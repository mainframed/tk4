         TITLE 'HMASMRCL - RECEIVE SUMMAY REPORT'
HMASMRCL CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMRCL  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   RCLRETRN=0;                     /* CLEAR RETURN CODE             */
         SLR   @10,@10                                             0204
         ST    @10,RCLRETRN                                        0204
*   HMASMMGP=''B;                   /* CLEAR HMASMMSG PARM LIST      */
         XC    HMASMMGP(28),HMASMMGP                               0205
*   VPART#1=' ';                    /* BLANK MSG VARIABLE SAVE AREA  */
         MVI   VPART#1+1,C' '                                      0206
         MVC   VPART#1+2(6),VPART#1+1                              0206
         MVI   VPART#1,C' '                                        0206
*   HEADRC=ZERO;                    /* INITIALIZE RETURN CODE        */
*                                                                  0207
         ST    @10,HEADRC                                          0207
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET ALL HEADINGS                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0208
*   IOPBUFAD=ADDR(PRL);             /* ADDRESS OF HEADINGS TO W      */
         L     @15,@PC00001                                        0208
         L     @15,RECXIOPG(,@15)                                  0208
         LA    @14,PRL                                             0208
         ST    @14,IOPBUFAD(,@15)                                  0208
*   PRLFLGS=''B;                    /* CLEAR FLAGS                   */
         MVI   PRLFLGS(@14),X'00'                                  0209
*   IOPDSID=CCARPTDS;               /* CCARPTDS DETERMINES OUTPT     */
         MVC   IOPDSID(1,@15),CCARPTDS(CCAPTR)                     0210
*   IOPFUNCT=IOPWRITE;              /* FOR OUTPUT                    */
         MVI   IOPFUNCT(@15),X'51'                                 0211
*   PRLHDADR=ZERO;                  /* ZERO OUT HEADING ADDRESS      */
         STCM  @10,7,PRLHDADR(@14)                                 0212
*   PRLRLEN=ZERO;                   /* 0 LENGTH FOR HDG RESET        */
         STH   @10,PRLRLEN(,@14)                                   0213
*   PRLHEAD=OFF;                    /* RESET ALL HEADINGS            */
*   PRLHEADO=ON;                    /* WITH THESE TWO PARMS          */
*   PRLBLANK=OFF;                   /* NOT BLANK LINE                */
         OI    PRLHEADO(@14),B'01000000'                           0216
         NI    PRLHEAD(@14),B'01011111'                            0216
*   CALL HMASMIO(HMASMIOP);         /* RESET VIA HMASMIO             */
         ST    @15,@AL00001                                        0217
         L     @15,@CV01420                                        0217
         LA    @01,@AL00001                                        0217
         BALR  @14,@15                                             0217
*   HEADRC=IOPRETRN;                /* SAVE RETURN CODE              */
         L     @10,@PC00001                                        0218
         L     @10,RECXIOPG(,@10)                                  0218
         SLR   @15,@15                                             0218
         IC    @15,IOPRETRN(,@10)                                  0218
         ST    @15,HEADRC                                          0218
*   IF HEADRC=ZERO                  /* IF OK TO CONTINUE THEN        */
*     THEN                                                         0219
         LTR   @15,@15                                             0219
         BNZ   @RF00219                                            0219
*     DO;                                                          0220
*       DO INDX=ONE TO DIM(HEADPTR) /* LOOP PRINTING HEADINGS        */
*             WHILE(HEADRC=ZERO);   /* UNLESS IO ERROR ENCOUNTER     */
         LA    @10,1                                               0221
         STH   @10,INDX                                            0221
@DL00221 ICM   @15,15,HEADRC                                       0221
         BNZ   @DC00221                                            0221
*         PRLRLEN=LENGTH(MAINHEAD); /* SET STANDARD LENGTH           */
         L     @15,@PC00001                                        0222
         L     @01,RECXIOPG(,@15)                                  0222
         L     @15,IOPBUFAD(,@01)                                  0222
         MVC   PRLRLEN(2,@15),@CH01461                             0222
*         PRLHEAD=ON;               /* SET THE NEW HEADING           */
*         PRLHEADO=OFF;             /* SIGNAL NOT RESET REQUEST      */
         OI    PRLHEAD(@15),B'10000000'                            0224
         NI    PRLHEADO(@15),B'10111111'                           0224
*         IF INDX=2×INDX=3×INDX=5   /* IF HEDING SHOULD BE BLANK     */
*           THEN                                                   0225
         CH    @10,@CH00062                                        0225
         BE    @RT00225                                            0225
         CH    @10,@CH00330                                        0225
         BE    @RT00225                                            0225
         CH    @10,@CH00227                                        0225
         BNE   @RF00225                                            0225
@RT00225 DS    0H                                                  0226
*           DO;                                                    0226
*             PRLBLANK=ON;          /* INDICATE BLANK HEADING        */
         L     @10,@PC00001                                        0227
         L     @10,RECXIOPG(,@10)                                  0227
         L     @10,IOPBUFAD(,@10)                                  0227
         OI    PRLBLANK(@10),B'00100000'                           0227
*             PRLHDADR=ZERO;        /* CLEAR HEADING ADDRESS         */
         SLR   @15,@15                                             0228
         STCM  @15,7,PRLHDADR(@10)                                 0228
*           END;                                                   0229
*         ELSE                                                     0230
*           DO;                     /* PASS HEADING ADDRESS          */
         B     @RC00225                                            0230
@RF00225 DS    0H                                                  0231
*             PRLBLANK=OFF;         /* NOT A BLANK LINE              */
         L     @10,@PC00001                                        0231
         L     @10,RECXIOPG(,@10)                                  0231
         L     @10,IOPBUFAD(,@10)                                  0231
         NI    PRLBLANK(@10),B'11011111'                           0231
*             PRLHDADR=HEADPTR(INDX);/* PASS HEADING ADDRESS         */
         LH    @15,INDX                                            0232
         SLA   @15,2                                               0232
         L     @15,HEADPTR-4(@15)                                  0232
         STCM  @15,7,PRLHDADR(@10)                                 0232
*           END;                                                   0233
*         CALL HMASMIO(HMASMIOP);   /* DO IO                         */
@RC00225 L     @10,@PC00001                                        0234
         L     @10,RECXIOPG(,@10)                                  0234
         ST    @10,@AL00001                                        0234
         L     @15,@CV01420                                        0234
         LA    @01,@AL00001                                        0234
         BALR  @14,@15                                             0234
*         HEADRC=IOPRETRN;          /* SAVE RETURN CODE              */
         L     @10,@PC00001                                        0235
         L     @10,RECXIOPG(,@10)                                  0235
         SLR   @15,@15                                             0235
         IC    @15,IOPRETRN(,@10)                                  0235
         ST    @15,HEADRC                                          0235
*       END;                        /*                               */
         LA    @10,1                                               0236
         AH    @10,INDX                                            0236
         STH   @10,INDX                                            0236
         CH    @10,@CH00227                                        0236
         BNH   @DL00221                                            0236
@DC00221 DS    0H                                                  0237
*     END;                          /* HEADING OUTPUT COMPLETED      */
*                                                                  0238
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0238
*   IOPFUNCT=IOPWRITE;              /* FUNCTION IS WRITE             */
@RF00219 L     @10,@PC00001                                        0238
         L     @10,RECXIOPG(,@10)                                  0238
         MVI   IOPFUNCT(@10),X'51'                                 0238
*   IOPDSID=CCARPTDS;               /* CCARPTDS DETERMINES OUTPUT    */
         MVC   IOPDSID(1,@10),CCARPTDS(CCAPTR)                     0239
*   IOPBUFAD=ADDR(PRL);             /* BUFFER TO WRITE IS A PRL    0240
*                                      (HMASMPRL)                    */
         LA    @15,PRL                                             0240
         ST    @15,IOPBUFAD(,@10)                                  0240
*   PRLRLEN=80;                     /* 80 CHARACTER LINE             */
         MVC   PRLRLEN(2,@15),@CH00607                             0241
*   PRLBLANK=OFF;                   /* BLANK LINE PRINT              */
*   PRLHEAD=OFF;                    /* THIS IS NOT A HEADING         */
*   PRLHEADO=OFF;                   /* THIS IS NOT A HEADING         */
         NI    PRLBLANK(@15),B'00011111'                           0244
*   IOPRETRN=IOPGOOD;                                              0245
         MVI   IOPRETRN(@10),X'00'                                 0245
*   RCLRETRN=0;                                                    0246
         SLR   @14,@14                                             0246
         ST    @14,RCLRETRN                                        0246
*                                                                  0247
*   /*****************************************************************/
*   /*                                                               */
*   /* START OF HMASMRCL CODE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*   DATALINE(1:80)='';              /* BLANK OUTPUT RECORD           */
         MVI   DATALINE(@15),C' '                                  0247
         MVC   DATALINE+1(79,@15),DATALINE(@15)                    0247
*   CALL HMASMIO(HMASMIOP);                                        0248
         ST    @10,@AL00001                                        0248
         L     @15,@CV01420                                        0248
         LA    @01,@AL00001                                        0248
         BALR  @14,@15                                             0248
*   RCLRETRN=IOPRETRN;              /* SAVE IO RETURN CODE           */
         L     @10,@PC00001                                        0249
         L     @01,RECXIOPG(,@10)                                  0249
         SLR   @00,@00                                             0249
         IC    @00,IOPRETRN(,@01)                                  0249
         ST    @00,RCLRETRN                                        0249
*   RESPECIFY                                                      0250
*     HMASMGTP BASED(RECXGSMP);     /* SUMMAY GTA FILE               */
*   RESPECIFY                                                      0251
*     GSMREC BASED(GTPBUFAD);       /* SUMMARY RECORD                */
*   SYSMCNT=0;                      /* CLEAR COUNT OF SYSMODS      0252
*                                      PROCESSED                     */
         SLR   @15,@15                                             0252
         ST    @15,SYSMCNT                                         0252
*   GTPFUNCT=GTPOPENN;                                             0253
         L     @10,RECXGSMP(,@10)                                  0253
         MVI   GTPFUNCT(@10),X'01'                                 0253
*   CALL HMASMGTA(HMASMGTP);        /* RESTART SUMMARY FILE          */
         ST    @10,@AL00001                                        0254
         L     @15,@CV01422                                        0254
         LA    @01,@AL00001                                        0254
         BALR  @14,@15                                             0254
*   GTPFUNCT=GTPGETN;                                              0255
         L     @10,@PC00001                                        0255
         L     @10,RECXGSMP(,@10)                                  0255
         MVI   GTPFUNCT(@10),X'08'                                 0255
*   CALL HMASMGTA(HMASMGTP);        /* GET FIRST SUMMARY FILE RECORD */
         ST    @10,@AL00001                                        0256
         L     @15,@CV01422                                        0256
         LA    @01,@AL00001                                        0256
         BALR  @14,@15                                             0256
*   DO WHILE(GTPRETRN<GTPEOF&RCLRETRN<STOPFUNC);                   0257
         B     @DE00257                                            0257
@DL00257 DS    0H                                                  0258
*     SYSMCNT=SYSMCNT+1;            /* COUNT OF SYSMODS PROCESSED    */
         LA    @10,1                                               0258
         AL    @10,SYSMCNT                                         0258
         ST    @10,SYSMCNT                                         0258
*     DATALINE(1:80)='';            /* BLANK OUTPUT RECORD           */
         L     @10,@PC00001                                        0259
         L     @01,RECXIOPG(,@10)                                  0259
         L     @15,IOPBUFAD(,@01)                                  0259
         MVI   DATALINE(@15),C' '                                  0259
         MVC   DATALINE+1(79,@15),DATALINE(@15)                    0259
*     SYSMODID=GSMS#;               /* SYSMOD ID                     */
         L     @10,RECXGSMP(,@10)                                  0260
         L     @10,GTPBUFAD(,@10)                                  0260
         MVC   SYSMODID(7,@15),GSMS#(@10)                          0260
*     IF GSMSTY=IOPPPTF THEN                                       0261
         CLI   GSMSTY(@10),3                                       0261
         BNE   @RF00261                                            0261
*       TYPE=TYPEP;                 /* PTF TYPE                      */
         MVC   TYPE(8,@15),@CC01508                                0262
*     ELSE                          /*                               */
*       IF GSMSTY=IOPPFUNC THEN                                    0263
         B     @RC00261                                            0263
@RF00261 L     @10,@PC00001                                        0263
         L     @01,RECXGSMP(,@10)                                  0263
         L     @01,GTPBUFAD(,@01)                                  0263
         CLI   GSMSTY(@01),4                                       0263
         BNE   @RF00263                                            0263
*         TYPE=TYPEF;               /* FUNCTION TYPE                 */
         L     @10,RECXIOPG(,@10)                                  0264
         L     @10,IOPBUFAD(,@10)                                  0264
         MVC   TYPE(8,@10),@CC01510                                0264
*       ELSE                        /*                               */
*         IF GSMSTY=IOPPUSER THEN                                  0265
         B     @RC00263                                            0265
@RF00263 L     @10,@PC00001                                        0265
         L     @01,RECXGSMP(,@10)                                  0265
         L     @01,GTPBUFAD(,@01)                                  0265
         CLI   GSMSTY(@01),1                                       0265
         BNE   @RF00265                                            0265
*           TYPE=TYPEU;             /* USERMOD TYPE                  */
         L     @10,RECXIOPG(,@10)                                  0266
         L     @10,IOPBUFAD(,@10)                                  0266
         MVC   TYPE(8,@10),@CC01512                                0266
*         ELSE                      /*                               */
*           IF GSMSTY=IOPPAPAR THEN                                0267
         B     @RC00265                                            0267
@RF00265 L     @10,@PC00001                                        0267
         L     @01,RECXGSMP(,@10)                                  0267
         L     @01,GTPBUFAD(,@01)                                  0267
         CLI   GSMSTY(@01),2                                       0267
         BNE   @RF00267                                            0267
*             TYPE=TYPEA;           /* APAR TYPE                     */
         L     @10,RECXIOPG(,@10)                                  0268
         L     @10,IOPBUFAD(,@10)                                  0268
         MVC   TYPE(8,@10),@CC01514                                0268
*           ELSE                    /*                               */
*             TYPE=TYPEX;           /* UN-KNOWN TYPE                 */
         B     @RC00267                                            0269
@RF00267 L     @10,@PC00001                                        0269
         L     @10,RECXIOPG(,@10)                                  0269
         L     @10,IOPBUFAD(,@10)                                  0269
         MVC   TYPE(8,@10),@CC01516                                0269
*     IF GSMRECVD=ON                /* SUCCESSFULLY RECEIVED         */
*       THEN                                                       0270
@RC00267 DS    0H                                                  0270
@RC00265 DS    0H                                                  0270
@RC00263 DS    0H                                                  0270
@RC00261 L     @10,@PC00001                                        0270
         L     @01,RECXGSMP(,@10)                                  0270
         L     @15,GTPBUFAD(,@01)                                  0270
         TM    GSMRECVD(@15),B'10000000'                           0270
         BNO   @RF00270                                            0270
*       DO;                                                        0271
*                                                                  0271
*         /***********************************************************/
*         /*                                                         */
*         /* SYSMOD SUCCESSFULLY RECEIVED                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0272
*         RECVSTAT=STATUSR;         /* "RECEIVED"                    */
         L     @10,RECXIOPG(,@10)                                  0272
         L     @10,IOPBUFAD(,@10)                                  0272
         MVC   RECVSTAT(9,@10),@CC01502                            0272
*         IF GSMRLFP=ON             /* RELFILE ELEMENTS PRESENT      */
*             &GSMRLFL=ON           /* SUCCESSFULLY LOADED           */
*           THEN                                                   0273
         TM    GSMRLFP(@15),B'01100000'                            0273
         BNO   @RF00273                                            0273
*           RECVINFO=MSGTDL;        /* "SMPTLIB DATASETS LOADED"     */
         MVC   RECVINFO(24,@10),@CC01518                           0274
*         CALL HMASMIO(HMASMIOP);   /* PUT RECORD TO SMPRPT DATASET  */
@RF00273 L     @10,@PC00001                                        0275
         L     @10,RECXIOPG(,@10)                                  0275
         ST    @10,@AL00001                                        0275
         L     @15,@CV01420                                        0275
         LA    @01,@AL00001                                        0275
         BALR  @14,@15                                             0275
*         RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN CODE */
         L     @10,@PC00001                                        0276
         L     @10,RECXIOPG(,@10)                                  0276
         L     @15,RCLRETRN                                        0276
         SLR   @14,@14                                             0276
         IC    @14,IOPRETRN(,@10)                                  0276
         CR    @15,@14                                             0276
         BNL   *+6
         LR    @15,@14                                             0276
         ST    @15,RCLRETRN                                        0276
*         DATALINE(1:80)='';        /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0277
         MVI   DATALINE(@10),C' '                                  0277
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0277
*       END;                                                       0278
*     ELSE                                                         0279
*       DO;                                                        0279
*                                                                  0279
         B     @RC00270                                            0279
@RF00270 DS    0H                                                  0280
*         /***********************************************************/
*         /*                                                         */
*         /* SYSMOD NOT RECEIVED                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0280
*         MSGOUT=OFF;               /* LINE NOT WRITTEN              */
         NI    MSGOUT,B'01111111'                                  0280
*         RECVSTAT=STATUSNR;        /* "NOT RECVD"                   */
         L     @10,@PC00001                                        0281
         L     @15,RECXIOPG(,@10)                                  0281
         L     @14,IOPBUFAD(,@15)                                  0281
         MVC   RECVSTAT(9,@14),@CC01505                            0281
*         IF GSMUSR=ON              /* STOPPED BY USER EXIT          */
*           THEN                                                   0282
         L     @10,RECXGSMP(,@10)                                  0282
         L     @10,GTPBUFAD(,@10)                                  0282
         TM    GSMUSR(@10),B'10000000'                             0282
         BNO   @RF00282                                            0282
*           DO;                                                    0283
*             RECVINFO=MSGUSR;      /* "USER EXIT"                   */
         MVC   RECVINFO(24,@14),@CC01521                           0284
*             CALL HMASMIO(HMASMIOP);/* PUT RECORD TO SMPRPT DATASET */
         ST    @15,@AL00001                                        0285
         L     @15,@CV01420                                        0285
         LA    @01,@AL00001                                        0285
         BALR  @14,@15                                             0285
*             RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0286
         L     @10,RECXIOPG(,@10)                                  0286
         L     @15,RCLRETRN                                        0286
         SLR   @14,@14                                             0286
         IC    @14,IOPRETRN(,@10)                                  0286
         CR    @15,@14                                             0286
         BNL   *+6
         LR    @15,@14                                             0286
         ST    @15,RCLRETRN                                        0286
*             MSGOUT=ON;            /* LINE HAS BEEN WRITTEN         */
         OI    MSGOUT,B'10000000'                                  0287
*             DATALINE(1:80)='';    /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0288
         MVI   DATALINE(@10),C' '                                  0288
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0288
*           END;                                                   0289
*         IF GSMSYNTX=ON            /* SYNTAX/CONSTRUCTION ERROR     */
*             &GSMEXCL=OFF          /* NOT EXCLUDED                  */
*           THEN                                                   0290
@RF00282 L     @10,@PC00001                                        0290
         L     @01,RECXGSMP(,@10)                                  0290
         L     @01,GTPBUFAD(,@01)                                  0290
         TM    GSMSYNTX(@01),B'01000000'                           0290
         BNO   @RF00290                                            0290
         TM    GSMEXCL(@01),B'00010000'                            0290
         BNZ   @RF00290                                            0290
*           DO;                                                    0291
*             RECVINFO=MSGSYNTX;    /* "SYSMOD/CONSTRUCTION"         */
         L     @10,RECXIOPG(,@10)                                  0292
         L     @01,IOPBUFAD(,@10)                                  0292
         MVC   RECVINFO(24,@01),@CC01524                           0292
*             CALL HMASMIO(HMASMIOP);/* PUT RECORD TO SMPRPT DATASET */
         ST    @10,@AL00001                                        0293
         L     @15,@CV01420                                        0293
         LA    @01,@AL00001                                        0293
         BALR  @14,@15                                             0293
*             RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0294
         L     @10,RECXIOPG(,@10)                                  0294
         L     @15,RCLRETRN                                        0294
         SLR   @14,@14                                             0294
         IC    @14,IOPRETRN(,@10)                                  0294
         CR    @15,@14                                             0294
         BNL   *+6
         LR    @15,@14                                             0294
         ST    @15,RCLRETRN                                        0294
*             MSGOUT=ON;            /* LINE HAS BEEN WRITTEN         */
         OI    MSGOUT,B'10000000'                                  0295
*             DATALINE(1:80)='';    /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0296
         MVI   DATALINE(@10),C' '                                  0296
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0296
*           END;                                                   0297
*         IF GSMRCVD=ON             /* ALREADY RECEIVED              */
*             &GSMSEL=ON            /* SYSMOD WAS SELECTED           */
*           THEN                                                   0298
@RF00290 L     @10,@PC00001                                        0298
         L     @01,RECXGSMP(,@10)                                  0298
         L     @15,GTPBUFAD(,@01)                                  0298
         TM    GSMRCVD(@15),B'00100000'                            0298
         BNO   @RF00298                                            0298
         TM    GSMSEL(@15),B'00010000'                             0298
         BNO   @RF00298                                            0298
*           DO;                                                    0299
*             RECVINFO=MSGRCVD;     /* "ALREADY RECEIVED"            */
         L     @10,RECXIOPG(,@10)                                  0300
         L     @01,IOPBUFAD(,@10)                                  0300
         MVC   RECVINFO(24,@01),@CC01527                           0300
*             CALL HMASMIO(HMASMIOP);/* PUT RECORD TO SMPRPT DATASET */
         ST    @10,@AL00001                                        0301
         L     @15,@CV01420                                        0301
         LA    @01,@AL00001                                        0301
         BALR  @14,@15                                             0301
*             RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0302
         L     @10,RECXIOPG(,@10)                                  0302
         L     @15,RCLRETRN                                        0302
         SLR   @14,@14                                             0302
         IC    @14,IOPRETRN(,@10)                                  0302
         CR    @15,@14                                             0302
         BNL   *+6
         LR    @15,@14                                             0302
         ST    @15,RCLRETRN                                        0302
*             MSGOUT=ON;            /* LINE HAS BEEN WRITTEN         */
         OI    MSGOUT,B'10000000'                                  0303
*             DATALINE(1:80)='';    /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0304
         MVI   DATALINE(@10),C' '                                  0304
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0304
*           END;                                                   0305
*         IF GSMNAVER=ON            /* NO APPLICABLE VER             */
*             &GSMEXCL=OFF          /* SYSMOD NOT EXCLUDED           */
*             &GSMRCVD=OFF          /* SYSMOD NOT ALREADY RECEIVED   */
*           THEN                                                   0306
@RF00298 L     @10,@PC00001                                        0306
         L     @01,RECXGSMP(,@10)                                  0306
         L     @01,GTPBUFAD(,@01)                                  0306
         TM    GSMNAVER(@01),B'00001000'                           0306
         BNO   @RF00306                                            0306
         TM    GSMEXCL(@01),B'00110000'                            0306
         BNZ   @RF00306                                            0306
*           DO;                                                    0307
*             RECVINFO=MSGNAVER;    /* "NO APPLICABLE ++VER"         */
         L     @10,RECXIOPG(,@10)                                  0308
         L     @01,IOPBUFAD(,@10)                                  0308
         MVC   RECVINFO(24,@01),@CC01530                           0308
*             CALL HMASMIO(HMASMIOP);/* PUT RECORD TO SMPRPT DATASET */
         ST    @10,@AL00001                                        0309
         L     @15,@CV01420                                        0309
         LA    @01,@AL00001                                        0309
         BALR  @14,@15                                             0309
*             RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0310
         L     @10,RECXIOPG(,@10)                                  0310
         L     @15,RCLRETRN                                        0310
         SLR   @14,@14                                             0310
         IC    @14,IOPRETRN(,@10)                                  0310
         CR    @15,@14                                             0310
         BNL   *+6
         LR    @15,@14                                             0310
         ST    @15,RCLRETRN                                        0310
*             MSGOUT=ON;            /* LINE HAS BEEN WRITTEN         */
         OI    MSGOUT,B'10000000'                                  0311
*             DATALINE(1:80)='';    /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0312
         MVI   DATALINE(@10),C' '                                  0312
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0312
*           END;                                                   0313
*         IF GSMSIOE=ON THEN                                       0314
@RF00306 L     @10,@PC00001                                        0314
         L     @01,RECXGSMP(,@10)                                  0314
         L     @01,GTPBUFAD(,@01)                                  0314
         TM    GSMSIOE(@01),B'00000100'                            0314
         BNO   @RF00314                                            0314
*           DO;                                                    0315
*             RECVINFO=MSGIOE;      /* "I/O ERROR"                   */
         L     @10,RECXIOPG(,@10)                                  0316
         L     @01,IOPBUFAD(,@10)                                  0316
         MVC   RECVINFO(24,@01),@CC01533                           0316
*             CALL HMASMIO(HMASMIOP);/* PUT RECORD TO SMPRPT DATASET */
         ST    @10,@AL00001                                        0317
         L     @15,@CV01420                                        0317
         LA    @01,@AL00001                                        0317
         BALR  @14,@15                                             0317
*             RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0318
         L     @10,RECXIOPG(,@10)                                  0318
         L     @15,RCLRETRN                                        0318
         SLR   @14,@14                                             0318
         IC    @14,IOPRETRN(,@10)                                  0318
         CR    @15,@14                                             0318
         BNL   *+6
         LR    @15,@14                                             0318
         ST    @15,RCLRETRN                                        0318
*             MSGOUT=ON;            /* LINE HAS BEEN WRITTEN         */
         OI    MSGOUT,B'10000000'                                  0319
*             DATALINE(1:80)='';    /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0320
         MVI   DATALINE(@10),C' '                                  0320
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0320
*           END;                                                   0321
*         IF GSMLERR=ON THEN                                       0322
@RF00314 L     @10,@PC00001                                        0322
         L     @01,RECXGSMP(,@10)                                  0322
         L     @01,GTPBUFAD(,@01)                                  0322
         TM    GSMLERR(@01),B'00000010'                            0322
         BNO   @RF00322                                            0322
*           DO;                                                    0323
*             RECVINFO=MSGLERR;     /* "RELFILE PROCESS ERROR"       */
         L     @10,RECXIOPG(,@10)                                  0324
         L     @01,IOPBUFAD(,@10)                                  0324
         MVC   RECVINFO(24,@01),@CC01536                           0324
*             CALL HMASMIO(HMASMIOP);/* PUT RECORD TO SMPRPT DATASET */
         ST    @10,@AL00001                                        0325
         L     @15,@CV01420                                        0325
         LA    @01,@AL00001                                        0325
         BALR  @14,@15                                             0325
*             RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0326
         L     @10,RECXIOPG(,@10)                                  0326
         L     @15,RCLRETRN                                        0326
         SLR   @14,@14                                             0326
         IC    @14,IOPRETRN(,@10)                                  0326
         CR    @15,@14                                             0326
         BNL   *+6
         LR    @15,@14                                             0326
         ST    @15,RCLRETRN                                        0326
*             MSGOUT=ON;            /* LINE HAS BEEN WRITTEN         */
         OI    MSGOUT,B'10000000'                                  0327
*             DATALINE(1:80)='';    /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0328
         MVI   DATALINE(@10),C' '                                  0328
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0328
*           END;                                                   0329
*         IF GSMRLFP=ON             /* RELFILE ELEMENTS PRESENT      */
*             &GSMRLFL=OFF          /* RELFILES NOT LOADED           */
*             &GSMLERR=OFF          /* NO RELFILE PROCESSING ERROR   */
*           THEN                                                   0330
@RF00322 L     @10,@PC00001                                        0330
         L     @01,RECXGSMP(,@10)                                  0330
         L     @15,GTPBUFAD(,@01)                                  0330
         TM    GSMRLFP(@15),B'01000000'                            0330
         BNO   @RF00330                                            0330
         TM    GSMRLFL(@15),B'00100000'                            0330
         BNZ   @RF00330                                            0330
         TM    GSMLERR(@15),B'00000010'                            0330
         BNZ   @RF00330                                            0330
*           DO;                                                    0331
*             RECVINFO=MSGRNP;      /* "RELFILES NOT PROCESSED"      */
         L     @10,RECXIOPG(,@10)                                  0332
         L     @01,IOPBUFAD(,@10)                                  0332
         MVC   RECVINFO(24,@01),@CC01539                           0332
*             CALL HMASMIO(HMASMIOP);/* PUT RECORD TO SMPRPT DATASET */
         ST    @10,@AL00001                                        0333
         L     @15,@CV01420                                        0333
         LA    @01,@AL00001                                        0333
         BALR  @14,@15                                             0333
*             RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0334
         L     @10,RECXIOPG(,@10)                                  0334
         L     @15,RCLRETRN                                        0334
         SLR   @14,@14                                             0334
         IC    @14,IOPRETRN(,@10)                                  0334
         CR    @15,@14                                             0334
         BNL   *+6
         LR    @15,@14                                             0334
         ST    @15,RCLRETRN                                        0334
*             MSGOUT=ON;            /* LINE HAS BEEN WRITTEN         */
         OI    MSGOUT,B'10000000'                                  0335
*             DATALINE(1:80)='';    /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0336
         MVI   DATALINE(@10),C' '                                  0336
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0336
*           END;                                                   0337
*         IF GSMNFND=ON             /* SYSMOD NOT FOUND ON PTFIN     */
*           THEN                                                   0338
@RF00330 L     @10,@PC00001                                        0338
         L     @01,RECXGSMP(,@10)                                  0338
         L     @01,GTPBUFAD(,@01)                                  0338
         TM    GSMNFND(@01),B'00100000'                            0338
         BNO   @RF00338                                            0338
*           DO;                                                    0339
*             RECVINFO=MSGNFND;     /* "NOT FOUND ON SMPPTFIN"       */
         L     @10,RECXIOPG(,@10)                                  0340
         L     @01,IOPBUFAD(,@10)                                  0340
         MVC   RECVINFO(24,@01),@CC01542                           0340
*             CALL HMASMIO(HMASMIOP);/* PUT RECORD TO SMPRPT DATASET */
         ST    @10,@AL00001                                        0341
         L     @15,@CV01420                                        0341
         LA    @01,@AL00001                                        0341
         BALR  @14,@15                                             0341
*             RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN
*                                      CODE                          */
         L     @10,@PC00001                                        0342
         L     @10,RECXIOPG(,@10)                                  0342
         L     @15,RCLRETRN                                        0342
         SLR   @14,@14                                             0342
         IC    @14,IOPRETRN(,@10)                                  0342
         CR    @15,@14                                             0342
         BNL   *+6
         LR    @15,@14                                             0342
         ST    @15,RCLRETRN                                        0342
*             MSGOUT=ON;            /* LINE HAS BEEN WRITTEN         */
         OI    MSGOUT,B'10000000'                                  0343
*             DATALINE(1:80)='';    /* BLANK OUTPUT RECORD           */
         L     @10,IOPBUFAD(,@10)                                  0344
         MVI   DATALINE(@10),C' '                                  0344
         MVC   DATALINE+1(79,@10),DATALINE(@10)                    0344
*           END;                                                   0345
*       END;                        /* NOT RECEIVED BECAUSE COND     */
@RF00338 DS    0H                                                  0347
*     CALL HMASMGTA(HMASMGTP);      /* GET NEXT SUMMARY RECORD       */
@RC00270 L     @10,@PC00001                                        0347
         L     @10,RECXGSMP(,@10)                                  0347
         ST    @10,@AL00001                                        0347
         L     @15,@CV01422                                        0347
         LA    @01,@AL00001                                        0347
         BALR  @14,@15                                             0347
*   END;                            /* END LOOP THRU GTA FILE RECORDS*/
@DE00257 L     @10,@PC00001                                        0348
         L     @10,RECXGSMP(,@10)                                  0348
         CLI   GTPRETRN(@10),4                                     0348
         BNL   @DC00257                                            0348
         L     @10,RCLRETRN                                        0348
         CH    @10,@CH00274                                        0348
         BL    @DL00257                                            0348
@DC00257 DS    0H                                                  0349
*   IF SYSMCNT=0 THEN                                              0349
         ICM   @10,15,SYSMCNT                                      0349
         BNZ   @RF00349                                            0349
*     DO;                           /* NO SYSMODS PROCESSED BY     0350
*                                      RECEIVE                       */
*       RECVINFO=MSGNSP;            /* "*NO SYSMODS PROCESSED*"      */
         L     @10,@PC00001                                        0351
         L     @10,RECXIOPG(,@10)                                  0351
         L     @01,IOPBUFAD(,@10)                                  0351
         MVC   RECVINFO(24,@01),@CC01545                           0351
*       CALL HMASMIO(HMASMIOP);     /* PUT RECORD TO SMPRPT DATASET  */
         ST    @10,@AL00001                                        0352
         L     @15,@CV01420                                        0352
         LA    @01,@AL00001                                        0352
         BALR  @14,@15                                             0352
*       RCLRETRN=MAX(RCLRETRN,IOPRETRN);/* SET MAX RCL RETURN CODE   */
         L     @10,@PC00001                                        0353
         L     @10,RECXIOPG(,@10)                                  0353
         L     @15,RCLRETRN                                        0353
         SLR   @14,@14                                             0353
         IC    @14,IOPRETRN(,@10)                                  0353
         CR    @15,@14                                             0353
         BNL   *+6
         LR    @15,@14                                             0353
         ST    @15,RCLRETRN                                        0353
*     END;                                                         0354
*                                                                  0354
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET ALL HEADINGS                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*   PRLHDADR=ZERO;                  /* ZERO OUT HEADING ADDRESS      */
@RF00349 SLR   @10,@10                                             0355
         L     @15,@PC00001                                        0355
         L     @15,RECXIOPG(,@15)                                  0355
         L     @14,IOPBUFAD(,@15)                                  0355
         STCM  @10,7,PRLHDADR(@14)                                 0355
*   PRLRLEN=ZERO;                   /* 0 LENGTH FOR HDG RESET        */
         STH   @10,PRLRLEN(,@14)                                   0356
*   PRLHEAD=OFF;                    /* RESET ALL HEADINGS            */
*   PRLHEADO=ON;                    /* WITH THESE TWO PARMS          */
*   PRLBLANK=OFF;                   /* NOT BLANK LINE                */
         OI    PRLHEADO(@14),B'01000000'                           0359
         NI    PRLHEAD(@14),B'01011111'                            0359
*   CALL HMASMIO(HMASMIOP);         /* RESET VIA HMASMIO             */
         ST    @15,@AL00001                                        0360
         L     @15,@CV01420                                        0360
         LA    @01,@AL00001                                        0360
         BALR  @14,@15                                             0360
*                                                                  0361
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE THE PTS SYSTEM ENTRY USING THE GTA SUMMAY FILE TO FIND */
*   /* SUCCESSFULLY RECEIVED FUNCTION SYSMODS.                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0361
*   RESPECIFY                                                      0361
*     HMASMGTP BASED(RECXGSMP);     /* SUMMARY GTP                   */
*   RESPECIFY                                                      0362
*     HMASMIOP BASED(RECXIOPG);     /* IOP FOR PTS SYS ENTRY         */
*   IF RECXGPSP->GTPWKAD^=0 THEN                                   0363
         L     @10,@PC00001                                        0363
         L     @01,RECXGPSP(,@10)                                  0363
         ICM   @00,15,GTPWKAD(@01)                                 0363
         BZ    @RF00363                                            0363
*     DO;                                                          0364
*                                                                  0364
*       /*************************************************************/
*       /*                                                           */
*       /* THERE ARE ENTRIES IN PTS SYSTEM ENTRY GTA FILE ... ACCESS */
*       /* THE PTS SYSTEM ENTRY ITSELF                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0365
*       IOPDSID=IOPPTS;             /* DATASET IS SMPPTS             */
         L     @10,RECXIOPG(,@10)                                  0365
         MVI   IOPDSID(@10),X'06'                                  0365
*       IOPNAME=' ';                /* N/A                           */
         MVI   IOPNAME+1(@10),C' '                                 0366
         MVC   IOPNAME+2(6,@10),IOPNAME+1(@10)                     0366
         MVI   IOPNAME(@10),C' '                                   0366
*       IOPTYPE=IOPSYS;             /* ENTRY TYPE IS SYSTEM          */
         MVI   IOPTYPE(@10),X'07'                                  0367
*       IOPFUNCT=IOPLOC;            /* FUNCTION IS LOCATE            */
         MVI   IOPFUNCT(@10),X'03'                                 0368
*       CALL HMASMIO(HMASMIOP);     /*                               */
         ST    @10,@AL00001                                        0369
         L     @15,@CV01420                                        0369
         LA    @01,@AL00001                                        0369
         BALR  @14,@15                                             0369
*       IF IOPRETRN=IOPGOOD THEN                                   0370
         L     @10,@PC00001                                        0370
         L     @01,RECXIOPG(,@10)                                  0370
         CLI   IOPRETRN(@01),0                                     0370
         BNE   @RF00370                                            0370
*         DO;                                                      0371
*                                                                  0371
*           /*********************************************************/
*           /*                                                       */
*           /* PTS SYSTEM ENTRY ACCESSED ... GO THRU THE GTA SUMMARY */
*           /* FILE TO SEE IF THERE ARE FUNCTION SYSMODS WHICH SHOULD*/
*           /* BE ADDED TO PTS SYSTEM ENTRY                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0372
*           GTPFUNCT=GTPOPENN;      /* RE-START GTA PROCESSING AT TOP*/
         L     @10,RECXGSMP(,@10)                                  0372
         MVI   GTPFUNCT(@10),X'01'                                 0372
*           CALL HMASMGTA(HMASMGTP);                               0373
         ST    @10,@AL00001                                        0373
         L     @15,@CV01422                                        0373
         LA    @01,@AL00001                                        0373
         BALR  @14,@15                                             0373
*           GTPFUNCT=GTPGETN;       /* GET NEXT FUNCTION             */
         L     @10,@PC00001                                        0374
         L     @10,RECXGSMP(,@10)                                  0374
         MVI   GTPFUNCT(@10),X'08'                                 0374
*           CALL HMASMGTA(HMASMGTP);/* GET FIRST RECORD              */
         ST    @10,@AL00001                                        0375
         L     @15,@CV01422                                        0375
         LA    @01,@AL00001                                        0375
         BALR  @14,@15                                             0375
*           ADDED=NO;               /* NOTHING HAS BEEN ADDED TO PTS
*                                      SYS ENTRY                     */
         MVI   ADDED,C'N'                                          0376
*           PTSPEMAX=NO;            /* INIT LOOP CONTROL SWITCH      */
         MVI   PTSPEMAX,C'N'                                       0377
*           DO WHILE GTPRETRN<GTPEOF/* NOT END OF GTA FILE           */
*                 &PTSPEMAX=NO;     /* PTS SYSTEM ENTRY PEMAX "OK"   */
         B     @DE00378                                            0378
@DL00378 DS    0H                                                  0379
*             IF GSMRECVD=ON&GSMSTY=IOPPFUNC THEN                  0379
         L     @10,@PC00001                                        0379
         L     @10,RECXGSMP(,@10)                                  0379
         L     @10,GTPBUFAD(,@10)                                  0379
         TM    GSMRECVD(@10),B'10000000'                           0379
         BNO   @RF00379                                            0379
         CLI   GSMSTY(@10),4                                       0379
         BNE   @RF00379                                            0379
*               DO;                                                0380
*                                                                  0380
*                 /***************************************************/
*                 /*                                                 */
*                 /* A SUCCESSFULLY RECEIVED FUNCTION FOUND IN       */
*                 /* SUMMARY GTA FILE ... SEE IF IT IS ALREADY IN THE*/
*                 /* PTS SYSTEM ENTRY                                */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0381
*                 FOUND=NO;         /* FUNCTION FMID NOT FOUND IN PTS
*                                      SYS                           */
         MVI   FOUND,C'N'                                          0381
*                 DO I=1 BY 1 WHILE IOPPTSND(I)^=IOPEOLST&FOUND=NO;
         LA    @10,1                                               0382
         STH   @10,I                                               0382
         B     @DE00382                                            0382
@DL00382 DS    0H                                                  0383
*                   IF IOPPTIND(I)=IOPPTFM&IOPPTFMD(I)=GSMS# THEN  0383
*                                                                  0383
         LH    @10,I                                               0383
         MH    @10,@CH00529                                        0383
         L     @15,@PC00001                                        0383
         L     @14,RECXIOPG(,@15)                                  0383
         SLR   @09,@09                                             0383
         IC    @09,IOPPTIND-9(@10,@14)                             0383
         CH    @09,@CH00039                                        0383
         BNE   @RF00383                                            0383
         L     @01,RECXGSMP(,@15)                                  0383
         L     @01,GTPBUFAD(,@01)                                  0383
         ALR   @14,@10                                             0383
         CLC   IOPPTFMD-9(7,@14),GSMS#(@01)                        0383
         BNE   @RF00383                                            0383
*                     /***********************************************/
*                     /*                                             */
*                     /* THE SAME FUNCTION (FMID) ALREADY IN PTS     */
*                     /* SYSTEM ENTRY                                */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0384
*                     FOUND=YES;                                   0384
         MVI   FOUND,C'Y'                                          0384
*                 END;                                             0385
@RF00383 LA    @10,1                                               0385
         AH    @10,I                                               0385
         STH   @10,I                                               0385
@DE00382 LH    @10,I                                               0385
         MH    @10,@CH00529                                        0385
         L     @15,@PC00001                                        0385
         L     @01,RECXIOPG(,@15)                                  0385
         SLR   @00,@00                                             0385
         IC    @00,IOPPTSND-9(@10,@01)                             0385
         CH    @00,@CH00717                                        0385
         BE    @DC00382                                            0385
         CLI   FOUND,C'N'                                          0385
         BE    @DL00382                                            0385
@DC00382 DS    0H                                                  0386
*                 IF FOUND=NO THEN                                 0386
         CLI   FOUND,C'N'                                          0386
         BNE   @RF00386                                            0386
*                   DO;                                            0387
*                                                                  0387
*                     /***********************************************/
*                     /*                                             */
*                     /* FUNCTION (FMID) NOT FOUND IN PTS SYSTEM     */
*                     /* ENTRY ... ADD IT                            */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0388
*                     IF I+1<CCAPEMAX THEN                         0388
         LH    @10,I                                               0388
         LA    @15,1                                               0388
         LR    @14,@10                                             0388
         ALR   @14,@15                                             0388
         CH    @14,CCAPEMAX(,CCAPTR)                               0388
         BNL   @RF00388                                            0388
*                       DO;                                        0389
*                                                                  0389
*                         /*******************************************/
*                         /*                                         */
*                         /* FMID WILL FIT                           */
*                         /*                                         */
*                         /*******************************************/
*                                                                  0390
*                         ADDED=YES;/* AN FMID HAS BEEN ADDED        */
         MVI   ADDED,C'Y'                                          0390
*                         IOPPTIND(I)=IOPPTFM;/* FMID ENTRY          */
         MH    @10,@CH00529                                        0391
         L     @14,@PC00001                                        0391
         L     @09,RECXIOPG(,@14)                                  0391
         STC   @15,IOPPTIND-9(@10,@09)                             0391
*                         IOPPTFMD(I)=GSMS#;/* THE FMID              */
         ST    @10,@TF00001                                        0392
         ALR   @10,@09                                             0392
         L     @01,RECXGSMP(,@14)                                  0392
         L     @01,GTPBUFAD(,@01)                                  0392
         MVC   IOPPTFMD-9(7,@10),GSMS#(@01)                        0392
*                         IOPPTSND(I+1)=IOPEOLST;/* END-OF-LIST      */
         LA    @10,255                                             0393
         L     @08,@TF00001                                        0393
         STC   @10,IOPPTSND(@08,@09)                               0393
*                       END;                                       0394
*                     ELSE                                         0395
*                       DO;                                        0395
*                                                                  0395
         B     @RC00388                                            0395
@RF00388 DS    0H                                                  0396
*                         /*******************************************/
*                         /*                                         */
*                         /* FMID WILL NOT FIT ... PEMAX EXCEEDED ...*/
*                         /* ISSUE HMA259I                           */
*                         /*                                         */
*                         /*******************************************/
*                                                                  0396
*                         MGPTYPE=MGPSEV;/* SEVERE ERROR             */
         MVI   MGPTYPE,X'04'                                       0396
*                         VPART#1=GSMS#;/* SYSMOD # BEING ADDED      */
         MVI   VPART#1+7,C' '                                      0397
         L     @10,@PC00001                                        0397
         L     @10,RECXGSMP(,@10)                                  0397
         L     @10,GTPBUFAD(,@10)                                  0397
         MVC   VPART#1(7),GSMS#(@10)                               0397
*                         CALL ERRMSG(HMA259I,NOPART,NOPART);      0398
         LA    @01,@AL00398                                        0398
         BAL   @14,ERRMSG                                          0398
*                         PTSPEMAX=YES;/* RESET LOOP CONTROL SWITCH  */
         MVI   PTSPEMAX,C'Y'                                       0399
*                       END;                                       0400
*                   END;                                           0401
@RC00388 DS    0H                                                  0402
*               END;                                               0402
@RF00386 DS    0H                                                  0403
*             CALL HMASMGTA(HMASMGTP);/* GET NEXT SUMMARY RECORD     */
@RF00379 L     @10,@PC00001                                        0403
         L     @10,RECXGSMP(,@10)                                  0403
         ST    @10,@AL00001                                        0403
         L     @15,@CV01422                                        0403
         LA    @01,@AL00001                                        0403
         BALR  @14,@15                                             0403
*           END;                                                   0404
@DE00378 L     @10,@PC00001                                        0404
         L     @10,RECXGSMP(,@10)                                  0404
         CLI   GTPRETRN(@10),4                                     0404
         BNL   @DC00378                                            0404
         CLI   PTSPEMAX,C'N'                                       0404
         BE    @DL00378                                            0404
@DC00378 DS    0H                                                  0405
*           IF ADDED=YES THEN                                      0405
         CLI   ADDED,C'Y'                                          0405
         BNE   @RF00405                                            0405
*             DO;                                                  0406
*                                                                  0406
*               /*****************************************************/
*               /*                                                   */
*               /* FUNCTION FMID'S HAVE BEEN ADDED TO THE PTS SYSTEM */
*               /* ENTRY ... RE-WRITE THE ENTRY TO THE PTS           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0407
*               IOPFUNCT=IOPSTOWR;  /* STOW REPLACE                  */
         L     @10,@PC00001                                        0407
         L     @10,RECXIOPG(,@10)                                  0407
         MVI   IOPFUNCT(@10),X'54'                                 0407
*               CALL HMASMIO(HMASMIOP);                            0408
         ST    @10,@AL00001                                        0408
         L     @15,@CV01420                                        0408
         LA    @01,@AL00001                                        0408
         BALR  @14,@15                                             0408
*               RECXMAX=MAX(RECXMAX,IOPRETRN);                     0409
         L     @10,@PC00001                                        0409
         L     @01,RECXIOPG(,@10)                                  0409
         L     @00,RECXMAX(,@10)                                   0409
         SLR   @15,@15                                             0409
         IC    @15,IOPRETRN(,@01)                                  0409
         CR    @00,@15                                             0409
         BNL   *+6
         LR    @00,@15                                             0409
         ST    @00,RECXMAX(,@10)                                   0409
*             END;                                                 0410
*         END;                                                     0411
*       ELSE                                                       0412
*         DO;                                                      0412
*                                                                  0412
         B     @RC00370                                            0412
@RF00370 DS    0H                                                  0413
*           /*********************************************************/
*           /*                                                       */
*           /* ERROR ACCESSING PTS SYSTEM ENTRY                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0413
*           RECXMAX=MAX(RECXMAX,IOPRETRN);/* RETAIN IO'S RETURN      */
         L     @10,@PC00001                                        0413
         L     @15,RECXIOPG(,@10)                                  0413
         L     @14,RECXMAX(,@10)                                   0413
         SLR   @09,@09                                             0413
         IC    @09,IOPRETRN(,@15)                                  0413
         CR    @14,@09                                             0413
         BNL   *+6
         LR    @14,@09                                             0413
         ST    @14,RECXMAX(,@10)                                   0413
*           IF IOPRETRN=IOPNOTFD THEN                              0414
         CLI   IOPRETRN(@15),4                                     0414
         BNE   @RF00414                                            0414
*             DO;                                                  0415
*                                                                  0415
*               /*****************************************************/
*               /*                                                   */
*               /* PTS SYSTEM ENTRY NOT FOUND ... ISSUE HMA246I      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0416
*               MGPTYPE=MGPSEV;     /* SEVERE ERROR                  */
         MVI   MGPTYPE,X'04'                                       0416
*               CALL ERRMSG(HMA246I,NOPART,NOPART);/* PTS SYS ENTRY
*                                      NOT FOUND                     */
         LA    @01,@AL00417                                        0417
         BAL   @14,ERRMSG                                          0417
*             END;                                                 0418
*         END;                                                     0419
@RF00414 DS    0H                                                  0420
*     END;                          /* PTS SYSTEM ENTRY UPDATED      */
@RC00370 DS    0H                                                  0421
*   RECXMAX=MAX(RECXMAX,RCLRETRN);  /* SET RECEIVE MAX RETURN CODE   */
@RF00363 L     @10,@PC00001                                        0421
         L     @15,RCLRETRN                                        0421
         L     @14,RECXMAX(,@10)                                   0421
         CR    @14,@15                                             0421
         BNL   *+6
         LR    @14,@15                                             0421
         ST    @14,RECXMAX(,@10)                                   0421
*   RETURN CODE(RCLRETRN);          /* --- RETURN TO CALLER ---      */
         L     @13,4(,@13)                                         0422
         L     @14,12(,@13)                                        0422
         LM    @00,@12,20(@13)                                     0422
         BR    @14                                                 0422
*                                                                  0423
*/********************************************************************/
*/*                                                                  */
*/*    ERRMSG - PUT ERROR MESSAGES TO SMPOUT AND SMPLOG FILES.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0423
*ERRMSG:                                                           0423
*   PROC(MSGCODE1,MSGCODE2,MSGCODE3);                              0423
ERRMSG   STM   @14,@12,@SA00002                                    0423
         MVC   @PC00002(12),0(@01)                                 0423
*   DCL                                                            0424
*     MSGCODE1 FIXED(8);            /* PRIMARY MESSAGE NUMBER        */
*   DCL                                                            0425
*     MSGCODE2 FIXED(8);            /* SECONDARY MESSAGE NUMBER      */
*   DCL                                                            0426
*     MSGCODE3 FIXED(8);            /* TERTIARY MESSAGE NUMBER       */
*                                                                  0426
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP HMASMMSG PARM LIST (MGP)                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */
         XC    MGPCLEAR(6),MGPCLEAR                                0427
*   MGPMGNO1=MSGCODE1;              /* PRIMARY MESSAGE NUMBER        */
         L     @10,@PC00002                                        0428
         SLR   @15,@15                                             0428
         IC    @15,MSGCODE1(,@10)                                  0428
         STH   @15,MGPMGNO1                                        0428
*   IF MSGCODE2^=NOPART THEN                                       0429
         L     @10,@PC00002+4                                      0429
         CLI   MSGCODE2(@10),0                                     0429
         BE    @RF00429                                            0429
*     MGPMGNO2=MSGCODE2;            /* SECONDARY MESSAGE PART        */
         SLR   @15,@15                                             0430
         IC    @15,MSGCODE2(,@10)                                  0430
         STH   @15,MGPMGNO2                                        0430
*   IF MSGCODE3^=NOPART THEN                                       0431
@RF00429 L     @10,@PC00002+8                                      0431
         CLI   MSGCODE3(@10),0                                     0431
         BE    @RF00431                                            0431
*     MGPMGNO3=MSGCODE3;            /* TERCIARY MESSAGE PART         */
         SLR   @15,@15                                             0432
         IC    @15,MSGCODE3(,@10)                                  0432
         STH   @15,MGPMGNO3                                        0432
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */
@RF00431 DS    0H                                                  0434
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */
*   MGPWTOR=OFF;                    /* NOT WTOR                      */
*   MGPWTO=OFF;                     /* NOT WTO                       */
*                                                                  0436
         OI    MGPPRINT,B'10010000'                                0436
         NI    MGPWTOR,B'11110011'                                 0436
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP VARIABLE PARTS OF CERTAIN MESSAGES                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0437
*   IF MGPMGNO1=HMA246I THEN                                       0437
         CLC   MGPMGNO1(2),@CH01446                                0437
         BNE   @RF00437                                            0437
*     DO;                                                          0438
*                                                                  0438
*       /*************************************************************/
*       /*                                                           */
*       /* HMA246I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0439
*       MGPVARPT(1)=ADDR(MSGSYS);   /* "SYSTEM"                      */
         LA    @10,MSGSYS                                          0439
         ST    @10,MGPVARPT                                        0439
*       MGPVARPT(2)=ADDR(MSGENT);   /* "ENTRY"                       */
         LA    @10,MSGENT                                          0440
         ST    @10,MGPVARPT+4                                      0440
*       MGPVARPT(3)=ADDR(MSGPTS);   /* "SMPPTS"                      */
         LA    @10,MSGPTS                                          0441
         ST    @10,MGPVARPT+8                                      0441
*     END;                                                         0442
*   IF MGPMGNO1=HMA259I THEN                                       0443
@RF00437 CLC   MGPMGNO1(2),@CH00900                                0443
         BNE   @RF00443                                            0443
*     DO;                                                          0444
*                                                                  0444
*       /*************************************************************/
*       /*                                                           */
*       /* HMA259I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0445
*       MGPVARPT(1)=ADDR(MSGPTS);   /* "SMPPTS"                      */
         LA    @10,MSGPTS                                          0445
         ST    @10,MGPVARPT                                        0445
*       MGPVARPT(2)=ADDR(MSGSYS);   /* "SYSTEM"                      */
         LA    @10,MSGSYS                                          0446
         ST    @10,MGPVARPT+4                                      0446
*       MGPVARPT(3)=ADDR(MSGFMID);  /* "FMID "                       */
         LA    @10,MSGFMID                                         0447
         ST    @10,MGPVARPT+8                                      0447
*       MGPVARPT(4)=ADDR(VPART#1);  /* FMID SYSMOD # BEING ADDED     */
         LA    @10,VPART#1                                         0448
         ST    @10,MGPVARPT+12                                     0448
*     END;                                                         0449
*   CALL HMASMMSG(HMASMMGP);                                       0450
@RF00443 L     @15,@CV01421                                        0450
         LA    @01,@AL00450                                        0450
         BALR  @14,@15                                             0450
*   RESPECIFY                                                      0451
*     REG15 RSTD;                   /* CHECK RETURN CODE             */
*   RECXMAX=MAX(RECXMAX,REG15);     /* SAVE IT IF HIGH               */
         L     @14,@PC00001                                        0452
         L     @10,RECXMAX(,@14)                                   0452
         CR    @10,REG15                                           0452
         BNL   *+6
         LR    @10,REG15                                           0452
         ST    @10,RECXMAX(,@14)                                   0452
*   RESPECIFY                                                      0453
*     REG15 UNRSTD;                                                0453
*                                                                  0453
*   /*****************************************************************/
*   /*                                                               */
*   /* SET RECEIVE RETURN CODE BASED UPON MGPTYPE                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0454
*   IF MGPTYPE=MGPWARN THEN                                        0454
         CLI   MGPTYPE,2                                           0454
         BNE   @RF00454                                            0454
*     RECXMAX=MAX(RECXMAX,PTFWARN); /* WARNING                       */
         LA    @15,4                                               0455
         CR    @10,@15                                             0455
         BNL   *+6
         LR    @10,@15                                             0455
         ST    @10,RECXMAX(,@14)                                   0455
*   ELSE                                                           0456
*     IF MGPTYPE=MGPERR THEN                                       0456
         B     @RC00454                                            0456
@RF00454 CLI   MGPTYPE,3                                           0456
         BNE   @RF00456                                            0456
*       RECXMAX=MAX(RECXMAX,STOPPTF);/* STOP-SYSMOD                  */
         L     @10,@PC00001                                        0457
         L     @15,RECXMAX(,@10)                                   0457
         LA    @14,8                                               0457
         CR    @15,@14                                             0457
         BNL   *+6
         LR    @15,@14                                             0457
         ST    @15,RECXMAX(,@10)                                   0457
*     ELSE                                                         0458
*       IF MGPTYPE=MGPSEV THEN                                     0458
         B     @RC00456                                            0458
@RF00456 CLI   MGPTYPE,4                                           0458
         BNE   @RF00458                                            0458
*         RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE                    */
         L     @10,@PC00001                                        0459
         L     @15,RECXMAX(,@10)                                   0459
         LA    @14,12                                              0459
         CR    @15,@14                                             0459
         BNL   *+6
         LR    @15,@14                                             0459
         ST    @15,RECXMAX(,@10)                                   0459
*       ELSE                                                       0460
*         IF MGPTYPE=MGPTERM THEN                                  0460
         B     @RC00458                                            0460
@RF00458 CLI   MGPTYPE,5                                           0460
         BNE   @RF00460                                            0460
*           RECXMAX=MAX(RECXMAX,STOPSMP);/* TERMINATING              */
         L     @10,@PC00001                                        0461
         L     @15,RECXMAX(,@10)                                   0461
         LA    @14,16                                              0461
         CR    @15,@14                                             0461
         BNL   *+6
         LR    @15,@14                                             0461
         ST    @15,RECXMAX(,@10)                                   0461
*   RETURN;                                                        0462
@EL00002 DS    0H                                                  0462
@EF00002 DS    0H                                                  0462
@ER00002 LM    @14,@12,@SA00002                                    0462
         BR    @14                                                 0462
*   END ERRMSG;                                                    0463
         B     @EL00002                                            0463
*   END HMASMRCL                                                   0464
*                                                                  0464
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  0464
*       ;                                                          0464
@DATA    DS    0H
@CH00346 DC    H'0'
@CH00039 DC    H'1'
@CH00062 DC    H'2'
@CH00330 DC    H'3'
@CH00227 DC    H'5'
@CH00529 DC    H'9'
@CH00274 DC    H'12'
@CH01446 DC    H'47'
@CH00900 DC    H'60'
@CH00607 DC    H'80'
@CH01461 DC    H'121'
@CH00717 DC    H'255'
         DS    0F
@AL00398 DC    A(@CH00900+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00346+1)
         DC    A(@CH00346+1)
@AL00417 DC    A(@CH01446+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00346+1)
         DC    A(@CH00346+1)
@AL00450 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    0F
@PC00002 EQU   @SA00002+60
         DS    18F
@AL00001 DS    1A
@TF00001 DS    F
         DS    0F
@CV01420 DC    V(HMASMIO)
@CV01421 DC    V(HMASMMSG)
@CV01422 DC    V(HMASMGTA)
@CV01423 DC    V(HMASMSUB)
         DS    0D
IOPPTR   DC    AL4(MYIOP)
SCPPTR   DS    A
SYSMCNT  DS    F
RCLRETRN DS    F
HEADRC   DS    F
INDX     DS    H
I        DS    H
@CC01518 DC    C'SMPTLIB DATASETS LOADED '
@CC01521 DC    C'USER EXIT               '
@CC01524 DC    C'SYNTAX/CONSTRUCTION     '
@CC01527 DC    C'ALREADY RECEIVED        '
@CC01530 DC    C'NO APPLICABLE ++VER     '
@CC01533 DC    C'I/O ERROR               '
@CC01536 DC    C'RELFILE PROCESS ERROR   '
@CC01539 DC    C'RELFILES NOT PROCESSED  '
@CC01542 DC    C'NOT FOUND ON SMPPTFIN   '
@CC01545 DC    C'*NO SYSMODS PROCESSED*  '
@CC01502 DC    C'RECEIVED '
@CC01505 DC    C'NOT RECVD'
@CC01508 DC    C'PTF     '
@CC01510 DC    C'FUNCTION'
@CC01512 DC    C'USERMOD '
@CC01514 DC    C'APAR    '
@CC01516 DC    C'UNKNOWN '
         DS    CL2
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00179 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00180 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
PRL      DS    CL141
MYIOP    DS    CL68
RCLFLGS1 DS    BL1
         ORG   RCLFLGS1
MSGOUT   DS    BL1
@NM00187 EQU   RCLFLGS1+0
         ORG   RCLFLGS1+1
VPART#1  DS    CL8
PTSPEMAX DS    CL1
ADDED    DS    CL1
FOUND    DS    CL1
MSGSYS   DC    CL8'SYSTEM  '
MSGENT   DC    CL8'ENTRY   '
MSGPTS   DC    CL8'SMPPTS  '
MSGFMID  DC    CL8'FMID    '
         DS    CL1
PATCHRCL DS    CL80
         ORG   PATCHRCL
@NM00188 DC    80X'FF'
         ORG   PATCHRCL+80
MAINHEAD DS    CL121
         ORG   MAINHEAD
@NM00189 DC    CL26' '
@NM00190 DC    CL9'RECEIVE  '
@NM00191 DC    CL9'SUMMARY  '
@NM00192 DC    CL6'REPORT'
@NM00193 DC    71CL1' '
         ORG   MAINHEAD+121
SECHEAD  DS    CL121
         ORG   SECHEAD
@NM00194 DC    CL6' '
@NM00195 DC    CL7'SYSMOD '
@NM00196 DC    CL2'  '
@NM00197 DC    CL9'STATUS   '
@NM00198 DC    CL2' '
@NM00199 DC    CL8'TYPE    '
@NM00200 DC    CL2' '
@NM00201 DC    CL24'------------------------'
@NM00202 DC    61CL1' '
         ORG   SECHEAD+121
HEADPTR  DC    AL4(MAINHEAD)
         DC    A(0)
         DC    A(0)
         DC    AL4(SECHEAD)
         DC    A(0)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
REG15    EQU   @15
RTNCODE  EQU   @15
RTNREG   EQU   @14
GSMREC   EQU   0
GSMKEY   EQU   GSMREC
GSMS#    EQU   GSMKEY
GSMSTY   EQU   GSMKEY+7
GSMSTAT1 EQU   GSMREC+15
GSMUSR   EQU   GSMSTAT1
GSMSYNTX EQU   GSMSTAT1
GSMRCVD  EQU   GSMSTAT1
GSMEXCL  EQU   GSMSTAT1
GSMNAVER EQU   GSMSTAT1
GSMSIOE  EQU   GSMSTAT1
GSMLERR  EQU   GSMSTAT1
GSMNFND  EQU   GSMSTAT1+1
GSMSTAT2 EQU   GSMREC+17
GSMRECVD EQU   GSMSTAT2
GSMRLFP  EQU   GSMSTAT2
GSMRLFL  EQU   GSMSTAT2
GSMSEL   EQU   GSMSTAT2
GSRREC   EQU   0
GSRKEY   EQU   GSRREC
GRFREC   EQU   0
GRFKEY   EQU   GRFREC
GRFFLGS  EQU   GRFREC+19
GPSREC   EQU   0
GPSKEY   EQU   GPSREC
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCAPEMAX EQU   CCAFSYS+10
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00017 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCARPTDS EQU   CCAFCTL+7
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00033 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00035 EQU   CCABLDLL
CCALKDRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00039+20
@NM00041 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00047+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00051 EQU   HMASMIOP+12
@NM00052 EQU   @NM00051
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00162 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMSCP EQU   0
SCPCHAR  EQU   HMASMSCP
SCPIOPAD EQU   HMASMSCP+16
SCPEOR   EQU   HMASMSCP+24
SCPRETRN EQU   HMASMSCP+25
HMASMPRL EQU   0
PRLRLEN  EQU   HMASMPRL
PRLSPAN  EQU   HMASMPRL+2
PRLFLGS  EQU   PRLSPAN
PRLHEAD  EQU   PRLFLGS
PRLHEADO EQU   PRLFLGS
PRLBLANK EQU   PRLFLGS
PRLDATE  EQU   HMASMPRL+4
PRLHDADR EQU   PRLDATE
PRLTIME  EQU   HMASMPRL+7
PRLEND   EQU   HMASMPRL+10
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPWKAD  EQU   HMASMGTP+8
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
SCPIOPRM EQU   0
SCPSTRNG EQU   0
RECXPARM EQU   0
RECXFLGS EQU   RECXPARM+8
RECXFLG1 EQU   RECXFLGS
RECXFLG2 EQU   RECXFLGS+1
RECXFLG3 EQU   RECXFLGS+2
RECXFLG4 EQU   RECXFLGS+3
RECXIOPS EQU   RECXPARM+12
RECXIOPG EQU   RECXIOPS+8
RECXMAX  EQU   RECXPARM+28
RECXGSMP EQU   RECXPARM+40
RECXGPSP EQU   RECXPARM+52
MSGCODE1 EQU   0
MSGCODE2 EQU   0
MSGCODE3 EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00058 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00069 EQU   IOPUDATA
@NM00070 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00079 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00090 EQU   IOPSRCDR+1
@NM00092 EQU   @NM00090+7
@NM00096 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00100 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00106 EQU   IOPMODDR+1
@NM00108 EQU   @NM00106+7
@NM00112 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00116 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00127 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00134 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00143 EQU   IOPPTFFX
@NM00144 EQU   @NM00143
IOPPDTES EQU   IOPPTFFX+41
@NM00147 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00172 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00172
IOPPTREL EQU   IOPPTFMD
IOPPTSND EQU   IOPPTREL
IOPPTIND EQU   IOPPTNTR+8
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00176 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00176
IOPBFTB1 EQU   IOPBFTB0
PRLDATA  EQU   PRLEND
DATALINE EQU   PRLDATA
SYSMODID EQU   DATALINE+5
RECVSTAT EQU   DATALINE+14
TYPE     EQU   DATALINE+25
RECVINFO EQU   DATALINE+35
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00207 EQU   DATALINE+59
@NM00206 EQU   DATALINE+33
@NM00205 EQU   DATALINE+23
@NM00204 EQU   DATALINE+12
@NM00203 EQU   DATALINE
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00178 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00177 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00175 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00174 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00173 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
@NM00171 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00170 EQU   IOPPTSFX+35
@NM00169 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00168 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00167 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00166 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00165 EQU   IOPQFMDR
@NM00161 EQU   IOPQSMDR
@NM00160 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00159 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00158 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00157 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00156 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00155 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00154 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00153 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00152 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00151 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00150 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00149 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00148 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00147+3
IOPRECD  EQU   @NM00147
@NM00146 EQU   IOPPTFFX+8
@NM00145 EQU   @NM00143+7
IOPPRELN EQU   @NM00144
@NM00142 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00141 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00140 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00139 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00138 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00137 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00136 EQU   @NM00134+7
@NM00135 EQU   @NM00134
@NM00133 EQU   IOPSYSDR+5
@NM00132 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00131 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00130 EQU   IOPDLBFX+8
@NM00129 EQU   @NM00127+7
@NM00128 EQU   @NM00127
@NM00126 EQU   IOPDLBDR+1
@NM00125 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00124 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00123 EQU   IOPMODFX+12
@NM00122 EQU   IOPMODF4
@NM00121 EQU   IOPMODF3
@NM00120 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00119 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00118 EQU   @NM00116+7
@NM00117 EQU   @NM00116
@NM00115 EQU   IOPMODDR+17
@NM00114 EQU   @NM00112+7
@NM00113 EQU   @NM00112
@NM00111 EQU   @NM00108
@NM00110 EQU   @NM00108
@NM00109 EQU   @NM00108
@NM00107 EQU   @NM00106
@NM00105 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00104 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00103 EQU   IOPSRCFX+8
@NM00102 EQU   @NM00100+7
@NM00101 EQU   @NM00100
@NM00099 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00098 EQU   @NM00096+7
@NM00097 EQU   @NM00096
@NM00095 EQU   @NM00092
@NM00094 EQU   @NM00092
@NM00093 EQU   @NM00092
@NM00091 EQU   @NM00090
@NM00089 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00088 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00087 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00086 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00085 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00084 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00083 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00081 EQU   @NM00079+7
@NM00080 EQU   @NM00079
@NM00078 EQU   IOPLMDDR+6
@NM00077 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00076 EQU   IOPLMDF4
@NM00075 EQU   IOPLMDF3
@NM00074 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00073 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00072 EQU   IOPLMDDR
@NM00071 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00070+4
IOPUSED  EQU   @NM00070
IOPTPSEQ EQU   @NM00069+8
IOPVLSER EQU   @NM00069+2
IOPBLKSI EQU   @NM00069
IOPCQMAX EQU   IOPCQMAP+12
@NM00068 EQU   IOPCQMAP+11
@NM00067 EQU   IOPCQMAP+8
@NM00066 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00065 EQU   IOPSCMAP+11
@NM00064 EQU   IOPSCMAP+8
@NM00063 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00062 EQU   IOPNTMAX+11
@NM00061 EQU   IOPNTMAX+8
@NM00060 EQU   IOPNTMAX
@NM00059 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00058+5
IOPIPTF3 EQU   @NM00058
RECXDSPC EQU   RECXPARM+74
RECXRELM EQU   RECXPARM+72
RECXRCUR EQU   RECXPARM+70
RECXRNXT EQU   RECXPARM+68
RECXRFLE EQU   RECXPARM+66
RECXSEQ# EQU   RECXPARM+64
RECXSCNT EQU   RECXPARM+62
RECXCNT  EQU   RECXPARM+60
RECXMNDX EQU   RECXPARM+56
RECXGRFP EQU   RECXPARM+48
RECXGSRP EQU   RECXPARM+44
RECXPPTR EQU   RECXPARM+36
RECXMCB  EQU   RECXPARM+32
RECXLAST EQU   RECXPARM+24
RECXIOPP EQU   RECXIOPS+4
RECXIOPT EQU   RECXIOPS
@NM00005 EQU   RECXFLG4
@NM00004 EQU   RECXFLG3
RECXPELM EQU   RECXFLG3
RECXPUPD EQU   RECXFLG3
RECXTXTF EQU   RECXFLG3
RECXPTXT EQU   RECXFLG3
RECXPIFS EQU   RECXFLG3
RECXPVER EQU   RECXFLG3
@NM00003 EQU   RECXFLG2
RECXELEF EQU   RECXFLG2
RECXJCLF EQU   RECXFLG2
RECXAVER EQU   RECXFLG2
RECXVERF EQU   RECXFLG2
@NM00002 EQU   RECXFLG1
RECXEXC  EQU   RECXFLG1
RECXSEL  EQU   RECXFLG1
RECXSYSS EQU   RECXFLG1
RECXSYSF EQU   RECXFLG1
RECXPEOF EQU   RECXFLG1
RECXSYSM EQU   RECXFLG1
RECXPROC EQU   RECXFLG1
@NM00001 EQU   RECXPARM
@NM00186 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00185 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPKEYLN EQU   HMASMGTP+6
GTPRCDLN EQU   HMASMGTP+4
@NM00184 EQU   HMASMGTP+2
PRLCONC  EQU   PRLTIME+2
@NM00183 EQU   PRLTIME
@NM00182 EQU   PRLFLGS
SCPRET   EQU   SCPRETRN
@NM00181 EQU   SCPEOR
SCPNORT  EQU   SCPEOR
SCPNOSUC EQU   SCPEOR
SCPRTERR EQU   SCPEOR
SCPCOMNT EQU   SCPEOR
SCPNOCT  EQU   SCPEOR
SCPCONT  EQU   SCPEOR
SCPPMLN  EQU   HMASMSCP+22
SCPINLN  EQU   HMASMSCP+20
SCPIORTN EQU   HMASMSCP+12
SCPWKAR  EQU   HMASMSCP+8
SCPSRCH  EQU   HMASMSCP+4
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00164 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00163 EQU   @NM00162+7
IOPQSMFM EQU   @NM00162
@NM00082 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00057 EQU   IOPUSERL
@NM00056 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00055 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00054 EQU   @NM00051+10
IOPSEQNO EQU   @NM00051+8
@NM00053 EQU   @NM00052+7
IOPPTFNM EQU   @NM00052
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00050 EQU   CCABLDLM+2
@NM00049 EQU   CCABLDLM
CCAUPDPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00047+12
CCAUPDTE EQU   @NM00047+8
CCAUPDNM EQU   @NM00047
CCASUPPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00045+12
CCAIOSUP EQU   @NM00045+8
CCASUPNM EQU   @NM00045
CCAZAPPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00043+12
CCASPZAP EQU   @NM00043+8
CCAZAPNM EQU   @NM00043
CCACOMPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00041+12
CCACOMRS EQU   @NM00041+8
CCACOMNM EQU   @NM00041
CCACPYPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00039+12
CCACOPY  EQU   @NM00039+8
CCACPYNM EQU   @NM00039
CCAASMPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00037+12
CCAASM   EQU   @NM00037+8
CCAASMNM EQU   @NM00037
CCALKDPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00035+12
CCALKED  EQU   @NM00035+8
CCALKDNM EQU   @NM00035
CCAPGMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCABPGRC EQU   @NM00033+20
CCABPGSP EQU   @NM00033+12
CCABPGAD EQU   @NM00033+8
CCABPGNM EQU   @NM00033
CCAEND   EQU   HMASMCCA+371
@NM00032 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00031 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00030 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00029 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00028 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00027 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00026 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00025 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00024 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00023 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00022 EQU   @NM00017+18
@NM00021 EQU   @NM00017+16
CCATBLPA EQU   @NM00017+12
@NM00020 EQU   @NM00017+8
@NM00019 EQU   @NM00017+4
@NM00018 EQU   @NM00017
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00016 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00015 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00014 EQU   CCAFBUFR+122
@NM00013 EQU   CCAFBUFR+120
@NM00012 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00011 EQU   CCAFBUFR+88
@NM00010 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00009 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
GPSENT   EQU   GPSKEY+1
GPSTYPE  EQU   GPSKEY
GRFRELF  EQU   GRFREC+22
GRFRELF# EQU   GRFREC+20
@NM00008 EQU   GRFFLGS
GRFLOADD EQU   GRFFLGS
GRFFLUSH EQU   GRFFLGS
GRFSTY   EQU   GRFREC+18
GRFSM#   EQU   GRFREC+11
GRFELTY  EQU   GRFKEY+10
GRFELEM  EQU   GRFKEY+2
GRFFSEQ  EQU   GRFKEY
GSRFMID  EQU   GSRKEY+4
GSRSREL  EQU   GSRKEY
@NM00007 EQU   GSMSTAT2
@NM00006 EQU   GSMSTAT1+1
GSMHPRT  EQU   GSMSTAT1+1
GSMCERR  EQU   GSMSTAT1+1
GSMRERR  EQU   GSMSTAT1+1
GSMRDUP  EQU   GSMSTAT1
GSMFMID  EQU   GSMREC+8
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00405 EQU   @RC00370
@RF00460 EQU   @EL00002
@RC00458 EQU   @EL00002
@RC00456 EQU   @EL00002
@RC00454 EQU   @EL00002
@ENDDATA EQU   *
         END   HMASMRCL,(C'PLS2109',0802,78334)

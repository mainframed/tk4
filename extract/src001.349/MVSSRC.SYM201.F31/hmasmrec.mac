         TITLE 'HMASMREC - RECEIVE SYSMOD PROCESSOR'
HMASMREC CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMREC  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @08,0                                               0001
@PSTART  LA    @09,4095(,@08)                                      0001
         LA    @10,4095(,@09)                                      0001
         LA    @12,4095(,@10)                                      0001
         USING @PSTART,@08                                         0001
         USING @PSTART+4095,@09                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@12                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0279
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DATA AREAS FOR RECEIVE PROCESSING                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0279
*                                                                  0279
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PROCESS CONTROL FLAGS, ETC                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0279
*   RECLFLGS=''B;                   /* CLEAR ALL FIELDS IN RECLFLGS  */
         MVI   RECLFLGS,X'00'                                      0279
*   RECXPARM=''B;                   /* CLEAR ALL FIELDS IN RECXPARM  */
         XC    RECXPARM(80),RECXPARM                               0280
*   RECXPPTR=ADDR(RECPARM);         /* INITIALIZE PTR TO RECPARM     */
         L     @15,@PC00001                                        0281
         ST    @15,RECXPPTR                                        0281
*   IF RECSEL=ON THEN                                              0282
         TM    RECSEL(@15),B'10000000'                             0282
         BNO   @RF00282                                            0282
*     RECXSEL=ON;                   /* RECEIVE "SELECT" FLAG         */
         OI    RECXSEL,B'00000100'                                 0283
*   IF RECEXC=ON THEN                                              0284
@RF00282 L     @15,@PC00001                                        0284
         TM    RECEXC(@15),B'01000000'                             0284
         BNO   @RF00284                                            0284
*     RECXEXC=ON;                   /* RECEIVE "EXCLUDE" FLAG        */
         OI    RECXEXC,B'00000010'                                 0285
*   RECXMAX=ZERO;                   /* INITIALIZE RETURN CODE      0286
*                                      COLLECTOR                     */
@RF00284 SLR   @15,@15                                             0286
         ST    @15,RECXMAX                                         0286
*   RECXPROC=GO;                    /* INITIALIZE PROCESS CONTROL  0287
*                                      FLAG                          */
         OI    RECXPROC,B'10000000'                                0287
*   RECXSEQ#=0;                     /* SUMMARY FILE SEQUENCE NUMBER  */
         STH   @15,RECXSEQ#                                        0288
*   RECXCNT=0;                      /* RECEIVED SYSMOD COUNT         */
         STH   @15,RECXCNT                                         0289
*   RECXSCNT=0;                     /* SELECTED SYSMOD COUNT         */
         STH   @15,RECXSCNT                                        0290
*   RECXRCUR=0;                     /* ABSOLUTE FILE SEQUENCE NUMBER
*                                      OF 1ST FILE OF CURRENT SYSMOD */
         STH   @15,RECXRCUR                                        0291
*   RECXRNXT=0;                     /* ABSOLUTE FILE SEQUENCE NUMBER
*                                      OF 1ST FILE OF NEXT SYSMOD    */
         STH   @15,RECXRNXT                                        0292
*   RECXRFLE=0;                     /* NUMBER OF FILES IN CURRENT  0293
*                                      SYSMOD                        */
         STH   @15,RECXRFLE                                        0293
*   RECXMNDX=0;                     /* COUNT OF ELEMENTS IN CURRENT
*                                      SYSMOD                        */
         ST    @15,RECXMNDX                                        0294
*   MCSCHECK=ON;                    /* CHECK MOD.CNTL.STMTS.         */
         OI    MCSCHECK,B'00000010'                                0295
*   MPDRETRN=0;                     /* CLEAR LAST PARSED CNTRL STMT
*                                      RETURN CODE HOLDER            */
         ST    @15,MPDRETRN                                        0296
*   VPARTS=' ';                     /* BLANK MSG VARIABLE PART SAVE
*                                      AREA                          */
         MVI   VPARTS+1,C' '                                       0297
         MVC   VPARTS+2(22),VPARTS+1                               0297
         MVI   VPARTS,C' '                                         0297
*                                                                  0298
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMMSG PARM INITIALIZATION                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0298
*   HMASMMGP=''B;                   /* CLEAR MGP                     */
         XC    HMASMMGP(28),HMASMMGP                               0298
*   MGPHLDS=ON;                     /* MESSAGES TO LOG               */
*   MGPPRINT=ON;                    /* SET FOR MSG TO PRINTER        */
*                                                                  0300
         OI    MGPHLDS,B'10010000'                                 0300
*   /*****************************************************************/
*   /*                                                               */
*   /* GET CORE FOR, SET UP ADDRESSIBILITY TO AND INITIALIZE         */
*   /* WORKAREAS                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0301
*                                                                  0301
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SUMMARY GTA FILE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0301
*   RESPECIFY                                                      0301
*     GSMREC BASED(ADDR(GTASM));    /* SUMMARY RECORD BUFFER         */
*   RECXGSMP=ADDR(GTPSM);           /* SUMMARY GTP                   */
         LA    @14,GTPSM                                           0302
         ST    @14,RECXGSMP                                        0302
*   RESPECIFY                                                      0303
*     HMASMGTP BASED(RECXGSMP);     /* SUMMARY GTP                   */
*   HMASMGTP=''B;                   /* SUMMARY FILE                  */
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0304
*   GTPRCDLN=LENGTH(GSMREC);        /* RECORD LENGTH                 */
         MVC   GTPRCDLN(2,@14),@CH00593                            0305
*   GTPKEYLN=LENGTH(GSMKEY);        /* KEY LENGTH                    */
         LA    @07,8                                               0306
         STH   @07,GTPKEYLN(,@14)                                  0306
*   GTPBUFAD=ADDR(GTASM);           /* BUFFER FOR SUMMARY RECORD     */
         LA    @06,GTASM                                           0307
         ST    @06,GTPBUFAD(,@14)                                  0307
*   GSMREC=''B;                     /* CLEAR THE SUMMARY RECORD      */
*                                                                  0308
         XC    GSMREC(18,@06),GSMREC(@06)                          0308
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SREL/FMID GTA FILE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*   RESPECIFY                                                      0309
*     GSRREC BASED(ADDR(GTASR));    /* SREL/FMID RECORD BUFFER       */
*   RECXGSRP=ADDR(GTPSR);           /* SREL/FMID GTP                 */
         LA    @14,GTPSR                                           0310
         ST    @14,RECXGSRP                                        0310
*   RESPECIFY                                                      0311
*     HMASMGTP BASED(RECXGSRP);     /* SREL/FMID GTP                 */
*   HMASMGTP=''B;                   /* SREL/FMID FILE                */
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0312
*   GTPRCDLN=LENGTH(GSRREC);        /* RECORD LENGTH                 */
         LA    @06,11                                              0313
         STH   @06,GTPRCDLN(,@14)                                  0313
*   GTPKEYLN=LENGTH(GSRKEY);        /* KEY LENGTH                    */
         STH   @06,GTPKEYLN(,@14)                                  0314
*   GTPBUFAD=ADDR(GTASR);           /* BUFFER                        */
*                                                                  0315
         LA    @05,GTASR                                           0315
         ST    @05,GTPBUFAD(,@14)                                  0315
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RELFILE GTA FILE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0316
*   RESPECIFY                                                      0316
*     GRFREC BASED(ADDR(GTARF));    /* RELFILE RECORD BUFFER         */
*   RECXGRFP=ADDR(GTPRF);           /* RELFILE GTP                   */
         LA    @14,GTPRF                                           0317
         ST    @14,RECXGRFP                                        0317
*   RESPECIFY                                                      0318
*     HMASMGTP BASED(RECXGRFP);     /* RELFILE GTP                   */
*   HMASMGTP=''B;                   /* RELFILE FILE                  */
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0319
*   GTPRCDLN=LENGTH(GRFREC);        /* RECORD LENGTH                 */
         MVC   GTPRCDLN(2,@14),@CH00608                            0320
*   GTPKEYLN=LENGTH(GRFKEY);        /* KEY LENGTH                    */
         STH   @06,GTPKEYLN(,@14)                                  0321
*   GTPBUFAD=ADDR(GTARF);           /* BUFFER                        */
*                                                                  0322
         LA    @06,GTARF                                           0322
         ST    @06,GTPBUFAD(,@14)                                  0322
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PTS SYSTEM ENTRY GTA FILE                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0323
*   RESPECIFY                                                      0323
*     GPSREC BASED(ADDR(GTAPS));    /* PTS SYS RECORD BUFFER         */
*   RECXGPSP=ADDR(GTPPS);           /* PTS SYSTEM ENTRY GTP          */
         LA    @14,GTPPS                                           0324
         ST    @14,RECXGPSP                                        0324
*   RESPECIFY                                                      0325
*     HMASMGTP BASED(RECXGPSP);     /* PTS SYSTEM ENTRY GTP          */
*   HMASMGTP=''B;                   /* PTS SYSTEM ENTRY FILE         */
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0326
*   GTPRCDLN=LENGTH(GPSREC);        /* RECORD LENGTH                 */
         STH   @07,GTPRCDLN(,@14)                                  0327
*   GTPKEYLN=LENGTH(GPSKEY);        /* KEY LENGTH                    */
         STH   @07,GTPKEYLN(,@14)                                  0328
*   GTPBUFAD=ADDR(GTAPS);           /* BUFFER                        */
*                                                                  0329
         LA    @07,GTAPS                                           0329
         ST    @07,GTPBUFAD(,@14)                                  0329
*   /*****************************************************************/
*   /*                                                               */
*   /* RECOVERY PARM INITIALIZATION                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0330
*   RESPECIFY                                                      0330
*     RVAPARM BASED(CCARVAD);       /* ADDRESS RVA                   */
*   RVAREC=ADDR(RECXPARM);          /* PUT IN PTR TO RECXPARM        */
*                                                                  0331
         L     @01,CCARVAD(,CCAPTR)                                0331
         LA    @00,RECXPARM                                        0331
         ST    @00,RVAREC(,@01)                                    0331
*   /*****************************************************************/
*   /*                                                               */
*   /* GET CORE FOR MCB FOR USE BY HMASMMPD                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0332
*   RECXMCB=0;                      /* CLEAR PTR TO MCB              */
         ST    @15,RECXMCB                                         0332
*   IF RECXMAX<STOPFUNC THEN                                       0333
         L     @15,RECXMAX                                         0333
         CH    @15,@CH00036                                        0333
         BNL   @RF00333                                            0333
*     DO;                                                          0334
*       SPLFUNCT=SPLGMIOP;          /* GETMAIN IOP FUNCTION          */
         MVI   SPLFUNCT,X'03'                                      0335
*       CALL HMASMSUB(HMASMSPL);                                   0336
         L     @15,@CV01709                                        0336
         LA    @01,@AL00336                                        0336
         BALR  @14,@15                                             0336
*       RESPECIFY                                                  0337
*         REG15 RSTD;                                              0337
*       IF REG15^=0 THEN                                           0338
         LTR   REG15,REG15                                         0338
         BZ    @RF00338                                            0338
*         DO;                                                      0339
*                                                                  0339
*           /*********************************************************/
*           /*                                                       */
*           /* INSUFFICIENT STORAGE ... STOP RECEIVE                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0340
*           RFY                                                    0340
*             REG15 UNRSTD;                                        0340
*           RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE ERROR            */
         L     @15,RECXMAX                                         0341
         LA    @14,12                                              0341
         CR    @15,@14                                             0341
         BNL   *+6
         LR    @15,@14                                             0341
         ST    @15,RECXMAX                                         0341
*         END;                                                     0342
*       ELSE                                                       0343
*         DO;                                                      0343
         B     @RC00338                                            0343
@RF00338 DS    0H                                                  0344
*           RECXMCB=SPLPMAD;        /* SET UP ADDRESSIBILITY FOR MCB
*                                      CORE UPON WHICH ALL MCB TYPES
*                                      ARE MAPPED                    */
         L     @15,SPLPMAD                                         0344
         ST    @15,RECXMCB                                         0344
*           RECXMCB->HMASMIOP=''B;  /* CLEAR MCB                     */
         XC    HMASMIOP(68,@15),HMASMIOP(@15)                      0345
*         END;                                                     0346
*     END;                                                         0347
@RC00338 DS    0H                                                  0348
*   RESPECIFY                                                      0348
*     MCBPTFMP BASED(RECXMCB);      /* SYSMOD HEADER MCB             */
@RF00333 DS    0H                                                  0349
*   RESPECIFY                                                      0349
*     MCBVERMP BASED(RECXMCB);      /* ++VER MCB                     */
*   RESPECIFY                                                      0350
*     MCBIFMP BASED(RECXMCB);       /* ++IF MCB                      */
*   RESPECIFY                                                      0351
*     MCBELEMP BASED(RECXMCB);      /* ++ELEM MCB                    */
*                                                                  0351
*   /*****************************************************************/
*   /*                                                               */
*   /* GET PTS SYSMOD ENTRY IOP                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0352
*   RECXIOPP=0;                     /* CLEAR PTR TO IOP              */
         SLR   @15,@15                                             0352
         ST    @15,RECXIOPP                                        0352
*   IF RECXMAX<STOPFUNC THEN                                       0353
         L     @15,RECXMAX                                         0353
         CH    @15,@CH00036                                        0353
         BNL   @RF00353                                            0353
*     DO;                                                          0354
*       SPLFUNCT=SPLGMIOP;          /* GETMAIN IOP FUNCTION          */
         MVI   SPLFUNCT,X'03'                                      0355
*       CALL HMASMSUB(HMASMSPL);                                   0356
         L     @15,@CV01709                                        0356
         LA    @01,@AL00356                                        0356
         BALR  @14,@15                                             0356
*       RESPECIFY                                                  0357
*         REG15 RSTD;                                              0357
*       IF REG15^=0 THEN                                           0358
         LTR   REG15,REG15                                         0358
         BZ    @RF00358                                            0358
*         DO;                                                      0359
*                                                                  0359
*           /*********************************************************/
*           /*                                                       */
*           /* INSUFFICIENT STORAGE ... STOP RECEIVE                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0360
*           RFY                                                    0360
*             REG15 UNRSTD;                                        0360
*           RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE ERROR            */
         L     @15,RECXMAX                                         0361
         LA    @14,12                                              0361
         CR    @15,@14                                             0361
         BNL   *+6
         LR    @15,@14                                             0361
         ST    @15,RECXMAX                                         0361
*         END;                                                     0362
*       ELSE                                                       0363
*         DO;                                                      0363
         B     @RC00358                                            0363
@RF00358 DS    0H                                                  0364
*           RECXIOPP=SPLPMAD;       /* PTS SYSMOD IOP                */
         L     @15,SPLPMAD                                         0364
         ST    @15,RECXIOPP                                        0364
*           RECXIOPP->HMASMIOP=''B; /* CLEAR IOP                     */
         XC    HMASMIOP(68,@15),HMASMIOP(@15)                      0365
*           RECXIOPP->IOPDSID=IOPPTS;/* DATASET IS SMPPTS            */
         MVI   IOPDSID(@15),X'06'                                  0366
*           RECXIOPP->IOPTYPE=IOPSMD;/* ENTRY TYPE IS "SMD"          */
         MVI   IOPTYPE(@15),X'0B'                                  0367
*           RECXIOPP->IOPFUNCT=IOPOPEN;/* CHECKED BY HMASMRCF        */
         MVI   IOPFUNCT(@15),X'00'                                 0368
*           RECXIOPP->IOPNAME=' ';  /* BLANK ENTRY NAME              */
         MVI   IOPNAME+1(@15),C' '                                 0369
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0369
         MVI   IOPNAME(@15),C' '                                   0369
*           RECXIOPP->IOPRETRN=ZERO;/* CLEAR RETURN CODE FIELD       */
         MVI   IOPRETRN(@15),X'00'                                 0370
*           RECXIOPP->IOPPTFNT=''B; /* CLEAR IOPUDATA PORTION        */
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0371
*           RECXIOPP->IOPNTLVL=IOPPTFLC;/* SET ENTRY LEVEL           */
         MVI   IOPNTLVL(@15),X'02'                                 0372
*           RECXIOPP->IOPPTFND(1)=IOPEOLST;/* SET END-OF-LIST        */
         MVI   IOPPTFND(@15),X'FF'                                 0373
*         END;                                                     0374
*     END;                                                         0375
*                                                                  0375
@RC00358 DS    0H                                                  0376
*   /*****************************************************************/
*   /*                                                               */
*   /* GET PTS MCS ENTRY IOP                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0376
*   RECXIOPT=0;                     /* CLEAR PTR TO IOP              */
@RF00353 SLR   @15,@15                                             0376
         ST    @15,RECXIOPT                                        0376
*   IF RECXMAX<STOPFUNC THEN                                       0377
         L     @15,RECXMAX                                         0377
         CH    @15,@CH00036                                        0377
         BNL   @RF00377                                            0377
*     DO;                                                          0378
*       SPLFUNCT=SPLGMIOP;          /* GETMAIN IOP FUNCTION          */
         MVI   SPLFUNCT,X'03'                                      0379
*       CALL HMASMSUB(HMASMSPL);                                   0380
         L     @15,@CV01709                                        0380
         LA    @01,@AL00380                                        0380
         BALR  @14,@15                                             0380
*       RESPECIFY                                                  0381
*         REG15 RSTD;                                              0381
*       IF REG15^=0 THEN                                           0382
         LTR   REG15,REG15                                         0382
         BZ    @RF00382                                            0382
*         DO;                                                      0383
*                                                                  0383
*           /*********************************************************/
*           /*                                                       */
*           /* INSUFFICIENT STORAGE ... STOP RECEIVE                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0384
*           RFY                                                    0384
*             REG15 UNRSTD;                                        0384
*           RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE ERROR            */
         L     @15,RECXMAX                                         0385
         LA    @14,12                                              0385
         CR    @15,@14                                             0385
         BNL   *+6
         LR    @15,@14                                             0385
         ST    @15,RECXMAX                                         0385
*         END;                                                     0386
*       ELSE                                                       0387
*         DO;                                                      0387
         B     @RC00382                                            0387
@RF00382 DS    0H                                                  0388
*           RECXIOPT=SPLPMAD;       /* PTS TEXT IOP                  */
         L     @15,SPLPMAD                                         0388
         ST    @15,RECXIOPT                                        0388
*           RECXIOPT->HMASMIOP=''B; /* CLEAR IOP                     */
         XC    HMASMIOP(68,@15),HMASMIOP(@15)                      0389
*           RECXIOPT->IOPDSID=IOPPTS;/* DATASET IS SMPPTS            */
         MVI   IOPDSID(@15),X'06'                                  0390
*           RECXIOPT->IOPTYPE=IOPMCS;/* ENTRY TYPE IS "MCS"          */
         MVI   IOPTYPE(@15),X'10'                                  0391
*           RECXIOPT->IOPNAME=' ';  /* BLANK ENTRY NAME              */
         MVI   IOPNAME+1(@15),C' '                                 0392
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0392
         MVI   IOPNAME(@15),C' '                                   0392
*           RECXIOPT->IOPFUNCT=IOPOPEN;/* CHECKED BY HMASMRCF        */
         MVI   IOPFUNCT(@15),X'00'                                 0393
*           RECXIOPT->IOPRETRN=ZERO;/* CLEAR RETURN CODE FIELD       */
         MVI   IOPRETRN(@15),X'00'                                 0394
*           RECXIOPT->IOPPTFNT=''B; /* CLEAR IOPUDATA PORTION        */
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0395
*           RECXIOPT->IOPNTLVL=IOPPTFLC;/* SET ENTRY LEVEL           */
         MVI   IOPNTLVL(@15),X'02'                                 0396
*         END;                                                     0397
*     END;                                                         0398
*                                                                  0398
@RC00382 DS    0H                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /* CCAIOP USED AS THE GENERAL USE IOP                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   SAVBUFAD=CCAIOPTR->IOPBUFAD;    /* SAVE IOPBUFAD BEFORE USE      */
@RF00377 L     @15,CCAIOPTR(,CCAPTR)                               0399
         MVC   SAVBUFAD(4),IOPBUFAD(@15)                           0399
*   RECXIOPG=CCAIOPTR;              /* GENERAL USE IOP               */
         ST    @15,RECXIOPG                                        0400
*   RECXIOPG->HMASMIOP=''B;         /* CLEAR IOP                     */
         XC    HMASMIOP(68,@15),HMASMIOP(@15)                      0401
*   RECXIOPG->IOPNAME=' ';          /* BLANK ENTRY NAME              */
         MVI   IOPNAME+1(@15),C' '                                 0402
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0402
         MVI   IOPNAME(@15),C' '                                   0402
*   RECXIOPG->IOPPTFNT=''B;         /* CLEAR IOPUDATA PORTION        */
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0403
*   RECXIOPG->IOPNTLVL=IOPPTFLC;    /* SET ENTRY LEVEL               */
*                                                                  0404
         MVI   IOPNTLVL(@15),X'02'                                 0404
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMSCN PARAMETER INITIALIZATION (HMASMSCP)                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0405
*   SCPPTR=ADDR(SCPSTORE);          /* SET TO STORAGE ALLOCATED FOR
*                                      SCP                           */
         LA    @14,SCPSTORE                                        0405
         ST    @14,SCPPTR                                          0405
*   HMASMSCP=''B;                   /* CLEAR SCP                     */
         XC    HMASMSCP(26,@14),HMASMSCP(@14)                      0406
*   SCPCOMNT=ON;                    /* SET SKIP-BY COMMENTS DURING 0407
*                                      SCAN                          */
         OI    SCPCOMNT(@14),B'00100000'                           0407
*   SCPINLN=LENGTH(CRPBUFFR);       /* BUFFER IN CRD PARM LIST       */
         MVC   SCPINLN(2,@14),@CH00429                             0408
*   SCPIORTN=ADDR(HMASMCRD);        /* FOR ADDITIONAL RECORDS DURING
*                                      SCAN GO HERE                  */
         L     @07,@CV01708                                        0409
         ST    @07,SCPIORTN(,@14)                                  0409
*   SCPIOPAD=ADDR(HMASMCRP);        /* PARM LIST FOR HMASMCRD        */
*                                                                  0410
         LA    @07,HMASMCRP                                        0410
         ST    @07,SCPIOPAD(,@14)                                  0410
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMCRD PARAMETER (HMASMCRP) INITIALIZATION                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*   HMASMCRP=''B;                   /* CLEAR THE CRP                 */
         XC    HMASMCRP(106),HMASMCRP                              0411
*   CRPUXNUM=UXPUX001;              /* SET RECEIVE USER EXIT         */
         MVI   CRPUXNUM,X'01'                                      0412
*   CRPSCPAD=SCPPTR;                /* SCP ADDRESS                   */
         ST    @14,CRPSCPAD                                        0413
*   CRPINDS=IOPPTFIN;               /* INPUT DATASET (SMPPTFIN)      */
         MVI   CRPINDS,X'0A'                                       0414
*   CRPOFFST=ON;                    /* OFFSET LINES TO SMPOUT        */
*                                                                  0415
         OI    CRPOFFST,B'00000010'                                0415
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMMPD PARAMETER INITIALIZATION (MPPPARM)                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*   MPPPARM=''B;                    /* CLEAR MPPPARM PARM BLOCK      */
         XC    MPPPARM(23),MPPPARM                                 0416
*   MPPIOPAD=RECXIOPP;              /* PTS PTF IOP ADDRESS           */
         MVC   MPPIOPAD(4),RECXIOPP                                0417
*   MPPMCBAD=RECXMCB;               /* ADDRESS OF MCB TO BE FILLED   */
         MVC   MPPMCBAD(4),RECXMCB                                 0418
*   MPPCRDAD=ADDR(HMASMCRD);        /* GET ROUTINE FOR USE BY MPD    */
         L     @14,@CV01708                                        0419
         ST    @14,MPPCRDAD                                        0419
*   MPPCRDPM=ADDR(HMASMCRP);        /* GET ROUTINE PARM LIST         */
         LA    @14,HMASMCRP                                        0420
         ST    @14,MPPCRDPM                                        0420
*   IF RECXMAX<STOPFUNC THEN                                       0421
         L     @14,RECXMAX                                         0421
         CH    @14,@CH00036                                        0421
         BNL   @RF00421                                            0421
*     DO;                                                          0422
*                                                                  0422
*       /*************************************************************/
*       /*                                                           */
*       /* ACCESS THE PTS SYSTEM ENTRY AND EXTRACT DATA PERTINENT TO */
*       /* RECEIVE PROCESSING                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0423
*       RECXIOPG->IOPDSID=IOPPTS;                                  0423
         MVI   IOPDSID(@15),X'06'                                  0423
*       RECXIOPG->IOPNAME=' ';                                     0424
         MVI   IOPNAME+1(@15),C' '                                 0424
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0424
         MVI   IOPNAME(@15),C' '                                   0424
*       RECXIOPG->IOPTYPE=IOPSYS;                                  0425
         MVI   IOPTYPE(@15),X'07'                                  0425
*       RECXIOPG->IOPFUNCT=IOPLOC;                                 0426
         MVI   IOPFUNCT(@15),X'03'                                 0426
*       CALL HMASMIO(RECXIOPG->HMASMIOP);/* GET PTS SYSTEM ENTRY     */
         ST    @15,@AL00001                                        0427
         L     @15,@CV01703                                        0427
         LA    @01,@AL00001                                        0427
         BALR  @14,@15                                             0427
*       IF RECXIOPG->IOPRETRN>=IOPNOTFD THEN                       0428
         L     @15,RECXIOPG                                        0428
         CLI   IOPRETRN(@15),4                                     0428
         BL    @RF00428                                            0428
*         DO;                                                      0429
*                                                                  0429
*           /*********************************************************/
*           /*                                                       */
*           /* PTS SYSTEM ENTRY COULD NOT BE ACCESSED                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0430
*           RECXMAX=STOPFUNC;       /* STOP RECEIVE                  */
         LA    @14,12                                              0430
         ST    @14,RECXMAX                                         0430
*           RECXMAX=MAX(RECXMAX,RECXIOPG->IOPRETRN);/* IN CASE HIGHER*/
         SLR   @07,@07                                             0431
         IC    @07,IOPRETRN(,@15)                                  0431
         CR    @14,@07                                             0431
         BNL   *+6
         LR    @14,@07                                             0431
         ST    @14,RECXMAX                                         0431
*           IF RECXIOPG->IOPRETRN=IOPNOTFD THEN                    0432
         CLI   IOPRETRN(@15),4                                     0432
         BNE   @RF00432                                            0432
*             MGPTYPE=MGPSEV;       /* SEVERE ERROR                  */
         MVI   MGPTYPE,X'04'                                       0433
*           ELSE                                                   0434
*             MGPTYPE=MGPINFO;      /* INFORMATIONAL ... AN I/O MSG
*                                      HAS BEEN ISSUED ALREADY IN  0434
*                                      THIS CASE                     */
*                                                                  0434
         B     @RC00432                                            0434
@RF00432 MVI   MGPTYPE,X'01'                                       0434
*           /*********************************************************/
*           /*                                                       */
*           /* PTS SYSTEM ENTRY NOT FOUND ... ISSUE HMA246I          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0435
*           CALL ERRMSG(HMA246I,NOPART,NOPART);/* PTS SYSTEM ENTRY 0435
*                                      NOT FOUND MESSAGE             */
@RC00432 LA    @01,@AL00435                                        0435
         BAL   @14,ERRMSG                                          0435
*         END;                                                     0436
*       ELSE                                                       0437
*         DO;                                                      0437
*                                                                  0437
         B     @RC00428                                            0437
@RF00428 DS    0H                                                  0438
*           /*********************************************************/
*           /*                                                       */
*           /* PTS SYSTEM ENTRY FOUND ... EXTRACT DATA PERTINENT TO  */
*           /* RECEIVE PROCESSING                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0438
*           RESPECIFY                                              0438
*             HMASMIOP BASED(RECXIOPG);                            0438
*           RECXDSPC=IOPDSSPC;      /* RELFILE SPACE ALLOCATION DATA */
         L     @15,RECXIOPG                                        0439
         MVC   RECXDSPC(6),IOPDSSPC(@15)                           0439
*           RECDSPFX=IOPDSPFX;      /* TLIB DSN PREFIX               */
*                                                                  0440
         MVC   RECDSPFX(26),IOPDSPFX(@15)                          0440
*           /*********************************************************/
*           /*                                                       */
*           /* INITIALIZE PTS SYSTEM ENTRY GTA FILE FROM THE DATA IN */
*           /* THE PTS SYSTEM ENTRY                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0441
*           RESPECIFY                                              0441
*             HMASMGTP BASED(RECXGPSP);/* PTS SYSTEM ENTRY GTP       */
*           DO I=1 BY 1 WHILE IOPPTSND(I)^=IOPEOLST&RECXMAX<STOPFUNC;
*                                                                  0442
         LA    @15,1                                               0442
         ST    @15,I                                               0442
         B     @DE00442                                            0442
@DL00442 DS    0H                                                  0443
*             /*******************************************************/
*             /*                                                     */
*             /* EXTRACT SRELS AND FMIDS FROM THE PTS SYSTEM ENTRY   */
*             /* AND PUT THEM IN THE PTSSYS GTA FILE.                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0443
*             IF IOPPTIND(I)=IOPPTFM×IOPPTIND(I)=IOPPTSRL THEN     0443
         L     @15,I                                               0443
         MH    @15,@CH00034                                        0443
         L     @01,RECXIOPG                                        0443
         SLR   @14,@14                                             0443
         IC    @14,IOPPTIND-9(@15,@01)                             0443
         CH    @14,@CH00041                                        0443
         BE    @RT00443                                            0443
         CH    @14,@CH00232                                        0443
         BNE   @RF00443                                            0443
@RT00443 DS    0H                                                  0444
*               DO;                                                0444
*                 GPSTYPE=IOPPTIND(I);/* SET FMID OR SREL TYPE       */
         LA    @15,GTAPS                                           0445
         L     @14,RECXIOPG                                        0445
         L     @07,I                                               0445
         MH    @07,@CH00034                                        0445
         SLR   @06,@06                                             0445
         IC    @06,IOPPTIND-9(@07,@14)                             0445
         STC   @06,GPSTYPE(,@15)                                   0445
*                 GPSENT=' ';       /* BLANK PART OF RECORD          */
         MVI   GPSENT+1(@15),C' '                                  0446
         MVC   GPSENT+2(5,@15),GPSENT+1(@15)                       0446
         MVI   GPSENT(@15),C' '                                    0446
*                 IF GPSTYPE=IOPPTFM THEN                          0447
         CLI   GPSTYPE(@15),1                                      0447
         BNE   @RF00447                                            0447
*                   GPSENT=IOPPTFMD(I);/* FMID VALUE                 */
         ALR   @14,@07                                             0448
         MVC   GPSENT(7,@15),IOPPTFMD-9(@14)                       0448
*                 ELSE                                             0449
*                   GPSENT=IOPPTREL(I);/* SREL VALUE                 */
         B     @RC00447                                            0449
@RF00447 LA    @15,GTAPS                                           0449
         MVI   GPSENT+4(@15),C' '                                  0449
         MVC   GPSENT+5(2,@15),GPSENT+4(@15)                       0449
         L     @14,I                                               0449
         MH    @14,@CH00034                                        0449
         L     @01,RECXIOPG                                        0449
         ALR   @01,@14                                             0449
         MVC   GPSENT(4,@15),IOPPTREL-9(@01)                       0449
*                 GTPFUNCT=GTPADD;  /* ADD RECORD TO FILE            */
@RC00447 L     @15,RECXGPSP                                        0450
         MVI   GTPFUNCT(@15),X'04'                                 0450
*                 CALL HMASMGTA(HMASMGTP);/* ADD RECORD              */
         ST    @15,@AL00001                                        0451
         L     @15,@CV01706                                        0451
         LA    @01,@AL00001                                        0451
         BALR  @14,@15                                             0451
*                 IF GTPRETRN>=GTPSPACE THEN                       0452
         L     @01,RECXGPSP                                        0452
         CLI   GTPRETRN(@01),12                                    0452
         BL    @RF00452                                            0452
*                   RECXMAX=STOPFUNC;                              0453
         MVC   RECXMAX(4),@CF00036                                 0453
*               END;                                               0454
@RF00452 DS    0H                                                  0455
*           END;                                                   0455
@RF00443 LA    @15,1                                               0455
         AL    @15,I                                               0455
         ST    @15,I                                               0455
@DE00442 L     @15,I                                               0455
         MH    @15,@CH00034                                        0455
         L     @01,RECXIOPG                                        0455
         SLR   @14,@14                                             0455
         IC    @14,IOPPTSND-9(@15,@01)                             0455
         CH    @14,@CH00766                                        0455
         BE    @DC00442                                            0455
         L     @15,RECXMAX                                         0455
         CH    @15,@CH00036                                        0455
         BL    @DL00442                                            0455
@DC00442 DS    0H                                                  0456
*         END;                                                     0456
*     END;                                                         0457
@RC00428 DS    0H                                                  0458
*   IF RECXMAX<STOPFUNC THEN                                       0458
@RF00421 L     @15,RECXMAX                                         0458
         CH    @15,@CH00036                                        0458
         BNL   @RF00458                                            0458
*     DO;                                                          0459
*                                                                  0459
*       /*************************************************************/
*       /*                                                           */
*       /* FOR PROCESSING SELECTED SYSMODS, DETERMINE HOW MANY       */
*       /* SYSMODS ARE SELECTED SO RECEIVE MAY STOP WHEN ALL SELECTED*/
*       /* SYSMODS HAVE BEEN PROCESSED                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0460
*       IF RECSEL=ON THEN                                          0460
         L     @15,@PC00001                                        0460
         TM    RECSEL(@15),B'10000000'                             0460
         BNO   @RF00460                                            0460
*         DO;                                                      0461
*                                                                  0461
*           /*********************************************************/
*           /*                                                       */
*           /* SELECT SPECIFIED                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0462
*           RECXSCNT=0;             /* CLEAR COUNT OF SELECTED     0462
*                                      SYSMODS                       */
         SLR   @15,@15                                             0462
         STH   @15,RECXSCNT                                        0462
*           RESPECIFY                                              0463
*             HMASMGTP BASED(CCASETAD);/* SELECT/EXCLUDE GTP         */
*           GTPFUNCT=GTPOPENN;      /* OPEN SELECT/EXCLUDE GTA FILE  */
         L     @15,CCASETAD(,CCAPTR)                               0464
         MVI   GTPFUNCT(@15),X'01'                                 0464
*           GTPBUFAD=ADDR(HMASMSET);/* SET UP POINTER TO SET STORE   */
         LA    @14,HMASMSET                                        0465
         ST    @14,GTPBUFAD(,@15)                                  0465
*           CALL HMASMGTA(HMASMGTP);                               0466
         ST    @15,@AL00001                                        0466
         L     @15,@CV01706                                        0466
         LA    @01,@AL00001                                        0466
         BALR  @14,@15                                             0466
*           GTPFUNCT=GTPGETN;       /* SET FUNCTION TO GET RECORDS 0467
*                                      SEQUENTIALLY FROM SET         */
         L     @15,CCASETAD(,CCAPTR)                               0467
         MVI   GTPFUNCT(@15),X'08'                                 0467
*           CALL HMASMGTA(HMASMGTP);/* GET FIRST RECORD              */
*                                                                  0468
         ST    @15,@AL00001                                        0468
         L     @15,@CV01706                                        0468
         LA    @01,@AL00001                                        0468
         BALR  @14,@15                                             0468
*           /*********************************************************/
*           /*                                                       */
*           /* GO THRU ALL RECORDS IN SELECT/EXCLUDE TABLE (SET)     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0469
*           DO WHILE GTPRETRN<GTPEOF;                              0469
         B     @DE00469                                            0469
@DL00469 DS    0H                                                  0470
*             IF SESMD=ON&SESELECT=ON THEN                         0470
         TM    SESMD,B'00000001'                                   0470
         BNO   @RF00470                                            0470
         TM    SESELECT,B'01000000'                                0470
         BNO   @RF00470                                            0470
*               DO;                                                0471
*                                                                  0471
*                 /***************************************************/
*                 /*                                                 */
*                 /* SELECTED SYSMOD                                 */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0472
*                 RECXSCNT=RECXSCNT+1;/* INCREMENT COUNT             */
         LH    @01,RECXSCNT                                        0472
         LA    @01,1(,@01)                                         0472
         STH   @01,RECXSCNT                                        0472
*               END;                                               0473
*             CALL HMASMGTA(HMASMGTP);/* GET NEXT RECORD             */
@RF00470 L     @01,CCASETAD(,CCAPTR)                               0474
         ST    @01,@AL00001                                        0474
         L     @15,@CV01706                                        0474
         LA    @01,@AL00001                                        0474
         BALR  @14,@15                                             0474
*           END;                                                   0475
@DE00469 L     @01,CCASETAD(,CCAPTR)                               0475
         CLI   GTPRETRN(@01),4                                     0475
         BL    @DL00469                                            0475
*         END;                                                     0476
*     END;                                                         0477
@RF00460 DS    0H                                                  0478
*   IF RECXMAX<STOPFUNC THEN                                       0478
@RF00458 L     @15,RECXMAX                                         0478
         CH    @15,@CH00036                                        0478
         BNL   @RF00478                                            0478
*     DO;                                                          0479
*                                                                  0479
*       /*************************************************************/
*       /*                                                           */
*       /* OPEN SMPPTFIN TO THE MODIFICATION CONTROL STATEMENT FILE  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0480
*       RECXIOPG->IOPDSID=IOPPTFIN; /* SMPPTFIN DATASET              */
         L     @15,RECXIOPG                                        0480
         MVI   IOPDSID(@15),X'0A'                                  0480
*       RECXIOPG->IOPFUNCT=IOPOPEN; /* OPEN FUNCTION                 */
         MVI   IOPFUNCT(@15),X'00'                                 0481
*       RECXIOPG->IOPSEQNO=1;       /* MUST BE SET FOR INITIAL OPEN  */
         MVC   IOPSEQNO(2,@15),@CH00041                            0482
*       RECXIOPG->IOPTYPE=''B;      /* TYPE IS N/A                   */
         SLR   @14,@14                                             0483
         STC   @14,IOPTYPE(,@15)                                   0483
*       RECXIOPG->IOPNAME=' ';      /* NAME IS N/A                   */
         MVI   IOPNAME+1(@15),C' '                                 0484
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0484
         MVI   IOPNAME(@15),C' '                                   0484
*       RECXIOPG->IOPPTFNT=''B;     /* CLEAR THE REST OF IOP         */
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0485
*       CALL HMASMIO(RECXIOPG->HMASMIOP);                          0486
         ST    @15,@AL00001                                        0486
         L     @15,@CV01703                                        0486
         LA    @01,@AL00001                                        0486
         BALR  @14,@15                                             0486
*       IF IOPRETRN^=IOPGOOD THEN                                  0487
         L     @15,RECXIOPG                                        0487
         CLI   IOPRETRN(@15),0                                     0487
         BE    @RF00487                                            0487
*         RECXMAX=MAX(RECXMAX,IOPRETRN);/* MAINTAIN RETURN CODE      */
         L     @14,RECXMAX                                         0488
         SLR   @07,@07                                             0488
         IC    @07,IOPRETRN(,@15)                                  0488
         CR    @14,@07                                             0488
         BNL   *+6
         LR    @14,@07                                             0488
         ST    @14,RECXMAX                                         0488
*       ELSE                                                       0489
*         DO;                                                      0489
         B     @RC00487                                            0489
@RF00487 DS    0H                                                  0490
*           PTFINOPN=ON;            /* SMPPTFIN OPEN                 */
*                                                                  0490
         OI    PTFINOPN,B'00010000'                                0490
*           /*********************************************************/
*           /*                                                       */
*           /* SMPPTFIN SUCCESSFULLY OPENED ... EXTRACT FILE SEQUENCE*/
*           /* NUMBER OF MODIFICATION CONTROL STATEMENT FILE ...     */
*           /* UNLOADED DATASET FILES (IF PRESENT) IMMEDIATELY FOLLOW*/
*           /* THIS FILE                                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0491
*           RECXRNXT=RECXIOPG->IOPTPSEQ+1;/* THE ABSOLUTE FILE     0491
*                                      SEQUENCE NUMBER OF THE NEXT 0491
*                                      SYSMOD ENCOUNTERED WHICH HAS A
*                                      FILES KEYWORD IS THE FILE   0491
*                                      IMMEDIATELY FOLLOWING THE   0491
*                                      MODIFICATION CONTROL STATEMENT
*                                      FILE                          */
         L     @01,RECXIOPG                                        0491
         LH    @01,IOPTPSEQ(,@01)                                  0491
         LA    @01,1(,@01)                                         0491
         STH   @01,RECXRNXT                                        0491
*         END;                                                     0492
*     END;                                                         0493
@RC00487 DS    0H                                                  0494
*                                                                  0494
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS PTFIN DATASET                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0494
*   IF RECXMAX<STOPFUNC THEN                                       0494
@RF00478 L     @15,RECXMAX                                         0494
         CH    @15,@CH00036                                        0494
         BNL   @RF00494                                            0494
*     CALL READ;                    /* READ FIRST RECORD             */
         BAL   @14,READ                                            0495
*   RECXSYSF=ON;                    /* SET TO FLUSH ANYTHING BEFORE
*                                      1ST SYSMOD HEADER FOUND       */
@RF00494 OI    RECXSYSF,B'00010000'                                0496
*   DO WHILE RECXPROC=GO&RECXPEOF=OFF&RECXMAX<STOPFUNC;            0497
*                                                                  0497
         B     @DE00497                                            0497
@DL00497 DS    0H                                                  0498
*     /***************************************************************/
*     /*                                                             */
*     /* AT THIS POINT THERE IS A CARD READ FROM SMPPTFIN IN THE     */
*     /* INPUT BUFFER                                                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0498
*     CALL CHKBUF;                  /* CHECK FOR THE TYPE OF CARD IN
*                                      BUFFER                        */
         BAL   @14,CHKBUF                                          0498
*     IF CHKTYPE=SMHEAD THEN                                       0499
         CLI   CHKTYPE,C'H'                                        0499
         BNE   @RF00499                                            0499
*       DO;                                                        0500
*                                                                  0500
*         /***********************************************************/
*         /*                                                         */
*         /* SYSMOD HEADER FOUND ... COMPLETE PROCESSING OF PREVIOUS */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0501
*         IF GSMHPRT=ON             /* PREVIOUS SYSMOD HEADER PRINTED*/
*           THEN                                                   0501
         LA    @15,GTASM                                           0501
         TM    GSMHPRT(@15),B'00010000'                            0501
         BNO   @RF00501                                            0501
*           CALL SKIP(1);           /* SKIP ONE LINE ON SMPOUT       */
         LA    @01,@AL00502                                        0502
         BAL   @14,SKIP                                            0502
*         IF RECXSYSM=ON            /* SYSMOD BEING PROCESSED        */
*           THEN                                                   0503
@RF00501 TM    RECXSYSM,B'01000000'                                0503
         BNO   @RF00503                                            0503
*           DO;                                                    0504
*             IF RECXSYSF=OFF       /* ... NOT BEING FLUSHED         */
*               THEN                                               0505
         TM    RECXSYSF,B'00010000'                                0505
         BNZ   @RF00505                                            0505
*               CALL HMASMRCC(RECXPARM);/* COMPLETE PROCESSING FOR 0506
*                                      PREVIOUS SYSMOD               */
         L     @15,@CV01710                                        0506
         LA    @01,@AL00506                                        0506
         BALR  @14,@15                                             0506
*             ELSE                                                 0507
*               CALL HMASMRCF(RECXPARM);/* COMPLETE PROCESSING FOR 0507
*                                      PREVIOUS FLUSHED SYSMOD       */
         B     @RC00505                                            0507
@RF00505 L     @15,@CV01711                                        0507
         LA    @01,@AL00507                                        0507
         BALR  @14,@15                                             0507
*           END;                                                   0508
@RC00505 DS    0H                                                  0509
*         CALL SYSMINIT;            /* RE-INITIALIZE FOR PROCESSING A
*                                      NEW SYSMOD                    */
@RF00503 BAL   @14,SYSMINIT                                        0509
*         IF RECSEL=ON              /* PROCESSING SELECTED SYSMODS   */
*             &RECXSCNT<=0          /* NO MORE SELECTED SYSMODS      */
*           THEN                                                   0510
         L     @15,@PC00001                                        0510
         TM    RECSEL(@15),B'10000000'                             0510
         BNO   @RF00510                                            0510
         LH    @15,RECXSCNT                                        0510
         LTR   @15,@15                                             0510
         BP    @RF00510                                            0510
*           RECXPROC=STOP;          /* ALL SELECTED SYSMODS HAVE BEEN
*                                      PROCESSED ... STOP RECEIVE    */
         NI    RECXPROC,B'01111111'                                0511
*       END;                                                       0512
*                                                                  0512
@RF00510 DS    0H                                                  0513
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR USER-EXIT RETURN CODES FROM PREVIOUS READ         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0513
*     IF READRTN>=CRPTPTF THEN                                     0513
@RF00499 L     @15,READRTN                                         0513
         LA    @14,8                                               0513
         CR    @15,@14                                             0513
         BL    @RF00513                                            0513
*       DO;                                                        0514
*                                                                  0514
*         /***********************************************************/
*         /*                                                         */
*         /* STOP-SYSMOD, STOP-FUNCTION OR STOP-SMP USER-EXIT CODE   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0515
*         RECXMAX=MAX(RECXMAX,READRTN);/* USER'S RETURN CODE         */
         L     @07,RECXMAX                                         0515
         CR    @07,@15                                             0515
         BNL   *+6
         LR    @07,@15                                             0515
         ST    @07,RECXMAX                                         0515
*         GSMUSR=ON;                /* USER EXIT FLUSH OR TERMINATE  */
         LA    @07,GTASM                                           0516
         OI    GSMUSR(@07),B'10000000'                             0516
*         RECXSYSF=ON;              /* FLUSH CURRENT SYSMOD          */
         OI    RECXSYSF,B'00010000'                                0517
*         IF READRTN>CRPTPTF THEN                                  0518
         CR    @15,@14                                             0518
         BNH   @RF00518                                            0518
*           RECXPROC=STOP;          /* STOP RECEIVE PROCESSING       */
         NI    RECXPROC,B'01111111'                                0519
*       END;                                                       0520
@RF00518 DS    0H                                                  0521
*     IF RECXPROC=GO&RECXMAX<STOPFUNC THEN                         0521
@RF00513 TM    RECXPROC,B'10000000'                                0521
         BNO   @RF00521                                            0521
         L     @15,RECXMAX                                         0521
         CH    @15,@CH00036                                        0521
         BNL   @RF00521                                            0521
*       DO;                                                        0522
*         IF CHKTYPE=SMHEAD THEN                                   0523
         CLI   CHKTYPE,C'H'                                        0523
         BNE   @RF00523                                            0523
*           DO;                                                    0524
*                                                                  0524
*             /*******************************************************/
*             /*                                                     */
*             /* RECORD CONTAINS A SYSMOD HEADER                     */
*             /* MODIFICATION-CNTRL-STMT                             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0525
*             CALL HDRPROC;         /* PROCESS A NEW SYSMOD          */
         BAL   @14,HDRPROC                                         0525
*           END;                                                   0526
*         IF CHKTYPE=SMCNTRL        /* NON-HEADER MOD.CNTL.STMT.     */
*             &MCSCHECK=ON          /* BODY OF SYSMOD BEING CHECKED  */
*           THEN                                                   0527
@RF00523 CLI   CHKTYPE,C'C'                                        0527
         BNE   @RF00527                                            0527
         TM    MCSCHECK,B'00000010'                                0527
         BNO   @RF00527                                            0527
*           DO;                                                    0528
*                                                                  0528
*             /*******************************************************/
*             /*                                                     */
*             /* RECORD CONTAINS A MODIFICATION-CONTROL STATEMENT    */
*             /* (OTHER THAN A SYSMOD HEADER)                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0529
*             CALL CNTLPROC;        /* PROCESS CNTRL STATEMENT       */
         BAL   @14,CNTLPROC                                        0529
*           END;                                                   0530
*         IF CHKTYPE=NOTCNTRL       /* NON-MOD.CNTL.STMT.            */
*             &MCSCHECK=ON          /* BODY OF SYSMOD BEING CHECKED  */
*           THEN                                                   0531
@RF00527 CLI   CHKTYPE,C'N'                                        0531
         BNE   @RF00531                                            0531
         TM    MCSCHECK,B'00000010'                                0531
         BNO   @RF00531                                            0531
*           DO;                                                    0532
*                                                                  0532
*             /*******************************************************/
*             /*                                                     */
*             /* RECORD CONTAINS A NON-MODIFICATION-CONTROL STATEMENT*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0533
*             CALL TEXTPROC;        /* PROCESS TEXT RECORDS          */
         BAL   @14,TEXTPROC                                        0533
*           END;                                                   0534
*       END;                                                       0535
@RF00531 DS    0H                                                  0536
*     CALL READ;                    /* GET THE NEXT PTFIN CARD       */
@RF00521 BAL   @14,READ                                            0536
*   END;                            /* END OF PTFIN CARD PROCESSING. */
@DE00497 TM    RECXPROC,B'10000000'                                0537
         BNO   @DC00497                                            0537
         TM    RECXPEOF,B'00100000'                                0537
         BNZ   @DC00497                                            0537
         L     @15,RECXMAX                                         0537
         CH    @15,@CH00036                                        0537
         BL    @DL00497                                            0537
@DC00497 DS    0H                                                  0538
*                                                                  0538
*   /*****************************************************************/
*   /*                                                               */
*   /* PTFIN DATASET PROCESSING COMPLETED                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0538
*   IF RECXSYSM=ON                  /* PROCESSING A SYSMOD ?         */
*     THEN                                                         0538
         TM    RECXSYSM,B'01000000'                                0538
         BNO   @RF00538                                            0538
*     DO;                                                          0539
*                                                                  0539
*       /*************************************************************/
*       /*                                                           */
*       /* FINISH UP THE LAST SYSMOD FROM PTFIN                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0540
*       IF GSMHPRT=ON               /* SYSMOD HEADER PRINTED         */
*         THEN                                                     0540
         LA    @15,GTASM                                           0540
         TM    GSMHPRT(@15),B'00010000'                            0540
         BNO   @RF00540                                            0540
*         CALL SKIP(1);             /* SKIP ONE LINE ON SMPOUT       */
         LA    @01,@AL00541                                        0541
         BAL   @14,SKIP                                            0541
*       IF RECXSYSF=OFF             /* SYSMOD NOT BEING FLUSHED      */
*         THEN                                                     0542
@RF00540 TM    RECXSYSF,B'00010000'                                0542
         BNZ   @RF00542                                            0542
*         CALL HMASMRCC(RECXPARM);  /* COMPLETE PROCESSING FOR LAST
*                                      SYSMOD (NOT FLUSHED)          */
         L     @15,@CV01710                                        0543
         LA    @01,@AL00543                                        0543
         BALR  @14,@15                                             0543
*       ELSE                                                       0544
*         CALL HMASMRCF(RECXPARM);  /* COMPLETE PROCESSING FOR LAST
*                                      SYSMOD (FLUSHED)              */
         B     @RC00542                                            0544
@RF00542 L     @15,@CV01711                                        0544
         LA    @01,@AL00544                                        0544
         BALR  @14,@15                                             0544
*     END;                                                         0545
@RC00542 DS    0H                                                  0546
*   CALL SKIP(3);                   /* SKIP THREE LINES ON SMPOUT    */
@RF00538 LA    @01,@AL00546                                        0546
         BAL   @14,SKIP                                            0546
*                                                                  0547
*   /*****************************************************************/
*   /*                                                               */
*   /* RECEIVE FUNCTION COMPLETION PROCESSING                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0547
*   IF PTFINOPN=ON THEN                                            0547
         TM    PTFINOPN,B'00010000'                                0547
         BNO   @RF00547                                            0547
*     DO;                                                          0548
*                                                                  0548
*       /*************************************************************/
*       /*                                                           */
*       /* SMPPTFIN WAS OPENED ... CLOSE IT                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0549
*       RECXIOPG->IOPDSID=IOPPTFIN; /* SMPPTFIN DATASET              */
         L     @15,RECXIOPG                                        0549
         MVI   IOPDSID(@15),X'0A'                                  0549
*       RECXIOPG->IOPFUNCT=IOPCLOSE;/* CLOSE FUNCTION                */
         MVI   IOPFUNCT(@15),X'50'                                 0550
*       RECXIOPG->IOPTYPE=''B;      /* TYPE IS N/A                   */
         SLR   @14,@14                                             0551
         STC   @14,IOPTYPE(,@15)                                   0551
*       RECXIOPG->IOPNAME=' ';      /* NAME IS N/A                   */
         MVI   IOPNAME+1(@15),C' '                                 0552
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0552
         MVI   IOPNAME(@15),C' '                                   0552
*       RECXIOPG->IOPPTFNT=''B;     /* CLEAR THE REST OF IOP         */
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0553
*       CALL HMASMIO(RECXIOPG->HMASMIOP);                          0554
         ST    @15,@AL00001                                        0554
         L     @15,@CV01703                                        0554
         LA    @01,@AL00001                                        0554
         BALR  @14,@15                                             0554
*       IF IOPRETRN^=IOPGOOD THEN                                  0555
         L     @15,RECXIOPG                                        0555
         CLI   IOPRETRN(@15),0                                     0555
         BE    @RF00555                                            0555
*         RECXMAX=MAX(RECXMAX,IOPRETRN);/* MAINTAIN RETURN CODE      */
         L     @14,RECXMAX                                         0556
         SLR   @07,@07                                             0556
         IC    @07,IOPRETRN(,@15)                                  0556
         CR    @14,@07                                             0556
         BNL   *+6
         LR    @14,@07                                             0556
         ST    @14,RECXMAX                                         0556
*       PTFINOPN=OFF;               /* SMPPTFIN CLOSED               */
@RF00555 NI    PTFINOPN,B'11101111'                                0557
*     END;                                                         0558
*                                                                  0559
*   /*****************************************************************/
*   /*                                                               */
*   /* LOAD RELFILE ELEMENTS TO SMPTLIB DASD DATASETS                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0559
*   IF RECXMAX<STOPFUNC&RECXGRFP->GTPWKAD^=0 THEN                  0559
@RF00547 L     @15,RECXMAX                                         0559
         CH    @15,@CH00036                                        0559
         BNL   @RF00559                                            0559
         L     @01,RECXGRFP                                        0559
         L     @15,GTPWKAD(,@01)                                   0559
         LTR   @15,@15                                             0559
         BZ    @RF00559                                            0559
*     DO;                                                          0560
*                                                                  0560
*       /*************************************************************/
*       /*                                                           */
*       /* THERE WERE RELFILE ELEMENTS PRESENT ... LOAD THEM TO THE  */
*       /* SMPTLIB DATASETS                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0561
*       CALL HMASMRCD(RECXPARM);                                   0561
         L     @15,@CV01713                                        0561
         LA    @01,@AL00561                                        0561
         BALR  @14,@15                                             0561
*       RECXMAX=MAX(RECXMAX,RECXLAST);/* SAVE HMASMRCD RETURN CODE   */
         L     @15,RECXMAX                                         0562
         L     @14,RECXLAST                                        0562
         CR    @15,@14                                             0562
         BNL   *+6
         LR    @15,@14                                             0562
         ST    @15,RECXMAX                                         0562
*     END;                                                         0563
*   IF RECSEL=ON THEN                                              0564
@RF00559 L     @15,@PC00001                                        0564
         TM    RECSEL(@15),B'10000000'                             0564
         BNO   @RF00564                                            0564
*     DO;                                                          0565
*                                                                  0565
*       /*************************************************************/
*       /*                                                           */
*       /* SELECT SPECIFIED ... ISSUE "HMA369I _______ SELECTED NOT  */
*       /* FOUND ON SMPPTFIN" FOR ANY SYSMODS IN THE SELECT LIST     */
*       /* WHICH WERE NOT ENCOUNTERED IN RECEIVE PROCESSING          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0566
*       RESPECIFY                                                  0566
*         HMASMGTP BASED(CCASETAD); /* SELECT/EXCLUDE GTP            */
*       GTPFUNCT=GTPOPENN;          /* OPEN SELECT/EXCLUDE GTA FILE  */
         L     @15,CCASETAD(,CCAPTR)                               0567
         MVI   GTPFUNCT(@15),X'01'                                 0567
*       GTPBUFAD=ADDR(HMASMSET);    /* SET UP POINTER TO SET STORE   */
         LA    @14,HMASMSET                                        0568
         ST    @14,GTPBUFAD(,@15)                                  0568
*       CALL HMASMGTA(HMASMGTP);                                   0569
         ST    @15,@AL00001                                        0569
         L     @15,@CV01706                                        0569
         LA    @01,@AL00001                                        0569
         BALR  @14,@15                                             0569
*       GTPFUNCT=GTPGETN;           /* SET FUNCTION TO GET RECORDS 0570
*                                      SEQUENTIALLY FROM SET         */
         L     @15,CCASETAD(,CCAPTR)                               0570
         MVI   GTPFUNCT(@15),X'08'                                 0570
*       CALL HMASMGTA(HMASMGTP);    /* GET FIRST RECORD              */
*                                                                  0571
         ST    @15,@AL00001                                        0571
         L     @15,@CV01706                                        0571
         LA    @01,@AL00001                                        0571
         BALR  @14,@15                                             0571
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL RECORDS IN SELECT/EXCLUDE TABLE (SET)         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0572
*       DO WHILE GTPRETRN<GTPEOF;                                  0572
         B     @DE00572                                            0572
@DL00572 DS    0H                                                  0573
*         IF SESMD=ON&SESELECT=ON THEN                             0573
         TM    SESMD,B'00000001'                                   0573
         BNO   @RF00573                                            0573
         TM    SESELECT,B'01000000'                                0573
         BNO   @RF00573                                            0573
*           DO;                                                    0574
*                                                                  0574
*             /*******************************************************/
*             /*                                                     */
*             /* SELECTED SYSMOD                                     */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0575
*             IF SEFOUND^=ON THEN   /* NOT FOUND ON PTFIN ?          */
         TM    SEFOUND,B'00000001'                                 0575
         BO    @RF00575                                            0575
*               DO;                                                0576
*                                                                  0576
*                 /***************************************************/
*                 /*                                                 */
*                 /* NOT FOUND ON PTFIN                              */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0577
*                 CALL ADDNFND(SESMDNO);/* ADD SYSMOD-ID TO RECEIVE
*                                      SUMMARY GTA FILE              */
         LA    @01,@AL00577                                        0577
         BAL   @14,ADDNFND                                         0577
*                 MGPTYPE=MGPERR;   /* WARNING MESSAGE               */
         MVI   MGPTYPE,X'03'                                       0578
*                 MSGSMDNM=SESMDNO; /* SYSMOD NUMBER                 */
         MVC   MSGSMDNM(7),SESMDNO                                 0579
*                 CALL ERRMSG(HMA369I,NOPART,NOPART);              0580
         LA    @01,@AL00580                                        0580
         BAL   @14,ERRMSG                                          0580
*               END;                                               0581
*           END;                                                   0582
@RF00575 DS    0H                                                  0583
*         CALL HMASMGTA(HMASMGTP);  /* GET NEXT RECORD               */
@RF00573 L     @01,CCASETAD(,CCAPTR)                               0583
         ST    @01,@AL00001                                        0583
         L     @15,@CV01706                                        0583
         LA    @01,@AL00001                                        0583
         BALR  @14,@15                                             0583
*       END;                                                       0584
@DE00572 L     @01,CCASETAD(,CCAPTR)                               0584
         CLI   GTPRETRN(@01),4                                     0584
         BL    @DL00572                                            0584
*     END;                                                         0585
*                                                                  0586
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE HMA248I IF NO SYSMODS WERE RECEIVED                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0586
*   IF RECXCNT=0                    /* NO SYSMODS SUCCESSFULLY RCVD  */
*     THEN                                                         0586
@RF00564 LH    @15,RECXCNT                                         0586
         LTR   @15,@15                                             0586
         BNZ   @RF00586                                            0586
*     DO;                                                          0587
*       MGPTYPE=MGPWARN;            /* WARNING MESSAGE               */
         MVI   MGPTYPE,X'02'                                       0588
*       CALL ERRMSG(HMA248I,NOPART,NOPART);                        0589
         LA    @01,@AL00589                                        0589
         BAL   @14,ERRMSG                                          0589
*     END;                                                         0590
*                                                                  0590
*   /*****************************************************************/
*   /*                                                               */
*   /* RECEIVE SUMMARY REPORT AND UPDATE OF PTS SYSTEM ENTRY         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0591
*   CALL HMASMRCL(RECXPARM);                                       0591
*                                                                  0591
@RF00586 L     @15,@CV01712                                        0591
         LA    @01,@AL00591                                        0591
         BALR  @14,@15                                             0591
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEANUP STORAGE ALLOCATED FOR RECEIVE PROCESSING              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0592
*   IF RECXMCB^=0 THEN                                             0592
         L     @15,RECXMCB                                         0592
         LTR   @15,@15                                             0592
         BZ    @RF00592                                            0592
*     DO;                                                          0593
*                                                                  0593
*       /*************************************************************/
*       /*                                                           */
*       /* FREE STORAGE ALLOCATED TO MCB CONTROL BLOCK               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0594
*       SPLPMAD=RECXMCB;            /* PTR TO STORAGE ALLOCATED      */
         ST    @15,SPLPMAD                                         0594
*       SPLFUNCT=SPLFMIOP;          /* FREEMAIN IOP FUNCTION         */
         MVI   SPLFUNCT,X'04'                                      0595
*       CALL HMASMSUB(HMASMSPL);                                   0596
         L     @15,@CV01709                                        0596
         LA    @01,@AL00596                                        0596
         BALR  @14,@15                                             0596
*     END;                                                         0597
*   IF RECXIOPP^=0 THEN                                            0598
@RF00592 L     @15,RECXIOPP                                        0598
         LTR   @15,@15                                             0598
         BZ    @RF00598                                            0598
*     DO;                                                          0599
*                                                                  0599
*       /*************************************************************/
*       /*                                                           */
*       /* FREE STORAGE ALLOCATED FOR PTS SYSMOD IOP                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0600
*       SPLPMAD=RECXIOPP;           /* PTR TO STORAGE ALLOCATED      */
         ST    @15,SPLPMAD                                         0600
*       SPLFUNCT=SPLFMIOP;          /* FREEMAIN IOP FUNCTION         */
         MVI   SPLFUNCT,X'04'                                      0601
*       CALL HMASMSUB(HMASMSPL);                                   0602
         L     @15,@CV01709                                        0602
         LA    @01,@AL00602                                        0602
         BALR  @14,@15                                             0602
*     END;                                                         0603
*   IF RECXIOPT^=0 THEN                                            0604
@RF00598 L     @15,RECXIOPT                                        0604
         LTR   @15,@15                                             0604
         BZ    @RF00604                                            0604
*     DO;                                                          0605
*                                                                  0605
*       /*************************************************************/
*       /*                                                           */
*       /* FREE STORAGE ALLOCATED FOR PTS MCS IOP                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0606
*       SPLPMAD=RECXIOPT;           /* PTR TO STORAGE ALLOCATED      */
         ST    @15,SPLPMAD                                         0606
*       SPLFUNCT=SPLFMIOP;          /* FREEMAIN IOP FUNCTION         */
         MVI   SPLFUNCT,X'04'                                      0607
*       CALL HMASMSUB(HMASMSPL);                                   0608
         L     @15,@CV01709                                        0608
         LA    @01,@AL00608                                        0608
         BALR  @14,@15                                             0608
*     END;                                                         0609
*   RESPECIFY                                                      0610
*     HMASMGTP BASED(RECXGSMP);     /* SUMMARY GTP                   */
@RF00604 DS    0H                                                  0611
*   IF GTPWKAD^=0 THEN                                             0611
         L     @15,RECXGSMP                                        0611
         L     @14,GTPWKAD(,@15)                                   0611
         LTR   @14,@14                                             0611
         BZ    @RF00611                                            0611
*     DO;                                                          0612
*                                                                  0612
*       /*************************************************************/
*       /*                                                           */
*       /* FREE SUMMARY GTA FILE                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0613
*       GTPFUNCT=GTPFREE;           /* FREE FUNCTION                 */
         MVI   GTPFUNCT(@15),X'0A'                                 0613
*       CALL HMASMGTA(HMASMGTP);    /* FREE IT                       */
         ST    @15,@AL00001                                        0614
         L     @15,@CV01706                                        0614
         LA    @01,@AL00001                                        0614
         BALR  @14,@15                                             0614
*     END;                                                         0615
*   RESPECIFY                                                      0616
*     HMASMGTP BASED(RECXGSRP);     /* SRELFMID GTP                  */
@RF00611 DS    0H                                                  0617
*   IF GTPWKAD^=0 THEN                                             0617
         L     @15,RECXGSRP                                        0617
         L     @14,GTPWKAD(,@15)                                   0617
         LTR   @14,@14                                             0617
         BZ    @RF00617                                            0617
*     DO;                                                          0618
*                                                                  0618
*       /*************************************************************/
*       /*                                                           */
*       /* FREE SRELFMID GTA FILE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0619
*       GTPFUNCT=GTPFREE;           /* FREE FUNCTION                 */
         MVI   GTPFUNCT(@15),X'0A'                                 0619
*       CALL HMASMGTA(HMASMGTP);    /* FREE IT                       */
         ST    @15,@AL00001                                        0620
         L     @15,@CV01706                                        0620
         LA    @01,@AL00001                                        0620
         BALR  @14,@15                                             0620
*     END;                                                         0621
*   RESPECIFY                                                      0622
*     HMASMGTP BASED(RECXGRFP);     /* RELFILE GTP                   */
@RF00617 DS    0H                                                  0623
*   IF GTPWKAD^=0 THEN                                             0623
         L     @15,RECXGRFP                                        0623
         L     @14,GTPWKAD(,@15)                                   0623
         LTR   @14,@14                                             0623
         BZ    @RF00623                                            0623
*     DO;                                                          0624
*                                                                  0624
*       /*************************************************************/
*       /*                                                           */
*       /* FREE RELFILE GTA FILE                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0625
*       GTPFUNCT=GTPFREE;           /* FREE FUNCTION                 */
         MVI   GTPFUNCT(@15),X'0A'                                 0625
*       CALL HMASMGTA(HMASMGTP);    /* FREE IT                       */
         ST    @15,@AL00001                                        0626
         L     @15,@CV01706                                        0626
         LA    @01,@AL00001                                        0626
         BALR  @14,@15                                             0626
*     END;                                                         0627
*   RESPECIFY                                                      0628
*     HMASMGTP BASED(RECXGPSP);     /* PTS SYSTEM ENTRY GTP          */
@RF00623 DS    0H                                                  0629
*   IF GTPWKAD^=0 THEN                                             0629
         L     @15,RECXGPSP                                        0629
         L     @14,GTPWKAD(,@15)                                   0629
         LTR   @14,@14                                             0629
         BZ    @RF00629                                            0629
*     DO;                                                          0630
*                                                                  0630
*       /*************************************************************/
*       /*                                                           */
*       /* FREE PTS SYSTEM ENTRY GTA FILE                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0631
*       GTPFUNCT=GTPFREE;           /* FREE FUNCTION                 */
         MVI   GTPFUNCT(@15),X'0A'                                 0631
*       CALL HMASMGTA(HMASMGTP);    /* FREE IT                       */
         ST    @15,@AL00001                                        0632
         L     @15,@CV01706                                        0632
         LA    @01,@AL00001                                        0632
         BALR  @14,@15                                             0632
*     END;                                                         0633
*                                                                  0633
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE CCA IOP'S IOPBUFAD                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0634
*   CCAIOPTR->IOPBUFAD=SAVBUFAD;                                   0634
@RF00629 L     @01,CCAIOPTR(,CCAPTR)                               0634
         MVC   IOPBUFAD(4,@01),SAVBUFAD                            0634
*   RETURN CODE(RECXMAX);           /* RETURN TO THE CALLER          */
         L     @15,RECXMAX                                         0635
         L     @13,4(,@13)                                         0635
         L     @14,12(,@13)                                        0635
         LM    @00,@12,20(@13)                                     0635
         BR    @14                                                 0635
*                                                                  0636
*/********************************************************************/
*/*                                                                  */
*/*    SYSMINIT - INITIALIZE DATA AREAS FOR PROCESSING A NEW SYSMOD  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0636
*SYSMINIT:                                                         0636
*   PROC;                                                          0636
@EL00001 L     @13,4(,@13)                                         0636
@EF00001 DS    0H                                                  0636
@ER00001 LM    @14,@12,12(@13)                                     0636
         BR    @14                                                 0636
SYSMINIT STM   @14,@12,@SA00002                                    0636
*                                                                  0637
*   /*****************************************************************/
*   /*                                                               */
*   /* RE-INITIALIZE PROCESS FLAGS FOR PROCESSING A NEW SYSMOD       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0637
*   RECXFLG2=ALLOFF;                                               0637
         MVI   RECXFLG2,B'00000000'                                0637
*   RECXFLG3=ALLOFF;                                               0638
         MVI   RECXFLG3,B'00000000'                                0638
*   RECXSYSM=OFF;                   /* CLEAR PROCESSING SYSMD      0639
*                                      INDICATOR                     */
*   RECXSYSF=OFF;                   /* CLEAR FLUSH INDICATOR         */
         NI    RECXSYSM,B'10101111'                                0640
*   RECXMNDX=0;                     /* COUNT OF ELEMENTS IN CURRENT
*                                      SYSMOD                        */
         SLR   @15,@15                                             0641
         ST    @15,RECXMNDX                                        0641
*   REL4VER=OFF;                    /* CLEAR VALID REL4 ++VER FOUND  */
*                                                                  0642
         NI    REL4VER,B'11011111'                                 0642
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE GTA SUMMARY FILE RECORD FOR THIS NEW SYSMOD        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0643
*   GSMREC=''B;                     /* CLEAR RECORD                  */
         LA    @15,GTASM                                           0643
         XC    GSMREC(18,@15),GSMREC(@15)                          0643
*   GSMFMID=NULLPTF#;               /* BLANK FMID FIELD              */
         MVC   GSMFMID(7,@15),@CC01733                             0644
*   GSMS#=NULLPTF#;                 /* BLANK SYSMOD NUMBER           */
*                                                                  0645
         MVC   GSMS#(7,@15),@CC01733                               0645
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE CURRENT GTA SREL/FMID FILE AND RE-INITIALIZE             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0646
*   RESPECIFY                                                      0646
*     HMASMGTP BASED(RECXGSRP);     /* SRELFMID GTP                  */
*   GTPFUNCT=GTPFREE;               /* FREE CURRENT SRELFMID FILE    */
         L     @15,RECXGSRP                                        0647
         MVI   GTPFUNCT(@15),X'0A'                                 0647
*   CALL HMASMGTA(HMASMGTP);                                       0648
         ST    @15,@AL00001                                        0648
         L     @15,@CV01706                                        0648
         LA    @01,@AL00001                                        0648
         BALR  @14,@15                                             0648
*   HMASMGTP=''B;                   /* RE-INITIALIZE GTP             */
         L     @15,RECXGSRP                                        0649
         XC    HMASMGTP(28,@15),HMASMGTP(@15)                      0649
*   GTPRCDLN=LENGTH(GSRREC);        /* RECORD LENGTH                 */
         LA    @14,11                                              0650
         STH   @14,GTPRCDLN(,@15)                                  0650
*   GTPKEYLN=LENGTH(GSRKEY);        /* KEY LENGTH                    */
         STH   @14,GTPKEYLN(,@15)                                  0651
*   GTPBUFAD=ADDR(GTASR);           /* BUFFER                        */
         LA    @14,GTASR                                           0652
         ST    @14,GTPBUFAD(,@15)                                  0652
*                                                                  0653
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IOP FOR PTS SYSMOD ENTRY                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0653
*   RECXIOPP->IOPNAME=' ';          /* BLANK ENTRY NAME              */
         L     @15,RECXIOPP                                        0653
         MVI   IOPNAME+1(@15),C' '                                 0653
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0653
         MVI   IOPNAME(@15),C' '                                   0653
*   RECXIOPP->IOPPTFNT=''B;         /* CLEAR IOPUDATA PORTION        */
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0654
*   RECXIOPP->IOPNTLVL=IOPPTFLC;    /* SET ENTRY LEVEL               */
         MVI   IOPNTLVL(@15),X'02'                                 0655
*   RECXIOPP->IOPPTPFX=RECDSPFX;    /* TLIB DATASET NAME PREFIX      */
         MVC   IOPPTPFX(26,@15),RECDSPFX                           0656
*   RECXIOPP->IOPFUNCT=IOPOPEN;     /* CHECKED BY HMASMRCF           */
         MVI   IOPFUNCT(@15),X'00'                                 0657
*   RECXIOPP->IOPRETRN=ZERO;        /* CLEAR RETURN CODE FIELD       */
         MVI   IOPRETRN(@15),X'00'                                 0658
*   RECXIOPP->IOPPTFND(1)=IOPEOLST; /* SET END-OF-LIST               */
*                                                                  0659
         MVI   IOPPTFND(@15),X'FF'                                 0659
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IOP FOR PTS MCS ENTRY                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0660
*   RECXIOPT->IOPNAME=' ';          /* BLANK ENTRY NAME              */
         L     @15,RECXIOPT                                        0660
         MVI   IOPNAME+1(@15),C' '                                 0660
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0660
         MVI   IOPNAME(@15),C' '                                   0660
*   RECXIOPT->IOPNAM17=UNKNOWN#;    /* SET TO UNKNOWN SYSMOD         */
         MVC   IOPNAM17(7,@15),@CC01735                            0661
*   RECXIOPT->IOPPTFNT=''B;         /* CLEAR IOPUDATA PORTION        */
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0662
*   RECXIOPT->IOPFUNCT=IOPOPEN;     /* CHECKED BY HMASMRCF           */
         MVI   IOPFUNCT(@15),X'00'                                 0663
*   RECXIOPT->IOPRETRN=ZERO;        /* CLEAR RETURN CODE FIELD       */
         MVI   IOPRETRN(@15),X'00'                                 0664
*   RECXIOPT->IOPNTLVL=IOPPTFLC;    /* SET ENTRY LEVEL               */
         MVI   IOPNTLVL(@15),X'02'                                 0665
*   RETURN;                                                        0666
@EL00002 DS    0H                                                  0666
@EF00002 DS    0H                                                  0666
@ER00002 LM    @14,@12,@SA00002                                    0666
         BR    @14                                                 0666
*   END SYSMINIT;                                                  0667
*                                                                  0668
*/********************************************************************/
*/*                                                                  */
*/*    HDRPROC - PROCESS HEADER SYSTEM MODIFICATION CONTROL          */
*/*              STATEMENTS                                          */
*/*                                                                  */
*/*        1. CALL HMASMMPD TO PARSE THE SYSMOD HEADER STATEMENT     */
*/*           AND SET UP FIELDS IN THE PTS PTF ENTRY IOP FOR THIS    */
*/*           SYSMOD.                                                */
*/*                                                                  */
*/*        2. CHECK SELECT/EXCLUDE CRITERIA USING THE SELECT/EXCLUDE */
*/*           LIST.                                                  */
*/*                                                                  */
*/*        3. ATTEMPT TO LOCATE A SYSMOD-TYPE ENTRY FOR THIS SYSMOD  */
*/*           ON THE SMPPTS DATASET.                                 */
*/*           - IF ONE IS FOUND AND NOT "IN ERROR", FLUSH THIS       */
*/*             SYSMOD.                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0668
*HDRPROC:                                                          0668
*   PROC;                                                          0668
HDRPROC  STM   @14,@12,@SA00003                                    0668
*   RECXSYSM=ON;                    /* SET PROCESSING SYSMOD       0669
*                                      INDICATOR                     */
         OI    RECXSYSM,B'01000000'                                0669
*   MCSCHECK=ON;                    /* RESTORE MOD.CNTL.STMT. CHECKS */
*   DUP347=OFF;                     /* CLEAR HMA347I MSG ISSUED FLAG */
         OI    MCSCHECK,B'00000010'                                0671
         NI    DUP347,B'11110111'                                  0671
*   GSMS#=CHKSMDID;                 /* INITIALIZE SYSMOD-ID          */
         LA    @15,GTASM                                           0672
         MVC   GSMS#(7,@15),CHKSMDID                               0672
*   IF CHKSMD#=YES                  /* SYSMOD # FOUND BY CHKBUF PROC */
*     THEN                                                         0673
         CLI   CHKSMD#,C'Y'                                        0673
         BNE   @RF00673                                            0673
*     DO;                                                          0674
*                                                                  0674
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE WHETHER THE SYSMOD SHOULD BE EXCLUDED           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0675
*       CALL SECHK;                 /* SEE IF IT SHOULD BE EXCLUDED  */
         BAL   @14,SECHK                                           0675
*       IF GSMEXCL=OFF              /* SYSMOD NOT EXCLUDED           */
*         THEN                                                     0676
         LA    @15,GTASM                                           0676
         TM    GSMEXCL(@15),B'00010000'                            0676
         BNZ   @RF00676                                            0676
*         CALL PTSCHK(GSMS#);       /* SEE IF IT IS ALREADY RECVD.   */
         ST    @15,@AL00001                                        0677
         LA    @01,@AL00001                                        0677
         BAL   @14,PTSCHK                                          0677
*     END;                                                         0678
@RF00676 DS    0H                                                  0679
*   IF(GSMEXCL=OFF                  /* SYSMOD NOT EXCLUDED (YET)     */
*       &GSMRCVD=OFF)               /* SYSMOD NOT ALREADY RECEIVED   */
*       ×GSMSEL=ON                  /* SYSMOD IS SELECTED            */
*     THEN                                                         0679
@RF00673 LA    @15,GTASM                                           0679
         TM    GSMEXCL(@15),B'00110000'                            0679
         BZ    @RT00679                                            0679
         LA    @15,GTASM                                           0679
         TM    GSMSEL(@15),B'00010000'                             0679
         BNO   @RF00679                                            0679
@RT00679 DS    0H                                                  0680
*     DO;                                                          0680
*                                                                  0680
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE THE FIRST RECORD FOR THIS SYSMOD (IN CRPBUFF) TO    */
*       /* SMPPTS USING THE "DUMMY" PTS MCS ENTRY INITIALIZED BY     */
*       /* SYSMINIT.... NOTE THAT THE "DUMMY" PTS MCS ENTRY IOP WILL */
*       /* BE TURNED INTO A "REAL" IOP IF HMASMMPD IS ABLE TO        */
*       /* SUCCESSFULLY PARSE THIS STATEMENT.                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0681
*       CALL SKIP(3);               /* SKIP THREE LINES ON SMPOUT TO
*                                      DELIMIT A SYSMOD              */
         LA    @01,@AL00681                                        0681
         BAL   @14,SKIP                                            0681
*       CALL WRITEPTS(SMCNTRL);     /* WRITE TO SMPPTS (MCS ENTRY) 0682
*                                      AND AND SMPOUT.               */
         LA    @01,@AL00682                                        0682
         BAL   @14,WRITEPTS                                        0682
*       GSMHPRT=ON;                 /* SYSMOD HEADER PRINTED         */
         LA    @15,GTASM                                           0683
         OI    GSMHPRT(@15),B'00010000'                            0683
*     END;                                                         0684
*                                                                  0684
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP HMASMCRP PARAMETER LIST AND CALL HMASMMPD TO PARSE THE */
*   /* HEADER STATEMENT.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0685
*   CRPBFPRM=OFF;                   /* BUFFER NOT PRIMED FOR NEXT  0685
*                                      READ                          */
@RF00679 NI    CRPBFPRM,B'01111111'                                0685
*   IF RECXSYSF=ON                  /* FLUSHING SYSMOD               */
*       ×GSMEXCL=ON                 /* SYSMOD EXCLUDED               */
*     THEN                                                         0686
         TM    RECXSYSF,B'00010000'                                0686
         BO    @RT00686                                            0686
         LA    @15,GTASM                                           0686
         TM    GSMEXCL(@15),B'00010000'                            0686
         BNO   @RF00686                                            0686
@RT00686 DS    0H                                                  0687
*     DO;                                                          0687
*       CRPPTS=OFF;                 /* DO NOT WRITE TO SMPPTS        */
*       CRPPRINT=OFF;               /* DO NOT WRITE TO SMPOUT        */
         NI    CRPPTS,B'11010111'                                  0689
*     END;                                                         0690
*   ELSE                                                           0691
*     DO;                                                          0691
         B     @RC00686                                            0691
@RF00686 DS    0H                                                  0692
*       CRPPTS=ON;                  /* WRITE TO SMPPTS               */
*       CRPPRINT=ON;                /* WRITE TO SMPOUT               */
         OI    CRPPTS,B'00101000'                                  0693
*     END;                                                         0694
*   CRPLOG=OFF;                     /* DO NOT WRITE TO SMPLOG        */
@RC00686 DS    0H                                                  0696
*   CRPOTHER=OFF;                   /* DO NOT WRITE TO CRDOUTDS      */
         NI    CRPLOG,B'11101011'                                  0696
*   CRPUXNUM=UXPUX001;              /* SET RECEIVE USER EXIT         */
         MVI   CRPUXNUM,X'01'                                      0697
*   MPPSMDNM=GSMS#;                 /* SYSMOD-ID (IF FOUND)          */
         LA    @15,GTASM                                           0698
         MVC   MPPSMDNM(7),GSMS#(@15)                              0698
*   CALL HMASMMPD(MPPPARM);         /* PARSE STATEMENT               */
         L     @15,@CV01707                                        0699
         LA    @01,@AL00699                                        0699
         BALR  @14,@15                                             0699
*   RESPECIFY                                                      0700
*     REG15 RSTD;                                                  0700
*   MPDRETRN=REG15;                 /* SAVE RETURN CODE FROM MPD     */
         ST    REG15,MPDRETRN                                      0701
*   RESPECIFY                                                      0702
*     REG15 UNRSTD;                                                0702
*   IF MPDRETRN>0 THEN                                             0703
         L     @15,MPDRETRN                                        0703
         LTR   @15,@15                                             0703
         BNP   @RF00703                                            0703
*     CALL PARSERR;                 /* PROCESS NON-ZERO PARSE CODES  */
*                                                                  0704
         BAL   @14,PARSERR                                         0704
*   /*****************************************************************/
*   /*                                                               */
*   /* PUT SYSMOD NAME IN PTS MCS IOP                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0705
*   RECXIOPT->IOPNAM17=MCBPNO;      /* SYSMOD NAME                   */
*                                                                  0705
@RF00703 L     @01,RECXIOPT                                        0705
         L     @15,RECXMCB                                         0705
         MVC   IOPNAM17(7,@01),MCBPNO(@15)                         0705
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN GTA SUMMARY FILE RECORD                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0706
*   GSMS#=MCBPNO;                   /* SYSMOD NUMBER                 */
         LA    @14,GTASM                                           0706
         MVC   GSMS#(7,@14),MCBPNO(@15)                            0706
*   GSMSTY=MCBPTP;                  /* SYSMOD TYPE                   */
*                                                                  0707
         MVC   GSMSTY(1,@14),MCBPTP(@15)                           0707
*   /*****************************************************************/
*   /*                                                               */
*   /* MAINTAIN RELFILE TAPE ABSOLUTE FILE SEQUENCE NUMBERS          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0708
*   RECXRFLE=MCBPRELN;              /* CURRENT SYSMOD'S # OF DATA  0708
*                                      FILES                         */
         LH    @15,MCBPRELN(,@15)                                  0708
         STH   @15,RECXRFLE                                        0708
*   RECXRCUR=RECXRNXT;              /* CURRENT SYSMOD'S 1ST DATA FILE*/
         LH    @14,RECXRNXT                                        0709
         STH   @14,RECXRCUR                                        0709
*   RECXRNXT=RECXRCUR+RECXRFLE;     /* NEXT SYSMOD'S 1ST DATA FILE   */
         ALR   @14,@15                                             0710
         STH   @14,RECXRNXT                                        0710
*   IF CHKSMD#=NO                   /* SYSMOD # NOT FOUND 1ST RECORD */
*     THEN                                                         0711
         CLI   CHKSMD#,C'N'                                        0711
         BNE   @RF00711                                            0711
*     DO;                                                          0712
*                                                                  0712
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE WHETHER THE SYSMOD SHOULD BE EXCLUDED           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0713
*       CALL SECHK;                 /* CHECK SELECT/EXCLUDE LIST     */
         BAL   @14,SECHK                                           0713
*       IF GSMEXCL=OFF              /* SYSMOD NOT EXCLUDED           */
*         THEN                                                     0714
         LA    @15,GTASM                                           0714
         TM    GSMEXCL(@15),B'00010000'                            0714
         BNZ   @RF00714                                            0714
*         CALL PTSCHK(GSMS#);       /* SEE IF IT IS ALREADY RECVD.   */
         ST    @15,@AL00001                                        0715
         LA    @01,@AL00001                                        0715
         BAL   @14,PTSCHK                                          0715
*     END;                                                         0716
*                                                                  0716
@RF00714 DS    0H                                                  0717
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THIS SYSMOD HAS ALREADY BEEN SEEN DURING THIS        */
*   /* INVOCATION OF RECEIVE                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0717
*   CALL DUPCHK;                    /* CHECK FOR DUPLICATE SYSMOD    */
@RF00711 BAL   @14,DUPCHK                                          0717
*   END HDRPROC;                                                   0718
@EL00003 DS    0H                                                  0718
@EF00003 DS    0H                                                  0718
@ER00003 LM    @14,@12,@SA00003                                    0718
         BR    @14                                                 0718
*                                                                  0719
*/********************************************************************/
*/*                                                                  */
*/*    CNTLPROC - PROCESS NON-HEADER SYSTEM MODIFICATION CONTROL     */
*/*    STATEMENTS                                                    */
*/*                                                                  */
*/*        1. CHECK FOR SYSMOD CONSTRUCTION ERRORS.                  */
*/*                                                                  */
*/*        2. CALL HMASMMPD TO PARSE THE MODIFICATION CNTRL STMT.    */
*/*                                                                  */
*/*        3. CALL THE APPROPRIATE PROCEDURE TO PROCESS THE          */
*/*           STATEMENT:                                             */
*/*                                                                  */
*/*           - VERPROC  : ++VER STATEMENTS.                         */
*/*           - IFPROC   : ++IF  STATEMENTS.                         */
*/*           - JCLPROC  : ++JCLIN STATEMENTS.                       */
*/*           - ELEMPROC : ++MOD, ++MAC, ++SRC, ETC. STATEMENTS.     */
*/*                                                                  */
*/*           OR "FLUSH" THE SYSMOD IF A SYNTAX ERROR WAS DETECTED   */
*/*           BY HMASMMPD.                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0719
*CNTLPROC:                                                         0719
*   PROC;                                                          0719
*                                                                  0719
CNTLPROC STM   @14,@12,@SA00004                                    0719
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SYSMOD CONSTRUCTION ERRORS                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0720
*   IF RECXPTXT=ON                  /* ELEMENT TEXT RECORDS EXPECTED */
*       &RECXTXTF=OFF               /* TEXT RECORDS NOT FOUND        */
*       &RECXSYSF=OFF               /* SYSMOD NOT BEING FLUSHED      */
*     THEN                                                         0720
         TM    RECXPTXT,B'00100000'                                0720
         BNO   @RF00720                                            0720
         TM    RECXTXTF,B'00010000'                                0720
         BNZ   @RF00720                                            0720
         TM    RECXSYSF,B'00010000'                                0720
         BNZ   @RF00720                                            0720
*     DO;                                                          0721
*                                                                  0721
*       /*************************************************************/
*       /*                                                           */
*       /* TEXT RECORDS SHOULD HAVE BEEN FOUND AFTER THE PREVIOUS    */
*       /* CONTROL CARD BUT WERE NOT ... ISSUE HMA273I               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0722
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0722
*       CALL ERRMSG(HMA273I,NOPART,NOPART);/* TEXT TEXT RECORDS NOT
*                                      FOUND FOR PRECEDING SYSTEM  0723
*                                      MODIFICATION CONTROL CARD     */
         LA    @01,@AL00723                                        0723
         BAL   @14,ERRMSG                                          0723
*       RECXSYSF=ON;                /* FLUSH THE CURRENT SYSMOD      */
         OI    RECXSYSF,B'00010000'                                0724
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           0725
         OI    GSMSYNTX(@15),B'01000000'                           0725
*     END;                                                         0726
*                                                                  0727
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE FIRST RECORD FOR THIS STMT. (IN CRPBUFFR) TO SMPPTS.*/
*   /* NOTE THAT THE SUBSEQUENT RECORDS WHICH MAKE UP THIS STATEMENT */
*   /* WILL BE WRITTEN TO SMPPTS BY HMASMCRD (SEE THE INITIALIZATION */
*   /* BELOW.)                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0727
*   CALL WRITEPTS(SMCNTRL);         /* WRITE TO SMPPTS (MCS ENTRY) 0727
*                                      AND AND SMPOUT.               */
@RF00720 LA    @01,@AL00727                                        0727
         BAL   @14,WRITEPTS                                        0727
*   IF RECXSYSM=OFF                 /* SYSMOD HEADER NOT BEEN FOUND  */
*     THEN                                                         0728
         TM    RECXSYSM,B'01000000'                                0728
         BNZ   @RF00728                                            0728
*     DO;                                                          0729
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0730
*       CALL ERRMSG(HMA345I,NOPART,NOPART);/* ISSUE MESSAGE          */
         LA    @01,@AL00731                                        0731
         BAL   @14,ERRMSG                                          0731
*     END;                                                         0732
*                                                                  0733
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FOR PROCESSING A NEW MODIFICATION CNTRL STMT       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0733
*   RECXPTXT=OFF;                   /* DO NOT EXPECT TEXT RECORDS TO
*                                      FOLLOW                        */
@RF00728 NI    RECXPTXT,B'11011111'                                0733
*   DUP347=OFF;                     /* CLEAR HMA347I MSG ISSUED FLAG */
         NI    DUP347,B'11110111'                                  0734
*   RECXPELM=OFF;                   /* CLEAR PROCESSING ELEMENT FLAG */
         NI    RECXPELM,B'11111011'                                0735
*   IF RECXMAX<STOPFUNC THEN                                       0736
         L     @15,RECXMAX                                         0736
         CH    @15,@CH00036                                        0736
         BNL   @RF00736                                            0736
*     DO;                                                          0737
*                                                                  0737
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP HMASMCRP PARAMETER LIST AND CALL HMASMMPD TO PARSE */
*       /* THE MODIFICATION CONTROL STATEMENT.                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0738
*       CRPBFPRM=OFF;               /* BUFFER NOT PRIMED FOR NEXT  0738
*                                      READ                          */
         NI    CRPBFPRM,B'01111111'                                0738
*       IF RECXSYSF=OFF THEN        /* FLUSHING SYSMOD ?             */
         TM    RECXSYSF,B'00010000'                                0739
         BNZ   @RF00739                                            0739
*         CRPPTS=ON;                /* NO ... WRITE TO SMPPTS        */
         OI    CRPPTS,B'00100000'                                  0740
*       ELSE                                                       0741
*         CRPPTS=OFF;               /* YES ... DO NOT WRITE TO SMPPTS*/
         B     @RC00739                                            0741
@RF00739 NI    CRPPTS,B'11011111'                                  0741
*       CRPLOG=OFF;                 /* DO NOT WRITE TO SMPLOG        */
@RC00739 DS    0H                                                  0743
*       CRPPRINT=ON;                /* WRITE TO SMPOUT               */
*       CRPOTHER=OFF;               /* DO NOT WRITE TO CRDOUTDS      */
         OI    CRPPRINT,B'00001000'                                0744
         NI    CRPLOG,B'11101011'                                  0744
*       CRPUXNUM=UXPUX001;          /* SET RECEIVE USER EXIT         */
         MVI   CRPUXNUM,X'01'                                      0745
*       MPPSMDNM=GSMS#;             /* SYSMOD-ID (MAY BE NULLPTF#)   */
         LA    @15,GTASM                                           0746
         MVC   MPPSMDNM(7),GSMS#(@15)                              0746
*       CALL HMASMMPD(MPPPARM);     /* PARSE THE STATEMENT           */
         L     @15,@CV01707                                        0747
         LA    @01,@AL00747                                        0747
         BALR  @14,@15                                             0747
*       RESPECIFY                                                  0748
*         REG15 RSTD;                                              0748
*       MPDRETRN=REG15;             /* SAVE PARSE RETURN CODE        */
         ST    REG15,MPDRETRN                                      0749
*       RESPECIFY                                                  0750
*         REG15 UNRSTD;                                            0750
*       IF MPDRETRN>0 THEN                                         0751
         L     @15,MPDRETRN                                        0751
         LTR   @15,@15                                             0751
         BNP   @RF00751                                            0751
*         CALL PARSERR;             /* PROCESS NON-ZERO PARSE CODES  */
         BAL   @14,PARSERR                                         0752
*       ELSE                                                       0753
*         DO;                                                      0753
*                                                                  0753
         B     @RC00751                                            0753
@RF00751 DS    0H                                                  0754
*           /*********************************************************/
*           /*                                                       */
*           /* PARSE RETURN CODE = 0 ... PROCESS STATEMENTS          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0754
*           IF MCBTYPE=MCBVERTP     /* ++VER STATEMENT               */
*             THEN                                                 0754
         L     @01,RECXMCB                                         0754
         CLI   MCBTYPE(@01),2                                      0754
         BNE   @RF00754                                            0754
*             CALL VERPROC;         /* PROCESS ++VER                 */
         BAL   @14,VERPROC                                         0755
*           ELSE                                                   0756
*             IF MCBTYPE=MCBIFTP    /* ++IF STATEMENT                */
*               THEN                                               0756
         B     @RC00754                                            0756
@RF00754 L     @01,RECXMCB                                         0756
         CLI   MCBTYPE(@01),3                                      0756
         BNE   @RF00756                                            0756
*               CALL IFPROC;        /* PROCESS ++IF                  */
         BAL   @14,IFPROC                                          0757
*             ELSE                                                 0758
*               IF MCBTYPE=MCBJCLTP /* ++JCLIN STATEMENT             */
*                 THEN                                             0758
         B     @RC00756                                            0758
@RF00756 L     @01,RECXMCB                                         0758
         CLI   MCBTYPE(@01),10                                     0758
         BNE   @RF00758                                            0758
*                 CALL JCLPROC;     /* PROCESS ++JCLIN               */
         BAL   @14,JCLPROC                                         0759
*               ELSE                                               0760
*                 IF MCBTYPE=MCBMODTP/* ++MOD STATEMENT              */
*                     ×MCBTYPE=MCBMCRTP/* ++MAC STATEMENT            */
*                     ×MCBTYPE=MCBSCRTP/* ++SRC STATEMENT            */
*                     ×MCBTYPE=MCBZAPTP/* ++ZAP STATEMENT            */
*                     ×MCBTYPE=MCBMCUTP/* ++MACUPD STATEMENT         */
*                     ×MCBTYPE=MCBSCUTP/* ++SRCUPD STATEMENT         */
*                   THEN                                           0760
         B     @RC00758                                            0760
@RF00758 L     @15,RECXMCB                                         0760
         CLI   MCBTYPE(@15),4                                      0760
         BE    @RT00760                                            0760
         CLI   MCBTYPE(@15),5                                      0760
         BE    @RT00760                                            0760
         CLI   MCBTYPE(@15),6                                      0760
         BE    @RT00760                                            0760
         CLI   MCBTYPE(@15),7                                      0760
         BE    @RT00760                                            0760
         CLI   MCBTYPE(@15),8                                      0760
         BE    @RT00760                                            0760
         CLI   MCBTYPE(@15),9                                      0760
         BNE   @RF00760                                            0760
@RT00760 DS    0H                                                  0761
*                   CALL ELEMPROC;  /* PROCESS ELEMENT STATEMENTS    */
         BAL   @14,ELEMPROC                                        0761
*                 ELSE                                             0762
*                   DO;                                            0762
*                                                                  0762
         B     @RC00760                                            0762
@RF00760 DS    0H                                                  0763
*                     /***********************************************/
*                     /*                                             */
*                     /* UN-KNOWN CONTROL TYPE OR SYNTAX ERROR       */
*                     /* DETECTED BY HMASMMPD PROCEDURE              */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0763
*                     RECXSYSF=ON;  /* FLUSH THE SYSMOD              */
         OI    RECXSYSF,B'00010000'                                0763
*                     GSMSYNTX=ON;  /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           0764
         OI    GSMSYNTX(@15),B'01000000'                           0764
*                   END;                                           0765
*         END;                                                     0766
*     END;                                                         0767
*   END CNTLPROC;                                                  0768
@EL00004 DS    0H                                                  0768
@EF00004 DS    0H                                                  0768
@ER00004 LM    @14,@12,@SA00004                                    0768
         BR    @14                                                 0768
*                                                                  0769
*/********************************************************************/
*/*                                                                  */
*/*    VERPROC - PROCESS ++VER MODIFICATION CONTROL STATEMENTS.      */
*/*                                                                  */
*/*        1. CHECK THE SREL/FMID GTA FILE TO DETERMINE WHETHER      */
*/*           ANOTHER ++VER IN THIS SYSMOD SPECIFIED THE SAME        */
*/*           SREL/FMID AS THIS ++VER.  IF SO, THIS SYSMOD WILL      */
*/*           BE "FLUSHED".                                          */
*/*                                                                  */
*/*        2. PUT THE SREL/FMID FROM THIS ++VER INTO THE SRELFMID    */
*/*           GTA FILE.                                              */
*/*                                                                  */
*/*        3. CHECK THE SREL/FMID SUPPLIED ON THIS ++VER AGAINST     */
*/*           THE PTS SYSTEM ENTRY TO DETERMINE THE APPLICABILITY    */
*/*           OF THIS SYSMOD.  SET RECXAVER FLAG "ON" IF THIS        */
*/*           ++VER IS APPLICABLE.                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0769
*VERPROC:                                                          0769
*   PROC;                                                          0769
VERPROC  STM   @14,@12,@SA00005                                    0769
*   DCL                                                            0770
*     VEROK CHAR(1);                /* LOCAL VER "OK" SWITCH         */
*   DCL                                                            0771
*     1 VERFLGS BIT(8),             /* LOCAL FLAGS                   */
*      2 SRELCHK BIT(1),            /* SREL MATCHES PTS SREL         */
*      2 FMIDCHK BIT(1),            /* FMID MATCHES PTS FMID         */
*      2 * BIT(6);                  /* UNUSED                        */
*                                                                  0771
*   /*****************************************************************/
*   /*                                                               */
*   /* SET RECEIVE PROCESSING FLAGS                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0772
*   RECXVERF=ON;                    /* SET VER FOUND INDICATOR       */
         OI    RECXVERF,B'10000000'                                0772
*   RECXPVER=ON;                    /* SET PROCESSING VER INDICATOR  */
*   RECXPIFS=OFF;                   /* CLEAR PROCESSING IF INDICATOR */
*                                                                  0774
         OI    RECXPVER,B'10000000'                                0774
         NI    RECXPIFS,B'10111111'                                0774
*   /*****************************************************************/
*   /*                                                               */
*   /* RE-INITIALIZE PROCESSING FLAGS                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0775
*   VERFLGS=''B;                    /* CLEAR LOCAL FLAGS             */
         MVI   VERFLGS,X'00'                                       0775
*   VEROK=YES;                      /* NO ERRORS ENCOUNTERED FOR VER */
         MVI   VEROK,C'Y'                                          0776
*   VERFMID=MCBSFMID;               /* SAVE CURRENT FMID OPERAND     */
         L     @01,RECXMCB                                         0777
         MVC   VERFMID(7),MCBSFMID(@01)                            0777
*                                                                  0778
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CONSTRUCTION ERRORS                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0778
*   IF RECXJCLF=ON                  /* JCLIN ALREADY FOUND           */
*       ×RECXMNDX>0                 /* SYSMOD ELEMENTS FOUND         */
*     THEN                                                         0778
         TM    RECXJCLF,B'00100000'                                0778
         BO    @RT00778                                            0778
         L     @15,RECXMNDX                                        0778
         LTR   @15,@15                                             0778
         BNP   @RF00778                                            0778
@RT00778 DS    0H                                                  0779
*     DO;                                                          0779
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                0780
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           0781
         OI    GSMSYNTX(@15),B'01000000'                           0781
*       VEROK=NO;                   /* SET SWITCH - DO NOT PERFORM 0782
*                                      SUBSEQUENT CHECKS             */
         MVI   VEROK,C'N'                                          0782
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0783
*       CALL ERRMSG(HMA345I,NOPART,NOPART);/* ISSUE HMA345I          */
         LA    @01,@AL00784                                        0784
         BAL   @14,ERRMSG                                          0784
*     END;                                                         0785
*                                                                  0786
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE THE RECEIVABILITY OF THIS SYSMOD BASED UPON THE     */
*   /* BYPASS OPTIONS AND THE SREL/FMID(S) IN THE PTS SYSTEM ENTRY   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0786
*   IF RECXAVER=OFF                 /* APPLICABLE VER NOT YET FOUND  */
*       &RECXMAX<STOPFUNC           /* NOT TERMINATING RECEIVE       */
*       &VEROK=YES                  /* NO ERRORS FOR THIS ++VER      */
*     THEN                                                         0786
@RF00778 TM    RECXAVER,B'01000000'                                0786
         BNZ   @RF00786                                            0786
         L     @15,RECXMAX                                         0786
         CH    @15,@CH00036                                        0786
         BNL   @RF00786                                            0786
         CLI   VEROK,C'Y'                                          0786
         BNE   @RF00786                                            0786
*     DO;                                                          0787
*       RESPECIFY                                                  0788
*         HMASMGTP BASED(RECXGPSP); /* PTS SYSTEM GTP                */
*       IF RECXIOPP->IOPPTYPE=IOPPFUNC/* FUNCTION-TYPE SYSMOD        */
*         THEN                                                     0789
         L     @01,RECXIOPP                                        0789
         CLI   IOPPTYPE(@01),4                                     0789
         BNE   @RF00789                                            0789
*         FMIDCHK=ON;               /* FMID CHK IS N/A FOR FUNCTIONS */
         OI    FMIDCHK,B'01000000'                                 0790
*       ELSE                                                       0791
*         DO;                                                      0791
*                                                                  0791
         B     @RC00789                                            0791
@RF00789 DS    0H                                                  0792
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FMID FOR NON-FUNCTION-TYPE SYSMODS              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0792
*           IF RECBPFM=OFF          /* FMID CRITERIA NOT BYPASSED    */
*             THEN                                                 0792
         L     @15,@PC00001                                        0792
         TM    RECBPFM(@15),B'00000100'                            0792
         BNZ   @RF00792                                            0792
*             DO;                                                  0793
*                                                                  0793
*               /*****************************************************/
*               /*                                                   */
*               /* FMID SELECTION CRITERIA IS NOT BYPASSED ... CHECK */
*               /* THIS VER'S FMID AGAINST PTS SYSTEM ENTRY          */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0794
*               GPSTYPE=IOPPTFM;    /* KEY: TYPE IS FMID             */
         LA    @15,GTAPS                                           0794
         MVI   GPSTYPE(@15),X'01'                                  0794
*               IF MCBSFMID=NULLPTF#/* NO FMID ON ++VER              */
*                 THEN                                             0795
         L     @01,RECXMCB                                         0795
         CLC   MCBSFMID(7,@01),@CC01733                            0795
         BNE   @RF00795                                            0795
*                 GPSENT=CCAFMID;   /* USE CCAFMID FOR GTA LOCATE    */
         MVC   GPSENT(7,@15),CCAFMID(CCAPTR)                       0796
*               ELSE                                               0797
*                 GPSENT=MCBSFMID;  /* USE MCB FMID FOR GTA LOCATE   */
         B     @RC00795                                            0797
@RF00795 LA    @15,GTAPS                                           0797
         L     @14,RECXMCB                                         0797
         MVC   GPSENT(7,@15),MCBSFMID(@14)                         0797
*               GTPFUNCT=GTPLOC;    /* LOCATE FUNCTION               */
@RC00795 L     @15,RECXGPSP                                        0798
         MVI   GTPFUNCT(@15),X'03'                                 0798
*               CALL HMASMGTA(HMASMGTP);/* SEE IF FIMD IS IN PTS   0799
*                                      SYSTEM ENTRY                  */
         ST    @15,@AL00001                                        0799
         L     @15,@CV01706                                        0799
         LA    @01,@AL00001                                        0799
         BALR  @14,@15                                             0799
*               IF GTPRETRN=GTPGOOD THEN                           0800
         L     @01,RECXGPSP                                        0800
         CLI   GTPRETRN(@01),0                                     0800
         BNE   @RF00800                                            0800
*                 FMIDCHK=ON;       /* FMID IS APPLICABLE TO THIS PTS*/
         OI    FMIDCHK,B'01000000'                                 0801
*             END;                                                 0802
*           ELSE                                                   0803
*             FMIDCHK=ON;           /* FMID CHECK IS BYPASSED        */
         B     @RC00792                                            0803
@RF00792 OI    FMIDCHK,B'01000000'                                 0803
*         END;                                                     0804
@RC00792 DS    0H                                                  0805
*       IF FMIDCHK=ON THEN                                         0805
@RC00789 TM    FMIDCHK,B'01000000'                                 0805
         BNO   @RF00805                                            0805
*         DO;                                                      0806
*                                                                  0806
*           /*********************************************************/
*           /*                                                       */
*           /* THE FMID ON THIS VER IS "OK" ... CHECK ALL SRELS      */
*           /* AGAINST THE PTS SYSTEM ENTRY                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0807
*           GPSENT=' ';             /* BLANK ENTRY FIELD IN PTS SYS
*                                      RECORD                        */
*                                                                  0807
         LA    @15,GTAPS                                           0807
         MVI   GPSENT+1(@15),C' '                                  0807
         MVC   GPSENT+2(5,@15),GPSENT+1(@15)                       0807
         MVI   GPSENT(@15),C' '                                    0807
*           /*********************************************************/
*           /*                                                       */
*           /* GO THRU THE SRELS SPECIFIED ON THIS ++VER AND COMPARE */
*           /* THEM TO SRELS IN THE PTS SYSTEM ENTRY                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0808
*           DO II=1 BY 1 WHILE MCBVND(II)^=IOPEOLST/* NOT AT END     */
*                 &SRELCHK=OFF;     /* SREL NOT FOUND IN PTS         */
         LA    @15,1                                               0808
         ST    @15,II                                              0808
         B     @DE00808                                            0808
@DL00808 DS    0H                                                  0809
*             IF MCBVIND(II)=IOPPSREL THEN                         0809
         L     @15,RECXMCB                                         0809
         L     @14,II                                              0809
         MH    @14,@CH00034                                        0809
         SLR   @07,@07                                             0809
         IC    @07,MCBVIND-9(@14,@15)                              0809
         CH    @07,@CH01190                                        0809
         BNE   @RF00809                                            0809
*               DO;                                                0810
*                                                                  0810
*                 /***************************************************/
*                 /*                                                 */
*                 /* SREL FOUND IN MCB ... LOOK FOR IT IN PTS SYSTEM */
*                 /* ENTRY GTA FILE                                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0811
*                 GPSTYPE=IOPPTSRL; /* KEY: TYPE IS SREL             */
         LA    @07,GTAPS                                           0811
         MVI   GPSTYPE(@07),X'02'                                  0811
*                 GPSENT(1:4)=MCBVNUM(II,1:4);/* KEY: SREL VALUE     */
         ALR   @14,@15                                             0812
         BCTR  @14,0                                               0812
         MVC   GPSENT(4,@07),MCBVNUM-8(@14)                        0812
*                 GSRFMID=MCBSFMID; /* PUT FMID IN SRELFMID RECORD 0813
*                                      KEY                           */
         LA    @14,GTASR                                           0813
         MVC   GSRFMID(7,@14),MCBSFMID(@15)                        0813
*                 GTPFUNCT=GTPLOC;  /* LOCATE FUNCTION               */
         L     @15,RECXGPSP                                        0814
         MVI   GTPFUNCT(@15),X'03'                                 0814
*                 CALL HMASMGTA(HMASMGTP);/* SEE IF THERE IS A MATCH */
         ST    @15,@AL00001                                        0815
         L     @15,@CV01706                                        0815
         LA    @01,@AL00001                                        0815
         BALR  @14,@15                                             0815
*                 IF GTPRETRN=GTPGOOD THEN                         0816
*                                                                  0816
         L     @01,RECXGPSP                                        0816
         CLI   GTPRETRN(@01),0                                     0816
         BNE   @RF00816                                            0816
*                   /*************************************************/
*                   /*                                               */
*                   /* FOUND IN PTS SYS ENTRY => APPLICABLE ++VER    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0817
*                   SRELCHK=ON;     /* SREL MATCHES PTS SREL         */
         OI    SRELCHK,B'10000000'                                 0817
*               END;                                               0818
@RF00816 DS    0H                                                  0819
*           END;                                                   0819
@RF00809 LA    @15,1                                               0819
         AL    @15,II                                              0819
         ST    @15,II                                              0819
@DE00808 L     @15,II                                              0819
         MH    @15,@CH00034                                        0819
         L     @01,RECXMCB                                         0819
         BCTR  @01,0                                               0819
         SLR   @14,@14                                             0819
         IC    @14,MCBVND-8(@15,@01)                               0819
         CH    @14,@CH00766                                        0819
         BE    @DC00808                                            0819
         TM    SRELCHK,B'10000000'                                 0819
         BZ    @DL00808                                            0819
@DC00808 DS    0H                                                  0820
*         END;                                                     0820
*     END;                                                         0821
@RF00805 DS    0H                                                  0822
*                                                                  0822
*   /*****************************************************************/
*   /*                                                               */
*   /* VALIDITY CHECK THE ++VER                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0822
*   IF VEROK=YES                    /* NO ERRORS FOR THIS ++VER      */
*       &RECXMAX<STOPFUNC           /* NO TERMINATING ERRORS         */
*     THEN                                                         0822
@RF00786 CLI   VEROK,C'Y'                                          0822
         BNE   @RF00822                                            0822
         L     @15,RECXMAX                                         0822
         CH    @15,@CH00036                                        0822
         BNL   @RF00822                                            0822
*     CALL VERCHK(VEROK);           /* CHECK THIS ++VER              */
         LA    @01,@AL00823                                        0823
         BAL   @14,VERCHK                                          0823
*   IF VEROK=YES                    /* VALIDITY CHECK SUCCESSFUL     */
*       &SRELCHK=ON                 /* AN SREL MATCHES A PTS SREL    */
*       &FMIDCHK=ON                 /* FMID MATCHES A PTS FMID       */
*       &RECXMAX<STOPFUNC           /* NO TERMINATING ERRORS         */
*     THEN                                                         0824
@RF00822 CLI   VEROK,C'Y'                                          0824
         BNE   @RF00824                                            0824
         TM    SRELCHK,B'11000000'                                 0824
         BNO   @RF00824                                            0824
         L     @15,RECXMAX                                         0824
         CH    @15,@CH00036                                        0824
         BNL   @RF00824                                            0824
*     RECXAVER=ON;                  /* SET APPLICABLE ++VER FOUND    */
         OI    RECXAVER,B'01000000'                                0825
*   RETURN;                                                        0826
@EL00005 DS    0H                                                  0826
@EF00005 DS    0H                                                  0826
@ER00005 LM    @14,@12,@SA00005                                    0826
         BR    @14                                                 0826
*   END VERPROC;                                                   0827
         B     @EL00005                                            0827
*                                                                  0828
*/********************************************************************/
*/*                                                                  */
*/*    IFPROC - PROCESS ++IF MODIFICATION CONTROL STATEMENTS         */
*/*                                                                  */
*/*           MAKE SURE THAT THE ++IF STATEMENT IS ASSOCIATED        */
*/*           WITH A PRECEDING ++VER STATEMENT.  IF NOT, THE         */
*/*           CURRENT SYSMOD IS SET TO BE "FLUSHED".                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0828
*IFPROC:                                                           0828
*   PROC;                                                          0828
IFPROC   STM   @14,@12,@SA00006                                    0828
*   IF RECXPVER=OFF THEN                                           0829
         TM    RECXPVER,B'10000000'                                0829
         BNZ   @RF00829                                            0829
*     DO;                                                          0830
*                                                                  0830
*       /*************************************************************/
*       /*                                                           */
*       /* THE ++IF STATEMENT DOES NOT FOLLOW A ++VER ... ISSUE      */
*       /* HMA349I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0831
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                0831
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           0832
         OI    GSMSYNTX(@15),B'01000000'                           0832
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0833
*       CALL ERRMSG(HMA349I,NOPART,NOPART);/* ++IF STMT NOT        0834
*                                      ASSOCIATED WITH ANY PRECEDING
*                                      ++VER.                        */
         LA    @01,@AL00834                                        0834
         BAL   @14,ERRMSG                                          0834
*     END;                                                         0835
*   ELSE                                                           0836
*     DO;                                                          0836
*                                                                  0836
         B     @RC00829                                            0836
@RF00829 DS    0H                                                  0837
*       /*************************************************************/
*       /*                                                           */
*       /* THE ++IF STATEMENT IS ASSOCIATED WITH A PREVIOUS ++VER    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0837
*       IF MCBIFENV=VERFMID THEN                                   0837
         L     @01,RECXMCB                                         0837
         CLC   MCBIFENV(7,@01),VERFMID                             0837
         BNE   @RF00837                                            0837
*         DO;                                                      0838
*                                                                  0838
*           /*********************************************************/
*           /*                                                       */
*           /* ++IF FMID OPERAND = ++VER FMID OPERAND ... ISSUE      */
*           /* HMA363I/PART095                                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0839
*           RECXSYSF=ON;            /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                0839
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           0840
         OI    GSMSYNTX(@15),B'01000000'                           0840
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0841
*           CALL ERRMSG(HMA363I,PART095,NOPART);                   0842
         LA    @01,@AL00842                                        0842
         BAL   @14,ERRMSG                                          0842
*         END;                                                     0843
*       IF MCBIFENV=RECXIOPP->IOPNAM17 THEN                        0844
@RF00837 L     @01,RECXMCB                                         0844
         L     @15,RECXIOPP                                        0844
         CLC   MCBIFENV(7,@01),IOPNAM17(@15)                       0844
         BNE   @RF00844                                            0844
*         DO;                                                      0845
*                                                                  0845
*           /*********************************************************/
*           /*                                                       */
*           /* ++IF FMID OPERAND = CURRENT SYSMOD'S NAME ... ISSUE   */
*           /* HMA363I/PART096                                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0846
*           RECXSYSF=ON;            /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                0846
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           0847
         OI    GSMSYNTX(@15),B'01000000'                           0847
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0848
*           CALL ERRMSG(HMA363I,PART096,NOPART);                   0849
         LA    @01,@AL00849                                        0849
         BAL   @14,ERRMSG                                          0849
*         END;                                                     0850
*     END;                                                         0851
*   RETURN;                                                        0852
@EL00006 DS    0H                                                  0852
@EF00006 DS    0H                                                  0852
@ER00006 LM    @14,@12,@SA00006                                    0852
         BR    @14                                                 0852
*   END IFPROC;                                                    0853
         B     @EL00006                                            0853
*                                                                  0854
*/********************************************************************/
*/*                                                                  */
*/*    JCLPROC - PROCESS ++JCLIN MODIFICATION CONTROL STATEMENTS     */
*/*                                                                  */
*/*        1. CHECK WHETHER AN APPLICABLE ++VER HAS BEEN FOUND.      */
*/*           IF NOT, THIS SYSMOD IS SET TO BE "FLUSHED".            */
*/*                                                                  */
*/*        2. INSURE THAT NO ++JCLIN HAS YET BEEN PROCESSED FOR      */
*/*           THIS SYSMOD.  IF SO, THIS SYSMOD IS SET TO BE          */
*/*           "FLUSHED".                                             */
*/*                                                                  */
*/*        3. IF THE JCLIN DATA IS EXPECTED IN-LINE (I.E., NOT ON    */
*/*           A TXLIB OR RELFILE), SET RECXPTXT "ON" TO INIDCATE     */
*/*           THAT TEXT IS EXPECTED.                                 */
*/*                                                                  */
*/*        4. CALL RCTPROC TO SAVE RELFILE PARAMETER DATA (IF        */
*/*           PRESENT.)                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0854
*JCLPROC:                                                          0854
*   PROC;                                                          0854
JCLPROC  STM   @14,@12,@SA00007                                    0854
*   RECXPTXT=OFF;                   /* TEXT RECORDS NOT EXPECTED     */
*   RECXPUPD=OFF;                   /* NOT PROCESSING UPDATE ELEM    */
*   RECXPVER=OFF;                   /* NOT PROCESSING ++VER          */
*   RECXPELM=ON;                    /* PROCESSING AN ELEMENT         */
         OI    RECXPELM,B'00000100'                                0858
         NI    RECXPTXT,B'01010111'                                0858
*   RECXRELM=0;                     /* CURRENT JCLIN HAS NO RELFILE  */
         SLR   @15,@15                                             0859
         STH   @15,RECXRELM                                        0859
*   IF RECXAVER=OFF THEN                                           0860
         TM    RECXAVER,B'01000000'                                0860
         BNZ   @RF00860                                            0860
*     DO;                                                          0861
*                                                                  0861
*       /*************************************************************/
*       /*                                                           */
*       /* AN APPLICABLE ++VER HAS NOT BEEN FOUND. THIS SYSMOD MUST  */
*       /* BE FLUSHED.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0862
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                0862
*       IF RECXVERF=ON              /* SOME ++VER HAS BEEN FOUND     */
*           &GSMSYNTX=OFF           /* NO SYNTAX/CONSTRUCTION ERRORS */
*         THEN                                                     0863
         TM    RECXVERF,B'10000000'                                0863
         BNO   @RF00863                                            0863
         LA    @15,GTASM                                           0863
         TM    GSMSYNTX(@15),B'01000000'                           0863
         BNZ   @RF00863                                            0863
*         DO;                                                      0864
*           GSMNAVER=ON;            /* SET NOT APPLICABLE IN SUMMARY */
         OI    GSMNAVER(@15),B'00001000'                           0865
*           MCSCHECK=OFF;           /* SUPPRESS MOD.CNTL.STMT. CHECKS*/
         NI    MCSCHECK,B'11111101'                                0866
*         END;                                                     0867
*       ELSE                                                       0868
*         GSMSYNTX=ON;              /* SET SYNTAX/CONSTRUCTION ERROR
*                                      FOR NO ++VER FOUND CONDITION  */
         B     @RC00863                                            0868
@RF00863 LA    @15,GTASM                                           0868
         OI    GSMSYNTX(@15),B'01000000'                           0868
*     END;                                                         0869
*                                                                  0869
@RC00863 DS    0H                                                  0870
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS JCLIN                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0870
*   IF RECXJCLF=ON THEN                                            0870
@RF00860 TM    RECXJCLF,B'00100000'                                0870
         BNO   @RF00870                                            0870
*     DO;                                                          0871
*                                                                  0871
*       /*************************************************************/
*       /*                                                           */
*       /* IN-LINE JCLIN HAS ALREADY BEEN PROCESSED FOR FOR THIS     */
*       /* SYSMOD (HMA342I ISSUED BY HMASMMPE).                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0872
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                0872
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           0873
         OI    GSMSYNTX(@15),B'01000000'                           0873
*     END;                                                         0874
*   ELSE                                                           0875
*     DO;                                                          0875
*                                                                  0875
         B     @RC00870                                            0875
@RF00870 DS    0H                                                  0876
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS IN-LINE JCLIN                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0876
*       IF MCBERLF(1)^=' ' THEN                                    0876
         L     @01,RECXMCB                                         0876
         CLI   MCBERLF(@01),C' '                                   0876
         BE    @RF00876                                            0876
*         CALL RCTPROC;             /* JCLIN IS ON A RELFILE         */
         BAL   @14,RCTPROC                                         0877
*       ELSE                                                       0878
*         IF MCBETXLB(1)=' ' THEN                                  0878
         B     @RC00876                                            0878
@RF00876 L     @01,RECXMCB                                         0878
         CLI   MCBETXLB(@01),C' '                                  0878
         BNE   @RF00878                                            0878
*           RECXPTXT=ON;            /* JCLIN IS NOT ON A RELFILE OR
*                                      TXLIB, THEREFORE, TEXT IS   0879
*                                      EXPECTED.                     */
         OI    RECXPTXT,B'00100000'                                0879
*     END;                                                         0880
@RF00878 DS    0H                                                  0880
@RC00876 DS    0H                                                  0881
*   RECXJCLF=ON;                    /* INDICATE IN-LINE JCLIN FOUND  */
@RC00870 OI    RECXJCLF,B'00100000'                                0881
*   RETURN;                                                        0882
@EL00007 DS    0H                                                  0882
@EF00007 DS    0H                                                  0882
@ER00007 LM    @14,@12,@SA00007                                    0882
         BR    @14                                                 0882
*   END JCLPROC;                                                   0883
*                                                                  0884
*/********************************************************************/
*/*                                                                  */
*/*    ELEMPROC - PROCESS ++MOD, ++MAC, ++SRC, ++MACUPD, ++SRCUPD    */
*/*               AND ++ZAP MODIFICATION CONTROL STATEMENTS.         */
*/*                                                                  */
*/*        1. CHECK WHETHER AN APPLICABLE ++VER HAS BEEN FOUND.      */
*/*           IF NOT, THIS SYSMOD IS SET TO BE "FLUSHED".            */
*/*                                                                  */
*/*        2. CHECK WHETHER THE CURRENT SYSMOD HAS SUPPLIED:         */
*/*                                                                  */
*/*           (1) MORE THAN 1 REPLACEMENT FOR A GIVEN ELEMENT,       */
*/*           (2) MORE THAN 1 UPDATE FOR A GIVEN ELEMENT,            */
*/*           (3) AN UPDATE AND A REPLACEMENT FOR A GIVEN ELEMENT.   */
*/*                                                                  */
*/*           IF ANY OF THE ABOVE CONDITIONS ARE FOUND TO BE TRUE    */
*/*           THE SYSMOD IS SET TO BE FLUSHED.                       */
*/*                                                                  */
*/*        3. IF IN-LINE TEXT IS EXPECTED FOR THIS ELEMENT (I.E.,    */
*/*           NOT TXLIB, LKLIB OR RELFILE), SET RECXPTXT "ON" TO     */
*/*           INDICATE THAT SUCH TEXT IS EXPECTED.                   */
*/*                                                                  */
*/*        4. CALL RCTPROC TO SAVE RELFILE PARAMETER DATA (IF        */
*/*           PRESENT.)                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0884
*ELEMPROC:                                                         0884
*   PROC;                                                          0884
ELEMPROC STM   @14,@12,@SA00008                                    0884
*   DCL                                                            0885
*     INVELMN(3) FIXED(8);          /* INVALID ELEM COMBINATION ARRAY*/
*   DCL                                                            0886
*     MM FIXED(15);                 /* INDEX - IOP SUBENTRIES        */
*   DCL                                                            0887
*     NN FIXED(15);                 /* INDEX - INVELMN ARRAY         */
*   RECXMNDX=RECXMNDX+1;            /* MAINTAIN COUNT OF ELEMENTS    */
*                                                                  0888
         LA    @15,1                                               0888
         AL    @15,RECXMNDX                                        0888
         ST    @15,RECXMNDX                                        0888
*   /*****************************************************************/
*   /*                                                               */
*   /* RE-INITIALIZE ELEMENT PROCESSING FLAGS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0889
*   RECXPTXT=OFF;                   /* TEXT RECORDS NOT EXPECTED     */
*   RECXTXTF=OFF;                   /* TEXT RECORDS NOT FOUND        */
*   RECXPUPD=OFF;                   /* NOT PROCESSING UPDATE ELEM    */
*   RECXPVER=OFF;                   /* NOT PROCESSING ++VER          */
*   RECXPELM=ON;                    /* PROCESSING AN ELEMENT         */
         OI    RECXPELM,B'00000100'                                0893
         NI    RECXPTXT,B'01000111'                                0893
*   RECXRELM=0;                     /* CURRENT ELEMENT HAS NO RELFILE*/
         SLR   @15,@15                                             0894
         STH   @15,RECXRELM                                        0894
*   UPDCHG=OFF;                     /* IEBUPDTE ./CHANGE NOT FOUND   */
*   UPDEND=OFF;                     /* IEBUPDTE ./ENDUP NOT FOUND    */
*   DUP362=OFF;                     /* HMASM362 HAS BEEN ISSUED      */
         NI    UPDCHG,B'00111011'                                  0897
*   IF RECXAVER=OFF THEN                                           0898
         TM    RECXAVER,B'01000000'                                0898
         BNZ   @RF00898                                            0898
*     DO;                                                          0899
*                                                                  0899
*       /*************************************************************/
*       /*                                                           */
*       /* AN APPLICABLE ++VER HAS NOT BEEN FOUND. THIS SYSMOD MUST  */
*       /* BE FLUSHED.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0900
*       RECXSYSF=ON;                /* THIS WILL STOP RECORDS FROM 0900
*                                      BEING WRITTEN TO THE PTS      */
         OI    RECXSYSF,B'00010000'                                0900
*       IF RECXVERF=ON              /* SOME ++VER HAS BEEN FOUND     */
*           &GSMSYNTX=OFF           /* NO SYNTAX/CONSTRUCTION ERRORS */
*         THEN                                                     0901
         TM    RECXVERF,B'10000000'                                0901
         BNO   @RF00901                                            0901
         LA    @15,GTASM                                           0901
         TM    GSMSYNTX(@15),B'01000000'                           0901
         BNZ   @RF00901                                            0901
*         DO;                                                      0902
*           GSMNAVER=ON;            /* SET NOT APPLICABLE IN SUMMARY */
         OI    GSMNAVER(@15),B'00001000'                           0903
*           MCSCHECK=OFF;           /* SUPPRESS MOD.CNTL.STMT. CHECKS*/
         NI    MCSCHECK,B'11111101'                                0904
*         END;                                                     0905
*       ELSE                                                       0906
*         GSMSYNTX=ON;              /* SET SYNTAX/CONSTRUCTION ERROR
*                                      FOR NO ++VER FOUND CONDITION  */
         B     @RC00901                                            0906
@RF00901 LA    @15,GTASM                                           0906
         OI    GSMSYNTX(@15),B'01000000'                           0906
*     END;                                                         0907
@RC00901 DS    0H                                                  0908
*                                                                  0908
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ELEMENT                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0908
*   IF MCBERLF(1)^=' '              /* RELFILE KEYWORD OPERAND       */
*     THEN                                                         0908
@RF00898 L     @01,RECXMCB                                         0908
         CLI   MCBERLF(@01),C' '                                   0908
         BE    @RF00908                                            0908
*     CALL RCTPROC;                 /* PROCESS RELFILE OPERAND       */
         BAL   @14,RCTPROC                                         0909
*   ELSE                                                           0910
*     IF MCBETXLB(1)=' '            /* ELEMENT NOT ON TXLIB          */
*         &MCBELKLB(1)=' '          /* ELEMENT NOT ON LKLIB          */
*         &MCBEDEL(1)=OFF           /* DELETE NOT SPECIFIED          */
*       THEN                                                       0910
         B     @RC00908                                            0910
@RF00908 L     @15,RECXMCB                                         0910
         CLI   MCBETXLB(@15),C' '                                  0910
         BNE   @RF00910                                            0910
         CLI   MCBELKLB(@15),C' '                                  0910
         BNE   @RF00910                                            0910
         TM    MCBEDEL(@15),B'01000000'                            0910
         BNZ   @RF00910                                            0910
*       RECXPTXT=ON;                /* TEXT RECORDS ARE EXPECTED TO
*                                      FOLLOW THIS ELEMENT STATEMENT */
         OI    RECXPTXT,B'00100000'                                0911
*   IF MCBTYPE=MCBMCUTP             /* ++MACUPD ELEMENT              */
*       ×MCBTYPE=MCBSCUTP           /* ++SRCUPD ELEMENT              */
*     THEN                                                         0912
@RF00910 DS    0H                                                  0912
@RC00908 L     @15,RECXMCB                                         0912
         CLI   MCBTYPE(@15),8                                      0912
         BE    @RT00912                                            0912
         CLI   MCBTYPE(@15),9                                      0912
         BNE   @RF00912                                            0912
@RT00912 DS    0H                                                  0913
*     RECXPUPD=ON;                  /* INDICATE UPDATE TEXT EXPECTED */
         OI    RECXPUPD,B'00001000'                                0913
*                                                                  0914
*/********************************************************************/
*/*                                                                  */
*/*  CHECK FOR INVALID ELEMENT COMBINATIONS AS FOLLOWS:              */
*/*                                                                  */
*/*              MOD  ×  ZAP  ×  SRC  ×  SRCUPD  ×  MAC  × MACUPD ×  */
*/*            ×------×-------×-------×----------×-------×--------×  */
*/*     MOD    ×      ×  INV  ×  OK   ×    OK    ×  OK   ×   OK   ×  */
*/*            ×------×-------×-------×----------×-------×--------×  */
*/*     ZAP    × INV  ×       ×  INV  ×   INV    ×  OK   ×   OK   ×  */
*/*            ×------×-------×-------×----------×-------×--------×  */
*/*     SRC    ×  OK  ×  INV  ×       ×   INV    ×  OK   ×   OK   ×  */
*/*            ×------×-------×-------×----------×-------×--------×  */
*/*     SRCUPD ×  OK  ×  INV  ×  INV  ×          ×  OK   ×   OK   ×  */
*/*            ×------×-------×-------×----------×-------×--------×  */
*/*     MAC    ×  OK  ×  OK   ×  OK   ×    OK    ×       ×  INV   ×  */
*/*            ×------×-------×-------×----------×-------×--------×  */
*/*     MACUPD ×  OK  ×  OK   ×  OK   ×    OK    ×  INV  ×        ×  */
*/*            ×------×-------×-------×----------×-------×--------×  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0914
*   DO MM=1 BY 1 TO DIM(INVELMN);   /* CLEAR INVELMN ARRAY           */
@RF00912 LA    @15,1                                               0914
         STH   @15,MM                                              0914
@DL00914 DS    0H                                                  0915
*     INVELMN(MM)=ZERO;                                            0915
         SLR   @14,@14                                             0915
         STC   @14,INVELMN-1(@15)                                  0915
*   END;                                                           0916
*                                                                  0916
         AL    @15,@CF00041                                        0916
         STH   @15,MM                                              0916
         CH    @15,@CH00043                                        0916
         BNH   @DL00914                                            0916
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INVELNM ARRAY WITH IOPPIND VALUES FOR ELEMENTS     */
*   /* WHICH ARE INVALID IN COMBINATION WITH THE ELEMENT BEING       */
*   /* PROCESSED                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0917
*   IF MCBTYPE=MCBMODTP             /* ++MOD ELEMENT                 */
*     THEN                                                         0917
         L     @01,RECXMCB                                         0917
         CLI   MCBTYPE(@01),4                                      0917
         BNE   @RF00917                                            0917
*     DO;                                                          0918
*       INVELMN(1)=IOPPZAP;         /* ZAP TO ELEMENT IS INVALID     */
         MVI   INVELMN,X'02'                                       0919
*       VPART#1=MSGMOD;             /* SET UP FOR ERROR MESSAGE      */
         MVC   VPART#1(8),MSGMOD                                   0920
*     END;                                                         0921
*   IF MCBTYPE=MCBZAPTP             /* ++ZAP ELEMENT                 */
*     THEN                                                         0922
@RF00917 L     @01,RECXMCB                                         0922
         CLI   MCBTYPE(@01),7                                      0922
         BNE   @RF00922                                            0922
*     DO;                                                          0923
*       INVELMN(1)=IOPPMOD;         /* MOD ELEMENT IS INVALID        */
         MVI   INVELMN,X'01'                                       0924
*       INVELMN(2)=IOPPSRCR;        /* SRC ELEMENT IS INVALID        */
         MVI   INVELMN+1,X'06'                                     0925
*       INVELMN(3)=IOPPSRCU;        /* SRCUPD TO ELEMENT IS INVALID  */
         MVI   INVELMN+2,X'07'                                     0926
*       VPART#1=MSGZAP;             /* SET UP FOR ERROR MESSAGE      */
         MVC   VPART#1(8),MSGZAP                                   0927
*     END;                                                         0928
*   IF MCBTYPE=MCBSCRTP             /* ++SRC ELEMENT                 */
*     THEN                                                         0929
@RF00922 L     @01,RECXMCB                                         0929
         CLI   MCBTYPE(@01),6                                      0929
         BNE   @RF00929                                            0929
*     DO;                                                          0930
*       INVELMN(1)=IOPPZAP;         /* ZAP TO ELEMENT IS INVALID     */
         MVI   INVELMN,X'02'                                       0931
*       INVELMN(2)=IOPPSRCU;        /* SRCUPD TO ELEMENT IS INVALID  */
         MVI   INVELMN+1,X'07'                                     0932
*       VPART#1=MSGSRCR;            /* SET UP FOR ERROR MESSAGE      */
         MVC   VPART#1(8),MSGSRCR                                  0933
*     END;                                                         0934
*   IF MCBTYPE=MCBSCUTP             /* ++SRCUPD ELEMENT              */
*     THEN                                                         0935
@RF00929 L     @01,RECXMCB                                         0935
         CLI   MCBTYPE(@01),9                                      0935
         BNE   @RF00935                                            0935
*     DO;                                                          0936
*       INVELMN(1)=IOPPZAP;         /* ZAP TO ELEMENT IS INVALID     */
         MVI   INVELMN,X'02'                                       0937
*       INVELMN(2)=IOPPSRCR;        /* SRC ELEMENT IS INVALID        */
         MVI   INVELMN+1,X'06'                                     0938
*       VPART#1=MSGSRCU;            /* SET UP FOR ERROR MESSAGE      */
         MVC   VPART#1(8),MSGSRCU                                  0939
*     END;                                                         0940
*   IF MCBTYPE=MCBMCRTP             /* ++MAC ELEMENT                 */
*     THEN                                                         0941
@RF00935 L     @01,RECXMCB                                         0941
         CLI   MCBTYPE(@01),5                                      0941
         BNE   @RF00941                                            0941
*     DO;                                                          0942
*       INVELMN(1)=IOPPMACU;        /* MACUPD TO ELEMENT IS INVALID  */
         MVI   INVELMN,X'05'                                       0943
*       VPART#1=MSGMACR;            /* SET UP FOR ERROR MESSAGE      */
         MVC   VPART#1(8),MSGMACR                                  0944
*     END;                                                         0945
*   IF MCBTYPE=MCBMCUTP             /* ++MACUPD ELEMENT              */
*     THEN                                                         0946
@RF00941 L     @01,RECXMCB                                         0946
         CLI   MCBTYPE(@01),8                                      0946
         BNE   @RF00946                                            0946
*     DO;                                                          0947
*       INVELMN(1)=IOPPMACR;        /* MAC ELEMENT IS INVALID        */
         MVI   INVELMN,X'04'                                       0948
*       VPART#1=MSGMACU;            /* SET UP FOR ERROR MESSAGE      */
         MVC   VPART#1(8),MSGMACU                                  0949
*     END;                                                         0950
*   RESPECIFY                                                      0951
*     HMASMIOP BASED(RECXIOPP);     /* ADDRESS SYSMOD IOP            */
@RF00946 DS    0H                                                  0952
*                                                                  0952
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ALL IOP SUBENTRIES                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0952
*   DO MM=1 BY 1 WHILE IOPPTFND(MM)^=IOPEOLST;                     0952
         LA    @15,1                                               0952
         STH   @15,MM                                              0952
         B     @DE00952                                            0952
@DL00952 DS    0H                                                  0953
*     IF IOPPMODS(MM)=MCBENAME      /* SUBENTRY NAME MATCHES CURRENT
*                                      ELEMENT                       */
*       THEN                                                       0953
         LH    @15,MM                                              0953
         MH    @15,@CH00034                                        0953
         L     @01,RECXIOPP                                        0953
         ALR   @01,@15                                             0953
         L     @15,RECXMCB                                         0953
         CLC   IOPPMODS-9(8,@01),MCBENAME(@15)                     0953
         BNE   @RF00953                                            0953
*       DO;                                                        0954
*                                                                  0954
*         /***********************************************************/
*         /*                                                         */
*         /* GO THRU THE INVELMN ARRAY TO SEE IF ENTRY TYPE IN IOP   */
*         /* MATCHES AN INVALID ENTRY TYPE IN INVELMN                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0955
*         DO NN=1 BY 1 TO DIM(INVELMN);                            0955
         LA    @15,1                                               0955
         STH   @15,NN                                              0955
@DL00955 DS    0H                                                  0956
*           IF IOPPIND(MM)=INVELMN(NN)/* IOP SUB-ENTRY MATCHES     0956
*                                      INVALID TYPE                  */
*             THEN                                                 0956
         LH    @14,MM                                              0956
         MH    @14,@CH00034                                        0956
         L     @01,RECXIOPP                                        0956
         SLR   @00,@00                                             0956
         IC    @00,IOPPIND-9(@14,@01)                              0956
         LA    @14,INVELMN-1(@15)                                  0956
         MVC   @ZT00003+3(1),0(@14)                                0956
         C     @00,@ZT00003                                        0956
         BNE   @RF00956                                            0956
*             DO;                                                  0957
*               CALL OPRNDKEY(INVELMN(NN),VPART#2);/* TRANSLATE IOP
*                                      SUB-ENTRY TYPE INTO EBCDIC  0958
*                                      STRING                        */
         LA    @15,INVELMN-1(@15)                                  0958
         ST    @15,@AL00001                                        0958
         LA    @15,VPART#2                                         0958
         ST    @15,@AL00001+4                                      0958
         LA    @01,@AL00001                                        0958
         BAL   @14,OPRNDKEY                                        0958
*               VPART#3=MCBENAME;   /* SETUP ELEMENT NAME FOR MSG    */
         L     @01,RECXMCB                                         0959
         MVC   VPART#3(8),MCBENAME(@01)                            0959
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0960
*               CALL ERRMSG(HMA378I,NOPART,NOPART);/* ISSUE MSG      */
         LA    @01,@AL00961                                        0961
         BAL   @14,ERRMSG                                          0961
*               RECXSYSF=ON;        /* SET TO FLUSH SYSMOD           */
         OI    RECXSYSF,B'00010000'                                0962
*               RECXGSMP->GTPBUFAD->GSMSYNTX=ON;/* SET SYNTAX ERROR
*                                      IN SUMMARY RECORD             */
         L     @01,RECXGSMP                                        0963
         L     @01,GTPBUFAD(,@01)                                  0963
         OI    GSMSYNTX(@01),B'01000000'                           0963
*             END;                                                 0964
*         END;                                                     0965
@RF00956 LA    @15,1                                               0965
         AH    @15,NN                                              0965
         STH   @15,NN                                              0965
         CH    @15,@CH00043                                        0965
         BNH   @DL00955                                            0965
*       END;                                                       0966
*   END;                                                           0967
@RF00953 LA    @15,1                                               0967
         AH    @15,MM                                              0967
         STH   @15,MM                                              0967
@DE00952 LH    @15,MM                                              0967
         MH    @15,@CH00034                                        0967
         L     @01,RECXIOPP                                        0967
         SLR   @14,@14                                             0967
         IC    @14,IOPPTFND-9(@15,@01)                             0967
         CH    @14,@CH00766                                        0967
         BNE   @DL00952                                            0967
*   RETURN;                                                        0968
@EL00008 DS    0H                                                  0968
@EF00008 DS    0H                                                  0968
@ER00008 LM    @14,@12,@SA00008                                    0968
         BR    @14                                                 0968
*   END ELEMPROC;                                                  0969
*                                                                  0970
*/********************************************************************/
*/*                                                                  */
*/*    TEXTPROC - PROCESS NON-MODIFICATION CONTROL STATEMENT RECORDS */
*/*                                                                  */
*/*        1. CHECK THAT IN-LINE TEXT RECORDS ARE EXPECTED           */
*/*           (RECXPTXT=ON).  IF NOT, ISSUE HMA273I AND SET          */
*/*           TO "FLUSH" THE CURRENT SYSMOD.                         */
*/*                                                                  */
*/*        2. SET RECXTXTF=ON TO INDICATE THAT IN-LINE TEXT RECORDS  */
*/*           HAVE BEEN FOUND FOR THE CURRENT ELEMENT.               */
*/*                                                                  */
*/*        3. IF PROCESSING UPDATE-TYPE ELEMENT TEXT RECORDS         */
*/*           (RECXPUPD=ON) AND COLUMNS 1-2 CONTAIN "./", CALL       */
*/*           UPDCHK TO INSURE THAT A SMP-RESTRICTED IEBUPDTE        */
*/*           CONTROL STATEMENT HAS NOT BEEN SUPPLIED.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0970
*TEXTPROC:                                                         0970
*   PROC;                                                          0970
*                                                                  0970
TEXTPROC STM   @14,@12,@SA00009                                    0970
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CONSTRUCTION ERRORS                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0971
*   IF RECXPTXT=ON THEN                                            0971
         TM    RECXPTXT,B'00100000'                                0971
         BNO   @RF00971                                            0971
*     DO;                                                          0972
*                                                                  0972
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESSING IN-LINE TEXT RECORDS                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0973
*       RECXTXTF=ON;                /* INDICATE TEXT RECORDS FOUND   */
         OI    RECXTXTF,B'00010000'                                0973
*       CALL WRITEPTS(NOTCNTRL);    /* WRITE RECORD TO SMPPTS TEXT 0974
*                                      ENTRY ONLY (NOT SMPOUT).      */
         LA    @01,@AL00974                                        0974
         BAL   @14,WRITEPTS                                        0974
*       IF RECXPUPD=ON              /* ++UPDTE OR ++SRCUPD TEXT ?    */
*         THEN                                                     0975
         TM    RECXPUPD,B'00001000'                                0975
         BNO   @RF00975                                            0975
*         CALL UPDCHK1;             /* YES ... CHECK EACH RECORD     */
         BAL   @14,UPDCHK1                                         0976
*     END;                                                         0977
*   ELSE                                                           0978
*     DO;                                                          0978
*                                                                  0978
         B     @RC00971                                            0978
@RF00971 DS    0H                                                  0979
*       /*************************************************************/
*       /*                                                           */
*       /* NOT PROCESSING IN-LINE TEXT RECORDS                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0979
*       IF DUP347=OFF               /* HMA347/HMA327 HAS NOT ALREADY
*                                      BEEN ISSUED FOR THESE RECORDS */
*           &MPDRETRN=0             /* NO PARSE ERROR ON LAST MOD. 0979
*                                      CNTRL. STMT.                  */
*         THEN                                                     0979
         TM    DUP347,B'00001000'                                  0979
         BNZ   @RF00979                                            0979
         L     @15,MPDRETRN                                        0979
         LTR   @15,@15                                             0979
         BNZ   @RF00979                                            0979
*         DO;                                                      0980
*                                                                  0980
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE HMA347I OR HMA327 AND FLUSH SYSMOD              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0981
*           RECXSYSF=ON;            /* FLUSH THE CURRENT SYSMOD      */
         OI    RECXSYSF,B'00010000'                                0981
*           DUP347=ON;              /* HMA347I HAS BEEN ISSUED       */
         OI    DUP347,B'00001000'                                  0982
*           CALL WRITEPTS(SMCNTRL); /* WRITE STATEMENT TO SMPOUT     */
         LA    @01,@AL00983                                        0983
         BAL   @14,WRITEPTS                                        0983
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0984
*           IF RECXPELM=OFF         /* NOT PROCESSING ELEMENT STMTS  */
*             THEN                                                 0985
         TM    RECXPELM,B'00000100'                                0985
         BNZ   @RF00985                                            0985
*             CALL ERRMSG(HMA347I,NOPART,NOPART);/* INVALID RECORD 0986
*                                      ... MODIFICATION CNTRL STMT 0986
*                                      EXPECTED.                     */
         LA    @01,@AL00986                                        0986
         BAL   @14,ERRMSG                                          0986
*           ELSE                                                   0987
*             CALL ERRMSG(HMA327I,NOPART,NOPART);/* INPUT TEXT AFTER
*                                      LKLIB, TXLIB OR RELFILE       */
         B     @RC00985                                            0987
@RF00985 LA    @01,@AL00987                                        0987
         BAL   @14,ERRMSG                                          0987
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */
@RC00985 LA    @15,GTASM                                           0988
         OI    GSMSYNTX(@15),B'01000000'                           0988
*         END;                                                     0989
*       ELSE                                                       0990
*         ;                         /* THE SYSMOD IS ALREADY BEING 0990
*                                      FLUSHED. AN APPROPRIATE     0990
*                                      MESSAGE HAS ALREADY BEEN    0990
*                                      ISSUED.                       */
@RF00979 DS    0H                                                  0991
*     END;                                                         0991
*   RETURN;                                                        0992
@EL00009 DS    0H                                                  0992
@EF00009 DS    0H                                                  0992
@ER00009 LM    @14,@12,@SA00009                                    0992
         BR    @14                                                 0992
*   END TEXTPROC;                                                  0993
         B     @EL00009                                            0993
*                                                                  0994
*/********************************************************************/
*/*                                                                  */
*/*  PTSCHK -                                                        */
*/*                                                                  */
*/*      SEARCH THE PTS FOR A PTS PTF ENTRY MATCHING THE INPUT       */
*/*      PARAMETER, SYSMNAME.                                        */
*/*                                                                  */
*/*      THIS PROCEDURE USES THE FOLLOWING IOPS:                     */
*/*        RECXIOPG - GENERAL USE IOP                                */
*/*                                                                  */
*/*      SET RECXSYSF "ON", GSMRRCVD "ON" AND MCSCHECK "OFF" IF      */
*/*      THE SYSMOD PASSED IS FOUND ON THE PTS (NOT IN ERROR).       */
*/*                                                                  */
*/*      RECXMAX WILL BE SET IF THE RETURN FROM HMASMIO IS           */
*/*      GREATER THAN IOPNOTFD (NOT FOUND).                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0994
*PTSCHK:                                                           0994
*   PROC(SYSMNAME);                                                0994
PTSCHK   STM   @14,@12,@SA00010                                    0994
         MVC   @PC00010(4),0(@01)                                  0994
*   DCL                                                            0995
*     SYSMNAME CHAR(7);             /* SYSMOD NAME                   */
*   RESPECIFY                                                      0996
*     HMASMIOP BASED(RECXIOPG);     /* SET UP TO USE GENERAL USE IOP */
*                                                                  0997
*   /*****************************************************************/
*   /*                                                               */
*   /* START SEARCHING PTS                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0997
*   IOPFUNCT=IOPBLDL;               /* DIRECTORY ONLY LOCATE         */
         L     @15,RECXIOPG                                        0997
         MVI   IOPFUNCT(@15),X'04'                                 0997
*   IOPDSID=IOPPTS;                 /* DATA SET IS PTS               */
         MVI   IOPDSID(@15),X'06'                                  0998
*   IOPNAME=SYSMNAME;               /* ENTRY NAME IS SYSMOD FOR WHICH
*                                      WE ARE LOOKING                */
         MVI   IOPNAME+7(@15),C' '                                 0999
         L     @14,@PC00010                                        0999
         MVC   IOPNAME(7,@15),SYSMNAME(@14)                        0999
*   IOPTYPE=IOPSMD;                 /* ENTRY TYPE IS PTF             */
         MVI   IOPTYPE(@15),X'0B'                                  1000
*   CALL HMASMIO(HMASMIOP);                                        1001
         ST    @15,@AL00001                                        1001
         L     @15,@CV01703                                        1001
         LA    @01,@AL00001                                        1001
         BALR  @14,@15                                             1001
*   IF IOPRETRN=IOPGOOD THEN                                       1002
         L     @15,RECXIOPG                                        1002
         CLI   IOPRETRN(@15),0                                     1002
         BNE   @RF01002                                            1002
*     DO;                                                          1003
*                                                                  1003
*       /*************************************************************/
*       /*                                                           */
*       /* PTS PTF ENTRY FOUND FOR SYSMOD                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1004
*       IF IOPERROR=OFF             /* NOT "IN ERROR"                */
*         THEN                                                     1004
         TM    IOPERROR(@15),B'00010000'                           1004
         BNZ   @RF01004                                            1004
*         DO;                                                      1005
*                                                                  1005
*           /*********************************************************/
*           /*                                                       */
*           /* SET FLAGS IN RECXPARM AND GTA SUMMARY RECORD          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1006
*           RECXSYSF=ON;            /* SET FLUSH INDICATOR           */
         OI    RECXSYSF,B'00010000'                                1006
*           GSMRCVD=ON;             /* ALREADY ON SMPPTS DATASET     */
         LA    @15,GTASM                                           1007
         OI    GSMRCVD(@15),B'00100000'                            1007
*           MCSCHECK=OFF;           /* SUPPRESS MOD.CNTL.STMT. CHECKS*/
         NI    MCSCHECK,B'11111101'                                1008
*         END;                                                     1009
*     END;                                                         1010
@RF01004 DS    0H                                                  1011
*   IF IOPRETRN>IOPNOTFD            /* TERMINATING I/O ERROR         */
*     THEN                                                         1011
@RF01002 L     @15,RECXIOPG                                        1011
         CLI   IOPRETRN(@15),4                                     1011
         BNH   @RF01011                                            1011
*     DO;                                                          1012
*                                                                  1012
*       /*************************************************************/
*       /*                                                           */
*       /* I/O ERROR ... TERMINATING                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1013
*       RECXMAX=MAX(RECXMAX,IOPRETRN);                             1013
         L     @14,RECXMAX                                         1013
         SLR   @07,@07                                             1013
         IC    @07,IOPRETRN(,@15)                                  1013
         CR    @14,@07                                             1013
         BNL   *+6
         LR    @14,@07                                             1013
         ST    @14,RECXMAX                                         1013
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                1014
*       GSMSIOE=ON;                 /* I/O ERROR ON SMP DATASET      */
         LA    @15,GTASM                                           1015
         OI    GSMSIOE(@15),B'00000100'                            1015
*     END;                                                         1016
*   RETURN;                                                        1017
@EL00010 DS    0H                                                  1017
@EF00010 DS    0H                                                  1017
@ER00010 LM    @14,@12,@SA00010                                    1017
         BR    @14                                                 1017
*   END PTSCHK;                                                    1018
         B     @EL00010                                            1018
*                                                                  1019
*/********************************************************************/
*/*                                                                  */
*/*    READ -                                                        */
*/*                                                                  */
*/*    READ SYSTEM MODIFICATION CONTROL CARDS AND SYSMOD TEXT RECORDS*/
*/*    FROM SMPPTFIN.                                                */
*/*                                                                  */
*/*    *  READ FROM PTFIN USING HMASMCRD.                            */
*/*                                                                  */
*/*    *  IF USER-EXIT RETURN CODE IS ENCOUNTERED:                   */
*/*                                                                  */
*/*       *  SAVE RETURN CODE IN READRTN                             */
*/*                                                                  */
*/*    *  IF HMASMCRD RETURN CODE  IS ENCOUNTERED:                   */
*/*                                                                  */
*/*       *  SAVE RETURN CODE IN READRTN                             */
*/*                                                                  */
*/*       *  FOR CRPEOF (END-OF-FILE) ---> RECXPEOF = ON             */
*/*                                                                  */
*/*       *  FOR >CRPEOF (TERMINATING ERRORS) ---> RECXPROC = STOP   */
*/*                                           ---> RECXSYSF = ON     */
*/*                                           ---> RECXMAX=CRPRETRN  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1019
*READ:                                                             1019
*   PROC;                                                          1019
READ     STM   @14,@12,@SA00011                                    1019
*   IF RECXPEOF=OFF&RECXPROC^=STOP THEN                            1020
         TM    RECXPROC,B'10000000'                                1020
         BNO   @RF01020                                            1020
         TM    RECXPEOF,B'00100000'                                1020
         BNZ   @RF01020                                            1020
*     DO;                                                          1021
*                                                                  1021
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP HMASMCRP PARAMETER LIST AND CALL HMASMCRD TO READ  */
*       /* FROM SMPPTFIN                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1022
*       CRPBFPRM=OFF;               /* BUFFER NOT PRIMED             */
*       CRPPTS=OFF;                 /* DO NOT WRITE TO SMPPTS        */
*       CRPLOG=OFF;                 /* DO NOT WRITE TO SMPLOG        */
*       CRPPRINT=OFF;               /* DO NOT WRITE TO SMPOUT        */
*       CRPOTHER=OFF;               /* DO NOT WRITE TO CRDOUTDS      */
*       CRPSCNCL=OFF;               /* NOT CALL FROM SCAN            */
         NI    CRPBFPRM,B'01000010'                                1027
*       CRPSCPAD=0;                 /* SCAN PARM LIST - N/A          */
         SLR   @15,@15                                             1028
         ST    @15,CRPSCPAD                                        1028
*       CRPUXNUM=UXPUX001;          /* SET RECEIVE USER EXIT         */
         MVI   CRPUXNUM,X'01'                                      1029
*       CALL HMASMCRD(HMASMCRP);    /* GENERAL GET ROUTINE           */
         L     @15,@CV01708                                        1030
         LA    @01,@AL01030                                        1030
         BALR  @14,@15                                             1030
*       RESPECIFY                                                  1031
*         REG15 RSTD;                                              1031
*       READRTN=REG15;              /* SAVE RETURN CODE FROM HMASMCRD
*                                      ROUTINE                       */
         ST    REG15,READRTN                                       1032
*       RESPECIFY                                                  1033
*         REG15 UNRSTD;                                            1033
*       IF READRTN=CRPEOF THEN                                     1034
*                                                                  1034
         L     @15,READRTN                                         1034
         CH    @15,@CH00092                                        1034
         BNE   @RF01034                                            1034
*         /***********************************************************/
*         /*                                                         */
*         /* EOF FROM HMASMCRD ROUTINE                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1035
*         RECXPEOF=ON;              /* SET END-OF-FILE FLAG          */
         OI    RECXPEOF,B'00100000'                                1035
*       IF READRTN>CRPEOF&CRPTRMEX=OFF THEN                        1036
@RF01034 L     @15,READRTN                                         1036
         CH    @15,@CH00092                                        1036
         BNH   @RF01036                                            1036
         TM    CRPTRMEX,B'01000000'                                1036
         BNZ   @RF01036                                            1036
*         DO;                                                      1037
*                                                                  1037
*           /*********************************************************/
*           /*                                                       */
*           /* TERMINATING ERROR FROM CRD ROUTINE ... NOT USER EXIT  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1038
*           RECXPROC=STOP;          /* STOP RECEIVE PROCESSING       */
*           RECXSYSF=ON;            /* FLUSH CURRENT SYSMOD          */
         OI    RECXSYSF,B'00010000'                                1039
         NI    RECXPROC,B'01111111'                                1039
*           GSMSIOE=ON;             /* I/O ERROR ON SMP DATASET      */
         LA    @14,GTASM                                           1040
         OI    GSMSIOE(@14),B'00000100'                            1040
*           RECXMAX=MAX(RECXMAX,READRTN);/* HMASMCRD'S RETURN CODE   */
         L     @14,RECXMAX                                         1041
         CR    @14,@15                                             1041
         BNL   *+6
         LR    @14,@15                                             1041
         ST    @14,RECXMAX                                         1041
*         END;                                                     1042
*     END;                                                         1043
*   RETURN;                                                        1044
@EL00011 DS    0H                                                  1044
@EF00011 DS    0H                                                  1044
@ER00011 LM    @14,@12,@SA00011                                    1044
         BR    @14                                                 1044
*   END READ;                                                      1045
         B     @EL00011                                            1045
*                                                                  1046
*/********************************************************************/
*/*                                                                  */
*/*    CHKBUF - SCAN INPUT BUFFER (CRDBUFFR) AND RETURN WITH AN      */
*/*             INDICATION OF THE TYPE OF RECORD IN CHKTYPE.         */
*/*                                                                  */
*/*             CHKTYPE                                              */
*/*             -------        ----------------------------------    */
*/*                                                                  */
*/*               'N' -------  NOT SMP MODIFICATION CNTRL STATEMENT. */
*/*                                                                  */
*/*               'C' -------  SMP MODIFICATION CNTRL STATEMENT      */
*/*                            (OTHER THAN ++FUNCTION, ++PTF,        */
*/*                             ++USERMOD OR ++APAR).                */
*/*                                                                  */
*/*               'H' -------  ++FUNCTION, ++PTF, ++USERMOD OR       */
*/*                            ++APAR MODIFICATION CNTRL STATEMENT.  */
*/*                                                                  */
*/*                            CHKSMD# - 'Y' ==> SYSMOD-ID FOUND     */
*/*                                                                  */
*/*                            CHKSMDID - SYSMOD-ID OR "NULLPTF#"    */
*/*                                                                  */
*/********************************************************************/
*                                                                  1046
*CHKBUF:                                                           1046
*   PROC;                                                          1046
CHKBUF   STM   @14,@12,@SA00012                                    1046
*   CHKSMD#=NO;                     /* SYSMOD # NOT FOUND            */
         MVI   CHKSMD#,C'N'                                        1047
*   IF CRPBUFFR(1:2)^='++' THEN                                    1048
         CLC   CRPBUFFR(2),@CC01964                                1048
         BE    @RF01048                                            1048
*     CHKTYPE=NOTCNTRL;                                            1049
         MVI   CHKTYPE,C'N'                                        1049
*   ELSE                                                           1050
*     DO;                                                          1050
*                                                                  1050
         B     @RC01048                                            1050
@RF01048 DS    0H                                                  1051
*       /*************************************************************/
*       /*                                                           */
*       /* THE INPUT BUFFER (CRPBUFFR) CONTAINS A MODIFICATION       */
*       /* CONTROL STATEMENT WHICH MUST BE SCANNED.                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1051
*       CHKTYPE=SMCNTRL;            /* SET THE CHKTYPE TO "SMCNTRL"
*                                      INITIALLY. IF THE RECORD IS 1051
*                                      FOUND TO CONTAIN A SYSMOD   1051
*                                      HEADER, CHKTYPE WILL BE SET TO
*                                      "SMHEAD" BY THE DSCAN ROUT  1051
*                                      PROCEDURE, SMHDTYPE.          */
         MVI   CHKTYPE,C'C'                                        1051
*       CHKKEY=NO;                  /* SET INITIALLY TO "NO". IF THE
*                                      RECORD IS FOUND TO CONTAIN ANY
*                                      KEYWORD FOLLOWING THE '++', 1052
*                                      CHKKEY WILL BE SET TO "YES" BY
*                                      THE DSCAN ROUT ROUTINES.      */
*                                                                  1052
         MVI   CHKKEY,C'N'                                         1052
*       /*************************************************************/
*       /*                                                           */
*       /* HMASMSCN PARAMETER INITIALIZATION (HMASMSCP)              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1053
*       SCPCHAR=ADDR(CRPBUFFR);     /* INPUT BUFFER                  */
         L     @15,SCPPTR                                          1053
         LA    @14,CRPBUFFR                                        1053
         ST    @14,SCPCHAR(,@15)                                   1053
*       SCPINLN=LENGTH(CRPBFCTL);   /* LENGTH OF SMP CNTRL STATEMENT */
         MVC   SCPINLN(2,@15),@CH00431                             1054
*       SCPSRCH=ADDR(SYSMSCAN);     /* DSCANS FOR SYSMOD HEADERS     */
         LA    @14,SYSMSCAN                                        1055
         ST    @14,SCPSRCH(,@15)                                   1055
*       SCPIORTN=0;                 /* DO NOT GO TO NEXT RECORD      */
         SLR   @14,@14                                             1056
         ST    @14,SCPIORTN(,@15)                                  1056
*       SCPEOR=ZERO;                /* CLEAR END OF RECORD FLAG      */
         MVI   SCPEOR(@15),X'00'                                   1057
*       SCPCOMNT=ON;                /* SET SKIP-BY COMMENTS DURING 1058
*                                      SCAN                          */
*                                                                  1058
         OI    SCPCOMNT(@15),B'00100000'                           1058
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN MODIFICATION CONTROL STATEMENT                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1059
*       CALL HMASMSCN(HMASMSCP);    /* SCAN STATEMENT                */
         ST    @15,@AL00001                                        1059
         L     @15,@CV01705                                        1059
         LA    @01,@AL00001                                        1059
         BALR  @14,@15                                             1059
*       IF SCPRETRN>SCPBAD          /* TERMINATING ERR. FROM SCN     */
*         THEN                                                     1060
         L     @15,SCPPTR                                          1060
         CLI   SCPRETRN(@15),4                                     1060
         BNH   @RF01060                                            1060
*         DO;                                                      1061
*                                                                  1061
*           /*********************************************************/
*           /*                                                       */
*           /* TERMINATING ERROR FROM SCAN ... FLUSH SYSMOD          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1062
*           RECXSYSF=ON;            /* FLUSH THE SYSMOD              */
         OI    RECXSYSF,B'00010000'                                1062
*           RECXMAX=MAX(RECXMAX,SCPRETRN);/* SAVE HIGH RETURN CODE   */
         L     @14,RECXMAX                                         1063
         SLR   @07,@07                                             1063
         IC    @07,SCPRETRN(,@15)                                  1063
         CR    @14,@07                                             1063
         BNL   *+6
         LR    @14,@07                                             1063
         ST    @14,RECXMAX                                         1063
*         END;                                                     1064
*       IF CHKKEY=NO                /* NO MCS KEYWORD FOUND          */
*           &SCPRETRN<=SCPBAD       /* NOT TERMINATING ERR. FROM SCN */
*         THEN                                                     1065
@RF01060 CLI   CHKKEY,C'N'                                         1065
         BNE   @RF01065                                            1065
         L     @01,SCPPTR                                          1065
         CLI   SCPRETRN(@01),4                                     1065
         BH    @RF01065                                            1065
*         DO;                                                      1066
*                                                                  1066
*           /*********************************************************/
*           /*                                                       */
*           /* THE STATEMENT WAS CONTINUED BEFORE THE KEYWORD        */
*           /* FOLLOWING THE '++'                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1067
*                                                                  1067
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT THE RECORD IN ERROR                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1067
*           CRPBFPRM=ON;            /* SET BUFFER PRIMED             */
*           CRPSCNCL=OFF;           /* USER EXIT - N/A               */
         OI    CRPBFPRM,B'10000000'                                1068
         NI    CRPSCNCL,B'11111110'                                1068
*           CRPSCPAD=0;             /* SCP ADDRESS - N/A             */
         SLR   @15,@15                                             1069
         ST    @15,CRPSCPAD                                        1069
*           CRPPTS=OFF;             /* DO NOT WRITE TO PTS           */
*           CRPLOG=OFF;             /* DO NOT WRITE TO SMPLOG        */
*           CRPPRINT=ON;            /* WRITE TO SMPOUT               */
         OI    CRPPRINT,B'00001000'                                1072
         NI    CRPPTS,B'11001111'                                  1072
*           CALL HMASMCRD(HMASMCRP);                               1073
         L     @15,@CV01708                                        1073
         LA    @01,@AL01073                                        1073
         BALR  @14,@15                                             1073
*           IF CRPRETRN^=CRPGOOD THEN                              1074
         CLI   CRPRETRN,0                                          1074
         BE    @RF01074                                            1074
*             RECXMAX=MAX(RECXMAX,CRPRETRN);/* SAVE HIGHEST CODE     */
*                                                                  1075
         L     @15,RECXMAX                                         1075
         SLR   @14,@14                                             1075
         IC    @14,CRPRETRN                                        1075
         CR    @15,@14                                             1075
         BNL   *+6
         LR    @15,@14                                             1075
         ST    @15,RECXMAX                                         1075
*           /*********************************************************/
*           /*                                                       */
*           /* FLUSH THE SYSMOD WITH A SYNTAX ERROR AND ISSUE HMA345I*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1076
*           RECXSYSF=ON;            /* FLUSH SYSMOD                  */
@RF01074 OI    RECXSYSF,B'00010000'                                1076
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           1077
         OI    GSMSYNTX(@15),B'01000000'                           1077
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1078
*           CALL ERRMSG(HMA345I,NOPART,NOPART);/* POSITIONAL PARM NOT
*                                      IN 1ST RECORD                 */
         LA    @01,@AL01079                                        1079
         BAL   @14,ERRMSG                                          1079
*         END;                                                     1080
*     END;                                                         1081
*   RETURN;                                                        1082
@EL00012 DS    0H                                                  1082
@EF00012 DS    0H                                                  1082
@ER00012 LM    @14,@12,@SA00012                                    1082
         BR    @14                                                 1082
*                                                                  1083
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCANS FOR SYSMOD HEADER STATEMENTS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1083
*   GEN DATA DEFS(SYSMSCAN) REFS(SMHDTYPE,SMCTTYPE,SM#VALUE);      1083
*                                                                  1084
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT - SYSMOD HEADER FOUND                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1084
*SMHDTYPE:                                                         1084
*   PROC;                                                          1084
         B     @PB00013                                            1084
SMHDTYPE STM   @14,@12,12(@13)                                     1084
*   CHKKEY=YES;                     /* KEYWORD FOUND                 */
         MVI   CHKKEY,C'Y'                                         1085
*   CHKTYPE=SMHEAD;                 /* SET SYSMOD HEADER TYPE        */
         MVI   CHKTYPE,C'H'                                        1086
*   CHKSMDID=NULLPTF#;              /* CLEAR SYSMOD-ID SAVE AREA     */
         MVC   CHKSMDID(7),@CC01733                                1087
*   SCPRET=SCPGOOD;                 /* CONT SCAN ... RETURN CODE 0   */
         L     @01,SCPPTR                                          1088
         MVI   SCPRET(@01),X'00'                                   1088
*   RETURN;                                                        1089
@EL00013 DS    0H                                                  1089
@EF00013 DS    0H                                                  1089
@ER00013 LM    @14,@12,12(@13)                                     1089
         BR    @14                                                 1089
*   END SMHDTYPE;                                                  1090
*                                                                  1091
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT - NOT A SYSMOD HEADER                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1091
*SMCTTYPE:                                                         1091
*   PROC;                                                          1091
SMCTTYPE STM   @14,@12,12(@13)                                     1091
*   CHKKEY=YES;                     /* KEYWORD FOUND                 */
         MVI   CHKKEY,C'Y'                                         1092
*   SCPRET=SCPNDSCN;                /* STOP SCAN ... RETURN CODE 0   */
         L     @01,SCPPTR                                          1093
         MVI   SCPRET(@01),X'04'                                   1093
*   RETURN;                                                        1094
@EL00014 DS    0H                                                  1094
@EF00014 DS    0H                                                  1094
@ER00014 LM    @14,@12,12(@13)                                     1094
         BR    @14                                                 1094
*   END SMCTTYPE;                                                  1095
*                                                                  1096
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT - EXTRACT SYSMOD ID FROM STATEMENT                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1096
*SM#VALUE:                                                         1096
*   PROC;                                                          1096
SM#VALUE STM   @14,@12,12(@13)                                     1096
*   DCL                                                            1097
*     1 * BASED(SCPCHAR),           /* ADDRESS SCP BUFFER            */
*      2 SM#ID CHAR(7);             /*                               */
*   CHKSMDID=SM#ID;                 /* SAVE SYSMOD-ID                */
         L     @15,SCPPTR                                          1098
         L     @01,SCPCHAR(,@15)                                   1098
         MVC   CHKSMDID(7),SM#ID(@01)                              1098
*   SCPRET=SCPNDSCN;                /* STOP SCAN ... RETURN CODE 0   */
         MVI   SCPRET(@15),X'04'                                   1099
*   CHKSMD#=YES;                    /* SYSMOD # FOUND                */
         MVI   CHKSMD#,C'Y'                                        1100
*   RETURN;                                                        1101
@EL00015 DS    0H                                                  1101
@EF00015 DS    0H                                                  1101
@ER00015 LM    @14,@12,12(@13)                                     1101
         BR    @14                                                 1101
*   END SM#VALUE;                                                  1102
*   END CHKBUF;                                                    1103
         B     @EL00012                                            1103
*                                                                  1104
*/********************************************************************/
*/*                                                                  */
*/*    ERRMSG - PUT ERROR MESSAGES TO SMPOUT AND SMPLOG FILES.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  1104
*ERRMSG:                                                           1104
*   PROC(MSGCODE1,MSGCODE2,MSGCODE3);                              1104
ERRMSG   STM   @14,@12,@SA00016                                    1104
         MVC   @PC00016(12),0(@01)                                 1104
*   DCL                                                            1105
*     MSGCODE1 FIXED(8);            /* PRIMARY MESSAGE NUMBER        */
*   DCL                                                            1106
*     MSGCODE2 FIXED(8);            /* SECONDARY MESSAGE NUMBER      */
*   DCL                                                            1107
*     MSGCODE3 FIXED(8);            /* TERTIARY MESSAGE NUMBER       */
*                                                                  1107
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP HMASMMSG PARM LIST (MGP)                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1108
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */
         XC    MGPCLEAR(6),MGPCLEAR                                1108
*   MGPMGNO1=MSGCODE1;              /* PRIMARY MESSAGE NUMBER        */
         L     @15,@PC00016                                        1109
         SLR   @14,@14                                             1109
         IC    @14,MSGCODE1(,@15)                                  1109
         STH   @14,MGPMGNO1                                        1109
*   IF MSGCODE2^=NOPART THEN                                       1110
         L     @15,@PC00016+4                                      1110
         CLI   MSGCODE2(@15),0                                     1110
         BE    @RF01110                                            1110
*     MGPMGNO2=MSGCODE2;            /* SECONDARY MESSAGE PART        */
         SLR   @14,@14                                             1111
         IC    @14,MSGCODE2(,@15)                                  1111
         STH   @14,MGPMGNO2                                        1111
*   IF MSGCODE3^=NOPART THEN                                       1112
@RF01110 L     @15,@PC00016+8                                      1112
         CLI   MSGCODE3(@15),0                                     1112
         BE    @RF01112                                            1112
*     MGPMGNO3=MSGCODE3;            /* TERCIARY MESSAGE PART         */
         SLR   @14,@14                                             1113
         IC    @14,MSGCODE3(,@15)                                  1113
         STH   @14,MGPMGNO3                                        1113
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */
@RF01112 DS    0H                                                  1115
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */
*   MGPWTOR=OFF;                    /* NOT WTOR                      */
*   MGPWTO=OFF;                     /* NOT WTO                       */
*                                                                  1117
         OI    MGPPRINT,B'10010000'                                1117
         NI    MGPWTOR,B'11110011'                                 1117
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP VARIABLE PARTS OF CERTAIN MESSAGES                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1118
*   IF MGPMGNO1=HMA246I THEN                                       1118
         CLC   MGPMGNO1(2),@CH01785                                1118
         BNE   @RF01118                                            1118
*     DO;                                                          1119
*                                                                  1119
*       /*************************************************************/
*       /*                                                           */
*       /* HMA246I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1120
*       MGPVARPT(1)=ADDR(MSGSYS);   /* "SYSTEM"                      */
         LA    @15,MSGSYS                                          1120
         ST    @15,MGPVARPT                                        1120
*       MGPVARPT(2)=ADDR(MSGENT);   /* "ENTRY"                       */
         LA    @15,MSGENT                                          1121
         ST    @15,MGPVARPT+4                                      1121
*       MGPVARPT(3)=ADDR(MSGPTS);   /* "SMPPTS"                      */
         LA    @15,MSGPTS                                          1122
         ST    @15,MGPVARPT+8                                      1122
*     END;                                                         1123
*   IF MGPMGNO1=HMA248I THEN                                       1124
@RF01118 CLC   MGPMGNO1(2),@CH01787                                1124
         BNE   @RF01124                                            1124
*     DO;                                                          1125
*                                                                  1125
*       /*************************************************************/
*       /*                                                           */
*       /* HMA248I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1126
*       MGPVARPT(1)=ADDR(MSGREC);   /* "RECEIVE"                     */
         LA    @15,MSGREC                                          1126
         ST    @15,MGPVARPT                                        1126
*     END;                                                         1127
*   IF MGPMGNO1=HMA259I THEN                                       1128
@RF01124 CLC   MGPMGNO1(2),@CH00949                                1128
         BNE   @RF01128                                            1128
*     DO;                                                          1129
*                                                                  1129
*       /*************************************************************/
*       /*                                                           */
*       /* HMA259I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1130
*       MGPVARPT(1)=ADDR(MSGPTS);   /* "SMPPTS"                      */
         LA    @15,MSGPTS                                          1130
         ST    @15,MGPVARPT                                        1130
*       MGPVARPT(2)=ADDR(MSGSYS);   /* "SYSTEM"                      */
         LA    @15,MSGSYS                                          1131
         ST    @15,MGPVARPT+4                                      1131
*       MGPVARPT(3)=ADDR(MSGFMID);  /* "FMID "                       */
         LA    @15,MSGFMID                                         1132
         ST    @15,MGPVARPT+8                                      1132
*       MGPVARPT(4)=ADDR(VPART#1);  /* FMID SYSMOD # BEING ADDED     */
         LA    @15,VPART#1                                         1133
         ST    @15,MGPVARPT+12                                     1133
*     END;                                                         1134
*   IF MGPMGNO1=HMA369I THEN                                       1135
@RF01128 CLC   MGPMGNO1(2),@CH01208                                1135
         BNE   @RF01135                                            1135
*     DO;                                                          1136
*                                                                  1136
*       /*************************************************************/
*       /*                                                           */
*       /* HMA369I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1137
*       MGPVARPT(1)=ADDR(MSGSMDNM); /* SYSMOD NAME                   */
         LA    @15,MSGSMDNM                                        1137
         ST    @15,MGPVARPT                                        1137
*     END;                                                         1138
*   IF MGPMGNO1=HMA363I THEN                                       1139
@RF01135 CLC   MGPMGNO1(2),@CH01196                                1139
         BNE   @RF01139                                            1139
*     DO;                                                          1140
*                                                                  1140
*       /*************************************************************/
*       /*                                                           */
*       /* HMA363I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1141
*       MGPVARPT(1)=ADDR(VPART#1);  /* VARIABLE PART                 */
         LA    @15,VPART#1                                         1141
         ST    @15,MGPVARPT                                        1141
*       MGPVARPT(2)=ADDR(VPART#2);  /* VARIABLE PART                 */
         LA    @15,VPART#2                                         1142
         ST    @15,MGPVARPT+4                                      1142
*       MGPVARPT(3)=ADDR(VPART#3);  /* VARIABLE PART                 */
         LA    @15,VPART#3                                         1143
         ST    @15,MGPVARPT+8                                      1143
*     END;                                                         1144
*   IF MGPMGNO1=HMA378I THEN                                       1145
@RF01139 CLC   MGPMGNO1(2),@CH01810                                1145
         BNE   @RF01145                                            1145
*     DO;                                                          1146
*                                                                  1146
*       /*************************************************************/
*       /*                                                           */
*       /* HMA378I                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1147
*       MGPVARPT(1)=ADDR(VPART#1);  /* VARIABLE PART - ELEMENT TYPE  */
         LA    @15,VPART#1                                         1147
         ST    @15,MGPVARPT                                        1147
*       MGPVARPT(2)=ADDR(VPART#2);  /* VARIABLE PART - ELEMENT TYPE  */
         LA    @15,VPART#2                                         1148
         ST    @15,MGPVARPT+4                                      1148
*       MGPVARPT(3)=ADDR(VPART#3);  /* VARIABLE PART - ELEMENT NAME  */
         LA    @15,VPART#3                                         1149
         ST    @15,MGPVARPT+8                                      1149
*     END;                                                         1150
*   CALL HMASMMSG(HMASMMGP);                                       1151
@RF01145 L     @15,@CV01704                                        1151
         LA    @01,@AL01151                                        1151
         BALR  @14,@15                                             1151
*   RESPECIFY                                                      1152
*     REG15 RSTD;                   /* CHECK RETURN CODE             */
*   RECXMAX=MAX(RECXMAX,REG15);     /* SAVE IT IF HIGH               */
         L     @14,RECXMAX                                         1153
         CR    @14,REG15                                           1153
         BNL   *+6
         LR    @14,REG15                                           1153
         ST    @14,RECXMAX                                         1153
*   RESPECIFY                                                      1154
*     REG15 UNRSTD;                                                1154
*                                                                  1154
*   /*****************************************************************/
*   /*                                                               */
*   /* SET RECEIVE RETURN CODE BASED UPON MGPTYPE                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1155
*   IF MGPTYPE=MGPWARN THEN                                        1155
         CLI   MGPTYPE,2                                           1155
         BNE   @RF01155                                            1155
*     RECXMAX=MAX(RECXMAX,PTFWARN); /* WARNING                       */
         LA    @15,4                                               1156
         CR    @14,@15                                             1156
         BNL   *+6
         LR    @14,@15                                             1156
         ST    @14,RECXMAX                                         1156
*   ELSE                                                           1157
*     IF MGPTYPE=MGPERR THEN                                       1157
         B     @RC01155                                            1157
@RF01155 CLI   MGPTYPE,3                                           1157
         BNE   @RF01157                                            1157
*       RECXMAX=MAX(RECXMAX,STOPPTF);/* STOP-SYSMOD                  */
         L     @15,RECXMAX                                         1158
         LA    @14,8                                               1158
         CR    @15,@14                                             1158
         BNL   *+6
         LR    @15,@14                                             1158
         ST    @15,RECXMAX                                         1158
*     ELSE                                                         1159
*       IF MGPTYPE=MGPSEV THEN                                     1159
         B     @RC01157                                            1159
@RF01157 CLI   MGPTYPE,4                                           1159
         BNE   @RF01159                                            1159
*         RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE                    */
         L     @15,RECXMAX                                         1160
         LA    @14,12                                              1160
         CR    @15,@14                                             1160
         BNL   *+6
         LR    @15,@14                                             1160
         ST    @15,RECXMAX                                         1160
*       ELSE                                                       1161
*         IF MGPTYPE=MGPTERM THEN                                  1161
         B     @RC01159                                            1161
@RF01159 CLI   MGPTYPE,5                                           1161
         BNE   @RF01161                                            1161
*           RECXMAX=MAX(RECXMAX,STOPSMP);/* TERMINATING              */
         L     @15,RECXMAX                                         1162
         LA    @14,16                                              1162
         CR    @15,@14                                             1162
         BNL   *+6
         LR    @15,@14                                             1162
         ST    @15,RECXMAX                                         1162
*   RETURN;                                                        1163
@EL00016 DS    0H                                                  1163
@EF00016 DS    0H                                                  1163
@ER00016 LM    @14,@12,@SA00016                                    1163
         BR    @14                                                 1163
*   END ERRMSG;                                                    1164
         B     @EL00016                                            1164
*                                                                  1165
*/********************************************************************/
*/*                                                                  */
*/*    PARSERR - PROCESS NON-ZERO RETURN CODES FROM PARSE PROCEDURES */
*/*                                                                  */
*/*        - CALLED TO PROCESS NON-ZERO RETURN CODES FROM THE        */
*/*          PARSE ROUTINES (HMASMMPD).                              */
*/*                                                                  */
*/*        1. IF AN END-OF-FILE WAS ENCOUNTERED BY HMASMCRD,         */
*/*           SET RECXPEOF TO STOP READS FROM PTFIN.                 */
*/*                                                                  */
*/*        2. IF THE RETURN CODE IS THE RESULT OF A USER EXIT:       */
*/*                                                                  */
*/*             - SET RECEIVE'S MAXIMUM RETURN CODE (RECXMAX)        */
*/*               APPROPRIATELY AND SET GSMUSR IN THE SUMMARY        */
*/*               RECORD.                                            */
*/*                                                                  */
*/*        2. IF THE RETURN CODE IS THE RESULT OF A SYNTAX ERROR:    */
*/*                                                                  */
*/*             - SET RECEIVE'S MAXIMUM RETURN CODE (RECXMAX)        */
*/*               TO STOPPTF AND SET GSMSYNTX IN THE SUMMARY         */
*/*               RECORD.                                            */
*/*                                                                  */
*/*        3. IF THE RETURN CODE IS THE RESULT OF A TERMINATING      */
*/*           ERROR FROM HMASMCRD:                                   */
*/*                                                                  */
*/*             - SET RECEIVE'S MAXIMUM RETURN CODE (RECXMAX)        */
*/*               TO HMASMCRD'S RETURN CODE AND SET GSMSIOE          */
*/*               IN THE SUMMARY RECORD TO INDICATE SMP DATASET      */
*/*               I/O ERROR.                                         */
*/*                                                                  */
*/*        4. IN ALL CASES, THE SYSMOD IS FLUSHED (RECXSYSF SET).    */
*/*                                                                  */
*/********************************************************************/
*                                                                  1165
*PARSERR:                                                          1165
*   PROC;                                                          1165
PARSERR  STM   @14,@12,12(@13)                                     1165
*   RECXSYSF=ON;                    /* FLUSH THE SYSMOD              */
         OI    RECXSYSF,B'00010000'                                1166
*   RECXMAX=MAX(RECXMAX,STOPPTF);   /* THE SYSMOD IS TERMINATED      */
*                                                                  1167
         L     @15,RECXMAX                                         1167
         LA    @14,8                                               1167
         CR    @15,@14                                             1167
         BNL   *+6
         LR    @15,@14                                             1167
         ST    @15,RECXMAX                                         1167
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK SETTINGS IN HMASMCRD'S PARAMETER LIST (HMASMCRP) TO     */
*   /* DETERMINE WHAT HAS HAPPENED                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1168
*   IF CRPRETRN=CRPEOF              /* END-OF-FILE ENCOUNTERED       */
*     THEN                                                         1168
         CLI   CRPRETRN,4                                          1168
         BNE   @RF01168                                            1168
*     RECXPEOF=ON;                  /* SET PTFIN EOF FLAG            */
         OI    RECXPEOF,B'00100000'                                1169
*   IF CRPTRMEX=ON                  /* USER-EXIT RETURN CODE         */
*     THEN                                                         1170
@RF01168 TM    CRPTRMEX,B'01000000'                                1170
         BNO   @RF01170                                            1170
*     DO;                                                          1171
*                                                                  1171
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN CODE IS THE RESULT OF THE USER EXIT                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1172
*       RECXMAX=MAX(RECXMAX,CRPRETRN);/* SAVE RETURN CODE            */
         L     @15,RECXMAX                                         1172
         SLR   @14,@14                                             1172
         IC    @14,CRPRETRN                                        1172
         CR    @15,@14                                             1172
         BNL   *+6
         LR    @15,@14                                             1172
         ST    @15,RECXMAX                                         1172
*       GSMUSR=ON;                  /* SET SUMMARY RECORD FLAG - USER
*                                      EXIT                          */
         LA    @15,GTASM                                           1173
         OI    GSMUSR(@15),B'10000000'                             1173
*     END;                                                         1174
*   ELSE                                                           1175
*     DO;                                                          1175
*                                                                  1175
         B     @RC01170                                            1175
@RF01170 DS    0H                                                  1176
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN CODE IS SYNTAX ERROR FROM PARSE OR I/O ERROR FROM  */
*       /* HMASMCRD.                                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1176
*       IF MPDRETRN<=STOPPTF THEN                                  1176
         L     @15,MPDRETRN                                        1176
         CH    @15,@CH00033                                        1176
         BH    @RF01176                                            1176
*         GSMSYNTX=ON;              /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           1177
         OI    GSMSYNTX(@15),B'01000000'                           1177
*       ELSE                                                       1178
*         RECXMAX=MAX(RECXMAX,MPDRETRN);/* TERMINATING ERROR         */
         B     @RC01176                                            1178
@RF01176 L     @15,RECXMAX                                         1178
         L     @14,MPDRETRN                                        1178
         CR    @15,@14                                             1178
         BNL   *+6
         LR    @15,@14                                             1178
         ST    @15,RECXMAX                                         1178
*     END;                                                         1179
*   RETURN;                                                        1180
@EL00017 DS    0H                                                  1180
@EF00017 DS    0H                                                  1180
@ER00017 LM    @14,@12,12(@13)                                     1180
         BR    @14                                                 1180
*   END PARSERR;                                                   1181
         B     @EL00017                                            1181
*                                                                  1182
*/********************************************************************/
*/*                                                                  */
*/*    WRITEPTS - WRITE RECORD IN CRPBUFFR TO THE PTS MCS ENTRY      */
*/*                         - AND/OR -                               */
*/*               WRITE RECORD IN CRPBUFFR TO SMPOUT.                */
*/*                                                                  */
*/*        1. INITIALIZE THE CRP PARAMETER LIST:                     */
*/*            - WRITE TO PTS MCS ENTRY (ALL RECORDS).               */
*/*            - IF MODIFICATION CONTROL STATEMENT RECORD,           */
*/*              - WRITE TO SMPOUT AND SMPLOG                        */
*/*            - IF NOT A MODIFICATION CONTROL STATEMENT RECORD,     */
*/*              - DO NOT WRITE TO SMPOUT AND SMPLOG.                */
*/*                                                                  */
*/*        2.  CALL HMASMCRD                                         */
*/*                                                                  */
*/*        3.  SET RECXMAX FOR NON-ZERO RETURN CODES FROM HMASMCRD   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1182
*WRITEPTS:                                                         1182
*   PROC(PRTFLG);                                                  1182
WRITEPTS STM   @14,@12,@SA00018                                    1182
         MVC   @PC00018(4),0(@01)                                  1182
*   DCL                                                            1183
*     PRTFLG CHAR(1);               /* ALLOWS THE CALLER TO SPECIFY
*                                      THAT THE RECORD IN CRPBUFFR BE
*                                      WRITTEN TO SMPOUT (WHEN SET TO
*                                      "SMCNTRL").                   */
*                                                                  1183
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMCRP PARAMETER INITIALIZATION                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1184
*   CRPSCNCL=OFF;                   /* THIS IN NOT A CALL FROM SCN   */
*   CRPOTHER=OFF;                   /* DO NOT WRITE TO CRPOUTDS      */
         NI    CRPSCNCL,B'11111010'                                1185
*   CRPUXNUM=0;                     /* USER EXIT - N/A               */
         MVI   CRPUXNUM,X'00'                                      1186
*   CRPSCPAD=0;                     /* SCP ADDRESS - N/A             */
         SLR   @15,@15                                             1187
         ST    @15,CRPSCPAD                                        1187
*   CRPLOG=OFF;                     /* DO NOT WRITE TO SMPLOG        */
*   CRPBFPRM=ON;                    /* THE BUFFER IS PRIMED          */
         OI    CRPBFPRM,B'10000000'                                1189
         NI    CRPLOG,B'11101111'                                  1189
*                                                                  1190
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE THE SETTING OF CRPPTS AND CRPPRINT                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1190
*   IF RECXSYSF=OFF THEN                                           1190
         TM    RECXSYSF,B'00010000'                                1190
         BNZ   @RF01190                                            1190
*     CRPPTS=ON;                    /* NOT FLUSH ... WRITE TO PTS    */
         OI    CRPPTS,B'00100000'                                  1191
*   ELSE                                                           1192
*     CRPPTS=OFF;                   /* FLUSH ... DO NOT WRITE TO PTS */
         B     @RC01190                                            1192
@RF01190 NI    CRPPTS,B'11011111'                                  1192
*   IF PRTFLG^=SMCNTRL THEN                                        1193
@RC01190 L     @15,@PC00018                                        1193
         CLI   PRTFLG(@15),C'C'                                    1193
         BE    @RF01193                                            1193
*     CRPPRINT=OFF;                 /* DO NOT WRITE TO SMPOUT        */
         NI    CRPPRINT,B'11110111'                                1194
*   ELSE                                                           1195
*     DO;                                                          1195
         B     @RC01193                                            1195
@RF01193 DS    0H                                                  1196
*       CALL SKIP(1);               /* PUT A BLANK LINE TO SMPOUT    */
         LA    @01,@AL01196                                        1196
         BAL   @14,SKIP                                            1196
*       CRPPRINT=ON;                /* WRITE TO SMPOUT               */
         OI    CRPPRINT,B'00001000'                                1197
*     END;                                                         1198
*                                                                  1198
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE RECORD TO PTS MCS ENTRY AND/OR SMPOUT                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1199
*   IF CRPPRINT=ON×CRPPTS=ON THEN                                  1199
@RC01193 TM    CRPPRINT,B'00101000'                                1199
         BZ    @RF01199                                            1199
*     DO;                                                          1200
*       CALL HMASMCRD(HMASMCRP);                                   1201
         L     @15,@CV01708                                        1201
         LA    @01,@AL01201                                        1201
         BALR  @14,@15                                             1201
*       IF CRPRETRN^=CRPGOOD THEN                                  1202
         CLI   CRPRETRN,0                                          1202
         BE    @RF01202                                            1202
*         DO;                                                      1203
*           IF CRPRETRN=CRPTPTF THEN                               1204
         CLI   CRPRETRN,8                                          1204
         BNE   @RF01204                                            1204
*             RECXSYSF=ON;          /* FLUSH THIS SYSMOD             */
         OI    RECXSYSF,B'00010000'                                1205
*           RECXMAX=MAX(RECXMAX,CRPRETRN);                         1206
@RF01204 L     @15,RECXMAX                                         1206
         SLR   @14,@14                                             1206
         IC    @14,CRPRETRN                                        1206
         CR    @15,@14                                             1206
         BNL   *+6
         LR    @15,@14                                             1206
         ST    @15,RECXMAX                                         1206
*         END;                                                     1207
*     END;                                                         1208
*   RETURN;                                                        1209
@EL00018 DS    0H                                                  1209
@EF00018 DS    0H                                                  1209
@ER00018 LM    @14,@12,@SA00018                                    1209
         BR    @14                                                 1209
*   END WRITEPTS;                                                  1210
         B     @EL00018                                            1210
*                                                                  1211
*/********************************************************************/
*/*                                                                  */
*/*    UPDCHK1 - CHECK FOR VALID UPDATE INPUT TEXT                   */
*/*                                                                  */
*/*            - THIS PROCEDURE IS CALLED WHEN PROCESSING IN-LINE    */
*/*              TEXT FOR ++UPDTE AND ++SRCUPD MODIFICATIONS         */
*/*                                                                  */
*/*        1. CALL UPDCHK2 TO SCAN THE INPUT TEXT (CRPBUFFR).        */
*/*                                                                  */
*/*        2.  INSURE THAT ONLY ./ CHANGE AND ./ ENDUP IEBUPDTE      */
*/*            CONTROL STATEMENTS ARE FOUND.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  1211
*UPDCHK1:                                                          1211
*   PROC;                                                          1211
UPDCHK1  STM   @14,@12,@SA00019                                    1211
*   DCL                                                            1212
*     LASTUPD# CHAR(8);             /* SEQUENCE # OF LAST UPDTE STMT.*/
*                                                                  1213
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING TEXT RECORDS FOR ++UPDTE OR ++SRCUPD               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1213
*   IF UPDEND=ON                    /* "./ ENDUP" ALREADY FOUND      */
*       &DUP362=OFF                 /* HMA362 HAS NOT BEEN ISSUED    */
*     THEN                                                         1213
         TM    UPDEND,B'01000000'                                  1213
         BNO   @RF01213                                            1213
         TM    DUP362,B'00000100'                                  1213
         BNZ   @RF01213                                            1213
*     DO;                                                          1214
*                                                                  1214
*       /*************************************************************/
*       /*                                                           */
*       /* ./ ENDUP ALREADY ENCOUNTERED ... ISSUE HMA362I            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1215
*       RECXSYSF=ON;                /* FLUSH CURRENT SYSMOD          */
         OI    RECXSYSF,B'00010000'                                1215
*       CALL WRITEPTS(SMCNTRL);     /* WRITE STMT TO SMPOUT          */
         LA    @01,@AL01216                                        1216
         BAL   @14,WRITEPTS                                        1216
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1217
*       CALL ERRMSG(HMA362I,NOPART,NOPART);                        1218
         LA    @01,@AL01218                                        1218
         BAL   @14,ERRMSG                                          1218
*       DUP362=ON;                  /* HMA362 HAS BEEN ISSUED        */
         OI    DUP362,B'00000100'                                  1219
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           1220
         OI    GSMSYNTX(@15),B'01000000'                           1220
*     END;                                                         1221
*   ELSE                                                           1222
*     DO;                                                          1222
         B     @RC01213                                            1222
@RF01213 DS    0H                                                  1223
*       ANSWER=UPDNONE;             /* INITIALIZE SWITCH             */
         MVI   ANSWER,C'N'                                         1223
*       IF CRPBUFFR(1:2)='./'       /* BUFFER CONTAINS UPDTE STMT    */
*         THEN                                                     1224
         CLC   CRPBUFFR(2),@CC02002                                1224
         BNE   @RF01224                                            1224
*         CALL UPDCHK2(ANSWER);     /* SCAN IEBUPDTE CNTRL STMT      */
         LA    @01,@AL01225                                        1225
         BAL   @14,UPDCHK2                                         1225
*       IF ANSWER=UPDENDUP          /* ./ ENDUP STATEMENT            */
*         THEN                                                     1226
@RF01224 CLI   ANSWER,C'E'                                         1226
         BNE   @RF01226                                            1226
*         UPDEND=ON;                /* ./ ENDUP FOUND                */
         OI    UPDEND,B'01000000'                                  1227
*       IF ANSWER=UPDCHANG THEN                                    1228
@RF01226 CLI   ANSWER,C'C'                                         1228
         BNE   @RF01228                                            1228
*         DO;                                                      1229
*                                                                  1229
*           /*********************************************************/
*           /*                                                       */
*           /* ./ CHANGE STMT ENCOUNTERED                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1230
*           LASTUPD#=''B;           /* CLEAR "LAST" SEQ # FOUND      */
         XC    LASTUPD#(8),LASTUPD#                                1230
*           IF UPDCHG=ON            /* ./ CHANGE ALREADY FOUND       */
*               &DUP362=OFF         /* HMA362 HAS NOT BEEN ISSUED    */
*             THEN                                                 1231
         TM    UPDCHG,B'10000000'                                  1231
         BNO   @RF01231                                            1231
         TM    DUP362,B'00000100'                                  1231
         BNZ   @RF01231                                            1231
*             DO;                                                  1232
*                                                                  1232
*               /*****************************************************/
*               /*                                                   */
*               /* MORE THAN ONE ./ CHANGE ... ISSUE HMA362I         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1233
*               RECXSYSF=ON;        /* FLUSH CURRENT SYSMOD          */
         OI    RECXSYSF,B'00010000'                                1233
*               CALL WRITEPTS(SMCNTRL);/* WRITE STMT SMPOUT          */
         LA    @01,@AL01234                                        1234
         BAL   @14,WRITEPTS                                        1234
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1235
*               CALL ERRMSG(HMA362I,NOPART,NOPART);                1236
         LA    @01,@AL01236                                        1236
         BAL   @14,ERRMSG                                          1236
*               DUP362=ON;          /* HMA362 HAS BEEN ISSUED        */
         OI    DUP362,B'00000100'                                  1237
*               GSMSYNTX=ON;        /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           1238
         OI    GSMSYNTX(@15),B'01000000'                           1238
*             END;                                                 1239
*           ELSE                                                   1240
*             DO;                                                  1240
         B     @RC01231                                            1240
@RF01231 DS    0H                                                  1241
*               IF CHNGMEM^=MCBENAME/* NAMES UNEQUAL ?               */
*                 THEN                                             1241
         L     @01,RECXMCB                                         1241
         CLC   CHNGMEM(8),MCBENAME(@01)                            1241
         BE    @RF01241                                            1241
*                 DO;                                              1242
*                                                                  1242
*                   /*************************************************/
*                   /*                                               */
*                   /* ./ CHANGE NAME INCORRECT ... ISSUE HMA292I    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1243
*                   RECXSYSF=ON;    /* FLUSH CURRENT SYSMOD          */
         OI    RECXSYSF,B'00010000'                                1243
*                   CALL WRITEPTS(SMCNTRL);/* WRITE STMT SMPOUT      */
         LA    @01,@AL01244                                        1244
         BAL   @14,WRITEPTS                                        1244
*                   MGPTYPE=MGPERR; /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1245
*                   CALL ERRMSG(HMA292I,NOPART,NOPART);            1246
         LA    @01,@AL01246                                        1246
         BAL   @14,ERRMSG                                          1246
*                   GSMSYNTX=ON;    /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           1247
         OI    GSMSYNTX(@15),B'01000000'                           1247
*                 END;                                             1248
*             END;                                                 1249
@RF01241 DS    0H                                                  1250
*           UPDCHG=ON;              /* ./ CHANGE FOUND               */
@RC01231 OI    UPDCHG,B'10000000'                                  1250
*         END;                                                     1251
*       IF ANSWER=UPDOTHER          /* INVALID IEBUPDTE CNTRL STMT   */
*         THEN                                                     1252
@RF01228 CLI   ANSWER,C'O'                                         1252
         BNE   @RF01252                                            1252
*         DO;                                                      1253
*                                                                  1253
*           /*********************************************************/
*           /*                                                       */
*           /* INVALID IEBUPDTE CONTROL STATEMENTS ... ISSUE HMA346I */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1254
*           RECXSYSF=ON;            /* FLUSH THE CURRENT SYSMOD      */
         OI    RECXSYSF,B'00010000'                                1254
*           CALL WRITEPTS(SMCNTRL); /* WRITE STATEMENT TO SMPOUT     */
         LA    @01,@AL01255                                        1255
         BAL   @14,WRITEPTS                                        1255
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1256
*           CALL ERRMSG(HMA346I,NOPART,NOPART);                    1257
         LA    @01,@AL01257                                        1257
         BAL   @14,ERRMSG                                          1257
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           1258
         OI    GSMSYNTX(@15),B'01000000'                           1258
*         END;                                                     1259
*       IF(ANSWER=UPDNONE           /* NON-IEBUPTDE CNTRL STMT       */
*           ×ANSWER=UPDENDUP)       /* "./ ENDUP" STMT               */
*           &UPDCHG=OFF             /* "./ CHANGE" NOT ENCOUNTERED   */
*           &DUP362=OFF             /* HMA362 HAS NOT BEEN ISSUED    */
*         THEN                                                     1260
@RF01252 CLI   ANSWER,C'N'                                         1260
         BE    @GL00034                                            1260
         CLI   ANSWER,C'E'                                         1260
         BNE   @RF01260                                            1260
@GL00034 TM    UPDCHG,B'10000100'                                  1260
         BNZ   @RF01260                                            1260
*         DO;                                                      1261
*                                                                  1261
*           /*********************************************************/
*           /*                                                       */
*           /* "./ CHANGE" NOT FOUND ... ISSUE HMA362I               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1262
*           RECXSYSF=ON;            /* FLUSH THE CURRENT SYSMOD      */
         OI    RECXSYSF,B'00010000'                                1262
*           CALL WRITEPTS(SMCNTRL); /* WRITE STATEMENT TO SMPOUT     */
         LA    @01,@AL01263                                        1263
         BAL   @14,WRITEPTS                                        1263
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1264
*           CALL ERRMSG(HMA362I,NOPART,NOPART);                    1265
         LA    @01,@AL01265                                        1265
         BAL   @14,ERRMSG                                          1265
*           DUP362=ON;              /* HMA362 HAS BEEN ISSUED        */
         OI    DUP362,B'00000100'                                  1266
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           1267
         OI    GSMSYNTX(@15),B'01000000'                           1267
*         END;                                                     1268
*       IF ANSWER=UPDNONE           /* NON-IEBUPTDE CNTRL STMT       */
*           &CRPBFSEQ<LASTUPD#      /* SEQ # LESS THAN LAST ONE FOUND*/
*           &DUP362=OFF             /* HMA362 HAS NOT BEEN ISSUED    */
*         THEN                                                     1269
@RF01260 CLI   ANSWER,C'N'                                         1269
         BNE   @RF01269                                            1269
         CLC   CRPBFSEQ(8),LASTUPD#                                1269
         BNL   @RF01269                                            1269
         TM    DUP362,B'00000100'                                  1269
         BNZ   @RF01269                                            1269
*         DO;                                                      1270
*                                                                  1270
*           /*********************************************************/
*           /*                                                       */
*           /* SEQUENCE NUMBER ERROR ... ISSUE HMA362I               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1271
*           RECXSYSF=ON;            /* FLUSH THE CURRENT SYSMOD      */
         OI    RECXSYSF,B'00010000'                                1271
*           CALL WRITEPTS(SMCNTRL); /* WRITE STATEMENT TO SMPOUT     */
         LA    @01,@AL01272                                        1272
         BAL   @14,WRITEPTS                                        1272
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1273
*           CALL ERRMSG(HMA362I,NOPART,NOPART);                    1274
         LA    @01,@AL01274                                        1274
         BAL   @14,ERRMSG                                          1274
*           DUP362=ON;              /* HMA362 HAS BEEN ISSUED        */
         OI    DUP362,B'00000100'                                  1275
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */
         LA    @15,GTASM                                           1276
         OI    GSMSYNTX(@15),B'01000000'                           1276
*         END;                                                     1277
*       IF ANSWER=UPDNONE           /* NON-IEBUPTDE CNTRL STMT       */
*         THEN                                                     1278
@RF01269 CLI   ANSWER,C'N'                                         1278
         BNE   @RF01278                                            1278
*         LASTUPD#=CRPBFSEQ;        /* SAVE LAST SEQ # ENCOUNTERED   */
         MVC   LASTUPD#(8),CRPBFSEQ                                1279
*     END;                                                         1280
*   RETURN;                                                        1281
@EL00019 DS    0H                                                  1281
@EF00019 DS    0H                                                  1281
@ER00019 LM    @14,@12,@SA00019                                    1281
         BR    @14                                                 1281
*   END UPDCHK1;                                                   1282
         B     @EL00019                                            1282
*                                                                  1283
*/********************************************************************/
*/*                                                                  */
*/*    UPDCHK2 - SCAN IEBUPDTE CONTROL STATEMENT IN CRPBUFFR AND     */
*/*              RETURN TO THE CALLER WITH THE TYPE OF IEBUPDTE      */
*/*              CONTROL STATEMENT ENCOUNTERED.                      */
*/*                                                                  */
*/*              UPDCK                             CHNGMEM           */
*/*              -----                          -------------------  */
*/*               'C'   - ./ CHANGE              "NAME=" OPERAND     */
*/*               'E'   - ./ ENDUPD                  N/A             */
*/*               'O'   - "OTHER" THAN ABOVE         N/A             */
*/*                                                                  */
*/********************************************************************/
*                                                                  1283
*UPDCHK2:                                                          1283
*   PROC(UPDCK);                                                   1283
UPDCHK2  STM   @14,@12,@SA00020                                    1283
         MVC   @PC00020(4),0(@01)                                  1283
*   DCL                                                            1284
*     UPDCK CHAR(1);                /* RETURN PARAMETER (SEE ABOVE)  */
*   UPDCK=UPDOTHER;                 /* INITIALIZE RETURNED PARAMETER
*                                      ... WILL BE CHANGED BY SCAN 1285
*                                      ROUTES IF "CHANGE" OR "ENDUP"
*                                      STATEMENTS ARE ENCOUNTERED    */
*                                                                  1285
         L     @15,@PC00020                                        1285
         MVI   UPDCK(@15),C'O'                                     1285
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMSCN PARAMETER INITIALIZATION (HMASMSCP)                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1286
*   SCPCHAR=ADDR(CRPBUFFR);         /* BEGINNING OF RECORD (WILL BE A
*                                      './')                         */
         L     @15,SCPPTR                                          1286
         LA    @14,CRPBUFFR                                        1286
         ST    @14,SCPCHAR(,@15)                                   1286
*   SCPSRCH=ADDR(UPDDSCAN);         /* DSCANS                        */
         LA    @14,UPDDSCAN                                        1287
         ST    @14,SCPSRCH(,@15)                                   1287
*   SCPINLN=LENGTH(CRPBUFFR);       /* BUFFER IN CRD PARM LIST       */
         MVC   SCPINLN(2,@15),@CH00429                             1288
*   SCPIORTN=ADDR(HMASMCRD);        /* FOR ADDITIONAL RECORDS DURING
*                                      SCAN GO HERE                  */
         L     @14,@CV01708                                        1289
         ST    @14,SCPIORTN(,@15)                                  1289
*   SCPEOR=ZERO;                    /* CLEAR END OF RECORD FLAG      */
         MVI   SCPEOR(@15),X'00'                                   1290
*   SCPCONT=ON;                     /* CHK CONTINUATION IN COL 71    */
*   SCPCOMNT=OFF;                   /* COMMENTS ARE NOT APPLICABLE   */
*                                                                  1292
         OI    SCPCONT(@15),B'10000000'                            1292
         NI    SCPCOMNT(@15),B'11011111'                           1292
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMCRP PARAMETER INITIALIZATION                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1293
*   CRPUXNUM=UXPUX001;              /* SET RECEIVE USER EXIT         */
         MVI   CRPUXNUM,X'01'                                      1293
*   CRPSCPAD=SCPPTR;                /* SCP ADDRESS                   */
         ST    @15,CRPSCPAD                                        1294
*   CRPINDS=IOPPTFIN;               /* INPUT DATASET (SMPPTFIN)      */
         MVI   CRPINDS,X'0A'                                       1295
*   CRPBFPRM=OFF;                   /* THE BUFFER IS PRIMED NOW BUT
*                                      WILL NOT BE IF CALLED BY SCN  */
*   CRPPTS=ON;                      /* WRITE RECORDS TO SMPPTS       */
*   CRPLOG=OFF;                     /* DO NOT WRITE TO SMPLOG        */
*   CRPPRINT=OFF;                   /* DO NOT WRITE TO SMPOUT        */
*   CRPOTHER=OFF;                   /* DO NOT WRITE TO CRDOUTDS      */
*                                                                  1300
         OI    CRPPTS,B'00100000'                                  1300
         NI    CRPBFPRM,B'01100011'                                1300
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL HMASMSCN TO SCAN FOR INVALID IEBUPDTE STATEMENTS.        */
*   /* HMASMCRD WILL BE CALLED FOR IEBUPDTE STATEMENT CONTINUATIONS  */
*   /* AND EACH RECORD WILL BE WRITTEN TO SMPPTS, SMPLOG AND SMPOUT. */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1301
*   CALL HMASMSCN(HMASMSCP);        /* SCAN STATEMENT                */
         ST    @15,@AL00001                                        1301
         L     @15,@CV01705                                        1301
         LA    @01,@AL00001                                        1301
         BALR  @14,@15                                             1301
*   IF SCPRET>SCPEXC THEN                                          1302
         L     @15,SCPPTR                                          1302
         CLI   SCPRET(@15),12                                      1302
         BNH   @RF01302                                            1302
*     DO;                                                          1303
*                                                                  1303
*       /*************************************************************/
*       /*                                                           */
*       /* TERMINAL ERROR DURING SCAN                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1304
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                1304
*       RECXMAX=MAX(RECXMAX,SCPRET);                               1305
         L     @14,RECXMAX                                         1305
         SLR   @07,@07                                             1305
         IC    @07,SCPRET(,@15)                                    1305
         CR    @14,@07                                             1305
         BNL   *+6
         LR    @14,@07                                             1305
         ST    @14,RECXMAX                                         1305
*     END;                                                         1306
*   RETURN;                                                        1307
@EL00020 DS    0H                                                  1307
@EF00020 DS    0H                                                  1307
@ER00020 LM    @14,@12,@SA00020                                    1307
         BR    @14                                                 1307
*                                                                  1308
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCANS FOR IEBUPDTE CONTROL STATEMENTS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1308
*   GEN DATA DEFS(UPDDSCAN) REFS(UPDDCHNG,UPDDENDU,UPDDNAME,UPDDSKIP);
*                                                                  1308
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN EXITS FOR IEBUPDTE CONTROL STATEMENTS                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1309
*   RESPECIFY                                                      1309
*    (REG1,                                                        1309
*     REG14) RSTD;                                                 1309
*                                                                  1309
*   /*****************************************************************/
*   /*                                                               */
*   /* IEBUPDTE "./ CHANGE" FOUND                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1310
*UPDDCHNG:                                                         1310
*   PROC;                                                          1310
         B     @PB00021                                            1310
UPDDCHNG STM   @14,@12,12(@13)                                     1310
*   UPDCK=UPDCHANG;                 /* SET RETURNED PARAMETER        */
         L     @15,@PC00020                                        1311
         MVI   UPDCK(@15),C'C'                                     1311
*   CHNGMEM='        ';             /* BLANK "NAME=" VARIABLE        */
         MVC   CHNGMEM(8),@CC02018                                 1312
*   RETURN;                                                        1313
@EL00021 DS    0H                                                  1313
@EF00021 DS    0H                                                  1313
@ER00021 LM    @14,@12,12(@13)                                     1313
         BR    @14                                                 1313
*   END UPDDCHNG;                                                  1314
*                                                                  1314
*   /*****************************************************************/
*   /*                                                               */
*   /* IEBUPDTE "NAME= " FOUND                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1315
*UPDDNAME:                                                         1315
*   PROC;                                                          1315
UPDDNAME STM   @14,@12,12(@13)                                     1315
*   CHNGMEM(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPERAND OF "NAME="
*                                      KEYWORD                       */
         L     @15,SCPPTR                                          1316
         LH    @07,SCPPMLN(,@15)                                   1316
         BCTR  @07,0                                               1316
         L     @06,SCPCHAR(,@15)                                   1316
         EX    @07,@SM02176                                        1316
*   SCPRET=SCPNDSCN;                /* STOP SCAN ... RETURN TO CALLER*/
         MVI   SCPRET(@15),X'04'                                   1317
*   RETURN;                                                        1318
@EL00022 DS    0H                                                  1318
@EF00022 DS    0H                                                  1318
@ER00022 LM    @14,@12,12(@13)                                     1318
         BR    @14                                                 1318
*   END UPDDNAME;                                                  1319
*                                                                  1319
*   /*****************************************************************/
*   /*                                                               */
*   /* KEYWORD OTHER THAN " NAME= " FOUND ON "./ CHANGE"             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1320
*UPDDSKIP:                                                         1320
*   PROC;                                                          1320
UPDDSKIP STM   @14,@12,12(@13)                                     1320
*   IF SCPPMLN=0                    /* ZERO LENGTH ... EQUAL SIGN    */
*     THEN                                                         1321
         L     @15,SCPPTR                                          1321
         LH    @00,SCPPMLN(,@15)                                   1321
         LTR   @00,@00                                             1321
         BNZ   @RF01321                                            1321
*     SCPPMLN=1;                    /* MAKE SCN THINK LENGTH IS 1    */
         MVC   SCPPMLN(2,@15),@CH00041                             1322
*   RETURN;                                                        1323
@EL00023 DS    0H                                                  1323
@EF00023 DS    0H                                                  1323
@ER00023 LM    @14,@12,12(@13)                                     1323
         BR    @14                                                 1323
*   END UPDDSKIP;                                                  1324
*                                                                  1324
         B     @EL00023                                            1324
*   /*****************************************************************/
*   /*                                                               */
*   /* IEBUPDTE "./ ENDUP " FOUND                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1325
*UPDDENDU:                                                         1325
*   PROC;                                                          1325
UPDDENDU STM   @14,@12,12(@13)                                     1325
*   UPDCK=UPDENDUP;                 /* SET RETURNED PARAMETER        */
         L     @15,@PC00020                                        1326
         MVI   UPDCK(@15),C'E'                                     1326
*   SCPRET=SCPNDSCN;                /* STOP SCAN ... RETURN TO CALLER*/
         L     @15,SCPPTR                                          1327
         MVI   SCPRET(@15),X'04'                                   1327
*   RETURN;                                                        1328
@EL00024 DS    0H                                                  1328
@EF00024 DS    0H                                                  1328
@ER00024 LM    @14,@12,12(@13)                                     1328
         BR    @14                                                 1328
*   END UPDDENDU;                                                  1329
*   RESPECIFY                                                      1330
*    (REG1,                                                        1330
*     REG14) UNRSTD;                                               1330
*   END UPDCHK2;                                                   1331
         B     @EL00020                                            1331
*                                                                  1332
*/********************************************************************/
*/*                                                                  */
*/*    RCTPROC - PROCESS RELFILE KEYWORD FOUND ON ++JCLIN AND        */
*/*              ELEMENT MODIFICATION CONTROL STATEMENTS.            */
*/*                                                                  */
*/*        1. CHECK THAT THE RELFILE IS NOT GREATER THAT THE NUMBER  */
*/*           OF FILES ON THE CURRENT SYSMOD.                        */
*/*                                                                  */
*/*        2. PUT THE ELEMENT NAME, TYPE AND ABSOLUTE FILE SEQUENCE  */
*/*           NUMBER IN THE RELFILE GTA FILE.                        */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1332
*RCTPROC:                                                          1332
*   PROC;                                                          1332
*                                                                  1332
RCTPROC  STM   @14,@12,@SA00025                                    1332
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT RELFILE KEYWORD FROM CHARACTER TO BINARY              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1333
*   RADJ=ZEROS;                     /* INIT WORK AREA TO RECEIVE   1333
*                                      RIGHT-ADJUSTED RELFILE NUMBER */
         MVC   RADJ(8),@CC01742                                    1333
*   JJ=LENGTH(RADJ);                /* INDEX SET TO RIGHT-HAND BYTE  */
         MVC   JJ(4),@CF00033                                      1334
*   DO II=LENGTH(MCBERLF) TO 1 BY-1;/* MOVE THRU MCBERLF FROM RIGHT
*                                      TO LEFT                       */
         LA    @15,4                                               1335
         ST    @15,II                                              1335
@DL01335 DS    0H                                                  1336
*     IF MCBERLF(II)^=' ' THEN      /* IGNORE BLANKS IN MCBERLF      */
         L     @14,RECXMCB                                         1336
         ALR   @15,@14                                             1336
         CLI   MCBERLF-1(@15),C' '                                 1336
         BE    @RF01336                                            1336
*       DO;                                                        1337
*         RADJ(JJ)=MCBERLF(II);     /* PUT CHAR IN WK AREA           */
         L     @15,JJ                                              1338
         LA    @01,RADJ-1(@15)                                     1338
         L     @07,II                                              1338
         ALR   @14,@07                                             1338
         MVC   0(1,@01),MCBERLF-1(@14)                             1338
*         JJ=JJ-1;                  /* MOVE WK AREA INDEX 1 TO LEFT  */
         BCTR  @15,0                                               1339
         ST    @15,JJ                                              1339
*       END;                                                       1340
*   END;                                                           1341
@RF01336 SLR   @15,@15                                             1341
         BCTR  @15,0                                               1341
         AL    @15,II                                              1341
         ST    @15,II                                              1341
         LTR   @15,@15                                             1341
         BP    @DL01335                                            1341
*   PACK(PKDEC,RADJ);               /* CONVERT CHAR TO PACKED DECIMAL*/
         PACK  PKDEC(8),RADJ(8)                                    1342
*   CVB(FIX31,PKDEC);               /* CONVERT PACKED DECIMAL TO   1343
*                                      BINARY                        */
         CVB   @15,PKDEC                                           1343
         ST    @15,FIX31                                           1343
*   RECXRELM=FIX31;                 /* SET CURRENT ELEMENT'S RELFILE */
         STH   @15,RECXRELM                                        1344
*   IF FIX31>RECXRFLE THEN                                         1345
         CH    @15,RECXRFLE                                        1345
         BNH   @RF01345                                            1345
*     DO;                                                          1346
*                                                                  1346
*       /*************************************************************/
*       /*                                                           */
*       /* RELFILE > FILES                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1347
*       MGPTYPE=MGPSEV;             /* SEVERE ERROR ... STOP RECEIVE */
         MVI   MGPTYPE,X'04'                                       1347
*       RECXSYSF=ON;                /* STOP THIS SYSMOD              */
         OI    RECXSYSF,B'00010000'                                1348
*       GSMSYNTX=ON;                /* SYNTAX ERROR                  */
         LA    @15,GTASM                                           1349
         OI    GSMSYNTX(@15),B'01000000'                           1349
*       CALL ERRMSG(HMA350I,NOPART,NOPART);                        1350
         LA    @01,@AL01350                                        1350
         BAL   @14,ERRMSG                                          1350
*     END;                                                         1351
*   ELSE                                                           1352
*     DO;                                                          1352
*                                                                  1352
         B     @RC01345                                            1352
@RF01345 DS    0H                                                  1353
*       /*************************************************************/
*       /*                                                           */
*       /* SET RELFILE DATA IN RELFILE GTA FILE                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1353
*       RESPECIFY                                                  1353
*         HMASMGTP BASED(RECXGRFP); /* RELFILE GTP                   */
*       IF RECXRELM^=0              /* RELFILE NON-ZERO ?            */
*           &RECXSYSF=OFF           /* SYSMOD NOT BEING FLUSHED ?    */
*         THEN                                                     1354
         LH    @15,RECXRELM                                        1354
         LTR   @15,@15                                             1354
         BZ    @RF01354                                            1354
         TM    RECXSYSF,B'00010000'                                1354
         BNZ   @RF01354                                            1354
*         DO;                                                      1355
*           GRFFSEQ=RECXRCUR+RECXRELM-1;/* ABSOLUTE FILE SEQ. NO.    */
         LA    @14,GTARF                                           1356
         AH    @15,RECXRCUR                                        1356
         BCTR  @15,0                                               1356
         ST    @15,@TF00001                                        1356
         MVC   GRFFSEQ(2,@14),@TF00001+2                           1356
*           IF MCBTYPE^=MCBJCLTP THEN                              1357
         L     @15,RECXMCB                                         1357
         CLI   MCBTYPE(@15),10                                     1357
         BE    @RF01357                                            1357
*             GRFELEM=MCBENAME;     /* MOD, MAC, SRC MEMBER          */
         MVC   GRFELEM(8,@14),MCBENAME(@15)                        1358
*           ELSE                                                   1359
*             GRFELEM=RECXIOPP->IOPNAM17;/* JCLIN MEMBER             */
         B     @RC01357                                            1359
@RF01357 LA    @15,GTARF                                           1359
         MVI   GRFELEM+7(@15),C' '                                 1359
         L     @14,RECXIOPP                                        1359
         MVC   GRFELEM(7,@15),IOPNAM17(@14)                        1359
*           GRFELTY=MCBTYPE;        /* TYPE                          */
@RC01357 LA    @15,GTARF                                           1360
         L     @14,RECXMCB                                         1360
         MVC   GRFELTY(1,@15),MCBTYPE(@14)                         1360
*           GRFSM#=RECXIOPP->IOPNAM17;/* SYSMOD NAME                 */
         L     @07,RECXIOPP                                        1361
         MVC   GRFSM#(7,@15),IOPNAM17(@07)                         1361
*           GRFSTY=RECXIOPP->IOPPTYPE;/* SYSMOD TYPE                 */
         MVC   GRFSTY(1,@15),IOPPTYPE(@07)                         1362
*           GRFFLGS=''B;            /* CLEAR FLAGS                   */
         MVI   GRFFLGS(@15),X'00'                                  1363
*           GRFRELF=MCBERLF;        /* RELFILE KEYWORD CHAR STRING 1364
*                                      FOR TAPE DSN FORMATION        */
         MVC   GRFRELF(4,@15),MCBERLF(@14)                         1364
*           GRFRELF#=RECXRELM;      /* RELFILE VALUE (BINARY) FOR  1365
*                                      DASD DSN FORMATION)           */
         MVC   GRFRELF#(2,@15),RECXRELM                            1365
*           GTPFUNCT=GTPADD;        /* ADD TO GTA FILE               */
         L     @15,RECXGRFP                                        1366
         MVI   GTPFUNCT(@15),X'04'                                 1366
*           CALL HMASMGTA(HMASMGTP);                               1367
         ST    @15,@AL00001                                        1367
         L     @15,@CV01706                                        1367
         LA    @01,@AL00001                                        1367
         BALR  @14,@15                                             1367
*           RECXMAX=MAX(RECXMAX,GTPRETRN);                         1368
*                                                                  1368
         L     @15,RECXGRFP                                        1368
         L     @14,RECXMAX                                         1368
         SLR   @07,@07                                             1368
         IC    @07,GTPRETRN(,@15)                                  1368
         CR    @14,@07                                             1368
         BNL   *+6
         LR    @14,@07                                             1368
         ST    @14,RECXMAX                                         1368
*           /*********************************************************/
*           /*                                                       */
*           /* SET RELFILE PRESENT IN SUMMARY RECORD                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1369
*           GSMRLFP=ON;             /* RELFILE ELEMENTS PRESENT      */
*                                                                  1369
         LA    @07,GTASM                                           1369
         OI    GSMRLFP(@07),B'01000000'                            1369
*           /*********************************************************/
*           /*                                                       */
*           /* PUT ANY ALIAS NAMES FOR THE ELEMENT INTO THE RELFILE  */
*           /* GTA FILE                                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1370
*           IF RECXMAX<STOPFUNC&MCBTYPE^=MCBJCLTP THEN             1370
         CH    @14,@CH00036                                        1370
         BNL   @RF01370                                            1370
         L     @14,RECXMCB                                         1370
         CLI   MCBTYPE(@14),10                                     1370
         BE    @RF01370                                            1370
*             DO;                                                  1371
*                                                                  1371
*               /*****************************************************/
*               /*                                                   */
*               /* FOR NON-JCLIN ELEMENT TYPES, THERE MAY BE ALIAS   */
*               /* NAMES IN THE MCB                                  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1372
*               IF MCBEDALS(1)^=' ' THEN                           1372
         CLI   MCBEDALS(@14),C' '                                  1372
         BE    @RF01372                                            1372
*                 DO;                                              1373
*                                                                  1373
*                   /*************************************************/
*                   /*                                               */
*                   /* DALIAS ... PUT IT INTO RELFILE GTA FILE       */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1374
*                   GRFELEM=MCBEDALS;/* ALIAS NAME                   */
         LA    @07,GTARF                                           1374
         MVC   GRFELEM(8,@07),MCBEDALS(@14)                        1374
*                   CALL HMASMGTA(HMASMGTP);                       1375
         ST    @15,@AL00001                                        1375
         L     @15,@CV01706                                        1375
         LA    @01,@AL00001                                        1375
         BALR  @14,@15                                             1375
*                   RECXMAX=MAX(RECXMAX,GTPRETRN);/* IN CASE GTA HAD
*                                      AN ERROR                      */
         L     @15,RECXMAX                                         1376
         L     @14,RECXGRFP                                        1376
         SLR   @07,@07                                             1376
         IC    @07,GTPRETRN(,@14)                                  1376
         CR    @15,@07                                             1376
         BNL   *+6
         LR    @15,@07                                             1376
         ST    @15,RECXMAX                                         1376
*                 END;                                             1377
*                                                                  1377
*               /*****************************************************/
*               /*                                                   */
*               /* GO THRU MCB SUB-ENTRIES FOR MALIAS AND TALIAS     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1378
*               DO II=1 BY 1 WHILE MCBEND(II)^=IOPEOLST&RECXMAX<   1378
*                     STOPFUNC;                                    1378
@RF01372 LA    @15,1                                               1378
         ST    @15,II                                              1378
         B     @DE01378                                            1378
@DL01378 DS    0H                                                  1379
*                 IF MCBEIND(II)=MCBEALIS THEN                     1379
         L     @15,RECXMCB                                         1379
         L     @14,II                                              1379
         MH    @14,@CH00034                                        1379
         SLR   @07,@07                                             1379
         IC    @07,MCBEIND-9(@14,@15)                              1379
         CH    @07,@CH00232                                        1379
         BNE   @RF01379                                            1379
*                   DO;                                            1380
*                                                                  1380
*                     /***********************************************/
*                     /*                                             */
*                     /* MALIAS OR TALIAS ... PUT IT INTO RELFILE GTA*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1381
*                     GRFELEM=MCBENTRY(II);/* ALIAS NAME             */
         LA    @07,GTARF                                           1381
         ALR   @15,@14                                             1381
         MVC   GRFELEM(8,@07),MCBENTRY-9(@15)                      1381
*                     CALL HMASMGTA(HMASMGTP);                     1382
         L     @01,RECXGRFP                                        1382
         ST    @01,@AL00001                                        1382
         L     @15,@CV01706                                        1382
         LA    @01,@AL00001                                        1382
         BALR  @14,@15                                             1382
*                     RECXMAX=MAX(RECXMAX,GTPRETRN);/* IN CASE GTA 1383
*                                      HAD AN ERROR                  */
         L     @15,RECXMAX                                         1383
         L     @14,RECXGRFP                                        1383
         SLR   @07,@07                                             1383
         IC    @07,GTPRETRN(,@14)                                  1383
         CR    @15,@07                                             1383
         BNL   *+6
         LR    @15,@07                                             1383
         ST    @15,RECXMAX                                         1383
*                   END;                                           1384
*               END;                                               1385
@RF01379 LA    @15,1                                               1385
         AL    @15,II                                              1385
         ST    @15,II                                              1385
@DE01378 L     @15,II                                              1385
         MH    @15,@CH00034                                        1385
         L     @01,RECXMCB                                         1385
         SLR   @14,@14                                             1385
         IC    @14,MCBEND-9(@15,@01)                               1385
         CH    @14,@CH00766                                        1385
         BE    @DC01378                                            1385
         L     @15,RECXMAX                                         1385
         CH    @15,@CH00036                                        1385
         BL    @DL01378                                            1385
@DC01378 DS    0H                                                  1386
*             END;                                                 1386
*         END;                                                     1387
*     END;                                                         1388
*   RETURN;                                                        1389
@EL00025 DS    0H                                                  1389
@EF00025 DS    0H                                                  1389
@ER00025 LM    @14,@12,@SA00025                                    1389
         BR    @14                                                 1389
*   END RCTPROC;                                                   1390
         B     @EL00025                                            1390
*                                                                  1391
*/********************************************************************/
*/*                                                                  */
*/*    SECHK  - DETERMINE WHETHER THE SYSMOD (FOUND IN GSMS#) SHOULD */
*/*             BE EXCLUDED FROM RECEIVE PROCESSING.                 */
*/*                                                                  */
*/*           - ON ENTY:                                             */
*/*                                                                  */
*/*              - GSMS# IN SUMMARY GTA RECORD SHOULD BE INITIALIZED */
*/*                WITH THE SYSMOD-ID TO BE CHECKED FOR EXCLUSION.   */
*/*                                                                  */
*/*           - ON EXIT:                                             */
*/*                                                                  */
*/*              -  RECX AND GTA SUMMARY FLAGS SET APPROPRIATELY     */
*/*                                                                  */
*/********************************************************************/
*                                                                  1391
*SECHK:                                                            1391
*   PROC;                                                          1391
*                                                                  1391
SECHK    STM   @14,@12,@SA00026                                    1391
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SELECT/EXCLUDE MODE PROCESSING                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1392
*   IF RECSEL=ON×RECEXC=ON THEN                                    1392
         L     @15,@PC00001                                        1392
         TM    RECSEL(@15),B'11000000'                             1392
         BZ    @RF01392                                            1392
*     DO;                                                          1393
*                                                                  1393
*       /*************************************************************/
*       /*                                                           */
*       /* SELECT OR EXCLUDE SPECIFIED ... CHECK THE SET FOR THE     */
*       /* PRESENCE OF THIS SYSMOD.                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1394
*       RESPECIFY                                                  1394
*         HMASMGTP BASED(CCASETAD); /* SET GTP                       */
*       HMASMSET=''B;               /* CLEAR SET RECORD              */
         XC    HMASMSET(12),HMASMSET                               1395
*       SENAME=' ';                 /* BLANK NAME FIELD IN RECORD    */
         MVI   SENAME+1,C' '                                       1396
         MVC   SENAME+2(6),SENAME+1                                1396
         MVI   SENAME,C' '                                         1396
*       SESMD=ON;                   /* SYSMOD NAME ENTRY IN SET      */
         OI    SESMD,B'00000001'                                   1397
*       SESMDNO=GSMS#;              /* SYSMOD NAME INTO SET          */
         LA    @15,GTASM                                           1398
         MVC   SESMDNO(7),GSMS#(@15)                               1398
*       GTPBUFAD=ADDR(HMASMSET);    /* POINT TO SET                  */
         L     @15,CCASETAD(,CCAPTR)                               1399
         LA    @14,HMASMSET                                        1399
         ST    @14,GTPBUFAD(,@15)                                  1399
*       GTPKEYLN=LENGTH(SELSTENT);  /* KEY LENGTH                    */
         MVC   GTPKEYLN(2,@15),@CH00035                            1400
*       GTPFUNCT=GTPLOC;            /* LOCATE FUNCTION               */
         MVI   GTPFUNCT(@15),X'03'                                 1401
*       CALL HMASMGTA(HMASMGTP);    /* SEE IF SYSMOD IS IN SET       */
         ST    @15,@AL00001                                        1402
         L     @15,@CV01706                                        1402
         LA    @01,@AL00001                                        1402
         BALR  @14,@15                                             1402
*       IF GTPRETRN=GTPGOOD THEN                                   1403
         L     @01,CCASETAD(,CCAPTR)                               1403
         CLI   GTPRETRN(@01),0                                     1403
         BNE   @RF01403                                            1403
*         DO;                                                      1404
*                                                                  1404
*           /*********************************************************/
*           /*                                                       */
*           /* SYSMOD FOUND IN SET                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1405
*           IF RECEXC=ON THEN                                      1405
         L     @15,@PC00001                                        1405
         TM    RECEXC(@15),B'01000000'                             1405
         BNO   @RF01405                                            1405
*             DO;                                                  1406
*                                                                  1406
*               /*****************************************************/
*               /*                                                   */
*               /* EXCLUDE MODE ... STOP THIS SYSMOD                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1407
*               RECXSYSF=ON;        /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                1407
*               GSMEXCL=ON;         /* EXCLUDED                      */
         LA    @15,GTASM                                           1408
         OI    GSMEXCL(@15),B'00010000'                            1408
*               MCSCHECK=OFF;       /* SUPPRESS MOD.CNTL.STMT. CHECKS*/
         NI    MCSCHECK,B'11111101'                                1409
*             END;                                                 1410
*           ELSE                                                   1411
*             DO;                                                  1411
*                                                                  1411
         B     @RC01405                                            1411
@RF01405 DS    0H                                                  1412
*               /*****************************************************/
*               /*                                                   */
*               /* SELECT MODE ... CONTINUE PROCESSING THIS SYSMOD   */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1412
*               GSMSEL=ON;          /* SELECTED                      */
         LA    @15,GTASM                                           1412
         OI    GSMSEL(@15),B'00010000'                             1412
*               IF SEFOUND=OFF      /* FOUND BEFORE DURING RECEIVE?  */
*                 THEN              /*                               */
         TM    SEFOUND,B'00000001'                                 1413
         BNZ   @RF01413                                            1413
*                 DO;                                              1414
*                   RECXSCNT=RECXSCNT-1;/* NO ... DECREMENT SELECT 1415
*                                      COUNT                         */
*                                                                  1415
         LH    @15,RECXSCNT                                        1415
         BCTR  @15,0                                               1415
         STH   @15,RECXSCNT                                        1415
*                   /*************************************************/
*                   /*                                               */
*                   /* PUT SET RECORD BACK TO GTA FILE WITH SEFOUND  */
*                   /* SET                                           */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1416
*                   SEFOUND=ON;     /* SELECTED SYSMOD FOUND         */
         OI    SEFOUND,B'00000001'                                 1416
*                   GTPFUNCT=GTPADD;/* ADD FUNCTION                  */
         L     @15,CCASETAD(,CCAPTR)                               1417
         MVI   GTPFUNCT(@15),X'04'                                 1417
*                   CALL HMASMGTA(HMASMGTP);/* PUT BACK IN GTA FILE  */
         ST    @15,@AL00001                                        1418
         L     @15,@CV01706                                        1418
         LA    @01,@AL00001                                        1418
         BALR  @14,@15                                             1418
*                 END;                                             1419
*             END;                                                 1420
*         END;                                                     1421
*       ELSE                                                       1422
*         DO;                                                      1422
*                                                                  1422
         B     @RC01403                                            1422
@RF01403 DS    0H                                                  1423
*           /*********************************************************/
*           /*                                                       */
*           /* SYSMOD NOT FOUND IN SET                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1423
*           IF RECSEL=ON THEN                                      1423
         L     @15,@PC00001                                        1423
         TM    RECSEL(@15),B'10000000'                             1423
         BNO   @RF01423                                            1423
*             DO;                                                  1424
*                                                                  1424
*               /*****************************************************/
*               /*                                                   */
*               /* SELECT MODE ... STOP THIS SYSMOD                  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1425
*               RECXSYSF=ON;        /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                1425
*               GSMEXCL=ON;         /* NOT SELECTED                  */
         LA    @15,GTASM                                           1426
         OI    GSMEXCL(@15),B'00010000'                            1426
*               MCSCHECK=OFF;       /* SUPPRESS MOD.CNTL.STMT. CHECKS*/
         NI    MCSCHECK,B'11111101'                                1427
*             END;                                                 1428
*         END;                                                     1429
*     END;                                                         1430
*   END SECHK;                                                     1431
@EL00026 DS    0H                                                  1431
@EF00026 DS    0H                                                  1431
@ER00026 LM    @14,@12,@SA00026                                    1431
         BR    @14                                                 1431
*                                                                  1432
*/********************************************************************/
*/*                                                                  */
*/*    DUPCHK - CHECK THE GTA SUMMARY FILE TO DETERMINE WHETHER THE  */
*/*             CURRENT SYSMOD (FOUND IN GTA SUMMARY RECORD BUFFER)  */
*/*             HAS ALREADY BEEN PROCESSED BY THIS INVOCATION OF     */
*/*             RECEIVE                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  1432
*DUPCHK:                                                           1432
*   PROC;                                                          1432
DUPCHK   STM   @14,@12,@SA00027                                    1432
*   DCL                                                            1433
*     GSMBKUP CHAR(LENGTH(GSMREC)); /* SAVES CURRENT SUMMARY RECORD  */
*   RESPECIFY                                                      1434
*     HMASMGTP BASED(RECXGSMP);     /* ADDRESS SUMMARY GTP           */
*   GSMRDUP=OFF;                    /* CLEAR DUPLICATE SYSMOD FLAG   */
         LA    @15,GTASM                                           1435
         NI    GSMRDUP(@15),B'11111110'                            1435
*   GSMBKUP=GSMREC;                 /* BACKUP CURRENT SUMMARY RECORD */
         MVC   GSMBKUP(18),GSMREC(@15)                             1436
*   IF GSMS#^=NULLPTF# THEN                                        1437
         CLC   GSMS#(7,@15),@CC01733                               1437
         BE    @RF01437                                            1437
*     DO;                                                          1438
*       GTPKEYLN=LENGTH(GSMS#);     /* KEY LENGTH IS ONLY SYSMOD NAME
*                                      LENGTH                        */
         L     @15,RECXGSMP                                        1439
         MVC   GTPKEYLN(2,@15),@CH00088                            1439
*       GTPFUNCT=GTPLOC;            /* LOCATE FUNCTION               */
         MVI   GTPFUNCT(@15),X'03'                                 1440
*       CALL HMASMGTA(HMASMGTP);    /*                               */
         ST    @15,@AL00001                                        1441
         L     @15,@CV01706                                        1441
         LA    @01,@AL00001                                        1441
         BALR  @14,@15                                             1441
*       GSMREC=GSMBKUP;             /* RESTORE CURRENT SUMMARY RECORD*/
         LA    @15,GTASM                                           1442
         MVC   GSMREC(18,@15),GSMBKUP                              1442
*       IF GTPRETRN=GTPGOOD         /* SYSMOD FOUND IN SUMMARY FILE  */
*           &GSMEXCL=OFF            /* SYSMOD NOT EXCLUDED           */
*         THEN                                                     1443
         L     @01,RECXGSMP                                        1443
         CLI   GTPRETRN(@01),0                                     1443
         BNE   @RF01443                                            1443
         TM    GSMEXCL(@15),B'00010000'                            1443
         BNZ   @RF01443                                            1443
*         DO;                                                      1444
*                                                                  1444
*           /*********************************************************/
*           /*                                                       */
*           /* THIS SYSMOD FOUND TO BE PREVIOUSLY PROCESSED          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1445
*           RECXSYSF=ON;            /* SET FLUSH FLAG                */
         OI    RECXSYSF,B'00010000'                                1445
*           GSMRDUP=ON;             /* SET DUPLICATE SYSMOD FLAG     */
         OI    GSMRDUP(@15),B'00000001'                            1446
*         END;                                                     1447
*       GTPKEYLN=LENGTH(GSMKEY);    /* RESET SUMMARY RECORD KEY    1448
*                                      LENGTH                        */
@RF01443 L     @01,RECXGSMP                                        1448
         MVC   GTPKEYLN(2,@01),@CH00033                            1448
*     END;                                                         1449
*   RETURN;                                                        1450
@EL00027 DS    0H                                                  1450
@EF00027 DS    0H                                                  1450
@ER00027 LM    @14,@12,@SA00027                                    1450
         BR    @14                                                 1450
*   END DUPCHK;                                                    1451
         B     @EL00027                                            1451
*                                                                  1452
*/********************************************************************/
*/*                                                                  */
*/*    VERCHK - ++VER VALIDITY CHECK PROCEDURE                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  1452
*VERCHK:                                                           1452
*   PROC(VERCK);                                                   1452
VERCHK   STM   @14,@12,@SA00028                                    1452
         MVC   @PC00028(4),0(@01)                                  1452
*   DCL                                                            1453
*     VERCK CHAR(1);                /* RETURNED TO CALLER AS: ......
*                                      'Y' FOR ++VER "OK" ..........
*                                      'N' FOR ++VER NOT "OK" ...... */
*   DCL                                                            1454
*     1 VERCHKF BIT(8),             /* VERCHK FLAGS                  */
*       3 VALIDVER BIT(1),          /* ++VER APPLICABLE TO SMP R4    */
*       3 VERCKERR BIT(1),          /* ERROR DETECTED                */
*       3 * BIT(6);                 /* UNUSED                        */
*   DCL                                                            1455
*     1 NXTSUBCB BDY(WORD),         /* NEXTSUB PROC VARIABLES/FLAGS  */
*      2 SUBINDX FIXED(15),         /* MCB ENTRY INDEX               */
*      2 SUBFLGS BIT(8),            /* FLAGS                         */
*       3 SUBEFND BIT(1),           /* MCB SUB-ENTRY FOUND           */
*       3 * BIT(7),                 /* UNUSED                        */
*      2 SUBNTSM# CHAR(7);          /* MCB SUB-ENTRY DATA (SYSMOD #) */
*   DCL                                                            1456
*     PREINDX1 FIXED(31);           /* INDEX 1ST PREREQ SUB-ENTRY    */
*   DCL                                                            1457
*     NPRINDX1 FIXED(31);           /* INDEX 1ST NPRE SUB-ENTRY      */
*   DCL                                                            1458
*     SUPINDX1 FIXED(31);           /* INDEX 1ST SUP SUB-ENTRY       */
*   DCL                                                            1459
*     REQINDX1 FIXED(31);           /* INDEX 1ST REQ SUB-ENTRY       */
*   DCL                                                            1460
*     FIDINDX1 FIXED(31);           /* INDEX FMID SUB-ENTRY          */
*   DCL                                                            1461
*     DELINDX1 FIXED(31);           /* INDEX 1ST DELETE SUB-ENTRY    */
*   DCL                                                            1462
*     VRSINDX1 FIXED(31);           /* INDEX 1ST VERSION SUB-ENTRY   */
*   RESPECIFY                                                      1463
*     HMASMIOP BASED(RECXIOPP);     /* PTS SYSMOD IOP                */
*   VERCK=YES;                      /* SET RETURNED PARAMETER        */
         L     @15,@PC00028                                        1464
         MVI   VERCK(@15),C'Y'                                     1464
*   VERCHKF=''B;                    /* CLEAR LOCAL FLAGS             */
*                                                                  1465
         MVI   VERCHKF,X'00'                                       1465
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ++VER APPLICABILITY                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1466
*   IF IOPPTYPE^=IOPPFUNC           /* NON-FUNCTION SYSMOD           */
*       &MCBSFMID=NULLPTF#          /* ... NO FMID OPERAND           */
*       &CCAFMID=NULLPTF#           /* ... NO FMID PARM SUPPLIED     */
*     THEN                                                         1466
         L     @01,RECXIOPP                                        1466
         CLI   IOPPTYPE(@01),4                                     1466
         BE    @RF01466                                            1466
         L     @01,RECXMCB                                         1466
         CLC   MCBSFMID(7,@01),@CC01733                            1466
         BNE   @RF01466                                            1466
         CLC   CCAFMID(7,CCAPTR),@CC01733                          1466
         BNE   @RF01466                                            1466
*     VERCK=NO;                     /* SET SWITCH - DO NOT PERFORM 1467
*                                      SUBSEQUENT CHECKS             */
*                                                                  1467
         MVI   VERCK(@15),C'N'                                     1467
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ++VER CONSISTENCY - FUNCTION-TYPE SYSMODS           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1468
*   IF VERCK=YES                    /* VALID ++VER                   */
*       &IOPPTYPE=IOPPFUNC          /* FUNCTION-TYPE SYSMOD          */
*       &REL4VER=ON                 /* NOT FIRST VALID ++VER         */
*     THEN                                                         1468
@RF01466 L     @15,@PC00028                                        1468
         CLI   VERCK(@15),C'Y'                                     1468
         BNE   @RF01468                                            1468
         L     @15,RECXIOPP                                        1468
         CLI   IOPPTYPE(@15),4                                     1468
         BNE   @RF01468                                            1468
         TM    REL4VER,B'00100000'                                 1468
         BNO   @RF01468                                            1468
*     DO;                                                          1469
*       IF(MCBSFMID=NULLPTF#        /* NO FMID SPECIFIED             */
*           &IOPFLF=OFF)            /* ... NOT FIRST-LEVEL FUNCTION  */
*           ×(MCBSFMID^=NULLPTF#    /* FMID SPECIFIED                */
*           &IOPFLF=ON)             /* ... FIRST-LEVEL-FUNCTION      */
*         THEN                                                     1470
         L     @01,RECXMCB                                         1470
         CLC   MCBSFMID(7,@01),@CC01733                            1470
         BNE   @GL00046                                            1470
         TM    IOPFLF(@15),B'00100000'                             1470
         BZ    @RT01470                                            1470
@GL00046 L     @01,RECXMCB                                         1470
         CLC   MCBSFMID(7,@01),@CC01733                            1470
         BE    @RF01470                                            1470
         L     @01,RECXIOPP                                        1470
         TM    IOPFLF(@01),B'00100000'                             1470
         BNO   @RF01470                                            1470
@RT01470 DS    0H                                                  1471
*         DO;                                                      1471
*                                                                  1471
*           /*********************************************************/
*           /*                                                       */
*           /* THIS ++VER AND PREVIOUSLY ENCOUNTERED ++VERS ARE      */
*           /* INCONSISTENT                                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1472
*           VERCKERR=ON;            /* SET ERROR FLAG                */
         OI    VERCKERR,B'01000000'                                1472
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1473
*           CALL ERRMSG(HMA363I,PART097,NOPART);/* ISSUE MSG         */
         LA    @01,@AL01474                                        1474
         BAL   @14,ERRMSG                                          1474
*         END;                                                     1475
*     END;                                                         1476
*                                                                  1476
@RF01470 DS    0H                                                  1477
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE THE SETTING OF THE "FIRST-LEVEL-FUNCTION" FLAG      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1477
*   IF VERCK=YES                    /* VALID ++VER                   */
*       &IOPPTYPE=IOPPFUNC          /* FUNCTION-TYPE SYSMOD          */
*       &REL4VER=OFF                /* FIRST VALID ++VER             */
*     THEN                                                         1477
@RF01468 L     @15,@PC00028                                        1477
         CLI   VERCK(@15),C'Y'                                     1477
         BNE   @RF01477                                            1477
         L     @15,RECXIOPP                                        1477
         CLI   IOPPTYPE(@15),4                                     1477
         BNE   @RF01477                                            1477
         TM    REL4VER,B'00100000'                                 1477
         BNZ   @RF01477                                            1477
*     DO;                                                          1478
*       REL4VER=ON;                 /* FIRST VALID REL4 ++VER FOUND  */
         OI    REL4VER,B'00100000'                                 1479
*       IF MCBSFMID=NULLPTF#        /* NO FMID SPECIFIED             */
*         THEN                                                     1480
         L     @01,RECXMCB                                         1480
         CLC   MCBSFMID(7,@01),@CC01733                            1480
         BNE   @RF01480                                            1480
*         IOPFLF=ON;                /* FIRST-LEVEL-FUNCTION          */
         OI    IOPFLF(@15),B'00100000'                             1481
*       ELSE                                                       1482
*         IOPFLF=OFF;               /* NOT FIRST-LEVEL-FUNCTION      */
         B     @RC01480                                            1482
@RF01480 L     @01,RECXIOPP                                        1482
         NI    IOPFLF(@01),B'11011111'                             1482
*     END;                                                         1483
@RC01480 DS    0H                                                  1484
*   IF VERCK=YES                    /* VALID ++VER                   */
*     THEN                                                         1484
@RF01477 L     @15,@PC00028                                        1484
         CLI   VERCK(@15),C'Y'                                     1484
         BNE   @RF01484                                            1484
*     DO;                                                          1485
*                                                                  1485
*       /*************************************************************/
*       /*                                                           */
*       /* FIND ++VER OPERANDS IN MCB SUB-ENTRIES                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1486
*       PREINDX1=0;                 /* NO PREREQ OPERANDS FOUND      */
         SLR   @15,@15                                             1486
         ST    @15,PREINDX1                                        1486
*       NPRINDX1=0;                 /* NO NPRE OPERANDS FOUND        */
         ST    @15,NPRINDX1                                        1487
*       SUPINDX1=0;                 /* NO SUP OPERANDS FOUND         */
         ST    @15,SUPINDX1                                        1488
*       REQINDX1=0;                 /* NO REQ OPERANDS FOUND         */
         ST    @15,REQINDX1                                        1489
*       FIDINDX1=0;                 /* NO FMID OPERANDS FOUND        */
         ST    @15,FIDINDX1                                        1490
*       DELINDX1=0;                 /* NO DELETE OPERANDS FOUND      */
         ST    @15,DELINDX1                                        1491
*       VRSINDX1=0;                 /* NO VERSION OPERANDS FOUND     */
         ST    @15,VRSINDX1                                        1492
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */
         MVC   SUBINDX(2),@CH00041                                 1493
*       CALL NEXTSUB(IOPPPRE);      /* SERACH FOR 1ST PREREQ         */
         LA    @01,@AL01494                                        1494
         BAL   @14,NEXTSUB                                         1494
*       IF SUBEFND=ON THEN                                         1495
         TM    SUBEFND,B'10000000'                                 1495
         BNO   @RF01495                                            1495
*         PREINDX1=SUBINDX;         /* 1ST PREREQ FOUND              */
         LH    @15,SUBINDX                                         1496
         ST    @15,PREINDX1                                        1496
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */
@RF01495 MVC   SUBINDX(2),@CH00041                                 1497
*       CALL NEXTSUB(IOPPNPR);      /* SERACH FOR 1ST NPRE           */
         LA    @01,@AL01498                                        1498
         BAL   @14,NEXTSUB                                         1498
*       IF SUBEFND=ON THEN                                         1499
         TM    SUBEFND,B'10000000'                                 1499
         BNO   @RF01499                                            1499
*         NPRINDX1=SUBINDX;         /* 1ST NPRE FOUND                */
         LH    @15,SUBINDX                                         1500
         ST    @15,NPRINDX1                                        1500
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */
@RF01499 MVC   SUBINDX(2),@CH00041                                 1501
*       CALL NEXTSUB(IOPPSUPV);     /* SERACH FOR 1ST SUP            */
         LA    @01,@AL01502                                        1502
         BAL   @14,NEXTSUB                                         1502
*       IF SUBEFND=ON THEN                                         1503
         TM    SUBEFND,B'10000000'                                 1503
         BNO   @RF01503                                            1503
*         SUPINDX1=SUBINDX;         /* 1ST SUP FOUND                 */
         LH    @15,SUBINDX                                         1504
         ST    @15,SUPINDX1                                        1504
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */
@RF01503 MVC   SUBINDX(2),@CH00041                                 1505
*       CALL NEXTSUB(IOPPREQ);      /* SERACH FOR 1ST REQ            */
         LA    @01,@AL01506                                        1506
         BAL   @14,NEXTSUB                                         1506
*       IF SUBEFND=ON THEN                                         1507
         TM    SUBEFND,B'10000000'                                 1507
         BNO   @RF01507                                            1507
*         REQINDX1=SUBINDX;         /* 1ST REQ FOUND                 */
         LH    @15,SUBINDX                                         1508
         ST    @15,REQINDX1                                        1508
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */
@RF01507 MVC   SUBINDX(2),@CH00041                                 1509
*       CALL NEXTSUB(IOPPFID);      /* SERACH FOR FMID OPERAND       */
         LA    @01,@AL01510                                        1510
         BAL   @14,NEXTSUB                                         1510
*       IF SUBEFND=ON THEN                                         1511
         TM    SUBEFND,B'10000000'                                 1511
         BNO   @RF01511                                            1511
*         FIDINDX1=SUBINDX;         /* FMID FOUND                    */
         LH    @15,SUBINDX                                         1512
         ST    @15,FIDINDX1                                        1512
*       CALL NEXTSUB(IOPPDEL);      /* SERACH FOR 1ST DELETE         */
@RF01511 LA    @01,@AL01513                                        1513
         BAL   @14,NEXTSUB                                         1513
*       IF SUBEFND=ON THEN                                         1514
         TM    SUBEFND,B'10000000'                                 1514
         BNO   @RF01514                                            1514
*         DELINDX1=SUBINDX;         /* 1ST DELETE FOUND              */
         LH    @15,SUBINDX                                         1515
         ST    @15,DELINDX1                                        1515
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */
@RF01514 MVC   SUBINDX(2),@CH00041                                 1516
*       CALL NEXTSUB(IOPPVER);      /* SERACH FOR 1ST VERSION        */
         LA    @01,@AL01517                                        1517
         BAL   @14,NEXTSUB                                         1517
*       IF SUBEFND=ON THEN                                         1518
         TM    SUBEFND,B'10000000'                                 1518
         BNO   @RF01518                                            1518
*         VRSINDX1=SUBINDX;         /* 1ST VERSION FOUND             */
         LH    @15,SUBINDX                                         1519
         ST    @15,VRSINDX1                                        1519
*                                                                  1520
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR INVALID KEYWORDS ON NON-FUNCTION ++VER STMTS    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1520
*       IF IOPPTYPE^=IOPPFUNC       /* NON-FUNCTION SYSMOD           */
*         THEN                                                     1520
@RF01518 L     @01,RECXIOPP                                        1520
         CLI   IOPPTYPE(@01),4                                     1520
         BE    @RF01520                                            1520
*         DO;                                                      1521
*           IF DELINDX1^=0          /* DELETE KEYWORD FOUND          */
*             THEN                                                 1522
         L     @15,DELINDX1                                        1522
         LTR   @15,@15                                             1522
         BZ    @RF01522                                            1522
*             DO;                                                  1523
*               VERCKERR=ON;        /* SET VC3 ERROR FLAG            */
         OI    VERCKERR,B'01000000'                                1524
*               VPART#1=MSGDEL;     /* SET UP FOR ERRMSG - 'DELETE'  */
         MVC   VPART#1(8),MSGDEL                                   1525
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1526
*               CALL ERRMSG(HMA363I,PART098,NOPART);/* ISSUE HMA363I */
         LA    @01,@AL01527                                        1527
         BAL   @14,ERRMSG                                          1527
*             END;                                                 1528
*           IF VERCK=YES            /* VALID ++VER                   */
*               &NPRINDX1^=0        /* NPRE KEYWORD FOUND            */
*             THEN                                                 1529
@RF01522 L     @15,@PC00028                                        1529
         CLI   VERCK(@15),C'Y'                                     1529
         BNE   @RF01529                                            1529
         L     @15,NPRINDX1                                        1529
         LTR   @15,@15                                             1529
         BZ    @RF01529                                            1529
*             DO;                                                  1530
*               VERCKERR=ON;        /* SET VC3 ERROR FLAG            */
         OI    VERCKERR,B'01000000'                                1531
*               VPART#1=MSGNPRE;    /* SET UP FOR ERRMSG - 'NPRE'    */
         MVC   VPART#1(8),MSGNPRE                                  1532
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1533
*               CALL ERRMSG(HMA363I,PART098,NOPART);/* ISSUE HMA363I */
         LA    @01,@AL01534                                        1534
         BAL   @14,ERRMSG                                          1534
*             END;                                                 1535
*         END;                      /* END NON-FUNCTION SYSMOD CHECKS*/
*                                                                  1536
@RF01529 DS    0H                                                  1537
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE PREREQ OPERANDS AGAINST SYSMOD-ID                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1537
*       CALL OPRNDSMI(PREINDX1,IOPPPRE);                           1537
*                                                                  1537
@RF01520 LA    @01,@AL01537                                        1537
         BAL   @14,OPRNDSMI                                        1537
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE NPRE OPERANDS AGAINST SYSMOD-ID                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1538
*       CALL OPRNDSMI(NPRINDX1,IOPPNPR);                           1538
*                                                                  1538
         LA    @01,@AL01538                                        1538
         BAL   @14,OPRNDSMI                                        1538
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE FMID OPERAND AGAINST SYSMOD-ID                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1539
*       CALL OPRNDSMI(FIDINDX1,IOPPFID);                           1539
*                                                                  1539
         LA    @01,@AL01539                                        1539
         BAL   @14,OPRNDSMI                                        1539
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE DELETE OPERAND AGAINST SYSMOD-ID                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1540
*       CALL OPRNDSMI(DELINDX1,IOPPDEL);                           1540
*                                                                  1540
         LA    @01,@AL01540                                        1540
         BAL   @14,OPRNDSMI                                        1540
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE SUP OPERAND AGAINST SYSMOD-ID                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1541
*       CALL OPRNDSMI(SUPINDX1,IOPPSUPV);                          1541
*                                                                  1541
         LA    @01,@AL01541                                        1541
         BAL   @14,OPRNDSMI                                        1541
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE PREREQ OPERANDS AGAINST NPRE OPERANDS             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1542
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,NPRINDX1,IOPPNPR);          1542
*                                                                  1542
         LA    @01,@AL01542                                        1542
         BAL   @14,OPRNDCHK                                        1542
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE PREREQ OPERANDS AGAINST SUP OPERANDS              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1543
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,SUPINDX1,IOPPSUPV);         1543
*                                                                  1543
         LA    @01,@AL01543                                        1543
         BAL   @14,OPRNDCHK                                        1543
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE PREREQ OPERANDS AGAINST REQ OPERANDS              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1544
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,REQINDX1,IOPPREQ);          1544
*                                                                  1544
         LA    @01,@AL01544                                        1544
         BAL   @14,OPRNDCHK                                        1544
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE PREREQ OPERANDS AGAINST FMID OPERAND              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1545
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,FIDINDX1,IOPPFID);          1545
*                                                                  1545
         LA    @01,@AL01545                                        1545
         BAL   @14,OPRNDCHK                                        1545
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE PREREQ OPERANDS AGAINST DELETE OPERANDS           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1546
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,DELINDX1,IOPPDEL);          1546
*                                                                  1546
         LA    @01,@AL01546                                        1546
         BAL   @14,OPRNDCHK                                        1546
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE NPRE OPERANDS AGAINST SUP OPERANDS                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1547
*       CALL OPRNDCHK(NPRINDX1,IOPPNPR,SUPINDX1,IOPPSUPV);         1547
*                                                                  1547
         LA    @01,@AL01547                                        1547
         BAL   @14,OPRNDCHK                                        1547
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE NPRE OPERANDS AGAINST REQ OPERANDS                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1548
*       CALL OPRNDCHK(NPRINDX1,IOPPNPR,REQINDX1,IOPPREQ);          1548
*                                                                  1548
         LA    @01,@AL01548                                        1548
         BAL   @14,OPRNDCHK                                        1548
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE NPRE OPERANDS AGAINST FMID OPERAND                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1549
*       CALL OPRNDCHK(NPRINDX1,IOPPNPR,FIDINDX1,IOPPFID);          1549
*                                                                  1549
         LA    @01,@AL01549                                        1549
         BAL   @14,OPRNDCHK                                        1549
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE NPRE OPERANDS AGAINST DELETE OPERANDS             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1550
*       CALL OPRNDCHK(NPRINDX1,IOPPNPR,DELINDX1,IOPPDEL);          1550
*                                                                  1550
         LA    @01,@AL01550                                        1550
         BAL   @14,OPRNDCHK                                        1550
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE SUP OPERANDS AGAINST REQ OPERANDS                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1551
*       CALL OPRNDCHK(SUPINDX1,IOPPSUPV,REQINDX1,IOPPREQ);         1551
*                                                                  1551
         LA    @01,@AL01551                                        1551
         BAL   @14,OPRNDCHK                                        1551
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE SUP OPERANDS AGAINST FMID OPERAND                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1552
*       CALL OPRNDCHK(SUPINDX1,IOPPSUPV,FIDINDX1,IOPPFID);         1552
*                                                                  1552
         LA    @01,@AL01552                                        1552
         BAL   @14,OPRNDCHK                                        1552
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE SUP OPERANDS AGAINST DELETE OPERANDS              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1553
*       CALL OPRNDCHK(SUPINDX1,IOPPSUPV,DELINDX1,IOPPDEL);         1553
*                                                                  1553
         LA    @01,@AL01553                                        1553
         BAL   @14,OPRNDCHK                                        1553
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE REQ OPERANDS AGAINST FMID OPERAND                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1554
*       CALL OPRNDCHK(REQINDX1,IOPPREQ,FIDINDX1,IOPPFID);          1554
*                                                                  1554
         LA    @01,@AL01554                                        1554
         BAL   @14,OPRNDCHK                                        1554
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE REQ OPERANDS AGAINST DELETE OPERANDS              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1555
*       CALL OPRNDCHK(REQINDX1,IOPPREQ,DELINDX1,IOPPDEL);          1555
*                                                                  1555
         LA    @01,@AL01555                                        1555
         BAL   @14,OPRNDCHK                                        1555
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE FMID OPERAND AGAINST DELETE OPERANDS              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1556
*       CALL OPRNDCHK(FIDINDX1,IOPPFID,DELINDX1,IOPPDEL);          1556
*                                                                  1556
         LA    @01,@AL01556                                        1556
         BAL   @14,OPRNDCHK                                        1556
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE VERSION OPERANDS AGAINST FMID OPERAND             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1557
*       CALL OPRNDCHK(FIDINDX1,IOPPFID,VRSINDX1,IOPPVER);          1557
         LA    @01,@AL01557                                        1557
         BAL   @14,OPRNDCHK                                        1557
*     END;                                                         1558
*                                                                  1559
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ALL SRELS IN MCB AND CHECK THE SRELFMID GTA FILE TO   */
*   /* DETERMINE WHETHER ANOTHER ++VER IN THIS SYSMOD SPECIFIED THE  */
*   /* SAME SREL-FMID PAIR AS THIS ++VER                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1559
*   DO II=1 BY 1 WHILE(MCBVND(II)^=IOPEOLST/* NOT END OF MCB         */
*         &VERCK=YES);              /* VALID ++VER                   */
@RF01484 LA    @15,1                                               1559
         ST    @15,II                                              1559
         B     @DE01559                                            1559
@DL01559 DS    0H                                                  1560
*     RESPECIFY                                                    1560
*       HMASMGTP BASED(RECXGSRP);   /* SRELFMID GTP                  */
*     IF MCBVIND(II)=IOPPSREL THEN                                 1561
         L     @15,RECXMCB                                         1561
         L     @14,II                                              1561
         MH    @14,@CH00034                                        1561
         SLR   @07,@07                                             1561
         IC    @07,MCBVIND-9(@14,@15)                              1561
         CH    @07,@CH01190                                        1561
         BNE   @RF01561                                            1561
*       DO;                                                        1562
*                                                                  1562
*         /***********************************************************/
*         /*                                                         */
*         /* SREL FOUND IN MCB                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1563
*         GSRSREL(1:4)=MCBVNUM(II,1:4);/* PUT SREL IN SRELFMID RECORD*/
         LA    @07,GTASR                                           1563
         ALR   @14,@15                                             1563
         BCTR  @14,0                                               1563
         MVC   GSRSREL(4,@07),MCBVNUM-8(@14)                       1563
*         GSRFMID=MCBSFMID;         /* PUT FMID IN SRELFMID RECORD 1564
*                                      KEY                           */
         MVC   GSRFMID(7,@07),MCBSFMID(@15)                        1564
*         GTPFUNCT=GTPLOC;          /* LOCATE FUNCTION               */
         L     @15,RECXGSRP                                        1565
         MVI   GTPFUNCT(@15),X'03'                                 1565
*         CALL HMASMGTA(HMASMGTP);  /* SEE IF THERE IS A MATCH       */
         ST    @15,@AL00001                                        1566
         L     @15,@CV01706                                        1566
         LA    @01,@AL00001                                        1566
         BALR  @14,@15                                             1566
*         IF GTPRETRN=GTPGOOD THEN                                 1567
         L     @01,RECXGSRP                                        1567
         CLI   GTPRETRN(@01),0                                     1567
         BNE   @RF01567                                            1567
*           DO;                                                    1568
*                                                                  1568
*             /*******************************************************/
*             /*                                                     */
*             /* MATCH FOUND ... MORE THAN ONE VERIFY FOR THE SAME   */
*             /* SREL-FMID PAIR ... ISSUE HMA348I                    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1569
*             VERCK=NO;             /* RESET SWITCH TO STOP        1569
*                                      SUBSEQUENT CHECKS             */
         L     @15,@PC00028                                        1569
         MVI   VERCK(@15),C'N'                                     1569
*             VERCKERR=ON;          /* SET ERROR SWITCH              */
         OI    VERCKERR,B'01000000'                                1570
*             MGPTYPE=MGPERR;       /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1571
*             CALL ERRMSG(HMA348I,NOPART,NOPART);                  1572
         LA    @01,@AL01572                                        1572
         BAL   @14,ERRMSG                                          1572
*           END;                                                   1573
*       END;                                                       1574
@RF01567 DS    0H                                                  1575
*   END;                                                           1575
@RF01561 LA    @15,1                                               1575
         AL    @15,II                                              1575
         ST    @15,II                                              1575
@DE01559 L     @15,II                                              1575
         MH    @15,@CH00034                                        1575
         L     @01,RECXMCB                                         1575
         BCTR  @01,0                                               1575
         SLR   @14,@14                                             1575
         IC    @14,MCBVND-8(@15,@01)                               1575
         CH    @14,@CH00766                                        1575
         BE    @DC01559                                            1575
         L     @15,@PC00028                                        1575
         CLI   VERCK(@15),C'Y'                                     1575
         BE    @DL01559                                            1575
@DC01559 DS    0H                                                  1576
*                                                                  1576
*   /*****************************************************************/
*   /*                                                               */
*   /* PUT THE SREL-FMID PAIRS FROM THIS ++VER INTO THE SRELFMID GTA */
*   /* FILE                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1576
*   IF VERCK=YES                    /* VALID ++VER                   */
*       &VERCKERR=OFF               /* NO ERROR(S) DETECTED          */
*     THEN                                                         1576
         L     @15,@PC00028                                        1576
         CLI   VERCK(@15),C'Y'                                     1576
         BNE   @RF01576                                            1576
         TM    VERCKERR,B'01000000'                                1576
         BNZ   @RF01576                                            1576
*     DO;                                                          1577
*                                                                  1577
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL SRELS IN MCB                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1578
*       DO II=1 BY 1 WHILE MCBVND(II)^=IOPEOLST&RECXMAX<STOPFUNC;  1578
         LA    @15,1                                               1578
         ST    @15,II                                              1578
         B     @DE01578                                            1578
@DL01578 DS    0H                                                  1579
*         IF MCBVIND(II)=IOPPSREL THEN                             1579
         L     @15,RECXMCB                                         1579
         L     @14,II                                              1579
         MH    @14,@CH00034                                        1579
         SLR   @07,@07                                             1579
         IC    @07,MCBVIND-9(@14,@15)                              1579
         CH    @07,@CH01190                                        1579
         BNE   @RF01579                                            1579
*           DO;                                                    1580
*                                                                  1580
*             /*******************************************************/
*             /*                                                     */
*             /* SREL FOUND IN MCB                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1581
*             GSRSREL=MCBVNUM(II,1:4);/* PUT SREL IN SRELFMID RECORD */
         LA    @07,GTASR                                           1581
         ALR   @14,@15                                             1581
         BCTR  @14,0                                               1581
         MVC   GSRSREL(4,@07),MCBVNUM-8(@14)                       1581
*             GSRFMID=MCBSFMID;     /* PUT FMID IN SRELFMID RECORD 1582
*                                      KEY                           */
         MVC   GSRFMID(7,@07),MCBSFMID(@15)                        1582
*             GTPFUNCT=GTPADD;      /* ADD FUNCTION                  */
         L     @15,RECXGSRP                                        1583
         MVI   GTPFUNCT(@15),X'04'                                 1583
*             CALL HMASMGTA(HMASMGTP);/* ADD RECORD TO FILE          */
         ST    @15,@AL00001                                        1584
         L     @15,@CV01706                                        1584
         LA    @01,@AL00001                                        1584
         BALR  @14,@15                                             1584
*             IF GTPRETRN>GTPGOOD THEN                             1585
*                                                                  1585
         L     @15,RECXGSRP                                        1585
         CLI   GTPRETRN(@15),0                                     1585
         BNH   @RF01585                                            1585
*               /*****************************************************/
*               /*                                                   */
*               /* ERROR ADDING TO GTA FILE ... OUT OF STORAGE       */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1586
*               RECXMAX=MAX(RECXMAX,GTPRETRN);                     1586
         L     @14,RECXMAX                                         1586
         SLR   @07,@07                                             1586
         IC    @07,GTPRETRN(,@15)                                  1586
         CR    @14,@07                                             1586
         BNL   *+6
         LR    @14,@07                                             1586
         ST    @14,RECXMAX                                         1586
*           END;                                                   1587
@RF01585 DS    0H                                                  1588
*       END;                                                       1588
@RF01579 LA    @15,1                                               1588
         AL    @15,II                                              1588
         ST    @15,II                                              1588
@DE01578 L     @15,II                                              1588
         MH    @15,@CH00034                                        1588
         L     @01,RECXMCB                                         1588
         BCTR  @01,0                                               1588
         SLR   @14,@14                                             1588
         IC    @14,MCBVND-8(@15,@01)                               1588
         CH    @14,@CH00766                                        1588
         BE    @DC01578                                            1588
         L     @15,RECXMAX                                         1588
         CH    @15,@CH00036                                        1588
         BL    @DL01578                                            1588
@DC01578 DS    0H                                                  1589
*     END;                                                         1589
*                                                                  1590
*   /*****************************************************************/
*   /*                                                               */
*   /* VERCHK PROCESSING COMPLETE ... RETURN TO CALLER               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1590
*   IF VERCKERR=OFF                 /* NO ERRORS DETECTED            */
*     THEN                                                         1590
@RF01576 TM    VERCKERR,B'01000000'                                1590
         BNZ   @RF01590                                            1590
*     VERCK=YES;                    /* SET PARM RETURNED TO CALLER   */
         L     @15,@PC00028                                        1591
         MVI   VERCK(@15),C'Y'                                     1591
*   ELSE                                                           1592
*     DO;                                                          1592
*                                                                  1592
         B     @RC01590                                            1592
@RF01590 DS    0H                                                  1593
*       /*************************************************************/
*       /*                                                           */
*       /* ++VER STATEMENT CONSTRUCTION ERROR ... FLUSH SYSMOD       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1593
*       VERCK=NO;                   /* SET PARM RETURNED TO CALLER   */
         L     @15,@PC00028                                        1593
         MVI   VERCK(@15),C'N'                                     1593
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */
         OI    RECXSYSF,B'00010000'                                1594
*       RECXGSMP->GTPBUFAD->GSMSYNTX=ON;/* SET SYNTAX IN SUMMARY   1595
*                                      RECORD                        */
         L     @01,RECXGSMP                                        1595
         L     @01,GTPBUFAD(,@01)                                  1595
         OI    GSMSYNTX(@01),B'01000000'                           1595
*     END;                                                         1596
*                                                                  1597
*/********************************************************************/
*/*                                                                  */
*/*    OPRNDCHK - ++VER OPERAND CHECK                                */
*/*                                                                  */
*/*               FOR THE CURRENT ++VER, COMPARE ALL OPERANDS OF     */
*/*               THE FIRST KEYWORD TYPE (OPR1TYPE) WITH ALL OPERANDS*/
*/*               OF THE SECOND KEYWORD TYPE (OPR2TYPE)              */
*/*                                                                  */
*/********************************************************************/
*                                                                  1597
*OPRNDCHK:                                                         1597
*   PROC(OPR1INDX,OPR1TYPE,OPR2INDX,OPR2TYPE);                     1597
         B     @PB00029                                            1597
OPRNDCHK STM   @14,@12,@SA00029                                    1597
         MVC   @PC00029(16),0(@01)                                 1597
*   DCL                                                            1598
*     OPR1INDX FIXED(31);           /* INDEX OF FIRST SUB-ENTRY FOR
*                                      OPERAND 1                     */
*   DCL                                                            1599
*     OPR1TYPE CHAR(1);             /* OPERAND 1 TYPE (KEYWORD)      */
*   DCL                                                            1600
*     OPR2INDX FIXED(31);           /* INDEX OF FIRST SUB-ENTRY FOR
*                                      OPERAND 2                     */
*   DCL                                                            1601
*     OPR2TYPE CHAR(1);             /* OPERAND 2 TYPE (KEYWORD)      */
*   DCL                                                            1602
*     LOCAL1X FIXED(31);            /* LOCAL INDEX FOR OPERAND 1   1602
*                                      KEYWORD SUB-ENTRIES           */
*   DCL                                                            1603
*     LOCAL2X FIXED(31);            /* LOCAL INDEX FOR OPERAND 2   1603
*                                      KEYWORD SUB-ENTRIES           */
*   IF OPR1INDX^=0&OPR2INDX^=0 THEN                                1604
         SLR   @15,@15                                             1604
         L     @14,@PC00029                                        1604
         L     @14,OPR1INDX(,@14)                                  1604
         CR    @14,@15                                             1604
         BE    @RF01604                                            1604
         L     @07,@PC00029+8                                      1604
         C     @15,OPR2INDX(,@07)                                  1604
         BE    @RF01604                                            1604
*     DO;                                                          1605
*       LOCAL1X=OPR1INDX;           /* START WITH FIRST KEYWORD 1  1606
*                                      OPERAND                       */
*                                                                  1606
         ST    @14,LOCAL1X                                         1606
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL KEYWORD 1 OPERANDS                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1607
*       DO WHILE LOCAL1X^=0;                                       1607
         B     @DE01607                                            1607
@DL01607 DS    0H                                                  1608
*         LOCAL2X=OPR2INDX;         /* FIRST KEYWORD 2 OPERAND       */
*                                                                  1608
         L     @15,@PC00029+8                                      1608
         MVC   LOCAL2X(4),OPR2INDX(@15)                            1608
*         /***********************************************************/
*         /*                                                         */
*         /* GO THRU ALL KEYWORD 2 OPERANDS                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1609
*         DO WHILE LOCAL2X^=0;                                     1609
         B     @DE01609                                            1609
@DL01609 DS    0H                                                  1610
*           IF MCBVNTRY(LOCAL2X)=MCBVNTRY(LOCAL1X) THEN            1610
         L     @15,RECXMCB                                         1610
         LA    @14,9                                               1610
         L     @01,LOCAL2X                                         1610
         MR    @00,@14                                             1610
         LR    @03,@14                                             1610
         M     @02,LOCAL1X                                         1610
         ST    @01,@TF00001                                        1610
         ALR   @01,@15                                             1610
         BCTR  @01,0                                               1610
         ALR   @03,@15                                             1610
         BCTR  @03,0                                               1610
         CLC   MCBVNTRY-8(8,@01),MCBVNTRY-8(@03)                   1610
         BNE   @RF01610                                            1610
*             DO;                                                  1611
*                                                                  1611
*               /*****************************************************/
*               /*                                                   */
*               /* KWRD 1 OPERAND APPEARS AS AN KWRD 2 OPERAND       */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1612
*               VERCKERR=ON;        /* SET VERCHK2 ERROR FLAG        */
         OI    VERCKERR,B'01000000'                                1612
*               VPARTS=' ';                                        1613
         MVI   VPARTS+1,C' '                                       1613
         MVC   VPARTS+2(22),VPARTS+1                               1613
         MVI   VPARTS,C' '                                         1613
*               VPART#1=MCBVNUM(LOCAL2X);/* OPERAND VALUE            */
         MVI   VPART#1+7,C' '                                      1614
         AL    @15,@TF00001                                        1614
         BCTR  @15,0                                               1614
         MVC   VPART#1(7),MCBVNUM-8(@15)                           1614
*               CALL OPRNDKEY(OPR1TYPE,VPART#2);/* KEYWORD           */
         L     @15,@PC00029+4                                      1615
         ST    @15,@AL00001                                        1615
         LA    @15,VPART#2                                         1615
         ST    @15,@AL00001+4                                      1615
         LA    @01,@AL00001                                        1615
         BAL   @14,OPRNDKEY                                        1615
*               CALL OPRNDKEY(OPR2TYPE,VPART#3);/* KEYWORD           */
         L     @15,@PC00029+12                                     1616
         ST    @15,@AL00001                                        1616
         LA    @15,VPART#3                                         1616
         ST    @15,@AL00001+4                                      1616
         LA    @01,@AL00001                                        1616
         BAL   @14,OPRNDKEY                                        1616
*               MGPTYPE=MGPERR;     /* SET MESSAGE SEVERITY          */
         MVI   MGPTYPE,X'03'                                       1617
*               CALL ERRMSG(HMA363I,PART094,NOPART);/* ISSUE HMA363I */
         LA    @01,@AL01618                                        1618
         BAL   @14,ERRMSG                                          1618
*             END;                                                 1619
*           SUBINDX=LOCAL2X+1;      /* SET UP TO SEARCH FOR NEXT OPR2*/
@RF01610 L     @01,LOCAL2X                                         1620
         LA    @01,1(,@01)                                         1620
         STH   @01,SUBINDX                                         1620
*           CALL NEXTSUB(OPR2TYPE); /* SERACH FOR OPR2 SUB-ENTRY     */
         L     @15,@PC00029+12                                     1621
         ST    @15,@AL00001                                        1621
         LA    @01,@AL00001                                        1621
         BAL   @14,NEXTSUB                                         1621
*           IF SUBEFND=OFF THEN                                    1622
         TM    SUBEFND,B'10000000'                                 1622
         BNZ   @RF01622                                            1622
*             LOCAL2X=0;            /* NO MORE KEYWORD 2 OPERANDS    */
         SLR   @15,@15                                             1623
         ST    @15,LOCAL2X                                         1623
*           ELSE                                                   1624
*             LOCAL2X=SUBINDX;      /* INDEX OF NEXT KWRD 2 OPERAND  */
         B     @RC01622                                            1624
@RF01622 LH    @15,SUBINDX                                         1624
         ST    @15,LOCAL2X                                         1624
*         END;                      /* END LOOP THRU ALL KEYWORD 2 1625
*                                      OPERANDS                      */
@RC01622 DS    0H                                                  1625
@DE01609 L     @15,LOCAL2X                                         1625
         LTR   @15,@15                                             1625
         BNZ   @DL01609                                            1625
*         SUBINDX=LOCAL1X+1;        /* SET UP TO SEARCH FOR NEXT OPR1*/
         L     @01,LOCAL1X                                         1626
         LA    @01,1(,@01)                                         1626
         STH   @01,SUBINDX                                         1626
*         CALL NEXTSUB(OPR1TYPE);   /* SERACH FOR OPR1 SUB-ENTRY     */
         L     @15,@PC00029+4                                      1627
         ST    @15,@AL00001                                        1627
         LA    @01,@AL00001                                        1627
         BAL   @14,NEXTSUB                                         1627
*         IF SUBEFND=OFF THEN                                      1628
         TM    SUBEFND,B'10000000'                                 1628
         BNZ   @RF01628                                            1628
*           LOCAL1X=0;              /* NO MORE KEYWORD 1 OPERANDS  1629
*                                      FOUND                         */
         SLR   @15,@15                                             1629
         ST    @15,LOCAL1X                                         1629
*         ELSE                                                     1630
*           LOCAL1X=SUBINDX;        /* INDEX OF NEXT KWRD 1 OPERAND  */
         B     @RC01628                                            1630
@RF01628 LH    @15,SUBINDX                                         1630
         ST    @15,LOCAL1X                                         1630
*       END;                        /* END LOOP THRU ALL KEYWORD 1 1631
*                                      OPERANDS                      */
@RC01628 DS    0H                                                  1631
@DE01607 L     @15,LOCAL1X                                         1631
         LTR   @15,@15                                             1631
         BNZ   @DL01607                                            1631
*     END;                                                         1632
*   RETURN;                                                        1633
@EL00029 DS    0H                                                  1633
@EF00029 DS    0H                                                  1633
@ER00029 LM    @14,@12,@SA00029                                    1633
         BR    @14                                                 1633
*   END OPRNDCHK;                                                  1634
         B     @EL00029                                            1634
*                                                                  1635
*/********************************************************************/
*/*                                                                  */
*/*    OPRNDSMI - ++VER OPERAND CHECK                                */
*/*                                                                  */
*/*               FOR THE CURRENT ++VER, COMPARE ALL OPERANDS OF     */
*/*               THE FIRST KEYWORD TYPE (OPR1TYP)  WITH THE SYSMOD  */
*/*               ID IN THE SYSMOD ENTRY IOP (RECXIOPP->HMASMIOP).   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1635
*OPRNDSMI:                                                         1635
*   PROC(OPR1INX,OPR1TYP);                                         1635
OPRNDSMI STM   @14,@12,@SA00030                                    1635
         MVC   @PC00030(8),0(@01)                                  1635
*   DCL                                                            1636
*     OPR1INX FIXED(31);            /* INDEX OF FIRST SUB-ENTRY FOR
*                                      OPERAND 1                     */
*   DCL                                                            1637
*     OPR1TYP CHAR(1);              /* OPERAND 1 TYPE (KEYWORD)      */
*   RESPECIFY                                                      1638
*     HMASMIOP BASED(RECXIOPP);     /* ADDRESS SYSMOD ENTRY IOP      */
*   DCL                                                            1639
*     LOC1X FIXED(31);              /* LOCAL INDEX FOR OPERAND 1   1639
*                                      KEYWORD SUB-ENTRIES           */
*   IF OPR1INX^=0 THEN                                             1640
         L     @15,@PC00030                                        1640
         L     @15,OPR1INX(,@15)                                   1640
         LTR   @15,@15                                             1640
         BZ    @RF01640                                            1640
*     DO;                                                          1641
*       LOC1X=OPR1INX;              /* START WITH FIRST KEYWORD 1  1642
*                                      OPERAND                       */
*                                                                  1642
         ST    @15,LOC1X                                           1642
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL KEYWORD 1 OPERANDS                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1643
*       DO WHILE LOC1X^=0;                                         1643
         B     @DE01643                                            1643
@DL01643 DS    0H                                                  1644
*         IF MCBVNUM(LOC1X)=IOPNAM17/* OPERAND IS SAME AS SYSMOD-ID  */
*           THEN                                                   1644
         L     @15,RECXMCB                                         1644
         L     @14,LOC1X                                           1644
         MH    @14,@CH00034                                        1644
         L     @07,RECXIOPP                                        1644
         ST    @14,@TF00001                                        1644
         ALR   @14,@15                                             1644
         BCTR  @14,0                                               1644
         CLC   MCBVNUM-8(7,@14),IOPNAM17(@07)                      1644
         BNE   @RF01644                                            1644
*           DO;                                                    1645
*                                                                  1645
*             /*******************************************************/
*             /*                                                     */
*             /* OPERAND IS SAME AS SYSMOD-ID - ISSUE HMA363         */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1646
*             VERCKERR=ON;          /* VERIFY STATEMENT ERROR        */
         OI    VERCKERR,B'01000000'                                1646
*             VPARTS=' ';                                          1647
         MVI   VPARTS+1,C' '                                       1647
         MVC   VPARTS+2(22),VPARTS+1                               1647
         MVI   VPARTS,C' '                                         1647
*             VPART#1=MCBVNTRY(LOC1X);/* INVALID OPERAND VALUE       */
         AL    @15,@TF00001                                        1648
         BCTR  @15,0                                               1648
         MVC   VPART#1(8),MCBVNTRY-8(@15)                          1648
*             IF IOPPTYPE=IOPPFUNC THEN                            1649
         CLI   IOPPTYPE(@07),4                                     1649
         BNE   @RF01649                                            1649
*               VPART#2=MSGFUNC;    /* ++FUNCTION                    */
         MVC   VPART#2(8),MSGFUNC                                  1650
*             ELSE                                                 1651
*               IF IOPPTYPE=IOPPPTF THEN                           1651
         B     @RC01649                                            1651
@RF01649 L     @01,RECXIOPP                                        1651
         CLI   IOPPTYPE(@01),3                                     1651
         BNE   @RF01651                                            1651
*                 VPART#2=MSGPTF;   /* ++PTF                         */
         MVC   VPART#2(8),MSGPTF                                   1652
*               ELSE                                               1653
*                 IF IOPPTYPE=IOPPAPAR THEN                        1653
         B     @RC01651                                            1653
@RF01651 L     @01,RECXIOPP                                        1653
         CLI   IOPPTYPE(@01),2                                     1653
         BNE   @RF01653                                            1653
*                   VPART#2=MSGAPAR;/* ++APAR                        */
         MVC   VPART#2(8),MSGAPAR                                  1654
*                 ELSE                                             1655
*                   IF IOPPTYPE=IOPPUSER THEN                      1655
         B     @RC01653                                            1655
@RF01653 L     @01,RECXIOPP                                        1655
         CLI   IOPPTYPE(@01),1                                     1655
         BNE   @RF01655                                            1655
*                     VPART#2=MSGUSER;/* ++USERMOD                   */
         MVC   VPART#2(8),MSGUSER                                  1656
*             CALL OPRNDKEY(OPR1TYP,VPART#3);/* KEYWORD              */
@RF01655 DS    0H                                                  1657
@RC01653 DS    0H                                                  1657
@RC01651 DS    0H                                                  1657
@RC01649 L     @15,@PC00030+4                                      1657
         ST    @15,@AL00001                                        1657
         LA    @15,VPART#3                                         1657
         ST    @15,@AL00001+4                                      1657
         LA    @01,@AL00001                                        1657
         BAL   @14,OPRNDKEY                                        1657
*             MGPTYPE=MGPERR;       /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1658
*             CALL ERRMSG(HMA363I,PART094,NOPART);/* ISSUE HMA363I   */
         LA    @01,@AL01659                                        1659
         BAL   @14,ERRMSG                                          1659
*           END;                                                   1660
*         SUBINDX=LOC1X+1;          /* SET UP TO SEARCH FOR NEXT OPR1*/
@RF01644 L     @01,LOC1X                                           1661
         LA    @01,1(,@01)                                         1661
         STH   @01,SUBINDX                                         1661
*         CALL NEXTSUB(OPR1TYP);    /* SERACH FOR OPR1 SUB-ENTRY     */
         L     @15,@PC00030+4                                      1662
         ST    @15,@AL00001                                        1662
         LA    @01,@AL00001                                        1662
         BAL   @14,NEXTSUB                                         1662
*         IF SUBEFND=OFF THEN                                      1663
         TM    SUBEFND,B'10000000'                                 1663
         BNZ   @RF01663                                            1663
*           LOC1X=0;                /* NO MORE KEYWORD 1 OPERANDS  1664
*                                      FOUND                         */
         SLR   @15,@15                                             1664
         ST    @15,LOC1X                                           1664
*         ELSE                                                     1665
*           LOC1X=SUBINDX;          /* INDEX OF NEXT KWRD 1 OPERAND  */
         B     @RC01663                                            1665
@RF01663 LH    @15,SUBINDX                                         1665
         ST    @15,LOC1X                                           1665
*       END;                        /* END LOOP THRU ALL KEYWORD 1 1666
*                                      OPERANDS                      */
@RC01663 DS    0H                                                  1666
@DE01643 L     @15,LOC1X                                           1666
         LTR   @15,@15                                             1666
         BNZ   @DL01643                                            1666
*     END;                                                         1667
*   RETURN;                                                        1668
@EL00030 DS    0H                                                  1668
@EF00030 DS    0H                                                  1668
@ER00030 LM    @14,@12,@SA00030                                    1668
         BR    @14                                                 1668
*   END OPRNDSMI;                                                  1669
         B     @EL00030                                            1669
*                                                                  1670
*/********************************************************************/
*/*                                                                  */
*/*    NEXTSUB - FIND THE NEXT OCCURRENCE OF THE CALLER-SPECIFIED    */
*/*              SUB-ENTRY TYPE IN THE MCB                           */
*/*                                                                  */
*/*            - ON ENTRY:                                           */
*/*                                                                  */
*/*              * SUBINDX IS SET TO THE SUB-ENTRY INDEX FROM WHICH  */
*/*                THE SEARCH IS TO START.                           */
*/*                                                                  */
*/*            - ON EXIT:                                            */
*/*                                                                  */
*/*              * SUBEFND IS SET IF THE SPECIFIED ENTRY-TYPE FOUND. */
*/*                                                                  */
*/*              * SUBINDX IS SET TO THE SUB-ENTRY INDEX FOR THE     */
*/*                ENTRY FOUND (IF ANY).                             */
*/*                                                                  */
*/*              * SUBNTSM# IS SET TO THE VALUE IN THE SUB-ENTRY     */
*/*                FOUND (IF ANY).                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1670
*NEXTSUB:                                                          1670
*   PROC(SUBTYPE);                                                 1670
NEXTSUB  STM   @14,@12,12(@13)                                     1670
         MVC   @PC00031(4),0(@01)                                  1670
*   DCL                                                            1671
*     SUBTYPE CHAR(1);              /* SUB-ENTRY TYPE - SAME VALUES
*                                      AS SPECIFIED FOR IOPPIND      */
*   DCL                                                            1672
*     UU FIXED(15);                 /* LOCAL SUB-ENTRY INDEX         */
*   SUBEFND=OFF;                    /* CLEAR SUB-ENTRY FOUND FLAG    */
         NI    SUBEFND,B'01111111'                                 1673
*   SUBNTSM#=NULLPTF#;              /* CLEAR SYSMOD NAME             */
         MVC   SUBNTSM#(7),@CC01733                                1674
*   UU=SUBINDX;                     /* SUB-ENTRY STARTING INDEX      */
*                                                                  1675
         MVC   UU(2),SUBINDX                                       1675
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THUR ALL MCB SUB-ENTRIES STARTING FROM SUBINDX             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1676
*   DO UU=UU BY 1 WHILE MCBVND(UU)^=IOPEOLST&SUBEFND=OFF;          1676
         B     @DE01676                                            1676
@DL01676 DS    0H                                                  1677
*     IF MCBVIND(UU)=SUBTYPE        /* SUBENTRY TYPE MATCH ?         */
*       THEN                                                       1677
         L     @15,RECXMCB                                         1677
         LH    @14,UU                                              1677
         LR    @07,@14                                             1677
         MH    @07,@CH00034                                        1677
         L     @06,@PC00031                                        1677
         SLR   @05,@05                                             1677
         IC    @05,MCBVIND-9(@07,@15)                              1677
         MVC   @ZT00003+3(1),SUBTYPE(@06)                          1677
         C     @05,@ZT00003                                        1677
         BNE   @RF01677                                            1677
*       DO;                                                        1678
*                                                                  1678
*         /***********************************************************/
*         /*                                                         */
*         /* THE NEXT SUBENTRY OF THE SPECIFIED TYPE FOUND           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1679
*         SUBEFND=ON;               /* SET SUB-ENTRY FOUND FLAG      */
         OI    SUBEFND,B'10000000'                                 1679
*         SUBINDX=UU;               /* SET SUB-ENTRY INDEX           */
         STH   @14,SUBINDX                                         1680
*         SUBNTSM#=MCBVNUM(UU);     /* SET SYSMOD NAME FROM SUB-ENTRY*/
         ALR   @15,@07                                             1681
         BCTR  @15,0                                               1681
         MVC   SUBNTSM#(7),MCBVNUM-8(@15)                          1681
*       END;                                                       1682
*   END;                            /* END OF LOOP THRU MCB        1683
*                                      SUB-ENTRIES                   */
@RF01677 LA    @15,1                                               1683
         AH    @15,UU                                              1683
         STH   @15,UU                                              1683
@DE01676 LH    @15,UU                                              1683
         MH    @15,@CH00034                                        1683
         L     @01,RECXMCB                                         1683
         BCTR  @01,0                                               1683
         SLR   @14,@14                                             1683
         IC    @14,MCBVND-8(@15,@01)                               1683
         CH    @14,@CH00766                                        1683
         BE    @DC01676                                            1683
         TM    SUBEFND,B'10000000'                                 1683
         BZ    @DL01676                                            1683
@DC01676 DS    0H                                                  1684
*   RETURN;                                                        1684
@EL00031 DS    0H                                                  1684
@EF00031 DS    0H                                                  1684
@ER00031 LM    @14,@12,12(@13)                                     1684
         BR    @14                                                 1684
*   END NEXTSUB;                                                   1685
*   END VERCHK;                                                    1686
@EL00028 DS    0H                                                  1686
@EF00028 DS    0H                                                  1686
@ER00028 LM    @14,@12,@SA00028                                    1686
         BR    @14                                                 1686
*                                                                  1687
*/********************************************************************/
*/*                                                                  */
*/*    OPRNDKEY - TRANSLATE IOPPIND VALUES INTO THE EBCDIC CHARACTER */
*/*               STRING WHICH THEY REPRESENT                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  1687
*OPRNDKEY:                                                         1687
*   PROC(PINDCODE,CHARVAL);                                        1687
OPRNDKEY STM   @14,@12,12(@13)                                     1687
         MVC   @PC00032(8),0(@01)                                  1687
*   DCL                                                            1688
*     PINDCODE CHAR(1);             /* IOPPIND VALUE                 */
*   DCL                                                            1689
*     CHARVAL CHAR(8);              /* IOPPIND VALUE - PRINTABLE   1689
*                                      CHARACTER STRING            1689
*                                      REPRESENTATION                */
*   CHARVAL=' ';                    /* BLANK CHAR STRING RETURNED    */
*                                                                  1690
         L     @15,@PC00032+4                                      1690
         MVI   CHARVAL+1(@15),C' '                                 1690
         MVC   CHARVAL+2(6,@15),CHARVAL+1(@15)                     1690
         MVI   CHARVAL(@15),C' '                                   1690
*   /*****************************************************************/
*   /*                                                               */
*   /* ELEMENT IOPPIND VALUES                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1691
*   IF PINDCODE=IOPPMOD             /* ++MOD ?                       */
*     THEN                                                         1691
         L     @14,@PC00032                                        1691
         CLI   PINDCODE(@14),1                                     1691
         BNE   @RF01691                                            1691
*     CHARVAL=MSGMOD;                                              1692
         MVC   CHARVAL(8,@15),MSGMOD                               1692
*   IF PINDCODE=IOPPZAP             /* ++ZAP ?                       */
*     THEN                                                         1693
@RF01691 L     @15,@PC00032                                        1693
         CLI   PINDCODE(@15),2                                     1693
         BNE   @RF01693                                            1693
*     CHARVAL=MSGZAP;                                              1694
         L     @15,@PC00032+4                                      1694
         MVC   CHARVAL(8,@15),MSGZAP                               1694
*   IF PINDCODE=IOPPMACR            /* ++MAC ?                       */
*     THEN                                                         1695
@RF01693 L     @15,@PC00032                                        1695
         CLI   PINDCODE(@15),4                                     1695
         BNE   @RF01695                                            1695
*     CHARVAL=MSGMACR;                                             1696
         L     @15,@PC00032+4                                      1696
         MVC   CHARVAL(8,@15),MSGMACR                              1696
*   IF PINDCODE=IOPPMACU            /* ++MACUPD ?                    */
*     THEN                                                         1697
@RF01695 L     @15,@PC00032                                        1697
         CLI   PINDCODE(@15),5                                     1697
         BNE   @RF01697                                            1697
*     CHARVAL=MSGMACU;                                             1698
         L     @15,@PC00032+4                                      1698
         MVC   CHARVAL(8,@15),MSGMACU                              1698
*   IF PINDCODE=IOPPSRCR            /* ++SRC ?                       */
*     THEN                                                         1699
@RF01697 L     @15,@PC00032                                        1699
         CLI   PINDCODE(@15),6                                     1699
         BNE   @RF01699                                            1699
*     CHARVAL=MSGSRCR;                                             1700
         L     @15,@PC00032+4                                      1700
         MVC   CHARVAL(8,@15),MSGSRCR                              1700
*   IF PINDCODE=IOPPSRCU            /* ++SRCUPD ?                    */
*     THEN                                                         1701
@RF01699 L     @15,@PC00032                                        1701
         CLI   PINDCODE(@15),7                                     1701
         BNE   @RF01701                                            1701
*     CHARVAL=MSGSRCU;                                             1702
*                                                                  1702
         L     @15,@PC00032+4                                      1702
         MVC   CHARVAL(8,@15),MSGSRCU                              1702
*   /*****************************************************************/
*   /*                                                               */
*   /* ++VER STATEMENT IOPPIND VALUES                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1703
*   IF PINDCODE=IOPPPRE             /* PREREQ ?                      */
*     THEN                                                         1703
@RF01701 L     @15,@PC00032                                        1703
         CLI   PINDCODE(@15),162                                   1703
         BNE   @RF01703                                            1703
*     CHARVAL=MSGPRE;                                              1704
         L     @15,@PC00032+4                                      1704
         MVC   CHARVAL(8,@15),MSGPRE                               1704
*   IF PINDCODE=IOPPNPR             /* NPRE ?                        */
*     THEN                                                         1705
@RF01703 L     @15,@PC00032                                        1705
         CLI   PINDCODE(@15),163                                   1705
         BNE   @RF01705                                            1705
*     CHARVAL=MSGNPRE;                                             1706
         L     @15,@PC00032+4                                      1706
         MVC   CHARVAL(8,@15),MSGNPRE                              1706
*   IF PINDCODE=IOPPSUPV            /* SUP ?                         */
*     THEN                                                         1707
@RF01705 L     @15,@PC00032                                        1707
         CLI   PINDCODE(@15),164                                   1707
         BNE   @RF01707                                            1707
*     CHARVAL=MSGSUP;                                              1708
         L     @15,@PC00032+4                                      1708
         MVC   CHARVAL(8,@15),MSGSUP                               1708
*   IF PINDCODE=IOPPREQ             /* REQ ?                         */
*     THEN                                                         1709
@RF01707 L     @15,@PC00032                                        1709
         CLI   PINDCODE(@15),165                                   1709
         BNE   @RF01709                                            1709
*     CHARVAL=MSGREQ;                                              1710
         L     @15,@PC00032+4                                      1710
         MVC   CHARVAL(8,@15),MSGREQ                               1710
*   IF PINDCODE=IOPPFID             /* FMID ?                        */
*     THEN                                                         1711
@RF01709 L     @15,@PC00032                                        1711
         CLI   PINDCODE(@15),167                                   1711
         BNE   @RF01711                                            1711
*     CHARVAL=MSGFMID;                                             1712
         L     @15,@PC00032+4                                      1712
         MVC   CHARVAL(8,@15),MSGFMID                              1712
*   IF PINDCODE=IOPPDEL             /* DELETE ?                      */
*     THEN                                                         1713
@RF01711 L     @15,@PC00032                                        1713
         CLI   PINDCODE(@15),168                                   1713
         BNE   @RF01713                                            1713
*     CHARVAL=MSGDEL;                                              1714
         L     @15,@PC00032+4                                      1714
         MVC   CHARVAL(8,@15),MSGDEL                               1714
*   IF PINDCODE=IOPPVER             /* VERSION?                      */
*     THEN                                                         1715
@RF01713 L     @15,@PC00032                                        1715
         CLI   PINDCODE(@15),169                                   1715
         BNE   @RF01715                                            1715
*     CHARVAL=MSGVERS;                                             1716
         L     @15,@PC00032+4                                      1716
         MVC   CHARVAL(8,@15),MSGVERS                              1716
*   RETURN;                                                        1717
@EL00032 DS    0H                                                  1717
@EF00032 DS    0H                                                  1717
@ER00032 LM    @14,@12,12(@13)                                     1717
         BR    @14                                                 1717
*   END OPRNDKEY;                                                  1718
         B     @EL00032                                            1718
*                                                                  1719
*/********************************************************************/
*/*                                                                  */
*/*    ADDNFND - ADD A RECORD TO GTA SUMMARY FILE FOR SELECTED       */
*/*    SYSMODS WHICH WERE NOT FOUND ON SMPPTFIN                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  1719
*ADDNFND:                                                          1719
*   PROC(NFNDSMD#);                                                1719
ADDNFND  STM   @14,@12,@SA00033                                    1719
         MVC   @PC00033(4),0(@01)                                  1719
*   DCL                                                            1720
*     NFNDSMD# CHAR(7);             /* SYSMOD-ID                     */
*   RESPECIFY                                                      1721
*     HMASMGTP BASED(RECXGSMP);     /* ADDRESS SUMMARY GTP           */
*   GSMREC=''B;                     /* CLEAR RECORD                  */
         LA    @15,GTASM                                           1722
         XC    GSMREC(18,@15),GSMREC(@15)                          1722
*   GSMFMID=NULLPTF#;               /* BLANK FMID FIELD              */
         MVC   GSMFMID(7,@15),@CC01733                             1723
*   GSMS#=NFNDSMD#;                 /* FILL IN SYSMOD-ID PASSED      */
         L     @14,@PC00033                                        1724
         MVC   GSMS#(7,@15),NFNDSMD#(@14)                          1724
*   GSMNFND=ON;                     /* SET "NOT FOUND" INDICATOR     */
         OI    GSMNFND(@15),B'00100000'                            1725
*   GSMSEL=ON;                      /* SET "SELECTED" INDICATOR      */
         OI    GSMSEL(@15),B'00010000'                             1726
*   GSMSTY=MCBERRTP;                /* SYSMOD TYPE IS UN-KNOWN       */
         MVI   GSMSTY(@15),X'FF'                                   1727
*   GTPFUNCT=GTPADD;                /* ADD TO GTA FILE FUNCTION      */
         L     @15,RECXGSMP                                        1728
         MVI   GTPFUNCT(@15),X'04'                                 1728
*   CALL HMASMGTA(HMASMGTP);        /* ADD RECORD                    */
         ST    @15,@AL00001                                        1729
         L     @15,@CV01706                                        1729
         LA    @01,@AL00001                                        1729
         BALR  @14,@15                                             1729
*   RECXMAX=MAX(RECXMAX,GTPRETRN);  /* MAINTAIN RETURN CODE          */
         L     @15,RECXMAX                                         1730
         L     @14,RECXGSMP                                        1730
         SLR   @07,@07                                             1730
         IC    @07,GTPRETRN(,@14)                                  1730
         CR    @15,@07                                             1730
         BNL   *+6
         LR    @15,@07                                             1730
         ST    @15,RECXMAX                                         1730
*   RETURN;                                                        1731
@EL00033 DS    0H                                                  1731
@EF00033 DS    0H                                                  1731
@ER00033 LM    @14,@12,@SA00033                                    1731
         BR    @14                                                 1731
*   END ADDNFND;                                                   1732
*                                                                  1733
*/********************************************************************/
*/*                                                                  */
*/*    SKIP  - SKIP "N" LINES ON SMPOUT TO DELIMIT ONE SYSMOD FROM   */
*/*            ANOTHER AND ONE MODIFICTION CONTROL STATEMENT FROM    */
*/*            ANOTHER.                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  1733
*SKIP:                                                             1733
*   PROC(SKPN);                                                    1733
SKIP     STM   @14,@12,@SA00034                                    1733
         MVC   @PC00034(4),0(@01)                                  1733
*   DCL                                                            1734
*     SKPN FIXED(31);               /* NUMBER OF LINES TO SKIP       */
*   DCL                                                            1735
*     XPRL CHAR(LENGTH(HMASMPRL));  /* AREA FOR PRL (HMASMPRL)       */
*   RESPECIFY                                                      1736
*     HMASMIOP BASED(RECXIOPG);     /* IOP FOR SMPPRINT              */
*   IOPFUNCT=IOPWRITE;              /* FUNCTION IS WRITE             */
         L     @15,RECXIOPG                                        1737
         MVI   IOPFUNCT(@15),X'51'                                 1737
*   IOPDSID=IOPPRINT;               /* DATASET IS SMPOUT             */
         MVI   IOPDSID(@15),X'0B'                                  1738
*   IOPBUFAD=ADDR(XPRL);            /* BUFFER TO WRITE IS A PRL    1739
*                                      (HMASMPRL)                    */
         LA    @14,XPRL                                            1739
         ST    @14,IOPBUFAD(,@15)                                  1739
*   PRLFLGS=''B;                    /* CLEAR FLAGS                   */
         MVI   PRLFLGS(@14),X'00'                                  1740
*   PRLBLANK=ON;                    /* BLANK LINE PRINT              */
         OI    PRLBLANK(@14),B'00100000'                           1741
*   IOPRETRN=IOPGOOD;                                              1742
         MVI   IOPRETRN(@15),X'00'                                 1742
*   DO II=1 TO SKPN WHILE IOPRETRN=IOPGOOD;                        1743
         LA    @15,1                                               1743
         B     @DE01743                                            1743
@DL01743 L     @15,RECXIOPG                                        1743
         CLI   IOPRETRN(@15),0                                     1743
         BNE   @DC01743                                            1743
*     CALL HMASMIO(HMASMIOP);                                      1744
         ST    @15,@AL00001                                        1744
         L     @15,@CV01703                                        1744
         LA    @01,@AL00001                                        1744
         BALR  @14,@15                                             1744
*   END;                                                           1745
         LA    @15,1                                               1745
         AL    @15,II                                              1745
@DE01743 ST    @15,II                                              1745
         L     @14,@PC00034                                        1745
         C     @15,SKPN(,@14)                                      1745
         BNH   @DL01743                                            1745
@DC01743 DS    0H                                                  1746
*   RECXMAX=MAX(RECXMAX,IOPRETRN);  /* IN CASE ANYTHING WENT WRONG   */
         L     @15,RECXMAX                                         1746
         L     @14,RECXIOPG                                        1746
         SLR   @07,@07                                             1746
         IC    @07,IOPRETRN(,@14)                                  1746
         CR    @15,@07                                             1746
         BNL   *+6
         LR    @15,@07                                             1746
         ST    @15,RECXMAX                                         1746
*   RETURN;                                                        1747
@EL00034 DS    0H                                                  1747
@EF00034 DS    0H                                                  1747
@ER00034 LM    @14,@12,@SA00034                                    1747
         BR    @14                                                 1747
*   END SKIP;                                                      1748
*   END HMASMREC                                                   1749
*                                                                  1749
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */
*/*%INCLUDE SYSLIB  (HMASMUXP)                                       */
*                                                                  1749
*       ;                                                          1749
@DATA    DS    0H
@CH00298 DC    H'0'
@CH00232 DC    H'2'
@CH00092 DC    H'4'
@CH00088 DC    H'7'
@CH00034 DC    H'9'
@CH00035 DC    H'10'
@CH00593 DC    H'18'
@CH00608 DC    H'26'
@CH01785 DC    H'47'
@CH01787 DC    H'49'
@CH00949 DC    H'60'
@CH00431 DC    H'72'
@CH00372 DC    H'74'
@CH00429 DC    H'80'
@CH01791 DC    H'93'
@CH01813 DC    H'94'
@CH01815 DC    H'95'
@CH01817 DC    H'96'
@CH01819 DC    H'97'
@CH01821 DC    H'98'
@CH01793 DC    H'128'
@CH01795 DC    H'146'
@CH01797 DC    H'147'
@CH01799 DC    H'148'
@CH01801 DC    H'149'
@CH01803 DC    H'150'
@CH01805 DC    H'151'
@CH01190 DC    H'161'
@CH01192 DC    H'162'
@CH01194 DC    H'163'
@CH01196 DC    H'164'
@CH01198 DC    H'165'
@CH01202 DC    H'167'
@CH01204 DC    H'168'
@CH01206 DC    H'169'
@CH01208 DC    H'170'
@CH01810 DC    H'179'
@CH00766 DC    H'255'
@SM02176 MVC   CHNGMEM(0),SCPSTRNG(@06)
         DS    0F
@AL00336 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00356 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00380 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00596 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00602 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00608 DC    A(HMASMSPL)             LIST WITH   1 ARGUMENT(S)
@AL00435 DC    A(@CH01785+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL00502 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00541 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01196 DC    A(@CF00041)             LIST WITH   1 ARGUMENT(S)
@AL00506 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00507 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00543 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00544 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00561 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00591 DC    A(RECXPARM)             LIST WITH   1 ARGUMENT(S)
@AL00546 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00681 DC    A(@CF00043)             LIST WITH   1 ARGUMENT(S)
@AL00577 DC    A(SESMDNO)              LIST WITH   1 ARGUMENT(S)
@AL00580 DC    A(@CH01208+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL00589 DC    A(@CH01787+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL00682 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00727 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00983 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01216 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01234 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01244 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01255 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01263 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01272 DC    A(@CC01730)             LIST WITH   1 ARGUMENT(S)
@AL00699 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00747 DC    A(MPPPARM)              LIST WITH   1 ARGUMENT(S)
@AL00723 DC    A(@CH00372+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL00731 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00784 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01079 DC    A(@CH01795+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL00823 DC    A(VEROK)                LIST WITH   1 ARGUMENT(S)
@AL00834 DC    A(@CH01803+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL00842 DC    A(@CH01196+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH01815+1)
         DC    A(@CH00298+1)
@AL00849 DC    A(@CH01196+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH01817+1)
         DC    A(@CH00298+1)
@AL00961 DC    A(@CH01810+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL00974 DC    A(@CC01724)             LIST WITH   1 ARGUMENT(S)
@AL00986 DC    A(@CH01799+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL00987 DC    A(@CH01793+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL01030 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01073 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01201 DC    A(HMASMCRP)             LIST WITH   1 ARGUMENT(S)
@AL01151 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
@AL01218 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01236 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01265 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01274 DC    A(@CH01194+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL01225 DC    A(ANSWER)               LIST WITH   1 ARGUMENT(S)
@AL01246 DC    A(@CH01791+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL01257 DC    A(@CH01797+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL01350 DC    A(@CH01805+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL01474 DC    A(@CH01196+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH01819+1)
         DC    A(@CH00298+1)
@AL01527 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01534 DC    A(@CH01196+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH01821+1)
         DC    A(@CH00298+1)
@AL01542 DC    A(PREINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01192+1)
@AL01549 DC    A(NPRINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01194+1)
@AL01556 DC    A(FIDINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01202+1)
         DC    A(DELINDX1)
         DC    A(@CH01204+1)
@AL01543 DC    A(PREINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01192+1)
         DC    A(SUPINDX1)
         DC    A(@CH01196+1)
@AL01544 DC    A(PREINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01192+1)
         DC    A(REQINDX1)
         DC    A(@CH01198+1)
@AL01545 DC    A(PREINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01192+1)
         DC    A(FIDINDX1)
         DC    A(@CH01202+1)
@AL01546 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01537 DC    A(PREINDX1)             LIST WITH   2 ARGUMENT(S)
@AL01494 DC    A(@CH01192+1)           LIST WITH   1 ARGUMENT(S)
         DC    A(DELINDX1)
         DC    A(@CH01204+1)
@AL01547 DC    A(NPRINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01194+1)
         DC    A(SUPINDX1)
         DC    A(@CH01196+1)
@AL01548 DC    A(NPRINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01194+1)
         DC    A(REQINDX1)
         DC    A(@CH01198+1)
@AL01550 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01538 DC    A(NPRINDX1)             LIST WITH   2 ARGUMENT(S)
@AL01498 DC    A(@CH01194+1)           LIST WITH   1 ARGUMENT(S)
         DC    A(DELINDX1)
         DC    A(@CH01204+1)
@AL01551 DC    A(SUPINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01196+1)
         DC    A(REQINDX1)
         DC    A(@CH01198+1)
@AL01552 DC    A(SUPINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01196+1)
         DC    A(FIDINDX1)
         DC    A(@CH01202+1)
@AL01553 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01541 DC    A(SUPINDX1)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CH01196+1)
         DC    A(DELINDX1)
         DC    A(@CH01204+1)
@AL01554 DC    A(REQINDX1)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH01198+1)
         DC    A(FIDINDX1)
         DC    A(@CH01202+1)
@AL01555 DC    A(REQINDX1)             LIST WITH   4 ARGUMENT(S)
@AL01506 DC    A(@CH01198+1)           LIST WITH   1 ARGUMENT(S)
@AL01540 DC    A(DELINDX1)             LIST WITH   2 ARGUMENT(S)
@AL01513 DC    A(@CH01204+1)           LIST WITH   1 ARGUMENT(S)
@AL01557 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01539 DC    A(FIDINDX1)             LIST WITH   2 ARGUMENT(S)
@AL01510 DC    A(@CH01202+1)           LIST WITH   1 ARGUMENT(S)
         DC    A(VRSINDX1)
@AL01517 DC    A(@CH01206+1)           LIST WITH   1 ARGUMENT(S)
@AL01572 DC    A(@CH01801+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(@CH00298+1)
         DC    A(@CH00298+1)
@AL01618 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01659 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01502 DC    A(@CH01196+1)           LIST WITH   1 ARGUMENT(S)
         DC    A(@CH01813+1)
         DC    A(@CH00298+1)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00012 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00009 DS    15F
@SA00018 DS    15F
@PC00018 DS    1F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00028 DS    15F
@PC00028 DS    1F
@SA00025 DS    15F
@PC00032 DS    2F
@SA00019 DS    15F
@SA00020 DS    15F
@PC00020 DS    1F
@PC00031 DS    1F
@SA00030 DS    15F
@PC00030 DS    2F
@SA00029 DS    15F
@PC00029 DS    4F
@SA00027 DS    0F
@SA00010 DS    0F
@PC00010 EQU   @SA00010+60
@SA00026 DS    0F
@SA00033 DS    0F
@PC00033 EQU   @SA00033+60
@SA00002 DS    0F
@SA00034 DS    0F
@PC00034 EQU   @SA00034+60
@SA00011 DS    0F
@SA00016 DS    0F
@PC00016 EQU   @SA00016+60
         DS    18F
@AL00001 DS    2A
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
         DS    0F
@CF00041 DC    F'1'
@CH00041 EQU   @CF00041+2
@CF00043 DC    F'3'
@CH00043 EQU   @CF00043+2
@CF00033 DC    F'8'
@CH00033 EQU   @CF00033+2
@CF00036 DC    F'12'
@CH00036 EQU   @CF00036+2
@CV01703 DC    V(HMASMIO)
@CV01704 DC    V(HMASMMSG)
@CV01705 DC    V(HMASMSCN)
@CV01706 DC    V(HMASMGTA)
@CV01707 DC    V(HMASMMPD)
@CV01708 DC    V(HMASMCRD)
@CV01709 DC    V(HMASMSUB)
@CV01710 DC    V(HMASMRCC)
@CV01711 DC    V(HMASMRCF)
@CV01712 DC    V(HMASMRCL)
@CV01713 DC    V(HMASMRCD)
         DS    0D
IOPPTR   DS    A
SCPPTR   DS    A
MPDRETRN DS    F
READRTN  DS    F
SAVBUFAD DS    A
I        DS    F
II       DS    F
JJ       DS    F
FIX31    DS    F
PREINDX1 DS    F
NPRINDX1 DS    F
SUPINDX1 DS    F
REQINDX1 DS    F
FIDINDX1 DS    F
DELINDX1 DS    F
VRSINDX1 DS    F
LOCAL1X  DS    F
LOCAL2X  DS    F
LOC1X    DS    F
MM       DS    H
NN       DS    H
UU       DS    H
@CC01742 DC    C'00000000'
@CC02018 DC    C'        '
@CC01733 EQU   @CC02018
@CC01735 DC    C'   ?   '
@CC01964 DC    C'++'
@CC02002 DC    C'./'
@CC01724 DC    C'N'
@CC01730 DC    C'C'
         DS    CL1
HMASMCRP DS    CL106
         ORG   HMASMCRP
CRPUXNUM DS    FL1
@NM00050 DS    CL3
CRPSCPAD DS    AL4
CRPINDS  DS    FL1
CRPOUTDS DS    FL1
CRPRETRN DS    FL1
@NM00051 DS    CL3
CRPFLG1  DS    BL2
         ORG   CRPFLG1
CRPBFPRM DS    BL1
CRPLOGCK EQU   CRPFLG1+0
CRPPTS   EQU   CRPFLG1+0
CRPLOG   EQU   CRPFLG1+0
CRPPRINT EQU   CRPFLG1+0
CRPOTHER EQU   CRPFLG1+0
CRPOFFST EQU   CRPFLG1+0
CRPSCNCL EQU   CRPFLG1+0
CRPEOFEN DS    BL1
CRPTRMEX EQU   CRPFLG1+1
CRPNOWPP EQU   CRPFLG1+1
CRPLIST  EQU   CRPFLG1+1
CRPRPT   EQU   CRPFLG1+1
@NM00052 EQU   CRPFLG1+1
         ORG   HMASMCRP+16
CRPFLG2  DS    BL2
         ORG   CRPFLG2
CRPINSW0 DS    BL1
         ORG   CRPINSW0
CRPEOFSW DS    BL1
         ORG   CRPFLG2+0
CRPINSW1 EQU   CRPFLG2+0
         ORG   CRPINSW1
CRPEXADD EQU   CRPINSW1+0
         ORG   CRPFLG2+0
CRPINSW2 EQU   CRPFLG2+0
         ORG   CRPINSW2
CRPWRTLG EQU   CRPINSW2+0
         ORG   CRPFLG2+0
CRPINSW3 EQU   CRPFLG2+0
         ORG   CRPINSW3
CRPEOF1  EQU   CRPINSW3+0
         ORG   CRPFLG2+0
CRPINSW4 EQU   CRPFLG2+0
CRPINSW5 EQU   CRPFLG2+0
CRPINSW6 EQU   CRPFLG2+0
CRPINSW7 EQU   CRPFLG2+0
         DS    CL1
CRPINSW8 DS    BL1
CRPINSW9 EQU   CRPFLG2+1
CRPINSWA EQU   CRPFLG2+1
CRPINSWB EQU   CRPFLG2+1
CRPINSWC EQU   CRPFLG2+1
CRPINSWD EQU   CRPFLG2+1
CRPINSWE EQU   CRPFLG2+1
CRPINSWF EQU   CRPFLG2+1
         ORG   HMASMCRP+18
CRPBUFFR DS    CL80
         ORG   CRPBUFFR
CRPBFCTL DS    CL72
         ORG   CRPBFCTL
CRPBFDTA DS    CL71
CRPBFCNT DS    CL1
         ORG   CRPBUFFR+72
CRPBFSEQ DS    CL8
         ORG   HMASMCRP+98
CRPDDNAM DS    CL8
         ORG   HMASMCRP+106
         DS    CL2
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00195 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00196 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
MPPPARM  DS    CL23
         ORG   MPPPARM
MPPIOPAD DS    AL4
MPPMCBAD DS    AL4
MPPCRDAD DS    AL4
MPPCRDPM DS    AL4
MPPSMDNM DS    CL7
         ORG   MPPPARM+23
         DS    CL1
RECXPARM DS    CL80
         ORG   RECXPARM
@NM00199 DS    CL8
RECXFLGS DS    CL4
         ORG   RECXFLGS
RECXFLG1 DS    BL1
         ORG   RECXFLG1
RECXPROC DS    BL1
RECXSYSM EQU   RECXFLG1+0
RECXPEOF EQU   RECXFLG1+0
RECXSYSF EQU   RECXFLG1+0
RECXSYSS EQU   RECXFLG1+0
RECXSEL  EQU   RECXFLG1+0
RECXEXC  EQU   RECXFLG1+0
@NM00200 EQU   RECXFLG1+0
         ORG   RECXFLGS+1
RECXFLG2 DS    BL1
         ORG   RECXFLG2
RECXVERF DS    BL1
RECXAVER EQU   RECXFLG2+0
RECXJCLF EQU   RECXFLG2+0
RECXELEF EQU   RECXFLG2+0
@NM00201 EQU   RECXFLG2+0
         ORG   RECXFLGS+2
RECXFLG3 DS    BL1
         ORG   RECXFLG3
RECXPVER DS    BL1
RECXPIFS EQU   RECXFLG3+0
RECXPTXT EQU   RECXFLG3+0
RECXTXTF EQU   RECXFLG3+0
RECXPUPD EQU   RECXFLG3+0
RECXPELM EQU   RECXFLG3+0
@NM00202 EQU   RECXFLG3+0
         ORG   RECXFLGS+3
RECXFLG4 DS    BL1
         ORG   RECXFLG4
@NM00203 DS    BL1
         ORG   RECXPARM+12
RECXIOPS DS    CL12
         ORG   RECXIOPS
RECXIOPT DS    AL4
RECXIOPP DS    AL4
RECXIOPG DS    AL4
         ORG   RECXPARM+24
RECXLAST DS    FL4
RECXMAX  DS    FL4
RECXMCB  DS    AL4
RECXPPTR DS    AL4
RECXGSMP DS    AL4
RECXGSRP DS    AL4
RECXGRFP DS    AL4
RECXGPSP DS    AL4
RECXMNDX DS    FL4
RECXCNT  DS    FL2
RECXSCNT DS    FL2
RECXSEQ# DS    FL2
RECXRFLE DS    FL2
RECXRNXT DS    FL2
RECXRCUR DS    FL2
RECXRELM DS    FL2
RECXDSPC DS    CL6
         ORG   RECXPARM+80
HMASMSET DS    CL12
         ORG   HMASMSET
SELSTENT DS    CL10
         ORG   SELSTENT
SELSTFLG DS    BL2
         ORG   SELSTFLG
@NM00208 DS    BL1
SEMCS    EQU   SELSTFLG+0
SESMD    EQU   SELSTFLG+0
SESRC    DS    BL1
SEDLB    EQU   SELSTFLG+1
SEMOD    EQU   SELSTFLG+1
SEMAC    EQU   SELSTFLG+1
SELMD    EQU   SELSTFLG+1
SEASM    EQU   SELSTFLG+1
SEFMD    EQU   SELSTFLG+1
SESYS    EQU   SELSTFLG+1
         ORG   SELSTENT+2
SENAME   DS    CL8
         ORG   SENAME
SESMDNO  DS    CL7
         ORG   SESMDNO
SEPTFNO  DS    CL7
         ORG   SENAME+7
@NM00209 DS    CL1
         ORG   HMASMSET+10
SEFLAGS  DS    BL1
         ORG   SEFLAGS
SEGROUP  DS    BL1
SESELECT EQU   SEFLAGS+0
SEEXCLUD EQU   SEFLAGS+0
SENOJCL  EQU   SEFLAGS+0
SEFMID   EQU   SEFLAGS+0
@NM00210 EQU   SEFLAGS+0
SEFOUND  EQU   SEFLAGS+0
         ORG   HMASMSET+11
SEFLAG2  DS    BL1
         ORG   SEFLAG2
SEFLAG2A DS    BL1
SEFLAG2B EQU   SEFLAG2+0
SEFLAG2C EQU   SEFLAG2+0
SEFLAG2D EQU   SEFLAG2+0
SEFLAG2E EQU   SEFLAG2+0
SEFLAG2F EQU   SEFLAG2+0
SEFLAG2G EQU   SEFLAG2+0
SEFLAG2H EQU   SEFLAG2+0
         ORG   HMASMSET+12
HMASMSPL DS    CL5
         ORG   HMASMSPL
SPLPMAD  DS    AL4
SPLFUNCT DS    FL1
         ORG   HMASMSPL+5
RECLFLGS DS    BL1
         ORG   RECLFLGS
UPDCHG   DS    BL1
UPDEND   EQU   RECLFLGS+0
REL4VER  EQU   RECLFLGS+0
PTFINOPN EQU   RECLFLGS+0
DUP347   EQU   RECLFLGS+0
DUP362   EQU   RECLFLGS+0
MCSCHECK EQU   RECLFLGS+0
@NM00214 EQU   RECLFLGS+0
         ORG   RECLFLGS+1
RECDSPFX DS    CL26
VERFMID  DS    CL7
CHKSMDID DS    CL7
CHNGMEM  DS    CL8
ANSWER   DS    CL1
CHKTYPE  DS    CL1
CHKSMD#  DS    CL1
CHKKEY   DS    CL1
RADJ     DS    CL8
         DS    CL2
PKDEC    DS    CL8
MSGSMDNM DS    CL7
VPARTS   DS    CL24
         ORG   VPARTS
VPART#1  DS    CL8
VPART#2  DS    CL8
VPART#3  DS    CL8
         ORG   VPARTS+24
         DS    CL1
SCPSTORE DS    CL26
         DS    CL2
GTPSM    DS    CL28
GTASM    DS    CL18
         DS    CL2
GTPSR    DS    CL28
GTASR    DS    CL11
         DS    CL1
GTPRF    DS    CL28
GTARF    DS    CL26
         DS    CL2
GTPPS    DS    CL28
GTAPS    DS    CL8
MSGSYS   DC    CL8'SYSTEM  '
MSGENT   DC    CL8'ENTRY   '
MSGPTS   DC    CL8'SMPPTS  '
MSGREC   DC    CL7'RECEIVE'
MSGMOD   DC    CL8'MOD     '
MSGZAP   DC    CL8'ZAP     '
MSGMACR  DC    CL8'MAC     '
MSGMACU  DC    CL8'MACUPD  '
MSGSRCR  DC    CL8'SRC     '
MSGSRCU  DC    CL8'SRCUPD  '
MSGDEL   DC    CL8'DELETE  '
MSGNPRE  DC    CL8'NPRE    '
MSGPRE   DC    CL8'PRE     '
MSGSUP   DC    CL8'SUP     '
MSGREQ   DC    CL8'REQ     '
MSGFMID  DC    CL8'FMID    '
MSGVERS  DC    CL8'VERSION '
MSGAPAR  DC    CL8'APAR    '
MSGPTF   DC    CL8'PTF     '
MSGFUNC  DC    CL8'FUNCTION'
MSGUSER  DC    CL8'USERMOD '
         DS    CL1
PATCHREC DS    CL80
         ORG   PATCHREC
@NM00215 DC    80X'FF'
         ORG   PATCHREC+80
VEROK    DS    CL1
VERFLGS  DS    BL1
         ORG   VERFLGS
SRELCHK  DS    BL1
FMIDCHK  EQU   VERFLGS+0
@NM00216 EQU   VERFLGS+0
         ORG   VERFLGS+1
LASTUPD# DS    CL8
GSMBKUP  DS    CL18
VERCHKF  DS    BL1
         ORG   VERCHKF
VALIDVER DS    BL1
VERCKERR EQU   VERCHKF+0
@NM00218 EQU   VERCHKF+0
         ORG   VERCHKF+1
         DS    CL3
NXTSUBCB DS    CL10
         ORG   NXTSUBCB
SUBINDX  DS    FL2
SUBFLGS  DS    BL1
         ORG   SUBFLGS
SUBEFND  DS    BL1
@NM00219 EQU   SUBFLGS+0
         ORG   NXTSUBCB+3
SUBNTSM# DS    CL7
         ORG   NXTSUBCB+10
XPRL     DS    CL10
INVELMN  DS    3AL1
HMASMREC CSECT
SYSMSCAN DSCAN KEY='++',SUCC=PTFKEY,BLANKS=ON
PTFKEY   DSCAN KEY='PTF',ALT=FUNCTKEY,ROUT=SMHDTYPE,SUCC=IDLPAR
FUNCTKEY DSCAN KEY='FUNCTION',ALT=APARKEY,ROUT=SMHDTYPE,SUCC=IDLPAR
APARKEY  DSCAN KEY='APAR',ALT=USERKEY,ROUT=SMHDTYPE,SUCC=IDLPAR
USERKEY  DSCAN KEY='USERMOD',ALT=NOTSMHDR,ROUT=SMHDTYPE,SUCC=IDLPAR
NOTSMHDR DSCAN ROUT=SMCTTYPE
*
IDLPAR   DSCAN KEY='(',SUCC=IDVAL1
IDVAL1   DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,ROUT=SM#VALUE
HMASMREC CSECT
UPDDSCAN DSCAN KEY='./ ',SUCC=UPDDS2,ALT=UPDDS1,BLANKS=ON,IO=NO
UPDDS1   DSCAN KEY='./',SUCC=UPDDS1A,BLANKS=ON,IO=NO
UPDDS1A  DSCAN MAXLEN=8,SUCC=UPDDS2,IO=NO
UPDDS2   DSCAN KEY='CHANGE',ALT=UPDDS3,ROUT=UPDDCHNG,SUCC=UPDDN1,IO=NO
UPDDN1   DSCAN KEY='NAME=',SUCC=UPDDN2,ALT=UPDDSKP,IO=NO
UPDDN2   DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,ROUT=UPDDNAME,IO=NO
UPDDS3   DSCAN KEY='ENDUP',ROUT=UPDDENDU,IO=NO
UPDDSKP  DSCAN MINLEN=0,SUCC=UPDDN1,ROUT=UPDDSKIP,COMMA=NO,IO=NO
HMASMREC CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
REG1     EQU   @01
REG14    EQU   @14
REG15    EQU   @15
RTNCODE  EQU   @15
RTNREG   EQU   @14
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCARVAD  EQU   CCAFSTA
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
CCASETAD EQU   CCASEGTP
@NM00016 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFMID  EQU   HMASMCCA+291
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00032 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00034 EQU   CCABLDLL
CCALKDRC EQU   @NM00034+20
@NM00036 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00036+20
@NM00038 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00038+20
@NM00040 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00040+20
@NM00042 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00042+20
@NM00044 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00044+20
@NM00046 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00046+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPRCDLN EQU   HMASMGTP+4
GTPKEYLN EQU   HMASMGTP+6
GTPWKAD  EQU   HMASMGTP+8
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00056 EQU   HMASMIOP+12
@NM00057 EQU   @NM00056
IOPSEQNO EQU   @NM00056+8
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00167 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
MCBPTFMP EQU   0
MCBTYPE  EQU   MCBPTFMP
MCBPNO   EQU   MCBPTFMP+1
MCBPRELN EQU   MCBPTFMP+8
MCBPTP   EQU   MCBPTFMP+10
MCBVERMP EQU   0
MCBSFMID EQU   MCBVERMP+1
MCBVEND  EQU   MCBVERMP+8
MCBIFMP  EQU   0
MCBIFENV EQU   MCBIFMP+1
MCBIEND  EQU   MCBIFMP+8
MCBELEMP EQU   0
MCBENAME EQU   MCBELEMP+1
MCBETXLB EQU   MCBELEMP+33
MCBELKLB EQU   MCBELEMP+41
MCBEDALS EQU   MCBELEMP+57
MCBERLF  EQU   MCBELEMP+73
MCBELEPM EQU   MCBELEMP+136
MCBEFLG1 EQU   MCBELEPM
MCBEFLG2 EQU   MCBELEPM+1
MCBEFLG3 EQU   MCBELEPM+2
MCBEFLG4 EQU   MCBELEPM+3
MCBEFLG5 EQU   MCBELEMP+140
MCBEDEL  EQU   MCBEFLG5
MCBEEND  EQU   MCBELEMP+141
HMASMPRL EQU   0
PRLSPAN  EQU   HMASMPRL+2
PRLFLGS  EQU   PRLSPAN
PRLBLANK EQU   PRLFLGS
PRLDATE  EQU   HMASMPRL+4
PRLTIME  EQU   HMASMPRL+7
PRLEND   EQU   HMASMPRL+10
GSMREC   EQU   0
GSMKEY   EQU   GSMREC
GSMS#    EQU   GSMKEY
GSMSTY   EQU   GSMKEY+7
GSMFMID  EQU   GSMREC+8
GSMSTAT1 EQU   GSMREC+15
GSMUSR   EQU   GSMSTAT1
GSMSYNTX EQU   GSMSTAT1
GSMRCVD  EQU   GSMSTAT1
GSMEXCL  EQU   GSMSTAT1
GSMNAVER EQU   GSMSTAT1
GSMSIOE  EQU   GSMSTAT1
GSMRDUP  EQU   GSMSTAT1
GSMNFND  EQU   GSMSTAT1+1
GSMHPRT  EQU   GSMSTAT1+1
GSMSTAT2 EQU   GSMREC+17
GSMRLFP  EQU   GSMSTAT2
GSMSEL   EQU   GSMSTAT2
GSRREC   EQU   0
GSRKEY   EQU   GSRREC
GSRSREL  EQU   GSRKEY
GSRFMID  EQU   GSRKEY+4
GRFREC   EQU   0
GRFKEY   EQU   GRFREC
GRFFSEQ  EQU   GRFKEY
GRFELEM  EQU   GRFKEY+2
GRFELTY  EQU   GRFKEY+10
GRFSM#   EQU   GRFREC+11
GRFSTY   EQU   GRFREC+18
GRFFLGS  EQU   GRFREC+19
GRFRELF# EQU   GRFREC+20
GRFRELF  EQU   GRFREC+22
GPSREC   EQU   0
GPSKEY   EQU   GPSREC
GPSTYPE  EQU   GPSKEY
GPSENT   EQU   GPSKEY+1
HMASMSCP EQU   0
SCPCHAR  EQU   HMASMSCP
SCPSRCH  EQU   HMASMSCP+4
SCPIORTN EQU   HMASMSCP+12
SCPIOPAD EQU   HMASMSCP+16
SCPINLN  EQU   HMASMSCP+20
SCPPMLN  EQU   HMASMSCP+22
SCPEOR   EQU   HMASMSCP+24
SCPCONT  EQU   SCPEOR
SCPCOMNT EQU   SCPEOR
SCPRETRN EQU   HMASMSCP+25
SCPRET   EQU   SCPRETRN
SCPSTRNG EQU   0
SPLPPACK EQU   0
SPLPUNPK EQU   0
SPLPDSN  EQU   0
SPLODSN  EQU   SPLPDSN
UX001PRM EQU   0
RVAPARM  EQU   0
RVAINFO  EQU   RVAPARM
RVAPASS  EQU   RVAPARM+12
RVAREC   EQU   RVAPASS+4
RVASTAE  EQU   RVAPARM+20
@NM00211 EQU   RVASTAE+16
@NM00212 EQU   RVASTAE+20
RVAFLAGS EQU   RVASTAE+24
@NM00217 EQU   0
SM#ID    EQU   @NM00217
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
SCPIOPRM EQU   0
RECPARM  EQU   0
RECFLAGS EQU   RECPARM+8
RECFLG1  EQU   RECFLAGS
RECFLG2  EQU   RECFLAGS+2
RECSEL   EQU   RECFLG2
RECEXC   EQU   RECFLG2
RECFLG3  EQU   RECFLAGS+3
RECFLG4  EQU   RECFLAGS+5
RECBPFM  EQU   RECFLG4
RECFLG5  EQU   RECFLAGS+7
SYSMNAME EQU   0
MSGCODE1 EQU   0
MSGCODE2 EQU   0
MSGCODE3 EQU   0
PRTFLG   EQU   0
UPDCK    EQU   0
VERCK    EQU   0
OPR1INDX EQU   0
OPR1TYPE EQU   0
OPR2INDX EQU   0
OPR2TYPE EQU   0
OPR1INX  EQU   0
OPR1TYP  EQU   0
SUBTYPE  EQU   0
PINDCODE EQU   0
CHARVAL  EQU   0
NFNDSMD# EQU   0
SKPN     EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00063 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00074 EQU   IOPUDATA
IOPTPSEQ EQU   @NM00074+8
@NM00075 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPNTLVL EQU   IOPASMDR
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00084 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00095 EQU   IOPSRCDR+1
@NM00097 EQU   @NM00095+7
@NM00101 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00105 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00111 EQU   IOPMODDR+1
@NM00113 EQU   @NM00111+7
@NM00117 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00121 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00132 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00139 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPTYPE EQU   IOPPTFDR+1
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPERROR EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPFLF   EQU   IOPPTFF3
IOPPTFFX EQU   IOPPTFNT+24
@NM00148 EQU   IOPPTFFX
@NM00149 EQU   @NM00148
IOPPDTES EQU   IOPPTFFX+41
@NM00152 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPPIND  EQU   IOPPNTRY+8
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPDSPFX EQU   IOPPTSFX+6
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00177 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00177
IOPPTREL EQU   IOPPTFMD
IOPPTSND EQU   IOPPTREL
IOPPTIND EQU   IOPPTNTR+8
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00181 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00181
IOPBFTB1 EQU   IOPBFTB0
MCBVVLST EQU   MCBVEND
MCBVNTRY EQU   MCBVVLST
MCBVNUM  EQU   MCBVNTRY
MCBVND   EQU   MCBVNUM
MCBVIND  EQU   MCBVVLST+8
MCBIVLST EQU   MCBIEND
MCBINTRY EQU   MCBIVLST
MCBINUM  EQU   MCBINTRY
MCBEVLST EQU   MCBEEND
MCBENTRY EQU   MCBEVLST
MCBENUM  EQU   MCBENTRY
MCBEND   EQU   MCBENUM
MCBEIND  EQU   MCBEVLST+8
PRLDATA  EQU   PRLEND
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00194 EQU   MCBENTRY+7
MCBIIND  EQU   MCBIVLST+8
@NM00187 EQU   MCBINTRY+7
MCBIND   EQU   MCBINUM
@NM00185 EQU   MCBVNTRY+7
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00183 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00182 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00180 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00179 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00178 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
@NM00176 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00175 EQU   IOPPTSFX+35
@NM00174 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00173 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00172 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00171 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00170 EQU   IOPQFMDR
@NM00166 EQU   IOPQSMDR
@NM00165 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00164 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00163 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00162 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00161 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00160 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00159 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00158 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00157 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00156 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00155 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00154 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPFMID EQU   IOPPTFFX+73
@NM00153 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00152+3
IOPRECD  EQU   @NM00152
@NM00151 EQU   IOPPTFFX+8
@NM00150 EQU   @NM00148+7
IOPPRELN EQU   @NM00149
@NM00147 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00146 EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00145 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00144 EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
@NM00143 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00142 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00141 EQU   @NM00139+7
@NM00140 EQU   @NM00139
@NM00138 EQU   IOPSYSDR+5
@NM00137 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00136 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00135 EQU   IOPDLBFX+8
@NM00134 EQU   @NM00132+7
@NM00133 EQU   @NM00132
@NM00131 EQU   IOPDLBDR+1
@NM00130 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00129 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00128 EQU   IOPMODFX+12
@NM00127 EQU   IOPMODF4
@NM00126 EQU   IOPMODF3
@NM00125 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00124 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00123 EQU   @NM00121+7
@NM00122 EQU   @NM00121
@NM00120 EQU   IOPMODDR+17
@NM00119 EQU   @NM00117+7
@NM00118 EQU   @NM00117
@NM00116 EQU   @NM00113
@NM00115 EQU   @NM00113
@NM00114 EQU   @NM00113
@NM00112 EQU   @NM00111
@NM00110 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00109 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00108 EQU   IOPSRCFX+8
@NM00107 EQU   @NM00105+7
@NM00106 EQU   @NM00105
@NM00104 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00103 EQU   @NM00101+7
@NM00102 EQU   @NM00101
@NM00100 EQU   @NM00097
@NM00099 EQU   @NM00097
@NM00098 EQU   @NM00097
@NM00096 EQU   @NM00095
@NM00094 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00093 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00092 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00091 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00090 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00089 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00088 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00086 EQU   @NM00084+7
@NM00085 EQU   @NM00084
@NM00083 EQU   IOPLMDDR+6
@NM00082 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00081 EQU   IOPLMDF4
@NM00080 EQU   IOPLMDF3
@NM00079 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00078 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00077 EQU   IOPLMDDR
@NM00076 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPALLOC EQU   @NM00075+4
IOPUSED  EQU   @NM00075
IOPVLSER EQU   @NM00074+2
IOPBLKSI EQU   @NM00074
IOPCQMAX EQU   IOPCQMAP+12
@NM00073 EQU   IOPCQMAP+11
@NM00072 EQU   IOPCQMAP+8
@NM00071 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00070 EQU   IOPSCMAP+11
@NM00069 EQU   IOPSCMAP+8
@NM00068 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00067 EQU   IOPNTMAX+11
@NM00066 EQU   IOPNTMAX+8
@NM00065 EQU   IOPNTMAX
@NM00064 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00063+5
IOPIPTF3 EQU   @NM00063
@NM00007 EQU   RECFLG5
RECICTOK EQU   RECFLG5
@NM00006 EQU   RECFLG4
@NM00005 EQU   RECFLG4
RECBPIRQ EQU   RECFLG4
RECBPREQ EQU   RECFLG4
RECBPPRE EQU   RECFLG4
RECBPID  EQU   RECFLG4
@NM00004 EQU   RECFLG3+1
RECSTS   EQU   RECFLG3
RECMTS   EQU   RECFLG3
RECPTS   EQU   RECFLG3
RECACRQ  EQU   RECFLG3
RECCRQ   EQU   RECFLG3
RECSCDS  EQU   RECFLG3
RECACDS  EQU   RECFLG3
RECCDS   EQU   RECFLG3
RECMASS  EQU   RECFLG2
@NM00003 EQU   RECFLG2
RECFMID  EQU   RECFLG2
RECGROUP EQU   RECFLG2
@NM00002 EQU   RECFLG1+1
RECDISW  EQU   RECFLG1+1
RECDISR  EQU   RECFLG1+1
RECDISN  EQU   RECFLG1+1
RECNOJCL EQU   RECFLG1
RECFLUSH EQU   RECFLG1
RECUSER  EQU   RECFLG1
RECAPAR  EQU   RECFLG1
RECCOMP  EQU   RECFLG1
RECASSEM EQU   RECFLG1
RECCHECK EQU   RECFLG1
RECNOAPP EQU   RECFLG1
@NM00001 EQU   RECPARM+5
RECNUCID EQU   RECPARM+4
RECJCLGT EQU   RECPARM
RVAEND   EQU   RVASTAE+25
@NM00213 EQU   RVAFLAGS
RVASDWFD EQU   RVAFLAGS
RVAVS1   EQU   RVAFLAGS
RVAMVS   EQU   RVAFLAGS
RVAUSRCH EQU   @NM00212+2
RVASYSCH EQU   @NM00212
RVAUSRCD EQU   @NM00211+2
RVASYSCD EQU   @NM00211
RVAABNDC EQU   RVASTAE+12
RVAEPRNM EQU   RVASTAE+4
RVASDWAP EQU   RVASTAE
RVATBL   EQU   RVAPASS
RVAMAJNM EQU   RVAINFO+8
RVACCAP  EQU   RVAINFO+4
RVAHDR   EQU   RVAINFO
UX001RCD EQU   UX001PRM+1
UX001RC  EQU   UX001PRM
SPLIFIL  EQU   SPLODSN+33
SPLISMD  EQU   SPLODSN+26
SPLIPFX  EQU   SPLODSN
SPLIUNPK EQU   SPLPUNPK+8
SPLOUNPK EQU   SPLPUNPK
SPLOPACK EQU   SPLPPACK+8
SPLIPACK EQU   SPLPPACK
@NM00207 EQU   SCPEOR
SCPNORT  EQU   SCPEOR
SCPNOSUC EQU   SCPEOR
SCPRTERR EQU   SCPEOR
SCPNOCT  EQU   SCPEOR
SCPWKAR  EQU   HMASMSCP+8
@NM00206 EQU   GRFFLGS
GRFLOADD EQU   GRFFLGS
GRFFLUSH EQU   GRFFLGS
@NM00205 EQU   GSMSTAT2
GSMRLFL  EQU   GSMSTAT2
GSMRECVD EQU   GSMSTAT2
@NM00204 EQU   GSMSTAT1+1
GSMCERR  EQU   GSMSTAT1+1
GSMRERR  EQU   GSMSTAT1+1
GSMLERR  EQU   GSMSTAT1
PRLCONC  EQU   PRLTIME+2
@NM00198 EQU   PRLTIME
PRLHDADR EQU   PRLDATE
@NM00197 EQU   PRLFLGS
PRLHEADO EQU   PRLFLGS
PRLHEAD  EQU   PRLFLGS
PRLRLEN  EQU   HMASMPRL
@NM00193 EQU   MCBEFLG5
MCBESTD  EQU   MCBEFLG5
@NM00192 EQU   MCBEFLG4
@NM00191 EQU   MCBEFLG3
@NM00190 EQU   MCBEFLG2
MCBEPAGA EQU   MCBEFLG2
MCBENE   EQU   MCBEFLG2
@NM00189 EQU   MCBEFLG1
MCBEDC   EQU   MCBEFLG1
MCBEREFR EQU   MCBEFLG1
MCBEOVLY EQU   MCBEFLG1
MCBESCTR EQU   MCBEFLG1
MCBEREUS EQU   MCBEFLG1
MCBERENT EQU   MCBEFLG1
MCBEAPF  EQU   MCBEFLG1
MCBERMID EQU   MCBELEMP+129
MCBELLKD EQU   MCBELEMP+128
MCBEJLKD EQU   MCBELEMP+116
MCBELUPI EQU   MCBELEMP+115
MCBEJUPI EQU   MCBELEMP+103
MCBELCPY EQU   MCBELEMP+102
MCBEJCPY EQU   MCBELEMP+90
MCBELASM EQU   MCBELEMP+89
MCBEJASM EQU   MCBELEMP+77
MCBESSI  EQU   MCBELEMP+65
MCBEASLB EQU   MCBELEMP+49
MCBESYS  EQU   MCBELEMP+25
MCBEDOBJ EQU   MCBELEMP+17
MCBEDIST EQU   MCBELEMP+9
@NM00188 EQU   MCBELEMP
@NM00186 EQU   MCBIFMP
@NM00184 EQU   MCBVERMP
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00169 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00168 EQU   @NM00167+7
IOPQSMFM EQU   @NM00167
@NM00087 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00062 EQU   IOPUSERL
@NM00061 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00060 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00059 EQU   @NM00056+10
@NM00058 EQU   @NM00057+7
IOPPTFNM EQU   @NM00057
@NM00055 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00054 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
@NM00053 EQU   HMASMGTP+2
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00049 EQU   CCABLDLM+2
@NM00048 EQU   CCABLDLM
CCAUPDPM EQU   @NM00046+24
@NM00047 EQU   @NM00046+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00046+12
CCAUPDTE EQU   @NM00046+8
CCAUPDNM EQU   @NM00046
CCASUPPM EQU   @NM00044+24
@NM00045 EQU   @NM00044+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00044+12
CCAIOSUP EQU   @NM00044+8
CCASUPNM EQU   @NM00044
CCAZAPPM EQU   @NM00042+24
@NM00043 EQU   @NM00042+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00042+12
CCASPZAP EQU   @NM00042+8
CCAZAPNM EQU   @NM00042
CCACOMPM EQU   @NM00040+24
@NM00041 EQU   @NM00040+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00040+12
CCACOMRS EQU   @NM00040+8
CCACOMNM EQU   @NM00040
CCACPYPM EQU   @NM00038+24
@NM00039 EQU   @NM00038+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00038+12
CCACOPY  EQU   @NM00038+8
CCACPYNM EQU   @NM00038
CCAASMPM EQU   @NM00036+24
@NM00037 EQU   @NM00036+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00036+12
CCAASM   EQU   @NM00036+8
CCAASMNM EQU   @NM00036
CCALKDPM EQU   @NM00034+24
@NM00035 EQU   @NM00034+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00034+12
CCALKED  EQU   @NM00034+8
CCALKDNM EQU   @NM00034
CCAPGMPM EQU   @NM00032+24
@NM00033 EQU   @NM00032+21
CCABPGRC EQU   @NM00032+20
CCABPGSP EQU   @NM00032+12
CCABPGAD EQU   @NM00032+8
CCABPGNM EQU   @NM00032
CCAEND   EQU   HMASMCCA+371
@NM00031 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00030 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00029 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00028 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00027 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00026 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00025 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00024 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00023 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00022 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00021 EQU   @NM00016+18
@NM00020 EQU   @NM00016+16
CCATBLPA EQU   @NM00016+12
@NM00019 EQU   @NM00016+8
@NM00018 EQU   @NM00016+4
@NM00017 EQU   @NM00016
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00015 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00014 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00013 EQU   CCAFBUFR+122
@NM00012 EQU   CCAFBUFR+120
@NM00011 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00010 EQU   CCAFBUFR+88
@NM00009 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00008 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00736 EQU   @EL00004
@RC00751 EQU   @EL00004
@RC00760 EQU   @EL00004
@RC00758 EQU   @EL00004
@RC00756 EQU   @EL00004
@RC00754 EQU   @EL00004
@RF00800 EQU   @RC00792
@RF00824 EQU   @EL00005
@RC00829 EQU   @EL00006
@RF00844 EQU   @EL00006
@RC00971 EQU   @EL00009
@RF01011 EQU   @EL00010
@RF01020 EQU   @EL00011
@RF01036 EQU   @EL00011
@RC01048 EQU   @EL00012
@RF01065 EQU   @EL00012
@PB00015 EQU   @EL00012
@RF01161 EQU   @EL00016
@RC01159 EQU   @EL00016
@RC01157 EQU   @EL00016
@RC01155 EQU   @EL00016
@RC01170 EQU   @EL00017
@RC01176 EQU   @EL00017
@RF01199 EQU   @EL00018
@RF01202 EQU   @EL00018
@RC01213 EQU   @EL00019
@RF01278 EQU   @EL00019
@RF01302 EQU   @EL00020
@RF01321 EQU   @EL00023
@PB00024 EQU   @EL00020
@RC01345 EQU   @EL00025
@RF01354 EQU   @EL00025
@RF01370 EQU   @EL00025
@RF01392 EQU   @EL00026
@RC01403 EQU   @EL00026
@RF01423 EQU   @EL00026
@RF01437 EQU   @EL00027
@RF01604 EQU   @EL00029
@RF01640 EQU   @EL00030
@PB00031 EQU   @EL00028
@RF01715 EQU   @EL00032
@RF00975 EQU   @RC00971
@PB00014 EQU   @PB00015
@PB00023 EQU   @PB00024
@RC01405 EQU   @RC01403
@RF01413 EQU   @RC01403
@PB00030 EQU   @PB00031
@PB00013 EQU   @PB00014
@PB00022 EQU   @PB00023
@PB00029 EQU   @PB00030
@PB00021 EQU   @PB00022
@RC01590 EQU   @PB00029
@ENDDATA EQU   *
         END   HMASMREC,(C'PLS2111',0802,78334)

         TITLE 'HMASMTMS - ELEMENT SELECTION PROCEDURE'
HMASMTMS CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTMS  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @09,0                                               0001
@PSTART  LA    @10,4095(,@09)                                      0001
         LA    @12,4095(,@10)                                      0001
         USING @PSTART,@09                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@12                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(8),0(@01)                                  0001
*   TMSFLGS=''B;                    /* CLEAR LOCAL PROCESSING FLAGS  */
         MVI   TMSFLGS,X'00'                                       0227
*   HIGHTMS=ZERO;                   /* INITIALIZE RETURN CODE      0228
*                                      COLLECTOR                     */
         SLR   HIGHTMS,HIGHTMS                                     0228
*   MSGSMDNM=ICTPTFS(1);            /* "CURRENT" SYSMOD-ID #         */
         L     @08,@PC00001+4                                      0229
         L     @08,CPTF(,@08)                                      0229
         MVC   MSGSMDNM(7),ICTPTFS(@08)                            0229
*   IF CCAAPPLY=ON                  /* APPLY                         */
*     THEN                                                         0230
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0230
         BNO   @RF00230                                            0230
*     MSGXCDS=MSGCDS;               /* SMPCDS DATASET FOR APPLY      */
         MVC   MSGXCDS(8),@CC01845                                 0231
*   ELSE                                                           0232
*     MSGXCDS=MSGACDS;              /* SMPACDS DATASET FOR ACCEPT    */
         B     @RC00230                                            0232
@RF00230 MVC   MSGXCDS(8),@CC01843                                 0232
*   IOPPTR=CCAIOPTR;                /* GENERAL-USE IOP FROM CCA      */
@RC00230 L     IOPPTR,CCAIOPTR(,CCAPTR)                            0233
*   HMASMMGP=''B;                   /* CLEAR HMASMMSG PARM BLOCK     */
         XC    HMASMMGP(32),HMASMMGP                               0234
*                                                                  0235
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS SRC REPLACEMENT ELEMENTS FROM THE "CURRENT" SYSMOD    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0235
*   RESPECIFY                                                      0235
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */
*   RESPECIFY                                                      0236
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN
*                                      PTR ARRAY FOR "CURRENT" PTF 0236
*                                      ENTRY                         */
*                                                                  0236
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0237
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0237
         LA    I,1                                                 0237
         B     @DE00237                                            0237
@DL00237 DS    0H                                                  0238
*     RESPECIFY                                                    0238
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"
*                                      SYSMOD                        */
*     IF ICTMSRCR(1)=ON             /* SRC REPL ELEMENT              */
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */
*       THEN                                                       0239
         LR    @08,I                                               0239
         SLA   @08,2                                               0239
         L     @03,@PC00001+4                                      0239
         L     @03,CPTF(,@03)                                      0239
         L     @03,ICTPCHN(,@03)                                   0239
         AL    @03,@CF02030                                        0239
         L     @08,ICTIXPF(@08,@03)                                0239
         TM    ICTMSRCR(@08),B'00000010'                           0239
         BNO   @RF00239                                            0239
         TM    ICTMSELM(@08),B'00100000'                           0239
         BNZ   @RF00239                                            0239
*       DO;                                                        0240
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */
*                                                                  0241
         XC    SELEXCL(2),SELEXCL                                  0241
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS SRC REPLACEMENT ELEMENT                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0242
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */
         ST    @08,CMOD                                            0242
*         VPART#1=MSGSRC;           /* ELEMENT TYPE FOR ERRMSG       */
         MVC   VPART#1(8),@CC01831                                 0243
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */
         MVC   VPART#2(8),ICTMNAME(@08)                            0244
*         CALL REPELEM;             /* PROCESS REPLACEMENT ELEMENTS  */
         BAL   @14,REPELEM                                         0245
*         IF ICTMISEL(1)=ON         /* ELEMENT SHOULD BE SELECTED  0246
*                                      WHEN COMPARED WITH TARGET SRC */
*           THEN                                                   0246
         LR    @08,I                                               0246
         SLA   @08,2                                               0246
         L     @03,@PC00001+4                                      0246
         L     @03,CPTF(,@03)                                      0246
         L     @03,ICTPCHN(,@03)                                   0246
         AL    @03,@CF02030                                        0246
         L     @08,ICTIXPF(@08,@03)                                0246
         TM    ICTMISEL(@08),B'10000000'                           0246
         BNO   @RF00246                                            0246
*           CALL ASSEMCHK;          /* CHECK AND SELECT ASSOCIATED 0247
*                                      ASSEMBLY                      */
         BAL   @14,ASSEMCHK                                        0247
*         IF ICTMISEL(1)=ON         /* STILL SHOULD BE SELECTED      */
*           THEN                                                   0248
@RF00246 LR    @08,I                                               0248
         SLA   @08,2                                               0248
         L     @03,@PC00001+4                                      0248
         L     @03,CPTF(,@03)                                      0248
         L     @03,ICTPCHN(,@03)                                   0248
         AL    @03,@CF02030                                        0248
         L     @08,ICTIXPF(@08,@03)                                0248
         TM    ICTMISEL(@08),B'10000000'                           0248
         BNO   @RF00248                                            0248
*           DO;                                                    0249
*                                                                  0249
*             /*******************************************************/
*             /*                                                     */
*             /* SRC ELEMENT SELECTED ... CHECK WHETHER ASSOCIATED   */
*             /* ++MOD SHOULD BE ELIMINATED FROM FURTHER             */
*             /* CONSIDERATION                                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0250
*             IF(TBLBPID=ON         /* BYPASS ID IN EFFECT           */
*                 ×TBLASSEM=ON      /* ASSEM SPECIFIED               */
*                 ×ASMREQD=ON)      /* ASSEMBLY REQUIRED BY ID CHECK */
*                 &ICTMASOC(1)=ON   /* THERE IS AN ASSOCIATED ++MOD  */
*               THEN                                               0250
         L     @08,@PC00001                                        0250
         L     @08,TBLXTBL(,@08)                                   0250
         TM    TBLBPID(@08),B'10000000'                            0250
         BO    @GL00002                                            0250
         TM    TBLASSEM(@08),B'00100000'                           0250
         BO    @GL00002                                            0250
         TM    ASMREQD,B'00010000'                                 0250
         BNO   @RF00250                                            0250
@GL00002 LR    @08,I                                               0250
         SLA   @08,2                                               0250
         L     @03,@PC00001+4                                      0250
         L     @03,CPTF(,@03)                                      0250
         L     @03,ICTPCHN(,@03)                                   0250
         AL    @03,@CF02030                                        0250
         L     @08,ICTIXPF(@08,@03)                                0250
         TM    ICTMASOC(@08),B'00010000'                           0250
         BNO   @RF00250                                            0250
*               DO;                                                0251
*                 CALL ELIMMOD(ICTMNAME(1));/* ELIMINATE ASSOC ++MOD */
         ST    @08,@AL00001                                        0252
         LA    @01,@AL00001                                        0252
         BAL   @14,ELIMMOD                                         0252
*                 ICTMASOC(1)=OFF;  /* SET ASSOCIATED ++MOD FLAG OFF */
         LR    @08,I                                               0253
         SLA   @08,2                                               0253
         L     @03,@PC00001+4                                      0253
         L     @03,CPTF(,@03)                                      0253
         L     @03,ICTPCHN(,@03)                                   0253
         AL    @03,@CF02030                                        0253
         L     @08,ICTIXPF(@08,@03)                                0253
         NI    ICTMASOC(@08),B'11101111'                           0253
*               END;                                               0254
*           END;                                                   0255
@RF00250 DS    0H                                                  0256
*         IF ICTMISEL(1)=OFF        /* ELEMENT NOT SELECTED          */
*             &ICTMMIDE(1)=OFF      /* NO ID CHECK ERROR             */
*             &ICTMASOC(1)=ON       /* THERE IS ASSOCIATED ++MOD     */
*           THEN                                                   0256
@RF00248 LR    @08,I                                               0256
         SLA   @08,2                                               0256
         L     @03,@PC00001+4                                      0256
         L     @03,CPTF(,@03)                                      0256
         L     @03,ICTPCHN(,@03)                                   0256
         AL    @03,@CF02030                                        0256
         L     @08,ICTIXPF(@08,@03)                                0256
         TM    ICTMASOC(@08),B'00010000'                           0256
         BNO   @RF00256                                            0256
         TM    ICTMISEL(@08),B'10001000'                           0256
         BNZ   @RF00256                                            0256
*           DO;                                                    0257
*                                                                  0257
*             /*******************************************************/
*             /*                                                     */
*             /* SRC ELEMENT EXCLUDED ... ELIMINATE ASSOC ++MOD      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0258
*             CALL ELIMMOD(ICTMNAME(1));/* ELIMAINATE ASSOC ++MOD    */
         ST    @08,@AL00001                                        0258
         LA    @01,@AL00001                                        0258
         BAL   @14,ELIMMOD                                         0258
*             ICTMASOC(1)=OFF;      /* SET ASSOCIATED ++MOD FLAG OFF */
         LR    @08,I                                               0259
         SLA   @08,2                                               0259
         L     @03,@PC00001+4                                      0259
         L     @03,CPTF(,@03)                                      0259
         L     @03,ICTPCHN(,@03)                                   0259
         AL    @03,@CF02030                                        0259
         L     @08,ICTIXPF(@08,@03)                                0259
         NI    ICTMASOC(@08),B'11101111'                           0259
*           END;                                                   0260
*         IF ICTMISEL(1)=OFF        /* SRC ELEMENT NOT SELECTED      */
*             &ICTMMIDE(1)=ON       /* DUE TO ID CHECK ERROR         */
*           THEN                                                   0261
*                                                                  0261
@RF00256 LR    @08,I                                               0261
         SLA   @08,2                                               0261
         L     @03,@PC00001+4                                      0261
         L     @03,CPTF(,@03)                                      0261
         L     @03,ICTPCHN(,@03)                                   0261
         AL    @03,@CF02030                                        0261
         L     @08,ICTIXPF(@08,@03)                                0261
         TM    ICTMMIDE(@08),B'00001000'                           0261
         BNO   @RF00261                                            0261
         TM    ICTMISEL(@08),B'10000000'                           0261
         BNZ   @RF00261                                            0261
*           /*********************************************************/
*           /*                                                       */
*           /* SRC ELEMENT ID CHECK ERROR ... MAKE SURE ALL          */
*           /* ASSEMBLIES ARE NOT SELECTED                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0262
*           CALL ASSEMSEL(ICTMOD(1),/* "CURRENT" ELEMENT             */
*               RESET);             /* CLEAR ICTMISEL IN ASSEM     0262
*                                      ENTRIES                       */
         ST    @08,@AL00001                                        0262
         LA    @08,@CC01748                                        0262
         ST    @08,@AL00001+4                                      0262
         LA    @01,@AL00001                                        0262
         BAL   @14,ASSEMSEL                                        0262
*       END;                        /* END SRC REPL ELEMENT          */
@RF00261 DS    0H                                                  0264
*   END;                            /* END ICTIXP LOOP               */
@RF00239 AH    I,@CH00067                                          0264
@DE00237 LR    @08,I                                               0264
         SLA   @08,2                                               0264
         L     @03,@PC00001+4                                      0264
         L     @03,CPTF(,@03)                                      0264
         L     @03,ICTPCHN(,@03)                                   0264
         AL    @03,@CF02030                                        0264
         L     @08,ICTIXP(@08,@03)                                 0264
         CL    @08,ICTENDIX                                        0264
         BNE   @DL00237                                            0264
*                                                                  0265
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS SRC UPDATE ELEMENTS FROM THE "CURRENT" SYSMOD         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*   RESPECIFY                                                      0265
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */
*   RESPECIFY                                                      0266
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN
*                                      PTR ARRAY FOR "CURRENT" PTF 0266
*                                      ENTRY                         */
*                                                                  0266
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0267
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0267
         LA    I,1                                                 0267
         B     @DE00267                                            0267
@DL00267 DS    0H                                                  0268
*     RESPECIFY                                                    0268
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"
*                                      SYSMOD                        */
*     IF ICTMSRCU(1)=ON             /* SRC UPDATE ELEMENT            */
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */
*       THEN                                                       0269
         LR    @08,I                                               0269
         SLA   @08,2                                               0269
         L     @03,@PC00001+4                                      0269
         L     @03,CPTF(,@03)                                      0269
         L     @03,ICTPCHN(,@03)                                   0269
         AL    @03,@CF02030                                        0269
         L     @08,ICTIXPF(@08,@03)                                0269
         TM    ICTMSRCU(@08),B'00000001'                           0269
         BNO   @RF00269                                            0269
         TM    ICTMSELM(@08),B'00100000'                           0269
         BNZ   @RF00269                                            0269
*       DO;                                                        0270
*                                                                  0270
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS SRC UPDATE ELEMENT                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0271
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */
         XC    SELEXCL(2),SELEXCL                                  0271
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */
         ST    @08,CMOD                                            0272
*         VPART#1=MSGSRCU;          /* ELEMENT TYPE FOR ERRMSG       */
         MVC   VPART#1(8),@CC01833                                 0273
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */
         MVC   VPART#2(8),ICTMNAME(@08)                            0274
*         CALL UPDELEM;             /* PROCESS UPDATE ELEMENTS       */
         BAL   @14,UPDELEM                                         0275
*         IF ICTMISEL(1)=ON         /* ELEMENT SHOULD BE SELECTED  0276
*                                      WHEN COMPARED WITH TARGET SRC */
*           THEN                                                   0276
         LR    @08,I                                               0276
         SLA   @08,2                                               0276
         L     @03,@PC00001+4                                      0276
         L     @03,CPTF(,@03)                                      0276
         L     @03,ICTPCHN(,@03)                                   0276
         AL    @03,@CF02030                                        0276
         L     @08,ICTIXPF(@08,@03)                                0276
         TM    ICTMISEL(@08),B'10000000'                           0276
         BNO   @RF00276                                            0276
*           CALL ASSEMCHK;          /* CHECK AND SELECT ASSOCIATED 0277
*                                      ASSEMBLIES                    */
         BAL   @14,ASSEMCHK                                        0277
*         IF ICTMISEL(1)=ON         /* STILL SELECTED                */
*           THEN                                                   0278
@RF00276 LR    @08,I                                               0278
         SLA   @08,2                                               0278
         L     @03,@PC00001+4                                      0278
         L     @03,CPTF(,@03)                                      0278
         L     @03,ICTPCHN(,@03)                                   0278
         AL    @03,@CF02030                                        0278
         L     @08,ICTIXPF(@08,@03)                                0278
         TM    ICTMISEL(@08),B'10000000'                           0278
         BNO   @RF00278                                            0278
*           DO;                                                    0279
*                                                                  0279
*             /*******************************************************/
*             /*                                                     */
*             /* SRCUPD ELEMENT SELECTED ... SEE IF ASSOC. ++MOD     */
*             /* SHOULD BE ELIMINATED                                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0280
*             IF(UMIDERR=ON         /* ALL UPDATES NOT PRE/SUP       */
*                 ×ASMREQD=ON       /* ... OR ASSM REQD. BY ID CHECK */
*                 ×TBLBPID=ON       /* ... OR BYPASS ID IN EFFECT    */
*                 ×TBLASSEM=ON)     /* ... OR ASSEM SPECIFIED        */
*                 &ICTMASOC(1)=ON   /* THERE IS ASSOCIATED ++MOD     */
*               THEN                                               0280
         TM    UMIDERR,B'01010000'                                 0280
         BNZ   @GL00006                                            0280
         L     @08,@PC00001                                        0280
         L     @08,TBLXTBL(,@08)                                   0280
         TM    TBLBPID(@08),B'10000000'                            0280
         BO    @GL00006                                            0280
         TM    TBLASSEM(@08),B'00100000'                           0280
         BNO   @RF00280                                            0280
@GL00006 LR    @08,I                                               0280
         SLA   @08,2                                               0280
         L     @03,@PC00001+4                                      0280
         L     @03,CPTF(,@03)                                      0280
         L     @03,ICTPCHN(,@03)                                   0280
         AL    @03,@CF02030                                        0280
         L     @08,ICTIXPF(@08,@03)                                0280
         TM    ICTMASOC(@08),B'00010000'                           0280
         BNO   @RF00280                                            0280
*               DO;                                                0281
*                 CALL ELIMMOD(ICTMNAME(1));/* ELIMINATE ASSOC ++MOD */
         ST    @08,@AL00001                                        0282
         LA    @01,@AL00001                                        0282
         BAL   @14,ELIMMOD                                         0282
*                 ICTMASOC(1)=OFF;  /* SET ASSOCIATED ++MOD FLAG OFF */
         LR    @08,I                                               0283
         SLA   @08,2                                               0283
         L     @03,@PC00001+4                                      0283
         L     @03,CPTF(,@03)                                      0283
         L     @03,ICTPCHN(,@03)                                   0283
         AL    @03,@CF02030                                        0283
         L     @08,ICTIXPF(@08,@03)                                0283
         NI    ICTMASOC(@08),B'11101111'                           0283
*               END;                                               0284
*           END;                    /* END SELECTED SRC UPDATE ELEM. */
@RF00280 DS    0H                                                  0286
*       END;                        /* END SRC UPDATE ELEMENT        */
@RF00278 DS    0H                                                  0287
*   END;                            /* END ICTIXP LOOP               */
@RF00269 AH    I,@CH00067                                          0287
@DE00267 LR    @08,I                                               0287
         SLA   @08,2                                               0287
         L     @03,@PC00001+4                                      0287
         L     @03,CPTF(,@03)                                      0287
         L     @03,ICTPCHN(,@03)                                   0287
         AL    @03,@CF02030                                        0287
         L     @08,ICTIXP(@08,@03)                                 0287
         CL    @08,ICTENDIX                                        0287
         BNE   @DL00267                                            0287
*                                                                  0288
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS MACRO REPLACEMENT ELEMENTS FROM "CURRENT" SYSMOD      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0288
*   RESPECIFY                                                      0288
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */
*   RESPECIFY                                                      0289
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN
*                                      PTR ARRAY FOR "CURRENT" PTF 0289
*                                      ENTRY                         */
*                                                                  0289
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0290
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0290
         LA    I,1                                                 0290
         B     @DE00290                                            0290
@DL00290 DS    0H                                                  0291
*     RESPECIFY                                                    0291
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"
*                                      SYSMOD                        */
*     IF ICTMMACR(1)=ON             /* MAC REPLACEMENT ELEMENT       */
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */
*       THEN                                                       0292
         LR    @08,I                                               0292
         SLA   @08,2                                               0292
         L     @03,@PC00001+4                                      0292
         L     @03,CPTF(,@03)                                      0292
         L     @03,ICTPCHN(,@03)                                   0292
         AL    @03,@CF02030                                        0292
         L     @08,ICTIXPF(@08,@03)                                0292
         TM    ICTMMACR(@08),B'00001000'                           0292
         BNO   @RF00292                                            0292
         TM    ICTMSELM(@08),B'00100000'                           0292
         BNZ   @RF00292                                            0292
*       DO;                                                        0293
*                                                                  0293
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS MACRO REPLACEMENT ELEMENT                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0294
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */
         XC    SELEXCL(2),SELEXCL                                  0294
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */
         ST    @08,CMOD                                            0295
*         VPART#1=MSGMAC;           /* ELEMENT TYPE FOR ERRMSG       */
         MVC   VPART#1(8),@CC01827                                 0296
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */
         MVC   VPART#2(8),ICTMNAME(@08)                            0297
*         CALL REPELEM;             /* PROCESS REPLACEMENT ELEMENTS  */
         BAL   @14,REPELEM                                         0298
*         IF ICTMISEL(1)=ON         /* SELECTED                      */
*           THEN                                                   0299
         LR    @08,I                                               0299
         SLA   @08,2                                               0299
         L     @03,@PC00001+4                                      0299
         L     @03,CPTF(,@03)                                      0299
         L     @03,ICTPCHN(,@03)                                   0299
         AL    @03,@CF02030                                        0299
         L     @08,ICTIXPF(@08,@03)                                0299
         TM    ICTMISEL(@08),B'10000000'                           0299
         BNO   @RF00299                                            0299
*           DO;                                                    0300
*                                                                  0300
*             /*******************************************************/
*             /*                                                     */
*             /* SELECTED MACRO ELEMENT                              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0301
*             CALL ASSEMCHK;        /* CHECK AND SELECT ANY ASSEMBLY
*                                      ENTRIES CREATED FOR THIS MACRO*/
         BAL   @14,ASSEMCHK                                        0301
*             IF ICTMISEL(1)=ON     /* STILL SELECTED                */
*               THEN                                               0302
         LR    @08,I                                               0302
         SLA   @08,2                                               0302
         L     @03,@PC00001+4                                      0302
         L     @03,CPTF(,@03)                                      0302
         L     @03,ICTPCHN(,@03)                                   0302
         AL    @03,@CF02030                                        0302
         L     @08,ICTIXPF(@08,@03)                                0302
         TM    ICTMISEL(@08),B'10000000'                           0302
         BNO   @RF00302                                            0302
*               DO;                                                0303
*                                                                  0303
*                 /***************************************************/
*                 /*                                                 */
*                 /* MACRO SELECTED ... ELIMINATE ANY ++MOD ICT      */
*                 /* ENTRIES FROM THE "CURRENT" SYSMOD FOR THE       */
*                 /* SELECTED ASSEMBLIES                             */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0304
*                 RESPECIFY                                        0304
*                   ICTASMLS BASED(ICTMACHN(1));/* ADDRESS LIST OF 0304
*                                      ASSEM ADDRESSES               */
*                                                                  0304
*                 /***************************************************/
*                 /*                                                 */
*                 /* GO THRU ALL REQUIRED ASSEMBLIES                 */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0305
*                 DO J=1 BY 1 WHILE ICTASMND(J)^=ICTENDIX;         0305
         LA    J,1                                                 0305
         B     @DE00305                                            0305
@DL00305 DS    0H                                                  0306
*                   IF ICTASMAD(J)->ICTMISEL(1)=ON/* SELECTED ASSEM  */
*                     THEN                                         0306
*                                                                  0306
         LR    @08,J                                               0306
         SLA   @08,2                                               0306
         LR    @15,I                                               0306
         SLA   @15,2                                               0306
         L     @14,@PC00001+4                                      0306
         L     @01,CPTF(,@14)                                      0306
         L     @01,ICTPCHN(,@01)                                   0306
         AL    @01,@CF02030                                        0306
         L     @01,ICTIXPF(@15,@01)                                0306
         MVC   @TF00001(4),ICTMACHN(@01)                           0306
         L     @01,@TF00001                                        0306
         AL    @01,@CF02030                                        0306
         L     @08,ICTASMAD(@08,@01)                               0306
         TM    ICTMISEL(@08),B'10000000'                           0306
         BNO   @RF00306                                            0306
*                     /***********************************************/
*                     /*                                             */
*                     /* ELIMINATE ANY ++MOD WITH THE SAME NAME      */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0307
*                     CALL ELIMMOD(ICTASMAD(J)->ICTMNAME(1));      0307
         ST    @08,@AL00001                                        0307
         LA    @01,@AL00001                                        0307
         BAL   @14,ELIMMOD                                         0307
*                 END;                                             0308
@RF00306 AH    J,@CH00067                                          0308
@DE00305 LR    @08,J                                               0308
         SLA   @08,2                                               0308
         LR    @15,I                                               0308
         SLA   @15,2                                               0308
         L     @14,@PC00001+4                                      0308
         L     @01,CPTF(,@14)                                      0308
         L     @01,ICTPCHN(,@01)                                   0308
         AL    @01,@CF02030                                        0308
         L     @01,ICTIXPF(@15,@01)                                0308
         MVC   @TF00001(4),ICTMACHN(@01)                           0308
         L     @01,@TF00001                                        0308
         AL    @01,@CF02030                                        0308
         L     @08,ICTASMND(@08,@01)                               0308
         CL    @08,ICTENDIX                                        0308
         BNE   @DL00305                                            0308
*               END;                                               0309
*             IF ICTMISEL(1)=OFF    /* MACRO NOT SELECTED            */
*                 &ICTMMIDE(1)=ON   /* DUE TO ID CHECK ERROR         */
*               THEN                                               0310
*                                                                  0310
@RF00302 LR    @08,I                                               0310
         SLA   @08,2                                               0310
         L     @03,@PC00001+4                                      0310
         L     @03,CPTF(,@03)                                      0310
         L     @03,ICTPCHN(,@03)                                   0310
         AL    @03,@CF02030                                        0310
         L     @08,ICTIXPF(@08,@03)                                0310
         TM    ICTMMIDE(@08),B'00001000'                           0310
         BNO   @RF00310                                            0310
         TM    ICTMISEL(@08),B'10000000'                           0310
         BNZ   @RF00310                                            0310
*               /*****************************************************/
*               /*                                                   */
*               /* MACRO NOT SELECTED DUE TO ID CHECK ERROR ... MAKE */
*               /* SURE ALL ASSEMBLIES ARE NOT SELECTED              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0311
*               CALL ASSEMSEL(ICTMOD(1),/* "CURRENT" ELEMENT         */
*                   RESET);         /* CLEAR ICTMISEL IN ASSEM     0311
*                                      ENTRIES                       */
         ST    @08,@AL00001                                        0311
         LA    @08,@CC01748                                        0311
         ST    @08,@AL00001+4                                      0311
         LA    @01,@AL00001                                        0311
         BAL   @14,ASSEMSEL                                        0311
*           END;                                                   0312
@RF00310 DS    0H                                                  0313
*       END;                        /* END MACRO REPLACEMENT ELEM.   */
@RF00299 DS    0H                                                  0314
*   END;                            /* END ICTIXP LOOP               */
@RF00292 AH    I,@CH00067                                          0314
@DE00290 LR    @08,I                                               0314
         SLA   @08,2                                               0314
         L     @03,@PC00001+4                                      0314
         L     @03,CPTF(,@03)                                      0314
         L     @03,ICTPCHN(,@03)                                   0314
         AL    @03,@CF02030                                        0314
         L     @08,ICTIXP(@08,@03)                                 0314
         CL    @08,ICTENDIX                                        0314
         BNE   @DL00290                                            0314
*                                                                  0315
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS MACUPD UPDATE ELEMENTS FROM "CURRENT" SYSMOD          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*   RESPECIFY                                                      0315
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */
*   RESPECIFY                                                      0316
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN
*                                      PTR ARRAY FOR "CURRENT" PTF 0316
*                                      ENTRY                         */
*                                                                  0316
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0317
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0317
         LA    I,1                                                 0317
         B     @DE00317                                            0317
@DL00317 DS    0H                                                  0318
*     RESPECIFY                                                    0318
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"
*                                      SYSMOD                        */
*     IF ICTMMACU(1)=ON             /* MAC UPDATE ELEMENT            */
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */
*       THEN                                                       0319
         LR    @08,I                                               0319
         SLA   @08,2                                               0319
         L     @03,@PC00001+4                                      0319
         L     @03,CPTF(,@03)                                      0319
         L     @03,ICTPCHN(,@03)                                   0319
         AL    @03,@CF02030                                        0319
         L     @08,ICTIXPF(@08,@03)                                0319
         TM    ICTMMACU(@08),B'00000100'                           0319
         BNO   @RF00319                                            0319
         TM    ICTMSELM(@08),B'00100000'                           0319
         BNZ   @RF00319                                            0319
*       DO;                                                        0320
*                                                                  0320
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS MACRO UPDATE ELEMENT                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0321
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */
         XC    SELEXCL(2),SELEXCL                                  0321
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */
         ST    @08,CMOD                                            0322
*         VPART#1=MSGMACU;          /* ELEMENT TYPE FOR ERRMSG       */
         MVC   VPART#1(8),@CC01829                                 0323
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */
         MVC   VPART#2(8),ICTMNAME(@08)                            0324
*         CALL UPDELEM;             /* PROCESS UPDATE ELEMENTS       */
         BAL   @14,UPDELEM                                         0325
*         IF ICTMISEL(1)=ON         /* SELECTED                      */
*           THEN                                                   0326
         LR    @08,I                                               0326
         SLA   @08,2                                               0326
         L     @03,@PC00001+4                                      0326
         L     @03,CPTF(,@03)                                      0326
         L     @03,ICTPCHN(,@03)                                   0326
         AL    @03,@CF02030                                        0326
         L     @08,ICTIXPF(@08,@03)                                0326
         TM    ICTMISEL(@08),B'10000000'                           0326
         BNO   @RF00326                                            0326
*           CALL ASSEMCHK;          /* CHECK AND SELECT ASSEMBLY   0327
*                                      ENTRIES FOR SELECTED MACRO  0327
*                                      UPDATE                        */
         BAL   @14,ASSEMCHK                                        0327
*         IF ICTMISEL(1)=ON         /* STILL SELECTED                */
*           THEN                                                   0328
@RF00326 LR    @08,I                                               0328
         SLA   @08,2                                               0328
         L     @03,@PC00001+4                                      0328
         L     @03,CPTF(,@03)                                      0328
         L     @03,ICTPCHN(,@03)                                   0328
         AL    @03,@CF02030                                        0328
         L     @08,ICTIXPF(@08,@03)                                0328
         TM    ICTMISEL(@08),B'10000000'                           0328
         BNO   @RF00328                                            0328
*           DO;                                                    0329
*                                                                  0329
*             /*******************************************************/
*             /*                                                     */
*             /* MACRO ELEMENT SELECTED ... ELIMINATE ANY ++MOD ICT  */
*             /* ENTRIES FROM THE "CURRENT" SYSMOD FOR THE SELECTED  */
*             /* ASSEMBLIES                                          */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0330
*             RESPECIFY                                            0330
*               ICTASMLS BASED(ICTMACHN(1));/* ADDRESS LIST OF ASSEM
*                                      ADDRESSES                     */
*                                                                  0330
*             /*******************************************************/
*             /*                                                     */
*             /* GO THRU ALL REQUIRED ASSEMBLIES                     */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0331
*             DO J=1 BY 1 WHILE ICTASMND(J)^=ICTENDIX;             0331
         LA    J,1                                                 0331
         B     @DE00331                                            0331
@DL00331 DS    0H                                                  0332
*               IF ICTASMAD(J)->ICTMISEL(1)=ON/* SELECTED ASSEM      */
*                 THEN                                             0332
         LR    @08,J                                               0332
         SLA   @08,2                                               0332
         LR    @15,I                                               0332
         SLA   @15,2                                               0332
         L     @14,@PC00001+4                                      0332
         L     @01,CPTF(,@14)                                      0332
         L     @01,ICTPCHN(,@01)                                   0332
         AL    @01,@CF02030                                        0332
         L     @01,ICTIXPF(@15,@01)                                0332
         MVC   @TF00001(4),ICTMACHN(@01)                           0332
         L     @01,@TF00001                                        0332
         AL    @01,@CF02030                                        0332
         L     @08,ICTASMAD(@08,@01)                               0332
         TM    ICTMISEL(@08),B'10000000'                           0332
         BNO   @RF00332                                            0332
*                 CALL ELIMMOD(ICTASMAD(J)->ICTMNAME(1));/* ELIMINATE
*                                      ANY ASSOC. ++MOD ENTRY        */
         ST    @08,@AL00001                                        0333
         LA    @01,@AL00001                                        0333
         BAL   @14,ELIMMOD                                         0333
*             END;                                                 0334
@RF00332 AH    J,@CH00067                                          0334
@DE00331 LR    @08,J                                               0334
         SLA   @08,2                                               0334
         LR    @15,I                                               0334
         SLA   @15,2                                               0334
         L     @14,@PC00001+4                                      0334
         L     @01,CPTF(,@14)                                      0334
         L     @01,ICTPCHN(,@01)                                   0334
         AL    @01,@CF02030                                        0334
         L     @01,ICTIXPF(@15,@01)                                0334
         MVC   @TF00001(4),ICTMACHN(@01)                           0334
         L     @01,@TF00001                                        0334
         AL    @01,@CF02030                                        0334
         L     @08,ICTASMND(@08,@01)                               0334
         CL    @08,ICTENDIX                                        0334
         BNE   @DL00331                                            0334
*           END;                                                   0335
*         IF ICTMISEL(1)=OFF        /* MACRO UPDATE NOT SELECTED     */
*             &ICTMMIDE(1)=ON       /* DUE TO ID CHECK ERROR         */
*           THEN                                                   0336
@RF00328 LR    @08,I                                               0336
         SLA   @08,2                                               0336
         L     @03,@PC00001+4                                      0336
         L     @03,CPTF(,@03)                                      0336
         L     @03,ICTPCHN(,@03)                                   0336
         AL    @03,@CF02030                                        0336
         L     @08,ICTIXPF(@08,@03)                                0336
         TM    ICTMMIDE(@08),B'00001000'                           0336
         BNO   @RF00336                                            0336
         TM    ICTMISEL(@08),B'10000000'                           0336
         BNZ   @RF00336                                            0336
*           CALL ASSEMSEL(ICTMOD(1),/* "CURRENT" ELEMENT             */
*               RESET);             /* CLEAR ICTMISEL IN ASSEM     0337
*                                      ENTIRES                       */
         ST    @08,@AL00001                                        0337
         LA    @08,@CC01748                                        0337
         ST    @08,@AL00001+4                                      0337
         LA    @01,@AL00001                                        0337
         BAL   @14,ASSEMSEL                                        0337
*       END;                        /* END MACUPD UPDATE ELEM.       */
@RF00336 DS    0H                                                  0339
*   END;                            /* END ICTIXP LOOP               */
@RF00319 AH    I,@CH00067                                          0339
@DE00317 LR    @08,I                                               0339
         SLA   @08,2                                               0339
         L     @03,@PC00001+4                                      0339
         L     @03,CPTF(,@03)                                      0339
         L     @03,ICTPCHN(,@03)                                   0339
         AL    @03,@CF02030                                        0339
         L     @08,ICTIXP(@08,@03)                                 0339
         CL    @08,ICTENDIX                                        0339
         BNE   @DL00317                                            0339
*                                                                  0340
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS MOD REPLACEMENT ELEMENTS FROM "CURRENT" SYSMOD        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*   RESPECIFY                                                      0340
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */
*   RESPECIFY                                                      0341
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN
*                                      PTR ARRAY FOR "CURRENT" PTF 0341
*                                      ENTRY                         */
*                                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0342
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0342
         LA    I,1                                                 0342
         B     @DE00342                                            0342
@DL00342 DS    0H                                                  0343
*     RESPECIFY                                                    0343
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"
*                                      SYSMOD                        */
*     IF(ICTMMOD(1)=ON              /* MOD REPLACEMENT ELEMENT       */
*         &ICTMASM(1)=OFF)          /* ... NOT ASSEM ENTRY           */
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */
*       THEN                                                       0344
         LR    @08,I                                               0344
         SLA   @08,2                                               0344
         L     @03,@PC00001+4                                      0344
         L     @03,CPTF(,@03)                                      0344
         L     @03,ICTPCHN(,@03)                                   0344
         AL    @03,@CF02030                                        0344
         L     @08,ICTIXPF(@08,@03)                                0344
         TM    ICTMMOD(@08),B'10000000'                            0344
         BNO   @RF00344                                            0344
         TM    ICTMASM(@08),B'01000000'                            0344
         BNZ   @RF00344                                            0344
         TM    ICTMSELM(@08),B'00100000'                           0344
         BNZ   @RF00344                                            0344
*       DO;                                                        0345
*                                                                  0345
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS MOD REPLACEMENT ELEMENT                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0346
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */
         XC    SELEXCL(2),SELEXCL                                  0346
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */
         ST    @08,CMOD                                            0347
*         VPART#1=MSGMOD;           /* ELEMENT TYPE FOR ERRMSG       */
         MVC   VPART#1(8),@CC01823                                 0348
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */
         MVC   VPART#2(8),ICTMNAME(@08)                            0349
*         CALL REPELEM;             /* PROCESS REPLACEMENT ELEMENTS  */
         BAL   @14,REPELEM                                         0350
*       END;                        /* END MOD/MAC REPLACEMENT ELEM. */
*   END;                            /* END ICTIXP LOOP               */
@RF00344 AH    I,@CH00067                                          0352
@DE00342 LR    @08,I                                               0352
         SLA   @08,2                                               0352
         L     @03,@PC00001+4                                      0352
         L     @03,CPTF(,@03)                                      0352
         L     @03,ICTPCHN(,@03)                                   0352
         AL    @03,@CF02030                                        0352
         L     @08,ICTIXP(@08,@03)                                 0352
         CL    @08,ICTENDIX                                        0352
         BNE   @DL00342                                            0352
*                                                                  0353
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ZAP UPDATE ELEMENTS FROM "CURRENT" SYSMOD             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0353
*   RESPECIFY                                                      0353
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */
*   RESPECIFY                                                      0354
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN
*                                      PTR ARRAY FOR "CURRENT" PTF 0354
*                                      ENTRY                         */
*                                                                  0354
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*   DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                         0355
         LA    I,1                                                 0355
         B     @DE00355                                            0355
@DL00355 DS    0H                                                  0356
*     RESPECIFY                                                    0356
*       ICTMOD BASED(ICTIXPF(I));   /* ADDRESS ELEMENT FROM "CURRENT"
*                                      SYSMOD                        */
*     IF ICTMZAP(1)=ON              /* MOD UPDATE ELEMENT            */
*         &ICTMSELM(1)=OFF          /* NOT ELIMINATED                */
*       THEN                                                       0357
         LR    @08,I                                               0357
         SLA   @08,2                                               0357
         L     @03,@PC00001+4                                      0357
         L     @03,CPTF(,@03)                                      0357
         L     @03,ICTPCHN(,@03)                                   0357
         AL    @03,@CF02030                                        0357
         L     @08,ICTIXPF(@08,@03)                                0357
         TM    ICTMZAP(@08),B'00100000'                            0357
         BNO   @RF00357                                            0357
         TM    ICTMSELM(@08),B'00100000'                           0357
         BNZ   @RF00357                                            0357
*       DO;                                                        0358
*                                                                  0358
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS ZAP ELEMENT                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0359
*         SELEXCL=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */
         XC    SELEXCL(2),SELEXCL                                  0359
*         CMOD=ADDR(ICTMOD(1));     /* SET PTR TO "CURRENT" ELEMENT  */
         ST    @08,CMOD                                            0360
*         VPART#1=MSGZAP;           /* ELEMENT TYPE FOR ERRMSG       */
         MVC   VPART#1(8),@CC01825                                 0361
*         VPART#2=ICTMNAME(1);      /* ELEMENT NAME FOR ERRMSG       */
         MVC   VPART#2(8),ICTMNAME(@08)                            0362
*         CALL ZAPCHK;              /* CHECK FOR ANOTHER ZAP TO THE
*                                      SAME ELEMENT                  */
         BAL   @14,ZAPCHK                                          0363
*         IF MULTIZAP=OFF           /* NO OTHER SELECTED ZAP         */
*           THEN                                                   0364
         TM    MULTIZAP,B'00000010'                                0364
         BNZ   @RF00364                                            0364
*           CALL UPDELEM;           /* PROCESS UPDATE ELEMENTS       */
         BAL   @14,UPDELEM                                         0365
*         IF ICTMISEL(1)=ON         /* ZAP SELECTED                  */
*           THEN                                                   0366
@RF00364 LR    @08,I                                               0366
         SLA   @08,2                                               0366
         L     @03,@PC00001+4                                      0366
         L     @03,CPTF(,@03)                                      0366
         L     @03,ICTPCHN(,@03)                                   0366
         AL    @03,@CF02030                                        0366
         L     @08,ICTIXPF(@08,@03)                                0366
         TM    ICTMISEL(@08),B'10000000'                           0366
         BNO   @RF00366                                            0366
*           CALL XPNDSEL;           /* SELECT ANY ASSOC EXPANDS      */
         BAL   @14,XPNDSEL                                         0367
*       END;                        /* END ZAP ELEMENT               */
@RF00366 DS    0H                                                  0369
*   END;                            /* END ICTIXP LOOP               */
@RF00357 AH    I,@CH00067                                          0369
@DE00355 LR    @08,I                                               0369
         SLA   @08,2                                               0369
         L     @03,@PC00001+4                                      0369
         L     @03,CPTF(,@03)                                      0369
         L     @03,ICTPCHN(,@03)                                   0369
         AL    @03,@CF02030                                        0369
         L     @08,ICTIXP(@08,@03)                                 0369
         CL    @08,ICTENDIX                                        0369
         BNE   @DL00355                                            0369
*                                                                  0370
*   /*****************************************************************/
*   /*                                                               */
*   /* ELEMENT SELECTION PROCESSING COMPLETE FOR "CURRENT" SYSMOD    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0370
*   IF HIGHTMS>=STOPPTF THEN                                       0370
         CH    HIGHTMS,@CH00059                                    0370
         BL    @RF00370                                            0370
*     DO;                                                          0371
*                                                                  0371
*       /*************************************************************/
*       /*                                                           */
*       /* "CURRENT" SYSMOD TERMINATED ... CLEANUP ICT MOD SECTION   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0372
*       RESPECIFY                                                  0372
*         ICTPTF BASED(CPTF);       /* ADDRESS "CURRENT" SYSMOD      */
*                                                                  0372
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL ELEMENTS IN THE CURRENT SYSMOD                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0373
*       DO J=1 BY 1 WHILE ICTIXP(J)^=ICTENDIX;                     0373
         LA    J,1                                                 0373
         B     @DE00373                                            0373
@DL00373 DS    0H                                                  0374
*         RESPECIFY                                                0374
*           ICTMOD BASED(ICTIXP(J));/* ADDRESS MOD SECTION ENTRIES 0374
*                                      ASSOCIATED WITH THE "CURRENT"
*                                      SYSMOD                        */
*         ICTMISEL(1)=OFF;          /* TURN OFF SELECT FLAG          */
         LR    @08,J                                               0375
         SLA   @08,2                                               0375
         L     @02,@PC00001+4                                      0375
         L     @02,CPTF(,@02)                                      0375
         L     @02,ICTPCHN(,@02)                                   0375
         AL    @02,@CF02030                                        0375
         L     @08,ICTIXP(@08,@02)                                 0375
         NI    ICTMISEL(@08),B'01111111'                           0375
*       END;                                                       0376
         AH    J,@CH00067                                          0376
@DE00373 LR    @08,J                                               0376
         SLA   @08,2                                               0376
         L     @02,@PC00001+4                                      0376
         L     @02,CPTF(,@02)                                      0376
         L     @02,ICTPCHN(,@02)                                   0376
         AL    @02,@CF02030                                        0376
         L     @08,ICTIXP(@08,@02)                                 0376
         CL    @08,ICTENDIX                                        0376
         BNE   @DL00373                                            0376
*     END;                                                         0377
*   IF HIGHTMS<STOPPTF THEN                                        0378
@RF00370 CH    HIGHTMS,@CH00059                                    0378
         BNL   @RF00378                                            0378
*     DO;                                                          0379
*                                                                  0379
*       /*************************************************************/
*       /*                                                           */
*       /* "CURRENT" SYSMOD SUCCESSFUL ... SORT OUT ELEMENTS IN THIS */
*       /* AND OTHER SYSMODS                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0380
*       RESPECIFY                                                  0380
*         ICTMOD BASED(CCAICMOD);   /* ADDRESS ENTIRE ICT MOD SECT   */
*                                                                  0380
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU THE ENTIRE ICT MOD SECTION (INDEX J)              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0381
*       DO J=1 BY 1 WHILE ICTMEND(J)^=ICTENDNT;                    0381
         LA    J,1                                                 0381
         B     @DE00381                                            0381
@DL00381 DS    0H                                                  0382
*         IF ICTMISEL(J)=ON         /* SELECTED ELEMENT              */
*             &ICTPPTR(J)=CPTF      /* FROM "CURRENT" SYSMOD         */
*           THEN                                                   0382
         LR    @08,J                                               0382
         MH    @08,@CH02013                                        0382
         L     @02,CCAICMOD(,CCAPTR)                               0382
         ST    @08,@TF00001                                        0382
         ALR   @08,@02                                             0382
         AL    @08,@CF02033                                        0382
         TM    ICTMISEL-11(@08),B'10000000'                        0382
         BNO   @RF00382                                            0382
         L     @08,@PC00001+4                                      0382
         L     @01,@TF00001                                        0382
         AL    @01,@CF02034                                        0382
         L     @15,ICTPPTR-96(@01,@02)                             0382
         C     @15,CPTF(,@08)                                      0382
         BNE   @RF00382                                            0382
*           DO;                                                    0383
*                                                                  0383
*             /*******************************************************/
*             /*                                                     */
*             /* INDEX J - SELECTED ELEMENT FROM "CURRENT" SYSMOD    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0384
*             ICTMTSEL(J)=ON;       /* SET TRANSIENT SELECT FLAG     */
*                                                                  0384
         AL    @02,@TF00001                                        0384
         AL    @02,@CF02033                                        0384
         OI    ICTMTSEL-11(@02),B'00000010'                        0384
*             /*******************************************************/
*             /*                                                     */
*             /* GO THRU THE ENTIRE ICT MOD SECTION (INDEX I)        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0385
*             DO I=1 BY 1 WHILE ICTMEND(I)^=ICTENDNT;              0385
         LA    I,1                                                 0385
         B     @DE00385                                            0385
@DL00385 DS    0H                                                  0386
*               IF ICTMNAME(I)=ICTMNAME(J)/* NAMES THE SAME          */
*                   &I^=J           /* NOT SELF                      */
*                   &ICTPPTR(I)^=CPTF/* NOT FROM "CURRENT" SYSMOD    */
*                   &ICTMISEL(I)=ON /* "OTHER" IS SELECTED           */
*                 THEN                                             0386
         LA    @08,144                                             0386
         LR    @01,I                                               0386
         MR    @00,@08                                             0386
         L     @15,CCAICMOD(,CCAPTR)                               0386
         LR    @07,@08                                             0386
         MR    @06,J                                               0386
         ST    @01,@TF00001                                        0386
         ALR   @01,@15                                             0386
         AL    @01,@CF02036                                        0386
         ST    @07,@TF00002                                        0386
         ALR   @07,@15                                             0386
         AL    @07,@CF02036                                        0386
         CLC   ICTMNAME(8,@01),ICTMNAME(@07)                       0386
         BNE   @RF00386                                            0386
         CR    I,J                                                 0386
         BE    @RF00386                                            0386
         L     @08,@PC00001+4                                      0386
         L     @14,@TF00001                                        0386
         AL    @14,@CF02034                                        0386
         L     @14,ICTPPTR-96(@14,@15)                             0386
         C     @14,CPTF(,@08)                                      0386
         BE    @RF00386                                            0386
         LR    @08,@15                                             0386
         AL    @08,@TF00001                                        0386
         AL    @08,@CF02033                                        0386
         TM    ICTMISEL-11(@08),B'10000000'                        0386
         BNO   @RF00386                                            0386
*                 DO;                                              0387
*                                                                  0387
*                   /*************************************************/
*                   /*                                               */
*                   /* INDEX I - PREVIOUSLY SELECTED ELEMENT FROM    */
*                   /* ANOTHER SYSMOD                                */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0388
*                   CALL INTRSECT(ADDR(ICTMOD(J)),/* "CURRENT" ELEM  */
*                       ADDR(ICTMOD(I)),/* "OTHER" ELEMENT           */
*                       ITYPE);     /* INTERSECTION TYPE             */
         L     @08,@TF00002                                        0388
         AL    @08,@CF02036                                        0388
         LA    @08,ICTMOD(@08,@15)                                 0388
         ST    @08,@AFTEMPS+8                                      0388
         L     @08,@TF00001                                        0388
         AL    @15,@CF02036                                        0388
         LA    @08,ICTMOD(@08,@15)                                 0388
         ST    @08,@AFTEMPS+12                                     0388
         LA    @01,@AL00388                                        0388
         BAL   @14,INTRSECT                                        0388
*                   IF ITYPE=REPREP /* REPLACEMENT TO REPLACEMENT    */
*                       ×ITYPE=REPUPD/* REPLACEMENT TO UPDATE        */
*                       ×(ITYPE=SRCMOD/* SRC REPLACEMENT TO MOD      */
*                       &ICTMASOC(J)=OFF)/* ... NO ASSOC. ++MOD      */
*                       ×(ITYPE=SRCUMOD/* SRC UPDATE TO MOD          */
*                       &ICTMASOC(J)=OFF)/* ... NO ASSOC. ++MOD      */
*                       ×(ITYPE=MODSRC/* MOD REPLACEMENT TO SRC      */
*                       &ICTMASOC(J)=OFF)/* .. NO ASSOC. ++SRC/SRCUPD*/
*                       ×(ITYPE=MODSRCU/* MOD REPLACEMENT TO SRCUPD  */
*                       &ICTMASOC(J)=OFF)/* .. NO ASSOC. ++SRC/SRCUPD*/
*                       ×ITYPE=MODXPND/* MOD REPLACEMENT TO EXPAND   */
*                     THEN                                         0389
         CLI   ITYPE,1                                             0389
         BE    @RT00389                                            0389
         CLI   ITYPE,2                                             0389
         BE    @RT00389                                            0389
         CLI   ITYPE,16                                            0389
         BNE   @GL00020                                            0389
         LR    @08,J                                               0389
         MH    @08,@CH02013                                        0389
         L     @01,CCAICMOD(,CCAPTR)                               0389
         ALR   @01,@08                                             0389
         AL    @01,@CF02033                                        0389
         TM    ICTMASOC-11(@01),B'00010000'                        0389
         BZ    @RT00389                                            0389
@GL00020 CLI   ITYPE,32                                            0389
         BNE   @GL00019                                            0389
         LR    @08,J                                               0389
         MH    @08,@CH02013                                        0389
         L     @01,CCAICMOD(,CCAPTR)                               0389
         ALR   @01,@08                                             0389
         AL    @01,@CF02033                                        0389
         TM    ICTMASOC-11(@01),B'00010000'                        0389
         BZ    @RT00389                                            0389
@GL00019 CLI   ITYPE,64                                            0389
         BNE   @GL00018                                            0389
         LR    @08,J                                               0389
         MH    @08,@CH02013                                        0389
         L     @01,CCAICMOD(,CCAPTR)                               0389
         ALR   @01,@08                                             0389
         AL    @01,@CF02033                                        0389
         TM    ICTMASOC-11(@01),B'00010000'                        0389
         BZ    @RT00389                                            0389
@GL00018 CLI   ITYPE,128                                           0389
         BNE   @GL00017                                            0389
         LR    @08,J                                               0389
         MH    @08,@CH02013                                        0389
         L     @01,CCAICMOD(,CCAPTR)                               0389
         ALR   @01,@08                                             0389
         AL    @01,@CF02033                                        0389
         TM    ICTMASOC-11(@01),B'00010000'                        0389
         BZ    @RT00389                                            0389
@GL00017 CLI   ITYPE,129                                           0389
         BNE   @RF00389                                            0389
@RT00389 DS    0H                                                  0390
*                     DO;                                          0390
*                                                                  0390
*                       /*********************************************/
*                       /*                                           */
*                       /* GET RID OF PREVIOUSLY SELECTED VERSION    */
*                       /* (EXCEPT ASSEM ENTRIES) AND WRK DATASET    */
*                       /* MEMBER                                    */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0391
*                       ICTMISEL(I)=OFF;/* CLEAR SELECT FLAG         */
         LR    @08,I                                               0391
         MH    @08,@CH02013                                        0391
         L     @15,CCAICMOD(,CCAPTR)                               0391
         ST    @08,@TF00001                                        0391
         ALR   @08,@15                                             0391
         AL    @08,@CF02033                                        0391
         NI    ICTMISEL-11(@08),B'01111111'                        0391
*                       CALL SCRWRKX(ICTMOD(I));/* SCRATCH PREV.   0392
*                                      VERSION ON WRK DATASET        */
         L     @08,@TF00001                                        0392
         AL    @15,@CF02036                                        0392
         LA    @08,ICTMOD(@08,@15)                                 0392
         ST    @08,@AL00001                                        0392
         LA    @01,@AL00001                                        0392
         BAL   @14,SCRWRKX                                         0392
*                     END;                                         0393
*                   IF ITYPE=UPDUPD /* UPDATE TO UPDATE              */
*                       ×ITYPE=UPDREP/* UPDATE TO REPLACEMENT        */
*                     THEN                                         0394
@RF00389 CLI   ITYPE,8                                             0394
         BE    @RT00394                                            0394
         CLI   ITYPE,4                                             0394
         BNE   @RF00394                                            0394
@RT00394 DS    0H                                                  0395
*                     ICTMFMID(I)=ICTMFMID(J);/* SET FMID OF PREVIOUS
*                                      ELEMENT TO FMID OF ELEMENT  0395
*                                      FROM "CURRENT" SYSMOD         */
         LA    @08,144                                             0395
         LR    @01,I                                               0395
         MR    @00,@08                                             0395
         L     @15,CCAICMOD(,CCAPTR)                               0395
         ALR   @01,@15                                             0395
         AL    @01,@CF02037                                        0395
         LR    @07,@08                                             0395
         MR    @06,J                                               0395
         ALR   @15,@07                                             0395
         AL    @15,@CF02037                                        0395
         MVC   @TS00001(7),ICTMFMID-88(@15)                        0395
         MVC   ICTMFMID-88(7,@01),@TS00001                         0395
*                 END;                                             0396
@RF00394 DS    0H                                                  0397
*             END;                  /* END OF "GO THRU THE ENTIRE ICT
*                                      MOD SECTION (INDEX I)"        */
@RF00386 AH    I,@CH00067                                          0397
@DE00385 LR    @08,I                                               0397
         MH    @08,@CH02013                                        0397
         L     @01,CCAICMOD(,CCAPTR)                               0397
         ALR   @01,@08                                             0397
         AL    @01,@CF02036                                        0397
         MVC   @TF00001(4),ICTMEND(@01)                            0397
         L     @08,@TF00001                                        0397
         CL    @08,ICTENDNT                                        0397
         BNE   @DL00385                                            0397
*           END;                    /* END OF "A SELECTED ELEMENT  0398
*                                      FROM THE CURRENT SYSMOD"      */
*       END;                        /* END OF "GO THRU THE ENTIRE ICT
*                                      MOD SECTION"                  */
*                                                                  0399
@RF00382 AH    J,@CH00067                                          0399
@DE00381 LR    @08,J                                               0399
         MH    @08,@CH02013                                        0399
         L     @02,CCAICMOD(,CCAPTR)                               0399
         ALR   @02,@08                                             0399
         AL    @02,@CF02036                                        0399
         MVC   @TF00001(4),ICTMEND(@02)                            0399
         L     @08,@TF00001                                        0399
         CL    @08,ICTENDNT                                        0399
         BNE   @DL00381                                            0399
*       /*************************************************************/
*       /*                                                           */
*       /* THE SELECT AND DELETE FLAGS IN ALL ICT MOD SECTION ENTRIES*/
*       /* FOR THE "CURRENT" SYSMOD AND INTERSECTED-WITH SYSMODS HAVE*/
*       /* BEEN APPROPRIATELY SET                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0400
*     END;                          /* END "CURRENT" SYSMOD        0400
*                                      SUCCESSFUL                    */
*                                                                  0401
*/********************************************************************/
*/*                                                                  */
*/*  AT THIS POINT,                                                  */
*/*                                                                  */
*/*    1. THERE WILL BE NO MORE THAN ONE SELECTED ++MOD, ++MAC,      */
*/*       ++SRC REPLACEMENT-TYPE ICT MOD SECTION ENTRY FOR ANY       */
*/*       ONE ELEMENT.                                               */
*/*                                                                  */
*/*    2. THERE MAY BE MULTIPLE SELECTED ++MACUPD, ++SRCUPD UPDATE-  */
*/*       TYPE ICT MOD SECTION ENTRIES FOR AN ELEMENT.               */
*/*                                                                  */
*/*    3. THERE MAY BE MULTIPLE SELECTED ASSEMBLY MOD SECTION        */
*/*       ENTRIES WHICH REPRESENT ASSEMBLIES FOR AN ELEMENT          */
*/*       CAUSED BY SOURCE AND MACRO MODIFICATIONS.  ALL OF THESE    */
*/*       ASSEMBLIES WILL BE FOR THE SAME SYSMOD.                    */
*/*                                                                  */
*/*       - THERE MAY BE A SELECTED ++MOD ICT MOD SECTION ENTRY      */
*/*         FOR THIS SAME ELEMENT IF THE SYSMOD SUPPLIED BOTH        */
*/*         A ++MOD AND A ++SRC/++SRCUPD FOR THE ELEMENT.            */
*/*                                                                  */
*/*       - THE RMID (ICTMRMID) OF THESE ASSEMBLY ENTRIES IS THE     */
*/*         SYSMOD WHICH WAS PROCESSED.                              */
*/*                                                                  */
*/*       - SOME OF THESE MAY BE ELIMINATED DURING THE PROCESSING    */
*/*         OF SUBSEQUENT SYSMODS.                                   */
*/*                                                                  */
*/*       - THE FMID OWNERSHIP OF THESE ASSEMBLY ENTRIES (ICTMFMID)  */
*/*         HAS BEEN ESTABLISHED (SEE ASSEMCHK PROCEDURE).           */
*/*                                                                  */
*/*    -----------------------------------------------------------   */
*/*                                                                  */
*/*  PROCESSING REQUIRED IN HMASMTMD AFTER ALL SYSMODS HAVE BEEN     */
*/*  PROCESSED:                                                      */
*/*                                                                  */
*/*    1. IF THERE IS A SELECTED ++MOD MOD SECTION ENTRY FOR AN      */
*/*       ELEMENT, ALL SELECTED ASSEMBLY MOD SECTION ENTRIES FOR     */
*/*       THE SAME ELEMENT MAY BE ELIMINATED.                        */
*/*                                                                  */
*/*    2. IF MORE THAN ONE SELECTED ASSEMBLY MOD SECTION ENTRY       */
*/*       EXISTS FOR THE SAME ELEMENT, THEY ALL HAVE BEEN CAUSED     */
*/*       BY THE SAME SYSMOD.  ALL BUT ONE OF THESE MAY BE           */
*/*       ELIMINATED.                                                */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0401
*   RETURN CODE(HIGHTMS);           /* RETURN TO CALLER              */
@RF00378 LR    @15,HIGHTMS                                         0401
         L     @13,4(,@13)                                         0401
         L     @14,12(,@13)                                        0401
         LM    @00,@12,20(@13)                                     0401
         BR    @14                                                 0401
*                                                                  0402
*/********************************************************************/
*/*                                                                  */
*/*    REPELEM  - PROCESS ++MOD, ++MAC, ++SRC AND ASSEMBLY           */
*/*               REPLACEMENT ELEMENTS                               */
*/*                                                                  */
*/*      - FOR ++MOD, ++MAC AND ++SRC ELEMENTS, DETERMINE WHETHER    */
*/*        THE ELEMENT SHOULD BE SELECTED OF EXCLUDED AS FOLLOWS:    */
*/*                                                                  */
*/*                                                                  */
*/*          VERSION    RMID CHECK    UMID CHECK       RESULT        */
*/*          --------   ----------    ----------     ------------    */
*/*                                                                  */
*/*             Y           -             -            SELECT        */
*/*             N           Y             Y            SELECT        */
*/*             N           N             -            IDERROR *     */
*/*             N           -             N            IDERROR *     */
*/*                                                                  */
*/*         * UNLESS "CURRENT" SYSMOD IS BEING                       */
*/*           RE-INSTALLED AND THE TARGET SYSTEM IS FOUND            */
*/*           TO BE "UP-LEVEL".  IF THE TARGET SYSTEM IS             */
*/*           "UP-LEVEL", EXCLUDE THE ELEMENT.                       */
*/*                                                                  */
*/*         . CHECK THE BYPASS OPTIONS IF AN ID CHECK ERROR IS       */
*/*           DETECTED.  ISSUE HMA319I FOR RMID ID CHECK ERRORS      */
*/*           AND CALL UMIDCHK TO ISSUE HMA319I MESSAGES FOR UMID    */
*/*           ID CHECK ERRORS.                                       */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                  (MOD, MAC OR SRC REPLACEMENT)                   */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * ICTMISEL - '1' IF ELEMENT SHOULD BE SELECTED               */
*/*                  '0' IF ELEMENT SHOULD NOT BE SELECTED           */
*/*                                                                  */
*/*     * ICTMMIDE - '1' IF ID CHECK ERROR DETECTED (EVEN IF BYPASSD)*/
*/*                  '0' NO ID CHECK ERROR                           */
*/*                                                                  */
*/*     * ASMREQD  - SET FOR ASSEMBLY ENTRY PASSED IF THE RMID       */
*/*                  OF THE LAST-SELECTED MOD ELEMENT IS NOT PRED    */
*/*                  OR SUPD AND THE LAST-SELECTED MOD ELEMENT       */
*/*                  IS ITSELF THE RESULT OF AN ASSEMBLY             */
*/*                                                                  */
*/*     * EXCLUDED - SET IF ELEMENT SHOULD BE EXCLUDED               */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0402
*REPELEM:                                                          0402
*   PROC;                                                          0402
REPELEM  STM   @14,@04,@SA00002                                    0402
         STM   @06,@12,@SA00002+28                                 0402
*   RESPECIFY                                                      0403
*     ICTMOD BASED(CMOD);           /* ADDRESS "CURRENT" ELEMENT     */
*   RESPECIFY                                                      0404
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" SYSMOD      */
*   SELEXCL=''B;                    /* CLEAR PROCESSING FLAGS        */
         XC    SELEXCL(2),SELEXCL                                  0405
*   REPFLG=ON;                      /* PROCESSING REPLACEMENT ELEMENT*/
*                                                                  0406
         OI    REPFLG,B'00001000'                                  0406
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE THE FMID AND RMID OF THE LAST SELECTED VERSION OF   */
*   /* THE "CURRENT" ELEMENT                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*   CALL GETMIDS;                   /* GET MODIDS ASSOCIATED WITH THE
*                                      LAST SELECTED VERSION OF THE
*                                      "CURRENT" ELEMENT             */
         BAL   @14,GETMIDS                                         0407
*   IF(LASTFMID^=NULLPTF#           /* THERE IS A "LAST" FMID        */
*       &ICTMFMID(1)^=LASTFMID)     /* .. AND ELEMENT-FMID'S DIFFER  */
*     THEN                                                         0408
         CLC   LASTFMID(7),@CC01719                                0408
         BE    @RF00408                                            0408
         L     @08,CMOD                                            0408
         CLC   ICTMFMID(7,@08),LASTFMID                            0408
         BE    @RF00408                                            0408
*     DO;                                                          0409
*                                                                  0409
*       /*************************************************************/
*       /*                                                           */
*       /* "CURRENT" ELEMENT AND "LAST-REPLACEMENT" HAVE DIFFERENT   */
*       /* FMIDS                                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0410
*       CALL VERSION;               /* SELECT/EXCLUDE PROCESSING     */
         BAL   @14,VERSION                                         0410
*       IF VERSIOND=ON THEN                                        0411
         TM    VERSIOND,B'00010000'                                0411
         BNO   @RF00411                                            0411
*         DO;                                                      0412
*           ICTMISEL(1)=ON;         /* SELECT "CURRENT" ELEMENT      */
         L     @08,CMOD                                            0413
         OI    ICTMISEL(@08),B'10000000'                           0413
*           ICTMICHN(1)=TBLXNULL;   /* CLEAR (A)CDS MODID LIST       */
         L     @15,@PC00001                                        0414
         MVC   ICTMICHN(4,@08),TBLXNULL(@15)                       0414
*         END;                                                     0415
*       ELSE                                                       0416
*         EXCLUDED=ON;              /* EXCLUDE "CURRENT" ELEMENT     */
         B     @RC00411                                            0416
@RF00411 OI    EXCLUDED,B'00001000'                                0416
*       SELDONE=ON;                 /* SELECTION PROCESSING DONE     */
@RC00411 OI    SELDONE,B'10000000'                                 0417
*     END;                                                         0418
*   IF(LASTFMID=NULLPTF#            /* THERE IS NO "LAST" FMID       */
*       &LASTRMID=NULLPTF#)         /* .. AND THERE IS NO "LAST" RMID*/
*     THEN                                                         0419
@RF00408 CLC   LASTFMID(7),@CC01719                                0419
         BNE   @RF00419                                            0419
         CLC   LASTRMID(7),@CC01719                                0419
         BNE   @RF00419                                            0419
*     DO;                                                          0420
*                                                                  0420
*       /*************************************************************/
*       /*                                                           */
*       /* THERE IS NO PREVIOUSLY SELECTED VERSION OF THIS ELEMENT   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0421
*       ICTMISEL(1)=ON;             /* SELECT "CURRENT" ELEMENT      */
         L     @08,CMOD                                            0421
         OI    ICTMISEL(@08),B'10000000'                           0421
*       ICTMICHN(1)=TBLXNULL;       /* CLEAR (A)CDS MODID LIST       */
         L     @15,@PC00001                                        0422
         MVC   ICTMICHN(4,@08),TBLXNULL(@15)                       0422
*       SELDONE=ON;                 /* SELECTION PROCESSING DONE     */
         OI    SELDONE,B'10000000'                                 0423
*     END;                                                         0424
*   IF SELDONE=OFF                  /* SELECTION PROCESSING NOT DONE */
*     THEN                                                         0425
@RF00419 TM    SELDONE,B'10000000'                                 0425
         BNZ   @RF00425                                            0425
*     DO;                                                          0426
*                                                                  0426
*       /*************************************************************/
*       /*                                                           */
*       /* "CURRENT" ELEMENT AND "LAST-REPLACEMENT" HAVE SAME FMIDS  */
*       /* ... OR THE "LAST-REPLACEMENT" HAS AN RMID WITH NO FMID    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0427
*       IF ICTPTYPE(1)=IOPPFUNC     /* FUNCTION-TYPE SYSMOD          */
*           &ICTPREDO(1)=ON         /* ... BEING RE-PROCESSED        */
*           &ICTMASM(1)=OFF         /* ELEMENT NOT ASSEM ENTRY       */
*           &LASTFMID^=NULLPTF#     /* ... VALID "LAST" FMID         */
*         THEN                                                     0427
         L     @08,@PC00001+4                                      0427
         L     @08,CPTF(,@08)                                      0427
         CLI   ICTPTYPE(@08),4                                     0427
         BNE   @RF00427                                            0427
         TM    ICTPREDO(@08),B'01000000'                           0427
         BNO   @RF00427                                            0427
         L     @08,CMOD                                            0427
         TM    ICTMASM(@08),B'01000000'                            0427
         BNZ   @RF00427                                            0427
         CLC   LASTFMID(7),@CC01719                                0427
         BE    @RF00427                                            0427
*         DO;                                                      0428
*                                                                  0428
*           /*********************************************************/
*           /*                                                       */
*           /* ELEMENT FROM FUNCTION BEING RE-INSTALLED              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0429
*           CALL UPLEVCHK;          /* CHECK TARGET SYSTEM FOR THIS
*                                      ELEMENT'S RMID/UMID(S)        */
         BAL   @14,UPLEVCHK                                        0429
*           IF UPLEVEL=ON           /* TARGET SYSTEM UPLEVEL         */
*             THEN                                                 0430
         TM    UPLEVEL,B'00000100'                                 0430
         BNO   @RF00430                                            0430
*             EXCLUDED=ON;          /* EXCLUDE "CURRENT" ELEM.       */
         OI    EXCLUDED,B'00001000'                                0431
*         END;                      /* END RE-INSTALL PROCESSING     */
@RF00430 DS    0H                                                  0433
*       IF EXCLUDED=OFF             /* ELEMENT NOT EXCLUDED          */
*         THEN                                                     0433
@RF00427 TM    EXCLUDED,B'00001000'                                0433
         BNZ   @RF00433                                            0433
*         DO;                                                      0434
*           IF ICTMRMID(1)^=LASTRMID/* RMIDS DIFFER                  */
*               &LASTRMID^=NULLPTF# /* ... VALID LAST RMID           */
*             THEN                                                 0435
         L     @08,CMOD                                            0435
         CLC   ICTMRMID(7,@08),LASTRMID                            0435
         BE    @RF00435                                            0435
         CLC   LASTRMID(7),@CC01719                                0435
         BE    @RF00435                                            0435
*             DO;                                                  0436
*                                                                  0436
*               /*****************************************************/
*               /*                                                   */
*               /* ELEMENTS HAVE DIFFERENT RMIDS                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0437
*               IF ICTPFMID(1)^=LASTFMID/* SYSMOD FMID DIFFERS FROM
*                                      ELEMENT'S FMID                */
*                   &ICTMASM(1)=ON  /* FOR AN ELEMENT TO BE ASSEMBLED*/
*                 THEN                                             0437
         L     @04,@PC00001+4                                      0437
         L     @04,CPTF(,@04)                                      0437
         CLC   ICTPFMID(7,@04),LASTFMID                            0437
         BE    @RF00437                                            0437
         TM    ICTMASM(@08),B'01000000'                            0437
         BNO   @RF00437                                            0437
*                 DO;                                              0438
*                                                                  0438
*                   /*************************************************/
*                   /*                                               */
*                   /* SYSMOD FMID DIFFERS FROM THE FMID OF AN       */
*                   /* ELEMENT TO BE ASSEMBLED ... THE ASSEMBLY WAS  */
*                   /* CAUSED BY A MACRO FROM THE "CURRENT" SYSMOD   */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0439
*                   ASMREQD=ON;     /* SET ASSEMBLY REQUIRED FLAG    */
         OI    ASMREQD,B'00010000'                                 0439
*                 END;                                             0440
*               ELSE                                               0441
*                 DO;                                              0441
*                                                                  0441
         B     @RC00437                                            0441
@RF00437 DS    0H                                                  0442
*                   /*************************************************/
*                   /*                                               */
*                   /* THE "CURRENT" SYSMOD MUST BE CHECKED FOR A    */
*                   /* PROPER PRE/SUP RELATIONSHIP WITH THE ELEMENT'S*/
*                   /* "LAST" RMID                                   */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0442
*                   CALL HMASMTPS(CPTF,/* "CURRENT" SYSMOD           */
*                       LASTRMID,   /* LAST RMID SYSMOD              */
*                       TPSRTN);    /* CHECK PRE/SUP                 */
         MVC   @AL00001+4(8),@AL00442                              0442
         L     @08,@PC00001+4                                      0442
         ST    @08,@AL00001                                        0442
         L     @15,@CV01714                                        0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*                   IF TPSRTN^=PRESUP THEN                         0443
         CLI   TPSRTN,232                                          0443
         BE    @RF00443                                            0443
*                     DO;                                          0444
*                       IF ICTMASM(1)=ON/* ELEMENT IS AN ASSEMBLY    */
*                           &LRMIDASM=ON/* LAST RMID RESULT OF ASSM. */
*                         THEN                                     0445
         L     @08,CMOD                                            0445
         TM    ICTMASM(@08),B'01000000'                            0445
         BNO   @RF00445                                            0445
         TM    LRMIDASM,B'10000000'                                0445
         BNO   @RF00445                                            0445
*                         ASMREQD=ON;/* AN ASSEMBLY IS REQUIRED AGAIN*/
         OI    ASMREQD,B'00010000'                                 0446
*                       ELSE                                       0447
*                         IF ICTPREDO(1)=ON/* SYSMOD RE-INSTALLATION */
*                             &ICTPTYPE(1)^=IOPPFUNC/* NON-FCTN.   0447
*                                      SYSMOD                        */
*                           THEN                                   0447
         B     @RC00445                                            0447
@RF00445 L     @08,@PC00001+4                                      0447
         L     @08,CPTF(,@08)                                      0447
         TM    ICTPREDO(@08),B'01000000'                           0447
         BNO   @RF00447                                            0447
         CLI   ICTPTYPE(@08),4                                     0447
         BE    @RF00447                                            0447
*                           EXCLUDED=ON;/* EXCLUDE THE ELEMENT       */
         OI    EXCLUDED,B'00001000'                                0448
*                         ELSE                                     0449
*                           RMIDERR=ON;/* INDICATE RMID CHECK ERROR  */
         B     @RC00447                                            0449
@RF00447 OI    RMIDERR,B'10000000'                                 0449
*                     END;          /* RMID NOT PRE/SUPD             */
@RC00447 DS    0H                                                  0450
@RC00445 DS    0H                                                  0451
*                 END;                                             0451
@RF00443 DS    0H                                                  0452
*             END;                  /* ELEMENTS HAVE DIFFERENT RMIDS */
@RC00437 DS    0H                                                  0453
*           IF EXCLUDED=OFF         /* ELEMENT NOT YET EXCLUDED      */
*             THEN                                                 0453
@RF00435 TM    EXCLUDED,B'00001000'                                0453
         BNZ   @RF00453                                            0453
*             DO;                                                  0454
*                                                                  0454
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK THE "CURRENT" SYSMOD RELATIVE TO ANY UPDATES*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0455
*               IF TBLBPID=ON       /* BYPASS ID CHECK ERRORS        */
*                 THEN                                             0455
         L     @08,@PC00001                                        0455
         L     @08,TBLXTBL(,@08)                                   0455
         TM    TBLBPID(@08),B'10000000'                            0455
         BNO   @RF00455                                            0455
*                 MGPTYPE=MGPWARN;  /* WARNINGS FOR UMID ERRORS      */
         MVI   MGPTYPE,X'02'                                       0456
*               ELSE                                               0457
*                 MGPTYPE=MGPERR;   /* STOP-SYSMOD FOR UMID ERRORS   */
         B     @RC00455                                            0457
@RF00455 MVI   MGPTYPE,X'03'                                       0457
*               IF ICTPREDO(1)=ON   /* SYSMOD RE-INSTALL             */
*                 THEN                                             0458
@RC00455 L     @08,@PC00001+4                                      0458
         L     @08,CPTF(,@08)                                      0458
         TM    ICTPREDO(@08),B'01000000'                           0458
         BNO   @RF00458                                            0458
*                 CALL UMIDCHK(NOMSG);/* CHECK UMIDS (NO MESSAGES)   */
         LA    @01,@AL00459                                        0459
         BAL   @14,UMIDCHK                                         0459
*               ELSE                                               0460
*                 CALL UMIDCHK(MSG);/* CHECK UMIDS (ISSUE MESSAGES)  */
*                                                                  0460
         B     @RC00458                                            0460
@RF00458 LA    @01,@AL00460                                        0460
         BAL   @14,UMIDCHK                                         0460
*               /*****************************************************/
*               /*                                                   */
*               /* DETERMINE SETTING OF ICTMISEL ("SELECT" FLAG)     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0461
*               IF RMIDERR=OFF      /* RMID CHECK SUCCESSFUL         */
*                   &UMIDERR=OFF    /* UMID CHECK SUCCESSFUL         */
*                 THEN                                             0461
@RC00458 TM    RMIDERR,B'11000000'                                 0461
         BNZ   @RF00461                                            0461
*                 ICTMISEL(1)=ON;   /* SELECT ELEMENT - NO ID CHECK  */
         L     @08,CMOD                                            0462
         OI    ICTMISEL(@08),B'10000000'                           0462
*               ELSE                                               0463
*                 DO;                                              0463
         B     @RC00461                                            0463
@RF00461 DS    0H                                                  0464
*                   IF RMIDERR=OFF  /* RMID CHECK SUCCESSFUL         */
*                       &UMIDERR=ON /* UMID CHECK FAILED             */
*                       &ICTPREDO(1)=ON/* SYSMOD BEING RE-INSTALLED  */
*                     THEN                                         0464
         TM    UMIDERR,B'01000000'                                 0464
         BNO   @RF00464                                            0464
         TM    RMIDERR,B'10000000'                                 0464
         BNZ   @RF00464                                            0464
         L     @08,@PC00001+4                                      0464
         L     @08,CPTF(,@08)                                      0464
         TM    ICTPREDO(@08),B'01000000'                           0464
         BNO   @RF00464                                            0464
*                     EXCLUDED=ON;  /* EXCLUDE "CURRENT" ELEMENT     */
         OI    EXCLUDED,B'00001000'                                0465
*                   ELSE                                           0466
*                     IF TBLBPID=ON /* ID CHECK ERRORS BYPASSED      */
*                       THEN                                       0466
         B     @RC00464                                            0466
@RF00464 L     @08,@PC00001                                        0466
         L     @08,TBLXTBL(,@08)                                   0466
         TM    TBLBPID(@08),B'10000000'                            0466
         BNO   @RF00466                                            0466
*                       DO;                                        0467
*                         ICTBYP(1)=ON;/* BYPASS USED FOR SYSMOD     */
         L     @08,@PC00001+4                                      0468
         L     @08,CPTF(,@08)                                      0468
         OI    ICTBYP(@08),B'00000010'                             0468
*                         ICTMISEL(1)=ON;/* SELECT ELEMENT - ID CHECK
*                                      ERROR                         */
         L     @08,CMOD                                            0469
         OI    ICTMISEL(@08),B'10000000'                           0469
*                       END;                                       0470
*                 END;                                             0471
@RF00466 DS    0H                                                  0471
@RC00464 DS    0H                                                  0472
*             END;                                                 0472
@RC00461 DS    0H                                                  0473
*         END;                                                     0473
@RF00453 DS    0H                                                  0474
*     END;                          /* END SAME FMID PROCESSING      */
@RF00433 DS    0H                                                  0475
*   IF EXCLUDED=OFF                 /* NOT EXCLUDED                  */
*       &(RMIDERR=ON                /* RMID ID ERROR                 */
*       ×UMIDERR=ON)                /* UMID ID ERROR                 */
*     THEN                                                         0475
@RF00425 TM    EXCLUDED,B'00001000'                                0475
         BNZ   @RF00475                                            0475
         TM    RMIDERR,B'11000000'                                 0475
         BZ    @RF00475                                            0475
*     DO;                                                          0476
*                                                                  0476
*       /*************************************************************/
*       /*                                                           */
*       /* RMID OR UMID ID CHECK ERROR                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0477
*       ICTMMIDE(1)=ON;             /* SET ID CHECK FLAG             */
         L     @08,CMOD                                            0477
         OI    ICTMMIDE(@08),B'00001000'                           0477
*       IF ICTMISEL(1)=ON           /* ELEMENT IS SELECTED           */
*         THEN                                                     0478
         TM    ICTMISEL(@08),B'10000000'                           0478
         BNO   @RF00478                                            0478
*         CCARGNP=ON;               /* SET FLAG FOR HMASMARL         */
         OI    CCARGNP(CCAPTR),B'01000000'                         0479
*       IF RMIDERR=ON               /* RMID ID CHECK ERROR           */
*         THEN                                                     0480
@RF00478 TM    RMIDERR,B'10000000'                                 0480
         BNO   @RF00480                                            0480
*         DO;                                                      0481
*                                                                  0481
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE MESSAGE HMA382I AND HMA319I FOR RMID ID CHECK   */
*           /* RELATIVE TO LASTRMID (UMIDCHK PROC ISSUED MESSAGES FOR*/
*           /* ALL OTHER MODIDS)                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0482
*           IF MSG382I=OFF THEN                                    0482
         TM    MSG382I,B'00100000'                                 0482
         BNZ   @RF00482                                            0482
*             CALL ERRMSG(HMA382I,NOPART);/* ISSUE MESSAGE           */
         LA    @01,@AL00483                                        0483
         BAL   @14,ERRMSG                                          0483
*           MSG382I=ON;             /* SET HMA382I MSG ISSUED FLAG   */
@RF00482 OI    MSG382I,B'00100000'                                 0484
*           IF LREPELM@=0           /* LAST REPLACEMENT NOT IN ICT   */
*             THEN                                                 0485
         L     @08,LREPELM@                                        0485
         LTR   @08,@08                                             0485
         BNZ   @RF00485                                            0485
*             VPART#3=MSGXCDS;      /* SET "SMPCDS" OR "SMPACDS"     */
         MVC   VPART#3(8),MSGXCDS                                  0486
*           ELSE                                                   0487
*             VPART#3=MSGSEL;       /* SET "SELECTED"                */
         B     @RC00485                                            0487
@RF00485 MVC   VPART#3(8),@CC01841                                 0487
*           VPART#4=MSGRMID;        /* SET "RMID" IN HMA319I MSG     */
@RC00485 MVC   VPART#4(8),@CC01837                                 0488
*           VPART#5=LASTRMID;       /* SET LAST RMID SYSMOD IN MSG   */
         MVI   VPART#5+7,C' '                                      0489
         MVC   VPART#5(7),LASTRMID                                 0489
*           CALL ERRMSG(HMA319I,NOPART);/* ISSUE MSG FOR RMID        */
         LA    @01,@AL00490                                        0490
         BAL   @14,ERRMSG                                          0490
*         END;                                                     0491
*     END;                          /* END ID CHECK ERROR PROCESSING */
@RF00480 DS    0H                                                  0493
*   REPFLG=OFF;                     /* FINISHED PROCESSING REPL. ELEM*/
@RF00475 NI    REPFLG,B'11110111'                                  0493
*   RETURN;                                                        0494
@EL00002 DS    0H                                                  0494
@EF00002 DS    0H                                                  0494
@ER00002 LM    @14,@04,@SA00002                                    0494
         LM    @06,@12,@SA00002+28                                 0494
         BR    @14                                                 0494
*   END REPELEM;                                                   0495
*                                                                  0496
*/********************************************************************/
*/*                                                                  */
*/*    UPDELEM  - PROCESS ++ZAP, ++MACUPD AND ++SRCUPD UPDATE        */
*/*               ELEMENTS:                                          */
*/*                                                                  */
*/*      - DETERMINE WHETHER ELEMENT SHOULD BE SELECTED:             */
*/*                                                                  */
*/*                                                                  */
*/*          VERSION    RMID CHECK    UMID CHECK       RESULT        */
*/*          --------   ----------    ----------     ------------    */
*/*                                                                  */
*/*             Y           -             Y            SELECT        */
*/*             Y           -             N            SELECT  *     */
*/*             N           Y             Y            SELECT        */
*/*             N           Y             N            SELECT  *     */
*/*             N           N             -            IDERROR       */
*/*                                                                  */
*/*                                                                  */
*/*         * - FOR ++SRCUPD ELEMENTS, ELIMINATE THE ASSOCIATED      */
*/*             ++MOD REPLACEMENT SUPPLIED IN THE "CURRENT" SYSMOD.  */
*/*                                                                  */
*/*                                                                  */
*/*      - CHECK BYPASS OPTIONS IF ID CHECK ERROR FOR RMID           */
*/*                                                                  */
*/*         - ISSUE HMA319I FOR RMID ID CHECK ERROR.                 */
*/*                                                                  */
*/*      - CALL UMIDCHK TO LIST ANY UPDATES IN ICT AND/OR (A)CDS     */
*/*        WHICH ARE NOT PREREQD OR SUPERSEDED ... UMIDERR WILL      */
*/*        BE SET IF SO                                              */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                  (ZAP, MACUPD OR SRCUPD UPDATE ELEMENT)          */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*                                                                  */
*/*     * ICTMISEL - '1' IF ELEMENT SHOULD BE SELECTED               */
*/*                  '0' IF ELEMENT SHOULD NOT BE SELECTED           */
*/*                                                                  */
*/*     * ICTMMIDE - '1' IF ID CHECK ERROR DETECTED (EVEN IF BYPASSD)*/
*/*                  '0' NO ID CHECK ERROR                           */
*/*                                                                  */
*/*     * UMIDERR -  SET IF "CURRENT" SYSMOD DID NOT PREREQ OR       */
*/*                  SUPERSEDE ALL UPDATES IN ICT AND/OR (A)CDS      */
*/*                                                                  */
*/*     * EXCLUDED - SET IF ELEMENT SHOULD BE EXCLUDED               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0496
*UPDELEM:                                                          0496
*   PROC;                                                          0496
UPDELEM  STM   @14,@04,@SA00003                                    0496
         STM   @06,@12,@SA00003+28                                 0496
*   RESPECIFY                                                      0497
*     ICTMOD BASED(CMOD);           /* ADDRESS "CURRENT" ELEMENT     */
*   RESPECIFY                                                      0498
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" SYSMOD      */
*   SELEXCL=''B;                    /* CLEAR SELECT/EXCLUDE FLAGS    */
         XC    SELEXCL(2),SELEXCL                                  0499
*   UPDFLG=ON;                      /* PROCESSING UPDATE ELEMENT     */
*                                                                  0500
         OI    UPDFLG,B'00000100'                                  0500
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE THE FMID AND RMID OF THE LAST SELECTED VERSION OF   */
*   /* THE "CURRENT" ELEMENT                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0501
*   CALL GETMIDS;                   /* GET MODIDS ASSOCIATED WITH THE
*                                      LAST SELECTED VERSION OF THE
*                                      CURRENT ELEMENT               */
         BAL   @14,GETMIDS                                         0501
*   IF DELETED=ON                   /* ELEMENT FOUND DELETED         */
*     THEN                                                         0502
         TM    DELETED,B'01000000'                                 0502
         BNO   @RF00502                                            0502
*     DO;                                                          0503
*                                                                  0503
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE FOR AN ELEMENT WHICH IS DELETED (HMA381I)          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0504
*       UPDERROR=ON;                /* SET UPDATE ERROR FLAG         */
         OI    UPDERROR,B'00100000'                                0504
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0505
*       CALL ERRMSG(HMA381I,NOPART);/* ISSUE HMA381I                 */
         LA    @01,@AL00506                                        0506
         BAL   @14,ERRMSG                                          0506
*     END;                                                         0507
*   IF UPDERROR=OFF                 /* ELEMENT NOT FOUND DELETED     */
*     THEN                                                         0508
@RF00502 TM    UPDERROR,B'00100000'                                0508
         BNZ   @RF00508                                            0508
*     DO;                                                          0509
*       IF LASTRMID=NULLPTF#        /* NO VERSION OF ELEMENT FOUND   */
*         THEN                                                     0510
         CLC   LASTRMID(7),@CC01719                                0510
         BNE   @RF00510                                            0510
*         DO;                                                      0511
*                                                                  0511
*           /*********************************************************/
*           /*                                                       */
*           /* UPDATE FOR AN ELEMENT WHICH DOES NOT EXIST (HMA415I)  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0512
*           UPDERROR=ON;            /* SET UPDATE ERROR FLAG         */
         OI    UPDERROR,B'00100000'                                0512
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0513
*           CALL ERRMSG(HMA415I,NOPART);/* ISSUE HMA415I             */
         LA    @01,@AL00514                                        0514
         BAL   @14,ERRMSG                                          0514
*         END;                                                     0515
*     END;                                                         0516
@RF00510 DS    0H                                                  0517
*   IF UPDERROR=OFF                 /* NO UPDATE ERROR               */
*     THEN                                                         0517
@RF00508 TM    UPDERROR,B'00100000'                                0517
         BNZ   @RF00517                                            0517
*     DO;                                                          0518
*       IF ICTMFMID(1)^=LASTFMID    /* COMPARE ELEMENT-FMID'S        */
*         THEN                                                     0519
         L     @08,CMOD                                            0519
         CLC   ICTMFMID(7,@08),LASTFMID                            0519
         BE    @RF00519                                            0519
*         DO;                                                      0520
*                                                                  0520
*           /*********************************************************/
*           /*                                                       */
*           /* ELEMENTS HAVE DIFFERENT FMIDS                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0521
*           CALL VERSION;           /* SELECT/EXCLUDE PROCESSING     */
         BAL   @14,VERSION                                         0521
*           IF VERSIOND=ON THEN                                    0522
         TM    VERSIOND,B'00010000'                                0522
         BNO   @RF00522                                            0522
*             DO;                                                  0523
*               ICTMISEL(1)=ON;     /* SELECT "CURRENT" ELEMENT      */
         L     @08,CMOD                                            0524
         OI    ICTMISEL(@08),B'10000000'                           0524
*               ICTMRMID(1)=ICTPTFS(1);/* "CURRENT" SYSMOD BECOMES 0525
*                                      RMID                          */
         L     @04,@PC00001+4                                      0525
         L     @04,CPTF(,@04)                                      0525
         MVC   ICTMRMID(7,@08),ICTPTFS(@04)                        0525
*             END;                                                 0526
*           ELSE                                                   0527
*             EXCLUDED=ON;          /* EXCLUDE "CURRENT" ELEMENT     */
         B     @RC00522                                            0527
@RF00522 OI    EXCLUDED,B'00001000'                                0527
*         END;                                                     0528
*       ELSE                                                       0529
*         DO;                                                      0529
*                                                                  0529
         B     @RC00519                                            0529
@RF00519 DS    0H                                                  0530
*           /*********************************************************/
*           /*                                                       */
*           /* ELEMENTS HAVE SAME FMIDS                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0530
*           CALL HMASMTPS(CPTF,     /* "CURRENT" SYSMOD              */
*               LASTRMID,           /* LAST RMID                     */
*               TPSRTN);            /* PREREQD OR SUPD               */
         MVC   @AL00001+4(8),@AL00530                              0530
         L     @08,@PC00001+4                                      0530
         ST    @08,@AL00001                                        0530
         L     @15,@CV01714                                        0530
         LA    @01,@AL00001                                        0530
         BALR  @14,@15                                             0530
*           IF TPSRTN=PRESUP        /* PARM RETURNED BY HMASMTPS     */
*             THEN                                                 0531
         CLI   TPSRTN,232                                          0531
         BNE   @RF00531                                            0531
*             ICTMISEL(1)=ON;       /* SELECT "CURRENT" ELEMENT      */
         L     @08,CMOD                                            0532
         OI    ICTMISEL(@08),B'10000000'                           0532
*           ELSE                                                   0533
*             IF ICTPREDO(1)=ON     /* SYSMOD RE-INSTALL             */
*               THEN                                               0533
         B     @RC00531                                            0533
@RF00531 L     @08,@PC00001+4                                      0533
         L     @08,CPTF(,@08)                                      0533
         TM    ICTPREDO(@08),B'01000000'                           0533
         BNO   @RF00533                                            0533
*               EXCLUDED=ON;        /* EXCLUDE THE ELEMENT           */
         OI    EXCLUDED,B'00001000'                                0534
*             ELSE                                                 0535
*               RMIDERR=ON;         /* RMID ID CHECK ERROR           */
         B     @RC00533                                            0535
@RF00533 OI    RMIDERR,B'10000000'                                 0535
*         END;                                                     0536
@RC00533 DS    0H                                                  0536
@RC00531 DS    0H                                                  0537
*     END;                                                         0537
@RC00519 DS    0H                                                  0538
*   IF RMIDERR=ON                   /* RMID ID CHECK ERROR           */
*       &UPDERROR=OFF               /* NO UPDATE ERROR               */
*     THEN                                                         0538
@RF00517 TM    RMIDERR,B'10000000'                                 0538
         BNO   @RF00538                                            0538
         TM    UPDERROR,B'00100000'                                0538
         BNZ   @RF00538                                            0538
*     DO;                                                          0539
*                                                                  0539
*       /*************************************************************/
*       /*                                                           */
*       /* RMID ID CHECK ERROR ... CHECK BYPASS OPTIONS              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0540
*       ICTMMIDE(1)=ON;             /* SET ID CHECK FAILURE FLAG     */
         L     @08,CMOD                                            0540
         OI    ICTMMIDE(@08),B'00001000'                           0540
*       IF TBLBPID=ON               /* ID CHECK ERRORS BYPASSEDD     */
*         THEN                                                     0541
         L     @04,@PC00001                                        0541
         L     @04,TBLXTBL(,@04)                                   0541
         TM    TBLBPID(@04),B'10000000'                            0541
         BNO   @RF00541                                            0541
*         DO;                                                      0542
*           MGPTYPE=MGPWARN;        /* SET ERROR MSG/RETURN_CODE     */
         MVI   MGPTYPE,X'02'                                       0543
*           ICTMISEL(1)=ON;         /* SELECT "CURRENT" ELEMENT      */
         OI    ICTMISEL(@08),B'10000000'                           0544
*           ICTBYP(1)=ON;           /* BYPASS USED FOR THIS SYSMOD   */
         L     @08,@PC00001+4                                      0545
         L     @08,CPTF(,@08)                                      0545
         OI    ICTBYP(@08),B'00000010'                             0545
*         END;                                                     0546
*       ELSE                                                       0547
*         MGPTYPE=MGPERR;           /* SET ERROR MSG/RETURN_CODE     */
         B     @RC00541                                            0547
@RF00541 MVI   MGPTYPE,X'03'                                       0547
*       IF ICTMISEL(1)=ON           /* ELEMENT IS SELECTED           */
*         THEN                                                     0548
@RC00541 L     @08,CMOD                                            0548
         TM    ICTMISEL(@08),B'10000000'                           0548
         BNO   @RF00548                                            0548
*         CCARGNP=ON;               /* SET FLAG FOR HMASMARL         */
*                                                                  0549
         OI    CCARGNP(CCAPTR),B'01000000'                         0549
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE HMA382I FOR RMID ID CHECK FAILURE                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0550
*       IF MSG382I=OFF THEN                                        0550
@RF00548 TM    MSG382I,B'00100000'                                 0550
         BNZ   @RF00550                                            0550
*         CALL ERRMSG(HMA382I,NOPART);/* ISSUE MESSAGE               */
         LA    @01,@AL00551                                        0551
         BAL   @14,ERRMSG                                          0551
*       MSG382I=ON;                 /* SET HMA382I MSG ISSUED FLAG   */
*                                                                  0552
@RF00550 OI    MSG382I,B'00100000'                                 0552
*       /*************************************************************/
*       /*                                                           */
*       /* LIST RMID INVOLVED IN ID CHECK ERROR (HMA319I)            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0553
*       IF LREPELM@=0               /* LAST REPLACEMENT NOT IN ICT   */
*         THEN                                                     0553
         L     @08,LREPELM@                                        0553
         LTR   @08,@08                                             0553
         BNZ   @RF00553                                            0553
*         VPART#3=MSGXCDS;          /* SET "SMPCDS" OR "SMPACDS" IN
*                                      MSG                           */
         MVC   VPART#3(8),MSGXCDS                                  0554
*       ELSE                                                       0555
*         VPART#3=MSGSEL;           /* SET "SELECTED" IN MSG         */
         B     @RC00553                                            0555
@RF00553 MVC   VPART#3(8),@CC01841                                 0555
*       VPART#4=MSGRMID;            /* SET "RMID" IN HMA319I MSG     */
@RC00553 MVC   VPART#4(8),@CC01837                                 0556
*       VPART#5=LASTRMID;           /* RMID SYSMOD-ID IN HMA319I MSG */
         MVI   VPART#5+7,C' '                                      0557
         MVC   VPART#5(7),LASTRMID                                 0557
*       CALL ERRMSG(HMA319I,NOPART);/* ISSUE MSG                     */
         LA    @01,@AL00558                                        0558
         BAL   @14,ERRMSG                                          0558
*     END;                          /* END ID CHECK ERROR PROCESSING */
*   IF ICTMISEL(1)=ON               /* "CURRENT" ELEMENT SELECTED    */
*     THEN                                                         0560
@RF00538 L     @08,CMOD                                            0560
         TM    ICTMISEL(@08),B'10000000'                           0560
         BNO   @RF00560                                            0560
*     DO;                                                          0561
*                                                                  0561
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK UMIDS ASSOCIATED WITH LAST REPLACEMENT VERSION OF   */
*       /* THE CURRENT ELEMENT                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0562
*       MGPTYPE=MGPWARN;            /* SET UP MESSAGE SEVERITY       */
         MVI   MGPTYPE,X'02'                                       0562
*       CALL UMIDCHK(MSG);          /* ISSUE UMID WARNING MESSAGES   */
         LA    @01,@AL00563                                        0563
         BAL   @14,UMIDCHK                                         0563
*       IF UMIDERR=ON               /* UMID CHECKS                   */
*         THEN                                                     0564
         TM    UMIDERR,B'01000000'                                 0564
         BNO   @RF00564                                            0564
*         CCARGNP=ON;               /* SET FLAG FOR HMASMARL         */
         OI    CCARGNP(CCAPTR),B'01000000'                         0565
*     END;                                                         0566
@RF00564 DS    0H                                                  0567
*   UPDFLG=OFF;                     /* FINISHED PROCESSING REPL. ELEM*/
@RF00560 NI    UPDFLG,B'11111011'                                  0567
*   RETURN;                                                        0568
@EL00003 DS    0H                                                  0568
@EF00003 DS    0H                                                  0568
@ER00003 LM    @14,@04,@SA00003                                    0568
         LM    @06,@12,@SA00003+28                                 0568
         BR    @14                                                 0568
*   END UPDELEM;                                                   0569
*                                                                  0570
*/********************************************************************/
*/*                                                                  */
*/*    VERSION  - DETERMINE SELECTION/EXCLUSION BASED UPON THE       */
*/*               FMID AND VERSION RELATIONSHIP BETWEEN THE          */
*/*               "CURRENT" ELEMENT AND THE PREVIOUSLY SELECTED      */
*/*               ELEMENT                                            */
*/*                                                                  */
*/*               THIS PROCEDURE IS CALLED WHEN THE "CURRENT"        */
*/*               ELEMENT'S FMID IS NOT THE SAME AS THE FMID         */
*/*               OF THE PREVIOUSLY SELECTED VERSION OF THE ELEMENT. */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*     * LASTFMID - SET TO THE ELEMENT-FMID ASSOCIATED WITH THE     */
*/*                  LAST SELECTED VERSION OF THE "CURRENT" ELEMENT. */
*/*                                                                  */
*/*                - IF LASTFMID='       ' NO PREVIOUSLY SELECTED    */
*/*                  VERSION OF THE ELEMENT WAS FOUND.               */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * VERSIOND - SET AS FOLLOWS:                                 */
*/*                                                                  */
*/*                  0  - "CURRENT" ELEMENT SHOULD NOT BE SELECTED   */
*/*                  1  - "CURRENT" ELEMENT SHOULD BE SELECTED       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0570
*VERSION:                                                          0570
*   PROC;                                                          0570
VERSION  STM   @14,@12,12(@13)                                     0570
*   DCL                                                            0571
*     FF FIXED(15);                 /* LOCAL INDEX - VERSION LIST    */
*   RESPECIFY                                                      0572
*     ICTMOD BASED(CMOD);           /* ADDRESS CURRENT ELEMENT       */
*   RESPECIFY                                                      0573
*     ICTPTF BASED(CPTF);           /* ADDRESS CURRENT SYSMOD        */
*   VERSIOND=OFF;                   /* "CURRENT" SYSMOD DOES NOT   0574
*                                      VERSION (CHANGE FMID) OF LAST
*                                      SELECTED VERSION OF ELEM.     */
         NI    VERSIOND,B'11101111'                                0574
*   IF LASTFMID=NULLPTF#            /* NO PREVIOUSLY SELECTED VERSION*/
*     THEN                                                         0575
         CLC   LASTFMID(7),@CC01719                                0575
         BNE   @RF00575                                            0575
*     VERSIOND=ON;                  /* "CURRENT" ELEMENT SHOULD BE 0576
*                                      SELECTED                      */
         OI    VERSIOND,B'00010000'                                0576
*   IF CPTF->ICTPFMID(1)=LASTFMID   /* COMPARE FUNCTIONAL OWNERSHIP
*                                      OF "CURRENT" SYSMOD WITH LAST
*                                      FUNCTION TO REPLACE THIS    0577
*                                      ELEMENT                       */
*     THEN                                                         0577
*                                                                  0577
@RF00575 L     @08,@PC00001+4                                      0577
         L     @08,CPTF(,@08)                                      0577
         CLC   ICTPFMID(7,@08),LASTFMID                            0577
         BNE   @RF00577                                            0577
*     /***************************************************************/
*     /*                                                             */
*     /* THE "OWNER" OF THE CURRENT SYSMOD IS THE SYSMOD WHICH       */
*     /* SUPPLIED THE PREVIOUSLY SELECTED VERSION OF THE ELEMENT ... */
*     /* THE CURRENT SYSMOD IS FUNCTIONALLY HIGHER THAN ITS OWNER    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0578
*     VERSIOND=ON;                  /* "CURRENT" ELEMENT SHOULD BE 0578
*                                      SELECTED                      */
         OI    VERSIOND,B'00010000'                                0578
*   IF VERSIOND=OFF THEN                                           0579
@RF00577 TM    VERSIOND,B'00010000'                                0579
         BNZ   @RF00579                                            0579
*     DO;                                                          0580
*                                                                  0580
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE THE FUNCTIONAL HIERARCHY INFORMATION (VERSION)    */
*       /* FROM THE CURRENT SYSMOD WITH THE FUNCTIONAL OWNERSHIP     */
*       /* ATTRIBUTE OF THE PREVIOUSLY SELECTED VERSION OF THE       */
*       /* ELEMENT                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0581
*       IF ICTMVRND(1)^=ICTENDIX THEN                              0581
         L     @08,CMOD                                            0581
         L     @08,ICTMVCHN(,@08)                                  0581
         CLC   ICTMVRND(4,@08),ICTENDIX                            0581
         BE    @RF00581                                            0581
*         DO;                                                      0582
*                                                                  0582
*           /*********************************************************/
*           /*                                                       */
*           /* THE CURRENT ELEMENT HAS A VERSION LIST ... USE IT     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0583
*           DO FF=1 BY 1 WHILE VERSIOND=OFF&ICTMVRND(FF)^=ICTENDIX;
         LA    FF,1                                                0583
         B     @DE00583                                            0583
@DL00583 DS    0H                                                  0584
*             IF ICTMVRNM(FF)=LASTFMID THEN                        0584
*                                                                  0584
         LR    @08,FF                                              0584
         SLA   @08,3                                               0584
         L     @03,CMOD                                            0584
         L     @03,ICTMVCHN(,@03)                                  0584
         ALR   @03,@08                                             0584
         AL    @03,@CF02046                                        0584
         CLC   ICTMVRNM(7,@03),LASTFMID                            0584
         BNE   @RF00584                                            0584
*               /*****************************************************/
*               /*                                                   */
*               /* THE CURRENT ELEMENT'S VERSION LIST NAMES THE      */
*               /* PREVEVIOUSLY SELECTED ELEMENT'S FMID ... SELECT   */
*               /* THE CURRENT ELEMENT                               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0585
*               VERSIOND=ON;                                       0585
         OI    VERSIOND,B'00010000'                                0585
*           END;                                                   0586
@RF00584 AH    FF,@CH00067                                         0586
@DE00583 TM    VERSIOND,B'00010000'                                0586
         BNZ   @DC00583                                            0586
         LR    @08,FF                                              0586
         SLA   @08,3                                               0586
         L     @03,CMOD                                            0586
         L     @03,ICTMVCHN(,@03)                                  0586
         AL    @03,@CF02046                                        0586
         L     @08,ICTMVRND(@08,@03)                               0586
         CL    @08,ICTENDIX                                        0586
         BNE   @DL00583                                            0586
@DC00583 DS    0H                                                  0587
*         END;                                                     0587
*       ELSE                                                       0588
*         DO;                                                      0588
*                                                                  0588
         B     @RC00581                                            0588
@RF00581 DS    0H                                                  0589
*           /*********************************************************/
*           /*                                                       */
*           /* THE CURRENT ELEMENT DOES NOT HAVE A VERSION LIST ...  */
*           /* USE THE VERSION LIST FROM THE CURRENT SYSMOD'S ++VER  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0589
*           DO FF=1 BY 1 WHILE VERSIOND=OFF&ICTVRSND(FF)^=ICTENDIX;
         LA    FF,1                                                0589
         B     @DE00589                                            0589
@DL00589 DS    0H                                                  0590
*             IF ICTVRSNM(FF)=LASTFMID THEN                        0590
*                                                                  0590
         LR    @08,FF                                              0590
         SLA   @08,3                                               0590
         L     @03,@PC00001+4                                      0590
         L     @03,CPTF(,@03)                                      0590
         MVC   @TF00001(4),ICTPVCHN(@03)                           0590
         L     @03,@TF00001                                        0590
         ALR   @03,@08                                             0590
         AL    @03,@CF02046                                        0590
         CLC   ICTVRSNM(7,@03),LASTFMID                            0590
         BNE   @RF00590                                            0590
*               /*****************************************************/
*               /*                                                   */
*               /* THE CURRENT SYSMOD'S VERSION LIST NAMES THE       */
*               /* PREVEVIOUSLY SELECTED ELEMENT'S FMID ... SELECT   */
*               /* THE CURRENT ELEMENT                               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0591
*               VERSIOND=ON;                                       0591
         OI    VERSIOND,B'00010000'                                0591
*           END;                                                   0592
@RF00590 AH    FF,@CH00067                                         0592
@DE00589 TM    VERSIOND,B'00010000'                                0592
         BNZ   @DC00589                                            0592
         LR    @08,FF                                              0592
         SLA   @08,3                                               0592
         L     @03,@PC00001+4                                      0592
         L     @03,CPTF(,@03)                                      0592
         MVC   @TF00001(4),ICTPVCHN(@03)                           0592
         L     @03,@TF00001                                        0592
         AL    @03,@CF02046                                        0592
         L     @08,ICTVRSND(@08,@03)                               0592
         CL    @08,ICTENDIX                                        0592
         BNE   @DL00589                                            0592
@DC00589 DS    0H                                                  0593
*         END;                                                     0593
*     END;                          /* END OF VERSION LIST CHECK     */
*   RETURN;                                                        0595
@EL00004 DS    0H                                                  0595
@EF00004 DS    0H                                                  0595
@ER00004 LM    @14,@12,12(@13)                                     0595
         BR    @14                                                 0595
*   END VERSION;                                                   0596
         B     @EL00004                                            0596
*                                                                  0597
*/********************************************************************/
*/*                                                                  */
*/*    UPLEVCHK - DETERMINE WHETHER THE TARGET SYSTEM <(A)CDS> IS    */
*/*               AT A HIGHER SERVICE LEVEL THAN THE SYSMOD BEING    */
*/*               RE-INSTALLED.                                      */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*               -  THIS PROCEDURE IS INVOKED ONLY FOR SYSMODS      */
*/*                  WHICH ARE BEING RE-INSTALLED.                   */
*/*                                                                  */
*/*               -  THE TARGET SYSTEM IS CONSIDERED TO BE "UPLEVEL" */
*/*                  IF THE RMID OF THE "CURRENT" ELEMENT IS FOUND   */
*/*                  INSTALLED ON THE TARGET SYSTEM.                 */
*/*                                                                  */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*     * LASTRMID - SET TO THE ELEMENT-RMID ASSOCIATED WITH THE     */
*/*                  LAST SELECTED VERSION OF THE "CURRENT" ELEMENT. */
*/*                                                                  */
*/*     * LREPELM@ -  0  - LAST RMID REPRESENTS VERSION OF ELEMENT   */
*/*                        ON THE TARGET SYSTEM (CDS OR ACDS).       */
*/*                                                                  */
*/*                  ^0  - LAST REPLACEMENT IS ICT VERSION OF THE    */
*/*                         ELEMENT (LREPELM@ POINTS TO ICT MOD      */
*/*                         SECT ENTRY REPRESENTING LAST REPLACEMENT)*/
*/*                                                                  */
*/*     * IOPPTR  -  POINTS TO AN IOP WHICH MAY BE USED TO ACCESS    */
*/*                  (A)CDS SYSMOD ENTRIES                           */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * UPLEVEL   - SET AS FOLLOWS:                                */
*/*                                                                  */
*/*                  1   - TARGET SYSTEM IS UPLEVEL                  */
*/*                  0   - TARGET SYSTEM IS NOT UPLEVEL              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0597
*UPLEVCHK:                                                         0597
*   PROC;                                                          0597
UPLEVCHK STM   @14,@04,@SA00005                                    0597
         STM   @06,@12,@SA00005+28                                 0597
*   RESPECIFY                                                      0598
*     ICTMOD BASED(CMOD);           /* ADDRESS "CURRENT" ELEMENT'S 0598
*                                      ICT MOD SECTION ENTRY         */
*   UPLEVEL=OFF;                    /* INITIALIZE TO NOT UPLEVEL     */
         NI    UPLEVEL,B'11111011'                                 0599
*   IF LREPELM@=0                   /* LAST REPLACEMENT NOT IN ICT   */
*       &ICTMRMID(1)^=LASTRMID      /* SERVICE LEVELS NOT EQUAL      */
*     THEN                                                         0600
         L     @08,LREPELM@                                        0600
         LTR   @08,@08                                             0600
         BNZ   @RF00600                                            0600
         L     @08,CMOD                                            0600
         CLC   ICTMRMID(7,@08),LASTRMID                            0600
         BE    @RF00600                                            0600
*     DO;                                                          0601
*                                                                  0601
*       /*************************************************************/
*       /*                                                           */
*       /* LAST REPLACEMENT FOR THE "CURRENT" ELEMENT IS FOUND ON THE*/
*       /* TARGET SYSTEM ... SEE IF THE "CURRENT" ELEMENT'S RMID IS  */
*       /* INSTALLED ON THE TARGET SYSTEM ... IF SO, THE TARGET      */
*       /* SYSTEM IS "UP-LEVEL"                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0602
*       RESPECIFY                                                  0602
*         HMASMIOP BASED(IOPPTR);   /* SET ADDRESSIBILITY TO AN IOP  */
*       IF CCAAPPLY=ON THEN                                        0603
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0603
         BNO   @RF00603                                            0603
*         IOPDSID=IOPCDS;           /* APPLY => CDS                  */
         MVI   IOPDSID(IOPPTR),X'02'                               0604
*       ELSE                                                       0605
*         IOPDSID=IOPACDS;          /* ^APPLY => ACCEPT => ACDS      */
         B     @RC00603                                            0605
@RF00603 MVI   IOPDSID(IOPPTR),X'0C'                               0605
*       IOPFUNCT=IOPBLDL;           /* BLDL FUNCTION                 */
@RC00603 MVI   IOPFUNCT(IOPPTR),X'04'                              0606
*       IOPTYPE=IOPSMD;             /* SYSMOD ENTRIES                */
         MVI   IOPTYPE(IOPPTR),X'0B'                               0607
*       IOPNAME=' ';                /* BLANK ENTRY NAME FIELD        */
         MVI   IOPNAME+1(IOPPTR),C' '                              0608
         MVC   IOPNAME+2(6,IOPPTR),IOPNAME+1(IOPPTR)               0608
         MVI   IOPNAME(IOPPTR),C' '                                0608
*       IOPNAM17=ICTMRMID(1);       /* FILL RMID AS SYSMOD ENTRY TO
*                                      LOCATE                        */
         L     @08,CMOD                                            0609
         MVC   IOPNAM17(7,IOPPTR),ICTMRMID(@08)                    0609
*       CALL HMASMIO(HMASMIOP);                                    0610
         ST    IOPPTR,@AL00001                                     0610
         L     @15,@CV01712                                        0610
         LA    @01,@AL00001                                        0610
         BALR  @14,@15                                             0610
*       IF IOPRETRN>IOPNOTFD THEN                                  0611
         CLI   IOPRETRN(IOPPTR),4                                  0611
         BNH   @RF00611                                            0611
*         HIGHTMS=MAX(HIGHTMS,IOPRETRN);/* ACCESS ERROR RETURN CODE  */
         SLR   @08,@08                                             0612
         IC    @08,IOPRETRN(,IOPPTR)                               0612
         CR    HIGHTMS,@08                                         0612
         BNL   *+6
         LR    HIGHTMS,@08                                         0612
*       IF IOPRETRN=IOPGOOD         /* ENTRY FOUND                   */
*           &IOPERROR=OFF           /* ENTRY NOT "IN ERROR"          */
*         THEN                                                     0613
@RF00611 CLI   IOPRETRN(IOPPTR),0                                  0613
         BNE   @RF00613                                            0613
         TM    IOPERROR(IOPPTR),B'00010000'                        0613
         BNZ   @RF00613                                            0613
*         UPLEVEL=ON;               /* CONSIDER THE TARGET SYSTEM  0614
*                                      UP-LEVEL                      */
         OI    UPLEVEL,B'00000100'                                 0614
*     END;                                                         0615
*   RETURN;                                                        0616
@EL00005 DS    0H                                                  0616
@EF00005 DS    0H                                                  0616
@ER00005 LM    @14,@04,@SA00005                                    0616
         LM    @06,@12,@SA00005+28                                 0616
         BR    @14                                                 0616
*   END UPLEVCHK;                                                  0617
         B     @EL00005                                            0617
*                                                                  0618
*/********************************************************************/
*/*                                                                  */
*/*    GETMIDS  - GET FMID AND RMID ASSOCIATED WITH THE LAST SELECTED*/
*/*               VERSION OF THE "CURRENT" ELEMENT.                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*               -  (A)CDS MODID LIST IN "CURRENT" ELEMENT'S        */
*/*                  MOD SECT ENTRY MUST BE INITIALIZED              */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * ICTMICHN - CURRENT ELEMENT'S MODID LIST IS SET TO POINT    */
*/*                  TO THE MODID LIST OF LAST SELECTED VERSION      */
*/*                  OF THE ELEMENT (IF FOUND IN ICT).               */
*/*                                                                  */
*/*     * LREPELM@ - SET TO ADDR OF ICT MOD SECTION ENTRY OF LAST    */
*/*                  SELECTED REPLACEMENT VERSION OF THE "CURRENT"   */
*/*                  ELEMENT (IF REPLACEMENT FOUND IN ICT).          */
*/*                                                                  */
*/*     * LASTFMID - SET TO THE FMID ASSOCIATED WITH LAST SELECTED   */
*/*                  VERSION OF THE "CURRENT" ELEMENT.               */
*/*                                                                  */
*/*     * LASTRMID - SET TO THE RMID ASSOCIATED WITH LAST SELECTED   */
*/*                  VERSION OF THE "CURRENT" ELEMENT.               */
*/*                                                                  */
*/*     * LRMIDASM - SET IF THE LAST RMID IS THE RESULT OF AN        */
*/*                  ASSEMBLY FOUND EITHER IN ICT OR ON (A)CDS.      */
*/*                                                                  */
*/*     * DELETED  - SET IF THE ENTRY FOUND IN THE ICT IS FOR        */
*/*                  A DELETED ELEMENT.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0618
*GETMIDS:                                                          0618
*   PROC;                                                          0618
GETMIDS  STM   @14,@12,@SA00006                                    0618
*   DCL                                                            0619
*     RR FIXED(15);                 /* LOCAL INDEX - ICT MOD SECT    */
*   RESPECIFY                                                      0620
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */
*   LREPELM@=0;                     /* CLEAR PTR TO LAST REPL IN ICT */
         SLR   @08,@08                                             0621
         ST    @08,LREPELM@                                        0621
*   LASTFMID=NULLPTF#;              /* BLANK LAST FMID               */
         MVC   LASTFMID(7),@CC01719                                0622
*   LASTRMID=NULLPTF#;              /* BLANK LAST RMID               */
         MVC   LASTRMID(7),@CC01719                                0623
*   LRMIDASM=OFF;                   /* CLEAR "LAST RMID => ASSEMBLY" */
         NI    LRMIDASM,B'01111111'                                0624
*                                                                  0625
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION ... MAKE SURE ASSEMBLY ENTRY IS FOUND */
*   /* (IF THERE IS BOTH A MOD AND ASSEM FOR SAME ELEMENT)           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0625
*   DO RR=1 BY 1 WHILE ICTMEND(RR)^=ICTENDNT/* AT END OF MOD SECT    */
*         &LRMIDASM=OFF;            /* AN ASSEM ENTRY MATCH NOT FND. */
         LA    RR,1                                                0625
         B     @DE00625                                            0625
@DL00625 DS    0H                                                  0626
*     IF ICTMNAME(RR)=CMOD->ICTMNAME(1)/* ELEMENTS WITH SAME NAME    */
*         &ICTPPTR(RR)^=CPTF        /* NOT FROM "CURRENT" SYSMOD     */
*         &ICTMISEL(RR)=ON          /* OTHER ELEMENT IS SELECTED     */
*       THEN                                                       0626
         LR    @08,RR                                              0626
         MH    @08,@CH02013                                        0626
         L     @03,CCAICMOD(,CCAPTR)                               0626
         ST    @08,@TF00001                                        0626
         ALR   @08,@03                                             0626
         AL    @08,@CF02036                                        0626
         L     @01,CMOD                                            0626
         CLC   ICTMNAME(8,@08),ICTMNAME(@01)                       0626
         BNE   @RF00626                                            0626
         L     @08,@PC00001+4                                      0626
         L     @01,@TF00001                                        0626
         AL    @01,@CF02034                                        0626
         L     @15,ICTPPTR-96(@01,@03)                             0626
         C     @15,CPTF(,@08)                                      0626
         BE    @RF00626                                            0626
         LR    @08,@03                                             0626
         AL    @08,@TF00001                                        0626
         AL    @08,@CF02033                                        0626
         TM    ICTMISEL-11(@08),B'10000000'                        0626
         BNO   @RF00626                                            0626
*       DO;                                                        0627
*         CALL INTRSECT(CMOD,ADDR(ICTMOD(RR)),ITYPE);/* COMPARE TYPES*/
         L     @08,@TF00001                                        0628
         AL    @03,@CF02036                                        0628
         LA    @08,ICTMOD(@08,@03)                                 0628
         ST    @08,@AFTEMPS                                        0628
         LA    @01,@AL00628                                        0628
         BAL   @14,INTRSECT                                        0628
*         IF ITYPE=REPREP           /* REPLACEMENT TO REPLACEMENT    */
*             ×ITYPE=REPUPD         /* REPLACEMENT TO UPDATE         */
*             ×ITYPE=UPDREP         /* UPDATE TO REPLACEMENT         */
*             ×ITYPE=UPDUPD         /* UPDATE TO UPDATE              */
*           THEN                                                   0629
         CLI   ITYPE,1                                             0629
         BE    @RT00629                                            0629
         CLI   ITYPE,2                                             0629
         BE    @RT00629                                            0629
         CLI   ITYPE,4                                             0629
         BE    @RT00629                                            0629
         CLI   ITYPE,8                                             0629
         BNE   @RF00629                                            0629
@RT00629 DS    0H                                                  0630
*           DO;                                                    0630
*                                                                  0630
*             /*******************************************************/
*             /*                                                     */
*             /* ANOTHER SELECTED VERSION OF THE ELEMENT FOUND       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0631
*             CMOD->ICTMICHN(1)=ICTMICHN(RR);/* MAKE THIS ELEMENT'S
*                                      MODID LIST THE SAME AS THAT OF
*                                      THE PREVIOUSLY SELECTED ONE   */
         LR    @08,RR                                              0631
         MH    @08,@CH02013                                        0631
         L     @03,CCAICMOD(,CCAPTR)                               0631
         ST    @08,@TF00001                                        0631
         ALR   @08,@03                                             0631
         AL    @08,@CF02047                                        0631
         MVC   @TF00002(4),ICTMICHN-104(@08)                       0631
         L     @08,@TF00002                                        0631
         ST    @08,@TF00002                                        0631
         L     @01,CMOD                                            0631
         MVC   ICTMICHN(4,@01),@TF00002                            0631
*             IF ICTMIDEL(RR)=OFF   /* PREV. VERSION NOT DELETED     */
*               THEN                                               0632
         LR    @08,@03                                             0632
         AL    @08,@TF00001                                        0632
         AL    @08,@CF02033                                        0632
         TM    ICTMIDEL-11(@08),B'01000000'                        0632
         BNZ   @RF00632                                            0632
*               DO;                                                0633
*                 LASTFMID=ICTMFMID(RR);/* SAVE FMID FROM ICT ELEM.  */
         LR    @08,@03                                             0634
         AL    @08,@TF00001                                        0634
         AL    @08,@CF02037                                        0634
         MVC   LASTFMID(7),ICTMFMID-88(@08)                        0634
*                 IF ICTMRMID(RR)^=NULLPTF#/* VALID RMID             */
*                   THEN                                           0635
         LR    @08,@03                                             0635
         AL    @08,@TF00001                                        0635
         AL    @08,@CF02048                                        0635
         CLC   ICTMRMID-80(7,@08),@CC01719                         0635
         BE    @RF00635                                            0635
*                   DO;                                            0636
*                     LASTRMID=ICTMRMID(RR);/* SAVE RMID             */
         LR    @08,@03                                             0637
         AL    @08,@TF00001                                        0637
         AL    @08,@CF02048                                        0637
         MVC   LASTRMID(7),ICTMRMID-80(@08)                        0637
*                     LREPELM@=ADDR(ICTMOD(RR));/* POINT TO ICT REPL */
         L     @08,@TF00001                                        0638
         AL    @08,@CF02036                                        0638
         LA    @08,ICTMOD(@08,@03)                                 0638
         ST    @08,LREPELM@                                        0638
*                     IF ICTMASM(RR)=ON/* ASSEM ENTRY                */
*                       THEN                                       0639
         AL    @03,@TF00001                                        0639
         AL    @03,@CF02049                                        0639
         TM    ICTMASM-9(@03),B'01000000'                          0639
         BNO   @RF00639                                            0639
*                       LRMIDASM=ON;/* LASTRMID IS RESULT OF ASSEM.  */
         OI    LRMIDASM,B'10000000'                                0640
*                   END;                                           0641
*               END;                                               0642
*             ELSE                                                 0643
*               DELETED=ON;         /* PREVIOUS VERSION IS DELETED   */
         B     @RC00632                                            0643
@RF00632 OI    DELETED,B'01000000'                                 0643
*           END;                                                   0644
@RC00632 DS    0H                                                  0645
*       END;                                                       0645
@RF00629 DS    0H                                                  0646
*   END;                                                           0646
@RF00626 AH    RR,@CH00067                                         0646
@DE00625 LR    @08,RR                                              0646
         MH    @08,@CH02013                                        0646
         L     @03,CCAICMOD(,CCAPTR)                               0646
         ALR   @03,@08                                             0646
         AL    @03,@CF02036                                        0646
         MVC   @TF00001(4),ICTMEND(@03)                            0646
         L     @08,@TF00001                                        0646
         CL    @08,ICTENDNT                                        0646
         BE    @DC00625                                            0646
         TM    LRMIDASM,B'10000000'                                0646
         BZ    @DL00625                                            0646
@DC00625 DS    0H                                                  0647
*   IF DELETED=OFF                  /* NOT DELETED IN ICT            */
*       &LREPELM@=0                 /* LAST REPLACEMENT NOT FOUND IN
*                                      ICT                           */
*     THEN                                                         0647
         TM    DELETED,B'01000000'                                 0647
         BNZ   @RF00647                                            0647
         L     @08,LREPELM@                                        0647
         LTR   @08,@08                                             0647
         BNZ   @RF00647                                            0647
*     DO;                                                          0648
*                                                                  0648
*       /*************************************************************/
*       /*                                                           */
*       /* NO REPLACEMENT FOUND IN ICT ... RMID MUST COME FROM (A)CDS*/
*       /* MODID LIST                                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0649
*       RESPECIFY                                                  0649
*         ICTMOD BASED(CMOD);       /* ADDRESS "CURRENT" ELEMENT     */
*       RESPECIFY                                                  0650
*         ICTMIDLS BASED(ICTMICHN(1));/* ADDRESS "CURRENT" ELEMENT'S
*                                      MODID LIST                    */
*                                                                  0650
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ELEMENT'S (A)CDS MODID LIST                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0651
*       DO RR=1 BY 1 WHILE ICTMIDND(RR)^=ICTENDIX;                 0651
         LA    RR,1                                                0651
         B     @DE00651                                            0651
@DL00651 DS    0H                                                  0652
*         IF ICTMIDTY(RR)=ICTMIDFM  /* FMID-TYPE MODID ON (A)CDS     */
*             &LASTFMID=NULLPTF#    /* FMID MODID NOT FOUND IN ICT   */
*           THEN                                                   0652
         LR    @08,RR                                              0652
         SLA   @08,3                                               0652
         L     @03,CMOD                                            0652
         MVC   @TF00001(4),ICTMICHN(@03)                           0652
         L     @03,@TF00001                                        0652
         ST    @08,@TF00001                                        0652
         ALR   @08,@03                                             0652
         BCTR  @08,0                                               0652
         TM    ICTMIDTY-7(@08),B'00000010'                         0652
         BNO   @RF00652                                            0652
         TM    ICTMIDTY-7(@08),B'00000001'                         0652
         BNZ   @RF00652                                            0652
         CLC   LASTFMID(7),@CC01719                                0652
         BNE   @RF00652                                            0652
*           LASTFMID=ICTMODID(RR);  /* LAST FMID SYSMOD-ID           */
         AL    @03,@TF00001                                        0653
         AL    @03,@CF02046                                        0653
         MVC   LASTFMID(7),ICTMODID(@03)                           0653
*         IF ICTMIDTY(RR)=ICTMIDRM  /* RMID-TYPE MODID ON (A)CDS     */
*           THEN                                                   0654
@RF00652 LR    @08,RR                                              0654
         SLA   @08,3                                               0654
         L     @03,CMOD                                            0654
         MVC   @TF00001(4),ICTMICHN(@03)                           0654
         L     @03,@TF00001                                        0654
         ST    @08,@TF00001                                        0654
         ALR   @08,@03                                             0654
         BCTR  @08,0                                               0654
         TM    ICTMIDTY-7(@08),B'00000001'                         0654
         BNO   @RF00654                                            0654
         TM    ICTMIDTY-7(@08),B'00000010'                         0654
         BNZ   @RF00654                                            0654
*           DO;                                                    0655
*             LASTRMID=ICTMODID(RR);/* LAST RMID SYSMOD-ID           */
         LR    @08,@03                                             0656
         AL    @08,@TF00001                                        0656
         AL    @08,@CF02046                                        0656
         MVC   LASTRMID(7),ICTMODID(@08)                           0656
*             IF ICTMIDAM(RR)=ON    /* RMID RESULT OF ASSEMBLY       */
*               THEN                                               0657
         AL    @03,@TF00001                                        0657
         BCTR  @03,0                                               0657
         TM    ICTMIDAM-7(@03),B'00000100'                         0657
         BNO   @RF00657                                            0657
*               LRMIDASM=ON;        /* SET FLAG                      */
         OI    LRMIDASM,B'10000000'                                0658
*           END;                                                   0659
@RF00657 DS    0H                                                  0660
*       END;                                                       0660
@RF00654 AH    RR,@CH00067                                         0660
@DE00651 LR    @08,RR                                              0660
         SLA   @08,3                                               0660
         L     @03,CMOD                                            0660
         MVC   @TF00001(4),ICTMICHN(@03)                           0660
         L     @03,@TF00001                                        0660
         AL    @03,@CF02046                                        0660
         L     @08,ICTMIDND(@08,@03)                               0660
         CL    @08,ICTENDIX                                        0660
         BNE   @DL00651                                            0660
*     END;                                                         0661
*   RETURN;                                                        0662
@EL00006 DS    0H                                                  0662
@EF00006 DS    0H                                                  0662
@ER00006 LM    @14,@12,@SA00006                                    0662
         BR    @14                                                 0662
*   END GETMIDS;                                                   0663
         B     @EL00006                                            0663
*                                                                  0664
*/********************************************************************/
*/*                                                                  */
*/*    UMIDCHK - UMID CHECK FOR REPLACEMENT AND UPDATE-TYPE          */
*/*               ELEMENTS:                                          */
*/*                                                                  */
*/*             - CHECK THAT ALL UPDATES (UMIDS) TO THE LAST SELECTED*/
*/*               VERSION OF THE "CURRENT" ELEMENT ARE PREREQD OR    */
*/*               SUPERSEDED.  NOTE THAT UPDATES TO AN ELEMENT ARE   */
*/*               FOUND IN BOTH THE ICT MOD SECTION AND THE (A)CDS   */
*/*               MODID LIST ASSOCIATED WITH THE "CURRENT" ELEMENT.  */
*/*                                                                  */
*/*               IF THE LAST REPLACEMENT TO AN ELEMENT IS IN THE    */
*/*               ICT (LREPELM@^=0), ONLY UPDATES TO THE ELEMENT     */
*/*               WHICH ARE IN THE ICT ARE CHECKED.  IF THE LAST     */
*/*               REPLACEMENT TO AN ELEMENT IS THE (A)CDS VERSION,   */
*/*               UPDATES IN THE ICT AND UPDATES IN THE (A)CDS MODID */
*/*               LIST ARE CHECKED.                                  */
*/*                                                                  */
*/*                                                                  */
*/*             - FOR REPLACEMENT ELEMENTS AND UPDATE ELEMENTS FOR   */
*/*               WHICH THERE IS NO REPLACEMENT IN THE ICT, THE      */
*/*               MODIDS IN THE (A)CDS MODID LIST ARE CHECKED TO     */
*/*               DETERMINE WHETHER THEY ARE PREREQ'D OR SUP'D BY    */
*/*               THE SYSMOD SUPPLYING THE "CURRENT" ELEMENT.        */
*/*                                                                  */
*/*               ICTMIDPL IS SET IN THE MODID LIST ENTRY IF THE     */
*/*               MODID IS PREREQ'D OR SUP'D BY THE SYSMOD SUPPLYING */
*/*               THE "CURRENT" ELEMENT.                             */
*/*                                                                  */
*/*             - MESSAGE HMA319I IS ISSUED FOR ANY UPDATE-MODID     */
*/*               (UMID) IN EITHER THE ICT OR (A)CDS MODID LIST      */
*/*               WHICH IS NOT PREREQ'D OR SUP'D AS THE "CURRENT"    */
*/*               ELEMENT IS POTENTIALLY DOWN-LEVELING THE INTER-    */
*/*               SECTED-WITH ELEMENT.                               */
*/*                                                                  */
*/*             - SET UMIDERR ON  IF ANY UMIDS  ARE NOT PREREQD/SUPD */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                                                                  */
*/*     * REPFLG  -  '1' IF "CURRENT" ELEMENT IS A REPLACEMENT-TYPE  */
*/*     * UPDFLG  -  '1' IF "CURRENT" ELEMENT IS AN UPDATE-TYPE      */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*     * LASTRMID - CONTAINS THE NAME OF THE SYSMOD WHICH LAST      */
*/*                  REPLACED THE "CURRENT" ELEMENT.                 */
*/*                                                                  */
*/*     * LREPELM@ -  0  => LAST REPLACEMENT IS (A)CDS VERSION OF    */
*/*                         THE ELEMENT ... NO REPLACEMENT IN ICT    */
*/*                                                                  */
*/*                  ^0  - LAST REPLACEMENT IS ICT VERSION OF THE    */
*/*                         ELEMENT (LREPELM@ POINTS TO ICT MOD      */
*/*                         SECT ENTRY REPRESENTING LAST REPLACEMENT)*/
*/*                                                                  */
*/*     * RMIDERR  - '1' => ELEMENT RMID ERROR                       */
*/*                  '0' => NO RMID ERROR                            */
*/*                                                                  */
*/*     * MGPTYPE  - SET TO THE VALUE FOR THE DESIRED MESSAGE        */
*/*                  SEVERITY FOR HMA382I                            */
*/*                  MGPWARN - ISSUE WARNING MESSAGE  (RC = 4)       */
*/*                  MGPERR  - ISSUE ERROR MESSAGE  (RC = 8)         */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * UMIDERR -  0 - ALL UMIDS CHECKED "OK"                      */
*/*                  1 - SOME UMIDS WERE NOT PREREQD AND/OR SUPD     */
*/*                                                                  */
*/*     * ICTMIDPL - SET/CLEARED IN (A)CDS MODID LIST                */
*/*                  (FOR FMID, RMID AND UMID MODIDS)                */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0664
*UMIDCHK:                                                          0664
*   PROC(UMIDMSG);                                                 0664
UMIDCHK  STM   @14,@04,@SA00007                                    0664
         STM   @06,@12,@SA00007+28                                 0664
         MVC   @PC00007(4),0(@01)                                  0664
*   DCL                                                            0665
*     UMIDMSG CHAR(1);              /* 'Y' - ISSUE MESSAGES .........
*                                      'N' - DO NOT ISSUE MESSAGES . */
*   DCL                                                            0666
*     KK FIXED(15);                 /* LOCAL INDEX                   */
*   DCL                                                            0667
*     UMIDSMID CHAR(7);             /* UMID SYSMOD-ID                */
*   RESPECIFY                                                      0668
*     ICTPTF BASED(CPTF);           /* "CURRENT" SYSMOD              */
*   RESPECIFY                                                      0669
*     ICTMOD BASED(CCAICMOD);       /* THE ENTIRE ICT MOD SECTION    */
*                                                                  0670
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ALL ENTRIES IN THE ICT MOD SECTION LOOKING FOR OTHER  */
*   /* UPDATES TO THE "CURRENT" ELEMENT                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0670
*   VPART#3=MSGSEL;                 /* SET "SELECTED" IN HMA319 MSG  */
         MVC   VPART#3(8),@CC01841                                 0670
*   VPART#4=MSGUMID;                /* SET "UMID" IN HMA319 MSG      */
         MVC   VPART#4(8),@CC01839                                 0671
*   DO KK=1 BY 1 WHILE ICTMEND(KK)^=ICTENDNT;                      0672
         LA    KK,1                                                0672
         B     @DE00672                                            0672
@DL00672 DS    0H                                                  0673
*     IF ICTMISEL(KK)=ON            /* SELECTED ?                    */
*         &ICTMNAME(KK)=CMOD->ICTMNAME(1)/* NAME = "CURRENT" ELEMENT */
*         &ADDR(ICTMOD(KK))^=CMOD   /* NOT SELF                      */
*       THEN                                                       0673
         LR    @08,KK                                              0673
         MH    @08,@CH02013                                        0673
         L     @04,CCAICMOD(,CCAPTR)                               0673
         ST    @08,@TF00001                                        0673
         ALR   @08,@04                                             0673
         AL    @08,@CF02033                                        0673
         TM    ICTMISEL-11(@08),B'10000000'                        0673
         BNO   @RF00673                                            0673
         L     @08,CMOD                                            0673
         LR    @03,@04                                             0673
         AL    @03,@TF00001                                        0673
         AL    @03,@CF02036                                        0673
         CLC   ICTMNAME(8,@03),ICTMNAME(@08)                       0673
         BNE   @RF00673                                            0673
         L     @03,@TF00001                                        0673
         AL    @04,@CF02036                                        0673
         LA    @04,ICTMOD(@03,@04)                                 0673
         CR    @04,@08                                             0673
         BE    @RF00673                                            0673
*       DO;                                                        0674
*         CALL INTRSECT(CMOD,       /* "CURRENT" ELEMENT             */
*             ADDR(ICTMOD(KK)),     /* ICT-ELEMENT                   */
*             ITYPE);               /* ELEMENT TYPES (RETURNED)      */
         ST    @04,@AFTEMPS+4                                      0675
         LA    @01,@AL00675                                        0675
         BAL   @14,INTRSECT                                        0675
*         IF ITYPE=REPUPD           /* REPLACEMENT TO UPDATE         */
*             ×ITYPE=UPDUPD         /* UPDATE TO UPDATE              */
*           THEN                                                   0676
         CLI   ITYPE,2                                             0676
         BE    @RT00676                                            0676
         CLI   ITYPE,8                                             0676
         BNE   @RF00676                                            0676
@RT00676 DS    0H                                                  0677
*           DO;                                                    0677
*             UMIDSMID=ICTPPTR(KK)->ICTPTFS(1);/* NAME OF SYSMOD   0678
*                                      WHICH SUPPLIED UPDATE ELEMENT
*                                      FOUND IN ICT                  */
         LR    @08,KK                                              0678
         MH    @08,@CH02013                                        0678
         L     @04,CCAICMOD(,CCAPTR)                               0678
         AL    @04,@CF02034                                        0678
         L     @08,ICTPPTR-96(@08,@04)                             0678
         MVC   UMIDSMID(7),ICTPTFS(@08)                            0678
*             CALL HMASMTPS(CPTF,   /* "CURRENT" SYSMOD              */
*                 UMIDSMID,         /* UPDATE FOUND IN ICT           */
*                 TPSRTN);          /* CHECK PRE/SUP                 */
         MVC   @AL00001+4(8),@AL00679                              0679
         L     @08,@PC00001+4                                      0679
         ST    @08,@AL00001                                        0679
         L     @15,@CV01714                                        0679
         LA    @01,@AL00001                                        0679
         BALR  @14,@15                                             0679
*             IF TPSRTN^=PRESUP     /* PRE/SUP RELATIONSHIP          */
*               THEN                                               0680
         CLI   TPSRTN,232                                          0680
         BE    @RF00680                                            0680
*               DO;                                                0681
*                                                                  0681
*                 /***************************************************/
*                 /*                                                 */
*                 /* THE CURRENT ELEMENT DOES NOT PREREQ OR SUP AN   */
*                 /* UPDATE FOUND IN THE ICT                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0682
*                 UMIDERR=ON;       /* SET UMID ERROR FLAG           */
         OI    UMIDERR,B'01000000'                                 0682
*                 IF UMIDMSG=MSG    /* MESSAGES SHOULD BE ISSUED     */
*                   THEN                                           0683
         L     @08,@PC00007                                        0683
         CLI   UMIDMSG(@08),C'Y'                                   0683
         BNE   @RF00683                                            0683
*                   DO;                                            0684
*                     IF MSG382I=OFF/* HMA382I MSG NOT ISSUED        */
*                       THEN                                       0685
         TM    MSG382I,B'00100000'                                 0685
         BNZ   @RF00685                                            0685
*                       DO;                                        0686
*                         CALL ERRMSG(HMA382I,NOPART);/* ISSUE     0687
*                                      HMA382I                       */
         LA    @01,@AL00687                                        0687
         BAL   @14,ERRMSG                                          0687
*                         MSG382I=ON;/* SET HMA382I MSG ISSUED FLAG  */
         OI    MSG382I,B'00100000'                                 0688
*                       END;                                       0689
*                     VPART#5=UMIDSMID;/* ICT UMID SYSMOD-ID IN MSG  */
@RF00685 MVI   VPART#5+7,C' '                                      0690
         MVC   VPART#5(7),UMIDSMID                                 0690
*                     CALL ERRMSG(HMA319I,NOPART);/* ISSUE MESSAGE   */
         LA    @01,@AL00691                                        0691
         BAL   @14,ERRMSG                                          0691
*                   END;                                           0692
*               END;                                               0693
@RF00683 DS    0H                                                  0694
*           END;                                                   0694
@RF00680 DS    0H                                                  0695
*       END;                                                       0695
@RF00676 DS    0H                                                  0696
*   END;                                                           0696
@RF00673 AH    KK,@CH00067                                         0696
@DE00672 LR    @08,KK                                              0696
         MH    @08,@CH02013                                        0696
         L     @04,CCAICMOD(,CCAPTR)                               0696
         ALR   @04,@08                                             0696
         AL    @04,@CF02036                                        0696
         MVC   @TF00001(4),ICTMEND(@04)                            0696
         L     @08,@TF00001                                        0696
         CL    @08,ICTENDNT                                        0696
         BNE   @DL00672                                            0696
*                                                                  0697
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE WHETHER THE "CURRENT" SYSMOD PREREQS OR SUPERSEDES  */
*   /* THE RMID AND ALL UMIDS FOUND IN THE (A)CDS MODID LIST         */
*   /* ASSOCIATED WITH THE "CURRENT" ELEMENT. ISSUE MSG HMA319 FOR   */
*   /* UMID CHECKS ONLY ... RMID CHECK MESSAGES HAVE ALREADY BEEN    */
*   /* ISSUED AT THIS POINT.                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0697
*   VPART#3=MSGXCDS;                /* "SMPCDS" OR "SMPACDS" FOR   0697
*                                      HMA319I MSG                   */
         MVC   VPART#3(8),MSGXCDS                                  0697
*   VPART#4=MSGUMID;                /* "UMID" FOR HMA319I MSG        */
         MVC   VPART#4(8),@CC01839                                 0698
*   RESPECIFY                                                      0699
*     ICTMOD BASED(CMOD);           /* "CURRENT" ELEMENT             */
*   RESPECIFY                                                      0700
*     ICTMIDLS BASED(ICTMICHN(1));  /* "CURRENT" ELEMENT'S MODID LIST*/
*                                                                  0700
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ELEMENT'S MODID LIST                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0701
*   DO KK=1 BY 1 WHILE ICTMIDND(KK)^=ICTENDIX;                     0701
         LA    KK,1                                                0701
         B     @DE00701                                            0701
@DL00701 DS    0H                                                  0702
*     IF ICTMIDTY(KK)=ICTMIDFM      /* FMID MODID                    */
*       THEN                                                       0702
         LR    @08,KK                                              0702
         SLA   @08,3                                               0702
         L     @04,CMOD                                            0702
         MVC   @TF00001(4),ICTMICHN(@04)                           0702
         L     @04,@TF00001                                        0702
         ST    @08,@TF00001                                        0702
         ALR   @08,@04                                             0702
         BCTR  @08,0                                               0702
         TM    ICTMIDTY-7(@08),B'00000010'                         0702
         BNO   @RF00702                                            0702
         TM    ICTMIDTY-7(@08),B'00000001'                         0702
         BNZ   @RF00702                                            0702
*       ICTMIDPL(KK)=ON;            /* FMID IS ALWAYS "OK"           */
*                                                                  0703
         AL    @04,@TF00001                                        0703
         BCTR  @04,0                                               0703
         OI    ICTMIDPL-7(@04),B'00100000'                         0703
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE WHETHER MODID IS PREREQ'D OR SUP'D BY SYSMOD      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0704
*     IF ICTMIDTY(KK)=ICTMIDUP      /* UMID MODID                    */
*         ×ICTMIDTY(KK)=ICTMIDRM    /* RMID MODID                    */
*       THEN                                                       0704
@RF00702 LR    @08,KK                                              0704
         SLA   @08,3                                               0704
         L     @04,CMOD                                            0704
         MVC   @TF00001(4),ICTMICHN(@04)                           0704
         L     @04,@TF00001                                        0704
         ST    @08,@TF00001                                        0704
         ALR   @08,@04                                             0704
         BCTR  @08,0                                               0704
         TM    ICTMIDTY-7(@08),B'00000011'                         0704
         BZ    @RT00704                                            0704
         AL    @04,@TF00001                                        0704
         BCTR  @04,0                                               0704
         TM    ICTMIDTY-7(@04),B'00000001'                         0704
         BNO   @RF00704                                            0704
         TM    ICTMIDTY-7(@04),B'00000010'                         0704
         BNZ   @RF00704                                            0704
@RT00704 DS    0H                                                  0705
*       DO;                                                        0705
*         IF LREPELM@=0             /* NO REPLACEMENT IN ICT         */
*             &ICTMIDTY(KK)=ICTMIDRM/* THIS IS (A)CDS RMID           */
*           THEN                                                   0706
         L     @08,LREPELM@                                        0706
         LTR   @08,@08                                             0706
         BNZ   @RF00706                                            0706
         LR    @08,KK                                              0706
         SLA   @08,3                                               0706
         L     @04,CMOD                                            0706
         MVC   @TF00001(4),ICTMICHN(@04)                           0706
         L     @04,@TF00001                                        0706
         ALR   @04,@08                                             0706
         BCTR  @04,0                                               0706
         TM    ICTMIDTY-7(@04),B'00000001'                         0706
         BNO   @RF00706                                            0706
         TM    ICTMIDTY-7(@04),B'00000010'                         0706
         BNZ   @RF00706                                            0706
*           DO;                     /* THIS RMID WAS ALREADY CHECKED */
*             IF RMIDERR=OFF        /* ELEMENT DID NOT HAVE RMID ERR */
*               THEN                                               0708
         TM    RMIDERR,B'10000000'                                 0708
         BNZ   @RF00708                                            0708
*               TPSRTN=PRESUP;      /* INDICATE RMID WAS PRE OR SUPD */
         MVI   TPSRTN,X'E8'                                        0709
*             ELSE                                                 0710
*               TPSRTN=INVALID;     /* INDICATE RMID NOT PRE OR SUPD */
         B     @RC00708                                            0710
@RF00708 MVI   TPSRTN,X'D5'                                        0710
*           END;                                                   0711
*         ELSE                                                     0712
*           CALL HMASMTPS(CPTF,     /* "CURRENT" SYSMOD              */
*               ICTMODID(KK),       /* MODID FROM (A)CDS MODID LIST  */
*               TPSRTN);            /* CHECK PRE/SUP OF MODID BY SMD */
*                                                                  0712
         B     @RC00706                                            0712
@RF00706 L     @08,@PC00001+4                                      0712
         ST    @08,@AL00001                                        0712
         LR    @08,KK                                              0712
         SLA   @08,3                                               0712
         L     @04,CMOD                                            0712
         MVC   @TF00001(4),ICTMICHN(@04)                           0712
         L     @04,@TF00001                                        0712
         AL    @04,@CF02046                                        0712
         LA    @08,ICTMODID(@08,@04)                               0712
         ST    @08,@AL00001+4                                      0712
         LA    @08,TPSRTN                                          0712
         ST    @08,@AL00001+8                                      0712
         L     @15,@CV01714                                        0712
         LA    @01,@AL00001                                        0712
         BALR  @14,@15                                             0712
*         /***********************************************************/
*         /*                                                         */
*         /* SET OR CLEAR MODID PRE/SUP FLAG IN MODID LIST ENTRY     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0713
*         IF REPFLG=ON              /* REPL ELEM. BEING PROCESSED    */
*             ×(UPDFLG=ON           /* UPDATE ELEM. BEING PROCESSED  */
*             &LREPELM@=0)          /* ... WITH NO REPL IN ICT       */
*           THEN                                                   0713
@RC00706 TM    REPFLG,B'00001000'                                  0713
         BO    @RT00713                                            0713
         TM    UPDFLG,B'00000100'                                  0713
         BNO   @RF00713                                            0713
         L     @08,LREPELM@                                        0713
         LTR   @08,@08                                             0713
         BNZ   @RF00713                                            0713
@RT00713 DS    0H                                                  0714
*           DO;                                                    0714
*             IF TPSRTN^=PRESUP     /* DOES NOT PRE/SUP MODID        */
*               THEN                                               0715
         CLI   TPSRTN,232                                          0715
         BE    @RF00715                                            0715
*               ICTMIDPL(KK)=OFF;   /* CLEAR MODID PRE/SUP FLAG      */
         LR    @08,KK                                              0716
         SLA   @08,3                                               0716
         L     @04,CMOD                                            0716
         MVC   @TF00001(4),ICTMICHN(@04)                           0716
         L     @04,@TF00001                                        0716
         ALR   @04,@08                                             0716
         BCTR  @04,0                                               0716
         NI    ICTMIDPL-7(@04),B'11011111'                         0716
*             ELSE                                                 0717
*               ICTMIDPL(KK)=ON;    /* SET MODID PRE/SUP FLAG        */
         B     @RC00715                                            0717
@RF00715 LR    @08,KK                                              0717
         SLA   @08,3                                               0717
         L     @04,CMOD                                            0717
         MVC   @TF00001(4),ICTMICHN(@04)                           0717
         L     @04,@TF00001                                        0717
         ALR   @04,@08                                             0717
         BCTR  @04,0                                               0717
         OI    ICTMIDPL-7(@04),B'00100000'                         0717
*           END;                                                   0718
*                                                                  0718
@RC00715 DS    0H                                                  0719
*         /***********************************************************/
*         /*                                                         */
*         /* FOR UMIDS (WITH NO REPLACEMENT IN ICT), SET UMIDERR     */
*         /* INDICATOR AND ISSUE HMA319I                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0719
*         IF TPSRTN^=PRESUP         /* DOES NOT PRE/SUP MODID        */
*             &LREPELM@=0           /* NO REPLACEMENT ELEMENT IN ICT */
*             &ICTMIDTY(KK)=ICTMIDUP/* THIS IS A UMID                */
*           THEN                                                   0719
@RF00713 CLI   TPSRTN,232                                          0719
         BE    @RF00719                                            0719
         L     @08,LREPELM@                                        0719
         LTR   @08,@08                                             0719
         BNZ   @RF00719                                            0719
         LR    @08,KK                                              0719
         SLA   @08,3                                               0719
         L     @04,CMOD                                            0719
         MVC   @TF00001(4),ICTMICHN(@04)                           0719
         L     @04,@TF00001                                        0719
         ALR   @04,@08                                             0719
         BCTR  @04,0                                               0719
         TM    ICTMIDTY-7(@04),B'00000011'                         0719
         BNZ   @RF00719                                            0719
*           DO;                                                    0720
*             UMIDERR=ON;           /* SET UMID ERROR FLAG           */
         OI    UMIDERR,B'01000000'                                 0721
*             IF UMIDMSG=MSG        /* MESSAGES SHOULD BE ISSUED     */
*               THEN                                               0722
         L     @08,@PC00007                                        0722
         CLI   UMIDMSG(@08),C'Y'                                   0722
         BNE   @RF00722                                            0722
*               DO;                                                0723
*                 IF MSG382I=OFF    /* HMA382I MSG NOT ISSUED        */
*                   THEN                                           0724
         TM    MSG382I,B'00100000'                                 0724
         BNZ   @RF00724                                            0724
*                   CALL ERRMSG(HMA382I,NOPART);/* ISSUE IT          */
         LA    @01,@AL00725                                        0725
         BAL   @14,ERRMSG                                          0725
*                 MSG382I=ON;       /* HMA382I MSG ISSUED            */
@RF00724 OI    MSG382I,B'00100000'                                 0726
*                 VPART#5=ICTMODID(KK);/* UMID SYSMOD-ID FOR HMA319I
*                                      MSG                           */
         MVI   VPART#5+7,C' '                                      0727
         LR    @08,KK                                              0727
         SLA   @08,3                                               0727
         L     @04,CMOD                                            0727
         MVC   @TF00001(4),ICTMICHN(@04)                           0727
         L     @04,@TF00001                                        0727
         ALR   @04,@08                                             0727
         AL    @04,@CF02046                                        0727
         MVC   VPART#5(7),ICTMODID(@04)                            0727
*                 CALL ERRMSG(HMA319I,NOPART);/* ISSUE MSG           */
         LA    @01,@AL00728                                        0728
         BAL   @14,ERRMSG                                          0728
*               END;                                               0729
*           END;                                                   0730
@RF00722 DS    0H                                                  0731
*       END;                                                       0731
@RF00719 DS    0H                                                  0732
*   END;                                                           0732
@RF00704 AH    KK,@CH00067                                         0732
@DE00701 LR    @08,KK                                              0732
         SLA   @08,3                                               0732
         L     @04,CMOD                                            0732
         MVC   @TF00001(4),ICTMICHN(@04)                           0732
         L     @04,@TF00001                                        0732
         AL    @04,@CF02046                                        0732
         L     @08,ICTMIDND(@08,@04)                               0732
         CL    @08,ICTENDIX                                        0732
         BNE   @DL00701                                            0732
*   RETURN;                                                        0733
@EL00007 DS    0H                                                  0733
@EF00007 DS    0H                                                  0733
@ER00007 LM    @14,@04,@SA00007                                    0733
         LM    @06,@12,@SA00007+28                                 0733
         BR    @14                                                 0733
*   END UMIDCHK;                                                   0734
*                                                                  0735
*/********************************************************************/
*/*                                                                  */
*/*    INTRSECT - WHEN TWO ELEMENTS ARE FOUND IN THE ICT WITH THE    */
*/*               SAME NAMES, DETERMINE THE TYPE OF INTERSECTION     */
*/*               INVOLVED.                                          */
*/*                                                                  */
*/*               NONE   - "CURRENT" ELEMENT AND "OTHER" ELEMENT     */
*/*                        ARE NOT COMPATIBLE WITH ONE ANOTHER.      */
*/*                        (I.E., A ++MOD AND A ++MAC).              */
*/*                                                                  */
*/*               REPREP - * "CURRENT" ELEMENT IS A REPLACEMENT      */
*/*                        * "OTHER" ELEMENT IS A REPLACEMENT        */
*/*                                                                  */
*/*               REPUPD - * "CURRENT" ELEMENT IS A REPLACEMENT      */
*/*                        * "OTHER" ELEMENT IS AN UPDATE            */
*/*                                                                  */
*/*               UPDREP - * "CURRENT" ELEMENT IS AN UPDATE          */
*/*                        * "OTHER" ELEMENT IS A REPLACEMENT        */
*/*                                                                  */
*/*               UPDUPD - * "CURRENT" ELEMENT IS AN UPDATE          */
*/*                        * "OTHER" ELEMENT IS AN UPDATE            */
*/*                                                                  */
*/*               SRCMOD - * "CURRENT" ELEMENT IS A SRC REPL         */
*/*                        * "OTHER" ELEMENT IS A MOD REPL           */
*/*                                                                  */
*/*               SRCUMOD- * "CURRENT" ELEMENT IS A SRC UPDATE       */
*/*                        * "OTHER" ELEMENT IS A MOD REPL           */
*/*                                                                  */
*/*               MODSRC - * "CURRENT" ELEMENT IS A MOD REPL         */
*/*                        * "OTHER" ELEMENT IS A SRC REPL           */
*/*                                                                  */
*/*               MODSRCU- * "CURRENT" ELEMENT IS A MOD REPL         */
*/*                        * "OTHER" ELEMENT IS A SRC UPDATE         */
*/*                                                                  */
*/*               MODXPND- * "CURRENT" ELEMENT IS A MOD REPL         */
*/*                        * "OTHER" ELEMENT IS A LKED FOR EXPAND    */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0735
*INTRSECT:                                                         0735
*   PROC(PTRC,PTRO,INTRTYPE);                                      0735
INTRSECT STM   @14,@12,12(@13)                                     0735
         MVC   @PC00008(12),0(@01)                                 0735
*   DCL                                                            0736
*     PTRC PTR(31);                 /* PTR TO "CURRENT" ELEMENT'S ICT
*                                      MOD SECTION ENTRY             */
*   DCL                                                            0737
*     PTRO PTR(31);                 /* PTR TO "OTHER" ELEMENT'S ICT
*                                      MOD SECTION ENTRY             */
*   DCL                                                            0738
*     INTRTYPE FIXED(8);            /* RETURNS INTERSECTION TYPE (SEE
*                                      ABOVE)                        */
*   RESPECIFY                                                      0739
*     ICTMOD BASED(PTRC);           /* ADDRESS "CURRENT" ELEMENT     */
*   INTRTYPE=NONE;                  /* INITIALIZE INTERSECTION TYPE
*                                      TO "NONE"                     */
*                                                                  0740
         L     @08,@PC00008+8                                      0740
         MVI   INTRTYPE(@08),X'00'                                 0740
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPATIBLE INTERSECTIONS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0741
*   IF ICTMMOD(1)=ON                /* "CURRENT" A MOD REPL          */
*       &PTRO->ICTMMOD(1)=ON        /* "OTHER" A MOD REPL            */
*     THEN                                                         0741
         L     @15,@PC00008                                        0741
         L     @01,PTRC(,@15)                                      0741
         TM    ICTMMOD(@01),B'10000000'                            0741
         BNO   @RF00741                                            0741
         L     @15,@PC00008+4                                      0741
         L     @01,PTRO(,@15)                                      0741
         TM    ICTMMOD(@01),B'10000000'                            0741
         BNO   @RF00741                                            0741
*     INTRTYPE=REPREP;              /* <--- BOTH REPLACEMENTS        */
         MVI   INTRTYPE(@08),X'01'                                 0742
*   IF ICTMMACR(1)=ON               /* "CURRENT" A ++MAC ?           */
*       &PTRO->ICTMMACR(1)=ON       /* "OTHER" A ++MAC ?             */
*     THEN                                                         0743
@RF00741 L     @08,@PC00008                                        0743
         L     @08,PTRC(,@08)                                      0743
         TM    ICTMMACR(@08),B'00001000'                           0743
         BNO   @RF00743                                            0743
         L     @08,@PC00008+4                                      0743
         L     @08,PTRO(,@08)                                      0743
         TM    ICTMMACR(@08),B'00001000'                           0743
         BNO   @RF00743                                            0743
*     INTRTYPE=REPREP;              /* <--- BOTH REPLACEMENTS        */
         L     @08,@PC00008+8                                      0744
         MVI   INTRTYPE(@08),X'01'                                 0744
*   IF ICTMSRCR(1)=ON               /* "CURRENT" A ++SRC ?           */
*       &PTRO->ICTMSRCR(1)=ON       /* "OTHER" A ++SRC ?             */
*     THEN                                                         0745
@RF00743 L     @08,@PC00008                                        0745
         L     @08,PTRC(,@08)                                      0745
         TM    ICTMSRCR(@08),B'00000010'                           0745
         BNO   @RF00745                                            0745
         L     @08,@PC00008+4                                      0745
         L     @08,PTRO(,@08)                                      0745
         TM    ICTMSRCR(@08),B'00000010'                           0745
         BNO   @RF00745                                            0745
*     INTRTYPE=REPREP;              /* <--- BOTH REPLACEMENTS        */
         L     @08,@PC00008+8                                      0746
         MVI   INTRTYPE(@08),X'01'                                 0746
*   IF ICTMMOD(1)=ON                /* "CURRENT" A MOD REPL ?        */
*       &PTRO->ICTMZAP(1)=ON        /* "OTHER" A ++ZAP ?             */
*     THEN                                                         0747
@RF00745 L     @08,@PC00008                                        0747
         L     @08,PTRC(,@08)                                      0747
         TM    ICTMMOD(@08),B'10000000'                            0747
         BNO   @RF00747                                            0747
         L     @08,@PC00008+4                                      0747
         L     @08,PTRO(,@08)                                      0747
         TM    ICTMZAP(@08),B'00100000'                            0747
         BNO   @RF00747                                            0747
*     INTRTYPE=REPUPD;              /* <--- REPLACEMENT ON UPDATE    */
         L     @08,@PC00008+8                                      0748
         MVI   INTRTYPE(@08),X'02'                                 0748
*   IF ICTMMACR(1)=ON               /* "CURRENT" A ++MAC ?           */
*       &PTRO->ICTMMACU(1)=ON       /* "OTHER" A ++MACUPD ?          */
*     THEN                                                         0749
@RF00747 L     @08,@PC00008                                        0749
         L     @08,PTRC(,@08)                                      0749
         TM    ICTMMACR(@08),B'00001000'                           0749
         BNO   @RF00749                                            0749
         L     @08,@PC00008+4                                      0749
         L     @08,PTRO(,@08)                                      0749
         TM    ICTMMACU(@08),B'00000100'                           0749
         BNO   @RF00749                                            0749
*     INTRTYPE=REPUPD;              /* <--- REPLACEMENT ON UPDATE    */
         L     @08,@PC00008+8                                      0750
         MVI   INTRTYPE(@08),X'02'                                 0750
*   IF ICTMSRCR(1)=ON               /* "CURRENT" A ++SRC ?           */
*       &PTRO->ICTMSRCU(1)=ON       /* "OTHER" A ++SRCUPD ?          */
*     THEN                                                         0751
@RF00749 L     @08,@PC00008                                        0751
         L     @08,PTRC(,@08)                                      0751
         TM    ICTMSRCR(@08),B'00000010'                           0751
         BNO   @RF00751                                            0751
         L     @08,@PC00008+4                                      0751
         L     @08,PTRO(,@08)                                      0751
         TM    ICTMSRCU(@08),B'00000001'                           0751
         BNO   @RF00751                                            0751
*     INTRTYPE=REPUPD;              /* <--- REPLACEMENT ON UPDATE    */
         L     @08,@PC00008+8                                      0752
         MVI   INTRTYPE(@08),X'02'                                 0752
*   IF ICTMZAP(1)=ON                /* "CURRENT" A ++ZAP ?           */
*       &PTRO->ICTMMOD(1)=ON        /* "OTHER" A MOD REPL?           */
*     THEN                                                         0753
@RF00751 L     @08,@PC00008                                        0753
         L     @08,PTRC(,@08)                                      0753
         TM    ICTMZAP(@08),B'00100000'                            0753
         BNO   @RF00753                                            0753
         L     @08,@PC00008+4                                      0753
         L     @08,PTRO(,@08)                                      0753
         TM    ICTMMOD(@08),B'10000000'                            0753
         BNO   @RF00753                                            0753
*     INTRTYPE=UPDREP;              /* <--- UPDATE ON REPLACEMENT    */
         L     @08,@PC00008+8                                      0754
         MVI   INTRTYPE(@08),X'04'                                 0754
*   IF ICTMMACU(1)=ON               /* "CURRENT" A ++MACUPD ?        */
*       &PTRO->ICTMMACR(1)=ON       /* "OTHER" A ++MAC ?             */
*     THEN                                                         0755
@RF00753 L     @08,@PC00008                                        0755
         L     @08,PTRC(,@08)                                      0755
         TM    ICTMMACU(@08),B'00000100'                           0755
         BNO   @RF00755                                            0755
         L     @08,@PC00008+4                                      0755
         L     @08,PTRO(,@08)                                      0755
         TM    ICTMMACR(@08),B'00001000'                           0755
         BNO   @RF00755                                            0755
*     INTRTYPE=UPDREP;              /* <--- UPDATE ON REPLACEMENT    */
         L     @08,@PC00008+8                                      0756
         MVI   INTRTYPE(@08),X'04'                                 0756
*   IF ICTMSRCU(1)=ON               /* "CURRENT" A ++SRCUPD ?        */
*       &PTRO->ICTMSRCR(1)=ON       /* "OTHER" A ++SRC ?             */
*     THEN                                                         0757
@RF00755 L     @08,@PC00008                                        0757
         L     @08,PTRC(,@08)                                      0757
         TM    ICTMSRCU(@08),B'00000001'                           0757
         BNO   @RF00757                                            0757
         L     @08,@PC00008+4                                      0757
         L     @08,PTRO(,@08)                                      0757
         TM    ICTMSRCR(@08),B'00000010'                           0757
         BNO   @RF00757                                            0757
*     INTRTYPE=UPDREP;              /* <--- UPDATE ON REPLACEMENT    */
         L     @08,@PC00008+8                                      0758
         MVI   INTRTYPE(@08),X'04'                                 0758
*   IF ICTMZAP(1)=ON                /* "CURRENT" A ++ZAP ?           */
*       &PTRO->ICTMZAP(1)=ON        /* "OTHER" A ++ZAP ?             */
*     THEN                                                         0759
@RF00757 L     @08,@PC00008                                        0759
         L     @08,PTRC(,@08)                                      0759
         TM    ICTMZAP(@08),B'00100000'                            0759
         BNO   @RF00759                                            0759
         L     @08,@PC00008+4                                      0759
         L     @08,PTRO(,@08)                                      0759
         TM    ICTMZAP(@08),B'00100000'                            0759
         BNO   @RF00759                                            0759
*     INTRTYPE=UPDUPD;              /* <--- UPDATE ON UPDATE         */
         L     @08,@PC00008+8                                      0760
         MVI   INTRTYPE(@08),X'08'                                 0760
*   IF ICTMMACU(1)=ON               /* "CURRENT" A ++MACUPD ?        */
*       &PTRO->ICTMMACU(1)=ON       /* "OTHER" A ++MACUPD ?          */
*     THEN                                                         0761
@RF00759 L     @08,@PC00008                                        0761
         L     @08,PTRC(,@08)                                      0761
         TM    ICTMMACU(@08),B'00000100'                           0761
         BNO   @RF00761                                            0761
         L     @08,@PC00008+4                                      0761
         L     @08,PTRO(,@08)                                      0761
         TM    ICTMMACU(@08),B'00000100'                           0761
         BNO   @RF00761                                            0761
*     INTRTYPE=UPDUPD;              /* <--- UPDATE ON UPDATE         */
         L     @08,@PC00008+8                                      0762
         MVI   INTRTYPE(@08),X'08'                                 0762
*   IF ICTMSRCU(1)=ON               /* "CURRENT" A ++SRCUPD ?        */
*       &PTRO->ICTMSRCU(1)=ON       /* "OTHER" A ++SRCUPD ?          */
*     THEN                                                         0763
@RF00761 L     @08,@PC00008                                        0763
         L     @08,PTRC(,@08)                                      0763
         TM    ICTMSRCU(@08),B'00000001'                           0763
         BNO   @RF00763                                            0763
         L     @08,@PC00008+4                                      0763
         L     @08,PTRO(,@08)                                      0763
         TM    ICTMSRCU(@08),B'00000001'                           0763
         BNO   @RF00763                                            0763
*     INTRTYPE=UPDUPD;              /* <--- UPDATE ON UPDATE         */
*                                                                  0764
         L     @08,@PC00008+8                                      0764
         MVI   INTRTYPE(@08),X'08'                                 0764
*   /*****************************************************************/
*   /*                                                               */
*   /* SRC-MOD INTERSECTIONS                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0765
*   IF ICTMMOD(1)=ON                /* "CURRENT" A MOD REPL          */
*       &ICTMASM(1)=OFF             /* ......... NOT AN ASSEMBLY     */
*       &PTRO->ICTMSRCR(1)=ON       /* "OTHER" A ++SRC               */
*     THEN                                                         0765
@RF00763 L     @08,@PC00008                                        0765
         L     @08,PTRC(,@08)                                      0765
         TM    ICTMMOD(@08),B'10000000'                            0765
         BNO   @RF00765                                            0765
         TM    ICTMASM(@08),B'01000000'                            0765
         BNZ   @RF00765                                            0765
         L     @08,@PC00008+4                                      0765
         L     @08,PTRO(,@08)                                      0765
         TM    ICTMSRCR(@08),B'00000010'                           0765
         BNO   @RF00765                                            0765
*     INTRTYPE=MODSRC;              /* <--- MOD REPL TO SRC          */
         L     @08,@PC00008+8                                      0766
         MVI   INTRTYPE(@08),X'40'                                 0766
*   IF ICTMMOD(1)=ON                /* "CURRENT" A ++MOD             */
*       &ICTMASM(1)=OFF             /* ......... NOT AN ASSEMBLY     */
*       &PTRO->ICTMSRCU(1)=ON       /* "OTHER" A ++SRCUPD            */
*     THEN                                                         0767
@RF00765 L     @08,@PC00008                                        0767
         L     @08,PTRC(,@08)                                      0767
         TM    ICTMMOD(@08),B'10000000'                            0767
         BNO   @RF00767                                            0767
         TM    ICTMASM(@08),B'01000000'                            0767
         BNZ   @RF00767                                            0767
         L     @08,@PC00008+4                                      0767
         L     @08,PTRO(,@08)                                      0767
         TM    ICTMSRCU(@08),B'00000001'                           0767
         BNO   @RF00767                                            0767
*     INTRTYPE=MODSRCU;             /* <--- MOD REPL TO SRCUPD       */
         L     @08,@PC00008+8                                      0768
         MVI   INTRTYPE(@08),X'80'                                 0768
*   IF ICTMSRCR(1)=ON               /* "CURRENT" A ++SRC             */
*       &PTRO->ICTMMOD(1)=ON        /* "OTHER" A MOD REPL            */
*       &PTRO->ICTMASM(1)=OFF       /* ....... NOT AN ASSEMBLY       */
*     THEN                                                         0769
@RF00767 L     @08,@PC00008                                        0769
         L     @08,PTRC(,@08)                                      0769
         TM    ICTMSRCR(@08),B'00000010'                           0769
         BNO   @RF00769                                            0769
         L     @08,@PC00008+4                                      0769
         L     @08,PTRO(,@08)                                      0769
         TM    ICTMMOD(@08),B'10000000'                            0769
         BNO   @RF00769                                            0769
         TM    ICTMASM(@08),B'01000000'                            0769
         BNZ   @RF00769                                            0769
*     INTRTYPE=SRCMOD;              /* <--- SRC REPL TO MOD          */
         L     @08,@PC00008+8                                      0770
         MVI   INTRTYPE(@08),X'10'                                 0770
*   IF ICTMSRCU(1)=ON               /* "CURRENT" A ++SRCUPD          */
*       &PTRO->ICTMMOD(1)=ON        /* "OTHER" A MOD REPL            */
*       &PTRO->ICTMASM(1)=OFF       /* ....... NOT AN ASSEMBLY       */
*     THEN                                                         0771
@RF00769 L     @08,@PC00008                                        0771
         L     @08,PTRC(,@08)                                      0771
         TM    ICTMSRCU(@08),B'00000001'                           0771
         BNO   @RF00771                                            0771
         L     @08,@PC00008+4                                      0771
         L     @08,PTRO(,@08)                                      0771
         TM    ICTMMOD(@08),B'10000000'                            0771
         BNO   @RF00771                                            0771
         TM    ICTMASM(@08),B'01000000'                            0771
         BNZ   @RF00771                                            0771
*     INTRTYPE=SRCUMOD;             /* <--- SRC UPDATE ON MOD REPL   */
*                                                                  0772
         L     @08,@PC00008+8                                      0772
         MVI   INTRTYPE(@08),X'20'                                 0772
*   /*****************************************************************/
*   /*                                                               */
*   /* MOD-XPND INTERSECTIONS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0773
*   IF ICTMMOD(1)=ON                /* "CURRENT" A MOD REPLACMENT    */
*       &PTRO->ICTMXPND(1)=ON       /* "OTHER" AN EXPAND             */
*     THEN                                                         0773
@RF00771 L     @08,@PC00008                                        0773
         L     @08,PTRC(,@08)                                      0773
         TM    ICTMMOD(@08),B'10000000'                            0773
         BNO   @RF00773                                            0773
         L     @08,@PC00008+4                                      0773
         L     @08,PTRO(,@08)                                      0773
         TM    ICTMXPND(@08),B'00010000'                           0773
         BNO   @RF00773                                            0773
*     INTRTYPE=MODXPND;             /* <--- MOD REPL TO EXPAND       */
         L     @08,@PC00008+8                                      0774
         MVI   INTRTYPE(@08),X'81'                                 0774
*   RETURN;                                                        0775
@EL00008 DS    0H                                                  0775
@EF00008 DS    0H                                                  0775
@ER00008 LM    @14,@12,12(@13)                                     0775
         BR    @14                                                 0775
*   END INTRSECT;                                                  0776
         B     @EL00008                                            0776
*                                                                  0777
*/********************************************************************/
*/*                                                                  */
*/*    ELIMMOD  - ELIMINATE ++MOD MOD SECTION ENTRY ASSOICATED       */
*/*               WITH THE "CURRENT" ELEMENT.   THE ASSOCIATED       */
*/*               ++MOD MOD SECT ENTRY IS ONE FROM THE "CURRENT"     */
*/*               SYSMOD.                                            */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT ... THIS SHOULD     */
*/*                  BE A MOD SECT ENTRY FOR A ++SRC/++SRCUPD.       */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0777
*ELIMMOD:                                                          0777
*   PROC(EMODNAME);                                                0777
ELIMMOD  STM   @14,@12,12(@13)                                     0777
         MVC   @PC00009(4),0(@01)                                  0777
*   DCL                                                            0778
*     EMODNAME CHAR(8);             /* ELEMENT NAME                  */
*   DCL                                                            0779
*     TT FIXED(15);                 /* LOCAL INDEX                   */
*   RESPECIFY                                                      0780
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */
*                                                                  0780
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU THE ICT MOD SECTION                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0781
*   DO TT=1 BY 1 WHILE ICTMEND(TT)^=ICTENDNT;                      0781
         LA    TT,1                                                0781
         B     @DE00781                                            0781
@DL00781 DS    0H                                                  0782
*     IF ICTMNAME(TT)=EMODNAME      /* MATCHES NAME TO BE ELIMINATED */
*         &ICTPPTR(TT)=CPTF         /* BOTH FROM "CURRENT" SYSMOD    */
*         &ICTMMOD(TT)=ON           /* ++MOD REPLACEMENT ENTRY       */
*         &ICTMASM(TT)=OFF          /* ... NOT ASSEM ENTRY           */
*       THEN                                                       0782
         LR    @08,TT                                              0782
         MH    @08,@CH02013                                        0782
         L     @03,CCAICMOD(,CCAPTR)                               0782
         L     @15,@PC00009                                        0782
         ST    @08,@TF00001                                        0782
         ALR   @08,@03                                             0782
         AL    @08,@CF02036                                        0782
         CLC   ICTMNAME(8,@08),EMODNAME(@15)                       0782
         BNE   @RF00782                                            0782
         L     @08,@PC00001+4                                      0782
         L     @01,@TF00001                                        0782
         AL    @01,@CF02034                                        0782
         L     @15,ICTPPTR-96(@01,@03)                             0782
         C     @15,CPTF(,@08)                                      0782
         BNE   @RF00782                                            0782
         LR    @08,@03                                             0782
         AL    @08,@TF00001                                        0782
         AL    @08,@CF02049                                        0782
         TM    ICTMMOD-9(@08),B'10000000'                          0782
         BNO   @RF00782                                            0782
         TM    ICTMASM-9(@08),B'01000000'                          0782
         BNZ   @RF00782                                            0782
*       DO;                                                        0783
*         ICTMSELM(TT)=ON;          /* ELIMINATE ++MOD REPL ENTRY    */
*         ICTMASOC(TT)=OFF;         /* TURN OFF ASSOCATED ++SRC FLAG */
*         ICTMISEL(TT)=OFF;         /* MAKE SURE SELECT FLAG IS OFF  */
         AL    @03,@TF00001                                        0786
         AL    @03,@CF02033                                        0786
         OI    ICTMSELM-11(@03),B'00100000'                        0786
         NI    ICTMASOC-11(@03),B'01101111'                        0786
*       END;                                                       0787
*   END;                            /* END LOOP THRU ICT MOD SECTION */
@RF00782 AH    TT,@CH00067                                         0788
@DE00781 LR    @08,TT                                              0788
         MH    @08,@CH02013                                        0788
         L     @03,CCAICMOD(,CCAPTR)                               0788
         ALR   @03,@08                                             0788
         AL    @03,@CF02036                                        0788
         MVC   @TF00001(4),ICTMEND(@03)                            0788
         L     @08,@TF00001                                        0788
         CL    @08,ICTENDNT                                        0788
         BNE   @DL00781                                            0788
*   RETURN;                                                        0789
@EL00009 DS    0H                                                  0789
@EF00009 DS    0H                                                  0789
@ER00009 LM    @14,@12,12(@13)                                     0789
         BR    @14                                                 0789
*   END ELIMMOD;                                                   0790
*                                                                  0791
*/********************************************************************/
*/*                                                                  */
*/*    SCRWRKX  - SCRATCH ANY EXISTING MEMBERS ON THE WRK DATASETS   */
*/*               FOR THE ELEMENT PASSED BY THE CALLER               */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * IOPPTR   - PTR TO IOP WHICH MAY BE USED TO SCRATCH MEMBERS */
*/*                  FROM THE WRK DATASETS                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0791
*SCRWRKX:                                                          0791
*   PROC(SCRMOD);                                                  0791
SCRWRKX  STM   @14,@12,@SA00010                                    0791
         MVC   @PC00010(4),0(@01)                                  0791
*   DCL                                                            0792
*     SCRMOD CHAR(*);               /* ICT MOD SECT ENTRY FOR AN   0792
*                                      ELEMENT                       */
*   RESPECIFY                                                      0793
*     ICTMOD BASED(ADDR(SCRMOD));   /* MOD SECT ENTRY PASSED         */
*   RESPECIFY                                                      0794
*     HMASMIOP BASED(IOPPTR);       /* ADDRESS IOP                   */
*   IF ICTMWRK(1)=ON THEN                                          0795
         L     @08,@PC00010                                        0795
         TM    ICTMWRK(@08),B'00001000'                            0795
         BNO   @RF00795                                            0795
*     DO;                                                          0796
*                                                                  0796
*       /*************************************************************/
*       /*                                                           */
*       /* THE ELEMENT'S TEXT HAS BEEN WRITTEN TO A WRK DATASET      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0797
*                                                                  0797
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE IOP FOR STOW DELETE FUNCTION TO WRK DATASET    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0797
*       IOPFUNCT=IOPSTOWD;          /* STOW DELETE FUNCTION          */
         MVI   IOPFUNCT(IOPPTR),X'53'                              0797
*       IOPDSID=IOPWKX;             /* WRKX DATASET ... DETERMINED BY
*                                      I/O ROUTINES FROM IOPTYPE     */
         MVI   IOPDSID(IOPPTR),X'28'                               0798
*       IOPNAME=ICTMNAME(1);        /* ELEMENT NAME                  */
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0799
*       IF ICTMMOD(1)=ON            /* ++MOD ELEMENT                 */
*         THEN                                                     0800
         TM    ICTMMOD(@08),B'10000000'                            0800
         BNO   @RF00800                                            0800
*         IOPTYPE=IOPMOD;           /* ... GET RID OF WRKX MOD       */
         MVI   IOPTYPE(IOPPTR),X'05'                               0801
*       IF ICTMXPND(1)=ON           /* EXPAND MOD ENTRY              */
*         THEN                                                     0802
@RF00800 L     @08,@PC00010                                        0802
         TM    ICTMXPND(@08),B'00010000'                           0802
         BNO   @RF00802                                            0802
*         IOPTYPE=IOPXZP;           /* ... GET RID OF WRKX EXPANDS   */
         MVI   IOPTYPE(IOPPTR),X'0D'                               0803
*       IF ICTMMACR(1)=ON           /* ++MAC ELEMENT                 */
*         THEN                                                     0804
@RF00802 L     @08,@PC00010                                        0804
         TM    ICTMMACR(@08),B'00001000'                           0804
         BNO   @RF00804                                            0804
*         IOPTYPE=IOPMCR;           /* ... GET RID OF WRKX MAC       */
         MVI   IOPTYPE(IOPPTR),X'03'                               0805
*       IF ICTMSRCR(1)=ON           /* ++SRC ELEMENT                 */
*         THEN                                                     0806
@RF00804 L     @08,@PC00010                                        0806
         TM    ICTMSRCR(@08),B'00000010'                           0806
         BNO   @RF00806                                            0806
*         IOPTYPE=IOPSCR;           /* ... GET RID OF WRKX SRC       */
         MVI   IOPTYPE(IOPPTR),X'08'                               0807
*       IF ICTMZAP(1)=ON            /* ++ZAP ELEMENT                 */
*         THEN                                                     0808
@RF00806 L     @08,@PC00010                                        0808
         TM    ICTMZAP(@08),B'00100000'                            0808
         BNO   @RF00808                                            0808
*         IOPTYPE=IOPZAP;           /* ... GET RID OF WRKX ZAPS      */
         MVI   IOPTYPE(IOPPTR),X'0C'                               0809
*       IF ICTMMACU(1)=ON           /* ++MACUPD ELEMENT              */
*         THEN                                                     0810
@RF00808 L     @08,@PC00010                                        0810
         TM    ICTMMACU(@08),B'00000100'                           0810
         BNO   @RF00810                                            0810
*         IOPTYPE=IOPMCU;           /* ... GET RID OF WRKX MACUPDS   */
         MVI   IOPTYPE(IOPPTR),X'04'                               0811
*       IF ICTMSRCU(1)=ON           /* ++SRCUPD ELEMENT              */
*         THEN                                                     0812
@RF00810 L     @08,@PC00010                                        0812
         TM    ICTMSRCU(@08),B'00000001'                           0812
         BNO   @RF00812                                            0812
*         IOPTYPE=IOPSCU;           /* ... GET RID OF WRKX SRCUPDTS  */
         MVI   IOPTYPE(IOPPTR),X'09'                               0813
*       CALL HMASMIO(HMASMIOP);     /* DO THE STOW DELETE            */
@RF00812 ST    IOPPTR,@AL00001                                     0814
         L     @15,@CV01712                                        0814
         LA    @01,@AL00001                                        0814
         BALR  @14,@15                                             0814
*       ICTMWRK(1)=OFF;             /* ELEMENT NO LONGER ON WRKX     */
         L     @08,@PC00010                                        0815
         NI    ICTMWRK(@08),B'11110111'                            0815
*     END;                                                         0816
*   RETURN;                                                        0817
@EL00010 DS    0H                                                  0817
@EF00010 DS    0H                                                  0817
@ER00010 LM    @14,@12,@SA00010                                    0817
         BR    @14                                                 0817
*   END SCRWRKX;                                                   0818
         B     @EL00010                                            0818
*                                                                  0819
*/********************************************************************/
*/*                                                                  */
*/*    ERRMSG   - PUT ERROR MESSAGES TO SMPOUT AND SMPLOG            */
*/*             - SET HIGHTMS FROM MGPTYPE                           */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*     * MGPTYPE -  MESSAGE SEVERITY INITIALIZED TO VALID VALUE     */
*/*               -  IGNORED FOR HMA319I MESSAGE ... SET TO "INFO"   */
*/*                                                                  */
*/*     * MSGSMDNM - "CURRENT" SYSMOD-ID                             */
*/*                                                                  */
*/*     * VPART#1  - "CURRENT" ELEMENT TYPE                          */
*/*                                                                  */
*/*     * VPART#2  - "CURRENT" ELEMENT NAME                          */
*/*                                                                  */
*/*     * VPART#3  - HMA319I - 'SMPCDS' × 'SMPACDS' × 'ICT'          */
*/*                - HMA410I - SYSMOD-ID                             */
*/*                                                                  */
*/*     * VPART#4  - HMA319I - 'RMID' × 'UMID'                       */
*/*                                                                  */
*/*     * VPART#5  - HMA319I - SYSMOD-ID #                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0819
*ERRMSG:                                                           0819
*   PROC(MSGCODE1,MSGCODE2);                                       0819
ERRMSG   STM   @14,@04,@SA00011                                    0819
         STM   @06,@12,@SA00011+28                                 0819
         MVC   @PC00011(8),0(@01)                                  0819
*   DCL                                                            0820
*     MSGCODE1 FIXED(8);            /* PRIMARY MESSAGE NUMBER        */
*   DCL                                                            0821
*     MSGCODE2 FIXED(8);            /* MESSAGE PART NUMBER           */
*                                                                  0822
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP HMASMMSG PARM LIST (MGP)                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0822
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */
         XC    MGPCLEAR(6),MGPCLEAR                                0822
*   MGPFLAGS=''B;                   /* CLEAR ALL FLAGS               */
         XC    MGPFLAGS(2),MGPFLAGS                                0823
*   MGPMGNO1=MSGCODE1;              /* PRIMARY MESSAGE NUMBER        */
         L     @08,@PC00011                                        0824
         SLR   @04,@04                                             0824
         IC    @04,MSGCODE1(,@08)                                  0824
         STH   @04,MGPMGNO1                                        0824
*   IF MSGCODE2^=NOPART THEN                                       0825
         L     @08,@PC00011+4                                      0825
         CLI   MSGCODE2(@08),0                                     0825
         BE    @RF00825                                            0825
*     MGPMGNO2=MSGCODE2;            /* MESSAGE PART NUMBER           */
         SLR   @04,@04                                             0826
         IC    @04,MSGCODE2(,@08)                                  0826
         STH   @04,MGPMGNO2                                        0826
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */
@RF00825 DS    0H                                                  0828
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */
*   MGPWTOR=OFF;                    /* NOT WTOR                      */
*   MGPWTO=OFF;                     /* NOT WTO                       */
*                                                                  0830
         OI    MGPPRINT,B'10010000'                                0830
         NI    MGPWTOR,B'11110011'                                 0830
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP VARIABLE PARTS OF CERTAIN MESSAGES                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0831
*   IF MSGCODE1=HMA381I THEN                                       0831
         L     @08,@PC00011                                        0831
         CLI   MSGCODE1(@08),182                                   0831
         BNE   @RF00831                                            0831
*     DO;                                                          0832
*                                                                  0832
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA381I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0833
*       MGPVARPT(1)=ADDR(VPART#1);  /* "CURRENT" ELEMENT TYPE        */
         LA    @08,VPART#1                                         0833
         ST    @08,MGPVARPT                                        0833
*       MGPVARPT(2)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID           */
         LA    @08,MSGSMDNM                                        0834
         ST    @08,MGPVARPT+4                                      0834
*       MGPVARPT(3)=ADDR(VPART#2);  /* "CURRENT" ELEMENT NAME        */
         LA    @08,VPART#2                                         0835
         ST    @08,MGPVARPT+8                                      0835
*     END;                                                         0836
*   IF MSGCODE1=HMA382I THEN                                       0837
@RF00831 L     @08,@PC00011                                        0837
         CLI   MSGCODE1(@08),183                                   0837
         BNE   @RF00837                                            0837
*     DO;                                                          0838
*                                                                  0838
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA382I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0839
*       MGPVARPT(1)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID           */
         LA    @08,MSGSMDNM                                        0839
         ST    @08,MGPVARPT                                        0839
*       IF ASSEMFLG=OFF             /* NOT PROCESSING ASSEMBLY       */
*         THEN                                                     0840
         TM    ASSEMFLG,B'10000000'                                0840
         BNZ   @RF00840                                            0840
*         DO;                                                      0841
*           MGPVARPT(2)=ADDR(VPART#1);/* "CURRENT" ELEMENT TYPE      */
         LA    @08,VPART#1                                         0842
         ST    @08,MGPVARPT+4                                      0842
*           MGPVARPT(3)=ADDR(VPART#2);/* "CURRENT" ELEMENT NAME      */
         LA    @08,VPART#2                                         0843
         ST    @08,MGPVARPT+8                                      0843
*         END;                                                     0844
*       ELSE                                                       0845
*         DO;                                                      0845
         B     @RC00840                                            0845
@RF00840 DS    0H                                                  0846
*           MGPMGNO2=PART101;       /* SET UP MESSAGE PART           */
         MVC   MGPMGNO2(2),@CH01821                                0846
*           MGPVARPT(2)=ADDR(VPART#6);/* 'ASSEMBLY'                  */
         LA    @08,VPART#6                                         0847
         ST    @08,MGPVARPT+4                                      0847
*           MGPVARPT(3)=ADDR(VPART#7);/* ASSEMBLY ELEMENT NAME       */
         LA    @08,VPART#7                                         0848
         ST    @08,MGPVARPT+8                                      0848
*           MGPVARPT(4)=ADDR(VPART#1);/* "CURRENT" ELEMENT TYPE      */
         LA    @08,VPART#1                                         0849
         ST    @08,MGPVARPT+12                                     0849
*           MGPVARPT(5)=ADDR(VPART#2);/* "CURRENT" ELEMENT NAME      */
         LA    @08,VPART#2                                         0850
         ST    @08,MGPVARPT+16                                     0850
*         END;                                                     0851
*     END;                                                         0852
@RC00840 DS    0H                                                  0853
*   IF MSGCODE1=HMA319I THEN                                       0853
@RF00837 L     @08,@PC00011                                        0853
         CLI   MSGCODE1(@08),120                                   0853
         BNE   @RF00853                                            0853
*     DO;                                                          0854
*                                                                  0854
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA319I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0855
*       MGPTYPE=MGPINFO;            /* HMA319I ALWAYS INFORMATIONAL  */
         MVI   MGPTYPE,X'01'                                       0855
*       MGPVARPT(1)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */
         LA    @08,MSGSMDNM                                        0856
         ST    @08,MGPVARPT                                        0856
*       MGPVARPT(2)=ADDR(VPART#3);  /* 'SMPCDS'×'SMPACDS'×'ICT'      */
         LA    @08,VPART#3                                         0857
         ST    @08,MGPVARPT+4                                      0857
*       MGPVARPT(3)=ADDR(VPART#4);  /* 'UMID' × 'RMID'               */
         LA    @08,VPART#4                                         0858
         ST    @08,MGPVARPT+8                                      0858
*       MGPVARPT(4)=ADDR(VPART#5);  /* SYSMOD-ID #                   */
         LA    @08,VPART#5                                         0859
         ST    @08,MGPVARPT+12                                     0859
*     END;                                                         0860
*   IF MSGCODE1=HMA410I THEN                                       0861
@RF00853 L     @08,@PC00011                                        0861
         CLI   MSGCODE1(@08),211                                   0861
         BNE   @RF00861                                            0861
*     DO;                                                          0862
*                                                                  0862
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA410I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0863
*       MGPVARPT(1)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */
         LA    @08,MSGSMDNM                                        0863
         ST    @08,MGPVARPT                                        0863
*       MGPVARPT(2)=ADDR(VPART#3);  /* "OTHER" SYSMOD-ID #           */
         LA    @08,VPART#3                                         0864
         ST    @08,MGPVARPT+4                                      0864
*       MGPVARPT(3)=ADDR(VPART#2);  /* "CURRENT" ELEMENT NAME        */
         LA    @08,VPART#2                                         0865
         ST    @08,MGPVARPT+8                                      0865
*     END;                                                         0866
*   IF MSGCODE1=HMA415I THEN                                       0867
@RF00861 L     @08,@PC00011                                        0867
         CLI   MSGCODE1(@08),216                                   0867
         BNE   @RF00867                                            0867
*     DO;                                                          0868
*                                                                  0868
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA415I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0869
*       MGPVARPT(1)=ADDR(VPART#2);  /* "CURRENT" ELEMENT NAME        */
         LA    @08,VPART#2                                         0869
         ST    @08,MGPVARPT                                        0869
*       MGPVARPT(2)=ADDR(MSGXCDS);  /* "CDS" OR "ACDS"               */
         LA    @08,MSGXCDS                                         0870
         ST    @08,MGPVARPT+4                                      0870
*       MGPVARPT(3)=ADDR(VPART#1);  /* "CURRENT" ELEMENT TYPE        */
         LA    @08,VPART#1                                         0871
         ST    @08,MGPVARPT+8                                      0871
*       MGPVARPT(4)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */
         LA    @08,MSGSMDNM                                        0872
         ST    @08,MGPVARPT+12                                     0872
*     END;                                                         0873
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE THE MESSAGE             */
*                                                                  0874
@RF00867 L     @15,@CV01713                                        0874
         LA    @01,@AL00874                                        0874
         BALR  @14,@15                                             0874
*   /*****************************************************************/
*   /*                                                               */
*   /* SET HIGHTMS RETURN CODE BASED UPON MGPTYPE                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0875
*   IF MGPTYPE=MGPWARN THEN                                        0875
         CLI   MGPTYPE,2                                           0875
         BNE   @RF00875                                            0875
*     HIGHTMS=MAX(HIGHTMS,PTFWARN); /* WARNING                       */
         LA    @08,4                                               0876
         CR    HIGHTMS,@08                                         0876
         BNL   *+6
         LR    HIGHTMS,@08                                         0876
*   ELSE                                                           0877
*     IF MGPTYPE=MGPERR THEN                                       0877
         B     @RC00875                                            0877
@RF00875 CLI   MGPTYPE,3                                           0877
         BNE   @RF00877                                            0877
*       HIGHTMS=MAX(HIGHTMS,STOPPTF);/* STOP-SYSMOD                  */
         LA    @08,8                                               0878
         CR    HIGHTMS,@08                                         0878
         BNL   *+6
         LR    HIGHTMS,@08                                         0878
*     ELSE                                                         0879
*       IF MGPTYPE=MGPSEV THEN                                     0879
         B     @RC00877                                            0879
@RF00877 CLI   MGPTYPE,4                                           0879
         BNE   @RF00879                                            0879
*         HIGHTMS=MAX(HIGHTMS,STOPFUNC);/* SEVERE                    */
         LA    @08,12                                              0880
         CR    HIGHTMS,@08                                         0880
         BNL   *+6
         LR    HIGHTMS,@08                                         0880
*       ELSE                                                       0881
*         IF MGPTYPE=MGPTERM THEN                                  0881
         B     @RC00879                                            0881
@RF00879 CLI   MGPTYPE,5                                           0881
         BNE   @RF00881                                            0881
*           HIGHTMS=MAX(HIGHTMS,STOPSMP);/* TERMINATING              */
         LA    @08,16                                              0882
         CR    HIGHTMS,@08                                         0882
         BNL   *+6
         LR    HIGHTMS,@08                                         0882
*   RETURN;                                                        0883
@EL00011 DS    0H                                                  0883
@EF00011 DS    0H                                                  0883
@ER00011 LM    @14,@04,@SA00011                                    0883
         LM    @06,@12,@SA00011+28                                 0883
         BR    @14                                                 0883
*   END ERRMSG;                                                    0884
         B     @EL00011                                            0884
*                                                                  0885
*/********************************************************************/
*/*                                                                  */
*/*    ASSEMCHK - FOR SELECTED ++SRC, ++SRCUPD, ++MAC AND ++MACUPD   */
*/*               ELEMENTS WHICH CAUSE ASSEMBLIES, THIS PROCEDURE    */
*/*               INSURES THAT THE "CURRENT" SYSMOD PREREQS AND      */
*/*               OR SUPERSEDES ALL MODIDS IN THE CORRESPONDING      */
*/*               TARGET SYSTEM MOD ENTRY WHICH WILL BE REPLACED     */
*/*               WHEN THE ASSEMBLY PERFORMED FOR THE "CURRENT"      */
*/*               ELEMENT IS INSTALLED                               */
*/*                                                                  */
*/*               RULES:                                             */
*/*                                                                  */
*/*               (1) IF THE LASTRMID IS NOT THE RESULT OF AN        */
*/*                   ASSEMBLY, THE LASTRMID MUST BE PREREQD OR      */
*/*                   SUPERSEDED BY THE "CURRENT" SYSMOD.            */
*/*                                                                  */
*/*                   IF THE LASTRMID IS THE RESULT OF AN ASSEMBLY   */
*/*                   AND IT IS NOT PREREQD OR SUPERSEDED BY THE     */
*/*                   "CURRENT" SYSMOD, "ASMREQD" WILL BE SET TO     */
*/*                   FORCE THE ASSEMBLY OF THE ELEMENT ... THE      */
*/*                   ASSUMPTION BEING THAT THE CHANGES WHICH        */
*/*                   REQUIRED THE LAST ASSEMBLY (I.E. , MACROS AND  */
*/*                   SOURCE REPLACEMENTS/UPDATES) WILL BE           */
*/*                   INCORPORATED WHEN THE ASSEMBLY IS DONE.        */
*/*                                                                  */
*/*               (2) IF THE LASTRMID IS ON THE (A)CDS,              */
*/*                                                                  */
*/*                   * ALL UMIDS IN THESE LISTS REPRESENT ZAPS TO   */
*/*                     THE MOD WHICH MUST BE SUPERSEDED BY THE      */
*/*                     SYSMOD CAUSING THE ASSEMBLY.  ANY WHICH      */
*/*                     ARE NOT WILL BE REPORTED (HMA319I).          */
*/*                                                                  */
*/*                   * THERE MAY BE A ZAP IN THE ICT FOR THE        */
*/*                     ELEMENT.  IT TOO MUST BE PREREQD OR SUPD.    */
*/*                                                                  */
*/*               (3) IF THE LASTRMID IS IN THE ICT,                 */
*/*                                                                  */
*/*                   * THE MODID LISTS IN THE ASSEM ENTRIES ARE     */
*/*                     NOT USED.  THE REPLACEMENT IN THE ICT IS     */
*/*                     ALL THAT NEED BE PREREQD OR SUPD.            */
*/*                                                                  */
*/*                   * THERE MAY BE A ZAP IN THE ICT FOR THE        */
*/*                     ELEMENT.  IT MUST BE PREREQD OR SUPD.        */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                                                                  */
*/*                  ANY ASSEMBLIES REQUIRED BY THIS ELEMENT SHOULD  */
*/*                  BE REPRESENTED BY ASSEM MOD SECTION ENTRIES     */
*/*                  WHICH ARE POINTED TO BY ICTASMLS.  THE MODID    */
*/*                  LISTS IN THESE ASSEM ENTRIES MUST BE INITIALIZED*/
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*    ---> IN ENTRY FOR ELEMENT PASSED <--------------------------- */
*/*                                                                  */
*/*     * ICTMISEL - '1' IF ELEMENT  SHOULD BE SELECTED              */
*/*                  '0' IF ELEMENT  SHOULD NOT BE SELECTED          */
*/*                                                                  */
*/*     * ICTMMIDE - '1' IF ID CHECK ERROR FOR AN ASSEMBLY CAUSES    */
*/*                      ELEMENT TO NOT BE SELECTED                  */
*/*                  '0' IF ASSEMBLIES CHECKED OK                    */
*/*                                                                  */
*/*    ---> IN ASSEMBLY ENTRIES ASSOCIATED WITH ELEMENT PASSED <---  */
*/*                                                                  */
*/*     * ICTMISEL - '1' IF ASSEMBLY SHOULD BE SELECTED              */
*/*                  '0' IF ASSEMBLY SHOULD NOT BE SELECTED          */
*/*                                                                  */
*/*     * ICTMFMID - INITIALIZED IN ASSEM ENTRIES TO THE FMID OF     */
*/*                  THE MOST RECENTLY SELECTED VERSION OF THE       */
*/*                  ELEMENT.                                        */
*/*                                                                  */
*/*     * ICTMRMID - INITIALIZED IN ASSEM ENTRIES TO THE "CURRENT"   */
*/*                  SYSMOD.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0885
*ASSEMCHK:                                                         0885
*   PROC;                                                          0885
ASSEMCHK STM   @14,@04,@SA00012                                    0885
         STM   @06,@12,@SA00012+28                                 0885
*   DCL                                                            0886
*     MM FIXED(15);                 /* INDEX - ICT MOD SECT ASSEMBLY
*                                      ENTRIES FOR "CURRENT" ELEMENT */
*   DCL                                                            0887
*     M1 FIXED(15);                 /* INDEX - ICT MOD SECT ENTRIES  */
*   DCL                                                            0888
*     1 * BIT(8),                   /* LOCAL FLAGS                   */
*      2 ASMIDERR BIT(1),           /* AN ASSEMBLY HAD RMID/UMID ERR */
*      2 ASMREQ1 BIT(1),            /* ASSEMBLY REQUIRED             */
*      2 * BIT(6);                  /* UN-USED                       */
*   RESPECIFY                                                      0889
*     ICTMOD BASED(SAVCMOD);        /* ADDRESS MOD ENTRY PASSED      */
*   RESPECIFY                                                      0890
*     ICTASMLS BASED(ICTMACHN(1));  /* ADDRESS LIST OF ASSEMBLY ENTRY
*                                      ADDRESSES IN ELEMENT PASSED   */
*   SAVCMOD=CMOD;                   /* SAVE "CURRENT" ELEMENT PTR    */
         L     SAVCMOD,CMOD                                        0891
*   SAVLFMID=LASTFMID;              /* SAVE LAST FMID SYSMOD-ID      */
         MVC   SAVLFMID(7),LASTFMID                                0892
*   SAVLRMID=LASTRMID;              /* SAVE LAST RMID SYSMOD-ID      */
         MVC   SAVLRMID(7),LASTRMID                                0893
*   SAVLRLM@=LREPELM@;              /* SAVE PTR TO LAST REPL IN ICT  */
         L     SAVLRLM@,LREPELM@                                   0894
*   SAVSEFLG=SELEXCL;               /* SAVE SELECT/EXCLUDE FLAGS     */
         MVC   SAVSEFLG(2),SELEXCL                                 0895
*   ASSEMFLG=ON;                    /* SET FLAG WHILE PROCESSING   0896
*                                      ASSEMBLY ENTRIES              */
         OI    ASSEMFLG,B'10000000'                                0896
*   MSG382I=OFF;                    /* CLEAR HMA382 ISSUED FLAG      */
         NI    MSG382I,B'11011111'                                 0897
*   VPART#6=MSGASSEM;               /* FILL IN MSG VARIABLE PART     */
         MVC   VPART#6(8),@CC01835                                 0898
*   ASMIDERR=OFF;                   /* CLEAR LOCAL FLAG              */
*   ASMREQ1=OFF;                    /* CLEAR LOCAL FLAG              */
         NI    ASMIDERR,B'00111111'                                0900
*                                                                  0901
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ASSEMBLY ENTRIES FOR ELEMENT PASSED                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0901
*   DO MM=1 BY 1 WHILE ICTASMND(MM)^=ICTENDIX;                     0901
         LA    MM,1                                                0901
         B     @DE00901                                            0901
@DL00901 DS    0H                                                  0902
*     SELEXCL=''B;                  /* CLEAR SELECT/EXCLUDE FLAGS    */
         XC    SELEXCL(2),SELEXCL                                  0902
*     CMOD=ICTASMAD(MM);            /* POINT TO ASSEMBLY ENTRY       */
*                                                                  0903
         LR    @08,MM                                              0903
         SLA   @08,2                                               0903
         MVC   @TF00001(4),ICTMACHN(SAVCMOD)                       0903
         L     @03,@TF00001                                        0903
         AL    @03,@CF02030                                        0903
         L     @08,ICTASMAD(@08,@03)                               0903
         ST    @08,CMOD                                            0903
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE FMID AND RMID FIELDS IN ASSEMBLY ENTRY           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0904
*     CMOD->ICTMRMID(1)=CPTF->ICTPTFS(1);/* "CURRENT" SYSMOD BECOMES
*                                      RMID                          */
         L     @03,@PC00001+4                                      0904
         L     @03,CPTF(,@03)                                      0904
         MVC   ICTMRMID(7,@08),ICTPTFS(@03)                        0904
*     CMOD->ICTMFMID(1)=NULLPTF#;   /* BLANK FMID FIELD FOR NOW      */
         MVC   ICTMFMID(7,@08),@CC01719                            0905
*     IF SAVCMOD->ICTMSRCR(1)=ON    /* ASSEM FOR ++SRC               */
*         ×SAVCMOD->ICTMSRCU(1)=ON  /* ASSEM FOR ++SRCUPD            */
*       THEN                                                       0906
         TM    ICTMSRCR(SAVCMOD),B'00000011'                       0906
         BZ    @RF00906                                            0906
*       DO;                                                        0907
*                                                                  0907
*         /***********************************************************/
*         /*                                                         */
*         /* ++SRC OR ++SRCUPD ELEMENT                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0908
*         CMOD->ICTMFMID(1)=SAVCMOD->ICTMFMID(1);/* FMID IS SAME AS
*                                      SOURCE OR SOURCE UPDATE       */
         MVC   ICTMFMID(7,@08),ICTMFMID(SAVCMOD)                   0908
*         CMOD->ICTMVCHN(1)=SAVCMOD->ICTMVCHN(1);/* VERSION LIST     */
         MVC   ICTMVCHN(4,@08),ICTMVCHN(SAVCMOD)                   0909
*       END;                                                       0910
*     IF CMOD->ICTMFMID(1)=NULLPTF# /* FMID NOT YET DETERMINED       */
*       THEN                                                       0911
@RF00906 L     @08,CMOD                                            0911
         CLC   ICTMFMID(7,@08),@CC01719                            0911
         BNE   @RF00911                                            0911
*       DO;                                                        0912
*                                                                  0912
*         /***********************************************************/
*         /*                                                         */
*         /* ++MAC OR ++MACUPD ELEMENT ... SEE IF ASSEMBLY CALLED FOR*/
*         /* IS A ++SRC/++SRCUPD SUPPLIED IN "CURRENT" (WHICH IS     */
*         /* SELECTED)                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0913
*         DO M1=1 BY 1 WHILE CCAICMOD->ICTMEND(M1)^=ICTENDNT;      0913
         LA    M1,1                                                0913
         B     @DE00913                                            0913
@DL00913 DS    0H                                                  0914
*           IF CCAICMOD->ICTMNAME(M1)=CMOD->ICTMNAME(1)/* SAME NAME  */
*               &CCAICMOD->ICTMISEL(M1)=ON/* SELECTED                */
*               &CCAICMOD->ICTPPTR(M1)=CPTF/* FROM "CURRENT" SYSMOD  */
*               &(CCAICMOD->ICTMSRCR(M1)=ON/* ICT SRC REPLACEMENT    */
*               ×CCAICMOD->ICTMSRCU(M1)=ON)/* ICT SRC UPDATE         */
*             THEN                                                 0914
         LR    @08,M1                                              0914
         MH    @08,@CH02013                                        0914
         L     @15,CCAICMOD(,CCAPTR)                               0914
         L     @14,CMOD                                            0914
         ST    @08,@TF00001                                        0914
         ALR   @08,@15                                             0914
         AL    @08,@CF02036                                        0914
         CLC   ICTMNAME(8,@08),ICTMNAME(@14)                       0914
         BNE   @RF00914                                            0914
         LR    @08,@15                                             0914
         AL    @08,@TF00001                                        0914
         AL    @08,@CF02033                                        0914
         TM    ICTMISEL-11(@08),B'10000000'                        0914
         BNO   @RF00914                                            0914
         L     @08,@PC00001+4                                      0914
         L     @01,@TF00001                                        0914
         AL    @01,@CF02034                                        0914
         L     @01,ICTPPTR-96(@01,@15)                             0914
         C     @01,CPTF(,@08)                                      0914
         BNE   @RF00914                                            0914
         AL    @15,@TF00001                                        0914
         AL    @15,@CF02049                                        0914
         TM    ICTMSRCR-9(@15),B'00000011'                         0914
         BZ    @RF00914                                            0914
*             DO;                                                  0915
*               CMOD->ICTMFMID(1)=SAVCMOD->ICTMFMID(1);/* FMID IS  0916
*                                      SAME AS CAUSER OF ASSEMBLY    */
         MVC   ICTMFMID(7,@14),ICTMFMID(SAVCMOD)                   0916
*               CMOD->ICTMVCHN(1)=SAVCMOD->ICTMVCHN(1);/* VERSION  0917
*                                      LIST                          */
         MVC   ICTMVCHN(4,@14),ICTMVCHN(SAVCMOD)                   0917
*             END;                                                 0918
*         END;                                                     0919
@RF00914 AH    M1,@CH00067                                         0919
@DE00913 LR    @08,M1                                              0919
         MH    @08,@CH02013                                        0919
         L     @01,CCAICMOD(,CCAPTR)                               0919
         ALR   @01,@08                                             0919
         AL    @01,@CF02036                                        0919
         MVC   @TF00001(4),ICTMEND(@01)                            0919
         L     @08,@TF00001                                        0919
         CL    @08,ICTENDNT                                        0919
         BNE   @DL00913                                            0919
*       END;                                                       0920
*     IF CMOD->ICTMFMID(1)=NULLPTF# /* FMID NOT YET DETERMINED       */
*       THEN                                                       0921
@RF00911 L     @08,CMOD                                            0921
         CLC   ICTMFMID(7,@08),@CC01719                            0921
         BNE   @RF00921                                            0921
*       DO;                                                        0922
*         CALL GETMIDS;             /* GET THE FMID OF THE LAST    0923
*                                      VERSION OF THIS ELEMENT       */
         BAL   @14,GETMIDS                                         0923
*         IF LASTFMID^=NULLPTF# THEN                               0924
         CLC   LASTFMID(7),@CC01719                                0924
         BE    @RF00924                                            0924
*           CMOD->ICTMFMID(1)=LASTFMID;/* FMID BECOMES THAT OF LAST  */
         L     @08,CMOD                                            0925
         MVC   ICTMFMID(7,@08),LASTFMID                            0925
*         ELSE                                                     0926
*           ;                       /* LEAVE ASSEMBLY ELEMENT FMID 0926
*                                      "BLANK"                       */
@RF00924 DS    0H                                                  0927
*         CMOD->ICTMVCHN(1)=TBLXNULL;/* NO VERSION LIST              */
         L     @08,@PC00001                                        0927
         L     @03,CMOD                                            0927
         MVC   ICTMVCHN(4,@03),TBLXNULL(@08)                       0927
*       END;                                                       0928
*     VPART#7=CMOD->ICTMNAME(1);    /* PUT ASSEMBLY NAME IN MSG PART */
*                                                                  0929
@RF00921 L     @08,CMOD                                            0929
         MVC   VPART#7(8),ICTMNAME(@08)                            0929
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE WHETHER ASSEMBLY CAN BE SELECTED                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0930
*     CALL REPELEM;                 /* PROCESS ASSEMBLY AS A       0930
*                                      REPLACEMENT ELEMENT           */
         BAL   @14,REPELEM                                         0930
*     IF ASMREQD=ON                 /* ASSEMBLY IS REQUIRED          */
*       THEN                                                       0931
         TM    ASMREQD,B'00010000'                                 0931
         BNO   @RF00931                                            0931
*       ASMREQ1=ON;                 /* SET LOCAL ASSEM REQUIRED FLAG */
         OI    ASMREQ1,B'01000000'                                 0932
*     IF CMOD->ICTMISEL(1)=OFF      /* ASSEMBLY NOT SELECTED         */
*         &CMOD->ICTMMIDE(1)=ON     /* DUE TO ID CHECK ERROR         */
*       THEN                                                       0933
@RF00931 L     @08,CMOD                                            0933
         TM    ICTMMIDE(@08),B'00001000'                           0933
         BNO   @RF00933                                            0933
         TM    ICTMISEL(@08),B'10000000'                           0933
         BNZ   @RF00933                                            0933
*       ASMIDERR=ON;                /* SET LOCAL ID CHECK ERR FLAG   */
         OI    ASMIDERR,B'10000000'                                0934
*   END;                            /* END LOOP THRU ALL ASSEMBLIES  */
@RF00933 AH    MM,@CH00067                                         0935
@DE00901 LR    @08,MM                                              0935
         SLA   @08,2                                               0935
         MVC   @TF00001(4),ICTMACHN(SAVCMOD)                       0935
         L     @03,@TF00001                                        0935
         AL    @03,@CF02030                                        0935
         L     @08,ICTASMND(@08,@03)                               0935
         CL    @08,ICTENDIX                                        0935
         BNE   @DL00901                                            0935
*                                                                  0936
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL ASSEMBLIES REQUIRED FOR THE "CURRENT" ELEMENT HAVE BEEN   */
*   /* CHECKED                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0936
*   CMOD=SAVCMOD;                   /* RESTORE PTR TO "CURRENT" ELEM */
         ST    SAVCMOD,CMOD                                        0936
*   LASTFMID=SAVLFMID;              /* RESTORE LASTFMID              */
         MVC   LASTFMID(7),SAVLFMID                                0937
*   LASTRMID=SAVLRMID;              /* RESTORE LASTRMID              */
         MVC   LASTRMID(7),SAVLRMID                                0938
*   LREPELM@=SAVLRLM@;              /* RESTORE LREPELM@              */
         ST    SAVLRLM@,LREPELM@                                   0939
*   SELEXCL=SAVSEFLG;               /* RESTORE SELEXCL FLAGS         */
         MVC   SELEXCL(2),SAVSEFLG                                 0940
*   IF ASMIDERR=ON                  /* AN ASSEM HAD ID CHECK ERROR   */
*     THEN                                                         0941
         TM    ASMIDERR,B'10000000'                                0941
         BNO   @RF00941                                            0941
*     DO;                                                          0942
*       ICTMISEL(1)=OFF;            /* "CURRENT" ELEMENT CANNOT BE 0943
*                                      SELECTED                      */
*       ICTMMIDE(1)=ON;             /* DUE TO ID CHECK ERROR FOR AN
*                                      ASSEMBLY                      */
         OI    ICTMMIDE(SAVCMOD),B'00001000'                       0944
         NI    ICTMISEL(SAVCMOD),B'01111111'                       0944
*       ASMREQ1=OFF;                /* CLEAR LOCAL ASSEM REQ'D FLAG  */
         NI    ASMREQ1,B'10111111'                                 0945
*     END;                                                         0946
*   IF ASMREQ1=ON                   /* ONE OR MORE OF THE ASSEMBLIES
*                                      WAS REQUIRED BECAUSE IT     0947
*                                      INTERSECTED WITH AN ASSEMBLED
*                                      MODULE                        */
*     THEN                                                         0947
@RF00941 TM    ASMREQ1,B'01000000'                                 0947
         BNO   @RF00947                                            0947
*     ASMREQD=ON;                   /* SET FLAG FOR CALLER'S USE     */
         OI    ASMREQD,B'00010000'                                 0948
*   ASSEMFLG=OFF;                   /* RESET FLAG SET WHILE        0949
*                                      PROCESSING ASSEMBLY ENTRIES   */
@RF00947 NI    ASSEMFLG,B'01111111'                                0949
*   RETURN;                                                        0950
@EL00012 DS    0H                                                  0950
@EF00012 DS    0H                                                  0950
@ER00012 LM    @14,@04,@SA00012                                    0950
         LM    @06,@12,@SA00012+28                                 0950
         BR    @14                                                 0950
*   END ASSEMCHK;                                                  0951
*                                                                  0952
*/********************************************************************/
*/*                                                                  */
*/*    ASSEMSEL - SET THE ICTMISEL FLAG IN ASSEMBLY ENTRIES CREATED  */
*/*               ON BEHALF OF THE MACRO OR SOURCE ENTRY PASSED      */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * ICTASMLS - INITIALIZED WITH POINTERS TO ASSEMBLY ENTRIES   */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0952
*ASSEMSEL:                                                         0952
*   PROC(XENTRY,XFLG);                                             0952
ASSEMSEL STM   @14,@12,12(@13)                                     0952
         MVC   @PC00013(8),0(@01)                                  0952
*   DCL                                                            0953
*     XENTRY CHAR(*);               /* ICT MOD SECT ENTRY            */
*   DCL                                                            0954
*     XFLG CHAR(1);                 /* 'S' SET ICTMISEL FLAG "ON" ...
*                                      'R' SET ICTMISEL FLAG "OFF"   */
*   DCL                                                            0955
*     NN FIXED(15);                 /* INDEX - ICTASMLS              */
*   RESPECIFY                                                      0956
*     ICTMOD BASED(ADDR(XENTRY));   /* ADDRESS MOD SECT ENTRY PASSED */
*   RESPECIFY                                                      0957
*     ICTASMLS BASED(ICTMACHN(1));  /* ADDRESS LIST OF ASSEM ENTRY 0957
*                                      ADDRESSES                     */
*   IF ICTMACHN(1)^=0               /* THERE IS ASSEM ADDRESS LIST   */
*     THEN                                                         0958
         L     @08,@PC00013                                        0958
         MVC   @TF00001(4),ICTMACHN(@08)                           0958
         L     @08,@TF00001                                        0958
         LTR   @08,@08                                             0958
         BZ    @RF00958                                            0958
*     DO;                                                          0959
*                                                                  0959
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ASSEM ENTRIES IN ICTASMLS                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0960
*       DO NN=1 BY 1 WHILE ICTASMND(NN)^=ICTENDIX;                 0960
         LA    NN,1                                                0960
         B     @DE00960                                            0960
@DL00960 DS    0H                                                  0961
*         IF XFLG=SET               /* SET SELECT FLAG               */
*           THEN                                                   0961
         L     @08,@PC00013+4                                      0961
         CLI   XFLG(@08),C'S'                                      0961
         BNE   @RF00961                                            0961
*           ICTASMAD(NN)->ICTMISEL(1)=ON;/* SET ICTMISEL             */
         LR    @08,NN                                              0962
         SLA   @08,2                                               0962
         L     @03,@PC00013                                        0962
         MVC   @TF00001(4),ICTMACHN(@03)                           0962
         L     @03,@TF00001                                        0962
         AL    @03,@CF02030                                        0962
         L     @08,ICTASMAD(@08,@03)                               0962
         OI    ICTMISEL(@08),B'10000000'                           0962
*         ELSE                                                     0963
*           ICTASMAD(NN)->ICTMISEL(1)=OFF;/* CLEAR ICTMISEL          */
         B     @RC00961                                            0963
@RF00961 LR    @08,NN                                              0963
         SLA   @08,2                                               0963
         L     @03,@PC00013                                        0963
         MVC   @TF00001(4),ICTMACHN(@03)                           0963
         L     @03,@TF00001                                        0963
         AL    @03,@CF02030                                        0963
         L     @08,ICTASMAD(@08,@03)                               0963
         NI    ICTMISEL(@08),B'01111111'                           0963
*       END;                                                       0964
@RC00961 AH    NN,@CH00067                                         0964
@DE00960 LR    @08,NN                                              0964
         SLA   @08,2                                               0964
         L     @03,@PC00013                                        0964
         MVC   @TF00001(4),ICTMACHN(@03)                           0964
         L     @03,@TF00001                                        0964
         AL    @03,@CF02030                                        0964
         L     @08,ICTASMND(@08,@03)                               0964
         CL    @08,ICTENDIX                                        0964
         BNE   @DL00960                                            0964
*     END;                                                         0965
*   RETURN;                                                        0966
@EL00013 DS    0H                                                  0966
@EF00013 DS    0H                                                  0966
@ER00013 LM    @14,@12,12(@13)                                     0966
         BR    @14                                                 0966
*   END ASSEMSEL;                                                  0967
         B     @EL00013                                            0967
*                                                                  0968
*/********************************************************************/
*/*                                                                  */
*/*    ZAPCHK   - CHECK ICT MOD SECTION FOR ANOTHER ZAP ENTRY        */
*/*               FOR THE SAME ELEMENT AS THE ONE PASSED             */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * MULTIZAP - SET IF ANOTHER ZAP FOUND                        */
*/*                                                                  */
*/*     * HIGHTMS  - SET TO STOP-SYSMOD IF ANOTHER ZAP FOUND         */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0968
*ZAPCHK:                                                           0968
*   PROC;                                                          0968
ZAPCHK   STM   @14,@04,@SA00014                                    0968
         STM   @06,@12,@SA00014+28                                 0968
*   DCL                                                            0969
*     IZ FIXED(15);                 /* INDEX - ICT MOD SECTION       */
*   RESPECIFY                                                      0970
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */
*                                                                  0970
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0971
*   DO IZ=1 BY 1 WHILE ICTMEND(IZ)^=ICTENDNT;                      0971
         LA    IZ,1                                                0971
         B     @DE00971                                            0971
@DL00971 DS    0H                                                  0972
*     IF ICTMNAME(IZ)=CMOD->ICTMNAME(1)/* ENTRY NAMES THE SAME       */
*         &ICTMISEL(IZ)=ON          /* ENTRY SELECTED                */
*         &ICTMZAP(IZ)=ON           /* ENTRY IS A ZAP                */
*       THEN                                                       0972
         LR    @08,IZ                                              0972
         MH    @08,@CH02013                                        0972
         L     @04,CCAICMOD(,CCAPTR)                               0972
         ST    @08,@TF00001                                        0972
         ALR   @08,@04                                             0972
         AL    @08,@CF02036                                        0972
         L     @03,CMOD                                            0972
         CLC   ICTMNAME(8,@08),ICTMNAME(@03)                       0972
         BNE   @RF00972                                            0972
         LR    @08,@04                                             0972
         AL    @08,@TF00001                                        0972
         AL    @08,@CF02033                                        0972
         TM    ICTMISEL-11(@08),B'10000000'                        0972
         BNO   @RF00972                                            0972
         LR    @08,@04                                             0972
         AL    @08,@TF00001                                        0972
         AL    @08,@CF02049                                        0972
         TM    ICTMZAP-9(@08),B'00100000'                          0972
         BNO   @RF00972                                            0972
*       DO;                                                        0973
*                                                                  0973
*         /***********************************************************/
*         /*                                                         */
*         /* ANOTHER ZAP FOUND FOR THIS ELEMENT ... ISSUE HMA410I    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0974
*         MGPTYPE=MGPERR;           /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0974
*         VPART#3=ICTPPTR(IZ)->ICTPTFS(1);/* OTHER SYSMOD WHICH    0975
*                                      SUPPLIED ZAP FOR THIS ELEMENT */
         MVI   VPART#3+7,C' '                                      0975
         L     @08,@TF00001                                        0975
         AL    @04,@CF02034                                        0975
         L     @08,ICTPPTR-96(@08,@04)                             0975
         MVC   VPART#3(7),ICTPTFS(@08)                             0975
*         CALL ERRMSG(HMA410I,NOPART);/* ISSUE MESSAGE               */
         LA    @01,@AL00976                                        0976
         BAL   @14,ERRMSG                                          0976
*         MULTIZAP=ON;              /* MULTIPLE ZAPS TO SAME ELEMENT */
         OI    MULTIZAP,B'00000010'                                0977
*       END;                                                       0978
*   END;                                                           0979
@RF00972 AH    IZ,@CH00067                                         0979
@DE00971 LR    @08,IZ                                              0979
         MH    @08,@CH02013                                        0979
         L     @04,CCAICMOD(,CCAPTR)                               0979
         ALR   @04,@08                                             0979
         AL    @04,@CF02036                                        0979
         MVC   @TF00001(4),ICTMEND(@04)                            0979
         L     @08,@TF00001                                        0979
         CL    @08,ICTENDNT                                        0979
         BNE   @DL00971                                            0979
*   RETURN;                                                        0980
@EL00014 DS    0H                                                  0980
@EF00014 DS    0H                                                  0980
@ER00014 LM    @14,@04,@SA00014                                    0980
         LM    @06,@12,@SA00014+28                                 0980
         BR    @14                                                 0980
*   END ZAPCHK;                                                    0981
*                                                                  0982
*/********************************************************************/
*/*                                                                  */
*/*    XPNDSEL  - SELECT EXPAND ENTRIES IN THE ICT ASSOCIATED WITH   */
*/*               A SELECTED ZAP ENTRY                               */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * CMOD    -  POINTS TO "CURRENT" ELEMENT.                    */
*/*                  ... A SELECTED ZAP ENTRY                        */
*/*                                                                  */
*/*     * CPTF    -  POINTS TO "CURRENT" SYSMOD ... THE SYSMOD       */
*/*                  WHICH SUPPLIED THE "CURRENT" ELEMENT.           */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0982
*XPNDSEL:                                                          0982
*   PROC;                                                          0982
XPNDSEL  STM   @14,@12,12(@13)                                     0982
*   DCL                                                            0983
*     ZI FIXED(15);                 /* INDEX - CURRENT SYSMOD ELEMS. */
*   RESPECIFY                                                      0984
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" PTF ENTRY   */
*   RESPECIFY                                                      0985
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS ICT MOD SECTION CHAIN
*                                      PTR ARRAY FOR "CURRENT" PTF 0985
*                                      ENTRY                         */
*                                                                  0985
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU "CURRENT" SYSMOD'S ELEMENTS                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0986
*   DO ZI=1 BY 1 WHILE ICTIXP(ZI)^=ICTENDIX;                       0986
         LA    ZI,1                                                0986
         B     @DE00986                                            0986
@DL00986 DS    0H                                                  0987
*     RESPECIFY                                                    0987
*       ICTMOD BASED(ICTIXPF(ZI));  /* ADDRESS ELEMENT FROM "CURRENT"
*                                      SYSMOD                        */
*     IF ICTMXPND(1)=ON             /* EXPAND MOD SECT ENTRY         */
*         &ICTMNAME(1)=CMOD->ICTMNAME(1)/* MATCHES SELECTED ZAP      */
*       THEN                                                       0988
         LR    @08,ZI                                              0988
         SLA   @08,2                                               0988
         L     @03,@PC00001+4                                      0988
         L     @03,CPTF(,@03)                                      0988
         L     @03,ICTPCHN(,@03)                                   0988
         AL    @03,@CF02030                                        0988
         L     @08,ICTIXPF(@08,@03)                                0988
         TM    ICTMXPND(@08),B'00010000'                           0988
         BNO   @RF00988                                            0988
         L     @03,CMOD                                            0988
         CLC   ICTMNAME(8,@08),ICTMNAME(@03)                       0988
         BNE   @RF00988                                            0988
*       ICTMISEL(1)=ON;             /* SELECT THE EXPAND             */
         OI    ICTMISEL(@08),B'10000000'                           0989
*   END;                                                           0990
@RF00988 AH    ZI,@CH00067                                         0990
@DE00986 LR    @08,ZI                                              0990
         SLA   @08,2                                               0990
         L     @03,@PC00001+4                                      0990
         L     @03,CPTF(,@03)                                      0990
         L     @03,ICTPCHN(,@03)                                   0990
         AL    @03,@CF02030                                        0990
         L     @08,ICTIXP(@08,@03)                                 0990
         CL    @08,ICTENDIX                                        0990
         BNE   @DL00986                                            0990
*   RETURN;                                                        0991
@EL00015 DS    0H                                                  0991
@EF00015 DS    0H                                                  0991
@ER00015 LM    @14,@12,12(@13)                                     0991
         BR    @14                                                 0991
*   END XPNDSEL;                                                   0992
*   END HMASMTMS                                                   0993
*                                                                  0993
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  0993
*       ;                                                          0993
@DATA    DS    0H
@CH00085 DC    H'0'
@CH00067 DC    H'1'
@CH00059 DC    H'8'
@CH01821 DC    H'101'
@CH01809 DC    H'120'
@CH02013 DC    H'144'
@CH01811 DC    H'182'
@CH01813 DC    H'183'
@CH01815 DC    H'211'
@CH01817 DC    H'216'
         DS    0F
@AL00388 DC    A(@AFTEMPS+8)           LIST WITH   3 ARGUMENT(S)
         DC    A(@AFTEMPS+12)
         DC    A(ITYPE)
@AL00442 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00530 DC    A(LASTRMID)             LIST WITH   2 ARGUMENT(S)
         DC    A(TPSRTN)
@AL00459 DC    A(@CC01723)             LIST WITH   1 ARGUMENT(S)
@AL00460 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00563 DC    A(@CC01721)             LIST WITH   1 ARGUMENT(S)
@AL00483 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00551 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00687 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00725 DC    A(@CH01813+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00085+1)
@AL00490 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00558 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00691 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00728 DC    A(@CH01809+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00085+1)
@AL00506 DC    A(@CH01811+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00085+1)
@AL00514 DC    A(@CH01817+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00085+1)
@AL00628 DC    A(CMOD)                 LIST WITH   3 ARGUMENT(S)
         DC    A(@AFTEMPS)
         DC    A(ITYPE)
@AL00675 DC    A(CMOD)                 LIST WITH   3 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
         DC    A(ITYPE)
@AL00679 DC    A(UMIDSMID)             LIST WITH   2 ARGUMENT(S)
         DC    A(TPSRTN)
@AL00874 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
@AL00976 DC    A(@CH01815+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00085+1)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@SA00002 DS    14F
@SA00012 DS    14F
@PC00009 DS    1F
@PC00013 DS    2F
@SA00003 DS    14F
@SA00014 DS    14F
@PC00008 DS    3F
@SA00006 DS    15F
@SA00007 DS    14F
@PC00007 DS    1F
@SA00011 DS    0F
@PC00011 EQU   @SA00011+56
@SA00005 DS    0F
@SA00010 DS    0F
@PC00010 EQU   @SA00010+60
         DS    16F
@AL00001 DS    3A
@TF00001 DS    F
@TF00002 DS    F
@AFTEMPS DS    4F
         DS    0F
@CF02036 DC    F'-144'
@CF02049 DC    F'-135'
@CF02033 DC    F'-133'
@CF02048 DC    F'-64'
@CF02037 DC    F'-56'
@CF02034 DC    F'-48'
@CF02047 DC    F'-40'
@CF02046 DC    F'-8'
@CF02030 DC    F'-4'
@CV01712 DC    V(HMASMIO)
@CV01713 DC    V(HMASMMSG)
@CV01714 DC    V(HMASMTPS)
         DS    0D
CMOD     DS    A
TPSRTN   DS    FL1
ITYPE    DS    FL1
@TS00001 DS    CL7
@CC01823 DC    C'MOD     '
@CC01825 DC    C'ZAP     '
@CC01827 DC    C'MAC     '
@CC01829 DC    C'MACUPD  '
@CC01831 DC    C'SRC     '
@CC01833 DC    C'SRCUPD  '
@CC01835 DC    C'ASSEMBLY'
@CC01837 DC    C'RMID    '
@CC01839 DC    C'UMID    '
@CC01841 DC    C'SELECTED'
@CC01843 DC    C'SMPACDS '
@CC01845 DC    C'SMPCDS  '
@CC01719 DC    C'       '
@CC01721 DC    C'Y'
@CC01723 DC    C'N'
@CC01748 EQU   @CC01837
         DS    CL2
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL32
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00239 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00240 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL20
         ORG   MGPVAR
MGPVARPT DS    5A
         ORG   HMASMMGP+32
TMSFLGS  DS    BL1
         ORG   TMSFLGS
ASSEMFLG DS    BL1
@NM00241 EQU   TMSFLGS+0
@NM00242 EQU   TMSFLGS+0
         ORG   TMSFLGS+1
SELEXCL  DS    BL2
         ORG   SELEXCL
@NM00243 DS    BL1
         ORG   @NM00243
SELDONE  DS    BL1
DELETED  EQU   @NM00243+0
UPDERROR EQU   @NM00243+0
VERSIOND EQU   @NM00243+0
EXCLUDED EQU   @NM00243+0
UPLEVEL  EQU   @NM00243+0
MULTIZAP EQU   @NM00243+0
@NM00244 EQU   @NM00243+0
         ORG   SELEXCL+1
@NM00245 DS    BL1
         ORG   @NM00245
IDERR    DS    BL1
         ORG   IDERR
RMIDERR  DS    BL1
UMIDERR  EQU   IDERR+0
MSG382I  EQU   IDERR+0
         ORG   @NM00245+0
ASMREQD  EQU   @NM00245+0
REPFLG   EQU   @NM00245+0
UPDFLG   EQU   @NM00245+0
@NM00246 EQU   @NM00245+0
         ORG   SELEXCL+2
         DS    CL1
@NM00247 DS    CL19
         ORG   @NM00247
LREPELM@ DS    AL4
@NM00248 DS    BL1
         ORG   @NM00248
LRMIDASM DS    BL1
         ORG   @NM00247+5
LASTIDS  DS    CL14
         ORG   LASTIDS
LASTFMID DS    CL7
LASTRMID DS    CL7
         ORG   @NM00247+19
SAVLFMID DS    CL7
SAVLRMID DS    CL7
SAVSEFLG DS    BL2
MSGSMDNM DS    CL7
MSGXCDS  DS    CL8
         ORG   MSGXCDS
@NM00249 DS    CL3
MSGXCDSA DS    CL4
@NM00250 DS    CL1
         ORG   MSGXCDS+8
VPARTS   DS    CL56
         ORG   VPARTS
VP382I   DS    CL32
         ORG   VP382I
VPART#1  DS    CL8
VPART#2  DS    CL8
VPART#6  DS    CL8
VPART#7  DS    CL8
         ORG   VPARTS+32
VP319I   DS    CL24
         ORG   VP319I
VPART#3  DS    CL8
VPART#4  DS    CL8
VPART#5  DS    CL8
         ORG   VPARTS+56
PATCHTMS DS    CL80
         ORG   PATCHTMS
@NM00251 DC    80X'FF'
         ORG   PATCHTMS+80
UMIDSMID DS    CL7
@NM00252 DS    BL1
         ORG   @NM00252
ASMIDERR DS    BL1
ASMREQ1  EQU   @NM00252+0
@NM00253 EQU   @NM00252+0
         ORG   @NM00252+1
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ZI       EQU   @02
IZ       EQU   @02
NN       EQU   @02
M1       EQU   @03
MM       EQU   @06
TT       EQU   @02
KK       EQU   @02
RR       EQU   @02
FF       EQU   @02
SAVLRLM@ EQU   @07
SAVCMOD  EQU   @02
HIGHTMS  EQU   @05
J        EQU   @03
I        EQU   @02
IOPPTR   EQU   @04
CCAPTR   EQU   @11
REG1     EQU   @01
REG14    EQU   @14
REG15    EQU   @15
RTNCODE  EQU   @15
RTNREG   EQU   @14
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLASSEM EQU   TBLFLG1
TBLFLG2  EQU   TBLFLAGS+2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLBPID  EQU   TBLFLG4
TBLFLG5  EQU   TBLFLAGS+7
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00023 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAAPPLY EQU   CCAFLAG1
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCARGNP  EQU   CCAFLAG3+1
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00039 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00041 EQU   CCABLDLL
CCALKDRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00053+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00057 EQU   HMASMIOP+12
@NM00058 EQU   @NM00057
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00168 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPFLG1 EQU   ICTPTF+7
ICTBYP   EQU   ICTPFLG1
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPREDO EQU   ICTPFLG4
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00195 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPTYPE EQU   ICTPTF+17
ICTPFMID EQU   ICTPTF+22
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTIXP   EQU   ICTIXPF
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTVRSND EQU   ICTVRSNM
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMEND  EQU   ICTMNAME
ICTMFLG2 EQU   ICTMOD+8
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMMOD  EQU   ICTMMODR
ICTMASM  EQU   ICTMMODR
ICTMZAP  EQU   ICTMFLG1
ICTMXPND EQU   ICTMFLG1
ICTMMACR EQU   ICTMFLG1
ICTMMACU EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMSRCU EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTMWRK  EQU   ICTMFLG3
ICTMFLG4 EQU   ICTMOD+11
ICTMISEL EQU   ICTMFLG4
ICTMIDEL EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMFLG5 EQU   ICTMOD+12
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTMRMID EQU   ICTMOD+80
ICTMFMID EQU   ICTMOD+88
ICTPPTR  EQU   ICTMOD+96
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMIDND EQU   ICTMODID
ICTMODST EQU   ICTMID+7
ICTMIDPL EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDTY EQU   ICTMODST
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTASMND EQU   ICTASMAD
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMVRND EQU   ICTMVRNM
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLFLG4 EQU   ICTLMOD+8
ICTLFLG1 EQU   ICTLMOD+9
ICTLFLG5 EQU   ICTLMOD+10
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTLFLG3 EQU   ICTLMOD+14
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXTBL  EQU   TBLXPARM+28
TBLXNULL EQU   TBLXPARM+36
TBLXFLG1 EQU   TBLXPARM+80
TBLXRC   EQU   TBLXPARM+92
CPTF     EQU   0
UMIDMSG  EQU   0
PTRC     EQU   0
PTRO     EQU   0
INTRTYPE EQU   0
EMODNAME EQU   0
SCRMOD   EQU   0
MSGCODE1 EQU   0
MSGCODE2 EQU   0
XENTRY   EQU   0
XFLG     EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00064 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00075 EQU   IOPUDATA
@NM00076 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00085 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00096 EQU   IOPSRCDR+1
@NM00098 EQU   @NM00096+7
@NM00102 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00106 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00112 EQU   IOPMODDR+1
@NM00114 EQU   @NM00112+7
@NM00118 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00122 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00133 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00140 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPERROR EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00149 EQU   IOPPTFFX
@NM00150 EQU   @NM00149
IOPPDTES EQU   IOPPTFFX+41
@NM00153 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00178 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00178
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00182 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00182
IOPBFTB1 EQU   IOPBFTB0
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00184 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00183 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00181 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00180 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00179 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00177 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00176 EQU   IOPPTSFX+35
@NM00175 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00174 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00173 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00172 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00171 EQU   IOPQFMDR
@NM00167 EQU   IOPQSMDR
@NM00166 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00165 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00164 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00163 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00162 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00161 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00160 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00159 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00158 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00157 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00156 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00155 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00154 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00153+3
IOPRECD  EQU   @NM00153
@NM00152 EQU   IOPPTFFX+8
@NM00151 EQU   @NM00149+7
IOPPRELN EQU   @NM00150
@NM00148 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00147 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00146 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00145 EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00144 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00143 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00142 EQU   @NM00140+7
@NM00141 EQU   @NM00140
@NM00139 EQU   IOPSYSDR+5
@NM00138 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00137 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00136 EQU   IOPDLBFX+8
@NM00135 EQU   @NM00133+7
@NM00134 EQU   @NM00133
@NM00132 EQU   IOPDLBDR+1
@NM00131 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00130 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00129 EQU   IOPMODFX+12
@NM00128 EQU   IOPMODF4
@NM00127 EQU   IOPMODF3
@NM00126 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00125 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00124 EQU   @NM00122+7
@NM00123 EQU   @NM00122
@NM00121 EQU   IOPMODDR+17
@NM00120 EQU   @NM00118+7
@NM00119 EQU   @NM00118
@NM00117 EQU   @NM00114
@NM00116 EQU   @NM00114
@NM00115 EQU   @NM00114
@NM00113 EQU   @NM00112
@NM00111 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00110 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00109 EQU   IOPSRCFX+8
@NM00108 EQU   @NM00106+7
@NM00107 EQU   @NM00106
@NM00105 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00104 EQU   @NM00102+7
@NM00103 EQU   @NM00102
@NM00101 EQU   @NM00098
@NM00100 EQU   @NM00098
@NM00099 EQU   @NM00098
@NM00097 EQU   @NM00096
@NM00095 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00094 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00093 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00092 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00091 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00090 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00089 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00087 EQU   @NM00085+7
@NM00086 EQU   @NM00085
@NM00084 EQU   IOPLMDDR+6
@NM00083 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00082 EQU   IOPLMDF4
@NM00081 EQU   IOPLMDF3
@NM00080 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00079 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00078 EQU   IOPLMDDR
@NM00077 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00076+4
IOPUSED  EQU   @NM00076
IOPTPSEQ EQU   @NM00075+8
IOPVLSER EQU   @NM00075+2
IOPBLKSI EQU   @NM00075
IOPCQMAX EQU   IOPCQMAP+12
@NM00074 EQU   IOPCQMAP+11
@NM00073 EQU   IOPCQMAP+8
@NM00072 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00071 EQU   IOPSCMAP+11
@NM00070 EQU   IOPSCMAP+8
@NM00069 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00068 EQU   IOPNTMAX+11
@NM00067 EQU   IOPNTMAX+8
@NM00066 EQU   IOPNTMAX
@NM00065 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00064+5
IOPIPTF3 EQU   @NM00064
TBLXEND0 EQU   TBLXPARM+124
@NM00007 EQU   TBLXPARM+108
TBLXIOP3 EQU   TBLXPARM+104
TBLXD2GT EQU   TBLXPARM+100
TBLXDLGT EQU   TBLXPARM+96
@NM00006 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTRC  EQU   TBLXRC
TBLXIBGN EQU   TBLXPARM+88
TBLXTSLP EQU   TBLXPARM+84
@NM00005 EQU   TBLXPARM+83
@NM00004 EQU   TBLXPARM+82
@NM00003 EQU   TBLXPARM+81
@NM00002 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
TBLXFUND EQU   TBLXPARM+72
TBLXFUNC EQU   TBLXPARM+64
@NM00001 EQU   TBLXPARM+62
TBLXCRQI EQU   TBLXPARM+61
TBLXCDSI EQU   TBLXPARM+60
TBLXLMGT EQU   TBLXPARM+56
TBLXSCGT EQU   TBLXPARM+52
TBLXSREL EQU   TBLXPARM+48
TBLXASGT EQU   TBLXPARM+44
TBLXIFGT EQU   TBLXPARM+40
TBLXTOP  EQU   TBLXPARM+32
TBLXSEGT EQU   TBLXPARM+24
TBLXIOPF EQU   TBLXPARM+20
TBLXIOP2 EQU   TBLXPARM+16
TBLXEND  EQU   TBLXINDX+8
TBLXSTRT EQU   TBLXINDX+4
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
ICTIXL   EQU   ICTIXLF
@NM00238 EQU   ICTLMOD+38
ICTLTTR  EQU   ICTLMOD+31
ICTTG2   EQU   ICTLMOD+23
ICTTG1   EQU   ICTLMOD+15
@NM00237 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTLCPY  EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
ICTTIND1 EQU   ICTLFLG3
@NM00236 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00235 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
ICTCOPY  EQU   ICTLFLG2
@NM00234 EQU   ICTLFLG7
@NM00233 EQU   ICTLFLG6
@NM00232 EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLNE   EQU   ICTLFLG5
@NM00231 EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLAPF  EQU   ICTLFLG1
@NM00230 EQU   ICTLFLG4
ICTLPASS EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLCPL  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
ICTLPROC EQU   ICTLFLG4
ICTLEND  EQU   ICTLNAME
@NM00229 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00228 EQU   ICTMVRNT+7
ICTTALND EQU   ICTTALNM
ICTMIDRG EQU   ICTMODST
ICTMIDF1 EQU   ICTMODST
ICTMIDPS EQU   ICTMODST
@NM00227 EQU   ICTMODST
ICTIXM   EQU   ICTIXMF
@NM00226 EQU   ICTMOD+128
ICTMICHA EQU   ICTMOD+108
@NM00225 EQU   ICTMOD+95
@NM00224 EQU   ICTMOD+87
ICTMSSI  EQU   ICTMOD+72
ICTMDOBJ EQU   ICTMOD+64
ICTMSYSL EQU   ICTMOD+56
ICTMDSTL EQU   ICTMOD+48
ICTMASLB EQU   ICTMOD+40
ICTTOLIB EQU   ICTMOD+32
ICTFMLIB EQU   ICTMOD+24
ICTMRELN EQU   ICTMOD+22
@NM00223 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00222 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00221 EQU   ICTMLEP4
@NM00220 EQU   ICTMLEP3
@NM00219 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00218 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00217 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMCOPY EQU   ICTMFLG5
ICTMPASS EQU   ICTMFLG5
@NM00216 EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
@NM00215 EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMALIS EQU   ICTMFLG3
ICTMTRX  EQU   ICTMFLG3
ICTMRELF EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTLIBLK EQU   ICTMFLG3
@NM00214 EQU   ICTMFLG2
@NM00213 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMNOGO EQU   ICTMFLG2
ICTMPROC EQU   ICTMFLG2
@NM00212 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00211 EQU   ICTVRSNT+7
@NM00210 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00209 EQU   ICTCSRST
@NM00208 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00207 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00206 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00205 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00204 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00203 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00202 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00201 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00200 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00199 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00198 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
@NM00197 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPSUPN EQU   ICTPTF+20
ICTPONUM EQU   ICTPTF+18
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00196 EQU   @NM00195
ICTPRQBY EQU   @NM00195
ICTPRQOK EQU   @NM00195
ICTPRQCK EQU   @NM00195
@NM00194 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00193 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00192 EQU   ICTPFLG4
@NM00191 EQU   ICTPFLG4
@NM00190 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00189 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00188 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00187 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00186 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTREGEN EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00185 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTPEND  EQU   ICTPTFS
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00170 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00169 EQU   @NM00168+7
IOPQSMFM EQU   @NM00168
@NM00088 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00063 EQU   IOPUSERL
@NM00062 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00061 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00060 EQU   @NM00057+10
IOPSEQNO EQU   @NM00057+8
@NM00059 EQU   @NM00058+7
IOPPTFNM EQU   @NM00058
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00056 EQU   CCABLDLM+2
@NM00055 EQU   CCABLDLM
CCAUPDPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00053+12
CCAUPDTE EQU   @NM00053+8
CCAUPDNM EQU   @NM00053
CCASUPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00051+12
CCAIOSUP EQU   @NM00051+8
CCASUPNM EQU   @NM00051
CCAZAPPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00049+12
CCASPZAP EQU   @NM00049+8
CCAZAPNM EQU   @NM00049
CCACOMPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00047+12
CCACOMRS EQU   @NM00047+8
CCACOMNM EQU   @NM00047
CCACPYPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00045+12
CCACOPY  EQU   @NM00045+8
CCACPYNM EQU   @NM00045
CCAASMPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00043+12
CCAASM   EQU   @NM00043+8
CCAASMNM EQU   @NM00043
CCALKDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00041+12
CCALKED  EQU   @NM00041+8
CCALKDNM EQU   @NM00041
CCAPGMPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCABPGRC EQU   @NM00039+20
CCABPGSP EQU   @NM00039+12
CCABPGAD EQU   @NM00039+8
CCABPGNM EQU   @NM00039
CCAEND   EQU   HMASMCCA+371
@NM00038 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00037 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00036 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00035 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00034 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00033 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00032 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00031 EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00030 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00029 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00028 EQU   @NM00023+18
@NM00027 EQU   @NM00023+16
CCATBLPA EQU   @NM00023+12
@NM00026 EQU   @NM00023+8
@NM00025 EQU   @NM00023+4
@NM00024 EQU   @NM00023
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00022 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00021 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00020 EQU   CCAFBUFR+122
@NM00019 EQU   CCAFBUFR+120
@NM00018 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00017 EQU   CCAFBUFR+88
@NM00016 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00015 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00014 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00013 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00012 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
@NM00011 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00010 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
TBLGROUP EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
TBLSEL   EQU   TBLFLG2
@NM00009 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLCHECK EQU   TBLFLG1
TBLNOAPP EQU   TBLFLG1
@NM00008 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00522 EQU   @RC00519
@RF00579 EQU   @EL00004
@RC00581 EQU   @EL00004
@RF00600 EQU   @EL00005
@RF00613 EQU   @EL00005
@RF00635 EQU   @RC00632
@RF00639 EQU   @RC00632
@RF00647 EQU   @EL00006
@RC00708 EQU   @RC00706
@RF00773 EQU   @EL00008
@RF00795 EQU   @EL00010
@RF00881 EQU   @EL00011
@RC00879 EQU   @EL00011
@RC00877 EQU   @EL00011
@RC00875 EQU   @EL00011
@RF00958 EQU   @EL00013
@ENDDATA EQU   *
         END   HMASMTMS,(C'PLS2152',0802,78334)

         TITLE 'HMASMTMD - ICT MOD SECTION BUILD DRIVER -'
HMASMTMD CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTMD  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @08,0                                               0001
@PSTART  LA    @09,4095(,@08)                                      0001
         LA    @10,4095(,@09)                                      0001
         LA    @12,4095(,@10)                                      0001
         USING @PSTART,@08                                         0001
         USING @PSTART+4095,@09                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@12                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0245
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FOR MOD SECTION BUILD PROCESSING                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0245
*   HIGHTMD=ZERO;                   /* RETURN CODE COLLECTOR         */
         SLR   @15,@15                                             0245
         ST    @15,HIGHTMD                                         0245
*   TMDFLGS=''B;                    /* CLEAR PROCESSING FLAGS        */
         MVI   TMDFLGS,X'00'                                       0246
*   MSGSMDN8=' ';                   /* BLANK MESSAGE AREA            */
         MVI   MSGSMDN8+1,C' '                                     0247
         MVC   MSGSMDN8+2(6),MSGSMDN8+1                            0247
         MVI   MSGSMDN8,C' '                                       0247
*   HMASMMGP=''B;                   /* CLEAR HMASMMSG PARM BLOCK     */
         XC    HMASMMGP(28),HMASMMGP                               0248
*   MPPPARM=''B;                    /* CLEAR HMASMMPD PARM BLOCK     */
         XC    MPPPARM(23),MPPPARM                                 0249
*   HMASMSPL=''B;                   /* CLEAR HMASMSPL PARM BLOCK     */
         XC    HMASMSPL(5),HMASMSPL                                0250
*   HMASMCRP=''B;                   /* CLEAR HMASMCRD PARM BLOCK     */
         XC    HMASMCRP(106),HMASMCRP                              0251
*   BLDM2WRK=OFF;                   /* NO INTERSECTIONS ON THE WRK 0252
*                                      DATASETS                      */
         NI    BLDM2WRK,B'11011111'                                0252
*   CALL HMASMTCR(TBLXPARM,MSG);    /* INSURE THAT THERE ALL SYSMODS
*                                      WHOSE REQUISITES ARE NOT    0253
*                                      SATISFIED ARE MARKED NOGO     */
         L     @15,@PC00001                                        0253
         ST    @15,@AL00001                                        0253
         LA    @15,@CC00717                                        0253
         ST    @15,@AL00001+4                                      0253
         L     @15,@CV01893                                        0253
         LA    @01,@AL00001                                        0253
         BALR  @14,@15                                             0253
*   CALL SKIP(1);                   /* SKIP A LINE ON SMPOUT         */
         LA    @01,@AL00254                                        0254
         BAL   @14,SKIP                                            0254
*   RESPECIFY                                                      0255
*     REG15 RSTD;                                                  0255
*   HIGHTMD=MAX(HIGHTMD,REG15);     /* MAINTAIN RETURN CODE          */
         L     @14,HIGHTMD                                         0256
         CR    @14,REG15                                           0256
         BNL   *+6
         LR    @14,REG15                                           0256
         ST    @14,HIGHTMD                                         0256
*   RESPECIFY                                                      0257
*     REG15 UNRSTD;                                                0257
*   PTRIOP1=CCAIOPTR;               /* USE IOP IN CCA FOR: ..........
*                                      1. (A)CDS SYSMOD ENTRIES .....
*                                      2. PTS MCS ENTIRES ...........*/
         L     PTRIOP1,CCAIOPTR(,CCAPTR)                           0258
*   SAVIOPB1=PTRIOP1->IOPBUFAD;     /* SAVE IOPBUFAD POINTER         */
         L     SAVIOPB1,IOPBUFAD(,PTRIOP1)                         0259
*   PTRIOP2=TBLXIOP2;               /* USE IOP IN TBLX FOR: .........
*                                      1. (A)CDS ELEMENT ENTRIES ....
*                                      2. WRK DATASET ENTRIES .......*/
         L     @07,@PC00001                                        0260
         L     @04,TBLXIOP2(,@07)                                  0260
         ST    @04,PTRIOP2                                         0260
*   SAVIOPB2=PTRIOP2->IOPBUFAD;     /* SAVE IOPBUFAD POINTER         */
         L     SAVIOPB2,IOPBUFAD(,@04)                             0261
*   MCBPTR=TBLXIOP3;                /* USE IOP IN TBLX FOR: .........
*                                      1. AN MCB ....................*/
         L     @07,TBLXIOP3(,@07)                                  0262
         ST    @07,MCBPTR                                          0262
*   SAVIOPB3=MCBPTR->IOPBUFAD;      /* SAVE IOPBUFAD POINTER         */
         MVC   SAVIOPB3(4),IOPBUFAD(@07)                           0263
*   RESPECIFY                                                      0264
*     MCBPTFMP BASED(MCBPTR);       /* SYSMOD HEADER MCB             */
*   RESPECIFY                                                      0265
*     MCBVERMP BASED(MCBPTR);       /* ++VER MCB                     */
*   RESPECIFY                                                      0266
*     MCBIFMP BASED(MCBPTR);        /* ++IF MCB                      */
*   RESPECIFY                                                      0267
*     MCBELEMP BASED(MCBPTR);       /* ++"ELEMENT" MCB               */
*   IF HIGHTMD<STOPFUNC THEN                                       0268
         CH    @14,@CH00036                                        0268
         BNL   @RF00268                                            0268
*     DO;                                                          0269
*                                                                  0269
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE HMASMCRD PARMLIST (HMASMCRP)                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0270
*       HMASMCRP=''B;                                              0270
         XC    HMASMCRP(106),HMASMCRP                              0270
*       CRPINDS=IOPPTS;             /* INPUT DATASET IS SMPPTS       */
*                                                                  0271
         MVI   CRPINDS,X'06'                                       0271
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE HMASMMPD PARMLIST (MPPPARM)                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0272
*       MPPIOPAD=0;                 /* NO IOP TO BE FILLED IN        */
         SLR   @04,@04                                             0272
         ST    @04,MPPIOPAD                                        0272
*       MPPMCBAD=MCBPTR;            /* MCB TO BE FILLED IN           */
         ST    @07,MPPMCBAD                                        0273
*       MPPCRDAD=ADDR(HMASMCRD);    /* GET ROUTINE                   */
         L     @07,@CV01885                                        0274
         ST    @07,MPPCRDAD                                        0274
*       MPPCRDPM=ADDR(HMASMCRP);    /* GET ROUTINE PARM LIST         */
         LA    @07,HMASMCRP                                        0275
         ST    @07,MPPCRDPM                                        0275
*     END;                                                         0276
*   IF TBLCHECK=ON                  /* APPLY/ACCEPT "CHECK"          */
*     THEN                                                         0277
@RF00268 L     @07,@PC00001                                        0277
         L     @07,TBLXTBL(,@07)                                   0277
         TM    TBLCHECK(@07),B'01000000'                           0277
         BNO   @RF00277                                            0277
*     TMWOPT=NOWRITE;               /* DO NOT WRITE TO WRK DATASETS  */
         MVI   TMWOPT,C'N'                                         0278
*   ELSE                                                           0279
*     TMWOPT=WRITE;                 /* WRITE ELEMENTS TO WRK DATASETS*/
         B     @RC00277                                            0279
@RF00277 MVI   TMWOPT,C'W'                                         0279
*                                                                  0280
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD MOD SECTION ENTRIES FOR DELETED-FROM-(A)CDS SYSMODS     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*   RESPECIFY                                                      0280
*     ICTPTF BASED(CCAICPTF);                                      0280
*                                                                  0280
@RC00277 DS    0H                                                  0281
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU THE ICT PTF SECTION ENTRIES                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0281
*   DO I=1 BY 1 WHILE ICTPEND(I)^=ICTENDNT&HIGHTMD<STOPFUNC;       0281
         LA    I,1                                                 0281
         B     @DE00281                                            0281
@DL00281 DS    0H                                                  0282
*     IF(ICTPDEXP(I)=ON             /* EXPLICITLY DELETED            */
*         ×ICTPDIMP(I)=ON)          /* IMPLICITLY DELETED            */
*         &ICTPNOGO(I)=OFF          /* NOT NOGO                      */
*       THEN                                                       0282
         LR    @07,I                                               0282
         MH    @07,@CH02382                                        0282
         L     @04,CCAICPTF(,CCAPTR)                               0282
         ST    @07,@TF00001                                        0282
         ALR   @07,@04                                             0282
         AL    @07,@CF02415                                        0282
         TM    ICTPDEXP-13(@07),B'00110000'                        0282
         BZ    @RF00282                                            0282
         LR    @07,@04                                             0282
         AL    @07,@TF00001                                        0282
         AL    @07,@CF02416                                        0282
         TM    ICTPNOGO-8(@07),B'01000000'                         0282
         BNZ   @RF00282                                            0282
*       DO;                                                        0283
*                                                                  0283
*         /***********************************************************/
*         /*                                                         */
*         /* PTF SECT ENTRY IS FOR SYSMOD BEING DELETED              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0284
*         CALL CDSDEL(ICTPTF(I));   /* BUILD MOD SECT ENTRIES        */
         L     @07,@TF00001                                        0284
         AL    @04,@CF02417                                        0284
         LA    @07,ICTPTF(@07,@04)                                 0284
         ST    @07,@AL00001                                        0284
         LA    @01,@AL00001                                        0284
         BAL   @14,CDSDEL                                          0284
*         ICTPMSL(I)=ON;            /* MOD SECT PROCESSING COMPLETED
*                                      FOR SYSMOD                    */
         LR    @07,I                                               0285
         MH    @07,@CH02382                                        0285
         L     @04,CCAICPTF(,CCAPTR)                               0285
         ALR   @04,@07                                             0285
         AL    @04,@CF02418                                        0285
         OI    ICTPMSL-15(@04),B'10000000'                         0285
*       END;                                                       0286
*   END;                                                           0287
*                                                                  0287
@RF00282 AL    I,@CF00065                                          0287
@DE00281 LR    @07,I                                               0287
         MH    @07,@CH02382                                        0287
         L     @04,CCAICPTF(,CCAPTR)                               0287
         AL    @04,@CF02417                                        0287
         L     @07,ICTPEND(@07,@04)                                0287
         CL    @07,ICTENDNT                                        0287
         BE    @DC00281                                            0287
         L     @07,HIGHTMD                                         0287
         CH    @07,@CH00036                                        0287
         BL    @DL00281                                            0287
@DC00281 DS    0H                                                  0288
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD MOD SECTION ENTRIES FOR SYSMODS REMAINING IN THE ICT    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0288
*   CALL BLDICTM;                   /* BUILD ICT MOD SECTION         */
         BAL   @14,BLDICTM                                         0288
*                                                                  0289
*   /*****************************************************************/
*   /*                                                               */
*   /* SORT OUT SELECTED MODS AND ASSEMBLY ENTRIES CREATED FOR SOURCE*/
*   /* AND MACRO ELEMENTS                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0289
*   RESPECIFY                                                      0289
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */
*                                                                  0289
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION FOR ASSEMBLY ENTRIES                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0290
*   DO I=1 BY 1 WHILE ICTMEND(I)^=ICTENDNT;                        0290
         LA    I,1                                                 0290
         B     @DE00290                                            0290
@DL00290 DS    0H                                                  0291
*     IF ICTMMOD(I)=ON              /* MOD ENTRY                     */
*         &ICTMASM(I)=ON            /* FOR AN ASSEMBLY               */
*         &ICTMISEL(I)=ON           /* SELECTED                      */
*       THEN                                                       0291
         LR    @07,I                                               0291
         MH    @07,@CH02383                                        0291
         L     @04,CCAICMOD(,CCAPTR)                               0291
         ST    @07,@TF00001                                        0291
         ALR   @07,@04                                             0291
         AL    @07,@CF02420                                        0291
         TM    ICTMMOD-9(@07),B'11000000'                          0291
         BNO   @RF00291                                            0291
         LR    @07,@04                                             0291
         AL    @07,@TF00001                                        0291
         AL    @07,@CF02421                                        0291
         TM    ICTMISEL-11(@07),B'10000000'                        0291
         BNO   @RF00291                                            0291
*       DO;                                                        0292
*         CALL CHKASSEM(ICTMOD(I),SRCMP1);/* MAKE SURE THERE IS STILL
*                                      A SELECTED MAC OR SRC WHICH 0293
*                                      CALLS FOR THE ASSEMBLY        */
         L     @07,@TF00001                                        0293
         AL    @04,@CF02422                                        0293
         LA    @07,ICTMOD(@07,@04)                                 0293
         ST    @07,@AL00001                                        0293
         LA    @07,SRCMP1                                          0293
         ST    @07,@AL00001+4                                      0293
         LA    @01,@AL00001                                        0293
         BAL   @14,CHKASSEM                                        0293
*         IF SRCMP1^=0              /* THERE IS SRC/MAC CALLING FOR
*                                      THE ASSEMBLY                  */
*           THEN                                                   0294
         ICM   @07,15,SRCMP1                                       0294
         BZ    @RF00294                                            0294
*           CALL SRCHMOD(ICTMNAME(I),SRCMP2);/* LOOK FOR SELECTED  0295
*                                      MOD-REPL TYPE ENTRY WITH SAME
*                                      NAME AS THIS ASSEMBLY ELEMENT */
         LR    @07,I                                               0295
         MH    @07,@CH02383                                        0295
         L     @04,CCAICMOD(,CCAPTR)                               0295
         AL    @04,@CF02422                                        0295
         LA    @07,ICTMNAME(@07,@04)                               0295
         ST    @07,@AL00001                                        0295
         LA    @07,SRCMP2                                          0295
         ST    @07,@AL00001+4                                      0295
         LA    @01,@AL00001                                        0295
         BAL   @14,SRCHMOD                                         0295
*         IF SRCMP1=0               /* NO SRC/MAC CALLING FOR ASSEM. */
*             ×SRCMP2^=0            /* MOD-REPL FOUND                */
*           THEN                                                   0296
@RF00294 SLR   @07,@07                                             0296
         C     @07,SRCMP1                                          0296
         BE    @RT00296                                            0296
         C     @07,SRCMP2                                          0296
         BE    @RF00296                                            0296
@RT00296 DS    0H                                                  0297
*           DO;                                                    0297
*                                                                  0297
*             /*******************************************************/
*             /*                                                     */
*             /* NO MAC/SRC CALLING FOR ASSEM. OR ++MOD REPL FOUND   */
*             /* ... THE ASSEMBLY NEED NOT BE DONE                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0298
*             ICTMSELM(I)=ON;       /* ELIMINATE THIS ASSEMBLY ENTRY */
*             ICTMISEL(I)=OFF;      /* UN-SELECT THE ASSEMBLY ENTRY  */
         LR    @07,I                                               0299
         MH    @07,@CH02383                                        0299
         L     @04,CCAICMOD(,CCAPTR)                               0299
         ALR   @04,@07                                             0299
         AL    @04,@CF02421                                        0299
         OI    ICTMSELM-11(@04),B'00100000'                        0299
         NI    ICTMISEL-11(@04),B'01111111'                        0299
*           END;                                                   0300
*         CALL ELIMASM(ICTMOD(I));  /* ELIMINATE ANY OTHER ASSEMBLIES
*                                      FOR THIS SAME ELEMENT         */
@RF00296 LR    @07,I                                               0301
         MH    @07,@CH02383                                        0301
         L     @04,CCAICMOD(,CCAPTR)                               0301
         AL    @04,@CF02422                                        0301
         LA    @07,ICTMOD(@07,@04)                                 0301
         ST    @07,@AL00001                                        0301
         LA    @01,@AL00001                                        0301
         BAL   @14,ELIMASM                                         0301
*       END;                                                       0302
*   END;                                                           0303
*                                                                  0303
@RF00291 AL    I,@CF00065                                          0303
@DE00290 LR    @07,I                                               0303
         MH    @07,@CH02383                                        0303
         L     @04,CCAICMOD(,CCAPTR)                               0303
         AL    @04,@CF02422                                        0303
         L     @07,ICTMEND(@07,@04)                                0303
         CL    @07,ICTENDNT                                        0303
         BNE   @DL00290                                            0303
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT THERE IS AT MOST, ONE SELECTED MOD-REPLACEMENT  */
*   /* TYPE ENTRY (ICTMMOD = ON) AND ONE SELECTED EXPAND-ZAP TYPE    */
*   /* ENTRY (ICTMMOD = ON & ICTMXPND = ON) IN THE ICT MOD SECTION   */
*   /* FOR ANY ONE ELEMENT.                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*                                                                  0304
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK SELECTED ELEMENTS IN ICT MOD SECTION FOR DISTLIB ERRORS */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*   RESPECIFY                                                      0304
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */
*                                                                  0304
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT PTF SECTION                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0305
*   DO IP=1 BY 1 WHILE ICTPEND(IP)^=ICTENDNT;                      0305
         LA    IP,1                                                0305
         B     @DE00305                                            0305
@DL00305 DS    0H                                                  0306
*     IF ICTPNOGO(IP)=OFF           /* NON-NOGO SYSMOD               */
*       THEN                                                       0306
         LR    @07,IP                                              0306
         MH    @07,@CH02382                                        0306
         L     @03,CCAICPTF(,CCAPTR)                               0306
         ALR   @03,@07                                             0306
         AL    @03,@CF02416                                        0306
         TM    ICTPNOGO-8(@03),B'01000000'                         0306
         BNZ   @RF00306                                            0306
*       DO;                                                        0307
*                                                                  0307
*         /***********************************************************/
*         /*                                                         */
*         /* GO THRU ALL ELEMENTS IN SYSMOD                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0308
*         RESPECIFY                                                0308
*           ICTIXPF BASED(ICTPCHN(IP));/* ADDRESS LIST OF MOD SECTION
*                                      ENTRIES FOR SYSMOD            */
*         DO I=1 BY 1 WHILE ICTIXP(I)^=ICTENDIX;                   0309
         LA    I,1                                                 0309
         B     @DE00309                                            0309
@DL00309 DS    0H                                                  0310
*           RESPECIFY                                              0310
*             ICTMOD BASED(ICTIXP(I));/* ADDRESS MOD SECTION ENTRY 0310
*                                      FOR SYSMOD                    */
*           IF ICTMISEL(1)=ON       /* SELECTED ELEMENT              */
*               &ICTMDSTE(1)=ON     /* INVALID DISTLIB               */
*             THEN                                                 0311
         LR    @07,I                                               0311
         SLA   @07,2                                               0311
         LR    @15,IP                                              0311
         MH    @15,@CH02382                                        0311
         L     @01,CCAICPTF(,CCAPTR)                               0311
         AL    @01,@CF02423                                        0311
         L     @01,ICTPCHN-64(@15,@01)                             0311
         AL    @01,@CF02424                                        0311
         L     @07,ICTIXP(@07,@01)                                 0311
         TM    ICTMISEL(@07),B'10000100'                           0311
         BNO   @RF00311                                            0311
*             DO;                                                  0312
*                                                                  0312
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE DISTLIB ERROR MESSAGE AND MARK SYSMOD NOGO  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0313
*               CALL ELMTYPE(ICTMOD(1),VPART#1);/* GET PRINTABLE   0313
*                                      ELEMENT TYPE                  */
         ST    @07,@AL00001                                        0313
         LA    @07,VPART#1                                         0313
         ST    @07,@AL00001+4                                      0313
         LA    @01,@AL00001                                        0313
         BAL   @14,ELMTYPE                                         0313
*               VPART#2=ICTMNAME(1);/* SET ELEMENT NAME FOR HMA405I  */
         LR    @07,I                                               0314
         SLA   @07,2                                               0314
         LR    @15,IP                                              0314
         MH    @15,@CH02382                                        0314
         L     @14,CCAICPTF(,CCAPTR)                               0314
         LA    @01,0(@15,@14)                                      0314
         AL    @01,@CF02423                                        0314
         L     @01,ICTPCHN-64(,@01)                                0314
         AL    @01,@CF02424                                        0314
         L     @07,ICTIXP(@07,@01)                                 0314
         MVC   VPART#2(8),ICTMNAME(@07)                            0314
*               VPART#3=ICTPTFS(IP);/* SET SYSMOD-ID FOR HMA405I     */
         MVI   VPART#3+7,C' '                                      0315
         ALR   @14,@15                                             0315
         AL    @14,@CF02417                                        0315
         MVC   VPART#3(7),ICTPTFS(@14)                             0315
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0316
*               CALL ERRMSG(HMA405I,NOPART);/* ISSUE DISTLIB ERROR 0317
*                                      MSG                           */
         LA    @01,@AL00317                                        0317
         BAL   @14,ERRMSG                                          0317
*               ICTPNOGO(IP)=ON;    /* MARK SYSMOD NOGO              */
*               ICTPCPL(IP)=ON;     /* MARK SYSMOD AS COMPLETE       */
         LR    @07,IP                                              0319
         MH    @07,@CH02382                                        0319
         L     @01,CCAICPTF(,CCAPTR)                               0319
         ALR   @01,@07                                             0319
         AL    @01,@CF02416                                        0319
         OI    ICTPNOGO-8(@01),B'01100000'                         0319
*             END;                                                 0320
*         END;                      /* END OF LOOP THRU ALL ELEMENTS
*                                      IN SYSMOD                     */
@RF00311 AL    I,@CF00065                                          0321
@DE00309 LR    @07,I                                               0321
         SLA   @07,2                                               0321
         LR    @15,IP                                              0321
         MH    @15,@CH02382                                        0321
         L     @14,CCAICPTF(,CCAPTR)                               0321
         LA    @01,0(@15,@14)                                      0321
         AL    @01,@CF02423                                        0321
         L     @01,ICTPCHN-64(,@01)                                0321
         AL    @01,@CF02424                                        0321
         L     @07,ICTIXP(@07,@01)                                 0321
         CL    @07,ICTENDIX                                        0321
         BNE   @DL00309                                            0321
*         IF ICTPNOGO(IP)=ON        /* SYSMOD MARKED NOGO            */
*           THEN                                                   0322
         ST    @15,@TF00001                                        0322
         ALR   @15,@14                                             0322
         AL    @15,@CF02416                                        0322
         TM    ICTPNOGO-8(@15),B'01000000'                         0322
         BNO   @RF00322                                            0322
*           DO;                                                    0323
*             MGPTYPE=MGPINFO;      /* INFORMATIONAL                 */
         MVI   MGPTYPE,X'01'                                       0324
*             MSGSMDNM=ICTPTFS(IP); /* SET SYSMOD-ID FOR HMA226I     */
         AL    @14,@TF00001                                        0325
         AL    @14,@CF02417                                        0325
         MVC   MSGSMDNM(7),ICTPTFS(@14)                            0325
*             CALL ERRMSG(HMA226I,PART011);/* ISSUE HMA226I MSG      */
         LA    @01,@AL00326                                        0326
         BAL   @14,ERRMSG                                          0326
*             ICTPMSG(IP)=ON;       /* SET MSG ISSUED FLAG           */
         LR    @07,IP                                              0327
         MH    @07,@CH02382                                        0327
         L     @03,CCAICPTF(,CCAPTR)                               0327
         ST    @07,@TF00001                                        0327
         ALR   @07,@03                                             0327
         AL    @07,@CF02416                                        0327
         OI    ICTPMSG-8(@07),B'00010000'                          0327
*             IF ICTPTYPE(IP)=IOPPFUNC/* FUNCTION SYSMOD FAILED      */
*               THEN                                               0328
         L     @07,@TF00001                                        0328
         AL    @03,@CF02426                                        0328
         SLR   @15,@15                                             0328
         IC    @15,ICTPTYPE-17(@07,@03)                            0328
         CH    @15,@CH00040                                        0328
         BNE   @RF00328                                            0328
*               CALL ERRMSG(HMA370I,NOPART);/* ISSUE HMA370I         */
*                                                                  0329
         LA    @01,@AL00329                                        0329
         BAL   @14,ERRMSG                                          0329
*             /*******************************************************/
*             /*                                                     */
*             /* CLEANUP ICT AND WRK DATASETS                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0330
*             CALL BLDMODSF(ICTPTF(IP),/* FAILING SYSMOD             */
*                 HIGHTMD);         /* RETURN CODE COLLECTOR         */
@RF00328 LR    @07,IP                                              0330
         MH    @07,@CH02382                                        0330
         L     @03,CCAICPTF(,CCAPTR)                               0330
         AL    @03,@CF02417                                        0330
         LA    @07,ICTPTF(@07,@03)                                 0330
         ST    @07,@AL00001                                        0330
         LA    @07,HIGHTMD                                         0330
         ST    @07,@AL00001+4                                      0330
         LA    @01,@AL00001                                        0330
         BAL   @14,BLDMODSF                                        0330
*             IF HIGHTMD<STOPFUNC THEN                             0331
         L     @07,HIGHTMD                                         0331
         CH    @07,@CH00036                                        0331
         BNL   @RF00331                                            0331
*               DO;                                                0332
*                                                                  0332
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK FOR SYSMODS WHICH REQUIRE THE FAILED      */
*                 /* SYSMOD                                          */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0333
*                 CALL HMASMTCR(TBLXPARM,MSG);/* CHECK REQUISITES    */
         L     @07,@PC00001                                        0333
         ST    @07,@AL00001                                        0333
         LA    @07,@CC00717                                        0333
         ST    @07,@AL00001+4                                      0333
         L     @15,@CV01893                                        0333
         LA    @01,@AL00001                                        0333
         BALR  @14,@15                                             0333
*                 RESPECIFY                                        0334
*                   REG15 RSTD;                                    0334
*                 HIGHTMD=MAX(HIGHTMD,REG15);/* MAINTAIN RETURN CODE */
         L     @14,HIGHTMD                                         0335
         CR    @14,REG15                                           0335
         BNL   *+6
         LR    @14,REG15                                           0335
         ST    @14,HIGHTMD                                         0335
*                 RESPECIFY                                        0336
*                   REG15 UNRSTD;                                  0336
*               END;                                               0337
*           END;                                                   0338
@RF00331 DS    0H                                                  0339
*       END;                        /* END PROCESSING NON-NOGO SYSMOD*/
@RF00322 DS    0H                                                  0340
*   END;                            /* END OF LOOP THRU ICT PTF    0340
*                                      SECTION                       */
@RF00306 AL    IP,@CF00065                                         0340
@DE00305 LR    @07,IP                                              0340
         MH    @07,@CH02382                                        0340
         L     @03,CCAICPTF(,CCAPTR)                               0340
         AL    @03,@CF02417                                        0340
         L     @07,ICTPEND(@07,@03)                                0340
         CL    @07,ICTENDNT                                        0340
         BNE   @DL00305                                            0340
*                                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* ANY REMAINING UN-PROCESSED SYSMODS IN THE ICT ARE THOSE WHICH */
*   /* SPECIFIED AN INVALID FMID/PREREQ RELATIONSHIP WITH ONE ANOTHER*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*   IF HIGHTMD<STOPFUNC THEN                                       0341
         L     @07,HIGHTMD                                         0341
         CH    @07,@CH00036                                        0341
         BNL   @RF00341                                            0341
*     CALL INVALID;                 /* HANDLE UN-PROCESSABLE SYSMODS */
*                                                                  0342
         BAL   @14,INVALID                                         0342
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEANUP FROM MOD SECTION BUILD PROCESSING CLOSE SMPPTS DATASET*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0343
*   RESPECIFY                                                      0343
*     HMASMIOP BASED(PTRIOP1);      /* IOP USED TO ACCESS PTS        */
@RF00341 DS    0H                                                  0344
*   HMASMIOP=''B;                   /* CLEAR IOP                     */
         XC    HMASMIOP(68,PTRIOP1),HMASMIOP(PTRIOP1)              0344
*   IOPDSID=IOPPTS;                 /* SMPPTS DATASET                */
         MVI   IOPDSID(PTRIOP1),X'06'                              0345
*   IOPFUNCT=IOPCLOSE;              /* CLOSE DATASET                 */
         MVI   IOPFUNCT(PTRIOP1),X'50'                             0346
*   CALL HMASMIO(HMASMIOP);                                        0347
*                                                                  0347
         ST    PTRIOP1,@AL00001                                    0347
         L     @15,@CV01886                                        0347
         LA    @01,@AL00001                                        0347
         BALR  @14,@15                                             0347
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE IOP BUFFER POINTERS                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0348
*   PTRIOP1->IOPBUFAD=SAVIOPB1;     /* CCA IOP BUFFER POINTER        */
         ST    SAVIOPB1,IOPBUFAD(,PTRIOP1)                         0348
*   PTRIOP2->IOPBUFAD=SAVIOPB2;     /* TBLX IOP BUFFER POINTER       */
         L     @07,PTRIOP2                                         0349
         ST    SAVIOPB2,IOPBUFAD(,@07)                             0349
*   MCBPTR->IOPBUFAD=SAVIOPB3;      /* TBLX IOP BUFFER POINTER       */
         L     @01,MCBPTR                                          0350
         MVC   IOPBUFAD(4,@01),SAVIOPB3                            0350
*   RETURN CODE(HIGHTMD);                                          0351
         L     @15,HIGHTMD                                         0351
         L     @13,4(,@13)                                         0351
         L     @14,12(,@13)                                        0351
         LM    @00,@12,20(@13)                                     0351
         BR    @14                                                 0351
*                                                                  0352
*/********************************************************************/
*/*                                                                  */
*/*    CDSDEL   - BUILD ICT MOD SECTION ENTRIES FOR SYSMODS BEING    */
*/*               DELETED FROM THE TARGET SYSTEM.                    */
*/*                                                                  */
*/*               THIS PROCEDURE ACCESSES THE (A)CDS TO FIND THE     */
*/*               PTF ENTRY FOR THE SYSMOD PASSED AND USES THE       */
*/*               ELEMENTS FOUND IN THE (A)CDS PTF ENTRY TO          */
*/*               DETERMINE THE TARGET-SYSTEM ELEMENTS WHICH ARE     */
*/*               CANDIDATES FOR DELETION.                           */
*/*                                                                  */
*/*               SINCE THE ELEMENTS ON THE TARGET SYSTEM MAY NO     */
*/*               LONGER BELONG TO THIS SYSMOD, THE ELEMENT ENTRIES  */
*/*               ON THE (A)CDS MUST BE ACCESSED TO DETERMINE THE    */
*/*               CURRENT FMID OWNERSHIP ATTRIBUTE OF THE ELEMENT.   */
*/*                                                                  */
*/*               NOTE THAT MACRO AND SOURCE UPDATE ELEMENTS SUPPLIED*/
*/*               IN NON-FUNCTION SYSMODS MUST BE PROCESSED SINCE    */
*/*               SERVICE SYSMODS MAY CHANGE THE FMID OWNERSHIP OF   */
*/*               A SOURCE OR MACRO ELEMENT BY SUPPLYING A SOURCE OR */
*/*               MACRO UPDATE.  ZAP ELEMENTS NEED NOT BE PROCESSED  */
*/*               SINCE THEY CANNOT CHANGE THE FMID OWNERSHIP OF AN  */
*/*               ELEMENT.                                           */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * HIGHTMD  - SET IF UNABLE TO OBTAIN STORAGE FOR PTF SECT    */
*/*                  ENTRY.                                          */
*/*                - SET IF I/O ERROR OCCURRED ACCESSING (A)CDS.     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0352
*CDSDEL:                                                           0352
*   PROC(DELSYSMD);                                                0352
CDSDEL   STM   @14,@12,@SA00002                                    0352
         MVC   @PC00002(4),0(@01)                                  0352
*   DCL                                                            0353
*     DELSYSMD CHAR(*);             /* ICT PTF SECT ENTRY FOR A    0353
*                                      SYSMOD BEING DELETED.         */
*   DCL                                                            0354
*     DELFCTN CHAR(7);              /* FUNCTION BEING DELETED        */
*   DCL                                                            0355
*     J FIXED(31);                  /* LOCAL INDEX                   */
*   DCL                                                            0356
*     PTR0 PTR(31);                 /* PTR TO ICT MOD SECT ENTRY   0356
*                                      OBTAINED IN THIS PROCEDURE    */
*   DCL                                                            0357
*     TESTIND FIXED(8);             /* LOCAL VARIABLE - IOPIND VALUES*/
*   RESPECIFY                                                      0358
*     ICTPTF BASED(ADDR(DELSYSMD)); /* ADDRESS PTF SECT ENTRY PASSED */
*   RESPECIFY                                                      0359
*     HMASMIOP BASED(PTRIOP1);      /* ADDRESS IOP FOR (A)CDS PTF  0359
*                                      ENTRY                         */
*   ICTPCHN(1)=0;                   /* CLEAR PTR TO LIST OF MOD SECT
*                                      ENTRIES BUILT FOR THIS SYSMOD */
*                                                                  0360
         L     @03,@PC00002                                        0360
         SLR   @15,@15                                             0360
         ST    @15,ICTPCHN(,@03)                                   0360
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE FUNCTION BEING DELETED                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0361
*   IF ICTPTYPE(1)=IOPPFUNC         /* SYSMOD PASSED IS A FUNCTION   */
*     THEN                                                         0361
         CLI   ICTPTYPE(@03),4                                     0361
         BNE   @RF00361                                            0361
*     DELFCTN=ICTPTFS(1);           /* ... IT IS THE FUNCTION BEING
*                                      DELETED                       */
         MVC   DELFCTN(7),ICTPTFS(@03)                             0362
*   ELSE                                                           0363
*     DELFCTN=ICTPFMID(1);          /* ... THE FUNCTIONAL OWNER OF 0363
*                                      THE SYSMOD PASSED IS THE    0363
*                                      FUNCTION BEING DELETED        */
*                                                                  0363
         B     @RC00361                                            0363
@RF00361 L     @03,@PC00002                                        0363
         MVC   DELFCTN(7),ICTPFMID(@03)                            0363
*   /*****************************************************************/
*   /*                                                               */
*   /* INITILIAZE IOP (PTRIOP1) TO ACCESS (A)CDS PTF ENTRY           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   IOPDSID=TBLXCDSI;               /* CONTROL DATASET ID            */
@RC00361 L     @03,@PC00001                                        0364
         MVC   IOPDSID(1,PTRIOP1),TBLXCDSI(@03)                    0364
*   IOPFUNCT=IOPLOC;                /* LOCATE FUNCTION               */
         MVI   IOPFUNCT(PTRIOP1),X'03'                             0365
*   IOPNAME=' ';                                                   0366
         MVI   IOPNAME+1(PTRIOP1),C' '                             0366
         MVC   IOPNAME+2(6,PTRIOP1),IOPNAME+1(PTRIOP1)             0366
         MVI   IOPNAME(PTRIOP1),C' '                               0366
*   IOPNAM17=ICTPTFS(1);            /* ENTRY NAME CURRENT SYSMOD     */
         L     @03,@PC00002                                        0367
         MVC   IOPNAM17(7,PTRIOP1),ICTPTFS(@03)                    0367
*   IOPTYPE=IOPSMD;                 /* ENTRY TYPE IS SYSMOD          */
         MVI   IOPTYPE(PTRIOP1),X'0B'                              0368
*   CALL HMASMIO(HMASMIOP);                                        0369
         ST    PTRIOP1,@AL00001                                    0369
         L     @15,@CV01886                                        0369
         LA    @01,@AL00001                                        0369
         BALR  @14,@15                                             0369
*   IF IOPRETRN=IOPGOOD             /* SYSMOD ENTRY FOUND ON (A)CDS  */
*       &IOPDUMMP=OFF               /* ... NOT DUMMY SUP OR DELETE   */
*     THEN                                                         0370
         CLI   IOPRETRN(PTRIOP1),0                                 0370
         BNE   @RF00370                                            0370
         TM    IOPDUMMP(PTRIOP1),B'00000100'                       0370
         BNZ   @RF00370                                            0370
*     DO;                                                          0371
*                                                                  0371
*       /*************************************************************/
*       /*                                                           */
*       /* SYSMOD TO BE DELETED LOCATED ON (A)CDS ... BUILD DELETED  */
*       /* MOD SECT ENTRIES FOR ALL ELEMENTS ON THE TARGET SYSTEM    */
*       /* WHICH STILL BELONG TO THIS SYSMOD                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0372
*                                                                  0372
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL SUBENTRIES IN (A)CDS PTF ENTRY                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0372
*       DO J=1 BY 1 WHILE IOPPTFND(J)^=IOPEOLST;                   0372
         LA    J,1                                                 0372
         B     @DE00372                                            0372
@DL00372 DS    0H                                                  0373
*         IF IOPPIND(J)>=IOPPREG    /* REGRESSED SUB-ENTRY VALUE     */
*           THEN                                                   0373
         LA    @15,80                                              0373
         LR    @14,J                                               0373
         MH    @14,@CH00034                                        0373
         SLR   @07,@07                                             0373
         IC    @07,IOPPIND-9(@14,PTRIOP1)                          0373
         CR    @07,@15                                             0373
         BL    @RF00373                                            0373
*           TESTIND=IOPPIND(J)-IOPPREG;/* CHANGE REGRESSED VALUE TO
*                                      CORRESPONDING NON-REGRESSED 0374
*                                      VALUE                         */
         SLR   @07,@15                                             0374
         STC   @07,TESTIND                                         0374
*         ELSE                                                     0375
*           TESTIND=IOPPIND(J);     /* USE IOPPIND VALUE AS IS       */
         B     @RC00373                                            0375
@RF00373 LR    @15,J                                               0375
         MH    @15,@CH00034                                        0375
         SLR   @14,@14                                             0375
         IC    @14,IOPPIND-9(@15,PTRIOP1)                          0375
         STC   @14,TESTIND                                         0375
*         IF TESTIND=IOPPASM        /* ASSEMBLY SUB-ENTRY            */
*           THEN                                                   0376
@RC00373 CLI   TESTIND,8                                           0376
         BNE   @RF00376                                            0376
*           TESTIND=IOPPMOD;        /* TREAT IT AS IF IT IS A ++MOD  */
         MVI   TESTIND,X'01'                                       0377
*         IF TESTIND=IOPPMOD×       /* ++MOD ELEMENT ?               */
*             TESTIND=IOPPMACR×     /* ++MAC ELEMENT ?               */
*             TESTIND=IOPPSRCR×     /* ++SRC ELEMENT ?               */
*             TESTIND=IOPPMACU×     /* ++MACUPD ELEMENT ?            */
*             TESTIND=IOPPSRCU      /* ++SRCUPD ELEMENT ?            */
*           THEN                                                   0378
@RF00376 CLI   TESTIND,1                                           0378
         BE    @RT00378                                            0378
         CLI   TESTIND,4                                           0378
         BE    @RT00378                                            0378
         CLI   TESTIND,6                                           0378
         BE    @RT00378                                            0378
         CLI   TESTIND,5                                           0378
         BE    @RT00378                                            0378
         CLI   TESTIND,7                                           0378
         BNE   @RF00378                                            0378
@RT00378 DS    0H                                                  0379
*           DO;                                                    0379
*                                                                  0379
*             /*******************************************************/
*             /*                                                     */
*             /* BUILD ICT MOD ENTRY IF (A)CDS ELEMENT IS FROM THE   */
*             /* FUNCTION BEING DELETED                              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0380
*             CALL CDSDEL1(IOPPMODS(J),/* ELEMENT NAME               */
*                 TESTIND,          /* ELEMENT TYPE                  */
*                 DELFCTN,          /* FUNCTION BEING DELETED        */
*                 ICTPTFS(1));      /* SYSMOD BEING DELETED          */
         LR    @15,J                                               0380
         MH    @15,@CH00034                                        0380
         LA    @15,IOPPMODS-9(@15,PTRIOP1)                         0380
         ST    @15,@AL00001                                        0380
         LA    @15,TESTIND                                         0380
         ST    @15,@AL00001+4                                      0380
         LA    @15,DELFCTN                                         0380
         ST    @15,@AL00001+8                                      0380
         L     @15,@PC00002                                        0380
         ST    @15,@AL00001+12                                     0380
         LA    @01,@AL00001                                        0380
         BAL   @14,CDSDEL1                                         0380
*             IF TESTIND=IOPPSRCR   /* SOURCE ELEMENT BEING DELETED  */
*               THEN                                               0381
         CLI   TESTIND,6                                           0381
         BNE   @RF00381                                            0381
*               DO;                                                0382
*                                                                  0382
*                 /***************************************************/
*                 /*                                                 */
*                 /* BUILD ICT MOD ENTRY FOR THE MODULE CORRESPONDING*/
*                 /* TO THE ABOVE ++SRC ELEMENT                      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0383
*                 TESTIND=IOPPMOD;  /* ELEMENT TYPE IS NOW ++MOD     */
         MVI   TESTIND,X'01'                                       0383
*                 CALL CDSDEL1(IOPPMODS(J),/* ELEMENT NAME           */
*                     TESTIND,      /* ELEMENT TYPE                  */
*                     DELFCTN,      /* FUNCTION BEING DELETED        */
*                     ICTPTFS(1));  /* SYSMOD BEING DELETED          */
         LR    @15,J                                               0384
         MH    @15,@CH00034                                        0384
         LA    @15,IOPPMODS-9(@15,PTRIOP1)                         0384
         ST    @15,@AL00001                                        0384
         LA    @15,TESTIND                                         0384
         ST    @15,@AL00001+4                                      0384
         LA    @15,DELFCTN                                         0384
         ST    @15,@AL00001+8                                      0384
         L     @15,@PC00002                                        0384
         ST    @15,@AL00001+12                                     0384
         LA    @01,@AL00001                                        0384
         BAL   @14,CDSDEL1                                         0384
*               END;                                               0385
*           END;                    /* END PROCESSING ELEMENT      0386
*                                      SUBENTRY                      */
@RF00381 DS    0H                                                  0387
*       END;                        /* END LOOP THRU (A)CDS PTF    0387
*                                      SUBENTRIES                    */
@RF00378 AL    J,@CF00065                                          0387
@DE00372 LR    @15,J                                               0387
         MH    @15,@CH00034                                        0387
         SLR   @14,@14                                             0387
         IC    @14,IOPPTFND-9(@15,PTRIOP1)                         0387
         CH    @14,@CH00765                                        0387
         BNE   @DL00372                                            0387
*     END;                          /* END DELETED SYSMOD FOUND ON 0388
*                                      (A)CDS                        */
*   ELSE                                                           0389
*     DO;                                                          0389
*                                                                  0389
         B     @RC00370                                            0389
@RF00370 DS    0H                                                  0390
*       /*************************************************************/
*       /*                                                           */
*       /* SYSMOD TO BE DELETED NOT LOCATED ON (A)CDS                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0390
*       IF IOPRETRN>IOPNOTFD THEN                                  0390
         CLI   IOPRETRN(PTRIOP1),4                                 0390
         BNH   @RF00390                                            0390
*         DO;                                                      0391
*                                                                  0391
*           /*********************************************************/
*           /*                                                       */
*           /* I/O ERROR ACCESSING (A)CDS PTF ENTRY FOR SYSMOD BEING */
*           /* DELETED. THIS MUST TERMINATE THE FUNCTION.            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0392
*           HIGHTMD=MAX(HIGHTMD,IOPRETRN);/* MAINTAIN HIGHTMD RET  0392
*                                      CODE                          */
         L     @03,HIGHTMD                                         0392
         SLR   @15,@15                                             0392
         IC    @15,IOPRETRN(,PTRIOP1)                              0392
         CR    @03,@15                                             0392
         BNL   *+6
         LR    @03,@15                                             0392
         ST    @03,HIGHTMD                                         0392
*         END;                                                     0393
*     END;                                                         0394
*                                                                  0394
@RF00390 DS    0H                                                  0395
*   /*****************************************************************/
*   /*                                                               */
*   /* MOD SECTION ENTRIES BUILT FOR ELEMENTS WHICH BELONG TO THE    */
*   /* SYSMOD BEING DELETED                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0395
*   RESPECIFY                                                      0395
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECT       */
*                                                                  0395
@RC00370 DS    0H                                                  0396
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU THE MOD SECT AND CHAIN ENTRIES JUST ADDED TO THE      */
*   /* CURRENT SYSMOD                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0396
*   DO J=1 BY 1 WHILE ICTMEND(J)^=ICTENDNT;                        0396
         LA    J,1                                                 0396
         B     @DE00396                                            0396
@DL00396 DS    0H                                                  0397
*     IF ICTMPASS(J)=ON             /* ADDED THIS PASS               */
*       THEN                                                       0397
         LR    @15,J                                               0397
         MH    @15,@CH02383                                        0397
         L     @14,CCAICMOD(,CCAPTR)                               0397
         ST    @15,@TF00001                                        0397
         ALR   @15,@14                                             0397
         AL    @15,@CF02427                                        0397
         TM    ICTMPASS-12(@15),B'10000000'                        0397
         BNO   @RF00397                                            0397
*       DO;                                                        0398
*                                                                  0398
*         /***********************************************************/
*         /*                                                         */
*         /* PUT PTR TO ELEMENT IN PTF ENTRY LIST                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0399
*         PTR0=ADDR(ICTMOD(J));     /* ADDRESS OF MOD ENTRY          */
         L     @15,@TF00001                                        0399
         AL    @14,@CF02422                                        0399
         LA    @15,ICTMOD(@15,@14)                                 0399
         ST    @15,PTR0                                            0399
*         CALL HMASMTAI(TBLXPARM,   /* TBLX PARMS                    */
*             ICTPCHN(1),           /* MOD CHAIN                     */
*             ADDR(PTR0),           /* VARIABLE CONTAINING @ MOD ENT.*/
*             LENGTH(ICTIXP));                                     0400
         L     @15,@PC00001                                        0400
         ST    @15,@AL00001                                        0400
         L     @15,@PC00002                                        0400
         LA    @15,ICTPCHN(,@15)                                   0400
         ST    @15,@AL00001+4                                      0400
         LA    @15,PTR0                                            0400
         ST    @15,@TF00001                                        0400
         LA    @15,@TF00001                                        0400
         ST    @15,@AL00001+8                                      0400
         LA    @15,@CF00040                                        0400
         ST    @15,@AL00001+12                                     0400
         L     @15,@CV01892                                        0400
         LA    @01,@AL00001                                        0400
         BALR  @14,@15                                             0400
*         ICTMPASS(J)=OFF;          /* CLEAR "THIS PASS" FLAG        */
         LR    @15,J                                               0401
         MH    @15,@CH02383                                        0401
         L     @01,CCAICMOD(,CCAPTR)                               0401
         ALR   @01,@15                                             0401
         AL    @01,@CF02427                                        0401
         NI    ICTMPASS-12(@01),B'01111111'                        0401
*       END;                                                       0402
*   END;                                                           0403
@RF00397 AL    J,@CF00065                                          0403
@DE00396 LR    @15,J                                               0403
         MH    @15,@CH02383                                        0403
         L     @01,CCAICMOD(,CCAPTR)                               0403
         AL    @01,@CF02422                                        0403
         L     @15,ICTMEND(@15,@01)                                0403
         CL    @15,ICTENDNT                                        0403
         BNE   @DL00396                                            0403
*   IF ICTPCHN(1)=0                 /* NO ENTRIES BUILT              */
*     THEN                                                         0404
         L     @03,@PC00002                                        0404
         ICM   @15,15,ICTPCHN(@03)                                 0404
         BNZ   @RF00404                                            0404
*     ICTPCHN(1)=TBLXNULL;          /* POINT TO EMPTY LIST           */
         L     @15,@PC00001                                        0405
         MVC   ICTPCHN(4,@03),TBLXNULL(@15)                        0405
*   RETURN;                                                        0406
@EL00002 DS    0H                                                  0406
@EF00002 DS    0H                                                  0406
@ER00002 LM    @14,@12,@SA00002                                    0406
         BR    @14                                                 0406
*                                                                  0407
*/********************************************************************/
*/*                                                                  */
*/* CDSDEL1  - BUILD ICT MOD SECTION ENTRY FOR ELEMENT FROM A        */
*/*            DELETED SYSMOD                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0407
*CDSDEL1:                                                          0407
*   PROC(DELMNAME,DELMTYP,DELMFCTN,DELMSMD);                       0407
CDSDEL1  STM   @14,@12,@SA00003                                    0407
         MVC   @PC00003(16),0(@01)                                 0407
*   DCL                                                            0408
*     DELMNAME CHAR(8);             /* ELEMENT TO BE DELETED         */
*   DCL                                                            0409
*     DELMTYP FIXED(8);             /* ELEMENT TYPE                  */
*   DCL                                                            0410
*     DELMFCTN CHAR(7);             /* FUNCTION BEING DELETED        */
*   DCL                                                            0411
*     DELMSMD CHAR(7);              /* SYSMOD BEING DELETED          */
*   CALL RMODICT(DELMNAME,DELMTYP,PTR0);/* CHECK ICT TO SEE IF     0412
*                                      ELEMENT IS THERE              */
         L     @15,@PC00003                                        0412
         ST    @15,@AL00001                                        0412
         L     @15,@PC00003+4                                      0412
         ST    @15,@AL00001+4                                      0412
         LA    @15,PTR0                                            0412
         ST    @15,@AL00001+8                                      0412
         LA    @01,@AL00001                                        0412
         BAL   @14,RMODICT                                         0412
*   IF PTR0^=0                      /* ELEMENT FOUND IN ICT          */
*     THEN                                                         0413
         ICM   @15,15,PTR0                                         0413
         BZ    @RF00413                                            0413
*     PTRIOP2->IOPRETRN=IOPNOTFD;   /* DO NOT BUILD ANOTHER DELETED
*                                      ICT MOD SECT ENTRY            */
         L     @01,PTRIOP2                                         0414
         MVI   IOPRETRN(@01),X'04'                                 0414
*   ELSE                                                           0415
*     CALL LOCELEM(DELMNAME,DELMTYP);/* LOOK FOR MOD ON (A)CDS       */
         B     @RC00413                                            0415
@RF00413 L     @15,@PC00003                                        0415
         ST    @15,@AL00001                                        0415
         L     @15,@PC00003+4                                      0415
         ST    @15,@AL00001+4                                      0415
         LA    @01,@AL00001                                        0415
         BAL   @14,LOCELEM                                         0415
*   IF PTRIOP2->IOPRETRN=IOPGOOD    /* ELEMENT LOCATED ON (A)CDS     */
*       &(PTRIOP2->IOPFMID=DELMFCTN /* ELEMENT-FMID MATCHES FUNCTION
*                                      BEING DELETED                 */
*       ×(PTRIOP2->IOPFMID=NULLPTF# /* ELEMENT HAS NO FMID ... AND   */
*       &PTRIOP2->IOPRMID=DELMSMD)) /* ELEMENT-RMID MATCHES SYSMOD 0416
*                                      BEING DELETED                 */
*     THEN                                                         0416
@RC00413 L     @15,PTRIOP2                                         0416
         CLI   IOPRETRN(@15),0                                     0416
         BNE   @RF00416                                            0416
         L     @14,@PC00003+8                                      0416
         CLC   IOPFMID(7,@15),DELMFCTN(@14)                        0416
         BE    @RT00416                                            0416
         CLC   IOPFMID(7,@15),@CC01944                             0416
         BNE   @RF00416                                            0416
         L     @14,@PC00003+12                                     0416
         CLC   IOPRMID(7,@15),DELMSMD(@14)                         0416
         BNE   @RF00416                                            0416
@RT00416 DS    0H                                                  0417
*     DO;                                                          0417
*                                                                  0417
*       /*************************************************************/
*       /*                                                           */
*       /* ELEMENT NOT ALREADY IN ICT AND ELEMENT FOUND ON (A)CDS FOR*/
*       /* PROPER FMID ... GET A MOD SECT ENTRY AND INITIALIZE IT    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0418
*       PTR0=TBLXTOP;               /* ADDR OF ENTRY TO BE OBTAINED  */
         L     @15,@PC00001                                        0418
         MVC   PTR0(4),TBLXTOP(@15)                                0418
*       CALL HMASMTAD(TBLXPARM,     /* PARM LIST                     */
*           'M',                    /* BUILD MOD SECTION ENTRY       */
*           IOPPMODS(J));           /* ENTRY NAME                    */
         ST    @15,@AL00001                                        0419
         LA    @15,@CC00717                                        0419
         ST    @15,@AL00001+4                                      0419
         LR    @15,J                                               0419
         MH    @15,@CH00034                                        0419
         LA    @15,IOPPMODS-9(@15,PTRIOP1)                         0419
         ST    @15,@AL00001+8                                      0419
         L     @15,@CV01891                                        0419
         LA    @01,@AL00001                                        0419
         BALR  @14,@15                                             0419
*       RESPECIFY                                                  0420
*         REG15 RSTD;                                              0420
*       IF REG15^=ZERO THEN                                        0421
         LTR   REG15,REG15                                         0421
         BZ    @RF00421                                            0421
*         HIGHTMD=MAX(HIGHTMD,REG15);/* MAINTAIN HIGHTMD RETURN CODE */
         L     @14,HIGHTMD                                         0422
         CR    @14,REG15                                           0422
         BNL   *+6
         LR    @14,REG15                                           0422
         ST    @14,HIGHTMD                                         0422
*       ELSE                                                       0423
*         DO;                                                      0423
         B     @RC00421                                            0423
@RF00421 DS    0H                                                  0424
*           RESPECIFY                                              0424
*             REG15 UNRSTD;                                        0424
*           RESPECIFY                                              0425
*             ICTMOD BASED(PTR0);   /* ADDRESS MOD SECTION ENTRY   0425
*                                      OBTAINED                      */
*                                                                  0425
*           /*********************************************************/
*           /*                                                       */
*           /* INITIALIZE MOD ENTRY FOR DELETED ELEMENT              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0426
*           ICTMFMID(1)=PTRIOP2->IOPFMID;/* ELEMENT-FMID             */
         L     @15,PTR0                                            0426
         L     @14,PTRIOP2                                         0426
         MVC   ICTMFMID(7,@15),IOPFMID(@14)                        0426
*           ICTMISEL(1)=ON;         /* SET ELEMENT SELECTED          */
*           ICTMTSEL(1)=ON;         /* SET TRANSIENT SELECT FLAG     */
*           ICTMIDEL(1)=ON;         /* SET ELEMENT DELETED           */
         OI    ICTMISEL(@15),B'11000010'                           0429
*           IF DELMTYP=IOPPMOD      /* ++MOD                         */
*             THEN                                                 0430
         L     @14,@PC00003+4                                      0430
         CLI   DELMTYP(@14),1                                      0430
         BNE   @RF00430                                            0430
*             ICTMMOD(1)=ON;        /* MODULE REPLACEMENT            */
         OI    ICTMMOD(@15),B'10000000'                            0431
*           IF DELMTYP=IOPPMACR     /* ++MAC                         */
*               ×DELMTYP=IOPPMACU   /* ++MACUPD                      */
*             THEN                                                 0432
@RF00430 L     @15,@PC00003+4                                      0432
         CLI   DELMTYP(@15),4                                      0432
         BE    @RT00432                                            0432
         CLI   DELMTYP(@15),5                                      0432
         BNE   @RF00432                                            0432
@RT00432 DS    0H                                                  0433
*             ICTMMACR(1)=ON;       /* MACRO REPLACEMENT             */
         L     @01,PTR0                                            0433
         OI    ICTMMACR(@01),B'00001000'                           0433
*           IF DELMTYP=IOPPSRCR     /* ++SRC                         */
*               ×DELMTYP=IOPPSRCU   /* ++SRCUPD                      */
*             THEN                                                 0434
@RF00432 L     @15,@PC00003+4                                      0434
         CLI   DELMTYP(@15),6                                      0434
         BE    @RT00434                                            0434
         CLI   DELMTYP(@15),7                                      0434
         BNE   @RF00434                                            0434
@RT00434 DS    0H                                                  0435
*             ICTMSRCR(1)=ON;       /* SOURCE REPLACEMENT            */
         L     @01,PTR0                                            0435
         OI    ICTMSRCR(@01),B'00000010'                           0435
*           ICTPPTR(1)=ADDR(ICTPTF(1));/* POINT TO PTF SECTION ENTRY */
*                                                                  0436
@RF00434 L     @15,PTR0                                            0436
         L     @14,@PC00002                                        0436
         ST    @14,ICTPPTR(,@15)                                   0436
*           /*********************************************************/
*           /*                                                       */
*           /* INITIALIZE MOD ENTRY FROM (A)CDS ELEMENT ENTRY IOP    */
*           /* (POINTED TO BY PTRIOP2)                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0437
*           CALL INITICTM(PTRIOP2,ICTMOD(1));                      0437
         LA    @14,PTRIOP2                                         0437
         ST    @14,@AL00001                                        0437
         ST    @15,@AL00001+4                                      0437
         LA    @01,@AL00001                                        0437
         BAL   @14,INITICTM                                        0437
*           ICTMPASS(1)=ON;         /* SET "PASS" FLAG IN ENTRY ADDED*/
         L     @01,PTR0                                            0438
         OI    ICTMPASS(@01),B'10000000'                           0438
*         END;                      /* END MOD ENTRY INITIALIZATION  */
*     END;                          /* END MOD ENTRY FOUND ON (A)CDS */
*   RETURN;                                                        0441
@EL00003 DS    0H                                                  0441
@EF00003 DS    0H                                                  0441
@ER00003 LM    @14,@12,@SA00003                                    0441
         BR    @14                                                 0441
*   END CDSDEL1;                                                   0442
         B     @EL00003                                            0442
*   END CDSDEL;                                                    0443
         B     @EL00002                                            0443
*                                                                  0444
*/********************************************************************/
*/*                                                                  */
*/*    BLDICTM  - BUILD ICT MOD SECTION ENTRIES FOR THE SYSMODS      */
*/*               IN THE ICT                                         */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * ICT PTF SECTION BUILT                                      */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * ICT MOD SECTION BUILT                                      */
*/*                                                                  */
*/*     * SELECTED ELEMENTS (SUPPLIED IN-LINE) MOVED TO SMPWRK       */
*/*       DATASETS                                                   */
*/*                                                                  */
*/*     * ICTMIDPS ( (A)CDS MODID LIST PRE/SUP FLAGS) APPROPRIATELY  */
*/*       SET FOR SELECTED ELEMENTS FROM NON-TERMINATED SYSMODS      */
*/*                                                                  */
*/*     * ICTPNOGO (SYSMOD NOGO FLAG) SET IN ICT PTF SECTION ENTRY   */
*/*       FOR SYSMODS WHICH WERE TERMINATED DURING ELEMENT SELECTION */
*/*                                                                  */
*/*     * HIGHTMD  - SET TO THE MAXIMUM RETURN CODE ENCOUNTERED      */
*/*                  DURING MOD SECTION BUILD PROCESSING.            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0444
*BLDICTM:                                                          0444
*   PROC;                                                          0444
BLDICTM  STM   @14,@12,@SA00004                                    0444
*   DCL                                                            0445
*     BLDICTRC FIXED(31);           /* LOCAL RETURN CODE ...       0445
*                                      "CURRENT" SYSMOD PROCESSING 0445
*                                      CODE                          */
*   DCL                                                            0446
*     SI FIXED(31);                 /* ICT PTF SECTION ENTRY INDEX   */
*   RESPECIFY                                                      0447
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE PTF SECTION    */
*                                                                  0448
*   /*****************************************************************/
*   /*                                                               */
*   /* GET SYSMODS FROM THE ICT (IN THEIR SYSMOD PROCESSING ORDER)   */
*   /* AND BUILD THE ICT MOD SECTION UNTIL THERE ARE NO PROCESSABLE  */
*   /* SYSMODS LEFT IN THE ICT                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0448
*   BUILD=CONTINUE;                 /* LOOP CONTROL                  */
         OI    BUILD,B'01000000'                                   0448
*   DO WHILE BUILD=CONTINUE         /* PROCESSABLE SYSMOD LAST PASS  */
*         &HIGHTMD<STOPFUNC;        /* NON-TERMINATING ERRORS        */
         B     @DE00449                                            0449
@DL00449 DS    0H                                                  0450
*     BUILD=STOP;                   /* LOOP CONTROL SET TO STOP      */
         NI    BUILD,B'10111111'                                   0450
*     BLDICTRC=0;                   /* "CURRENT" SYSMOD PROCESSING   */
         SLR   @03,@03                                             0451
         ST    @03,BLDICTRC                                        0451
*     CALL GETSYSPO(SI);            /* GET NEXT PROCESSABLE SYSMOD   */
         LA    @01,@AL00452                                        0452
         BAL   @14,GETSYSPO                                        0452
*     IF SI^=0 THEN                                                0453
         L     @03,SI                                              0453
         LTR   @03,@03                                             0453
         BZ    @RF00453                                            0453
*       DO;                                                        0454
*                                                                  0454
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESSABLE SYSMOD FOUND ... BUILD MOD SECT ENTRIES     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0455
*         MSGSMDNM=ICTPTFS(SI);     /* SET UP SYSMOD NAME FOR ERRMSG */
         MH    @03,@CH02382                                        0455
         L     @15,CCAICPTF(,CCAPTR)                               0455
         ST    @03,@TF00001                                        0455
         ALR   @03,@15                                             0455
         AL    @03,@CF02417                                        0455
         MVC   MSGSMDNM(7),ICTPTFS(@03)                            0455
*         BUILD=CONTINUE;           /* LOOP CONTROL ... THERE MAY BE
*                                      MORE PROCESSABLE SYSMODS      */
         OI    BUILD,B'01000000'                                   0456
*         CALL BLDMODS(ICTPTF(SI),  /* "CURRENT" SYSMOD              */
*             BLDICTRC);            /* "CURRENT" RETURN CODE         */
         L     @03,@TF00001                                        0457
         AL    @15,@CF02417                                        0457
         LA    @03,ICTPTF(@03,@15)                                 0457
         ST    @03,@AL00001                                        0457
         LA    @03,BLDICTRC                                        0457
         ST    @03,@AL00001+4                                      0457
         LA    @01,@AL00001                                        0457
         BAL   @14,BLDMODS                                         0457
*         ICTPMSL(SI)=ON;           /* INDICATE THIS SYSMOD PROCESSED*/
         L     @03,SI                                              0458
         MH    @03,@CH02382                                        0458
         L     @15,CCAICPTF(,CCAPTR)                               0458
         ST    @03,@TF00001                                        0458
         ALR   @03,@15                                             0458
         AL    @03,@CF02418                                        0458
         OI    ICTPMSL-15(@03),B'10000000'                         0458
*         CALL MARKSUPS(ICTPTF(SI));/* MARK SUPD SYSMODS AS PROCESSED*/
         L     @03,@TF00001                                        0459
         AL    @15,@CF02417                                        0459
         LA    @03,ICTPTF(@03,@15)                                 0459
         ST    @03,@AL00001                                        0459
         LA    @01,@AL00001                                        0459
         BAL   @14,MARKSUPS                                        0459
*         IF BLDICTRC<STOPPTF THEN                                 0460
         L     @03,BLDICTRC                                        0460
         CH    @03,@CH00033                                        0460
         BNL   @RF00460                                            0460
*           DO;                                                    0461
*                                                                  0461
*             /*******************************************************/
*             /*                                                     */
*             /* MOD SECT ENTRIES BUILT ... SELECT ELEMENTS          */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0462
*             CALL HMASMTMS(TBLXPARM,/* TBLX PARM LIST               */
*                 ADDR(ICTPTF(SI)));/* CURRENT SYSMOD                */
         L     @03,@PC00001                                        0462
         ST    @03,@AL00001                                        0462
         L     @03,SI                                              0462
         MH    @03,@CH02382                                        0462
         L     @01,CCAICPTF(,CCAPTR)                               0462
         AL    @01,@CF02417                                        0462
         LA    @03,ICTPTF(@03,@01)                                 0462
         ST    @03,@TF00001                                        0462
         LA    @03,@TF00001                                        0462
         ST    @03,@AL00001+4                                      0462
         L     @15,@CV01894                                        0462
         LA    @01,@AL00001                                        0462
         BALR  @14,@15                                             0462
*             RESPECIFY                                            0463
*               REG15 RSTD;                                        0463
*             BLDICTRC=MAX(BLDICTRC,REG15);/* SAVE TMS RETURN CODE   */
         L     @14,BLDICTRC                                        0464
         CR    @14,REG15                                           0464
         BNL   *+6
         LR    @14,REG15                                           0464
         ST    @14,BLDICTRC                                        0464
*             RESPECIFY                                            0465
*               REG15 UNRSTD;                                      0465
*           END;                                                   0466
*         IF BLDICTRC<STOPPTF       /* "CURRENT" SYSMOD NOT TERM     */
*             &BLDM2WRK=ON          /* ELEMENTS TO BE MOVED TO WRK   */
*           THEN                                                   0467
@RF00460 L     @03,BLDICTRC                                        0467
         CH    @03,@CH00033                                        0467
         BNL   @RF00467                                            0467
         TM    BLDM2WRK,B'00100000'                                0467
         BNO   @RF00467                                            0467
*           DO;                                                    0468
*                                                                  0468
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE REMAINING ELEMENTS TO WRK DATASETS             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0469
*             CALL BLDMODS2(ICTPTF(SI),/* "CURRENT" SYSMOD           */
*                 BLDICTRC);        /* RETURN CODE                   */
         L     @03,SI                                              0469
         MH    @03,@CH02382                                        0469
         L     @01,CCAICPTF(,CCAPTR)                               0469
         AL    @01,@CF02417                                        0469
         LA    @03,ICTPTF(@03,@01)                                 0469
         ST    @03,@AL00001                                        0469
         LA    @03,BLDICTRC                                        0469
         ST    @03,@AL00001+4                                      0469
         LA    @01,@AL00001                                        0469
         BAL   @14,BLDMODS2                                        0469
*           END;                                                   0470
*         IF BLDICTRC<STOPPTF       /* SYSMOD SUCCESSFUL             */
*           THEN                                                   0471
@RF00467 L     @03,BLDICTRC                                        0471
         CH    @03,@CH00033                                        0471
         BNL   @RF00471                                            0471
*           DO;                                                    0472
*                                                                  0472
*             /*******************************************************/
*             /*                                                     */
*             /* SET ICTMIDPS FLAGS FOR SELECTED ELEMENTS            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0473
*             CALL BLDMODS3(ICTPTF(SI),/* "CURRENT" SYSMOD           */
*                 BLDICTRC);        /* RETURN CODE                   */
         L     @03,SI                                              0473
         MH    @03,@CH02382                                        0473
         L     @01,CCAICPTF(,CCAPTR)                               0473
         AL    @01,@CF02417                                        0473
         LA    @03,ICTPTF(@03,@01)                                 0473
         ST    @03,@AL00001                                        0473
         LA    @03,BLDICTRC                                        0473
         ST    @03,@AL00001+4                                      0473
         LA    @01,@AL00001                                        0473
         BAL   @14,BLDMODS3                                        0473
*           END;                                                   0474
*         ELSE                                                     0475
*           DO;                                                    0475
*                                                                  0475
         B     @RC00471                                            0475
@RF00471 DS    0H                                                  0476
*             /*******************************************************/
*             /*                                                     */
*             /* TERMINATE MOD SECT BUILD FOR THIS SYSMOD            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0476
*             MGPTYPE=MGPINFO;      /* INFORMATIONAL                 */
         MVI   MGPTYPE,X'01'                                       0476
*             CALL ERRMSG(HMA226I,PART011);/* PROCESSING TERM        */
         LA    @01,@AL00477                                        0477
         BAL   @14,ERRMSG                                          0477
*             IF ICTPTYPE(SI)=IOPPFUNC/* FUNCTION SYSMOD FAILED      */
*               THEN                                               0478
         L     @03,SI                                              0478
         MH    @03,@CH02382                                        0478
         L     @01,CCAICPTF(,CCAPTR)                               0478
         AL    @01,@CF02426                                        0478
         SLR   @00,@00                                             0478
         IC    @00,ICTPTYPE-17(@03,@01)                            0478
         CH    @00,@CH00040                                        0478
         BNE   @RF00478                                            0478
*               CALL ERRMSG(HMA370I);/* ISSUE HMA370I                */
*                                                                  0479
         LA    @01,@AL00479                                        0479
         BAL   @14,ERRMSG                                          0479
*             /*******************************************************/
*             /*                                                     */
*             /* MARK "CURRENT" SYSMOD NOGO AND CHECK ICT PTF SECTION*/
*             /* FOR REQUISITES                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0480
*             ICTPNOGO(SI)=ON;      /* MARK SYSMOD NOGO              */
@RF00478 DS    0H                                                  0481
*             ICTPCPL(SI)=ON;       /* MARK SYSMOD AS COMPLETE       */
*             ICTPMSG(SI)=ON;       /* SET MSG ISSUED FLAG           */
         L     @03,SI                                              0482
         MH    @03,@CH02382                                        0482
         L     @01,CCAICPTF(,CCAPTR)                               0482
         ALR   @01,@03                                             0482
         AL    @01,@CF02416                                        0482
         OI    ICTPNOGO-8(@01),B'01110000'                         0482
*             IF BLDICTRC<STOPFUNC&HIGHTMD<STOPFUNC THEN           0483
         LA    @03,12                                              0483
         C     @03,BLDICTRC                                        0483
         BNH   @RF00483                                            0483
         C     @03,HIGHTMD                                         0483
         BNH   @RF00483                                            0483
*               DO;                                                0484
*                 CALL HMASMTCR(TBLXPARM,MSG);/* CHECK REQUISITES    */
         L     @03,@PC00001                                        0485
         ST    @03,@AL00001                                        0485
         LA    @03,@CC00717                                        0485
         ST    @03,@AL00001+4                                      0485
         L     @15,@CV01893                                        0485
         LA    @01,@AL00001                                        0485
         BALR  @14,@15                                             0485
*                 RESPECIFY                                        0486
*                   REG15 RSTD;                                    0486
*                 BLDICTRC=MAX(BLDICTRC,REG15);/* MAINTAIN R.C.      */
         L     @14,BLDICTRC                                        0487
         CR    @14,REG15                                           0487
         BNL   *+6
         LR    @14,REG15                                           0487
         ST    @14,BLDICTRC                                        0487
*                 RESPECIFY                                        0488
*                   REG15 UNRSTD;                                  0488
*               END;                                               0489
*           END;                                                   0490
@RF00483 DS    0H                                                  0491
*         IF BLDICTRC>0             /* ERRORS IN PROCESSING          */
*           THEN                                                   0491
@RC00471 ICM   @03,15,BLDICTRC                                     0491
         BNP   @RF00491                                            0491
*           CALL SKIP(1);           /* SKIP A LINE ON SMPOUT         */
         LA    @01,@AL00492                                        0492
         BAL   @14,SKIP                                            0492
*         HIGHTMD=MAX(HIGHTMD,BLDICTRC);/* SET MAX R.C. FROM LAST  0493
*                                      SYSMOD PROCESSED              */
@RF00491 L     @03,HIGHTMD                                         0493
         L     @15,BLDICTRC                                        0493
         CR    @03,@15                                             0493
         BNL   *+6
         LR    @03,@15                                             0493
         ST    @03,HIGHTMD                                         0493
*       END;                        /* END OF PROCESSING 1         0494
*                                      PROCESSABLE SYSMOD            */
*   END;                            /* END OF LOOP WHILE           0495
*                                      BUILD=CONTINUE                */
@RF00453 DS    0H                                                  0495
@DE00449 TM    BUILD,B'01000000'                                   0495
         BNO   @DC00449                                            0495
         L     @03,HIGHTMD                                         0495
         CH    @03,@CH00036                                        0495
         BL    @DL00449                                            0495
@DC00449 DS    0H                                                  0496
*   RETURN;                                                        0496
@EL00004 DS    0H                                                  0496
@EF00004 DS    0H                                                  0496
@ER00004 LM    @14,@12,@SA00004                                    0496
         BR    @14                                                 0496
*   END BLDICTM;                                                   0497
*                                                                  0498
*/********************************************************************/
*/*                                                                  */
*/*    BLDMODS  - BUILD ICT MOD SECTION ENTRIES FOR ALL ELEMENTS     */
*/*               SUPPLIED IN THE "CURRENT" SYSMOD.                  */
*/*                                                                  */
*/*               - ACCESS THE "CURRENT" SYSMOD'S MCS ENTRY ON       */
*/*                 THE PTS                                          */
*/*                                                                  */
*/*               - READ THRU THE MODIFICATION CONTROL STATEMENTS    */
*/*                                                                  */
*/*               - CALL BLDENTRY FOR EACH ELEMENT MCS ENCOUNTERED   */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * BLDSYSMD - ICT PTF SECTION ENTRY REPRESENTING THE          */
*/*                  "CURRENT" SYSMOD                                */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * BLDMODRC - PARAMETER RETURNED TO CALLER AS FOLLOWS:        */
*/*                                                                  */
*/*                  0 - MOD SECT ENTRIES FOR SYSMOD SUCCESSFULLY    */
*/*                      BUILT                                       */
*/*                                                                  */
*/*                  8 - PTS SYSMOD ENTRY NOT FOUND                  */
*/*                    - ERROR BUILDING MOD SECTION ENTRIES          */
*/*                                                                  */
*/*                  8 OR GREATER CODES FROM:                        */
*/*                                                                  */
*/*                      HMASMTAD - GET CORE FOR ENTRY               */
*/*                      HMASMCRD - READ MODIFICATION CNTRL. STMT.   */
*/*                      HMASMIO  - ACCESS PTS MCS ENTRY             */
*/*                      HMASMMPD - PARSE MODIFICATION CNTRL. STMT.  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0498
*BLDMODS:                                                          0498
*   PROC(BLDSYSMD,BLDMODRC);                                       0498
BLDMODS  STM   @14,@12,@SA00005                                    0498
         MVC   @PC00005(8),0(@01)                                  0498
*   DCL                                                            0499
*     BLDSYSMD CHAR(*);             /* ICT PTF ENTRY REPRESENTING  0499
*                                      SYSMOD TO BE PROCESSED        */
*   DCL                                                            0500
*     BLDMODRC FIXED(31);           /* MAX RETURN CODE PARAMETER     */
*   DCL                                                            0501
*     BLDMODPC FIXED(31);           /* ELEMENT RETURN CODE VARIABLE  */
*   DCL                                                            0502
*     JM FIXED(15);                 /* INDEX - MOD SECT ENTRIES      */
*   DCL                                                            0503
*     MODADDR PTR(31);              /* ADDR OF ICT MOD SECT ENTRY    */
*                                                                  0504
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FOR BUILDING MOD SECT ENTRIES - "CURRENT" SYSMOD   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0504
*   BLDMODRC=ZERO;                  /* INITIALIZE RETURN CODE        */
         SLR   @03,@03                                             0504
         L     @15,@PC00005+4                                      0504
         ST    @03,BLDMODRC(,@15)                                  0504
*   BLDM2WRK=OFF;                   /* CLEAR DEFERRED WRK DATASET  0505
*                                      PROCESSING FLAG               */
         NI    BLDM2WRK,B'11011111'                                0505
*   RESPECIFY                                                      0506
*     ICTPTF BASED(ADDR(BLDSYSMD)); /* PTF ENTRY PASSED              */
*   RESPECIFY                                                      0507
*     HMASMIOP BASED(PTRIOP1);      /* IOP USED TO ACCESS PTS        */
*   ICTPCHN(1)=0;                   /* CLEAR PTR TO LIST OF MOD SECT
*                                      ENTRIES BUILT FOR THIS SYSMOD */
         L     @14,@PC00005                                        0508
         ST    @03,ICTPCHN(,@14)                                   0508
*   ICTPWRKO(1)=OFF;                /* SYSMOD HAS NOT OVERLAID WRK 0509
*                                      DATASET MEMBERS               */
*                                                                  0509
         NI    ICTPWRKO(@14),B'10111111'                           0509
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE SYSMOD MCS ENTRY ON THE PTS AND READ FIRST RECORD      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0510
*   CALL LOCMCS(ICTPTFS(1),BLDMODRC);/* LOCATE MCS ENTRY             */
         ST    @14,@AL00001                                        0510
         ST    @15,@AL00001+4                                      0510
         LA    @01,@AL00001                                        0510
         BAL   @14,LOCMCS                                          0510
*   IF BLDMODRC=ZERO THEN                                          0511
         L     @15,@PC00005+4                                      0511
         ICM   @14,15,BLDMODRC(@15)                                0511
         BNZ   @RF00511                                            0511
*     DO;                                                          0512
*       CALL HMASMCRD(HMASMCRP);    /* READ FIRST RECORD             */
         L     @15,@CV01885                                        0513
         LA    @01,@AL00513                                        0513
         BALR  @14,@15                                             0513
*       IF CRPRETRN=CRPEOF          /* END-OF-FILE ENCOUNTERED       */
*         THEN                                                     0514
         CLI   CRPRETRN,4                                          0514
         BNE   @RF00514                                            0514
*         MCSEOF=ON;                /* SET END-OF-FILE FLAG          */
         OI    MCSEOF,B'00010000'                                  0515
*       ELSE                                                       0516
*         BLDMODRC=CRPRETRN;        /* SAVE RETURN CODE              */
         B     @RC00514                                            0516
@RF00514 L     @15,@PC00005+4                                      0516
         SLR   @14,@14                                             0516
         IC    @14,CRPRETRN                                        0516
         ST    @14,BLDMODRC(,@15)                                  0516
*     END;                                                         0517
@RC00514 DS    0H                                                  0518
*                                                                  0518
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ALL RECORDS IN PTS MCS MEMBER FOR THE SYSMOD          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0518
*   DO WHILE BLDMODRC<STOPPTF       /* SYSMOD NOT TERMINATED         */
*         &MCSEOF=OFF;              /* NOT AT END OF MCS MEMBER      */
*                                                                  0518
@RF00511 B     @DE00518                                            0518
@DL00518 DS    0H                                                  0519
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS MODIFICATION CONTROL STATEMENT IN CRPBUFFR          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0519
*     BLDMODPC=0;                   /* CLEAR ELEMENT RETURN CODE     */
         SLR   @15,@15                                             0519
         ST    @15,BLDMODPC                                        0519
*     MPPSMDNM=ICTPTFS(1);          /* PASS SYSMOD NUMBER            */
         L     @15,@PC00005                                        0520
         MVC   MPPSMDNM(7),ICTPTFS(@15)                            0520
*     CALL HMASMMPD(MPPPARM);       /* PARSE STATEMENT               */
         L     @15,@CV01887                                        0521
         LA    @01,@AL00521                                        0521
         BALR  @14,@15                                             0521
*     RESPECIFY                                                    0522
*       REG15 RSTD;                                                0522
*     BLDMODPC=MAX(BLDMODPC,REG15); /* SAVE PARSE RETURN CODE        */
         L     @14,BLDMODPC                                        0523
         CR    @14,REG15                                           0523
         BNL   *+6
         LR    @14,REG15                                           0523
         ST    @14,BLDMODPC                                        0523
*     RESPECIFY                                                    0524
*       REG15 UNRSTD;                                              0524
*     IF BLDMODPC>=STOPPTF          /* TERMINATING PARSE ERROR       */
*       THEN                                                       0525
         CH    @14,@CH00033                                        0525
         BL    @RF00525                                            0525
*       DO;                                                        0526
*         MGPTYPE=MGPERR;           /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0527
*         CALL ERRMSG(HMA355I,NOPART);/* ISSUE HMA355I               */
         LA    @01,@AL00528                                        0528
         BAL   @14,ERRMSG                                          0528
*       END;                                                       0529
*     IF BLDMODPC<STOPPTF THEN                                     0530
@RF00525 L     @15,BLDMODPC                                        0530
         CH    @15,@CH00033                                        0530
         BNL   @RF00530                                            0530
*       DO;                                                        0531
*                                                                  0531
*         /***********************************************************/
*         /*                                                         */
*         /* A MODIFICATION CNTRL STMT HAS BEEN SUCCESSFULLY READ AND*/
*         /* PARSED                                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0532
*         IF MCBTYPE=MCBMODTP       /* ++MOD ELEMENT ?               */
*             ×MCBTYPE=MCBMCRTP     /* ++MAC ELEMENT ?               */
*             ×MCBTYPE=MCBSCRTP     /* ++SRC ELEMENT ?               */
*             ×MCBTYPE=MCBSCUTP     /* ++SRCUPD ELEMENT ?            */
*             ×MCBTYPE=MCBMCUTP     /* ++MACUPD ELEMENT ?            */
*             ×MCBTYPE=MCBZAPTP     /* ++ZAP ELEMENT ?               */
*           THEN                                                   0532
         L     @15,MCBPTR                                          0532
         CLI   MCBTYPE(@15),4                                      0532
         BE    @RT00532                                            0532
         CLI   MCBTYPE(@15),5                                      0532
         BE    @RT00532                                            0532
         CLI   MCBTYPE(@15),6                                      0532
         BE    @RT00532                                            0532
         CLI   MCBTYPE(@15),9                                      0532
         BE    @RT00532                                            0532
         CLI   MCBTYPE(@15),8                                      0532
         BE    @RT00532                                            0532
         CLI   MCBTYPE(@15),7                                      0532
         BNE   @RF00532                                            0532
@RT00532 DS    0H                                                  0533
*           CALL BLDENTRY(BLDSYSMD,BLDMODPC);/* BUILD ENTRY AND    0533
*                                      POSITION THE INPUT TO THE NEXT
*                                      MODIFICATION CONTROL STATEMENT
*                                      (OR EOF)                      */
         L     @15,@PC00005                                        0533
         ST    @15,@AL00001                                        0533
         LA    @15,BLDMODPC                                        0533
         ST    @15,@AL00001+4                                      0533
         LA    @01,@AL00001                                        0533
         BAL   @14,BLDENTRY                                        0533
*         ELSE                                                     0534
*           CALL SKIPELEM(BLDMODPC);/* SKIP OVER NON-ELEM STMT.      */
         B     @RC00532                                            0534
@RF00532 LA    @01,@AL00534                                        0534
         BAL   @14,SKIPELEM                                        0534
*       END;                        /* END OF PROCESSING 1 ELEMENT   */
@RC00532 DS    0H                                                  0536
*     BLDMODRC=MAX(BLDMODRC,BLDMODPC);/* MAINTAIN HIGH RET. CODE     */
@RF00530 L     @15,@PC00005+4                                      0536
         L     @14,BLDMODRC(,@15)                                  0536
         L     @07,BLDMODPC                                        0536
         CR    @14,@07                                             0536
         BNL   *+6
         LR    @14,@07                                             0536
         ST    @14,BLDMODRC(,@15)                                  0536
*   END;                            /* END OF PROCESSING RECORDS IN
*                                      MCS MEMBER                    */
@DE00518 L     @15,@PC00005+4                                      0537
         L     @15,BLDMODRC(,@15)                                  0537
         CH    @15,@CH00033                                        0537
         BNL   @DC00518                                            0537
         TM    MCSEOF,B'00010000'                                  0537
         BZ    @DL00518                                            0537
@DC00518 DS    0H                                                  0538
*                                                                  0538
*   /*****************************************************************/
*   /*                                                               */
*   /* FINISHED PROCESSING PTS MCS MEMBER ... BUILD CHAIN OF ELEMENTS*/
*   /* FOR THE "CURRENT" SYSMOD                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0538
*   RESPECIFY                                                      0538
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */
*                                                                  0538
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0539
*   DO JM=1 BY 1 WHILE ICTMEND(JM)^=ICTENDNT/* NOT AT MOD SECT END   */
*         &BLDMODRC<STOPFUNC;       /* NOT TERMINATING               */
         LA    JM,1                                                0539
         B     @DE00539                                            0539
@DL00539 DS    0H                                                  0540
*     IF ICTPPTR(JM)=ADDR(ICTPTF(1))/* ELEMENT FROM "CURRENT" SYSMOD */
*       THEN                                                       0540
         LR    @03,JM                                              0540
         MH    @03,@CH02383                                        0540
         L     @15,CCAICMOD(,CCAPTR)                               0540
         L     @14,@PC00005                                        0540
         LA    @01,0(@03,@15)                                      0540
         AL    @01,@CF02433                                        0540
         C     @14,ICTPPTR-96(,@01)                                0540
         BNE   @RF00540                                            0540
*       DO;                                                        0541
*                                                                  0541
*         /***********************************************************/
*         /*                                                         */
*         /* PUT ADDRESS OF MOD SECT ENTRY INTO PTF SECTION ENTRY    */
*         /* LIST (ICTIXP)                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0542
*         MODADDR=ADDR(ICTMOD(JM)); /* ICT MOD SECT ENTRY ADDRESS    */
         AL    @15,@CF02422                                        0542
         LA    @03,ICTMOD(@03,@15)                                 0542
         ST    @03,MODADDR                                         0542
*         CALL HMASMTAI(TBLXPARM,   /*                               */
*             ICTPCHN(1),           /* MOD SECT POINTER LIST         */
*             ADDR(MODADDR),        /* ADDR OF MOD SECT ENTRY ADDR   */
*             LENGTH(ICTIXP));      /* LENGTH OF ENTRY IN LIST       */
         L     @03,@PC00001                                        0543
         ST    @03,@AL00001                                        0543
         LA    @03,ICTPCHN(,@14)                                   0543
         ST    @03,@AL00001+4                                      0543
         LA    @03,MODADDR                                         0543
         ST    @03,@TF00001                                        0543
         LA    @03,@TF00001                                        0543
         ST    @03,@AL00001+8                                      0543
         LA    @03,@CF00040                                        0543
         ST    @03,@AL00001+12                                     0543
         L     @15,@CV01892                                        0543
         LA    @01,@AL00001                                        0543
         BALR  @14,@15                                             0543
*         RESPECIFY                                                0544
*           REG15 RSTD;                                            0544
*         BLDMODRC=MAX(BLDMODRC,REG15);/* SAVE RETURN CODE FROM TAI  */
         L     @14,@PC00005+4                                      0545
         L     @03,BLDMODRC(,@14)                                  0545
         CR    @03,REG15                                           0545
         BNL   *+6
         LR    @03,REG15                                           0545
         ST    @03,BLDMODRC(,@14)                                  0545
*         RESPECIFY                                                0546
*           REG15 UNRSTD;                                          0546
*       END;                                                       0547
*   END;                                                           0548
@RF00540 AL    JM,@CF00065                                         0548
@DE00539 LR    @03,JM                                              0548
         MH    @03,@CH02383                                        0548
         L     @01,CCAICMOD(,CCAPTR)                               0548
         AL    @01,@CF02422                                        0548
         L     @03,ICTMEND(@03,@01)                                0548
         CL    @03,ICTENDNT                                        0548
         BE    @DC00539                                            0548
         L     @03,@PC00005+4                                      0548
         L     @03,BLDMODRC(,@03)                                  0548
         CH    @03,@CH00036                                        0548
         BL    @DL00539                                            0548
@DC00539 DS    0H                                                  0549
*   IF ICTPCHN(1)=0                 /* NO MOD SECT ENTRIES BUILT     */
*     THEN                                                         0549
         L     @15,@PC00005                                        0549
         ICM   @14,15,ICTPCHN(@15)                                 0549
         BNZ   @RF00549                                            0549
*     ICTPCHN(1)=TBLXNULL;          /* POINT TO EMPTY LIST           */
         L     @14,@PC00001                                        0550
         MVC   ICTPCHN(4,@15),TBLXNULL(@14)                        0550
*   IF BLDMODRC>=STOPPTF THEN                                      0551
*                                                                  0551
@RF00549 L     @15,@PC00005+4                                      0551
         L     @14,BLDMODRC(,@15)                                  0551
         CH    @14,@CH00033                                        0551
         BL    @RF00551                                            0551
*     /***************************************************************/
*     /*                                                             */
*     /* ERRORS DURING MOD SECTION BUILD ... CLEANUP WRK DATASETS    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0552
*     CALL BLDMODSF(BLDSYSMD,BLDMODRC);                            0552
         L     @14,@PC00005                                        0552
         ST    @14,@AL00001                                        0552
         ST    @15,@AL00001+4                                      0552
         LA    @01,@AL00001                                        0552
         BAL   @14,BLDMODSF                                        0552
*   RETURN;                                                        0553
@EL00005 DS    0H                                                  0553
@EF00005 DS    0H                                                  0553
@ER00005 LM    @14,@12,@SA00005                                    0553
         BR    @14                                                 0553
*   END BLDMODS;                                                   0554
         B     @EL00005                                            0554
*                                                                  0555
*/********************************************************************/
*/*                                                                  */
*/*    BLDMODS2 - FINISH UP PROCESSING OF A SYSMOD AFTER ALL         */
*/*               ELEMENTS HAVE BEEN SELECTED AND THERE REMAIN       */
*/*               IN-LINE ELEMENTS TO BE MOVED TO THE WRK DATASETS   */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *          - ALL ELEMENTS FROM THE "CURRENT" SYSMOD HAVE     */
*/*                  BEEN SUCCESSFULLY SELECTED OR EXCLUDED (I.E.,   */
*/*                  THE SYSMOD IS NOT NOGO DUE TO ID CHECK ERRORS). */
*/*                                                                  */
*/*     *          - THERE ARE MOD SECTION ENTRIES IN THE ICT FOR    */
*/*                  EVERY ELEMENT IN THE "CURRENT" SYSMOD ... THE   */
*/*                  SELECTED ELEMENTS FROM THE "CURRENT" SYSMOD     */
*/*                  HAVE "ICTMISEL" SET "ON" IN THEIR RESPECTIVE    */
*/*                  MOD SECTION ENTRIES.                            */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0555
*BLDMODS2:                                                         0555
*   PROC(BLDM2SMD,BLDMD2RC);                                       0555
BLDMODS2 STM   @14,@12,@SA00006                                    0555
         MVC   @PC00006(8),0(@01)                                  0555
*   DCL                                                            0556
*     BLDM2SMD CHAR(*);             /* ICT PTF ENTRY                 */
*   DCL                                                            0557
*     BLDMD2RC FIXED(31);           /* MAX RETURN CODE COLLECTOR   0557
*                                      PARAMETER                     */
*   DCL                                                            0558
*     BLDMD2PC FIXED(31);           /* ELEMENT RETURN CODE VARIABLE  */
*   DCL                                                            0559
*     MODSCPTR PTR(31);             /* LOCAL POINTER ... USED TO   0559
*                                      ADDRESS MOD SECT ENTRIES    0559
*                                      ASSOCIATED WITH "CURRENT"   0559
*                                      SYSMOD                        */
*   RESPECIFY                                                      0560
*     ICTPTF BASED(ADDR(BLDM2SMD)); /* PTF SECTION ENTRY PASSED ...
*                                      "CURRENT" SYSMOD              */
*   RESPECIFY                                                      0561
*     HMASMIOP BASED(PTRIOP1);      /* IOP BEING USED TO ACCESS PTS  */
*                                                                  0561
*   /*****************************************************************/
*   /*                                                               */
*   /* RE-ACCESS THE PTS MCS MEMBER                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*   CALL LOCMCS(ICTPTFS(1),BLDMD2RC);/* RE-LOCATE PTS MCS MEMBER FOR
*                                      CURRENT SYSMOD                */
         L     @03,@PC00006                                        0562
         ST    @03,@AL00001                                        0562
         L     @03,@PC00006+4                                      0562
         ST    @03,@AL00001+4                                      0562
         LA    @01,@AL00001                                        0562
         BAL   @14,LOCMCS                                          0562
*   IF BLDMD2RC<STOPPTF THEN                                       0563
         L     @15,@PC00006+4                                      0563
         L     @15,BLDMD2RC(,@15)                                  0563
         CH    @15,@CH00033                                        0563
         BNL   @RF00563                                            0563
*     DO;                                                          0564
*       CALL HMASMCRD(HMASMCRP);    /* READ FIRST RECORD             */
         L     @15,@CV01885                                        0565
         LA    @01,@AL00565                                        0565
         BALR  @14,@15                                             0565
*       IF CRPRETRN=CRPEOF          /* END-OF-FILE ON MCS MEMBER     */
*         THEN                                                     0566
         CLI   CRPRETRN,4                                          0566
         BNE   @RF00566                                            0566
*         MCSEOF=ON;                /* SET END-OF-FILE FLAG          */
         OI    MCSEOF,B'00010000'                                  0567
*       ELSE                                                       0568
*         BLDMD2RC=MAX(BLDMD2RC,CRPRETRN);/* SAVE RETURN CODE        */
*                                                                  0568
         B     @RC00566                                            0568
@RF00566 L     @15,@PC00006+4                                      0568
         L     @14,BLDMD2RC(,@15)                                  0568
         SLR   @07,@07                                             0568
         IC    @07,CRPRETRN                                        0568
         CR    @14,@07                                             0568
         BNL   *+6
         LR    @14,@07                                             0568
         ST    @14,BLDMD2RC(,@15)                                  0568
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS ALL RECORDS IN MCS MEMBER                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0569
*       DO WHILE BLDMD2RC<STOPPTF   /* SYSMOD NOT TERMINATED         */
*             &MCSEOF=OFF;          /* NOT AT END-OF-FILE ON MCS     */
*                                                                  0569
@RC00566 B     @DE00569                                            0569
@DL00569 DS    0H                                                  0570
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS MODIFICATION CNTRL STMT IN CRPBUFFR             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0570
*         BLDMD2PC=0;               /* CLEAR ELEMENT RETURN CODE     */
         SLR   @15,@15                                             0570
         ST    @15,BLDMD2PC                                        0570
*         MPPSMDNM=ICTPTFS(1);      /* PASS SYSMOD NUMBER            */
         L     @15,@PC00006                                        0571
         MVC   MPPSMDNM(7),ICTPTFS(@15)                            0571
*         CALL HMASMMPD(MPPPARM);   /* PARSE STMT                    */
         L     @15,@CV01887                                        0572
         LA    @01,@AL00572                                        0572
         BALR  @14,@15                                             0572
*         RESPECIFY                                                0573
*           REG15 RSTD;                                            0573
*         BLDMD2PC=MAX(BLDMD2PC,REG15);                            0574
         L     @14,BLDMD2PC                                        0574
         CR    @14,REG15                                           0574
         BNL   *+6
         LR    @14,REG15                                           0574
         ST    @14,BLDMD2PC                                        0574
*         RESPECIFY                                                0575
*           REG15 UNRSTD;                                          0575
*         IF BLDMD2PC<STOPPTF THEN                                 0576
         CH    @14,@CH00033                                        0576
         BNL   @RF00576                                            0576
*           DO;                                                    0577
*                                                                  0577
*             /*******************************************************/
*             /*                                                     */
*             /* A MODIFICATION CNTRL STMT READ AND PARSED           */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0578
*             IF MCBTYPE=MCBMODTP   /* ++MOD ELEMENT ?               */
*                 ×MCBTYPE=MCBMCRTP /* ++MAC ELEMENT ?               */
*                 ×MCBTYPE=MCBSCRTP /* ++SRC ELEMENT ?               */
*                 ×MCBTYPE=MCBZAPTP /* ++ZAP ELEMENT ?               */
*                 ×MCBTYPE=MCBMCUTP /* ++MACUPD ELEMENT ?            */
*                 ×MCBTYPE=MCBSCUTP /* ++SRCUPD ELEMENT ?            */
*               THEN                                               0578
         L     @15,MCBPTR                                          0578
         CLI   MCBTYPE(@15),4                                      0578
         BE    @RT00578                                            0578
         CLI   MCBTYPE(@15),5                                      0578
         BE    @RT00578                                            0578
         CLI   MCBTYPE(@15),6                                      0578
         BE    @RT00578                                            0578
         CLI   MCBTYPE(@15),7                                      0578
         BE    @RT00578                                            0578
         CLI   MCBTYPE(@15),8                                      0578
         BE    @RT00578                                            0578
         CLI   MCBTYPE(@15),9                                      0578
         BNE   @RF00578                                            0578
@RT00578 DS    0H                                                  0579
*               DO;                                                0579
*                                                                  0579
*                 /***************************************************/
*                 /*                                                 */
*                 /* ELEMENT TYPE MODIFICATION CNTRL STMT ... SEARCH */
*                 /* THE ICT FOR THIS ELEMENT FROM THE CURRENT SYSMOD*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0580
*                 CALL SRCHICTM(MCBENAME,/* ELEMENT NAME             */
*                     MCBTYPE,      /* ELEMENT TYPE                  */
*                     ICTPTFS(1),   /* CURRENT SYSMOD                */
*                     MODSCPTR);    /* MOD SECT PTR                  */
         L     @15,MCBPTR                                          0580
         LA    @14,MCBENAME(,@15)                                  0580
         ST    @14,@AL00001                                        0580
         ST    @15,@AL00001+4                                      0580
         L     @15,@PC00006                                        0580
         ST    @15,@AL00001+8                                      0580
         LA    @15,MODSCPTR                                        0580
         ST    @15,@AL00001+12                                     0580
         LA    @01,@AL00001                                        0580
         BAL   @14,SRCHICTM                                        0580
*                 RESPECIFY                                        0581
*                   ICTMOD BASED(MODSCPTR);/* MOD ENTRY              */
*                 IF ICTMISEL(1)=ON /* SELECTED                      */
*                     &ICTMIDEL(1)=OFF/* DELETE NOT SPECIFIED        */
*                     &ICTMWRK(1)=OFF/* NOT MOVED TO WRK             */
*                     &ICTMRELF(1)=OFF/* NOT RELFILE                 */
*                     &ICTLIBLK(1)=OFF/* NOT LKLIB                   */
*                     &ICTLIBTX(1)=OFF/* NOT TXLIB                   */
*                   THEN                                           0582
         L     @15,MODSCPTR                                        0582
         TM    ICTMISEL(@15),B'10000000'                           0582
         BNO   @RF00582                                            0582
         TM    ICTMIDEL(@15),B'01000000'                           0582
         BNZ   @RF00582                                            0582
         TM    ICTMWRK(@15),B'11101000'                            0582
         BNZ   @RF00582                                            0582
*                   DO;                                            0583
*                                                                  0583
*                     /***********************************************/
*                     /*                                             */
*                     /* ELEMENT SHOULD BE MOVED TO WRK DATASET      */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0584
*                     IF MCBTYPE=MCBMCUTP/* ++MACUPD ELEMENT         */
*                         ×MCBTYPE=MCBSCUTP/* ++SRCUPD ELEMENT       */
*                       THEN                                       0584
         L     @15,MCBPTR                                          0584
         CLI   MCBTYPE(@15),8                                      0584
         BE    @RT00584                                            0584
         CLI   MCBTYPE(@15),9                                      0584
         BNE   @RF00584                                            0584
@RT00584 DS    0H                                                  0585
*                       TMWMODE=MERGE;/* MERGE WITH EXISTING         */
         MVI   TMWMODE,C'M'                                        0585
*                     ELSE                                         0586
*                       TMWMODE=CREATE;/* CREATE NEW MEMBER          */
         B     @RC00584                                            0586
@RF00584 MVI   TMWMODE,C'C'                                        0586
*                     ICTMWRK(1)=ON;/* SET MOVED TO WRK FLAG         */
@RC00584 L     @01,MODSCPTR                                        0587
         OI    ICTMWRK(@01),B'00001000'                            0587
*                     CALL HMASMTMW(TMWOPT,/* WRITE TO WRK           */
*                         MODSCPTR, /* PTR ICT MOD                   */
*                         HMASMCRP, /* GET PARM LIST                 */
*                         TMWMODE); /* CREATE×MERGE                  */
         L     @15,@CV01895                                        0588
         LA    @01,@AL00588                                        0588
         BALR  @14,@15                                             0588
*                     RESPECIFY                                    0589
*                       REG15 RSTD;                                0589
*                     IF REG15=IOPEOF/* END-OF-FILE ENCOUNTERED      */
*                       THEN                                       0590
         CH    REG15,@CH00040                                      0590
         BNE   @RF00590                                            0590
*                       MCSEOF=ON;  /* SET END-OF-FILE FLAG          */
         OI    MCSEOF,B'00010000'                                  0591
*                     ELSE                                         0592
*                       BLDMD2PC=MAX(BLDMD2PC,REG15);/* MAINTAIN     */
         B     @RC00590                                            0592
@RF00590 L     @14,BLDMD2PC                                        0592
         CR    @14,REG15                                           0592
         BNL   *+6
         LR    @14,REG15                                           0592
         ST    @14,BLDMD2PC                                        0592
*                     IF REG15<STOPPTF THEN                        0593
@RC00590 CH    REG15,@CH00033                                      0593
         BNL   @RF00593                                            0593
*                       ICTPWRKO(1)=ON;/* WRK MEMBER OVERLAID        */
         L     @14,@PC00006                                        0594
         OI    ICTPWRKO(@14),B'01000000'                           0594
*                     RESPECIFY                                    0595
*                       REG15 UNRSTD;                              0595
@RF00593 DS    0H                                                  0596
*                     IF ICTMXPND(1)=ON/* EXPANDS ENCOUNTERED        */
*                         &BLDMD2RC<STOPPTF THEN                   0596
*                                                                  0596
         L     @01,MODSCPTR                                        0596
         TM    ICTMXPND(@01),B'00010000'                           0596
         BNO   @RF00596                                            0596
         L     @15,@PC00006+4                                      0596
         L     @15,BLDMD2RC(,@15)                                  0596
         CH    @15,@CH00033                                        0596
         BNL   @RF00596                                            0596
*                       /*********************************************/
*                       /*                                           */
*                       /* BUILD MOD SECT ENTRY FOR EXPAND           */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0597
*                       CALL XPNDZAP(MODSCPTR,/* PTR MOD ENTRY       */
*                           ADDR(ICTPTF(1)),/* PTF ENT.              */
*                           BLDMD2PC);/* RETURN CODE                 */
         L     @15,@PC00006                                        0597
         ST    @15,@AFTEMPS                                        0597
         LA    @01,@AL00597                                        0597
         BAL   @14,XPNDZAP                                         0597
*                   END;            /* END PROCESSING ELEMENT MOVET
*                                      TO WRKX                       */
*                 ELSE                                             0599
*                                                                  0599
*                   /*************************************************/
*                   /*                                               */
*                   /* ELEMENT NEED NOT BE MOVED TO WRK DATASET      */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0599
*                   CALL SKIPELEM(BLDMD2PC);/* SKIP OVER IT          */
         B     @RC00582                                            0599
@RF00582 LA    @01,@AL00599                                        0599
         BAL   @14,SKIPELEM                                        0599
*               END;                /* END PROCESSING ELEMENT MCS  0600
*                                      STMT                          */
*             ELSE                                                 0601
*                                                                  0601
*               /*****************************************************/
*               /*                                                   */
*               /* NON-ELEMENT TYPE MODIFICATION CNTRL STMT          */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0601
*               CALL SKIPELEM(BLDMD2PC);/* SKIP OVER IT              */
         B     @RC00578                                            0601
@RF00578 LA    @01,@AL00601                                        0601
         BAL   @14,SKIPELEM                                        0601
*           END;                    /* END PROCESSING A PARSED MCS 0602
*                                      STMT.                         */
@RC00578 DS    0H                                                  0603
*         BLDMD2RC=MAX(BLDMD2RC,BLDMD2PC);/* MAINTAIN RET. CODE      */
@RF00576 L     @15,@PC00006+4                                      0603
         L     @14,BLDMD2RC(,@15)                                  0603
         L     @07,BLDMD2PC                                        0603
         CR    @14,@07                                             0603
         BNL   *+6
         LR    @14,@07                                             0603
         ST    @14,BLDMD2RC(,@15)                                  0603
*       END;                        /* END OF MCS PROCESSING LOOP    */
@DE00569 L     @15,@PC00006+4                                      0604
         L     @15,BLDMD2RC(,@15)                                  0604
         CH    @15,@CH00033                                        0604
         BNL   @DC00569                                            0604
         TM    MCSEOF,B'00010000'                                  0604
         BZ    @DL00569                                            0604
@DC00569 DS    0H                                                  0605
*     END;                          /* END OF PROCESSING AFTER     0605
*                                      SUCCESSFUL LOCATE FOR MCS     */
*   IF BLDMD2RC>=STOPPTF            /* SYSMOD TERMINATED             */
*     THEN                                                         0606
@RF00563 L     @15,@PC00006+4                                      0606
         L     @14,BLDMD2RC(,@15)                                  0606
         CH    @14,@CH00033                                        0606
         BL    @RF00606                                            0606
*     CALL BLDMODSF(ICTPTF(1),      /* "CURRENT" SYSMOD              */
*         BLDMD2RC);                /* RETURN CODE COLLECTOR         */
         L     @14,@PC00006                                        0607
         ST    @14,@AL00001                                        0607
         ST    @15,@AL00001+4                                      0607
         LA    @01,@AL00001                                        0607
         BAL   @14,BLDMODSF                                        0607
*   RETURN;                                                        0608
@EL00006 DS    0H                                                  0608
@EF00006 DS    0H                                                  0608
@ER00006 LM    @14,@12,@SA00006                                    0608
         BR    @14                                                 0608
*   END BLDMODS2;                                                  0609
         B     @EL00006                                            0609
*                                                                  0610
*/********************************************************************/
*/*                                                                  */
*/*    BLDMODS3 - SET THE PRE/SUP FLAGS (ICTMIDPS) IN THE MODID      */
*/*               LISTS ASSOCIATED WITH ELEMENTS SELECTED FOR THE    */
*/*               "CURRENT" SYSMOD                                   */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *          - ALL ELEMENTS FROM THE "CURRENT" SYSMOD HAVE     */
*/*                  BEEN SUCCESSFULLY SELECTED OR EXCLUDED (I.E.,   */
*/*                  THE SYSMOD IS NOT NOGO DUE TO ID CHECK ERRORS). */
*/*                                                                  */
*/*     *          - THERE ARE MOD SECTION ENTRIES IN THE ICT FOR    */
*/*                  EVERY ELEMENT IN THE "CURRENT" SYSMOD ... THE   */
*/*                  SELECTED ELEMENTS FROM THE "CURRENT" SYSMOD     */
*/*                  HAVE "ICTMISEL" SET "ON" IN THEIR RESPECTIVE    */
*/*                  MOD SECTION ENTRIES.                            */
*/*                                                                  */
*/*     *          - ICTMIDPL IS SET IN THE SELECTED ELEMENTS'       */
*/*                  MODID LISTS                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0610
*BLDMODS3:                                                         0610
*   PROC(BLDM3SMD,BLDMD3RC);                                       0610
BLDMODS3 STM   @14,@12,12(@13)                                     0610
         MVC   @PC00007(8),0(@01)                                  0610
*   DCL                                                            0611
*     BLDM3SMD CHAR(*);             /* ICT PTF ENTRY                 */
*   DCL                                                            0612
*     BLDMD3RC FIXED(31);           /* MAX RETURN CODE COLLECTOR   0612
*                                      PARAMETER                     */
*   DCL                                                            0613
*     IX FIXED(15);                 /* INDEX - MOD SECT PTR LIST     */
*   DCL                                                            0614
*     IM FIXED(15);                 /* INDEX - MODID LIST            */
*   RESPECIFY                                                      0615
*     ICTPTF BASED(ADDR(BLDM3SMD)); /* PTF SECTION ENTRY PASSED ...
*                                      "CURRENT" SYSMOD              */
*   RESPECIFY                                                      0616
*     ICTIXPF BASED(ICTPCHN(1));    /* MOD SECT PTR LIST ...       0616
*                                      "CURRENT" SYSMOD              */
*   IF ICTPCHN(1)=0                 /* NO MOD SECTION ENTRIES        */
*     THEN                                                         0617
         L     @15,@PC00007                                        0617
         ICM   @14,15,ICTPCHN(@15)                                 0617
         BNZ   @RF00617                                            0617
*     ICTPCHN(1)=TBLXNULL;          /* POINT TO EMPTY LIST           */
*                                                                  0618
         L     @14,@PC00001                                        0618
         MVC   ICTPCHN(4,@15),TBLXNULL(@14)                        0618
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ELEMENTS IN "CURRENT" SYSMOD                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0619
*   DO IX=1 BY 1 WHILE ICTIXP(IX)^=ICTENDIX;                       0619
@RF00617 LA    IX,1                                                0619
         B     @DE00619                                            0619
@DL00619 DS    0H                                                  0620
*     RESPECIFY                                                    0620
*       ICTMOD BASED(ICTIXP(IX));   /* ADDRESS MOD SECT ENTRY        */
*     RESPECIFY                                                    0621
*       ICTMIDLS BASED(ICTMICHN(1));/* ADDRESS MODID LIST            */
*     IF ICTMISEL(1)=ON             /* ELEMENT SELECTED              */
*       THEN                                                       0622
         LR    @03,IX                                              0622
         SLA   @03,2                                               0622
         L     @15,@PC00007                                        0622
         L     @01,ICTPCHN(,@15)                                   0622
         AL    @01,@CF02424                                        0622
         L     @03,ICTIXP(@03,@01)                                 0622
         TM    ICTMISEL(@03),B'10000000'                           0622
         BNO   @RF00622                                            0622
*       DO;                                                        0623
*                                                                  0623
*         /***********************************************************/
*         /*                                                         */
*         /* GO THRU MODID LIST FOR SELECTED ELEMENT                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0624
*         DO IM=1 BY 1 WHILE ICTMIDND(IM)^=ICTENDIX;               0624
*                                                                  0624
         LA    IM,1                                                0624
         B     @DE00624                                            0624
@DL00624 DS    0H                                                  0625
*           /*********************************************************/
*           /*                                                       */
*           /* SET PRE/SUP INDICATOR (ICTMIDPS) FROM ICTMIDLS        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0625
*           IF ICTMIDPL(IM)=ON      /* PRE/SUP BY "CURRENT" SYSMOD   */
*             THEN                                                 0625
         LR    @15,IM                                              0625
         SLA   @15,3                                               0625
         LR    @14,IX                                              0625
         SLA   @14,2                                               0625
         L     @07,@PC00007                                        0625
         L     @01,ICTPCHN(,@07)                                   0625
         AL    @01,@CF02424                                        0625
         L     @01,ICTIXP(@14,@01)                                 0625
         L     @14,ICTMICHN(,@01)                                  0625
         ST    @15,@TF00001                                        0625
         ALR   @15,@14                                             0625
         BCTR  @15,0                                               0625
         TM    ICTMIDPL-7(@15),B'00100000'                         0625
         BNO   @RF00625                                            0625
*             ICTMIDPS(IM)=ON;      /* SET PRE/SUP INDICATOR         */
         AL    @14,@TF00001                                        0626
         BCTR  @14,0                                               0626
         OI    ICTMIDPS-7(@14),B'01000000'                         0626
*           ELSE                                                   0627
*             ICTMIDPS(IM)=OFF;     /* CLEAR PRE/SUP INDICATOR       */
         B     @RC00625                                            0627
@RF00625 LR    @15,IM                                              0627
         SLA   @15,3                                               0627
         LR    @14,IX                                              0627
         SLA   @14,2                                               0627
         L     @07,@PC00007                                        0627
         L     @01,ICTPCHN(,@07)                                   0627
         AL    @01,@CF02424                                        0627
         L     @01,ICTIXP(@14,@01)                                 0627
         L     @01,ICTMICHN(,@01)                                  0627
         ALR   @01,@15                                             0627
         BCTR  @01,0                                               0627
         NI    ICTMIDPS-7(@01),B'10111111'                         0627
*         END;                                                     0628
@RC00625 AL    IM,@CF00065                                         0628
@DE00624 LR    @15,IM                                              0628
         SLA   @15,3                                               0628
         LR    @14,IX                                              0628
         SLA   @14,2                                               0628
         L     @07,@PC00007                                        0628
         L     @01,ICTPCHN(,@07)                                   0628
         AL    @01,@CF02424                                        0628
         L     @01,ICTIXP(@14,@01)                                 0628
         L     @01,ICTMICHN(,@01)                                  0628
         AL    @01,@CF02434                                        0628
         L     @15,ICTMIDND(@15,@01)                               0628
         CL    @15,ICTENDIX                                        0628
         BNE   @DL00624                                            0628
*       END;                                                       0629
*   END;                                                           0630
@RF00622 AL    IX,@CF00065                                         0630
@DE00619 LR    @03,IX                                              0630
         SLA   @03,2                                               0630
         L     @15,@PC00007                                        0630
         L     @01,ICTPCHN(,@15)                                   0630
         AL    @01,@CF02424                                        0630
         L     @03,ICTIXP(@03,@01)                                 0630
         CL    @03,ICTENDIX                                        0630
         BNE   @DL00619                                            0630
*   RETURN;                                                        0631
@EL00007 DS    0H                                                  0631
@EF00007 DS    0H                                                  0631
@ER00007 LM    @14,@12,12(@13)                                     0631
         BR    @14                                                 0631
*   END BLDMODS3;                                                  0632
*                                                                  0633
*/********************************************************************/
*/*                                                                  */
*/*    BLDENTRY - BUILD ICT MOD SECTION ENTRY FOR AN ELEMENT         */
*/*                                                                  */
*/*               - CALL HMASMTAD TO GET ENTRY IN ICT ENTRY SECTION. */
*/*                                                                  */
*/*               - CALL HMASMTM1 FOR ++MOD ELEMENTS.                */
*/*                 CALL HMASMTM2 FOR ++MAC AND ++MACUPD ELEMENTS.   */
*/*                 CALL HMASMTM3 FOR ++SRC AND ++SRCUPD ELEMENTS.   */
*/*                 CALL HMASMTM4 FOR ++ZAP ELEMENTS.                */
*/*                                                                  */
*/*               - INITIALIZE ELEMENT'S FMID AND RMID.              */
*/*                                                                  */
*/*               - MOVE IN-LINE TEXT SUPPLIED FOR ELEMENT TO WRK    */
*/*                 DATASETS BY CALLING HMASMTMW.                    */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * MCBPTR   - POINTS TO AN MCB INITIALIZED FROM THE           */
*/*                  MODIFICATION CNTRL. STMT. FOR THE ELEMENT.      */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * CRPBUFFR - IS PRIMED WITH THE NEXT MODIFICATION CONTROL    */
*/*                  STATEMENT IF BLDENTRC IS ZERO.                  */
*/*                                                                  */
*/*     * BLDENTRC - PROCESSING RETURN CODE RETURNED WITH THE        */
*/*                  HIGHEST RETURN CODE ENCOUNTERED:                */
*/*                                                                  */
*/*                  4 - END-OF-FILE ENCOUNTERED ON PTS MCS MEMBER.  */
*/*                                                                  */
*/*                  8, 12, 16 RETURN CODES FROM:                    */
*/*                                                                  */
*/*                    HMASMTM1 - PROCEDURE CALLED FOR ++MOD/ZAP     */
*/*                    HMASMTM2 - PROCEDURE CALLED FOR ++MAC/MACUPD  */
*/*                    HMASMTM3 - PROCEDURE CALLED FOR ++SRC/SRCUPD  */
*/*                    HMASMTMW - PROCEDURE CALLED TO MOVE IN-LINE   */
*/*                               ELEMENT TEXT TO WRK DATASET        */
*/*                    SKIPELEM - PROCEDURE CALLED TO MOVE TO NEXT   */
*/*                               MODIFICATION CNTRL. STMT.          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0633
*BLDENTRY:                                                         0633
*   PROC(BLDESMD,BLDENTRC);                                        0633
BLDENTRY STM   @14,@12,@SA00008                                    0633
         MVC   @PC00008(8),0(@01)                                  0633
*   DCL                                                            0634
*     BLDESMD CHAR(*);              /* PTF SECT ENTRY                */
*   DCL                                                            0635
*     BLDENTRC FIXED(31);           /* MAX RETURN CODE COLLECTOR   0635
*                                      PARAMETER                     */
*   DCL                                                            0636
*     TMXRETRN FIXED(31);           /* RETURN CODE FROM HMASMTM1, 2 3
*                                      OR 4                          */
*   DCL                                                            0637
*     BLDENT@ PTR(31);              /* POINTS TO MOD SECT ENTRY BEING
*                                      BUILT                         */
*   DCL                                                            0638
*     WCHKANS CHAR(1);              /* VARIABLE PASSED TO WRKCHK     */
*   DCL                                                            0639
*     ENTTYPE FIXED(8);             /* ELEMENT TYPE (MCBTYPE VALUES) */
*   DCL                                                            0640
*     ENTERMID CHAR(7);             /* ELEMENT RMID FROM MCBERMID    */
*   RESPECIFY                                                      0641
*     ICTPTF BASED(ADDR(BLDESMD));  /* PTF SECT ENTRY PASSED         */
*   ENTTYPE=MCBTYPE;                /* SAVE MCB ELEMENT TYPE VALUE   */
         L     @15,MCBPTR                                          0642
         SLR   ENTTYPE,ENTTYPE                                     0642
         IC    ENTTYPE,MCBTYPE(,@15)                               0642
*   ENTERMID=MCBERMID;              /* SAVE RMID FROM MCB            */
*                                                                  0643
         MVC   ENTERMID(7),MCBERMID(@15)                           0643
*   /*****************************************************************/
*   /*                                                               */
*   /* GET A BASIC MOD SECTION ENTRY                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0644
*   BLDENT@=TBLXTOP;                /* ADDR OF ENTRY TO BE OBTAINED  */
         L     @03,@PC00001                                        0644
         MVC   BLDENT@(4),TBLXTOP(@03)                             0644
*   CALL HMASMTAD(TBLXPARM,         /* PARM LIST                     */
*       'M',                        /* BUILD MOD SECTION ENTRY       */
*       MCBENAME);                  /* ENTRY NAME                    */
         ST    @03,@AL00001                                        0645
         LA    @03,@CC00717                                        0645
         ST    @03,@AL00001+4                                      0645
         LA    @03,MCBENAME(,@15)                                  0645
         ST    @03,@AL00001+8                                      0645
         L     @15,@CV01891                                        0645
         LA    @01,@AL00001                                        0645
         BALR  @14,@15                                             0645
*   RESPECIFY                                                      0646
*     REG15 RSTD;                                                  0646
*   BLDENTRC=MAX(BLDENTRC,REG15);   /* SAVE RETURN CODE FROM HMASMTAD*/
         L     @14,@PC00008+4                                      0647
         L     @03,BLDENTRC(,@14)                                  0647
         CR    @03,REG15                                           0647
         BNL   *+6
         LR    @03,REG15                                           0647
         ST    @03,BLDENTRC(,@14)                                  0647
*   RESPECIFY                                                      0648
*     REG15 UNRSTD;                                                0648
*   IF BLDENTRC<STOPPTF THEN                                       0649
         CH    @03,@CH00033                                        0649
         BNL   @RF00649                                            0649
*     DO;                                                          0650
*                                                                  0650
*       /*************************************************************/
*       /*                                                           */
*       /* BASIC MOD SECTION ENTRY OBTAINED ... INITIALIZE IT FROM   */
*       /* THE PTF SECT ENTRY PASSED AND THE MCB                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0651
*       RESPECIFY                                                  0651
*         ICTMOD BASED(BLDENT@);    /* ADDRESSIBILITY TO MOD SECT  0651
*                                      ENTRY JUST OBTAINED           */
*       ICTMNAME(1)=MCBENAME;       /* FILL IN ELEMENT NAME          */
*                                                                  0652
         L     @03,BLDENT@                                         0652
         L     @01,MCBPTR                                          0652
         MVC   ICTMNAME(8,@03),MCBENAME(@01)                       0652
*       /*************************************************************/
*       /*                                                           */
*       /* CALL THE APPROPRATE PROCESSOR (TM1, TM2, TM3 OR TM4) TO   */
*       /* COMPLETE THE ICT FROM DATA IN THE (A)CDS ELEMENT ENTRY.   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0653
*       RESPECIFY                                                  0653
*         REG15 RSTD;                                              0653
*       IF ENTTYPE=MCBMODTP THEN                                   0654
         CH    ENTTYPE,@CH00040                                    0654
         BNE   @RF00654                                            0654
*         DO;                                                      0655
*                                                                  0655
*           /*********************************************************/
*           /*                                                       */
*           /* MOD TYPE ENTRY                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0656
*           ICTMMOD(1)=ON;          /* SET ICT MOD SECT INDICATOR    */
         OI    ICTMMOD(@03),B'10000000'                            0656
*           CALL HMASMTM1(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */
         MVC   @AL00001+4(12),@AL00657                             0657
         L     @14,@PC00001                                        0657
         ST    @14,@AL00001                                        0657
         L     @14,@PC00008                                        0657
         ST    @14,@TF00001                                        0657
         L     @15,@CV01896                                        0657
         LA    @01,@AL00001                                        0657
         BALR  @14,@15                                             0657
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */
         ST    REG15,TMXRETRN                                      0658
*           CALL MODSRCA(ICTMOD(1));/* CHAIN MOD TO ASSOC. SRC       */
         L     @14,BLDENT@                                         0659
         ST    @14,@AL00001                                        0659
         LA    @01,@AL00001                                        0659
         BAL   @14,MODSRCA                                         0659
*         END;                                                     0660
*       IF ENTTYPE=MCBMCRTP THEN                                   0661
@RF00654 CH    ENTTYPE,@CH00103                                    0661
         BNE   @RF00661                                            0661
*         DO;                                                      0662
*                                                                  0662
*           /*********************************************************/
*           /*                                                       */
*           /* MAC TYPE ENTRY                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0663
*           ICTMMACR(1)=ON;         /* SET ICT MOD SECT INDICATOR    */
         L     @14,BLDENT@                                         0663
         OI    ICTMMACR(@14),B'00001000'                           0663
*           CALL HMASMTM2(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */
         MVC   @AL00001+4(12),@AL00664                             0664
         L     @14,@PC00001                                        0664
         ST    @14,@AL00001                                        0664
         L     @14,@PC00008                                        0664
         ST    @14,@TF00001                                        0664
         L     @15,@CV01897                                        0664
         LA    @01,@AL00001                                        0664
         BALR  @14,@15                                             0664
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */
         ST    REG15,TMXRETRN                                      0665
*         END;                                                     0666
*       IF ENTTYPE=MCBMCUTP THEN                                   0667
@RF00661 CH    ENTTYPE,@CH00033                                    0667
         BNE   @RF00667                                            0667
*         DO;                                                      0668
*                                                                  0668
*           /*********************************************************/
*           /*                                                       */
*           /* MACUPD TYPE ENTRY                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0669
*           ICTMMACU(1)=ON;         /* SET ICT MOD SECT INDICATOR    */
         L     @14,BLDENT@                                         0669
         OI    ICTMMACU(@14),B'00000100'                           0669
*           CALL HMASMTM2(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */
         MVC   @AL00001+4(12),@AL00670                             0670
         L     @14,@PC00001                                        0670
         ST    @14,@AL00001                                        0670
         L     @14,@PC00008                                        0670
         ST    @14,@TF00001                                        0670
         L     @15,@CV01897                                        0670
         LA    @01,@AL00001                                        0670
         BALR  @14,@15                                             0670
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */
         ST    REG15,TMXRETRN                                      0671
*         END;                                                     0672
*       IF ENTTYPE=MCBSCRTP THEN                                   0673
@RF00667 CH    ENTTYPE,@CH00289                                    0673
         BNE   @RF00673                                            0673
*         DO;                                                      0674
*                                                                  0674
*           /*********************************************************/
*           /*                                                       */
*           /* SRC TYPE ENTRY                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0675
*           ICTMSRCR(1)=ON;         /* SET ICT MOD SECT INDICATOR    */
         L     @14,BLDENT@                                         0675
         OI    ICTMSRCR(@14),B'00000010'                           0675
*           CALL HMASMTM3(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */
         MVC   @AL00001+4(12),@AL00676                             0676
         L     @14,@PC00001                                        0676
         ST    @14,@AL00001                                        0676
         L     @14,@PC00008                                        0676
         ST    @14,@TF00001                                        0676
         L     @15,@CV01898                                        0676
         LA    @01,@AL00001                                        0676
         BALR  @14,@15                                             0676
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */
         ST    REG15,TMXRETRN                                      0677
*           CALL SRCMODA(ICTMOD(1));/* CHAIN SRC TO ASSOC. MOD       */
         L     @14,BLDENT@                                         0678
         ST    @14,@AL00001                                        0678
         LA    @01,@AL00001                                        0678
         BAL   @14,SRCMODA                                         0678
*         END;                                                     0679
*       IF ENTTYPE=MCBSCUTP THEN                                   0680
@RF00673 CH    ENTTYPE,@CH00034                                    0680
         BNE   @RF00680                                            0680
*         DO;                                                      0681
*                                                                  0681
*           /*********************************************************/
*           /*                                                       */
*           /* SRCUPD TYPE ENTRY                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0682
*           ICTMSRCU(1)=ON;         /* SET ICT MOD SECT INDICATOR    */
         L     @14,BLDENT@                                         0682
         OI    ICTMSRCU(@14),B'00000001'                           0682
*           CALL HMASMTM3(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */
         MVC   @AL00001+4(12),@AL00683                             0683
         L     @14,@PC00001                                        0683
         ST    @14,@AL00001                                        0683
         L     @14,@PC00008                                        0683
         ST    @14,@TF00001                                        0683
         L     @15,@CV01898                                        0683
         LA    @01,@AL00001                                        0683
         BALR  @14,@15                                             0683
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */
         ST    REG15,TMXRETRN                                      0684
*           CALL SRCMODA(ICTMOD(1));/* CHAIN SRC TO ASSOC. MOD       */
         L     @14,BLDENT@                                         0685
         ST    @14,@AL00001                                        0685
         LA    @01,@AL00001                                        0685
         BAL   @14,SRCMODA                                         0685
*         END;                                                     0686
*       IF ENTTYPE=MCBZAPTP THEN                                   0687
@RF00680 CH    ENTTYPE,@CH00067                                    0687
         BNE   @RF00687                                            0687
*         DO;                                                      0688
*                                                                  0688
*           /*********************************************************/
*           /*                                                       */
*           /* ZAP TYPE ENTRY                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0689
*           ICTMZAP(1)=ON;          /* SET ICT MOD SECT INDICATOR    */
         L     @14,BLDENT@                                         0689
         OI    ICTMZAP(@14),B'00100000'                            0689
*           CALL HMASMTM1(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               MCBPTR);            /* PTR TO INITIALIZED MCB        */
         MVC   @AL00001+4(12),@AL00690                             0690
         L     @14,@PC00001                                        0690
         ST    @14,@AL00001                                        0690
         L     @14,@PC00008                                        0690
         ST    @14,@TF00001                                        0690
         L     @15,@CV01896                                        0690
         LA    @01,@AL00001                                        0690
         BALR  @14,@15                                             0690
*           TMXRETRN=REG15;         /* SAVE RETURN CODE              */
         ST    REG15,TMXRETRN                                      0691
*         END;                                                     0692
*       BLDENTRC=MAX(BLDENTRC,TMXRETRN);/* SAVE RETURN CODE FROM TM1,
*                                      TM2 OR TM3                    */
@RF00687 L     @14,@PC00008+4                                      0693
         L     @03,BLDENTRC(,@14)                                  0693
         L     @07,TMXRETRN                                        0693
         CR    @03,@07                                             0693
         BNL   *+6
         LR    @03,@07                                             0693
         ST    @03,BLDENTRC(,@14)                                  0693
*       RESPECIFY                                                  0694
*         REG15 UNRSTD;                                            0694
*                                                                  0694
*       /*************************************************************/
*       /*                                                           */
*       /* COMPLETE MOD SECT ENTRY INITIALIZATION                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0695
*                                                                  0695
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE ELEMENT FMID                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0695
*       IF ICTPTYPE(1)=IOPPFUNC THEN/* FUNCTION SYSMOD ?             */
         L     @03,@PC00008                                        0695
         CLI   ICTPTYPE(@03),4                                     0695
         BNE   @RF00695                                            0695
*         ICTMFMID(1)=ICTPTFS(1);   /* YES - FMID IS SYSMOD'S NAME   */
         L     @01,BLDENT@                                         0696
         MVC   ICTMFMID(7,@01),ICTPTFS(@03)                        0696
*       ELSE                                                       0697
*         ICTMFMID(1)=ICTPFMID(1);  /* NO - FMID IS FROM SYSMOD'S  0697
*                                      FMID                          */
*                                                                  0697
         B     @RC00695                                            0697
@RF00695 L     @03,BLDENT@                                         0697
         L     @15,@PC00008                                        0697
         MVC   ICTMFMID(7,@03),ICTPFMID(@15)                       0697
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE ELEMENT RMID                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0698
*       IF(ENTTYPE=MCBMODTP         /* ++MOD ELEMENT ?               */
*           ×ENTTYPE=MCBMCRTP       /* ++MAC ELEMENT ?               */
*           ×ENTTYPE=MCBSCRTP)      /* ++SRC ELEMENT ?               */
*         THEN                                                     0698
@RC00695 CH    ENTTYPE,@CH00040                                    0698
         BE    @RT00698                                            0698
         CH    ENTTYPE,@CH00103                                    0698
         BE    @RT00698                                            0698
         CH    ENTTYPE,@CH00289                                    0698
         BNE   @RF00698                                            0698
@RT00698 DS    0H                                                  0699
*         DO;                                                      0699
*                                                                  0699
*           /*********************************************************/
*           /*                                                       */
*           /* SET RMID FOR MOD, MAC AND SRC ELEMENTS                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0700
*           IF ENTERMID^=NULLPTF#   /* NON-BLANK RMID IN MCB         */
*             THEN                                                 0700
         CLC   ENTERMID(7),@CC01944                                0700
         BE    @RF00700                                            0700
*             ICTMRMID(1)=ENTERMID; /* RMID COMES FROM RMID KEYWORD  */
         L     @01,BLDENT@                                         0701
         MVC   ICTMRMID(7,@01),ENTERMID                            0701
*           ELSE                                                   0702
*             ICTMRMID(1)=ICTPTFS(1);/* SYSMOD NAME IS RMID          */
         B     @RC00700                                            0702
@RF00700 L     @01,BLDENT@                                         0702
         L     @15,@PC00008                                        0702
         MVC   ICTMRMID(7,@01),ICTPTFS(@15)                        0702
*         END;                                                     0703
*       ELSE                                                       0704
*                                                                  0704
*         /***********************************************************/
*         /*                                                         */
*         /* SET RMID TO "BLANKS" FOR ZAP, MACUPD, SRCUPD ELEMENTS   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0704
*         ICTMRMID(1)=NULLPTF#;     /* RMID FOR UPDATE-TYPE ELEMENTS */
         B     @RC00698                                            0704
@RF00698 L     @01,BLDENT@                                         0704
         MVC   ICTMRMID(7,@01),@CC01944                            0704
*     END;                                                         0705
*                                                                  0705
@RC00698 DS    0H                                                  0706
*   /*****************************************************************/
*   /*                                                               */
*   /* ICT MOD SECTION ENTRY INITIALIZED FOR CURRENT ELEMENT         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0706
*   IF BLDENTRC<STOPPTF THEN                                       0706
@RF00649 L     @15,@PC00008+4                                      0706
         L     @15,BLDENTRC(,@15)                                  0706
         CH    @15,@CH00033                                        0706
         BNL   @RF00706                                            0706
*     DO;                                                          0707
*                                                                  0707
*       /*************************************************************/
*       /*                                                           */
*       /* MOD SECTION ENTRY INITIALIZATION SUCCESSFUL FOR THE       */
*       /* CURRENT ELEMENT                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0708
*       IF ICTLIBLK(1)=OFF          /* ELEMENT NOT ON LKLIB          */
*           &ICTLIBTX(1)=OFF        /* ELEMENT NOT ON TXLIB          */
*           &ICTMRELF(1)=OFF        /* ELEMENT NOT ON RELFILE        */
*           &ICTMIDEL(1)=OFF        /* ELEMENT NOT TO BE DELETED     */
*         THEN                                                     0708
         L     @15,BLDENT@                                         0708
         TM    ICTLIBLK(@15),B'11100000'                           0708
         BNZ   @RF00708                                            0708
         TM    ICTMIDEL(@15),B'01000000'                           0708
         BNZ   @RF00708                                            0708
*         DO;                                                      0709
*                                                                  0709
*           /*********************************************************/
*           /*                                                       */
*           /* ELEMENT SUPPLIED IN-LINE ... CHECK IF IT CAN BE MOVED */
*           /* TO A WRK DATASET NOW.                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0710
*           CALL WRKCHK(ICTMNAME(1),ICTMFLG1(1),WCHKANS);          0710
         ST    @15,@AL00001                                        0710
         LA    @15,ICTMFLG1(,@15)                                  0710
         ST    @15,@AL00001+4                                      0710
         LA    @15,WCHKANS                                         0710
         ST    @15,@AL00001+8                                      0710
         LA    @01,@AL00001                                        0710
         BAL   @14,WRKCHK                                          0710
*           IF WCHKANS=YES THEN                                    0711
         CLI   WCHKANS,C'Y'                                        0711
         BNE   @RF00711                                            0711
*             DO;                                                  0712
*                                                                  0712
*               /*****************************************************/
*               /*                                                   */
*               /* ELEMENT CAN BE MOVED TO WRK DATASET               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0713
*               ICTMWRK(1)=ON;      /* INDICATE ELEMENT MOVED        */
         L     @01,BLDENT@                                         0713
         OI    ICTMWRK(@01),B'00001000'                            0713
*               TMWMODE=CREATE;     /* CREATE NEW WRK DATASET MEMBER */
         MVI   TMWMODE,C'C'                                        0714
*               CALL HMASMTMW(TMWOPT,/* WRITE TO WRK                 */
*                   BLDENT@,        /* PTR ICT MOD                   */
*                   HMASMCRP,       /* GET PARM LIST                 */
*                   TMWMODE);       /* CREATE×MERGE                  */
         L     @15,@CV01895                                        0715
         LA    @01,@AL00715                                        0715
         BALR  @14,@15                                             0715
*               RESPECIFY                                          0716
*                 REG15 RSTD;                                      0716
*               IF REG15=IOPEOF     /* END-OF-FILE ENCOUNTERED       */
*                 THEN                                             0717
         CH    REG15,@CH00040                                      0717
         BNE   @RF00717                                            0717
*                 MCSEOF=ON;        /* SET END-OF-FILE FLAG          */
         OI    MCSEOF,B'00010000'                                  0718
*               ELSE                                               0719
*                 BLDENTRC=MAX(BLDENTRC,REG15);/* MAINTAIN RET.CODE  */
         B     @RC00717                                            0719
@RF00717 L     @14,@PC00008+4                                      0719
         L     @07,BLDENTRC(,@14)                                  0719
         CR    @07,REG15                                           0719
         BNL   *+6
         LR    @07,REG15                                           0719
         ST    @07,BLDENTRC(,@14)                                  0719
*               RESPECIFY                                          0720
*                 REG15 UNRSTD;                                    0720
@RC00717 DS    0H                                                  0721
*               IF ICTMXPND(1)=ON   /* EXPANDS ENCOUNTERED ?         */
*                   &BLDENTRC<STOPPTF THEN                         0721
*                                                                  0721
         L     @01,BLDENT@                                         0721
         TM    ICTMXPND(@01),B'00010000'                           0721
         BNO   @RF00721                                            0721
         L     @15,@PC00008+4                                      0721
         L     @14,BLDENTRC(,@15)                                  0721
         CH    @14,@CH00033                                        0721
         BNL   @RF00721                                            0721
*                 /***************************************************/
*                 /*                                                 */
*                 /* BUILD MOD SECT ENTRY FOR MOD TO BE EXPANDED     */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0722
*                 CALL XPNDZAP(BLDENT@,/* PTR ICT MOD ENTRY          */
*                     ADDR(ICTPTF(1)),/* PTR ICT PTF                 */
*                     BLDENTRC);    /* RETURN CODE                   */
         MVC   @AL00001(8),@AL00722                                0722
         L     @14,@PC00008                                        0722
         ST    @14,@AFTEMPS+4                                      0722
         ST    @15,@AL00001+8                                      0722
         LA    @01,@AL00001                                        0722
         BAL   @14,XPNDZAP                                         0722
*             END;                  /* END PROCESSING SELECTED     0723
*                                      ELEMENT MOVED TO WRK DATASET  */
*           ELSE                                                   0724
*             DO;                                                  0724
*                                                                  0724
         B     @RC00711                                            0724
@RF00711 DS    0H                                                  0725
*               /*****************************************************/
*               /*                                                   */
*               /* ELEMENT COULD NOT BE MOVED TO WRK DATASET         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0725
*               BLDM2WRK=ON;        /* WORK TO DO BY BLDMODS2 PROC   */
         OI    BLDM2WRK,B'00100000'                                0725
*               CALL SKIPELEM(BLDENTRC);/* GET NEXT MCS              */
         L     @15,@PC00008+4                                      0726
         ST    @15,@AL00001                                        0726
         LA    @01,@AL00001                                        0726
         BAL   @14,SKIPELEM                                        0726
*             END;                  /* END PROCESSING ELEMENT NOT NOT
*                                      MOVED TO WRK DATASET          */
*         END;                      /* END PROCESSING ELEMENT      0728
*                                      SUPPLIED IN-LINE              */
*       ELSE                                                       0729
*         CALL SKIPELEM(BLDENTRC);  /* NOT IN LINE ... GET NEXT MCS  */
         B     @RC00708                                            0729
@RF00708 L     @15,@PC00008+4                                      0729
         ST    @15,@AL00001                                        0729
         LA    @01,@AL00001                                        0729
         BAL   @14,SKIPELEM                                        0729
*     END;                          /* END BLDENTRC<STOPPTF          */
*   RETURN;                                                        0731
@EL00008 DS    0H                                                  0731
@EF00008 DS    0H                                                  0731
@ER00008 LM    @14,@12,@SA00008                                    0731
         BR    @14                                                 0731
*   END BLDENTRY;                                                  0732
         B     @EL00008                                            0732
*                                                                  0733
*/********************************************************************/
*/*                                                                  */
*/*    LOCELEM  - LOCATE AN ELEMENT ON THE (A)CDS.                   */
*/*                                                                  */
*/*               THE RESULTANT ELEMENT ENTRY IS IN THE IOP POINTED  */
*/*               TO BY PTRIOP2.                                     */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * PTRIOP2  - PTR TO IOP WHICH MAY BE USED TO LOCATE ELEMENT  */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * HIGHTMD  - SET IF I/O ERROR OCCURRED ACCESSING (A)CDS.     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0733
*LOCELEM:                                                          0733
*   PROC(ELEMNAME,ELEMTYPE);                                       0733
LOCELEM  STM   @14,@12,@SA00009                                    0733
         MVC   @PC00009(8),0(@01)                                  0733
*   DCL                                                            0734
*     ELEMNAME CHAR(8);                                            0734
*   DCL                                                            0735
*     ELEMTYPE FIXED(8);            /* SAME VALUES AS IOPPIND        */
*   DCL                                                            0736
*     LTSTTYPE FIXED(8);            /* NON-REGRESSED IOPPIND VALUES  */
*   RESPECIFY                                                      0737
*     HMASMIOP BASED(PTRIOP2);      /* IOP TO ACCESS (A)CDS ELEMENT
*                                      ENTRY                         */
*   IF ELEMTYPE>=IOPPREG            /* REGRESSED IOPPIND VALUE PASSED*/
*     THEN                                                         0738
         L     @15,@PC00009+4                                      0738
         CLI   ELEMTYPE(@15),80                                    0738
         BL    @RF00738                                            0738
*     LTSTTYPE=ELEMTYPE-IOPPREG;    /* CONVERT TO NON-REGRESSED VALUE*/
         SLR   LTSTTYPE,LTSTTYPE                                   0739
         IC    LTSTTYPE,ELEMTYPE(,@15)                             0739
         SH    LTSTTYPE,@CH00469                                   0739
*   ELSE                                                           0740
*     LTSTTYPE=ELEMTYPE;            /* USE VALUE PASSED              */
         B     @RC00738                                            0740
@RF00738 L     @15,@PC00009+4                                      0740
         SLR   LTSTTYPE,LTSTTYPE                                   0740
         IC    LTSTTYPE,ELEMTYPE(,@15)                             0740
*   IOPRETRN=IOPGOOD;               /* CLEAR IOP FIELD               */
@RC00738 L     @03,PTRIOP2                                         0741
         MVI   IOPRETRN(@03),X'00'                                 0741
*   IOPDSID=TBLXCDSI;               /* APPROPRIATE CONTROL DATASET   */
*                                                                  0742
         L     @15,@PC00001                                        0742
         MVC   IOPDSID(1,@03),TBLXCDSI(@15)                        0742
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO LOCATE ELEMENT ENTRY                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0743
*   IOPFUNCT=IOPLOC;                                               0743
         MVI   IOPFUNCT(@03),X'03'                                 0743
*   IOPNAME=ELEMNAME;                                              0744
         L     @15,@PC00009                                        0744
         MVC   IOPNAME(8,@03),ELEMNAME(@15)                        0744
*   IF LTSTTYPE=IOPPMOD             /* ++MOD ELEMENT                 */
*       ×LTSTTYPE=IOPPZAP           /* ++ZAP ELEMENT                 */
*     THEN                                                         0745
         CH    LTSTTYPE,@CH00065                                   0745
         BE    @RT00745                                            0745
         CH    LTSTTYPE,@CH00273                                   0745
         BNE   @RF00745                                            0745
@RT00745 DS    0H                                                  0746
*     IOPTYPE=IOPMOD;               /* ACCESS (A)CDS MOD ENTRY       */
         L     @01,PTRIOP2                                         0746
         MVI   IOPTYPE(@01),X'05'                                  0746
*   ELSE                                                           0747
*     IF LTSTTYPE=IOPPMACR          /* ++MAC ELEMENT                 */
*         ×LTSTTYPE=IOPPMACU        /* ++MACUPD ELEMENT              */
*       THEN                                                       0747
         B     @RC00745                                            0747
@RF00745 CH    LTSTTYPE,@CH00040                                   0747
         BE    @RT00747                                            0747
         CH    LTSTTYPE,@CH00103                                   0747
         BNE   @RF00747                                            0747
@RT00747 DS    0H                                                  0748
*       IOPTYPE=IOPMCR;             /* ACCESS (A)CDS MAC ENTRY       */
         L     @01,PTRIOP2                                         0748
         MVI   IOPTYPE(@01),X'03'                                  0748
*     ELSE                                                         0749
*       IF LTSTTYPE=IOPPSRCR        /* ++SRC ELEMENT                 */
*           ×LTSTTYPE=IOPPSRCR      /* ++SRCUPD ELEMENT              */
*         THEN                                                     0749
         B     @RC00747                                            0749
@RF00747 LA    @03,6                                               0749
         CR    LTSTTYPE,@03                                        0749
         BE    @RT00749                                            0749
         CR    LTSTTYPE,@03                                        0749
         BNE   @RF00749                                            0749
@RT00749 DS    0H                                                  0750
*         IOPTYPE=IOPSCR;           /* ACCESS (A)CDS SRC ENTRY       */
         L     @01,PTRIOP2                                         0750
         MVI   IOPTYPE(@01),X'08'                                  0750
*       ELSE                                                       0751
*         IOPRETRN=IOPNOTFD;        /* RETURN A "NOT FOUND"          */
         B     @RC00749                                            0751
@RF00749 L     @01,PTRIOP2                                         0751
         MVI   IOPRETRN(@01),X'04'                                 0751
*   IF IOPRETRN^=IOPNOTFD THEN                                     0752
@RC00749 DS    0H                                                  0752
@RC00747 DS    0H                                                  0752
@RC00745 L     @15,PTRIOP2                                         0752
         CLI   IOPRETRN(@15),4                                     0752
         BE    @RF00752                                            0752
*     DO;                                                          0753
*                                                                  0753
*       /*************************************************************/
*       /*                                                           */
*       /* ACCESS (A)CDS FOR ELEMENT                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0754
*       CALL HMASMIO(HMASMIOP);                                    0754
         ST    @15,@AL00001                                        0754
         L     @15,@CV01886                                        0754
         LA    @01,@AL00001                                        0754
         BALR  @14,@15                                             0754
*       IF IOPRETRN>IOPNOTFD        /* I/O ERROR ?                   */
*         THEN                                                     0755
         L     @15,PTRIOP2                                         0755
         CLI   IOPRETRN(@15),4                                     0755
         BNH   @RF00755                                            0755
*         HIGHTMD=MAX(HIGHTMD,IOPRETRN);/* MAINTAIN HIGHTMD RETURN 0756
*                                      CODE                          */
         L     @14,HIGHTMD                                         0756
         SLR   @07,@07                                             0756
         IC    @07,IOPRETRN(,@15)                                  0756
         CR    @14,@07                                             0756
         BNL   *+6
         LR    @14,@07                                             0756
         ST    @14,HIGHTMD                                         0756
*     END;                                                         0757
*   RETURN;                                                        0758
@EL00009 DS    0H                                                  0758
@EF00009 DS    0H                                                  0758
@ER00009 LM    @14,@12,@SA00009                                    0758
         BR    @14                                                 0758
*   END LOCELEM;                                                   0759
         B     @EL00009                                            0759
*                                                                  0760
*/********************************************************************/
*/*                                                                  */
*/*    BLDMODSF - CLEANUP UP THE ICT AND THE WRK DATASETS FOR A      */
*/*               SYSMOD WHICH IS TERMINATED DURING MOD SECTION      */
*/*               BUILD PROCESSING.                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * ICTPPTR  - ICT MOD SECTION ENTRIES MUST HAVE ICTPPTR SET   */
*/*                  TO THE ADDRESS OF THE ICT PTF SECTION ENTRY     */
*/*                  REPRESENTING THE SYSMOD TO WHICH THEY BELONG.   */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0760
*BLDMODSF:                                                         0760
*   PROC(BLDMFSMD,BLDFLSHC);                                       0760
BLDMODSF STM   @14,@12,@SA00010                                    0760
         MVC   @PC00010(8),0(@01)                                  0760
*   DCL                                                            0761
*     BLDMFSMD CHAR(*);             /* ICT PTF SECTION ENTRY         */
*   DCL                                                            0762
*     BLDFLSHC FIXED(31);           /* RETURN CODE COLLECTOR         */
*   DCL                                                            0763
*     MM FIXED(15);                 /* INDEX - MOD SECTION ENTRIES   */
*   RESPECIFY                                                      0764
*     ICTPTF BASED(ADDR(BLDMFSMD)); /* ADDRESS SYSMOD PASSED         */
*   RESPECIFY                                                      0765
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */
*                                                                  0765
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION FOR ELEMENTS FROM "CURRENT" SYSMOD    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0766
*   DO MM=1 BY 1 WHILE ICTMEND(MM)^=ICTENDNT;                      0766
         LA    MM,1                                                0766
         B     @DE00766                                            0766
@DL00766 DS    0H                                                  0767
*     IF ICTPPTR(MM)=ADDR(ICTPTF(1))/* ELEMENT FROM "CURRENT" SYSMOD */
*         &ICTMISEL(MM)=ON          /* SELECTED ELEMENT              */
*       THEN                                                       0767
         LR    @03,MM                                              0767
         MH    @03,@CH02383                                        0767
         L     @15,CCAICMOD(,CCAPTR)                               0767
         L     @14,@PC00010                                        0767
         LA    @01,0(@03,@15)                                      0767
         AL    @01,@CF02433                                        0767
         C     @14,ICTPPTR-96(,@01)                                0767
         BNE   @RF00767                                            0767
         ST    @03,@TF00001                                        0767
         ALR   @03,@15                                             0767
         AL    @03,@CF02421                                        0767
         TM    ICTMISEL-11(@03),B'10000000'                        0767
         BNO   @RF00767                                            0767
*       DO;                                                        0768
*                                                                  0768
*         /***********************************************************/
*         /*                                                         */
*         /* A SELECTED ELEMENT FROM THE CURRENT SYSMOD ... MAKE IT  */
*         /* NOGO ... MAKE IT NOT-SELECTED IF THE SYSMOD HAS NOT     */
*         /* OVERLAID ANY MEMBERS ON THE WRK DATASETS                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0769
*         ICTMNOGO(MM)=ON;          /* MARK ELEMENT NOGO             */
         LR    @03,@15                                             0769
         AL    @03,@TF00001                                        0769
         AL    @03,@CF02438                                        0769
         OI    ICTMNOGO-8(@03),B'01000000'                         0769
*         IF ICTPWRKO(1)=OFF        /* WRK DATASET MEMBERS NOT     0770
*                                      OVERLAID                      */
*           THEN                                                   0770
         TM    ICTPWRKO(@14),B'01000000'                           0770
         BNZ   @RF00770                                            0770
*           ICTMISEL(MM)=OFF;       /* MARK ELEMENT NOT SELECTED     */
*                                                                  0771
         AL    @15,@TF00001                                        0771
         AL    @15,@CF02421                                        0771
         NI    ICTMISEL-11(@15),B'01111111'                        0771
*         /***********************************************************/
*         /*                                                         */
*         /* SCRATCH WKRX DATASET MEMBER FOR THIS ELEMENT            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0772
*         CALL SCRWRKX(ICTMOD(MM));                                0772
@RF00770 LR    @03,MM                                              0772
         MH    @03,@CH02383                                        0772
         L     @01,CCAICMOD(,CCAPTR)                               0772
         AL    @01,@CF02422                                        0772
         LA    @03,ICTMOD(@03,@01)                                 0772
         ST    @03,@AL00001                                        0772
         LA    @01,@AL00001                                        0772
         BAL   @14,SCRWRKX                                         0772
*       END;                                                       0773
*   END;                                                           0774
@RF00767 AL    MM,@CF00065                                         0774
@DE00766 LR    @03,MM                                              0774
         MH    @03,@CH02383                                        0774
         L     @01,CCAICMOD(,CCAPTR)                               0774
         AL    @01,@CF02422                                        0774
         L     @03,ICTMEND(@03,@01)                                0774
         CL    @03,ICTENDNT                                        0774
         BNE   @DL00766                                            0774
*   RETURN;                                                        0775
@EL00010 DS    0H                                                  0775
@EF00010 DS    0H                                                  0775
@ER00010 LM    @14,@12,@SA00010                                    0775
         BR    @14                                                 0775
*   END BLDMODSF;                                                  0776
*                                                                  0777
*/********************************************************************/
*/*                                                                  */
*/*    MARKSUPS - SET THE ICTPMSL INDICATOR IN ALL ICT PTF SECTION   */
*/*               ENTRIES WHICH REPRESENT SYSMODS SUPERSEDED BY THE  */
*/*               CALLER-PASSED SYSMOD.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0777
*MARKSUPS:                                                         0777
*   PROC(MSUPSMD);                                                 0777
MARKSUPS STM   @14,@12,12(@13)                                     0777
         MVC   @PC00011(4),0(@01)                                  0777
*   DCL                                                            0778
*     MSUPSMD CHAR(*);              /* ICT PTF SECTION ENTRY WHOSE 0778
*                                      SUPS ARE TO BE PROCESSED      */
*   DCL                                                            0779
*     PTRICTP PTR(31);              /* LOCAL PTR ... POINTS TO FIRST
*                                      ENTRY IN ICT PTF SECTION      */
*   DCL                                                            0780
*     RR FIXED(15);                 /* LOCAL INDEX ... CURRENT     0780
*                                      SYSMOD'S SUP LIST ENTRIES     */
*   DCL                                                            0781
*     SS FIXED(15);                 /* LOCAL INDEX ... ICT PTF SECT
*                                      ENTRY                         */
*   RESPECIFY                                                      0782
*     ICTPTF BASED(ADDR(MSUPSMD));  /* PTF SECT ENTRY PASSED         */
*   RESPECIFY                                                      0783
*     ICTSUPLS BASED(ICTPSCHN(1));  /* SUP LIST ASSOCIATED WITH PTF
*                                      SECT ENTRY PASSED             */
*   PTRICTP=CCAICPTF;               /* INITIALIZE TO FIRST ICT PTF 0784
*                                      SECT ENTRY                    */
*                                                                  0784
         L     PTRICTP,CCAICPTF(,CCAPTR)                           0784
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ALL ENTRIES IN ICT PTF SECTION                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0785
*   DO SS=1 BY 1 WHILE PTRICTP->ICTPEND(SS)^=ICTENDNT;             0785
*                                                                  0785
         LA    SS,1                                                0785
         B     @DE00785                                            0785
@DL00785 DS    0H                                                  0786
*     /***************************************************************/
*     /*                                                             */
*     /* GO THRU ALL ENTRIES IN SYSMOD'S SUP LIST                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0786
*     DO RR=1 BY 1 WHILE ICTSUPND(RR)^=ICTENDIX;                   0786
         LA    RR,1                                                0786
         B     @DE00786                                            0786
@DL00786 DS    0H                                                  0787
*       IF PTRICTP->ICTPTFS(SS)=ICTSUPNM(RR)/* ICT SYSMOD SUPD ?     */
*         THEN                                                     0787
         LR    @05,SS                                              0787
         MH    @05,@CH02382                                        0787
         LR    @15,RR                                              0787
         SLA   @15,3                                               0787
         L     @14,@PC00011                                        0787
         L     @01,ICTPSCHN(,@14)                                  0787
         ST    @05,@TF00001                                        0787
         ALR   @05,PTRICTP                                         0787
         AL    @05,@CF02417                                        0787
         ALR   @01,@15                                             0787
         AL    @01,@CF02434                                        0787
         CLC   ICTPTFS(7,@05),ICTSUPNM(@01)                        0787
         BNE   @RF00787                                            0787
*         DO;                                                      0788
*                                                                  0788
*           /*********************************************************/
*           /*                                                       */
*           /* SYSMOD FOUND IN ICT IS SUPERSEDED BY CURRENT SYSMOD   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0789
*           PTRICTP->ICTPMSL(SS)=ON;/* INDICATE "PROCESSED" BY     0789
*                                      ELEMENT SELECTION PROCEDURE   */
         LR    @05,PTRICTP                                         0789
         AL    @05,@TF00001                                        0789
         AL    @05,@CF02418                                        0789
         OI    ICTPMSL-15(@05),B'10000000'                         0789
*         END;                                                     0790
*     END;                                                         0791
@RF00787 AL    RR,@CF00065                                         0791
@DE00786 LR    @05,RR                                              0791
         SLA   @05,3                                               0791
         L     @15,@PC00011                                        0791
         L     @01,ICTPSCHN(,@15)                                  0791
         AL    @01,@CF02434                                        0791
         L     @05,ICTSUPND(@05,@01)                               0791
         CL    @05,ICTENDIX                                        0791
         BNE   @DL00786                                            0791
*   END;                                                           0792
         AL    SS,@CF00065                                         0792
@DE00785 LR    @15,SS                                              0792
         MH    @15,@CH02382                                        0792
         AL    @15,@CF02417                                        0792
         L     @15,ICTPEND(@15,PTRICTP)                            0792
         CL    @15,ICTENDNT                                        0792
         BNE   @DL00785                                            0792
*   RETURN;                                                        0793
@EL00011 DS    0H                                                  0793
@EF00011 DS    0H                                                  0793
@ER00011 LM    @14,@12,12(@13)                                     0793
         BR    @14                                                 0793
*   END MARKSUPS;                                                  0794
*                                                                  0795
*/********************************************************************/
*/*                                                                  */
*/*    SKIPELEM - READ RECORDS FROM THE PTS MCS MEMBER UNTIL EITHER  */
*/*               AN END-OF-FILE OR A RECORD WITH '++' (COLS 1-2) IS */
*/*               ENCOUNTERED.                                       */
*/*                                                                  */
*/*               -  IF AN I/O ERROR IS ENCOUNTERED, SET SKIPRC TO   */
*/*                  STOPPTF.                                        */
*/*                                                                  */
*/*               - IF AN END-OF-FILE IS ENCOUNTERED, SET SKIPRC TO  */
*/*                 IOPEOF.                                          */
*/*                                                                  */
*/*               - IF A "++" RECORD  IS ENCOUNTERED, SET SKIPRC TO  */
*/*                 IOPGOOD.                                         */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * SKIPRC   - PROCESS CONTROL PARAMETER ... MAY BE NON-ZERO   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0795
*SKIPELEM:                                                         0795
*   PROC(SKIPRC);                                                  0795
SKIPELEM STM   @14,@12,@SA00012                                    0795
         MVC   @PC00012(4),0(@01)                                  0795
*   DCL                                                            0796
*     SKIPRC FIXED(31);             /* RETURN CODE COLLECTOR         */
*   DCL                                                            0797
*     SKIPLOOP CHAR(1);             /* LOOP CONTROL SWITCH           */
*                                                                  0797
*   /*****************************************************************/
*   /*                                                               */
*   /* READ RECORDS USING HMASMCRP (INTO CRPBUFFR) UNTIL NON-ZERO    */
*   /* RETURN CODE OR A ++ IS FOUND IN FIRST TWO COLUMNS.            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0798
*   SKIPLOOP=YES;                   /* SET LOOP CONTROL SWITCH       */
         MVI   SKIPLOOP,C'Y'                                       0798
*   DO WHILE SKIPLOOP=YES;                                         0799
         B     @DE00799                                            0799
@DL00799 DS    0H                                                  0800
*     CRPBFPRM=OFF;                 /* BUFFER NOT PRIMED             */
*     CRPSCNCL=OFF;                 /* NOT A CALL FROM HMASMSCN      */
         NI    CRPBFPRM,B'01111110'                                0801
*     CALL HMASMCRD(HMASMCRP);                                     0802
         L     @15,@CV01885                                        0802
         LA    @01,@AL00802                                        0802
         BALR  @14,@15                                             0802
*     IF CRPRETRN^=CRPGOOD THEN                                    0803
         CLI   CRPRETRN,0                                          0803
         BE    @RF00803                                            0803
*       SKIPLOOP=NO;                /* ERROR OR EOF ... STOP LOOP    */
         MVI   SKIPLOOP,C'N'                                       0804
*     ELSE                                                         0805
*       IF CRPBUFFR(1:2)='++' THEN                                 0805
         B     @RC00803                                            0805
@RF00803 CLC   CRPBUFFR(2),@CC02184                                0805
         BNE   @RF00805                                            0805
*         SKIPLOOP=NO;              /* NEXT MCS FOUND ... STOP LOOP  */
         MVI   SKIPLOOP,C'N'                                       0806
*   END;                                                           0807
@RF00805 DS    0H                                                  0807
@RC00803 DS    0H                                                  0807
@DE00799 CLI   SKIPLOOP,C'Y'                                       0807
         BE    @DL00799                                            0807
*   IF CRPRETRN=CRPEOF              /* END-OF-FILE ENCOUNTERED       */
*     THEN                                                         0808
         CLI   CRPRETRN,4                                          0808
         BNE   @RF00808                                            0808
*     MCSEOF=ON;                    /* SET END-OF-FILE FLAG          */
         OI    MCSEOF,B'00010000'                                  0809
*   ELSE                                                           0810
*     SKIPRC=MAX(SKIPRC,CRPRETRN);  /* MAINTAIN RETURN CODE          */
         B     @RC00808                                            0810
@RF00808 L     @15,@PC00012                                        0810
         L     @14,SKIPRC(,@15)                                    0810
         SLR   @07,@07                                             0810
         IC    @07,CRPRETRN                                        0810
         CR    @14,@07                                             0810
         BNL   *+6
         LR    @14,@07                                             0810
         ST    @14,SKIPRC(,@15)                                    0810
*   RETURN;                                                        0811
@EL00012 DS    0H                                                  0811
@EF00012 DS    0H                                                  0811
@ER00012 LM    @14,@12,@SA00012                                    0811
         BR    @14                                                 0811
*   END SKIPELEM;                                                  0812
         B     @EL00012                                            0812
*                                                                  0813
*/********************************************************************/
*/*                                                                  */
*/*    WRKCHK   - CHECK THE ICT MOD SECTION TO DETERMINE WHETHER THE */
*/*               ELEMENT PASSED (ELEMENT_NAME/ELEMENT_TYPE PAIR)    */
*/*               CAN BE MOVED TO A WRK DATASET.                     */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0813
*WRKCHK:                                                           0813
*   PROC(ELNAME,ELTYPE,ANSWRKC);                                   0813
WRKCHK   STM   @14,@12,12(@13)                                     0813
         MVC   @PC00013(12),0(@01)                                 0813
*   DCL                                                            0814
*     ELNAME CHAR(8);               /* ELEMENT NAME                  */
*   DCL                                                            0815
*     ELTYPE BIT(8);                /* ELEMENT TYPE (VALUES AS IN  0815
*                                      ICTMFLG1)                     */
*   DCL                                                            0816
*     ANSWRKC CHAR(1);              /* RETURNS "YES" IF THE ELEMENT
*                                      CAN BE MOVED ... RETURNS "NO"
*                                      IF NOT                        */
*   DCL                                                            0817
*     NN FIXED(15);                 /* LOCAL INDEX ... ICT MOD SECT
*                                      ENTRIES                       */
*   RESPECIFY                                                      0818
*     ICTMOD BASED(CCAICMOD);       /* SET UP ADDRESSIBILITY TO THE
*                                      ENTIRE ICT MOD SECTION        */
*                                                                  0818
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOK THRU THE ICT MOD SECTION FOR ANOTHER VERSION OF THE SAME */
*   /* ELEMENT_NAME/ELEMENT_TYPE AS ELNAME/ELTYPE                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0819
*   ANSWRKC=YES;                    /* INITIALLY SET TO "OK TO MOVE
*                                      THIS ELEMENT"                 */
         L     @15,@PC00013+8                                      0819
         MVI   ANSWRKC(@15),C'Y'                                   0819
*   DO NN=1 BY 1 WHILE ICTMEND(NN)^=ICTENDNT&ANSWRKC=YES;          0820
         LA    NN,1                                                0820
         B     @DE00820                                            0820
@DL00820 DS    0H                                                  0821
*     IF ICTMNAME(NN)=ELNAME        /* COMPARE ELEMENT NAME          */
*         &ICTMFLG1(NN)=ELTYPE      /* COMPARE ELEMENT TYPE          */
*         &ICTMWRK(NN)=ON           /* CHK IF MOVED TO WRK DATASET   */
*       THEN                                                       0821
         LR    @03,NN                                              0821
         MH    @03,@CH02383                                        0821
         L     @15,CCAICMOD(,CCAPTR)                               0821
         L     @14,@PC00013                                        0821
         ST    @03,@TF00001                                        0821
         ALR   @03,@15                                             0821
         AL    @03,@CF02422                                        0821
         CLC   ICTMNAME(8,@03),ELNAME(@14)                         0821
         BNE   @RF00821                                            0821
         L     @03,@PC00013+4                                      0821
         LR    @14,@15                                             0821
         AL    @14,@TF00001                                        0821
         AL    @14,@CF02420                                        0821
         CLC   ICTMFLG1-9(1,@14),ELTYPE(@03)                       0821
         BNE   @RF00821                                            0821
         AL    @15,@TF00001                                        0821
         AL    @15,@CF02439                                        0821
         TM    ICTMWRK-10(@15),B'00001000'                         0821
         BNO   @RF00821                                            0821
*       DO;                                                        0822
*                                                                  0822
*         /***********************************************************/
*         /*                                                         */
*         /* ANOTHER VERSION OF THIS SAME ELEMENT IS ON A WRK DATASET*/
*         /* ... THIS VERSION OF THE ELEMENT CANNOT BE MOVED NOW     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0823
*         ANSWRKC=NO;               /* SET RETURN PARM ... "CANNOT BE
*                                      MOVED"                        */
         L     @03,@PC00013+8                                      0823
         MVI   ANSWRKC(@03),C'N'                                   0823
*       END;                                                       0824
*   END;                                                           0825
@RF00821 AL    NN,@CF00065                                         0825
@DE00820 LR    @03,NN                                              0825
         MH    @03,@CH02383                                        0825
         L     @01,CCAICMOD(,CCAPTR)                               0825
         AL    @01,@CF02422                                        0825
         L     @03,ICTMEND(@03,@01)                                0825
         CL    @03,ICTENDNT                                        0825
         BE    @DC00820                                            0825
         L     @03,@PC00013+8                                      0825
         CLI   ANSWRKC(@03),C'Y'                                   0825
         BE    @DL00820                                            0825
@DC00820 DS    0H                                                  0826
*   RETURN;                                                        0826
@EL00013 DS    0H                                                  0826
@EF00013 DS    0H                                                  0826
@ER00013 LM    @14,@12,12(@13)                                     0826
         BR    @14                                                 0826
*   END WRKCHK;                                                    0827
*                                                                  0828
*/********************************************************************/
*/*                                                                  */
*/*    XPNDZAP  - BUILD AN ICT MOD SECTION ENTRY FOR A MODULE        */
*/*               WHICH MUST BE LINKEDITED AND EXPANDED FOR A ZAP    */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * XPNDRC   - RETURN CODE PARAMETER PASSED ... MAY BE NON-ZERO*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0828
*XPNDZAP:                                                          0828
*   PROC(ZAPMOD@,ZAPPTF@,XPNDRC);                                  0828
XPNDZAP  STM   @14,@12,@SA00014                                    0828
         MVC   @PC00014(12),0(@01)                                 0828
*   DCL                                                            0829
*     ZAPMOD@ PTR(31);              /* PTR TO ICT MOD SECT ENTRY FOR
*                                      ZAP ELEMENT                   */
*   DCL                                                            0830
*     ZAPPTF@ PTR(31);              /* PTR TO ICT PTF SECT ENTRY FOR
*                                      ZAP ELEMENT                   */
*   DCL                                                            0831
*     XPNDRC FIXED(31);             /* MAX RETURN CODE COLLECTOR     */
*   DCL                                                            0832
*     XPNDPTR PTR(31);              /* LOCAL PTR TO ENTRY BUILT      */
*   RESPECIFY                                                      0833
*     ICTMOD BASED(ZAPMOD@);        /* ADDRESS MOD SECT ENTRY        */
*   RESPECIFY                                                      0834
*     ICTPTF BASED(ZAPPTF@);        /* ADDRESS PTF SECT ENTRY        */
*                                                                  0834
*   /*****************************************************************/
*   /*                                                               */
*   /* OBTAIN ICT MOD SECTION ENTRY FOR EXPAND LINK EDIT             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0835
*   ICTMXPND(1)=OFF;                /* TURN OFF BIT SET BY HMASMTMW  */
         L     @15,@PC00014                                        0835
         L     @15,ZAPMOD@(,@15)                                   0835
         NI    ICTMXPND(@15),B'11101111'                           0835
*   XPNDPTR=TBLXTOP;                /* ADDR OF ENTRY TO BE OBTAINED  */
         L     @14,@PC00001                                        0836
         MVC   XPNDPTR(4),TBLXTOP(@14)                             0836
*   CALL HMASMTAD(TBLXPARM,         /* PARM LIST                     */
*       'M',                        /* BUILD MOD SECTION ENTRY       */
*       ICTMNAME);                  /* ENTRY NAME                    */
         ST    @14,@AL00001                                        0837
         LA    @14,@CC00717                                        0837
         ST    @14,@AL00001+4                                      0837
         ST    @15,@AL00001+8                                      0837
         L     @15,@CV01891                                        0837
         LA    @01,@AL00001                                        0837
         BALR  @14,@15                                             0837
*   RESPECIFY                                                      0838
*     REG15 RSTD;                                                  0838
*   XPNDRC=MAX(XPNDRC,REG15);       /* MAINTAIN RETURN CODE          */
         L     @14,@PC00014+8                                      0839
         L     @07,XPNDRC(,@14)                                    0839
         CR    @07,REG15                                           0839
         BNL   *+6
         LR    @07,REG15                                           0839
         ST    @07,XPNDRC(,@14)                                    0839
*   RESPECIFY                                                      0840
*     REG15 UNRSTD;                                                0840
*   IF XPNDRC<STOPPTF THEN                                         0841
         CH    @07,@CH00033                                        0841
         BNL   @RF00841                                            0841
*     DO;                                                          0842
*                                                                  0842
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE MOD SECTION ENTRY OBTAINED TO REPRESENT THE    */
*       /* LINKEDIT REQUIRED TO EXPAND THE MODULE                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0843
*       RESPECIFY                                                  0843
*         ICTMOD BASED(XPNDPTR);    /* ADDRESS MOD SECT JUST OBTAINED*/
*       CALL HMASMTM1(TBLXPARM,     /* PARM LIST                     */
*           XPNDPTR,                /* PTR TO MOD SECT ENTRY         */
*           ZAPPTF@,                /* PTR TO PTF SECT ENTRY         */
*           MCBPTR);                /* PTR TO INITIALIZED MCB        */
         L     @15,@PC00001                                        0844
         ST    @15,@AL00001                                        0844
         LA    @15,XPNDPTR                                         0844
         ST    @15,@AL00001+4                                      0844
         L     @15,@PC00014+4                                      0844
         ST    @15,@AL00001+8                                      0844
         LA    @15,MCBPTR                                          0844
         ST    @15,@AL00001+12                                     0844
         L     @15,@CV01896                                        0844
         LA    @01,@AL00001                                        0844
         BALR  @14,@15                                             0844
*       RESPECIFY                                                  0845
*         REG15 RSTD;                                              0845
*       XPNDRC=MAX(XPNDRC,REG15);   /* MAINTAIN RETURN CODE          */
         L     @14,@PC00014+8                                      0846
         L     @07,XPNDRC(,@14)                                    0846
         CR    @07,REG15                                           0846
         BNL   *+6
         LR    @07,REG15                                           0846
         ST    @07,XPNDRC(,@14)                                    0846
*       RESPECIFY                                                  0847
*         REG15 UNRSTD;             /*                               */
*       ICTMMOD(1)=OFF;             /* CLEAR MOD-REPL INDICATOR      */
*       ICTMZAP(1)=OFF;             /* CLEAR MOD-ZAP INDICATOR       */
*       ICTMXPND(1)=ON;             /* SET EXPAND ZAP FLAG           */
         L     @15,XPNDPTR                                         0850
         OI    ICTMXPND(@15),B'00010000'                           0850
         NI    ICTMMOD(@15),B'01011111'                            0850
*       ICTFMLIB(1)='SMPWRK4 ';     /* SMPWRK4 CONTAINS EXPAND STMTS.*/
         MVC   ICTFMLIB(8,@15),@CC02209                            0851
*       ICTMFMID(1)=ICTPFMID(1);    /* FMID IS SYSMOD'S FMID         */
         L     @14,@PC00014+4                                      0852
         L     @01,ZAPPTF@(,@14)                                   0852
         MVC   ICTMFMID(7,@15),ICTPFMID(@01)                       0852
*       ICTMRMID(1)=NULLPTF#;       /* RMID IS NOT APPLICABLE ... AN
*                                      EXPAND ZAP DOES NOT CHANGE  0853
*                                      ELEMENT'S RMID                */
         MVC   ICTMRMID(7,@15),@CC01944                            0853
*     END;                                                         0854
*   RETURN;                                                        0855
@EL00014 DS    0H                                                  0855
@EF00014 DS    0H                                                  0855
@ER00014 LM    @14,@12,@SA00014                                    0855
         BR    @14                                                 0855
*   END XPNDZAP;                                                   0856
         B     @EL00014                                            0856
*                                                                  0857
*/********************************************************************/
*/*                                                                  */
*/*    LOCMCS   - LOCATE PTS MCS MEMBER                              */
*/*                                                                  */
*/*             - RE-INITIALIZE HMASMCRD AND HMASMMPD PARM LISTS     */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * PTRIOP1  - PTR TO IOP TO BE USED TO ACCESS MCS MEMBER      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0857
*LOCMCS:                                                           0857
*   PROC(MEMBR,LOCRC);                                             0857
LOCMCS   STM   @14,@12,@SA00015                                    0857
         MVC   @PC00015(8),0(@01)                                  0857
*   DCL                                                            0858
*     MEMBR CHAR(7);                /* PTS MCS MEMBER NAME           */
*   DCL                                                            0859
*     LOCRC FIXED(31);              /* RETURN CODE COLLECTOR         */
*   RESPECIFY                                                      0860
*     HMASMIOP BASED(PTRIOP1);      /* IOP USED TO ACCESS PTS        */
*   MCSEOF=OFF;                     /* CLEAR MCS MEMBER END-OF-FILE
*                                      FLAG                          */
*                                                                  0861
         NI    MCSEOF,B'11101111'                                  0861
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE SMPPTS DATASET                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0862
*   HMASMIOP=''B;                   /* CLEAR IOP                     */
         XC    HMASMIOP(68,PTRIOP1),HMASMIOP(PTRIOP1)              0862
*   IOPDSID=IOPPTS;                 /* SMPPTS DATASET                */
         MVI   IOPDSID(PTRIOP1),X'06'                              0863
*   IOPFUNCT=IOPCLOSE;              /* CLOSE DATASET                 */
         MVI   IOPFUNCT(PTRIOP1),X'50'                             0864
*   CALL HMASMIO(HMASMIOP);                                        0865
*                                                                  0865
         ST    PTRIOP1,@AL00001                                    0865
         L     @15,@CV01886                                        0865
         LA    @01,@AL00001                                        0865
         BALR  @14,@15                                             0865
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE SYSMOD MCS ENTRY ON THE PTS DATASET                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0866
*   IOPDSID=IOPPTS;                 /* SMPPTS DATASET                */
         MVI   IOPDSID(PTRIOP1),X'06'                              0866
*   IOPNAME=' ';                    /* BLANK NAME FIELD              */
         MVI   IOPNAME+1(PTRIOP1),C' '                             0867
         MVC   IOPNAME+2(6,PTRIOP1),IOPNAME+1(PTRIOP1)             0867
         MVI   IOPNAME(PTRIOP1),C' '                               0867
*   IOPNAM17=MEMBR;                 /* SYSMOD NAME IS ENTRY TO LOCATE
*                                      ON PTS                        */
         L     @03,@PC00015                                        0868
         MVC   IOPNAM17(7,PTRIOP1),MEMBR(@03)                      0868
*   IOPTYPE=IOPMCS;                 /* ENTRY TYPE IS MCS             */
         MVI   IOPTYPE(PTRIOP1),X'10'                              0869
*   IOPFUNCT=IOPBLDL;               /* DO BLDL TO SET UP FOR       0870
*                                      PROCESSING RECORDS            */
         MVI   IOPFUNCT(PTRIOP1),X'04'                             0870
*   CALL HMASMIO(HMASMIOP);                                        0871
         ST    PTRIOP1,@AL00001                                    0871
         L     @15,@CV01886                                        0871
         LA    @01,@AL00001                                        0871
         BALR  @14,@15                                             0871
*   IF IOPRETRN=IOPGOOD THEN                                       0872
         CLI   IOPRETRN(PTRIOP1),0                                 0872
         BNE   @RF00872                                            0872
*     DO;                                                          0873
*                                                                  0873
*       /*************************************************************/
*       /*                                                           */
*       /* PTS MCS ENTRY FOUND FOR SYSMOD                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0874
*       IOPFUNCT=IOPPOSI;           /* POSITION TO MEMBER RECORDS    */
         MVI   IOPFUNCT(PTRIOP1),X'02'                             0874
*       CALL HMASMIO(HMASMIOP);                                    0875
         ST    PTRIOP1,@AL00001                                    0875
         L     @15,@CV01886                                        0875
         LA    @01,@AL00001                                        0875
         BALR  @14,@15                                             0875
*       IF IOPRETRN=IOPGOOD THEN                                   0876
         CLI   IOPRETRN(PTRIOP1),0                                 0876
         BNE   @RF00876                                            0876
*         DO;                                                      0877
*                                                                  0877
*           /*********************************************************/
*           /*                                                       */
*           /* SUCCESSFULLY POSITIONED TO RECORDS CONTAINING THE     */
*           /* MODIFICATION CONTROL STATEMENTS FOR THE SYSMOD        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0878
*                                                                  0878
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP HMASMCRD PARM LIST (HMASMCRP) AND HMASMMPD PARM*/
*           /* LIST (HMASMMPP)                                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0878
*           HMASMCRP=''B;           /* CLEAR PARM LIST               */
         XC    HMASMCRP(106),HMASMCRP                              0878
*           CRPINDS=IOPPTS;         /* INPUT DATASET IS SMPPTS       */
         MVI   CRPINDS,X'06'                                       0879
*           CRPBFPRM=OFF;           /* BUFFER NOT PRIMED             */
*           CRPPTS=OFF;             /* DO NOT WRITE TO PTS           */
*           CRPLOG=OFF;             /* DO NOT WRITE TO LOG           */
*           CRPPRINT=OFF;           /* DO NOT WRITE TO OUT           */
*           CRPOTHER=OFF;           /* DO NOT WRITE TO CRDOUTDS      */
         NI    CRPBFPRM,B'01000011'                                0884
*           CRPUXNUM=0;             /* NO USER EXIT                  */
         MVI   CRPUXNUM,X'00'                                      0885
*           CRPSCNCL=OFF;           /* NOT A CALL FROM HMASMSCN      */
         NI    CRPSCNCL,B'11111110'                                0886
*           CRPSCPAD=0;             /* NO SCP IS PASSED              */
         SLR   @15,@15                                             0887
         ST    @15,CRPSCPAD                                        0887
*           MPPMCBAD=MCBPTR;        /* POINT TO MCB                  */
         MVC   MPPMCBAD(4),MCBPTR                                  0888
*           MPPCRDAD=ADDR(HMASMCRD);/* GET ROUTINE FOR USE BY MPD    */
         L     @15,@CV01885                                        0889
         ST    @15,MPPCRDAD                                        0889
*           MPPCRDPM=ADDR(HMASMCRP);/* GET ROUTINE PARM LIST         */
         LA    @15,HMASMCRP                                        0890
         ST    @15,MPPCRDPM                                        0890
*         END;                                                     0891
*       ELSE                                                       0892
*         DO;                                                      0892
*                                                                  0892
         B     @RC00876                                            0892
@RF00876 DS    0H                                                  0893
*           /*********************************************************/
*           /*                                                       */
*           /* COULD NOT POSITION TO RECORDS IN PTS MCS MEMBER ...   */
*           /* ISSUE: HMA246I/PART011                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0893
*           LOCRC=STOPPTF;          /* SET RETURN CODE               */
         L     @03,@PC00015+4                                      0893
         LA    @15,8                                               0893
         ST    @15,LOCRC(,@03)                                     0893
*           LOCRC=MAX(LOCRC,IOPRETRN);/* IN CASE HIGHER              */
         SLR   @14,@14                                             0894
         IC    @14,IOPRETRN(,PTRIOP1)                              0894
         CR    @15,@14                                             0894
         BNL   *+6
         LR    @15,@14                                             0894
         ST    @15,LOCRC(,@03)                                     0894
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0895
*           CALL ERRMSG(HMA246I,PART011);                          0896
         LA    @01,@AL00896                                        0896
         BAL   @14,ERRMSG                                          0896
*         END;                                                     0897
*     END;                                                         0898
*   ELSE                                                           0899
*     DO;                                                          0899
*                                                                  0899
         B     @RC00872                                            0899
@RF00872 DS    0H                                                  0900
*       /*************************************************************/
*       /*                                                           */
*       /* COULD NOT DO BLDL TO LOCATE PTS MCS ENTRY (EITHER NOT     */
*       /* FOUND OR I/O ERROR) ... ISSUE: HMA246I/PART011            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0900
*       LOCRC=STOPPTF;              /* SET RETURN CODE               */
         L     @03,@PC00015+4                                      0900
         LA    @15,8                                               0900
         ST    @15,LOCRC(,@03)                                     0900
*       LOCRC=MAX(LOCRC,IOPRETRN);  /* IN CASE HIGHER                */
         SLR   @14,@14                                             0901
         IC    @14,IOPRETRN(,PTRIOP1)                              0901
         CR    @15,@14                                             0901
         BNL   *+6
         LR    @15,@14                                             0901
         ST    @15,LOCRC(,@03)                                     0901
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       0902
*       CALL ERRMSG(HMA246I,PART011);                              0903
         LA    @01,@AL00903                                        0903
         BAL   @14,ERRMSG                                          0903
*     END;                                                         0904
*   RETURN;                                                        0905
@EL00015 DS    0H                                                  0905
@EF00015 DS    0H                                                  0905
@ER00015 LM    @14,@12,@SA00015                                    0905
         BR    @14                                                 0905
*   END LOCMCS;                                                    0906
         B     @EL00015                                            0906
*                                                                  0907
*/********************************************************************/
*/*                                                                  */
*/*    SRCHICTM - SEARCH THE ICT MOD SECTION ENTRIES FOR THE CALLER  */
*/*               SPECIFIED ELEMENT_NAME/ELEMENT_TYPE/SYSMOD         */
*/*               COMBINATION.                                       */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0907
*SRCHICTM:                                                         0907
*   PROC(ELMNAME,ELMCBTY,SMDNAME,RTNPTR);                          0907
SRCHICTM STM   @14,@12,12(@13)                                     0907
         MVC   @PC00016(16),0(@01)                                 0907
*   DCL                                                            0908
*     ELMNAME CHAR(8);              /* ELEMENT NAME                  */
*   DCL                                                            0909
*     ELMCBTY FIXED(8);             /* ELEMENT TYPE (MCBTYPE VALUES) */
*   DCL                                                            0910
*     SMDNAME CHAR(7);              /* SYSMOD NAME                   */
*   DCL                                                            0911
*     RTNPTR PTR(31);               /* RETURNS PTR TO ICT MOD SECT 0911
*                                      ENTRY FOUND (OR ZERO)         */
*   DCL                                                            0912
*     QQ FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/
*   DCL                                                            0913
*     SSMDPTR PTR(31);              /* LOCAL PTR TO PTF SECT ENTRY   */
*   RESPECIFY                                                      0914
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */
*   RTNPTR=0;                       /* CLEAR RETURN POINTER          */
*                                                                  0915
         L     @15,@PC00016+12                                     0915
         SLR   @14,@14                                             0915
         ST    @14,RTNPTR(,@15)                                    0915
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU THE ICT MOD SECTION                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0916
*   DO QQ=1 BY 1 WHILE ICTMEND(QQ)^=ICTENDNT&RTNPTR=0;             0916
         LA    QQ,1                                                0916
         B     @DE00916                                            0916
@DL00916 DS    0H                                                  0917
*     IF ICTMNAME(QQ)=ELMNAME THEN                                 0917
         LR    @03,QQ                                              0917
         MH    @03,@CH02383                                        0917
         L     @15,CCAICMOD(,CCAPTR)                               0917
         L     @14,@PC00016                                        0917
         ST    @03,@TF00001                                        0917
         ALR   @03,@15                                             0917
         AL    @03,@CF02422                                        0917
         CLC   ICTMNAME(8,@03),ELMNAME(@14)                        0917
         BNE   @RF00917                                            0917
*       DO;                                                        0918
*         SSMDPTR=0;                /* CLEAR PTR TO PTF SECT ENTRY   */
         SLR   SSMDPTR,SSMDPTR                                     0919
*         IF ELMCBTY=MCBMODTP       /* ++MOD TYPE PASSED             */
*             &ICTMMOD(QQ)=ON       /* ++MOD TYPE IN ICT             */
*           THEN                                                   0920
         L     @14,@PC00016+4                                      0920
         CLI   ELMCBTY(@14),4                                      0920
         BNE   @RF00920                                            0920
         LR    @14,@15                                             0920
         AL    @14,@TF00001                                        0920
         AL    @14,@CF02420                                        0920
         TM    ICTMMOD-9(@14),B'10000000'                          0920
         BNO   @RF00920                                            0920
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */
         L     @14,@TF00001                                        0921
         AL    @15,@CF02433                                        0921
         L     SSMDPTR,ICTPPTR-96(@14,@15)                         0921
*         IF ELMCBTY=MCBZAPTP       /* ++ZAP TYPE PASSED             */
*             &ICTMZAP(QQ)=ON       /* ++ZAP TYPE IN ICT             */
*           THEN                                                   0922
@RF00920 L     @15,@PC00016+4                                      0922
         CLI   ELMCBTY(@15),7                                      0922
         BNE   @RF00922                                            0922
         LR    @15,QQ                                              0922
         MH    @15,@CH02383                                        0922
         L     @14,CCAICMOD(,CCAPTR)                               0922
         ST    @15,@TF00001                                        0922
         ALR   @15,@14                                             0922
         AL    @15,@CF02420                                        0922
         TM    ICTMZAP-9(@15),B'00100000'                          0922
         BNO   @RF00922                                            0922
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */
         L     @15,@TF00001                                        0923
         AL    @14,@CF02433                                        0923
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0923
*         IF ELMCBTY=MCBMCRTP       /* ++MAC TYPE PASSED             */
*             &ICTMMACR(QQ)=ON      /* ++MAC TYPE IN ICT             */
*           THEN                                                   0924
@RF00922 L     @15,@PC00016+4                                      0924
         CLI   ELMCBTY(@15),5                                      0924
         BNE   @RF00924                                            0924
         LR    @15,QQ                                              0924
         MH    @15,@CH02383                                        0924
         L     @14,CCAICMOD(,CCAPTR)                               0924
         ST    @15,@TF00001                                        0924
         ALR   @15,@14                                             0924
         AL    @15,@CF02420                                        0924
         TM    ICTMMACR-9(@15),B'00001000'                         0924
         BNO   @RF00924                                            0924
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */
         L     @15,@TF00001                                        0925
         AL    @14,@CF02433                                        0925
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0925
*         IF ELMCBTY=MCBMCUTP       /* ++MACUPD TYPE PASSED          */
*             &ICTMMACU(QQ)=ON      /* ++MACUPD TYPE IN ICT          */
*           THEN                                                   0926
@RF00924 L     @15,@PC00016+4                                      0926
         CLI   ELMCBTY(@15),8                                      0926
         BNE   @RF00926                                            0926
         LR    @15,QQ                                              0926
         MH    @15,@CH02383                                        0926
         L     @14,CCAICMOD(,CCAPTR)                               0926
         ST    @15,@TF00001                                        0926
         ALR   @15,@14                                             0926
         AL    @15,@CF02420                                        0926
         TM    ICTMMACU-9(@15),B'00000100'                         0926
         BNO   @RF00926                                            0926
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */
         L     @15,@TF00001                                        0927
         AL    @14,@CF02433                                        0927
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0927
*         IF ELMCBTY=MCBSCRTP       /* ++SRC TYPE PASSED             */
*             &ICTMSRCR(QQ)=ON      /* ++SRC TYPE IN ICT             */
*           THEN                                                   0928
@RF00926 L     @15,@PC00016+4                                      0928
         CLI   ELMCBTY(@15),6                                      0928
         BNE   @RF00928                                            0928
         LR    @15,QQ                                              0928
         MH    @15,@CH02383                                        0928
         L     @14,CCAICMOD(,CCAPTR)                               0928
         ST    @15,@TF00001                                        0928
         ALR   @15,@14                                             0928
         AL    @15,@CF02420                                        0928
         TM    ICTMSRCR-9(@15),B'00000010'                         0928
         BNO   @RF00928                                            0928
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */
         L     @15,@TF00001                                        0929
         AL    @14,@CF02433                                        0929
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0929
*         IF ELMCBTY=MCBSCUTP       /* ++SRCUPD TYPE PASSED          */
*             &ICTMSRCU(QQ)=ON      /* ++SRCUPD TYPE IN ICT          */
*           THEN                                                   0930
@RF00928 L     @15,@PC00016+4                                      0930
         CLI   ELMCBTY(@15),9                                      0930
         BNE   @RF00930                                            0930
         LR    @15,QQ                                              0930
         MH    @15,@CH02383                                        0930
         L     @14,CCAICMOD(,CCAPTR)                               0930
         ST    @15,@TF00001                                        0930
         ALR   @15,@14                                             0930
         AL    @15,@CF02420                                        0930
         TM    ICTMSRCU-9(@15),B'00000001'                         0930
         BNO   @RF00930                                            0930
*           SSMDPTR=ICTPPTR(QQ);    /* POINT TO PTF SECT ENTRY       */
         L     @15,@TF00001                                        0931
         AL    @14,@CF02433                                        0931
         L     SSMDPTR,ICTPPTR-96(@15,@14)                         0931
*         IF SSMDPTR^=0 THEN                                       0932
@RF00930 LTR   SSMDPTR,SSMDPTR                                     0932
         BZ    @RF00932                                            0932
*           DO;                                                    0933
*                                                                  0933
*             /*******************************************************/
*             /*                                                     */
*             /* MATCHING ELEMENT_NAME/ELEMENT_TYPES FOUND ... CHECK */
*             /* WHETHER THE SYSMOD ASSOCIATED WITH THE ELEMENT IN   */
*             /* THE ICT IS THE SAME AS THAT SUPPLIED BY THE CALLER  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0934
*             IF SSMDPTR->ICTPTFS(1)=SMDNAME THEN                  0934
         L     @15,@PC00016+8                                      0934
         CLC   ICTPTFS(7,SSMDPTR),SMDNAME(@15)                     0934
         BNE   @RF00934                                            0934
*               RTNPTR=ADDR(ICTMOD(QQ));/* MATCHING SYSMOD NAME ...
*                                      SET RTNPTR TO THE CURRENT MOD
*                                      SECT ENTRY                    */
         L     @03,@PC00016+12                                     0935
         LR    @15,QQ                                              0935
         MH    @15,@CH02383                                        0935
         L     @01,CCAICMOD(,CCAPTR)                               0935
         AL    @01,@CF02422                                        0935
         LA    @15,ICTMOD(@15,@01)                                 0935
         ST    @15,RTNPTR(,@03)                                    0935
*           END;                                                   0936
@RF00934 DS    0H                                                  0937
*       END;                                                       0937
@RF00932 DS    0H                                                  0938
*   END;                                                           0938
@RF00917 AL    QQ,@CF00065                                         0938
@DE00916 LR    @03,QQ                                              0938
         MH    @03,@CH02383                                        0938
         L     @01,CCAICMOD(,CCAPTR)                               0938
         AL    @01,@CF02422                                        0938
         L     @03,ICTMEND(@03,@01)                                0938
         CL    @03,ICTENDNT                                        0938
         BE    @DC00916                                            0938
         L     @03,@PC00016+12                                     0938
         ICM   @15,15,RTNPTR(@03)                                  0938
         BZ    @DL00916                                            0938
@DC00916 DS    0H                                                  0939
*   RETURN;                                                        0939
@EL00016 DS    0H                                                  0939
@EF00016 DS    0H                                                  0939
@ER00016 LM    @14,@12,12(@13)                                     0939
         BR    @14                                                 0939
*   END SRCHICTM;                                                  0940
*                                                                  0941
*/********************************************************************/
*/*                                                                  */
*/*    SCRWRKX  - SCRATCH ANY EXISTING MEMBERS ON THE WRK DATASETS   */
*/*               FOR THE ELEMENT PASSED BY THE CALLER               */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * PTRIOP2  - PTR TO IOP WHICH MAY BE USED TO SCRATCH MEMBERS */
*/*                  FROM THE WRK DATASETS                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0941
*SCRWRKX:                                                          0941
*   PROC(SCRMOD);                                                  0941
SCRWRKX  STM   @14,@12,@SA00017                                    0941
         MVC   @PC00017(4),0(@01)                                  0941
*   DCL                                                            0942
*     SCRMOD CHAR(*);               /* ICT MOD SECT ENTRY FOR AN   0942
*                                      ELEMENT                       */
*   RESPECIFY                                                      0943
*     ICTMOD BASED(ADDR(SCRMOD));   /* MOD SECT ENTRY PASSED         */
*   RESPECIFY                                                      0944
*     HMASMIOP BASED(PTRIOP2);      /* ADDRESS IOP                   */
*   IF ICTMWRK(1)=ON THEN                                          0945
         L     @15,@PC00017                                        0945
         TM    ICTMWRK(@15),B'00001000'                            0945
         BNO   @RF00945                                            0945
*     DO;                                                          0946
*                                                                  0946
*       /*************************************************************/
*       /*                                                           */
*       /* THE ELEMENT'S TEXT HAS BEEN WRITTEN TO A WRK DATASET      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0947
*                                                                  0947
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE IOP FOR STOW DELETE FUNCTION TO WRK DATASET    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0947
*       IOPFUNCT=IOPSTOWD;          /* STOW DELETE FUNCTION          */
         L     @14,PTRIOP2                                         0947
         MVI   IOPFUNCT(@14),X'53'                                 0947
*       IOPDSID=IOPWKX;             /* WRKX DATASET ... DETERMINED BY
*                                      I/O ROUTINES FROM IOPTYPE     */
         MVI   IOPDSID(@14),X'28'                                  0948
*       IOPNAME=ICTMNAME(1);        /* ELEMENT NAME                  */
         MVC   IOPNAME(8,@14),ICTMNAME(@15)                        0949
*       IF ICTMMOD(1)=ON            /* ++MOD ELEMENT                 */
*         THEN                                                     0950
         TM    ICTMMOD(@15),B'10000000'                            0950
         BNO   @RF00950                                            0950
*         IOPTYPE=IOPMOD;           /* ... GET RID OF WRKX MOD       */
         MVI   IOPTYPE(@14),X'05'                                  0951
*       IF ICTMXPND(1)=ON           /* EXPAND MOD ENTRY              */
*         THEN                                                     0952
@RF00950 L     @15,@PC00017                                        0952
         TM    ICTMXPND(@15),B'00010000'                           0952
         BNO   @RF00952                                            0952
*         IOPTYPE=IOPXZP;           /* ... GET RID OF WRKX EXPANDS   */
         L     @01,PTRIOP2                                         0953
         MVI   IOPTYPE(@01),X'0D'                                  0953
*       IF ICTMMACR(1)=ON           /* ++MAC ELEMENT                 */
*         THEN                                                     0954
@RF00952 L     @15,@PC00017                                        0954
         TM    ICTMMACR(@15),B'00001000'                           0954
         BNO   @RF00954                                            0954
*         IOPTYPE=IOPMCR;           /* ... GET RID OF WRKX MAC       */
         L     @01,PTRIOP2                                         0955
         MVI   IOPTYPE(@01),X'03'                                  0955
*       IF ICTMSRCR(1)=ON           /* ++SRC ELEMENT                 */
*         THEN                                                     0956
@RF00954 L     @15,@PC00017                                        0956
         TM    ICTMSRCR(@15),B'00000010'                           0956
         BNO   @RF00956                                            0956
*         IOPTYPE=IOPSCR;           /* ... GET RID OF WRKX SRC       */
         L     @01,PTRIOP2                                         0957
         MVI   IOPTYPE(@01),X'08'                                  0957
*       IF ICTMZAP(1)=ON            /* ++ZAP ELEMENT                 */
*         THEN                                                     0958
@RF00956 L     @15,@PC00017                                        0958
         TM    ICTMZAP(@15),B'00100000'                            0958
         BNO   @RF00958                                            0958
*         IOPTYPE=IOPZAP;           /* ... GET RID OF WRKX ZAPS      */
         L     @01,PTRIOP2                                         0959
         MVI   IOPTYPE(@01),X'0C'                                  0959
*       IF ICTMMACU(1)=ON           /* ++MACUPD ELEMENT              */
*         THEN                                                     0960
@RF00958 L     @15,@PC00017                                        0960
         TM    ICTMMACU(@15),B'00000100'                           0960
         BNO   @RF00960                                            0960
*         IOPTYPE=IOPMCU;           /* ... GET RID OF WRKX MACUPDS   */
         L     @01,PTRIOP2                                         0961
         MVI   IOPTYPE(@01),X'04'                                  0961
*       IF ICTMSRCU(1)=ON           /* ++SRCUPD ELEMENT              */
*         THEN                                                     0962
@RF00960 L     @15,@PC00017                                        0962
         TM    ICTMSRCU(@15),B'00000001'                           0962
         BNO   @RF00962                                            0962
*         IOPTYPE=IOPSCR;           /* ... GET RID OF WRKX SRCUPDTS  */
         L     @01,PTRIOP2                                         0963
         MVI   IOPTYPE(@01),X'08'                                  0963
*       CALL HMASMIO(HMASMIOP);     /* DO THE STOW DELETE            */
@RF00962 L     @01,PTRIOP2                                         0964
         ST    @01,@AL00001                                        0964
         L     @15,@CV01886                                        0964
         LA    @01,@AL00001                                        0964
         BALR  @14,@15                                             0964
*       ICTMWRK(1)=OFF;             /* ELEMENT NO LONGER ON WRKX     */
         L     @15,@PC00017                                        0965
         NI    ICTMWRK(@15),B'11110111'                            0965
*     END;                                                         0966
*   RETURN;                                                        0967
@EL00017 DS    0H                                                  0967
@EF00017 DS    0H                                                  0967
@ER00017 LM    @14,@12,@SA00017                                    0967
         BR    @14                                                 0967
*   END SCRWRKX;                                                   0968
         B     @EL00017                                            0968
*                                                                  0969
*/********************************************************************/
*/*                                                                  */
*/*    SRCMODA  - FOR THE ++SRC MOD SECTION ENTRY PASSED, LOOK IN    */
*/*               THE ICT FOR AN ASSOCIATED ++MOD MOD SECTION        */
*/*               ENTRY                                              */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * SET IN ++SRC MOD SECTION ENTRY PASSED:                     */
*/*                                                                  */
*/*     - ICTMASOC - SET IF ASSOCIATED ++MOD MOD SECTION ENTRY FOUND */
*/*                                                                  */
*/*     * SET IN ASSOCIATED ++MOD MOD SECT. ENTRY:                   */
*/*                                                                  */
*/*     - ICTMASOC - ASSOICATED ++SRC ENTRY EXISTS                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0969
*SRCMODA:                                                          0969
*   PROC(SRCENTRY);                                                0969
SRCMODA  STM   @14,@12,12(@13)                                     0969
         MVC   @PC00018(4),0(@01)                                  0969
*   DCL                                                            0970
*     SRCENTRY CHAR(*);             /* ICT MOD SECT ENTRY FOR ++SRC
*                                      OR ++SRCUPD ELEMENT           */
*   DCL                                                            0971
*     UU FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/
*   DCL                                                            0972
*     SRCNAME CHAR(8);              /* SOURCE ELEMENT NAME           */
*   DCL                                                            0973
*     SRCSMD@ PTR(31);              /* PTR TO SYSMOD ASSOC WITH ++SRC*/
*   DCL                                                            0974
*     SRCSPTR PTR(31);              /* PTR TO ++SRC MOD ENTRY PASSED */
*   DCL                                                            0975
*     SRCMPTR PTR(31);              /* PTR TO ASSOC ++MOD ENTRY      */
*   RESPECIFY                                                      0976
*     ICTMOD BASED(ADDR(SRCENTRY)); /* ADDRESS ENTRY PASSED          */
*   ICTMASOC(1)=OFF;                /* CLEAR ASSOC. MOD FLAG         */
         L     @02,@PC00018                                        0977
         NI    ICTMASOC(@02),B'11101111'                           0977
*   SRCNAME=ICTMNAME(1);            /* SRC ELEMENT NAME              */
         MVC   SRCNAME(8),ICTMNAME(@02)                            0978
*   SRCSMD@=ICTPPTR(1);             /* "CURRENT" SYSMOD              */
         L     SRCSMD@,ICTPPTR(,@02)                               0979
*   SRCSPTR=ADDR(SRCENTRY);         /* SAVE ADDR OF ++SRC ENTRY      */
         LR    SRCSPTR,@02                                         0980
*   SRCMPTR=0;                      /* CLEAR PTR TO ASSOC ++MOD      */
*                                                                  0981
         SLR   SRCMPTR,SRCMPTR                                     0981
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION LOOKING FOR ASSOC MOD SECT ENTRY      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0982
*   RESPECIFY                                                      0982
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */
*   DO UU=1 BY 1 WHILE ICTMEND(UU)^=ICTENDNT&SRCMPTR=0;            0983
         LA    UU,1                                                0983
         B     @DE00983                                            0983
@DL00983 DS    0H                                                  0984
*     IF ICTMNAME(UU)=SRCNAME       /* ELEMENT NAMES EQUAL           */
*         &ICTMMOD(UU)=ON           /* MOD ENTRY                     */
*         &ICTMASM(UU)=OFF          /* ... NOT ASSEMBLY ENTRY        */
*         &ICTPPTR(UU)=SRCSMD@      /* "CURRENT" SYSMOD              */
*       THEN                                                       0984
         LR    @15,UU                                              0984
         MH    @15,@CH02383                                        0984
         L     @14,CCAICMOD(,CCAPTR)                               0984
         ST    @15,@TF00001                                        0984
         ALR   @15,@14                                             0984
         AL    @15,@CF02422                                        0984
         CLC   ICTMNAME(8,@15),SRCNAME                             0984
         BNE   @RF00984                                            0984
         LR    @15,@14                                             0984
         AL    @15,@TF00001                                        0984
         AL    @15,@CF02420                                        0984
         TM    ICTMMOD-9(@15),B'10000000'                          0984
         BNO   @RF00984                                            0984
         TM    ICTMASM-9(@15),B'01000000'                          0984
         BNZ   @RF00984                                            0984
         L     @15,@TF00001                                        0984
         AL    @15,@CF02433                                        0984
         C     SRCSMD@,ICTPPTR-96(@15,@14)                         0984
         BNE   @RF00984                                            0984
*       DO;                                                        0985
*                                                                  0985
*         /***********************************************************/
*         /*                                                         */
*         /* ASSOCIATED ++MOD MOD ENTRY FOUND                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0986
*         ICTMASOC(UU)=ON;          /* SET ASSOC ++SRC IN ++MOD ENTRY*/
         LR    @15,@14                                             0986
         AL    @15,@TF00001                                        0986
         AL    @15,@CF02421                                        0986
         OI    ICTMASOC-11(@15),B'00010000'                        0986
*         SRCMPTR=ADDR(ICTMOD(UU)); /* POINT TO ++MOD ENTRY FOUND    */
         L     SRCMPTR,@TF00001                                    0987
         AL    @14,@CF02422                                        0987
         LA    SRCMPTR,ICTMOD(SRCMPTR,@14)                         0987
*         SRCSPTR->ICTMASOC(1)=ON;  /* SET ASSOC ++MOD IN ++SRC ENTRY*/
         OI    ICTMASOC(SRCSPTR),B'00010000'                       0988
*       END;                                                       0989
*   END;                                                           0990
@RF00984 AL    UU,@CF00065                                         0990
@DE00983 LR    @15,UU                                              0990
         MH    @15,@CH02383                                        0990
         L     @01,CCAICMOD(,CCAPTR)                               0990
         AL    @01,@CF02422                                        0990
         L     @15,ICTMEND(@15,@01)                                0990
         CL    @15,ICTENDNT                                        0990
         BE    @DC00983                                            0990
         LTR   SRCMPTR,SRCMPTR                                     0990
         BZ    @DL00983                                            0990
@DC00983 DS    0H                                                  0991
*   RETURN;                                                        0991
@EL00018 DS    0H                                                  0991
@EF00018 DS    0H                                                  0991
@ER00018 LM    @14,@12,12(@13)                                     0991
         BR    @14                                                 0991
*   END SRCMODA;                                                   0992
*                                                                  0993
*/********************************************************************/
*/*                                                                  */
*/*    MODSRCA  - FOR THE ++MOD MOD SECTION ENTRY PASSED, LOOK IN    */
*/*               THE ICT FOR AN ASSOCIATED ++SRC MOD SECTION        */
*/*               ENTRY                                              */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * SET IN ++MOD MOD SECTION ENTRY PASSED:                     */
*/*                                                                  */
*/*     - ICTMASOC - SET IF ASSOICATED ++SRC MOD SECT ENTRY FOUND    */
*/*                                                                  */
*/*     * SET IN ++SRC MOD SECTION ENTRY ASSOCIATED WITH ++MOD:      */
*/*                                                                  */
*/*     - ICTMASOC - ASSOCIATED ++MOD MOD SECTION ENTRY EXISTS       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0993
*MODSRCA:                                                          0993
*   PROC(MODENTRY);                                                0993
MODSRCA  STM   @14,@12,12(@13)                                     0993
         MVC   @PC00019(4),0(@01)                                  0993
*   DCL                                                            0994
*     MODENTRY CHAR(*);             /* ICT MOD SECT. ENTRY FOR ++MOD
*                                      ELEMENT                       */
*   DCL                                                            0995
*     TT FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/
*   DCL                                                            0996
*     MODNAME CHAR(8);              /* ELEMENT NAME                  */
*   DCL                                                            0997
*     MODSMD@ PTR(31);              /* PTR TO SYSMOD ASSOC WITH ++MOD*/
*   DCL                                                            0998
*     MODMPTR PTR(31);              /* PTR TO ++MOD MOD ENTRY PASSED */
*   DCL                                                            0999
*     MODSPTR PTR(31);              /* PTR TO ++SRC ENTRY FOUND      */
*   RESPECIFY                                                      1000
*     ICTMOD BASED(ADDR(MODENTRY)); /* ADDRESS ENTRY PASSED          */
*   ICTMASOC(1)=OFF;                /* CLEAR ASSOC ++SRC FLAG        */
         L     @02,@PC00019                                        1001
         NI    ICTMASOC(@02),B'11101111'                           1001
*   MODNAME=ICTMNAME(1);            /* MOD ELEMENT NAME              */
         MVC   MODNAME(8),ICTMNAME(@02)                            1002
*   MODSMD@=ICTPPTR(1);             /* "CURRENT" SYSMOD              */
         L     MODSMD@,ICTPPTR(,@02)                               1003
*   MODMPTR=ADDR(MODENTRY);         /* PTR TO ++MOD ENTRY PASSED     */
         LR    MODMPTR,@02                                         1004
*   MODSPTR=0;                      /* PTR TO ++SRC ENTRY FOUND      */
*                                                                  1005
         SLR   MODSPTR,MODSPTR                                     1005
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION LOOKING FOR ASSOC ++SRC MOD SECT ENTRY*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1006
*   RESPECIFY                                                      1006
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */
*   DO TT=1 BY 1 WHILE ICTMEND(TT)^=ICTENDNT&MODSPTR=0;            1007
         LA    TT,1                                                1007
         B     @DE01007                                            1007
@DL01007 DS    0H                                                  1008
*     IF ICTMNAME(TT)=MODNAME       /* ELEMENT NAMES EQUAL           */
*         &(ICTMSRCR(TT)=ON         /* ++SRC ENTRY                   */
*         ×ICTMSRCU(TT)=ON)         /* ++SRCUPD ENTRY                */
*         &ICTPPTR(TT)=MODSMD@      /* "CURRENT" SYSMOD              */
*       THEN                                                       1008
         LR    @15,TT                                              1008
         MH    @15,@CH02383                                        1008
         L     @14,CCAICMOD(,CCAPTR)                               1008
         ST    @15,@TF00001                                        1008
         ALR   @15,@14                                             1008
         AL    @15,@CF02422                                        1008
         CLC   ICTMNAME(8,@15),MODNAME                             1008
         BNE   @RF01008                                            1008
         LR    @15,@14                                             1008
         AL    @15,@TF00001                                        1008
         AL    @15,@CF02420                                        1008
         TM    ICTMSRCR-9(@15),B'00000011'                         1008
         BZ    @RF01008                                            1008
         L     @15,@TF00001                                        1008
         AL    @15,@CF02433                                        1008
         C     MODSMD@,ICTPPTR-96(@15,@14)                         1008
         BNE   @RF01008                                            1008
*       DO;                                                        1009
*                                                                  1009
*         /***********************************************************/
*         /*                                                         */
*         /* ASSOCIATED ++SRC OR ++SRCUPD MOD ENTRY FOUND            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1010
*         ICTMASOC(TT)=ON;          /* SET ASSOC ++MOD IN ++SRC ENTRY*/
         LR    @15,@14                                             1010
         AL    @15,@TF00001                                        1010
         AL    @15,@CF02421                                        1010
         OI    ICTMASOC-11(@15),B'00010000'                        1010
*         MODSPTR=ADDR(ICTMOD(TT)); /* POINT ++SRC ENTRY FOUND       */
         L     MODSPTR,@TF00001                                    1011
         AL    @14,@CF02422                                        1011
         LA    MODSPTR,ICTMOD(MODSPTR,@14)                         1011
*         MODMPTR->ICTMASOC(1)=ON;  /* SET ASSOC ++SRC IN ++MOD ENTRY*/
         OI    ICTMASOC(MODMPTR),B'00010000'                       1012
*       END;                                                       1013
*   END;                                                           1014
@RF01008 AL    TT,@CF00065                                         1014
@DE01007 LR    @15,TT                                              1014
         MH    @15,@CH02383                                        1014
         L     @01,CCAICMOD(,CCAPTR)                               1014
         AL    @01,@CF02422                                        1014
         L     @15,ICTMEND(@15,@01)                                1014
         CL    @15,ICTENDNT                                        1014
         BE    @DC01007                                            1014
         LTR   MODSPTR,MODSPTR                                     1014
         BZ    @DL01007                                            1014
@DC01007 DS    0H                                                  1015
*   RETURN;                                                        1015
@EL00019 DS    0H                                                  1015
@EF00019 DS    0H                                                  1015
@ER00019 LM    @14,@12,12(@13)                                     1015
         BR    @14                                                 1015
*   END MODSRCA;                                                   1016
*                                                                  1017
*/********************************************************************/
*/*                                                                  */
*/*    GETSYSPO - GET A VALID PROCESSABLE SYSMOD FROM THOSE IN THE   */
*/*               ICT PTF SECTION USING THE SYSMOD PROCESSING ORDER  */
*/*               (ICTPONUM) DETERMINED BY HMASMTPO.                 */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1017
*GETSYSPO:                                                         1017
*   PROC(NXTINDX);                                                 1017
GETSYSPO STM   @14,@12,12(@13)                                     1017
         MVC   @PC00020(4),0(@01)                                  1017
*   DCL                                                            1018
*     NXTINDX FIXED(31);            /* INDEX TO ICT PTF SECTION ENTRY
*                                      .... ZERO IF NO PROCESSABLE 1018
*                                      SYSMOD FOUND IN ICT           */
*   DCL                                                            1019
*     PI FIXED(15);                 /* LOCAL INDEX - PTF SECT ENTRIES*/
*   DCL                                                            1020
*     MINORD# FIXED(16);            /* LOWEST PROCESSING ORDER VALUE
*                                      FOUND IN SEARCH THRU ICT      */
*   RESPECIFY                                                      1021
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */
*   NXTINDX=0;                      /* CLEAR INDEX RETURNED TO CALLER*/
         L     @02,@PC00020                                        1022
         SLR   @15,@15                                             1022
         ST    @15,NXTINDX(,@02)                                   1022
*   MINORD#=0;                      /* LOWEST PROCESSING ORDER VALUE
*                                      FOUND IN SEARCH THRU ICT      */
*                                                                  1023
         SLR   MINORD#,MINORD#                                     1023
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT PTF SECTION ENTRIES                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1024
*   DO PI=1 BY 1 WHILE ICTPEND(PI)^=ICTENDNT&HIGHTMD<STOPFUNC;     1024
         LA    PI,1                                                1024
         B     @DE01024                                            1024
@DL01024 DS    0H                                                  1025
*     IF ICTPNOGO(PI)=OFF           /* SYSMOD NOT NOGO               */
*         &ICTPSUPN(PI)=0           /* SYSMOD NOT SUPERSEDED         */
*         &ICTPMSL(PI)=OFF          /* SYSMOD NOT PROCESSED          */
*         &ICTPGELM(PI)=OFF         /* SYSMOD NOT ELIMINATED         */
*         &ICTPDEXP(PI)=OFF         /* SYSMOD NOT EXPLICITLY DELETED */
*         &ICTPDIMP(PI)=OFF         /* SYSMOD NOT IMPLICITLY DELETED */
*       THEN                                                       1025
         LR    @15,PI                                              1025
         MH    @15,@CH02382                                        1025
         L     @14,CCAICPTF(,CCAPTR)                               1025
         ST    @15,@TF00001                                        1025
         ALR   @15,@14                                             1025
         AL    @15,@CF02416                                        1025
         TM    ICTPNOGO-8(@15),B'01000000'                         1025
         BNZ   @RF01025                                            1025
         LR    @15,@14                                             1025
         AL    @15,@TF00001                                        1025
         AL    @15,@CF02443                                        1025
         SLR   @07,@07                                             1025
         ICM   @07,3,ICTPSUPN-20(@15)                              1025
         LTR   @07,@07                                             1025
         BNZ   @RF01025                                            1025
         LR    @15,@14                                             1025
         AL    @15,@TF00001                                        1025
         AL    @15,@CF02418                                        1025
         TM    ICTPMSL-15(@15),B'10000000'                         1025
         BNZ   @RF01025                                            1025
         LR    @15,@14                                             1025
         AL    @15,@TF00001                                        1025
         AL    @15,@CF02415                                        1025
         TM    ICTPGELM-13(@15),B'00111000'                        1025
         BNZ   @RF01025                                            1025
*       DO;                                                        1026
*                                                                  1026
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESSABLE SYSMOD FOUND ... CHECK ITS PROCESSING ORDER */
*         /* VALUE RELATIVE TO THE LAST ONE FOUND                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1027
*         IF MINORD#=0              /* FIRST PROCESSABLE SYSMOD FND  */
*           THEN                                                   1027
         LTR   MINORD#,MINORD#                                     1027
         BNZ   @RF01027                                            1027
*           DO;                                                    1028
*             MINORD#=ICTPONUM(PI); /* SAVE PROCESSING ORDER VALUE   */
         AL    @14,@TF00001                                        1029
         AL    @14,@CF02444                                        1029
         SLR   MINORD#,MINORD#                                     1029
         ICM   MINORD#,3,ICTPONUM-18(@14)                          1029
*             NXTINDX=PI;           /* SAVE ICT PTF SECT. INDEX      */
         L     @15,@PC00020                                        1030
         ST    PI,NXTINDX(,@15)                                    1030
*           END;                                                   1031
*         ELSE                                                     1032
*           DO;                                                    1032
         B     @RC01027                                            1032
@RF01027 DS    0H                                                  1033
*             IF ICTPONUM(PI)<MINORD#/* COMPARE WITH LOWEST # FOUND  */
*               THEN                                               1033
         LR    @15,PI                                              1033
         MH    @15,@CH02382                                        1033
         L     @01,CCAICPTF(,CCAPTR)                               1033
         ALR   @01,@15                                             1033
         AL    @01,@CF02444                                        1033
         SLR   @15,@15                                             1033
         ICM   @15,3,ICTPONUM-18(@01)                              1033
         CR    @15,MINORD#                                         1033
         BNL   @RF01033                                            1033
*               DO;                                                1034
*                                                                  1034
*                 /***************************************************/
*                 /*                                                 */
*                 /* A NEW LOWEST PROCESSING ORDER # FOUND           */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1035
*                 MINORD#=ICTPONUM(PI);/* SAVE PROCESSG. ORDER VALUE */
         LR    MINORD#,@15                                         1035
*                 NXTINDX=PI;       /* SAVE ICT PTF SECT. INDEX      */
         L     @15,@PC00020                                        1036
         ST    PI,NXTINDX(,@15)                                    1036
*               END;                                               1037
*           END;                                                   1038
@RF01033 DS    0H                                                  1039
*       END;                        /* END PROCESSABLE SYSMOD FOUND  */
@RC01027 DS    0H                                                  1040
*   END;                            /* END LOOP THRU ICT PTF SECTION */
@RF01025 AL    PI,@CF00065                                         1040
@DE01024 LR    @15,PI                                              1040
         MH    @15,@CH02382                                        1040
         L     @01,CCAICPTF(,CCAPTR)                               1040
         AL    @01,@CF02417                                        1040
         L     @15,ICTPEND(@15,@01)                                1040
         CL    @15,ICTENDNT                                        1040
         BE    @DC01024                                            1040
         L     @15,HIGHTMD                                         1040
         CH    @15,@CH00036                                        1040
         BL    @DL01024                                            1040
@DC01024 DS    0H                                                  1041
*   RETURN;                                                        1041
@EL00020 DS    0H                                                  1041
@EF00020 DS    0H                                                  1041
@ER00020 LM    @14,@12,12(@13)                                     1041
         BR    @14                                                 1041
*   END GETSYSPO;                                                  1042
*                                                                  1043
*/********************************************************************/
*/*                                                                  */
*/*    ERRMSG   - PUT ERROR MESSAGES TO SMPOUT AND SMPLOG            */
*/*             - SET HIGHTMD FROM MGPTYPE                           */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     * MGPTYPE -  MESSAGE SEVERITY INITIALIZED TO VALID VALUE     */
*/*                                                                  */
*/*     * MSGSMDNM - "CURRENT" SYSMOD NAME                           */
*/*                                                                  */
*/*     * VPART#1  - AS NEEDED FOR PARTICULAR MESSAGES               */
*/*                                                                  */
*/*     * VPART#2  - AS NEEDED FOR PARTICULAR MESSAGES               */
*/*                                                                  */
*/*     * VPART#3  - AS NEEDED FOR PARTICULAR MESSAGES               */
*/*                                                                  */
*/********************************************************************/
*                                                                  1043
*ERRMSG:                                                           1043
*   PROC(MSGCODE1,MSGCODE2);                                       1043
ERRMSG   STM   @14,@12,@SA00021                                    1043
         MVC   @PC00021(8),0(@01)                                  1043
*   DCL                                                            1044
*     MSGCODE1 FIXED(8);            /* PRIMARY MESSAGE NUMBER        */
*   DCL                                                            1045
*     MSGCODE2 FIXED(8);            /* MESSAGE PART NUMBER           */
*                                                                  1046
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP HMASMMSG PARM LIST (MGP)                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1046
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */
         XC    MGPCLEAR(6),MGPCLEAR                                1046
*   MGPFLAGS=''B;                   /* CLEAR ALL FLAGS               */
         XC    MGPFLAGS(2),MGPFLAGS                                1047
*   MGPMGNO1=MSGCODE1;              /* PRIMARY MESSAGE NUMBER        */
         L     @15,@PC00021                                        1048
         SLR   @14,@14                                             1048
         IC    @14,MSGCODE1(,@15)                                  1048
         STH   @14,MGPMGNO1                                        1048
*   IF MSGCODE2^=NOPART THEN                                       1049
         L     @15,@PC00021+4                                      1049
         CLI   MSGCODE2(@15),0                                     1049
         BE    @RF01049                                            1049
*     MGPMGNO2=MSGCODE2;            /* MESSAGE PART NUMBER           */
         SLR   @14,@14                                             1050
         IC    @14,MSGCODE2(,@15)                                  1050
         STH   @14,MGPMGNO2                                        1050
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */
@RF01049 DS    0H                                                  1052
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */
*                                                                  1052
         OI    MGPPRINT,B'10010000'                                1052
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP VARIABLE PARTS OF CERTAIN MESSAGES                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1053
*   IF MSGCODE1=HMA226I             /* MESSAGE ID = HMA226I          */
*     THEN                                                         1053
         L     @15,@PC00021                                        1053
         CLI   MSGCODE1(@15),27                                    1053
         BNE   @RF01053                                            1053
*     DO;                                                          1054
*                                                                  1054
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA226I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1055
*       MGPVARPT(1)=ADDR(TBLXFUNC); /* SMP FUNCTION (APPLY OR ACCEPT)*/
         L     @15,@PC00001                                        1055
         LA    @15,TBLXFUNC(,@15)                                  1055
         ST    @15,MGPVARPT                                        1055
*       MGPVARPT(2)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */
         LA    @15,MSGSMDNM                                        1056
         ST    @15,MGPVARPT+4                                      1056
*     END;                                                         1057
*   IF MSGCODE1=HMA246I             /* MESSAGE ID = HMA246I          */
*     THEN                                                         1058
@RF01053 L     @15,@PC00021                                        1058
         CLI   MSGCODE1(@15),47                                    1058
         BNE   @RF01058                                            1058
*     DO;                                                          1059
*                                                                  1059
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA246I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1060
*       MGPVARPT(1)=ADDR(MSGMCS);   /* SET 'MCS' IN MSG              */
         LA    @15,@CC01991                                        1060
         ST    @15,MGPVARPT                                        1060
*       MGPVARPT(2)=ADDR(MSGENTRY); /* SET 'ENTRY' IN MSG            */
         LA    @15,@CC01995                                        1061
         ST    @15,MGPVARPT+4                                      1061
*       MGPVARPT(3)=ADDR(MSGPTS);   /* SET 'SMPPTS' IN MSG           */
         LA    @15,@CC01993                                        1062
         ST    @15,MGPVARPT+8                                      1062
*       MGPVARPT(4)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */
         LA    @15,MSGSMDNM                                        1063
         ST    @15,MGPVARPT+12                                     1063
*     END;                                                         1064
*   IF MSGCODE1=HMA355I             /* MESSAGE ID = HMA355I          */
*     THEN                                                         1065
@RF01058 L     @15,@PC00021                                        1065
         CLI   MSGCODE1(@15),156                                   1065
         BNE   @RF01065                                            1065
*     DO;                                                          1066
*                                                                  1066
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA355I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1067
*       MGPVARPT(1)=ADDR(MSGMCS);   /* SET 'MCS' IN MSG              */
         LA    @15,@CC01991                                        1067
         ST    @15,MGPVARPT                                        1067
*       MGPVARPT(2)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */
         LA    @15,MSGSMDNM                                        1068
         ST    @15,MGPVARPT+4                                      1068
*       MGPVARPT(3)=ADDR(MSGPTS);   /* SET 'SMPPTS' IN MSG           */
         LA    @15,@CC01993                                        1069
         ST    @15,MGPVARPT+8                                      1069
*     END;                                                         1070
*   IF MSGCODE1=HMA370I             /* MESSAGE ID = HMA370I          */
*     THEN                                                         1071
@RF01065 L     @15,@PC00021                                        1071
         CLI   MSGCODE1(@15),171                                   1071
         BNE   @RF01071                                            1071
*     DO;                                                          1072
*                                                                  1072
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA370I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1073
*       MGPTYPE=MGPSEV;             /* SET TO STOP-FUNCTION ERROR    */
         MVI   MGPTYPE,X'04'                                       1073
*       MGPVARPT(1)=ADDR(TBLXFUNC); /* SMP FUNCTION (APPLY OR ACCEPT)*/
         L     @15,@PC00001                                        1074
         LA    @15,TBLXFUNC(,@15)                                  1074
         ST    @15,MGPVARPT                                        1074
*       MGPVARPT(2)=ADDR(MSGSMDNM); /* "CURRENT" SYSMOD-ID #         */
         LA    @15,MSGSMDNM                                        1075
         ST    @15,MGPVARPT+4                                      1075
*     END;                                                         1076
*   IF MSGCODE1=HMA375I             /* MESSAGE ID = HMA375I          */
*     THEN                                                         1077
@RF01071 L     @15,@PC00021                                        1077
         CLI   MSGCODE1(@15),176                                   1077
         BNE   @RF01077                                            1077
*     DO;                                                          1078
*                                                                  1078
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA375I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1079
*       MGPVARPT(1)=ADDR(VPART#1);  /* SYSMOD-ID                     */
         LA    @15,VPART#1                                         1079
         ST    @15,MGPVARPT                                        1079
*     END;                                                         1080
*   IF MSGCODE1=HMA374I             /* MESSAGE ID = HMA374I          */
*     THEN                                                         1081
@RF01077 L     @15,@PC00021                                        1081
         CLI   MSGCODE1(@15),175                                   1081
         BNE   @RF01081                                            1081
*     DO;                                                          1082
*                                                                  1082
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA374I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1083
*       MGPVARPT(1)=ADDR(VPART#1);  /* "FMID" × "PREREQ"             */
         LA    @15,VPART#1                                         1083
         ST    @15,MGPVARPT                                        1083
*       MGPVARPT(2)=ADDR(VPART#2);  /* FMID OR PREREQ SYSMOD-ID      */
         LA    @15,VPART#2                                         1084
         ST    @15,MGPVARPT+4                                      1084
*     END;                                                         1085
*   IF MSGCODE1=HMA405I             /* MESSAGE ID = HMA374I          */
*     THEN                                                         1086
@RF01081 L     @15,@PC00021                                        1086
         CLI   MSGCODE1(@15),206                                   1086
         BNE   @RF01086                                            1086
*     DO;                                                          1087
*                                                                  1087
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT HMA405I MESSAGE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1088
*       MGPVARPT(1)=ADDR(VPART#1);  /* ELEMENT TYPE                  */
         LA    @15,VPART#1                                         1088
         ST    @15,MGPVARPT                                        1088
*       MGPVARPT(2)=ADDR(VPART#2);  /* ELEMENT NAME                  */
         LA    @15,VPART#2                                         1089
         ST    @15,MGPVARPT+4                                      1089
*       MGPVARPT(3)=ADDR(VPART#3);  /* SYSMOD-ID                     */
         LA    @15,VPART#3                                         1090
         ST    @15,MGPVARPT+8                                      1090
*     END;                                                         1091
*   CALL HMASMMSG(HMASMMGP);                                       1092
*                                                                  1092
@RF01086 L     @15,@CV01888                                        1092
         LA    @01,@AL01092                                        1092
         BALR  @14,@15                                             1092
*   /*****************************************************************/
*   /*                                                               */
*   /* SET HIGHTMD RETURN CODE BASED UPON MGPTYPE                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1093
*   IF MGPTYPE=MGPWARN THEN                                        1093
         CLI   MGPTYPE,2                                           1093
         BNE   @RF01093                                            1093
*     HIGHTMD=MAX(HIGHTMD,PTFWARN); /* WARNING                       */
         L     @15,HIGHTMD                                         1094
         LA    @14,4                                               1094
         CR    @15,@14                                             1094
         BNL   *+6
         LR    @15,@14                                             1094
         ST    @15,HIGHTMD                                         1094
*   ELSE                                                           1095
*     IF MGPTYPE=MGPERR THEN                                       1095
         B     @RC01093                                            1095
@RF01093 CLI   MGPTYPE,3                                           1095
         BNE   @RF01095                                            1095
*       HIGHTMD=MAX(HIGHTMD,STOPPTF);/* STOP-SYSMOD                  */
         L     @15,HIGHTMD                                         1096
         LA    @14,8                                               1096
         CR    @15,@14                                             1096
         BNL   *+6
         LR    @15,@14                                             1096
         ST    @15,HIGHTMD                                         1096
*     ELSE                                                         1097
*       IF MGPTYPE=MGPSEV THEN                                     1097
         B     @RC01095                                            1097
@RF01095 CLI   MGPTYPE,4                                           1097
         BNE   @RF01097                                            1097
*         HIGHTMD=MAX(HIGHTMD,STOPFUNC);/* SEVERE                    */
         L     @15,HIGHTMD                                         1098
         LA    @14,12                                              1098
         CR    @15,@14                                             1098
         BNL   *+6
         LR    @15,@14                                             1098
         ST    @15,HIGHTMD                                         1098
*       ELSE                                                       1099
*         IF MGPTYPE=MGPTERM THEN                                  1099
         B     @RC01097                                            1099
@RF01097 CLI   MGPTYPE,5                                           1099
         BNE   @RF01099                                            1099
*           HIGHTMD=MAX(HIGHTMD,STOPSMP);/* TERMINATING              */
         L     @15,HIGHTMD                                         1100
         LA    @14,16                                              1100
         CR    @15,@14                                             1100
         BNL   *+6
         LR    @15,@14                                             1100
         ST    @15,HIGHTMD                                         1100
*   RETURN;                                                        1101
@EL00021 DS    0H                                                  1101
@EF00021 DS    0H                                                  1101
@ER00021 LM    @14,@12,@SA00021                                    1101
         BR    @14                                                 1101
*   END ERRMSG;                                                    1102
         B     @EL00021                                            1102
*                                                                  1103
*/********************************************************************/
*/*                                                                  */
*/*    INVALID  - FIND AND MARK NOGO ANY SYSMODS REMAINING IN THE    */
*/*               ICT WHICH ARE NOT PROCESSED ... BUT SHOULD HAVE    */
*/*               BEEN                                               */
*/*                                                                  */
*/*               THIS PROCEDURE WILL CATCH SYSMOD CONSTRUCTION      */
*/*               ERRORS OF THE FORM,                                */
*/*                                                                  */
*/*                 ++FUNCTION(F000000) .                            */
*/*                 ++VER(XXXX) PRE(P000000) .                       */
*/*                                                                  */
*/*                 ++PTF(P000000) .                                 */
*/*                 ++VER(XXXX) FMID(F000000) .                      */
*/*                                                                  */
*/*               ... A FUNCTION SYSMOD PREREQS ANOTHER SYSMOD       */
*/*               WHICH IN TURN NAMES THE FUNCTION AS ITS FMID.      */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1103
*INVALID:                                                          1103
*   PROC;                                                          1103
INVALID  STM   @14,@12,@SA00022                                    1103
*   DCL                                                            1104
*     IN FIXED(15);                 /* LOCAL INDEX - PTF SECT ENTRIES*/
*   RESPECIFY                                                      1105
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */
*                                                                  1105
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU THE ICT PTF SECTION                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1106
*   DO IN=1 BY 1 WHILE ICTPEND(IN)^=ICTENDNT/* NOT AT END            */
*         &HIGHTMD<STOPFUNC;        /* NOT TERMINATING               */
         LA    IN,1                                                1106
         B     @DE01106                                            1106
@DL01106 DS    0H                                                  1107
*     IF ICTPMSL(IN)=OFF            /* NOT PROCESSED                 */
*         &ICTPNOGO(IN)=OFF         /* NOT NOGO                      */
*         &ICTPGELM(IN)=OFF         /* NOT ELIMINATED                */
*         &ICTPSUPN(IN)<=0          /* NOT SUPERSEDED                */
*         &ICTPDEXP(IN)=OFF         /* NOT EXPLICITLY DELETED        */
*         &ICTPDIMP(IN)=OFF         /* NOT IMPLICITLY DELETED        */
*       THEN                                                       1107
         LR    @03,IN                                              1107
         MH    @03,@CH02382                                        1107
         L     @15,CCAICPTF(,CCAPTR)                               1107
         ST    @03,@TF00001                                        1107
         ALR   @03,@15                                             1107
         AL    @03,@CF02418                                        1107
         TM    ICTPMSL-15(@03),B'10000000'                         1107
         BNZ   @RF01107                                            1107
         LR    @03,@15                                             1107
         AL    @03,@TF00001                                        1107
         AL    @03,@CF02416                                        1107
         TM    ICTPNOGO-8(@03),B'01000000'                         1107
         BNZ   @RF01107                                            1107
         LR    @03,@15                                             1107
         AL    @03,@TF00001                                        1107
         AL    @03,@CF02415                                        1107
         TM    ICTPGELM-13(@03),B'00001000'                        1107
         BNZ   @RF01107                                            1107
         LR    @03,@15                                             1107
         AL    @03,@TF00001                                        1107
         AL    @03,@CF02443                                        1107
         CLC   ICTPSUPN-20(2,@03),@CH00083                         1107
         BH    @RF01107                                            1107
         LR    @03,@15                                             1107
         AL    @03,@TF00001                                        1107
         AL    @03,@CF02415                                        1107
         TM    ICTPDEXP-13(@03),B'00110000'                        1107
         BNZ   @RF01107                                            1107
*       DO;                                                        1108
*                                                                  1108
*         /***********************************************************/
*         /*                                                         */
*         /* A VALID SYSMOD FOUND WHICH HAS NOT BEEN PROCESSED ...   */
*         /* ISSUE: HMA226I MESSAGE ... MARK SYSMOD NOGO             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1109
*         MSGSMDNM=ICTPTFS(IN);     /* SET UP SYSMOD NAME FOR ERRMSG */
         AL    @15,@TF00001                                        1109
         AL    @15,@CF02417                                        1109
         MVC   MSGSMDNM(7),ICTPTFS(@15)                            1109
*         MGPTYPE=MGPERR;           /* STOP-SYSMOD ERROR             */
         MVI   MGPTYPE,X'03'                                       1110
*         CALL ERRMSG(HMA226I,PART011);                            1111
         LA    @01,@AL01111                                        1111
         BAL   @14,ERRMSG                                          1111
*         ICTPNOGO(IN)=ON;          /* SYSMOD IS NOGO                */
*         ICTPCPL(IN)=ON;           /* SYSMOD IS COMPLETE            */
*         ICTPMSG(IN)=ON;           /* NOGO MESSAGE HAS BEEN ISSUED  */
*                                                                  1114
         LR    @03,IN                                              1114
         MH    @03,@CH02382                                        1114
         L     @15,CCAICPTF(,CCAPTR)                               1114
         ST    @03,@TF00001                                        1114
         ALR   @03,@15                                             1114
         AL    @03,@CF02416                                        1114
         OI    ICTPNOGO-8(@03),B'01110000'                         1114
*         /***********************************************************/
*         /*                                                         */
*         /* LOOK AT REQUISITES TO SEE WHY SYSMOD WAS NOT PROCESSED  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1115
*         CALL INVMSG(ICTPTF(IN));  /* ISSUE MESSAGES CONCERNING   1115
*                                      UN-PROCESSED REQUISITES       */
         L     @03,@TF00001                                        1115
         AL    @15,@CF02417                                        1115
         LA    @03,ICTPTF(@03,@15)                                 1115
         ST    @03,@AL00001                                        1115
         LA    @01,@AL00001                                        1115
         BAL   @14,INVMSG                                          1115
*         IF ICTPTYPE(IN)=IOPPFUNC  /* FUNCTION-TYPE SYSMOD          */
*           THEN                                                   1116
         LR    @03,IN                                              1116
         MH    @03,@CH02382                                        1116
         L     @01,CCAICPTF(,CCAPTR)                               1116
         AL    @01,@CF02426                                        1116
         SLR   @00,@00                                             1116
         IC    @00,ICTPTYPE-17(@03,@01)                            1116
         CH    @00,@CH00040                                        1116
         BNE   @RF01116                                            1116
*           CALL ERRMSG(HMA370I,NOPART);/* ISSUE HMA370I             */
         LA    @01,@AL01117                                        1117
         BAL   @14,ERRMSG                                          1117
*         CALL HMASMTCR(TBLXPARM,MSG);/* CHECK REQUISITES            */
@RF01116 L     @03,@PC00001                                        1118
         ST    @03,@AL00001                                        1118
         LA    @03,@CC00717                                        1118
         ST    @03,@AL00001+4                                      1118
         L     @15,@CV01893                                        1118
         LA    @01,@AL00001                                        1118
         BALR  @14,@15                                             1118
*         RESPECIFY                                                1119
*           REG15 RSTD;                                            1119
*         HIGHTMD=MAX(HIGHTMD,REG15);                              1120
         L     @14,HIGHTMD                                         1120
         CR    @14,REG15                                           1120
         BNL   *+6
         LR    @14,REG15                                           1120
         ST    @14,HIGHTMD                                         1120
*         RESPECIFY                                                1121
*           REG15 UNRSTD;                                          1121
*       END;                                                       1122
*   END;                            /* END LOOP THRU ICT PTF SECT    */
@RF01107 AL    IN,@CF00065                                         1123
@DE01106 LR    @03,IN                                              1123
         MH    @03,@CH02382                                        1123
         L     @01,CCAICPTF(,CCAPTR)                               1123
         AL    @01,@CF02417                                        1123
         L     @03,ICTPEND(@03,@01)                                1123
         CL    @03,ICTENDNT                                        1123
         BE    @DC01106                                            1123
         L     @03,HIGHTMD                                         1123
         CH    @03,@CH00036                                        1123
         BL    @DL01106                                            1123
@DC01106 DS    0H                                                  1124
*   RETURN;                                                        1124
@EL00022 DS    0H                                                  1124
@EF00022 DS    0H                                                  1124
@ER00022 LM    @14,@12,@SA00022                                    1124
         BR    @14                                                 1124
*   END INVALID;                                                   1125
*                                                                  1126
*/********************************************************************/
*/*                                                                  */
*/*    INVMSG   - ISSUE MESSAGE HMA374I NAMING THE FMID AND PREREQS  */
*/*               OF A SYSMOD WHICH COULD NOT BE PROCESSED           */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1126
*INVMSG:                                                           1126
*   PROC(INVSYSMD);                                                1126
INVMSG   STM   @14,@12,@SA00023                                    1126
         MVC   @PC00023(4),0(@01)                                  1126
*   DCL                                                            1127
*     INVSYSMD CHAR(*);             /* ICT PTF SECT ENTRY            */
*   DCL                                                            1128
*     INV FIXED(15);                /* INDEX                         */
*   DCL                                                            1129
*     INVMSL CHAR(1);               /* LOCAL VARIABLE                */
*   RESPECIFY                                                      1130
*     ICTPTF BASED(ADDR(INVSYSMD)); /* ADDRESS PTF SECT ENTRY PASSED */
*                                                                  1130
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR ERRMSG                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1131
*   MGPTYPE=MGPINFO;                /* INFORMATIONAL MESSAGES        */
*                                                                  1131
         MVI   MGPTYPE,X'01'                                       1131
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF THE FMID IS UN-PROCESSED AND THEREBY PREVENTED THE     */
*   /* "CURRENT" SYSMOD FROM BEING PROCESSED                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1132
*   VPARTS=' ';                     /* BLANK VARIABLE PARTS          */
         MVI   VPARTS+1,C' '                                       1132
         MVC   VPARTS+2(22),VPARTS+1                               1132
         MVI   VPARTS,C' '                                         1132
*   VPART#1=MSGFMID;                /* PUT "FMID" IN MESSAGE         */
         MVC   VPART#1(8),@CC01999                                 1133
*   VPART#2=ICTPFMID(1);            /* FILL IN FMID SYSMOD-ID#       */
         MVI   VPART#2+7,C' '                                      1134
         L     @15,@PC00023                                        1134
         MVC   VPART#2(7),ICTPFMID(@15)                            1134
*   CALL MSLCHK(ICTPFMID(1),INVMSL);/* IS IT PROCESSED               */
         LA    @15,ICTPFMID(,@15)                                  1135
         ST    @15,@AL00001                                        1135
         LA    @15,INVMSL                                          1135
         ST    @15,@AL00001+4                                      1135
         LA    @01,@AL00001                                        1135
         BAL   @14,MSLCHK                                          1135
*   IF INVMSL=UNPROC THEN                                          1136
         CLI   INVMSL,C'U'                                         1136
         BNE   @RF01136                                            1136
*     CALL ERRMSG(HMA374I,NOPART);  /* ISSUE MESSAGE                 */
*                                                                  1137
         LA    @01,@AL01137                                        1137
         BAL   @14,ERRMSG                                          1137
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF THERE ARE ANY UN-PROCESSED PREREQS WHICH PREVENTED THE */
*   /* "CURRENT" SYSMOD FROM BEING PROCESSED                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1138
*   RESPECIFY                                                      1138
*     ICTPRELS BASED(ICTPPCHN(1));  /* ADDRESS PREREQ LIST FOR THIS
*                                      SYSMOD                        */
@RF01136 DS    0H                                                  1139
*   VPARTS=' ';                     /* BLANK VARIABLE PARTS          */
         MVI   VPARTS+1,C' '                                       1139
         MVC   VPARTS+2(22),VPARTS+1                               1139
         MVI   VPARTS,C' '                                         1139
*   VPART#1=MSGPRE;                 /* PUT "PREREQ" IN MESSAGE       */
         MVC   VPART#1(8),@CC01997                                 1140
*   DO INV=1 BY 1 WHILE ICTPREND(INV)^=ICTENDIX;                   1141
         LA    INV,1                                               1141
         B     @DE01141                                            1141
@DL01141 DS    0H                                                  1142
*     VPART#2=ICTPRENM(1);          /* FILL IN PREREQ SYSMOD-ID#     */
         MVI   VPART#2+7,C' '                                      1142
         L     @03,@PC00023                                        1142
         L     @03,ICTPPCHN(,@03)                                  1142
         MVC   VPART#2(7),ICTPRENM(@03)                            1142
*     CALL MSLCHK(ICTPRENM(1),INVMSL);/* IS IT PROCESSED             */
         ST    @03,@AL00001                                        1143
         LA    @03,INVMSL                                          1143
         ST    @03,@AL00001+4                                      1143
         LA    @01,@AL00001                                        1143
         BAL   @14,MSLCHK                                          1143
*     IF INVMSL=UNPROC THEN                                        1144
         CLI   INVMSL,C'U'                                         1144
         BNE   @RF01144                                            1144
*       CALL ERRMSG(HMA374I,NOPART);/* ISSUE MESSAGE                 */
         LA    @01,@AL01145                                        1145
         BAL   @14,ERRMSG                                          1145
*   END;                            /* END OF PREREQ LIST            */
@RF01144 AL    INV,@CF00065                                        1146
@DE01141 LR    @03,INV                                             1146
         SLA   @03,3                                               1146
         L     @15,@PC00023                                        1146
         L     @01,ICTPPCHN(,@15)                                  1146
         AL    @01,@CF02434                                        1146
         L     @03,ICTPREND(@03,@01)                               1146
         CL    @03,ICTENDIX                                        1146
         BNE   @DL01141                                            1146
*   RETURN;                                                        1147
@EL00023 DS    0H                                                  1147
@EF00023 DS    0H                                                  1147
@ER00023 LM    @14,@12,@SA00023                                    1147
         BR    @14                                                 1147
*   END INVMSG;                                                    1148
*                                                                  1149
*/********************************************************************/
*/*                                                                  */
*/*    MSLCHK   - RETURN AN INDICATION OF THE ELEMENT SELECTION      */
*/*               PROCESSING STATUS OF THE SYSMOD PASSED BY THE      */
*/*               CALLER.                                            */
*/*                                                                  */
*/*                                                                  */
*/*    RETURN IN PARAMETER "MSL":                                    */
*/*                                                                  */
*/*               'N' - NOT FOUND IN ICT.                            */
*/*                                                                  */
*/*               'U' - FOUND IN ICT BUT NOT NOT PROCESSED.          */
*/*                                                                  */
*/*               'P' - FOUND IN ICT AND PROCESSED.                  */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1149
*MSLCHK:                                                           1149
*   PROC(MSLSYSMD,MSL);                                            1149
MSLCHK   STM   @14,@12,12(@13)                                     1149
         MVC   @PC00024(8),0(@01)                                  1149
*   DCL                                                            1150
*     MSLSYSMD CHAR(7);             /* A SYSMOD NAME                 */
*   DCL                                                            1151
*     MSL CHAR(1);                  /* RETURN PARAMETER (SEE ABOVE)  */
*   DCL                                                            1152
*     LL FIXED(15);                 /* LOCAL INDEX ... ICT PTF SECT
*                                      ENTRIES                       */
*   RESPECIFY                                                      1153
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */
*                                                                  1153
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU THE ICT PTF SECTION                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1154
*   MSL=NOTFND;                     /* INITIALLY SET RETURN PARM TO
*                                      "NOT FOUND"                   */
         L     @15,@PC00024+4                                      1154
         MVI   MSL(@15),C'N'                                       1154
*   DO LL=1 BY 1 WHILE ICTPEND(LL)^=ICTENDNT&MSL=NOTFND;           1155
         LA    LL,1                                                1155
         B     @DE01155                                            1155
@DL01155 DS    0H                                                  1156
*     IF ICTPTFS(LL)=MSLSYSMD       /* SPECIFIED SYSMOD              */
*       THEN                                                       1156
         LR    @03,LL                                              1156
         MH    @03,@CH02382                                        1156
         L     @15,CCAICPTF(,CCAPTR)                               1156
         L     @14,@PC00024                                        1156
         ST    @03,@TF00001                                        1156
         ALR   @03,@15                                             1156
         AL    @03,@CF02417                                        1156
         CLC   ICTPTFS(7,@03),MSLSYSMD(@14)                        1156
         BNE   @RF01156                                            1156
*       DO;                                                        1157
*         IF ICTPMSL(LL)=ON         /* SYSMOD PROCESSED              */
*           THEN                                                   1158
         AL    @15,@TF00001                                        1158
         AL    @15,@CF02418                                        1158
         TM    ICTPMSL-15(@15),B'10000000'                         1158
         BNO   @RF01158                                            1158
*           MSL=PROCESSD;           /* RETURN PARM TO "PROCESSED"    */
         L     @03,@PC00024+4                                      1159
         MVI   MSL(@03),C'P'                                       1159
*         ELSE                                                     1160
*           MSL=UNPROC;             /* RETURN PARM TO "UNPROCESSED"  */
         B     @RC01158                                            1160
@RF01158 L     @03,@PC00024+4                                      1160
         MVI   MSL(@03),C'U'                                       1160
*       END;                                                       1161
@RC01158 DS    0H                                                  1162
*   END;                                                           1162
@RF01156 AL    LL,@CF00065                                         1162
@DE01155 LR    @03,LL                                              1162
         MH    @03,@CH02382                                        1162
         L     @01,CCAICPTF(,CCAPTR)                               1162
         AL    @01,@CF02417                                        1162
         L     @03,ICTPEND(@03,@01)                                1162
         CL    @03,ICTENDNT                                        1162
         BE    @DC01155                                            1162
         L     @03,@PC00024+4                                      1162
         CLI   MSL(@03),C'N'                                       1162
         BE    @DL01155                                            1162
@DC01155 DS    0H                                                  1163
*   RETURN;                                                        1163
@EL00024 DS    0H                                                  1163
@EF00024 DS    0H                                                  1163
@ER00024 LM    @14,@12,12(@13)                                     1163
         BR    @14                                                 1163
*   END MSLCHK;                                                    1164
*                                                                  1165
*/********************************************************************/
*/*                                                                  */
*/*    CHKASSEM - CHECK THE ASSEMBLY ENTRY PASSED TO SEE IF IT       */
*/*               SHOULD POTENTIALLY BE SELECTED                     */
*/*                                                                  */
*/*               AN ASSEMBLY ENTRY WHICH SHOULD POTENTIALLY BE      */
*/*               SELECTED IS ONE CREATED FOR A SELECTED ++SRC,      */
*/*               ++SRCUPD, ++MAC OR ++MACUPD ELEMENT.  NOTE THAT    */
*/*               IT IS POSSIBLE TO HAVE ASSEMBLY ENTRIES IN THE     */
*/*               ICT MOD SECTION WHICH WERE CREATED WHEN AN ELEMENT */
*/*               WAS PROCESSED BY HMASMTMS BUT WAS LATER MADE       */
*/*               INVALID BY A SYSMOD SPECIFYING THE DELETION OF     */
*/*               THE PREVIOUSLY PROCESSED ELEMENT.                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1165
*CHKASSEM:                                                         1165
*   PROC(ASMENTRY,CHKAPTR);                                        1165
CHKASSEM STM   @14,@12,12(@13)                                     1165
         MVC   @PC00025(8),0(@01)                                  1165
*   DCL                                                            1166
*     ASMENTRY CHAR(*);             /* MOD SECT ASSEMBLY ENTRY       */
*   DCL                                                            1167
*     CHKAPTR PTR(31);              /* PTR RETURNED TO CALLER ......
*                                      NON-ZERO => ASSEMBLY IS FOR A
*                                      SELECTED SRC/SRCUPD OR MACRO  */
*   DCL                                                            1168
*     IN3 FIXED(15);                /* INDEX                         */
*   DCL                                                            1169
*     IN4 FIXED(15);                /* INDEX                         */
*   RESPECIFY                                                      1170
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */
*   CHKAPTR=0;                      /* CLEAR PTR RETURNED TO CALLER  */
*                                                                  1171
         L     @15,@PC00025+4                                      1171
         SLR   @14,@14                                             1171
         ST    @14,CHKAPTR(,@15)                                   1171
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION AND EXAMINE SRC/SRCUPD AND MACRO      */
*   /* ENTRIES TO SEE IF A SELECTED ONE CAUSED THE CREATION OF THIS  */
*   /* ASSEMBLY ENTRY                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1172
*   DO IN3=1 BY 1 WHILE ICTMEND(IN3)^=ICTENDNT/* NOT AT END          */
*         &CHKAPTR=0;               /* NOT YET FOUND                 */
         LA    IN3,1                                               1172
         B     @DE01172                                            1172
@DL01172 DS    0H                                                  1173
*     RESPECIFY                                                    1173
*       ICTASMLS BASED(ICTMACHN(IN3));/* ADDRESS LIST OF ASSEMBLY  1173
*                                      ENTRY ADDRESSES               */
*     IF(ICTMSRCR(IN3)=ON           /* ++SRC - SRC REPLACEMENT       */
*         ×ICTMSRCU(IN3)=ON         /* ++SRCUPD - SRC UPDATE         */
*         ×ICTMMACR(IN3)=ON         /* ++MAC - MACRO REPLACEMENT     */
*         ×ICTMMACU(IN3)=ON)        /* ++MACUPD - MACRO UPDATE       */
*         &ICTMISEL(IN3)=ON         /* SELECTED                      */
*       THEN                                                       1174
         LR    @03,IN3                                             1174
         MH    @03,@CH02383                                        1174
         L     @15,CCAICMOD(,CCAPTR)                               1174
         ST    @03,@TF00001                                        1174
         ALR   @03,@15                                             1174
         AL    @03,@CF02420                                        1174
         TM    ICTMSRCR-9(@03),B'00001111'                         1174
         BZ    @RF01174                                            1174
         AL    @15,@TF00001                                        1174
         AL    @15,@CF02421                                        1174
         TM    ICTMISEL-11(@15),B'10000000'                        1174
         BNO   @RF01174                                            1174
*       DO;                                                        1175
*                                                                  1175
*         /***********************************************************/
*         /*                                                         */
*         /* GO THRU THE LIST OF ASSEMBLY ENTRIES CAUSED BY THIS     */
*         /* SELECTED SRC/SRCUPD/MACRO ELEMENT                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1176
*         DO IN4=1 BY 1 WHILE ICTASMND(IN4)^=ICTENDIX/* ^END         */
*               &CHKAPTR=0;         /* NOT YET FOUND                 */
         LA    IN4,1                                               1176
         B     @DE01176                                            1176
@DL01176 DS    0H                                                  1177
*           IF ICTASMAD(IN4)=ADDR(ASMENTRY)/* ASSEMBLY PASSED WAS  1177
*                                      CAUSED BY THIS ELEMENT        */
*             THEN                                                 1177
         LR    @15,IN4                                             1177
         SLA   @15,2                                               1177
         LR    @14,IN3                                             1177
         MH    @14,@CH02383                                        1177
         L     @07,CCAICMOD(,CCAPTR)                               1177
         LA    @01,0(@14,@07)                                      1177
         AL    @01,@CF02445                                        1177
         L     @01,ICTMACHN-112(,@01)                              1177
         L     @00,@PC00025                                        1177
         LR    @06,@00                                             1177
         AL    @01,@CF02424                                        1177
         C     @06,ICTASMAD(@15,@01)                               1177
         BNE   @RF01177                                            1177
*             CHKAPTR=ADDR(ICTMOD(IN3));/* SET PTR RETURNED TO CALLER*/
         L     @15,@PC00025+4                                      1178
         AL    @07,@CF02422                                        1178
         LA    @14,ICTMOD(@14,@07)                                 1178
         ST    @14,CHKAPTR(,@15)                                   1178
*         END;                      /* END OF LOOP THRU ASSEMBLY   1179
*                                      ENTRIES LIST                  */
@RF01177 AL    IN4,@CF00065                                        1179
@DE01176 LR    @15,IN4                                             1179
         SLA   @15,2                                               1179
         LR    @14,IN3                                             1179
         MH    @14,@CH02383                                        1179
         L     @01,CCAICMOD(,CCAPTR)                               1179
         AL    @01,@CF02445                                        1179
         L     @01,ICTMACHN-112(@14,@01)                           1179
         AL    @01,@CF02424                                        1179
         L     @15,ICTASMND(@15,@01)                               1179
         CL    @15,ICTENDIX                                        1179
         BE    @DC01176                                            1179
         L     @15,@PC00025+4                                      1179
         ICM   @14,15,CHKAPTR(@15)                                 1179
         BZ    @DL01176                                            1179
@DC01176 DS    0H                                                  1180
*       END;                        /* END OF LOOP THRU ICT MOD    1180
*                                      SECTION                       */
*   END;                                                           1181
@RF01174 AL    IN3,@CF00065                                        1181
@DE01172 LR    @03,IN3                                             1181
         MH    @03,@CH02383                                        1181
         L     @01,CCAICMOD(,CCAPTR)                               1181
         AL    @01,@CF02422                                        1181
         L     @03,ICTMEND(@03,@01)                                1181
         CL    @03,ICTENDNT                                        1181
         BE    @DC01172                                            1181
         L     @03,@PC00025+4                                      1181
         ICM   @15,15,CHKAPTR(@03)                                 1181
         BZ    @DL01172                                            1181
@DC01172 DS    0H                                                  1182
*   RETURN;                                                        1182
@EL00025 DS    0H                                                  1182
@EF00025 DS    0H                                                  1182
@ER00025 LM    @14,@12,12(@13)                                     1182
         BR    @14                                                 1182
*   END CHKASSEM;                                                  1183
*                                                                  1184
*/********************************************************************/
*/*                                                                  */
*/*    SRCHMOD  - FIND A SELECTED ++MOD REPLACEMENT-TYPE MOD SECT    */
*/*               ENTRY FOR THE CALLER-SPECIFIED ELEMENT NAME        */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1184
*SRCHMOD:                                                          1184
*   PROC(SRCHMN,SRCHMP);                                           1184
SRCHMOD  STM   @14,@12,12(@13)                                     1184
         MVC   @PC00026(8),0(@01)                                  1184
*   DCL                                                            1185
*     SRCHMN CHAR(8);               /* ELEMENT NAME                  */
*   DCL                                                            1186
*     SRCHMP PTR(31);               /* PTR RETURNED TO CALLER ......
*                                      NON-ZERO => POINTS TO SELECTED
*                                      MOD REPL ENTRY IN ICT         */
*   DCL                                                            1187
*     IN5 FIXED(15);                /* INDEX                         */
*   RESPECIFY                                                      1188
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */
*   SRCHMP=0;                       /* CLEAR PTR RETURNED TO CALLER  */
*                                                                  1189
         L     @15,@PC00026+4                                      1189
         SLR   @14,@14                                             1189
         ST    @14,SRCHMP(,@15)                                    1189
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1190
*   DO IN5=1 BY 1 WHILE ICTMEND(IN5)^=ICTENDNT/* NOT AT END          */
*         &SRCHMP=0;                /* NOT YET FOUND                 */
         LA    IN5,1                                               1190
         B     @DE01190                                            1190
@DL01190 DS    0H                                                  1191
*     IF ICTMNAME(IN5)=SRCHMN       /* ELEMENT NAMES THE SAME        */
*         &ICTMMOD(IN5)=ON          /* MOD REPLACEMENT ENTRY         */
*         &ICTMASM(IN5)=OFF         /* NOT ASSEMBLY ENTRY            */
*         &ICTMISEL(IN5)=ON         /* SELECTED                      */
*       THEN                                                       1191
         LR    @03,IN5                                             1191
         MH    @03,@CH02383                                        1191
         L     @15,CCAICMOD(,CCAPTR)                               1191
         L     @14,@PC00026                                        1191
         ST    @03,@TF00001                                        1191
         ALR   @03,@15                                             1191
         AL    @03,@CF02422                                        1191
         CLC   ICTMNAME(8,@03),SRCHMN(@14)                         1191
         BNE   @RF01191                                            1191
         LR    @03,@15                                             1191
         AL    @03,@TF00001                                        1191
         AL    @03,@CF02420                                        1191
         TM    ICTMMOD-9(@03),B'10000000'                          1191
         BNO   @RF01191                                            1191
         TM    ICTMASM-9(@03),B'01000000'                          1191
         BNZ   @RF01191                                            1191
         LR    @03,@15                                             1191
         AL    @03,@TF00001                                        1191
         AL    @03,@CF02421                                        1191
         TM    ICTMISEL-11(@03),B'10000000'                        1191
         BNO   @RF01191                                            1191
*       SRCHMP=ADDR(ICTMOD(IN5));   /* RETURN PTR TO CALLER          */
         L     @03,@PC00026+4                                      1192
         L     @14,@TF00001                                        1192
         AL    @15,@CF02422                                        1192
         LA    @15,ICTMOD(@14,@15)                                 1192
         ST    @15,SRCHMP(,@03)                                    1192
*   END;                                                           1193
@RF01191 AL    IN5,@CF00065                                        1193
@DE01190 LR    @03,IN5                                             1193
         MH    @03,@CH02383                                        1193
         L     @01,CCAICMOD(,CCAPTR)                               1193
         AL    @01,@CF02422                                        1193
         L     @03,ICTMEND(@03,@01)                                1193
         CL    @03,ICTENDNT                                        1193
         BE    @DC01190                                            1193
         L     @03,@PC00026+4                                      1193
         ICM   @15,15,SRCHMP(@03)                                  1193
         BZ    @DL01190                                            1193
@DC01190 DS    0H                                                  1194
*   RETURN;                                                        1194
@EL00026 DS    0H                                                  1194
@EF00026 DS    0H                                                  1194
@ER00026 LM    @14,@12,12(@13)                                     1194
         BR    @14                                                 1194
*   END SRCHMOD;                                                   1195
*                                                                  1196
*/********************************************************************/
*/*                                                                  */
*/*    ELIMASM  - ELIMINATE ANY SELECTED ASSEMBLY ENTRIES IN THE ICT */
*/*               MOD SECTION WHICH CALL FOR THE ASSEMBLY OF THE     */
*/*               SAME ELEMENT AS THE ENTRY PASSED.                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1196
*ELIMASM:                                                          1196
*   PROC(ELIMASME);                                                1196
ELIMASM  STM   @14,@12,12(@13)                                     1196
         MVC   @PC00027(4),0(@01)                                  1196
*   DCL                                                            1197
*     ELIMASME CHAR(*);             /* ASSEMBLY ENTRY                */
*   DCL                                                            1198
*     ELIMASMN CHAR(8);             /* ASSEMBLY ELEMENT NAME         */
*   DCL                                                            1199
*     IN6 FIXED(15);                /* INDEX                         */
*   RESPECIFY                                                      1200
*     ICTMOD BASED(ADDR(ELIMASME)); /* ADDRESS MOD ENTRY PASSED      */
*   ELIMASMN=ICTMNAME(1);           /* SAVE ASSEMBLY ELEMENT NAME    */
         L     @15,@PC00027                                        1201
         MVC   ELIMASMN(8),ICTMNAME(@15)                           1201
*   RESPECIFY                                                      1202
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */
*                                                                  1203
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1203
*   DO IN6=1 BY 1 WHILE ICTMEND(IN6)^=ICTENDNT;/* NOT AT END         */
         LA    IN6,1                                               1203
         B     @DE01203                                            1203
@DL01203 DS    0H                                                  1204
*     IF ICTMNAME(IN6)=ELIMASMN     /* ELEMENT NAMES THE SAME        */
*         &ICTMMOD(IN6)=ON          /* MOD REPLACEMENT ENTRY         */
*         &ICTMASM(IN6)=ON          /* ASSEMBLY ENTRY                */
*         &ICTMISEL(IN6)=ON         /* SELECTED                      */
*         &ADDR(ICTMOD(IN6))^=ADDR(ELIMASME)/* NOT ENTRY PASSED      */
*       THEN                                                       1204
         LR    @03,IN6                                             1204
         MH    @03,@CH02383                                        1204
         L     @15,CCAICMOD(,CCAPTR)                               1204
         ST    @03,@TF00001                                        1204
         ALR   @03,@15                                             1204
         AL    @03,@CF02422                                        1204
         CLC   ICTMNAME(8,@03),ELIMASMN                            1204
         BNE   @RF01204                                            1204
         LR    @03,@15                                             1204
         AL    @03,@TF00001                                        1204
         AL    @03,@CF02420                                        1204
         TM    ICTMMOD-9(@03),B'11000000'                          1204
         BNO   @RF01204                                            1204
         LR    @03,@15                                             1204
         AL    @03,@TF00001                                        1204
         AL    @03,@CF02421                                        1204
         TM    ICTMISEL-11(@03),B'10000000'                        1204
         BNO   @RF01204                                            1204
         L     @03,@TF00001                                        1204
         AL    @03,@CF02422                                        1204
         LA    @03,ICTMOD(@03,@15)                                 1204
         L     @14,@PC00027                                        1204
         CR    @03,@14                                             1204
         BE    @RF01204                                            1204
*       DO;                                                        1205
*         ICTMSELM(IN6)=ON;         /* SET ELIMINATED FLAG           */
*         ICTMISEL(IN6)=OFF;        /* CLEAR SELECTED FLAG           */
         AL    @15,@TF00001                                        1207
         AL    @15,@CF02421                                        1207
         OI    ICTMSELM-11(@15),B'00100000'                        1207
         NI    ICTMISEL-11(@15),B'01111111'                        1207
*       END;                                                       1208
*   END;                                                           1209
@RF01204 AL    IN6,@CF00065                                        1209
@DE01203 LR    @03,IN6                                             1209
         MH    @03,@CH02383                                        1209
         L     @01,CCAICMOD(,CCAPTR)                               1209
         AL    @01,@CF02422                                        1209
         L     @03,ICTMEND(@03,@01)                                1209
         CL    @03,ICTENDNT                                        1209
         BNE   @DL01203                                            1209
*   RETURN;                                                        1210
@EL00027 DS    0H                                                  1210
@EF00027 DS    0H                                                  1210
@ER00027 LM    @14,@12,12(@13)                                     1210
         BR    @14                                                 1210
*   END ELIMASM;                                                   1211
*                                                                  1212
*/********************************************************************/
*/*                                                                  */
*/*    RMODICT  - LOOK FOR A REPLACEMENT VERSION OF AN ELEMENT IN    */
*/*               THE ICT MOD SECTION                                */
*/*                                                                  */
*/*             - PASSED ELEMENT-NAME AND IOPPIND-VALUE ELEMENT-TYPE */
*/*                                                                  */
*/*             - IOPPIND-VALUE     TYPE OF ICT MOD ENTRY RETURNED   */
*/*                 PASSED                                           */
*/*                                                                  */
*/*               --------------    -------------------------------- */
*/*                                                                  */
*/*                IOPPMOD          MOD REPLACEMENT (ICTMMOD=ON)     */
*/*                IOPPMAC          MAC REPLACEMENT (ICTMMACR=ON)    */
*/*                IOPPMACU         MAC REPLACEMENT (ICTMMACR=ON)    */
*/*                IOPPSRC          SRC REPLACEMENT (ICTMSRCR=ON)    */
*/*                IOPPSRCU         SRC REPLACEMENT (ICTMSRCR=ON)    */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*     *                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1212
*RMODICT:                                                          1212
*   PROC(ELMNNAME,ELMNTYPE,ELMNPTR);                               1212
RMODICT  STM   @14,@12,12(@13)                                     1212
         MVC   @PC00028(12),0(@01)                                 1212
*   DCL                                                            1213
*     ELMNNAME CHAR(8);             /* ELEMENT NAME TO BE FOUND      */
*   DCL                                                            1214
*     ELMNTYPE FIXED(8);            /* ELEMENT TYPE - IOPPIND VALUES */
*   DCL                                                            1215
*     ELMNPTR PTR(31);              /* RETURNS PTR TO ICT MOD SECT 1215
*                                      ENTRY (IF FOUND) ............
*                                      RETRUNS 0 IF ENTRY NOT FOUND  */
*   DCL                                                            1216
*     MJ FIXED(15);                 /* INDEX - MOD SECT ENTRIES      */
*   DCL                                                            1217
*     ETSTTYPE FIXED(8);            /* LOCAL VARIABLE - NON-REGRESSED
*                                      IOPPIND VALUE                 */
*   RESPECIFY                                                      1218
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECT       */
*   ELMNPTR=0;                      /* CLEAR PTR RETURNED TO CALLER  */
         L     @15,@PC00028+8                                      1219
         SLR   @14,@14                                             1219
         ST    @14,ELMNPTR(,@15)                                   1219
*   IF ELMNTYPE>=IOPPREG            /* REGRESSED IOPPIND VALUE       */
*     THEN                                                         1220
         L     @15,@PC00028+4                                      1220
         CLI   ELMNTYPE(@15),80                                    1220
         BL    @RF01220                                            1220
*     ETSTTYPE=ELMNTYPE-IOPPREG;    /* CONVERT TO NON-REGRESSED VALUE*/
         SLR   ETSTTYPE,ETSTTYPE                                   1221
         IC    ETSTTYPE,ELMNTYPE(,@15)                             1221
         SH    ETSTTYPE,@CH00469                                   1221
*   ELSE                                                           1222
*     ETSTTYPE=ELMNTYPE;            /* NO CONVERSION NECESSARY       */
         B     @RC01220                                            1222
@RF01220 L     @15,@PC00028+4                                      1222
         SLR   ETSTTYPE,ETSTTYPE                                   1222
         IC    ETSTTYPE,ELMNTYPE(,@15)                             1222
*                                                                  1223
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1223
*   DO MJ=1 BY 1 WHILE ICTMEND(MJ)^=ICTENDNT/* NOT AT END            */
*         &ELMNPTR=0;               /* NOT YET FOUND                 */
@RC01220 LA    MJ,1                                                1223
         B     @DE01223                                            1223
@DL01223 DS    0H                                                  1224
*     IF ICTMNAME(MJ)=ELMNNAME      /* MATCHES ELEMENT NAME PASSED   */
*       THEN                                                       1224
         LR    @15,MJ                                              1224
         MH    @15,@CH02383                                        1224
         L     @14,CCAICMOD(,CCAPTR)                               1224
         L     @07,@PC00028                                        1224
         ST    @15,@TF00001                                        1224
         ALR   @15,@14                                             1224
         AL    @15,@CF02422                                        1224
         CLC   ICTMNAME(8,@15),ELMNNAME(@07)                       1224
         BNE   @RF01224                                            1224
*       DO;                                                        1225
*         IF ETSTTYPE=IOPPMOD       /* LOOKING FOR ++MOD TYPE        */
*             &ICTMMOD(MJ)=ON       /* ICT MOD SECT MOD ENTRY        */
*             &ICTMASM(MJ)=OFF      /* NOT ASSEM ENTRY               */
*           THEN                                                   1226
         CH    ETSTTYPE,@CH00065                                   1226
         BNE   @RF01226                                            1226
         LR    @15,@14                                             1226
         AL    @15,@TF00001                                        1226
         AL    @15,@CF02420                                        1226
         TM    ICTMMOD-9(@15),B'10000000'                          1226
         BNO   @RF01226                                            1226
         TM    ICTMASM-9(@15),B'01000000'                          1226
         BNZ   @RF01226                                            1226
*           ELMNPTR=ADDR(ICTMOD(MJ));/* ICT MOD ENTRY FOUND          */
         L     @15,@PC00028+8                                      1227
         L     @01,@TF00001                                        1227
         AL    @14,@CF02422                                        1227
         LA    @14,ICTMOD(@01,@14)                                 1227
         ST    @14,ELMNPTR(,@15)                                   1227
*         IF(ETSTTYPE=IOPPMACR      /* LOOKING FOR ++MAC TYPE        */
*             ×ETSTTYPE=IOPPMACU)   /* LOOKING FOR ++MACUPD TYPE     */
*             &ICTMMACR(MJ)=ON      /* ICT MOD SECT MAC ENTRY        */
*           THEN                                                   1228
@RF01226 CH    ETSTTYPE,@CH00040                                   1228
         BE    @GL00078                                            1228
         CH    ETSTTYPE,@CH00103                                   1228
         BNE   @RF01228                                            1228
@GL00078 LR    @15,MJ                                              1228
         MH    @15,@CH02383                                        1228
         L     @14,CCAICMOD(,CCAPTR)                               1228
         ST    @15,@TF00001                                        1228
         ALR   @15,@14                                             1228
         AL    @15,@CF02420                                        1228
         TM    ICTMMACR-9(@15),B'00001000'                         1228
         BNO   @RF01228                                            1228
*           ELMNPTR=ADDR(ICTMOD(MJ));/* ICT MOD ENTRY FOUND          */
         L     @15,@PC00028+8                                      1229
         L     @01,@TF00001                                        1229
         AL    @14,@CF02422                                        1229
         LA    @14,ICTMOD(@01,@14)                                 1229
         ST    @14,ELMNPTR(,@15)                                   1229
*         IF(ETSTTYPE=IOPPSRCR      /* LOOKING FOR ++SRC TYPE        */
*             ×ETSTTYPE=IOPPSRCU)   /* LOOKING FOR ++SRCUPD TYPE     */
*             &ICTMSRCR(MJ)=ON      /* ICT MOD SECT SRC ENTRY        */
*           THEN                                                   1230
@RF01228 CH    ETSTTYPE,@CH00289                                   1230
         BE    @GL00080                                            1230
         CH    ETSTTYPE,@CH00067                                   1230
         BNE   @RF01230                                            1230
@GL00080 LR    @15,MJ                                              1230
         MH    @15,@CH02383                                        1230
         L     @14,CCAICMOD(,CCAPTR)                               1230
         ST    @15,@TF00001                                        1230
         ALR   @15,@14                                             1230
         AL    @15,@CF02420                                        1230
         TM    ICTMSRCR-9(@15),B'00000010'                         1230
         BNO   @RF01230                                            1230
*           ELMNPTR=ADDR(ICTMOD(MJ));/* ICT MOD ENTRY FOUND          */
         L     @15,@PC00028+8                                      1231
         L     @01,@TF00001                                        1231
         AL    @14,@CF02422                                        1231
         LA    @14,ICTMOD(@01,@14)                                 1231
         ST    @14,ELMNPTR(,@15)                                   1231
*       END;                                                       1232
@RF01230 DS    0H                                                  1233
*   END;                                                           1233
@RF01224 AL    MJ,@CF00065                                         1233
@DE01223 LR    @15,MJ                                              1233
         MH    @15,@CH02383                                        1233
         L     @01,CCAICMOD(,CCAPTR)                               1233
         AL    @01,@CF02422                                        1233
         L     @15,ICTMEND(@15,@01)                                1233
         CL    @15,ICTENDNT                                        1233
         BE    @DC01223                                            1233
         L     @15,@PC00028+8                                      1233
         ICM   @14,15,ELMNPTR(@15)                                 1233
         BZ    @DL01223                                            1233
@DC01223 DS    0H                                                  1234
*   RETURN;                                                        1234
@EL00028 DS    0H                                                  1234
@EF00028 DS    0H                                                  1234
@ER00028 LM    @14,@12,12(@13)                                     1234
         BR    @14                                                 1234
*   END RMODICT;                                                   1235
*                                                                  1236
*/********************************************************************/
*/*                                                                  */
*/*    ELMTYPE  - DETERMINE ELEMENT TYPE FROM ICTMFLG1               */
*/*                                                                  */
*/*               THE CALLER'S PARAMETER IS SET TO A PRINTABLE       */
*/*               EBCDIC CHARACTER STRING CORRESPONDING TO THE       */
*/*               THE ICT MOD SECTION ENTRY ELEMENT TYPE             */
*/*                                                                  */
*/********************************************************************/
*                                                                  1236
*ELMTYPE:                                                          1236
*   PROC(ELMENTRY,ETEBCDIC);                                       1236
ELMTYPE  STM   @14,@12,12(@13)                                     1236
         MVC   @PC00029(8),0(@01)                                  1236
*   DCL                                                            1237
*     ELMENTRY CHAR(*);             /* ICT MOD SECTION ENTRY         */
*   DCL                                                            1238
*     ETEBCDIC CHAR(8);             /* PRINTABLE EBCDIC ELEMENT TYPE */
*   RESPECIFY                                                      1239
*     ICTMOD BASED(ADDR(ELMENTRY)); /* ADDRESS MOD ENTRY PASSED      */
*   ETEBCDIC=' ';                   /* BLANK TYPE RETURNED TO CALLER */
         L     @15,@PC00029+4                                      1240
         MVI   ETEBCDIC+1(@15),C' '                                1240
         MVC   ETEBCDIC+2(6,@15),ETEBCDIC+1(@15)                   1240
         MVI   ETEBCDIC(@15),C' '                                  1240
*   IF ICTMMOD(1)=ON                /* MOD ENTRY                     */
*     THEN                                                         1241
         L     @14,@PC00029                                        1241
         TM    ICTMMOD(@14),B'10000000'                            1241
         BNO   @RF01241                                            1241
*     ETEBCDIC=MSGMOD;              /* ++MOD TYPE ENTRY              */
         MVC   ETEBCDIC(8,@15),@CC02001                            1242
*   IF ICTMMACR(1)=ON               /* MACRO ENTRY                   */
*     THEN                                                         1243
@RF01241 L     @15,@PC00029                                        1243
         TM    ICTMMACR(@15),B'00001000'                           1243
         BNO   @RF01243                                            1243
*     ETEBCDIC=MSGMAC;              /* ++MAC TYPE ENTRY              */
         L     @15,@PC00029+4                                      1244
         MVC   ETEBCDIC(8,@15),@CC02003                            1244
*   IF ICTMMACU(1)=ON               /* MACRO UPDATE ENTRY            */
*     THEN                                                         1245
@RF01243 L     @15,@PC00029                                        1245
         TM    ICTMMACU(@15),B'00000100'                           1245
         BNO   @RF01245                                            1245
*     ETEBCDIC=MSGMACU;             /* ++MACUPD TYPE ENTRY           */
         L     @15,@PC00029+4                                      1246
         MVC   ETEBCDIC(8,@15),@CC02009                            1246
*   IF ICTMSRCR(1)=ON               /* SOURCE ENTRY                  */
*     THEN                                                         1247
@RF01245 L     @15,@PC00029                                        1247
         TM    ICTMSRCR(@15),B'00000010'                           1247
         BNO   @RF01247                                            1247
*     ETEBCDIC=MSGSRC;              /* ++SRC TYPE ENTRY              */
         L     @15,@PC00029+4                                      1248
         MVC   ETEBCDIC(8,@15),@CC02005                            1248
*   IF ICTMSRCU(1)=ON               /* SOURCE UPDATE ENTRY           */
*     THEN                                                         1249
@RF01247 L     @15,@PC00029                                        1249
         TM    ICTMSRCU(@15),B'00000001'                           1249
         BNO   @RF01249                                            1249
*     ETEBCDIC=MSGSRCU;             /* ++SRCUPD TYPE ENTRY           */
         L     @15,@PC00029+4                                      1250
         MVC   ETEBCDIC(8,@15),@CC02011                            1250
*   RETURN;                                                        1251
@EL00029 DS    0H                                                  1251
@EF00029 DS    0H                                                  1251
@ER00029 LM    @14,@12,12(@13)                                     1251
         BR    @14                                                 1251
*   END ELMTYPE;                                                   1252
         B     @EL00029                                            1252
*                                                                  1253
*/********************************************************************/
*/*                                                                  */
*/*    INITICTM - INITIALIZE ICT MOD SECTION ENTRY FROM DATA IN      */
*/*               CDS ENTRY IOP                                      */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1253
*INITICTM:                                                         1253
*   PROC(IIOPTR,IMODENT);                                          1253
INITICTM STM   @14,@12,@SA00030                                    1253
         MVC   @PC00030(8),0(@01)                                  1253
*   DCL                                                            1254
*     IIOPTR PTR(31);               /* PTR TO CDS ELEMENT ENTRY IOP  */
*   DCL                                                            1255
*     IMODENT CHAR(*);              /* ICT MOD ENTRY TO INITIALIZE   */
*   DCL                                                            1256
*     INI FIXED(15);                /* INDEX - IOP VARIABLE ARRAY    */
*   DCL                                                            1257
*     INITIRC FIXED(31);            /* LOCAL RETURN CODE             */
*   RESPECIFY                                                      1258
*     HMASMIOP BASED(IIOPTR);       /* ADDRESS IOP PASSED            */
*   RESPECIFY                                                      1259
*     ICTMOD BASED(ADDR(IMODENT));  /* ADDRESS ICT ENTRY PASSD       */
*   INITIRC=0;                      /* CLEAR LOCAL RETURN CODE       */
         SLR   INITIRC,INITIRC                                     1260
*   IF IOPTYPE=IOPMOD               /* ++MOD TYPE CDS IOP            */
*     THEN                                                         1261
         L     @02,@PC00030                                        1261
         L     @02,IIOPTR(,@02)                                    1261
         CLI   IOPTYPE(@02),5                                      1261
         BNE   @RF01261                                            1261
*     DO;                                                          1262
*                                                                  1262
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE ++MOD ICT MOD SECTION ENTRY                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1263
*       ICTMDSTL(1)=IOPDLIB;        /* DLIB                          */
         L     @15,@PC00030+4                                      1263
         MVC   ICTMDSTL(8,@15),IOPDLIB(@02)                        1263
*       ICTMSYSL(1)='        ';     /* SYSLIB - N/A FOR MODS         */
         MVC   ICTMSYSL(8,@15),@CC01946                            1264
*       ICTMTCHN(1)=0;              /* CLEAR PTR TO ICT ALIAS LIST   */
*                                                                  1265
         SLR   @02,@02                                             1265
         ST    @02,ICTMTCHN(,@15)                                  1265
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU IOP VARIABLE ARRAY FOR ALIAS ENTRIES              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1266
*       DO INI=1 BY 1 WHILE IOPMODND(INI)^=IOPEOLST/* NOT AT END     */
*             &INITIRC=0;           /* NO ERRORS                     */
         LA    INI,1                                               1266
         B     @DE01266                                            1266
@DL01266 DS    0H                                                  1267
*         IF IOPMDIND(INI)=IOPMDTAL /* TALIAS NAME                   */
*             ×IOPMDIND(INI)=IOPMDDAL/* DALIAS NAME                  */
*           THEN                                                   1267
         LR    @15,INI                                             1267
         MH    @15,@CH00034                                        1267
         L     @14,@PC00030                                        1267
         L     @01,IIOPTR(,@14)                                    1267
         SLR   @14,@14                                             1267
         IC    @14,IOPMDIND-9(@15,@01)                             1267
         CH    @14,@CH00273                                        1267
         BE    @RT01267                                            1267
         CH    @14,@CH00088                                        1267
         BNE   @RF01267                                            1267
@RT01267 DS    0H                                                  1268
*           DO;                                                    1268
*                                                                  1268
*             /*******************************************************/
*             /*                                                     */
*             /* PUT ALIAS INTO ICT ALIAS LIST                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1269
*             CALL HMASMTAI(TBLXPARM,/* TBLX PARMS                   */
*                 ICTMTCHN(1),      /* ALIAS LIST CHAIN ANCHOR       */
*                 ADDR(IOPLMODS(INI)),/* ALIAS NAME                  */
*                 LENGTH(ICTTALNM));/* LENGTH OF ICT INDEX ENTRY     */
         L     @15,@PC00001                                        1269
         ST    @15,@AL00001                                        1269
         L     @15,@PC00030+4                                      1269
         LA    @15,ICTMTCHN(,@15)                                  1269
         ST    @15,@AL00001+4                                      1269
         LR    @15,INI                                             1269
         MH    @15,@CH00034                                        1269
         L     @14,@PC00030                                        1269
         L     @01,IIOPTR(,@14)                                    1269
         LA    @15,IOPLMODS-9(@15,@01)                             1269
         ST    @15,@TF00001                                        1269
         LA    @15,@TF00001                                        1269
         ST    @15,@AL00001+8                                      1269
         LA    @15,@CF00033                                        1269
         ST    @15,@AL00001+12                                     1269
         L     @15,@CV01892                                        1269
         LA    @01,@AL00001                                        1269
         BALR  @14,@15                                             1269
*             RESPECIFY                                            1270
*               REG15 RSTD;                                        1270
*             INITIRC=MAX(INITIRC,REG15);                          1271
         CR    INITIRC,REG15                                       1271
         BNL   *+6
         LR    INITIRC,REG15                                       1271
*             RESPECIFY                                            1272
*               REG15 UNRSTD;                                      1272
*           END;                                                   1273
*       END;                                                       1274
@RF01267 AL    INI,@CF00065                                        1274
@DE01266 LR    @15,INI                                             1274
         MH    @15,@CH00034                                        1274
         L     @14,@PC00030                                        1274
         L     @01,IIOPTR(,@14)                                    1274
         SLR   @14,@14                                             1274
         IC    @14,IOPMODND-9(@15,@01)                             1274
         CH    @14,@CH00765                                        1274
         BE    @DC01266                                            1274
         LTR   INITIRC,INITIRC                                     1274
         BZ    @DL01266                                            1274
@DC01266 DS    0H                                                  1275
*       IF ICTMTCHN(1)=0            /* NO ALIASES PUT IN LIST        */
*         THEN                                                     1275
         L     @02,@PC00030+4                                      1275
         ICM   @15,15,ICTMTCHN(@02)                                1275
         BNZ   @RF01275                                            1275
*         ICTMTCHN(1)=TBLXNULL;     /* POINT TO EMPTY LIST           */
         L     @15,@PC00001                                        1276
         MVC   ICTMTCHN(4,@02),TBLXNULL(@15)                       1276
*     END;                                                         1277
@RF01275 DS    0H                                                  1278
*   IF IOPTYPE=IOPMAC               /* ++MAC TYPE CDS IOP            */
*     THEN                                                         1278
@RF01261 L     @02,@PC00030                                        1278
         L     @02,IIOPTR(,@02)                                    1278
         CLI   IOPTYPE(@02),3                                      1278
         BNE   @RF01278                                            1278
*     DO;                                                          1279
*                                                                  1279
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE ++MAC ICT MOD SECTION ENTRY                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1280
*       ICTTOLIB(1)=BLANKDDN;       /* BLANK TARGET LIBRARY DDNAME   */
         L     @15,@PC00030+4                                      1280
         MVC   ICTTOLIB(8,@15),@CC01946                            1280
*       ICTMDSTL(1)=IOPMCDLB;       /* DLIB                          */
         MVC   ICTMDSTL(8,@15),IOPMCDLB(@02)                       1281
*       ICTMSYSL(1)=IOPMCSYS;       /* SYSLIB                        */
         MVC   ICTMSYSL(8,@15),IOPMCSYS(@02)                       1282
*       IF CCAACCPT=ON              /* ACCEPT PROCESSING             */
*         THEN                                                     1283
         TM    CCAACCPT(CCAPTR),B'00100000'                        1283
         BNO   @RF01283                                            1283
*         ICTTOLIB(1)=ICTMDSTL(1);  /* TARGET LIBRARY IS DLIB        */
         MVC   ICTTOLIB(8,@15),ICTMDSTL(@15)                       1284
*       ELSE                                                       1285
*         IF ICTMSYSL(1)=BLANKDDN   /* NO APPLY TARGET LIBRARY       */
*           THEN                                                   1285
         B     @RC01283                                            1285
@RF01283 L     @02,@PC00030+4                                      1285
         CLC   ICTMSYSL(8,@02),@CC01946                            1285
         BNE   @RF01285                                            1285
*           ICTTOLIB(1)=SMPMTS;     /* TARGET LIBRARY IS "SMPMTS"    */
         MVC   ICTTOLIB(8,@02),@CC01969                            1286
*         ELSE                                                     1287
*           ICTTOLIB(1)=ICTMSYSL(1);/* TARGET LIBRARY IS SYSLIB      */
         B     @RC01285                                            1287
@RF01285 L     @02,@PC00030+4                                      1287
         MVC   ICTTOLIB(8,@02),ICTMSYSL(@02)                       1287
*       ICTMTCHN(1)=0;              /* CLEAR PTR TO ICT ALIAS LIST   */
*                                                                  1288
@RC01285 DS    0H                                                  1288
@RC01283 L     @02,@PC00030+4                                      1288
         SLR   @15,@15                                             1288
         ST    @15,ICTMTCHN(,@02)                                  1288
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU IOP VARIABLE ARRAY FOR ALIAS ENTRIES              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1289
*       DO INI=1 BY 1 WHILE IOPMACND(INI)^=IOPEOLST/* NOT AT END     */
*             &INITIRC=0;           /* NO ERRORS                     */
         LA    INI,1                                               1289
         B     @DE01289                                            1289
@DL01289 DS    0H                                                  1290
*         IF IOPMCIND(INI)=IOPMCMAL /* MALIAS NAME                   */
*           THEN                                                   1290
         LR    @15,INI                                             1290
         MH    @15,@CH00034                                        1290
         L     @14,@PC00030                                        1290
         L     @14,IIOPTR(,@14)                                    1290
         SLR   @07,@07                                             1290
         IC    @07,IOPMCIND-9(@15,@14)                             1290
         CH    @07,@CH00273                                        1290
         BNE   @RF01290                                            1290
*           DO;                                                    1291
*                                                                  1291
*             /*******************************************************/
*             /*                                                     */
*             /* PUT ALIAS INTO ICT ALIAS LIST                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1292
*             CALL HMASMTAI(TBLXPARM,/* TBLX PARMS                   */
*                 ICTMTCHN(1),      /* ALIAS LIST CHAIN ANCHOR       */
*                 ADDR(IOPMCASM(INI)),/* ALIAS NAME                  */
*                 LENGTH(ICTTALNM));/* LENGTH OF ICT INDEX ENTRY     */
         L     @07,@PC00001                                        1292
         ST    @07,@AL00001                                        1292
         L     @07,@PC00030+4                                      1292
         LA    @07,ICTMTCHN(,@07)                                  1292
         ST    @07,@AL00001+4                                      1292
         LA    @15,IOPMCASM-9(@15,@14)                             1292
         ST    @15,@TF00001                                        1292
         LA    @15,@TF00001                                        1292
         ST    @15,@AL00001+8                                      1292
         LA    @15,@CF00033                                        1292
         ST    @15,@AL00001+12                                     1292
         L     @15,@CV01892                                        1292
         LA    @01,@AL00001                                        1292
         BALR  @14,@15                                             1292
*             RESPECIFY                                            1293
*               REG15 RSTD;                                        1293
*             INITIRC=MAX(INITIRC,REG15);                          1294
         CR    INITIRC,REG15                                       1294
         BNL   *+6
         LR    INITIRC,REG15                                       1294
*             RESPECIFY                                            1295
*               REG15 UNRSTD;                                      1295
*           END;                                                   1296
*       END;                                                       1297
@RF01290 AL    INI,@CF00065                                        1297
@DE01289 LR    @15,INI                                             1297
         MH    @15,@CH00034                                        1297
         L     @14,@PC00030                                        1297
         L     @01,IIOPTR(,@14)                                    1297
         SLR   @14,@14                                             1297
         IC    @14,IOPMACND-9(@15,@01)                             1297
         CH    @14,@CH00765                                        1297
         BE    @DC01289                                            1297
         LTR   INITIRC,INITIRC                                     1297
         BZ    @DL01289                                            1297
@DC01289 DS    0H                                                  1298
*       IF ICTMTCHN(1)=0            /* NO ALIASES PUT IN LIST        */
*         THEN                                                     1298
         L     @15,@PC00030+4                                      1298
         ICM   @14,15,ICTMTCHN(@15)                                1298
         BNZ   @RF01298                                            1298
*         ICTMTCHN(1)=TBLXNULL;     /* POINT TO EMPTY LIST           */
         L     @14,@PC00001                                        1299
         MVC   ICTMTCHN(4,@15),TBLXNULL(@14)                       1299
*     END;                                                         1300
@RF01298 DS    0H                                                  1301
*   IF IOPTYPE=IOPSRC               /* ++SRC TYPE CDS IOP            */
*     THEN                                                         1301
@RF01278 L     @15,@PC00030                                        1301
         L     @15,IIOPTR(,@15)                                    1301
         CLI   IOPTYPE(@15),8                                      1301
         BNE   @RF01301                                            1301
*     DO;                                                          1302
*                                                                  1302
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE ++SRC ICT MOD SECTION ENTRY                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1303
*       ICTTOLIB(1)=BLANKDDN;       /* BLANK TARGET SYSTEM DDNAME    */
         L     @14,@PC00030+4                                      1303
         MVC   ICTTOLIB(8,@14),@CC01946                            1303
*       ICTMDSTL(1)=IOPSRDLB;       /* DLIB                          */
         MVC   ICTMDSTL(8,@14),IOPSRDLB(@15)                       1304
*       ICTMSYSL(1)=IOPSRSYS;       /* SYSLIB                        */
         MVC   ICTMSYSL(8,@14),IOPSRSYS(@15)                       1305
*       ICTMTCHN(1)=TBLXNULL;       /* POINT TO EMPTY LIST FOR ALIAS */
         L     @15,@PC00001                                        1306
         MVC   ICTMTCHN(4,@14),TBLXNULL(@15)                       1306
*       IF CCAACCPT=ON              /* ACCEPT PROCESSING             */
*         THEN                                                     1307
         TM    CCAACCPT(CCAPTR),B'00100000'                        1307
         BNO   @RF01307                                            1307
*         ICTTOLIB(1)=ICTMDSTL(1);  /* TARGET LIBRARY IS DLIB        */
         MVC   ICTTOLIB(8,@14),ICTMDSTL(@14)                       1308
*       ELSE                                                       1309
*         IF ICTMSYSL(1)=BLANKDDN   /* NO APPLY TARGET LIBRARY       */
*           THEN                                                   1309
         B     @RC01307                                            1309
@RF01307 L     @15,@PC00030+4                                      1309
         CLC   ICTMSYSL(8,@15),@CC01946                            1309
         BNE   @RF01309                                            1309
*           ICTTOLIB(1)=SMPSTS;     /* TARGET LIBRARY IS "SMPSTS"    */
         MVC   ICTTOLIB(8,@15),@CC01971                            1310
*         ELSE                                                     1311
*           ICTTOLIB(1)=ICTMSYSL(1);/* TARGET LIBRARY IS SYSLIB      */
         B     @RC01309                                            1311
@RF01309 L     @15,@PC00030+4                                      1311
         MVC   ICTTOLIB(8,@15),ICTMSYSL(@15)                       1311
*     END;                                                         1312
*   RETURN;                                                        1313
@EL00030 DS    0H                                                  1313
@EF00030 DS    0H                                                  1313
@ER00030 LM    @14,@12,@SA00030                                    1313
         BR    @14                                                 1313
*   END INITICTM;                                                  1314
         B     @EL00030                                            1314
*                                                                  1315
*/********************************************************************/
*/*                                                                  */
*/*    SKIP     - PUT BLANK LINES TO SMPOUT                          */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1315
*SKIP:                                                             1315
*   PROC(SKPN);                                                    1315
SKIP     STM   @14,@12,@SA00031                                    1315
         MVC   @PC00031(4),0(@01)                                  1315
*   DCL                                                            1316
*     SKPN FIXED(31);               /* NUMBER OF LINES TO SKIP       */
*   DCL                                                            1317
*     ISK FIXED(31);                /* LOCAL COUNTER                 */
*   DCL                                                            1318
*     XIOP CHAR(LENGTH(HMASMIOP));  /* LOCAL IOP                     */
*   DCL                                                            1319
*     XPRL CHAR(LENGTH(HMASMPRL));  /* LOCAL PRL (HMASMPRL)          */
*   RESPECIFY                                                      1320
*     HMASMIOP BASED(ADDR(XIOP));   /* ADDRESS LOCAL IOP             */
*   IOPRETRN=0;                     /*                               */
         LA    @15,XIOP                                            1321
         MVI   IOPRETRN(@15),X'00'                                 1321
*   IOPFUNCT=IOPWRITE;              /*                               */
         MVI   IOPFUNCT(@15),X'51'                                 1322
*   IOPDSID=IOPPRINT;               /*                               */
         MVI   IOPDSID(@15),X'0B'                                  1323
*   IOPBUFAD=ADDR(XPRL);            /* POINT TO PRL                  */
         LA    @14,XPRL                                            1324
         ST    @14,IOPBUFAD(,@15)                                  1324
*   PRLFLGS=''B;                    /* CLEAR PRL FLAGS               */
         MVI   PRLFLGS(@14),X'00'                                  1325
*   PRLBLANK=ON;                    /* BLANK-LINE PRINT              */
         OI    PRLBLANK(@14),B'00100000'                           1326
*   DO ISK=1 TO SKPN WHILE IOPRETRN=IOPGOOD;                       1327
         LA    ISK,1                                               1327
         B     @DE01327                                            1327
@DL01327 LA    @03,XIOP                                            1327
         CLI   IOPRETRN(@03),0                                     1327
         BNE   @DC01327                                            1327
*     CALL HMASMIO(HMASMIOP);                                      1328
         ST    @03,@AL00001                                        1328
         L     @15,@CV01886                                        1328
         LA    @01,@AL00001                                        1328
         BALR  @14,@15                                             1328
*   END;                                                           1329
         AL    ISK,@CF00065                                        1329
@DE01327 L     @03,@PC00031                                        1329
         C     ISK,SKPN(,@03)                                      1329
         BNH   @DL01327                                            1329
@DC01327 DS    0H                                                  1330
*   RETURN;                                                        1330
@EL00031 DS    0H                                                  1330
@EF00031 DS    0H                                                  1330
@ER00031 LM    @14,@12,@SA00031                                    1330
         BR    @14                                                 1330
*   END SKIP;                                                      1331
*   END HMASMTMD                                                   1332
*                                                                  1332
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */
*                                                                  1332
*       ;                                                          1332
@DATA    DS    0H
@CH00083 DC    H'0'
@CH00273 DC    H'2'
@CH00088 DC    H'3'
@CH00103 DC    H'5'
@CH00289 DC    H'6'
@CH00067 DC    H'7'
@CH00034 DC    H'9'
@CH00580 DC    H'11'
@CH00036 DC    H'12'
@CH00609 DC    H'27'
@CH01977 DC    H'47'
@CH00469 DC    H'80'
@CH02382 DC    H'116'
@CH02383 DC    H'144'
@CH01979 DC    H'156'
@CH01981 DC    H'171'
@CH01983 DC    H'175'
@CH01987 DC    H'206'
@CH00765 DC    H'255'
         DS    0F
@AL00254 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00492 DC    A(@CF00065)             LIST WITH   1 ARGUMENT(S)
@AL00317 DC    A(@CH01987+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00083+1)
@AL00326 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00477 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01111 DC    A(@CH00609+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00580+1)
@AL00329 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01117 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00479 DC    A(@CH01981+1)           LIST WITH   1 ARGUMENT(S)
         DC    A(@CH00083+1)
@AL00452 DC    A(SI)                   LIST WITH   1 ARGUMENT(S)
@AL00521 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00572 DC    A(MPPPARM)              LIST WITH   1 ARGUMENT(S)
@AL00528 DC    A(@CH01979+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00083+1)
@AL00534 DC    A(BLDMODPC)             LIST WITH   1 ARGUMENT(S)
@AL00588 DC    A(TMWOPT)               LIST WITH   4 ARGUMENT(S)
         DC    A(MODSCPTR)
         DC    A(HMASMCRP)
         DC    A(TMWMODE)
@AL00597 DC    A(MODSCPTR)             LIST WITH   3 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00599 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00601 DC    A(BLDMD2PC)             LIST WITH   1 ARGUMENT(S)
@AL00657 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00664 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00670 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00676 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00683 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00690 DC    A(BLDENT@)              LIST WITH   3 ARGUMENT(S)
         DC    A(@TF00001)
         DC    A(MCBPTR)
@AL00715 DC    A(TMWOPT)               LIST WITH   4 ARGUMENT(S)
         DC    A(BLDENT@)
@AL00513 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00565 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00802 DC    A(HMASMCRP)             LIST WITH   1 ARGUMENT(S)
         DC    A(TMWMODE)
@AL00722 DC    A(BLDENT@)              LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL00896 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00903 DC    A(@CH01977+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00580+1)
@AL01092 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
@AL01137 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01145 DC    A(@CH01983+1)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CH00083+1)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    15F
@PC00002 DS    1F
@SA00004 DS    15F
@PC00025 DS    2F
@PC00026 DS    2F
@PC00027 DS    1F
@PC00029 DS    2F
@SA00010 DS    15F
@PC00010 DS    2F
@SA00022 DS    15F
@SA00003 DS    15F
@PC00003 DS    4F
@PC00028 DS    3F
@PC00020 DS    1F
@SA00005 DS    15F
@PC00005 DS    2F
@PC00011 DS    1F
@SA00006 DS    15F
@PC00006 DS    2F
@PC00007 DS    2F
@SA00015 DS    15F
@PC00015 DS    2F
@SA00008 DS    15F
@PC00008 DS    2F
@PC00016 DS    4F
@PC00019 DS    1F
@PC00018 DS    1F
@PC00013 DS    3F
@SA00023 DS    15F
@PC00023 DS    1F
@PC00024 DS    2F
@SA00017 DS    0F
@PC00017 EQU   @SA00017+60
@SA00014 DS    0F
@PC00014 EQU   @SA00014+60
@SA00012 DS    0F
@PC00012 EQU   @SA00012+60
@SA00030 DS    0F
@PC00030 EQU   @SA00030+60
@SA00009 DS    0F
@PC00009 EQU   @SA00009+60
@SA00021 DS    0F
@PC00021 EQU   @SA00021+60
@SA00031 DS    0F
@PC00031 EQU   @SA00031+60
         DS    18F
@AL00001 DS    4A
@TF00001 DS    F
@AFTEMPS DS    2F
         DS    0F
@CF00065 DC    F'1'
@CH00065 EQU   @CF00065+2
@CF00040 DC    F'4'
@CH00040 EQU   @CF00040+2
@CF00033 DC    F'8'
@CH00033 EQU   @CF00033+2
@CF02422 DC    F'-144'
@CF02438 DC    F'-136'
@CF02420 DC    F'-135'
@CF02439 DC    F'-134'
@CF02421 DC    F'-133'
@CF02427 DC    F'-132'
@CF02417 DC    F'-116'
@CF02416 DC    F'-108'
@CF02415 DC    F'-103'
@CF02418 DC    F'-101'
@CF02426 DC    F'-99'
@CF02444 DC    F'-98'
@CF02443 DC    F'-96'
@CF02423 DC    F'-52'
@CF02433 DC    F'-48'
@CF02445 DC    F'-32'
@CF02434 DC    F'-8'
@CF02424 DC    F'-4'
@CV01885 DC    V(HMASMCRD)
@CV01886 DC    V(HMASMIO)
@CV01887 DC    V(HMASMMPD)
@CV01888 DC    V(HMASMMSG)
@CV01891 DC    V(HMASMTAD)
@CV01892 DC    V(HMASMTAI)
@CV01893 DC    V(HMASMTCR)
@CV01894 DC    V(HMASMTMS)
@CV01895 DC    V(HMASMTMW)
@CV01896 DC    V(HMASMTM1)
@CV01897 DC    V(HMASMTM2)
@CV01898 DC    V(HMASMTM3)
@CV01889 DC    V(HMASMSCN)
@CV01890 DC    V(HMASMSUB)
@CV01899 DC    V(HMASMTM4)
         DS    0D
IOPPTR   DS    A
HIGHTMD  DS    F
PTRIOP2  DS    A
MCBPTR   DS    A
SRCMP1   DS    A
SRCMP2   DS    A
SAVIOPB3 DS    A
PTR0     DS    A
BLDICTRC DS    F
SI       DS    F
BLDMODPC DS    F
MODADDR  DS    A
BLDMD2PC DS    F
MODSCPTR DS    A
TMXRETRN DS    F
BLDENT@  DS    A
XPNDPTR  DS    A
TESTIND  DS    FL1
@CC01946 DC    C'        '
@CC01969 DC    C'SMPMTS  '
@CC01971 DC    C'SMPSTS  '
@CC01991 DC    C'MCS     '
@CC01993 DC    C'SMPPTS  '
@CC01995 DC    C'ENTRY   '
@CC01997 DC    C'PREREQ  '
@CC01999 DC    C'FMID    '
@CC02001 DC    C'MOD     '
@CC02003 DC    C'MAC     '
@CC02005 DC    C'SRC     '
@CC02009 DC    C'MACUPD  '
@CC02011 DC    C'SRCUPD  '
@CC02209 DC    C'SMPWRK4 '
@CC01944 EQU   @CC01946
@CC02184 DC    C'++'
@CC00717 EQU   @CC01991
         DS    CL1
HMASMCRP DS    CL106
         ORG   HMASMCRP
CRPUXNUM DS    FL1
@NM00057 DS    CL3
CRPSCPAD DS    AL4
CRPINDS  DS    FL1
CRPOUTDS DS    FL1
CRPRETRN DS    FL1
@NM00058 DS    CL3
CRPFLG1  DS    BL2
         ORG   CRPFLG1
CRPBFPRM DS    BL1
CRPLOGCK EQU   CRPFLG1+0
CRPPTS   EQU   CRPFLG1+0
CRPLOG   EQU   CRPFLG1+0
CRPPRINT EQU   CRPFLG1+0
CRPOTHER EQU   CRPFLG1+0
CRPOFFST EQU   CRPFLG1+0
CRPSCNCL EQU   CRPFLG1+0
CRPEOFEN DS    BL1
CRPTRMEX EQU   CRPFLG1+1
CRPNOWPP EQU   CRPFLG1+1
CRPLIST  EQU   CRPFLG1+1
CRPRPT   EQU   CRPFLG1+1
@NM00059 EQU   CRPFLG1+1
         ORG   HMASMCRP+16
CRPFLG2  DS    BL2
         ORG   CRPFLG2
CRPINSW0 DS    BL1
         ORG   CRPINSW0
CRPEOFSW DS    BL1
         ORG   CRPFLG2+0
CRPINSW1 EQU   CRPFLG2+0
         ORG   CRPINSW1
CRPEXADD EQU   CRPINSW1+0
         ORG   CRPFLG2+0
CRPINSW2 EQU   CRPFLG2+0
         ORG   CRPINSW2
CRPWRTLG EQU   CRPINSW2+0
         ORG   CRPFLG2+0
CRPINSW3 EQU   CRPFLG2+0
         ORG   CRPINSW3
CRPEOF1  EQU   CRPINSW3+0
         ORG   CRPFLG2+0
CRPINSW4 EQU   CRPFLG2+0
CRPINSW5 EQU   CRPFLG2+0
CRPINSW6 EQU   CRPFLG2+0
CRPINSW7 EQU   CRPFLG2+0
         DS    CL1
CRPINSW8 DS    BL1
CRPINSW9 EQU   CRPFLG2+1
CRPINSWA EQU   CRPFLG2+1
CRPINSWB EQU   CRPFLG2+1
CRPINSWC EQU   CRPFLG2+1
CRPINSWD EQU   CRPFLG2+1
CRPINSWE EQU   CRPFLG2+1
CRPINSWF EQU   CRPFLG2+1
         ORG   HMASMCRP+18
CRPBUFFR DS    CL80
         ORG   CRPBUFFR
CRPBFCTL DS    CL72
         ORG   CRPBFCTL
CRPBFDTA DS    CL71
CRPBFCNT DS    CL1
         ORG   CRPBUFFR+72
CRPBFSEQ DS    CL8
         ORG   HMASMCRP+98
CRPDDNAM DS    CL8
         ORG   HMASMCRP+106
         DS    CL2
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00255 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00256 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
MPPPARM  DS    CL23
         ORG   MPPPARM
MPPIOPAD DS    AL4
MPPMCBAD DS    AL4
MPPCRDAD DS    AL4
MPPCRDPM DS    AL4
MPPSMDNM DS    CL7
         ORG   MPPPARM+23
         DS    CL1
HMASMSPL DS    CL5
         ORG   HMASMSPL
SPLPMAD  DS    AL4
SPLFUNCT DS    FL1
         ORG   HMASMSPL+5
TMDFLGS  DS    BL1
         ORG   TMDFLGS
LOOP     DS    BL1
BUILD    EQU   TMDFLGS+0
BLDM2WRK EQU   TMDFLGS+0
MCSEOF   EQU   TMDFLGS+0
@NM00257 EQU   TMDFLGS+0
         ORG   TMDFLGS+1
TMWMODE  DS    CL1
TMWOPT   DS    CL1
MSGSMDN8 DS    CL8
         ORG   MSGSMDN8
MSGSMDNM DS    CL7
@NM00258 DS    CL1
         ORG   MSGSMDN8+8
VPARTS   DS    CL24
         ORG   VPARTS
VPART#1  DS    CL8
VPART#2  DS    CL8
VPART#3  DS    CL8
         ORG   VPARTS+24
PATCHTMD DS    CL80
         ORG   PATCHTMD
@NM00259 DC    80X'FF'
         ORG   PATCHTMD+80
DELFCTN  DS    CL7
WCHKANS  DS    CL1
ENTERMID DS    CL7
SKIPLOOP DS    CL1
SRCNAME  DS    CL8
MODNAME  DS    CL8
INVMSL   DS    CL1
ELIMASMN DS    CL8
XIOP     DS    CL68
XPRL     DS    CL10
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ISK      EQU   @02
INITIRC  EQU   @03
INI      EQU   @02
ETSTTYPE EQU   @03
MJ       EQU   @02
IN6      EQU   @02
IN5      EQU   @02
IN4      EQU   @03
IN3      EQU   @02
LL       EQU   @02
INV      EQU   @02
IN       EQU   @02
MINORD#  EQU   @03
PI       EQU   @02
MODSPTR  EQU   @03
MODMPTR  EQU   @05
MODSMD@  EQU   @04
TT       EQU   @02
SRCMPTR  EQU   @03
SRCSPTR  EQU   @05
SRCSMD@  EQU   @04
UU       EQU   @02
SSMDPTR  EQU   @03
QQ       EQU   @02
NN       EQU   @02
SS       EQU   @02
RR       EQU   @04
PTRICTP  EQU   @03
MM       EQU   @02
LTSTTYPE EQU   @02
ENTTYPE  EQU   @02
IM       EQU   @03
IX       EQU   @02
JM       EQU   @02
J        EQU   @03
SAVIOPB2 EQU   @06
SAVIOPB1 EQU   @05
IP       EQU   @04
I        EQU   @03
PTRIOP1  EQU   @02
CCAPTR   EQU   @11
REG15    EQU   @15
REG1     EQU   @01
REG14    EQU   @14
RTNCODE  EQU   @15
RTNREG   EQU   @14
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLCHECK EQU   TBLFLG1
TBLFLG2  EQU   TBLFLAGS+2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLFLG5  EQU   TBLFLAGS+7
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00023 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAACCPT EQU   CCAFLAG1
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00039 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00041 EQU   CCABLDLL
CCALKDRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00053+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00060 EQU   HMASMIOP+12
@NM00061 EQU   @NM00060
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00171 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMPRL EQU   0
PRLSPAN  EQU   HMASMPRL+2
PRLFLGS  EQU   PRLSPAN
PRLBLANK EQU   PRLFLGS
PRLDATE  EQU   HMASMPRL+4
PRLTIME  EQU   HMASMPRL+7
PRLEND   EQU   HMASMPRL+10
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPEND  EQU   ICTPTFS
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPDEXP EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
ICTPMSL  EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
@NM00200 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPTYPE EQU   ICTPTF+17
ICTPONUM EQU   ICTPTF+18
ICTPSUPN EQU   ICTPTF+20
ICTPFMID EQU   ICTPTF+22
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTIXP   EQU   ICTIXPF
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTSUPND EQU   ICTSUPNM
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREND EQU   ICTPRENM
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMEND  EQU   ICTMNAME
ICTMFLG2 EQU   ICTMOD+8
ICTMNOGO EQU   ICTMFLG2
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMMOD  EQU   ICTMMODR
ICTMASM  EQU   ICTMMODR
ICTMZAP  EQU   ICTMFLG1
ICTMXPND EQU   ICTMFLG1
ICTMMACR EQU   ICTMFLG1
ICTMMACU EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMSRCU EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTLIBLK EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTMRELF EQU   ICTMFLG3
ICTMWRK  EQU   ICTMFLG3
ICTMFLG4 EQU   ICTMOD+11
ICTMISEL EQU   ICTMFLG4
ICTMIDEL EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMFLG5 EQU   ICTMOD+12
ICTMPASS EQU   ICTMFLG5
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTFMLIB EQU   ICTMOD+24
ICTTOLIB EQU   ICTMOD+32
ICTMDSTL EQU   ICTMOD+48
ICTMSYSL EQU   ICTMOD+56
ICTMRMID EQU   ICTMOD+80
ICTMFMID EQU   ICTMOD+88
ICTPPTR  EQU   ICTMOD+96
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMIDND EQU   ICTMODID
ICTMODST EQU   ICTMID+7
ICTMIDPS EQU   ICTMODST
ICTMIDPL EQU   ICTMODST
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTASMND EQU   ICTASMAD
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLFLG4 EQU   ICTLMOD+8
ICTLFLG1 EQU   ICTLMOD+9
ICTLFLG5 EQU   ICTLMOD+10
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTLFLG3 EQU   ICTLMOD+14
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
MCBPTFMP EQU   0
MCBTYPE  EQU   MCBPTFMP
MCBVERMP EQU   0
MCBVEND  EQU   MCBVERMP+8
MCBIFMP  EQU   0
MCBIEND  EQU   MCBIFMP+8
MCBELEMP EQU   0
MCBENAME EQU   MCBELEMP+1
MCBERMID EQU   MCBELEMP+129
MCBELEPM EQU   MCBELEMP+136
MCBEFLG1 EQU   MCBELEPM
MCBEFLG2 EQU   MCBELEPM+1
MCBEFLG3 EQU   MCBELEPM+2
MCBEFLG4 EQU   MCBELEPM+3
MCBEFLG5 EQU   MCBELEMP+140
MCBEEND  EQU   MCBELEMP+141
SPLPPACK EQU   0
SPLPUNPK EQU   0
SPLPDSN  EQU   0
SPLODSN  EQU   SPLPDSN
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXIOP2 EQU   TBLXPARM+16
TBLXTBL  EQU   TBLXPARM+28
TBLXTOP  EQU   TBLXPARM+32
TBLXNULL EQU   TBLXPARM+36
TBLXCDSI EQU   TBLXPARM+60
TBLXFUNC EQU   TBLXPARM+64
TBLXFLG1 EQU   TBLXPARM+80
TBLXRC   EQU   TBLXPARM+92
TBLXIOP3 EQU   TBLXPARM+104
DELSYSMD EQU   0
DELMNAME EQU   0
DELMTYP  EQU   0
DELMFCTN EQU   0
DELMSMD  EQU   0
BLDSYSMD EQU   0
BLDMODRC EQU   0
BLDM2SMD EQU   0
BLDMD2RC EQU   0
BLDM3SMD EQU   0
BLDMD3RC EQU   0
BLDESMD  EQU   0
BLDENTRC EQU   0
ELEMNAME EQU   0
ELEMTYPE EQU   0
BLDMFSMD EQU   0
BLDFLSHC EQU   0
MSUPSMD  EQU   0
SKIPRC   EQU   0
ELNAME   EQU   0
ELTYPE   EQU   0
ANSWRKC  EQU   0
ZAPMOD@  EQU   0
ZAPPTF@  EQU   0
XPNDRC   EQU   0
MEMBR    EQU   0
LOCRC    EQU   0
ELMNAME  EQU   0
ELMCBTY  EQU   0
SMDNAME  EQU   0
RTNPTR   EQU   0
SCRMOD   EQU   0
SRCENTRY EQU   0
MODENTRY EQU   0
NXTINDX  EQU   0
MSGCODE1 EQU   0
MSGCODE2 EQU   0
INVSYSMD EQU   0
MSLSYSMD EQU   0
MSL      EQU   0
ASMENTRY EQU   0
CHKAPTR  EQU   0
SRCHMN   EQU   0
SRCHMP   EQU   0
ELIMASME EQU   0
ELMNNAME EQU   0
ELMNTYPE EQU   0
ELMNPTR  EQU   0
ELMENTRY EQU   0
ETEBCDIC EQU   0
IIOPTR   EQU   0
IMODENT  EQU   0
SKPN     EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00067 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00078 EQU   IOPUDATA
@NM00079 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00088 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMID  EQU   IOPRMIDE
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPFMID  EQU   IOPFMIDE
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCSYS EQU   IOPMACFX+64
IOPMCDLB EQU   IOPMACFX+72
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACND EQU   IOPMACID
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00099 EQU   IOPSRCDR+1
@NM00101 EQU   @NM00099+7
@NM00105 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00109 EQU   IOPSRCFX
IOPSRSYS EQU   IOPSRCFX+64
IOPSRDLB EQU   IOPSRCFX+72
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00115 EQU   IOPMODDR+1
@NM00117 EQU   @NM00115+7
@NM00121 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00125 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPDLIB  EQU   IOPMODFX+72
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODND EQU   IOPMODID
IOPMODST EQU   IOPLMODS+7
IOPMDIND EQU   IOPMNTRY+8
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00136 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00143 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPDUMMP EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00152 EQU   IOPPTFFX
@NM00153 EQU   @NM00152
IOPPDTES EQU   IOPPTFFX+41
@NM00156 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPPIND  EQU   IOPPNTRY+8
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00181 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00181
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00185 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00185
IOPBFTB1 EQU   IOPBFTB0
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
MCBVVLST EQU   MCBVEND
MCBVNTRY EQU   MCBVVLST
MCBVNUM  EQU   MCBVNTRY
MCBIVLST EQU   MCBIEND
MCBINTRY EQU   MCBIVLST
MCBINUM  EQU   MCBINTRY
MCBEVLST EQU   MCBEEND
MCBENTRY EQU   MCBEVLST
MCBENUM  EQU   MCBENTRY
PRLDATA  EQU   PRLEND
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
MCBEIND  EQU   MCBEVLST+8
@NM00254 EQU   MCBENTRY+7
MCBEND   EQU   MCBENUM
MCBIIND  EQU   MCBIVLST+8
@NM00247 EQU   MCBINTRY+7
MCBIND   EQU   MCBINUM
MCBVIND  EQU   MCBVVLST+8
@NM00245 EQU   MCBVNTRY+7
MCBVND   EQU   MCBVNUM
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00187 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00186 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00184 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00183 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00182 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00180 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00179 EQU   IOPPTSFX+35
@NM00178 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00177 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00176 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00175 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00174 EQU   IOPQFMDR
@NM00170 EQU   IOPQSMDR
@NM00169 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00168 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00167 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00166 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00165 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00164 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00163 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00162 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00161 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00160 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00159 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00158 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPFMID EQU   IOPPTFFX+73
@NM00157 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00156+3
IOPRECD  EQU   @NM00156
@NM00155 EQU   IOPPTFFX+8
@NM00154 EQU   @NM00152+7
IOPPRELN EQU   @NM00153
@NM00151 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00150 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00149 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
@NM00148 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00147 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00146 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00145 EQU   @NM00143+7
@NM00144 EQU   @NM00143
@NM00142 EQU   IOPSYSDR+5
@NM00141 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00140 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00139 EQU   IOPDLBFX+8
@NM00138 EQU   @NM00136+7
@NM00137 EQU   @NM00136
@NM00135 EQU   IOPDLBDR+1
@NM00134 EQU   IOPDLBDR
@NM00133 EQU   IOPMODST
@NM00132 EQU   IOPMODFX+12
@NM00131 EQU   IOPMODF4
@NM00130 EQU   IOPMODF3
@NM00129 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00128 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00127 EQU   @NM00125+7
@NM00126 EQU   @NM00125
@NM00124 EQU   IOPMODDR+17
@NM00123 EQU   @NM00121+7
@NM00122 EQU   @NM00121
@NM00120 EQU   @NM00117
@NM00119 EQU   @NM00117
@NM00118 EQU   @NM00117
@NM00116 EQU   @NM00115
@NM00114 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00113 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
@NM00112 EQU   IOPSRCFX+8
@NM00111 EQU   @NM00109+7
@NM00110 EQU   @NM00109
@NM00108 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00107 EQU   @NM00105+7
@NM00106 EQU   @NM00105
@NM00104 EQU   @NM00101
@NM00103 EQU   @NM00101
@NM00102 EQU   @NM00101
@NM00100 EQU   @NM00099
@NM00098 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00097 EQU   IOPMACST
@NM00096 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00095 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
@NM00094 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00093 EQU   IOPRMST
@NM00092 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   IOPLMDDR+6
@NM00086 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00085 EQU   IOPLMDF4
@NM00084 EQU   IOPLMDF3
@NM00083 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00082 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00081 EQU   IOPLMDDR
@NM00080 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00079+4
IOPUSED  EQU   @NM00079
IOPTPSEQ EQU   @NM00078+8
IOPVLSER EQU   @NM00078+2
IOPBLKSI EQU   @NM00078
IOPCQMAX EQU   IOPCQMAP+12
@NM00077 EQU   IOPCQMAP+11
@NM00076 EQU   IOPCQMAP+8
@NM00075 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00074 EQU   IOPSCMAP+11
@NM00073 EQU   IOPSCMAP+8
@NM00072 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00071 EQU   IOPNTMAX+11
@NM00070 EQU   IOPNTMAX+8
@NM00069 EQU   IOPNTMAX
@NM00068 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00067+5
IOPIPTF3 EQU   @NM00067
TBLXEND0 EQU   TBLXPARM+124
@NM00007 EQU   TBLXPARM+108
TBLXD2GT EQU   TBLXPARM+100
TBLXDLGT EQU   TBLXPARM+96
@NM00006 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTRC  EQU   TBLXRC
TBLXIBGN EQU   TBLXPARM+88
TBLXTSLP EQU   TBLXPARM+84
@NM00005 EQU   TBLXPARM+83
@NM00004 EQU   TBLXPARM+82
@NM00003 EQU   TBLXPARM+81
@NM00002 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
TBLXFUND EQU   TBLXPARM+72
@NM00001 EQU   TBLXPARM+62
TBLXCRQI EQU   TBLXPARM+61
TBLXLMGT EQU   TBLXPARM+56
TBLXSCGT EQU   TBLXPARM+52
TBLXSREL EQU   TBLXPARM+48
TBLXASGT EQU   TBLXPARM+44
TBLXIFGT EQU   TBLXPARM+40
TBLXSEGT EQU   TBLXPARM+24
TBLXIOPF EQU   TBLXPARM+20
TBLXEND  EQU   TBLXINDX+8
TBLXSTRT EQU   TBLXINDX+4
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
SPLIFIL  EQU   SPLODSN+33
SPLISMD  EQU   SPLODSN+26
SPLIPFX  EQU   SPLODSN
SPLIUNPK EQU   SPLPUNPK+8
SPLOUNPK EQU   SPLPUNPK
SPLOPACK EQU   SPLPPACK+8
SPLIPACK EQU   SPLPPACK
@NM00253 EQU   MCBEFLG5
MCBEDEL  EQU   MCBEFLG5
MCBESTD  EQU   MCBEFLG5
@NM00252 EQU   MCBEFLG4
@NM00251 EQU   MCBEFLG3
@NM00250 EQU   MCBEFLG2
MCBEPAGA EQU   MCBEFLG2
MCBENE   EQU   MCBEFLG2
@NM00249 EQU   MCBEFLG1
MCBEDC   EQU   MCBEFLG1
MCBEREFR EQU   MCBEFLG1
MCBEOVLY EQU   MCBEFLG1
MCBESCTR EQU   MCBEFLG1
MCBEREUS EQU   MCBEFLG1
MCBERENT EQU   MCBEFLG1
MCBEAPF  EQU   MCBEFLG1
MCBELLKD EQU   MCBELEMP+128
MCBEJLKD EQU   MCBELEMP+116
MCBELUPI EQU   MCBELEMP+115
MCBEJUPI EQU   MCBELEMP+103
MCBELCPY EQU   MCBELEMP+102
MCBEJCPY EQU   MCBELEMP+90
MCBELASM EQU   MCBELEMP+89
MCBEJASM EQU   MCBELEMP+77
MCBERLF  EQU   MCBELEMP+73
MCBESSI  EQU   MCBELEMP+65
MCBEDALS EQU   MCBELEMP+57
MCBEASLB EQU   MCBELEMP+49
MCBELKLB EQU   MCBELEMP+41
MCBETXLB EQU   MCBELEMP+33
MCBESYS  EQU   MCBELEMP+25
MCBEDOBJ EQU   MCBELEMP+17
MCBEDIST EQU   MCBELEMP+9
@NM00248 EQU   MCBELEMP
MCBIFENV EQU   MCBIFMP+1
@NM00246 EQU   MCBIFMP
MCBSFMID EQU   MCBVERMP+1
@NM00244 EQU   MCBVERMP
MCBPTP   EQU   MCBPTFMP+10
MCBPRELN EQU   MCBPTFMP+8
MCBPNO   EQU   MCBPTFMP+1
ICTIXL   EQU   ICTIXLF
@NM00243 EQU   ICTLMOD+38
ICTLTTR  EQU   ICTLMOD+31
ICTTG2   EQU   ICTLMOD+23
ICTTG1   EQU   ICTLMOD+15
@NM00242 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTLCPY  EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
ICTTIND1 EQU   ICTLFLG3
@NM00241 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00240 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
ICTCOPY  EQU   ICTLFLG2
@NM00239 EQU   ICTLFLG7
@NM00238 EQU   ICTLFLG6
@NM00237 EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLNE   EQU   ICTLFLG5
@NM00236 EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLAPF  EQU   ICTLFLG1
@NM00235 EQU   ICTLFLG4
ICTLPASS EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLCPL  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
ICTLPROC EQU   ICTLFLG4
ICTLEND  EQU   ICTLNAME
@NM00234 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00233 EQU   ICTMVRNT+7
ICTMVRND EQU   ICTMVRNM
ICTTALND EQU   ICTTALNM
ICTMIDTY EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDRG EQU   ICTMODST
ICTMIDF1 EQU   ICTMODST
@NM00232 EQU   ICTMODST
ICTIXM   EQU   ICTIXMF
@NM00231 EQU   ICTMOD+128
ICTMICHA EQU   ICTMOD+108
@NM00230 EQU   ICTMOD+95
@NM00229 EQU   ICTMOD+87
ICTMSSI  EQU   ICTMOD+72
ICTMDOBJ EQU   ICTMOD+64
ICTMASLB EQU   ICTMOD+40
ICTMRELN EQU   ICTMOD+22
@NM00228 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00227 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00226 EQU   ICTMLEP4
@NM00225 EQU   ICTMLEP3
@NM00224 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00223 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00222 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMCOPY EQU   ICTMFLG5
@NM00221 EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
@NM00220 EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMALIS EQU   ICTMFLG3
ICTMTRX  EQU   ICTMFLG3
@NM00219 EQU   ICTMFLG2
@NM00218 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMPROC EQU   ICTMFLG2
@NM00217 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00216 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00215 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00214 EQU   ICTCSRST
@NM00213 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00212 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00211 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00210 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00209 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00208 EQU   ICTPREST
@NM00207 EQU   ICTSUPNT+7
@NM00206 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00205 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00204 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00203 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
@NM00202 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00201 EQU   @NM00200
ICTPRQBY EQU   @NM00200
ICTPRQOK EQU   @NM00200
ICTPRQCK EQU   @NM00200
@NM00199 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
@NM00198 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00197 EQU   ICTPFLG4
@NM00196 EQU   ICTPFLG4
@NM00195 EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00194 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00193 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00192 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00191 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00190 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
PRLCONC  EQU   PRLTIME+2
@NM00189 EQU   PRLTIME
PRLHDADR EQU   PRLDATE
@NM00188 EQU   PRLFLGS
PRLHEADO EQU   PRLFLGS
PRLHEAD  EQU   PRLFLGS
PRLRLEN  EQU   HMASMPRL
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00173 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00172 EQU   @NM00171+7
IOPQSMFM EQU   @NM00171
@NM00091 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00066 EQU   IOPUSERL
@NM00065 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00064 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00063 EQU   @NM00060+10
IOPSEQNO EQU   @NM00060+8
@NM00062 EQU   @NM00061+7
IOPPTFNM EQU   @NM00061
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00056 EQU   CCABLDLM+2
@NM00055 EQU   CCABLDLM
CCAUPDPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00053+12
CCAUPDTE EQU   @NM00053+8
CCAUPDNM EQU   @NM00053
CCASUPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00051+12
CCAIOSUP EQU   @NM00051+8
CCASUPNM EQU   @NM00051
CCAZAPPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00049+12
CCASPZAP EQU   @NM00049+8
CCAZAPNM EQU   @NM00049
CCACOMPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00047+12
CCACOMRS EQU   @NM00047+8
CCACOMNM EQU   @NM00047
CCACPYPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00045+12
CCACOPY  EQU   @NM00045+8
CCACPYNM EQU   @NM00045
CCAASMPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00043+12
CCAASM   EQU   @NM00043+8
CCAASMNM EQU   @NM00043
CCALKDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00041+12
CCALKED  EQU   @NM00041+8
CCALKDNM EQU   @NM00041
CCAPGMPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCABPGRC EQU   @NM00039+20
CCABPGSP EQU   @NM00039+12
CCABPGAD EQU   @NM00039+8
CCABPGNM EQU   @NM00039
CCAEND   EQU   HMASMCCA+371
@NM00038 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00037 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00036 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00035 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00034 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00033 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00032 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00031 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00030 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00029 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00028 EQU   @NM00023+18
@NM00027 EQU   @NM00023+16
CCATBLPA EQU   @NM00023+12
@NM00026 EQU   @NM00023+8
@NM00025 EQU   @NM00023+4
@NM00024 EQU   @NM00023
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00022 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00021 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00020 EQU   CCAFBUFR+122
@NM00019 EQU   CCAFBUFR+120
@NM00018 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00017 EQU   CCAFBUFR+88
@NM00016 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00015 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00014 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00013 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00012 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
TBLBPID  EQU   TBLFLG4
@NM00011 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00010 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
TBLGROUP EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
TBLSEL   EQU   TBLFLG2
@NM00009 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLASSEM EQU   TBLFLG1
TBLNOAPP EQU   TBLFLG1
@NM00008 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00404 EQU   @EL00002
@RF00416 EQU   @EL00003
@RC00421 EQU   @EL00003
@RF00551 EQU   @EL00005
@RC00582 EQU   @RC00578
@RF00606 EQU   @EL00006
@RC00700 EQU   @RC00698
@RF00706 EQU   @EL00008
@RC00708 EQU   @EL00008
@RF00752 EQU   @EL00009
@RF00755 EQU   @EL00009
@RC00808 EQU   @EL00012
@RF00841 EQU   @EL00014
@RC00872 EQU   @EL00015
@RF00945 EQU   @EL00017
@RF01099 EQU   @EL00021
@RC01097 EQU   @EL00021
@RC01095 EQU   @EL00021
@RC01093 EQU   @EL00021
@RF01249 EQU   @EL00029
@RF01301 EQU   @EL00030
@RC01309 EQU   @EL00030
@RC01307 EQU   @EL00030
@RF00596 EQU   @RC00582
@RC00711 EQU   @RC00708
@RC00876 EQU   @RC00872
@RF00721 EQU   @RC00711
@ENDDATA EQU   *
         END   HMASMTMD,(C'PLS2151',0802,78334)

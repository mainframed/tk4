         TITLE 'HMASMTCL - TABLE BUILD CLEANUP PROCEDURE'
HMASMTCL CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTCL  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  LA    @12,4095(,@10)                                      0001
         USING @PSTART,@10                                         0001
         USING @PSTART+4095,@12                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   HMASMMGP=''B;                   /* INITIALIZE THE MGP            */
         XC    HMASMMGP(28),HMASMMGP                               0121
*   MGPPRINT=ON;                    /* ROUTE MESSAGE TO PRINTER      */
*   MGPHLDS=ON;                     /* ROUTE MESSAGE TO SMPLOG       */
         OI    MGPPRINT,B'10010000'                                0123
*                                                                  0124
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO ISSUE HMA226I FOR NON-NOGO SYSMODS IN ICT WHEN*/
*   /* THE SMP APPLY/ACCEPT/RESTORE FUNCTION IS TERMINATING          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0124
*   IF TBLXTRC>=STOPFUNC            /* A/A/R TERMINATING             */
*       &CCAICT^=ZERO               /* VALID PTR TO ICT              */
*       &CCAICPTF^=ZERO             /* VALID PTR TO ICT PTF SECTION  */
*     THEN                                                         0124
         L     @09,@PC00001                                        0124
         CLI   TBLXTRC(@09),12                                     0124
         BL    @RF00124                                            0124
         SLR   @09,@09                                             0124
         C     @09,CCAICT(,CCAPTR)                                 0124
         BE    @RF00124                                            0124
         C     @09,CCAICPTF(,CCAPTR)                               0124
         BE    @RF00124                                            0124
*     CALL TCLTERM;                 /* ISSUE HMA226I MESSAGES        */
         BAL   @14,TCLTERM                                         0125
*                                                                  0126
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO FREEMAIN CORE FOR THE ICT,SET LENGTH FIELDS,  */
*   /* AND FREE THE GTA FILES                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0126
*   CALL TCLMOPUP;                  /*                               */
@RF00124 BAL   @14,TCLMOPUP                                        0126
*   RFY                             /*                               */
*     RTNCODE RSTD;                 /*                               */
*   TCLRTNCD=RTNCODE;               /* SAVE RETURN CODE              */
         STC   RTNCODE,TCLRTNCD                                    0128
*   RFY                             /*                               */
*     RTNCODE UNRSTD;               /*                               */
*                                                                  0130
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE HMA420 MESSAGES FOR NON-NOGO SYSMODS IN THE ICT WHICH   */
*   /* HAVE BYPASSED REQUISITES                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0130
*   IF TBLXTRC<STOPFUNC             /* A/A/R NOT TERMINATING         */
*     THEN                                                         0130
         L     @09,@PC00001                                        0130
         CLI   TBLXTRC(@09),12                                     0130
         BNL   @RF00130                                            0130
*     CALL BYPREQS;                 /*                               */
         BAL   @14,BYPREQS                                         0131
*   RESPECIFY                                                      0132
*     RTNCODE RSTD;                                                0132
@RF00130 DS    0H                                                  0133
*   TCLRTNCD=MAX(TCLRTNCD,RTNCODE); /* MAINTAIN RETURN CODE          */
         SLR   @14,@14                                             0133
         IC    @14,TCLRTNCD                                        0133
         CR    @14,RTNCODE                                         0133
         BNL   *+6
         LR    @14,RTNCODE                                         0133
         STC   @14,TCLRTNCD                                        0133
*   RESPECIFY                                                      0134
*     RTNCODE UNRSTD;                                              0134
*                                                                  0135
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE HMA434 MESSAGES FOR SELECTED ELEMENTS WHICH DO NOT HAVE */
*   /* A TARGET LIBRARY (APPLY AND RESTORE)                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0135
*   IF TBLXTRC<STOPFUNC             /* A/A/R NOT TERMINATING         */
*       &(CCAAPPLY=ON               /* APPLY                         */
*       ×CCARES=ON)                 /* RESTORE                       */
*     THEN                                                         0135
         L     @09,@PC00001                                        0135
         CLI   TBLXTRC(@09),12                                     0135
         BNL   @RF00135                                            0135
         TM    CCAAPPLY(CCAPTR),B'01001000'                        0135
         BZ    @RF00135                                            0135
*     DO;                                                          0136
*       CALL NOLIBCHK;              /* CHECK SELECTED ELEMENTS IN ICT*/
         BAL   @14,NOLIBCHK                                        0137
*       RESPECIFY                                                  0138
*         RTNCODE RSTD;                                            0138
*       TCLRTNCD=MAX(TCLRTNCD,RTNCODE);/* MAINTAIN RETURN CODE       */
         SLR   @14,@14                                             0139
         IC    @14,TCLRTNCD                                        0139
         CR    @14,RTNCODE                                         0139
         BNL   *+6
         LR    @14,RTNCODE                                         0139
         STC   @14,TCLRTNCD                                        0139
*       RESPECIFY                                                  0140
*         RTNCODE UNRSTD;                                          0140
*     END;                                                         0141
*                                                                  0142
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINES TO CHECK FOR SYSMODS THAT DO NOT APPLY TO THE   */
*   /* SYSTEM AND SET THE CCA PROCESSOR BITS                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0142
*   IF TBLXTRC<STOPFUNC             /* A/A/R NOT TERMINATING         */
*       &TCLRTNCD<STOPFUNC          /* TCL NOT TERMINATING           */
*       &CCAICT^=ZERO               /* VALID PTR TO ICT              */
*     THEN                                                         0142
@RF00135 L     @09,@PC00001                                        0142
         CLI   TBLXTRC(@09),12                                     0142
         BNL   @RF00142                                            0142
         CLI   TCLRTNCD,12                                         0142
         BNL   @RF00142                                            0142
         ICM   @09,15,CCAICT(CCAPTR)                               0142
         BZ    @RF00142                                            0142
*     DO;                           /* ALL PREVIOUS FUNCTIONS WERE OK
*                                      CHECK FOR THE FOLLOWING     0143
*                                      CONDITIONS                    */
*                                                                  0144
*       /*************************************************************/
*       /*                                                           */
*       /* CALL PROCEDURE TO LOOP THRU PTFS,MODS, AND LMODS TO SET   */
*       /* ALL THE NOGO,COMPLETE, AND MESSAGE BITS FOR ALL APPLICABLE*/
*       /* ELEMENTS                                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0144
*       CALL NOGOCHCK;              /* RETURN CODE IS ALWAYS ZERO    */
         BAL   @14,NOGOCHCK                                        0144
*                                                                  0145
*       /*************************************************************/
*       /*                                                           */
*       /* CALL PROCEDURE TO CHECK FOR ANY PTFS WHERE NONE OF ITS    */
*       /* SUB-ELEMENTS APPLY TO THE SYSTEM                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0145
*       CALL NOTAPCHK;              /* RETURN CODE IS ALWAYS ZERO    */
         BAL   @14,NOTAPCHK                                        0145
*     END;                          /*                               */
*                                                                  0147
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL PROCEDURE TO LOOP THRU THE ICT TO SEE IF ANY PTFS WERE   */
*   /* MARKED NOGO AND TO SEE IF NO PTFS MET SPECIFICATIONS          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0147
*   IF TBLXTRC<STOPFUNC             /* A/A/R NOT TERMINATING         */
*       &TCLRTNCD<STOPFUNC          /* TCL NOT TERMINATING           */
*       &CCAICT^=ZERO               /* VALID ICT POINTER             */
*     THEN                                                         0147
@RF00142 L     @09,@PC00001                                        0147
         CLI   TBLXTRC(@09),12                                     0147
         BNL   @RF00147                                            0147
         CLI   TCLRTNCD,12                                         0147
         BNL   @RF00147                                            0147
         ICM   @09,15,CCAICT(CCAPTR)                               0147
         BZ    @RF00147                                            0147
*     DO;                                                          0148
*       CALL NOPTFSCK;              /* CHK FOR NON APPLICABLE SYSMODS*/
         BAL   @14,NOPTFSCK                                        0149
*       RFY                                                        0150
*         RTNCODE RSTD;                                            0150
*       TCLRTNCD=MAX(TCLRTNCD,RTNCODE);/* SET RETURN CODE IF HIGHER  */
         SLR   @14,@14                                             0151
         IC    @14,TCLRTNCD                                        0151
         CR    @14,RTNCODE                                         0151
         BNL   *+6
         LR    @14,RTNCODE                                         0151
         STC   @14,TCLRTNCD                                        0151
*       RFY                                                        0152
*         RTNCODE UNRSTD;                                          0152
*     END;                                                         0153
*                                                                  0154
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE SECOND IOP IF ONE WAS GETMAINED VIA CALLING HMASMSUB */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0154
*   IF TBLXIOP2^=ZERO               /* WAS THE SECOND IOP GETMAINED? */
*     THEN                          /* YES                           */
@RF00147 L     @09,@PC00001                                        0154
         L     @09,TBLXIOP2(,@09)                                  0154
         LTR   @09,@09                                             0154
         BZ    @RF00154                                            0154
*     DO;                           /* THEN FREE IT                  */
*       RFY                         /*                               */
*         RTNCODE RSTD;             /*                               */
*       HMASMSPL=''B;               /* CLEAR THE PARAMETER           */
         XC    HMASMSPL(5),HMASMSPL                                0157
*       SPLFUNCT=SPLFMIOP;          /* FREE THE IOP                  */
         MVI   SPLFUNCT,X'04'                                      0158
*       SPLPMAD=TBLXIOP2;           /* ADDRESS OF IOP TO BE FREED    */
         ST    @09,SPLPMAD                                         0159
*       CALL HMASMSUB(HMASMSPL);    /* CALL SUB PROC TO DO FREEING   */
         L     @15,@CV01006                                        0160
         LA    @01,@AL00160                                        0160
         BALR  @14,@15                                             0160
*       RFY                         /*                               */
*         RTNCODE UNRSTD;           /*                               */
*     END;                          /* END FREE PROCESSING           */
*                                                                  0163
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE THIRD IOP IF ONE WAS GETMAINED VIA CALLING HMASMSUB  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0163
*   IF TBLXIOP3^=ZERO               /* WAS THE SECOND IOP GETMAINED? */
*     THEN                          /* YES                           */
@RF00154 L     @09,@PC00001                                        0163
         L     @09,TBLXIOP3(,@09)                                  0163
         LTR   @09,@09                                             0163
         BZ    @RF00163                                            0163
*     DO;                           /* THEN FREE IT                  */
*       RFY                         /*                               */
*         RTNCODE RSTD;             /*                               */
*       HMASMSPL=''B;               /* CLEAR THE PARAMETER           */
         XC    HMASMSPL(5),HMASMSPL                                0166
*       SPLFUNCT=SPLFMIOP;          /* FREE THE IOP                  */
         MVI   SPLFUNCT,X'04'                                      0167
*       SPLPMAD=TBLXIOP3;           /* ADDRESS OF IOP TO BE FREED    */
         ST    @09,SPLPMAD                                         0168
*       CALL HMASMSUB(HMASMSPL);    /* CALL SUB PROC TO DO FREEING   */
         L     @15,@CV01006                                        0169
         LA    @01,@AL00169                                        0169
         BALR  @14,@15                                             0169
*       RFY                         /*                               */
*         RTNCODE UNRSTD;           /*                               */
*     END;                          /* END FREE PROCESSING           */
*   RETURN CODE(TCLRTNCD);          /* RETURN WITH TCLRTNCD RC       */
@RF00163 SLR   @15,@15                                             0172
         IC    @15,TCLRTNCD                                        0172
         L     @13,4(,@13)                                         0172
         L     @14,12(,@13)                                        0172
         LM    @00,@12,20(@13)                                     0172
         BR    @14                                                 0172
         EJECT
*                                                                  0173
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO GET ANOTHER IOP, GET AND SET UP POINTERS TO THE ICT*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0173
*TCLMOPUP:                                                         0173
*   PROC;                                                          0173
*                                                                  0173
TCLMOPUP STM   @14,@12,@SA00002                                    0173
*   /*****************************************************************/
*   /*                                                               */
*   /* SET AND INITIALIZE VARIABLES                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0174
*   DCL                                                            0174
*     FREELEN FIXED(24);            /* LENGTH OF AREA TO FREE        */
*   DCL                                                            0175
*     FREETOP FIXED(31);            /* TOP OF AREA TO FREE           */
*   DCL                                                            0176
*     FREELENA PTR(31);             /* ADDR OF AREA TO BE FREED      */
*   DCL                             /*                               */
*     MOPUPRTN FIXED(8);            /* TCLMOPUP RETURN CODE AREA     */
*   MOPUPRTN=ZERO;                  /* INITIALIZE RETURN CODE AREA   */
         MVI   MOPUPRTN,X'00'                                      0178
*   FREELENA=ZERO;                  /* INITIALIZE THE ADDR FLD FOR 0179
*                                      THE AREA TO BE FREMAINED TO 0179
*                                      ZERO                          */
         SLR   @09,@09                                             0179
         ST    @09,FREELENA                                        0179
*   FREELEN=ZERO;                   /* INITIALIZE THE FREELENGTH FLD
*                                      TO ZERO                       */
         STCM  @09,7,FREELEN                                       0180
*   RFY                                                            0181
*     ICTPTF BASED(CCAICPTF);       /* PTF BASE                      */
*   RFY                                                            0182
*     ICTIXPF BASED(TBLXSTRT);      /*                               */
*   RFY                                                            0183
*     HMASMIOP BASED(ADDR(FIXIOP)); /*                               */
*   TBLXINDX=TBLXINDX&&TBLXINDX;    /* ZERO TBL PARM                 */
*                                                                  0184
         L     @15,@PC00001                                        0184
         XC    TBLXINDX(12,@15),TBLXINDX(@15)                      0184
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE WAS NO ICT BUILT THEN THE LMD,MOD,AND PTF POINTERS   */
*   /* ARE ZERO                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0185
*   IF TBLXIBGN=ZERO&CCAICT=ZERO THEN                              0185
         C     @09,TBLXIBGN(,@15)                                  0185
         BNE   @RF00185                                            0185
         C     @09,CCAICT(,CCAPTR)                                 0185
         BNE   @RF00185                                            0185
*     DO;                           /* IF THE END OF THE GETMAINED 0186
*                                      AREA IS ZERO THE THERE IS     */
*       CCAICLMD=ZERO;              /* NO LMOD SECTION TO BE FREED   */
         ST    @09,CCAICLMD(,CCAPTR)                               0187
*       CCAICMOD=ZERO;              /* NO MOD SECTION TO BE FREED    */
         ST    @09,CCAICMOD(,CCAPTR)                               0188
*       CCAICPTF=ZERO;              /* NO PTF SECTION TO BE FREED    */
         ST    @09,CCAICPTF(,CCAPTR)                               0189
*     END;                          /*                               */
*                                                                  0190
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE WAS AN ICT BUILT THEN FREE THEN SETUP TO FREE THE    */
*   /* UNUSED PORTION OF THE GETMAINED AREA FOR THE ICT              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0191
*   IF TBLXIBGN^=ZERO THEN                                         0191
@RF00185 L     @09,@PC00001                                        0191
         L     @09,TBLXIBGN(,@09)                                  0191
         LTR   @09,@09                                             0191
         BZ    @RF00191                                            0191
*     DO;                           /* THERE IS AN ICT AND FREE THE
*                                      UNUSED PORTION                */
*       FREETOP=CCAICLMD;           /* ASSUME TOP OF AREA TO FREE IS
*                                      BOTTOM OF LMOD SECTION        */
         L     @15,CCAICLMD(,CCAPTR)                               0193
         ST    @15,FREETOP                                         0193
*       IF CCAICMOD>=TBLXIBGN THEN  /* IS MOD SECTION ABOVE BEGINNING*/
         L     @14,CCAICMOD(,CCAPTR)                               0194
         CR    @14,@09                                             0194
         BL    @RF00194                                            0194
*         DO;                       /* YES,                          */
*           FREETOP=MIN(FREETOP,CCAICMOD);/* TOP OF AREA TO FREE     */
         CR    @15,@14                                             0196
         BNH   *+6
         LR    @15,@14                                             0196
         ST    @15,FREETOP                                         0196
*         END;                                                     0197
*       IF CCAICT>=TBLXIBGN THEN    /* ICTCORE SECTION ABOVE       0198
*                                      BEGINNING?                    */
@RF00194 L     @09,CCAICT(,CCAPTR)                                 0198
         L     @15,@PC00001                                        0198
         C     @09,TBLXIBGN(,@15)                                  0198
         BL    @RF00198                                            0198
*         DO;                       /* YES,                          */
*           FREETOP=MIN(CCAICT,FREETOP);/* ...                       */
         L     @15,FREETOP                                         0200
         CR    @09,@15                                             0200
         BNH   *+6
         LR    @09,@15                                             0200
         ST    @09,FREETOP                                         0200
*         END;                                                     0201
*       FREELENA=TBLXIBGN;          /* AREA TO FREE                  */
@RF00198 L     @09,@PC00001                                        0202
         L     @09,TBLXIBGN(,@09)                                  0202
         ST    @09,FREELENA                                        0202
*       FREELEN=FREETOP-TBLXIBGN;   /* LENGTH OF AREA TO FREE        */
         L     @15,FREETOP                                         0203
         SLR   @15,@09                                             0203
         STCM  @15,7,FREELEN                                       0203
*       FREELEN=(FREELEN/8)*8;      /* ROUND DOWN TO A DOUBLE WORD 0204
*                                      BDY                           */
*                                                                  0204
         SRL   @15,3                                               0204
         SLA   @15,3                                               0204
         STCM  @15,7,FREELEN                                       0204
*       /*************************************************************/
*       /*                                                           */
*       /* FREEMAIN CORE FOR THE ICT THAT WAS UNUSED.                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0205
*       IF FREELEN^=ZERO THEN       /* STORAGE TO FREE?              */
         LTR   @15,@15                                             0205
         BZ    @RF00205                                            0205
*         DO;                       /* YES,                          */
*           RFY                                                    0207
*            (R0,                                                  0207
*             R1) RSTD;             /* RESTRICT REGS 0 AND 1         */
*           R0=FREELEN;             /* LENGTH TO BE FREED            */
         LR    R0,@15                                              0208
*           R1=FREELENA;            /* ADDR OF AREA TO BE FREED      */
         LR    R1,@09                                              0209
*           GEN CODE( FREEMAIN R,A=(1),LV=(0))                     0210
*           REFS(R0,R1);                                           0210
          FREEMAIN R,A=(1),LV=(0)
*           RFY                                                    0211
*            (R0,                                                  0211
*             R1) UNRSTD;           /* UNRESTRICT REGS 0 AND 1       */
*         END;                                                     0212
*       ELSE                                                       0213
*         ;                         /* NO STORAGE TO FREE            */
@RF00205 DS    0H                                                  0214
*     END;                          /* END FREEMAIN SECTION          */
*                                                                  0214
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE ASSEMBLY GTA FILE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0215
*   IF TBLXASGT^=ZERO THEN                                         0215
@RF00191 L     @09,@PC00001                                        0215
         L     @09,TBLXASGT(,@09)                                  0215
         LTR   @09,@09                                             0215
         BZ    @RF00215                                            0215
*     DO;                           /*                               */
*       RFY                                                        0217
*         HMASMGTP BASED(TBLXASGT); /*                               */
*       GTPFUNCT=GTPFREE;           /* FUNCTION IS TO FREE THE ASMS  */
         MVI   GTPFUNCT(@09),X'0A'                                 0218
*       CALL HMASMGTA(HMASMGTP);    /* CALL PROCEDURE                */
         ST    @09,@AL00001                                        0219
         L     @15,@CV01005                                        0219
         LA    @01,@AL00001                                        0219
         BALR  @14,@15                                             0219
*       MOPUPRTN=GTPRETRN;          /* SET RETURN FROM GTPFREE(=ZERO)*/
         L     @09,@PC00001                                        0220
         L     @09,TBLXASGT(,@09)                                  0220
         MVC   MOPUPRTN(1),GTPRETRN(@09)                           0220
*       RFY                                                        0221
*         HMASMGTP BASED;           /*                               */
*     END;                          /*                               */
*                                                                  0222
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE SYSMOD CANDIDATE GTP FILE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0223
*   IF TBLXSCGT^=ZERO THEN                                         0223
@RF00215 L     @09,@PC00001                                        0223
         L     @09,TBLXSCGT(,@09)                                  0223
         LTR   @09,@09                                             0223
         BZ    @RF00223                                            0223
*     DO;                           /*                               */
*       RFY                                                        0225
*         HMASMGTP BASED(TBLXSCGT); /*                               */
*       GTPFUNCT=GTPFREE;           /* FUNC IS FREE SYSMOD CANDIDATES*/
         MVI   GTPFUNCT(@09),X'0A'                                 0226
*       CALL HMASMGTA(HMASMGTP);    /* CALL PROCEDURE                */
         ST    @09,@AL00001                                        0227
         L     @15,@CV01005                                        0227
         LA    @01,@AL00001                                        0227
         BALR  @14,@15                                             0227
*       MOPUPRTN=MAX(MOPUPRTN,GTPRETRN);/* SET RETURN TO MAX RETURN
*                                      CODE ENCOUNTERED              */
         L     @09,@PC00001                                        0228
         L     @09,TBLXSCGT(,@09)                                  0228
         SLR   @15,@15                                             0228
         IC    @15,MOPUPRTN                                        0228
         SLR   @14,@14                                             0228
         IC    @14,GTPRETRN(,@09)                                  0228
         CR    @15,@14                                             0228
         BNL   *+6
         LR    @15,@14                                             0228
         STC   @15,MOPUPRTN                                        0228
*       RFY                                                        0229
*         HMASMGTP BASED;           /*                               */
*     END;                          /*                               */
*                                                                  0230
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE LMOD GTA FILE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0231
*   IF TBLXLMGT^=ZERO THEN                                         0231
@RF00223 L     @09,@PC00001                                        0231
         L     @09,TBLXLMGT(,@09)                                  0231
         LTR   @09,@09                                             0231
         BZ    @RF00231                                            0231
*     DO;                           /*                               */
*       RFY                                                        0233
*         HMASMGTP BASED(TBLXLMGT); /*                               */
*       GTPFUNCT=GTPFREE;           /* FUNCTION IS TO FREE THE LMODS */
         MVI   GTPFUNCT(@09),X'0A'                                 0234
*       CALL HMASMGTA(HMASMGTP);    /* CALL PROCEDURE                */
         ST    @09,@AL00001                                        0235
         L     @15,@CV01005                                        0235
         LA    @01,@AL00001                                        0235
         BALR  @14,@15                                             0235
*       MOPUPRTN=MAX(MOPUPRTN,GTPRETRN);/* SET RETURN TO MAX RETURN
*                                      CODE ENCOUNTERED              */
         L     @09,@PC00001                                        0236
         L     @09,TBLXLMGT(,@09)                                  0236
         SLR   @15,@15                                             0236
         IC    @15,MOPUPRTN                                        0236
         SLR   @14,@14                                             0236
         IC    @14,GTPRETRN(,@09)                                  0236
         CR    @15,@14                                             0236
         BNL   *+6
         LR    @15,@14                                             0236
         STC   @15,MOPUPRTN                                        0236
*       RFY                                                        0237
*         HMASMGTP BASED;           /*                               */
*     END;                          /*                               */
*                                                                  0238
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE SYSMOD-FMID GTA FILE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0239
*   RFY                                                            0239
*     HMASMGTP BASED(TBLXDLGT);     /* ADDRESS SYSMOD-FMID GTP       */
@RF00231 DS    0H                                                  0240
*   IF TBLXDLGT^=0                  /* GTP WAS INITIALIZED BY TD1    */
*     THEN                                                         0240
         L     @09,@PC00001                                        0240
         L     @09,TBLXDLGT(,@09)                                  0240
         LTR   @09,@09                                             0240
         BZ    @RF00240                                            0240
*     DO;                                                          0241
*       GTPFUNCT=GTPFREE;           /* FUNCTION IS TO FREE GTA FILE  */
         MVI   GTPFUNCT(@09),X'0A'                                 0242
*       CALL HMASMGTA(HMASMGTP);    /* CALL PROCEDURE                */
         ST    @09,@AL00001                                        0243
         L     @15,@CV01005                                        0243
         LA    @01,@AL00001                                        0243
         BALR  @14,@15                                             0243
*       MOPUPRTN=MAX(MOPUPRTN,GTPRETRN);/* MAINTAIN RETURN CODE      */
         L     @09,@PC00001                                        0244
         L     @09,TBLXDLGT(,@09)                                  0244
         SLR   @15,@15                                             0244
         IC    @15,MOPUPRTN                                        0244
         SLR   @14,@14                                             0244
         IC    @14,GTPRETRN(,@09)                                  0244
         CR    @15,@14                                             0244
         BNL   *+6
         LR    @15,@14                                             0244
         STC   @15,MOPUPRTN                                        0244
*     END;                                                         0245
*   RFY                                                            0246
*     HMASMGTP BASED;                                              0246
@RF00240 DS    0H                                                  0247
*   RETURN CODE(MOPUPRTN);          /* RETURN MUST BE ZERO           */
         SLR   @15,@15                                             0247
         IC    @15,MOPUPRTN                                        0247
         L     @14,@SA00002                                        0247
         LM    @00,@12,@SA00002+8                                  0247
         BR    @14                                                 0247
*   END TCLMOPUP;                   /*                               */
         EJECT
*NOGOCHCK:                                                         0249
*   PROC;                                                          0249
*                                                                  0249
NOGOCHCK STM   @14,@12,@SA00003                                    0249
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE CALLED TO MARK ALL APPLICABLE ENTRIES NOGO, COMPLETE*/
*   /* AND MESSAGE SENT                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0250
*                                                                  0250
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP AND INITIALIZE VARIABLES                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0250
*   DECLARE                         /*                               */
*    (NGI,                                                         0250
*     NGJ,                                                         0250
*     NGK,                                                         0250
*     NGL) FIXED(31);               /* LOOP VARIABLES                */
*   RFY                                                            0251
*     ICTPTF BASED(CCAICPTF);       /*                               */
*   RFY                                                            0252
*     ICTIXPF BASED(ICTPCHN(NGI));  /*                               */
*   RFY                                                            0253
*     ICTMOD BASED(ICTIXP(NGJ));    /*                               */
*                                                                  0253
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU PTFS. IF PTF IS NOGO THEN ALL MODS FOR THAT PTF ARE */
*   /* NOGO                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0254
*   DO NGI=1 BY 1 WHILE ICTPEND(NGI)^=ICTENDNT;/* LOOP THRU PTFS     */
         LA    @09,1                                               0254
         ST    @09,NGI                                             0254
         B     @DE00254                                            0254
@DL00254 DS    0H                                                  0255
*     IF ICTPNOGO(NGI)=ON           /* PTF NOGO?                     */
*       THEN                        /* YES                           */
         L     @09,NGI                                             0255
         MH    @09,@CH01202                                        0255
         L     @15,CCAICPTF(,CCAPTR)                               0255
         ST    @09,@TF00001                                        0255
         ALR   @09,@15                                             0255
         AL    @09,@CF01220                                        0255
         TM    ICTPNOGO-8(@09),B'01000000'                         0255
         BNO   @RF00255                                            0255
*       DO;                         /* MUST MARK MODS NOGO           */
*         ICTPROCS(NGI)=OFF;        /* NOT IN PROCESS SINCE THIS MOD7
*                                      WILL PUT OUT ERR MSG          */
         LR    @09,@15                                             0257
         AL    @09,@TF00001                                        0257
         AL    @09,@CF01220                                        0257
         NI    ICTPROCS-8(@09),B'01111111'                         0257
*         ICTPECPL(NGI)=ON;         /* PTF COMPLETE                  */
         LR    @09,@15                                             0258
         AL    @09,@TF00001                                        0258
         AL    @09,@CF01222                                        0258
         OI    ICTPECPL-14(@09),B'01000000'                        0258
*         IF ICTPMSG(NGI)=OFF       /* HAS PTF MSG BEEN SENT         */
*             &TBLXTRC<STOPFUNC     /* SMP FUNCTION NOT TERMINATING  */
*           THEN                    /* NO                            */
         LR    @09,@15                                             0259
         AL    @09,@TF00001                                        0259
         AL    @09,@CF01220                                        0259
         TM    ICTPMSG-8(@09),B'00010000'                          0259
         BNZ   @RF00259                                            0259
         L     @09,@PC00001                                        0259
         CLI   TBLXTRC(@09),12                                     0259
         BNL   @RF00259                                            0259
*           DO;                     /* WRITE IT NOW                  */
*             MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MSG PARM           */
         XC    MGPCLEAR(6),MGPCLEAR                                0261
*             MGPTYPE=MGPINFO;      /* SET MESSAGE SEVERITY          */
         MVI   MGPTYPE,X'01'                                       0262
*             MGPMGNO1=HMA226I;     /* XXXXXXXX PROCESSING TERMINATED*/
         SLR   @14,@14                                             0263
         IC    @14,HMA226I                                         0263
         STH   @14,MGPMGNO1                                        0263
*             MGPMGNO2=PART011;     /* FOR PTF XXXXXXX               */
         SLR   @14,@14                                             0264
         IC    @14,PART011                                         0264
         STH   @14,MGPMGNO2                                        0264
*             MGPVARPT(1)=ADDR(TBLXFUNC);/* SMP FUNCTION             */
         LA    @09,TBLXFUNC(,@09)                                  0265
         ST    @09,MGPVARPT                                        0265
*             MGPVARPT(2)=ADDR(ICTPTFS(NGI));/* PTF NUMBER           */
         L     @09,@TF00001                                        0266
         AL    @09,@CF01224                                        0266
         LA    @09,ICTPTFS(@09,@15)                                0266
         ST    @09,MGPVARPT+4                                      0266
*             ICTPMSG(NGI)=ON;      /* SET PTF MSG SENT              */
         AL    @15,@TF00001                                        0267
         AL    @15,@CF01220                                        0267
         OI    ICTPMSG-8(@15),B'00010000'                          0267
*             CALL HMASMMSG(HMASMMGP);/* WRITE MSG                   */
         L     @15,@CV01004                                        0268
         LA    @01,@AL00268                                        0268
         BALR  @14,@15                                             0268
*           END;                    /* PTF COMPLETE IF NOGO          */
*         IF ICTPCHN(NGI)^=0        /* MOD SECTION ENTRIES PRESENT   */
*           THEN                                                   0270
@RF00259 L     @09,NGI                                             0270
         MH    @09,@CH01202                                        0270
         L     @01,CCAICPTF(,CCAPTR)                               0270
         AL    @01,@CF01226                                        0270
         L     @09,ICTPCHN-64(@09,@01)                             0270
         LTR   @09,@09                                             0270
         BZ    @RF00270                                            0270
*           DO;                                                    0271
*                                                                  0271
*             /*******************************************************/
*             /*                                                     */
*             /* GO THRU MODS FOR THIS SYSMOD                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0272
*             DO NGJ=1 BY 1 WHILE ICTIXP(NGJ)^=ICTENDIX;/* LOOP THRU
*                                      PTF TO MOD INDICIES           */
         LA    @09,1                                               0272
         ST    @09,NGJ                                             0272
         B     @DE00272                                            0272
@DL00272 DS    0H                                                  0273
*               ICTMNOGO(1)=ON;     /* MOD IS NOGO                   */
*               ICTMCPL(1)=ON;      /* MOD IS COMPLETED              */
*               ICTMMSG(1)=ON;      /* MSG NOT NEEDED                */
         L     @09,NGJ                                             0275
         LR    @15,@09                                             0275
         SLA   @15,2                                               0275
         L     @14,NGI                                             0275
         MH    @14,@CH01202                                        0275
         L     @01,CCAICPTF(,CCAPTR)                               0275
         AL    @01,@CF01226                                        0275
         L     @01,ICTPCHN-64(@14,@01)                             0275
         AL    @01,@CF01227                                        0275
         L     @01,ICTIXP(@15,@01)                                 0275
         OI    ICTMNOGO(@01),B'01110000'                           0275
*             END;                  /* END MOD LOOP                  */
         AH    @09,@CH00063                                        0276
         ST    @09,NGJ                                             0276
@DE00272 L     @09,NGJ                                             0276
         SLA   @09,2                                               0276
         L     @15,NGI                                             0276
         MH    @15,@CH01202                                        0276
         L     @01,CCAICPTF(,CCAPTR)                               0276
         AL    @01,@CF01226                                        0276
         L     @01,ICTPCHN-64(@15,@01)                             0276
         AL    @01,@CF01227                                        0276
         L     @09,ICTIXP(@09,@01)                                 0276
         CL    @09,ICTENDIX                                        0276
         BNE   @DL00272                                            0276
*           END;                                                   0277
*         ELSE                                                     0278
*           ICTPCHN(NGI)=TBLXNULL;  /* POINT TO EMPTY LIST           */
         B     @RC00270                                            0278
@RF00270 L     @09,NGI                                             0278
         MH    @09,@CH01202                                        0278
         L     @01,CCAICPTF(,CCAPTR)                               0278
         L     @15,@PC00001                                        0278
         L     @00,TBLXNULL(,@15)                                  0278
         AL    @01,@CF01226                                        0278
         ST    @00,ICTPCHN-64(@09,@01)                             0278
*       END;                        /* END PTF NOGO GROUP            */
@RC00270 DS    0H                                                  0280
*   END;                            /* END PTF LOOP                  */
*                                                                  0280
@RF00255 LA    @09,1                                               0280
         AL    @09,NGI                                             0280
         ST    @09,NGI                                             0280
@DE00254 L     @09,NGI                                             0280
         MH    @09,@CH01202                                        0280
         L     @01,CCAICPTF(,CCAPTR)                               0280
         AL    @01,@CF01224                                        0280
         L     @09,ICTPEND(@09,@01)                                0280
         CL    @09,ICTENDNT                                        0280
         BNE   @DL00254                                            0280
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION OF CODE LOOPS ON THE LMOD ICT SECTION AND MARKS  */
*   /* ALL LMOD COMPLETE IF ALL ITS ASSOCIATED MODULES ARE MARKED    */
*   /* COMPLETE                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0281
*   RFY                                                            0281
*     ICTLMOD BASED(CCAICLMD);      /* ICT LMOD BASE                 */
*   RFY                                                            0282
*     ICTIXLF BASED(ICTLCHN(NGK));  /* BASE FOR LMOD TO MOD CHAIN    */
*   RFY                                                            0283
*     ICTMOD BASED(ICTIXL(NGL));    /* MOD BASED ON LMOD TO MOD PTR  */
*   RFY                                                            0284
*     ICTPTF BASED(ICTPPTR(1));     /* PTF BASED ON MOD PTR          */
*   DO NGK=1 BY 1 WHILE ICTLEND(NGK)^=ICTENDNT;/* LOOP THRU LMODS    */
         LA    @09,1                                               0285
         ST    @09,NGK                                             0285
         B     @DE00285                                            0285
@DL00285 DS    0H                                                  0286
*     IF ICTLCHN(NGK)=0             /* NO MODS FOR THIS LMOD         */
*       THEN                                                       0286
         L     @09,NGK                                             0286
         MH    @09,@CH01203                                        0286
         L     @15,CCAICLMD(,CCAPTR)                               0286
         LA    @01,0(@09,@15)                                      0286
         AL    @01,@CF01228                                        0286
         L     @14,ICTLCHN-34(,@01)                                0286
         LTR   @14,@14                                             0286
         BNZ   @RF00286                                            0286
*       ICTLCHN(NGK)=TBLXNULL;      /* POINT TO EMPTY LIST           */
         L     @14,@PC00001                                        0287
         L     @14,TBLXNULL(,@14)                                  0287
         AL    @15,@CF01228                                        0287
         ST    @14,ICTLCHN-34(@09,@15)                             0287
*     DO NGL=1 BY 1 WHILE ICTIXL(NGL)^=ICTENDIX;/* LOOP THRU ICT LMOD
*                                      TO MOD INDICIES               */
@RF00286 LA    @09,1                                               0288
         ST    @09,NGL                                             0288
         B     @DE00288                                            0288
@DL00288 DS    0H                                                  0289
*       IF ICTMCPL(1)=OFF           /* BR OUT OF LOOP WHEN ONE MOD   */
*         THEN                      /* IS FOUND NOT COMPLETE         */
         L     @09,NGL                                             0289
         LR    @15,@09                                             0289
         SLA   @15,2                                               0289
         L     @14,NGK                                             0289
         MH    @14,@CH01203                                        0289
         L     @01,CCAICLMD(,CCAPTR)                               0289
         AL    @01,@CF01228                                        0289
         L     @01,ICTLCHN-34(@14,@01)                             0289
         AL    @01,@CF01227                                        0289
         L     @01,ICTIXL(@15,@01)                                 0289
         TM    ICTMCPL(@01),B'00100000'                            0289
         BZ    @RT00289                                            0289
*         GO TO LMDNTCPL;           /*                               */
*     END;                          /* END LOOP ON INDICIES          */
*                                                                  0291
         AH    @09,@CH00063                                        0291
         ST    @09,NGL                                             0291
@DE00288 L     @09,NGL                                             0291
         SLA   @09,2                                               0291
         L     @15,NGK                                             0291
         MH    @15,@CH01203                                        0291
         L     @14,CCAICLMD(,CCAPTR)                               0291
         LA    @01,0(@15,@14)                                      0291
         AL    @01,@CF01228                                        0291
         L     @01,ICTLCHN-34(,@01)                                0291
         AL    @01,@CF01227                                        0291
         L     @09,ICTIXL(@09,@01)                                 0291
         CL    @09,ICTENDIX                                        0291
         BNE   @DL00288                                            0291
*     /***************************************************************/
*     /*                                                             */
*     /* FALL THRU TO HERE MEANS ALL MODS FOR LMOD ARE COMPLETE THUS */
*     /* THE LMOD IS ALSO COMPLETE                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0292
*     ICTLCPL(NGK)=ON;              /* LMOD IS COMPLETE              */
         ALR   @14,@15                                             0292
         AL    @14,@CF01229                                        0292
         OI    ICTLCPL-8(@14),B'00100000'                          0292
*LMDNTCPL:                          /*                               */
*   END;                            /* END OF LOOP ON LMODS          */
LMDNTCPL LA    @09,1                                               0293
         AL    @09,NGK                                             0293
         ST    @09,NGK                                             0293
@DE00285 L     @09,NGK                                             0293
         MH    @09,@CH01203                                        0293
         L     @01,CCAICLMD(,CCAPTR)                               0293
         AL    @01,@CF01231                                        0293
         L     @09,ICTLEND(@09,@01)                                0293
         CL    @09,ICTENDNT                                        0293
         BNE   @DL00285                                            0293
*   RETURN CODE(ZERO);              /*                               */
         SLR   @15,@15                                             0294
         L     @14,@SA00003                                        0294
         LM    @00,@12,@SA00003+8                                  0294
         BR    @14                                                 0294
*   END NOGOCHCK;                   /*                               */
         EJECT
*NOTAPCHK:                                                         0296
*   PROC;                           /*                               */
*                                                                  0296
NOTAPCHK STM   @14,@12,12(@13)                                     0296
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE IS CALLED TO LOOP THRU THE MOD SECT. OF EACH   */
*   /* PTF CHECKING PTFS THAT CONTAIN ALL MODULES THAT DO NOT APPLY  */
*   /* TO ANY LOAD MODULES. IF ONE IS FOUND IT IS MARKED IN PROCESS  */
*   /* AND COMPLETE SO THAT A MESSAGE WILL BE WRITTEN OUT FIRST THING*/
*   /* BY THE PROCESSING PROGRAM(HMASMAPP OR HMASMRES) SETUP AND     */
*   /* INITIALIZE VARIABLES                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0297
*   RFY                                                            0297
*     ICTPTF BASED(CCAICPTF);       /* PTF BASE                      */
*   RFY                                                            0298
*     ICTIXPF BASED(ICTPCHN(PTFX)); /* PTF TO MOD CHAIN              */
*   RFY                                                            0299
*     ICTMOD BASED(ICTIXP(PTFIX));  /* PTR TO MODS                   */
*   RFY                                                            0300
*     ICTIXMF BASED(ICTMCHN(1));    /* MOD TO LMOD CHAIN             */
*   RFY                                                            0301
*     ICTLMOD BASED(ICTIXM(MODIX)); /* LMOD BASE                     */
*   DO PTFX=1 BY 1 WHILE ICTPEND(PTFX)^=ICTENDNT;/* LOOP THRU PTFS   */
         LA    @09,1                                               0302
         ST    @09,PTFX                                            0302
         B     @DE00302                                            0302
@DL00302 DS    0H                                                  0303
*     IF ICTPNOGO(PTFX)=OFF         /* PTF NOT ALREADY NOGO          */
*         &ICTPECPL(PTFX)=OFF       /* AND PTF NOT ALREADY COMPLETE  */
*         &ICTPROCS(PTFX)=OFF       /* AND IN PROCESS                */
*       THEN                        /* IF NOT THEN DO CHECK          */
         L     @09,PTFX                                            0303
         MH    @09,@CH01202                                        0303
         L     @15,CCAICPTF(,CCAPTR)                               0303
         ST    @09,@TF00001                                        0303
         ALR   @09,@15                                             0303
         AL    @09,@CF01220                                        0303
         TM    ICTPNOGO-8(@09),B'01000000'                         0303
         BNZ   @RF00303                                            0303
         LR    @09,@15                                             0303
         AL    @09,@TF00001                                        0303
         AL    @09,@CF01222                                        0303
         TM    ICTPECPL-14(@09),B'01000000'                        0303
         BNZ   @RF00303                                            0303
         LR    @09,@15                                             0303
         AL    @09,@TF00001                                        0303
         AL    @09,@CF01220                                        0303
         TM    ICTPROCS-8(@09),B'10000000'                         0303
         BNZ   @RF00303                                            0303
*       DO;                         /*                               */
*         IF ICTPCHN(PTFX)^=0       /* MOD SECTION ENTRIES PRESENT   */
*           THEN                                                   0305
         L     @09,@TF00001                                        0305
         AL    @15,@CF01226                                        0305
         L     @09,ICTPCHN-64(@09,@15)                             0305
         LTR   @09,@09                                             0305
         BZ    @RF00305                                            0305
*           DO;                                                    0306
*                                                                  0306
*             /*******************************************************/
*             /*                                                     */
*             /* GO THRU MODS FOR THIS SYSMOD                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0307
*             DO PTFIX=1 BY 1 WHILE ICTIXP(PTFIX)^=ICTENDIX;/* LOOP
*                                      THRU MODS FOR PTF             */
         LA    @09,1                                               0307
         ST    @09,PTFIX                                           0307
         B     @DE00307                                            0307
@DL00307 DS    0H                                                  0308
*               IF ICTIXM(1)^=ICTENDIX/* IF MOD HAS VALID PTR TO LMOD*/
*                   ×ICTMISEL(1)=OFF/* MODULE NOT SELECTED           */
*                   ×ICTMMACR(1)=OFF/* NOT A MACRO REPLACEMENT       */
*                   ×ICTMMACU(1)=OFF/* NOT A MACRO UPDATE            */
*                   ×ICTMSRCR(1)=OFF/* NOT A SOURCE REPLACEMENT      */
*                   ×ICTMSRCU(1)=OFF/* NOT A SOURCE UPDATE           */
*                 THEN              /* YES                           */
         L     @09,PTFIX                                           0308
         LR    @15,@09                                             0308
         SLA   @15,2                                               0308
         L     @14,PTFX                                            0308
         MH    @14,@CH01202                                        0308
         L     @01,CCAICPTF(,CCAPTR)                               0308
         AL    @01,@CF01226                                        0308
         L     @01,ICTPCHN-64(@14,@01)                             0308
         AL    @01,@CF01227                                        0308
         L     @15,ICTIXP(@15,@01)                                 0308
         L     @01,ICTMCHN(,@15)                                   0308
         CLC   ICTIXM(4,@01),ICTENDIX                              0308
         BNE   @RT00308                                            0308
         TM    ICTMISEL(@15),B'10000000'                           0308
         BZ    @RT00308                                            0308
         TM    ICTMMACR(@15),B'00001111'                           0308
         BNO   @RT00308                                            0308
*                 GO TO GOTLMOD1;   /* BR OUT OF LOOP                */
*             END;                  /* END LOOP ON PTF MODS          */
         AH    @09,@CH00063                                        0310
         ST    @09,PTFIX                                           0310
@DE00307 L     @09,PTFIX                                           0310
         SLA   @09,2                                               0310
         L     @15,PTFX                                            0310
         MH    @15,@CH01202                                        0310
         L     @01,CCAICPTF(,CCAPTR)                               0310
         AL    @01,@CF01226                                        0310
         L     @01,ICTPCHN-64(@15,@01)                             0310
         AL    @01,@CF01227                                        0310
         L     @09,ICTIXP(@09,@01)                                 0310
         CL    @09,ICTENDIX                                        0310
         BNE   @DL00307                                            0310
*           END;                                                   0311
*         ELSE                                                     0312
*           ICTPCHN(PTFX)=TBLXNULL; /* POINT TO EMPTY LIST           */
         B     @RC00305                                            0312
@RF00305 L     @09,PTFX                                            0312
         MH    @09,@CH01202                                        0312
         L     @01,CCAICPTF(,CCAPTR)                               0312
         L     @15,@PC00001                                        0312
         L     @00,TBLXNULL(,@15)                                  0312
         AL    @01,@CF01226                                        0312
         ST    @00,ICTPCHN-64(@09,@01)                             0312
*         ICTPECPL(PTFX)=ON;        /* MARK PTF COMPLETE             */
@RC00305 L     @09,PTFX                                            0313
         MH    @09,@CH01202                                        0313
         L     @15,CCAICPTF(,CCAPTR)                               0313
         ST    @09,@TF00001                                        0313
         ALR   @09,@15                                             0313
         AL    @09,@CF01222                                        0313
         OI    ICTPECPL-14(@09),B'01000000'                        0313
*         ICTPROCS(PTFX)=ON;        /* MARK PTF PROCESS              */
         AL    @15,@TF00001                                        0314
         AL    @15,@CF01220                                        0314
         OI    ICTPROCS-8(@15),B'10000000'                         0314
*       END;                        /* END PTF DOES NOT HAVE UPDATES */
*GOTLMOD1:                          /* BR TO HERE IF MOD HAD LMODS   */
*   END;                            /* END LOOP ON ICT PTFS          */
@RF00303 DS    0H                                                  0316
GOTLMOD1 LA    @09,1                                               0316
         AL    @09,PTFX                                            0316
         ST    @09,PTFX                                            0316
@DE00302 L     @09,PTFX                                            0316
         MH    @09,@CH01202                                        0316
         L     @01,CCAICPTF(,CCAPTR)                               0316
         AL    @01,@CF01224                                        0316
         L     @09,ICTPEND(@09,@01)                                0316
         CL    @09,ICTENDNT                                        0316
         BNE   @DL00302                                            0316
*   RETURN CODE(ZERO);              /* SET RTN CODE AND RETURN       */
         SLR   @15,@15                                             0317
         L     @14,12(,@13)                                        0317
         LM    @00,@12,20(@13)                                     0317
         BR    @14                                                 0317
*   END NOTAPCHK;                   /* END PROC                      */
         EJECT
*NOPTFSCK:                                                         0319
*   PROC;                           /*                               */
*                                                                  0319
NOPTFSCK STM   @14,@12,@SA00005                                    0319
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO LOOP THRU ICT PTF SECTION TO SEE IF ANY OR ALL   */
*   /* PTFS WERE IN ERROR SETUP AND INITIALIZE VARIABLES             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0320
*   RFY                                                            0320
*     ICTPTF BASED(CCAICPTF);       /* PTF BASE                      */
*   RFY                                                            0321
*     ICTIXPF BASED(ICTPCHN(PTFX)); /* PTF TO MOD CHAIN              */
*   RFY                                                            0322
*     ICTMOD BASED(ICTIXP(PTFIX));  /* PTR TO MODS                   */
*   RFY                                                            0323
*     ICTIXMF BASED(ICTMCHN(1));    /* MOD TO LMOD CHAIN             */
*   RFY                                                            0324
*     ICTLMOD BASED(ICTIXM(MODIX)); /* LMOD BASE                     */
*   ONEPTFOK=OFF;                   /* INITIALIZE TO NO PTF FOUND    */
         NI    ONEPTFOK,B'01111111'                                0325
*   DECLARE                         /*                               */
*     NOPTFSRT FIXED(8);            /* RETURN CODE                   */
*   NOPTFSRT=ZERO;                  /* INIT RETURN CODE              */
         MVI   NOPTFSRT,X'00'                                      0327
*   DO PTFX=1 BY 1 WHILE ICTPEND(PTFX)^=ICTENDNT;/* LOOP THRU PTFS   */
         LA    @09,1                                               0328
         ST    @09,PTFX                                            0328
         B     @DE00328                                            0328
@DL00328 DS    0H                                                  0329
*     IF ICTPNOGO(PTFX)=OFF         /* IS PTF NOT NOGO??             */
*       THEN                        /* YES                           */
         L     @09,PTFX                                            0329
         MH    @09,@CH01202                                        0329
         L     @01,CCAICPTF(,CCAPTR)                               0329
         ALR   @01,@09                                             0329
         AL    @01,@CF01220                                        0329
         TM    ICTPNOGO-8(@01),B'01000000'                         0329
         BNZ   @RF00329                                            0329
*       DO;                         /*                               */
*         ONEPTFOK=ON;              /* SET ONE GOOD PTF FOUND        */
         OI    ONEPTFOK,B'10000000'                                0331
*       END;                        /*                               */
*     ELSE                          /* NOGO IS ON                    */
*       DO;                         /*                               */
         B     @RC00329                                            0333
@RF00329 DS    0H                                                  0334
*         IF ICTPTYPE(PTFX)=IOPPFUNC/* IS PTF FUNCTION BIT OFF??     */
*           THEN                    /* YES                           */
         L     @09,PTFX                                            0334
         MH    @09,@CH01202                                        0334
         L     @01,CCAICPTF(,CCAPTR)                               0334
         AL    @01,@CF01233                                        0334
         SLR   @00,@00                                             0334
         IC    @00,ICTPTYPE-17(@09,@01)                            0334
         CH    @00,@CH00037                                        0334
         BNE   @RF00334                                            0334
*           DO;                     /*                               */
*             NOPTFSRT=STOPFUNC;    /* SET RETURN CODE               */
         MVI   NOPTFSRT,X'0C'                                      0336
*           END;                    /*                               */
*         ELSE                      /* PTF IS NOT FUNC               */
*           DO;                     /*                               */
         B     @RC00334                                            0338
@RF00334 DS    0H                                                  0339
*             NOPTFSRT=MAX(NOPTFSRT,STOPPTF);/* SET MAX RETURN CODE  */
         SLR   @09,@09                                             0339
         IC    @09,NOPTFSRT                                        0339
         LA    @15,8                                               0339
         CR    @09,@15                                             0339
         BNL   *+6
         LR    @09,@15                                             0339
         STC   @09,NOPTFSRT                                        0339
*           END;                    /*                               */
*       END;                        /*                               */
@RC00334 DS    0H                                                  0342
*   END;                            /* END PTF LOOP                  */
*                                                                  0342
@RC00329 LA    @09,1                                               0342
         AL    @09,PTFX                                            0342
         ST    @09,PTFX                                            0342
@DE00328 L     @09,PTFX                                            0342
         MH    @09,@CH01202                                        0342
         L     @01,CCAICPTF(,CCAPTR)                               0342
         AL    @01,@CF01224                                        0342
         L     @09,ICTPEND(@09,@01)                                0342
         CL    @09,ICTENDNT                                        0342
         BNE   @DL00328                                            0342
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF PTF LOOP. IF NO VALID PTFS WERE FOUND THEN PUT OUT     */
*   /* ERROR MESSAGE                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0343
*   IF ONEPTFOK=OFF                 /* ANY VALID PTFS LEFT?          */
*       &TBLXTRC<STOPFUNC           /* FUNCTION HAS NOT BEEN STOPED  */
*       &TCLRTNCD<STOPFUNC          /* FUNCTION HAS NOT BEEN STOPED  */
*     THEN                          /* NO                            */
         TM    ONEPTFOK,B'10000000'                                0343
         BNZ   @RF00343                                            0343
         L     @09,@PC00001                                        0343
         CLI   TBLXTRC(@09),12                                     0343
         BNL   @RF00343                                            0343
         CLI   TCLRTNCD,12                                         0343
         BNL   @RF00343                                            0343
*     DO;                           /* ERROR                         */
*       MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MSG NUMBERS              */
         XC    MGPCLEAR(6),MGPCLEAR                                0345
*       MGPTYPE=MGPSEV;             /* SET MESSAGE SEVERITY          */
         MVI   MGPTYPE,X'04'                                       0346
*       MGPPRINT=ON;                /* ROUTE MESSAGE TO PRINTER      */
*       MGPHLDS=ON;                 /* ROUTE MESSAGE TO SMPLOG       */
         OI    MGPPRINT,B'10010000'                                0348
*       MGPMGNO1=HMA248I;           /* THE XXXXXXXX OPTION WAS     0349
*                                      REQUESTED - NO PTFS MEET    0349
*                                      SPECIFIECATIONS               */
         SLR   @15,@15                                             0349
         IC    @15,HMA248I                                         0349
         STH   @15,MGPMGNO1                                        0349
*       MGPVARPT(1)=ADDR(TBLXFUNC); /* SMP FUNCTION                  */
         LA    @09,TBLXFUNC(,@09)                                  0350
         ST    @09,MGPVARPT                                        0350
*       CALL HMASMMSG(HMASMMGP);    /* WRITE MSG                     */
         L     @15,@CV01004                                        0351
         LA    @01,@AL00351                                        0351
         BALR  @14,@15                                             0351
*       NOPTFSRT=STOPFUNC;          /* SET NO PTF RTN CODE           */
         MVI   NOPTFSRT,X'0C'                                      0352
*     END;                          /* END OF NO VALID PTFS GROUP    */
*   RETURN CODE(NOPTFSRT);          /* RETURN WITH CODE SET UP       */
@RF00343 SLR   @15,@15                                             0354
         IC    @15,NOPTFSRT                                        0354
         L     @14,@SA00005                                        0354
         LM    @00,@12,@SA00005+8                                  0354
         BR    @14                                                 0354
*   END NOPTFSCK;                   /* END PROC                      */
*                                                                  0356
*/****************************************************************** */
*/*                                                                  */
*/* BYPREQS - LIST BYPASSED REQUISITES FOR NON-NOGO SYSMODS IN THE   */
*/*           ICT                                                    */
*/*                                                                  */
*/*                                                                  */
*/****************************************************************** */
*                                                                  0356
*BYPREQS:                                                          0356
*   PROC;                                                          0356
BYPREQS  STM   @14,@12,@SA00006                                    0356
*   DCL                                                            0357
*     BYPRTN FIXED(31);             /* 0 - NO BYPASSED REQUISITES  0357
*                                      .... 4 - BYPASSED REQUISITES
*                                      .....                         */
*   DCL                                                            0358
*     KK FIXED(15);                 /* INDEX - ICT PTF SECTION ENTRY */
*   BYPRTN=0;                       /* CLEAR RETURN CODE             */
         SLR   @09,@09                                             0359
         ST    @09,BYPRTN                                          0359
*   RESPECIFY                                                      0360
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE PTF SECTION    */
*   IF CCAICPTF^=0                  /* PTF SECTION BUILT             */
*     THEN                                                         0361
         C     @09,CCAICPTF(,CCAPTR)                               0361
         BE    @RF00361                                            0361
*     DO;                                                          0362
*                                                                  0362
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL SYSMODS IN THE ICT PTF SECTION                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0363
*       DO KK=1 BY 1 WHILE ICTPEND(KK)^=ICTENDNT;                  0363
         LA    @09,1                                               0363
         STH   @09,KK                                              0363
         B     @DE00363                                            0363
@DL00363 DS    0H                                                  0364
*         IF ICTPNOGO(KK)=OFF       /* SYSMOD IS NOT NOGO            */
*             &ICTPGELM(KK)=OFF     /* SYSMOD IS NOT ELIMINATED      */
*             &ICTPSUPN(KK)=0       /* SYSMOD IS NOT SUPERSEDED      */
*             &ICTPRQCK(KK)=ON      /* REQ CHECKING HAS BEEN DONE    */
*             &ICTPRQOK(KK)=ON      /* REQ CHECKING SUCCESSFUL       */
*             &ICTPRQBY(KK)=ON      /* REQS WERE BYPASSED            */
*           THEN                                                   0364
         LH    @09,KK                                              0364
         MH    @09,@CH01202                                        0364
         L     @15,CCAICPTF(,CCAPTR)                               0364
         ST    @09,@TF00001                                        0364
         ALR   @09,@15                                             0364
         AL    @09,@CF01220                                        0364
         TM    ICTPNOGO-8(@09),B'01000000'                         0364
         BNZ   @RF00364                                            0364
         LR    @09,@15                                             0364
         AL    @09,@TF00001                                        0364
         AL    @09,@CF01234                                        0364
         TM    ICTPGELM-13(@09),B'00001000'                        0364
         BNZ   @RF00364                                            0364
         LR    @09,@15                                             0364
         AL    @09,@TF00001                                        0364
         AL    @09,@CF01235                                        0364
         SLR   @14,@14                                             0364
         ICM   @14,3,ICTPSUPN-20(@09)                              0364
         LTR   @14,@14                                             0364
         BNZ   @RF00364                                            0364
         LR    @09,@15                                             0364
         AL    @09,@TF00001                                        0364
         AL    @09,@CF01236                                        0364
         TM    ICTPRQCK-15(@09),B'00001110'                        0364
         BNO   @RF00364                                            0364
*           DO;                                                    0365
*             CALL REQLIST(ICTPTF(KK));/* LIST BYPASSED REQUISITES   */
         L     @09,@TF00001                                        0366
         AL    @15,@CF01224                                        0366
         LA    @09,ICTPTF(@09,@15)                                 0366
         ST    @09,@AL00001                                        0366
         LA    @01,@AL00001                                        0366
         BAL   @14,REQLIST                                         0366
*             BYPRTN=PTFWARN;       /* SET WARNING RETURN CODE       */
         MVC   BYPRTN(4),@CF00037                                  0367
*           END;                                                   0368
*       END;                                                       0369
@RF00364 LA    @09,1                                               0369
         AH    @09,KK                                              0369
         STH   @09,KK                                              0369
@DE00363 LH    @09,KK                                              0369
         MH    @09,@CH01202                                        0369
         L     @01,CCAICPTF(,CCAPTR)                               0369
         AL    @01,@CF01224                                        0369
         L     @09,ICTPEND(@09,@01)                                0369
         CL    @09,ICTENDNT                                        0369
         BNE   @DL00363                                            0369
*     END;                                                         0370
*   RETURN CODE(BYPRTN);                                           0371
@RF00361 L     @15,BYPRTN                                          0371
         L     @14,@SA00006                                        0371
         LM    @00,@12,@SA00006+8                                  0371
         BR    @14                                                 0371
*   END BYPREQS;                                                   0372
*                                                                  0373
*/****************************************************************** */
*/*                                                                  */
*/* REQLIST - LIST BYPASSED REQUISITES IN THE LIST FOR THE CURRENT   */
*/*           SYSMOD                                                 */
*/*                                                                  */
*/*                                                                  */
*/****************************************************************** */
*                                                                  0373
*REQLIST:                                                          0373
*   PROC(RLPTFENT,REQMSGID);                                       0373
REQLIST  STM   @14,@12,@SA00007                                    0373
         MVC   @PC00007(8),0(@01)                                  0373
*   DCL                                                            0374
*     RLPTFENT CHAR(*);             /* ICT PTF SECTION ENTRY         */
*   DCL                                                            0375
*     REQMSGID FIXED(8);            /* ID OF MESSAGE TO ISSUE        */
*   DCL                                                            0376
*     II FIXED(15);                 /* LOCAL INDEX - REQ LIST ENTRIES*/
*   DCL                                                            0377
*     REQNAME CHAR(7);              /* REQ SYSMOD ID# ... MSG      0377
*                                      VARIABLE                      */
*   DCL                                                            0378
*     REQTYPE CHAR(8);              /* REQ SYSMOD TYPE .. MSG      0378
*                                      VARIABLE                      */
*   DCL                                                            0379
*     REQSTAT CHAR(12);             /* REQ SYSMOD STATUS. MSG      0379
*                                      VARIABLE                      */
*   DCL                                                            0380
*     REQCSR CHAR(7);               /* REQ CAUSER ....... MSG      0380
*                                      VARIABLE                      */
*   RESPECIFY                                                      0381
*     ICTPTF BASED(ADDR(RLPTFENT)); /* ADDRESS PTF SECT ENTRY PASSED */
*   RESPECIFY                                                      0382
*     ICTREQLS BASED(ICTPRCHN(1));  /* ADDRESS "CURRENT" REQ LIST    */
*   RESPECIFY                                                      0383
*     ICTPRELS BASED(ICTPPCHN(1));  /* ADDRESS "CURRENT" PREREQ LIST */
*   RESPECIFY                                                      0384
*     ICTIRQLS BASED(ICTPICHN(1));  /* ADDRESS "CURRENT" IFREQ LIST  */
*   MGPCLEAR=''B;                   /* CLEAR MESSAGE NUMBERS         */
         XC    MGPCLEAR(6),MGPCLEAR                                0385
*   MGPFLAGS=''B;                   /* CLEAR FLAGS                   */
*                                                                  0386
         XC    MGPFLAGS(2),MGPFLAGS                                0386
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE HMA420I "REQUISITE SYSMODS BYPASSED FOR SYSMOD   #######*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0387
*   MGPMGNO1=HMA420I;               /* MESSAGE NUMBER                */
         MVC   MGPMGNO1(2),@CH01014                                0387
*   MGPVARPT(1)=ADDR(ICTPTFS(1));   /* SYSMOD NUMBER                 */
         L     @09,@PC00007                                        0388
         ST    @09,MGPVARPT                                        0388
*   MGPTYPE=MGPWARN;                /* WARNING MESSAGE               */
         MVI   MGPTYPE,X'02'                                       0389
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */
         OI    MGPPRINT,B'10010000'                                0391
*   CALL HMASMMSG(HMASMMGP);                                       0392
*                                                                  0392
         L     @15,@CV01004                                        0392
         LA    @01,@AL00392                                        0392
         BALR  @14,@15                                             0392
*   /*****************************************************************/
*   /*                                                               */
*   /* LIST BYPASSED PREREQS FOR THIS SYSMOD                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0393
*   DO II=1 BY 1 WHILE ICTPREND(II)^=ICTENDIX;                     0393
         LA    @09,1                                               0393
         STH   @09,II                                              0393
         B     @DE00393                                            0393
@DL00393 DS    0H                                                  0394
*     IF ICTPREQS(II)=ON            /* REQ SATISFIED INDICATOR       */
*         &ICTPREQB(II)=ON          /* REQ BYPASSED INDICATOR        */
*       THEN                                                       0394
         LH    @09,II                                              0394
         SLA   @09,3                                               0394
         L     @15,@PC00007                                        0394
         L     @15,ICTPPCHN(,@15)                                  0394
         ST    @09,@TF00001                                        0394
         ALR   @09,@15                                             0394
         BCTR  @09,0                                               0394
         TM    ICTPREQS-7(@09),B'00011000'                         0394
         BNO   @RF00394                                            0394
*       DO;                                                        0395
*         REQNAME=ICTPRENM(II);     /* REQ SYSMOD NAME               */
         AL    @15,@TF00001                                        0396
         AL    @15,@CF01237                                        0396
         MVC   REQNAME(7),ICTPRENM(@15)                            0396
*         REQTYPE=MSGPRE;           /* REQ TYPE = PRE                */
         MVC   REQTYPE(8),@CC01038                                 0397
*         REQSTAT=MSGBYP;           /* REQUISITE STATUS - "BYPASSED" */
         MVC   REQSTAT(12),@CC01042                                0398
*         REQCSR=NULLPTF#;          /* BLANK CAUSER FOR MSG          */
         MVC   REQCSR(7),@CC01024                                  0399
*         CALL REQLMSG;             /* ISSUE MESSAGE                 */
         BAL   @14,REQLMSG                                         0400
*       END;                                                       0401
*   END;                                                           0402
*                                                                  0402
@RF00394 LA    @09,1                                               0402
         AH    @09,II                                              0402
         STH   @09,II                                              0402
@DE00393 LH    @09,II                                              0402
         SLA   @09,3                                               0402
         L     @15,@PC00007                                        0402
         L     @01,ICTPPCHN(,@15)                                  0402
         AL    @01,@CF01237                                        0402
         L     @09,ICTPREND(@09,@01)                               0402
         CL    @09,ICTENDIX                                        0402
         BNE   @DL00393                                            0402
*   /*****************************************************************/
*   /*                                                               */
*   /* LIST BYPASSED REQS FOR THIS SYSMOD                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*   DO II=1 BY 1 WHILE ICTREQND(II)^=ICTENDIX;                     0403
         LA    @09,1                                               0403
         STH   @09,II                                              0403
         B     @DE00403                                            0403
@DL00403 DS    0H                                                  0404
*     IF ICTRREQS(II)=ON            /* REQ SATISFIED INDICATOR       */
*         &ICTRREQB(II)=ON          /* REQ BYPASSED INDICATOR        */
*       THEN                                                       0404
         LH    @09,II                                              0404
         SLA   @09,3                                               0404
         L     @15,@PC00007                                        0404
         L     @15,ICTPRCHN(,@15)                                  0404
         ST    @09,@TF00001                                        0404
         ALR   @09,@15                                             0404
         BCTR  @09,0                                               0404
         TM    ICTRREQS-7(@09),B'00011000'                         0404
         BNO   @RF00404                                            0404
*       DO;                                                        0405
*         REQNAME=ICTREQNM(II);     /* REQ SYSMOD NAME               */
         AL    @15,@TF00001                                        0406
         AL    @15,@CF01237                                        0406
         MVC   REQNAME(7),ICTREQNM(@15)                            0406
*         REQTYPE=MSGREQ;           /* REQ TYPE = REQ                */
         MVC   REQTYPE(8),@CC01036                                 0407
*         REQSTAT=MSGBYP;           /* REQUISITE STATUS - "BYPASSED" */
         MVC   REQSTAT(12),@CC01042                                0408
*         REQCSR=NULLPTF#;          /* BLANK CAUSER FOR MSG          */
         MVC   REQCSR(7),@CC01024                                  0409
*         CALL REQLMSG;             /* ISSUE MESSAGE                 */
         BAL   @14,REQLMSG                                         0410
*       END;                                                       0411
*   END;                                                           0412
*                                                                  0412
@RF00404 LA    @09,1                                               0412
         AH    @09,II                                              0412
         STH   @09,II                                              0412
@DE00403 LH    @09,II                                              0412
         SLA   @09,3                                               0412
         L     @15,@PC00007                                        0412
         L     @01,ICTPRCHN(,@15)                                  0412
         AL    @01,@CF01237                                        0412
         L     @09,ICTREQND(@09,@01)                               0412
         CL    @09,ICTENDIX                                        0412
         BNE   @DL00403                                            0412
*   /*****************************************************************/
*   /*                                                               */
*   /* LIST BYPASSED IFREQS FOR THIS SYSMOD                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0413
*   DO II=1 BY 1 WHILE ICTIRQND(II)^=ICTENDIX;                     0413
         LA    @09,1                                               0413
         STH   @09,II                                              0413
         B     @DE00413                                            0413
@DL00413 DS    0H                                                  0414
*     IF ICTIREQS(II)=ON            /* REQ SATISFIED INDICATOR       */
*         &ICTIREQB(II)=ON          /* REQ BYPASSED INDICATOR        */
*       THEN                                                       0414
         LH    @09,II                                              0414
         SLA   @09,4                                               0414
         L     @15,@PC00007                                        0414
         L     @14,ICTPICHN(,@15)                                  0414
         ST    @09,@TF00001                                        0414
         ALR   @09,@14                                             0414
         AL    @09,@CF01238                                        0414
         TM    ICTIREQS-7(@09),B'00011000'                         0414
         BNO   @RF00414                                            0414
*       DO;                                                        0415
*         REQNAME=ICTIRQNM(II);     /* REQ SYSMOD NAME               */
         LR    @09,@14                                             0416
         AL    @09,@TF00001                                        0416
         AL    @09,@CF01239                                        0416
         MVC   REQNAME(7),ICTIRQNM(@09)                            0416
*         REQTYPE=MSGIFREQ;         /* REQ TYPE = IFREQ              */
         MVC   REQTYPE(8),@CC01040                                 0417
*         REQSTAT=MSGBYP;           /* REQUISITE STATUS - "BYPASSED" */
         MVC   REQSTAT(12),@CC01042                                0418
*         IF ICTCSRNM(II)^=ICTPTFS(1)/* CAUSER IS NOT "SELF"         */
*           THEN                                                   0419
         LR    @09,@14                                             0419
         AL    @09,@TF00001                                        0419
         AL    @09,@CF01237                                        0419
         CLC   ICTCSRNM-8(7,@09),ICTPTFS(@15)                      0419
         BE    @RF00419                                            0419
*           REQCSR=ICTCSRNM(II);    /* INITIALIZE CAUSER FOR MSG     */
         AL    @14,@TF00001                                        0420
         AL    @14,@CF01237                                        0420
         MVC   REQCSR(7),ICTCSRNM-8(@14)                           0420
*         ELSE                                                     0421
*           REQCSR=NULLPTF#;        /* BLANK CAUSER FOR MSG          */
         B     @RC00419                                            0421
@RF00419 MVC   REQCSR(7),@CC01024                                  0421
*         CALL REQLMSG;             /* ISSUE MESSAGE                 */
@RC00419 BAL   @14,REQLMSG                                         0422
*       END;                                                       0423
*   END;                                                           0424
@RF00414 LA    @09,1                                               0424
         AH    @09,II                                              0424
         STH   @09,II                                              0424
@DE00413 LH    @09,II                                              0424
         SLA   @09,4                                               0424
         L     @15,@PC00007                                        0424
         L     @01,ICTPICHN(,@15)                                  0424
         AL    @01,@CF01239                                        0424
         L     @09,ICTIRQND(@09,@01)                               0424
         CL    @09,ICTENDIX                                        0424
         BNE   @DL00413                                            0424
*   RETURN;                                                        0425
@EL00007 DS    0H                                                  0425
@EF00007 DS    0H                                                  0425
@ER00007 LM    @14,@12,@SA00007                                    0425
         BR    @14                                                 0425
*REQLMSG:                                                          0426
*   PROC;                                                          0426
*                                                                  0426
REQLMSG  STM   @14,@12,@SA00008                                    0426
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE HMA359I - MISSING/NOGO OR BYPASSED REQUISITES FOLLOWING */
*   /* HMA420I                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */
         XC    MGPCLEAR(6),MGPCLEAR                                0427
*   MGPFLAGS=''B;                   /* CLEAR HMASMMSG FLAGS          */
         XC    MGPFLAGS(2),MGPFLAGS                                0428
*   MGPMGNO1=HMA359I;               /* MESSAGE NUMBER                */
         MVC   MGPMGNO1(2),@CH01012                                0429
*   MGPMGNO2=PART091;               /* MESSAGE PART NUMBER           */
         SLR   @09,@09                                             0430
         IC    @09,PART091                                         0430
         STH   @09,MGPMGNO2                                        0430
*   IF REQCSR^=NULLPTF#             /* CAUSER PRESENT                */
*     THEN                                                         0431
         CLC   REQCSR(7),@CC01024                                  0431
         BE    @RF00431                                            0431
*     MGPMGNO3=PART130;             /* MESSAGE PART FOR CAUSER SYSMOD*/
         SLR   @09,@09                                             0432
         IC    @09,PART130                                         0432
         STH   @09,MGPMGNO3                                        0432
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */
@RF00431 DS    0H                                                  0434
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */
         OI    MGPPRINT,B'10010000'                                0434
*   MGPTYPE=MGPINFO;                /* INFORMATIONAL MESSAGE         */
         MVI   MGPTYPE,X'01'                                       0435
*   MGPVARPT(1)=ADDR(REQNAME);      /* VARIABLE PART: SYSMOD-ID      */
         LA    @09,REQNAME                                         0436
         ST    @09,MGPVARPT                                        0436
*   MGPVARPT(2)=ADDR(REQTYPE);      /* VARIABLE PART: REQUISITE TYPE */
         LA    @09,REQTYPE                                         0437
         ST    @09,MGPVARPT+4                                      0437
*   MGPVARPT(3)=ADDR(REQSTAT);      /* VARIABLE PART: REQ STATUS     */
         LA    @09,REQSTAT                                         0438
         ST    @09,MGPVARPT+8                                      0438
*   MGPVARPT(4)=ADDR(REQCSR);       /* VARIABLE PART: REQ CAUSER     */
         LA    @09,REQCSR                                          0439
         ST    @09,MGPVARPT+12                                     0439
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE MESSAGE                 */
         L     @15,@CV01004                                        0440
         LA    @01,@AL00440                                        0440
         BALR  @14,@15                                             0440
*   RETURN;                                                        0441
@EL00008 DS    0H                                                  0441
@EF00008 DS    0H                                                  0441
@ER00008 LM    @14,@12,@SA00008                                    0441
         BR    @14                                                 0441
*   END REQLMSG;                                                   0442
*   END REQLIST;                                                   0443
*                                                                  0444
*/****************************************************************** */
*/*                                                                  */
*/* NOLIBCHK - ISSUE HMA434 FOR ANY SELECTED ELEMENTS WHICH HAVE     */
*/*            NOWHERE TO GO                                         */
*/*                                                                  */
*/*                                                                  */
*/****************************************************************** */
*                                                                  0444
*NOLIBCHK:                                                         0444
*   PROC;                                                          0444
NOLIBCHK STM   @14,@12,@SA00009                                    0444
*   DCL                                                            0445
*     NLBRTN FIXED(31);             /* RETURN CODE                   */
*   DCL                                                            0446
*     LL FIXED(15);                 /* INDEX - ICT PTF SECTION ENTRY */
*   DCL                                                            0447
*     MM FIXED(15);                 /* INDEX - ICTIXP LIST ENTRIES   */
*   DCL                                                            0448
*     NLBTYPE CHAR(8);              /* ELEMENT TYPE - EBCDIC         */
*   NLBRTN=0;                       /* CLEAR RETURN CODE             */
*                                                                  0449
         SLR   @09,@09                                             0449
         ST    @09,NLBRTN                                          0449
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP MGP FOR ANY MESSAGES TO BE ISSUED                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */
         XC    MGPCLEAR(6),MGPCLEAR                                0450
*   MGPTYPE=MGPINFO;                /* INFORMATIONAL                 */
         MVI   MGPTYPE,X'01'                                       0451
*   MGPMGNO1=HMA434I;               /* SET UP MESSAGE NUMBER         */
         MVC   MGPMGNO1(2),@CH01016                                0452
*   RESPECIFY                                                      0453
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE PTF SECTION    */
*   IF CCAICPTF^=0                  /* PTF SECTION BUILT             */
*     THEN                                                         0454
         C     @09,CCAICPTF(,CCAPTR)                               0454
         BE    @RF00454                                            0454
*     DO;                                                          0455
*                                                                  0455
*       /*************************************************************/
*       /*                                                           */
*       /* GO THRU ALL SYSMODS IN THE ICT PTF SECTION                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0456
*       DO LL=1 BY 1 WHILE ICTPEND(LL)^=ICTENDNT;                  0456
         LA    @09,1                                               0456
         STH   @09,LL                                              0456
         B     @DE00456                                            0456
@DL00456 DS    0H                                                  0457
*         IF ICTPNOGO(LL)=OFF       /* SYSMOD IS NOT NOGO            */
*             &ICTPDEXP(LL)=OFF     /* SYSMOD IS NOT DELETED         */
*             &ICTPDIMP(LL)=OFF     /* SYSMOD IS NOT DELETED         */
*             &ICTPGELM(LL)=OFF     /* SYSMOD IS NOT ELIMINATED      */
*             &ICTPSUPN(LL)=0       /* SYSMOD IS NOT SUPERSEDED      */
*             &ICTPMSL(LL)=ON       /* ELEMENT SELECTION DONE        */
*           THEN                                                   0457
         LH    @09,LL                                              0457
         MH    @09,@CH01202                                        0457
         L     @15,CCAICPTF(,CCAPTR)                               0457
         ST    @09,@TF00001                                        0457
         ALR   @09,@15                                             0457
         AL    @09,@CF01220                                        0457
         TM    ICTPNOGO-8(@09),B'01000000'                         0457
         BNZ   @RF00457                                            0457
         LR    @09,@15                                             0457
         AL    @09,@TF00001                                        0457
         AL    @09,@CF01234                                        0457
         TM    ICTPDEXP-13(@09),B'00111000'                        0457
         BNZ   @RF00457                                            0457
         LR    @09,@15                                             0457
         AL    @09,@TF00001                                        0457
         AL    @09,@CF01235                                        0457
         SLR   @14,@14                                             0457
         ICM   @14,3,ICTPSUPN-20(@09)                              0457
         LTR   @14,@14                                             0457
         BNZ   @RF00457                                            0457
         AL    @15,@TF00001                                        0457
         AL    @15,@CF01236                                        0457
         TM    ICTPMSL-15(@15),B'10000000'                         0457
         BNO   @RF00457                                            0457
*           DO;                                                    0458
*                                                                  0458
*             /*******************************************************/
*             /*                                                     */
*             /* GO THRU ALL ELEMENTS IN THE SYSMOD                  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0459
*             RESPECIFY                                            0459
*               ICTIXPF BASED(ICTPCHN(LL));/* ADDRESS LIST OF PTRS TO
*                                      MOD SECT ENTRIES              */
*             DO MM=1 BY 1 WHILE ICTIXP(MM)^=ICTENDIX;             0460
         LA    @09,1                                               0460
         STH   @09,MM                                              0460
         B     @DE00460                                            0460
@DL00460 DS    0H                                                  0461
*               RESPECIFY                                          0461
*                 ICTMOD BASED(ICTIXP(MM));/* ADDRESS MOD SECT ENTRY */
*               RESPECIFY                                          0462
*                 ICTIXMF BASED(ICTMCHN(1));/* ADDRESS LIST OF PTRS
*                                      TO LMOD SECT ENTRIES          */
*               NLBTYPE=NULLTYPE;   /* CLEAR ELEMENT TYPE            */
         MVC   NLBTYPE(8),@CC01059                                 0463
*               IF ICTMISEL(1)=ON   /* ELEMENT SELECTED              */
*                   &ICTMIDEL(1)=OFF/* ... NOT FOR DELETION          */
*                   &(ICTMMOD(1)=ON /* MODULE REPL OR ASSEMBLY       */
*                   ×ICTMZAP(1)=ON) /* ZAP                           */
*                   &ICTIXM(1)=ICTENDIX/* NO LMOD SECT POINTERS      */
*                 THEN                                             0464
         LH    @09,MM                                              0464
         SLA   @09,2                                               0464
         LH    @15,LL                                              0464
         MH    @15,@CH01202                                        0464
         L     @01,CCAICPTF(,CCAPTR)                               0464
         AL    @01,@CF01226                                        0464
         L     @01,ICTPCHN-64(@15,@01)                             0464
         AL    @01,@CF01227                                        0464
         L     @09,ICTIXP(@09,@01)                                 0464
         TM    ICTMISEL(@09),B'10000000'                           0464
         BNO   @RF00464                                            0464
         TM    ICTMIDEL(@09),B'01000000'                           0464
         BNZ   @RF00464                                            0464
         TM    ICTMMOD(@09),B'10100000'                            0464
         BZ    @RF00464                                            0464
         L     @01,ICTMCHN(,@09)                                   0464
         CLC   ICTIXM(4,@01),ICTENDIX                              0464
         BNE   @RF00464                                            0464
*                 CALL ELEMTYPE(ICTMOD(1),/* ELEMENT                 */
*                     NLBTYPE);     /* EBCDIC ELEM. TYPE             */
         ST    @09,@AL00001                                        0465
         LA    @09,NLBTYPE                                         0465
         ST    @09,@AL00001+4                                      0465
         LA    @01,@AL00001                                        0465
         BAL   @14,ELEMTYPE                                        0465
*               MGPVARPT(1)=ADDR(NLBTYPE);/* ELEMENT TYPE            */
@RF00464 LA    @09,NLBTYPE                                         0466
         ST    @09,MGPVARPT                                        0466
*               MGPVARPT(2)=ADDR(ICTMNAME(1));/* ELEMENT NAME        */
         LH    @09,MM                                              0467
         SLA   @09,2                                               0467
         LH    @15,LL                                              0467
         MH    @15,@CH01202                                        0467
         L     @14,CCAICPTF(,CCAPTR)                               0467
         LA    @01,0(@15,@14)                                      0467
         AL    @01,@CF01226                                        0467
         L     @01,ICTPCHN-64(,@01)                                0467
         AL    @01,@CF01227                                        0467
         L     @09,ICTIXP(@09,@01)                                 0467
         ST    @09,MGPVARPT+4                                      0467
*               MGPVARPT(3)=ADDR(ICTPTFS(LL));/* SYSMOD              */
         AL    @14,@CF01224                                        0468
         LA    @09,ICTPTFS(@15,@14)                                0468
         ST    @09,MGPVARPT+8                                      0468
*               IF NLBTYPE^=NULLTYPE/* VALID TYPE                    */
*                 THEN                                             0469
         CLC   NLBTYPE(8),@CC01059                                 0469
         BE    @RF00469                                            0469
*                 CALL HMASMMSG(HMASMMGP);/* ISSUE HMA434            */
         L     @15,@CV01004                                        0470
         LA    @01,@AL00470                                        0470
         BALR  @14,@15                                             0470
*             END;                  /* ELEMENTS IN ONE SYSMOD        */
@RF00469 LA    @09,1                                               0471
         AH    @09,MM                                              0471
         STH   @09,MM                                              0471
@DE00460 LH    @09,MM                                              0471
         SLA   @09,2                                               0471
         LH    @15,LL                                              0471
         MH    @15,@CH01202                                        0471
         L     @01,CCAICPTF(,CCAPTR)                               0471
         AL    @01,@CF01226                                        0471
         L     @01,ICTPCHN-64(@15,@01)                             0471
         AL    @01,@CF01227                                        0471
         L     @09,ICTIXP(@09,@01)                                 0471
         CL    @09,ICTENDIX                                        0471
         BNE   @DL00460                                            0471
*           END;                    /* NON-NOGO/NON-DELETED SYSMOD   */
*       END;                        /* ALL SYSMODS IN ICT            */
@RF00457 LA    @09,1                                               0473
         AH    @09,LL                                              0473
         STH   @09,LL                                              0473
@DE00456 LH    @09,LL                                              0473
         MH    @09,@CH01202                                        0473
         L     @01,CCAICPTF(,CCAPTR)                               0473
         AL    @01,@CF01224                                        0473
         L     @09,ICTPEND(@09,@01)                                0473
         CL    @09,ICTENDNT                                        0473
         BNE   @DL00456                                            0473
*     END;                          /* PTF SECTION BUILT             */
*   RETURN CODE(NLBRTN);                                           0475
@RF00454 L     @15,NLBRTN                                          0475
         L     @14,@SA00009                                        0475
         LM    @00,@12,@SA00009+8                                  0475
         BR    @14                                                 0475
*   END NOLIBCHK;                                                  0476
*                                                                  0477
*/****************************************************************** */
*/*                                                                  */
*/* ELEMTYPE - RETURN TO THE CALLER THE PRINTABLE ELEMENT TYPE       */
*/*            FOR THE ICT MOD SECTION ENTRY PASSED                  */
*/*                                                                  */
*/*                                                                  */
*/****************************************************************** */
*                                                                  0477
*ELEMTYPE:                                                         0477
*   PROC(ELEMENT,ELEMEBC);                                         0477
ELEMTYPE STM   @14,@12,12(@13)                                     0477
         MVC   @PC00010(8),0(@01)                                  0477
*   DCL                                                            0478
*     ELEMENT CHAR(*);              /* ICT MOD SECT ENTRY            */
*   DCL                                                            0479
*     ELEMEBC CHAR(8);              /* ELEMENT TYPE RETURNED         */
*   RESPECIFY                                                      0480
*     ICTMOD BASED(ADDR(ELEMENT));  /* ADDRESS ENTRY PASSED          */
*   IF ICTMMOD(1)=ON                /*                               */
*       &ICTMASM(1)=OFF             /*                               */
*     THEN                                                         0481
         L     @09,@PC00010                                        0481
         TM    ICTMMOD(@09),B'10000000'                            0481
         BNO   @RF00481                                            0481
         TM    ICTMASM(@09),B'01000000'                            0481
         BNZ   @RF00481                                            0481
*     ELEMEBC=MSGMOD;               /* "MODULE"                      */
         L     @09,@PC00010+4                                      0482
         MVC   ELEMEBC(8,@09),@CC01045                             0482
*   IF ICTMMOD(1)=ON                /*                               */
*       &ICTMASM(1)=ON              /*                               */
*     THEN                                                         0483
@RF00481 L     @09,@PC00010                                        0483
         TM    ICTMMOD(@09),B'11000000'                            0483
         BNO   @RF00483                                            0483
*     ELEMEBC=MSGASM;               /* "ASSEMBLY"                    */
         L     @09,@PC00010+4                                      0484
         MVC   ELEMEBC(8,@09),@CC01047                             0484
*   IF ICTMZAP(1)=ON                /*                               */
*     THEN                                                         0485
@RF00483 L     @09,@PC00010                                        0485
         TM    ICTMZAP(@09),B'00100000'                            0485
         BNO   @RF00485                                            0485
*     ELEMEBC=MSGZAP;               /* "ZAP "                        */
         L     @09,@PC00010+4                                      0486
         MVC   ELEMEBC(8,@09),@CC01049                             0486
*   IF ICTMMACR(1)=ON THEN                                         0487
@RF00485 L     @09,@PC00010                                        0487
         TM    ICTMMACR(@09),B'00001000'                           0487
         BNO   @RF00487                                            0487
*     ELEMEBC=MSGMAC;               /* "MACRO"                       */
         L     @09,@PC00010+4                                      0488
         MVC   ELEMEBC(8,@09),@CC01051                             0488
*   IF ICTMMACU(1)=ON THEN                                         0489
@RF00487 L     @09,@PC00010                                        0489
         TM    ICTMMACU(@09),B'00000100'                           0489
         BNO   @RF00489                                            0489
*     ELEMEBC=MSGMACU;              /* "MACUPD"                      */
         L     @09,@PC00010+4                                      0490
         MVC   ELEMEBC(8,@09),@CC01053                             0490
*   IF ICTMSRCR(1)=ON THEN                                         0491
@RF00489 L     @09,@PC00010                                        0491
         TM    ICTMSRCR(@09),B'00000010'                           0491
         BNO   @RF00491                                            0491
*     ELEMEBC=MSGSRC;               /* "SOURCE"                      */
         L     @09,@PC00010+4                                      0492
         MVC   ELEMEBC(8,@09),@CC01055                             0492
*   IF ICTMSRCU(1)=ON THEN                                         0493
@RF00491 L     @09,@PC00010                                        0493
         TM    ICTMSRCU(@09),B'00000001'                           0493
         BNO   @RF00493                                            0493
*     ELEMEBC=MSGSRCU;              /* "SRCUPD"                      */
         L     @09,@PC00010+4                                      0494
         MVC   ELEMEBC(8,@09),@CC01057                             0494
*   RETURN;                                                        0495
@EL00010 DS    0H                                                  0495
@EF00010 DS    0H                                                  0495
@ER00010 LM    @14,@12,12(@13)                                     0495
         BR    @14                                                 0495
*   END ELEMTYPE;                                                  0496
         B     @EL00010                                            0496
*                                                                  0497
*/****************************************************************** */
*/*                                                                  */
*/* TCLTERM  - ISSUE HMA226 FOR NON-NOGO SYSMODS ... THIS PROCEDURE  */
*/*            IS CALLED ONLY WHEN THE APPLY/ACCEPT/RESTORE FUNCTION */
*/*            IS BEING TERMINATED                                   */
*/*                                                                  */
*/****************************************************************** */
*                                                                  0497
*TCLTERM:                                                          0497
*   PROC;                                                          0497
TCLTERM  STM   @14,@12,@SA00011                                    0497
*   DCL                                                            0498
*     NN FIXED(15);                 /* INDEX - ICT PTF SECTION       */
*   RESPECIFY                                                      0499
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ICT PTF SECTION       */
*                                                                  0499
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THUR ICT PTF SECTION ENTRIES                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0500
*   DO NN=1 BY 1 WHILE ICTPEND(NN)^=ICTENDNT;/* NOT AT END           */
         LA    @09,1                                               0500
         STH   @09,NN                                              0500
         B     @DE00500                                            0500
@DL00500 DS    0H                                                  0501
*     IF ICTPNOGO(NN)=OFF           /* SYSMOD NOT MARKED NOGO        */
*       THEN                                                       0501
         LH    @09,NN                                              0501
         MH    @09,@CH01202                                        0501
         L     @15,CCAICPTF(,CCAPTR)                               0501
         ST    @09,@TF00001                                        0501
         ALR   @09,@15                                             0501
         AL    @09,@CF01220                                        0501
         TM    ICTPNOGO-8(@09),B'01000000'                         0501
         BNZ   @RF00501                                            0501
*       DO;                                                        0502
*         IF(TBLSEL=ON              /* SELECT MODE                   */
*             ×TBLGROUP=ON)         /* OR GROUP MODE                 */
*             &ICTPCDSE(NN)=OFF     /* ... SYSMOD NOT IN "LIST"      */
*           THEN                                                   0503
         L     @09,@PC00001                                        0503
         L     @09,TBLXTBL(,@09)                                   0503
         TM    TBLSEL(@09),B'10100000'                             0503
         BZ    @RF00503                                            0503
         AL    @15,@TF00001                                        0503
         AL    @15,@CF01234                                        0503
         TM    ICTPCDSE-13(@15),B'10000000'                        0503
         BZ    @RT00503                                            0503
*           ;                       /* DO NOT ISSUE ANY MESSAGE      */
*         ELSE                                                     0505
*           DO;                                                    0505
*                                                                  0505
@RF00503 DS    0H                                                  0506
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE HMA226I                                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0506
*             MGPCLEAR=''B;         /* CLEAR MESSAGE NUMBERS         */
         XC    MGPCLEAR(6),MGPCLEAR                                0506
*             MGPTYPE=MGPINFO;      /* INFORMATIONAL MESSAGE         */
         MVI   MGPTYPE,X'01'                                       0507
*             MGPMGNO1=HMA226I;     /* PRIMARY MESSAGE NUMBER        */
         SLR   @09,@09                                             0508
         IC    @09,HMA226I                                         0508
         STH   @09,MGPMGNO1                                        0508
*             MGPMGNO2=PART011;     /* MESSAGE PART NUMBER           */
         SLR   @09,@09                                             0509
         IC    @09,PART011                                         0509
         STH   @09,MGPMGNO2                                        0509
*             MGPVARPT(1)=ADDR(TBLXFUNC);/* SMP FUNCTION             */
         L     @09,@PC00001                                        0510
         LA    @09,TBLXFUNC(,@09)                                  0510
         ST    @09,MGPVARPT                                        0510
*             MGPVARPT(2)=ADDR(ICTPTFS(NN));/* SYSMOD ID             */
         LH    @09,NN                                              0511
         MH    @09,@CH01202                                        0511
         L     @01,CCAICPTF(,CCAPTR)                               0511
         AL    @01,@CF01224                                        0511
         LA    @09,ICTPTFS(@09,@01)                                0511
         ST    @09,MGPVARPT+4                                      0511
*             CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE               */
         L     @15,@CV01004                                        0512
         LA    @01,@AL00512                                        0512
         BALR  @14,@15                                             0512
*             ICTPMSG(NN)=ON;       /* SET MESSAGE ISSUED FLAG       */
         LH    @09,NN                                              0513
         MH    @09,@CH01202                                        0513
         L     @01,CCAICPTF(,CCAPTR)                               0513
         ALR   @01,@09                                             0513
         AL    @01,@CF01220                                        0513
         OI    ICTPMSG-8(@01),B'00010000'                          0513
*           END;                                                   0514
*       END;                        /* NON-NOGO SYSMOD               */
@RT00503 DS    0H                                                  0516
*   END;                            /* LOOP THRU ICT PTF SECTION     */
@RF00501 LA    @09,1                                               0516
         AH    @09,NN                                              0516
         STH   @09,NN                                              0516
@DE00500 LH    @09,NN                                              0516
         MH    @09,@CH01202                                        0516
         L     @01,CCAICPTF(,CCAPTR)                               0516
         AL    @01,@CF01224                                        0516
         L     @09,ICTPEND(@09,@01)                                0516
         CL    @09,ICTENDNT                                        0516
         BNE   @DL00500                                            0516
*   RETURN CODE(0);                                                0517
         SLR   @15,@15                                             0517
         L     @14,@SA00011                                        0517
         LM    @00,@12,@SA00011+8                                  0517
         BR    @14                                                 0517
*   END TCLTERM;                                                   0518
*   END HMASMTCL                    /*                               */
*                                                                  0519
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  0519
*       ;                                                          0519
@DATA    DS    0H
@CH00063 DC    H'1'
@CH01203 DC    H'54'
@CH01202 DC    H'116'
@CH01012 DC    H'160'
@CH01014 DC    H'221'
@CH01016 DC    H'235'
         DS    0F
@AL00160 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00169 DC    A(HMASMSPL)             LIST WITH   1 ARGUMENT(S)
@AL00268 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00351 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00392 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00440 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00470 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00512 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    15F
@SA00006 DS    15F
@SA00009 DS    15F
@SA00007 DS    15F
@PC00007 DS    2F
@PC00010 DS    2F
@SA00008 DS    0F
@SA00005 DS    0F
@SA00003 DS    0F
@SA00011 DS    0F
         DS    15F
@AL00001 DS    2A
@TF00001 DS    F
         DS    0F
@CF00037 DC    F'4'
@CH00037 EQU   @CF00037+2
@CF01224 DC    F'-116'
@CF01220 DC    F'-108'
@CF01234 DC    F'-103'
@CF01222 DC    F'-102'
@CF01236 DC    F'-101'
@CF01233 DC    F'-99'
@CF01235 DC    F'-96'
@CF01231 DC    F'-54'
@CF01226 DC    F'-52'
@CF01229 DC    F'-46'
@CF01228 DC    F'-20'
@CF01239 DC    F'-16'
@CF01238 DC    F'-9'
@CF01237 DC    F'-8'
@CF01227 DC    F'-4'
@CV01004 DC    V(HMASMMSG)
@CV01005 DC    V(HMASMGTA)
@CV01006 DC    V(HMASMSUB)
         DS    0D
PTFX     DS    F
PTFIX    DS    F
MODIX    DS    F
SAVICTSP DS    FL4
         ORG   SAVICTSP
SAVSP    DS    FL1
SAVLEN   DS    FL3
         ORG   SAVICTSP+4
FREETOP  DS    F
FREELENA DS    A
NGI      DS    F
NGJ      DS    F
NGK      DS    F
NGL      DS    F
BYPRTN   DS    F
NLBRTN   DS    F
KK       DS    H
II       DS    H
LL       DS    H
MM       DS    H
NN       DS    H
TCLRTNCD DS    FL1
HMA226I  DC    AL1(27)
HMA248I  DC    AL1(49)
PART011  DC    AL1(11)
PART091  DC    AL1(91)
PART130  DC    AL1(130)
         DS    CL1
FREELEN  DS    FL3
MOPUPRTN DS    FL1
NOPTFSRT DS    FL1
@CC01042 DC    C'BYPASSED    '
@CC01036 DC    C'REQ     '
@CC01038 DC    C'PRE     '
@CC01040 DC    C'IFREQ   '
@CC01045 DC    C'MOD     '
@CC01047 DC    C'ASSEMBLY'
@CC01049 DC    C'ZAP     '
@CC01051 DC    C'MAC     '
@CC01053 DC    C'MACUPD  '
@CC01055 DC    C'SRC     '
@CC01057 DC    C'SRCUPD  '
@CC01059 DC    C'        '
@CC01024 EQU   @CC01059
         DS    CL2
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00121 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00122 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
HMASMSPL DS    CL5
         ORG   HMASMSPL
SPLPMAD  DS    AL4
SPLFUNCT DS    FL1
         ORG   HMASMSPL+5
RSJMAP   DS    CL24
         ORG   RSJMAP
RSJTYPE  DS    FL1
RSJPNAME DS    CL8
RSJSNAME DS    CL8
RSJSMD   DS    CL7
         ORG   RSJMAP+24
FIXIOP   DS    CL93
         DS    CL2
GOTCORE  DS    CL8
         ORG   GOTCORE
ICTPTR   DS    AL4
SPLEN    DS    AL4
         ORG   SPLEN
SPL      DS    CL1
LEN      DS    FL3
         ORG   GOTCORE+8
INTFLAGS DS    BL1
         ORG   INTFLAGS
ONEPTFOK DS    BL1
PTFERRSW EQU   INTFLAGS+0
LDDERRSW EQU   INTFLAGS+0
INLJCLIN EQU   INTFLAGS+0
@NM00126 EQU   INTFLAGS+0
         ORG   INTFLAGS+1
         DS    CL1
PATCHTCL DS    CL80
         ORG   PATCHTCL
@NM00127 DC    80X'FF'
         ORG   PATCHTCL+80
REQNAME  DS    CL7
REQTYPE  DS    CL8
REQSTAT  DS    CL12
REQCSR   DS    CL7
NLBTYPE  DS    CL8
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
IOPPTR   EQU   @08
RTNCODE  EQU   @15
R0       EQU   @00
R1       EQU   @01
RTNREG   EQU   @14
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLFLG2  EQU   TBLFLAGS+2
TBLSEL   EQU   TBLFLG2
TBLGROUP EQU   TBLFLG2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLFLG5  EQU   TBLFLAGS+7
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00023 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAAPPLY EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00039 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00041 EQU   CCABLDLL
CCALKDRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00053+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPNAME  EQU   HMASMIOP+4
@NM00057 EQU   HMASMIOP+12
@NM00058 EQU   @NM00057
IOPDDNAM EQU   HMASMIOP+24
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPEND  EQU   ICTPTFS
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTPNOGO EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPCDSE EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPFLG8 EQU   ICTPTF+14
ICTPECPL EQU   ICTPFLG8
ICTPFLG9 EQU   ICTPTF+15
ICTPMSL  EQU   ICTPFLG9
@NM00077 EQU   ICTPFLG9
ICTPRQCK EQU   @NM00077
ICTPRQOK EQU   @NM00077
ICTPRQBY EQU   @NM00077
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPTYPE EQU   ICTPTF+17
ICTPSUPN EQU   ICTPTF+20
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTIXP   EQU   ICTIXPF
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQND EQU   ICTREQNM
ICTREQST EQU   ICTREQNT+7
ICTRREQS EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREND EQU   ICTPRENM
ICTPREST EQU   ICTPRENT+7
ICTPREQS EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQND EQU   ICTIRQNM
ICTIRQST EQU   ICTIRQNT+7
ICTIREQS EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTCSRNM EQU   ICTIRQNT+8
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMFLG2 EQU   ICTMOD+8
ICTMNOGO EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMMOD  EQU   ICTMMODR
ICTMASM  EQU   ICTMMODR
ICTMZAP  EQU   ICTMFLG1
ICTMMACR EQU   ICTMFLG1
ICTMMACU EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMSRCU EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTMFLG4 EQU   ICTMOD+11
ICTMISEL EQU   ICTMFLG4
ICTMIDEL EQU   ICTMFLG4
ICTMFLG5 EQU   ICTMOD+12
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTPPTR  EQU   ICTMOD+96
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTIXM   EQU   ICTIXMF
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMODST EQU   ICTMID+7
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLEND  EQU   ICTLNAME
ICTLFLG4 EQU   ICTLMOD+8
ICTLCPL  EQU   ICTLFLG4
ICTLFLG1 EQU   ICTLMOD+9
ICTLFLG5 EQU   ICTLMOD+10
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTLFLG3 EQU   ICTLMOD+14
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
ICTIXL   EQU   ICTIXLF
SPLPPACK EQU   0
SPLPUNPK EQU   0
SPLPDSN  EQU   0
SPLODSN  EQU   SPLPDSN
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
TPIFRECD EQU   0
TPIKEY   EQU   TPIFRECD
TPIDATA  EQU   TPIFRECD+21
CCADSIDA EQU   0
CCATYPEA EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXSTRT EQU   TBLXINDX+4
TBLXIOP2 EQU   TBLXPARM+16
TBLXTBL  EQU   TBLXPARM+28
TBLXNULL EQU   TBLXPARM+36
TBLXASGT EQU   TBLXPARM+44
TBLXSCGT EQU   TBLXPARM+52
TBLXLMGT EQU   TBLXPARM+56
TBLXFUNC EQU   TBLXPARM+64
TBLXFLG1 EQU   TBLXPARM+80
TBLXIBGN EQU   TBLXPARM+88
TBLXRC   EQU   TBLXPARM+92
TBLXTRC  EQU   TBLXRC
TBLXDLGT EQU   TBLXPARM+96
TBLXIOP3 EQU   TBLXPARM+104
RLPTFENT EQU   0
REQMSGID EQU   0
ELEMENT  EQU   0
ELEMEBC  EQU   0
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
IOPUDATA EQU   IOPEND
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPPTMAX EQU   IOPCDMAX
@NM00066 EQU   IOPSCMAP+11
@NM00065 EQU   IOPSCMAP+8
@NM00064 EQU   IOPSCMAP
TBLXEND0 EQU   TBLXPARM+124
@NM00007 EQU   TBLXPARM+108
TBLXD2GT EQU   TBLXPARM+100
@NM00006 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTSLP EQU   TBLXPARM+84
@NM00005 EQU   TBLXPARM+83
@NM00004 EQU   TBLXPARM+82
@NM00003 EQU   TBLXPARM+81
@NM00002 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
TBLXFUND EQU   TBLXPARM+72
@NM00001 EQU   TBLXPARM+62
TBLXCRQI EQU   TBLXPARM+61
TBLXCDSI EQU   TBLXPARM+60
TBLXSREL EQU   TBLXPARM+48
TBLXIFGT EQU   TBLXPARM+40
TBLXTOP  EQU   TBLXPARM+32
TBLXSEGT EQU   TBLXPARM+24
TBLXIOPF EQU   TBLXPARM+20
TBLXEND  EQU   TBLXINDX+8
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
TPISTAT  EQU   TPIDATA
TPIREQ   EQU   TPIKEY+14
TPIFMID  EQU   TPIKEY+7
TPICSR   EQU   TPIKEY
@NM00125 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00124 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPBUFAD EQU   HMASMGTP+12
GTPWKAD  EQU   HMASMGTP+8
GTPKEYLN EQU   HMASMGTP+6
GTPRCDLN EQU   HMASMGTP+4
@NM00123 EQU   HMASMGTP+2
SPLIFIL  EQU   SPLODSN+33
SPLISMD  EQU   SPLODSN+26
SPLIPFX  EQU   SPLODSN
SPLIUNPK EQU   SPLPUNPK+8
SPLOUNPK EQU   SPLPUNPK
SPLOPACK EQU   SPLPPACK+8
SPLIPACK EQU   SPLPPACK
@NM00120 EQU   ICTLMOD+38
ICTLTTR  EQU   ICTLMOD+31
ICTTG2   EQU   ICTLMOD+23
ICTTG1   EQU   ICTLMOD+15
@NM00119 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTLCPY  EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
ICTTIND1 EQU   ICTLFLG3
@NM00118 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00117 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
ICTCOPY  EQU   ICTLFLG2
@NM00116 EQU   ICTLFLG7
@NM00115 EQU   ICTLFLG6
@NM00114 EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLNE   EQU   ICTLFLG5
@NM00113 EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLAPF  EQU   ICTLFLG1
@NM00112 EQU   ICTLFLG4
ICTLPASS EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
ICTLPROC EQU   ICTLFLG4
@NM00111 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00110 EQU   ICTMVRNT+7
ICTMVRND EQU   ICTMVRNM
ICTTALND EQU   ICTTALNM
ICTASMND EQU   ICTASMAD
ICTMIDTY EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDRG EQU   ICTMODST
ICTMIDF1 EQU   ICTMODST
ICTMIDPL EQU   ICTMODST
ICTMIDPS EQU   ICTMODST
@NM00109 EQU   ICTMODST
ICTMIDND EQU   ICTMODID
@NM00108 EQU   ICTMOD+128
ICTMICHA EQU   ICTMOD+108
@NM00107 EQU   ICTMOD+95
ICTMFMID EQU   ICTMOD+88
@NM00106 EQU   ICTMOD+87
ICTMRMID EQU   ICTMOD+80
ICTMSSI  EQU   ICTMOD+72
ICTMDOBJ EQU   ICTMOD+64
ICTMSYSL EQU   ICTMOD+56
ICTMDSTL EQU   ICTMOD+48
ICTMASLB EQU   ICTMOD+40
ICTTOLIB EQU   ICTMOD+32
ICTFMLIB EQU   ICTMOD+24
ICTMRELN EQU   ICTMOD+22
@NM00105 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00104 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00103 EQU   ICTMLEP4
@NM00102 EQU   ICTMLEP3
@NM00101 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00100 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00099 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMCOPY EQU   ICTMFLG5
ICTMPASS EQU   ICTMFLG5
@NM00098 EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
@NM00097 EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMALIS EQU   ICTMFLG3
ICTMWRK  EQU   ICTMFLG3
ICTMTRX  EQU   ICTMFLG3
ICTMRELF EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTLIBLK EQU   ICTMFLG3
ICTMXPND EQU   ICTMFLG1
@NM00096 EQU   ICTMFLG2
@NM00095 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMPROC EQU   ICTMFLG2
ICTMEND  EQU   ICTMNAME
@NM00094 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00093 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00092 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00091 EQU   ICTCSRST
@NM00090 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00089 EQU   ICTCSRST
@NM00088 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
@NM00087 EQU   ICTIRQST
@NM00086 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
@NM00085 EQU   ICTPREST
@NM00084 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00083 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
@NM00082 EQU   ICTREQST
@NM00081 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00080 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
@NM00079 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPFMID EQU   ICTPTF+22
ICTPONUM EQU   ICTPTF+18
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00078 EQU   @NM00077
@NM00076 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
@NM00075 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00074 EQU   ICTPFLG4
@NM00073 EQU   ICTPFLG4
@NM00072 EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
@NM00071 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00070 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00069 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00068 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00067 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
@NM00063 EQU   IOPUSERL
@NM00062 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
IOPBUFAD EQU   HMASMIOP+52
@NM00061 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00060 EQU   @NM00057+10
IOPSEQNO EQU   @NM00057+8
@NM00059 EQU   @NM00058+7
IOPPTFNM EQU   @NM00058
IOPNAM17 EQU   IOPNAME
IOPTYPE  EQU   HMASMIOP+3
IOPRETRN EQU   HMASMIOP+2
IOPFUNCT EQU   HMASMIOP+1
IOPDSID  EQU   HMASMIOP
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00056 EQU   CCABLDLM+2
@NM00055 EQU   CCABLDLM
CCAUPDPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00053+12
CCAUPDTE EQU   @NM00053+8
CCAUPDNM EQU   @NM00053
CCASUPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00051+12
CCAIOSUP EQU   @NM00051+8
CCASUPNM EQU   @NM00051
CCAZAPPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00049+12
CCASPZAP EQU   @NM00049+8
CCAZAPNM EQU   @NM00049
CCACOMPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00047+12
CCACOMRS EQU   @NM00047+8
CCACOMNM EQU   @NM00047
CCACPYPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00045+12
CCACOPY  EQU   @NM00045+8
CCACPYNM EQU   @NM00045
CCAASMPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00043+12
CCAASM   EQU   @NM00043+8
CCAASMNM EQU   @NM00043
CCALKDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00041+12
CCALKED  EQU   @NM00041+8
CCALKDNM EQU   @NM00041
CCAPGMPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCABPGRC EQU   @NM00039+20
CCABPGSP EQU   @NM00039+12
CCABPGAD EQU   @NM00039+8
CCABPGNM EQU   @NM00039
CCAEND   EQU   HMASMCCA+371
@NM00038 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00037 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00036 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00035 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00034 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00033 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00032 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00031 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00030 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00029 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00028 EQU   @NM00023+18
@NM00027 EQU   @NM00023+16
CCATBLPA EQU   @NM00023+12
@NM00026 EQU   @NM00023+8
@NM00025 EQU   @NM00023+4
@NM00024 EQU   @NM00023
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00022 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00021 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00020 EQU   CCAFBUFR+122
@NM00019 EQU   CCAFBUFR+120
@NM00018 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00017 EQU   CCAFBUFR+88
@NM00016 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00015 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00014 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00013 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00012 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
TBLBPID  EQU   TBLFLG4
@NM00011 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00010 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
@NM00009 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLASSEM EQU   TBLFLG1
TBLCHECK EQU   TBLFLG1
TBLNOAPP EQU   TBLFLG1
@NM00008 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00289 EQU   LMDNTCPL
@RT00308 EQU   GOTLMOD1
@RF00493 EQU   @EL00010
@ENDDATA EQU   *
         END   HMASMTCL,(C'PLS2136',0802,78334)

         TITLE 'HMASMTM1-ICT MOD SECTION BUILD (INIT ENTRY FOR ++MOD/++*
               ZAP)'
HMASMTM1 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTM1  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(16),0(@01)                                 0001
*   IOPPTR=CCAIOPTR;                /* SET UP BASE IOP ADDRESS       */
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0208
*   TM1HIRC=ZERO;                   /* INITIALIZE HIGHEST RC       0209
*                                      COLLECTOR                     */
         SLR   TM1HIRC,TM1HIRC                                     0209
*   TM1SWCH1=OFF;                   /* INITIALIZE LOCAL SWITCHES     */
         MVI   TM1SWCH1,B'00000000'                                0210
*   TM1SWCH2=OFF;                   /* INITIALIZE LOCAL SWITCHES     */
         MVI   TM1SWCH2,B'00000000'                                0211
*   ICTMDSTL(1)=BLANKS;             /* INITIALIZE FIELD TO BLANKS    */
*                                                                  0212
         L     @08,@PC00001+4                                      0212
         L     @08,ICMODPTR(,@08)                                  0212
         MVC   ICTMDSTL(8,@08),BLANKS                              0212
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN ICT MOD VALUES FROM PTF ENTRY PASSED AND OTHER FIELDS */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   ICTMMOD(1)=ON;                  /* MODULE REPLACEMENT "FOR NOW"--
*                                      MIGHT BE SET TO ZAP IN PROC2. */
         OI    ICTMMOD(@08),B'10000000'                            0213
*   ICTPPTR(1)=ICPTFPTR;            /* PTR TO ICT PTF ENTRY          */
         L     @15,@PC00001+8                                      0214
         MVC   ICTPPTR(4,@08),ICPTFPTR(@15)                        0214
*   ICTMCHN(1)=TBLXNULL;            /* INIT LMOD CHAIN PTR           */
*                                                                  0215
         L     @15,@PC00001                                        0215
         MVC   ICTMCHN(4,@08),TBLXNULL(@15)                        0215
*   /*****************************************************************/
*   /*                                                               */
*   /* ATTEMPT TO LOCATE THE ELEMENT ENTRY FOR THE CURRENT ELEMENT ON*/
*   /* THE (A)CDS DATASET, DEPENDING ON THE FUNCTION BEING RUN SO    */
*   /* THAT THE DISTLIB ENTRY FOR THIS ELEMENT CAN BE RETRIEVED      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0216
*   CALL TM1PROC1;                  /* CALL PROC TO DO LOCATE        */
         BAL   @14,TM1PROC1                                        0216
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RETURN CODE   */
         SLR   @08,@08                                             0217
         IC    @08,IOPRETRN(,IOPPTR)                               0217
         CR    TM1HIRC,@08                                         0217
         BNL   *+6
         LR    TM1HIRC,@08                                         0217
*   IF TM1HIRC=IOPGOOD              /* WAS THE RETURN FROM HMASMIO IN
*                                      TM1PROC1 =0 OR NOT          0218
*                                      FOUND(RESET) TO 0?            */
*       &ELMCBPTR^=ZERO THEN        /* WAS AN ELEMENT MCB PTR PASSED?*/
*                                                                  0218
         SLR   @08,@08                                             0218
         CR    TM1HIRC,@08                                         0218
         BNE   @RF00218                                            0218
         L     @15,@PC00001+12                                     0218
         C     @08,ELMCBPTR(,@15)                                  0218
         BE    @RF00218                                            0218
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE THE ICT MODULE MAPPING FROM THE MCB PASSED FROM  */
*     /* THE CALLING MODULE                                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0219
*     CALL TM1PROC2;                /* CALL PROCEDURE TO FILL IN ICT
*                                      MOD ENTRY FIELDS FROM MCB     */
         BAL   @14,TM1PROC2                                        0219
*   IF TM1HIRC=IOPGOOD              /* PREVIOUS PROCEDURE SUCCESSFUL?*/
*       &LMODADD=ON THEN            /* LMOD SUBENTRY ADDED TO IOP?   */
*                                                                  0220
@RF00218 CH    TM1HIRC,@CH00088                                    0220
         BNE   @RF00220                                            0220
         TM    LMODADD,B'10000000'                                 0220
         BNO   @RF00220                                            0220
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF A LMOD SUBENTRY WAS ADDED TO THE IOP FROM THE  */
*     /* MCB SUBENTRIES, AND IF SO A NEED EXISTS TO STOW REPLACE THE */
*     /* UPDATED MOD ENTRY.                                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0221
*     DO;                           /*                               */
*       IOPFUNCT=IOPSTOWR;          /* INDICATE STOW REPLACE FUNCTION*/
         MVI   IOPFUNCT(IOPPTR),X'54'                              0222
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MOD     */
         ST    IOPPTR,@AL00001                                     0223
         L     @15,@CV01853                                        0223
         LA    @01,@AL00001                                        0223
         BALR  @14,@15                                             0223
*       TM1HIRC=MAX(TM1HIRC,IOPRETRN);/* PICK UP HIGHEST RC          */
         SLR   @08,@08                                             0224
         IC    @08,IOPRETRN(,IOPPTR)                               0224
         CR    TM1HIRC,@08                                         0224
         BNL   *+6
         LR    TM1HIRC,@08                                         0224
*     END;                          /*                               */
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/
*                                                                  0226
@RF00220 CH    TM1HIRC,@CH00088                                    0226
         BNE   @RF00226                                            0226
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF THE DISTLIB VALUE HAS BEEN FOUND FOR THE       */
*     /* CURRENT ELEMENT. THIS IS REQUIRED FOR ALL FUNCTION          */
*     /* PROCESSING. IF ONE IS NOT DETERMINED THEN ISSUE MSG HMA431I */
*     /* AND SET RC=STOPPTF.                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0227
*     CALL TM1PROC3;                /* CALL PROCEDURE TO CHECK IF A
*                                      DLIB VALUE HAS BEEN FOUND     */
         BAL   @14,TM1PROC3                                        0227
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */
@RF00226 SLR   @08,@08                                             0228
         IC    @08,IOPRETRN(,IOPPTR)                               0228
         CR    TM1HIRC,@08                                         0228
         BNL   *+6
         LR    TM1HIRC,@08                                         0228
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/
*                                                                  0229
         CH    TM1HIRC,@CH00088                                    0229
         BNE   @RF00229                                            0229
*     /***************************************************************/
*     /*                                                             */
*     /* COMPARE THE DISTLIB OPERAND ON THE CDS MOD ENTRY AGAINST THE*/
*     /* VALUE IN THE MCB FOR APPLY. IF DIFFERENT VALUES THEN SET THE*/
*     /* DISTLIB CONFLICT BIT (ICTMDSTE) ON.                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0230
*     CALL TM1PROC4;                /* CALL PROCEDURE TO CHECK IF A
*                                      DLIB CONFLICT EXISTS          */
         BAL   @14,TM1PROC4                                        0230
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */
@RF00229 SLR   @08,@08                                             0231
         IC    @08,IOPRETRN(,IOPPTR)                               0231
         CR    TM1HIRC,@08                                         0231
         BNL   *+6
         LR    TM1HIRC,@08                                         0231
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/
*                                                                  0232
         CH    TM1HIRC,@CH00088                                    0232
         BNE   @RF00232                                            0232
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF THE DLIB VALUE IN THE ACDS MOD ENTRY IS NOT    */
*     /* EQUAL TO THE MCB VALUE FOR ACCEPT PROCESSING. IF DIFFERENT, */
*     /* THEN DETERMINE IF THE ACDS DLIB VALUE SHOULD BE UPDATED OR  */
*     /* IF THE DISTLIB CONFLICT BIT (ICTMDSTE) SHOULD BE SET ON, IF */
*     /* CHECKS (1-4) ARE NOT TRUE.                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0233
*     CALL TM1PROC5;                /* CALL PROCEDURE TO CHECK IF A
*                                      DLIB SHOULD BE UPDATED WITH 0233
*                                      DLIB VALUE FROM THE MCB       */
         BAL   @14,TM1PROC5                                        0233
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */
@RF00232 SLR   @08,@08                                             0234
         IC    @08,IOPRETRN(,IOPPTR)                               0234
         CR    TM1HIRC,@08                                         0234
         BNL   *+6
         LR    TM1HIRC,@08                                         0234
*   IF TM1HIRC=IOPGOOD              /* PREVIOUS PROCEDURE SUCCESSFUL?*/
*       &CCAAPPLY=ON                /* FUNCTION EQUAL TO APPLY?      */
*       &ICTMDSTE(1)=OFF THEN       /* NO DISTLIB CONFLICT?          */
*                                                                  0235
         CH    TM1HIRC,@CH00088                                    0235
         BNE   @RF00235                                            0235
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0235
         BNO   @RF00235                                            0235
         L     @08,@PC00001+4                                      0235
         L     @08,ICMODPTR(,@08)                                  0235
         TM    ICTMDSTE(@08),B'00000100'                           0235
         BNZ   @RF00235                                            0235
*     /***************************************************************/
*     /*                                                             */
*     /* FOR APPLY WITH NO DISTLIB CONFLICT ERROR BIT ON, CHECK TO   */
*     /* SEE IF ANY CDS ENTRIES (EITHER MOD OR LMOD) NEED TO BE      */
*     /* CREATED OR MODIFIED FOR ELEMENTS THAT ARE IN A DISTLIB TOTAL*/
*     /* COPY.                                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0236
*     CALL TM1PROC6;                /* CALL PROCEDURE TO CHECK IF ANY
*                                      CDS ENTRIES MUST BE CREATED OR
*                                      MODIFIED                      */
         BAL   @14,TM1PROC6                                        0236
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */
@RF00235 SLR   @08,@08                                             0237
         IC    @08,IOPRETRN(,IOPPTR)                               0237
         CR    TM1HIRC,@08                                         0237
         BNL   *+6
         LR    TM1HIRC,@08                                         0237
*   IF TM1HIRC=IOPGOOD              /* PREVIOUS PROCESSING OK, AND A */
*       &BLDACDSM=ON THEN           /* (A)CDS MOD ENTRY MUST BE BUILT*/
         CH    TM1HIRC,@CH00088                                    0238
         BNE   @RF00238                                            0238
         TM    BLDACDSM,B'00000100'                                0238
         BNO   @RF00238                                            0238
*     DO;                           /* BUILD AND ADD A MOD ENTRY     */
*                                                                  0239
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO (A)CDS MOD ENTRY WAS FOUND, THEN CREATE A (A)CDS MOD*/
*       /* ENTRY FOR THIS ELEMENT INDICATING A LMOD SUBENTRY NAME    */
*       /* EQUAL TO THE ELEMENT NAME BEING PROCESSED AND DISTLIB FROM*/
*       /* MCB.                                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0240
*       IOPNAME=ICTMNAME(1);        /* MOD ENTRY NAME TO ADD         */
         L     @08,@PC00001+4                                      0240
         L     @08,ICMODPTR(,@08)                                  0240
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0240
*       IOPTYPE=IOPMOD;             /* MOD TYPE ENTRY                */
         MVI   IOPTYPE(IOPPTR),X'05'                               0241
*       IOPMODDR=' ';               /* INIT MOD ENTRY DIRECTORY      */
         MVI   IOPMODDR+1(IOPPTR),C' '                             0242
         MVC   IOPMODDR+2(22,IOPPTR),IOPMODDR+1(IOPPTR)            0242
         MVI   IOPMODDR(IOPPTR),C' '                               0242
*       IOPNTLVL=IOPMODLC;          /* CURENT LEVEL                  */
         MVI   IOPNTLVL(IOPPTR),X'02'                              0243
*       IOPRMID=' ';                /* BLANK RMID FIELD              */
         MVI   IOPRMID+1(IOPPTR),C' '                              0244
         MVC   IOPRMID+2(5,IOPPTR),IOPRMID+1(IOPPTR)               0244
         MVI   IOPRMID(IOPPTR),C' '                                0244
*       IOPRMST=IOPRMST&&IOPRMST;   /* ZERO OUT RMID STATUS FIELD    */
         XC    IOPRMST(1,IOPPTR),IOPRMST(IOPPTR)                   0245
*       IOPFMID=' ';                /* BLANK FMID FIELD              */
         MVI   IOPFMID+1(IOPPTR),C' '                              0246
         MVC   IOPFMID+2(5,IOPPTR),IOPFMID+1(IOPPTR)               0246
         MVI   IOPFMID(IOPPTR),C' '                                0246
*       IOPFMST=IOPFMST&&IOPFMST;   /* ZERO OUT FMID STATUS FIELD    */
         XC    IOPFMST(1,IOPPTR),IOPFMST(IOPPTR)                   0247
*       IOPMODFX=' ';               /* INIT MOD ENTRY DATA FIELDS    */
         MVI   IOPMODFX+1(IOPPTR),C' '                             0248
         MVC   IOPMODFX+2(78,IOPPTR),IOPMODFX+1(IOPPTR)            0248
         MVI   IOPMODFX(IOPPTR),C' '                               0248
*       IOPBUSMD=ICTPTFS(1);        /* SYSMOD CAUSING ADD OF ENTRY   */
         L     @15,@PC00001+8                                      0249
         L     @01,ICPTFPTR(,@15)                                  0249
         MVC   IOPBUSMD(7,IOPPTR),ICTPTFS(@01)                     0249
*       IOPBUTYP=IOPBUADD;          /* INDICATE ADD OPERATION        */
         MVI   IOPBUTYP(IOPPTR),X'01'                              0250
*       IOPMODF1=ICTMLEP1(1);       /* FIRST BYTE OF LEPARMS FROM ICT*/
         MVC   IOPMODF1(1,IOPPTR),ICTMLEP1(@08)                    0251
*       IOPMODF2=ICTMLEP2(1);       /* LAST BYTE OF LEPARMS FROM ICT */
         MVC   IOPMODF2(1,IOPPTR),ICTMLEP2(@08)                    0252
*       IOPMODF3=IOPMODF3&&IOPMODF3;/* ZERO OUT FIELD                */
         XC    IOPMODF3(1,IOPPTR),IOPMODF3(IOPPTR)                 0253
*       IOPMODF4=IOPMODF4&&IOPMODF4;/* ZERO OUT FIELD                */
         XC    IOPMODF4(1,IOPPTR),IOPMODF4(IOPPTR)                 0254
*       IOPDLIB=MCBEDIST;           /* DISTRIBUTION LIB FROM MCB     */
         L     @08,@PC00001+12                                     0255
         L     @08,ELMCBPTR(,@08)                                  0255
         MVC   IOPDLIB(8,IOPPTR),MCBEDIST(@08)                     0255
*       IOPMODND(1)=IOPEOLST;       /* SET END OF LIST MARKER        */
         MVI   IOPMODND(IOPPTR),X'FF'                              0256
*       CALL TM1LMOD;               /* TO PROCESS MCB LMOD SUBENTRYS */
         BAL   @14,TM1LMOD                                         0257
*       IOPFUNCT=IOPSTOWR;          /* INDICATE STOW REPLACE FUNCTION*/
*                                                                  0258
         MVI   IOPFUNCT(IOPPTR),X'54'                              0258
*       /*************************************************************/
*       /*                                                           */
*       /* ADD NEW MOD ENTRY TO THE CDS FOR THIS ELEMENT             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0259
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MODULE  */
         ST    IOPPTR,@AL00001                                     0259
         L     @15,@CV01853                                        0259
         LA    @01,@AL00001                                        0259
         BALR  @14,@15                                             0259
*     END;                          /*                               */
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */
*                                                                  0261
@RF00238 SLR   @08,@08                                             0261
         IC    @08,IOPRETRN(,IOPPTR)                               0261
         CR    TM1HIRC,@08                                         0261
         BNL   *+6
         LR    TM1HIRC,@08                                         0261
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FROMLIB FOR RESTORE PROCESSING                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0262
*   IF TM1HIRC=IOPGOOD              /* PREVIOUS PROCEDURE SUCCESSFUL?*/
*       &CCARES=ON                  /* IS FUNCTION RESTORE AND,      */
*       &ICTMDSTE(1)=OFF THEN       /* NO DISTLIB CONFLICT ERROR?    */
         CH    TM1HIRC,@CH00088                                    0262
         BNE   @RF00262                                            0262
         TM    CCARES(CCAPTR),B'00001000'                          0262
         BNO   @RF00262                                            0262
         L     @08,@PC00001+4                                      0262
         L     @08,ICMODPTR(,@08)                                  0262
         TM    ICTMDSTE(@08),B'00000100'                           0262
         BNZ   @RF00262                                            0262
*     ICTFMLIB(1)=ICTMDSTL(1);      /* FOR RESTORE FROMLIB IS DISTLIB*/
         MVC   ICTFMLIB(8,@08),ICTMDSTL(@08)                       0263
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/
*                                                                  0264
@RF00262 CH    TM1HIRC,@CH00088                                    0264
         BNE   @RF00264                                            0264
*     /***************************************************************/
*     /*                                                             */
*     /* IF DELETE WAS NOT SPECIFIED ON THE ++MOD FOR THIS ELEMENT   */
*     /* (I.E. - ICTMIDEL=OFF, WILL BE SET ON IN TM1PROC2 IF DELETE  */
*     /* WAS ENTERED), THEN CALL TM1PROC7 TO DO THE FOLLOWING FOR THE*/
*     /* FUNCTION SPECIFIED, OTHERWISE SKIP CALL AND CONTINUE. FOR   */
*     /* APPLY OR RESTORE PROCESSING, ADD THE LOAD MODULE NAMES      */
*     /* AFFECTED BY THIS ELEMENT TO A GTA FILE INDICATING THE       */
*     /* ELEMENT. FOR ACCEPT PROCESSING, ADD THE ELEMENT NAME TO A   */
*     /* GTA FILE.                                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0265
*     IF ICTMIDEL(1)=OFF THEN       /* CALL IF DELETE NOT SPECIFIED
*                                      ON ++MOD FOR THIS ELEMENT     */
         L     @08,@PC00001+4                                      0265
         L     @08,ICMODPTR(,@08)                                  0265
         TM    ICTMIDEL(@08),B'01000000'                           0265
         BNZ   @RF00265                                            0265
*       CALL TM1PROC7;              /* CALL PROCEDURE TO ADD ENTRIES
*                                      TO GTA FILES FOR CURRENT MOD  */
         BAL   @14,TM1PROC7                                        0266
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */
@RF00265 DS    0H                                                  0267
@RF00264 SLR   @08,@08                                             0267
         IC    @08,IOPRETRN(,IOPPTR)                               0267
         CR    TM1HIRC,@08                                         0267
         BNL   *+6
         LR    TM1HIRC,@08                                         0267
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/
*                                                                  0268
         CH    TM1HIRC,@CH00088                                    0268
         BNE   @RF00268                                            0268
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE THE MODID LIST FOR THIS ELEMENT. IF A MODID LIST */
*     /* EXIST FOR ANOTHER VERSION OF THIS ELEMENT, THEN POINT THE   */
*     /* CHAIN POINTER FOR THIS ENTRY TO THAT VERSION'S MODID LIST.  */
*     /* IF NO MODID LIST CAN BE FOUND, THEN CALL HMASMTID TO BUILD A*/
*     /* MODID LIST FOR THIS ELEMENT.                                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0269
*     CALL TM1PROC8;                /* CALL PROCEDURE TO BUILD MODID
*                                      LIST OR CHAIN TO IF PRESENT   */
         BAL   @14,TM1PROC8                                        0269
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */
*                                                                  0270
@RF00268 SLR   @08,@08                                             0270
         IC    @08,IOPRETRN(,IOPPTR)                               0270
         CR    TM1HIRC,@08                                         0270
         BNL   *+6
         LR    TM1HIRC,@08                                         0270
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF HMASMTM1 PROCESSING. RETURN TO CALLER WITH HIGHEST     */
*   /* RETURN CODE ENCOUNTERED DURING PROCESSING.                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0271
*   RETURN CODE(TM1HIRC);           /* RETURN TO CALLER WITH MAX RC  */
         LR    @15,TM1HIRC                                         0271
         L     @13,4(,@13)                                         0271
         L     @14,12(,@13)                                        0271
         LM    @00,@12,20(@13)                                     0271
         BR    @14                                                 0271
*TM1PROC1:                                                         0272
*   PROC;                           /*                               */
*                                                                  0272
@EL00001 L     @13,4(,@13)                                         0272
@EF00001 DS    0H                                                  0272
@ER00001 LM    @14,@12,12(@13)                                     0272
         BR    @14                                                 0272
TM1PROC1 STM   @14,@02,@SA00002                                    0272
         STM   @04,@12,@SA00002+20                                 0272
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETER LIST FOR CALL TO HMASMIO                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0273
*   IOPFUNCT=IOPLOC;                /* INDICATE LOCATE OPERATION     */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0273
*   IOPTYPE=IOPMOD;                 /* INDICATE (A)CDS MOD ENTRY     */
         MVI   IOPTYPE(IOPPTR),X'05'                               0274
*   IOPNAME=ICTMNAME(1);            /* ELEMENT ENTRY BEING PROCESSED */
*                                                                  0275
         L     @08,@PC00001+4                                      0275
         L     @08,ICMODPTR(,@08)                                  0275
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0275
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE FUNCTION BEING RUN SO DATASET CAN BE SET            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0276
*   IF CCAACCPT=ON                  /* IS FUNCTION = ACCEPT?         */
*     THEN                                                         0276
         TM    CCAACCPT(CCAPTR),B'00100000'                        0276
         BNO   @RF00276                                            0276
*     IOPDSID=IOPACDS;              /* YES- USE ACDS DATASET         */
         MVI   IOPDSID(IOPPTR),X'0C'                               0277
*   ELSE                                                           0278
*     IOPDSID=IOPCDS;               /* NO- USE CDS DATASET           */
         B     @RC00276                                            0278
@RF00276 MVI   IOPDSID(IOPPTR),X'02'                               0278
*   CALL HMASMIO(HMASMIOP);         /* CALL SMP IO INTERFACE MODULE  */
@RC00276 ST    IOPPTR,@AL00001                                     0279
         L     @15,@CV01853                                        0279
         LA    @01,@AL00001                                        0279
         BALR  @14,@15                                             0279
*   IF IOPRETRN=IOPNOTFD THEN       /* ENTRY NOT FOUND FOR ELEMENT   */
         CLI   IOPRETRN(IOPPTR),4                                  0280
         BNE   @RF00280                                            0280
*     DO;                           /*                               */
*                                                                  0281
*       /*************************************************************/
*       /*                                                           */
*       /* IF ENTRY NOT FOUND, THEN LOOK FOR ENTRY UNDER DALIAS NAME */
*       /* IF MCB ENTRY POINTER WAS PASSED                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0282
*       IF ELMCBPTR^=ZERO           /* IF MCB ENTRY WAS PASSED, AND  */
*           &MCBEDALS^=BLANKS THEN  /* DALIAS WAS ENTERED THEN       */
         L     @08,@PC00001+12                                     0282
         L     @08,ELMCBPTR(,@08)                                  0282
         LTR   @08,@08                                             0282
         BZ    @RF00282                                            0282
         CLC   MCBEDALS(8,@08),BLANKS                              0282
         BE    @RF00282                                            0282
*         DO;                       /* LOOK FOR UNDER DALIAS NAME    */
*           IOPNAME=MCBEDALS;       /* SET UP PARM WITH DALIAS NAME  */
         MVC   IOPNAME(8,IOPPTR),MCBEDALS(@08)                     0284
*           CALL HMASMIO(HMASMIOP); /* CALL SMP IO INTERFACE MODULE  */
         ST    IOPPTR,@AL00001                                     0285
         L     @15,@CV01853                                        0285
         LA    @01,@AL00001                                        0285
         BALR  @14,@15                                             0285
*           IF IOPRETRN=IOPGOOD THEN/* IF ENTRY FOUND FOR DALIAS,    */
*                                                                  0286
         CLI   IOPRETRN(IOPPTR),0                                  0286
         BNE   @RF00286                                            0286
*             /*******************************************************/
*             /*                                                     */
*             /* IF ENTRY WAS FOUND AS A DALIAS, THEN ADD A MOD ENTRY*/
*             /* FOR THE CURRENT ELEMENT WITH THE DATA FROM THE      */
*             /* DALIAS ENTRY.                                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0287
*             DO;                   /* ADD ENTRY FROM DALIAS ENTRY   */
*               IOPFUNCT=IOPSTOWC;  /* TO RENAME MEMBER              */
         MVI   IOPFUNCT(IOPPTR),X'52'                              0288
*               IOPONAME=MCBEDALS;  /* DALIAS ENTRY NAME             */
         L     @08,@PC00001+12                                     0289
         L     @08,ELMCBPTR(,@08)                                  0289
         MVC   IOPONAME(8,IOPPTR),MCBEDALS(@08)                    0289
*               IOPOTYPE=IOPMOD;    /* MOD TYPE ENTRY                */
         MVI   IOPOTYPE(IOPPTR),X'05'                              0290
*               IOPNNAME=ICTMNAME(1);/* CURRENT ENTRY NAME           */
         L     @08,@PC00001+4                                      0291
         L     @08,ICMODPTR(,@08)                                  0291
         MVC   IOPNNAME(8,IOPPTR),ICTMNAME(@08)                    0291
*               IOPNTYPE=IOPMOD;    /* MOD TYPE ENTRY                */
         MVI   IOPNTYPE(IOPPTR),X'05'                              0292
*               CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE    0293
*                                      MODULE                        */
         ST    IOPPTR,@AL00001                                     0293
         L     @15,@CV01853                                        0293
         LA    @01,@AL00001                                        0293
         BALR  @14,@15                                             0293
*             END;                  /*                               */
*         END;                      /*                               */
@RF00286 DS    0H                                                  0296
*     END;                          /*                               */
@RF00282 DS    0H                                                  0297
*   IF IOPRETRN=IOPNOTFD            /* ENTRY STILL NOT FOUND/ADDED,  */
*       &(CCAACCPT=ON               /* FUNCTION IS ACCEPT, OR THE    */
*       ×CCAAPPLY=ON)               /* FUNCTION IS APPLY, AND A MCB  */
*       &ELMCBPTR^=ZERO             /* WAS PASSED AS A PARAMETER,    */
*       &MCBEDIST^=BLANKS THEN      /* AND A DISTLIB VALUE ENTERED   */
*                                                                  0297
@RF00280 CLI   IOPRETRN(IOPPTR),4                                  0297
         BNE   @RF00297                                            0297
         TM    CCAACCPT(CCAPTR),B'01100000'                        0297
         BZ    @RF00297                                            0297
         L     @08,@PC00001+12                                     0297
         L     @08,ELMCBPTR(,@08)                                  0297
         LTR   @08,@08                                             0297
         BZ    @RF00297                                            0297
         CLC   MCBEDIST(8,@08),BLANKS                              0297
         BE    @RF00297                                            0297
*     /***************************************************************/
*     /*                                                             */
*     /* FOR A NOT FOUND MOD ENTRY (EITHER AS THE CURRENT ELEMENT OR */
*     /* AS A DALIAS), AND THE FUNCTION IS APPLY/ACCEPT, AND MCB WAS */
*     /* INPUT AND A DISTLIB VALUE EXISTS IN THE MCB, INDICATE THE   */
*     /* NEED FOR A (A)CDS MOD ENTRY TO BE BUILT FOR THIS ELEMENT. IT*/
*     /* WILL BE BUILT AFTER THE ICT ENTRY HAS BEEN BUILT FROM THE   */
*     /* INPUTS.                                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0298
*     BLDACDSM=ON;                  /* SET BIT TO BUILD (A)CDS MOD 0298
*                                      ENTRY                         */
         OI    BLDACDSM,B'00000100'                                0298
*   IF IOPRETRN=IOPGOOD THEN        /* WAS AN ENTRY WAS FOUND EITHER
*                                      AS THE ENTRY NAME OR DALIAS?  */
@RF00297 CLI   IOPRETRN(IOPPTR),0                                  0299
         BNE   @RF00299                                            0299
*     DO;                           /*                               */
*       ICTMDSTL(1)=IOPDLIB;        /* YES- FILL IN ENTRY FROM (A)CDS
*                                      FOR ENTRY FOUND EITHER AS THE
*                                      ENTRY OR DALIAS               */
         L     @08,@PC00001+4                                      0301
         L     @08,ICMODPTR(,@08)                                  0301
         MVC   ICTMDSTL(8,@08),IOPDLIB(IOPPTR)                     0301
*       DLIBBIT=ON;                 /* INDICATE DLIB VALUE FOUND     */
         OI    DLIBBIT,B'10000000'                                 0302
*       IF ELMCBPTR^=ZERO THEN      /* WAS A MCB PASSED AS INPUT?    */
         L     @08,@PC00001+12                                     0303
         ICM   @15,15,ELMCBPTR(@08)                                0303
         BZ    @RF00303                                            0303
*         MODFND=ON;                /* SET UP FOR CALL TO TM1LMOD    */
         OI    MODFND,B'01000000'                                  0304
*     END;                          /*                               */
@RF00303 DS    0H                                                  0306
*                                                                  0306
*   /*****************************************************************/
*   /*                                                               */
*   /* ALIAS NAMES INTO THE ICT ENTRY.                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0306
*   IF TM1HIRC=ZERO                 /* IF MCB NOT PRESENT THEN GET   */
*       &ELMCBPTR=ZERO THEN         /* ...ALIAS NAMES FROM IOP       */
@RF00299 SLR   @08,@08                                             0306
         CR    TM1HIRC,@08                                         0306
         BNE   @RF00306                                            0306
         L     @15,@PC00001+12                                     0306
         C     @08,ELMCBPTR(,@15)                                  0306
         BNE   @RF00306                                            0306
*     CALL ALASPROC;                /*                               */
*                                                                  0307
         BAL   @14,ALASPROC                                        0307
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ERROR CODE                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0308
*   IF IOPRETRN=IOPNOTFD THEN       /* IF ENTRY NOT FOUND THEN RESET
*                                      RETURN CODE TO ZERO           */
@RF00306 CLI   IOPRETRN(IOPPTR),4                                  0308
         BNE   @RF00308                                            0308
*     IOPRETRN=IOPGOOD;             /* SET RC=0                      */
         MVI   IOPRETRN(IOPPTR),X'00'                              0309
*   END TM1PROC1;                   /*                               */
@EL00002 DS    0H                                                  0310
@EF00002 DS    0H                                                  0310
@ER00002 LM    @14,@02,@SA00002                                    0310
         LM    @04,@12,@SA00002+20                                 0310
         BR    @14                                                 0310
*TM1PROC2:                                                         0311
*   PROC;                           /*                               */
*                                                                  0311
TM1PROC2 STM   @14,@02,@SA00003                                    0311
         STM   @04,@12,@SA00003+20                                 0311
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN ICT MOD VALUES FROM MCB ELEMENT PASSED                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0312
*                                                                  0312
*   /*****************************************************************/
*   /*                                                               */
*   /* DALIAS ON ++MOD/++ZAP CONTROL STATEMENT                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0312
*   IF MCBEDALS^=BLANKS             /* DALIAS ENTERED ON ++MOD?      */
*       &CCAACCPT=ON THEN           /* DO ONLY FOR ACCEPT FUNCTION   */
         L     @08,@PC00001+12                                     0312
         L     @08,ELMCBPTR(,@08)                                  0312
         CLC   MCBEDALS(8,@08),BLANKS                              0312
         BE    @RF00312                                            0312
         TM    CCAACCPT(CCAPTR),B'00100000'                        0312
         BNO   @RF00312                                            0312
*     DO;                           /* ADD TO ICTTCHN LIST           */
*       CALL HMASMTAI(TBLXPARM,     /* PARAMETER FOR TABLE MODULES   */
*           ICTMTCHN(1),            /* CHAIN TO BE BUILT             */
*           ADDR(MCBEDALS),         /* DATA TO BE CHAINED            */
*           LENGTH(ICTTALLS(1)));   /* DATA TO CHAIN LENGTH          */
         L     @15,@PC00001                                        0314
         ST    @15,@AL00001                                        0314
         L     @15,@PC00001+4                                      0314
         L     @01,ICMODPTR(,@15)                                  0314
         LA    @15,ICTMTCHN(,@01)                                  0314
         ST    @15,@AL00001+4                                      0314
         LA    @08,MCBEDALS(,@08)                                  0314
         ST    @08,@TF00001                                        0314
         LA    @08,@TF00001                                        0314
         ST    @08,@AL00001+8                                      0314
         LA    @08,@CF00062                                        0314
         ST    @08,@AL00001+12                                     0314
         L     @15,@CV01856                                        0314
         LA    @01,@AL00001                                        0314
         BALR  @14,@15                                             0314
*       RFY                                                        0315
*         RTNCODE RSTD;             /* RESTRICT REG 15 USAGE         */
*       IF RTNCODE^=IOPGOOD THEN    /* WAS HMASMTAI SUCCESSFULL?     */
         LTR   RTNCODE,RTNCODE                                     0316
         BZ    @RF00316                                            0316
*         TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC     */
         CR    TM1HIRC,RTNCODE                                     0317
         BNL   *+6
         LR    TM1HIRC,RTNCODE                                     0317
*       RFY                                                        0318
*         RTNCODE UNRSTD;           /* RELEASE REG 15                */
@RF00316 DS    0H                                                  0319
*       IF TM1HIRC^=IOPGOOD THEN    /* WAS HMASMTAI SUCCESSFULL?     */
         CH    TM1HIRC,@CH00088                                    0319
         BNE   @RT00319                                            0319
*         RETURN;                   /* NO- RETURN                    */
*       ICTMALIS(1)=ON;             /* INDICATE ALIAS ENTRY EXISTS   */
         L     @08,@PC00001+4                                      0321
         L     @08,ICMODPTR(,@08)                                  0321
         OI    ICTMALIS(@08),B'00000100'                           0321
*     END;                          /*                               */
*                                                                  0322
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE ON ++MOD CONTROL STATEMENT                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0323
*   IF MCBEDEL=ON THEN              /* WAS DELETE ENTERED ON ++MOD?  */
@RF00312 L     @08,@PC00001+12                                     0323
         L     @08,ELMCBPTR(,@08)                                  0323
         TM    MCBEDEL(@08),B'01000000'                            0323
         BNO   @RF00323                                            0323
*     ICTMIDEL(1)=ON;               /* YES- SET ON ICT DELETE FLAG   */
*                                                                  0324
         L     @08,@PC00001+4                                      0324
         L     @08,ICMODPTR(,@08)                                  0324
         OI    ICTMIDEL(@08),B'01000000'                           0324
*   /*****************************************************************/
*   /*                                                               */
*   /* DISTLIB ON ++MOD/++ZAP CONTROL STATEMENT                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   IF MCBEDIST^=BLANKS THEN        /* DISTLIB ENTERED ON ++MOD?     */
@RF00323 L     @08,@PC00001+12                                     0325
         L     @08,ELMCBPTR(,@08)                                  0325
         CLC   MCBEDIST(8,@08),BLANKS                              0325
         BE    @RF00325                                            0325
*     ICTMDSTL(1)=MCBEDIST;         /* PICK UP MCB DISTLIB VALUE     */
         L     @15,@PC00001+4                                      0326
         L     @01,ICMODPTR(,@15)                                  0326
         MVC   ICTMDSTL(8,@01),MCBEDIST(@08)                       0326
*                                                                  0327
*   /*****************************************************************/
*   /*                                                               */
*   /* LEPARMS ON ++MOD CONTROL STATEMENT                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0327
*   IF MCBEFLG1^=ALLOFF             /* ANY LINK EDIT PARMS ENTERED,  */
*       ×MCBEFLG2^=ALLOFF THEN      /* IN EITHER LE PARM BYTE?       */
@RF00325 L     @08,@PC00001+12                                     0327
         L     @08,ELMCBPTR(,@08)                                  0327
         CLI   MCBEFLG1(@08),B'00000000'                           0327
         BNE   @RT00327                                            0327
         CLI   MCBEFLG2(@08),B'00000000'                           0327
         BE    @RF00327                                            0327
@RT00327 DS    0H                                                  0328
*     ICTMPRMS(1)=ON;               /* MOD LE PARMS OBTAINED IN MCB  */
         L     @08,@PC00001+4                                      0328
         L     @08,ICMODPTR(,@08)                                  0328
         OI    ICTMPRMS(@08),B'00000010'                           0328
*   ICTMLEP1(1)=MCBEFLG1;           /* PICK UP FIRST BYTE MCB LEPARMS*/
@RF00327 L     @08,@PC00001+4                                      0329
         L     @08,ICMODPTR(,@08)                                  0329
         L     @15,@PC00001+12                                     0329
         L     @15,ELMCBPTR(,@15)                                  0329
         MVC   ICTMLEP1(1,@08),MCBEFLG1(@15)                       0329
*   ICTMLEP2(1)=MCBEFLG2;           /* PICK UP REST OF MCB LEPARMS   */
*                                                                  0330
         MVC   ICTMLEP2(1,@08),MCBEFLG2(@15)                       0330
*   /*****************************************************************/
*   /*                                                               */
*   /* LKLIB × TXLIB × RELFILE ON ++MOD CONTROL STATEMENT MOVE TO    */
*   /* FROMLIB FOR APPLY/ACCEPT. NOTE: KEYWORDS MUTUALLY EXCLUSIVE.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*   IF CCAAPPLY=ON                  /* IS FUNCTION APPLY OR ACCEPT?  */
*       ×CCAACCPT=ON THEN           /*                               */
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0331
         BZ    @RF00331                                            0331
*     DO;                           /*                               */
*       IF MCBELKLB^=BLANKS THEN    /* WAS LKLIB ENTERED ON ++MOD?   */
         CLC   MCBELKLB(8,@15),BLANKS                              0333
         BE    @RF00333                                            0333
*         DO;                       /*                               */
*           ICTFMLIB(1)=MCBELKLB;   /* YES- SET FROMLIB TO MCBELKLB  */
         MVC   ICTFMLIB(8,@08),MCBELKLB(@15)                       0335
*           ICTLIBLK(1)=ON;         /* INDICATE LKLIB                */
         OI    ICTLIBLK(@08),B'10000000'                           0336
*         END;                      /*                               */
*       ELSE                                                       0338
*         IF MCBETXLB^=BLANKS THEN  /* WAS TXLIB ENTERED ON ++MOD?   */
         B     @RC00333                                            0338
@RF00333 L     @08,@PC00001+12                                     0338
         L     @08,ELMCBPTR(,@08)                                  0338
         CLC   MCBETXLB(8,@08),BLANKS                              0338
         BE    @RF00338                                            0338
*           DO;                     /*                               */
*             ICTFMLIB(1)=MCBETXLB; /* YES- SET FROMLIB TO MCBETXLB  */
         L     @15,@PC00001+4                                      0340
         L     @15,ICMODPTR(,@15)                                  0340
         MVC   ICTFMLIB(8,@15),MCBETXLB(@08)                       0340
*             ICTLIBTX(1)=ON;       /* INDICATE TXLIB                */
         OI    ICTLIBTX(@15),B'01000000'                           0341
*           END;                    /*                               */
*         ELSE                                                     0343
*           IF MCBERLF^=BLANKS(1:4) THEN/* RELFILE ENTERED ON ++MOD? */
         B     @RC00338                                            0343
@RF00338 L     @08,@PC00001+12                                     0343
         L     @08,ELMCBPTR(,@08)                                  0343
         CLC   MCBERLF(4,@08),BLANKS                               0343
         BE    @RF00343                                            0343
*             DO;                   /* YES- PROCESS FOR RELFILE      */
*               ICTMRELF(1)=ON;     /* SET BIT TO INDICATE RELF      */
         L     @08,@PC00001+4                                      0345
         L     @08,ICMODPTR(,@08)                                  0345
         OI    ICTMRELF(@08),B'00100000'                           0345
*               ICTFMLIB(1)=CSMPTLIB;/* SET FROMLIB TO SMPTLIB       */
*                                                                  0346
         MVC   ICTFMLIB(8,@08),@CC01864                            0346
*               /*****************************************************/
*               /*                                                   */
*               /* CONVERT RELFILE TO HEX AND MOVE INTO ICTMRELN(1)  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0347
*               RADJ=CZEROS;        /* INIT WORKAREA TO RECEIVE RIGHT
*                                      ADJUSTED RELFILE NUMBER       */
         MVC   RADJ(8),@CC01868                                    0347
*               S=LENGTH(RADJ);     /* INDEX SET TO RIGHT HAND BYTE  */
         LA    S,8                                                 0348
*               DO T=LENGTH(MCBERLF) TO 1 BY-1;/* MOVE THROUGH     0349
*                                      MCBERLF FROM RIGHT TO LEFT    */
         LA    T,4                                                 0349
@DL00349 DS    0H                                                  0350
*                 IF MCBERLF(T)^=' ' THEN/* IGNORE BLANKS IN FIELD   */
         L     @08,@PC00001+12                                     0350
         L     @08,ELMCBPTR(,@08)                                  0350
         LR    @01,@08                                             0350
         ALR   @01,T                                               0350
         CLI   MCBERLF-1(@01),C' '                                 0350
         BE    @RF00350                                            0350
*                   DO;             /*                               */
*                     RADJ(S)=MCBERLF(T);/* PUT CHAR IN WORKAREA     */
         LA    @01,RADJ-1(S)                                       0352
         ALR   @08,T                                               0352
         MVC   0(1,@01),MCBERLF-1(@08)                             0352
*                     S=S-1;        /* MOVE INDEX 1 TO LEFT          */
         BCTR  S,0                                                 0353
*                   END;            /*                               */
*               END;                /*                               */
@RF00350 BCTR  T,0                                                 0355
         CH    T,@CH00070                                          0355
         BNL   @DL00349                                            0355
*               PACK(PKDEC,RADJ);   /* CONVERT CHAR TO PACKED DECIMAL*/
         PACK  PKDEC(8),RADJ(8)                                    0356
*               CVB(FIX31,PKDEC);   /* CONVERT PACKED DECIMAL->BINARY*/
         CVB   FIX31,PKDEC                                         0357
*               ICTMRELN(1)=FIX31;  /* SET CURRENT ELEMENT RELFILE#  */
         L     @08,@PC00001+4                                      0358
         L     @08,ICMODPTR(,@08)                                  0358
         STH   FIX31,ICTMRELN(,@08)                                0358
*             END;                  /*                               */
*           ELSE                                                   0360
*             ICTFMLIB(1)=CSMPWRK3; /* YES- SET FROMLIB TO SMPWRK3   */
         B     @RC00343                                            0360
@RF00343 L     @08,@PC00001+4                                      0360
         L     @08,ICMODPTR(,@08)                                  0360
         MVC   ICTFMLIB(8,@08),@CC01866                            0360
*     END;                          /*                               */
*                                                                  0361
@RC00343 DS    0H                                                  0361
@RC00338 DS    0H                                                  0361
@RC00333 DS    0H                                                  0362
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD VERSION LIST FOR ++MOD CONTROL STATEMENT                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0362
*   ICTMVCHN(1)=0;                  /* CLEAR VERSION LIST POINTER    */
@RF00331 L     @08,@PC00001+4                                      0362
         L     @08,ICMODPTR(,@08)                                  0362
         SLR   @15,@15                                             0362
         ST    @15,ICTMVCHN(,@08)                                  0362
*   DO S=1 BY 1 WHILE MCBEND(S)^=IOPEOLST/* PROCESS ALL MCB        0363
*                                      SUBENTRIES                    */
*         &TM1HIRC=IOPGOOD;         /* WHILE RETURN CODE = ZERO      */
         LA    S,1                                                 0363
         B     @DE00363                                            0363
@DL00363 DS    0H                                                  0364
*     IF MCBEIND(S)=MCBEVERS THEN   /* SUBENTRY A VERSION NUMBER?    */
         LR    @08,S                                               0364
         MH    @08,@CH00038                                        0364
         L     @05,@PC00001+12                                     0364
         L     @05,ELMCBPTR(,@05)                                  0364
         SLR   @15,@15                                             0364
         IC    @15,MCBEIND-9(@08,@05)                              0364
         CH    @15,@CH00070                                        0364
         BNE   @RF00364                                            0364
*       DO;                         /*                               */
*         CALL HMASMTAI(TBLXPARM,   /* PARAMETER FOR TABLE MODULES   */
*             ICTMVCHN(1),          /* CHAIN TO BE BUILT             */
*             ADDR(MCBEVLST(S)),    /* DATA TO BE CHAINED            */
*             LENGTH(ICTMVRLS(1))); /* DATA TO CHAIN LENGTH          */
         L     @15,@PC00001                                        0366
         ST    @15,@AL00001                                        0366
         L     @15,@PC00001+4                                      0366
         L     @01,ICMODPTR(,@15)                                  0366
         LA    @15,ICTMVCHN(,@01)                                  0366
         ST    @15,@AL00001+4                                      0366
         LA    @08,MCBEVLST-9(@08,@05)                             0366
         ST    @08,@TF00001                                        0366
         LA    @08,@TF00001                                        0366
         ST    @08,@AL00001+8                                      0366
         LA    @08,@CF00062                                        0366
         ST    @08,@AL00001+12                                     0366
         L     @15,@CV01856                                        0366
         LA    @01,@AL00001                                        0366
         BALR  @14,@15                                             0366
*         RFY                                                      0367
*           RTNCODE RSTD;           /* RESTRICT REG 15 USAGE         */
*         IF RTNCODE^=IOPGOOD THEN  /* WAS HMASMTAI SUCCESSFULL?     */
         LTR   RTNCODE,RTNCODE                                     0368
         BZ    @RF00368                                            0368
*           TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC   */
         CR    TM1HIRC,RTNCODE                                     0369
         BNL   *+6
         LR    TM1HIRC,RTNCODE                                     0369
*         RFY                                                      0370
*           RTNCODE UNRSTD;         /* RELEASE REG 15                */
@RF00368 DS    0H                                                  0371
*       END;                        /*                               */
*   END;                                                           0372
@RF00364 AH    S,@CH00070                                          0372
@DE00363 LR    @08,S                                               0372
         MH    @08,@CH00038                                        0372
         L     @05,@PC00001+12                                     0372
         L     @05,ELMCBPTR(,@05)                                  0372
         SLR   @15,@15                                             0372
         IC    @15,MCBEND-9(@08,@05)                               0372
         CH    @15,@CH00714                                        0372
         BE    @DC00363                                            0372
         CH    TM1HIRC,@CH00088                                    0372
         BE    @DL00363                                            0372
@DC00363 DS    0H                                                  0373
*   IF ICTMVCHN(1)=0                /* NO VERSION LIST BUILT         */
*     THEN                                                         0373
         L     @08,@PC00001+4                                      0373
         L     @08,ICMODPTR(,@08)                                  0373
         ICM   @15,15,ICTMVCHN(@08)                                0373
         BNZ   @RF00373                                            0373
*     ICTMVCHN(1)=TBLXNULL;         /* POINT TO EMPTY LIST           */
*                                                                  0374
         L     @15,@PC00001                                        0374
         MVC   ICTMVCHN(4,@08),TBLXNULL(@15)                       0374
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD ALIAS LIST FOR ++MOD AND ++ZAP CONTROL STATEMENTS       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0375
*   CALL ALASPROC;                  /*                               */
*                                                                  0375
@RF00373 BAL   @14,ALASPROC                                        0375
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A MOD ENTRY WAS FOUND, THEN CALL TM1LMOD TO SEARCH THE MCB */
*   /* FOR LMOD SUBENTRIES TO ADD TO THE MOD ENTRY.                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0376
*   IF MODFND=ON THEN               /* WAS A MOD ENTRY FOUND?        */
         TM    MODFND,B'01000000'                                  0376
         BNO   @RF00376                                            0376
*     DO;                           /*                               */
*       CALL TM1LMOD;               /* TO PROCESS MCB LMOD SUBENTRIES*/
         BAL   @14,TM1LMOD                                         0378
*       TM1HIRC=MAX(TM1HIRC,IOPRETRN);/* PICK UP HIGHEST RC          */
         SLR   @08,@08                                             0379
         IC    @08,IOPRETRN(,IOPPTR)                               0379
         CR    TM1HIRC,@08                                         0379
         BNL   *+6
         LR    TM1HIRC,@08                                         0379
*     END;                          /*                               */
*                                                                  0380
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MCBTYPE PASSED IS A ZAP, THEN TURN OFF THE MOD TYPE BIT*/
*   /* AND TURN ON THE ZAP TYPE BIT.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0381
*   IF MCBTYPE=MCBZAPTP THEN        /* IS MCB A ZAP TYPE?            */
@RF00376 L     @08,@PC00001+12                                     0381
         L     @08,ELMCBPTR(,@08)                                  0381
         CLI   MCBTYPE(@08),7                                      0381
         BNE   @RF00381                                            0381
*     DO;                           /*                               */
*       ICTMMOD(1)=OFF;             /* TURN OFF MOD BIT              */
*       ICTMZAP(1)=ON;              /* TURN ON ZAP BIT               */
         L     @08,@PC00001+4                                      0384
         L     @08,ICMODPTR(,@08)                                  0384
         OI    ICTMZAP(@08),B'00100000'                            0384
         NI    ICTMMOD(@08),B'01111111'                            0384
*     END;                          /*                               */
*   END TM1PROC2;                   /*                               */
@EL00003 DS    0H                                                  0386
@EF00003 DS    0H                                                  0386
@ER00003 LM    @14,@02,@SA00003                                    0386
         LM    @04,@12,@SA00003+20                                 0386
         BR    @14                                                 0386
*ALASPROC:                                                         0387
*   PROC;                           /*                               */
*                                                                  0387
ALASPROC STM   @14,@02,@SA00004                                    0387
         STM   @04,@12,@SA00004+20                                 0387
*   /*****************************************************************/
*   /*                                                               */
*   /* ALIAS NAMES ARE PUT INTO THE ICT ENTRY. IF AN MCB HAS BEEN    */
*   /* SUPPLIED THEN THE IT IS SEARCHED FOR THE NAMES. IF NONE ARE   */
*   /* FOUND THE THE (A)CDS ELEMENT ENTRY IS USED FOR THE NAMES.     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0388
*   IF ELMCBPTR^=ZERO THEN          /*                               */
         L     @08,@PC00001+12                                     0388
         ICM   @15,15,ELMCBPTR(@08)                                0388
         BZ    @RF00388                                            0388
*     DO S=1 BY 1 WHILE MCBEND(S)^=IOPEOLST/* PROCESS ALL MCB      0389
*                                      SUBENTRIES                    */
*           &TM1HIRC=IOPGOOD;       /* WHILE RETURN CODE = ZERO      */
         LA    S,1                                                 0389
         B     @DE00389                                            0389
@DL00389 DS    0H                                                  0390
*       IF MCBEIND(S)=MCBEALIS THEN /* SUBENTRY A TALIAS NAME?       */
         LR    @08,S                                               0390
         MH    @08,@CH00038                                        0390
         L     @05,@PC00001+12                                     0390
         L     @05,ELMCBPTR(,@05)                                  0390
         SLR   @15,@15                                             0390
         IC    @15,MCBEIND-9(@08,@05)                              0390
         CH    @15,@CH00279                                        0390
         BNE   @RF00390                                            0390
*         DO;                       /*                               */
*           CALL HMASMTAI(TBLXPARM, /* PARAMETER FOR TABLE MODULES   */
*               ICTMTCHN(1),        /* CHAIN TO BE BUILT             */
*               ADDR(MCBEVLST(S)),  /* DATA TO BE CHAINED            */
*               LENGTH(ICTTALLS(1)));/* DATA TO CHAIN LENGTH         */
         L     @15,@PC00001                                        0392
         ST    @15,@AL00001                                        0392
         L     @15,@PC00001+4                                      0392
         L     @01,ICMODPTR(,@15)                                  0392
         LA    @15,ICTMTCHN(,@01)                                  0392
         ST    @15,@AL00001+4                                      0392
         LA    @08,MCBEVLST-9(@08,@05)                             0392
         ST    @08,@TF00001                                        0392
         LA    @08,@TF00001                                        0392
         ST    @08,@AL00001+8                                      0392
         LA    @08,@CF00062                                        0392
         ST    @08,@AL00001+12                                     0392
         L     @15,@CV01856                                        0392
         LA    @01,@AL00001                                        0392
         BALR  @14,@15                                             0392
*           RFY                                                    0393
*             RTNCODE RSTD;         /* RESTRICT REG 15 USAGE         */
*           IF RTNCODE^=IOPGOOD THEN/* WAS HMASMTAI SUCCESSFULL?     */
         LTR   RTNCODE,RTNCODE                                     0394
         BZ    @RF00394                                            0394
*             TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC */
         CR    TM1HIRC,RTNCODE                                     0395
         BNL   *+6
         LR    TM1HIRC,RTNCODE                                     0395
*           ELSE                                                   0396
*             ICTMALIS(1)=ON;       /* INDICATE ALIAS ENTRY EXISTS   */
         B     @RC00394                                            0396
@RF00394 L     @14,@PC00001+4                                      0396
         L     @14,ICMODPTR(,@14)                                  0396
         OI    ICTMALIS(@14),B'00000100'                           0396
*           RFY                                                    0397
*             RTNCODE UNRSTD;       /* RELEASE REG 15                */
@RC00394 DS    0H                                                  0398
*         END;                      /*                               */
*     END;                          /*                               */
*                                                                  0399
@RF00390 AH    S,@CH00070                                          0399
@DE00389 LR    @08,S                                               0399
         MH    @08,@CH00038                                        0399
         L     @05,@PC00001+12                                     0399
         L     @05,ELMCBPTR(,@05)                                  0399
         SLR   @15,@15                                             0399
         IC    @15,MCBEND-9(@08,@05)                               0399
         CH    @15,@CH00714                                        0399
         BE    @DC00389                                            0399
         CH    TM1HIRC,@CH00088                                    0399
         BE    @DL00389                                            0399
@DC00389 DS    0H                                                  0400
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ALIAS FROM MCB NOW CHECK FOR IOP VALUES                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0400
*   IF DLIBBIT=ON                   /* IOP PRESENT                   */
*       &ICTMALIS(1)=OFF THEN       /* ... AND NO ALIAS NAMES YET    */
@RF00388 TM    DLIBBIT,B'10000000'                                 0400
         BNO   @RF00400                                            0400
         L     @08,@PC00001+4                                      0400
         L     @08,ICMODPTR(,@08)                                  0400
         TM    ICTMALIS(@08),B'00000100'                           0400
         BNZ   @RF00400                                            0400
*     DO S=1 BY 1 WHILE IOPMODND(S)^=IOPEOLST/* PROCESS ALL        0401
*                                      SUBENTRIES                    */
*           &TM1HIRC=IOPGOOD;       /* WHILE RETURN CODE = ZERO      */
         LA    S,1                                                 0401
         B     @DE00401                                            0401
@DL00401 DS    0H                                                  0402
*       IF IOPMDIND(S)=IOPMDTAL     /* SUBENTRY A ALIAS NAME?        */
*           ×IOPMDIND(S)=IOPMDDAL THEN/*                             */
         LR    @08,S                                               0402
         MH    @08,@CH00038                                        0402
         SLR   @05,@05                                             0402
         IC    @05,IOPMDIND-9(@08,IOPPTR)                          0402
         CH    @05,@CH00279                                        0402
         BE    @RT00402                                            0402
         CH    @05,@CH00093                                        0402
         BNE   @RF00402                                            0402
@RT00402 DS    0H                                                  0403
*         DO;                       /*                               */
*           CALL HMASMTAI(TBLXPARM, /* PARAMETER FOR TABLE MODULES   */
*               ICTMTCHN(1),        /* CHAIN TO BE BUILT             */
*               ADDR(IOPMDDTA(S)),  /* DATA TO BE CHAINED            */
*               LENGTH(ICTTALLS(1)));/* DATA TO CHAIN LENGTH         */
         L     @08,@PC00001                                        0404
         ST    @08,@AL00001                                        0404
         L     @08,@PC00001+4                                      0404
         L     @08,ICMODPTR(,@08)                                  0404
         LA    @08,ICTMTCHN(,@08)                                  0404
         ST    @08,@AL00001+4                                      0404
         LR    @08,S                                               0404
         MH    @08,@CH00038                                        0404
         LA    @08,IOPMDDTA-9(@08,IOPPTR)                          0404
         ST    @08,@TF00001                                        0404
         LA    @08,@TF00001                                        0404
         ST    @08,@AL00001+8                                      0404
         LA    @08,@CF00062                                        0404
         ST    @08,@AL00001+12                                     0404
         L     @15,@CV01856                                        0404
         LA    @01,@AL00001                                        0404
         BALR  @14,@15                                             0404
*           RFY                                                    0405
*             RTNCODE RSTD;         /* RESTRICT REG 15 USAGE         */
*           IF RTNCODE^=IOPGOOD THEN/* WAS HMASMTAI SUCCESSFULL?     */
         LTR   RTNCODE,RTNCODE                                     0406
         BZ    @RF00406                                            0406
*             TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC */
         CR    TM1HIRC,RTNCODE                                     0407
         BNL   *+6
         LR    TM1HIRC,RTNCODE                                     0407
*           ELSE                                                   0408
*             ICTMALIS(1)=ON;       /* INDICATE ALIAS ENTRY EXISTS   */
         B     @RC00406                                            0408
@RF00406 L     @14,@PC00001+4                                      0408
         L     @14,ICMODPTR(,@14)                                  0408
         OI    ICTMALIS(@14),B'00000100'                           0408
*           RFY                                                    0409
*             RTNCODE UNRSTD;       /* RELEASE REG 15                */
@RC00406 DS    0H                                                  0410
*         END;                      /*                               */
*     END;                          /*                               */
@RF00402 AH    S,@CH00070                                          0411
@DE00401 LR    @08,S                                               0411
         MH    @08,@CH00038                                        0411
         SLR   @05,@05                                             0411
         IC    @05,IOPMODND-9(@08,IOPPTR)                          0411
         CH    @05,@CH00714                                        0411
         BE    @DC00401                                            0411
         CH    TM1HIRC,@CH00088                                    0411
         BE    @DL00401                                            0411
@DC00401 DS    0H                                                  0412
*   END ALASPROC;                   /*                               */
@EL00004 DS    0H                                                  0412
@EF00004 DS    0H                                                  0412
@ER00004 LM    @14,@02,@SA00004                                    0412
         LM    @04,@12,@SA00004+20                                 0412
         BR    @14                                                 0412
*TM1PROC3:                                                         0413
*   PROC;                           /*                               */
*                                                                  0413
TM1PROC3 STM   @14,@02,@SA00005                                    0413
         STM   @04,@12,@SA00005+20                                 0413
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A DISTLIB VALUE FOUND. FOR ANY FUNCTION, IF ONE NOT */
*   /* FOUND THEN SEND ERROR MESSAGE HMA431I (INSUFFICIENT INFOR-    */
*   /* MATION AVAILABLE FOR SYSMOD PROCESSING) AND SET THE RETURN    */
*   /* CODE TO STOPPTF (RC=8).                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*   IF ICTMDSTL(1)=BLANKS THEN      /* HAS A DISTLIB VALUE BEEN FOUND*/
         L     @08,@PC00001+4                                      0414
         L     @08,ICMODPTR(,@08)                                  0414
         CLC   ICTMDSTL(8,@08),BLANKS                              0414
         BNE   @RF00414                                            0414
*     DO;                           /* NO- THEN SEND ERROR MESSAGE   */
*       ICTMCPL(1)=ON;              /* SET COMPLETE BIT ON           */
*       ICTMNOGO(1)=ON;             /* SET NOGO BIT ON               */
*       ICTMMSG(1)=ON;              /* SET MESSAGE SENT BIT ON       */
*                                                                  0418
         OI    ICTMCPL(@08),B'01110000'                            0418
*       /*************************************************************/
*       /*                                                           */
*       /* GENERATE ERROR MSG HMA431                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0419
*       ETYPE='MOD     ';           /* ELEMENT TYPE FOR MSG          */
         MVC   ETYPE(8),@CC01929                                   0419
*       HMASMMGP=''B;               /* ZERO PARAMETER FIELD          */
         XC    HMASMMGP(24),HMASMMGP                               0420
*       MGPTYPE=MGPERR;             /* SET FOR RETURN CODE=8         */
         MVI   MGPTYPE,X'03'                                       0421
*       MGPPRINT=ON;                /* SEND TO SMPOUT                */
*       MGPHLDS=ON;                 /* SEND TO SMPLOG                */
         OI    MGPPRINT,B'10010000'                                0423
*       MGPMGNO1=HMA431I;           /* INSUFFICIENT INFORMATION MSG  */
         MVC   MGPMGNO1(2),@CH01859                                0424
*       MGPVARPT(1)=ADDR(ETYPE);    /* MOD ELEMENT                   */
         LA    @02,ETYPE                                           0425
         ST    @02,MGPVARPT                                        0425
*       MGPVARPT(2)=ADDR(ICTMNAME(1));/* ITS NAME                    */
         ST    @08,MGPVARPT+4                                      0426
*       MGPVARPT(3)=ADDR(ICTPTFS(1));/* OUNER SYSMOD                 */
         L     @08,@PC00001+8                                      0427
         L     @08,ICPTFPTR(,@08)                                  0427
         ST    @08,MGPVARPT+8                                      0427
*       CALL HMASMMSG(HMASMMGP);    /* SEND ERROR MESSAGE            */
*                                                                  0428
         L     @15,@CV01854                                        0428
         LA    @01,@AL00428                                        0428
         BALR  @14,@15                                             0428
*       /*************************************************************/
*       /*                                                           */
*       /* SET RETURN CODE TO STOPPTF (RC=8)                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0429
*       TM1HIRC=MAX(TM1HIRC,STOPPTF);/*                              */
         LA    @08,8                                               0429
         CR    TM1HIRC,@08                                         0429
         BNL   *+6
         LR    TM1HIRC,@08                                         0429
*     END;                          /*                               */
*   END TM1PROC3;                   /*                               */
@EL00005 DS    0H                                                  0431
@EF00005 DS    0H                                                  0431
@ER00005 LM    @14,@02,@SA00005                                    0431
         LM    @04,@12,@SA00005+20                                 0431
         BR    @14                                                 0431
*TM1PROC4:                                                         0432
*   PROC;                           /*                               */
*                                                                  0432
TM1PROC4 STM   @14,@12,12(@13)                                     0432
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A DLIB VALUE WAS FOUND ON THE CDS, AND APPLY FUNCTION IS   */
*   /* BEING EXECUTED, AND A MCB WAS PASSED, AND MCB DISTLIB VALUE   */
*   /* WAS ENTERED, THEN COMPARE THE CDS DISTLIB AND THE MCB DISTLIB */
*   /* VALUES. IF DIFFERENT DLIB VALUES ARE FOUND, THEN BLANK OUT THE*/
*   /* ICTMOD ENTRY AND SET THE DISTLIB CONFLICT BIT (ICTMDSTE) ON.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0433
*   IF DLIBBIT=ON                   /* WAS A DLIB VALUE FOUND, AND   */
*       &CCAAPPLY=ON                /* IS THE FUNCTION APPLY, AND    */
*       &ELMCBPTR^=ZERO             /* WAS A MCB PASSED, AND         */
*       &MCBEDIST^=BLANKS           /* MCB DISTLIB WAS ENTERED, AND  */
*       &MCBEDIST^=IOPDLIB THEN     /* MCB DISTLIB ^= IOPDLIB?       */
         TM    DLIBBIT,B'10000000'                                 0433
         BNO   @RF00433                                            0433
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0433
         BNO   @RF00433                                            0433
         L     @08,@PC00001+12                                     0433
         L     @08,ELMCBPTR(,@08)                                  0433
         LTR   @08,@08                                             0433
         BZ    @RF00433                                            0433
         CLC   MCBEDIST(8,@08),BLANKS                              0433
         BE    @RF00433                                            0433
         CLC   MCBEDIST(8,@08),IOPDLIB(IOPPTR)                     0433
         BE    @RF00433                                            0433
*     DO;                           /*                               */
*       ICTMDSTL(1)=BLANKS;         /* BLANK OUT THE ICT DISTLIB     */
         L     @08,@PC00001+4                                      0435
         L     @08,ICMODPTR(,@08)                                  0435
         MVC   ICTMDSTL(8,@08),BLANKS                              0435
*       ICTMDSTE(1)=ON;             /* INDICATE A DLIB CONFLICT      */
         OI    ICTMDSTE(@08),B'00000100'                           0436
*     END;                          /*                               */
*   END TM1PROC4;                   /*                               */
@EL00006 DS    0H                                                  0438
@EF00006 DS    0H                                                  0438
@ER00006 LM    @14,@12,12(@13)                                     0438
         BR    @14                                                 0438
*TM1PROC5:                                                         0439
*   PROC;                           /*                               */
*                                                                  0439
TM1PROC5 STM   @14,@12,@SA00007                                    0439
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ACCEPT FUNCTION, AND A DLIB VALUE WAS FOUND IN THE ACDS,   */
*   /* AND A MCB WAS PASSED, AND THE VALUES ARE DIFFERENT, THEN CHECK*/
*   /* 1) IF NOAPPLY WAS NOT SPECIFIED 2) IF SYSMOD OWNING THE       */
*   /* ELEMENT IS APPLIED ON THE CDS 3) IF THE SYSMOD OWNING THE     */
*   /* ELEMENT APPEARS AS AN FMID,RMID OR UMID VALUE IN THE ELEMENT  */
*   /* CDS ENTRY 4) IF THE CDS ENTRY DISTLIB VALUE IS THE SAME AS THE*/
*   /* VALUE IN THE MCB. IF ALL CHECKS (1-4) ARE TRUE THEN THE ICT,  */
*   /* AND ACDS ELEMENT VALUES ARE SET TO THE MCB VALUE, OTHERWISE   */
*   /* THE DLIB CONFLICT BIT (ICTMDSTE)IS SET ON.                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0440
*   IF CCAACCPT=ON                  /* IS FUNCTION ACCEPT, AND       */
*       &DLIBBIT=ON                 /* WAS A DLIB VALUE FOUND, AND   */
*       &ELMCBPTR^=ZERO             /* WAS A MCB PASSED, AND         */
*       &MCBEDIST^=BLANKS           /* DLIB VALUE SUPPLIED IN MCB    */
*       &MCBEDIST^=IOPDLIB THEN     /* ARE MCB & IOP DLIB VALUES ^=? */
         TM    CCAACCPT(CCAPTR),B'00100000'                        0440
         BNO   @RF00440                                            0440
         TM    DLIBBIT,B'10000000'                                 0440
         BNO   @RF00440                                            0440
         L     @08,@PC00001+12                                     0440
         L     @08,ELMCBPTR(,@08)                                  0440
         LTR   @08,@08                                             0440
         BZ    @RF00440                                            0440
         CLC   MCBEDIST(8,@08),BLANKS                              0440
         BE    @RF00440                                            0440
         CLC   MCBEDIST(8,@08),IOPDLIB(IOPPTR)                     0440
         BE    @RF00440                                            0440
*     DO;                           /*                               */
*                                                                  0441
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF CHECK 1 IS SUCCESSFULL                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0442
*       IF TBLNOAPP=OFF THEN        /* NOAPPLY NOT SPECIFIED?        */
         L     @08,@PC00001                                        0442
         L     @08,TBLXTBL(,@08)                                   0442
         TM    TBLNOAPP(@08),B'10000000'                           0442
         BNZ   @RF00442                                            0442
*         DO;                       /*                               */
*           SAVADLIB=IOPDLIB;       /* SAVE ACDS DLIB VALUE          */
         MVC   SAVADLIB(8),IOPDLIB(IOPPTR)                         0444
*           IOPFUNCT=IOPLOC;        /* SET UP TO LOCATE OWNER        */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0445
*           IOPDSID=IOPCDS;         /* SET DATASET TO CDS            */
         MVI   IOPDSID(IOPPTR),X'02'                               0446
*           IOPTYPE=IOPSMD;         /* SYSMOD TYPE ENTRY             */
         MVI   IOPTYPE(IOPPTR),X'0B'                               0447
*           IOPNAME=ICTPTFS(1);     /* OWNER OF ELEMENT              */
*                                                                  0448
         MVI   IOPNAME+7(IOPPTR),C' '                              0448
         L     @08,@PC00001+8                                      0448
         L     @08,ICPTFPTR(,@08)                                  0448
         MVC   IOPNAME(7,IOPPTR),ICTPTFS(@08)                      0448
*           /*********************************************************/
*           /*                                                       */
*           /* LOCATE SYSMOD ON CDS DATASET                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0449
*           CALL HMASMIO(HMASMIOP); /* CALL SMP IO INTERFACE MODULE  */
         ST    IOPPTR,@AL00001                                     0449
         L     @15,@CV01853                                        0449
         LA    @01,@AL00001                                        0449
         BALR  @14,@15                                             0449
*           IF IOPRETRN=IOPGOOD THEN/* IS OWNER APPLIED ON CDS?      */
         CLI   IOPRETRN(IOPPTR),0                                  0450
         BNE   @RF00450                                            0450
*             DO;                   /*                               */
*               SMDAPPLY=ON;        /* INDICATE SYSMOD IS APPLIED    */
         OI    SMDAPPLY,B'01000000'                                0452
*               IOPTYPE=IOPMOD;     /* INDICATE MOD TYPE ENTRY       */
         MVI   IOPTYPE(IOPPTR),X'05'                               0453
*               IOPFUNCT=IOPLOC;    /* LOCATE ELEMENT ON CDS         */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0454
*               IOPNAME=ICTMNAME(1);/* FILL IN ELEMENT NAME          */
         L     @08,@PC00001+4                                      0455
         L     @08,ICMODPTR(,@08)                                  0455
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0455
*                                                                  0456
*               /*****************************************************/
*               /*                                                   */
*               /* LOCATE MOD ENTRY ON CDS DATASET                   */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0456
*               CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE    0456
*                                      MODULE                        */
         ST    IOPPTR,@AL00001                                     0456
         L     @15,@CV01853                                        0456
         LA    @01,@AL00001                                        0456
         BALR  @14,@15                                             0456
*               IF IOPRETRN=IOPGOOD THEN/* IS ELEMENT ALSO ON CDS?   */
*                                                                  0457
         CLI   IOPRETRN(IOPPTR),0                                  0457
         BNE   @RF00457                                            0457
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK IF SYSMOD OWNING ELEMENT IS FMID/RMID/UMID*/
*                 /* IN ENTRY                                        */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0458
*                 DO;               /*                               */
*                   IF IOPFMID=ICTPTFS(1)/* DOES FMID MATCH OWNER, OR*/
*                       ×IOPRMID=ICTPTFS(1) THEN/* DOES RMID MATCH 0459
*                                      OWNER?                        */
         L     @08,@PC00001+8                                      0459
         L     @08,ICPTFPTR(,@08)                                  0459
         CLC   IOPFMID(7,IOPPTR),ICTPTFS(@08)                      0459
         BE    @RT00459                                            0459
         CLC   IOPRMID(7,IOPPTR),ICTPTFS(@08)                      0459
         BNE   @RF00459                                            0459
@RT00459 DS    0H                                                  0460
*                     XMID=ON;      /* INDICATE RMID/FMID MATCH      */
         OI    XMID,B'00100000'                                    0460
*                   ELSE                                           0461
*                     DO L=1 BY 1 WHILE IOPMODND(L)^=IOPEOLST/* TO 0461
*                                      EOF,                          */
*                           &XMID=OFF;/* OR TILL HIT FOUND           */
         B     @RC00459                                            0461
@RF00459 LA    L,1                                                 0461
         B     @DE00461                                            0461
@DL00461 DS    0H                                                  0462
*                       IF IOPMODID(L)=ICTPTFS(1) THEN/* UMID MATCH? */
         LR    @08,L                                               0462
         MH    @08,@CH00038                                        0462
         L     @05,@PC00001+8                                      0462
         L     @05,ICPTFPTR(,@05)                                  0462
         ALR   @08,IOPPTR                                          0462
         CLC   IOPMODID-9(7,@08),ICTPTFS(@05)                      0462
         BNE   @RF00462                                            0462
*                         XMID=ON;  /* INDICATE UMID MATCH           */
         OI    XMID,B'00100000'                                    0463
*                     END;          /*                               */
@RF00462 AH    L,@CH00070                                          0464
@DE00461 LR    @08,L                                               0464
         MH    @08,@CH00038                                        0464
         SLR   @05,@05                                             0464
         IC    @05,IOPMODND-9(@08,IOPPTR)                          0464
         CH    @05,@CH00714                                        0464
         BE    @DC00461                                            0464
         TM    XMID,B'00100000'                                    0464
         BZ    @DL00461                                            0464
@DC00461 DS    0H                                                  0465
*                 END;              /*                               */
@RC00459 DS    0H                                                  0466
*             END;                  /*                               */
*                                                                  0466
@RF00457 DS    0H                                                  0467
*           /*********************************************************/
*           /*                                                       */
*           /* DETERMINE IF CHECKS (2-4) ARE SUCCESSFULL             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0467
*           IF IOPRETRN=IOPGOOD     /* NO ERRORS FROM HMASMIO        */
*               &SMDAPPLY=ON        /* OWNER SYSMOD IS APPLIED       */
*               &XMID=ON            /* EITHER FMID/RMID/UMID MATCH   */
*               &IOPDLIB=MCBEDIST THEN/* CDS DLIB MATCHES MCB DLIB   */
@RF00450 CLI   IOPRETRN(IOPPTR),0                                  0467
         BNE   @RF00467                                            0467
         TM    SMDAPPLY,B'01100000'                                0467
         BNO   @RF00467                                            0467
         L     @08,@PC00001+12                                     0467
         L     @08,ELMCBPTR(,@08)                                  0467
         CLC   IOPDLIB(8,IOPPTR),MCBEDIST(@08)                     0467
         BNE   @RF00467                                            0467
*             DO;                   /*                               */
*                                                                  0468
*               /*****************************************************/
*               /*                                                   */
*               /* UPDATE ELEMENT ENTRY IN ACDS DLIB = CDS AND MCB   */
*               /* DLIB VALUES AND MAKE ICT DLIB VALUE EQUAL TO MCB  */
*               /* DLIB VALUE                                        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0469
*               ICTMDSTL(1)=MCBEDIST;/* SET ICT VALUE = MCB VALUE    */
         L     @03,@PC00001+4                                      0469
         L     @03,ICMODPTR(,@03)                                  0469
         MVC   ICTMDSTL(8,@03),MCBEDIST(@08)                       0469
*               IOPFUNCT=IOPLOC;    /* LOCATE FUNCTION               */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0470
*               IOPDSID=IOPACDS;    /* ACDS DATASET                  */
         MVI   IOPDSID(IOPPTR),X'0C'                               0471
*               IOPNAME=ICTMNAME(1);/* ELEMENT NAME                  */
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@03)                     0472
*               IOPTYPE=IOPMOD;     /* MOD TYPE ENTRY                */
*                                                                  0473
         MVI   IOPTYPE(IOPPTR),X'05'                               0473
*               /*****************************************************/
*               /*                                                   */
*               /* RE LOCATE ACDS MOD ENTRY TO BUFFER FOR UPDATE     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0474
*               CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE    0474
*                                      MODULE                        */
         ST    IOPPTR,@AL00001                                     0474
         L     @15,@CV01853                                        0474
         LA    @01,@AL00001                                        0474
         BALR  @14,@15                                             0474
*               IF IOPRETRN=IOPGOOD THEN/* ELEMENT MOD ENTRY FOUND?  */
         CLI   IOPRETRN(IOPPTR),0                                  0475
         BNE   @RF00475                                            0475
*                 DO;               /*                               */
*                   SAVADLIB=MCBEDIST;/* UPDATE TO MCB DISTLIB VALUE */
         L     @08,@PC00001+12                                     0477
         L     @08,ELMCBPTR(,@08)                                  0477
         MVC   SAVADLIB(8),MCBEDIST(@08)                           0477
*                   IOPDLIB=MCBEDIST;/* UPDATE TO CDS/MCB DISTLIB    */
         MVC   IOPDLIB(8,IOPPTR),MCBEDIST(@08)                     0478
*                   IOPFUNCT=IOPSTOWR;/* INDICATE STOW REPLACE       */
*                                                                  0479
         MVI   IOPFUNCT(IOPPTR),X'54'                              0479
*                   /*************************************************/
*                   /*                                               */
*                   /* REPLACE WITH UPDATED DLIB VALUE FROM MCB      */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0480
*                   CALL HMASMIO(HMASMIOP);/* CALL IO INTERFACE    0480
*                                      MODULE                        */
         ST    IOPPTR,@AL00001                                     0480
         L     @15,@CV01853                                        0480
         LA    @01,@AL00001                                        0480
         BALR  @14,@15                                             0480
*                 END;              /*                               */
*             END;                  /*                               */
*           ELSE                                                   0483
*             ICTMDSTE(1)=ON;       /* SET ON DLIB CONFLICT BIT      */
         B     @RC00467                                            0483
@RF00467 L     @08,@PC00001+4                                      0483
         L     @08,ICMODPTR(,@08)                                  0483
         OI    ICTMDSTE(@08),B'00000100'                           0483
*           IOPDLIB=SAVADLIB;       /* RESTORE DLIB VALUE IF CHANGED */
@RC00467 MVC   IOPDLIB(8,IOPPTR),SAVADLIB                          0484
*         END;                      /*                               */
*       ELSE                                                       0486
*         ICTMDSTE(1)=ON;           /* SET ON DLIB CONFLICT BIT      */
         B     @RC00442                                            0486
@RF00442 L     @08,@PC00001+4                                      0486
         L     @08,ICMODPTR(,@08)                                  0486
         OI    ICTMDSTE(@08),B'00000100'                           0486
*     END;                          /*                               */
@RC00442 DS    0H                                                  0488
*   IF IOPRETRN=IOPNOTFD THEN       /* IF ENTRY NOT FOUND THEN RESET
*                                      RETURN CODE TO ZERO           */
@RF00440 CLI   IOPRETRN(IOPPTR),4                                  0488
         BNE   @RF00488                                            0488
*     IOPRETRN=IOPGOOD;             /* SET RC=0                      */
         MVI   IOPRETRN(IOPPTR),X'00'                              0489
*   END TM1PROC5;                   /*                               */
@EL00007 DS    0H                                                  0490
@EF00007 DS    0H                                                  0490
@ER00007 LM    @14,@12,@SA00007                                    0490
         BR    @14                                                 0490
*TM1PROC6:                                                         0491
*   PROC;                           /*                               */
TM1PROC6 STM   @14,@12,@SA00008                                    0491
*   IOPFUNCT=IOPLOC;                /* SET FUNCTION TO LOCATE        */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0492
*   IOPTYPE=IOPDLB;                 /* INDICATE DLIB ENTRY           */
         MVI   IOPTYPE(IOPPTR),X'06'                               0493
*   IOPNAME=ICTMDSTL(1);            /* DISTLIB ENTRY NAME            */
*                                                                  0494
         L     @08,@PC00001+4                                      0494
         L     @08,ICMODPTR(,@08)                                  0494
         MVC   IOPNAME(8,IOPPTR),ICTMDSTL(@08)                     0494
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF THIS ELEMENTS DISTLIB IS A TOTAL COPY (I.E.- IF A*/
*   /* CDS DLIB ENTRY EXISTS, IT IS A TOTAL COPY DISTLIB)            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0495
*   CALL HMASMIO(HMASMIOP);         /* CALL SMP IO INTERFACE MODULE  */
         ST    IOPPTR,@AL00001                                     0495
         L     @15,@CV01853                                        0495
         LA    @01,@AL00001                                        0495
         BALR  @14,@15                                             0495
*   IF IOPRETRN=IOPGOOD THEN        /* TOTAL COPY DLIB (IE.-FOUND)   */
         CLI   IOPRETRN(IOPPTR),0                                  0496
         BNE   @RF00496                                            0496
*     DO;                           /*                               */
*                                                                  0497
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE THE TARGET SYSLIB SUBENTRIES FROM THE DLIB ENTRY FOR */
*       /* USE LATER IN THE EVENT THAT A CDS LMOD ENTRY NEEDS TO BE  */
*       /* CREATED                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0498
*       SYSLIBS(1)=BLANKS;          /* BLANK OUT FIRST SYSLIB SAVE   */
         MVC   SYSLIBS(8),BLANKS                                   0498
*       SYSLIBS(2)=BLANKS;          /* BLANK OUT LAST SYSLIB SAVE    */
         MVC   SYSLIBS+8(8),BLANKS                                 0499
*       DO L=1 BY 1 WHILE IOPDLBND(L)^=IOPEOLST;/* DO TO END OF LIST */
         LA    L,1                                                 0500
         B     @DE00500                                            0500
@DL00500 DS    0H                                                  0501
*         IF IOPDLIND(L)=IOPDLSYS THEN/* SYSLIB TYPE ENTRY?          */
         LR    @08,L                                               0501
         MH    @08,@CH00038                                        0501
         SLR   @05,@05                                             0501
         IC    @05,IOPDLIND-9(@08,IOPPTR)                          0501
         CH    @05,@CH00070                                        0501
         BNE   @RF00501                                            0501
*           SYSLIBS(L)=IOPDSYS(L);  /* SAVE SYSLIB ENTRIES (MAX=2)   */
         LR    @05,L                                               0502
         SLA   @05,3                                               0502
         LA    @03,SYSLIBS-8(@05)                                  0502
         ALR   @08,IOPPTR                                          0502
         MVC   0(8,@03),IOPDSYS-9(@08)                             0502
*       END;                        /*                               */
@RF00501 AH    L,@CH00070                                          0503
@DE00500 LR    @08,L                                               0503
         MH    @08,@CH00038                                        0503
         SLR   @05,@05                                             0503
         IC    @05,IOPDLBND-9(@08,IOPPTR)                          0503
         CH    @05,@CH00714                                        0503
         BNE   @DL00500                                            0503
*       IOPTYPE=IOPMOD;             /* INDICATE MOD ENTRY            */
         MVI   IOPTYPE(IOPPTR),X'05'                               0504
*       IOPNAME=ICTMNAME(1);        /* MOD NAME BEING PROCESSED      */
*                                                                  0505
         L     @08,@PC00001+4                                      0505
         L     @08,ICMODPTR(,@08)                                  0505
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0505
*       /*************************************************************/
*       /*                                                           */
*       /* ATTEMPT TO LOCATE A CDS MOD ENTRY FOR THIS ELEMENT        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0506
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MODULE  */
         ST    IOPPTR,@AL00001                                     0506
         L     @15,@CV01853                                        0506
         LA    @01,@AL00001                                        0506
         BALR  @14,@15                                             0506
*       IF IOPRETRN=IOPGOOD THEN    /* WAS A MOD ENTRY FOUND?        */
         CLI   IOPRETRN(IOPPTR),0                                  0507
         BNE   @RF00507                                            0507
*         DO;                       /*                               */
*                                                                  0509
*           /*********************************************************/
*           /*                                                       */
*           /* FOR A LOCATED ENTRY, ATTEMPT TO FIND A LMOD SUBENTRY  */
*           /* EQUAL TO THIS ELEMENT                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0509
*           DO S=1 BY 1 TO CCAPEMAX WHILE IOPMODND(S)^=IOPEOLST/*  0509
*                                      TILL                          */
*                 &MODALMOD=OFF;    /* END OR A MATCH FOUND          */
         LA    S,1                                                 0509
         B     @DE00509                                            0509
@DL00509 LR    @08,S                                               0509
         MH    @08,@CH00038                                        0509
         SLR   @05,@05                                             0509
         IC    @05,IOPMODND-9(@08,IOPPTR)                          0509
         CH    @05,@CH00714                                        0509
         BE    @DC00509                                            0509
         TM    MODALMOD,B'00010000'                                0509
         BNZ   @DC00509                                            0509
*             IF IOPLMODS(S)=ICTMNAME(1)/* MOD NAME FOUND AND TYPE IS
*                                      A                             */
*                 &IOPMDIND(S)=IOPMDLMD THEN/* LMOD?                 */
         L     @05,@PC00001+4                                      0510
         L     @05,ICMODPTR(,@05)                                  0510
         ST    @08,@TF00001                                        0510
         ALR   @08,IOPPTR                                          0510
         CLC   IOPLMODS-9(8,@08),ICTMNAME(@05)                     0510
         BNE   @RF00510                                            0510
         L     @08,@TF00001                                        0510
         SLR   @05,@05                                             0510
         IC    @05,IOPMDIND-9(@08,IOPPTR)                          0510
         CH    @05,@CH00070                                        0510
         BNE   @RF00510                                            0510
*               MODALMOD=ON;        /* INDICATE MOD FOUND AS LMOD    */
         OI    MODALMOD,B'00010000'                                0511
*           END;                    /*                               */
@RF00510 AH    S,@CH00070                                          0512
@DE00509 CH    S,CCAPEMAX(,CCAPTR)                                 0512
         BNH   @DL00509                                            0512
@DC00509 DS    0H                                                  0513
*           IF MODALMOD=OFF THEN    /* WAS ENTRY FOUND AS A LMOD?    */
         TM    MODALMOD,B'00010000'                                0513
         BNZ   @RF00513                                            0513
*             DO;                   /* NO- THEN ADD IT AS A LMOD     */
*               IF S+1^>CCAPEMAX THEN/*                              */
         LA    @08,1                                               0515
         LR    @05,S                                               0515
         ALR   @05,@08                                             0515
         CH    @05,CCAPEMAX(,CCAPTR)                               0515
         BH    @RF00515                                            0515
*                 DO;               /*                               */
*                                                                  0516
*                   /*************************************************/
*                   /*                                               */
*                   /* IF NOT FOUND AS A LMOD SUBENTRY ON THE LOCATED*/
*                   /* CDS MOD ENTRY, THEN ADD IT IF SPACE ALLOWS    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0517
*                   IOPLMODS(S)=ICTMNAME(1);/* ADD MOD NAME TO LIST
*                                      OF LMODS                      */
         LR    @05,S                                               0517
         MH    @05,@CH00038                                        0517
         ST    @05,@TF00001                                        0517
         ALR   @05,IOPPTR                                          0517
         L     @03,@PC00001+4                                      0517
         L     @03,ICMODPTR(,@03)                                  0517
         MVC   IOPLMODS-9(8,@05),ICTMNAME(@03)                     0517
*                   IOPMDIND(S)=IOPMDLMD;/* INDICATE LMOD SUBENTRY 0518
*                                      TYPE                          */
         L     @05,@TF00001                                        0518
         STC   @08,IOPMDIND-9(@05,IOPPTR)                          0518
*                   IOPMODND(S+1)=IOPEOLST;/* SET NEW END OF LIST  0519
*                                      MARKER                        */
         LA    @08,255                                             0519
         L     @05,@TF00001                                        0519
         STC   @08,IOPMODND(@05,IOPPTR)                            0519
*                   IOPFUNCT=IOPSTOWR;/* INDICATE STOW REPLACE     0520
*                                      FUNCTION                      */
         MVI   IOPFUNCT(IOPPTR),X'54'                              0520
*                                                                  0521
*                   /*************************************************/
*                   /*                                               */
*                   /* REPLACE THE UPDATED CDS MOD ENTRY             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0521
*                   CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE
*                                      MODULE                        */
         ST    IOPPTR,@AL00001                                     0521
         L     @15,@CV01853                                        0521
         LA    @01,@AL00001                                        0521
         BALR  @14,@15                                             0521
*                 END;              /*                               */
*               ELSE                                               0523
*                 IOPRETRN=IOPEXC;  /* IOPSPACE EXCEEDED- CAN'T ADD  */
         B     @RC00515                                            0523
@RF00515 MVI   IOPRETRN(IOPPTR),X'08'                              0523
*             END;                  /*                               */
*         END;                      /*                               */
*       ELSE                                                       0526
*         IF IOPRETRN=IOPNTFND THEN /* IF NO MOD ENTRY FOUND THEN ADD*/
         B     @RC00507                                            0526
@RF00507 CLI   IOPRETRN(IOPPTR),4                                  0526
         BNE   @RF00526                                            0526
*           DO;                     /*                               */
*                                                                  0527
*             /*******************************************************/
*             /*                                                     */
*             /* IF NO CDS MOD ENTRY WAS FOUND, THEN CREATE A CDS MOD*/
*             /* ENTRY FOR THIS ELEMENT INDICATING A LMOD SUBENTRY   */
*             /* NAME EQUAL TO THE ELEMENT NAME BEING PROCESSED      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0528
*             BLDACDSM=OFF;         /* PREVENT ANOTHER STOW          */
         NI    BLDACDSM,B'11111011'                                0528
*             IOPMODDR=' ';         /* INIT MOD ENTRY DIRECTORY      */
         MVI   IOPMODDR+1(IOPPTR),C' '                             0529
         MVC   IOPMODDR+2(22,IOPPTR),IOPMODDR+1(IOPPTR)            0529
         MVI   IOPMODDR(IOPPTR),C' '                               0529
*             IOPNTLVL=IOPMODLC;    /* CURENT LEVEL                  */
         MVI   IOPNTLVL(IOPPTR),X'02'                              0530
*             IOPRMST=IOPRMST&&IOPRMST;/* ZERO OUT FIELD             */
         XC    IOPRMST(1,IOPPTR),IOPRMST(IOPPTR)                   0531
*             IOPFMST=IOPFMST&&IOPFMST;/* ZERO OUT FIELD             */
         XC    IOPFMST(1,IOPPTR),IOPFMST(IOPPTR)                   0532
*             IOPMODFX=' ';         /* INIT MOD ENTRY DATA FIELDS    */
         MVI   IOPMODFX+1(IOPPTR),C' '                             0533
         MVC   IOPMODFX+2(78,IOPPTR),IOPMODFX+1(IOPPTR)            0533
         MVI   IOPMODFX(IOPPTR),C' '                               0533
*             IOPBUSMD=ICTPTFS(1);  /* SYSMOD CAUSING ADD OF ENTRY   */
         L     @08,@PC00001+8                                      0534
         L     @08,ICPTFPTR(,@08)                                  0534
         MVC   IOPBUSMD(7,IOPPTR),ICTPTFS(@08)                     0534
*             IOPBUTYP=IOPBUADD;    /* INDICATE ADD OPERATION        */
         MVI   IOPBUTYP(IOPPTR),X'01'                              0535
*             IOPMODF1=ICTMLEP1(1); /* FIRST BYTE OF LEPARMS FROM ICT*/
         L     @08,@PC00001+4                                      0536
         L     @08,ICMODPTR(,@08)                                  0536
         MVC   IOPMODF1(1,IOPPTR),ICTMLEP1(@08)                    0536
*             IOPMODF2=ICTMLEP2(1); /* LAST BYTE OF LEPARMS FROM ICT */
         MVC   IOPMODF2(1,IOPPTR),ICTMLEP2(@08)                    0537
*             IOPMODF3=IOPMODF3&&IOPMODF3;/* ZERO OUT FIELD          */
         XC    IOPMODF3(1,IOPPTR),IOPMODF3(IOPPTR)                 0538
*             IOPMODF4=IOPMODF4&&IOPMODF4;/* ZERO OUT FIELD          */
         XC    IOPMODF4(1,IOPPTR),IOPMODF4(IOPPTR)                 0539
*             IOPDLIB=MCBEDIST;     /* DISTRIBUTION LIB FROM MCB     */
         L     @03,@PC00001+12                                     0540
         L     @03,ELMCBPTR(,@03)                                  0540
         MVC   IOPDLIB(8,IOPPTR),MCBEDIST(@03)                     0540
*             IOPLMODS(1)=ICTMNAME(1);/* MOD NAME AS LMOD SUBENTRY   */
         MVC   IOPLMODS(8,IOPPTR),ICTMNAME(@08)                    0541
*             IOPMDIND(1)=IOPMDLMD; /* LOAD MOD TYPE ENTRY           */
         MVI   IOPMDIND(IOPPTR),X'01'                              0542
*             IOPMODND(2)=IOPEOLST; /* SET END OF LIST MARKER        */
         MVI   IOPMODND+9(IOPPTR),X'FF'                            0543
*             IOPFUNCT=IOPSTOWR;    /* INDICATE STOW REPLACE FUNCTION*/
*                                                                  0544
         MVI   IOPFUNCT(IOPPTR),X'54'                              0544
*             /*******************************************************/
*             /*                                                     */
*             /* ADD NEW MOD ENTRY TO THE CDS FOR THIS ELEMENT       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0545
*             CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE MODULE */
         ST    IOPPTR,@AL00001                                     0545
         L     @15,@CV01853                                        0545
         LA    @01,@AL00001                                        0545
         BALR  @14,@15                                             0545
*           END;                    /*                               */
*       IF IOPRETRN=IOPGOOD THEN    /*                               */
@RF00526 DS    0H                                                  0547
@RC00507 CLI   IOPRETRN(IOPPTR),0                                  0547
         BNE   @RF00547                                            0547
*         DO;                       /*                               */
*           IOPFUNCT=IOPLOC;        /* INDICATE LOCATE FUNCTION      */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0549
*           IOPTYPE=IOPLMD;         /* INDICATE LMOD TYPE ENTRY      */
         MVI   IOPTYPE(IOPPTR),X'02'                               0550
*           IOPNAME=ICTMNAME(1);    /* MOD NAME BEING PROCESSED      */
*                                                                  0551
         L     @08,@PC00001+4                                      0551
         L     @08,ICMODPTR(,@08)                                  0551
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0551
*           /*********************************************************/
*           /*                                                       */
*           /* ATTEMPT TO LOCATE A CDS LMOD ENTRY FOR THIS ELEMENT   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0552
*           CALL HMASMIO(HMASMIOP); /* CALL SMP IO INTERFACE MODULE  */
         ST    IOPPTR,@AL00001                                     0552
         L     @15,@CV01853                                        0552
         LA    @01,@AL00001                                        0552
         BALR  @14,@15                                             0552
*           IF IOPRETRN=IOPNTFND THEN/* WAS A LMOD ENTRY FOUND FOR 0553
*                                      MOD                           */
         CLI   IOPRETRN(IOPPTR),4                                  0553
         BNE   @RF00553                                            0553
*             DO;                   /*                               */
*                                                                  0554
*               /*****************************************************/
*               /*                                                   */
*               /* IF NO CDS LMOD ENTRY WAS FOUND, THEN CREATE A CDS */
*               /* LMOD ENTRY FOR THIS ELEMENT INDICATING A LMOD     */
*               /* SUBENTRY NAME EQUAL TO THE ELEMENT NAME BEING     */
*               /* PROCESSED                                         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0555
*               IOPLMDNT=IOPLMDNT&&IOPLMDNT;/* CLEAR FIELD           */
         XC    IOPLMDNT(104,IOPPTR),IOPLMDNT(IOPPTR)               0555
*               IOPLMDFX=' ';       /* CLEAR FIELD                   */
         MVI   IOPLMDFX+1(IOPPTR),C' '                             0556
         MVC   IOPLMDFX+2(78,IOPPTR),IOPLMDFX+1(IOPPTR)            0556
         MVI   IOPLMDFX(IOPPTR),C' '                               0556
*               IOPNTLVL=IOPLMDLC;  /* CURRENT                       */
         MVI   IOPNTLVL(IOPPTR),X'02'                              0557
*               IOPBUSMD=ICTPTFS(1);/* SYSMOD CAUSING ADD OF ENTRY   */
         L     @08,@PC00001+8                                      0558
         L     @08,ICPTFPTR(,@08)                                  0558
         MVC   IOPBUSMD(7,IOPPTR),ICTPTFS(@08)                     0558
*               IOPBUTYP=IOPBUADD;  /* INDICATE ADD OPERATION        */
         MVI   IOPBUTYP(IOPPTR),X'01'                              0559
*               IOPLMDF1=ICTMLEP1(1);/* FIRST BYTE OF LEPARM FROM ICT*/
         L     @08,@PC00001+4                                      0560
         L     @08,ICMODPTR(,@08)                                  0560
         MVC   IOPLMDF1(1,IOPPTR),ICTMLEP1(@08)                    0560
*               IOPLMDF2=ICTMLEP2(1);/* LAST BYTE OF LEPARMS FROM ICT*/
         MVC   IOPLMDF2(1,IOPPTR),ICTMLEP2(@08)                    0561
*               IF IOPLMDF1^=ALLOFF /* ANY LEPARMS ENTERED ON ++MOD? */
*                   ×IOPLMDF2^=ALLOFF THEN/* YES- SET BIT ON         */
         CLI   IOPLMDF1(IOPPTR),B'00000000'                        0562
         BNE   @RT00562                                            0562
         CLI   IOPLMDF2(IOPPTR),B'00000000'                        0562
         BE    @RF00562                                            0562
@RT00562 DS    0H                                                  0563
*                 IOPLINK=ON;       /* LINK-EDIT PARMS OBTAINED      */
         OI    IOPLINK(IOPPTR),B'01000000'                         0563
*               IOPCOPY=ON;         /* COPIED AT SYSGEN              */
@RF00562 OI    IOPCOPY(IOPPTR),B'10000000'                         0564
*                                                                  0565
*               /*****************************************************/
*               /*                                                   */
*               /* INDICATE THE TARGET SYSLIB SUBENTRIES SAVED ABOVE */
*               /* FROM THE CDS DLIB ENTRY                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0565
*               IF SYSLIBS(1)=BLANKS THEN/* ANY SYSLIB NAMES SAVED?  */
         CLC   SYSLIBS(8),BLANKS                                   0565
         BNE   @RF00565                                            0565
*                 IOPLMDND(1)=IOPEOLST;/* NO-SET END OF LIST MARKER  */
         MVI   IOPLMDND(IOPPTR),X'FF'                              0566
*               ELSE                /*                               */
*                 DO;               /*                               */
         B     @RC00565                                            0567
@RF00565 DS    0H                                                  0568
*                   IOPLSYS(1)=SYSLIBS(1);/* PUT IN FIRST SYSLIB NAME*/
         MVC   IOPLSYS(8,IOPPTR),SYSLIBS                           0568
*                   IOPLMIND(1)=IOPLMSYS;/* INDICATE SYSLIB NAME     */
         MVI   IOPLMIND(IOPPTR),X'01'                              0569
*                 END;              /*                               */
*               IF SYSLIBS(2)=BLANKS THEN/* ANY SECOND SYSLIB NAME?  */
@RC00565 CLC   SYSLIBS+8(8),BLANKS                                 0571
         BNE   @RF00571                                            0571
*                 IOPLMDND(2)=IOPEOLST;/* NO-SET END OF LIST MARKER  */
         MVI   IOPLMDND+9(IOPPTR),X'FF'                            0572
*               ELSE                /*                               */
*                 DO;               /*                               */
         B     @RC00571                                            0573
@RF00571 DS    0H                                                  0574
*                   IOPLSYS(2)=SYSLIBS(2);/* PUT IN SECOND SYSLIB  0574
*                                      NAME                          */
         MVC   IOPLSYS+9(8,IOPPTR),SYSLIBS+8                       0574
*                   IOPLMIND(2)=IOPLMSYS;/* INDICATE SYSLIB NAME     */
         MVI   IOPLMIND+9(IOPPTR),X'01'                            0575
*                   IOPLMDND(3)=IOPEOLST;/* SET END OF LIST MARKER   */
         MVI   IOPLMDND+18(IOPPTR),X'FF'                           0576
*                 END;              /*                               */
*                                                                  0577
*               /*****************************************************/
*               /*                                                   */
*               /* NOTE: THE TARGET SYSLIB SUBENTRIES APPEAR IN THE  */
*               /* FIRST DATA RECORD OF THE MEMBER. POINT TO THIS    */
*               /* AREA IN THE IOP AND DO A WRITE OF THIS RECORD.    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0578
*               SAVBUFAD=IOPBUFAD;  /* SAVE BUFFER ADDRESS           */
@RC00571 L     SAVBUFAD,IOPBUFAD(,IOPPTR)                          0578
*               IOPBUFAD=ADDR(IOPLMDFX);/* POINT TO FIRST RECORD OF
*                                      MEM                           */
         LA    @08,IOPLMDFX(,IOPPTR)                               0579
         ST    @08,IOPBUFAD(,IOPPTR)                               0579
*               IOPFUNCT=IOPWRITE;  /* INDICATE WRITE OPERATION      */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0580
*                                                                  0581
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE THE FIRST DATA RECORD WITH THE TARGET SYSLIB*/
*               /* SUBENTRIES                                        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0581
*               CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE    0581
*                                      MODULE                        */
         ST    IOPPTR,@AL00001                                     0581
         L     @15,@CV01853                                        0581
         LA    @01,@AL00001                                        0581
         BALR  @14,@15                                             0581
*               IOPBUFAD=SAVBUFAD;  /* RESTORE SAVED BUFFER ADDRESS  */
         ST    SAVBUFAD,IOPBUFAD(,IOPPTR)                          0582
*               IF IOPRETRN=IOPGOOD THEN/* WRITE OF DATA RECORD OK?  */
         CLI   IOPRETRN(IOPPTR),0                                  0583
         BNE   @RF00583                                            0583
*                 DO;               /*                               */
*                   IOPFUNCT=IOPSTOWR;/* INDICATE STOW REPLACE     0585
*                                      FUNCTION                      */
*                                                                  0585
         MVI   IOPFUNCT(IOPPTR),X'54'                              0585
*                   /*************************************************/
*                   /*                                               */
*                   /* ADD THE DIRECTORY ENTRY FOR THE NEW CDS LMOD  */
*                   /* ENTRY                                         */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0586
*                   CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE
*                                      MODULE                        */
         ST    IOPPTR,@AL00001                                     0586
         L     @15,@CV01853                                        0586
         LA    @01,@AL00001                                        0586
         BALR  @14,@15                                             0586
*                 END;              /*                               */
*             END;                  /*                               */
@RF00583 DS    0H                                                  0589
*         END;                      /*                               */
@RF00553 DS    0H                                                  0590
*     END;                          /*                               */
@RF00547 DS    0H                                                  0591
*   IF IOPRETRN=IOPNTFND THEN       /* IF ENTRY NOT FOUND THEN SET TO*/
@RF00496 CLI   IOPRETRN(IOPPTR),4                                  0591
         BNE   @RF00591                                            0591
*     IOPRETRN=IOPGOOD;             /* CONTINUE PROCESSING           */
         MVI   IOPRETRN(IOPPTR),X'00'                              0592
*   END TM1PROC6;                   /*                               */
@EL00008 DS    0H                                                  0593
@EF00008 DS    0H                                                  0593
@ER00008 LM    @14,@12,@SA00008                                    0593
         BR    @14                                                 0593
*TM1PROC7:                                                         0594
*   PROC;                           /*                               */
TM1PROC7 STM   @14,@02,@SA00009                                    0594
         STM   @04,@12,@SA00009+20                                 0594
*   RFY                                                            0595
*     HMASMGTP BASED(TBLXLMGT);     /*                               */
*   RFY                                                            0596
*     LMMRECRD BASED(GTPBUFAD);     /*                               */
*                                                                  0596
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN GTP FUNCTION AND BUILD ENTRY TO ADD BY GTA            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0597
*   GTPFUNCT=GTPADD;                /* INDICATE ADD OPERATION        */
         L     @08,@PC00001                                        0597
         L     @08,TBLXLMGT(,@08)                                  0597
         MVI   GTPFUNCT(@08),X'04'                                 0597
*   LMMSMD=ICTPTFS(1);              /* FILL IN CAUSING SYSMOD        */
         L     @15,GTPBUFAD(,@08)                                  0598
         L     @14,@PC00001+8                                      0598
         L     @01,ICPTFPTR(,@14)                                  0598
         MVC   LMMSMD(7,@15),ICTPTFS(@01)                          0598
*   LMMMNAME=ICTMNAME(1);           /* MOD WHICH REQUIRES LMOD       */
*                                                                  0599
         L     @14,@PC00001+4                                      0599
         L     @14,ICMODPTR(,@14)                                  0599
         MVC   LMMMNAME(8,@15),ICTMNAME(@14)                       0599
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE FUNCTION BEING EXECUTED                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0600
*   IF CCAACCPT=ON THEN             /* DO FOR ACCEPT FUNCTION        */
*                                                                  0600
         TM    CCAACCPT(CCAPTR),B'00100000'                        0600
         BNO   @RF00600                                            0600
*     /***************************************************************/
*     /*                                                             */
*     /* DO FOR ACCEPT FUNCTION                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0601
*     DO;                           /*                               */
*       LMMLNAME=ICTMNAME(1);       /* MOD NAME IS ALSO LMOD NAME    */
         MVC   LMMLNAME(8,@15),ICTMNAME(@14)                       0602
*       CALL HMASMGTA(HMASMGTP);    /* CALL GENERAL TABLE BUILD MOD  */
         ST    @08,@AL00001                                        0603
         L     @15,@CV01857                                        0603
         LA    @01,@AL00001                                        0603
         BALR  @14,@15                                             0603
*       TM1HIRC=MAX(TM1HIRC,GTPRETRN);/* PICK UP HIGHEST RETURN CODE */
         L     @08,@PC00001                                        0604
         L     @08,TBLXLMGT(,@08)                                  0604
         SLR   @15,@15                                             0604
         IC    @15,GTPRETRN(,@08)                                  0604
         CR    TM1HIRC,@15                                         0604
         BNL   *+6
         LR    TM1HIRC,@15                                         0604
*     END;                          /*                               */
*   ELSE                            /* DO FOR APPLY OR RESTORE       */
*                                                                  0606
*     /***************************************************************/
*     /*                                                             */
*     /* DO FOR APPLY OR RESTORE FUNCTION                            */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0606
*     DO;                           /*                               */
         B     @RC00600                                            0606
@RF00600 DS    0H                                                  0607
*       IOPFUNCT=IOPLOC;            /*                               */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0607
*       IOPTYPE=IOPMOD;             /*                               */
         MVI   IOPTYPE(IOPPTR),X'05'                               0608
*       IOPNAME=ICTMNAME(1);        /*                               */
         L     @08,@PC00001+4                                      0609
         L     @08,ICMODPTR(,@08)                                  0609
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0609
*                                                                  0610
*       /*************************************************************/
*       /*                                                           */
*       /* REREAD THE CDS MOD ENTRY FOR THIS ELEMENT                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0610
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MODULE  */
         ST    IOPPTR,@AL00001                                     0610
         L     @15,@CV01853                                        0610
         LA    @01,@AL00001                                        0610
         BALR  @14,@15                                             0610
*       IF IOPRETRN=IOPGOOD THEN    /*                               */
         CLI   IOPRETRN(IOPPTR),0                                  0611
         BNE   @RF00611                                            0611
*         DO;                       /*                               */
*                                                                  0612
*           /*********************************************************/
*           /*                                                       */
*           /* ADD A RECORD TO THE GTA FILE FOR EACH LMOD SUBENTRY IN*/
*           /* THE CDS MOD ENTRY FOR THIS ELEMENT.                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0613
*           DO L=1 BY 1 WHILE IOPMODND(L)^=IOPEOLST/* TO END OF LIST
*                                      OR                            */
*                 &TM1HIRC=IOPGOOD; /* ERROR ENCOUNTERED             */
         LA    L,1                                                 0613
         B     @DE00613                                            0613
@DL00613 DS    0H                                                  0614
*             IF IOPMDIND(L)=IOPMDLMD THEN/* IS TYPE LMOD ENTRY TYPE?*/
         LR    @08,L                                               0614
         MH    @08,@CH00038                                        0614
         SLR   @05,@05                                             0614
         IC    @05,IOPMDIND-9(@08,IOPPTR)                          0614
         CH    @05,@CH00070                                        0614
         BNE   @RF00614                                            0614
*               DO;                 /* YES- DO FOR LMOD TYPES ONLY   */
*                 LMMLNAME=IOPLMODS(L);/* FILL IN LMOD NAME          */
*                                                                  0616
         L     @05,@PC00001                                        0616
         L     @05,TBLXLMGT(,@05)                                  0616
         L     @01,GTPBUFAD(,@05)                                  0616
         ALR   @08,IOPPTR                                          0616
         MVC   LMMLNAME(8,@01),IOPLMODS-9(@08)                     0616
*                 /***************************************************/
*                 /*                                                 */
*                 /* ADD A GTA FILE ENTRY FOR THE LMOD SUBENTRY      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0617
*                 CALL HMASMGTA(HMASMGTP);/* CALL TABLE BUILD MOD    */
         ST    @05,@AL00001                                        0617
         L     @15,@CV01857                                        0617
         LA    @01,@AL00001                                        0617
         BALR  @14,@15                                             0617
*                 TM1HIRC=MAX(TM1HIRC,GTPRETRN);/* PICK UP HIGEST RC */
         L     @08,@PC00001                                        0618
         L     @08,TBLXLMGT(,@08)                                  0618
         SLR   @05,@05                                             0618
         IC    @05,GTPRETRN(,@08)                                  0618
         CR    TM1HIRC,@05                                         0618
         BNL   *+6
         LR    TM1HIRC,@05                                         0618
*               END;                /*                               */
*           END;                    /*                               */
@RF00614 AH    L,@CH00070                                          0620
@DE00613 LR    @08,L                                               0620
         MH    @08,@CH00038                                        0620
         SLR   @05,@05                                             0620
         IC    @05,IOPMODND-9(@08,IOPPTR)                          0620
         CH    @05,@CH00714                                        0620
         BE    @DC00613                                            0620
         CH    TM1HIRC,@CH00088                                    0620
         BE    @DL00613                                            0620
@DC00613 DS    0H                                                  0621
*         END;                      /*                               */
*     END;                          /*                               */
@RF00611 DS    0H                                                  0623
*   IF IOPRETRN=IOPNOTFD THEN       /*                               */
@RC00600 CLI   IOPRETRN(IOPPTR),4                                  0623
         BNE   @RF00623                                            0623
*     IOPRETRN=IOPGOOD;             /*                               */
         MVI   IOPRETRN(IOPPTR),X'00'                              0624
*   END TM1PROC7;                   /*                               */
@EL00009 DS    0H                                                  0625
@EF00009 DS    0H                                                  0625
@ER00009 LM    @14,@02,@SA00009                                    0625
         LM    @04,@12,@SA00009+20                                 0625
         BR    @14                                                 0625
*TM1PROC8:                                                         0626
*   PROC;                                                          0626
TM1PROC8 STM   @14,@02,@SA00010                                    0626
         STM   @04,@12,@SA00010+20                                 0626
*   IOPRETRN=IOPGOOD;               /* CLEAR FIELD CALLER CHECKS UPON
*                                      RETURN                        */
*                                                                  0627
         MVI   IOPRETRN(IOPPTR),X'00'                              0627
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH THE ICT MODULE SECTION FOR ANOTHER VERSION OF THIS     */
*   /* MODULE WHICH ALREADY HAS A MODID LIST BUILT. IF FOUND, THEN   */
*   /* CHAIN THIS ICT MOD ENTRY TO THAT ENTRY'S MODID LIST.          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0628
*   ICMODPTR->ICTMICHN(1)=ZERO;     /* ZERO CURRENT ENTRY POINTER    */
         L     @08,@PC00001+4                                      0628
         L     @08,ICMODPTR(,@08)                                  0628
         SLR   @15,@15                                             0628
         ST    @15,ICTMICHN(,@08)                                  0628
*   RFY                                                            0629
*     ICTMOD BASED(CCAICMOD);       /* BASE TO FULL ICT MOD SECTION  */
*   DO L=1 BY 1 WHILE ICTMEND(L)^=ICTENDNT/* TILL END OF ICT MOD     */
*         &ICTMATCH=OFF;            /* SECTION OR MATCH FOUND        */
         LA    L,1                                                 0630
         B     @DE00630                                            0630
@DL00630 DS    0H                                                  0631
*     IF ICTMNAME(L)=ICMODPTR->ICTMNAME(1)/* SAME ELEMENT NAMES      */
*         &ICTMICHN(L)^=ZERO        /* AND NOT SAME ENTRY            */
*         &((ICTMMOD(L)=ON&ICMODPTR->ICTMMOD(1)=ON)/* BOTH MODS      */
*         ×(ICTMZAP(L)=ON&ICMODPTR->ICTMZAP(1)=ON)/* BOTH ZAPS       */
*         ×(ICTMZAP(L)=ON&ICMODPTR->ICTMMOD(1)=ON)/* ZAP - MOD       */
*         ×(ICTMMOD(L)=ON&ICMODPTR->ICTMZAP(1)=ON))/* MOD - ZAP      */
*       THEN                                                       0631
         LR    @08,L                                               0631
         MH    @08,@CH01952                                        0631
         L     @05,CCAICMOD(,CCAPTR)                               0631
         L     @15,@PC00001+4                                      0631
         L     @15,ICMODPTR(,@15)                                  0631
         ST    @08,@TF00001                                        0631
         ALR   @08,@05                                             0631
         AL    @08,@CF01965                                        0631
         CLC   ICTMNAME(8,@08),ICTMNAME(@15)                       0631
         BNE   @RF00631                                            0631
         L     @08,@TF00001                                        0631
         AL    @08,@CF01966                                        0631
         L     @08,ICTMICHN-104(@08,@05)                           0631
         LTR   @08,@08                                             0631
         BZ    @RF00631                                            0631
         AL    @05,@TF00001                                        0631
         AL    @05,@CF01967                                        0631
         TM    ICTMMOD-9(@05),B'10000000'                          0631
         BNO   @GL00040                                            0631
         TM    ICTMMOD(@15),B'10000000'                            0631
         BO    @RT00631                                            0631
@GL00040 LR    @08,L                                               0631
         MH    @08,@CH01952                                        0631
         L     @05,CCAICMOD(,CCAPTR)                               0631
         ALR   @05,@08                                             0631
         AL    @05,@CF01967                                        0631
         TM    ICTMZAP-9(@05),B'00100000'                          0631
         BNO   @GL00039                                            0631
         L     @08,@PC00001+4                                      0631
         L     @08,ICMODPTR(,@08)                                  0631
         TM    ICTMZAP(@08),B'00100000'                            0631
         BO    @RT00631                                            0631
@GL00039 LR    @08,L                                               0631
         MH    @08,@CH01952                                        0631
         L     @05,CCAICMOD(,CCAPTR)                               0631
         ALR   @05,@08                                             0631
         AL    @05,@CF01967                                        0631
         TM    ICTMZAP-9(@05),B'00100000'                          0631
         BNO   @GL00038                                            0631
         L     @08,@PC00001+4                                      0631
         L     @08,ICMODPTR(,@08)                                  0631
         TM    ICTMMOD(@08),B'10000000'                            0631
         BO    @RT00631                                            0631
@GL00038 LR    @08,L                                               0631
         MH    @08,@CH01952                                        0631
         L     @05,CCAICMOD(,CCAPTR)                               0631
         ALR   @05,@08                                             0631
         AL    @05,@CF01967                                        0631
         TM    ICTMMOD-9(@05),B'10000000'                          0631
         BNO   @RF00631                                            0631
         L     @08,@PC00001+4                                      0631
         L     @08,ICMODPTR(,@08)                                  0631
         TM    ICTMZAP(@08),B'00100000'                            0631
         BNO   @RF00631                                            0631
@RT00631 DS    0H                                                  0632
*       DO;                         /*                               */
*         ICTMATCH=ON;              /* INDICATE ANOTHER ENTRY FOUND  */
         OI    ICTMATCH,B'00001000'                                0633
*         ICMODPTR->ICTMICHN(1)=ICTMICHN(L);/* CHAIN TO EXISTING   0634
*                                      MODID LIST POINTER            */
         L     @08,@PC00001+4                                      0634
         L     @08,ICMODPTR(,@08)                                  0634
         LR    @05,L                                               0634
         MH    @05,@CH01952                                        0634
         L     @15,CCAICMOD(,CCAPTR)                               0634
         LA    @01,0(@05,@15)                                      0634
         AL    @01,@CF01966                                        0634
         L     @14,ICTMICHN-104(,@01)                              0634
         ST    @14,ICTMICHN(,@08)                                  0634
*         ICMODPTR->ICTMICHA(1)=ICTMICHA(L);/* CHAIN TO EXISTING   0635
*                                      MODID LIST POINTER            */
         AL    @15,@CF01969                                        0635
         L     @05,ICTMICHA-108(@05,@15)                           0635
         ST    @05,ICTMICHA(,@08)                                  0635
*       END;                                                       0636
*   END;                                                           0637
*                                                                  0637
@RF00631 AH    L,@CH00070                                          0637
@DE00630 LR    @08,L                                               0637
         MH    @08,@CH01952                                        0637
         L     @05,CCAICMOD(,CCAPTR)                               0637
         AL    @05,@CF01965                                        0637
         L     @08,ICTMEND(@08,@05)                                0637
         CL    @08,ICTENDNT                                        0637
         BE    @DC00630                                            0637
         TM    ICTMATCH,B'00001000'                                0637
         BZ    @DL00630                                            0637
@DC00630 DS    0H                                                  0638
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO CHAIN WAS AVAILABLE FROM ANOTHER VERSION TO HOOK ON TO, */
*   /* THEN CALL HMASMIO TO READ THE (A)CDS MODULE ENTRY FOR THIS    */
*   /* ELEMENT SO THAT HMASMTID CAN BE CALLED TO BUILD A MODID LIST  */
*   /* FOR THIS ELEMENT.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0638
*   IF ICTMATCH=OFF THEN            /* WAS A CHAIN HOOKED ON TO?     */
         TM    ICTMATCH,B'00001000'                                0638
         BNZ   @RF00638                                            0638
*     DO;                           /*                               */
*       IOPFUNCT=IOPLOC;            /* INDICATE LOCATE FUNCTION      */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0640
*       IOPTYPE=IOPMOD;             /* MODULE TYPE ENTRY             */
*                                                                  0641
         MVI   IOPTYPE(IOPPTR),X'05'                               0641
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE FUNCTION TO SET UP DATASET (A)CDS               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0642
*       IF CCAACCPT=ON THEN         /* ACCEPT FUNCTION?              */
         TM    CCAACCPT(CCAPTR),B'00100000'                        0642
         BNO   @RF00642                                            0642
*         IOPDSID=IOPACDS;          /* YES- ACDS DATASET             */
         MVI   IOPDSID(IOPPTR),X'0C'                               0643
*       ELSE                                                       0644
*         IOPDSID=IOPCDS;           /* INDICATE CDS DATASET          */
         B     @RC00642                                            0644
@RF00642 MVI   IOPDSID(IOPPTR),X'02'                               0644
*       IOPNAME=ICMODPTR->ICTMNAME(1);/* MODULE ELEMENT ENTRY        */
@RC00642 L     @08,@PC00001+4                                      0645
         L     @08,ICMODPTR(,@08)                                  0645
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0645
*                                                                  0646
*       /*************************************************************/
*       /*                                                           */
*       /* LOCATE THE MODULE ELEMENT ON THE (A)CDS                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0646
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MODULE  */
         ST    IOPPTR,@AL00001                                     0646
         L     @15,@CV01853                                        0646
         LA    @01,@AL00001                                        0646
         BALR  @14,@15                                             0646
*       IF IOPRETRN=IOPGOOD THEN    /* WAS MODULE ENTRY FOUND        */
         CLI   IOPRETRN(IOPPTR),0                                  0647
         BNE   @RF00647                                            0647
*         DO;                       /*                               */
*                                                                  0648
*           /*********************************************************/
*           /*                                                       */
*           /* CALL HMASMTID TO BUILD A ICT MODID LIST FOR THIS ICT  */
*           /* MOD ENTRY WITH THE FMID,RMID, AND UMID DATA.          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0649
*           CALL HMASMTID(TBLXPARM, /*                               */
*               ICMODPTR,           /* ICT MOD SECT ENTRY            */
*               ICMODPTR->ICTMICHN(1),/* (A)CDS MODID LIST   @Z67SP00*/
*               HMASMIOP);          /* (A)CDS ELEMENT ENTRY IOP ...
*                                      BUILD MODID LIST FOR THIS   0649
*                                      ELEMENT               @Z67SP00*/
         L     @08,@PC00001                                        0649
         ST    @08,@AL00001                                        0649
         L     @08,@PC00001+4                                      0649
         ST    @08,@AL00001+4                                      0649
         L     @08,ICMODPTR(,@08)                                  0649
         LA    @08,ICTMICHN(,@08)                                  0649
         ST    @08,@AL00001+8                                      0649
         ST    IOPPTR,@AL00001+12                                  0649
         L     @15,@CV01855                                        0649
         LA    @01,@AL00001                                        0649
         BALR  @14,@15                                             0649
*           RFY                                                    0650
*             RTNCODE RSTD;         /* RESTRICT REG 15 USAGE         */
*           IF RTNCODE^=IOPGOOD THEN/* WAS HMASMTID SUCCESSFULL?     */
         LTR   RTNCODE,RTNCODE                                     0651
         BZ    @RF00651                                            0651
*             TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC */
         CR    TM1HIRC,RTNCODE                                     0652
         BNL   *+6
         LR    TM1HIRC,RTNCODE                                     0652
*           RFY                                                    0653
*             RTNCODE UNRSTD;       /* RELEASE REG 15                */
@RF00651 DS    0H                                                  0654
*         END;                      /*                               */
*       ELSE                                                       0655
*         IF IOPRETRN=IOPNOTFD THEN /* WAS SYSMOD FOUND?             */
         B     @RC00647                                            0655
@RF00647 CLI   IOPRETRN(IOPPTR),4                                  0655
         BNE   @RF00655                                            0655
*           DO;                     /* NO- SET CHAINS TO NULL LIST   */
*             ICMODPTR->ICTMICHN(1)=TBLXNULL;/* CHAIN TO EXISTING  0657
*                                      NULL LIST POINTER             */
         L     @08,@PC00001+4                                      0657
         L     @08,ICMODPTR(,@08)                                  0657
         L     @15,@PC00001                                        0657
         L     @15,TBLXNULL(,@15)                                  0657
         ST    @15,ICTMICHN(,@08)                                  0657
*             ICMODPTR->ICTMICHA(1)=TBLXNULL;/* CHAIN TO EXISTING  0658
*                                      NULL LIST POINTER             */
         ST    @15,ICTMICHA(,@08)                                  0658
*           END;                    /* END- SET CHAINS TO NULL LIST  */
*       TM1HIRC=MAX(TM1HIRC,IOPRETRN);/* PICK UP HIGHEST RC          */
@RF00655 DS    0H                                                  0660
@RC00647 SLR   @08,@08                                             0660
         IC    @08,IOPRETRN(,IOPPTR)                               0660
         CR    TM1HIRC,@08                                         0660
         BNL   *+6
         LR    TM1HIRC,@08                                         0660
*     END;                          /*                               */
*   IF IOPRETRN=IOPNOTFD THEN       /* IF ENTRY NOT FOUND THEN RESET
*                                      RETURN CODE TO ZERO           */
@RF00638 CLI   IOPRETRN(IOPPTR),4                                  0662
         BNE   @RF00662                                            0662
*     IOPRETRN=IOPGOOD;             /* SET RC=0                      */
         MVI   IOPRETRN(IOPPTR),X'00'                              0663
*   END TM1PROC8;                   /*                               */
@EL00010 DS    0H                                                  0664
@EF00010 DS    0H                                                  0664
@ER00010 LM    @14,@02,@SA00010                                    0664
         LM    @04,@12,@SA00010+20                                 0664
         BR    @14                                                 0664
*TM1LMOD:                                                          0665
*   PROC;                           /*                               */
*                                                                  0665
TM1LMOD  STM   @14,@02,12(@13)                                     0665
         STM   @04,@12,36(@13)                                     0665
*   /*****************************************************************/
*   /*                                                               */
*   /* WHEN A MOD ENTRY WAS FOUND OR IS BEING ADDED, AND A MCB WAS   */
*   /* PASSED AS INPUT, THE MCB SUBENTRY DATA MUST BE CHECKED FOR    */
*   /* LMOD SUBENTRY TYPES. IF FOUND THEN THEY MUST BE COMPARED TO   */
*   /* THE EXISTING ENTRIES TO DETERMINE IF THEY MUST BE INSERTED    */
*   /* INTO THE IOP AREA SO THE UPDATED MOD ENTRY CAN BE STOW        */
*   /* REPLACED WITH THE NEW LMOD SUBENTRIES.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0666
*   DO S=1 BY 1 TO CCAPEMAX WHILE MCBEND(S)^=IOPEOLST/* LOOP ALL MCB
*                                      SUBENTRIES TO END OF LIST ,   */
*         &TM1HIRC=IOPGOOD;         /* WHILE SPACE FOR ADD EXISTS    */
         LA    S,1                                                 0666
         B     @DE00666                                            0666
@DL00666 LR    @08,S                                               0666
         MH    @08,@CH00038                                        0666
         L     @05,@PC00001+12                                     0666
         L     @05,ELMCBPTR(,@05)                                  0666
         SLR   @15,@15                                             0666
         IC    @15,MCBEND-9(@08,@05)                               0666
         CH    @15,@CH00714                                        0666
         BE    @DC00666                                            0666
         CH    TM1HIRC,@CH00088                                    0666
         BNE   @DC00666                                            0666
*     IF MCBEIND(S)=MCBELMOD THEN   /* MCB SUBENTRY A LMOD TYPE?     */
         SLR   @15,@15                                             0667
         IC    @15,MCBEIND-9(@08,@05)                              0667
         CH    @15,@CH00044                                        0667
         BNE   @RF00667                                            0667
*       DO;                         /* YES- DO PROCESS               */
*         LMODFND=OFF;              /* RESET FOR NEXT PASS           */
         NI    LMODFND,B'11011111'                                 0669
*         DO T=1 BY 1 TO CCAPEMAX WHILE/* LOOP ALL IOP SUBENTRIES TO */
*               IOPMODND(T)^=IOPEOLST/* END OF SUBENTRIES ON MOD , IF*/
*               &LMODFND=OFF;       /* NO MATCH IS FOUND             */
         LA    T,1                                                 0670
         B     @DE00670                                            0670
@DL00670 LA    @08,9                                               0670
         LR    @01,T                                               0670
         MR    @00,@08                                             0670
         SLR   @00,@00                                             0670
         IC    @00,IOPMODND-9(@01,IOPPTR)                          0670
         CH    @00,@CH00714                                        0670
         BE    @DC00670                                            0670
         TM    LMODFND,B'00100000'                                 0670
         BNZ   @DC00670                                            0670
*           IF IOPLMODS(T)=MCBENTRY(S)/* DO ENTRIES MATCH AND        */
*               &IOPMDIND(T)=IOPMDLMD THEN/* IS ENTRY ALSO LMOD?     */
         LR    @07,@08                                             0671
         MR    @06,S                                               0671
         L     @08,@PC00001+12                                     0671
         L     @08,ELMCBPTR(,@08)                                  0671
         ST    @01,@TF00001                                        0671
         ALR   @01,IOPPTR                                          0671
         ALR   @08,@07                                             0671
         CLC   IOPLMODS-9(8,@01),MCBENTRY-9(@08)                   0671
         BNE   @RF00671                                            0671
         L     @08,@TF00001                                        0671
         SLR   @15,@15                                             0671
         IC    @15,IOPMDIND-9(@08,IOPPTR)                          0671
         CH    @15,@CH00070                                        0671
         BNE   @RF00671                                            0671
*             LMODFND=ON;           /* YES-SET UP TO EXIT LOOP       */
         OI    LMODFND,B'00100000'                                 0672
*         END;                      /* END OF IOP SEARCH LOOP        */
@RF00671 AH    T,@CH00070                                          0673
@DE00670 CH    T,CCAPEMAX(,CCAPTR)                                 0673
         BNH   @DL00670                                            0673
@DC00670 DS    0H                                                  0674
*         IF LMODFND=OFF THEN       /* DOES ENTRY EXIST IN IOP?      */
         TM    LMODFND,B'00100000'                                 0674
         BNZ   @RF00674                                            0674
*           DO;                     /* NO- THEN BUILD ONE            */
*             IF T+1^>CCAPEMAX THEN /* IS THERE SPACE TO BUILD ENTRY?*/
         LA    @08,1                                               0676
         LR    @15,T                                               0676
         ALR   @15,@08                                             0676
         CH    @15,CCAPEMAX(,CCAPTR)                               0676
         BH    @RF00676                                            0676
*               DO;                 /* YES- BUILD LMOD SUBENTRY      */
*                 IOPLMODS(T)=MCBENTRY(S);/* LMOD NAME TO IOP        */
         LA    @15,9                                               0678
         LR    @01,T                                               0678
         MR    @00,@15                                             0678
         ST    @01,@TF00001                                        0678
         ALR   @01,IOPPTR                                          0678
         MR    @14,S                                               0678
         L     @14,@PC00001+12                                     0678
         L     @14,ELMCBPTR(,@14)                                  0678
         ALR   @14,@15                                             0678
         MVC   IOPLMODS-9(8,@01),MCBENTRY-9(@14)                   0678
*                 IOPMDIND(T)=IOPMDLMD;/* INDICATE LMOD TYPE ENTRY   */
         L     @01,@TF00001                                        0679
         STC   @08,IOPMDIND-9(@01,IOPPTR)                          0679
*                 IOPMODND(T+1)=IOPEOLST;/* SET NEW END OF LIST      */
         LA    @08,255                                             0680
         L     @01,@TF00001                                        0680
         STC   @08,IOPMODND(@01,IOPPTR)                            0680
*                 LMODADD=ON;       /* INDICATE NEED FOR STOW REPLACE*/
         OI    LMODADD,B'10000000'                                 0681
*               END;                /* END- BUILD LMOD SUBENTRY      */
*             ELSE                                                 0683
*               TM1HIRC=IOPEXC;     /* SET RETURN CODE TO NO SPACE   */
         B     @RC00676                                            0683
@RF00676 LA    TM1HIRC,8                                           0683
*           END;                    /* END ENTRY NOT EXIST IN IOP    */
@RC00676 DS    0H                                                  0685
*       END;                        /* END OF LMOD SUBENTRY LOOP     */
@RF00674 DS    0H                                                  0686
*   END;                            /* END OF MCB SUBENTRY LOOP      */
@RF00667 AH    S,@CH00070                                          0686
@DE00666 CH    S,CCAPEMAX(,CCAPTR)                                 0686
         BNH   @DL00666                                            0686
@DC00666 DS    0H                                                  0687
*   END TM1LMOD;                    /*                               */
@EL00011 DS    0H                                                  0687
@EF00011 DS    0H                                                  0687
@ER00011 LM    @14,@02,12(@13)                                     0687
         LM    @04,@12,36(@13)                                     0687
         BR    @14                                                 0687
*   END HMASMTM1                    /*                               */
*                                                                  0688
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  0688
*       ;                                                          0688
@DATA    DS    0H
@CH00088 DC    H'0'
@CH00070 DC    H'1'
@CH00279 DC    H'2'
@CH00093 DC    H'3'
@CH00044 DC    H'4'
@CH00038 DC    H'9'
@CH01952 DC    H'144'
@CH01859 DC    H'232'
@CH00714 DC    H'255'
         DS    0F
@AL00428 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
@SA00002 DS    14F
@SA00003 DS    14F
@SA00004 DS    0F
@SA00010 DS    0F
@SA00009 DS    0F
@SA00008 DS    0F
@SA00007 DS    0F
@SA00005 DS    0F
         DS    15F
@AL00001 DS    4A
@TF00001 DS    F
         DS    0F
@CF00062 DC    F'8'
@CF01965 DC    F'-144'
@CF01967 DC    F'-135'
@CF01966 DC    F'-40'
@CF01969 DC    F'-36'
@CV01853 DC    V(HMASMIO)
@CV01854 DC    V(HMASMMSG)
@CV01855 DC    V(HMASMTID)
@CV01856 DC    V(HMASMTAI)
@CV01857 DC    V(HMASMGTA)
         DS    0D
@CC01864 DC    C'SMPTLIB '
@CC01866 DC    C'SMPWRK3 '
@CC01868 DC    C'00000000'
@CC01929 DC    C'MOD     '
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00250 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00251 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
ETYPE    DS    CL8
TM1SWCH1 DS    BL1
         ORG   TM1SWCH1
DLIBBIT  DS    BL1
SMDAPPLY EQU   TM1SWCH1+0
XMID     EQU   TM1SWCH1+0
MODALMOD EQU   TM1SWCH1+0
ICTMATCH EQU   TM1SWCH1+0
BLDACDSM EQU   TM1SWCH1+0
@NM00255 EQU   TM1SWCH1+0
         ORG   TM1SWCH1+1
TM1SWCH2 DS    BL1
         ORG   TM1SWCH2
LMODADD  DS    BL1
MODFND   EQU   TM1SWCH2+0
LMODFND  EQU   TM1SWCH2+0
@NM00256 EQU   TM1SWCH2+0
         ORG   TM1SWCH2+1
SAVADLIB DS    CL8
         DS    CL2
PKDEC    DS    CL8
RADJ     DS    CL8
BLANKS   DC    CL8'        '
PATCHTM1 DS    CL80
         ORG   PATCHTM1
@NM00257 DC    80X'FF'
         ORG   PATCHTM1+80
SYSLIBS  DS    2CL8
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
T        EQU   @05
S        EQU   @04
L        EQU   @04
FIX31    EQU   @04
SAVBUFAD EQU   @03
TM1HIRC  EQU   @03
IOPPTR   EQU   @02
CCAPTR   EQU   @11
RTNCODE  EQU   @15
RTNREG   EQU   @14
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLNOAPP EQU   TBLFLG1
TBLFLG2  EQU   TBLFLAGS+2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLFLG5  EQU   TBLFLAGS+7
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCAPEMAX EQU   CCAFSYS+10
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00023 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAAPPLY EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00039 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00041 EQU   CCABLDLL
CCALKDRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00053+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00057 EQU   HMASMIOP+12
@NM00058 EQU   @NM00057
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00168 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00195 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMEND  EQU   ICTMNAME
ICTMFLG2 EQU   ICTMOD+8
ICTMNOGO EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMMOD  EQU   ICTMMODR
ICTMZAP  EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTLIBLK EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTMRELF EQU   ICTMFLG3
ICTMALIS EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMFLG4 EQU   ICTMOD+11
ICTMIDEL EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
ICTMFLG5 EQU   ICTMOD+12
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTMRELN EQU   ICTMOD+22
ICTFMLIB EQU   ICTMOD+24
ICTMDSTL EQU   ICTMOD+48
ICTPPTR  EQU   ICTMOD+96
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMICHA EQU   ICTMOD+108
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMODST EQU   ICTMID+7
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLFLG4 EQU   ICTLMOD+8
ICTLFLG1 EQU   ICTLMOD+9
ICTLFLG5 EQU   ICTLMOD+10
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTLFLG3 EQU   ICTLMOD+14
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
MCBPTFMP EQU   0
MCBTYPE  EQU   MCBPTFMP
MCBVERMP EQU   0
MCBVEND  EQU   MCBVERMP+8
MCBIFMP  EQU   0
MCBIEND  EQU   MCBIFMP+8
MCBELEMP EQU   0
MCBEDIST EQU   MCBELEMP+9
MCBETXLB EQU   MCBELEMP+33
MCBELKLB EQU   MCBELEMP+41
MCBEDALS EQU   MCBELEMP+57
MCBERLF  EQU   MCBELEMP+73
MCBELEPM EQU   MCBELEMP+136
MCBEFLG1 EQU   MCBELEPM
MCBEFLG2 EQU   MCBELEPM+1
MCBEFLG3 EQU   MCBELEPM+2
MCBEFLG4 EQU   MCBELEPM+3
MCBEFLG5 EQU   MCBELEMP+140
MCBEDEL  EQU   MCBEFLG5
MCBEEND  EQU   MCBELEMP+141
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
LMMRECRD EQU   0
LMMKEY   EQU   LMMRECRD
LMMSMD   EQU   LMMKEY
LMMMNAME EQU   LMMKEY+7
LMMLNAME EQU   LMMKEY+15
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXTBL  EQU   TBLXPARM+28
TBLXNULL EQU   TBLXPARM+36
TBLXLMGT EQU   TBLXPARM+56
TBLXFLG1 EQU   TBLXPARM+80
TBLXRC   EQU   TBLXPARM+92
ICMODPTR EQU   0
ICPTFPTR EQU   0
ELMCBPTR EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00064 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPONAME EQU   IOPSTCMP
IOPOTYPE EQU   IOPSTCMP+8
IOPNNAME EQU   IOPSTCMP+9
IOPNTYPE EQU   IOPSTCMP+17
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00075 EQU   IOPUDATA
@NM00076 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPNTLVL EQU   IOPASMDR
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPCOPY  EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPLMDFX EQU   IOPLMDNT+24
@NM00085 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPLMDND EQU   IOPSYSLB
IOPLMIND EQU   IOPLNTRY+8
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMID  EQU   IOPRMIDE
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPFMID  EQU   IOPFMIDE
IOPFMST  EQU   IOPFMIDE+7
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPBUSMD EQU   IOPBUNT
IOPBUTYP EQU   IOPBUNT+7
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00096 EQU   IOPSRCDR+1
@NM00098 EQU   @NM00096+7
@NM00102 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00106 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00112 EQU   IOPMODDR+1
@NM00114 EQU   @NM00112+7
@NM00118 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00122 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPDLIB  EQU   IOPMODFX+72
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODND EQU   IOPMODID
IOPMODST EQU   IOPLMODS+7
IOPMDIND EQU   IOPMNTRY+8
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00133 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPDLBND EQU   IOPDSYS
IOPDLIND EQU   IOPDNTRY+8
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00140 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00149 EQU   IOPPTFFX
@NM00150 EQU   @NM00149
IOPPDTES EQU   IOPPTFFX+41
@NM00153 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00178 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00178
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00182 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00182
IOPBFTB1 EQU   IOPBFTB0
ICTENDNT EQU   ICTENDCH
MCBVVLST EQU   MCBVEND
MCBVNTRY EQU   MCBVVLST
MCBVNUM  EQU   MCBVNTRY
MCBIVLST EQU   MCBIEND
MCBINTRY EQU   MCBIVLST
MCBINUM  EQU   MCBINTRY
MCBEVLST EQU   MCBEEND
MCBENTRY EQU   MCBEVLST
MCBENUM  EQU   MCBENTRY
MCBEND   EQU   MCBENUM
MCBEIND  EQU   MCBEVLST+8
ICTENDIX EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00249 EQU   MCBENTRY+7
MCBIIND  EQU   MCBIVLST+8
@NM00242 EQU   MCBINTRY+7
MCBIND   EQU   MCBINUM
MCBVIND  EQU   MCBVVLST+8
@NM00240 EQU   MCBVNTRY+7
MCBVND   EQU   MCBVNUM
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00184 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00183 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00181 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00180 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00179 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00177 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00176 EQU   IOPPTSFX+35
@NM00175 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00174 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00173 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00172 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00171 EQU   IOPQFMDR
@NM00167 EQU   IOPQSMDR
@NM00166 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00165 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00164 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00163 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00162 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00161 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00160 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00159 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00158 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00157 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00156 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00155 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00154 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00153+3
IOPRECD  EQU   @NM00153
@NM00152 EQU   IOPPTFFX+8
@NM00151 EQU   @NM00149+7
IOPPRELN EQU   @NM00150
@NM00148 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00147 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00146 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00145 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00144 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00143 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00142 EQU   @NM00140+7
@NM00141 EQU   @NM00140
@NM00139 EQU   IOPSYSDR+5
@NM00138 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00137 EQU   IOPSYSDR
@NM00136 EQU   IOPDLBFX+8
@NM00135 EQU   @NM00133+7
@NM00134 EQU   @NM00133
@NM00132 EQU   IOPDLBDR+1
@NM00131 EQU   IOPDLBDR
@NM00130 EQU   IOPMODST
@NM00129 EQU   IOPMODFX+12
@NM00128 EQU   IOPMODF4
@NM00127 EQU   IOPMODF3
@NM00126 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00125 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00124 EQU   @NM00122+7
@NM00123 EQU   @NM00122
@NM00121 EQU   IOPMODDR+17
@NM00120 EQU   @NM00118+7
@NM00119 EQU   @NM00118
@NM00117 EQU   @NM00114
@NM00116 EQU   @NM00114
@NM00115 EQU   @NM00114
@NM00113 EQU   @NM00112
@NM00111 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00110 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00109 EQU   IOPSRCFX+8
@NM00108 EQU   @NM00106+7
@NM00107 EQU   @NM00106
@NM00105 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00104 EQU   @NM00102+7
@NM00103 EQU   @NM00102
@NM00101 EQU   @NM00098
@NM00100 EQU   @NM00098
@NM00099 EQU   @NM00098
@NM00097 EQU   @NM00096
@NM00095 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00094 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00093 EQU   IOPMACFX+8
@NM00092 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
@NM00091 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00090 EQU   IOPRMST
@NM00089 EQU   IOPMACDR
@NM00087 EQU   @NM00085+7
@NM00086 EQU   @NM00085
@NM00084 EQU   IOPLMDDR+6
@NM00083 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
@NM00082 EQU   IOPLMDF4
@NM00081 EQU   IOPLMDF3
@NM00080 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00079 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00078 EQU   IOPLMDDR
@NM00077 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPALLOC EQU   @NM00076+4
IOPUSED  EQU   @NM00076
IOPTPSEQ EQU   @NM00075+8
IOPVLSER EQU   @NM00075+2
IOPBLKSI EQU   @NM00075
IOPCQMAX EQU   IOPCQMAP+12
@NM00074 EQU   IOPCQMAP+11
@NM00073 EQU   IOPCQMAP+8
@NM00072 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00071 EQU   IOPSCMAP+11
@NM00070 EQU   IOPSCMAP+8
@NM00069 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00068 EQU   IOPNTMAX+11
@NM00067 EQU   IOPNTMAX+8
@NM00066 EQU   IOPNTMAX
@NM00065 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00064+5
IOPIPTF3 EQU   @NM00064
TBLXEND0 EQU   TBLXPARM+124
@NM00007 EQU   TBLXPARM+108
TBLXIOP3 EQU   TBLXPARM+104
TBLXD2GT EQU   TBLXPARM+100
TBLXDLGT EQU   TBLXPARM+96
@NM00006 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTRC  EQU   TBLXRC
TBLXIBGN EQU   TBLXPARM+88
TBLXTSLP EQU   TBLXPARM+84
@NM00005 EQU   TBLXPARM+83
@NM00004 EQU   TBLXPARM+82
@NM00003 EQU   TBLXPARM+81
@NM00002 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
TBLXFUND EQU   TBLXPARM+72
TBLXFUNC EQU   TBLXPARM+64
@NM00001 EQU   TBLXPARM+62
TBLXCRQI EQU   TBLXPARM+61
TBLXCDSI EQU   TBLXPARM+60
TBLXSCGT EQU   TBLXPARM+52
TBLXSREL EQU   TBLXPARM+48
TBLXASGT EQU   TBLXPARM+44
TBLXIFGT EQU   TBLXPARM+40
TBLXTOP  EQU   TBLXPARM+32
TBLXSEGT EQU   TBLXPARM+24
TBLXIOPF EQU   TBLXPARM+20
TBLXIOP2 EQU   TBLXPARM+16
TBLXEND  EQU   TBLXINDX+8
TBLXSTRT EQU   TBLXINDX+4
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
@NM00254 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00253 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
GTPKEYLN EQU   HMASMGTP+6
GTPRCDLN EQU   HMASMGTP+4
@NM00252 EQU   HMASMGTP+2
@NM00248 EQU   MCBEFLG5
MCBESTD  EQU   MCBEFLG5
@NM00247 EQU   MCBEFLG4
@NM00246 EQU   MCBEFLG3
@NM00245 EQU   MCBEFLG2
MCBEPAGA EQU   MCBEFLG2
MCBENE   EQU   MCBEFLG2
@NM00244 EQU   MCBEFLG1
MCBEDC   EQU   MCBEFLG1
MCBEREFR EQU   MCBEFLG1
MCBEOVLY EQU   MCBEFLG1
MCBESCTR EQU   MCBEFLG1
MCBEREUS EQU   MCBEFLG1
MCBERENT EQU   MCBEFLG1
MCBEAPF  EQU   MCBEFLG1
MCBERMID EQU   MCBELEMP+129
MCBELLKD EQU   MCBELEMP+128
MCBEJLKD EQU   MCBELEMP+116
MCBELUPI EQU   MCBELEMP+115
MCBEJUPI EQU   MCBELEMP+103
MCBELCPY EQU   MCBELEMP+102
MCBEJCPY EQU   MCBELEMP+90
MCBELASM EQU   MCBELEMP+89
MCBEJASM EQU   MCBELEMP+77
MCBESSI  EQU   MCBELEMP+65
MCBEASLB EQU   MCBELEMP+49
MCBESYS  EQU   MCBELEMP+25
MCBEDOBJ EQU   MCBELEMP+17
MCBENAME EQU   MCBELEMP+1
@NM00243 EQU   MCBELEMP
MCBIFENV EQU   MCBIFMP+1
@NM00241 EQU   MCBIFMP
MCBSFMID EQU   MCBVERMP+1
@NM00239 EQU   MCBVERMP
MCBPTP   EQU   MCBPTFMP+10
MCBPRELN EQU   MCBPTFMP+8
MCBPNO   EQU   MCBPTFMP+1
ICTIXL   EQU   ICTIXLF
@NM00238 EQU   ICTLMOD+38
ICTLTTR  EQU   ICTLMOD+31
ICTTG2   EQU   ICTLMOD+23
ICTTG1   EQU   ICTLMOD+15
@NM00237 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTLCPY  EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
ICTTIND1 EQU   ICTLFLG3
@NM00236 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00235 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
ICTCOPY  EQU   ICTLFLG2
@NM00234 EQU   ICTLFLG7
@NM00233 EQU   ICTLFLG6
@NM00232 EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLNE   EQU   ICTLFLG5
@NM00231 EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLAPF  EQU   ICTLFLG1
@NM00230 EQU   ICTLFLG4
ICTLPASS EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLCPL  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
ICTLPROC EQU   ICTLFLG4
ICTLEND  EQU   ICTLNAME
@NM00229 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00228 EQU   ICTMVRNT+7
ICTMVRND EQU   ICTMVRNM
ICTTALND EQU   ICTTALNM
ICTASMND EQU   ICTASMAD
ICTMIDTY EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDRG EQU   ICTMODST
ICTMIDF1 EQU   ICTMODST
ICTMIDPL EQU   ICTMODST
ICTMIDPS EQU   ICTMODST
@NM00227 EQU   ICTMODST
ICTMIDND EQU   ICTMODID
ICTIXM   EQU   ICTIXMF
@NM00226 EQU   ICTMOD+128
@NM00225 EQU   ICTMOD+95
ICTMFMID EQU   ICTMOD+88
@NM00224 EQU   ICTMOD+87
ICTMRMID EQU   ICTMOD+80
ICTMSSI  EQU   ICTMOD+72
ICTMDOBJ EQU   ICTMOD+64
ICTMSYSL EQU   ICTMOD+56
ICTMASLB EQU   ICTMOD+40
ICTTOLIB EQU   ICTMOD+32
@NM00223 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00222 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00221 EQU   ICTMLEP4
@NM00220 EQU   ICTMLEP3
@NM00219 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00218 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00217 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMCOPY EQU   ICTMFLG5
ICTMPASS EQU   ICTMFLG5
@NM00216 EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
ICTMISEL EQU   ICTMFLG4
@NM00215 EQU   ICTMFLG3
ICTMWRK  EQU   ICTMFLG3
ICTMTRX  EQU   ICTMFLG3
ICTMSRCU EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMMACU EQU   ICTMFLG1
ICTMMACR EQU   ICTMFLG1
ICTMXPND EQU   ICTMFLG1
ICTMASM  EQU   ICTMMODR
@NM00214 EQU   ICTMFLG2
@NM00213 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMPROC EQU   ICTMFLG2
@NM00212 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00211 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00210 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00209 EQU   ICTCSRST
@NM00208 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00207 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00206 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00205 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00204 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00203 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00202 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00201 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00200 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00199 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00198 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
ICTIXP   EQU   ICTIXPF
@NM00197 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPFMID EQU   ICTPTF+22
ICTPSUPN EQU   ICTPTF+20
ICTPONUM EQU   ICTPTF+18
ICTPTYPE EQU   ICTPTF+17
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00196 EQU   @NM00195
ICTPRQBY EQU   @NM00195
ICTPRQOK EQU   @NM00195
ICTPRQCK EQU   @NM00195
@NM00194 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00193 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00192 EQU   ICTPFLG4
@NM00191 EQU   ICTPFLG4
@NM00190 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00189 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00188 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00187 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00186 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00185 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTPEND  EQU   ICTPTFS
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00170 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00169 EQU   @NM00168+7
IOPQSMFM EQU   @NM00168
@NM00088 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00063 EQU   IOPUSERL
@NM00062 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00061 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00060 EQU   @NM00057+10
IOPSEQNO EQU   @NM00057+8
@NM00059 EQU   @NM00058+7
IOPPTFNM EQU   @NM00058
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00056 EQU   CCABLDLM+2
@NM00055 EQU   CCABLDLM
CCAUPDPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00053+12
CCAUPDTE EQU   @NM00053+8
CCAUPDNM EQU   @NM00053
CCASUPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00051+12
CCAIOSUP EQU   @NM00051+8
CCASUPNM EQU   @NM00051
CCAZAPPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00049+12
CCASPZAP EQU   @NM00049+8
CCAZAPNM EQU   @NM00049
CCACOMPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00047+12
CCACOMRS EQU   @NM00047+8
CCACOMNM EQU   @NM00047
CCACPYPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00045+12
CCACOPY  EQU   @NM00045+8
CCACPYNM EQU   @NM00045
CCAASMPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00043+12
CCAASM   EQU   @NM00043+8
CCAASMNM EQU   @NM00043
CCALKDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00041+12
CCALKED  EQU   @NM00041+8
CCALKDNM EQU   @NM00041
CCAPGMPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCABPGRC EQU   @NM00039+20
CCABPGSP EQU   @NM00039+12
CCABPGAD EQU   @NM00039+8
CCABPGNM EQU   @NM00039
CCAEND   EQU   HMASMCCA+371
@NM00038 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00037 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00036 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00035 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00034 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00033 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00032 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00031 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00030 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00029 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00028 EQU   @NM00023+18
@NM00027 EQU   @NM00023+16
CCATBLPA EQU   @NM00023+12
@NM00026 EQU   @NM00023+8
@NM00025 EQU   @NM00023+4
@NM00024 EQU   @NM00023
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00022 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00021 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00020 EQU   CCAFBUFR+122
@NM00019 EQU   CCAFBUFR+120
@NM00018 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00017 EQU   CCAFBUFR+88
@NM00016 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00015 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00014 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00013 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00012 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
TBLBPID  EQU   TBLFLG4
@NM00011 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00010 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
TBLGROUP EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
TBLSEL   EQU   TBLFLG2
@NM00009 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLASSEM EQU   TBLFLG1
TBLCHECK EQU   TBLFLG1
@NM00008 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00308 EQU   @EL00002
@RT00319 EQU   @EL00003
@RF00381 EQU   @EL00003
@RF00400 EQU   @EL00004
@RF00414 EQU   @EL00005
@RF00433 EQU   @EL00006
@RF00475 EQU   @RC00467
@RF00488 EQU   @EL00007
@RF00513 EQU   @RC00507
@RC00515 EQU   @RC00507
@RF00591 EQU   @EL00008
@RF00623 EQU   @EL00009
@RF00662 EQU   @EL00010
@ENDDATA EQU   *
         END   HMASMTM1,(C'PLS2155',0802,78334)

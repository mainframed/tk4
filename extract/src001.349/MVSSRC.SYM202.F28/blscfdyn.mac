         TITLE 'EP=BLSCFDYN -- IPCS DAS FREE DYNAMIC ALLOCATION INTERFA*
               ACE      '
*     /* CHANGE ACTIVITY
*    THIS MODULE IS WRITTEN FOR @G57LPSR
BLSCFDYN CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'BLSCFDYN  78.062'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         BLSCGETF R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(8),0(@01)                                  0002
*                                                                  0032
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MODULE STATUS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0032
*   DMCBPTR=ADDR(DMCBPARM);         /* BASE THE DMCB                 */
         L     DMCBPTR,@PC00001                                    0032
*   MODNAME=LMODNMC;                /* INITIALIZE THE MODULE NAME    */
         MVC   MODNAME(8),@CC00584                                 0033
*   RETCODE=F0C;                    /* INIT THE MODULE RETURN CODE   */
         SLR   @10,@10                                             0034
         ST    @10,RETCODE                                         0034
*   SUBCODE=F0C;                    /* INIT THE SUBROUTINE RETURN  0035
*                                      CODE FOR DEBUG                */
         ST    @10,SUBCODE                                         0035
*   S99TUFP=F0C;                    /* INIT THE TEXT UNIT MULTIPLE 0036
*                                      ENTRY BASE (UNUSED VARIABLE)  */
*                                                                  0036
         SLR   S99TUFP,S99TUFP                                     0036
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD DYNALLOC PARAMETER LIST TO FREE DATA SET                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0037
*   S99RB=S99RB&&S99RB;             /* CLEAR THE REQUEST BLOCK       */
         XC    S99RB(20),S99RB                                     0037
*   TUL=TUL&&TUL;                   /* CLEAR THE TEXT UNIT POINTERS
*                                      AND TEXT UNIT AREA            */
         XC    TUL(80),TUL                                         0038
*   S99RBPTR=ADDR(S99RB);           /* INIT THE REQUEST BLOCK POINTER*/
         LA    @02,S99RB                                           0039
         ST    @02,S99RBPTR                                        0039
*   S99RBPND=ON;                    /* LAST POINTER INDICATOR        */
         OI    S99RBPND,B'10000000'                                0040
*   S99RBLN=F20C;                   /* REQUEST BLOCK LENGTH          */
         MVI   S99RBLN,X'14'                                       0041
*   S99VERB=S99VRBUN;               /* VERB IS UNALLOCATE            */
         MVI   S99VERB,X'02'                                       0042
*   S99TXTPP=ADDR(TUPL);            /* TEXT UNIT POINTER LIST ADDRESS*/
         LA    @02,TUPL                                            0043
         ST    @02,S99TXTPP                                        0043
*   S99TUBAS=ADDR(TUS);             /* START OF TEXT UNIT AREA       */
         LA    S99TUBAS,TUS                                        0044
*   RFY                                                            0045
*     S99TUNIT BASED(S99TUBAS);     /* BASE THE TEXT UNIT MAP        */
*                                                                  0045
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD UNALLOCATE BY DDNAME TEXT UNIT                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0046
*   S99TUPTR(F1C)=S99TUBAS;         /* TEXT UNIT POINTER LIST ENTRY  */
         ST    S99TUBAS,S99TUPTR(,@02)                             0046
*   S99TUKEY=DUNDDNAM;              /* UNALLOCATE BY DDNAME          */
         MVC   S99TUKEY(2,S99TUBAS),@CB00306                       0047
*   S99TUNUM=F1C;                   /* NUMBER OF TU ENTRIES          */
         LA    @02,1                                               0048
         STCM  @02,3,S99TUNUM(S99TUBAS)                            0048
*   S99TULNG=F8C;                   /* TEXT UNIT ENTRY LENGTH        */
         MVC   S99TULNG(2,S99TUBAS),@CH00048                       0049
*   S99TUPAR(F1C:F8C)=DMCBDDNM;     /* DDNAME INTO TEXT UNIT ENTRY   */
         MVC   S99TUPAR(8,S99TUBAS),DMCBDDNM(DMCBPTR)              0050
*   S99TUPLM=F1C;                   /* TEXT UNIT POINTER LIST DIM    */
         LR    S99TUPLM,@02                                        0051
*   S99TUPLX=F2C;                   /* TEXT UNIT POINTER LIST INDEX  */
         LA    S99TUPLX,2                                          0052
*   S99TUBAS=S99TUBAS+F14C;         /* BUMP TU BASE FOR NEXT FREE TU */
*                                                                  0053
         AL    S99TUBAS,@CF00549                                   0053
*   /*****************************************************************/
*   /*                                                               */
*   /* OBTAIN DISPOSITION OVERRIDE FROM PARM LIST                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0054
*   DMCBODIS=F0C;                   /* INIT THE OVERRIDE DISP FIELD  */
         MVI   DMCBODIS(DMCBPTR),X'00'                             0054
*   ALBAS=ADDR(PLIST);              /* BASE THE PARM LIST            */
         L     ALBAS,@PC00001+4                                    0055
*   IF ALPTR^=F0C THEN              /* TEST FOR OVERRIDE PARM LIST 0056
*                                      EXISTENCE                     */
         C     @10,ALPTR(,ALBAS)                                   0056
         BE    @RF00056                                            0056
*     DO;                           /* PARM LIST EXISTS              */
*       ALSW=OFF;                   /* INIT LOOP SWITCH              */
         NI    ALSW,B'01111111'                                    0058
*       DO WHILE ALSW=OFF;          /* LOOP THROUGH PARM LIST        */
         B     @DE00059                                            0059
@DL00059 DS    0H                                                  0060
*         ALOPT=ALOP&LHEX7FC;       /* MASK LAST ENTRY BIT FROM KEY
*                                      CODE                          */
         LA    ALOPT,127                                           0060
         SLR   @10,@10                                             0060
         IC    @10,ALOP(,ALBAS)                                    0060
         NR    ALOPT,@10                                           0060
*         IF ALOPT=DISPOP THEN      /* TEST FOR DISP PARAMETER       */
         C     ALOPT,@CF00052                                      0061
         BNE   @RF00061                                            0061
*           CALL DISPPROC;          /* GET DISP OVERRIDE             */
         BAL   @14,DISPPROC                                        0062
*         ELSE                                                     0063
*           IF ALOPT=PASSOP THEN    /* TEST FOR PASSWORD PARAMETER   */
         B     @RC00061                                            0063
@RF00061 C     ALOPT,@CF00564                                      0063
         BNE   @RF00063                                            0063
*             DO;                   /* SKIP OVER PASSWORD PARAMETER  */
*               ALBAS=ALBAS+F8C;    /* SKIP TO END OF PASSWORD     0065
*                                      PARAMETER                     */
         AL    ALBAS,@CF00048                                      0065
*             END;                  /* SKIP OVER PASSWORD PARAMETER  */
*           ELSE                                                   0067
*             DO;                   /* INVALID PARAMETER KEY CODE    */
         B     @RC00063                                            0067
@RF00063 DS    0H                                                  0068
*               CHSTR867=ALOPT;     /* GET KEY FIELD                 */
         STCM  ALOPT,3,CHSTR867                                    0068
*               CHSTR88=LHEX0FC;    /* TRANSLATE IT TO CHARACTER HEX */
         MVI   CHSTR88,X'0F'                                       0069
*               UNPK(CTEMP,CHSTR8);                                0070
         UNPK  CTEMP(9),CHSTR8(8)                                  0070
*               TR(CTEMP,HEXTBL);                                  0071
         TR    CTEMP(9),HEXTBL                                     0071
*               DO;                 /* BLSDMSG                     0072
*                                      (ZZ2,F3117C,DMCBMSG,BLSDMSGS)
*                                      INSERT(MODNAME,CTEMP72)       */
*                 IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT   0073
*                                      INSERT                        */
         LA    @10,IOPTLIST+12                                     0073
         ST    @10,IOPTLIST                                        0073
*                 IOPTLIST(2)=ADDR(MODNAME);/* INSERT NAME POINTER   */
         LA    @10,MODNAME                                         0074
         ST    @10,IOPTLIST+4                                      0074
*                 IOPTLIST(3)=0;    /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0075
         ST    @10,IOPTLIST+8                                      0075
*                 RFY                                              0076
*                   I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 0076
*                                      1-2                           */
*                 I015F=LENGTH(MODNAME);/* INSERT LENGTH             */
         LA    @02,IOPTLIST+8                                      0077
         MVC   I015F(2,@02),@CH00048                               0077
*                 IOPTLIST(4)=0;    /* LAST INSERT                   */
         ST    @10,IOPTLIST+12                                     0078
*                 IOPTLIST(5)=ADDR(CTEMP72);/* INSERT NAME POINTER   */
         LA    @02,CTEMP72                                         0079
         ST    @02,IOPTLIST+16                                     0079
*                 IOPTLIST(6)=0;    /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0080
*                 RFY                                              0081
*                   I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 0081
*                                      1-2                           */
*                 I015F=LENGTH(CTEMP72);/* INSERT LENGTH             */
         LA    @10,IOPTLIST+20                                     0082
         MVC   I015F(2,@10),@CH00076                               0082
*                 CALL BLSDMSG0(ZZ2,F3117C,DMCBMSG,BLSDMSGS,'00000000'B
*                     ,ADDR(IOPTLIST));/* BUILD MESSAGE              */
         L     @10,DMCBTVP(,DMCBPTR)                               0083
         ST    @10,@AL00001                                        0083
         LA    @10,@CF00557                                        0083
         ST    @10,@AL00001+4                                      0083
         LA    @10,DMCBMSG(,DMCBPTR)                               0083
         ST    @10,@AL00001+8                                      0083
         L     @10,DMCBMSGS(,DMCBPTR)                              0083
         ST    @10,@AL00001+12                                     0083
         LA    @10,@CB00599                                        0083
         ST    @10,@AL00001+16                                     0083
         LA    @10,IOPTLIST                                        0083
         ST    @10,@AFTEMPS+4                                      0083
         LA    @10,@AFTEMPS+4                                      0083
         ST    @10,@AL00001+20                                     0083
         L     @15,DMCBMSG0(,DMCBPTR)                              0083
         LA    @01,@AL00001                                        0083
         BALR  @14,@15                                             0083
*               END;                /* BLSDMSG                     0084
*                                      (ZZ2,F3117C,DMCBMSG,BLSDMSGS)
*                                      INSERT(MODNAME,CTEMP72) BUILD
*                                      ERROR MESSAGE                 */
*               ALSW=ON;            /* SET END OF LOOP               */
         OI    ALSW,B'10000000'                                    0085
*               RETCODE=ERROR;      /* MARK ERROR                    */
         MVC   RETCODE(4),@CF00048                                 0086
*               DO;                 /* ABEND(110) DUMP USER          */
*                 RESPECIFY                                        0088
*                  (GPR01F) RESTRICTED;                            0088
*                 GPR01F=(110)&'00000FFF'X;/* COMP CODE IN BITS 20-31*/
         LA    GPR01F,110                                          0089
*                 GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS  0090
*                                      FLAG                          */
         O     GPR01F,@CF00602                                     0090
*                 SVC(13);          /* ISSUE ABEND SVC               */
         SVC   13                                                  0091
*                 RESPECIFY                                        0092
*                  (GPR01F) UNRESTRICTED;                          0092
*               END;                /* ABEND(110) DUMP USER INTERNAL
*                                      ERROR                         */
*             END;                  /* INVALID PARAMETER KEY CODE    */
*         IF ALVL=ON THEN           /* TEST FOR LAST LIST ELEMENT    */
@RC00063 DS    0H                                                  0095
@RC00061 TM    ALVL(ALBAS),B'10000000'                             0095
         BNO   @RF00095                                            0095
*           DO;                     /* LAST LIST ELEMENT             */
*             ALSW=ON;              /* TERMINATE LIST PROCESSING     */
         OI    ALSW,B'10000000'                                    0097
*           END;                    /* LAST LIST ELEMENT             */
*         ELSE                                                     0099
*           ALBAS=ALBAS+F4C;        /* SET UP FOR NEXT PLIST ENTRY   */
         B     @RC00095                                            0099
@RF00095 AL    ALBAS,@CF00041                                      0099
*       END;                        /* LOOP THROUGH PARM LIST        */
@RC00095 DS    0H                                                  0100
@DE00059 TM    ALSW,B'10000000'                                    0100
         BZ    @DL00059                                            0100
*     END;                          /* PARM LIST EXISTS              */
*                                                                  0101
*   /*****************************************************************/
*   /*                                                               */
*   /* HANDLE DISPOSITION OVERRIDE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0102
*   IF RETCODE=F0C THEN             /* TEST FOR PREVIOUS ERROR       */
@RF00056 L     @10,RETCODE                                         0102
         LTR   @10,@10                                             0102
         BNZ   @RF00102                                            0102
*     DO;                           /* OK SO FAR                     */
*       IF DMCBODIS^=F0C&           /* TEST FOR DISPOSITION OVERRIDE */
*           DMCBVSF=OFF THEN        /* AND NOT VSAM                  */
         CLI   DMCBODIS(DMCBPTR),0                                 0104
         BE    @RF00104                                            0104
         TM    DMCBVSF(DMCBPTR),B'00000001'                        0104
         BNZ   @RF00104                                            0104
*         DO;                       /* BUILD DISP OVERRIDE TEXT UNIT */
*           S99TUPTR(F2C)=S99TUBAS; /* TEXT UNIT POINTER ENTRY       */
         L     @10,S99TXTPP                                        0106
         ST    S99TUBAS,S99TUPTR+4(,@10)                           0106
*           S99TUKEY=DUNOVDSP;      /* OVERRIDING DISPOSITION        */
         MVC   S99TUKEY(2,S99TUBAS),@CB00314                       0107
*           S99TUNUM=F1C;           /* NUMBER OF TU ENTRIES          */
         LA    @10,1                                               0108
         STCM  @10,3,S99TUNUM(S99TUBAS)                            0108
*           S99TULNG=F1C;           /* TEXT UNIT ENTRY LENGTH        */
         STCM  @10,3,S99TULNG(S99TUBAS)                            0109
*           S99TUPAR(F1C)=DMCBODIS; /* OVERRIDE DISP INTO TU ENTRY   */
         MVC   S99TUPAR(1,S99TUBAS),DMCBODIS(DMCBPTR)              0110
*           S99TUPLM=F2C;           /* TEXT UNIT POINTER LIST DIM    */
         LA    S99TUPLM,2                                          0111
*           S99TUPLX=F3C;           /* TEXT UNIT POINTER LIST INDEX  */
         LA    S99TUPLX,3                                          0112
*           S99TUBAS=S99TUBAS+F8C;  /* BUMP TU BASE FOR NEXT FREE TU */
         AL    S99TUBAS,@CF00048                                   0113
*         END;                      /* BUILD DISP OVERRIDE TEXT UNIT */
*                                                                  0114
*       /*************************************************************/
*       /*                                                           */
*       /* HANDLE DATA SET RELEASE FOR DISP = DELETE                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0115
*       IF DMCBODIS=DISPODEL×       /* TEST OVERRIDE DISP = DELETE   */
*           DMCBDISP=DISPNDEL THEN  /* OR NORMAL DISP = DELETE       */
@RF00104 CLI   DMCBODIS(DMCBPTR),X'04'                             0115
         BE    @RT00115                                            0115
         CLI   DMCBDISP(DMCBPTR),X'04'                             0115
         BNE   @RF00115                                            0115
@RT00115 DS    0H                                                  0116
*         DO;                       /* BUILD UNALLOC OPTION TEXT UNIT*/
*           S99TUPTR(S99TUPLX)=S99TUBAS;/* TEXT UNIT POINTER ENTRY   */
         LR    @10,S99TUPLX                                        0117
         SLA   @10,2                                               0117
         L     @05,S99TXTPP                                        0117
         AL    @05,@CF00658                                        0117
         ST    S99TUBAS,S99TUPTR(@10,@05)                          0117
*           S99TUKEY=DUNUNALC;      /* UNALLOCATION OPTION           */
         MVC   S99TUKEY(2,S99TUBAS),@CB00318                       0118
*           S99TUNUM=F0C;           /* NUMBER OF TU ENTRIES          */
         SLR   @10,@10                                             0119
         STCM  @10,3,S99TUNUM(S99TUBAS)                            0119
*           S99TUPLM=S99TUPLX;      /* TEXT UNIT POINTER LIST DIM    */
         LR    S99TUPLM,S99TUPLX                                   0120
*           S99TUPLX=S99TUPLX+F1C;  /* TEXT UNIT POINTER LIST INDEX  */
         AL    S99TUPLX,@CF00050                                   0121
*           S99TUBAS=S99TUBAS+F4C;  /* BUMP TU BASE FOR NEXT FREE TU */
         AL    S99TUBAS,@CF00041                                   0122
*         END;                      /* BUILD UNALLOC OPTION TEXT UNIT*/
*       S99TUPLN(S99TUPLM)=ON;      /* PARM LIST END MARKER          */
*                                                                  0124
@RF00115 LR    @10,S99TUPLM                                        0124
         SLA   @10,2                                               0124
         L     @06,S99TXTPP                                        0124
         ALR   @06,@10                                             0124
         AL    @06,@CF00658                                        0124
         OI    S99TUPLN(@06),B'10000000'                           0124
*       /*************************************************************/
*       /*                                                           */
*       /* PERFORM DYNAMIC FREE FUNCTION                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0125
*       RFY                                                        0125
*        (GPR01P,                                                  0125
*         GPR15F) RSTD;                                            0125
*       GPR01P=ADDR(S99RBPTR);      /* DYNALLOC PARM LIST ADDRESS    */
         LA    GPR01P,S99RBPTR                                     0126
*/* MACDATE Y-2 73082                                                */
*                                                                  0127
*       SVC(99);                    /* PERFORM DYNAMIC FREE FUNCTION */
         SVC   99                                                  0127
*       SUBCODE=GPR15F;             /* SAVE RETURN CODE FOR TEST     */
         ST    GPR15F,SUBCODE                                      0128
*       RFY                                                        0129
*        (GPR01P,                                                  0129
*         GPR15F) UNRSTD;                                          0129
*       IF SUBCODE^=F0C×S99INFO^=F0C THEN/* TEST FOR SUBROUTINE ERROR*/
         L     @10,SUBCODE                                         0130
         SLR   @05,@05                                             0130
         CR    @10,@05                                             0130
         BNE   @RT00130                                            0130
         LH    @10,S99INFO                                         0130
         N     @10,@CF00659                                        0130
         CR    @05,@10                                             0130
         BE    @RF00130                                            0130
@RT00130 DS    0H                                                  0131
*         DO;                       /* DYNAMIC FREE FUNCTION FAILED  */
*                                                                  0131
*           /*********************************************************/
*           /*                                                       */
*           /* PERFORM FREE ERROR ANALYSIS FUNCTION                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0132
*           DMCBIRSC=S99INFO;       /* SVC 99 INFORMATION CODE       */
         MVC   DMCBIRSC(2,DMCBPTR),S99INFO                         0132
*           DMCBSUBC=SUBCODE;       /* DYNALLOC RETURN CODE          */
         L     @10,SUBCODE                                         0133
         ST    @10,DMCBSUBC(,DMCBPTR)                              0133
*           DMCBDRBP=ADDR(S99RB);   /* DYNALLOC REQUEST BLOCK        */
         LA    @10,S99RB                                           0134
         ST    @10,DMCBDRBP(,DMCBPTR)                              0134
*           RFY                                                    0135
*            (GPR01P) RSTD;                                        0135
*           GPR01P=DMCBPTR;         /* PASS DMCB ADDRESS             */
         LR    GPR01P,DMCBPTR                                      0136
*           RFY                                                    0137
*            (GPR01P) UNRSTD;                                      0137
*           CALL BLSCANAL;          /* PERFORM ERROR ANALYSIS        */
         L     @15,@CV00257                                        0138
         BALR  @14,@15                                             0138
*           RFY                                                    0139
*            (GPR15F) RSTD;                                        0139
*           SUBCODE=GPR15F;         /* SAVE RETURN CODE FOR TEST     */
         ST    GPR15F,SUBCODE                                      0140
*           RFY                                                    0141
*            (GPR15F) UNRSTD;                                      0141
*           IF SUBCODE^=F0C THEN    /* TEST FOR SUBROUTINE ERROR     */
         L     @10,SUBCODE                                         0142
         LTR   @10,@10                                             0142
         BZ    @RF00142                                            0142
*             DO;                   /* ERROR ANALYSIS FAILED         */
*               RETCODE=SUBCODE;    /* MARK ERROR TO CALLER          */
         ST    @10,RETCODE                                         0144
*               IF SUBCODE^=SEVERE THEN/* TEST FOR OTHER THAN GETMAIN
*                                      ERROR                         */
         C     @10,@CF00539                                        0145
         BE    @RF00145                                            0145
*                 DO;               /* OTHER ERROR ANALYSIS ERROR    */
*                   DO;             /* BLSDMSG (ZZ2,NOMSG,DMCBMSG,0)
*                                      ROUTE(TERM)                   */
*                     CALL BLSDMSG0(ZZ2,NOMSG,DMCBMSG,0,'00010000'B,0);
         MVC   @AL00001+4(20),@AL00148                             0148
         L     @10,DMCBTVP(,DMCBPTR)                               0148
         ST    @10,@AL00001                                        0148
         LA    @10,DMCBMSG(,DMCBPTR)                               0148
         ST    @10,@AL00001+8                                      0148
         L     @15,DMCBMSG0(,DMCBPTR)                              0148
         LA    @01,@AL00001                                        0148
         BALR  @14,@15                                             0148
*                                   /* BUILD MESSAGE                 */
*                   END;            /* BLSDMSG (ZZ2,NOMSG,DMCBMSG,0)
*                                      ROUTE(TERM) OUTPUT MESSAGE  0149
*                                      LIST                          */
*                   DO;             /* ABEND(F133C) DUMP USER        */
*                     RESPECIFY                                    0151
*                      (GPR01F) RESTRICTED;                        0151
*                     GPR01F=(F133C)&'00000FFF'X;/* COMP CODE IN BITS
*                                      20-31                         */
         LA    GPR01F,133                                          0152
*                     GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS
*                                      FLAG                          */
         O     GPR01F,@CF00602                                     0153
*                     SVC(13);      /* ISSUE ABEND SVC               */
         SVC   13                                                  0154
*                     RESPECIFY                                    0155
*                      (GPR01F) UNRESTRICTED;                      0155
*                   END;            /* ABEND(F133C) DUMP USER SVC99
*                                      ERROR ANALYSIS FAILED         */
*                 END;              /* OTHER ERROR ANALYSIS ERROR    */
*             END;                  /* ERROR ANALYSIS FAILED         */
*           ELSE                                                   0159
*             DO;                   /* ERROR ANALYSIS OK             */
         B     @RC00142                                            0159
@RF00142 DS    0H                                                  0160
*               IF DMCBSUBC=F0C THEN/* TEST FOR SVC 99 WARNING     0160
*                                      CONDITION                     */
         L     @10,DMCBSUBC(,DMCBPTR)                              0160
         LTR   @10,@10                                             0160
         BNZ   @RF00160                                            0160
*                 RETCODE=WARNING;                                 0161
         MVC   RETCODE(4),@CF00041                                 0161
*               ELSE                                               0162
*                 RETCODE=ERROR;                                   0162
         B     @RC00160                                            0162
@RF00160 MVC   RETCODE(4),@CF00048                                 0162
*             END;                  /* ERROR ANALYSIS OK             */
@RC00160 DS    0H                                                  0164
*         END;                      /* DYNAMIC FREE FUNCTION FAILED  */
@RC00142 DS    0H                                                  0165
*     END;                          /* OK SO FAR                     */
*                                                                  0165
@RF00130 DS    0H                                                  0166
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE COMPLETE, RETURN TO CALLER                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0166
*   RETURN CODE(RETCODE);                                          0166
@RF00102 L     @10,RETCODE                                         0166
         L     @13,4(,@13)                                         0166
         L     @00,@SIZDATD                                        0166
         LR    @01,@11                                             0166
         BLSCFREF R,LV=(0),A=(1)
         LR    @15,@10                                             0166
         L     @14,12(,@13)                                        0166
         LM    @00,@12,20(@13)                                     0166
         BR    @14                                                 0166
         EJECT
*                                                                  0167
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO PROCESS THE DISPOSITION PARAMETER                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0167
*DISPPROC:                                                         0167
*   PROCEDURE;                      /* DISP PARM PROCESSING          */
DISPPROC STM   @14,@04,@SA00002                                    0167
         STM   @06,@12,@SA00002+28                                 0167
*   IF ALPRB4F1^=F0C THEN           /* TEST FOR IMMEDIATE TEXT UNIT
*                                      KEY VALUE                     */
         CLI   ALPRB4F1(ALBAS),0                                   0168
         BE    @RF00168                                            0168
*     DMCBODIS=ALPRB4F1;            /* SET OVERRIDE DISPOSITION      */
         IC    @10,ALPRB4F1(,ALBAS)                                0169
         STC   @10,DMCBODIS(,DMCBPTR)                              0169
*   ELSE                                                           0170
*     DO;                           /* GET OVERRIDE DISPOSITION FROM
*                                      INDIRECT PARM FIELD           */
         B     @RC00168                                            0170
@RF00168 DS    0H                                                  0171
*       ALBAS=ALBAS+F4C;            /* BUMP PLIST BASE TO PARM VALUE
*                                      ADDRESS                       */
         AL    ALBAS,@CF00041                                      0171
*       IF ALPTC1^=LBLNKC THEN      /* TEST FOR NON-NULL PARM VALUE  */
         L     @10,ALPTR(,ALBAS)                                   0172
         CLI   ALPTC1(@10),C' '                                    0172
         BE    @RF00172                                            0172
*         DO;                       /* NON-NULL PARM VALUE FIELD,  0173
*                                      OBTAIN TEXT UNIT PARM VALUE   */
*           CALL MATCH(RDISPP,LENGTH(DISPSTR),DISPSTR,FTMP8);/* GET
*                                      TU PARM                       */
         ST    @10,@AL00001                                        0174
         LA    @10,@CF00651                                        0174
         ST    @10,@AL00001+4                                      0174
         LA    @10,DISPSTR                                         0174
         ST    @10,@AL00001+8                                      0174
         LA    @10,FTMP8                                           0174
         ST    @10,@AL00001+12                                     0174
         LA    @01,@AL00001                                        0174
         BAL   @14,MATCH                                           0174
*           IF FTMP8^=F0C THEN      /* TEST FOR VALID PARM VALUE     */
         CLI   FTMP8,0                                             0175
         BE    @RF00175                                            0175
*             DMCBODIS=FTMP8;       /* SET OVERRIDE DISPOSITION      */
         IC    @10,FTMP8                                           0176
         STC   @10,DMCBODIS(,DMCBPTR)                              0176
*           ELSE                                                   0177
*             DO;                   /* INVALID PARM VALUE            */
         B     @RC00175                                            0177
@RF00175 DS    0H                                                  0178
*               ALSW=ON;            /* TERMINATE LIST PROCESSING     */
         OI    ALSW,B'10000000'                                    0178
*               RETCODE=ERROR;      /* MARK ERROR                    */
         LA    @10,8                                               0179
         ST    @10,RETCODE                                         0179
*               DO;                 /* BLSDMSG                     0180
*                                      (ZZ2,F3118C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DISPKY,MODNAME,DISPKY,R
*                                      DISPP)                        */
*                 IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT   0181
*                                      INSERT                        */
         LA    @15,IOPTLIST+12                                     0181
         ST    @15,IOPTLIST                                        0181
*                 IOPTLIST(2)=ADDR(DISPKY);/* INSERT NAME POINTER    */
         LA    @15,@CC00582                                        0182
         ST    @15,IOPTLIST+4                                      0182
*                 IOPTLIST(3)=0;    /* ZERO RESERVED FIELD           */
         SLR   @14,@14                                             0183
         ST    @14,IOPTLIST+8                                      0183
*                 RFY                                              0184
*                   I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 0184
*                                      1-2                           */
*                 I015F=LENGTH(DISPKY);/* INSERT LENGTH              */
         LA    @09,4                                               0185
         LA    @08,IOPTLIST+8                                      0185
         STH   @09,I015F(,@08)                                     0185
*                 IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT   0186
*                                      INSERT                        */
         LA    @08,IOPTLIST+24                                     0186
         ST    @08,IOPTLIST+12                                     0186
*                 IOPTLIST(5)=ADDR(MODNAME);/* INSERT NAME POINTER   */
         LA    @08,MODNAME                                         0187
         ST    @08,IOPTLIST+16                                     0187
*                 IOPTLIST(6)=0;    /* ZERO RESERVED FIELD           */
         ST    @14,IOPTLIST+20                                     0188
*                 RFY                                              0189
*                   I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 0189
*                                      1-2                           */
*                 I015F=LENGTH(MODNAME);/* INSERT LENGTH             */
         LA    @08,IOPTLIST+20                                     0190
         STH   @10,I015F(,@08)                                     0190
*                 IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT  0191
*                                      INSERT                        */
         LA    @10,IOPTLIST+36                                     0191
         ST    @10,IOPTLIST+24                                     0191
*                 IOPTLIST(8)=ADDR(DISPKY);/* INSERT NAME POINTER    */
         ST    @15,IOPTLIST+28                                     0192
*                 IOPTLIST(9)=0;    /* ZERO RESERVED FIELD           */
         ST    @14,IOPTLIST+32                                     0193
*                 RFY                                              0194
*                   I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 0194
*                                      1-2                           */
*                 I015F=LENGTH(DISPKY);/* INSERT LENGTH              */
         LA    @10,IOPTLIST+32                                     0195
         STH   @09,I015F(,@10)                                     0195
*                 IOPTLIST(10)=0;   /* LAST INSERT                   */
         ST    @14,IOPTLIST+36                                     0196
*                 IOPTLIST(11)=ADDR(RDISPP);/* INSERT NAME POINTER   */
         L     @10,ALPTR(,ALBAS)                                   0197
         ST    @10,IOPTLIST+40                                     0197
*                 IOPTLIST(12)=0;   /* ZERO RESERVED FIELD           */
         ST    @14,IOPTLIST+44                                     0198
*                 RFY                                              0199
*                   I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES
*                                      1-2                           */
*                 I015F=LENGTH(RDISPP);/* INSERT LENGTH              */
         LA    @10,IOPTLIST+44                                     0200
         MVC   I015F(2,@10),@CH00083                               0200
*                 CALL BLSDMSG0(ZZ2,F3118C,DMCBMSG,BLSDMSGS,'00000000'B
*                     ,ADDR(IOPTLIST));/* BUILD MESSAGE              */
         L     @10,DMCBTVP(,DMCBPTR)                               0201
         ST    @10,@AL00001                                        0201
         LA    @10,@CF00559                                        0201
         ST    @10,@AL00001+4                                      0201
         LA    @10,DMCBMSG(,DMCBPTR)                               0201
         ST    @10,@AL00001+8                                      0201
         L     @10,DMCBMSGS(,DMCBPTR)                              0201
         ST    @10,@AL00001+12                                     0201
         LA    @10,@CB00599                                        0201
         ST    @10,@AL00001+16                                     0201
         LA    @10,IOPTLIST                                        0201
         ST    @10,@AFTEMPS                                        0201
         LA    @10,@AFTEMPS                                        0201
         ST    @10,@AL00001+20                                     0201
         L     @15,DMCBMSG0(,DMCBPTR)                              0201
         LA    @01,@AL00001                                        0201
         BALR  @14,@15                                             0201
*               END;                /* BLSDMSG                     0202
*                                      (ZZ2,F3118C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DISPKY,MODNAME,DISPKY,R
*                                      DISPP) ISSUE ERROR MESSAGE    */
*               DO;                 /* ABEND(110) DUMP USER          */
*                 RESPECIFY                                        0204
*                  (GPR01F) RESTRICTED;                            0204
*                 GPR01F=(110)&'00000FFF'X;/* COMP CODE IN BITS 20-31*/
         LA    GPR01F,110                                          0205
*                 GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS  0206
*                                      FLAG                          */
         O     GPR01F,@CF00602                                     0206
*                 SVC(13);          /* ISSUE ABEND SVC               */
         SVC   13                                                  0207
*                 RESPECIFY                                        0208
*                  (GPR01F) UNRESTRICTED;                          0208
*               END;                /* ABEND(110) DUMP USER INTERNAL
*                                      ERROR                         */
*             END;                  /* INVALID PARM VALUE            */
*         END;                      /* NON-NULL PARM VALUE FIELD,  0211
*                                      OBTAIN TEXT UNIT PARM VALUE   */
*     END;                          /* GET OVERRIDE DISPOSITION FROM
*                                      INDIRECT PARM FIELD           */
*   END DISPPROC;                                                  0213
@EL00002 DS    0H                                                  0213
@EF00002 DS    0H                                                  0213
@ER00002 LM    @14,@04,@SA00002                                    0213
         LM    @06,@12,@SA00002+28                                 0213
         BR    @14                                                 0213
         EJECT
*                                                                  0214
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO MATCH A VARIABLE LENGTH FIELD VALUE WITH A LIST  */
*   /* OF VALID VALUES AND RETURN A ONE BYTE TEXT UNIT PARAMETER     */
*   /* VALUE                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0214
*MATCH:                                                            0214
*   PROCEDURE(MATFLD,MATSTRL,MATSTR,MATVAL);                       0214
MATCH    STM   @14,@12,12(@13)                                     0214
         MVC   @PC00003(16),0(@01)                                 0214
*   DCL                                                            0215
*     MATFLD CHAR(*),               /* PARAMETER FIELD VALUE TO BE 0215
*                                      EXAMINED                      */
*     MATSTRL BIN(31),              /* LENGTH OF VALID VALUE STRING  */
*     MATSTR CHAR(*),               /* TEXT OF VALID VALUE STRING    */
*     MATVAL CHAR(1),               /* TEXT UNIT PARAMETER VALUE   0215
*                                      RETURNED                      */
*     MATLEN BIN(31),               /* LOCAL COPY OF MATSTRL         */
*     MATSW BIT(1),                 /* 1 IF MATCH FOUND              */
*     MATSK BIT(1),                 /* 1 IF NO MATCH WITH CURRENT  0215
*                                      VALID VALUE                   */
*     MATI BIN(31),                 /* VALID VALUE STRING INDEX      */
*     MATJ BIN(31),                 /* PARM FIELD VALUE INDEX        */
*     MATHEX0 BIT(8) CONSTANT('00'X),/* LITERAL HEX 0                */
*     MATSTARC CHAR(1) CONSTANT('*');/* LITERAL '*'                  */
         SPACE 1
*   MATVAL=MATHEX0;                 /* INIT RETURN VALUE TO NOT FOUND*/
         L     @10,@PC00003+12                                     0216
         MVI   MATVAL(@10),X'00'                                   0216
*   MATLEN=MATSTRL;                 /* MAKE LOCAL COPY OF STRING   0217
*                                      LENGTH                        */
         L     @10,@PC00003+4                                      0217
         L     MATLEN,MATSTRL(,@10)                                0217
*   MATSW=OFF;                      /* INIT MATCH FOUND SWITCH       */
         NI    MATSW,B'01111111'                                   0218
*   MATSK=OFF;                      /* INIT CURRENT NO MATCH SWITCH  */
         NI    MATSK,B'01111111'                                   0219
*   MATJ=F1C;                       /* INIT PARM FIELD INDEX         */
         LA    @10,1                                               0220
         LR    MATJ,@10                                            0220
*   DO MATI=F1C TO MATLEN WHILE MATSW=OFF;/* SCAN VALID VALUE STRING */
         LR    MATI,@10                                            0221
         B     @DE00221                                            0221
@DL00221 TM    MATSW,B'10000000'                                   0221
         BNZ   @DC00221                                            0221
*     IF MATSW=OFF THEN             /* TEST THAT CURRENT VALID VALUE
*                                      STRING MATCHES                */
         TM    MATSW,B'10000000'                                   0222
         BNZ   @RF00222                                            0222
*       DO;                         /* CURRENT VALID VALUE STRING  0223
*                                      MATCHES SO FAR                */
*         IF MATSTR(MATI)=MATSTARC THEN/* TEST VALID VALUE DELIMITER */
         L     @10,@PC00003+8                                      0224
         LR    @05,@10                                             0224
         ALR   @05,MATI                                            0224
         BCTR  @05,0                                               0224
         CLI   MATSTR(@05),C'*'                                    0224
         BNE   @RF00224                                            0224
*           DO;                     /* MATCH FOUND                   */
*             MATSW=ON;             /* PARM FIELD AND VALID VALUE  0226
*                                      MATCH                         */
         OI    MATSW,B'10000000'                                   0226
*             MATI=MATI+F1C;        /* BUMP VALID VALUE STRING TO  0227
*                                      RETURN VALUE                  */
         AL    MATI,@CF00050                                       0227
*             MATVAL=MATSTR(MATI);  /* RETURN TEXT UNIT PARAMETER  0228
*                                      VALUE                         */
         L     @05,@PC00003+12                                     0228
         ALR   @10,MATI                                            0228
         BCTR  @10,0                                               0228
         MVC   MATVAL(1,@05),MATSTR(@10)                           0228
*           END;                    /* MATCH FOUND                   */
*         ELSE                                                     0230
*           DO;                     /* MATCH NOT FOUND               */
         B     @RC00224                                            0230
@RF00224 DS    0H                                                  0231
*             IF MATFLD(MATJ)=MATSTR(MATI) THEN/* TEST BYTE FOR MATCH*/
         L     @10,@PC00003                                        0231
         L     @05,@PC00003+8                                      0231
         ALR   @10,MATJ                                            0231
         BCTR  @10,0                                               0231
         ALR   @05,MATI                                            0231
         BCTR  @05,0                                               0231
         CLC   MATFLD(1,@10),MATSTR(@05)                           0231
         BNE   @RF00231                                            0231
*               DO;                 /* BYTES MATCH                   */
*                 MATJ=MATJ+F1C;    /* BUMP PARM FIELD INDEX TO NEXT
*                                      BYTE                          */
         AL    MATJ,@CF00050                                       0233
*               END;                /* BYTES MATCH                   */
*             ELSE                                                 0235
*               DO;                 /* BYTES DO NOT MATCH            */
         B     @RC00231                                            0235
@RF00231 DS    0H                                                  0236
*                 MATSK=ON;         /* CURRENT VALID VALUE DOES NOT
*                                      MATCH                         */
         OI    MATSK,B'10000000'                                   0236
*                 MATJ=F1C;         /* RESET THE PARMFIELD INDEX FOR
*                                      NEXT MATCH TEST               */
         LA    MATJ,1                                              0237
*               END;                /* BYTES DO NOT MATCH            */
*           END;                    /* MATCH NOT FOUND               */
@RC00231 DS    0H                                                  0240
*       END;                        /* CURRENT VALID VALUE STRING  0240
*                                      MATCHES SO FAR                */
@RC00224 DS    0H                                                  0241
*     IF MATSK=ON&                  /* TEST FOR CURRENT VALID VALUE
*                                      DOES NOT MATCH                */
*         MATSTR(MATI)=MATSTARC THEN/* AND FOR VALID VALUE DELIMETER */
@RF00222 TM    MATSK,B'10000000'                                   0241
         BNO   @RF00241                                            0241
         L     @10,@PC00003+8                                      0241
         ALR   @10,MATI                                            0241
         BCTR  @10,0                                               0241
         CLI   MATSTR(@10),C'*'                                    0241
         BNE   @RF00241                                            0241
*       DO;                         /* END OF CURRENT VALUE, SET UP
*                                      TO TEST NEXT VALUE            */
*         MATI=MATI+F1C;            /* SKIP INDEX OVER RETURN VALUE  */
         AL    MATI,@CF00050                                       0243
*         MATSK=OFF;                /* STOP SKIPPING OVER NO MATCH 0244
*                                      VALUE                         */
         NI    MATSK,B'01111111'                                   0244
*       END;                        /* END OF CURRENT VALUE, SET UP
*                                      TO TEST NEXT VALUE            */
*   END;                            /* SCAN VALID VALUE STRING       */
@RF00241 AL    MATI,@CF00050                                       0246
@DE00221 CR    MATI,MATLEN                                         0246
         BNH   @DL00221                                            0246
@DC00221 DS    0H                                                  0247
*   END MATCH;                      /* END PROCEDURE                 */
@EL00003 DS    0H                                                  0247
@EF00003 DS    0H                                                  0247
@ER00003 LM    @14,@12,12(@13)                                     0247
         BR    @14                                                 0247
         EJECT
*                                                                  0248
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0248
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR01F FIXED(31) REG(1),                                     0248
*     GPR15F FIXED(31) REG(15),                                    0248
*     GPR01P PTR(31) REG(1);                                       0248
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0249
*     I031F FIXED(31) BASED,                                       0249
*     I031P PTR(31) BASED,                                         0249
*     I015F FIXED(15) BASED,                                       0249
*     I015P PTR(15) BASED,                                         0249
*     I008P PTR(8) BASED,                                          0249
*     I001C CHAR(1) BASED;                                         0249
*   DECLARE                                                        0250
*     IOPTLIST(12) PTR(31) BDY(WORD);/* OPTION LIST ARRAY            */
*   DCL                                                            0251
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0251
*   GEN DATA DEFS(HEXTBL);                                         0252
*   END BLSCFDYN                                                   0253
*                                                                  0253
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */
*                                                                  0253
*       ;                                                          0253
@EL00001 L     @13,4(,@13)                                         0253
@EF00001 L     @00,@SIZDATD                                        0253
         LR    @01,@11                                             0253
         BLSCFREF R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0253
         BR    @14                                                 0253
@DATA    DS    0H
@CH00076 DC    H'2'
@CH00083 DC    H'7'
         DS    0F
@AL00148 DC    A(@CF00561)             LIST WITH   5 ARGUMENT(S)
         DS    F
         DC    A(@CF00183)
         DC    A(@CB00608)
         DC    A(@CF00183)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@SA00002 DS    14F
@PC00003 DS    4F
@AL00001 DS    6A
@AFTEMPS DS    2F
BLSCFDYN CSECT
         DS    0F
@CF00183 DC    F'0'
@CF00050 DC    F'1'
@CF00041 DC    F'4'
@CF00052 DC    F'5'
@CF00048 DC    F'8'
@CH00048 EQU   @CF00048+2
@CF00539 DC    F'12'
@CF00549 DC    F'14'
@CF00651 DC    F'30'
@CF00564 DC    F'80'
@CF00557 DC    F'3117'
@CF00559 DC    F'3118'
@CF00658 DC    F'-4'
@CF00561 DC    F'-1'
@CF00602 DC    XL4'80000000'
@CF00659 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
S99RBPTR DS    AL4
         ORG   S99RBPTR
S99RBPND DS    BL1
         ORG   S99RBPTR+4
FTMP8    DS    FL1
         ORG   FTMP8
BTMP8    DS    BL1
         ORG   FTMP8+1
         DS    CL3
S99RB    DS    CL20
         ORG   S99RB
S99RBLN  DS    CL1
S99VERB  DS    CL1
S99FLAG1 DS    CL2
         ORG   S99FLAG1
S99FLG11 DS    CL1
         ORG   S99FLG11
S99ONCNV DS    BL1
S99NOCNV EQU   S99FLG11+0
S99NOMNT EQU   S99FLG11+0
S99JBSYS EQU   S99FLG11+0
         ORG   S99FLAG1+1
S99FLG12 DS    CL1
         ORG   S99RB+4
S99RSC   DS    CL4
         ORG   S99RSC
S99ERROR DS    CL2
S99INFO  DS    CL2
         ORG   S99RB+8
S99TXTPP DS    AL4
S99RSV01 DS    FL4
S99FLAG2 DS    CL4
         ORG   S99FLAG2
S99FLG21 DS    CL1
         ORG   S99FLG21
S99WTVOL DS    BL1
S99WTDSN EQU   S99FLG21+0
S99NORES EQU   S99FLG21+0
S99WTUNT EQU   S99FLG21+0
S99OFFLN EQU   S99FLG21+0
S99TIONQ EQU   S99FLG21+0
S99CATLG EQU   S99FLG21+0
S99MOUNT EQU   S99FLG21+0
         ORG   S99FLAG2+1
S99FLG22 DS    CL1
         ORG   S99FLG22
S99UDEVT DS    BL1
S99PCINT EQU   S99FLG22+0
         ORG   S99FLAG2+2
S99FLG23 DS    CL1
S99FLG24 DS    CL1
         ORG   S99RB+20
TUL      DS    CL80
         ORG   TUL
TUPL     DS    4A
TUS      DS    CL64
         ORG   TUL+80
ALSW     DS    BL1
         DS    CL3
CHSTR8   DS    CL8
         ORG   CHSTR8
@NM00005 DS    CL3
CHSTR847 DS    CL4
         ORG   CHSTR847
@NM00006 DS    CL2
CHSTR867 DS    CL2
         ORG   CHSTR8+7
CHSTR88  DS    CL1
         ORG   CHSTR8+8
CTEMP    DS    CL9
         ORG   CTEMP
@NM00007 DS    CL5
CTEMP63  DS    CL3
         ORG   CTEMP63
@NM00008 DS    CL1
CTEMP72  DS    CL2
         ORG   CTEMP+9
         DS    CL3
MODSTAT  DS    CL16
         ORG   MODSTAT
MODNAME  DS    CL8
RETCODE  DS    FL4
SUBCODE  DS    FL4
         ORG   MODSTAT+16
MATSW    DS    BL1
MATSK    DS    BL1
         DS    CL2
IOPTLIST DS    12A
BLSCFDYN CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00257 DC    V(BLSCANAL)
         DS    0D
@CC00584 DC    C'BLSCFDYN'
@CC00582 DC    C'DISP'
@CB00306 DC    X'0001'
@CB00314 DC    X'0005'
@CB00318 DC    X'0007'
@CB00599 DC    B'00000000'
@CB00608 DC    B'00010000'
DISPSTR  DS    CL30
         ORG   DISPSTR
DISPA    DC    CL8'UNCATLG*'
DISPB    DC    X'01'
DISPC    DC    CL6'CATLG*'
DISPD    DC    X'02'
DISPE    DC    CL7'DELETE*'
DISPF    DC    X'04'
DISPG    DC    CL5'KEEP*'
DISPH    DC    X'08'
         ORG   DISPSTR+30
         DS    CL6
DASPATCH DS    CL256
         ORG   DASPATCH
DASPATA  DC    64A(0)
         ORG   DASPATCH+256
BLSCFDYN CSECT
*                         /*
HEXTBL   EQU   *-240
         DC    CL16'0123456789ABCDEF'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSCFDYN CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MATJ     EQU   @03
MATI     EQU   @02
MATLEN   EQU   @04
ALOPT    EQU   @02
S99TUBAS EQU   @03
S99TUPLX EQU   @06
S99TUPLM EQU   @07
ALBAS    EQU   @05
S99TUFP  EQU   @02
DMCBPTR  EQU   @04
GPR01F   EQU   @01
GPR01P   EQU   @01
GPR15F   EQU   @15
DMCB     EQU   0
DMCBTVP  EQU   DMCB+8
DMCBFTY  EQU   DMCB+20
DMCBVSF  EQU   DMCBFTY
DMCBOPN  EQU   DMCB+21
DMCBRMOD EQU   DMCB+23
DMCBOUT  EQU   DMCBRMOD
DMCBOPTS EQU   DMCB+24
DMCBGKY  EQU   DMCBOPTS
DMCBMFLG EQU   DMCB+28
DMCBBUFP EQU   DMCB+32
DMCBKEYP EQU   DMCB+44
DMCBMSG  EQU   DMCB+52
DMCBRI   EQU   DMCB+64
DMCBMSG0 EQU   DMCB+68
DMCBMSGS EQU   DMCB+72
DMCBFRE  EQU   DMCB+88
DMCBEOB  EQU   DMCB+92
DMCBACBE EQU   DMCB+124
DMCBDDNM EQU   DMCB+260
DMCBDISP EQU   DMCB+367
DMCBODIS EQU   DMCB+368
DMCBSPEC EQU   DMCB+380
DMCBDRBP EQU   DMCB+400
DMCBSUBC EQU   DMCB+404
DMCBIRSC EQU   DMCB+408
DMCBAMS  EQU   DMCB+416
DMCBAUDT EQU   DMCB+568
DMCBLSCP EQU   DMCBAUDT+16
S99TUPL  EQU   0
S99TUPTR EQU   S99TUPL
S99TUPLN EQU   S99TUPTR
S99TUP   EQU   0
S99TUNIT EQU   0
S99TUKEY EQU   S99TUNIT
S99TUNUM EQU   S99TUNIT+2
S99TUENT EQU   S99TUNIT+4
S99TULNG EQU   S99TUENT
S99TUPAR EQU   S99TUENT+2
S99TUFLD EQU   0
BLSDMSGS EQU   0
BLSDMSG0 EQU   0
ZZ2      EQU   0
ALPTR    EQU   0
ALOP     EQU   ALPTR
ALVL     EQU   ALOP
ALPRB4C1 EQU   ALPTR+3
ALPRB4F1 EQU   ALPRB4C1
ALPTF31  EQU   0
ALPTB2C3 EQU   ALPTF31+1
ALPTB3C2 EQU   ALPTB2C3+1
ALPTC1   EQU   0
RDISPP   EQU   0
I015F    EQU   0
ALPTCVL  EQU   0
DMCBDMGR EQU   0
DMCBRQC  EQU   0
I001C    EQU   0
I008P    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
DMCBPARM EQU   0
PLIST    EQU   0
MATFLD   EQU   0
MATSTRL  EQU   0
MATSTR   EQU   0
MATVAL   EQU   0
DMCBVSM  EQU   DMCBAMS
DMCBQSM  EQU   DMCBAMS
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
DMCBRES7 EQU   DMCBQSM+96
DMCBDCB  EQU   DMCBQSM
DMCBACB  EQU   DMCBVSM+76
DMCBRPL  EQU   DMCBVSM
ALPTB4C1 EQU   ALPTB3C2+1
@NM00004 EQU   ALPTB3C2
@NM00003 EQU   ALPTB2C3
@NM00002 EQU   ALPTF31
@NM00001 EQU   ALPTR+1
S99TUPRM EQU   S99TUFLD+2
S99TULEN EQU   S99TUFLD
S99TUPND EQU   S99TUP
DMCBWRK  EQU   DMCB+648
DMCBRES8 EQU   DMCB+640
DMCBMODN EQU   DMCB+632
DMCBCARY EQU   DMCBAUDT+20
DMCBCLC  EQU   DMCBAUDT+12
DMCBOPC  EQU   DMCBAUDT+8
DMCBFRC  EQU   DMCBAUDT+4
DMCBALC  EQU   DMCBAUDT
DMCBFR   EQU   DMCB+412
DMCBRES6 EQU   DMCB+410
DMCBRSZM EQU   DMCB+398
DMCBRSZA EQU   DMCB+396
DMCBCISZ EQU   DMCB+394
DMCBDCBL EQU   DMCB+392
DMCBDCLR EQU   DMCB+390
DMCBDCFM EQU   DMCB+389
DMCBRES5 EQU   DMCB+388
DMCBLBRT EQU   DMCB+386
DMCBLBSQ EQU   DMCB+384
DMCBLBPS EQU   DMCB+383
DMCBLBTY EQU   DMCB+382
DMCBRES4 EQU   DMCB+381
DMCBSPRS EQU   DMCBSPEC
DMCBSPRN EQU   DMCBSPEC
DMCBSPCT EQU   DMCBSPEC
DMCBSPRL EQU   DMCBSPEC
DMCBSPSE EQU   DMCB+376
DMCBSPPR EQU   DMCB+372
DMCBSPTY EQU   DMCB+369
DMCBSTAT EQU   DMCB+366
DMCBRES3 EQU   DMCB+364
DMCBMEMB EQU   DMCB+356
DMCBMODL EQU   DMCB+348
DMCBRES9 EQU   DMCB+340
DMCBPID  EQU   DMCB+332
DMCBTYPE EQU   DMCB+328
DMCBDSN  EQU   DMCB+284
DMCBUNIT EQU   DMCB+276
DMCBDSOR EQU   DMCB+274
DMCBVOL  EQU   DMCB+268
DMCBSYNM EQU   DMCB+132
DMCBRPLF EQU   DMCB+128
DMCBDCBE EQU   DMCBACBE
DMCBARC  EQU   DMCB+120
DMCBCPC  EQU   DMCB+116
DMCBRET  EQU   DMCB+112
DMCBSTL  EQU   DMCB+96
DMCBRES2 EQU   DMCB+85
DMCBSPID EQU   DMCB+84
DMCBRESC EQU   DMCB+80
DMCBZZ1P EQU   DMCB+76
DMCBRRL  EQU   DMCB+60
DMCBRBA  EQU   DMCB+56
DMCBKEYL EQU   DMCB+48
DMCBKPC  EQU   DMCBKEYP
DMCBORL  EQU   DMCB+40
DMCBBLEN EQU   DMCB+36
DMCBBFPC EQU   DMCBBUFP
DMCBRES1 EQU   DMCB+31
DMCBACCM EQU   DMCB+30
DMCBREJ  EQU   DMCB+29
DMCBRESB EQU   DMCBMFLG
DMCBFMOD EQU   DMCBMFLG
DMCBLOPT EQU   DMCB+27
DMCBLRM  EQU   DMCB+26
DMCBLRQ  EQU   DMCB+25
DMCBOPRS EQU   DMCBOPTS
DMCBLRD  EQU   DMCBOPTS
DMCBBWD  EQU   DMCBOPTS
DMCBUPD  EQU   DMCBOPTS
DMCBAPX  EQU   DMCBOPTS
DMCBRNO  EQU   DMCBGKY
DMCBKYD  EQU   DMCBOPTS
DMCBRMRS EQU   DMCBRMOD
DMCBRM5  EQU   DMCBRMOD
DMCBRM6  EQU   DMCBRMOD
DMCBTMP  EQU   DMCBOUT
DMCBRQST EQU   DMCB+22
DMCBRESA EQU   DMCBOPN
DMCBSOUT EQU   DMCBOPN
DMCBSIN  EQU   DMCBOPN
DMCBKSF  EQU   DMCBFTY
DMCBFTRS EQU   DMCBFTY
DMCBSHF  EQU   DMCBFTY
DMCBIRL  EQU   DMCB+16
DMCBRTC  EQU   DMCB+12
DMCBNEXT EQU   DMCB+4
DMCBID   EQU   DMCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00145 EQU   @RC00142
@RC00168 EQU   @EL00002
@RF00172 EQU   @EL00002
@RC00175 EQU   @EL00002
@ENDDATA EQU   *
         END   BLSCFDYN,(C'PLS1918',0701,78062)

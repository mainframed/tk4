         TITLE 'EP=BLSCANLE -- IPCS DAS DATA ACCESS ERROR ANALYZER INTE*
               ERFACE   '
*     /* CHANGE ACTIVITY
*    THIS MODULE IS WRITTEN FOR @G57LPSR
BLSCANLE CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'BLSCANLE  78.062'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         BLSCGETF R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(4),0(@01)                                  0002
*                                                                  0030
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MODULE STATUS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0030
*   DMCBPTR=ADDR(DMCBPARM);         /* BASE THE DMCB                 */
         L     DMCBPTR,@PC00001                                    0030
*   MODNAME=LMODNMC;                /* INIT THE MODULE NAME          */
         MVC   MODNAME(8),@CC00336                                 0031
*   RETCODE=F0C;                    /* INIT THE MODULE RETURN CODE   */
         SLR   @10,@10                                             0032
         ST    @10,RETCODE                                         0032
*   SUBCODE=F0C;                    /* INIT THE SUBROUTINE RETURN  0033
*                                      CODE                          */
         ST    @10,SUBCODE                                         0033
*   IF DMCBLSCP<ADDR(DMCBCARY(DIM(DMCBCARY)))&/* IF AUDIT TRAIL PTR  */
*       DMCBLSCP>=ADDR(DMCBCARY(F1C)) THEN/* IS WITHIN THE BOUNDS OF
*                                      THE AUDIT TRAIL LIST          */
         L     @10,DMCBLSCP(,DMCBPTR)                              0034
         LA    @05,DMCBCARY+40(,DMCBPTR)                           0034
         CR    @10,@05                                             0034
         BNL   @RF00034                                            0034
         LA    @05,DMCBCARY(,DMCBPTR)                              0034
         CR    @10,@05                                             0034
         BL    @RF00034                                            0034
*     DMCBLSCP=DMCBLSCP+F4C;        /* BUMP THE PTR TO NEXT SLOT     */
         AL    @10,@CF00039                                        0035
         ST    @10,DMCBLSCP(,DMCBPTR)                              0035
*   ELSE                                                           0036
*     DMCBLSCP=ADDR(DMCBCARY(F1C)); /* ELSE SET PTR TO FIRST SLOT    */
         B     @RC00034                                            0036
@RF00034 LA    @10,DMCBCARY(,DMCBPTR)                              0036
         ST    @10,DMCBLSCP(,DMCBPTR)                              0036
*   RFY                                                            0037
*     GPR13P RSTD;                                                 0037
@RC00034 DS    0H                                                  0038
*   DMCBRQC=CSAVR14;                /* REMEMBER WHERE CALLED FROM    */
         L     @10,DMCBLSCP(,DMCBPTR)                              0038
         L     @05,MSAVHSA(,GPR13P)                                0038
         L     @05,CSAVR14(,@05)                                   0038
         ST    @05,DMCBRQC(,@10)                                   0038
*   RFY                                                            0039
*     GPR13P UNRSTD;                                               0039
*                                                                  0039
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE COMMON MESSAGE INSERTS                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0040
*   IF DMCBRQST>=DMCBOPR&DMCBRQST<=DMCBPOR THEN/* TEST FOR VALID   0040
*                                      REQUEST CODE CODE             */
         CLI   DMCBRQST(DMCBPTR),1                                 0040
         BL    @RF00040                                            0040
         CLI   DMCBRQST(DMCBPTR),8                                 0040
         BH    @RF00040                                            0040
*     OPCODE=OPNAME(DMCBRQST);      /* FILL IN REQUEST NAME          */
         SLR   @10,@10                                             0041
         IC    @10,DMCBRQST(,DMCBPTR)                              0041
         MH    @10,@CH00050                                        0041
         LA    @05,OPNAME-5(@10)                                   0041
         MVC   OPCODE(5),0(@05)                                    0041
*   ELSE                                                           0042
*     DO;                           /* INVALID REQUEST CODE          */
         B     @RC00040                                            0042
@RF00040 DS    0H                                                  0043
*       CHSTR87=DMCBRQST;           /* GET DATA ACCESS VERB FIELD    */
         IC    @10,DMCBRQST(,DMCBPTR)                              0043
         STC   @10,CHSTR87                                         0043
*       CHSTR88=LHEX0FC;            /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0044
*       UNPK(CTEMP,CHSTR8);                                        0045
         UNPK  CTEMP(9),CHSTR8(8)                                  0045
*       TR(CTEMP,HEXTBL);                                          0046
         TR    CTEMP(9),HEXTBL                                     0046
*       OPCODE=CTEMP78;             /* STORE THE VERB                */
         MVI   OPCODE+2,C' '                                       0047
         MVC   OPCODE+3(2),OPCODE+2                                0047
         MVC   OPCODE(2),CTEMP78                                   0047
*     END;                          /* INVALID REQUEST CODE          */
*   CHSTR847=DMCBRTC;               /* DAS RETURN CODE               */
@RC00040 MVC   CHSTR847(4),DMCBRTC(DMCBPTR)                        0049
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0050
*   UNPK(CTEMP,CHSTR8);                                            0051
         UNPK  CTEMP(9),CHSTR8(8)                                  0051
*   TR(CTEMP,HEXTBL);                                              0052
         TR    CTEMP(9),HEXTBL                                     0052
*   RCODE=CTEMP78;                  /* SAVE THE RETURN CODE          */
         MVC   RCODE(2),CTEMP78                                    0053
*   CHSTR847=DMCBREJ;               /* DAS REJECT CODE               */
         SLR   @10,@10                                             0054
         IC    @10,DMCBREJ(,DMCBPTR)                               0054
         STCM  @10,15,CHSTR847                                     0054
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0055
*   UNPK(CTEMP,CHSTR8);                                            0056
         UNPK  CTEMP(9),CHSTR8(8)                                  0056
*   TR(CTEMP,HEXTBL);                                              0057
         TR    CTEMP(9),HEXTBL                                     0057
*   REJCODE=CTEMP78;                /* SAVE THE REJECT CODE          */
         MVC   REJCODE(2),CTEMP78                                  0058
         EJECT
*                                                                  0059
*   /*****************************************************************/
*   /*                                                               */
*   /* DO ERROR ANALYSIS                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0059
*   IF DMCBVSF=ON THEN              /* TEST FOR VSAM DATA SET        */
         TM    DMCBVSF(DMCBPTR),B'00000001'                        0059
         BNO   @RF00059                                            0059
*     DO;                           /* VSAM DATA SET                 */
*       CALL VSAM;                  /* DO ERROR ANALYSIS FOR VSAM  0061
*                                      DATA SET                      */
         BAL   @14,VSAM                                            0061
*     END;                          /* VSAM DATA SET                 */
*   ELSE                                                           0063
*     DO;                           /* NON-VSAM DATA SET             */
         B     @RC00059                                            0063
@RF00059 DS    0H                                                  0064
*       CALL NONVSAM;               /* ERROR ANALYSIS FOR NON-VSAM DS*/
         BAL   @14,NONVSAM                                         0064
*     END;                          /* NON-VSAM DATA SET             */
*                                                                  0065
*   /*****************************************************************/
*   /*                                                               */
*   /* ANALYSIS COMPLETE, RETURN TO CALLER                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0066
*   RETURN CODE(RETCODE);                                          0066
@RC00059 L     @10,RETCODE                                         0066
         L     @13,4(,@13)                                         0066
         L     @00,@SIZDATD                                        0066
         LR    @01,@11                                             0066
         BLSCFREF R,LV=(0),A=(1)
         LR    @15,@10                                             0066
         L     @14,12(,@13)                                        0066
         LM    @00,@12,20(@13)                                     0066
         BR    @14                                                 0066
         EJECT
*                                                                  0067
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO DO ERROR ANALYSIS FOR VSAM DATA SET TYPE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0067
*VSAM:                                                             0067
*   PROCEDURE;                      /* DO ERROR ANALYSIS FOR VSAM  0067
*                                      DATA SET TYPE                 */
*                                                                  0067
VSAM     STM   @14,@12,@SA00002                                    0067
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE IPCS VSAM BASIC DATA ACCESS ERROR MESSAGE           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0068
*   CHSTR847=DMCBSUBC;              /* VSAM RETURN CODE              */
         MVC   CHSTR847(4),DMCBSUBC(DMCBPTR)                       0068
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0069
*   UNPK(CTEMP,CHSTR8);                                            0070
         UNPK  CTEMP(9),CHSTR8(8)                                  0070
*   TR(CTEMP,HEXTBL);                                              0071
         TR    CTEMP(9),HEXTBL                                     0071
*   SUBRCOD=CTEMP78;                /* SAVE THE RETURN CODE          */
         MVC   SUBRCOD(2),CTEMP78                                  0072
*   IF DMCBRQST=DMCBOPR×            /* TEST FOR OPEN REQUEST         */
*       DMCBRQST=DMCBCLR THEN       /* OR CLOSE REQUEST              */
         CLI   DMCBRQST(DMCBPTR),1                                 0073
         BE    @RT00073                                            0073
         CLI   DMCBRQST(DMCBPTR),2                                 0073
         BNE   @RF00073                                            0073
@RT00073 DS    0H                                                  0074
*     CHSTR847=DMCBACBE;            /* ACBERFLG FIELD AFTER OPEN/CLSE*/
         MVC   CHSTR847(4),DMCBACBE(DMCBPTR)                       0074
*   ELSE                                                           0075
*     CHSTR847=DMCBRPLF;            /* RPL FDBK FIELD AFTER BAD VSAM
*                                      REQUEST                       */
         B     @RC00073                                            0075
@RF00073 MVC   CHSTR847(4),DMCBRPLF(DMCBPTR)                       0075
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
@RC00073 MVI   CHSTR88,X'0F'                                       0076
*   UNPK(CTEMP,CHSTR8);                                            0077
         UNPK  CTEMP(9),CHSTR8(8)                                  0077
*   TR(CTEMP,HEXTBL);                                              0078
         TR    CTEMP(9),HEXTBL                                     0078
*   DO;                             /* BLSDMSG                     0079
*                                      (ZZ2,F3114C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDDNM,OPCODE,RCODE,R
*                                      EJCODE,SUBRCOD,CTEMP18,DMCBDSN
*                                      )                             */
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */
         LA    @10,IOPTLIST+12                                     0080
         ST    @10,IOPTLIST                                        0080
*     IOPTLIST(2)=ADDR(DMCBDDNM);   /* INSERT NAME POINTER           */
         LA    @10,DMCBDDNM(,DMCBPTR)                              0081
         ST    @10,IOPTLIST+4                                      0081
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0082
         ST    @10,IOPTLIST+8                                      0082
*     RFY                                                          0083
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(DMCBDDNM);       /* INSERT LENGTH                 */
         LA    @05,8                                               0084
         LA    @15,IOPTLIST+8                                      0084
         STH   @05,I015F(,@15)                                     0084
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */
         LA    @15,IOPTLIST+24                                     0085
         ST    @15,IOPTLIST+12                                     0085
*     IOPTLIST(5)=ADDR(OPCODE);     /* INSERT NAME POINTER           */
         LA    @15,OPCODE                                          0086
         ST    @15,IOPTLIST+16                                     0086
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0087
*     RFY                                                          0088
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(OPCODE);         /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+20                                     0089
         MVC   I015F(2,@15),@CH00050                               0089
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */
         LA    @15,IOPTLIST+36                                     0090
         ST    @15,IOPTLIST+24                                     0090
*     IOPTLIST(8)=ADDR(RCODE);      /* INSERT NAME POINTER           */
         LA    @15,RCODE                                           0091
         ST    @15,IOPTLIST+28                                     0091
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0092
*     RFY                                                          0093
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(RCODE);          /* INSERT LENGTH                 */
         LA    @15,2                                               0094
         LA    @14,IOPTLIST+32                                     0094
         STH   @15,I015F(,@14)                                     0094
*     IOPTLIST(10)=ADDR(IOPTLIST(13));/* CHAIN TO NEXT INSERT        */
         LA    @14,IOPTLIST+48                                     0095
         ST    @14,IOPTLIST+36                                     0095
*     IOPTLIST(11)=ADDR(REJCODE);   /* INSERT NAME POINTER           */
         LA    @14,REJCODE                                         0096
         ST    @14,IOPTLIST+40                                     0096
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0097
*     RFY                                                          0098
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(REJCODE);        /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+44                                     0099
         STH   @15,I015F(,@14)                                     0099
*     IOPTLIST(13)=ADDR(IOPTLIST(16));/* CHAIN TO NEXT INSERT        */
         LA    @14,IOPTLIST+60                                     0100
         ST    @14,IOPTLIST+48                                     0100
*     IOPTLIST(14)=ADDR(SUBRCOD);   /* INSERT NAME POINTER           */
         LA    @14,SUBRCOD                                         0101
         ST    @14,IOPTLIST+52                                     0101
*     IOPTLIST(15)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+56                                     0102
*     RFY                                                          0103
*       I015F BASED(ADDR(IOPTLIST(15)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(SUBRCOD);        /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+56                                     0104
         STH   @15,I015F(,@14)                                     0104
*     IOPTLIST(16)=ADDR(IOPTLIST(19));/* CHAIN TO NEXT INSERT        */
         LA    @15,IOPTLIST+72                                     0105
         ST    @15,IOPTLIST+60                                     0105
*     IOPTLIST(17)=ADDR(CTEMP18);   /* INSERT NAME POINTER           */
         LA    @15,CTEMP18                                         0106
         ST    @15,IOPTLIST+64                                     0106
*     IOPTLIST(18)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+68                                     0107
*     RFY                                                          0108
*       I015F BASED(ADDR(IOPTLIST(18)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(CTEMP18);        /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+68                                     0109
         STH   @05,I015F(,@15)                                     0109
*     IOPTLIST(19)=0;               /* LAST INSERT                   */
         ST    @10,IOPTLIST+72                                     0110
*     IOPTLIST(20)=ADDR(DMCBDSN);   /* INSERT NAME POINTER           */
         LA    @05,DMCBDSN(,DMCBPTR)                               0111
         ST    @05,IOPTLIST+76                                     0111
*     IOPTLIST(21)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+80                                     0112
*     RFY                                                          0113
*       I015F BASED(ADDR(IOPTLIST(21)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(DMCBDSN);        /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+80                                     0114
         MVC   I015F(2,@10),@CH00121                               0114
*     CALL BLSDMSG0(ZZ2,F3114C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0115
*         IOPTLIST));               /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0115
         ST    @10,@AL00001                                        0115
         LA    @10,@CF00310                                        0115
         ST    @10,@AL00001+4                                      0115
         LA    @10,DMCBMSG(,DMCBPTR)                               0115
         ST    @10,@AL00001+8                                      0115
         L     @10,DMCBMSGS(,DMCBPTR)                              0115
         ST    @10,@AL00001+12                                     0115
         LA    @10,@CB00378                                        0115
         ST    @10,@AL00001+16                                     0115
         LA    @10,IOPTLIST                                        0115
         ST    @10,@AFTEMPS                                        0115
         LA    @10,@AFTEMPS                                        0115
         ST    @10,@AL00001+20                                     0115
         L     @15,DMCBMSG0(,DMCBPTR)                              0115
         LA    @01,@AL00001                                        0115
         BALR  @14,@15                                             0115
*   END;                            /* BLSDMSG                     0116
*                                      (ZZ2,F3114C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDDNM,OPCODE,RCODE,R
*                                      EJCODE,SUBRCOD,CTEMP18,DMCBDSN
*                                      )                             */
*/* BUILD ERROR MESSAGE                                              */
*                                                                  0117
*   CALL VSAMFAIL;                  /* ISSUE THE VSAM FAILURE MESSAGE*/
         BAL   @14,VSAMFAIL                                        0117
*   END VSAM;                       /* DO ERROR ANALYSIS FOR VSAM  0118
*                                      DATA SET TYPE                 */
@EL00002 DS    0H                                                  0118
@EF00002 DS    0H                                                  0118
@ER00002 LM    @14,@12,@SA00002                                    0118
         BR    @14                                                 0118
         EJECT
*                                                                  0119
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO ISSUE THE VSAM FAILURE MESSAGE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0119
*VSAMFAIL:                                                         0119
*   PROCEDURE;                                                     0119
*                                                                  0119
VSAMFAIL STM   @14,@12,@SA00003                                    0119
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE VSAMFAIL PARAMETER LIST                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0120
*   GFPARMS=GFPARMS&&GFPARMS;       /* ZERO THE PARM LIST            */
         XC    GFPARMS(44),GFPARMS                                 0120
*   IF DMCBRQST=DMCBOPR THEN        /* TEST FOR OPEN REQUEST         */
         CLI   DMCBRQST(DMCBPTR),1                                 0121
         BNE   @RF00121                                            0121
*     GFCALLID=GFOPEN;              /* OPEN REQUEST                  */
         MVC   GFCALLID(2),@CH00057                                0122
*   ELSE                                                           0123
*     IF DMCBRQST=DMCBCLR THEN      /* TEST FOR CLOSE REQUEST        */
         B     @RC00121                                            0123
@RF00121 CLI   DMCBRQST(DMCBPTR),2                                 0123
         BNE   @RF00123                                            0123
*       GFCALLID=GFCLOSE;           /* CLOSE REQUEST                 */
         MVC   GFCALLID(2),@CH00074                                0124
*     ELSE                                                         0125
*       IF DMCBRQST=DMCBGER THEN    /* TEST FOR GET REQUEST          */
         B     @RC00123                                            0125
@RF00123 CLI   DMCBRQST(DMCBPTR),4                                 0125
         BNE   @RF00125                                            0125
*         GFCALLID=GFGET;           /* GET REQUEST                   */
         MVC   GFCALLID(2),@CH00050                                0126
*       ELSE                                                       0127
*         IF DMCBRQST=DMCBPUR THEN  /* TEST FOR PUT REQUEST          */
         B     @RC00125                                            0127
@RF00125 CLI   DMCBRQST(DMCBPTR),5                                 0127
         BNE   @RF00127                                            0127
*           GFCALLID=GFPUT;         /* PUT REQUEST                   */
         MVC   GFCALLID(2),@CH00046                                0128
*         ELSE                                                     0129
*           IF DMCBRQST=DMCBERR THEN/* TEST FOR ERASE REQUEST        */
         B     @RC00127                                            0129
@RF00127 CLI   DMCBRQST(DMCBPTR),6                                 0129
         BNE   @RF00129                                            0129
*             GFCALLID=GFERASE;     /* ERASE REQUEST                 */
         MVC   GFCALLID(2),@CH00039                                0130
*           ELSE                                                   0131
*             IF DMCBRQST=DMCBENR THEN/* TEST FOR ENDREQ REQUEST     */
         B     @RC00129                                            0131
@RF00129 CLI   DMCBRQST(DMCBPTR),7                                 0131
         BNE   @RF00131                                            0131
*               GFCALLID=GFENDREQ;  /* ENDREQ REQUEST                */
         MVC   GFCALLID(2),@CH00103                                0132
*             ELSE                                                 0133
*               IF DMCBRQST=DMCBPOR THEN/* TEST FOR POINT REQUEST    */
         B     @RC00131                                            0133
@RF00131 CLI   DMCBRQST(DMCBPTR),8                                 0133
         BNE   @RF00133                                            0133
*                 GFCALLID=GFPOINT; /* POINT REQUEST                 */
         MVC   GFCALLID(2),@CH00081                                0134
*   IF GFCALLID^=0 THEN             /* TEST FOR VALID VSAM OPCODE    */
@RF00133 DS    0H                                                  0135
@RC00131 DS    0H                                                  0135
@RC00129 DS    0H                                                  0135
@RC00127 DS    0H                                                  0135
@RC00125 DS    0H                                                  0135
@RC00123 DS    0H                                                  0135
@RC00121 LH    @10,GFCALLID                                        0135
         LTR   @10,@10                                             0135
         BZ    @RF00135                                            0135
*     DO;                           /* VALID VSAM OPCODE             */
*       IF GFCALLID=GFOPEN×GFCALLID=GFCLOSE THEN/* TEST FOR OPEN OR
*                                      CLOSE                         */
         C     @10,@CF00057                                        0137
         BE    @RT00137                                            0137
         C     @10,@CF00074                                        0137
         BNE   @RF00137                                            0137
@RT00137 DS    0H                                                  0138
*         GFCBPTR=ADDR(DMCBACB);    /* SET ACB POINTER IN PLIST FOR
*                                      OPEN/CLOSE                    */
         LA    @10,DMCBACB(,DMCBPTR)                               0138
         ST    @10,GFCBPTR                                         0138
*       ELSE                                                       0139
*         GFCBPTR=ADDR(DMCBRPL);    /* SET RPL POINTER FOR ALL OTHERS*/
         B     @RC00137                                            0139
@RF00137 LA    @10,DMCBRPL(,DMCBPTR)                               0139
         ST    @10,GFCBPTR                                         0139
*       GFRCODE=DMCBSUBC;           /* VSAM RETURN CODE              */
@RC00137 L     @10,DMCBSUBC(,DMCBPTR)                              0140
         ST    @10,GFRCODE                                         0140
*       GF02PTR=ADDR(BLSCANLI);     /* SET MESSAGE WRITER EP TO IPCS
*                                      DDM MESSAGE WRITER INTERCEPT
*                                      MODULE                        */
         L     @10,@CV00237                                        0141
         ST    @10,GF02PTR                                         0141
*       GFSUBSYS=OFF;               /* NOT SUBSYSTEM ERROR TO BE   0142
*                                      ANALYZED                      */
*       GFKEYN08=OFF;               /* GFKEYN08 CONTROLS THE ISSUANCE
*                                      OF A MODESET. SINCE THE     0143
*                                      MESSAGE WRITER WILL NOT ISSUE
*                                      A PUTLINE AND A PROGRAM NAME
*                                      IS SUPPLIED, THE MODESET IS 0143
*                                      NOT NEEDED TO ACCESS THE TSO
*                                      CPPL AND THE GFCPPLP FIELD MAY
*                                      BE USED TO PASS THE ADDRESS OF
*                                      THE DMCB TO THE BLSCANLI    0143
*                                      MODULE                        */
*       GFWTPSW=OFF;                /* IKJEFF19 MUST THINK THAT IT IS
*                                      ISSUING A PUTLINE OR IT WILL
*                                      NOT COPY THE CONTENTS OF    0144
*                                      GFCPPLP INTO THE MESSAGE    0144
*                                      WRITER PARAMETER LIST. GFCPPLP
*                                      CONTAINS THE ADDRESS OF THE 0144
*                                      DMCB FOR USE BY BLSCANLI. IT
*                                      WILL ZERO THE MTCPPLP FIELD 0144
*                                      AND TURN ON THE MTWTPSW BEFORE
*                                      PASSING THE MESSAGE PLIST TO
*                                      IJKEFF02                      */
         NI    GFSUBSYS,B'00011111'                                0144
*       GFCPPLP=ADDR(DMCB);         /* GET DMCB ADDRESS TO BLSCANLI.
*                                      VSAMFAIL PASSES THIS TO THE 0145
*                                      MESSAGE PLIST IF GFWTPSW IS 0145
*                                      OFF                           */
         ST    DMCBPTR,GFCPPLP                                     0145
*       GFECBP=F0C;                 /* MESSAGE WRITER ECB LIST     0146
*                                      POINTER                       */
         SLR   @10,@10                                             0146
         ST    @10,GFECBP                                          0146
*       GFPGMNL=LENGTH(DMCBMODN);   /* A PROGRAM NAME MUST BE      0147
*                                      SUPPLIED TO PREVENT IKJEFF19
*                                      FROM USING THE VALUE IN     0147
*                                      GFCPPLP AS A POINTER TO THE 0147
*                                      TSO CPPL TO OBTAIN A PROGRAM
*                                      NAME                          */
         MVC   GFPGMNL(2),@CH00046                                 0147
*       GFPGMNP=ADDR(DMCBMODN);     /* ERROR MODULE NAME             */
         LA    @10,DMCBMODN(,DMCBPTR)                              0148
         ST    @10,GFPGMNP                                         0148
*       GFDSNLEN=LENGTH(DMCBDSN);   /* DATA SET NAME LENGTH          */
         MVC   GFDSNLEN(2),@CH00121                                0149
*       GFDSNP=ADDR(DMCBDSN);       /* DATA SET NAME POINTER         */
*                                                                  0150
         LA    @10,DMCBDSN(,DMCBPTR)                               0150
         ST    @10,GFDSNP                                          0150
*       /*************************************************************/
*       /*                                                           */
*       /* DO VSAM ERROR ANALYSIS USING THE VSAMFAIL MODULE          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0151
*       CALL INVVSAMF;              /* INVOKE IKJEFF19 TO DO VSAM  0151
*                                      ERROR ANALYSIS                */
         BAL   @14,INVVSAMF                                        0151
*     END;                          /* VALID VSAM OPCODE             */
*   END VSAMFAIL;                   /* ISSUE VSAM FAILURE MESSAGE    */
@EL00003 DS    0H                                                  0153
@EF00003 DS    0H                                                  0153
@ER00003 LM    @14,@12,@SA00003                                    0153
         BR    @14                                                 0153
         EJECT
*                                                                  0154
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO INVOKE IKJEFF19 TO DO VSAM ERROR ANALYSIS        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0154
*INVVSAMF:                                                         0154
*   PROCEDURE;                      /* INVOKE IKJEFF19 TO DO VSAM  0154
*                                      ERROR ANALYSIS                */
INVVSAMF STM   @14,@12,@SA00004                                    0154
*   GEN FLOWS(LINKERR);                                            0155
*                        /* TELL COMPILER ABOUT
*                                      ERRET(LINKERR) IN LINK MACRO
*   DO;                             /* LINK EP(LINKNAME)           0156
*                                      PARAM(GFPARMS) ERRET(LINKERR) */
*     I00601='00'X;                 /* EP/DE FLAG                    */
         MVI   I00601,X'00'                                        0157
*     I00602=ADDR(LINKNAME);        /* ADDR OF EP/DE                 */
         LA    @10,@CC00334                                        0158
         STCM  @10,7,I00602                                        0158
*     I00604=0;                     /* DCB PTR                       */
         SLR   @10,@10                                             0159
         STCM  @10,7,I00604                                        0159
*     I00603='80'X;                 /* ERRET FLAG                    */
         MVI   I00603,X'80'                                        0160
*     I00605=ADDR(LINKERR);         /* ERRET PTR                     */
         LA    @10,LINKERR                                         0161
         ST    @10,I00605                                          0161
*     IOPTLIST(1)=ADDR(GFPARMS);    /* ADDR OF PROB PROG PARM        */
         LA    @10,GFPARMS                                         0162
         ST    @10,IOPTLIST                                        0162
*     IOPTLIST(1)=IOPTLIST(1)×'80000000'X;/* SET VL BIT              */
         O     @10,@CF00297                                        0163
         ST    @10,IOPTLIST                                        0163
*     RESPECIFY                                                    0164
*      (GPR01P) RESTRICTED;                                        0164
*     GPR01P=ADDR(IOPTLIST);        /* ADDR OF OPTLIST               */
         LA    GPR01P,IOPTLIST                                     0165
*     RESPECIFY                                                    0166
*      (GPR15P) RESTRICTED;                                        0166
*     GPR15P=ADDR(I006);            /* ADDR OF LINK LIST             */
         LA    GPR15P,I006                                         0167
*     SVC(6);                       /* ISSUE LINK SVC                */
         SVC   6                                                   0168
*     RESPECIFY                                                    0169
*      (GPR01P) UNRESTRICTED;                                      0169
*     RESPECIFY                                                    0170
*      (GPR15P) UNRESTRICTED;                                      0170
*   END;                            /* LINK EP(LINKNAME)           0171
*                                      PARAM(GFPARMS) ERRET(LINKERR)
*                                      DO VSAM ERROR ANALYSIS        */
*   RFY                                                            0172
*     GPR15F RSTD;                                                 0172
*   SUBCODE=GPR15F;                 /* SAVE THE RETURN CODE          */
         ST    GPR15F,SUBCODE                                      0173
*   RFY                                                            0174
*     GPR15F UNRSTD;                                               0174
*   IF SUBCODE^=0 THEN              /* TEST FOR IKJEFF19 ERROR       */
         L     @10,SUBCODE                                         0175
         LTR   @10,@10                                             0175
         BZ    @RF00175                                            0175
*     DO;                           /* IKJEFF19 ERROR                */
*       RETCODE=ERROR;              /* FORCE ERROR TO CALLER         */
         MVC   RETCODE(4),@CF00046                                 0177
*     END;                          /* IKJEFF19 ERROR                */
*   RETURN;                                                        0179
@EL00004 DS    0H                                                  0179
@EF00004 DS    0H                                                  0179
@ER00004 LM    @14,@12,@SA00004                                    0179
         BR    @14                                                 0179
         EJECT
*                                                                  0180
*/* START OF SPECIFICATIONS*******************************************/
*/*                                                                  */
*/*   MODULE NAME:  LINKERR (BLSCLKR)                                */
*/*                                                                  */
*/*   DESCRIPTIVE NAME:  IPCS DAS LINK SVC ERROR RETURN ROUTINE      */
*/*                                                                  */
*/*   COPYRIGHT: NONE                                                */
*/*                                                                  */
*/*   STATUS: SU57 RELEASE 1, LEVEL 0                                */
*/*                                                                  */
*/*   FUNCTION:                                                      */
*/*     PROVIDE INCLUDED CODE FOR A LINK SVC ERROR RETURN THAT       */
*/*     PRODUCES MESSAGE BLS03110 AND HOOKS IT TO THE DMCBMSG        */
*/*     MESSAGE CHAIN ANCHOR.                                        */
*/*                                                                  */
*/*   NOTES:                                                         */
*/*                                                                  */
*/*     DEPENDENCIES:                                                */
*/*       THE FOLLOWING SYMBOLS MUST BE DEFINED IN THE ENCLOSING     */
*/*       PROCEDURE:                                                 */
*/*          RETCODE                                                 */
*/*          SUBCODE                                                 */
*/*          ERROR                                                   */
*/*          GPR01F                                                  */
*/*          GPR15F                                                  */
*/*          ABENDC                                                  */
*/*          REASON                                                  */
*/*          RESULT                                                  */
*/*          MODNAME                                                 */
*/*          LINKNAME                                                */
*/*          CHSTR88                                                 */
*/*          CHSTR847                                                */
*/*          CTEMP                                                   */
*/*          CTEMP18                                                 */
*/*          HEXTBL                                                  */
*/*          HEX0FC                                                  */
*/*          F3110C                                                  */
*/*                                                                  */
*/*     RESTRICTIONS:   NONE                                         */
*/*                                                                  */
*/*     REGISTER CONVENTIONS:                                        */
*/*       GPR01F - (1)                                               */
*/*       GPR15F - (15)                                              */
*/*                                                                  */
*/*     PATCH LABEL:  N/A                                            */
*/*                                                                  */
*/*     SERIALIZATION REQUIREMENTS: NONE                             */
*/*                                                                  */
*/*   MODULE TYPE:  INCLUDED EXECUTABLE CODE                         */
*/*                                                                  */
*/*     PROCESSOR: PLS/2                                             */
*/*                                                                  */
*/*     MODULE SIZE: N/A                                             */
*/*                                                                  */
*/*     ATTRIBUTES:                                                  */
*/*      EXECUTABLE          PROBLEM STATE      REENTRANT            */
*/*                                                                  */
*/*   ENTRY POINT:  LINKERR                                          */
*/*                                                                  */
*/*     PURPOSE:  SEE FUNCTION                                       */
*/*                                                                  */
*/*     LINKAGE:                                                     */
*/*       R01 LOADED WITH ABEND CODE                                 */
*/*       R15 LOADED WITH ABEND REASON CODE                          */
*/*                                                                  */
*/*     METHOD OF ACCESS:  SYSTEM LINK SVC ERRET                     */
*/*                                                                  */
*/*   INPUT:  SEE LINKAGE                                            */
*/*                                                                  */
*/*   OUTPUT:                                                        */
*/*      MESSAGE BLS03110 CHAINED FROM DMCBMSG IN IPCS DM/PM FORMAT. */
*/*      THE OUTPUT MESSAGE LIST FORMAT IS DESCRIBED IN THE BLSDMSG0 */
*/*      MODULE DESCRIPTION.                                         */
*/*                                                                  */
*/*   EXIT-NORMAL:  RETURN TO LINK SVC                               */
*/*     RETCODE = 8   MESSAGE BLS03110 IS ISSUED.                    */
*/*                                                                  */
*/*   EXIT-ERROR:  NONE                                              */
*/*                                                                  */
*/*   EXTERNAL REFERENCES:                                           */
*/*                                                                  */
*/*     ROUTINES:                                                    */
*/*       BLSDMSG0      IPCS DM/PM MESSAGE TEXT BUILD FUNCTION       */
*/*                                                                  */
*/*     DATA AREAS: SEE SYMBOLS DEFINED UNDER DEPENDENCIES           */
*/*                                                                  */
*/*     CONTROL BLOCKS: DMCB      R,W                                */
*/*                     BLSDMSGS  R                                  */
*/*                     ZZ2       R                                  */
*/*                                                                  */
*/*   TABLES/WORKAREAS: NONE                                         */
*/*                                                                  */
*/*   MACROS: BLSDMSG                                                */
*/*                                                                  */
*/*   CHANGE ACTIVITY:                                               */
*/*     THIS MODULE IS WRITTEN FOR @G57LPSR.                         */
*/*                                                                  */
*/*   MESSAGES ISSUED:                                               */
*/*        BLS03110I LINK SVC TO LINKNAME FROM MODNAME FAILED.       */
*/*                  ABEND CODE=XXXXXXXX, REASON CODE=YYYYYYYY       */
*/*                                                                  */
*/*   ABEND CODES:  NONE                                             */
*/*                                                                  */
*/*   DATA SETS ACCESSED:  NONE                                      */
*/*                                                                  */
*/*** END OF SPECIFICATIONS*******************************************/
*                                                                  0180
*LINKERR:                                                          0180
*   RFY                                                            0180
*    (GPR01F,                                                      0180
*     GPR15F) RSTD;                                                0180
LINKERR  DS    0H                                                  0181
*   ABENDC=GPR01F;                  /* SAVE THE ABEND CODE           */
         LR    ABENDC,GPR01F                                       0181
*   REASON=GPR15F;                  /* SAVE THE ABEND REASON CODE    */
         LR    REASON,GPR15F                                       0182
*   RFY                                                            0183
*    (GPR01F,                                                      0183
*     GPR15F) UNRSTD;                                              0183
*   CHSTR847=ABENDC;                /* GET ABEND CODE FIELD          */
         STCM  ABENDC,15,CHSTR847                                  0184
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0185
*   UNPK(CTEMP,CHSTR8);                                            0186
         UNPK  CTEMP(9),CHSTR8(8)                                  0186
*   TR(CTEMP,HEXTBL);                                              0187
         TR    CTEMP(9),HEXTBL                                     0187
*   RESULT=CTEMP18;                 /* STORE THE RESULT              */
         MVC   RESULT(8),CTEMP18                                   0188
*   CHSTR847=REASON;                /* GET REASON CODE FIELD         */
         STCM  REASON,15,CHSTR847                                  0189
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0190
*   UNPK(CTEMP,CHSTR8);                                            0191
         UNPK  CTEMP(9),CHSTR8(8)                                  0191
*   TR(CTEMP,HEXTBL);                                              0192
         TR    CTEMP(9),HEXTBL                                     0192
*   DO;                             /* BLSDMSG                     0193
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)
*                                      INSERT(LINKNAME,MODNAME,RESULT
*                                      ,CTEMP18)                     */
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */
         LA    @10,IOPTLIST+12                                     0194
         ST    @10,IOPTLIST                                        0194
*     IOPTLIST(2)=ADDR(LINKNAME);   /* INSERT NAME POINTER           */
         LA    @10,@CC00334                                        0195
         ST    @10,IOPTLIST+4                                      0195
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0196
         ST    @10,IOPTLIST+8                                      0196
*     RFY                                                          0197
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(LINKNAME);       /* INSERT LENGTH                 */
         LA    @05,8                                               0198
         LA    @15,IOPTLIST+8                                      0198
         STH   @05,I015F(,@15)                                     0198
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */
         LA    @15,IOPTLIST+24                                     0199
         ST    @15,IOPTLIST+12                                     0199
*     IOPTLIST(5)=ADDR(MODNAME);    /* INSERT NAME POINTER           */
         LA    @15,MODNAME                                         0200
         ST    @15,IOPTLIST+16                                     0200
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0201
*     RFY                                                          0202
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(MODNAME);        /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+20                                     0203
         STH   @05,I015F(,@15)                                     0203
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */
         LA    @15,IOPTLIST+36                                     0204
         ST    @15,IOPTLIST+24                                     0204
*     IOPTLIST(8)=ADDR(RESULT);     /* INSERT NAME POINTER           */
         LA    @15,RESULT                                          0205
         ST    @15,IOPTLIST+28                                     0205
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0206
*     RFY                                                          0207
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(RESULT);         /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+32                                     0208
         STH   @05,I015F(,@15)                                     0208
*     IOPTLIST(10)=0;               /* LAST INSERT                   */
         ST    @10,IOPTLIST+36                                     0209
*     IOPTLIST(11)=ADDR(CTEMP18);   /* INSERT NAME POINTER           */
         LA    @15,CTEMP18                                         0210
         ST    @15,IOPTLIST+40                                     0210
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0211
*     RFY                                                          0212
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(CTEMP18);        /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+44                                     0213
         STH   @05,I015F(,@10)                                     0213
*     CALL BLSDMSG0(ZZ2,F3110C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0214
*         IOPTLIST));               /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0214
         ST    @10,@AL00001                                        0214
         LA    @10,@CF00308                                        0214
         ST    @10,@AL00001+4                                      0214
         LA    @10,DMCBMSG(,DMCBPTR)                               0214
         ST    @10,@AL00001+8                                      0214
         L     @10,DMCBMSGS(,DMCBPTR)                              0214
         ST    @10,@AL00001+12                                     0214
         LA    @10,@CB00378                                        0214
         ST    @10,@AL00001+16                                     0214
         LA    @10,IOPTLIST                                        0214
         ST    @10,@AFTEMPS+4                                      0214
         LA    @10,@AFTEMPS+4                                      0214
         ST    @10,@AL00001+20                                     0214
         L     @15,DMCBMSG0(,DMCBPTR)                              0214
         LA    @01,@AL00001                                        0214
         BALR  @14,@15                                             0214
*   END;                            /* BLSDMSG                     0215
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)
*                                      INSERT(LINKNAME,MODNAME,RESULT
*                                      ,CTEMP18) BUILD LINK SVC ERROR
*                                      MESSAGE                       */
*   RETCODE=ERROR;                  /* MARK ERROR TO CALLER          */
         MVC   RETCODE(4),@CF00046                                 0216
*   END INVVSAMF;                   /* INVOKE IKJEFF19 TO DO VSAM  0217
*                                      ERROR ANALYSIS                */
         B     @EL00004                                            0217
         EJECT
*                                                                  0218
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO DO ERROR ANALYSIS FOR NON-VSAM DATA SET          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0218
*NONVSAM:                                                          0218
*   PROCEDURE;                      /* DO ERROR ANALYSIS FOR NON-VSAM
*                                      DATA SET                      */
*                                                                  0218
NONVSAM  STM   @14,@12,@SA00005                                    0218
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE IPCS NON-VSAM BASIC DATA ACCESS ERROR MESSAGE       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0219
*   CHSTR847=DMCBCPC;               /* I/O OP ABEND CODE             */
         MVC   CHSTR847(4),DMCBCPC(DMCBPTR)                        0219
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0220
*   UNPK(CTEMP,CHSTR8);                                            0221
         UNPK  CTEMP(9),CHSTR8(8)                                  0221
*   TR(CTEMP,HEXTBL);                                              0222
         TR    CTEMP(9),HEXTBL                                     0222
*   RESULT=CTEMP18;                 /* SAVE THE ABEND CODE           */
         MVC   RESULT(8),CTEMP18                                   0223
*   CHSTR847=DMCBDCBE;              /* I/O OP ABEND REASON CODE      */
         MVC   CHSTR847(4),DMCBDCBE(DMCBPTR)                       0224
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0225
*   UNPK(CTEMP,CHSTR8);                                            0226
         UNPK  CTEMP(9),CHSTR8(8)                                  0226
*   TR(CTEMP,HEXTBL);                                              0227
         TR    CTEMP(9),HEXTBL                                     0227
*   DO;                             /* BLSDMSG                     0228
*                                      (ZZ2,F3116C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDDNM,OPCODE,RCODE,R
*                                      EJCODE,RESULT,CTEMP18,DMCBDSN)*/
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */
         LA    @10,IOPTLIST+12                                     0229
         ST    @10,IOPTLIST                                        0229
*     IOPTLIST(2)=ADDR(DMCBDDNM);   /* INSERT NAME POINTER           */
         LA    @10,DMCBDDNM(,DMCBPTR)                              0230
         ST    @10,IOPTLIST+4                                      0230
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0231
         ST    @10,IOPTLIST+8                                      0231
*     RFY                                                          0232
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(DMCBDDNM);       /* INSERT LENGTH                 */
         LA    @05,8                                               0233
         LA    @15,IOPTLIST+8                                      0233
         STH   @05,I015F(,@15)                                     0233
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */
         LA    @15,IOPTLIST+24                                     0234
         ST    @15,IOPTLIST+12                                     0234
*     IOPTLIST(5)=ADDR(OPCODE);     /* INSERT NAME POINTER           */
         LA    @15,OPCODE                                          0235
         ST    @15,IOPTLIST+16                                     0235
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0236
*     RFY                                                          0237
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(OPCODE);         /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+20                                     0238
         MVC   I015F(2,@15),@CH00050                               0238
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */
         LA    @15,IOPTLIST+36                                     0239
         ST    @15,IOPTLIST+24                                     0239
*     IOPTLIST(8)=ADDR(RCODE);      /* INSERT NAME POINTER           */
         LA    @15,RCODE                                           0240
         ST    @15,IOPTLIST+28                                     0240
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0241
*     RFY                                                          0242
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(RCODE);          /* INSERT LENGTH                 */
         LA    @15,2                                               0243
         LA    @14,IOPTLIST+32                                     0243
         STH   @15,I015F(,@14)                                     0243
*     IOPTLIST(10)=ADDR(IOPTLIST(13));/* CHAIN TO NEXT INSERT        */
         LA    @14,IOPTLIST+48                                     0244
         ST    @14,IOPTLIST+36                                     0244
*     IOPTLIST(11)=ADDR(REJCODE);   /* INSERT NAME POINTER           */
         LA    @14,REJCODE                                         0245
         ST    @14,IOPTLIST+40                                     0245
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0246
*     RFY                                                          0247
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(REJCODE);        /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+44                                     0248
         STH   @15,I015F(,@14)                                     0248
*     IOPTLIST(13)=ADDR(IOPTLIST(16));/* CHAIN TO NEXT INSERT        */
         LA    @15,IOPTLIST+60                                     0249
         ST    @15,IOPTLIST+48                                     0249
*     IOPTLIST(14)=ADDR(RESULT);    /* INSERT NAME POINTER           */
         LA    @15,RESULT                                          0250
         ST    @15,IOPTLIST+52                                     0250
*     IOPTLIST(15)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+56                                     0251
*     RFY                                                          0252
*       I015F BASED(ADDR(IOPTLIST(15)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(RESULT);         /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+56                                     0253
         STH   @05,I015F(,@15)                                     0253
*     IOPTLIST(16)=ADDR(IOPTLIST(19));/* CHAIN TO NEXT INSERT        */
         LA    @15,IOPTLIST+72                                     0254
         ST    @15,IOPTLIST+60                                     0254
*     IOPTLIST(17)=ADDR(CTEMP18);   /* INSERT NAME POINTER           */
         LA    @15,CTEMP18                                         0255
         ST    @15,IOPTLIST+64                                     0255
*     IOPTLIST(18)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+68                                     0256
*     RFY                                                          0257
*       I015F BASED(ADDR(IOPTLIST(18)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(CTEMP18);        /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+68                                     0258
         STH   @05,I015F(,@15)                                     0258
*     IOPTLIST(19)=0;               /* LAST INSERT                   */
         ST    @10,IOPTLIST+72                                     0259
*     IOPTLIST(20)=ADDR(DMCBDSN);   /* INSERT NAME POINTER           */
         LA    @05,DMCBDSN(,DMCBPTR)                               0260
         ST    @05,IOPTLIST+76                                     0260
*     IOPTLIST(21)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+80                                     0261
*     RFY                                                          0262
*       I015F BASED(ADDR(IOPTLIST(21)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(DMCBDSN);        /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+80                                     0263
         MVC   I015F(2,@10),@CH00121                               0263
*     CALL BLSDMSG0(ZZ2,F3116C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0264
*         IOPTLIST));               /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0264
         ST    @10,@AL00001                                        0264
         LA    @10,@CF00314                                        0264
         ST    @10,@AL00001+4                                      0264
         LA    @10,DMCBMSG(,DMCBPTR)                               0264
         ST    @10,@AL00001+8                                      0264
         L     @10,DMCBMSGS(,DMCBPTR)                              0264
         ST    @10,@AL00001+12                                     0264
         LA    @10,@CB00378                                        0264
         ST    @10,@AL00001+16                                     0264
         LA    @10,IOPTLIST                                        0264
         ST    @10,@AFTEMPS+8                                      0264
         LA    @10,@AFTEMPS+8                                      0264
         ST    @10,@AL00001+20                                     0264
         L     @15,DMCBMSG0(,DMCBPTR)                              0264
         LA    @01,@AL00001                                        0264
         BALR  @14,@15                                             0264
*   END;                            /* BLSDMSG                     0265
*                                      (ZZ2,F3116C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDDNM,OPCODE,RCODE,R
*                                      EJCODE,RESULT,CTEMP18,DMCBDSN)*/
*/* BUILD ERROR MESSAGE                                              */
*                                                                  0266
*   IF DMCBRQST=DMCBOPR×DMCBRQST=DMCBCLR THEN/* TEST FOR OPEN OR   0266
*                                      CLOSE                         */
         CLI   DMCBRQST(DMCBPTR),1                                 0266
         BE    @RT00266                                            0266
         CLI   DMCBRQST(DMCBPTR),2                                 0266
         BNE   @RF00266                                            0266
@RT00266 DS    0H                                                  0267
*     DO;                           /* NON-VSAM OPEN OR CLOSE        */
*     END;                          /* NON-VSAM OPEN OR CLOSE        */
*   ELSE                                                           0269
*     DO;                           /* NON-VSAM DATA OPERATION       */
         B     @RC00266                                            0269
@RF00266 DS    0H                                                  0270
*       IF DMCBRTC=12 THEN          /* TEST FOR SYNAD ERROR          */
         CLC   DMCBRTC(4,DMCBPTR),@CF00244                         0270
         BNE   @RF00270                                            0270
*         DO;                       /* ISSUE SYNAD ERROR MESSAGE     */
*           CALL SYNADERR;          /* ISSUE THE SYNAD ERROR MESSAGE */
         BAL   @14,SYNADERR                                        0272
*         END;                      /* ISSUE SYNAD ERROR MESSAGE     */
*     END;                          /* NON-VSAM DATA OPERATION       */
*   END NONVSAM;                                                   0275
@EL00005 DS    0H                                                  0275
@EF00005 DS    0H                                                  0275
@ER00005 LM    @14,@12,@SA00005                                    0275
         BR    @14                                                 0275
         EJECT
*                                                                  0276
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO ISSUE THE NON-VSAM SYNAD ERROR MESSAGE           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0276
*SYNADERR:                                                         0276
*   PROCEDURE;                                                     0276
*                                                                  0276
SYNADERR STM   @14,@12,@SA00006                                    0276
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNAD MESSAGE FOR UNIT RECORD DEVICE TYPE                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0277
*   IF SYNDDVTY=LURC THEN           /* TEST FOR UNIT RECORD ERROR    */
         CLC   SYNDDVTY(2,DMCBPTR),@CC00332                        0277
         BNE   @RF00277                                            0277
*     DO;                           /* HANDLE UNIT RECORD CASE       */
*       DO;                         /* BLSDMSG                     0279
*                                      (ZZ2,F3115C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDSN,LNAC,SYNDSTEP,S
*                                      YNDUA,SYNDDVTY,SYNDDDNM,SYNDOP
*                                      N,SYNDERDS,SYNDDACM,LNAC)     */
*         IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT      */
         LA    @10,IOPTLIST+12                                     0280
         ST    @10,IOPTLIST                                        0280
*         IOPTLIST(2)=ADDR(DMCBDSN);/* INSERT NAME POINTER           */
         LA    @10,DMCBDSN(,DMCBPTR)                               0281
         ST    @10,IOPTLIST+4                                      0281
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0282
         ST    @10,IOPTLIST+8                                      0282
*         RFY                                                      0283
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(DMCBDSN);    /* INSERT LENGTH                 */
         LA    @05,IOPTLIST+8                                      0284
         MVC   I015F(2,@05),@CH00121                               0284
*         IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT      */
         LA    @05,IOPTLIST+24                                     0285
         ST    @05,IOPTLIST+12                                     0285
*         IOPTLIST(5)=ADDR(LNAC);   /* INSERT NAME POINTER           */
         LA    @05,@CC00326                                        0286
         ST    @05,IOPTLIST+16                                     0286
*         IOPTLIST(6)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0287
*         RFY                                                      0288
*           I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(LNAC);       /* INSERT LENGTH                 */
         LA    @15,3                                               0289
         LA    @14,IOPTLIST+20                                     0289
         STH   @15,I015F(,@14)                                     0289
*         IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT     */
         LA    @14,IOPTLIST+36                                     0290
         ST    @14,IOPTLIST+24                                     0290
*         IOPTLIST(8)=ADDR(SYNDSTEP);/* INSERT NAME POINTER          */
         LA    @14,SYNDSTEP(,DMCBPTR)                              0291
         ST    @14,IOPTLIST+28                                     0291
*         IOPTLIST(9)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0292
*         RFY                                                      0293
*           I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(SYNDSTEP);   /* INSERT LENGTH                 */
         LA    @14,8                                               0294
         LA    @09,IOPTLIST+32                                     0294
         STH   @14,I015F(,@09)                                     0294
*         IOPTLIST(10)=ADDR(IOPTLIST(13));/* CHAIN TO NEXT INSERT    */
         LA    @09,IOPTLIST+48                                     0295
         ST    @09,IOPTLIST+36                                     0295
*         IOPTLIST(11)=ADDR(SYNDUA);/* INSERT NAME POINTER           */
         LA    @09,SYNDUA(,DMCBPTR)                                0296
         ST    @09,IOPTLIST+40                                     0296
*         IOPTLIST(12)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0297
*         RFY                                                      0298
*           I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDUA);     /* INSERT LENGTH                 */
         LA    @09,IOPTLIST+44                                     0299
         STH   @15,I015F(,@09)                                     0299
*         IOPTLIST(13)=ADDR(IOPTLIST(16));/* CHAIN TO NEXT INSERT    */
         LA    @09,IOPTLIST+60                                     0300
         ST    @09,IOPTLIST+48                                     0300
*         IOPTLIST(14)=ADDR(SYNDDVTY);/* INSERT NAME POINTER         */
         LA    @09,SYNDDVTY(,DMCBPTR)                              0301
         ST    @09,IOPTLIST+52                                     0301
*         IOPTLIST(15)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+56                                     0302
*         RFY                                                      0303
*           I015F BASED(ADDR(IOPTLIST(15)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDVTY);   /* INSERT LENGTH                 */
         LA    @09,IOPTLIST+56                                     0304
         MVC   I015F(2,@09),@CH00074                               0304
*         IOPTLIST(16)=ADDR(IOPTLIST(19));/* CHAIN TO NEXT INSERT    */
         LA    @09,IOPTLIST+72                                     0305
         ST    @09,IOPTLIST+60                                     0305
*         IOPTLIST(17)=ADDR(SYNDDDNM);/* INSERT NAME POINTER         */
         LA    @09,SYNDDDNM(,DMCBPTR)                              0306
         ST    @09,IOPTLIST+64                                     0306
*         IOPTLIST(18)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+68                                     0307
*         RFY                                                      0308
*           I015F BASED(ADDR(IOPTLIST(18)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDDNM);   /* INSERT LENGTH                 */
         LA    @09,IOPTLIST+68                                     0309
         STH   @14,I015F(,@09)                                     0309
*         IOPTLIST(19)=ADDR(IOPTLIST(22));/* CHAIN TO NEXT INSERT    */
         LA    @14,IOPTLIST+84                                     0310
         ST    @14,IOPTLIST+72                                     0310
*         IOPTLIST(20)=ADDR(SYNDOPN);/* INSERT NAME POINTER          */
         LA    @14,SYNDOPN(,DMCBPTR)                               0311
         ST    @14,IOPTLIST+76                                     0311
*         IOPTLIST(21)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+80                                     0312
*         RFY                                                      0313
*           I015F BASED(ADDR(IOPTLIST(21)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDOPN);    /* INSERT LENGTH                 */
         LA    @14,6                                               0314
         LA    @09,IOPTLIST+80                                     0314
         STH   @14,I015F(,@09)                                     0314
*         IOPTLIST(22)=ADDR(IOPTLIST(25));/* CHAIN TO NEXT INSERT    */
         LA    @09,IOPTLIST+96                                     0315
         ST    @09,IOPTLIST+84                                     0315
*         IOPTLIST(23)=ADDR(SYNDERDS);/* INSERT NAME POINTER         */
         LA    @09,SYNDERDS(,DMCBPTR)                              0316
         ST    @09,IOPTLIST+88                                     0316
*         IOPTLIST(24)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+92                                     0317
*         RFY                                                      0318
*           I015F BASED(ADDR(IOPTLIST(24)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDERDS);   /* INSERT LENGTH                 */
         LA    @09,IOPTLIST+92                                     0319
         MVC   I015F(2,@09),@CH00143                               0319
*         IOPTLIST(25)=ADDR(IOPTLIST(28));/* CHAIN TO NEXT INSERT    */
         LA    @09,IOPTLIST+108                                    0320
         ST    @09,IOPTLIST+96                                     0320
*         IOPTLIST(26)=ADDR(SYNDDACM);/* INSERT NAME POINTER         */
         LA    @09,SYNDDACM(,DMCBPTR)                              0321
         ST    @09,IOPTLIST+100                                    0321
*         IOPTLIST(27)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+104                                    0322
*         RFY                                                      0323
*           I015F BASED(ADDR(IOPTLIST(27)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDACM);   /* INSERT LENGTH                 */
         LA    @09,IOPTLIST+104                                    0324
         STH   @14,I015F(,@09)                                     0324
*         IOPTLIST(28)=0;           /* LAST INSERT                   */
         ST    @10,IOPTLIST+108                                    0325
*         IOPTLIST(29)=ADDR(LNAC);  /* INSERT NAME POINTER           */
         ST    @05,IOPTLIST+112                                    0326
*         IOPTLIST(30)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+116                                    0327
*         RFY                                                      0328
*           I015F BASED(ADDR(IOPTLIST(30)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(LNAC);       /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+116                                    0329
         STH   @15,I015F(,@10)                                     0329
*         CALL BLSDMSG0(ZZ2,F3115C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(
*             IOPTLIST));           /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0330
         ST    @10,@AL00001                                        0330
         LA    @10,@CF00312                                        0330
         ST    @10,@AL00001+4                                      0330
         LA    @10,DMCBMSG(,DMCBPTR)                               0330
         ST    @10,@AL00001+8                                      0330
         L     @10,DMCBMSGS(,DMCBPTR)                              0330
         ST    @10,@AL00001+12                                     0330
         LA    @10,@CB00378                                        0330
         ST    @10,@AL00001+16                                     0330
         LA    @10,IOPTLIST                                        0330
         ST    @10,@AFTEMPS+12                                     0330
         LA    @10,@AFTEMPS+12                                     0330
         ST    @10,@AL00001+20                                     0330
         L     @15,DMCBMSG0(,DMCBPTR)                              0330
         LA    @01,@AL00001                                        0330
         BALR  @14,@15                                             0330
*       END;                        /* BLSDMSG                     0331
*                                      (ZZ2,F3115C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDSN,LNAC,SYNDSTEP,S
*                                      YNDUA,SYNDDVTY,SYNDDDNM,SYNDOP
*                                      N,SYNDERDS,SYNDDACM,LNAC)   0331
*                                      BUILD ERROR MESSAGE           */
*     END;                          /* HANDLE UNIT RECORD CASE       */
         EJECT
*                                                                  0333
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNAD MESSAGE FOR TAPE DEVICE TYPE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0333
*   IF SYNDDVTY=LTAC THEN           /* TEST FOR TAPE ERROR           */
@RF00277 CLC   SYNDDVTY(2,DMCBPTR),@CC00330                        0333
         BNE   @RF00333                                            0333
*     DO;                           /* HANDLE TAPE DEVICE CASE       */
*       DO;                         /* BLSDMSG                     0335
*                                      (ZZ2,F3115C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDSN,DMCBVOL,SYNDSTE
*                                      P,SYNDUA,SYNDDVTY,SYNDDDNM,SYN
*                                      DOPN,SYNDERDS,SYNDTACM,SYNDTBL
*                                      K)                            */
*         IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT      */
         LA    @10,IOPTLIST+12                                     0336
         ST    @10,IOPTLIST                                        0336
*         IOPTLIST(2)=ADDR(DMCBDSN);/* INSERT NAME POINTER           */
         LA    @10,DMCBDSN(,DMCBPTR)                               0337
         ST    @10,IOPTLIST+4                                      0337
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0338
         ST    @10,IOPTLIST+8                                      0338
*         RFY                                                      0339
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(DMCBDSN);    /* INSERT LENGTH                 */
         LA    @05,IOPTLIST+8                                      0340
         MVC   I015F(2,@05),@CH00121                               0340
*         IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT      */
         LA    @05,IOPTLIST+24                                     0341
         ST    @05,IOPTLIST+12                                     0341
*         IOPTLIST(5)=ADDR(DMCBVOL);/* INSERT NAME POINTER           */
         LA    @05,DMCBVOL(,DMCBPTR)                               0342
         ST    @05,IOPTLIST+16                                     0342
*         IOPTLIST(6)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0343
*         RFY                                                      0344
*           I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(DMCBVOL);    /* INSERT LENGTH                 */
         LA    @05,6                                               0345
         LA    @15,IOPTLIST+20                                     0345
         STH   @05,I015F(,@15)                                     0345
*         IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT     */
         LA    @15,IOPTLIST+36                                     0346
         ST    @15,IOPTLIST+24                                     0346
*         IOPTLIST(8)=ADDR(SYNDSTEP);/* INSERT NAME POINTER          */
         LA    @15,SYNDSTEP(,DMCBPTR)                              0347
         ST    @15,IOPTLIST+28                                     0347
*         IOPTLIST(9)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0348
*         RFY                                                      0349
*           I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(SYNDSTEP);   /* INSERT LENGTH                 */
         LA    @15,8                                               0350
         LA    @14,IOPTLIST+32                                     0350
         STH   @15,I015F(,@14)                                     0350
*         IOPTLIST(10)=ADDR(IOPTLIST(13));/* CHAIN TO NEXT INSERT    */
         LA    @14,IOPTLIST+48                                     0351
         ST    @14,IOPTLIST+36                                     0351
*         IOPTLIST(11)=ADDR(SYNDUA);/* INSERT NAME POINTER           */
         LA    @14,SYNDUA(,DMCBPTR)                                0352
         ST    @14,IOPTLIST+40                                     0352
*         IOPTLIST(12)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0353
*         RFY                                                      0354
*           I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDUA);     /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+44                                     0355
         MVC   I015F(2,@14),@CH00103                               0355
*         IOPTLIST(13)=ADDR(IOPTLIST(16));/* CHAIN TO NEXT INSERT    */
         LA    @14,IOPTLIST+60                                     0356
         ST    @14,IOPTLIST+48                                     0356
*         IOPTLIST(14)=ADDR(SYNDDVTY);/* INSERT NAME POINTER         */
         LA    @14,SYNDDVTY(,DMCBPTR)                              0357
         ST    @14,IOPTLIST+52                                     0357
*         IOPTLIST(15)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+56                                     0358
*         RFY                                                      0359
*           I015F BASED(ADDR(IOPTLIST(15)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDVTY);   /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+56                                     0360
         MVC   I015F(2,@14),@CH00074                               0360
*         IOPTLIST(16)=ADDR(IOPTLIST(19));/* CHAIN TO NEXT INSERT    */
         LA    @14,IOPTLIST+72                                     0361
         ST    @14,IOPTLIST+60                                     0361
*         IOPTLIST(17)=ADDR(SYNDDDNM);/* INSERT NAME POINTER         */
         LA    @14,SYNDDDNM(,DMCBPTR)                              0362
         ST    @14,IOPTLIST+64                                     0362
*         IOPTLIST(18)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+68                                     0363
*         RFY                                                      0364
*           I015F BASED(ADDR(IOPTLIST(18)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDDNM);   /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+68                                     0365
         STH   @15,I015F(,@14)                                     0365
*         IOPTLIST(19)=ADDR(IOPTLIST(22));/* CHAIN TO NEXT INSERT    */
         LA    @15,IOPTLIST+84                                     0366
         ST    @15,IOPTLIST+72                                     0366
*         IOPTLIST(20)=ADDR(SYNDOPN);/* INSERT NAME POINTER          */
         LA    @15,SYNDOPN(,DMCBPTR)                               0367
         ST    @15,IOPTLIST+76                                     0367
*         IOPTLIST(21)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+80                                     0368
*         RFY                                                      0369
*           I015F BASED(ADDR(IOPTLIST(21)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDOPN);    /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+80                                     0370
         STH   @05,I015F(,@15)                                     0370
*         IOPTLIST(22)=ADDR(IOPTLIST(25));/* CHAIN TO NEXT INSERT    */
         LA    @15,IOPTLIST+96                                     0371
         ST    @15,IOPTLIST+84                                     0371
*         IOPTLIST(23)=ADDR(SYNDERDS);/* INSERT NAME POINTER         */
         LA    @15,SYNDERDS(,DMCBPTR)                              0372
         ST    @15,IOPTLIST+88                                     0372
*         IOPTLIST(24)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+92                                     0373
*         RFY                                                      0374
*           I015F BASED(ADDR(IOPTLIST(24)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDERDS);   /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+92                                     0375
         MVC   I015F(2,@15),@CH00143                               0375
*         IOPTLIST(25)=ADDR(IOPTLIST(28));/* CHAIN TO NEXT INSERT    */
         LA    @15,IOPTLIST+108                                    0376
         ST    @15,IOPTLIST+96                                     0376
*         IOPTLIST(26)=ADDR(SYNDTACM);/* INSERT NAME POINTER         */
         LA    @15,SYNDTACM(,DMCBPTR)                              0377
         ST    @15,IOPTLIST+100                                    0377
*         IOPTLIST(27)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+104                                    0378
*         RFY                                                      0379
*           I015F BASED(ADDR(IOPTLIST(27)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDTACM);   /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+104                                    0380
         STH   @05,I015F(,@15)                                     0380
*         IOPTLIST(28)=0;           /* LAST INSERT                   */
         ST    @10,IOPTLIST+108                                    0381
*         IOPTLIST(29)=ADDR(SYNDTBLK);/* INSERT NAME POINTER         */
         LA    @05,SYNDTBLK(,DMCBPTR)                              0382
         ST    @05,IOPTLIST+112                                    0382
*         IOPTLIST(30)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+116                                    0383
*         RFY                                                      0384
*           I015F BASED(ADDR(IOPTLIST(30)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDTBLK);   /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+116                                    0385
         MVC   I015F(2,@10),@CH00081                               0385
*         CALL BLSDMSG0(ZZ2,F3115C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(
*             IOPTLIST));           /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0386
         ST    @10,@AL00001                                        0386
         LA    @10,@CF00312                                        0386
         ST    @10,@AL00001+4                                      0386
         LA    @10,DMCBMSG(,DMCBPTR)                               0386
         ST    @10,@AL00001+8                                      0386
         L     @10,DMCBMSGS(,DMCBPTR)                              0386
         ST    @10,@AL00001+12                                     0386
         LA    @10,@CB00378                                        0386
         ST    @10,@AL00001+16                                     0386
         LA    @10,IOPTLIST                                        0386
         ST    @10,@AFTEMPS+12                                     0386
         LA    @10,@AFTEMPS+12                                     0386
         ST    @10,@AL00001+20                                     0386
         L     @15,DMCBMSG0(,DMCBPTR)                              0386
         LA    @01,@AL00001                                        0386
         BALR  @14,@15                                             0386
*       END;                        /* BLSDMSG                     0387
*                                      (ZZ2,F3115C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDSN,DMCBVOL,SYNDSTE
*                                      P,SYNDUA,SYNDDVTY,SYNDDDNM,SYN
*                                      DOPN,SYNDERDS,SYNDTACM,SYNDTBL
*                                      K) BUILD ERROR MESSAGE        */
*     END;                          /* HANDLE TAPE DEVICE CASE       */
         EJECT
*                                                                  0389
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNAD MESSAGE FOR DIRECT ACCESS DEVICE TYPE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0389
*   IF SYNDDVTY=LDAC THEN           /* TEST FOR DIRECT ACCESS ERROR  */
@RF00333 CLC   SYNDDVTY(2,DMCBPTR),@CC00328                        0389
         BNE   @RF00389                                            0389
*     DO;                           /* HANDLE DASD CASE              */
*       DO;                         /* BLSDMSG                     0391
*                                      (ZZ2,F3115C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDSN,DMCBVOL,SYNDSTE
*                                      P,SYNDUA,SYNDDVTY,SYNDDDNM,SYN
*                                      DOPN,SYNDERDS,SYNDDACM,SYNDDAD
*                                      R)                            */
*         IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT      */
         LA    @10,IOPTLIST+12                                     0392
         ST    @10,IOPTLIST                                        0392
*         IOPTLIST(2)=ADDR(DMCBDSN);/* INSERT NAME POINTER           */
         LA    @10,DMCBDSN(,DMCBPTR)                               0393
         ST    @10,IOPTLIST+4                                      0393
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0394
         ST    @10,IOPTLIST+8                                      0394
*         RFY                                                      0395
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(DMCBDSN);    /* INSERT LENGTH                 */
         LA    @05,IOPTLIST+8                                      0396
         MVC   I015F(2,@05),@CH00121                               0396
*         IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT      */
         LA    @05,IOPTLIST+24                                     0397
         ST    @05,IOPTLIST+12                                     0397
*         IOPTLIST(5)=ADDR(DMCBVOL);/* INSERT NAME POINTER           */
         LA    @05,DMCBVOL(,DMCBPTR)                               0398
         ST    @05,IOPTLIST+16                                     0398
*         IOPTLIST(6)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0399
*         RFY                                                      0400
*           I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(DMCBVOL);    /* INSERT LENGTH                 */
         LA    @05,6                                               0401
         LA    @15,IOPTLIST+20                                     0401
         STH   @05,I015F(,@15)                                     0401
*         IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT     */
         LA    @15,IOPTLIST+36                                     0402
         ST    @15,IOPTLIST+24                                     0402
*         IOPTLIST(8)=ADDR(SYNDSTEP);/* INSERT NAME POINTER          */
         LA    @15,SYNDSTEP(,DMCBPTR)                              0403
         ST    @15,IOPTLIST+28                                     0403
*         IOPTLIST(9)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0404
*         RFY                                                      0405
*           I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(SYNDSTEP);   /* INSERT LENGTH                 */
         LA    @15,8                                               0406
         LA    @14,IOPTLIST+32                                     0406
         STH   @15,I015F(,@14)                                     0406
*         IOPTLIST(10)=ADDR(IOPTLIST(13));/* CHAIN TO NEXT INSERT    */
         LA    @14,IOPTLIST+48                                     0407
         ST    @14,IOPTLIST+36                                     0407
*         IOPTLIST(11)=ADDR(SYNDUA);/* INSERT NAME POINTER           */
         LA    @14,SYNDUA(,DMCBPTR)                                0408
         ST    @14,IOPTLIST+40                                     0408
*         IOPTLIST(12)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0409
*         RFY                                                      0410
*           I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDUA);     /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+44                                     0411
         MVC   I015F(2,@14),@CH00103                               0411
*         IOPTLIST(13)=ADDR(IOPTLIST(16));/* CHAIN TO NEXT INSERT    */
         LA    @14,IOPTLIST+60                                     0412
         ST    @14,IOPTLIST+48                                     0412
*         IOPTLIST(14)=ADDR(SYNDDVTY);/* INSERT NAME POINTER         */
         LA    @14,SYNDDVTY(,DMCBPTR)                              0413
         ST    @14,IOPTLIST+52                                     0413
*         IOPTLIST(15)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+56                                     0414
*         RFY                                                      0415
*           I015F BASED(ADDR(IOPTLIST(15)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDVTY);   /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+56                                     0416
         MVC   I015F(2,@14),@CH00074                               0416
*         IOPTLIST(16)=ADDR(IOPTLIST(19));/* CHAIN TO NEXT INSERT    */
         LA    @14,IOPTLIST+72                                     0417
         ST    @14,IOPTLIST+60                                     0417
*         IOPTLIST(17)=ADDR(SYNDDDNM);/* INSERT NAME POINTER         */
         LA    @14,SYNDDDNM(,DMCBPTR)                              0418
         ST    @14,IOPTLIST+64                                     0418
*         IOPTLIST(18)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+68                                     0419
*         RFY                                                      0420
*           I015F BASED(ADDR(IOPTLIST(18)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDDNM);   /* INSERT LENGTH                 */
         LA    @14,IOPTLIST+68                                     0421
         STH   @15,I015F(,@14)                                     0421
*         IOPTLIST(19)=ADDR(IOPTLIST(22));/* CHAIN TO NEXT INSERT    */
         LA    @15,IOPTLIST+84                                     0422
         ST    @15,IOPTLIST+72                                     0422
*         IOPTLIST(20)=ADDR(SYNDOPN);/* INSERT NAME POINTER          */
         LA    @15,SYNDOPN(,DMCBPTR)                               0423
         ST    @15,IOPTLIST+76                                     0423
*         IOPTLIST(21)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+80                                     0424
*         RFY                                                      0425
*           I015F BASED(ADDR(IOPTLIST(21)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDOPN);    /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+80                                     0426
         STH   @05,I015F(,@15)                                     0426
*         IOPTLIST(22)=ADDR(IOPTLIST(25));/* CHAIN TO NEXT INSERT    */
         LA    @15,IOPTLIST+96                                     0427
         ST    @15,IOPTLIST+84                                     0427
*         IOPTLIST(23)=ADDR(SYNDERDS);/* INSERT NAME POINTER         */
         LA    @15,SYNDERDS(,DMCBPTR)                              0428
         ST    @15,IOPTLIST+88                                     0428
*         IOPTLIST(24)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+92                                     0429
*         RFY                                                      0430
*           I015F BASED(ADDR(IOPTLIST(24)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDERDS);   /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+92                                     0431
         MVC   I015F(2,@15),@CH00143                               0431
*         IOPTLIST(25)=ADDR(IOPTLIST(28));/* CHAIN TO NEXT INSERT    */
         LA    @15,IOPTLIST+108                                    0432
         ST    @15,IOPTLIST+96                                     0432
*         IOPTLIST(26)=ADDR(SYNDDACM);/* INSERT NAME POINTER         */
         LA    @15,SYNDDACM(,DMCBPTR)                              0433
         ST    @15,IOPTLIST+100                                    0433
*         IOPTLIST(27)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+104                                    0434
*         RFY                                                      0435
*           I015F BASED(ADDR(IOPTLIST(27)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDACM);   /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+104                                    0436
         STH   @05,I015F(,@15)                                     0436
*         IOPTLIST(28)=0;           /* LAST INSERT                   */
         ST    @10,IOPTLIST+108                                    0437
*         IOPTLIST(29)=ADDR(SYNDDADR);/* INSERT NAME POINTER         */
         LA    @05,SYNDDADR(,DMCBPTR)                              0438
         ST    @05,IOPTLIST+112                                    0438
*         IOPTLIST(30)=0;           /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+116                                    0439
*         RFY                                                      0440
*           I015F BASED(ADDR(IOPTLIST(30)));/* ACCESS BYTES 1-2      */
*         I015F=LENGTH(SYNDDADR);   /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+116                                    0441
         MVC   I015F(2,@10),@CH00265                               0441
*         CALL BLSDMSG0(ZZ2,F3115C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(
*             IOPTLIST));           /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0442
         ST    @10,@AL00001                                        0442
         LA    @10,@CF00312                                        0442
         ST    @10,@AL00001+4                                      0442
         LA    @10,DMCBMSG(,DMCBPTR)                               0442
         ST    @10,@AL00001+8                                      0442
         L     @10,DMCBMSGS(,DMCBPTR)                              0442
         ST    @10,@AL00001+12                                     0442
         LA    @10,@CB00378                                        0442
         ST    @10,@AL00001+16                                     0442
         LA    @10,IOPTLIST                                        0442
         ST    @10,@AFTEMPS+12                                     0442
         LA    @10,@AFTEMPS+12                                     0442
         ST    @10,@AL00001+20                                     0442
         L     @15,DMCBMSG0(,DMCBPTR)                              0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*       END;                        /* BLSDMSG                     0443
*                                      (ZZ2,F3115C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBDSN,DMCBVOL,SYNDSTE
*                                      P,SYNDUA,SYNDDVTY,SYNDDDNM,SYN
*                                      DOPN,SYNDERDS,SYNDDACM,SYNDDAD
*                                      R) BUILD ERROR MESSAGE        */
*     END;                          /* HANDLE DASD CASE              */
*   END SYNADERR;                                                  0445
@EL00006 DS    0H                                                  0445
@EF00006 DS    0H                                                  0445
@ER00006 LM    @14,@12,@SA00006                                    0445
         BR    @14                                                 0445
         EJECT
*                                                                  0446
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0446
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR01F FIXED(31) REG(1),                                     0446
*     GPR15F FIXED(31) REG(15),                                    0446
*     GPR01P PTR(31) REG(1),                                       0446
*     GPR13P PTR(31) REG(13),                                      0446
*     GPR15P PTR(31) REG(15);                                      0446
*   DCL                                                            0447
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */
*      2 I00602 PTR(24),            /* EP/DE PTR                     */
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */
*      2 I00604 PTR(24),            /* DCB PTR                       */
*      2 I00605 PTR(31);            /* ERRET PTR                     */
*   DECLARE                                                        0448
*     ILIST CHAR(12) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0449
*     I031F FIXED(31) BASED,                                       0449
*     I031P PTR(31) BASED,                                         0449
*     I015F FIXED(15) BASED,                                       0449
*     I015P PTR(15) BASED,                                         0449
*     I008P PTR(8) BASED,                                          0449
*     I001C CHAR(1) BASED;                                         0449
*   DECLARE                                                        0450
*     IOPTLIST(30) PTR(31) BDY(WORD);/* OPTION LIST ARRAY            */
*   DCL                                                            0451
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0451
*   GEN DATA DEFS(HEXTBL);                                         0452
*   END BLSCANLE                                                   0453
*                                                                  0453
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJEFFGF)                                       */
*/*%INCLUDE SYSLIB  (BLSCLKR )                                       */
*                                                                  0453
*       ;                                                          0453
@EL00001 L     @13,4(,@13)                                         0453
@EF00001 L     @00,@SIZDATD                                        0453
         LR    @01,@11                                             0453
         BLSCFREF R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0453
         BR    @14                                                 0453
@DATA    DS    0H
@CH00103 DC    H'3'
@CH00050 DC    H'5'
@CH00081 DC    H'7'
@CH00265 DC    H'14'
@CH00143 DC    H'15'
@CH00121 DC    H'44'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    15F
@SA00005 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00006 DS    15F
@AL00001 DS    6A
@AFTEMPS DS    4F
BLSCANLE CSECT
         DS    0F
@CF00074 DC    F'2'
@CH00074 EQU   @CF00074+2
@CF00039 DC    F'4'
@CH00039 EQU   @CF00039+2
@CF00057 DC    F'6'
@CH00057 EQU   @CF00057+2
@CF00046 DC    F'8'
@CH00046 EQU   @CF00046+2
@CF00244 DC    F'12'
@CF00308 DC    F'3110'
@CF00310 DC    F'3114'
@CF00312 DC    F'3115'
@CF00314 DC    F'3116'
@CF00297 DC    XL4'80000000'
@DATD    DSECT
         DS    0D
GFPARMS  DS    CL44
         ORG   GFPARMS
GFCBPTR  DS    AL4
GFRCODE  DS    FL4
GF02PTR  DS    AL4
GFCALLID DS    FL2
GFBITS   DS    BL1
         ORG   GFBITS
GFKEYN08 DS    BL1
GFSUBSYS EQU   GFBITS+0
GFWTPSW  EQU   GFBITS+0
@NM00001 EQU   GFBITS+0
         ORG   GFPARMS+15
@NM00002 DS    AL1
GFCPPLP  DS    AL4
GFECBP   DS    AL4
GFDSNLEN DS    FL2
GFPGMNL  DS    FL2
GFDSNP   DS    AL4
GFPGMNP  DS    AL4
@NM00003 DS    AL4
@NM00004 DS    AL4
         ORG   GFPARMS+44
MODSTAT  DS    CL16
         ORG   MODSTAT
MODNAME  DS    CL8
RETCODE  DS    FL4
SUBCODE  DS    FL4
         ORG   MODSTAT+16
OPCODE   DS    CL5
RCODE    DS    CL2
REJCODE  DS    CL2
SUBRCOD  DS    CL2
RESULT   DS    CL8
         DS    CL1
CHSTR8   DS    CL8
         ORG   CHSTR8
@NM00005 DS    CL3
CHSTR847 DS    CL4
         ORG   CHSTR847
CHSTR846 DS    CL3
CHSTR87  DS    CL1
         ORG   CHSTR8+7
CHSTR88  DS    CL1
         ORG   CHSTR8+8
CTEMP    DS    CL9
         ORG   CTEMP
CTEMP18  DS    CL8
         ORG   CTEMP18
CTEMP14  DS    CL4
CTEMP58  DS    CL4
         ORG   CTEMP58
CTEMP56  DS    CL2
CTEMP78  DS    CL2
         ORG   CTEMP+9
         DS    CL7
ILIST    DS    CL12
IOPTLIST DS    30A
BLSCANLE CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00237 DC    V(BLSCANLI)
         DS    0D
@CC00334 DC    C'IKJEFF19'
@CC00336 DC    C'BLSCANLE'
@CC00326 DC    C'N/A'
@CC00328 DC    C'DA'
@CC00330 DC    C'TA'
@CC00332 DC    C'UR'
@CB00378 DC    B'00000000'
         DS    CL6
DASPATCH DS    CL80
         ORG   DASPATCH
DASPATA  DC    20A(0)
         ORG   DASPATCH+80
OPNAME   DC    CL5'OPEN '
         DC    CL5'CLOSE'
         DC    CL5'SET  '
         DC    CL5'GET  '
         DC    CL5'PUT  '
         DC    CL5'ERASE'
         DC    CL5'END  '
         DC    CL5'POINT'
BLSCANLE CSECT
*                         /*
HEXTBL   EQU   *-240
         DC    CL16'0123456789ABCDEF'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSCANLE CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
REASON   EQU   @06
ABENDC   EQU   @05
DMCBPTR  EQU   @04
GPR13P   EQU   @13
GPR01P   EQU   @01
GPR15P   EQU   @15
GPR15F   EQU   @15
GPR01F   EQU   @01
DMCB     EQU   0
DMCBTVP  EQU   DMCB+8
DMCBRTC  EQU   DMCB+12
DMCBFTY  EQU   DMCB+20
DMCBVSF  EQU   DMCBFTY
DMCBOPN  EQU   DMCB+21
DMCBRQST EQU   DMCB+22
DMCBRMOD EQU   DMCB+23
DMCBOUT  EQU   DMCBRMOD
DMCBOPTS EQU   DMCB+24
DMCBGKY  EQU   DMCBOPTS
DMCBMFLG EQU   DMCB+28
DMCBREJ  EQU   DMCB+29
DMCBBUFP EQU   DMCB+32
DMCBKEYP EQU   DMCB+44
DMCBMSG  EQU   DMCB+52
DMCBRI   EQU   DMCB+64
DMCBMSG0 EQU   DMCB+68
DMCBMSGS EQU   DMCB+72
DMCBFRE  EQU   DMCB+88
DMCBEOB  EQU   DMCB+92
DMCBCPC  EQU   DMCB+116
DMCBACBE EQU   DMCB+124
DMCBDCBE EQU   DMCBACBE
DMCBRPLF EQU   DMCB+128
DMCBSYNM EQU   DMCB+132
DMCBDDNM EQU   DMCB+260
DMCBVOL  EQU   DMCB+268
DMCBDSN  EQU   DMCB+284
DMCBSPEC EQU   DMCB+380
DMCBSUBC EQU   DMCB+404
DMCBAMS  EQU   DMCB+416
DMCBAUDT EQU   DMCB+568
DMCBLSCP EQU   DMCBAUDT+16
DMCBCARY EQU   DMCBAUDT+20
DMCBMODN EQU   DMCB+632
DMCBRQC  EQU   0
BLSDMSGS EQU   0
BLSDMSG0 EQU   0
ZZ2      EQU   0
MSAV     EQU   0
MSAVHSA  EQU   MSAV+4
CSAV     EQU   0
CSAVR14  EQU   CSAV+12
I015F    EQU   0
DMCBDMGR EQU   0
I001C    EQU   0
I008P    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
DMCBPARM EQU   0
DMCBVSM  EQU   DMCBAMS
DMCBRPL  EQU   DMCBVSM
DMCBACB  EQU   DMCBVSM+76
DMCBQSM  EQU   DMCBAMS
SYNDMBUF EQU   DMCBSYNM
SYNDSTEP EQU   SYNDMBUF+59
SYNDUA   EQU   SYNDMBUF+68
SYNDDVTY EQU   SYNDMBUF+72
SYNDDDNM EQU   SYNDMBUF+75
SYNDOPN  EQU   SYNDMBUF+84
SYNDERDS EQU   SYNDMBUF+91
SYNDDADR EQU   SYNDMBUF+107
SYNDTBLK EQU   SYNDDADR
SYNDTACM EQU   SYNDDADR+8
SYNDDACM EQU   SYNDMBUF+122
I006     EQU   ILIST
I00601   EQU   I006
I00602   EQU   I006+1
I00603   EQU   I006+4
I00604   EQU   I006+5
I00605   EQU   I006+8
CHSTR878 EQU   CHSTR8+6
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
SYNDP9   EQU   SYNDMBUF+121
SYNDP8   EQU   SYNDDADR+7
SYNDP7   EQU   SYNDMBUF+106
SYNDP6   EQU   SYNDMBUF+90
SYNDP5   EQU   SYNDMBUF+83
SYNDP4   EQU   SYNDMBUF+74
SYNDP3   EQU   SYNDMBUF+71
SYNDP2   EQU   SYNDMBUF+67
SYNDP1   EQU   SYNDMBUF
DMCBRES7 EQU   DMCBQSM+96
DMCBDCB  EQU   DMCBQSM
CSAVR1   EQU   CSAV+24
CSAVR0   EQU   CSAV+20
CSAVR15  EQU   CSAV+16
CSAVPAD  EQU   CSAV
MSAVWD1  EQU   MSAV
DMCBWRK  EQU   DMCB+648
DMCBRES8 EQU   DMCB+640
DMCBCLC  EQU   DMCBAUDT+12
DMCBOPC  EQU   DMCBAUDT+8
DMCBFRC  EQU   DMCBAUDT+4
DMCBALC  EQU   DMCBAUDT
DMCBFR   EQU   DMCB+412
DMCBRES6 EQU   DMCB+410
DMCBIRSC EQU   DMCB+408
DMCBDRBP EQU   DMCB+400
DMCBRSZM EQU   DMCB+398
DMCBRSZA EQU   DMCB+396
DMCBCISZ EQU   DMCB+394
DMCBDCBL EQU   DMCB+392
DMCBDCLR EQU   DMCB+390
DMCBDCFM EQU   DMCB+389
DMCBRES5 EQU   DMCB+388
DMCBLBRT EQU   DMCB+386
DMCBLBSQ EQU   DMCB+384
DMCBLBPS EQU   DMCB+383
DMCBLBTY EQU   DMCB+382
DMCBRES4 EQU   DMCB+381
DMCBSPRS EQU   DMCBSPEC
DMCBSPRN EQU   DMCBSPEC
DMCBSPCT EQU   DMCBSPEC
DMCBSPRL EQU   DMCBSPEC
DMCBSPSE EQU   DMCB+376
DMCBSPPR EQU   DMCB+372
DMCBSPTY EQU   DMCB+369
DMCBODIS EQU   DMCB+368
DMCBDISP EQU   DMCB+367
DMCBSTAT EQU   DMCB+366
DMCBRES3 EQU   DMCB+364
DMCBMEMB EQU   DMCB+356
DMCBMODL EQU   DMCB+348
DMCBRES9 EQU   DMCB+340
DMCBPID  EQU   DMCB+332
DMCBTYPE EQU   DMCB+328
DMCBUNIT EQU   DMCB+276
DMCBDSOR EQU   DMCB+274
DMCBARC  EQU   DMCB+120
DMCBRET  EQU   DMCB+112
DMCBSTL  EQU   DMCB+96
DMCBRES2 EQU   DMCB+85
DMCBSPID EQU   DMCB+84
DMCBRESC EQU   DMCB+80
DMCBZZ1P EQU   DMCB+76
DMCBRRL  EQU   DMCB+60
DMCBRBA  EQU   DMCB+56
DMCBKEYL EQU   DMCB+48
DMCBKPC  EQU   DMCBKEYP
DMCBORL  EQU   DMCB+40
DMCBBLEN EQU   DMCB+36
DMCBBFPC EQU   DMCBBUFP
DMCBRES1 EQU   DMCB+31
DMCBACCM EQU   DMCB+30
DMCBRESB EQU   DMCBMFLG
DMCBFMOD EQU   DMCBMFLG
DMCBLOPT EQU   DMCB+27
DMCBLRM  EQU   DMCB+26
DMCBLRQ  EQU   DMCB+25
DMCBOPRS EQU   DMCBOPTS
DMCBLRD  EQU   DMCBOPTS
DMCBBWD  EQU   DMCBOPTS
DMCBUPD  EQU   DMCBOPTS
DMCBAPX  EQU   DMCBOPTS
DMCBRNO  EQU   DMCBGKY
DMCBKYD  EQU   DMCBOPTS
DMCBRMRS EQU   DMCBRMOD
DMCBRM5  EQU   DMCBRMOD
DMCBRM6  EQU   DMCBRMOD
DMCBTMP  EQU   DMCBOUT
DMCBRESA EQU   DMCBOPN
DMCBSOUT EQU   DMCBOPN
DMCBSIN  EQU   DMCBOPN
DMCBKSF  EQU   DMCBFTY
DMCBFTRS EQU   DMCBFTY
DMCBSHF  EQU   DMCBFTY
DMCBIRL  EQU   DMCB+16
DMCBNEXT EQU   DMCB+4
DMCBID   EQU   DMCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00135 EQU   @EL00003
@RF00175 EQU   @EL00004
@RC00266 EQU   @EL00005
@RF00270 EQU   @EL00005
@RF00389 EQU   @EL00006
@ENDDATA EQU   *
         END   BLSCANLE,(C'PLS1851',0701,78062)

         TITLE 'EP=BLSCAAMS -- IPCS DAS ACCESS METHOD SERVICES INTERFAC*
               CE       '
*     /* CHANGE ACTIVITY
*    THIS MODULE IS WRITTEN FOR @G57LPSR
BLSCAAMS CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'BLSCAAMS  78.062'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         BLSCGETS R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
*   DMCBPTR=GPR01P;                 /* BASE THE DMCB AND DMAL        */
         LR    DMCBPTR,GPR01P                                      0029
*   RFY                                                            0030
*     GPR01P UNRSTD;                                               0030
*   MODNAME=LMODNMC;                                               0031
         MVC   MODNAME(8),@CC00400                                 0031
*   RETCODE=F0C;                                                   0032
         SLR   @10,@10                                             0032
         ST    @10,RETCODE                                         0032
*   SUBCODE=F0C;                                                   0033
*                                                                  0033
         ST    @10,SUBCODE                                         0033
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IDCAMS PARAMETER LIST ELEMENTS                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0034
*   OPTLLEN=F0C;                    /* NULL IDCAMS OPTION LIST       */
         STH   @10,OPTLLEN                                         0034
*   DNAMLLEN=F0C;                   /* NULL IDCAMS DNAME LIST        */
         STH   @10,DNAMLLEN                                        0035
*   PNLLEN=F0C;                     /* NULL IDCAMS PAGE NUMBER LIST  */
         STH   @10,PNLLEN                                          0036
*   IOLNUM=F2C;                     /* SYSIN AND SYSPRINT ARE TO BE
*                                      MANAGED                       */
         MVC   IOLNUM(4),@CF00072                                  0037
*   IOLINDDP=ADDR(INDD);            /* ADDRESS OF SYSIN DDNAME ENTRY */
         LA    @04,@CC00359                                        0038
         ST    @04,IOLINDDP                                        0038
*   IOLMINP=ADDR(BLSCAMIN);         /* SYSIN IN-CORE GET ROUTINE     */
         L     @04,@CV00284                                        0039
         ST    @04,IOLMINP                                         0039
*   IOLINCBP=ADDR(INCB);            /* ADDR OF BLSCAMIN CONTROL BLOCK*/
         LA    @04,INCB                                            0040
         ST    @04,IOLINCBP                                        0040
*   IOLOUDDP=ADDR(OUDD);            /* ADDR OF SYSPRINT DDNAME ENTRY */
         LA    @04,@CC00362                                        0041
         ST    @04,IOLOUDDP                                        0041
*   IOLMPRP=ADDR(BLSCAMPR);         /* SYSPRINT IN-CORE PUT ROUTINE  */
         L     @04,@CV00285                                        0042
         ST    @04,IOLMPRP                                         0042
*   IOLOUCBP=ADDR(OUCB);            /* ADDRESS OF BLSCAMPR CNTRL BLK */
         LA    @04,OUCB                                            0043
         ST    @04,IOLOUCBP                                        0043
*   OUHEAD=F0C;                     /* SYSPRINT CONTROL BLOCK        */
         ST    @10,OUHEAD                                          0044
*   OUCUR=F0C;                                                     0045
         ST    @10,OUCUR                                           0045
*   OUTAIL=F0C;                                                    0046
         ST    @10,OUTAIL                                          0046
*   INHEAD=F0C;                     /* SYSIN CONTROL BLOCK           */
         ST    @10,INHEAD                                          0047
*   INCUR=F0C;                                                     0048
         ST    @10,INCUR                                           0048
*   INTAIL=F0C;                                                    0049
*                                                                  0049
         ST    @10,INTAIL                                          0049
*   /*****************************************************************/
*   /*                                                               */
*   /* PREPARE IDCAMS SYSIN TEXT STREAM                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0050
*   MODELPTR=DMALMODP;              /* ADDR OF THE ALLOCATION MODEL  */
         L     MODELPTR,DMALMODP(,DMCBPTR)                         0050
*   IF MMAMSLP=F0C THEN             /* TEST FOR INVALID IDCAMS SYSIN
*                                      STREAM POINTER IN MODEL       */
         C     @10,MMAMSLP(,MODELPTR)                              0051
         BNE   @RF00051                                            0051
*     DO;                           /* INVALID IDCAMS SYSIN STREAM 0052
*                                      POINTER                       */
*       DO;                         /* BLSDMSG                     0053
*                                      (ZZ2,F3108C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBMODL)              */
*         IOPTLIST(1)=0;            /* LAST INSERT                   */
         ST    @10,IOPTLIST                                        0054
*         IOPTLIST(2)=ADDR(DMCBMODL);/* INSERT NAME POINTER          */
         LA    @04,DMCBMODL(,DMCBPTR)                              0055
         ST    @04,IOPTLIST+4                                      0055
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+8                                      0056
*         RFY                                                      0057
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(DMCBMODL);   /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+8                                      0058
         MVC   I015F(2,@10),@CH00044                               0058
*         CALL BLSDMSG0(ZZ2,F3108C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(
*             IOPTLIST));           /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0059
         ST    @10,@AL00001                                        0059
         LA    @10,@CF00382                                        0059
         ST    @10,@AL00001+4                                      0059
         LA    @10,DMCBMSG(,DMCBPTR)                               0059
         ST    @10,@AL00001+8                                      0059
         L     @10,DMCBMSGS(,DMCBPTR)                              0059
         ST    @10,@AL00001+12                                     0059
         LA    @10,@CB00411                                        0059
         ST    @10,@AL00001+16                                     0059
         LA    @10,IOPTLIST                                        0059
         ST    @10,@AFTEMPS+4                                      0059
         LA    @10,@AFTEMPS+4                                      0059
         ST    @10,@AL00001+20                                     0059
         L     @15,DMCBMSG0(,DMCBPTR)                              0059
         LA    @01,@AL00001                                        0059
         BALR  @14,@15                                             0059
*       END;                        /* BLSDMSG                     0060
*                                      (ZZ2,F3108C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBMODL) BUILD INVALID
*                                      IDCAMS SYSIN STREAM POINTER 0060
*                                      MESSAGE                       */
*       RETCODE=ERROR;              /* NOTIFY CALLER                 */
         MVC   RETCODE(4),@CF00044                                 0061
*     END;                          /* INVALID IDCAMS SYSIN STREAM 0062
*                                      POINTER                       */
*   ELSE                                                           0063
*     DO;                           /* VALID IDCAMS SYSIN STREAM   0063
*                                      POINTER                       */
         B     @RC00051                                            0063
@RF00051 DS    0H                                                  0064
*       CALL BLDSTR(MMAMSLP);       /* BUILD IDCAMS SYSIN STREAM     */
*                                                                  0064
         LA    @10,MMAMSLP(,MODELPTR)                              0064
         ST    @10,@AL00001                                        0064
         LA    @01,@AL00001                                        0064
         BAL   @14,BLDSTR                                          0064
*       /*************************************************************/
*       /*                                                           */
*       /* INVOKE ACCESS METHOD SERVICES TO GET SPACE FOR DATA SET   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0065
*       IF RETCODE=F0C THEN         /* TEST THAT ALL IS WELL         */
         L     @10,RETCODE                                         0065
         LTR   @10,@10                                             0065
         BNZ   @RF00065                                            0065
*         DO;                       /* OK TO INVOKE IDCAMS           */
*           CALL INVAMS;            /* INVOKE IDCAMS TO GET SPACE FOR
*                                      VSAM DATA SET                 */
         BAL   @14,INVAMS                                          0067
*         END;                      /* OK TO INVOKE IDCAMS           */
*     END;                          /* VALID IDCAMS SYSIN STREAM   0069
*                                      POINTER                       */
*                                                                  0069
@RF00065 DS    0H                                                  0070
*   /*****************************************************************/
*   /*                                                               */
*   /* IDCAMS DATA SET ALLOCATION COMPLETE, RETURN TO CALLER         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0070
*   RETURN CODE(RETCODE);                                          0070
@RC00051 L     @10,RETCODE                                         0070
         L     @13,4(,@13)                                         0070
         L     @00,@SIZDATD                                        0070
         LR    @01,@11                                             0070
         BLSCFRES R,LV=(0),A=(1)
         LR    @15,@10                                             0070
         L     @14,12(,@13)                                        0070
         LM    @00,@12,20(@13)                                     0070
         BR    @14                                                 0070
         EJECT
*                                                                  0071
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO INVOKE IDCAMS TO GET SPACE FOR DATA SET          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0071
*INVAMS:                                                           0071
*   PROCEDURE;                      /* INVOKE IDCAMS TO GET SPACE FOR
*                                      DATA SET                      */
INVAMS   STM   @14,@12,@SA00002                                    0071
*   GEN FLOWS(LINKERR);                                            0072
*                        /* TELL COMPILER ABOUT
*                                      ERRET(LINKERR) IN LINK MACRO
*   DO;                             /* LINK EP(LINKNAME) PARAM(AMSOPT
*                                      L,AMSDNAML,AMSPNL,AMSIOL) VL
*                                      ERRET(LINKERR)                */
*     I00601='00'X;                 /* EP/DE FLAG                    */
         MVI   I00601,X'00'                                        0074
*     I00602=ADDR(LINKNAME);        /* ADDR OF EP/DE                 */
         LA    @10,@CC00402                                        0075
         STCM  @10,7,I00602                                        0075
*     I00604=0;                     /* DCB PTR                       */
         SLR   @10,@10                                             0076
         STCM  @10,7,I00604                                        0076
*     I00603='80'X;                 /* ERRET FLAG                    */
         MVI   I00603,X'80'                                        0077
*     I00605=ADDR(LINKERR);         /* ERRET PTR                     */
         LA    @10,LINKERR                                         0078
         ST    @10,I00605                                          0078
*     IOPTLIST(1)=ADDR(AMSOPTL);    /* ADDR OF PROB PROG PARM        */
         LA    @10,AMSOPTL                                         0079
         ST    @10,IOPTLIST                                        0079
*     IOPTLIST(2)=ADDR(AMSDNAML);   /* ADDR OF PROB PROG PARM        */
         LA    @10,AMSDNAML                                        0080
         ST    @10,IOPTLIST+4                                      0080
*     IOPTLIST(3)=ADDR(AMSPNL);     /* ADDR OF PROB PROG PARM        */
         LA    @10,AMSPNL                                          0081
         ST    @10,IOPTLIST+8                                      0081
*     IOPTLIST(4)=ADDR(AMSIOL);     /* ADDR OF PROB PROG PARM        */
         LA    @10,AMSIOL                                          0082
         ST    @10,IOPTLIST+12                                     0082
*     IOPTLIST(4)=IOPTLIST(4)×'80000000'X;/* SET VL BIT              */
         O     @10,@CF00370                                        0083
         ST    @10,IOPTLIST+12                                     0083
*     RESPECIFY                                                    0084
*      (GPR01P) RESTRICTED;                                        0084
*     GPR01P=ADDR(IOPTLIST);        /* ADDR OF OPTLIST               */
         LA    GPR01P,IOPTLIST                                     0085
*     RESPECIFY                                                    0086
*      (GPR15P) RESTRICTED;                                        0086
*     GPR15P=ADDR(I006);            /* ADDR OF LINK LIST             */
         LA    GPR15P,I006                                         0087
*     SVC(6);                       /* ISSUE LINK SVC                */
         SVC   6                                                   0088
*     RESPECIFY                                                    0089
*      (GPR01P) UNRESTRICTED;                                      0089
*     RESPECIFY                                                    0090
*      (GPR15P) UNRESTRICTED;                                      0090
*   END;                            /* LINK EP(LINKNAME) PARAM(AMSOPT
*                                      L,AMSDNAML,AMSPNL,AMSIOL) VL
*                                      ERRET(LINKERR) GET SPACE FOR
*                                      NEW DATA SET                  */
*   RFY                                                            0092
*     GPR15F RSTD;                                                 0092
*   SUBCODE=GPR15F;                 /* SAVE THE RETURN CODE          */
         ST    GPR15F,SUBCODE                                      0093
*   RFY                                                            0094
*     GPR15F UNRSTD;                                               0094
*   IF SUBCODE^=F0C THEN            /* TEST FOR IDCAMS ERROR         */
         L     @10,SUBCODE                                         0095
         LTR   @10,@10                                             0095
         BZ    @RF00095                                            0095
*     DO;                           /* IDCAMS ERROR                  */
*       IF SUBCODE<ERROR THEN       /* TEST FOR WARNING              */
         C     @10,@CF00044                                        0097
         BNL   @RF00097                                            0097
*         RETCODE=SUBCODE;          /* SET TO SUBCODE                */
         ST    @10,RETCODE                                         0098
*       ELSE                                                       0099
*         RETCODE=ERROR;            /* FORCE ERROR TO CALLER         */
         B     @RC00097                                            0099
@RF00097 MVC   RETCODE(4),@CF00044                                 0099
*       DO;                         /* BLSDMSG                     0100
*                                      (ZZ2,F3111C,DMCBMSG,BLSDMSGS)
*                                      INSERT(MODNAME,DMCBMODL)      */
@RC00097 DS    0H                                                  0101
*         IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT      */
         LA    @10,IOPTLIST+12                                     0101
         ST    @10,IOPTLIST                                        0101
*         IOPTLIST(2)=ADDR(MODNAME);/* INSERT NAME POINTER           */
         LA    @10,MODNAME                                         0102
         ST    @10,IOPTLIST+4                                      0102
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0103
         ST    @10,IOPTLIST+8                                      0103
*         RFY                                                      0104
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(MODNAME);    /* INSERT LENGTH                 */
         LA    @04,8                                               0105
         LA    @15,IOPTLIST+8                                      0105
         STH   @04,I015F(,@15)                                     0105
*         IOPTLIST(4)=0;            /* LAST INSERT                   */
         ST    @10,IOPTLIST+12                                     0106
*         IOPTLIST(5)=ADDR(DMCBMODL);/* INSERT NAME POINTER          */
         LA    @15,DMCBMODL(,DMCBPTR)                              0107
         ST    @15,IOPTLIST+16                                     0107
*         IOPTLIST(6)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0108
*         RFY                                                      0109
*           I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(DMCBMODL);   /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+20                                     0110
         STH   @04,I015F(,@10)                                     0110
*         CALL BLSDMSG0(ZZ2,F3111C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(
*             IOPTLIST));           /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0111
         ST    @10,@AL00001                                        0111
         LA    @10,@CF00386                                        0111
         ST    @10,@AL00001+4                                      0111
         LA    @10,DMCBMSG(,DMCBPTR)                               0111
         ST    @10,@AL00001+8                                      0111
         L     @10,DMCBMSGS(,DMCBPTR)                              0111
         ST    @10,@AL00001+12                                     0111
         LA    @10,@CB00411                                        0111
         ST    @10,@AL00001+16                                     0111
         LA    @10,IOPTLIST                                        0111
         ST    @10,@AFTEMPS                                        0111
         LA    @10,@AFTEMPS                                        0111
         ST    @10,@AL00001+20                                     0111
         L     @15,DMCBMSG0(,DMCBPTR)                              0111
         LA    @01,@AL00001                                        0111
         BALR  @14,@15                                             0111
*       END;                        /* BLSDMSG                     0112
*                                      (ZZ2,F3111C,DMCBMSG,BLSDMSGS)
*                                      INSERT(MODNAME,DMCBMODL) BUILD
*                                      ERROR MESSAGE                 */
*       CALL BLSCHOK(DMCB,DMCBMSG,OUHEAD);/* APPEND IDCAMS SYSPRINT
*                                      TO MESSAGE LIST               */
         ST    DMCBPTR,@AL00001                                    0113
         LA    @10,DMCBMSG(,DMCBPTR)                               0113
         ST    @10,@AL00001+4                                      0113
         LA    @10,OUHEAD                                          0113
         ST    @10,@AL00001+8                                      0113
         L     @15,@CV00287                                        0113
         LA    @01,@AL00001                                        0113
         BALR  @14,@15                                             0113
*     END;                          /* IDCAMS ERROR                  */
*   ELSE                                                           0115
*     DO;                           /* IDCAMS OK                     */
*                                                                  0115
         B     @RC00095                                            0115
@RF00095 DS    0H                                                  0116
*       /*************************************************************/
*       /*                                                           */
*       /* IDCAMS OK, FREEMAIN IN-CORE SYSPRINT RECORDS              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0116
*       OUPTR=OUHEAD;               /* HEAD OF SYSPRINT RECORD LIST  */
         L     @10,OUHEAD                                          0116
         ST    @10,OUPTR                                           0116
*       DO WHILE OUPTR^=F0C;        /* LOOP THRU SYSPRINT RECORD LIST*/
         B     @DE00117                                            0117
@DL00117 DS    0H                                                  0118
*         OUHEAD=MSGWNXT;           /* UNHOOK THIS RECORD FROM LIST  */
         L     @10,OUPTR                                           0118
         L     @04,MSGWNXT(,@10)                                   0118
         ST    @04,OUHEAD                                          0118
*         OUFPTR=OUPTR-LENGTH(MSGDPRF);/* BASE MSGDENT FOR FREEMAIN  */
         SL    @10,@CF00044                                        0119
         LR    OUFPTR,@10                                          0119
*         DO;                       /* FREEMAIN(RC)                0120
*                                      LV(MSGDFLEN)A(MSGDENT)      0120
*                                      SP(MSGDSPID)                  */
*           RESPECIFY                                              0121
*            (GPR01F,                                              0121
*             GPR15F,                                              0121
*             GPR00F) RESTRICTED;                                  0121
*           GPR01F=0;               /* REG 1 MUST BE ZERO            */
         SLR   GPR01F,GPR01F                                       0122
*           GPR15F=1;               /* SET TYPE                      */
         LA    GPR15F,1                                            0123
*           GPR00F=MSGDFLEN;        /* LENGTH REQUESTED              */
         L     GPR00F,MSGDFLEN-1(,OUFPTR)                          0124
         ICM   GPR00F,8,@CB00394                                   0124
*           GPR01F=ADDR(MSGDENT);   /* SET REGISTER ONE              */
         LR    GPR01F,OUFPTR                                       0125
*           GPR15F=GPR15F+((MSGDSPID)*256);/* SUBPOOL VALUE          */
         SLR   @14,@14                                             0126
         IC    @14,MSGDSPID(,OUFPTR)                               0126
         SLA   @14,8                                               0126
         ALR   GPR15F,@14                                          0126
*           SVC(120);               /* RC/RU-FORM OF GETMAIN         */
         SVC   120                                                 0127
*           RESPECIFY                                              0128
*            (GPR01F,                                              0128
*             GPR15F,                                              0128
*             GPR00F) UNRESTRICTED;                                0128
*         END;                      /* FREEMAIN(RC)                0129
*                                      LV(MSGDFLEN)A(MSGDENT)      0129
*                                      SP(MSGDSPID) FREE THIS      0129
*                                      SYSPRINT RECORD               */
*         OUPTR=OUHEAD;             /* SET BASE TO NEXT SYSPRINT LINE*/
         L     @10,OUHEAD                                          0130
         ST    @10,OUPTR                                           0130
*       END;                        /* LOOP THRU SYSPRINT RECORD LIST*/
@DE00117 L     @10,OUPTR                                           0131
         LTR   @10,@10                                             0131
         BNZ   @DL00117                                            0131
*     END;                          /* IDCAMS OK                     */
*   RETURN;                                                        0133
*                                                                  0133
@EL00002 DS    0H                                                  0133
@EF00002 DS    0H                                                  0133
@ER00002 LM    @14,@12,@SA00002                                    0133
         BR    @14                                                 0133
*/* START OF SPECIFICATIONS*******************************************/
*/*                                                                  */
*/*   MODULE NAME:  LINKERR (BLSCLKR)                                */
*/*                                                                  */
*/*   DESCRIPTIVE NAME:  IPCS DAS LINK SVC ERROR RETURN ROUTINE      */
*/*                                                                  */
*/*   COPYRIGHT: NONE                                                */
*/*                                                                  */
*/*   STATUS: SU57 RELEASE 1, LEVEL 0                                */
*/*                                                                  */
*/*   FUNCTION:                                                      */
*/*     PROVIDE INCLUDED CODE FOR A LINK SVC ERROR RETURN THAT       */
*/*     PRODUCES MESSAGE BLS03110 AND HOOKS IT TO THE DMCBMSG        */
*/*     MESSAGE CHAIN ANCHOR.                                        */
*/*                                                                  */
*/*   NOTES:                                                         */
*/*                                                                  */
*/*     DEPENDENCIES:                                                */
*/*       THE FOLLOWING SYMBOLS MUST BE DEFINED IN THE ENCLOSING     */
*/*       PROCEDURE:                                                 */
*/*          RETCODE                                                 */
*/*          SUBCODE                                                 */
*/*          ERROR                                                   */
*/*          GPR01F                                                  */
*/*          GPR15F                                                  */
*/*          ABENDC                                                  */
*/*          REASON                                                  */
*/*          RESULT                                                  */
*/*          MODNAME                                                 */
*/*          LINKNAME                                                */
*/*          CHSTR88                                                 */
*/*          CHSTR847                                                */
*/*          CTEMP                                                   */
*/*          CTEMP18                                                 */
*/*          HEXTBL                                                  */
*/*          HEX0FC                                                  */
*/*          F3110C                                                  */
*/*                                                                  */
*/*     RESTRICTIONS:   NONE                                         */
*/*                                                                  */
*/*     REGISTER CONVENTIONS:                                        */
*/*       GPR01F - (1)                                               */
*/*       GPR15F - (15)                                              */
*/*                                                                  */
*/*     PATCH LABEL:  N/A                                            */
*/*                                                                  */
*/*     SERIALIZATION REQUIREMENTS: NONE                             */
*/*                                                                  */
*/*   MODULE TYPE:  INCLUDED EXECUTABLE CODE                         */
*/*                                                                  */
*/*     PROCESSOR: PLS/2                                             */
*/*                                                                  */
*/*     MODULE SIZE: N/A                                             */
*/*                                                                  */
*/*     ATTRIBUTES:                                                  */
*/*      EXECUTABLE          PROBLEM STATE      REENTRANT            */
*/*                                                                  */
*/*   ENTRY POINT:  LINKERR                                          */
*/*                                                                  */
*/*     PURPOSE:  SEE FUNCTION                                       */
*/*                                                                  */
*/*     LINKAGE:                                                     */
*/*       R01 LOADED WITH ABEND CODE                                 */
*/*       R15 LOADED WITH ABEND REASON CODE                          */
*/*                                                                  */
*/*     METHOD OF ACCESS:  SYSTEM LINK SVC ERRET                     */
*/*                                                                  */
*/*   INPUT:  SEE LINKAGE                                            */
*/*                                                                  */
*/*   OUTPUT:                                                        */
*/*      MESSAGE BLS03110 CHAINED FROM DMCBMSG IN IPCS DM/PM FORMAT. */
*/*      THE OUTPUT MESSAGE LIST FORMAT IS DESCRIBED IN THE BLSDMSG0 */
*/*      MODULE DESCRIPTION.                                         */
*/*                                                                  */
*/*   EXIT-NORMAL:  RETURN TO LINK SVC                               */
*/*     RETCODE = 8   MESSAGE BLS03110 IS ISSUED.                    */
*/*                                                                  */
*/*   EXIT-ERROR:  NONE                                              */
*/*                                                                  */
*/*   EXTERNAL REFERENCES:                                           */
*/*                                                                  */
*/*     ROUTINES:                                                    */
*/*       BLSDMSG0      IPCS DM/PM MESSAGE TEXT BUILD FUNCTION       */
*/*                                                                  */
*/*     DATA AREAS: SEE SYMBOLS DEFINED UNDER DEPENDENCIES           */
*/*                                                                  */
*/*     CONTROL BLOCKS: DMCB      R,W                                */
*/*                     BLSDMSGS  R                                  */
*/*                     ZZ2       R                                  */
*/*                                                                  */
*/*   TABLES/WORKAREAS: NONE                                         */
*/*                                                                  */
*/*   MACROS: BLSDMSG                                                */
*/*                                                                  */
*/*   CHANGE ACTIVITY:                                               */
*/*     THIS MODULE IS WRITTEN FOR @G57LPSR.                         */
*/*                                                                  */
*/*   MESSAGES ISSUED:                                               */
*/*        BLS03110I LINK SVC TO LINKNAME FROM MODNAME FAILED.       */
*/*                  ABEND CODE=XXXXXXXX, REASON CODE=YYYYYYYY       */
*/*                                                                  */
*/*   ABEND CODES:  NONE                                             */
*/*                                                                  */
*/*   DATA SETS ACCESSED:  NONE                                      */
*/*                                                                  */
*/*** END OF SPECIFICATIONS*******************************************/
*                                                                  0134
*LINKERR:                                                          0134
*   RFY                                                            0134
*    (GPR01F,                                                      0134
*     GPR15F) RSTD;                                                0134
LINKERR  DS    0H                                                  0135
*   ABENDC=GPR01F;                  /* SAVE THE ABEND CODE           */
         LR    ABENDC,GPR01F                                       0135
*   REASON=GPR15F;                  /* SAVE THE ABEND REASON CODE    */
         LR    REASON,GPR15F                                       0136
*   RFY                                                            0137
*    (GPR01F,                                                      0137
*     GPR15F) UNRSTD;                                              0137
*   CHSTR847=ABENDC;                /* GET ABEND CODE FIELD          */
         STCM  ABENDC,15,CHSTR847                                  0138
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0139
*   UNPK(CTEMP,CHSTR8);                                            0140
         UNPK  CTEMP(9),CHSTR8(8)                                  0140
*   TR(CTEMP,HEXTBL);                                              0141
         TR    CTEMP(9),HEXTBL                                     0141
*   RESULT=CTEMP18;                 /* STORE THE RESULT              */
         MVC   RESULT(8),CTEMP18                                   0142
*   CHSTR847=REASON;                /* GET REASON CODE FIELD         */
         STCM  REASON,15,CHSTR847                                  0143
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0144
*   UNPK(CTEMP,CHSTR8);                                            0145
         UNPK  CTEMP(9),CHSTR8(8)                                  0145
*   TR(CTEMP,HEXTBL);                                              0146
         TR    CTEMP(9),HEXTBL                                     0146
*   DO;                             /* BLSDMSG                     0147
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)
*                                      INSERT(LINKNAME,MODNAME,RESULT
*                                      ,CTEMP18)                     */
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */
         LA    @10,IOPTLIST+12                                     0148
         ST    @10,IOPTLIST                                        0148
*     IOPTLIST(2)=ADDR(LINKNAME);   /* INSERT NAME POINTER           */
         LA    @10,@CC00402                                        0149
         ST    @10,IOPTLIST+4                                      0149
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0150
         ST    @10,IOPTLIST+8                                      0150
*     RFY                                                          0151
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(LINKNAME);       /* INSERT LENGTH                 */
         LA    @04,8                                               0152
         LA    @15,IOPTLIST+8                                      0152
         STH   @04,I015F(,@15)                                     0152
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */
         LA    @15,IOPTLIST+24                                     0153
         ST    @15,IOPTLIST+12                                     0153
*     IOPTLIST(5)=ADDR(MODNAME);    /* INSERT NAME POINTER           */
         LA    @15,MODNAME                                         0154
         ST    @15,IOPTLIST+16                                     0154
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0155
*     RFY                                                          0156
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(MODNAME);        /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+20                                     0157
         STH   @04,I015F(,@15)                                     0157
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */
         LA    @15,IOPTLIST+36                                     0158
         ST    @15,IOPTLIST+24                                     0158
*     IOPTLIST(8)=ADDR(RESULT);     /* INSERT NAME POINTER           */
         LA    @15,RESULT                                          0159
         ST    @15,IOPTLIST+28                                     0159
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0160
*     RFY                                                          0161
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(RESULT);         /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+32                                     0162
         STH   @04,I015F(,@15)                                     0162
*     IOPTLIST(10)=0;               /* LAST INSERT                   */
         ST    @10,IOPTLIST+36                                     0163
*     IOPTLIST(11)=ADDR(CTEMP18);   /* INSERT NAME POINTER           */
         LA    @15,CTEMP18                                         0164
         ST    @15,IOPTLIST+40                                     0164
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0165
*     RFY                                                          0166
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(CTEMP18);        /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+44                                     0167
         STH   @04,I015F(,@10)                                     0167
*     CALL BLSDMSG0(ZZ2,F3110C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0168
*         IOPTLIST));               /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0168
         ST    @10,@AL00001                                        0168
         LA    @10,@CF00384                                        0168
         ST    @10,@AL00001+4                                      0168
         LA    @10,DMCBMSG(,DMCBPTR)                               0168
         ST    @10,@AL00001+8                                      0168
         L     @10,DMCBMSGS(,DMCBPTR)                              0168
         ST    @10,@AL00001+12                                     0168
         LA    @10,@CB00411                                        0168
         ST    @10,@AL00001+16                                     0168
         LA    @10,IOPTLIST                                        0168
         ST    @10,@AFTEMPS                                        0168
         LA    @10,@AFTEMPS                                        0168
         ST    @10,@AL00001+20                                     0168
         L     @15,DMCBMSG0(,DMCBPTR)                              0168
         LA    @01,@AL00001                                        0168
         BALR  @14,@15                                             0168
*   END;                            /* BLSDMSG                     0169
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)
*                                      INSERT(LINKNAME,MODNAME,RESULT
*                                      ,CTEMP18) BUILD LINK SVC ERROR
*                                      MESSAGE                       */
*   RETCODE=ERROR;                  /* MARK ERROR TO CALLER          */
         MVC   RETCODE(4),@CF00044                                 0170
*   END INVAMS;                     /* INVOKE IDCAMS TO GET SPACE FOR
*                                      DATA SET                      */
         B     @EL00002                                            0171
         EJECT
*                                                                  0172
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO BUILD IDCAMS SYSIN STREAM                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0172
*BLDSTR:                                                           0172
*   PROCEDURE(BLDSTRP);             /* BUILD IDCAMS SYSIN STREAM     */
BLDSTR   STM   @14,@12,@SA00003                                    0172
         MVC   @PC00003(4),0(@01)                                  0172
*   DCL                                                            0173
*     BLDSTRP PTR(31),              /* PASSED TEXT RECORD STREAM PTR */
*     MAMSLP PTR(31),               /* WORK TEXT RECORD STREAM PTR   */
*     MVLEN FIXED(31),              /* MODEL SYSIN TEXT MOVE LENGTH  */
*     RECLEN BIN(31);               /* LENGTH OF INREC               */
*   MAMSLP=BLDSTRP;                 /* HEAD OF AMS TEXT RECORD STREAM*/
         L     @10,@PC00003                                        0174
         L     MAMSLP,BLDSTRP(,@10)                                0174
*   RFY                                                            0175
*     MMAMSREC BASED(MAMSLP);       /* BASE THE MODEL AMS TEXT RECORD
*                                      MAP                           */
*   MVLEN=MMAMSLEN;                 /* INIT RECORD LENGTH            */
         SLR   MVLEN,MVLEN                                         0176
         ICM   MVLEN,3,MMAMSLEN(MAMSLP)                            0176
*   DO WHILE MVLEN>F0C&RETCODE=F0C; /* LOOP THRU IDCAMS TEXT RECORDS */
         B     @DE00177                                            0177
@DL00177 DS    0H                                                  0178
*     RECLEN=MAX(LENGTH(INRECF),MVLEN);/* LENGTH OF INREC            */
         LA    RECLEN,68                                           0178
         CR    RECLEN,MVLEN                                        0178
         BNL   *+6
         LR    RECLEN,MVLEN                                        0178
*     DO;                           /* GETMAIN (RC) LV(RECLEN+F4C) 0179
*                                      SP(DMCBSPID) RTCD(SUBCODE)    */
*       RESPECIFY                                                  0180
*        (GPR01F,                                                  0180
*         GPR15F,                                                  0180
*         GPR00F) RESTRICTED;                                      0180
*       GPR01F=0;                   /* REG 1 MUST BE ZERO            */
         SLR   GPR01F,GPR01F                                       0181
*       GPR15F=0;                   /* RC-TYPE GETMAIN               */
         SLR   GPR15F,GPR15F                                       0182
*       GPR00F=RECLEN+F4C;          /* LENGTH REQUESTED              */
         LA    GPR00F,4                                            0183
         ALR   GPR00F,RECLEN                                       0183
*       GPR15F=GPR15F×((DMCBSPID)*256);/* SP IN BYTE 2               */
         SLR   @14,@14                                             0184
         IC    @14,DMCBSPID(,DMCBPTR)                              0184
         SLA   @14,8                                               0184
         OR    GPR15F,@14                                          0184
*       SVC(120);                   /* RC/RU-FORM OF GETMAIN         */
         SVC   120                                                 0185
*       SUBCODE=GPR15F;             /* SET RETURN CODE               */
         ST    GPR15F,SUBCODE                                      0186
*       RESPECIFY                                                  0187
*        (GPR01F,                                                  0187
*         GPR15F,                                                  0187
*         GPR00F) UNRESTRICTED;                                    0187
*     END;                          /* GETMAIN (RC) LV(RECLEN+F4C) 0188
*                                      SP(DMCBSPID) RTCD(SUBCODE)  0188
*                                      SPACE FOR TEXT LINE           */
*     RFY                                                          0189
*       GPR01P RSTD;                                               0189
*     INPTR=GPR01P;                 /* ADDRESS OF TEXT LINE          */
         ST    GPR01P,INPTR                                        0190
*     RFY                                                          0191
*       GPR01P UNRSTD;                                             0191
*     IF SUBCODE^=F0C THEN          /* TEST FOR GETMAIN ERROR        */
         L     @10,SUBCODE                                         0192
         LTR   @10,@10                                             0192
         BZ    @RF00192                                            0192
*       DO;                         /* GETMAIN FAILED                */
*         RETCODE=ERROR;            /* NOTIFY CALLER                 */
         MVC   RETCODE(4),@CF00044                                 0194
*         CALL BLSCGMF(DMCB,DMCBMSG,MODNAME);/* BUILD GETMAIN FAILURE
*                                      MESSAGE                       */
         ST    DMCBPTR,@AL00001                                    0195
         LA    @10,DMCBMSG(,DMCBPTR)                               0195
         ST    @10,@AL00001+4                                      0195
         LA    @10,MODNAME                                         0195
         ST    @10,@AL00001+8                                      0195
         L     @15,@CV00286                                        0195
         LA    @01,@AL00001                                        0195
         BALR  @14,@15                                             0195
*       END;                        /* GETMAIN FAILED                */
*     ELSE                                                         0197
*       DO;                         /* GETMAIN OK                    */
         B     @RC00192                                            0197
@RF00192 DS    0H                                                  0198
*         IF INHEAD=F0C THEN        /* TEST FOR FIRST ENTRY          */
         L     @10,INHEAD                                          0198
         LTR   @10,@10                                             0198
         BNZ   @RF00198                                            0198
*           INHEAD=INPTR;           /* INIT TEXT LIST HEADER         */
         L     @10,INPTR                                           0199
         ST    @10,INHEAD                                          0199
*         ELSE                                                     0200
*           DO;                     /* NOT FIRST SYSIN TEXT LINE     */
         B     @RC00198                                            0200
@RF00198 DS    0H                                                  0201
*             INTAIL->INNEXT=INPTR; /* HOOK THIS LINE TO LIST        */
         L     @10,INPTR                                           0201
         L     @09,INTAIL                                          0201
         ST    @10,INNEXT(,@09)                                    0201
*           END;                    /* NOT FIRST SYSIN TEXT LINE     */
*         INTAIL=INPTR;             /* END OF LIST                   */
@RC00198 L     @10,INPTR                                           0203
         ST    @10,INTAIL                                          0203
*         INNEXT=F0C;               /* MARK END OF LIST              */
         SLR   @09,@09                                             0204
         ST    @09,INNEXT(,@10)                                    0204
*         INRECF=LBLNKC;            /* BLANK THE SYSIN TEXT RECORD 0205
*                                      AREA                          */
         MVI   INRECF+1(@10),C' '                                  0205
         MVC   INRECF+2(66,@10),INRECF+1(@10)                      0205
         MVI   INRECF(@10),C' '                                    0205
*         INREC(F1C:MVLEN)=MMAMSREC(F1C:MVLEN);/* MOVE RECORD TO   0206
*                                      SYSIN LIST                    */
         LR    @09,MVLEN                                           0206
         BCTR  @09,0                                               0206
         EX    @09,@SM00525                                        0206
*         INLEN=RECLEN;             /* FORCE CORRECT LENGTH FOR    0207
*                                      FREEMAIN                      */
         STH   RECLEN,INLEN(,@10)                                  0207
*         CALL SCAN;                /* SEARCH FOR IDCAMS PARAMETERS
*                                      TO BE OVERRIDDEN              */
         BAL   @14,SCAN                                            0208
*         MAMSLP=MAMSLP+MVLEN;      /* BUMP MODEL RECORD BASE        */
         ALR   MAMSLP,MVLEN                                        0209
*         MVLEN=MMAMSLEN;           /* NEW RECORD LENGTH             */
         SLR   MVLEN,MVLEN                                         0210
         ICM   MVLEN,3,MMAMSLEN(MAMSLP)                            0210
*       END;                        /* GETMAIN OK                    */
*   END;                            /* LOOP THRU IDCAMS TEXT RECORDS */
@RC00192 DS    0H                                                  0212
@DE00177 SLR   @10,@10                                             0212
         CR    MVLEN,@10                                           0212
         BNH   @DC00177                                            0212
         C     @10,RETCODE                                         0212
         BE    @DL00177                                            0212
@DC00177 DS    0H                                                  0213
*   END BLDSTR;                     /* BUILD IDCAMS SYSIN STREAM     */
@EL00003 DS    0H                                                  0213
@EF00003 DS    0H                                                  0213
@ER00003 LM    @14,@12,@SA00003                                    0213
         BR    @14                                                 0213
         EJECT
*                                                                  0214
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO SCAN IDCAMS PARAMETER FOR OVERRIDE               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0214
*SCAN:                                                             0214
*   PROCEDURE;                                                     0214
SCAN     STM   @14,@12,@SA00004                                    0214
*   DCL                                                            0215
*     LCYLC CHAR(3) CONSTANT('CYL');/* LITERAL 'CYL'                 */
*   DCL                                                            0216
*     LTRKC CHAR(3) CONSTANT('TRK');/* LITERAL 'TRK'                 */
*   DCL                                                            0217
*     LLENDC CHAR(3) CONSTANT(') -');/* IDCAMS LINE END              */
*   DCL                                                            0218
*     LCYLSC CHAR(11) CONSTANT(' CYLINDERS(');/* IDCAMS VERB         */
*   DCL                                                            0219
*     LNAMEC CHAR(6) CONSTANT(' NAME(');/* IDCAMS VERB               */
*   DCL                                                            0220
*     LTRKSC CHAR(8) CONSTANT(' TRACKS(');/* IDCAMS VERB             */
*   DCL                                                            0221
*     LVOLSC CHAR(9) CONSTANT(' VOLUMES(');/* IDCAMS VERB            */
*   DCL                                                            0222
*     1 DSNTXT DEF(INTEXT),         /* NAME OVERRIDE MAP             */
*      2 DSNTYP CHAR(LENGTH(LNAMEC)),/* NAME VERB FIELD              */
*      2 DSNVAL CHAR(44),           /* DATA SET NAME                 */
*      2 DSNEND CHAR(LENGTH(LLENDC));/* LINE END TEXT                */
*   DCL                                                            0223
*     1 VOLTXT DEF(INTEXT),         /* VOLUMES OVERRIDE MAP          */
*      2 VOLTYP CHAR(LENGTH(LVOLSC)),/* VOLUMES VERB FIELD           */
*      2 VOLVAL CHAR(6),            /* VOLUME SERIAL                 */
*      2 VOLEND CHAR(LENGTH(LLENDC));/* LINE END TEXT                */
*   DCL                                                            0224
*     1 CYLTXT DEF(INTEXT),         /* CYLINDERS OVERRIDE MAP        */
*      2 CYLTYP CHAR(LENGTH(LCYLSC)),/* CYLINDERS VERB FIELD         */
*      2 CYLPRI CHAR(4),            /* PRIMARY ALLOCATION VALUE      */
*      2 * CHAR(1),                 /* 1 BLANK                       */
*      2 CYLSEC CHAR(4),            /* SECONDARY ALLOCATION VALUE    */
*      2 CYLEND CHAR(LENGTH(LLENDC));/* LINE END TEXT                */
*   DCL                                                            0225
*     1 TRKTXT DEF(INTEXT),         /* TRACKS OVERRIDE MAP           */
*      2 TRKTYP CHAR(LENGTH(LTRKSC)),/* TRACKS VERB FIELD            */
*      2 TRKPRI CHAR(4),            /* PRIMARY ALLOCATION VALUE      */
*      2 * CHAR(1),                 /* 1 BLANK                       */
*      2 TRKSEC CHAR(4),            /* SECONDARY ALLOCATION VALUE    */
*      2 TRKEND CHAR(LENGTH(LLENDC));/* LINE END TEXT                */
*   DCL                                                            0226
*     DMCBDSN1 CHAR(1) DEF(DMCBDSN);/* BYTE 1, LENGTH ONE            */
*   DCL                                                            0227
*     DMCBVOL1 CHAR(1) DEF(DMCBVOL);/* BYTE 1, LENGTH ONE            */
*   DCL                                                            0228
*     DMCBSPT1 CHAR(1) DEF(DMCBSPTY);/* BYTE 1, LENGTH ONE           */
         SPACE 1
*   IF DSNTYP=LNAMEC&               /* TEST FOR DATA SET NAME VERB   */
*       DMCBDSN1^=LHEX0C THEN       /* NON NULL OVERRIDE DATA SET  0229
*                                      NAME                          */
         L     @10,INPTR                                           0229
         CLC   DSNTYP(6,@10),@CC00471                              0229
         BNE   @RF00229                                            0229
         CLI   DMCBDSN1(DMCBPTR),X'00'                             0229
         BE    @RF00229                                            0229
*     DO;                           /* BUILD DATA SET NAME TEXT    0230
*                                      RECORD                        */
*       INTXTF=LNAMEC;              /* FILL IN VERB AND BLANK REST OF
*                                      RECORD                        */
         MVI   INTXTF+6(@10),C' '                                  0231
         MVC   INTXTF+7(57,@10),INTXTF+6(@10)                      0231
         MVC   INTXTF(6,@10),@CC00471                              0231
*       DSNVAL=DMCBDSN;             /* MOVE IN DATA SET NAME         */
         MVC   DSNVAL(44,@10),DMCBDSN(DMCBPTR)                     0232
*       DSNEND=LLENDC;              /* MOVE IN LINE END              */
         MVC   DSNEND(3,@10),@CC00466                              0233
*     END;                          /* BUILD DATA SET NAME TEXT    0234
*                                      RECORD                        */
*   IF VOLTYP=LVOLSC&               /* TEST FOR VOLUME SERIAL VERB   */
*       DMCBVOL1^=LHEX0C THEN       /* NON NULL OVERRIDE VOLUME    0235
*                                      SERIAL                        */
@RF00229 L     @10,INPTR                                           0235
         CLC   VOLTYP(9,@10),@CC00475                              0235
         BNE   @RF00235                                            0235
         CLI   DMCBVOL1(DMCBPTR),X'00'                             0235
         BE    @RF00235                                            0235
*     DO;                           /* BUILD VOLUME SERIAL TEXT    0236
*                                      RECORD                        */
*       INTXTF=LVOLSC;              /* FILL IN VERB AND BLANK REST OF
*                                      RECORD                        */
         MVI   INTXTF+9(@10),C' '                                  0237
         MVC   INTXTF+10(54,@10),INTXTF+9(@10)                     0237
         MVC   INTXTF(9,@10),@CC00475                              0237
*       VOLVAL=DMCBVOL;             /* MOVE IN VOLUME SERIAL         */
         MVC   VOLVAL(6,@10),DMCBVOL(DMCBPTR)                      0238
*       VOLEND=LLENDC;              /* MOVE IN LINE END              */
         MVC   VOLEND(3,@10),@CC00466                              0239
*     END;                          /* BUILD VOLUME SERIAL TEXT    0240
*                                      RECORD                        */
*   IF CYLTYP=LCYLSC×               /* TEST FOR SPACE IN CYLINDERS 0241
*                                      VERB                          */
*       TRKTYP=LTRKSC THEN          /* TEST FOR SPACE IN TRACKS VERB */
@RF00235 L     @10,INPTR                                           0241
         CLC   CYLTYP(11,@10),@CC00468                             0241
         BE    @RT00241                                            0241
         CLC   TRKTYP(8,@10),@CC00473                              0241
         BNE   @RF00241                                            0241
@RT00241 DS    0H                                                  0242
*     DO;                           /* SPACE SPECIFICATION VERB      */
*       IF DMCBSPT1=LBLNKC THEN     /* TEST NULL OVERRIDE SPACE    0243
*                                      SPECIFICATION                 */
         CLI   DMCBSPT1(DMCBPTR),C' '                              0243
         BE    @RT00243                                            0243
*         ;                         /* NULL OVERRIDE SPACE         0244
*                                      SPECIFICATION                 */
*       ELSE                                                       0245
*         DO;                       /* NON NULL OVERRIDE SPACE IN  0245
*                                      CYLINDERS                     */
*           IF DMCBSPTY=LCYLC&      /* OVERRIDE SPACE IN CYLINDERS   */
*               DMCBSPPR>F0C THEN   /* NON NULL PRIMARY SPACE VALUE  */
         CLC   DMCBSPTY(3,DMCBPTR),@CC00462                        0246
         BNE   @RF00246                                            0246
         L     @10,DMCBSPPR(,DMCBPTR)                              0246
         LTR   @10,@10                                             0246
         BNP   @RF00246                                            0246
*             DO;                   /* BUILD SPACE IN CYLINDERS TEXT
*                                      RECORD                        */
*               INTXTF=LCYLSC;      /* FILL IN VERB AND BLANK REST OF
*                                      RECORD                        */
         L     @10,INPTR                                           0248
         MVI   INTXTF+11(@10),C' '                                 0248
         MVC   INTXTF+12(52,@10),INTXTF+11(@10)                    0248
         MVC   INTXTF(11,@10),@CC00468                             0248
*               CALL BINCHAR(DMCBSPPR,CYLPRI);/* MOVE IN PRIMARY   0249
*                                      SPACE VALUE                   */
         LA    @04,DMCBSPPR(,DMCBPTR)                              0249
         ST    @04,@AL00001                                        0249
         LA    @10,CYLPRI(,@10)                                    0249
         ST    @10,@AL00001+4                                      0249
         LA    @01,@AL00001                                        0249
         BAL   @14,BINCHAR                                         0249
*               IF DMCBSPSE>F0C THEN/* NON NULL SECONDARY SPACE VALUE*/
         L     @10,DMCBSPSE(,DMCBPTR)                              0250
         LTR   @10,@10                                             0250
         BNP   @RF00250                                            0250
*                 CALL BINCHAR(DMCBSPSE,CYLSEC);/* MOVE IN SECONDARY
*                                      SPACE VALUE                   */
         LA    @10,DMCBSPSE(,DMCBPTR)                              0251
         ST    @10,@AL00001                                        0251
         L     @10,INPTR                                           0251
         LA    @10,CYLSEC(,@10)                                    0251
         ST    @10,@AL00001+4                                      0251
         LA    @01,@AL00001                                        0251
         BAL   @14,BINCHAR                                         0251
*               CYLEND=LLENDC;      /* MOVE IN LINE END              */
@RF00250 L     @10,INPTR                                           0252
         MVC   CYLEND(3,@10),@CC00466                              0252
*             END;                  /* BUILD SPACE IN CYLINDERS TEXT
*                                      RECORD                        */
*           ELSE                                                   0254
*             IF DMCBSPTY=LTRKC&    /* OVERRIDE SPACE IN TRACKS      */
*                 DMCBSPPR>F0C THEN /* NON NULL PRIMARY SPACE VALUE  */
         B     @RC00246                                            0254
@RF00246 CLC   DMCBSPTY(3,DMCBPTR),@CC00464                        0254
         BNE   @RF00254                                            0254
         L     @10,DMCBSPPR(,DMCBPTR)                              0254
         LTR   @10,@10                                             0254
         BNP   @RF00254                                            0254
*               DO;                 /* BUILD SPACE IN TRACKS TEXT  0255
*                                      RECORD                        */
*                 INTXTF=LTRKSC;    /* FILL IN VERB AND BLANK REST OF
*                                      RECORD                        */
         L     @10,INPTR                                           0256
         MVI   INTXTF+8(@10),C' '                                  0256
         MVC   INTXTF+9(55,@10),INTXTF+8(@10)                      0256
         MVC   INTXTF(8,@10),@CC00473                              0256
*                 CALL BINCHAR(DMCBSPPR,TRKPRI);/* MOVE IN PRIMARY 0257
*                                      SPACE VALUE                   */
         LA    @04,DMCBSPPR(,DMCBPTR)                              0257
         ST    @04,@AL00001                                        0257
         LA    @10,TRKPRI(,@10)                                    0257
         ST    @10,@AL00001+4                                      0257
         LA    @01,@AL00001                                        0257
         BAL   @14,BINCHAR                                         0257
*                 IF DMCBSPSE>F0C THEN/* NON NULL SECONDARY SPACE  0258
*                                      VALUE                         */
         L     @10,DMCBSPSE(,DMCBPTR)                              0258
         LTR   @10,@10                                             0258
         BNP   @RF00258                                            0258
*                   CALL BINCHAR(DMCBSPSE,TRKSEC);/* MOVE IN       0259
*                                      SECONDARY SPACE VALUE         */
         LA    @10,DMCBSPSE(,DMCBPTR)                              0259
         ST    @10,@AL00001                                        0259
         L     @10,INPTR                                           0259
         LA    @10,TRKSEC(,@10)                                    0259
         ST    @10,@AL00001+4                                      0259
         LA    @01,@AL00001                                        0259
         BAL   @14,BINCHAR                                         0259
*                 TRKEND=LLENDC;    /* MOVE IN LINE END              */
@RF00258 L     @10,INPTR                                           0260
         MVC   TRKEND(3,@10),@CC00466                              0260
*               END;                /* BUILD SPACE IN TRACKS TEXT  0261
*                                      RECORD                        */
*         END;                      /* NON NULL OVERRIDE SPACE IN  0262
*                                      TRACKS                        */
*     END;                          /* SPACE SPECIFICATION VERB      */
*   END SCAN;                                                      0264
@EL00004 DS    0H                                                  0264
@EF00004 DS    0H                                                  0264
@ER00004 LM    @14,@12,@SA00004                                    0264
         BR    @14                                                 0264
         SPACE 2
*                                                                  0265
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO CONVERT A BINARY INTEGER TO 4 BYTE CHARACTER     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*BINCHAR:                                                          0265
*   PROCEDURE(BCSRC,BCRES);                                        0265
BINCHAR  STM   @14,@12,12(@13)                                     0265
         MVC   @PC00005(8),0(@01)                                  0265
*   DCL                                                            0266
*     BCSRC BIN(31),                /* SOURCE IN BINARY              */
*     BCRES CHAR(4),                /* RESULT FIELD 4 BYTE CHARACTER */
*     BCI BIN(31),                  /* DO LOOP INDEX                 */
*     1 BCWRK CHAR(8) BDY(DWORD),   /* PACKED RESULT OF CONVERT TO 0266
*                                      DECIMAL                       */
*      2 BCWRES CHAR(7),            /* PLACE HOLDER                  */
*      2 BCWRK88 CHAR(1);           /* LOW ORDER DIGIT AN SIGN       */
*   CVD(BCSRC,BCWRK);               /* CONVERT SOURCE TO PACKED      */
         L     @10,@PC00005                                        0267
         L     @10,BCSRC(,@10)                                     0267
         CVD   @10,BCWRK                                           0267
*   BCWRK88=BCWRK88×LHEX0FC;        /* MAKE RESULT UNSIGNED          */
         OI    BCWRK88,X'0F'                                       0268
*   UNPK(BCRES,BCWRK);              /* UNPACK TO CHARACTER           */
         L     @10,@PC00005+4                                      0269
         UNPK  BCRES(4,@10),BCWRK(8)                               0269
*   DO BCI=F1C TO LENGTH(BCRES)-F1C WHILE BCRES(BCI)=F0C;/* BLANK  0270
*                                      LEADING ZEROS                 */
         LA    BCI,1                                               0270
@DL00270 L     @10,@PC00005+4                                      0270
         LR    @03,BCI                                             0270
         BCTR  @03,0                                               0270
         SLR   @15,@15                                             0270
         IC    @15,BCRES(@03,@10)                                  0270
         C     @15,@CF00190                                        0270
         BNE   @DC00270                                            0270
*     BCRES(BCI)=LBLNKC;                                           0271
         ALR   @10,BCI                                             0271
         BCTR  @10,0                                               0271
         MVI   BCRES(@10),C' '                                     0271
*   END;                            /* BLANK LEADING ZEROS           */
         AL    BCI,@CF00046                                        0272
         C     BCI,@CF00101                                        0272
         BNH   @DL00270                                            0272
@DC00270 DS    0H                                                  0273
*   END BINCHAR;                                                   0273
@EL00005 DS    0H                                                  0273
@EF00005 DS    0H                                                  0273
@ER00005 LM    @14,@12,12(@13)                                     0273
         BR    @14                                                 0273
         EJECT
*                                                                  0274
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0274
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                     0274
*     GPR01F FIXED(31) REG(1),                                     0274
*     GPR15F FIXED(31) REG(15),                                    0274
*     GPR01P PTR(31) REG(1),                                       0274
*     GPR15P PTR(31) REG(15);                                      0274
*   DCL                                                            0275
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */
*      2 I00602 PTR(24),            /* EP/DE PTR                     */
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */
*      2 I00604 PTR(24),            /* DCB PTR                       */
*      2 I00605 PTR(31);            /* ERRET PTR                     */
*   DECLARE                                                        0276
*     ILIST CHAR(12) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0277
*     I031F FIXED(31) BASED,                                       0277
*     I031P PTR(31) BASED,                                         0277
*     I015F FIXED(15) BASED,                                       0277
*     I015P PTR(15) BASED,                                         0277
*     I008P PTR(8) BASED,                                          0277
*     I001C CHAR(1) BASED;                                         0277
*   DECLARE                                                        0278
*     IOPTLIST(12) PTR(31) BDY(WORD);/* OPTION LIST ARRAY            */
*   DCL                                                            0279
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0279
*   GEN DATA DEFS(HEXTBL);                                         0280
*   END BLSCAAMS                                                   0281
*                                                                  0281
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (BLSCAMOM)                                       */
*/*%INCLUDE SYSLIB  (BLSDMSGD)                                       */
*/*%INCLUDE SYSLIB  (BLSCAMCB)                                       */
*/*%INCLUDE SYSLIB  (BLSCLKR )                                       */
*                                                                  0281
*       ;                                                          0281
@EL00001 L     @13,4(,@13)                                         0281
@EF00001 L     @00,@SIZDATD                                        0281
         LR    @01,@11                                             0281
         BLSCFRES R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0281
         BR    @14                                                 0281
@DATA    DS    0H
@SM00525 MVC   INREC(0,@10),MMAMSREC(MAMSLP)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00003 DS    15F
@PC00003 DS    1F
@SA00002 DS    15F
@SA00004 DS    15F
@PC00005 DS    2F
@AL00001 DS    6A
@AFTEMPS DS    2F
BLSCAAMS CSECT
         DS    0F
@CF00190 DC    F'0'
@CF00046 DC    F'1'
@CF00072 DC    F'2'
@CF00101 DC    F'3'
@CF00044 DC    F'8'
@CH00044 EQU   @CF00044+2
@CF00382 DC    F'3108'
@CF00384 DC    F'3110'
@CF00386 DC    F'3111'
@CF00370 DC    XL4'80000000'
@DATD    DSECT
         DS    0D
MMTUP    DS    AL4
         ORG   MMTUP
MMTUPND  DS    BL1
         ORG   MMTUP+4
MODSTAT  DS    CL16
         ORG   MODSTAT
MODNAME  DS    CL8
RETCODE  DS    FL4
SUBCODE  DS    FL4
         ORG   MODSTAT+16
RESULT   DS    CL8
         DS    CL4
CHSTR8   DS    CL8
         ORG   CHSTR8
CHSTR813 DS    CL3
CHSTR847 DS    CL4
CHSTR88  DS    CL1
         ORG   CHSTR8+8
CTEMP    DS    CL9
         ORG   CTEMP
CTEMP18  DS    CL8
         ORG   CTEMP+9
         DS    CL3
BLSCAMCB DS    CL96
         ORG   BLSCAMCB
MCBOPTL  DS    CL4
MCBDNAML DS    CL4
MCBPNL   DS    CL4
MCBIOL   DS    CL28
MCBINCB  DS    CL24
MCBOUCB  DS    CL24
MCBINPTR DS    AL4
MCBOUPTR DS    AL4
         ORG   BLSCAMCB+96
         DS    CL4
BCWRK    DS    CL8
         ORG   BCWRK
BCWRES   DS    CL7
BCWRK88  DS    CL1
         ORG   BCWRK+8
ILIST    DS    CL12
IOPTLIST DS    12A
BLSCAAMS CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00284 DC    V(BLSCAMIN)
@CV00285 DC    V(BLSCAMPR)
@CV00286 DC    V(BLSCGMF)
@CV00287 DC    V(BLSCHOK)
@CV00288 DC    V(BLSCAMOD)
         DS    0D
@CC00468 DC    C' CYLINDERS('
@CC00359 DC    C'DDSYSIN   '
@CC00362 DC    C'DDSYSPRINT'
@CC00475 DC    C' VOLUMES('
@CC00400 DC    C'BLSCAAMS'
@CC00402 DC    C'IDCAMS  '
@CC00473 DC    C' TRACKS('
@CC00471 DC    C' NAME('
@CC00462 DC    C'CYL'
@CC00464 DC    C'TRK'
@CC00466 DC    C') -'
@CB00394 DC    X'00'
@CB00411 DC    B'00000000'
         DS    CL7
DASPATCH DS    CL80
         ORG   DASPATCH
DASPATA  DC    20A(0)
         ORG   DASPATCH+80
BLSCAAMS CSECT
*                         /*
HEXTBL   EQU   *-240
         DC    CL16'0123456789ABCDEF'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSCAAMS CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
BCI      EQU   @02
RECLEN   EQU   @08
MVLEN    EQU   @06
MAMSLP   EQU   @07
REASON   EQU   @06
ABENDC   EQU   @04
OUFPTR   EQU   @05
MODELPTR EQU   @02
DMCBPTR  EQU   @05
GPR01P   EQU   @01
GPR15P   EQU   @15
GPR15F   EQU   @15
GPR01F   EQU   @01
GPR00F   EQU   @00
DMCB     EQU   0
DMCBTVP  EQU   DMCB+8
DMCBFTY  EQU   DMCB+20
DMCBOPN  EQU   DMCB+21
DMCBRMOD EQU   DMCB+23
DMCBOUT  EQU   DMCBRMOD
DMCBOPTS EQU   DMCB+24
DMCBGKY  EQU   DMCBOPTS
DMCBMFLG EQU   DMCB+28
DMCBBUFP EQU   DMCB+32
DMCBKEYP EQU   DMCB+44
DMCBMSG  EQU   DMCB+52
DMCBRI   EQU   DMCB+64
DMCBMSG0 EQU   DMCB+68
DMCBMSGS EQU   DMCB+72
DMCBSPID EQU   DMCB+84
DMCBFRE  EQU   DMCB+88
DMCBEOB  EQU   DMCB+92
DMCBACBE EQU   DMCB+124
DMCBVOL  EQU   DMCB+268
DMCBDSN  EQU   DMCB+284
DMCBMODL EQU   DMCB+348
DMCBSPTY EQU   DMCB+369
DMCBSPPR EQU   DMCB+372
DMCBSPSE EQU   DMCB+376
DMCBSPEC EQU   DMCB+380
DMCBAMS  EQU   DMCB+416
DMCBAUDT EQU   DMCB+568
DMCBLSCP EQU   DMCBAUDT+16
DMCBWRK  EQU   DMCB+648
MODLMAP  EQU   0
MMACBDCB EQU   MODLMAP+16
MMRPLP   EQU   MODLMAP+20
MMOPCLP  EQU   MODLMAP+24
MMDYRBP  EQU   MODLMAP+28
MMAMSLP  EQU   MODLMAP+32
MMACB    EQU   0
MMDYRB   EQU   0
MMAMSREC EQU   0
MMAMSLEN EQU   MMAMSREC
MMTUPL   EQU   0
MMTUPTR  EQU   MMTUPL
MMTUNIT  EQU   0
MMTUENT  EQU   MMTUNIT+4
MSGDENT  EQU   0
MSGDPRF  EQU   MSGDENT
MSGDSPID EQU   MSGDPRF
MSGDFLEN EQU   MSGDPRF+1
MSGDWRT  EQU   MSGDENT+8
MSGDMOV  EQU   MSGDWRT+4
MSGWENT  EQU   0
MSGWNXT  EQU   MSGWENT
MSGWMOV  EQU   MSGWENT+4
BLSDMSGS EQU   0
BLSDMSG0 EQU   0
ZZ2      EQU   0
INENT    EQU   0
INNEXT   EQU   INENT
INLEN    EQU   INENT+4
INTEXT   EQU   INENT+8
OUENT    EQU   0
I015F    EQU   0
DMCBDMGR EQU   0
DMCBRQC  EQU   0
I001C    EQU   0
I008P    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
MMAMSL   EQU   0
MMDCB    EQU   0
MMOPCL   EQU   0
MMRPL    EQU   0
MODELNAM EQU   0
BLDSTRP  EQU   0
BCSRC    EQU   0
BCRES    EQU   0
DMCBVSM  EQU   DMCBAMS
DMCBQSM  EQU   DMCBAMS
DMAL     EQU   DMCBWRK
DMALMODA EQU   DMAL+4
DMALMODP EQU   DMAL+12
MMACBMCF EQU   MMACB+12
MMACBMC1 EQU   MMACBMCF
MMRB     EQU   MMDYRB
MMRSC    EQU   MMRB+4
MMTXTPP  EQU   MMRB+8
OUPTR    EQU   MCBOUPTR
AMSOPTL  EQU   MCBOPTL
OPTLLEN  EQU   AMSOPTL
AMSDNAML EQU   MCBDNAML
DNAMLLEN EQU   AMSDNAML
AMSPNL   EQU   MCBPNL
PNLLEN   EQU   AMSPNL
AMSIOL   EQU   MCBIOL
IOLNUM   EQU   AMSIOL
IOLINDDP EQU   AMSIOL+4
IOLMINP  EQU   AMSIOL+8
IOLINCBP EQU   AMSIOL+12
IOLOUDDP EQU   AMSIOL+16
IOLMPRP  EQU   AMSIOL+20
IOLOUCBP EQU   AMSIOL+24
INCB     EQU   MCBINCB
INHEAD   EQU   INCB
INCUR    EQU   INCB+4
INTAIL   EQU   INCB+8
OUCB     EQU   MCBOUCB
OUHEAD   EQU   OUCB
OUCUR    EQU   OUCB+4
OUTAIL   EQU   OUCB+8
INPTR    EQU   MCBINPTR
INREC    EQU   INENT+4
INRECF   EQU   INENT+4
INTXTF   EQU   INRECF+4
I006     EQU   ILIST
I00601   EQU   I006
I00602   EQU   I006+1
I00603   EQU   I006+4
I00604   EQU   I006+5
I00605   EQU   I006+8
DSNTXT   EQU   INTEXT
DSNTYP   EQU   DSNTXT
DSNVAL   EQU   DSNTXT+6
DSNEND   EQU   DSNTXT+50
VOLTXT   EQU   INTEXT
VOLTYP   EQU   VOLTXT
VOLVAL   EQU   VOLTXT+9
VOLEND   EQU   VOLTXT+15
CYLTXT   EQU   INTEXT
CYLTYP   EQU   CYLTXT
CYLPRI   EQU   CYLTXT+11
CYLSEC   EQU   CYLTXT+16
CYLEND   EQU   CYLTXT+20
TRKTXT   EQU   INTEXT
TRKTYP   EQU   TRKTXT
TRKPRI   EQU   TRKTXT+8
TRKSEC   EQU   TRKTXT+13
TRKEND   EQU   TRKTXT+17
DMCBDSN1 EQU   DMCBDSN
DMCBVOL1 EQU   DMCBVOL
DMCBSPT1 EQU   DMCBSPTY
OUREC    EQU   OUENT+4
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00002 EQU   TRKTXT+12
@NM00001 EQU   CYLTXT+15
INRES    EQU   INRECF
OURESV01 EQU   OUCB+20
OUECODE  EQU   OUCB+16
OURCODE  EQU   OUCB+12
INRESV01 EQU   INCB+20
INECODE  EQU   INCB+16
INRCODE  EQU   INCB+12
PNLTXT   EQU   AMSPNL+2
DNAMLENT EQU   AMSDNAML+2
OPTLTXT  EQU   AMSOPTL+2
MMFLAG2  EQU   MMRB+16
MMRSV01  EQU   MMRB+12
MMINFO   EQU   MMRSC+2
MMERROR  EQU   MMRSC
MMFLAG1  EQU   MMRB+2
MMVERB   EQU   MMRB+1
MMRBLN   EQU   MMRB
MMACBKEY EQU   MMACBMC1
DMALEND  EQU   DMAL+1196
DMALTUS  EQU   DMAL+172
DMALTUPL EQU   DMAL+44
DMALTUBS EQU   DMAL+40
DMALTUPM EQU   DMAL+36
DMALDYRB EQU   DMAL+16
DMALPRMP EQU   DMAL+8
DMALID   EQU   DMAL
DMCBRES7 EQU   DMCBQSM+96
DMCBDCB  EQU   DMCBQSM
DMCBACB  EQU   DMCBVSM+76
DMCBRPL  EQU   DMCBVSM
OUTEXT   EQU   OUENT+8
OUPAD    EQU   OUENT+6
OULEN    EQU   OUENT+4
OUNEXT   EQU   OUENT
INPAD    EQU   INENT+6
MSGWTXT  EQU   MSGWMOV+4
MSGWPAD  EQU   MSGWMOV+2
MSGWLEN  EQU   MSGWMOV
MSGDTXT  EQU   MSGDMOV+4
MSGDPAD  EQU   MSGDMOV+2
MSGDLEN  EQU   MSGDMOV
MSGDNXT  EQU   MSGDWRT
MSGDBAK  EQU   MSGDPRF+4
MMTUPAR  EQU   MMTUENT+2
MMTULNG  EQU   MMTUENT
MMTUNUM  EQU   MMTUNIT+2
MMTUKEY  EQU   MMTUNIT
MMTUPLN  EQU   MMTUPTR
MMAMSTXT EQU   MMAMSREC+4
MMAMSPAD EQU   MMAMSREC+2
MMACBID  EQU   MMACB
MMRRL    EQU   MODLMAP+36
MMNAME   EQU   MODLMAP+8
MMRESV1  EQU   MODLMAP+4
MMNXMOD  EQU   MODLMAP
DMCBRES8 EQU   DMCB+640
DMCBMODN EQU   DMCB+632
DMCBCARY EQU   DMCBAUDT+20
DMCBCLC  EQU   DMCBAUDT+12
DMCBOPC  EQU   DMCBAUDT+8
DMCBFRC  EQU   DMCBAUDT+4
DMCBALC  EQU   DMCBAUDT
DMCBFR   EQU   DMCB+412
DMCBRES6 EQU   DMCB+410
DMCBIRSC EQU   DMCB+408
DMCBSUBC EQU   DMCB+404
DMCBDRBP EQU   DMCB+400
DMCBRSZM EQU   DMCB+398
DMCBRSZA EQU   DMCB+396
DMCBCISZ EQU   DMCB+394
DMCBDCBL EQU   DMCB+392
DMCBDCLR EQU   DMCB+390
DMCBDCFM EQU   DMCB+389
DMCBRES5 EQU   DMCB+388
DMCBLBRT EQU   DMCB+386
DMCBLBSQ EQU   DMCB+384
DMCBLBPS EQU   DMCB+383
DMCBLBTY EQU   DMCB+382
DMCBRES4 EQU   DMCB+381
DMCBSPRS EQU   DMCBSPEC
DMCBSPRN EQU   DMCBSPEC
DMCBSPCT EQU   DMCBSPEC
DMCBSPRL EQU   DMCBSPEC
DMCBODIS EQU   DMCB+368
DMCBDISP EQU   DMCB+367
DMCBSTAT EQU   DMCB+366
DMCBRES3 EQU   DMCB+364
DMCBMEMB EQU   DMCB+356
DMCBRES9 EQU   DMCB+340
DMCBPID  EQU   DMCB+332
DMCBTYPE EQU   DMCB+328
DMCBUNIT EQU   DMCB+276
DMCBDSOR EQU   DMCB+274
DMCBDDNM EQU   DMCB+260
DMCBSYNM EQU   DMCB+132
DMCBRPLF EQU   DMCB+128
DMCBDCBE EQU   DMCBACBE
DMCBARC  EQU   DMCB+120
DMCBCPC  EQU   DMCB+116
DMCBRET  EQU   DMCB+112
DMCBSTL  EQU   DMCB+96
DMCBRES2 EQU   DMCB+85
DMCBRESC EQU   DMCB+80
DMCBZZ1P EQU   DMCB+76
DMCBRRL  EQU   DMCB+60
DMCBRBA  EQU   DMCB+56
DMCBKEYL EQU   DMCB+48
DMCBKPC  EQU   DMCBKEYP
DMCBORL  EQU   DMCB+40
DMCBBLEN EQU   DMCB+36
DMCBBFPC EQU   DMCBBUFP
DMCBRES1 EQU   DMCB+31
DMCBACCM EQU   DMCB+30
DMCBREJ  EQU   DMCB+29
DMCBRESB EQU   DMCBMFLG
DMCBFMOD EQU   DMCBMFLG
DMCBLOPT EQU   DMCB+27
DMCBLRM  EQU   DMCB+26
DMCBLRQ  EQU   DMCB+25
DMCBOPRS EQU   DMCBOPTS
DMCBLRD  EQU   DMCBOPTS
DMCBBWD  EQU   DMCBOPTS
DMCBUPD  EQU   DMCBOPTS
DMCBAPX  EQU   DMCBOPTS
DMCBRNO  EQU   DMCBGKY
DMCBKYD  EQU   DMCBOPTS
DMCBRMRS EQU   DMCBRMOD
DMCBRM5  EQU   DMCBRMOD
DMCBRM6  EQU   DMCBRMOD
DMCBTMP  EQU   DMCBOUT
DMCBRQST EQU   DMCB+22
DMCBRESA EQU   DMCBOPN
DMCBSOUT EQU   DMCBOPN
DMCBSIN  EQU   DMCBOPN
DMCBVSF  EQU   DMCBFTY
DMCBKSF  EQU   DMCBFTY
DMCBFTRS EQU   DMCBFTY
DMCBSHF  EQU   DMCBFTY
DMCBIRL  EQU   DMCB+16
DMCBRTC  EQU   DMCB+12
DMCBNEXT EQU   DMCB+4
DMCBID   EQU   DMCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00095 EQU   @EL00002
@RF00241 EQU   @EL00004
@RT00243 EQU   @EL00004
@RF00254 EQU   @EL00004
@RC00246 EQU   @EL00004
@ENDDATA EQU   *
         END   BLSCAAMS,(C'PLS1144',0701,78062)

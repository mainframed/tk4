         TITLE 'EP=BLSCANAL -- IPCS DAS DYNALLOC ERROR ANALYZER INTERFA*
               ACE      '
BLSCANAL CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'BLSCANAL  78.062'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         BLSCGETS R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
*   DMCBPTR=GPR01P;                 /* BASE THE DMCB                 */
         LR    DMCBPTR,GPR01P                                      0028
*   RFY                                                            0029
*     GPR01P UNRSTD;                                               0029
*   MODNAME=LMODNMC;                /* INIT THE MODULE NAME          */
         MVC   MODNAME(8),@CC00344                                 0030
*   RETCODE=F0C;                    /* INIT THE MODULE RETURN CODE   */
         SLR   @10,@10                                             0031
         ST    @10,RETCODE                                         0031
*   SUBCODE=F0C;                    /* INIT THE SUBROUTINE RETURN  0032
*                                      CODE                          */
*                                                                  0032
         ST    @10,SUBCODE                                         0032
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE IPCS BASIC DYNALLOC ERROR MESSAGE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0033
*   CALL BASEMSG;                   /* ISSUE THE IPCS BASIC DYNALLOC
*                                      ERROR MESSAGE                 */
*                                                                  0033
         BAL   @14,BASEMSG                                         0033
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE DAIRFAIL PARAMETER LIST                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0034
*   DFS99RBP=DMCBDRBP;              /* ADDRESS OF DYNALLOC REQUEST 0034
*                                      BLCOK                         */
         L     @10,DMCBDRBP(,DMCBPTR)                              0034
         ST    @10,DFS99RBP                                        0034
*   DFRCP=ADDR(DMCBSUBC);           /* ADDRESS OF DYNALLOC RETURN  0035
*                                      CODE                          */
         LA    @10,DMCBSUBC(,DMCBPTR)                              0035
         ST    @10,DFRCP                                           0035
*   DFJEFF02=ADDR(LDFMSGWT);        /* TSO MESSAGE WRITER ENTRY POINT*/
         LA    @10,LDFMSGWT                                        0036
         ST    @10,DFJEFF02                                        0036
*   DFIDP=ADDR(LDFID);              /* ADDRESS OF CALLER           0037
*                                      IDENTIFICATION FIELD          */
         LA    @05,LDFID                                           0037
         ST    @05,DFIDP                                           0037
*   DFCPPLP=F0C;                    /* CPPL PARAMETER LIST NOT     0038
*                                      SUPPLIED                      */
         SLR   @15,@15                                             0038
         ST    @15,DFCPPLP                                         0038
*   DFBUFP=ADDR(DFBUFS);            /* ADDRESS OF MESSAGE BUFFERS    */
*                                                                  0039
         LA    @14,DFBUFS                                          0039
         ST    @14,DFBUFP                                          0039
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DAIRFAIL PARAMETERS                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0040
*   DFMSGWTP=F0C;                   /* FORCE DAIRFAIL TO LINK TO TSO
*                                      MESSAGE WRITER                */
         ST    @15,DFMSGWTP(,@10)                                  0040
*   DFID=F0C;                       /* CLEAR THE FIELD               */
         STH   @15,DFID(,@05)                                      0041
*   DFIDNUM=DFSVC99;                /* SUPPLY THE CALLER IDENTIFIER  */
         MVI   DFIDNUM(@05),X'32'                                  0042
*   DFWTP=ON;                       /* ISSUE WTP INSTEAD OF PUTLINE  */
*   DFBUFSW=ON;                     /* SET TO BUILD DAIRFAIL MESSAGE
*                                      BUFFERS                       */
*   DFBUFS2=OFF;                    /* SET TO NOT OUTPUT DAIRFAIL  0045
*                                      MESSAGES TO TERMINAL          */
*                                                                  0045
         OI    DFWTP(@05),B'11000000'                              0045
         NI    DFBUFS2(@05),B'11011111'                            0045
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE MESSAGE RETURN BUFFERS                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0046
*   DFBUF1=DFBUF1&&DFBUF1;          /* CLEAR THE BUFFER              */
         XC    DFBUF1(255),DFBUF1                                  0046
*   DFBUF2=DFBUF2&&DFBUF2;          /* CLEAR THE BUFFER              */
         XC    DFBUF2(255),DFBUF2                                  0047
*   DFBUFL1=LENGTH(DFBUFT1)+F4C;    /* INIT THE BUFFER LENGTH        */
         LA    @10,255                                             0048
         STH   @10,DFBUFL1                                         0048
*   DFBUFL2=LENGTH(DFBUFT2)+F4C;    /* INIT THE BUFFER LENGTH        */
*                                                                  0049
         STH   @10,DFBUFL2                                         0049
*   /*****************************************************************/
*   /*                                                               */
*   /* DO DYNALLOC ERROR ANALYSIS USING THE DAIRFAIL MODULE          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0050
*   CALL INVDAIRF;                  /* INVOKE IKJEFF18 TO DO DYNALLOC
*                                      ERROR ANALYSIS                */
         BAL   @14,INVDAIRF                                        0050
*   IF RETCODE=F0C THEN             /* IF IKJEFF18 OK                */
         L     @10,RETCODE                                         0051
         LTR   @10,@10                                             0051
         BNZ   @RF00051                                            0051
*     DO;                           /* REFORMAT IKJEFF18 MESSAGES  0052
*                                      INTO IPCS MESSAGE FORMAT      */
*                                                                  0052
*       /*************************************************************/
*       /*                                                           */
*       /* REFORMAT IKJEFF18 MESSAGES INTO IPCS MESSAGE FORMAT       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0053
*       CALL BLSCRFM(DMCB,DMCBMSG,ADDR(DFBUF1));/* REFORMAT FIRST  0053
*                                      LEVEL MESSAGE                 */
         ST    DMCBPTR,@AL00001                                    0053
         LA    @10,DMCBMSG(,DMCBPTR)                               0053
         ST    @10,@AL00001+4                                      0053
         LA    @10,DFBUF1                                          0053
         ST    @10,@TF00001                                        0053
         LA    @10,@TF00001                                        0053
         ST    @10,@AL00001+8                                      0053
         L     @15,@CV00290                                        0053
         LA    @01,@AL00001                                        0053
         BALR  @14,@15                                             0053
*       RFY                                                        0054
*         GPR15F RSTD;                                             0054
*       SUBCODE=GPR15F;             /* OBTAIN THE SUBROUTINE RETURN
*                                      CODE                          */
         ST    GPR15F,SUBCODE                                      0055
*       RFY                                                        0056
*         GPR15F UNRSTD;                                           0056
*       RETCODE=MAX(SUBCODE,RETCODE);/* PASS MAX ERROR TO CALLER     */
         L     @10,SUBCODE                                         0057
         L     @05,RETCODE                                         0057
         CR    @05,@10                                             0057
         BNL   *+6
         LR    @05,@10                                             0057
         ST    @05,RETCODE                                         0057
*       IF SUBCODE=F0C THEN         /* TEST FOR NO ERROR             */
         LTR   @10,@10                                             0058
         BNZ   @RF00058                                            0058
*         DO;                       /* REFORMAT SECOND MESSAGE       */
*           CALL BLSCRFM(DMCB,DMCBMSG,ADDR(DFBUF2));/* REFORMAT    0060
*                                      SECOND LEVEL MESSAGE          */
         ST    DMCBPTR,@AL00001                                    0060
         LA    @10,DMCBMSG(,DMCBPTR)                               0060
         ST    @10,@AL00001+4                                      0060
         LA    @10,DFBUF2                                          0060
         ST    @10,@TF00001                                        0060
         LA    @10,@TF00001                                        0060
         ST    @10,@AL00001+8                                      0060
         L     @15,@CV00290                                        0060
         LA    @01,@AL00001                                        0060
         BALR  @14,@15                                             0060
*           RFY                                                    0061
*             GPR15F RSTD;                                         0061
*           SUBCODE=GPR15F;         /* OBTAIN THE SUBROUTINE RETURN
*                                      CODE                          */
         ST    GPR15F,SUBCODE                                      0062
*           RFY                                                    0063
*             GPR15F UNRSTD;                                       0063
*           RETCODE=MAX(SUBCODE,RETCODE);/* PASS MAX ERROR TO CALLER */
         L     @10,SUBCODE                                         0064
         L     @15,RETCODE                                         0064
         CR    @10,@15                                             0064
         BNL   *+6
         LR    @10,@15                                             0064
         ST    @10,RETCODE                                         0064
*         END;                      /* REFORMAT SECOND MESSAGE       */
*     END;                          /* REFORMAT IKJEFF18 MESSAGES  0066
*                                      INTO IPCS MESSAGE FORMAT      */
*                                                                  0066
@RF00058 DS    0H                                                  0067
*   /*****************************************************************/
*   /*                                                               */
*   /* ANALYSIS COMPLETE, RETURN TO CALLER                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0067
*   RETURN CODE(RETCODE);                                          0067
@RF00051 L     @10,RETCODE                                         0067
         L     @13,4(,@13)                                         0067
         L     @00,@SIZDATD                                        0067
         LR    @01,@11                                             0067
         BLSCFRES R,LV=(0),A=(1)
         LR    @15,@10                                             0067
         L     @14,12(,@13)                                        0067
         LM    @00,@12,20(@13)                                     0067
         BR    @14                                                 0067
         EJECT
*                                                                  0068
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO ISSUE THE IPCS BASIC DYNALLOC ERROR MESSAGE      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0068
*BASEMSG:                                                          0068
*   PROCEDURE;                      /* ISSUE THE IPCS BASIC DYNALLOC
*                                      ERROR MESSAGE                 */
BASEMSG  STM   @14,@12,@SA00002                                    0068
*   CHSTR87=S99VERB;                /* GET DYNALLOC SVC VERB FIELD   */
         L     @10,DMCBDRBP(,DMCBPTR)                              0069
         MVC   CHSTR87(1),S99VERB(@10)                             0069
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0070
*   UNPK(CTEMP,CHSTR8);                                            0071
         UNPK  CTEMP(9),CHSTR8(8)                                  0071
*   TR(CTEMP,HEXTBL);                                              0072
         TR    CTEMP(9),HEXTBL                                     0072
*   OPCODE=CTEMP78;                 /* STORE THE VERB                */
         MVC   OPCODE(2),CTEMP78                                   0073
*   CHSTR847=DMCBSUBC;              /* DYNALLOC SVC RETURN CODE      */
         L     @05,DMCBSUBC(,DMCBPTR)                              0074
         STCM  @05,15,CHSTR847                                     0074
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0075
*   UNPK(CTEMP,CHSTR8);                                            0076
         UNPK  CTEMP(9),CHSTR8(8)                                  0076
*   TR(CTEMP,HEXTBL);                                              0077
         TR    CTEMP(9),HEXTBL                                     0077
*   RCODE=CTEMP78;                  /* SAVE THE RETURN CODE          */
         MVC   RCODE(2),CTEMP78                                    0078
*   CHSTR847=S99RSC;                /* DYNALLOC ERROR CODE AND REASON
*                                      CODE                          */
         MVC   CHSTR847(4),S99RSC(@10)                             0079
*   CHSTR88=LHEX0FC;                /* TRANSLATE THEM TO PRINTABLE 0080
*                                      HEX                           */
         MVI   CHSTR88,X'0F'                                       0080
*   UNPK(CTEMP,CHSTR8);                                            0081
         UNPK  CTEMP(9),CHSTR8(8)                                  0081
*   TR(CTEMP,HEXTBL);                                              0082
         TR    CTEMP(9),HEXTBL                                     0082
*   IF DMCBSUBC=0 THEN              /* TEST FOR RETURN CODE = 0      */
         LTR   @05,@05                                             0083
         BNZ   @RF00083                                            0083
*     CTEMP14=CTEMP58;              /* MOVE INFO CODE INTO         0084
*                                      INFO/REASON CODE FIELD        */
         MVC   CTEMP14(4),CTEMP58                                  0084
*   DO;                             /* BLSDMSG                     0085
*                                      (ZZ2,F3112C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBMODL,OPCODE,RCODE,C
*                                      TEMP14,DMCBDSN)               */
@RF00083 DS    0H                                                  0086
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */
         LA    @10,IOPTLIST+12                                     0086
         ST    @10,IOPTLIST                                        0086
*     IOPTLIST(2)=ADDR(DMCBMODL);   /* INSERT NAME POINTER           */
         LA    @10,DMCBMODL(,DMCBPTR)                              0087
         ST    @10,IOPTLIST+4                                      0087
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0088
         ST    @10,IOPTLIST+8                                      0088
*     RFY                                                          0089
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(DMCBMODL);       /* INSERT LENGTH                 */
         LA    @05,IOPTLIST+8                                      0090
         MVC   I015F(2,@05),@CH00044                               0090
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */
         LA    @05,IOPTLIST+24                                     0091
         ST    @05,IOPTLIST+12                                     0091
*     IOPTLIST(5)=ADDR(OPCODE);     /* INSERT NAME POINTER           */
         LA    @05,OPCODE                                          0092
         ST    @05,IOPTLIST+16                                     0092
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0093
*     RFY                                                          0094
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(OPCODE);         /* INSERT LENGTH                 */
         LA    @05,2                                               0095
         LA    @15,IOPTLIST+20                                     0095
         STH   @05,I015F(,@15)                                     0095
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */
         LA    @15,IOPTLIST+36                                     0096
         ST    @15,IOPTLIST+24                                     0096
*     IOPTLIST(8)=ADDR(RCODE);      /* INSERT NAME POINTER           */
         LA    @15,RCODE                                           0097
         ST    @15,IOPTLIST+28                                     0097
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0098
*     RFY                                                          0099
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(RCODE);          /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+32                                     0100
         STH   @05,I015F(,@15)                                     0100
*     IOPTLIST(10)=ADDR(IOPTLIST(13));/* CHAIN TO NEXT INSERT        */
         LA    @05,IOPTLIST+48                                     0101
         ST    @05,IOPTLIST+36                                     0101
*     IOPTLIST(11)=ADDR(CTEMP14);   /* INSERT NAME POINTER           */
         LA    @05,CTEMP14                                         0102
         ST    @05,IOPTLIST+40                                     0102
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0103
*     RFY                                                          0104
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(CTEMP14);        /* INSERT LENGTH                 */
         LA    @05,IOPTLIST+44                                     0105
         MVC   I015F(2,@05),@CH00037                               0105
*     IOPTLIST(13)=0;               /* LAST INSERT                   */
         ST    @10,IOPTLIST+48                                     0106
*     IOPTLIST(14)=ADDR(DMCBDSN);   /* INSERT NAME POINTER           */
         LA    @05,DMCBDSN(,DMCBPTR)                               0107
         ST    @05,IOPTLIST+52                                     0107
*     IOPTLIST(15)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+56                                     0108
*     RFY                                                          0109
*       I015F BASED(ADDR(IOPTLIST(15)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(DMCBDSN);        /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+56                                     0110
         MVC   I015F(2,@10),@CH00119                               0110
*     CALL BLSDMSG0(ZZ2,F3112C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0111
*         IOPTLIST));               /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0111
         ST    @10,@AL00001                                        0111
         LA    @10,@CF00332                                        0111
         ST    @10,@AL00001+4                                      0111
         LA    @10,DMCBMSG(,DMCBPTR)                               0111
         ST    @10,@AL00001+8                                      0111
         L     @10,DMCBMSGS(,DMCBPTR)                              0111
         ST    @10,@AL00001+12                                     0111
         LA    @10,@CB00375                                        0111
         ST    @10,@AL00001+16                                     0111
         LA    @10,IOPTLIST                                        0111
         ST    @10,@AFTEMPS                                        0111
         LA    @10,@AFTEMPS                                        0111
         ST    @10,@AL00001+20                                     0111
         L     @15,DMCBMSG0(,DMCBPTR)                              0111
         LA    @01,@AL00001                                        0111
         BALR  @14,@15                                             0111
*   END;                            /* BLSDMSG                     0112
*                                      (ZZ2,F3112C,DMCBMSG,BLSDMSGS)
*                                      INSERT(DMCBMODL,OPCODE,RCODE,C
*                                      TEMP14,DMCBDSN) BUILD ERROR 0112
*                                      MESSAGE                       */
*   END BASEMSG;                    /* END OF ISSUE THE IPCS BASIC 0113
*                                      DYNALLOC ERROR MESSAGE        */
@EL00002 DS    0H                                                  0113
@EF00002 DS    0H                                                  0113
@ER00002 LM    @14,@12,@SA00002                                    0113
         BR    @14                                                 0113
         EJECT
*                                                                  0114
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO INVOKE IKJEFF18 TO DO DYNALLOC ERROR ANALYSIS    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0114
*INVDAIRF:                                                         0114
*   PROC;                           /* INVOKE IKJEFF18 TO DO DYNALLOC
*                                      ERROR ANALYSIS                */
INVDAIRF STM   @14,@12,@SA00003                                    0114
*   RFY                                                            0115
*     GPR01P RSTD;                                                 0115
*   GPR01P=ADDR(DFPARMS);           /* PASS PARMLIST TO IJKEFF18     */
         LA    GPR01P,DFPARMS                                      0116
*   GEN FLOWS(LINKERR);                                            0117
*                        /* TELL COMPILER ABOUT
*                                      ERRET(LINKERR) IN LINK MACRO
*   RFY                                                            0118
*     GPR01P UNRSTD;                                               0118
*   DO;                             /* LINK EP(LINKNAME)           0119
*                                      ERRET(LINKERR)                */
*     I00601='00'X;                 /* EP/DE FLAG                    */
         MVI   I00601,X'00'                                        0120
*     I00602=ADDR(LINKNAME);        /* ADDR OF EP/DE                 */
         LA    @10,@CC00346                                        0121
         STCM  @10,7,I00602                                        0121
*     I00604=0;                     /* DCB PTR                       */
         SLR   @10,@10                                             0122
         STCM  @10,7,I00604                                        0122
*     I00603='80'X;                 /* ERRET FLAG                    */
         MVI   I00603,X'80'                                        0123
*     I00605=ADDR(LINKERR);         /* ERRET PTR                     */
         LA    @10,LINKERR                                         0124
         ST    @10,I00605                                          0124
*     RESPECIFY                                                    0125
*      (GPR15P) RESTRICTED;                                        0125
*     GPR15P=ADDR(I006);            /* ADDR OF LINK LIST             */
         LA    GPR15P,I006                                         0126
*     SVC(6);                       /* ISSUE LINK SVC                */
         SVC   6                                                   0127
*     RESPECIFY                                                    0128
*      (GPR15P) UNRESTRICTED;                                      0128
*   END;                            /* LINK EP(LINKNAME)           0129
*                                      ERRET(LINKERR) DO SVC 99 ERROR
*                                      ANALYSIS                      */
*   RFY                                                            0130
*     GPR15F RSTD;                                                 0130
*   SUBCODE=GPR15F;                 /* SAVE THE RETURN CODE          */
         ST    GPR15F,SUBCODE                                      0131
*   RFY                                                            0132
*     GPR15F UNRSTD;                                               0132
*   IF SUBCODE^=0 THEN              /* TEST FOR IKJEFF18 ERROR       */
         L     @10,SUBCODE                                         0133
         LTR   @10,@10                                             0133
         BZ    @RF00133                                            0133
*     DO;                           /* IKJEFF18 ERROR                */
*       RETCODE=ERROR;              /* FORCE ERROR TO CALLER         */
         MVC   RETCODE(4),@CF00044                                 0135
*     END;                          /* IKJEFF18 ERROR                */
*   RETURN;                                                        0137
@EL00003 DS    0H                                                  0137
@EF00003 DS    0H                                                  0137
@ER00003 LM    @14,@12,@SA00003                                    0137
         BR    @14                                                 0137
         EJECT
*                                                                  0138
*/* START OF SPECIFICATIONS*******************************************/
*/*                                                                  */
*/*   MODULE NAME:  LINKERR (BLSCLKR)                                */
*/*                                                                  */
*/*   DESCRIPTIVE NAME:  IPCS DAS LINK SVC ERROR RETURN ROUTINE      */
*/*                                                                  */
*/*   COPYRIGHT: NONE                                                */
*/*                                                                  */
*/*   STATUS: SU57 RELEASE 1, LEVEL 0                                */
*/*                                                                  */
*/*   FUNCTION:                                                      */
*/*     PROVIDE INCLUDED CODE FOR A LINK SVC ERROR RETURN THAT       */
*/*     PRODUCES MESSAGE BLS03110 AND HOOKS IT TO THE DMCBMSG        */
*/*     MESSAGE CHAIN ANCHOR.                                        */
*/*                                                                  */
*/*   NOTES:                                                         */
*/*                                                                  */
*/*     DEPENDENCIES:                                                */
*/*       THE FOLLOWING SYMBOLS MUST BE DEFINED IN THE ENCLOSING     */
*/*       PROCEDURE:                                                 */
*/*          RETCODE                                                 */
*/*          SUBCODE                                                 */
*/*          ERROR                                                   */
*/*          GPR01F                                                  */
*/*          GPR15F                                                  */
*/*          ABENDC                                                  */
*/*          REASON                                                  */
*/*          RESULT                                                  */
*/*          MODNAME                                                 */
*/*          LINKNAME                                                */
*/*          CHSTR88                                                 */
*/*          CHSTR847                                                */
*/*          CTEMP                                                   */
*/*          CTEMP18                                                 */
*/*          HEXTBL                                                  */
*/*          HEX0FC                                                  */
*/*          F3110C                                                  */
*/*                                                                  */
*/*     RESTRICTIONS:   NONE                                         */
*/*                                                                  */
*/*     REGISTER CONVENTIONS:                                        */
*/*       GPR01F - (1)                                               */
*/*       GPR15F - (15)                                              */
*/*                                                                  */
*/*     PATCH LABEL:  N/A                                            */
*/*                                                                  */
*/*     SERIALIZATION REQUIREMENTS: NONE                             */
*/*                                                                  */
*/*   MODULE TYPE:  INCLUDED EXECUTABLE CODE                         */
*/*                                                                  */
*/*     PROCESSOR: PLS/2                                             */
*/*                                                                  */
*/*     MODULE SIZE: N/A                                             */
*/*                                                                  */
*/*     ATTRIBUTES:                                                  */
*/*      EXECUTABLE          PROBLEM STATE      REENTRANT            */
*/*                                                                  */
*/*   ENTRY POINT:  LINKERR                                          */
*/*                                                                  */
*/*     PURPOSE:  SEE FUNCTION                                       */
*/*                                                                  */
*/*     LINKAGE:                                                     */
*/*       R01 LOADED WITH ABEND CODE                                 */
*/*       R15 LOADED WITH ABEND REASON CODE                          */
*/*                                                                  */
*/*     METHOD OF ACCESS:  SYSTEM LINK SVC ERRET                     */
*/*                                                                  */
*/*   INPUT:  SEE LINKAGE                                            */
*/*                                                                  */
*/*   OUTPUT:                                                        */
*/*      MESSAGE BLS03110 CHAINED FROM DMCBMSG IN IPCS DM/PM FORMAT. */
*/*      THE OUTPUT MESSAGE LIST FORMAT IS DESCRIBED IN THE BLSDMSG0 */
*/*      MODULE DESCRIPTION.                                         */
*/*                                                                  */
*/*   EXIT-NORMAL:  RETURN TO LINK SVC                               */
*/*     RETCODE = 8   MESSAGE BLS03110 IS ISSUED.                    */
*/*                                                                  */
*/*   EXIT-ERROR:  NONE                                              */
*/*                                                                  */
*/*   EXTERNAL REFERENCES:                                           */
*/*                                                                  */
*/*     ROUTINES:                                                    */
*/*       BLSDMSG0      IPCS DM/PM MESSAGE TEXT BUILD FUNCTION       */
*/*                                                                  */
*/*     DATA AREAS: SEE SYMBOLS DEFINED UNDER DEPENDENCIES           */
*/*                                                                  */
*/*     CONTROL BLOCKS: DMCB      R,W                                */
*/*                     BLSDMSGS  R                                  */
*/*                     ZZ2       R                                  */
*/*                                                                  */
*/*   TABLES/WORKAREAS: NONE                                         */
*/*                                                                  */
*/*   MACROS: BLSDMSG                                                */
*/*                                                                  */
*/*   CHANGE ACTIVITY:                                               */
*/*     THIS MODULE IS WRITTEN FOR @G57LPSR.                         */
*/*                                                                  */
*/*   MESSAGES ISSUED:                                               */
*/*        BLS03110I LINK SVC TO LINKNAME FROM MODNAME FAILED.       */
*/*                  ABEND CODE=XXXXXXXX, REASON CODE=YYYYYYYY       */
*/*                                                                  */
*/*   ABEND CODES:  NONE                                             */
*/*                                                                  */
*/*   DATA SETS ACCESSED:  NONE                                      */
*/*                                                                  */
*/*** END OF SPECIFICATIONS*******************************************/
*                                                                  0138
*LINKERR:                                                          0138
*   RFY                                                            0138
*    (GPR01F,                                                      0138
*     GPR15F) RSTD;                                                0138
LINKERR  DS    0H                                                  0139
*   ABENDC=GPR01F;                  /* SAVE THE ABEND CODE           */
         LR    ABENDC,GPR01F                                       0139
*   REASON=GPR15F;                  /* SAVE THE ABEND REASON CODE    */
         LR    REASON,GPR15F                                       0140
*   RFY                                                            0141
*    (GPR01F,                                                      0141
*     GPR15F) UNRSTD;                                              0141
*   CHSTR847=ABENDC;                /* GET ABEND CODE FIELD          */
         STCM  ABENDC,15,CHSTR847                                  0142
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0143
*   UNPK(CTEMP,CHSTR8);                                            0144
         UNPK  CTEMP(9),CHSTR8(8)                                  0144
*   TR(CTEMP,HEXTBL);                                              0145
         TR    CTEMP(9),HEXTBL                                     0145
*   RESULT=CTEMP18;                 /* STORE THE RESULT              */
         MVC   RESULT(8),CTEMP18                                   0146
*   CHSTR847=REASON;                /* GET REASON CODE FIELD         */
         STCM  REASON,15,CHSTR847                                  0147
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0148
*   UNPK(CTEMP,CHSTR8);                                            0149
         UNPK  CTEMP(9),CHSTR8(8)                                  0149
*   TR(CTEMP,HEXTBL);                                              0150
         TR    CTEMP(9),HEXTBL                                     0150
*   DO;                             /* BLSDMSG                     0151
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)
*                                      INSERT(LINKNAME,MODNAME,RESULT
*                                      ,CTEMP18)                     */
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */
         LA    @10,IOPTLIST+12                                     0152
         ST    @10,IOPTLIST                                        0152
*     IOPTLIST(2)=ADDR(LINKNAME);   /* INSERT NAME POINTER           */
         LA    @10,@CC00346                                        0153
         ST    @10,IOPTLIST+4                                      0153
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0154
         ST    @10,IOPTLIST+8                                      0154
*     RFY                                                          0155
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(LINKNAME);       /* INSERT LENGTH                 */
         LA    @05,8                                               0156
         LA    @15,IOPTLIST+8                                      0156
         STH   @05,I015F(,@15)                                     0156
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */
         LA    @15,IOPTLIST+24                                     0157
         ST    @15,IOPTLIST+12                                     0157
*     IOPTLIST(5)=ADDR(MODNAME);    /* INSERT NAME POINTER           */
         LA    @15,MODNAME                                         0158
         ST    @15,IOPTLIST+16                                     0158
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0159
*     RFY                                                          0160
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(MODNAME);        /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+20                                     0161
         STH   @05,I015F(,@15)                                     0161
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */
         LA    @15,IOPTLIST+36                                     0162
         ST    @15,IOPTLIST+24                                     0162
*     IOPTLIST(8)=ADDR(RESULT);     /* INSERT NAME POINTER           */
         LA    @15,RESULT                                          0163
         ST    @15,IOPTLIST+28                                     0163
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0164
*     RFY                                                          0165
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(RESULT);         /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+32                                     0166
         STH   @05,I015F(,@15)                                     0166
*     IOPTLIST(10)=0;               /* LAST INSERT                   */
         ST    @10,IOPTLIST+36                                     0167
*     IOPTLIST(11)=ADDR(CTEMP18);   /* INSERT NAME POINTER           */
         LA    @15,CTEMP18                                         0168
         ST    @15,IOPTLIST+40                                     0168
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0169
*     RFY                                                          0170
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(CTEMP18);        /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+44                                     0171
         STH   @05,I015F(,@10)                                     0171
*     CALL BLSDMSG0(ZZ2,F3110C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0172
*         IOPTLIST));               /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0172
         ST    @10,@AL00001                                        0172
         LA    @10,@CF00330                                        0172
         ST    @10,@AL00001+4                                      0172
         LA    @10,DMCBMSG(,DMCBPTR)                               0172
         ST    @10,@AL00001+8                                      0172
         L     @10,DMCBMSGS(,DMCBPTR)                              0172
         ST    @10,@AL00001+12                                     0172
         LA    @10,@CB00375                                        0172
         ST    @10,@AL00001+16                                     0172
         LA    @10,IOPTLIST                                        0172
         ST    @10,@AFTEMPS+4                                      0172
         LA    @10,@AFTEMPS+4                                      0172
         ST    @10,@AL00001+20                                     0172
         L     @15,DMCBMSG0(,DMCBPTR)                              0172
         LA    @01,@AL00001                                        0172
         BALR  @14,@15                                             0172
*   END;                            /* BLSDMSG                     0173
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)
*                                      INSERT(LINKNAME,MODNAME,RESULT
*                                      ,CTEMP18) BUILD LINK SVC ERROR
*                                      MESSAGE                       */
*   RETCODE=ERROR;                  /* MARK ERROR TO CALLER          */
         MVC   RETCODE(4),@CF00044                                 0174
*   END INVDAIRF;                   /* END INVOKE IKJEFF18 TO DO   0175
*                                      DYNALLOC ERROR ANALYSIS       */
         B     @EL00003                                            0175
         EJECT
*                                                                  0176
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0176
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR01F FIXED(31) REG(1),                                     0176
*     GPR15F FIXED(31) REG(15),                                    0176
*     GPR01P PTR(31) REG(1),                                       0176
*     GPR15P PTR(31) REG(15);                                      0176
*   DCL                                                            0177
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */
*      2 I00602 PTR(24),            /* EP/DE PTR                     */
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */
*      2 I00604 PTR(24),            /* DCB PTR                       */
*      2 I00605 PTR(31);            /* ERRET PTR                     */
*   DECLARE                                                        0178
*     ILIST CHAR(12) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0179
*     I031F FIXED(31) BASED,                                       0179
*     I031P PTR(31) BASED,                                         0179
*     I015F FIXED(15) BASED,                                       0179
*     I015P PTR(15) BASED,                                         0179
*     I008P PTR(8) BASED,                                          0179
*     I001C CHAR(1) BASED;                                         0179
*   DECLARE                                                        0180
*     IOPTLIST(15) PTR(31) BDY(WORD);/* OPTION LIST ARRAY            */
*   DCL                                                            0181
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0181
*   GEN DATA DEFS(HEXTBL);                                         0182
*   END BLSCANAL                                                   0183
*                                                                  0183
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */
*/*%INCLUDE SYSLIB  (IKJEFFDF)                                       */
*/*%INCLUDE SYSLIB  (BLSCLKR )                                       */
*                                                                  0183
*       ;                                                          0183
@EL00001 L     @13,4(,@13)                                         0183
@EF00001 L     @00,@SIZDATD                                        0183
         LR    @01,@11                                             0183
         BLSCFRES R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0183
         BR    @14                                                 0183
@DATA    DS    0H
@CH00037 DC    H'4'
@CH00119 DC    H'44'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00003 DS    15F
@AL00001 DS    6A
@TF00001 DS    F
@AFTEMPS DS    2F
BLSCANAL CSECT
         DS    0F
@CF00044 DC    F'8'
@CH00044 EQU   @CF00044+2
@CF00330 DC    F'3110'
@CF00332 DC    F'3112'
@DATD    DSECT
         DS    0D
S99RBPTR DS    AL4
         ORG   S99RBPTR
S99RBPND DS    BL1
         ORG   S99RBPTR+4
S99TUFP  DS    A
LDFMSGWT DS    A
LDFID    DS    H
         DS    CL2
DFPARMS  DS    CL24
         ORG   DFPARMS
DFS99RBP DS    AL4
         ORG   DFS99RBP
DFDAPLP  DS    AL4
         ORG   DFPARMS+4
DFRCP    DS    AL4
DFJEFF02 DS    AL4
DFIDP    DS    AL4
DFCPPLP  DS    AL4
DFBUFP   DS    AL4
         ORG   DFPARMS+24
DFBUFS   DS    CL511
         ORG   DFBUFS
DFBUF1   DS    CL255
         ORG   DFBUF1
DFBUFL1  DS    FL2
DFBUFO1  DS    FL2
DFBUFT1  DS    CL251
         ORG   DFBUFS+255
@NM00003 DS    CL1
DFBUF2   DS    CL255
         ORG   DFBUF2
DFBUFL2  DS    FL2
DFBUFO2  DS    FL2
DFBUFT2  DS    CL251
         ORG   DFBUFS+511
         DS    CL1
MODSTAT  DS    CL16
         ORG   MODSTAT
MODNAME  DS    CL8
RETCODE  DS    FL4
SUBCODE  DS    FL4
         ORG   MODSTAT+16
OPCODE   DS    CL2
RCODE    DS    CL2
RESULT   DS    CL8
         DS    CL4
CHSTR8   DS    CL8
         ORG   CHSTR8
@NM00004 DS    CL3
CHSTR847 DS    CL4
         ORG   CHSTR847
CHSTR846 DS    CL3
CHSTR87  DS    CL1
         ORG   CHSTR8+7
CHSTR88  DS    CL1
         ORG   CHSTR8+8
CTEMP    DS    CL9
         ORG   CTEMP
CTEMP18  DS    CL8
         ORG   CTEMP18
CTEMP14  DS    CL4
CTEMP58  DS    CL4
         ORG   CTEMP58
CTEMP56  DS    CL2
CTEMP78  DS    CL2
         ORG   CTEMP+9
         DS    CL7
ILIST    DS    CL12
IOPTLIST DS    15A
BLSCANAL CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00290 DC    V(BLSCRFM)
         DS    0D
@CC00344 DC    C'BLSCANAL'
@CC00346 DC    C'IKJEFF18'
@CB00375 DC    B'00000000'
         DS    CL7
DASPATCH DS    CL80
         ORG   DASPATCH
DASPATA  DC    20A(0)
         ORG   DASPATCH+80
BLSCANAL CSECT
*                         /*
HEXTBL   EQU   *-240
         DC    CL16'0123456789ABCDEF'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSCANAL CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
REASON   EQU   @06
ABENDC   EQU   @05
DMCBPTR  EQU   @04
GPR01P   EQU   @01
GPR15F   EQU   @15
GPR15P   EQU   @15
GPR01F   EQU   @01
DMCB     EQU   0
DMCBTVP  EQU   DMCB+8
DMCBFTY  EQU   DMCB+20
DMCBOPN  EQU   DMCB+21
DMCBRMOD EQU   DMCB+23
DMCBOUT  EQU   DMCBRMOD
DMCBOPTS EQU   DMCB+24
DMCBGKY  EQU   DMCBOPTS
DMCBMFLG EQU   DMCB+28
DMCBBUFP EQU   DMCB+32
DMCBKEYP EQU   DMCB+44
DMCBMSG  EQU   DMCB+52
DMCBRI   EQU   DMCB+64
DMCBMSG0 EQU   DMCB+68
DMCBMSGS EQU   DMCB+72
DMCBFRE  EQU   DMCB+88
DMCBEOB  EQU   DMCB+92
DMCBACBE EQU   DMCB+124
DMCBDSN  EQU   DMCB+284
DMCBMODL EQU   DMCB+348
DMCBSPEC EQU   DMCB+380
DMCBDRBP EQU   DMCB+400
DMCBSUBC EQU   DMCB+404
DMCBAMS  EQU   DMCB+416
DMCBAUDT EQU   DMCB+568
DMCBLSCP EQU   DMCBAUDT+16
S99RB    EQU   0
S99VERB  EQU   S99RB+1
S99FLAG1 EQU   S99RB+2
S99FLG11 EQU   S99FLAG1
S99RSC   EQU   S99RB+4
S99TXTPP EQU   S99RB+8
S99FLAG2 EQU   S99RB+16
S99FLG21 EQU   S99FLAG2
S99FLG22 EQU   S99FLAG2+1
S99TUPL  EQU   0
S99TUPTR EQU   S99TUPL
S99TUP   EQU   0
S99TUNIT EQU   0
S99TUENT EQU   S99TUNIT+4
S99TUFLD EQU   0
DFMSGWTP EQU   0
DFID     EQU   0
@NM00001 EQU   DFID
DFWTP    EQU   @NM00001
DFBUFSW  EQU   @NM00001
DFBUFS2  EQU   @NM00001
IDNUM    EQU   DFID+1
DFIDNUM  EQU   IDNUM
BLSDMSGS EQU   0
BLSDMSG0 EQU   0
ZZ2      EQU   0
I015F    EQU   0
DFRC     EQU   0
DMCBDMGR EQU   0
DMCBRQC  EQU   0
I001C    EQU   0
I008P    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
DMCBVSM  EQU   DMCBAMS
DMCBQSM  EQU   DMCBAMS
I006     EQU   ILIST
I00601   EQU   I006
I00602   EQU   I006+1
I00603   EQU   I006+4
I00604   EQU   I006+5
I00605   EQU   I006+8
CHSTR878 EQU   CHSTR8+6
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
DMCBRES7 EQU   DMCBQSM+96
DMCBDCB  EQU   DMCBQSM
DMCBACB  EQU   DMCBVSM+76
DMCBRPL  EQU   DMCBVSM
@NM00002 EQU   @NM00001
S99TUPRM EQU   S99TUFLD+2
S99TULEN EQU   S99TUFLD
S99TUPAR EQU   S99TUENT+2
S99TULNG EQU   S99TUENT
S99TUNUM EQU   S99TUNIT+2
S99TUKEY EQU   S99TUNIT
S99TUPND EQU   S99TUP
S99TUPLN EQU   S99TUPTR
S99FLG24 EQU   S99FLAG2+3
S99FLG23 EQU   S99FLAG2+2
S99PCINT EQU   S99FLG22
S99UDEVT EQU   S99FLG22
S99MOUNT EQU   S99FLG21
S99CATLG EQU   S99FLG21
S99TIONQ EQU   S99FLG21
S99OFFLN EQU   S99FLG21
S99WTUNT EQU   S99FLG21
S99NORES EQU   S99FLG21
S99WTDSN EQU   S99FLG21
S99WTVOL EQU   S99FLG21
S99RSV01 EQU   S99RB+12
S99INFO  EQU   S99RSC+2
S99ERROR EQU   S99RSC
S99FLG12 EQU   S99FLAG1+1
S99JBSYS EQU   S99FLG11
S99NOMNT EQU   S99FLG11
S99NOCNV EQU   S99FLG11
S99ONCNV EQU   S99FLG11
S99RBLN  EQU   S99RB
DMCBWRK  EQU   DMCB+648
DMCBRES8 EQU   DMCB+640
DMCBMODN EQU   DMCB+632
DMCBCARY EQU   DMCBAUDT+20
DMCBCLC  EQU   DMCBAUDT+12
DMCBOPC  EQU   DMCBAUDT+8
DMCBFRC  EQU   DMCBAUDT+4
DMCBALC  EQU   DMCBAUDT
DMCBFR   EQU   DMCB+412
DMCBRES6 EQU   DMCB+410
DMCBIRSC EQU   DMCB+408
DMCBRSZM EQU   DMCB+398
DMCBRSZA EQU   DMCB+396
DMCBCISZ EQU   DMCB+394
DMCBDCBL EQU   DMCB+392
DMCBDCLR EQU   DMCB+390
DMCBDCFM EQU   DMCB+389
DMCBRES5 EQU   DMCB+388
DMCBLBRT EQU   DMCB+386
DMCBLBSQ EQU   DMCB+384
DMCBLBPS EQU   DMCB+383
DMCBLBTY EQU   DMCB+382
DMCBRES4 EQU   DMCB+381
DMCBSPRS EQU   DMCBSPEC
DMCBSPRN EQU   DMCBSPEC
DMCBSPCT EQU   DMCBSPEC
DMCBSPRL EQU   DMCBSPEC
DMCBSPSE EQU   DMCB+376
DMCBSPPR EQU   DMCB+372
DMCBSPTY EQU   DMCB+369
DMCBODIS EQU   DMCB+368
DMCBDISP EQU   DMCB+367
DMCBSTAT EQU   DMCB+366
DMCBRES3 EQU   DMCB+364
DMCBMEMB EQU   DMCB+356
DMCBRES9 EQU   DMCB+340
DMCBPID  EQU   DMCB+332
DMCBTYPE EQU   DMCB+328
DMCBUNIT EQU   DMCB+276
DMCBDSOR EQU   DMCB+274
DMCBVOL  EQU   DMCB+268
DMCBDDNM EQU   DMCB+260
DMCBSYNM EQU   DMCB+132
DMCBRPLF EQU   DMCB+128
DMCBDCBE EQU   DMCBACBE
DMCBARC  EQU   DMCB+120
DMCBCPC  EQU   DMCB+116
DMCBRET  EQU   DMCB+112
DMCBSTL  EQU   DMCB+96
DMCBRES2 EQU   DMCB+85
DMCBSPID EQU   DMCB+84
DMCBRESC EQU   DMCB+80
DMCBZZ1P EQU   DMCB+76
DMCBRRL  EQU   DMCB+60
DMCBRBA  EQU   DMCB+56
DMCBKEYL EQU   DMCB+48
DMCBKPC  EQU   DMCBKEYP
DMCBORL  EQU   DMCB+40
DMCBBLEN EQU   DMCB+36
DMCBBFPC EQU   DMCBBUFP
DMCBRES1 EQU   DMCB+31
DMCBACCM EQU   DMCB+30
DMCBREJ  EQU   DMCB+29
DMCBRESB EQU   DMCBMFLG
DMCBFMOD EQU   DMCBMFLG
DMCBLOPT EQU   DMCB+27
DMCBLRM  EQU   DMCB+26
DMCBLRQ  EQU   DMCB+25
DMCBOPRS EQU   DMCBOPTS
DMCBLRD  EQU   DMCBOPTS
DMCBBWD  EQU   DMCBOPTS
DMCBUPD  EQU   DMCBOPTS
DMCBAPX  EQU   DMCBOPTS
DMCBRNO  EQU   DMCBGKY
DMCBKYD  EQU   DMCBOPTS
DMCBRMRS EQU   DMCBRMOD
DMCBRM5  EQU   DMCBRMOD
DMCBRM6  EQU   DMCBRMOD
DMCBTMP  EQU   DMCBOUT
DMCBRQST EQU   DMCB+22
DMCBRESA EQU   DMCBOPN
DMCBSOUT EQU   DMCBOPN
DMCBSIN  EQU   DMCBOPN
DMCBVSF  EQU   DMCBFTY
DMCBKSF  EQU   DMCBFTY
DMCBFTRS EQU   DMCBFTY
DMCBSHF  EQU   DMCBFTY
DMCBIRL  EQU   DMCB+16
DMCBRTC  EQU   DMCB+12
DMCBNEXT EQU   DMCB+4
DMCBID   EQU   DMCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00133 EQU   @EL00003
@ENDDATA EQU   *
         END   BLSCANAL,(C'PLS1847',0701,78062)

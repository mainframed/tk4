ADPR     TITLE 'BLSEADPR- ADD PROBLEM TO IPCS DATA BASE                *
                        '
*     /* CHANGE ACTIVITY
*          01/31/78 PTM 7638
*          02/09/78 PTM 7668
*          02/14/78 PTM 7755
*          03/07/78 PTM 7812
*    THIS MODULE IS WRITTEN FOR @G57LPJD
BLSEADPR CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'BLSEADPR  78.067'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @10,4095(,@12)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@10                                    0002
         L     @00,@SIZDATD                                        0002
         BLSUALLR R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
*BLREXTRN - IDENTIFY EXTERNAL REFERENCES
         EXTRN BLSDDT00
         EXTRN BLSDTM00
         EXTRN BLSDSV00
         EXTRN BLSDC070
         EXTRN BLSDC600
         EXTRN BLSDC128
*   ZZ2PTR=R1;                      /* GET TASK VARIABLE             */
         LR    ZZ2PTR,R1                                           0369
*   RESPECIFY                                                      0370
*     R1 UNRESTRICTED;              /* FINISHED WITH REG1            */
*   RETC=0;                         /* INITIALIZE THE RETC           */
         SLR   RETC,RETC                                           0371
         SPACE 1
*   DO;                             /* BLSUPARS MF(E,PX)             */
*     CALL BLSUPARI(ZZ2,PCCSECT,PDAPTR);/* PARSE OPERANDS            */
         ST    ZZ2PTR,@AL00001                                     0373
         L     @01,PCPTR                                           0373
         ST    @01,@AL00001+4                                      0373
         LA    @15,PDAPTR                                          0373
         ST    @15,@AL00001+8                                      0373
         L     @01,ZZ2BVTP(,ZZ2PTR)                                0373
         L     @15,BVTPARIP(,@01)                                  0373
         LA    @01,@AL00001                                        0373
         BALR  @14,@15                                             0373
*     RESPECIFY                                                    0374
*      (GPR15F) RESTRICTED;                                        0374
*     IF GPR15F^=ZZZFLAGI THEN                                     0375
*                                                                  0375
         LTR   GPR15F,GPR15F                                       0375
         BZ    @RF00375                                            0375
*       /*************************************************************/
*       /*                                                           */
*       /* UNABLE TO PARSE                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0376
*       DO;                         /* UNABLE TO PARSE               */
*         RETC=GPR15F;              /* RETURN CODE                   */
         LR    RETC,GPR15F                                         0377
*         GO TO EXITNORL;           /* EXIT WITHOUT PDL              */
         B     EXITNORL                                            0378
*       END;                                                       0379
*     RESPECIFY                                                    0380
*      (GPR15F) UNRESTRICTED;                                      0380
@RF00375 DS    0H                                                  0381
*     RESPECIFY                                                    0381
*      (PDRPTR) RESTRICTED;                                        0381
*     PDRPTR=PDAPTR;                /* ->PDL                         */
         L     PDRPTR,PDAPTR                                       0382
*     GENERATE REFS(PD,PDRPTR) CODE(USING PD,PDRPTR);              0383
         USING PD,PDRPTR
*     IF PXTEST=PXTEST1 THEN                                       0384
         CLC   PXTEST(2),@CH00041                                  0384
         BNE   @RF00384                                            0384
*       ZZ2AFX=ZZZ1;                /* TEST                          */
         OI    ZZ2AFX(ZZ2PTR),B'10000000'                          0385
*     ELSE                                                         0386
*       IF PXTEST=PXTEST0 THEN                                     0386
         B     @RC00384                                            0386
@RF00384 CLC   PXTEST(2),@CH00068                                  0386
         BNE   @RF00386                                            0386
*         ZZ2AFX=ZZZ0;              /* NOTEST                        */
         NI    ZZ2AFX(ZZ2PTR),B'01111111'                          0387
*   END;                            /* BLSUPARS MF(E,PX) ISSUE THE 0388
*                                      CALL TO IKJPARSE              */
@RF00386 DS    0H                                                  0388
@RC00384 DS    0H                                                  0389
         EJECT
*                                                                  0389
*/********************************************************************/
*/*                                                                  */
*/* COMMAND PROCESSOR CODE BEGINS                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0389
*   MSGPTR=0;                       /* CLEAR MESSAGE POINTER         */
         SLR   @04,@04                                             0389
         ST    @04,MSGPTR                                          0389
*   CALL BLSDTIME(ZZ2,CURTIME,CURDATE);/* GET CURRENT TIME AND DATE  */
         ST    ZZ2PTR,@AL00001                                     0390
         LA    @04,CURTIME                                         0390
         ST    @04,@AL00001+4                                      0390
         LA    @04,CURDATE                                         0390
         ST    @04,@AL00001+8                                      0390
         L     @15,@CV01347                                        0390
         LA    @01,@AL00001                                        0390
         BALR  @14,@15                                             0390
*   RESPECIFY                                                      0391
*     RF RESTRICTED;                                               0391
*   IF RF^=0 THEN                   /* CHECK RETURN CODE             */
         LTR   RF,RF                                               0392
         BZ    @RF00392                                            0392
*     DO;                           /* SOMETHING IS WRONG WITH TIME  */
*       RESPECIFY                                                  0394
*         RF UNRESTRICTED;                                         0394
*       CURTIME='';                 /* SET TIME TO BLANKS            */
         MVI   CURTIME,C' '                                        0395
         MVC   CURTIME+1(7),CURTIME                                0395
*       CURDATE='';                 /* SET DATE TO BLANKS            */
         MVI   CURDATE,C' '                                        0396
         MVC   CURDATE+1(7),CURDATE                                0396
*     END;                                                         0397
*   ELSE                                                           0398
*     ;                             /* TIME AND DATE ARE OK          */
@RF00392 DS    0H                                                  0399
*   CALL OPEN;                      /* OPEN THE PROBLEM DIRECTORY    */
         BAL   @14,OPEN                                            0399
*   IF RETC=0 THEN                                                 0400
         LTR   RETC,RETC                                           0400
         BNZ   @RF00400                                            0400
*     CALL SEG1;                    /* OPEN IS OK                    */
         BAL   @14,SEG1                                            0401
*   ELSE                                                           0402
*     ;                                                            0402
@RF00400 DS    0H                                                  0403
         EJECT
*EXITRLSA:                                                         0403
*   DO WHILE(PDAPTR^=0);            /* BLRRLSA MF(EXECUTE,PD)        */
EXITRLSA B     @DE00403                                            0403
@DL00403 DS    0H                                                  0404
*     PDRPTR=PDAPTR;                                               0404
         L     PDRPTR,PDAPTR                                       0404
*     PDAPTR=PDXP;                                                 0405
         L     @06,PDXP-1(,PDRPTR)                                 0405
         LA    @06,0(,@06)                                         0405
         ST    @06,PDAPTR                                          0405
*     DO;                           /* FREEMAIN(R)                 0406
*                                      LV(PDL)SP(1)A(PDDSECT)        */
*       RESPECIFY                                                  0407
*        (GPR01F,                                                  0407
*         GPR00F) RESTRICTED;                                      0407
*       GPR00F=PDL;                 /* LENGTH REQUESTED              */
         L     GPR00F,PDL-1(,PDRPTR)                               0408
         ICM   GPR00F,8,@CB01629                                   0408
*       GPR01F=1;                   /* SP IN REG 1                   */
         LA    GPR01F,1                                            0409
*       GEN(SLL   GPR01F,24)                                       0410
*       NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;               0410
         SLL   GPR01F,24
*       GPR00F=GPR00F×GPR01F;       /* SP IN HI BYTE                 */
         OR    GPR00F,GPR01F                                       0411
*       GPR01F=ADDR(PDDSECT);       /* SET REGISTER ONE              */
         LR    GPR01F,PDRPTR                                       0412
*       SVC(10);                    /* R-FORM OF GETMAIN             */
         SVC   10                                                  0413
*       RESPECIFY                                                  0414
*        (GPR01F,                                                  0414
*         GPR00F) UNRESTRICTED;                                    0414
*     END;                          /* FREEMAIN(R)                 0415
*                                      LV(PDL)SP(1)A(PDDSECT)        */
*   END;                            /* BLRRLSA MF(EXECUTE,PD) FREE 0416
*                                      PARSE PARAMETER LIST          */
@DE00403 L     @06,PDAPTR                                          0416
         LTR   @06,@06                                             0416
         BNZ   @DL00403                                            0416
*   RETURN CODE(RETC);              /* RETURN TO CALLING PROGRAM   0417
*                                      NORMAL EXIT                   */
         L     @13,4(,@13)                                         0417
         L     @00,@SIZDATD                                        0417
         LR    @01,@11                                             0417
         BLSUFRER R,LV=(0),A=(1)
         LR    @15,@07                                             0417
         L     @14,12(,@13)                                        0417
         LM    @00,@12,20(@13)                                     0417
         BR    @14                                                 0417
         SPACE 1
*EXITNORL:                                                         0418
*   RETURN CODE(RETC);              /* RETURN TO THE CALLER BAD    0418
*                                      RETURN CODE                   */
EXITNORL L     @13,4(,@13)                                         0418
         L     @00,@SIZDATD                                        0418
         LR    @01,@11                                             0418
         BLSUFRER R,LV=(0),A=(1)
         LR    @15,@07                                             0418
         L     @14,12(,@13)                                        0418
         LM    @00,@12,20(@13)                                     0418
         BR    @14                                                 0418
         EJECT
*OPEN:                                                             0419
*   PROCEDURE;                                                     0419
OPEN     STM   @14,@06,@SA00002                                    0419
         STM   @08,@12,@SA00002+36                                 0419
*   DO;                             /* BLSOPEN(ZZ1PDRP)OUTPUT        */
*     RFY                                                          0421
*       GPR01P RSTD;                                               0421
*     GPR01P=ZZ1PDRP;               /* ADDRESS DMCB                  */
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0422
         L     GPR01P,ZZ1PDRP(,@04)                                0422
*     RFY                                                          0423
*       DMCB BASED(GPR01P);                                        0423
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                       0424
         LR    @04,GPR01P                                          0424
         N     @04,@CF01517                                        0424
         CLR   @04,GPR01P                                          0424
         BNE   @RF00424                                            0424
         CLC   DMCBID(4,GPR01P),@CC01518                           0424
         BNE   @RF00424                                            0424
*       DO;                                                        0425
*         DMCBRQST=DMCBOPR;         /* INDICATE OPEN REQUEST         */
         MVI   DMCBRQST(GPR01P),X'01'                              0426
*         DMCBOUT='1'B;             /* INDICATE OPEN FOR OUTPUR      */
         OI    DMCBOUT(GPR01P),B'10000000'                         0427
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                                 0428
         BALR  @14,@15                                             0428
*       END;                                                       0429
*     ELSE                                                         0430
*       DO;                                                        0430
         B     @RC00424                                            0430
@RF00424 DS    0H                                                  0431
*         RFY                                                      0431
*          (GPR00F,                                                0431
*           GPR15F) RSTD;                                          0431
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                       0432
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                           0433
*         RFY                                                      0434
*          (GPR00F,                                                0434
*           GPR15F);                                               0434
*       END;                                                       0435
*     RFY                                                          0436
*       DMCB;                                                      0436
@RC00424 DS    0H                                                  0437
*     RFY                                                          0437
*       GPR01P;                                                    0437
*   END;                            /* BLSOPEN(ZZ1PDRP)OUTPUT OPEN 0438
*                                      PROBLEM DIRECTORY             */
*   RESPECIFY                                                      0439
*     RF RESTRICTED;                                               0439
*   IF RF^=0 THEN                   /* IF OPEN NOT OK                */
         LTR   RF,RF                                               0440
         BZ    @RF00440                                            0440
*     DO;                                                          0441
*       IF RF=16 THEN               /* IF INVALID DMCB               */
         C     RF,@CF00052                                         0442
         BNE   @RF00442                                            0442
*         DO;                       /* ABEND(147) DUMP               */
*           RESPECIFY                                              0444
*            (GPR01F) RESTRICTED;                                  0444
*           GPR01F=147;             /* COMP CODE IN REG 1            */
         LA    GPR01F,147                                          0445
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00061                                     0446
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                                  0447
*           RESPECIFY                                              0448
*            (GPR01F) UNRESTRICTED;                                0448
*         END;                      /* ABEND(147) DUMP QUIT RIGHT  0449
*                                      HERE                          */
*       ELSE                                                       0450
*         ;                                                        0450
@RF00442 DS    0H                                                  0451
*       RETC=RF;                                                   0451
         LR    RETC,RF                                             0451
*       RESPECIFY                                                  0452
*         RF UNRESTRICTED;                                         0452
*       DO;                         /* BLSDMSG                     0453
*                                      (ZZ2,04042,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*         CALL BLSDMSG0(ZZ2,04042,DMCBMSG,BLSDMSGS,'10110000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                     0454
         LA    @04,@CF01520                                        0454
         ST    @04,@AL00001+4                                      0454
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0454
         L     @04,ZZ1PDRP(,@04)                                   0454
         LA    @04,DMCBMSG(,@04)                                   0454
         ST    @04,@AL00001+8                                      0454
         L     @04,ZZ2MSGSP(,ZZ2PTR)                               0454
         ST    @04,@AL00001+12                                     0454
         LA    @04,@CB01521                                        0454
         ST    @04,@AL00001+16                                     0454
         LA    @04,@CF00046                                        0454
         ST    @04,@AL00001+20                                     0454
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0454
         LA    @01,@AL00001                                        0454
         BALR  @14,@15                                             0454
*       END;                        /* BLSDMSG                     0455
*                                      (ZZ2,04042,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*     END;                                                         0456
*   ELSE                                                           0457
*     ;                                                            0457
@RF00440 DS    0H                                                  0458
*   END OPEN;                                                      0458
@EL00002 DS    0H                                                  0458
@EF00002 DS    0H                                                  0458
@ER00002 LM    @14,@06,@SA00002                                    0458
         LM    @08,@12,@SA00002+36                                 0458
         BR    @14                                                 0458
         EJECT
*SEG1:                                                             0459
*   PROCEDURE;                                                     0459
SEG1     STM   @14,@06,@SA00003                                    0459
         STM   @08,@12,@SA00003+36                                 0459
*   BUFPTR=ADDR(BUF1);              /* SET POINTER TO MYBUF          */
         LA    BUFPTR,BUF1                                         0460
*   PDRKRCTY=PDRSVALC;              /* SET TO READ SEED RECORD       */
         MVC   PDRKRCTY(2,BUFPTR),@CC01262                         0461
*   PDRKPREF=FPDBPIDP;              /* SET PROBLEM PREFIX IN KEY     */
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0462
         L     @09,ZZ1FPP(,@09)                                    0462
         MVC   PDRKPREF(3,BUFPTR),FPDBPIDP(@09)                    0462
*   PDRKPNUM='00000';               /* SET PROBLEM NUMBER IN KEY     */
         MVC   PDRKPNUM(5,BUFPTR),@CC01525                         0463
*   PDRRECSQ='0000';                /* SET RECORD SEQUENCE NUMBER    */
         MVC   PDRRECSQ(4,BUFPTR),@CC01526                         0464
*   CALL SEG3;                      /* CONTINUE PROCESSING           */
         BAL   @14,SEG3                                            0465
*   CALL CLOSE;                                                    0466
         BAL   @14,CLOSE                                           0466
*   IF RETC=0 THEN                                                 0467
         SLR   @09,@09                                             0467
         CR    RETC,@09                                            0467
         BNE   @RF00467                                            0467
*     DO;                           /* NO PROBLEM                    */
*       DO;                         /* BLSDMSG                     0469
*                                      (ZZ2,05100,MSGPTR,BLSDMSGS) IN
*                                      SERT(FPPIDP,PDRKPNUM)ROUTE(BOT
*                                      H)                            */
*         IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT      */
         LA    @04,IOPTLIST+12                                     0470
         ST    @04,IOPTLIST                                        0470
*         IOPTLIST(2)=ADDR(FPPIDP); /* INSERT NAME POINTER           */
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0471
         L     @04,ZZ1FPP(,@04)                                    0471
         LA    @04,FPPIDP(,@04)                                    0471
         ST    @04,IOPTLIST+4                                      0471
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */
         ST    @09,IOPTLIST+8                                      0472
*         RFY                                                      0473
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(FPPIDP);     /* INSERT LENGTH                 */
         LA    @04,IOPTLIST+8                                      0474
         MVC   I015F(2,@04),@CH00094                               0474
*         IOPTLIST(4)=0;            /* LAST INSERT                   */
         ST    @09,IOPTLIST+12                                     0475
*         IOPTLIST(5)=ADDR(PDRKPNUM);/* INSERT NAME POINTER          */
         LA    @04,PDRKPNUM(,BUFPTR)                               0476
         ST    @04,IOPTLIST+16                                     0476
*         IOPTLIST(6)=0;            /* ZERO RESERVED FIELD           */
         ST    @09,IOPTLIST+20                                     0477
*         RFY                                                      0478
*           I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(PDRKPNUM);   /* INSERT LENGTH                 */
         LA    @09,IOPTLIST+20                                     0479
         MVC   I015F(2,@09),@CH00091                               0479
*         CALL BLSDMSG0(ZZ2,05100,MSGPTR,BLSDMSGS,'00110000'B,ADDR(
*             IOPTLIST));           /* BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                     0480
         LA    @09,@CF01535                                        0480
         ST    @09,@AL00001+4                                      0480
         LA    @09,MSGPTR                                          0480
         ST    @09,@AL00001+8                                      0480
         L     @09,ZZ2MSGSP(,ZZ2PTR)                               0480
         ST    @09,@AL00001+12                                     0480
         LA    @09,@CB01536                                        0480
         ST    @09,@AL00001+16                                     0480
         LA    @09,IOPTLIST                                        0480
         ST    @09,@AFTEMPS                                        0480
         LA    @09,@AFTEMPS                                        0480
         ST    @09,@AL00001+20                                     0480
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0480
         LA    @01,@AL00001                                        0480
         BALR  @14,@15                                             0480
*       END;                        /* BLSDMSG                     0481
*                                      (ZZ2,05100,MSGPTR,BLSDMSGS) IN
*                                      SERT(FPPIDP,PDRKPNUM)ROUTE(BOT
*                                      H)                            */
*       IF DEFLTWD=DEFAULT THEN     /* IF DEFAULT KEYWORD PRESENT    */
         CLC   DEFLTWD(2),@CH00041                                 0482
         BNE   @RF00482                                            0482
*         ZZ1ZZ2P->ZZ2APID=PDRKPID; /* SET NEW PROBLEM AS DEFAULT    */
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0483
         L     @09,ZZ1ZZ2P(,@09)                                   0483
         MVC   ZZ2APID(8,@09),PDRKPID(BUFPTR)                      0483
*       ELSE                                                       0484
*         ;                         /* LEAVE DEFAULT PROBLEM ALONE   */
@RF00482 DS    0H                                                  0485
*     END;                                                         0485
*   ELSE                                                           0486
*     IF DEFLTWD=DEFAULT THEN       /* IF ADDPROB FAILED AND DEFAULT */
         B     @RC00467                                            0486
@RF00467 CLC   DEFLTWD(2),@CH00041                                 0486
         BNE   @RF00486                                            0486
*       DO;                         /* BLSDMSG                     0487
*                                      (ZZ2,04069,MSGPTR,BLSDMSGS) 0487
*                                      ROUTE(BOTH)                   */
*         CALL BLSDMSG0(ZZ2,04069,MSGPTR,BLSDMSGS,'00110000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                     0488
         LA    @04,@CF01537                                        0488
         ST    @04,@AL00001+4                                      0488
         LA    @04,MSGPTR                                          0488
         ST    @04,@AL00001+8                                      0488
         L     @04,ZZ2MSGSP(,ZZ2PTR)                               0488
         ST    @04,@AL00001+12                                     0488
         LA    @04,@CB01536                                        0488
         ST    @04,@AL00001+16                                     0488
         LA    @04,@CF00046                                        0488
         ST    @04,@AL00001+20                                     0488
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0488
         LA    @01,@AL00001                                        0488
         BALR  @14,@15                                             0488
*       END;                        /* BLSDMSG                     0489
*                                      (ZZ2,04069,MSGPTR,BLSDMSGS) 0489
*                                      ROUTE(BOTH) TELL USER THAT  0489
*                                      DEFAULT NOT ESTABLISHED       */
*     ELSE                                                         0490
*       ;                                                          0490
@RF00486 DS    0H                                                  0491
*   END SEG1;                                                      0491
@EL00003 DS    0H                                                  0491
@EF00003 DS    0H                                                  0491
@ER00003 LM    @14,@06,@SA00003                                    0491
         LM    @08,@12,@SA00003+36                                 0491
         BR    @14                                                 0491
         EJECT
*CLOSE:                                                            0492
*   PROCEDURE;                                                     0492
CLOSE    STM   @14,@06,@SA00004                                    0492
         STM   @08,@12,@SA00004+36                                 0492
*   DO;                             /* BLSCLOSE(ZZ1PDRP)             */
*     RFY                                                          0494
*       GPR01P RSTD;                                               0494
*     GPR01P=ZZ1PDRP;               /* ADDRESS THE DMCB              */
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0495
         L     GPR01P,ZZ1PDRP(,@04)                                0495
*     RFY                                                          0496
*       DMCB BASED(GPR01P);                                        0496
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                       0497
         LR    @04,GPR01P                                          0497
         N     @04,@CF01517                                        0497
         CLR   @04,GPR01P                                          0497
         BNE   @RF00497                                            0497
         CLC   DMCBID(4,GPR01P),@CC01518                           0497
         BNE   @RF00497                                            0497
*       DO;                                                        0498
*         DMCBRQST=DMCBCLR;         /* INDICATE CLOSE REQUEST        */
         MVI   DMCBRQST(GPR01P),X'02'                              0499
*         DMCBTMP='0'B;             /* INDICATE NON TEMP CLOSE       */
*         DMCBRM6='0'B;             /* INDICATE                      */
*         DMCBRM5='0'B;             /* DISP OPTION                   */
         NI    DMCBTMP(GPR01P),B'00011111'                         0502
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                                 0503
         BALR  @14,@15                                             0503
*       END;                                                       0504
*     ELSE                                                         0505
*       DO;                                                        0505
         B     @RC00497                                            0505
@RF00497 DS    0H                                                  0506
*         RFY                                                      0506
*          (GPR00F,                                                0506
*           GPR15F) RSTD;                                          0506
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                       0507
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                           0508
*         RFY                                                      0509
*          (GPR00F,                                                0509
*           GPR15F);                                               0509
*       END;                                                       0510
*     RFY                                                          0511
*       DMCB;                                                      0511
@RC00497 DS    0H                                                  0512
*     RFY                                                          0512
*       GPR01P;                                                    0512
*   END;                            /* BLSCLOSE(ZZ1PDRP) CLOSE     0513
*                                      PROBLEM DIRECTORY             */
*   RESPECIFY                                                      0514
*     RF RESTRICTED;                                               0514
*   IF RF^=0 THEN                   /* IF RETURN CODE NOT ZERO       */
         LTR   RF,RF                                               0515
         BZ    @RF00515                                            0515
*     DO;                                                          0516
*       IF RF=16 THEN               /* IF INVALID DMCB               */
         C     RF,@CF00052                                         0517
         BNE   @RF00517                                            0517
*         DO;                       /* ABEND(147) DUMP               */
*           RESPECIFY                                              0519
*            (GPR01F) RESTRICTED;                                  0519
*           GPR01F=147;             /* COMP CODE IN REG 1            */
         LA    GPR01F,147                                          0520
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00061                                     0521
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                                  0522
*           RESPECIFY                                              0523
*            (GPR01F) UNRESTRICTED;                                0523
*         END;                      /* ABEND(147) DUMP QUIT RIGHT  0524
*                                      HERE                          */
*       ELSE                                                       0525
*         ;                                                        0525
@RF00517 DS    0H                                                  0526
*       RETC=RF;                    /* SAVE RETURN CODE              */
         LR    RETC,RF                                             0526
*       RESPECIFY                                                  0527
*         RF UNRESTRICTED;                                         0527
*       DO;                         /* BLSDMSG                     0528
*                                      (ZZ2,04045,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*         CALL BLSDMSG0(ZZ2,04045,DMCBMSG,BLSDMSGS,'10110000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                     0529
         LA    @04,@CF01542                                        0529
         ST    @04,@AL00001+4                                      0529
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0529
         L     @04,ZZ1PDRP(,@04)                                   0529
         LA    @04,DMCBMSG(,@04)                                   0529
         ST    @04,@AL00001+8                                      0529
         L     @04,ZZ2MSGSP(,ZZ2PTR)                               0529
         ST    @04,@AL00001+12                                     0529
         LA    @04,@CB01521                                        0529
         ST    @04,@AL00001+16                                     0529
         LA    @04,@CF00046                                        0529
         ST    @04,@AL00001+20                                     0529
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0529
         LA    @01,@AL00001                                        0529
         BALR  @14,@15                                             0529
*       END;                        /* BLSDMSG                     0530
*                                      (ZZ2,04045,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*     END;                                                         0531
*   ELSE                                                           0532
*     ;                                                            0532
@RF00515 DS    0H                                                  0533
*   END CLOSE;                                                     0533
@EL00004 DS    0H                                                  0533
@EF00004 DS    0H                                                  0533
@ER00004 LM    @14,@06,@SA00004                                    0533
         LM    @08,@12,@SA00004+36                                 0533
         BR    @14                                                 0533
         EJECT
*SEG3:                                                             0534
*   PROCEDURE;                                                     0534
*                                                                  0534
SEG3     STM   @14,@06,@SA00005                                    0534
         STM   @08,@12,@SA00005+36                                 0534
*   /*****************************************************************/
*   /*                                                               */
*   /* BLSGET (ZZ1PDRP) ARG(PDRKEY)ARGLEN(LENGTH(PDRKEY))AREA(MYBUF)A*/
*   /* REALEN(LENGTH(MYBUF))UPD KEYEQ                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0535
*   DO;                             /* BLSGET (ZZ1PDRP) ARG(PDRKEY)AR
*                                      GLEN(LENGTH(PDRKEY))AREA(MYBUF
*                                      )AREALEN(LENGTH(MYBUF))UPD  0535
*                                      KEYEQ                         */
*     RFY                                                          0536
*       GPR01P RSTD;                                               0536
*     GPR01P=ZZ1PDRP;               /* ADDRESS DMCB                  */
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0537
         L     GPR01P,ZZ1PDRP(,@09)                                0537
*     RFY                                                          0538
*       DMCB BASED(GPR01P);                                        0538
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                       0539
         LR    @09,GPR01P                                          0539
         N     @09,@CF01517                                        0539
         CLR   @09,GPR01P                                          0539
         BNE   @RF00539                                            0539
         CLC   DMCBID(4,GPR01P),@CC01518                           0539
         BNE   @RF00539                                            0539
*       DO;                                                        0540
*         DMCBBUFP=ADDR(MYBUF);     /* PLACE BUFFER ADDRESS IN DMCB  */
         ST    BUFPTR,DMCBBUFP(,GPR01P)                            0541
*         DMCBBLEN=LENGTH(MYBUF)&'7FFFFFFF'X;/* PLACE BUFFER LENGTH
*                                      IN DMCB                       */
         MVC   DMCBBLEN(4,GPR01P),@CF00394                         0542
*         DMCBKEYP=ADDR(PDRKEY);    /* PLACE KEY ADDRESS IN DMCB     */
         ST    BUFPTR,DMCBKEYP(,GPR01P)                            0543
*         DMCBKEYL=(LENGTH(PDRKEY))&'7FFFFFFF'X;/* PLACE KEY LENGTH
*                                      IN DMCB                       */
         MVC   DMCBKEYL(4,GPR01P),@CF01016                         0544
*         DMCBKYD='1'B;             /* INDICATE KEYED ACCESS         */
*         DMCBAPX='0'B;             /* INDICATE EXACT KEY MATCH      */
*         DMCBGKY='0'B;             /* INDICATE FULL KEY SEARCH      */
*         DMCBUPD='1'B;             /* INDICATE UPDATE OPTION        */
         OI    DMCBKYD(GPR01P),B'10010000'                         0548
         NI    DMCBAPX(GPR01P),B'10011111'                         0548
*         DMCBRQST=DMCBGER;         /* INDICATE GET REQUEST          */
         MVI   DMCBRQST(GPR01P),X'04'                              0549
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                                 0550
         BALR  @14,@15                                             0550
*       END;                                                       0551
*     ELSE                                                         0552
*       DO;                                                        0552
         B     @RC00539                                            0552
@RF00539 DS    0H                                                  0553
*         RFY                                                      0553
*          (GPR00F,                                                0553
*           GPR15F) RSTD;                                          0553
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                       0554
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                           0555
*         RFY                                                      0556
*          (GPR00F,                                                0556
*           GPR15F);                                               0556
*       END;                                                       0557
*     RFY                                                          0558
*       DMCB;                                                      0558
@RC00539 DS    0H                                                  0559
*     RFY                                                          0559
*       GPR01P;                                                    0559
*   END;                            /* BLSGET (ZZ1PDRP) ARG(PDRKEY)AR
*                                      GLEN(LENGTH(PDRKEY))AREA(MYBUF
*                                      )AREALEN(LENGTH(MYBUF))UPD  0560
*                                      KEYEQ GET SEED RECORD FOR   0560
*                                      UPDATE                        */
*   RESPECIFY                                                      0561
*     RF RESTRICTED;                                               0561
*   IF RF^=0 THEN                   /* IF RETURN CODE NOT ZERO       */
         LTR   RF,RF                                               0562
         BZ    @RF00562                                            0562
*     DO;                                                          0563
*       IF RF=16 THEN               /* IF INVALID DMCB               */
         C     RF,@CF00052                                         0564
         BNE   @RF00564                                            0564
*         DO;                       /* ABEND(147) DUMP               */
*           RESPECIFY                                              0566
*            (GPR01F) RESTRICTED;                                  0566
*           GPR01F=147;             /* COMP CODE IN REG 1            */
         LA    GPR01F,147                                          0567
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00061                                     0568
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                                  0569
*           RESPECIFY                                              0570
*            (GPR01F) UNRESTRICTED;                                0570
*         END;                      /* ABEND(147) DUMP QUIT RIGHT  0571
*                                      HERE                          */
*       ELSE                                                       0572
*         ;                                                        0572
@RF00564 DS    0H                                                  0573
*       RETC=RF;                                                   0573
         LR    RETC,RF                                             0573
*       RESPECIFY                                                  0574
*         RF UNRESTRICTED;                                         0574
*       DO;                         /* BLSDMSG                     0575
*                                      (ZZ2,04043,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*         CALL BLSDMSG0(ZZ2,04043,DMCBMSG,BLSDMSGS,'10110000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                     0576
         LA    @09,@CF01548                                        0576
         ST    @09,@AL00001+4                                      0576
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0576
         L     @09,ZZ1PDRP(,@09)                                   0576
         LA    @09,DMCBMSG(,@09)                                   0576
         ST    @09,@AL00001+8                                      0576
         L     @09,ZZ2MSGSP(,ZZ2PTR)                               0576
         ST    @09,@AL00001+12                                     0576
         LA    @09,@CB01521                                        0576
         ST    @09,@AL00001+16                                     0576
         LA    @09,@CF00046                                        0576
         ST    @09,@AL00001+20                                     0576
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0576
         LA    @01,@AL00001                                        0576
         BALR  @14,@15                                             0576
*       END;                        /* BLSDMSG                     0577
*                                      (ZZ2,04043,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*     END;                                                         0578
*   ELSE                                                           0579
*     CALL SEG4;                    /* A SEED RECORD IS IN BUFFER    */
         B     @RC00562                                            0579
@RF00562 BAL   @14,SEG4                                            0579
*   END SEG3;                                                      0580
@EL00005 DS    0H                                                  0580
@EF00005 DS    0H                                                  0580
@ER00005 LM    @14,@06,@SA00005                                    0580
         LM    @08,@12,@SA00005+36                                 0580
         BR    @14                                                 0580
         EJECT
*SEG4:                                                             0581
*   PROCEDURE;                                                     0581
SEG4     STM   @14,@06,@SA00006                                    0581
         STM   @08,@12,@SA00006+36                                 0581
*   PACK(PACKED,PDRSVNUM);          /* CONVERT TO PACKED FORMAT      */
         PACK  PACKED(8),PDRSVNUM(5,BUFPTR)                        0582
*   CVB(PNUM,PACKED);               /* CONVERT PROB NUMBER TO BINARY */
         CVB   PNUM,PACKED                                         0583
*   PNUM=PNUM+1;                    /* INCREMENT PROBLEM NUMBER      */
         AL    PNUM,@CF00041                                       0584
*   IF PNUM>99999 THEN              /* IF PROBLEM NUMBER OVERFLOWED  */
         C     PNUM,@CF01555                                       0585
         BNH   @RF00585                                            0585
*     DO;                           /* START OVER WITH 1             */
*       DO;                         /* BLSDMSG                     0587
*                                      (ZZ2,05101,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*         CALL BLSDMSG0(ZZ2,05101,DMCBMSG,BLSDMSGS,'10110000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                     0588
         LA    @09,@CF01556                                        0588
         ST    @09,@AL00001+4                                      0588
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0588
         L     @09,ZZ1PDRP(,@09)                                   0588
         LA    @09,DMCBMSG(,@09)                                   0588
         ST    @09,@AL00001+8                                      0588
         L     @09,ZZ2MSGSP(,ZZ2PTR)                               0588
         ST    @09,@AL00001+12                                     0588
         LA    @09,@CB01521                                        0588
         ST    @09,@AL00001+16                                     0588
         LA    @09,@CF00046                                        0588
         ST    @09,@AL00001+20                                     0588
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0588
         LA    @01,@AL00001                                        0588
         BALR  @14,@15                                             0588
*       END;                        /* BLSDMSG                     0589
*                                      (ZZ2,05101,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*       RETC=12;                    /* SET ERROR RETURN CODE         */
         LA    RETC,12                                             0590
*     END;                                                         0591
*   ELSE                                                           0592
*     DO;                           /* PROBLEM NUMBER OK             */
         B     @RC00585                                            0592
@RF00585 DS    0H                                                  0593
*       CVD(PNUM,PACKED);           /* CONVERT PROB NUMBER TO PACKED */
         CVD   PNUM,PACKED                                         0593
*       UNPK(PDRSVNUM,PACKED);      /* CONVERT PROB NUMBER TO EBCDIC */
         UNPK  PDRSVNUM(5,BUFPTR),PACKED(8)                        0594
*       PDRSVNUM(LENGTH(PDRSVNUM))=PDRSVNUM(LENGTH(PDRSVNUM))×'0'; 0595
         OI    PDRSVNUM+4(BUFPTR),C'0'                             0595
*     END;                                                         0596
*                                                                  0596
*   /*****************************************************************/
*   /*                                                               */
*   /* BLSPUT (ZZ1PDRP)                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0597
*   DO;                             /* BLSPUT (ZZ1PDRP)              */
@RC00585 DS    0H                                                  0598
*     RFY                                                          0598
*       GPR01P RSTD;                                               0598
*     GPR01P=ZZ1PDRP;               /* ADDRESS DMCB                  */
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0599
         L     GPR01P,ZZ1PDRP(,@09)                                0599
*     RFY                                                          0600
*       DMCB BASED(GPR01P);                                        0600
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                       0601
         LR    @09,GPR01P                                          0601
         N     @09,@CF01517                                        0601
         CLR   @09,GPR01P                                          0601
         BNE   @RF00601                                            0601
         CLC   DMCBID(4,GPR01P),@CC01518                           0601
         BNE   @RF00601                                            0601
*       DO;                                                        0602
*         DMCBRQST=DMCBPUR;         /* INDICATE PUT REQUEST          */
         MVI   DMCBRQST(GPR01P),X'05'                              0603
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                                 0604
         BALR  @14,@15                                             0604
*       END;                                                       0605
*     ELSE                                                         0606
*       DO;                                                        0606
         B     @RC00601                                            0606
@RF00601 DS    0H                                                  0607
*         RFY                                                      0607
*          (GPR00F,                                                0607
*           GPR15F) RSTD;                                          0607
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                       0608
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                           0609
*         RFY                                                      0610
*          (GPR00F,                                                0610
*           GPR15F);                                               0610
*       END;                                                       0611
*     RFY                                                          0612
*       DMCB;                                                      0612
@RC00601 DS    0H                                                  0613
*     RFY                                                          0613
*       GPR01P;                                                    0613
*   END;                            /* BLSPUT (ZZ1PDRP) WRITE UPDATED
*                                      SEED RECORD                   */
*   RESPECIFY                                                      0615
*     RF RESTRICTED;                                               0615
*   IF RF^=0×RETC^=0 THEN           /* IF RETURN CODE NOT ZERO       */
         SLR   @14,@14                                             0616
         CR    RF,@14                                              0616
         BNE   @RT00616                                            0616
         CR    RETC,@14                                            0616
         BE    @RF00616                                            0616
@RT00616 DS    0H                                                  0617
*     DO;                                                          0617
*       IF RF=16 THEN               /* IF INVALID DMCB               */
         C     RF,@CF00052                                         0618
         BNE   @RF00618                                            0618
*         DO;                       /* ABEND(147) DUMP               */
*           RESPECIFY                                              0620
*            (GPR01F) RESTRICTED;                                  0620
*           GPR01F=147;             /* COMP CODE IN REG 1            */
         LA    GPR01F,147                                          0621
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00061                                     0622
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                                  0623
*           RESPECIFY                                              0624
*            (GPR01F) UNRESTRICTED;                                0624
*         END;                      /* ABEND(147) DUMP QUIT RIGHT  0625
*                                      HERE                          */
*       ELSE                                                       0626
*         ;                                                        0626
@RF00618 DS    0H                                                  0627
*       RETC=MAX(RF,RETC);                                         0627
         CR    RETC,RF                                             0627
         BNL   *+6
         LR    RETC,RF                                             0627
*       IF RF^=0 THEN                                              0628
         LTR   RF,RF                                               0628
         BZ    @RF00628                                            0628
*         DO;                                                      0629
*           RESPECIFY                                              0630
*             RF UNRESTRICTED;                                     0630
*           DO;                     /* BLSDMSG                     0631
*                                      (ZZ2,04044,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*             CALL BLSDMSG0(ZZ2,04044,DMCBMSG,BLSDMSGS,'10110000'B,0);
         ST    ZZ2PTR,@AL00001                                     0632
         LA    @09,@CF01562                                        0632
         ST    @09,@AL00001+4                                      0632
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0632
         L     @09,ZZ1PDRP(,@09)                                   0632
         LA    @09,DMCBMSG(,@09)                                   0632
         ST    @09,@AL00001+8                                      0632
         L     @09,ZZ2MSGSP(,ZZ2PTR)                               0632
         ST    @09,@AL00001+12                                     0632
         LA    @09,@CB01521                                        0632
         ST    @09,@AL00001+16                                     0632
         LA    @09,@CF00046                                        0632
         ST    @09,@AL00001+20                                     0632
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0632
         LA    @01,@AL00001                                        0632
         BALR  @14,@15                                             0632
*                                   /* BUILD MESSAGE                 */
*           END;                    /* BLSDMSG                     0633
*                                      (ZZ2,04044,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*         END;                                                     0634
*       ELSE                                                       0635
*         ;                                                        0635
@RF00628 DS    0H                                                  0636
*     END;                                                         0636
*   ELSE                                                           0637
*     CALL SEG5;                    /* NO PROBLEM                    */
         B     @RC00616                                            0637
@RF00616 BAL   @14,SEG5                                            0637
*   END SEG4;                                                      0638
@EL00006 DS    0H                                                  0638
@EF00006 DS    0H                                                  0638
@ER00006 LM    @14,@06,@SA00006                                    0638
         LM    @08,@12,@SA00006+36                                 0638
         BR    @14                                                 0638
         EJECT
*SEG5:                                                             0639
*   PROCEDURE;                                                     0639
SEG5     STM   @14,@06,@SA00007                                    0639
         STM   @08,@12,@SA00007+36                                 0639
*   CALL CLOSE;                     /* CLOSE PROBLEM DIRECTORY       */
         BAL   @14,CLOSE                                           0640
*   IF RETC=0 THEN                  /* IF CLOSE OK                   */
         LTR   RETC,RETC                                           0641
         BNZ   @RF00641                                            0641
*     DO;                           /* PROCEED WITH OPEN             */
*       CALL OPEN;                  /* OPEN THE PROBLEM DIRECTORY    */
         BAL   @14,OPEN                                            0643
*       IF RETC=0 THEN              /* IF OPEN OK                    */
         LTR   RETC,RETC                                           0644
         BNZ   @RF00644                                            0644
*         DO;                       /* BUILD THE STATUS RECORD       */
*           PDRKRCTY=PDRSTATC;      /* SET RECORD TYPE TO STATUS     */
         MVC   PDRKRCTY(2,BUFPTR),@CC01252                         0646
*           PDRKPNUM=PDRSVNUM;      /* SET NEW PROBLEM NUMBER IN KEY */
         MVC   PDRKPNUM(5,BUFPTR),PDRSVNUM(BUFPTR)                 0647
*           CALL CLEAR;             /* CLEAR STATUS RECORD           */
         BAL   @14,CLEAR                                           0648
*           PDRODATE=CURDATE;       /* SET CURRENT DATE INTO PDR     */
         MVC   PDRODATE(8,BUFPTR),CURDATE                          0649
*           PDROTIME=CURTIME;       /* SET CURRENT TIME INTO PDR     */
         MVC   PDROTIME(8,BUFPTR),CURTIME                          0650
*           PDRCOMP='';             /* CLEAR COMPONENT ID FIELD      */
         MVI   PDRCOMP(BUFPTR),C' '                                0651
         MVC   PDRCOMP+1(9,BUFPTR),PDRCOMP(BUFPTR)                 0651
*           PDRSEV=' ';             /* SET SEVERITY TO BLANK         */
         MVI   PDRSEV(BUFPTR),C' '                                 0652
*           PDROWNID=PSCBUSER;      /* SET DEFAULT PROBLEM OWNER     */
         L     @09,CPPLPSCB(,ZZ2PTR)                               0653
         MVC   PDROWNID(7,BUFPTR),PSCBUSER(@09)                    0653
*           PDROWNLN=PSCBUSRL;      /* SET LENGTH OF OWNER ID        */
         IC    @04,PSCBUSRL(,@09)                                  0654
         STC   @04,PDROWNLN(,BUFPTR)                               0654
*           PDRGROUP=FPGRPID;       /* SET DEFAULT GROUP ID          */
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0655
         L     @09,ZZ1FPP(,@09)                                    0655
         MVC   PDRGROUP(8,BUFPTR),FPGRPID(@09)                     0655
*           PDRSYS=FPSYSID;         /* SET DEFAULT SYSTEM ID         */
         MVC   PDRSYS(8,BUFPTR),FPSYSID(@09)                       0656
*           PDRUSER='';             /* CLEAR USER FIELD              */
         MVI   PDRUSER(BUFPTR),C' '                                0657
         MVC   PDRUSER+1(7,BUFPTR),PDRUSER(BUFPTR)                 0657
*           PDRPSTAT=PDRPINIC;      /* SET DEFAULT PROBLEM STATUS    */
         MVC   PDRPSTAT(8,BUFPTR),@CC01278                         0658
*           PDRPDATE='';            /* SET DATE OF STATUS CHANGE     */
         MVI   PDRPDATE(BUFPTR),C' '                               0659
         MVC   PDRPDATE+1(7,BUFPTR),PDRPDATE(BUFPTR)               0659
*           PDRPTIME='';            /* SET TIME OF STATUS CHANGE     */
         MVI   PDRPTIME(BUFPTR),C' '                               0660
         MVC   PDRPTIME+1(7,BUFPTR),PDRPTIME(BUFPTR)               0660
*           PDRRDATE=CURDATE;       /* SET DATE PROBLEM REPORTED     */
         MVC   PDRRDATE(8,BUFPTR),CURDATE                          0661
*           PDRRTIME=CURTIME;       /* SET TIME PROBLEM REPORTED     */
         MVC   PDRRTIME(8,BUFPTR),CURTIME                          0662
*           PDRISTAT='';            /* SET DEFAULT IBM STATUS        */
         MVI   PDRISTAT(BUFPTR),C' '                               0663
         MVC   PDRISTAT+1(7,BUFPTR),PDRISTAT(BUFPTR)               0663
*           PDRIDATE='';            /* SET DATE OF IBM STATUS CHANGE */
         MVI   PDRIDATE(BUFPTR),C' '                               0664
         MVC   PDRIDATE+1(7,BUFPTR),PDRIDATE(BUFPTR)               0664
*           PDRITIME='';            /* SET TIME OF IBM STATUS CHANGE */
         MVI   PDRITIME(BUFPTR),C' '                               0665
         MVC   PDRITIME+1(7,BUFPTR),PDRITIME(BUFPTR)               0665
*           PDRAPRID='';            /* SET DEFAULT APAR ID           */
         MVI   PDRAPRID(BUFPTR),C' '                               0666
         MVC   PDRAPRID+1(6,BUFPTR),PDRAPRID(BUFPTR)               0666
*           PDRTSTAT='';            /* SET DEFAULT PTF STATUS        */
         MVI   PDRTSTAT(BUFPTR),C' '                               0667
         MVC   PDRTSTAT+1(3,BUFPTR),PDRTSTAT(BUFPTR)               0667
*           PDRTDATE='';            /* SET DATE OF PTF STATUS CHANGE */
         MVI   PDRTDATE(BUFPTR),C' '                               0668
         MVC   PDRTDATE+1(7,BUFPTR),PDRTDATE(BUFPTR)               0668
*           PDRTTIME='';            /* SET TIME OF PTF STATUS CHANGE */
         MVI   PDRTTIME(BUFPTR),C' '                               0669
         MVC   PDRTTIME+1(7,BUFPTR),PDRTTIME(BUFPTR)               0669
*           PDRPTFID='';            /* SET DEFAULT PTF ID            */
         MVI   PDRPTFID(BUFPTR),C' '                               0670
         MVC   PDRPTFID+1(6,BUFPTR),PDRPTFID(BUFPTR)               0670
*           PDRFSTAT='';            /* SET DEFAULT FIX STATUS        */
         MVI   PDRFSTAT(BUFPTR),C' '                               0671
         MVC   PDRFSTAT+1(3,BUFPTR),PDRFSTAT(BUFPTR)               0671
*           PDRFDATE='';            /* SET DATE OF FIX STATUS CHANGE */
         MVI   PDRFDATE(BUFPTR),C' '                               0672
         MVC   PDRFDATE+1(7,BUFPTR),PDRFDATE(BUFPTR)               0672
*           PDRFTIME='';            /* SET TIME OF FIX STATUS CHANGE */
         MVI   PDRFTIME(BUFPTR),C' '                               0673
         MVC   PDRFTIME+1(7,BUFPTR),PDRFTIME(BUFPTR)               0673
*           PDRFIXID='';            /* SET DEFAULT FIX ID            */
         MVI   PDRFIXID(BUFPTR),C' '                               0674
         MVC   PDRFIXID+1(59,BUFPTR),PDRFIXID(BUFPTR)              0674
*           PDRABS='';              /* CLEAR PROBLEM ABSTRACT FIELD  */
         MVI   PDRABS(BUFPTR),C' '                                 0675
         MVC   PDRABS+1(127,BUFPTR),PDRABS(BUFPTR)                 0675
*           PDRDSSEQ='0000';        /* SET DATA SET RECORD SEQUENCE
*                                      NUMBER                        */
*                                                                  0676
         MVC   PDRDSSEQ(4,BUFPTR),@CC01526                         0676
*           /*********************************************************/
*           /*                                                       */
*           /* MERGE COMMAND PARAMETERS INTO STATUS RECORD           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0677
*           IF DTEIFP=ON&DTEIL^=0 THEN/* IF DATE PRESENT IN COMMAND  */
         TM    DTEIFP,B'10000000'                                  0677
         BNO   @RF00677                                            0677
         LH    @09,DTEIL                                           0677
         LTR   @09,@09                                             0677
         BZ    @RF00677                                            0677
*             PDRODATE=DTEI(1:DTEIL);/* SET DATE PROBLEM OCCURRED    */
         MVI   PDRODATE+1(BUFPTR),C' '                             0678
         MVC   PDRODATE+2(6,BUFPTR),PDRODATE+1(BUFPTR)             0678
         BCTR  @09,0                                               0678
         L     @04,DTEIP                                           0678
         EX    @09,@SM01630                                        0678
*           ELSE                                                   0679
*             ;                     /* DATE IS NOT PRESENT, LEAVE IT */
@RF00677 DS    0H                                                  0680
*           IF TMEIFP=ON&TMEIL^=0 THEN/* IF TIME PRESENT IN COMMAND  */
         TM    TMEIFP,B'10000000'                                  0680
         BNO   @RF00680                                            0680
         LH    @09,TMEIL                                           0680
         LTR   @09,@09                                             0680
         BZ    @RF00680                                            0680
*             PDROTIME=TMEI(1:TMEIL);/* SET TIME PROBLEM OCCURRED    */
         MVI   PDROTIME+1(BUFPTR),C' '                             0681
         MVC   PDROTIME+2(6,BUFPTR),PDROTIME+1(BUFPTR)             0681
         BCTR  @09,0                                               0681
         L     @04,TMEIP                                           0681
         EX    @09,@SM01632                                        0681
*           ELSE                                                   0682
*             ;                     /* TIME IS NOT PRESENT, LEAVE IT */
@RF00680 DS    0H                                                  0683
*           IF GRPIFP=ON&GRPIL^=0 THEN/* IF GROUP ID PRESENT IN    0683
*                                      COMMAND                       */
         TM    GRPIFP,B'10000000'                                  0683
         BNO   @RF00683                                            0683
         LH    @09,GRPIL                                           0683
         LTR   @09,@09                                             0683
         BZ    @RF00683                                            0683
*             PDRGROUP=GRPI(1:GRPIL);/* SET GROUP ID IN STATUS RECORD*/
         MVI   PDRGROUP+1(BUFPTR),C' '                             0684
         MVC   PDRGROUP+2(6,BUFPTR),PDRGROUP+1(BUFPTR)             0684
         BCTR  @09,0                                               0684
         L     @04,GRPIP                                           0684
         EX    @09,@SM01634                                        0684
*           ELSE                                                   0685
*             ;                     /* USE DEFAULT GROUP ID          */
@RF00683 DS    0H                                                  0686
*           IF SIDIFP=ON&SIDIL^=0 THEN/* IF SYS ID PRESENT IN COMMAND*/
         TM    SIDIFP,B'10000000'                                  0686
         BNO   @RF00686                                            0686
         LH    @09,SIDIL                                           0686
         LTR   @09,@09                                             0686
         BZ    @RF00686                                            0686
*             PDRSYS=SIDI(1:SIDIL); /* SET SYSTEM ID IN STATUS RECORD*/
         MVI   PDRSYS+1(BUFPTR),C' '                               0687
         MVC   PDRSYS+2(6,BUFPTR),PDRSYS+1(BUFPTR)                 0687
         BCTR  @09,0                                               0687
         L     @04,SIDIP                                           0687
         EX    @09,@SM01636                                        0687
*           ELSE                                                   0688
*             ;                     /* USE DEFAULT SYSTEM ID         */
@RF00686 DS    0H                                                  0689
*           IF UFLIFP=ON&UFLIL^=0 THEN/* IF USER FIELD IS PRESENT    */
         TM    UFLIFP,B'10000000'                                  0689
         BNO   @RF00689                                            0689
         LH    @09,UFLIL                                           0689
         LTR   @09,@09                                             0689
         BZ    @RF00689                                            0689
*             PDRUSER=UFLI(1:UFLIL);/* SET VALUE IN USER FIELD       */
         MVI   PDRUSER+1(BUFPTR),C' '                              0690
         MVC   PDRUSER+2(6,BUFPTR),PDRUSER+1(BUFPTR)               0690
         BCTR  @09,0                                               0690
         L     @04,UFLIP                                           0690
         EX    @09,@SM01638                                        0690
*           ELSE                                                   0691
*             ;                     /* LEAVE IT BLANK                */
@RF00689 DS    0H                                                  0692
*           IF CIDIFP=ON&CIDIL^=0 THEN/* IF COMPONENT ID PRESENT     */
         TM    CIDIFP,B'10000000'                                  0692
         BNO   @RF00692                                            0692
         LH    @09,CIDIL                                           0692
         LTR   @09,@09                                             0692
         BZ    @RF00692                                            0692
*             PDRCOMP=CIDI(1:CIDIL);/* SET COMPONENT ID IN RECORD    */
         MVI   PDRCOMP+1(BUFPTR),C' '                              0693
         MVC   PDRCOMP+2(8,BUFPTR),PDRCOMP+1(BUFPTR)               0693
         BCTR  @09,0                                               0693
         L     @04,CIDIP                                           0693
         EX    @09,@SM01640                                        0693
*           ELSE                                                   0694
*             ;                     /* LEAVE COMPONENT ID BLANK      */
@RF00692 DS    0H                                                  0695
*           IF OWNIFP=ON&OWNIL^=0 THEN/* IF PROBLEM OWNER ID PRESENT */
         TM    OWNIFP,B'10000000'                                  0695
         BNO   @RF00695                                            0695
         LH    @09,OWNIL                                           0695
         LTR   @09,@09                                             0695
         BZ    @RF00695                                            0695
*             DO;                                                  0696
*               PDROWNID=OWNI(1:OWNIL);/* SET PROBLEM OWNER IN RECORD*/
         MVI   PDROWNID+1(BUFPTR),C' '                             0697
         MVC   PDROWNID+2(5,BUFPTR),PDROWNID+1(BUFPTR)             0697
         LR    @04,@09                                             0697
         BCTR  @04,0                                               0697
         L     @01,OWNIP                                           0697
         EX    @04,@SM01642                                        0697
*               PDROWNLN=OWNIL;     /* SET LENGTH OF OWNER ID        */
         STC   @09,PDROWNLN(,BUFPTR)                               0698
*             END;                                                 0699
*           ELSE                                                   0700
*             ;                     /* USE CURRENT LOGON ID          */
@RF00695 DS    0H                                                  0701
*           IF SEVIFP=ON&SEVI(1)^='0' THEN/* IF PROBLEM SEVERITY   0701
*                                      PRESENT                       */
         TM    SEVIFP,B'10000000'                                  0701
         BNO   @RF00701                                            0701
         L     @09,SEVIP                                           0701
         CLI   SEVI(@09),C'0'                                      0701
         BE    @RF00701                                            0701
*             PDRSEV=SEVI(1);       /* SET PROBLEM SEVERITY          */
         MVC   PDRSEV(1,BUFPTR),SEVI(@09)                          0702
*           ELSE                                                   0703
*             ;                     /* LEAVE SEVERITY BLANK          */
@RF00701 DS    0H                                                  0704
*           IF APRIFP=ON&APRIL^=0 THEN/* IF APAR ID PRESENT IN     0704
*                                      COMMAND                       */
         TM    APRIFP,B'10000000'                                  0704
         BNO   @RF00704                                            0704
         LH    @09,APRIL                                           0704
         LTR   @09,@09                                             0704
         BZ    @RF00704                                            0704
*             PDRAPRID=APRI(1:APRIL);/* SET APAR ID IN RECORD        */
         MVI   PDRAPRID+1(BUFPTR),C' '                             0705
         MVC   PDRAPRID+2(5,BUFPTR),PDRAPRID+1(BUFPTR)             0705
         BCTR  @09,0                                               0705
         L     @04,APRIP                                           0705
         EX    @09,@SM01644                                        0705
*           ELSE                                                   0706
*             ;                     /* LEAVE APAR ID BLANK           */
@RF00704 DS    0H                                                  0707
*           IF PTFIFP=ON&PTFIL^=0 THEN/* IF PTF ID PRESENT IN COMMAND*/
         TM    PTFIFP,B'10000000'                                  0707
         BNO   @RF00707                                            0707
         LH    @09,PTFIL                                           0707
         LTR   @09,@09                                             0707
         BZ    @RF00707                                            0707
*             PDRPTFID=PTFI(1:PTFIL);/* SET PTF ID IN RECORD         */
         MVI   PDRPTFID+1(BUFPTR),C' '                             0708
         MVC   PDRPTFID+2(5,BUFPTR),PDRPTFID+1(BUFPTR)             0708
         BCTR  @09,0                                               0708
         L     @04,PTFIP                                           0708
         EX    @09,@SM01646                                        0708
*           ELSE                                                   0709
*             ;                     /* LEAVE PTF ID BLANK            */
@RF00707 DS    0H                                                  0710
*           IF FIXQFP=ON&FIXQL^=0 THEN/* IF FIX ID PRESENT IN COMMAND*/
         TM    FIXQFP,B'10000000'                                  0710
         BNO   @RF00710                                            0710
         LH    @09,FIXQL                                           0710
         LTR   @09,@09                                             0710
         BZ    @RF00710                                            0710
*             PDRFIXID=FIXQ(1:FIXQL);/* SET FIX ID IN RECORD         */
         MVI   PDRFIXID+1(BUFPTR),C' '                             0711
         MVC   PDRFIXID+2(58,BUFPTR),PDRFIXID+1(BUFPTR)            0711
         BCTR  @09,0                                               0711
         L     @04,FIXQP                                           0711
         EX    @09,@SM01648                                        0711
*           ELSE                                                   0712
*             ;                     /* LEAVE FIX ID BLANK            */
@RF00710 DS    0H                                                  0713
*           IF ABSQFP=ON&ABSQL^=0 THEN/* IF ABSTRACT PRESENT IN    0713
*                                      COMMAND                       */
         TM    ABSQFP,B'10000000'                                  0713
         BNO   @RF00713                                            0713
         LH    @09,ABSQL                                           0713
         LTR   @09,@09                                             0713
         BZ    @RF00713                                            0713
*             PDRABS=ABSQ(1:ABSQL); /* SET ABSTRACT IN RECORD        */
         MVI   PDRABS+1(BUFPTR),C' '                               0714
         MVC   PDRABS+2(126,BUFPTR),PDRABS+1(BUFPTR)               0714
         BCTR  @09,0                                               0714
         L     @04,ABSQP                                           0714
         EX    @09,@SM01650                                        0714
*           ELSE                                                   0715
*             ;                     /* LEAVE ABSTRACT FIELD BLANK    */
@RF00713 DS    0H                                                  0716
*           IF PSTTYPE>0 THEN       /* IF STATUS VALID               */
         LH    @09,PSTTYPE                                         0716
         LTR   @09,@09                                             0716
         BNP   @RF00716                                            0716
*             DO;                                                  0717
*               PDRPSTAT=STATPROB(PSTTYPE);/* SET STATUS FIELD       */
         SLA   @09,3                                               0718
         LA    @04,STATPROB-8(@09)                                 0718
         MVC   PDRPSTAT(8,BUFPTR),0(@04)                           0718
*               PDRPDATE=CURDATE;   /* SET DATE OF STATUS CHANGE     */
         MVC   PDRPDATE(8,BUFPTR),CURDATE                          0719
*               PDRPTIME=CURTIME;   /* SET TIME OF STATUS CHANGE     */
         MVC   PDRPTIME(8,BUFPTR),CURTIME                          0720
*             END;                                                 0721
*           ELSE                                                   0722
*             ;                     /* LEAVE STATUS AS INITIAL       */
@RF00716 DS    0H                                                  0723
*           IF IBMFLDWD>0 THEN      /* IF IBM STATUS VALID           */
         LH    @09,IBMFLDWD                                        0723
         LTR   @09,@09                                             0723
         BNP   @RF00723                                            0723
*             DO;                                                  0724
*               PDRISTAT=STATIBM(IBMFLDWD);/* SET IBM STATUS FIELD   */
         SLA   @09,3                                               0725
         LA    @04,STATIBM-8(@09)                                  0725
         MVC   PDRISTAT(8,BUFPTR),0(@04)                           0725
*               PDRIDATE=CURDATE;   /* SET DATE OF IBM STATUS CHANGE */
         MVC   PDRIDATE(8,BUFPTR),CURDATE                          0726
*               PDRITIME=CURTIME;   /* SET TIME OF IBM STATUS CHANGE */
         MVC   PDRITIME(8,BUFPTR),CURTIME                          0727
*             END;                                                 0728
*           ELSE                                                   0729
*             ;                     /* LEAVE IBM STATUS BLANK(NONE)  */
@RF00723 DS    0H                                                  0730
*           IF PTFFLDWD>0 THEN      /* IF PTF STATUS VALID           */
         LH    @09,PTFFLDWD                                        0730
         LTR   @09,@09                                             0730
         BNP   @RF00730                                            0730
*             DO;                                                  0731
*               PDRTSTAT=STATPTF(PTFFLDWD);/* SET PTF STATUS FIELD   */
         SLA   @09,2                                               0732
         LA    @04,STATPTF-4(@09)                                  0732
         MVC   PDRTSTAT(4,BUFPTR),0(@04)                           0732
*               PDRTDATE=CURDATE;   /* SET DATE OF PTF STATUS CHANGE */
         MVC   PDRTDATE(8,BUFPTR),CURDATE                          0733
*               PDRTTIME=CURTIME;   /* SET TIME OF PTF STATUS CHANGE */
         MVC   PDRTTIME(8,BUFPTR),CURTIME                          0734
*             END;                                                 0735
*           ELSE                                                   0736
*             ;                     /* LEAVE PTF STATUS BLANK (NONE) */
@RF00730 DS    0H                                                  0737
*           IF FIXFLDWD>0 THEN      /* IF FIX STATUS VALID           */
         LH    @09,FIXFLDWD                                        0737
         LTR   @09,@09                                             0737
         BNP   @RF00737                                            0737
*             DO;                                                  0738
*               PDRFSTAT=STATFIX(FIXFLDWD);/* SET FIX STATUS FIELD   */
         SLA   @09,2                                               0739
         LA    @04,STATFIX-4(@09)                                  0739
         MVC   PDRFSTAT(4,BUFPTR),0(@04)                           0739
*               PDRFDATE=CURDATE;   /* SET DATE OF FIX STATUS CHANGE */
         MVC   PDRFDATE(8,BUFPTR),CURDATE                          0740
*               PDRFTIME=CURTIME;   /* SET TIME OF FIX STATUS CHANGE */
         MVC   PDRFTIME(8,BUFPTR),CURTIME                          0741
*             END;                                                 0742
*           ELSE                                                   0743
*             ;                     /* LEAVE FIX STATUS BLANK (NONE) */
@RF00737 DS    0H                                                  0744
*           IF DSCQFP=ON THEN       /* IF PROBLEM DESCRIPTION PRESENT*/
         TM    DSCQFP,B'10000000'                                  0744
         BNO   @RF00744                                            0744
*             DO;                                                  0745
*               CALL DESLOCAL;      /* BUILD DESCRIPTION RECORD(S)   */
         BAL   @14,DESLOCAL                                        0746
*               RESPECIFY                                          0747
*                 RF RESTRICTED;                                   0747
*               RETC=RF;            /* SAVE RETURN CODE              */
         LR    RETC,RF                                             0748
*               RESPECIFY                                          0749
*                 RF UNRESTRICTED;                                 0749
*             END;                                                 0750
*           ELSE                                                   0751
*             ;                     /* NO PROBLEM DESCRIPTION TEXT   */
@RF00744 DS    0H                                                  0752
*           IF DDSDFP=ON THEN       /* IF PROB DESCRIPTION IN DATA 0752
*                                      SET                           */
         TM    DDSDFP,B'10000000'                                  0752
         BNO   @RF00752                                            0752
*             DO;                                                  0753
*               CALL BLSEADP1(ZZ2,DDS,MYBUF);/* BUILD RECORDS      0754
*                                      REMOTELY                      */
         ST    ZZ2PTR,@AL00001                                     0754
         LA    @09,DDS                                             0754
         ST    @09,@AL00001+4                                      0754
         ST    BUFPTR,@AL00001+8                                   0754
         L     @15,@CV01348                                        0754
         LA    @01,@AL00001                                        0754
         BALR  @14,@15                                             0754
*               RESPECIFY                                          0755
*                 RF RESTRICTED;                                   0755
*               RETC=RF;            /* SAVE RETURN CODE              */
         LR    RETC,RF                                             0756
*               RESPECIFY                                          0757
*                 RF UNRESTRICTED;                                 0757
*             END;                                                 0758
*           ELSE                                                   0759
*             ;                     /* NO PROBLEM DESCRIPTION DATASET*/
@RF00752 DS    0H                                                  0760
*           CALL SET;                                              0760
         BAL   @14,SET                                             0760
*           IF RETC=0 THEN                                         0761
         LTR   RETC,RETC                                           0761
         BNZ   @RF00761                                            0761
*             DO;                                                  0762
*                                                                  0762
*               /*****************************************************/
*               /*                                                   */
*               /* BLSPUT (ZZ1PDRP) RECLEN(LENGTH(PDREC)+LENGTH(PDRST*/
*               /* REC))AREALEN(LENGTH(MYBUF))AREA(MYBUF)            */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0763
*               DO;                 /* BLSPUT (ZZ1PDRP) RECLEN(LENGTH
*                                      (PDREC)+LENGTH(PDRSTREC))AREAL
*                                      EN(LENGTH(MYBUF))AREA(MYBUF)  */
*                 RFY                                              0764
*                   GPR01P RSTD;                                   0764
*                 GPR01P=ZZ1PDRP;   /* ADDRESS DMCB                  */
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0765
         L     GPR01P,ZZ1PDRP(,@09)                                0765
*                 RFY                                              0766
*                   DMCB BASED(GPR01P);                            0766
*                 IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/*  0767
*                                      VALID DMCB ?                  */
*                   THEN                                           0767
         LR    @09,GPR01P                                          0767
         N     @09,@CF01517                                        0767
         CLR   @09,GPR01P                                          0767
         BNE   @RF00767                                            0767
         CLC   DMCBID(4,GPR01P),@CC01518                           0767
         BNE   @RF00767                                            0767
*                   DO;                                            0768
*                     DMCBBUFP=ADDR(MYBUF);/* PLACE BUFFER ADDRESS IN
*                                      DMCB                          */
         ST    BUFPTR,DMCBBUFP(,GPR01P)                            0769
*                     DMCBBLEN=LENGTH(MYBUF)&'7FFFFFFF'X;/* PLACE  0770
*                                      BUFFER LENGTH IN DMCB         */
         MVC   DMCBBLEN(4,GPR01P),@CF00394                         0770
*                     DMCBORL=(LENGTH(PDREC)+LENGTH(PDRSTREC))&    0771
*                         '7FFFFFFF'X;/* PLACE RECORD LENGTH IN DMCB */
         MVC   DMCBORL(4,GPR01P),@CF01618                          0771
*                     DMCBRQST=DMCBPUR;/* INDICATE PUT REQUEST       */
         MVI   DMCBRQST(GPR01P),X'05'                              0772
*                     CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST         */
         L     @15,DMCBRI(,GPR01P)                                 0773
         BALR  @14,@15                                             0773
*                   END;                                           0774
*                 ELSE                                             0775
*                   DO;                                            0775
         B     @RC00767                                            0775
@RF00767 DS    0H                                                  0776
*                     RFY                                          0776
*                      (GPR00F,                                    0776
*                       GPR15F) RSTD;                              0776
*                     GPR00F=0;     /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                       0777
*                     GPR15F=16;    /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                           0778
*                     RFY                                          0779
*                      (GPR00F,                                    0779
*                       GPR15F);                                   0779
*                   END;                                           0780
*                 RFY                                              0781
*                   DMCB;                                          0781
@RC00767 DS    0H                                                  0782
*                 RFY                                              0782
*                   GPR01P;                                        0782
*               END;                /* BLSPUT (ZZ1PDRP) RECLEN(LENGTH
*                                      (PDREC)+LENGTH(PDRSTREC))AREAL
*                                      EN(LENGTH(MYBUF))AREA(MYBUF)
*                                      WRITE OUT THEN NEW PROBLEM  0783
*                                      STATUS RECORD                 */
*               RESPECIFY                                          0784
*                 RF RESTRICTED;                                   0784
*               IF RF^=0 THEN       /* IF RETURN CODE NOT ZERO       */
         LTR   RF,RF                                               0785
         BZ    @RF00785                                            0785
*                 DO;                                              0786
*                   IF RF=16 THEN   /* IF INVALID DMCB               */
         C     RF,@CF00052                                         0787
         BNE   @RF00787                                            0787
*                     DO;           /* ABEND(147) DUMP               */
*                       RESPECIFY                                  0789
*                        (GPR01F) RESTRICTED;                      0789
*                       GPR01F=147; /* COMP CODE IN REG 1            */
         LA    GPR01F,147                                          0790
*                       GPR01F=GPR01F×'80000000'X;/*               0791
*                                      DUMP/STEP/DUMPOPTS FLAG       */
         O     GPR01F,@CF00061                                     0791
*                       SVC(13);    /* ISSUE ABEND SVC               */
         SVC   13                                                  0792
*                       RESPECIFY                                  0793
*                        (GPR01F) UNRESTRICTED;                    0793
*                     END;          /* ABEND(147) DUMP QUIT RIGHT  0794
*                                      HERE                          */
*                   ELSE                                           0795
*                     ;                                            0795
@RF00787 DS    0H                                                  0796
*                   RETC=RF;        /* SAVE RETURN CODE              */
         LR    RETC,RF                                             0796
*                   RESPECIFY                                      0797
*                     RF UNRESTRICTED;                             0797
*                   DO;             /* BLSDMSG                     0798
*                                      (ZZ2,04044,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*                     CALL BLSDMSG0(ZZ2,04044,DMCBMSG,BLSDMSGS,    0799
*                         '10110000'B,0);/* BUILD MESSAGE            */
         ST    ZZ2PTR,@AL00001                                     0799
         LA    @09,@CF01562                                        0799
         ST    @09,@AL00001+4                                      0799
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0799
         L     @09,ZZ1PDRP(,@09)                                   0799
         LA    @09,DMCBMSG(,@09)                                   0799
         ST    @09,@AL00001+8                                      0799
         L     @09,ZZ2MSGSP(,ZZ2PTR)                               0799
         ST    @09,@AL00001+12                                     0799
         LA    @09,@CB01521                                        0799
         ST    @09,@AL00001+16                                     0799
         LA    @09,@CF00046                                        0799
         ST    @09,@AL00001+20                                     0799
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0799
         LA    @01,@AL00001                                        0799
         BALR  @14,@15                                             0799
*                   END;            /* BLSDMSG                     0800
*                                      (ZZ2,04044,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*                 END;                                             0801
*               ELSE                                               0802
*                 ;                 /* NO PROBLEM                    */
@RF00785 DS    0H                                                  0803
*             END;                                                 0803
*           ELSE                                                   0804
*             ;                                                    0804
@RF00761 DS    0H                                                  0805
*         END;                                                     0805
*       ELSE                                                       0806
*         ;                                                        0806
@RF00644 DS    0H                                                  0807
*     END;                                                         0807
*   ELSE                                                           0808
*     ;                                                            0808
@RF00641 DS    0H                                                  0809
*   END SEG5;                                                      0809
@EL00007 DS    0H                                                  0809
@EF00007 DS    0H                                                  0809
@ER00007 LM    @14,@06,@SA00007                                    0809
         LM    @08,@12,@SA00007+36                                 0809
         BR    @14                                                 0809
         EJECT
*SET:                                                              0810
*   PROCEDURE;                                                     0810
*                                                                  0810
SET      STM   @14,@06,@SA00008                                    0810
         STM   @08,@12,@SA00008+36                                 0810
*   /*****************************************************************/
*   /*                                                               */
*   /* BLSSET (ZZ1PDRP) AREA(MYBUF)AREALEN(LENGTH(MYBUF))KEYEQ       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0811
*   DO;                             /* BLSSET (ZZ1PDRP) AREA(MYBUF)AR
*                                      EALEN(LENGTH(MYBUF))KEYEQ     */
*     RFY                                                          0812
*       GPR01P RSTD;                                               0812
*     GPR01P=ZZ1PDRP;               /* ADDRESS DMCB                  */
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0813
         L     GPR01P,ZZ1PDRP(,@09)                                0813
*     RFY                                                          0814
*       DMCB BASED(GPR01P);                                        0814
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */
*       THEN                                                       0815
         LR    @09,GPR01P                                          0815
         N     @09,@CF01517                                        0815
         CLR   @09,GPR01P                                          0815
         BNE   @RF00815                                            0815
         CLC   DMCBID(4,GPR01P),@CC01518                           0815
         BNE   @RF00815                                            0815
*       DO;                                                        0816
*         DMCBBUFP=ADDR(MYBUF);     /* PLACE BUFFER ADDRESS IN DMCB  */
         ST    BUFPTR,DMCBBUFP(,GPR01P)                            0817
*         DMCBBLEN=LENGTH(MYBUF)&'7FFFFFFF'X;/* PLACE BUFFER LENGTH
*                                      IN DMCB                       */
         MVC   DMCBBLEN(4,GPR01P),@CF00394                         0818
*         DMCBKYD='1'B;             /* INDICATE KEYED ACCESS         */
*         DMCBAPX='0'B;             /* INDICATE EXACT KEY MATCH      */
*         DMCBGKY='0'B;             /* INDICATE FULL KEY SEARCH      */
         OI    DMCBKYD(GPR01P),B'10000000'                         0821
         NI    DMCBAPX(GPR01P),B'10011111'                         0821
*         DMCBRQST=DMCBSER;         /* INDICATE SET REQUEST          */
         MVI   DMCBRQST(GPR01P),X'03'                              0822
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                                 0823
         BALR  @14,@15                                             0823
*       END;                                                       0824
*     ELSE                                                         0825
*       DO;                                                        0825
         B     @RC00815                                            0825
@RF00815 DS    0H                                                  0826
*         RFY                                                      0826
*          (GPR00F,                                                0826
*           GPR15F) RSTD;                                          0826
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                       0827
*         GPR15F=16;                /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                           0828
*         RFY                                                      0829
*          (GPR00F,                                                0829
*           GPR15F);                                               0829
*       END;                                                       0830
*     RFY                                                          0831
*       DMCB;                                                      0831
@RC00815 DS    0H                                                  0832
*     RFY                                                          0832
*       GPR01P;                                                    0832
*   END;                            /* BLSSET (ZZ1PDRP) AREA(MYBUF)AR
*                                      EALEN(LENGTH(MYBUF))KEYEQ     */
*   RESPECIFY                                                      0834
*     RF RESTRICTED;                                               0834
*   IF RF^=0 THEN                   /* IF RETURN CODE NOT ZERO       */
         LTR   RF,RF                                               0835
         BZ    @RF00835                                            0835
*     DO;                                                          0836
*       IF RF=16 THEN               /* IF INVALID DMCB               */
         C     RF,@CF00052                                         0837
         BNE   @RF00837                                            0837
*         DO;                       /* ABEND(147) DUMP               */
*           RESPECIFY                                              0839
*            (GPR01F) RESTRICTED;                                  0839
*           GPR01F=147;             /* COMP CODE IN REG 1            */
         LA    GPR01F,147                                          0840
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00061                                     0841
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                                  0842
*           RESPECIFY                                              0843
*            (GPR01F) UNRESTRICTED;                                0843
*         END;                      /* ABEND(147) DUMP QUIT RIGHT  0844
*                                      HERE                          */
*       ELSE                                                       0845
*         ;                                                        0845
@RF00837 DS    0H                                                  0846
*       RETC=RF;                    /* SAVE RETURN CODE              */
         LR    RETC,RF                                             0846
*       RESPECIFY                                                  0847
*         RF UNRESTRICTED;                                         0847
*       DO;                         /* BLSDMSG                     0848
*                                      (ZZ2,04041,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*         CALL BLSDMSG0(ZZ2,04041,DMCBMSG,BLSDMSGS,'10110000'B,0);/*
*                                      BUILD MESSAGE                 */
         ST    ZZ2PTR,@AL00001                                     0849
         LA    @09,@CF01576                                        0849
         ST    @09,@AL00001+4                                      0849
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0849
         L     @09,ZZ1PDRP(,@09)                                   0849
         LA    @09,DMCBMSG(,@09)                                   0849
         ST    @09,@AL00001+8                                      0849
         L     @09,ZZ2MSGSP(,ZZ2PTR)                               0849
         ST    @09,@AL00001+12                                     0849
         LA    @09,@CB01521                                        0849
         ST    @09,@AL00001+16                                     0849
         LA    @09,@CF00046                                        0849
         ST    @09,@AL00001+20                                     0849
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0849
         LA    @01,@AL00001                                        0849
         BALR  @14,@15                                             0849
*       END;                        /* BLSDMSG                     0850
*                                      (ZZ2,04041,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*     END;                                                         0851
*   ELSE                                                           0852
*     ;                             /* NO PROBLEM                    */
@RF00835 DS    0H                                                  0853
*   END SET;                                                       0853
@EL00008 DS    0H                                                  0853
@EF00008 DS    0H                                                  0853
@ER00008 LM    @14,@06,@SA00008                                    0853
         LM    @08,@12,@SA00008+36                                 0853
         BR    @14                                                 0853
         EJECT
*CLEAR:                                                            0854
*   PROCEDURE;                                                     0854
*                                                                  0854
CLEAR    STM   @14,@12,12(@13)                                     0854
*/****************************************************************   */
*/*                                                                  */
*/* BY USING A SUBROUTINE THE REGISTER VALUES ARE PRESERVED          */
*/*                                                                  */
*/****************************************************************   */
*                                                                  0855
*   DECLARE                                                        0855
*     GPR4P REGISTER(4) UNRESTRICTED,                              0855
*     GPR5F REGISTER(5) UNRESTRICTED,                              0855
*     GPR6P REGISTER(6) UNRESTRICTED,                              0855
*     GPR7F REGISTER(7) UNRESTRICTED;                              0855
*   RESPECIFY                                                      0856
*    (GPR4P,                                                       0856
*     GPR5F,                                                       0856
*     GPR6P,                                                       0856
*     GPR7F) RESTRICTED;            /* RESTRICT REGISTERS FOR MOVE   */
*   GPR4P=ADDR(PDRSTREC);           /* STARTING ADDRESS TO CLEAR     */
         LA    GPR4P,PDRSTREC(,BUFPTR)                             0857
*   GPR5F=LENGTH(PDRSTREC);         /* LENGTH OF AREA TO CLEAR       */
         LA    GPR5F,400                                           0858
*   GPR6P=0;                        /* SOURCE LOCATION NOT RELEVANT  */
         SLR   GPR6P,GPR6P                                         0859
*   GPR7F=0;                        /* CLEAR BYTE AND SOURCE LENGTH  */
         SLR   GPR7F,GPR7F                                         0860
*   MVCL(GPR4P,GPR6P);              /* WIPE IT CLEAN                 */
         MVCL  GPR4P,GPR6P                                         0861
*   RESPECIFY                                                      0862
*    (GPR4P,                                                       0862
*     GPR5F,                                                       0862
*     GPR6P,                                                       0862
*     GPR7F) UNRESTRICTED;          /* RELEASE REGISTERS             */
*   END CLEAR;                                                     0863
@EL00009 DS    0H                                                  0863
@EF00009 DS    0H                                                  0863
@ER00009 LM    @14,@12,12(@13)                                     0863
         BR    @14                                                 0863
         EJECT
*DESLOCAL:                                                         0864
*   PROCEDURE;                                                     0864
*                                                                  0864
DESLOCAL STM   @14,@12,@SA00010                                    0864
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE COPIES THE PROBLEM DESCRIPTION INTO THE PROBLEM  */
*   /* DIRECTORY DATA SET                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0865
*   DECLARE                                                        0865
*     DESBUFP POINTER(31),          /* LOCAL BUFFER POINTER          */
*     I POINTER(31),                /* INDEX TO INPUT BYTE           */
*     J POINTER(31),                /* INDEX TO OUTPUT BYTE          */
*     K POINTER(31),                /* INDEX TO DESCRIPTION LINE     */
*     L POINTER(31),                /* INDEX TO LAST BLANK IN OUTPUT */
*     RNUM FIXED(31);               /* DESCRIPTION RECORD SEQUENCE 0865
*                                      NUMBER                        */
*   CALL SET;                       /* SET FOR DIRECT INSERTS        */
         BAL   @14,SET                                             0866
*   IF RETC=0 THEN                                                 0867
         SLR   @09,@09                                             0867
         CR    RETC,@09                                            0867
         BNE   @RF00867                                            0867
*     DO;                                                          0868
*       DESBUFP=ADDR(BUF2);         /* SET POINTER TO BUFFER         */
         LA    DESBUFP,BUF2                                        0869
*       DESBUFP->PDREC=PDREC;       /* COPY RECORD HEADER            */
         MVC   PDREC(16,DESBUFP),PDREC(BUFPTR)                     0870
*       RESPECIFY                                                  0871
*         PDREC BASED(DESBUFP);     /* BASE DIRECTORY RECORD IN    0871
*                                      BUFFER                        */
*       PDRKRCTY=PDRDESCC;          /* SET RECORD TYPE TO PROBLEM  0872
*                                      DESCRIPTION                   */
         MVC   PDRKRCTY(2,DESBUFP),@CC01254                        0872
*       RNUM=0;                     /* INITIALIZE RECORD SEQUENCE  0873
*                                      NUMBER                        */
         SLR   @04,@04                                             0873
         ST    @04,RNUM                                            0873
*       J=1;                        /* INITIALIZE INDEX TO OUTPUT  0874
*                                      BYTE                          */
         LA    @04,1                                               0874
         LR    J,@04                                               0874
*       K=1;                        /* INITIALIZE INDEX TO RECORD    */
         ST    @04,K                                               0875
*       L=1;                        /* INITIALIZE BLANK INDEX        */
         ST    @04,L                                               0876
*       DO I=1 TO DSCQL WHILE RETC=0;/* COPY DESCRIPTION TEXT        */
         LR    I,@04                                               0877
         B     @DE00877                                            0877
@DL00877 LTR   RETC,RETC                                           0877
         BNZ   @DC00877                                            0877
*         IF J^=L×DSCQ(I)^=' ' THEN /* SKIP OVER LEADING BLANKS      */
         C     J,L                                                 0878
         BNE   @RT00878                                            0878
         L     @04,DSCQP                                           0878
         ALR   @04,I                                               0878
         BCTR  @04,0                                               0878
         CLI   DSCQ(@04),C' '                                      0878
         BE    @RF00878                                            0878
@RT00878 DS    0H                                                  0879
*           DO;                     /* ON OUR WAY                    */
*             PDRDESC(K,J)=DSCQ(I)×' ';/* COPY A BYTE                */
         L     @04,K                                               0880
         MH    @04,@CH01235                                        0880
         ALR   @04,J                                               0880
         ALR   @04,DESBUFP                                         0880
         AL    @04,@CF01652                                        0880
         L     @15,DSCQP                                           0880
         LR    @14,@15                                             0880
         ALR   @14,I                                               0880
         BCTR  @14,0                                               0880
         MVC   PDRDESC-16(1,@04),DSCQ(@14)                         0880
         OI    PDRDESC-16(@04),C' '                                0880
*             J=J+1;                /* BUMP INDEX TO OUTPUT BYTE     */
         AL    J,@CF00041                                          0881
*             IF DSCQ(I)=' ' THEN   /* IF A BLANK WAS MOVED          */
         ALR   @15,I                                               0882
         BCTR  @15,0                                               0882
         CLI   DSCQ(@15),C' '                                      0882
         BNE   @RF00882                                            0882
*               L=J;                /* SAVE THE INDEX TO NEXT BYTE   */
         ST    J,L                                                 0883
*             ELSE                                                 0884
*               ;                   /* NOT A BLANK                   */
@RF00882 DS    0H                                                  0885
*             IF J>LENGTH(PDRDESC) THEN/* IF DESCRIPTION LINE IS FULL*/
         C     J,@CF01235                                          0885
         BNH   @RF00885                                            0885
*               DO;                                                0886
*                 CALL STEPLINE;    /* STEP TO NEXT LINE             */
         BAL   @14,STEPLINE                                        0887
*                 RESPECIFY                                        0888
*                   RF RESTRICTED;                                 0888
*                 RETC=RF;          /* RETURN TO CALLER              */
         LR    RETC,RF                                             0889
*                 RESPECIFY                                        0890
*                   RF UNRESTRICTED;                               0890
*               END;                                               0891
*             ELSE                                                 0892
*               ;                   /* LINE NOT FULL                 */
@RF00885 DS    0H                                                  0893
*           END;                    /* ONE BYTE MOVED                */
*         ELSE                                                     0894
*           ;                       /* SKIPPING LEADING AND MULTIPLE
*                                      BLANKS                        */
@RF00878 DS    0H                                                  0895
*       END;                        /* FINISHED WITH INPUT TEXT      */
         AL    I,@CF00041                                          0895
@DE00877 CH    I,DSCQL                                             0895
         BNH   @DL00877                                            0895
@DC00877 DS    0H                                                  0896
*       IF J>1 THEN                 /* IF PARTIAL LINE FILLED        */
         C     J,@CF00041                                          0896
         BNH   @RF00896                                            0896
*         DO;                       /* BLANK OUT THE REST OF IT      */
*           DO I=J TO LENGTH(PDRDESC);/* JUST DO ONE LINE            */
         LR    I,J                                                 0898
         B     @DE00898                                            0898
@DL00898 DS    0H                                                  0899
*             PDRDESC(K,I)=' ';     /* PAD IT WITH BLANKS            */
         L     @04,K                                               0899
         MH    @04,@CH01235                                        0899
         ALR   @04,I                                               0899
         ALR   @04,DESBUFP                                         0899
         AL    @04,@CF01652                                        0899
         MVI   PDRDESC-16(@04),C' '                                0899
*           END;                    /* END OF PADDING LOOP           */
         AL    I,@CF00041                                          0900
@DE00898 C     I,@CF01235                                          0900
         BNH   @DL00898                                            0900
*           K=K+1;                  /* BUMP THE LINE COUNTER         */
         LA    @04,1                                               0901
         L     @15,K                                               0901
         ALR   @15,@04                                             0901
         ST    @15,K                                               0901
*           BUFPTR->PDRDESCL=BUFPTR->PDRDESCL+1;/* LIKEWISE THE TOTAL*/
         AL    @04,PDRDESCL(,BUFPTR)                               0902
         ST    @04,PDRDESCL(,BUFPTR)                               0902
*         END;                      /* END OF ODD LINE PROCESS       */
*       ELSE                                                       0904
*         ;                         /* NO PARTIAL LINE PRESENT       */
@RF00896 DS    0H                                                  0905
*       IF K>1&RETC=0 THEN          /* IF ANY LINES IN RECORD        */
         L     @04,K                                               0905
         C     @04,@CF00041                                        0905
         BNH   @RF00905                                            0905
         LTR   RETC,RETC                                           0905
         BNZ   @RF00905                                            0905
*         DO;                       /* WRITE OUT THE LAST ONE        */
*           K=K-1;                  /* STEP BACK TO TRUE LINE COUNT  */
         BCTR  @04,0                                               0907
         ST    @04,K                                               0907
*           IF RNUM<10000 THEN                                     0908
         L     @15,RNUM                                            0908
         C     @15,@CF01596                                        0908
         BNL   @RF00908                                            0908
*             DO;                                                  0909
*               CVD(RNUM,PACKED);   /* CONVERT RECORD NUMBER TO    0910
*                                      DECIMAL                       */
         CVD   @15,PACKED                                          0910
*               UNPK(PDRRECSQ,PACKED);/* UNPACK IT                   */
         UNPK  PDRRECSQ(4,DESBUFP),PACKED(8)                       0911
*               PDRRECSQ(LENGTH(PDRRECSQ))=PDRRECSQ(LENGTH(PDRRECSQ))×
*                   '0';            /* CORRECT ZONE OF LAST DIGIT    */
*                                                                  0912
         OI    PDRRECSQ+3(DESBUFP),C'0'                            0912
*               /*****************************************************/
*               /*                                                   */
*               /* BLSPUT (ZZ1PDRP)                                  */
*               /* AREA(PDREC)RECLEN(LENGTH(PDREC)+K*LENGTH(PDRDESC))*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0913
*               DO;                 /* BLSPUT (ZZ1PDRP) AREA(PDREC)RE
*                                      CLEN(LENGTH(PDREC)+K*LENGTH(PD
*                                      RDESC))                       */
*                 RFY                                              0914
*                   GPR01P RSTD;                                   0914
*                 GPR01P=ZZ1PDRP;   /* ADDRESS DMCB                  */
         L     @15,ZZ2ZZ1P(,ZZ2PTR)                                0915
         L     GPR01P,ZZ1PDRP(,@15)                                0915
*                 RFY                                              0916
*                   DMCB BASED(GPR01P);                            0916
*                 IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/*  0917
*                                      VALID DMCB ?                  */
*                   THEN                                           0917
         LR    @00,GPR01P                                          0917
         N     @00,@CF01517                                        0917
         CLR   @00,GPR01P                                          0917
         BNE   @RF00917                                            0917
         CLC   DMCBID(4,GPR01P),@CC01518                           0917
         BNE   @RF00917                                            0917
*                   DO;                                            0918
*                     DMCBBUFP=ADDR(PDREC);/* PLACE BUFFER ADDRESS IN
*                                      DMCB                          */
         ST    DESBUFP,DMCBBUFP(,GPR01P)                           0919
*                     DMCBORL=(LENGTH(PDREC)+K*LENGTH(PDRDESC))&   0920
*                         '7FFFFFFF'X;/* PLACE RECORD LENGTH IN DMCB */
         MH    @04,@CH01235                                        0920
         AL    @04,@CF00052                                        0920
         N     @04,@CF01547                                        0920
         ST    @04,DMCBORL(,GPR01P)                                0920
*                     DMCBRQST=DMCBPUR;/* INDICATE PUT REQUEST       */
         MVI   DMCBRQST(GPR01P),X'05'                              0921
*                     CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST         */
         L     @15,DMCBRI(,GPR01P)                                 0922
         BALR  @14,@15                                             0922
*                   END;                                           0923
*                 ELSE                                             0924
*                   DO;                                            0924
         B     @RC00917                                            0924
@RF00917 DS    0H                                                  0925
*                     RFY                                          0925
*                      (GPR00F,                                    0925
*                       GPR15F) RSTD;                              0925
*                     GPR00F=0;     /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                       0926
*                     GPR15F=16;    /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                           0927
*                     RFY                                          0928
*                      (GPR00F,                                    0928
*                       GPR15F);                                   0928
*                   END;                                           0929
*                 RFY                                              0930
*                   DMCB;                                          0930
@RC00917 DS    0H                                                  0931
*                 RFY                                              0931
*                   GPR01P;                                        0931
*               END;                /* BLSPUT (ZZ1PDRP) AREA(PDREC)RE
*                                      CLEN(LENGTH(PDREC)+K*LENGTH(PD
*                                      RDESC)) WRITE OUT LAST      0932
*                                      DESCRIPTION RECORD            */
*               RESPECIFY                                          0933
*                 RF RESTRICTED;                                   0933
*               IF RF^=0 THEN       /* IF RETURN CODE NOT ZERO       */
         LTR   RF,RF                                               0934
         BZ    @RF00934                                            0934
*                 DO;                                              0935
*                   IF RF=16 THEN   /* IF INVALID DMCB               */
         C     RF,@CF00052                                         0936
         BNE   @RF00936                                            0936
*                     DO;           /* ABEND(147) DUMP               */
*                       RESPECIFY                                  0938
*                        (GPR01F) RESTRICTED;                      0938
*                       GPR01F=147; /* COMP CODE IN REG 1            */
         LA    GPR01F,147                                          0939
*                       GPR01F=GPR01F×'80000000'X;/*               0940
*                                      DUMP/STEP/DUMPOPTS FLAG       */
         O     GPR01F,@CF00061                                     0940
*                       SVC(13);    /* ISSUE ABEND SVC               */
         SVC   13                                                  0941
*                       RESPECIFY                                  0942
*                        (GPR01F) UNRESTRICTED;                    0942
*                     END;          /* ABEND(147) DUMP QUIT RIGHT  0943
*                                      HERE                          */
*                   ELSE                                           0944
*                     ;                                            0944
@RF00936 DS    0H                                                  0945
*                   RETC=RF;        /* SAVE RETURN CODE              */
         LR    RETC,RF                                             0945
*                   RESPECIFY                                      0946
*                     RF UNRESTRICTED;                             0946
*                   DO;             /* BLSDMSG                     0947
*                                      (ZZ2,04044,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*                     CALL BLSDMSG0(ZZ2,04044,DMCBMSG,BLSDMSGS,    0948
*                         '10110000'B,0);/* BUILD MESSAGE            */
         ST    ZZ2PTR,@AL00001                                     0948
         LA    @09,@CF01562                                        0948
         ST    @09,@AL00001+4                                      0948
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0948
         L     @09,ZZ1PDRP(,@09)                                   0948
         LA    @09,DMCBMSG(,@09)                                   0948
         ST    @09,@AL00001+8                                      0948
         L     @09,ZZ2MSGSP(,ZZ2PTR)                               0948
         ST    @09,@AL00001+12                                     0948
         LA    @09,@CB01521                                        0948
         ST    @09,@AL00001+16                                     0948
         LA    @09,@CF00046                                        0948
         ST    @09,@AL00001+20                                     0948
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0948
         LA    @01,@AL00001                                        0948
         BALR  @14,@15                                             0948
*                   END;            /* BLSDMSG                     0949
*                                      (ZZ2,04044,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*                 END;              /* RETURN TO CALLER              */
*               ELSE                                               0951
*                 ;                 /* NO PROBLEM                    */
@RF00934 DS    0H                                                  0952
*             END;                                                 0952
*           ELSE                                                   0953
*             CALL OVF;             /* RECORD SEQUENCE # OVERFLOW    */
         B     @RC00908                                            0953
@RF00908 BAL   @14,OVF                                             0953
*         END;                                                     0954
*       ELSE                                                       0955
*         ;                         /* CAME OUT EVEN WITH NOTHING  0955
*                                      LEFT OVER (THAT'S UNUSUAL!)   */
@RF00905 DS    0H                                                  0956
*     END;                                                         0956
*   ELSE                                                           0957
*     ;                                                            0957
@RF00867 DS    0H                                                  0958
*   RETURN CODE(RETC);              /* ALL IS WELL                   */
@RC00867 LR    @15,RETC                                            0958
         L     @14,@SA00010                                        0958
         LM    @00,@12,@SA00010+8                                  0958
         BR    @14                                                 0958
         EJECT
*STEPLINE:                                                         0959
*   PROCEDURE;                                                     0959
STEPLINE STM   @14,@01,@SA00011                                    0959
         STM   @04,@12,@SA00011+16                                 0959
*   IF L^=J&I<DSCQL&DSCQ(I+1)^=' '&L^=1 THEN/* NOT BLANK?            */
         L     @04,L                                               0960
         CR    @04,J                                               0960
         BE    @RF00960                                            0960
         CH    I,DSCQL                                             0960
         BNL   @RF00960                                            0960
         L     @01,DSCQP                                           0960
         ALR   @01,I                                               0960
         CLI   DSCQ(@01),C' '                                      0960
         BE    @RF00960                                            0960
         C     @04,@CF00041                                        0960
         BE    @RF00960                                            0960
*     DO;                           /* PUT WORD IN NEXT LINE         */
*       I=I+L-J;                    /* BACK UP THE INPUT             */
         LR    @15,I                                               0962
         ALR   @15,@04                                             0962
         SLR   @15,J                                               0962
         LR    I,@15                                               0962
*       DO L=L TO LENGTH(PDRDESC);  /* CLEAR PARTIAL WORD IN OUTPUT  */
         B     @DE00963                                            0963
@DL00963 DS    0H                                                  0964
*         PDRDESC(K,L)=' ';         /* BLANK IT OUT                  */
         L     @03,K                                               0964
         MH    @03,@CH01235                                        0964
         ALR   @03,@04                                             0964
         ALR   @03,DESBUFP                                         0964
         AL    @03,@CF01652                                        0964
         MVI   PDRDESC-16(@03),C' '                                0964
*       END;                        /* END OF BLANKING LOOP          */
         AL    @04,@CF00041                                        0965
         ST    @04,L                                               0965
@DE00963 C     @04,@CF01235                                        0965
         BNH   @DL00963                                            0965
*     END;                          /* ALL DONE                      */
*   ELSE                            /* NEXT CHARACTER IS BLANK OR    */
*     ;                             /* LAST CHARACTER IN LINE BLANK  */
@RF00960 DS    0H                                                  0968
*   L=1;                            /* RESET BLANK INDEX             */
         LA    @04,1                                               0968
         ST    @04,L                                               0968
*   J=1;                            /* SET INDEX TO FIRST BYTE OF  0969
*                                      LINE                          */
         LR    J,@04                                               0969
*   K=K+1;                          /* STEP INDEX TO NEXT LINE       */
         L     @15,K                                               0970
         ALR   @15,@04                                             0970
         ST    @15,K                                               0970
*   BUFPTR->PDRDESCL=BUFPTR->PDRDESCL+1;/* BUMP TOTAL LINE COUNT     */
         AL    @04,PDRDESCL(,BUFPTR)                               0971
         ST    @04,PDRDESCL(,BUFPTR)                               0971
*   IF K>PDRDEMAX THEN              /* IF RECORD IS FULL             */
         C     @15,@CF00142                                        0972
         BNH   @RF00972                                            0972
*     DO;                                                          0973
*       CALL WRITEIT;               /* FILL IT IN AND WRITE IT OUT   */
         BAL   @14,WRITEIT                                         0974
*       RESPECIFY                                                  0975
*         RF RESTRICTED;                                           0975
*       RETC=RF;                    /* SAVE RETURN CODE              */
         LR    RETC,RF                                             0976
*       RESPECIFY                                                  0977
*         RF UNRESTRICTED;                                         0977
*     END;                                                         0978
*   ELSE                                                           0979
*     ;                             /* RECORD NOT FULL               */
@RF00972 DS    0H                                                  0980
*   RETURN CODE(RETC);              /* ALL IS OK                     */
         LR    @15,RETC                                            0980
         L     @14,@SA00011                                        0980
         LM    @00,@01,@SA00011+8                                  0980
         LM    @04,@12,@SA00011+16                                 0980
         BR    @14                                                 0980
*   END STEPLINE;                   /* READY TO PROCESS NEXT LINE    */
         EJECT
*WRITEIT:                                                          0982
*   PROCEDURE;                                                     0982
WRITEIT  STM   @14,@12,@SA00012                                    0982
*   K=1;                            /* RESET LINE NUMBER             */
         LA    @08,1                                               0983
         ST    @08,K                                               0983
*   IF RNUM<10000 THEN                                             0984
         L     @04,RNUM                                            0984
         C     @04,@CF01596                                        0984
         BNL   @RF00984                                            0984
*     DO;                                                          0985
*       CVD(RNUM,PACKED);           /* CONVERT RSEQUENCE NUMBER TO   */
         CVD   @04,PACKED                                          0986
*       UNPK(PDRRECSQ,PACKED);      /* DECIMAL AND UNPACK IT         */
         UNPK  PDRRECSQ(4,DESBUFP),PACKED(8)                       0987
*       PDRRECSQ(LENGTH(PDRRECSQ))=PDRRECSQ(LENGTH(PDRRECSQ))×'0';/*
*                                      CORRECT THE ZONE OF LAST DIGIT*/
         OI    PDRRECSQ+3(DESBUFP),C'0'                            0988
*       RNUM=RNUM+1;                /* BUMP THE SEQUENCE NUMBER      */
*                                                                  0989
         ALR   @04,@08                                             0989
         ST    @04,RNUM                                            0989
*       /*************************************************************/
*       /*                                                           */
*       /* BLSPUT (ZZ1PDRP)                                          */
*       /* AREA(PDREC)RECLEN(LENGTH(PDREC)+PDRDEMAX*LENGTH(PDRDESC)) */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0990
*       DO;                         /* BLSPUT (ZZ1PDRP) AREA(PDREC)RE
*                                      CLEN(LENGTH(PDREC)+PDRDEMAX*LE
*                                      NGTH(PDRDESC))                */
*         RFY                                                      0991
*           GPR01P RSTD;                                           0991
*         GPR01P=ZZ1PDRP;           /* ADDRESS DMCB                  */
         L     @08,ZZ2ZZ1P(,ZZ2PTR)                                0992
         L     GPR01P,ZZ1PDRP(,@08)                                0992
*         RFY                                                      0993
*           DMCB BASED(GPR01P);                                    0993
*         IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB
*                                      ?                             */
*           THEN                                                   0994
         LR    @08,GPR01P                                          0994
         N     @08,@CF01517                                        0994
         CLR   @08,GPR01P                                          0994
         BNE   @RF00994                                            0994
         CLC   DMCBID(4,GPR01P),@CC01518                           0994
         BNE   @RF00994                                            0994
*           DO;                                                    0995
*             DMCBBUFP=ADDR(PDREC); /* PLACE BUFFER ADDRESS IN DMCB  */
         ST    DESBUFP,DMCBBUFP(,GPR01P)                           0996
*             DMCBORL=(LENGTH(PDREC)+PDRDEMAX*LENGTH(PDRDESC))&    0997
*                 '7FFFFFFF'X;      /* PLACE RECORD LENGTH IN DMCB   */
         MVC   DMCBORL(4,GPR01P),@CF01621                          0997
*             DMCBRQST=DMCBPUR;     /* INDICATE PUT REQUEST          */
         MVI   DMCBRQST(GPR01P),X'05'                              0998
*             CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST                 */
         L     @15,DMCBRI(,GPR01P)                                 0999
         BALR  @14,@15                                             0999
*           END;                                                   1000
*         ELSE                                                     1001
*           DO;                                                    1001
         B     @RC00994                                            1001
@RF00994 DS    0H                                                  1002
*             RFY                                                  1002
*              (GPR00F,                                            1002
*               GPR15F) RSTD;                                      1002
*             GPR00F=0;             /* INDICATE NO MESSAGE CHAIN     */
         SLR   GPR00F,GPR00F                                       1003
*             GPR15F=16;            /* INDICATE INVALID DMCB         */
         LA    GPR15F,16                                           1004
*             RFY                                                  1005
*              (GPR00F,                                            1005
*               GPR15F);                                           1005
*           END;                                                   1006
*         RFY                                                      1007
*           DMCB;                                                  1007
@RC00994 DS    0H                                                  1008
*         RFY                                                      1008
*           GPR01P;                                                1008
*       END;                        /* BLSPUT (ZZ1PDRP) AREA(PDREC)RE
*                                      CLEN(LENGTH(PDREC)+PDRDEMAX*LE
*                                      NGTH(PDRDESC)) WRITE OUT THE
*                                      RECORD                        */
*       RESPECIFY                                                  1010
*         RF RESTRICTED;                                           1010
*       IF RF^=0 THEN               /* IF RETURN CODE NOT ZERO       */
         LTR   RF,RF                                               1011
         BZ    @RF01011                                            1011
*         DO;                                                      1012
*           IF RF=16 THEN           /* IF INVALID DMCB               */
         C     RF,@CF00052                                         1013
         BNE   @RF01013                                            1013
*             DO;                   /* ABEND(147) DUMP               */
*               RESPECIFY                                          1015
*                (GPR01F) RESTRICTED;                              1015
*               GPR01F=147;         /* COMP CODE IN REG 1            */
         LA    GPR01F,147                                          1016
*               GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG */
         O     GPR01F,@CF00061                                     1017
*               SVC(13);            /* ISSUE ABEND SVC               */
         SVC   13                                                  1018
*               RESPECIFY                                          1019
*                (GPR01F) UNRESTRICTED;                            1019
*             END;                  /* ABEND(147) DUMP QUIT RIGHT  1020
*                                      HERE                          */
*           ELSE                                                   1021
*             ;                                                    1021
@RF01013 DS    0H                                                  1022
*           RETC=RF;                /* SAVE RETURN CODE              */
         LR    RETC,RF                                             1022
*           RESPECIFY                                              1023
*             RF UNRESTRICTED;                                     1023
*           DO;                     /* BLSDMSG                     1024
*                                      (ZZ2,04044,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*             CALL BLSDMSG0(ZZ2,04044,DMCBMSG,BLSDMSGS,'10110000'B,0);
         ST    ZZ2PTR,@AL00001                                     1025
         LA    @08,@CF01562                                        1025
         ST    @08,@AL00001+4                                      1025
         L     @08,ZZ2ZZ1P(,ZZ2PTR)                                1025
         L     @08,ZZ1PDRP(,@08)                                   1025
         LA    @08,DMCBMSG(,@08)                                   1025
         ST    @08,@AL00001+8                                      1025
         L     @08,ZZ2MSGSP(,ZZ2PTR)                               1025
         ST    @08,@AL00001+12                                     1025
         LA    @08,@CB01521                                        1025
         ST    @08,@AL00001+16                                     1025
         LA    @08,@CF00046                                        1025
         ST    @08,@AL00001+20                                     1025
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               1025
         LA    @01,@AL00001                                        1025
         BALR  @14,@15                                             1025
*                                   /* BUILD MESSAGE                 */
*           END;                    /* BLSDMSG                     1026
*                                      (ZZ2,04044,DMCBMSG,BLSDMSGS)
*                                      ROUTE(BOTH)LIFO               */
*         END;                      /* DONE                          */
*       ELSE                                                       1028
*         ;                         /* NO PROBLEM                    */
@RF01011 DS    0H                                                  1029
*     END;                                                         1029
*   ELSE                                                           1030
*     CALL OVF;                     /* RECORD SEQUENCE # OVERFLOW    */
         B     @RC00984                                            1030
@RF00984 BAL   @14,OVF                                             1030
*   RETURN CODE(RETC);              /* ALL IS OK                     */
@RC00984 LR    @15,RETC                                            1031
         L     @14,@SA00012                                        1031
         LM    @00,@12,@SA00012+8                                  1031
         BR    @14                                                 1031
*   END WRITEIT;                    /* READY TO PROCESS NEXT RECORD  */
*   END DESLOCAL;                   /* ALL DONE                      */
         EJECT
*OVF:                                                              1034
*   PROCEDURE;                      /* RECORD SEQUENCE # OVERFLOW    */
OVF      STM   @14,@12,@SA00013                                    1034
*   MSGPTR=0;                                                      1035
         SLR   @07,@07                                             1035
         ST    @07,MSGPTR                                          1035
*   DO;                             /* BLSDMSG                     1036
*                                      (ZZ2,04070,MSGPTR,BLSDMSGS) 1036
*                                      ROUTE(BOTH)LIFO               */
*     CALL BLSDMSG0(ZZ2,04070,MSGPTR,BLSDMSGS,'10110000'B,0);/* BUILD
*                                      MESSAGE                       */
         ST    ZZ2PTR,@AL00001                                     1037
         LA    @07,@CF01610                                        1037
         ST    @07,@AL00001+4                                      1037
         LA    @07,MSGPTR                                          1037
         ST    @07,@AL00001+8                                      1037
         L     @07,ZZ2MSGSP(,ZZ2PTR)                               1037
         ST    @07,@AL00001+12                                     1037
         LA    @07,@CB01521                                        1037
         ST    @07,@AL00001+16                                     1037
         LA    @07,@CF00046                                        1037
         ST    @07,@AL00001+20                                     1037
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               1037
         LA    @01,@AL00001                                        1037
         BALR  @14,@15                                             1037
*   END;                            /* BLSDMSG                     1038
*                                      (ZZ2,04070,MSGPTR,BLSDMSGS) 1038
*                                      ROUTE(BOTH)LIFO               */
*   END OVF;                                                       1039
*                                                                  1039
@EL00013 DS    0H                                                  1039
@EF00013 DS    0H                                                  1039
@ER00013 LM    @14,@12,@SA00013                                    1039
         BR    @14                                                 1039
*/********************************************************************/
*/*                                                                  */
*/* COMMAND PROCESSOR CODE ENDS                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  1040
         EJECT
*                                                                  1040
*/*BLSUPEND--MVS IPCS MODULE                                         */
*                                                                  1040
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                     1040
*     GPR01F FIXED(31) REG(1),                                     1040
*     GPR15F FIXED(31) REG(15),                                    1040
*     GPR01P PTR(31) REG(1);                                       1040
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       1041
*     I031F FIXED(31) BASED,                                       1041
*     I031P PTR(31) BASED,                                         1041
*     I015F FIXED(15) BASED,                                       1041
*     I015P PTR(15) BASED,                                         1041
*     I008P PTR(8) BASED,                                          1041
*     I001C CHAR(1) BASED;                                         1041
*   DECLARE                                                        1042
*     IOPTLIST(6) PTR(31) BDY(WORD);/* OPTION LIST ARRAY             */
*   GENERATE NODEFS NOREFS DATA;                                   1043
*   END                             /* BLRPEND                       */
*                                                                  1044
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (BLSUZZZ )                                       */
*/*%INCLUDE SYSLIB  (BLRFULL )                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IKJPSCB )                                       */
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */
*/*%INCLUDE SYSLIB  (BLSUSERV)                                       */
*/*%INCLUDE SYSLIB  (BLRSERV )                                       */
*/*%INCLUDE SYSLIB  (BLRSERVD)                                       */
*/*%INCLUDE SYSLIB  (BLSDSERV)                                       */
*/*%INCLUDE SYSLIB  (BLSEAP  )                                       */
*/*%INCLUDE SYSLIB  (BLSPDR  )                                       */
*/*%INCLUDE SYSLIB  (BLSFP   )                                       */
*/*%INCLUDE SYSLIB  (BLSESTAT)                                       */
*                                                                  1044
*       ;                                                          1044
@EL00001 L     @13,4(,@13)                                         1044
@EF00001 L     @00,@SIZDATD                                        1044
         LR    @01,@11                                             1044
         BLSUFRER R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     1044
         BR    @14                                                 1044
@DATA    DS    0H
@CH00068 DC    H'2'
@CH00094 DC    H'3'
@CH00091 DC    H'5'
@SM01630 MVC   PDRODATE(0,BUFPTR),DTEI(@04)
@SM01632 MVC   PDROTIME(0,BUFPTR),TMEI(@04)
@SM01634 MVC   PDRGROUP(0,BUFPTR),GRPI(@04)
@SM01636 MVC   PDRSYS(0,BUFPTR),SIDI(@04)
@SM01638 MVC   PDRUSER(0,BUFPTR),UFLI(@04)
@SM01640 MVC   PDRCOMP(0,BUFPTR),CIDI(@04)
@SM01642 MVC   PDROWNID(0,BUFPTR),OWNI(@01)
@SM01644 MVC   PDRAPRID(0,BUFPTR),APRI(@04)
@SM01646 MVC   PDRPTFID(0,BUFPTR),PTFI(@04)
@SM01648 MVC   PDRFIXID(0,BUFPTR),FIXQ(@04)
@SM01650 MVC   PDRABS(0,BUFPTR),ABSQ(@04)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    14F
@SA00003 DS    14F
@SA00005 DS    14F
@SA00004 DS    14F
@SA00006 DS    14F
@SA00007 DS    14F
@SA00010 DS    15F
@SA00008 DS    14F
@SA00011 DS    13F
@SA00013 DS    15F
@SA00012 DS    15F
@AL00001 DS    6A
@AFTEMPS DS    1F
BLSEADPR CSECT
         DS    0F
@CF00046 DC    F'0'
@CF00041 DC    F'1'
@CH00041 EQU   @CF00041+2
@CF00142 DC    F'13'
@CF01016 DC    F'14'
@CF00052 DC    F'16'
@CF01235 DC    F'72'
@CH01235 EQU   @CF01235+2
@CF01618 DC    F'416'
@CF01621 DC    F'952'
@CF00394 DC    F'1024'
@CF01576 DC    F'4041'
@CF01520 DC    F'4042'
@CF01548 DC    F'4043'
@CF01562 DC    F'4044'
@CF01542 DC    F'4045'
@CF01537 DC    F'4069'
@CF01610 DC    F'4070'
@CF01535 DC    F'5100'
@CF01556 DC    F'5101'
@CF01596 DC    F'10000'
@CF01555 DC    F'99999'
@CF01652 DC    F'-57'
@CF00061 DC    XL4'80000000'
@CF01517 DC    XL4'FFFFFFF8'
@CF01547 DC    XL4'7FFFFFFF'
@DATD    DSECT
         DS    0D
PDAPTR   DS    A
MSGPTR   DS    A
K        DS    A
L        DS    A
RNUM     DS    F
CURDATE  DS    CL8
CURTIME  DS    CL8
         DS    CL4
PACKED   DS    CL8
BUF1     DS    CL1024
BUF2     DS    CL1024
IOPTLIST DS    6A
BLSEADPR CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01347 DC    V(BLSDTIME)
@CV01348 DC    V(BLSEADP1)
         DS    0D
PCPTR    DC    AL4(PC)
@CC01278 DC    C'INITIAL '
@CC01525 DC    C'00000'
@CC01518 DC    C'DMCB'
@CC01526 EQU   @CC01525
@CC01252 DC    C'ST'
@CC01254 DC    C'DE'
@CC01262 DC    C'SV'
@CB01629 DC    X'00'
@CB01521 DC    B'10110000'
@CB01536 DC    B'00110000'
STATPROB DC    CL8'ACTIVE  '
         DC    CL8'CLAPAR  '
         DC    CL8'CLDUP   '
         DC    CL8'CLFIX   '
         DC    CL8'CLNTF   '
         DC    CL8'CLOTHER '
         DC    CL8'CLPTF   '
         DC    CL8'INACTIVE'
         DC    CL8'INITIAL '
STATIBM  DC    CL8'        '
         DC    CL8'ABY     '
         DC    CL8'ACK     '
         DC    CL8'APARED  '
         DC    CL8'CAN     '
         DC    CL8'DOC     '
         DC    CL8'DUA     '
         DC    CL8'DUB     '
         DC    CL8'DUU     '
         DC    CL8'MCH     '
         DC    CL8'PER     '
         DC    CL8'PRS     '
         DC    CL8'PSRR    '
         DC    CL8'REPORTED'
         DC    CL8'RET     '
         DC    CL8'ROP     '
         DC    CL8'SUG     '
         DC    CL8'UR1     '
         DC    CL8'UR2     '
         DC    CL8'UR3     '
         DC    CL8'UR4     '
         DC    CL8'UR5     '
         DC    CL8'USE     '
STATPTF  DC    CL4'    '
         DC    CL4'ACPT'
         DC    CL4'INST'
         DC    CL4'RCVD'
         DC    CL4'REJD'
         DC    CL4'RQST'
STATFIX  DC    CL4'    '
         DC    CL4'ACPT'
         DC    CL4'INST'
         DC    CL4'RCVD'
         DC    CL4'REJD'
         DC    CL4'RQST'
@DATD    DSECT
         SPACE 2
***********************************************************************
* THE FOLLOWING AREA, BLRPATCH, IS RESERVED FOR PATCH APPLICATION     *
* TO OBTAIN PATCH ROOM IN THE @DATD AUTOMATIC STORAGE AREA, MODIFY    *
* CONSTANT @SIZDATD TO REFLECT THE DESIRED @DATD SIZE                 *
***********************************************************************
         SPACE
BLSEADPR CSECT
         ORG
         DS    0D
BLRPATCH DC    CL8'ZAPAREA',(((*-BLSEADPR+19)/20+7)/8)CL8'BLSEADPR'
@DATD    DSECT
         SPACE 2
***********************************************************************
* IKJPARM--BEGIN MACROS SPECIFYING COMMAND SYNTAX                     *
***********************************************************************
         SPACE
BLSEADPR CSECT
PC       IKJPARM DSECT=PD
@DATD    DSECT
BLSEADPR CSECT
DATEWD   IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'DATE',SUBFLD=DATESUB
@DATD    DSECT
BLSEADPR CSECT
TIMEWD   IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'TIME',SUBFLD=TIMESUB
@DATD    DSECT
BLSEADPR CSECT
GROUPWD  IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'GROUP',SUBFLD=GRPSUB
@DATD    DSECT
BLSEADPR CSECT
SYSTEMWD IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'SYSTEM',SUBFLD=SIDSUB
@DATD    DSECT
BLSEADPR CSECT
USERWD   IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'USER',SUBFLD=USESUB
@DATD    DSECT
BLSEADPR CSECT
COMPIDWD IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'COMPID',SUBFLD=CIDSUB
@DATD    DSECT
BLSEADPR CSECT
OWNERWD  IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'OWNER',SUBFLD=OWNSUB
@DATD    DSECT
BLSEADPR CSECT
SEVWD    IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'SEVERITY',SUBFLD=SEVSUB
@DATD    DSECT
BLSEADPR CSECT
PSTATWD  IKJKEYWD DEFAULT='PSTATUS'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'PSTATUS',SUBFLD=PSTATSUB
@DATD    DSECT
BLSEADPR CSECT
IBMSTWD  IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'IBMSTATUS',SUBFLD=IBMSTSUB
@DATD    DSECT
BLSEADPR CSECT
PTFSTWD  IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'PTFSTATUS',SUBFLD=PTFSTSUB
@DATD    DSECT
BLSEADPR CSECT
FIXSTWD  IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'FIXSTATUS',SUBFLD=FIXSTSUB
@DATD    DSECT
BLSEADPR CSECT
APARWD   IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'APARID',SUBFLD=APARSUB
@DATD    DSECT
BLSEADPR CSECT
PTFIDWD  IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'PTFID',SUBFLD=PTFSUB
@DATD    DSECT
BLSEADPR CSECT
FIXWD    IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'FIXID',SUBFLD=FIXSUB
@DATD    DSECT
BLSEADPR CSECT
ABSWD    IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'ABSTRACT',SUBFLD=ABSSUB
@DATD    DSECT
BLSEADPR CSECT
DESCWD   IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'DESCRIPTION',SUBFLD=DESCSUB
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'DSDESCRIPTION',SUBFLD=DSDSUB
@DATD    DSECT
BLSEADPR CSECT
DEFLTWD  IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'DEFAULT'
@DATD    DSECT
BLSEADPR CSECT
PXTEST   IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'TEST'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'NOTEST'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
DATESUB  IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
DTE      IKJIDENT 'DATE',UPPERCASE,FIRST=NUMERIC,MAXLNTH=8,OTHER=ANY,  *
               PROMPT='DATE OCCURRED - MM/DD/YY',VALIDCK=BLSDDT00
@DATD    DSECT
BLSEADPR CSECT
         SPACE
TIMESUB  IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
TME      IKJIDENT 'TIME',UPPERCASE,FIRST=NUMERIC,MAXLNTH=8,OTHER=ANY,  *
               PROMPT='TIME OCCURRED - HH:MM:SS',VALIDCK=BLSDTM00
@DATD    DSECT
BLSEADPR CSECT
         SPACE
GRPSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
GRP      IKJIDENT 'GROUP',UPPERCASE,FIRST=ALPHANUM,MAXLNTH=8,OTHER=ALPH*
               ANUM,PROMPT='GROUP ASSIGNED TO THIS PROBLEM'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
SIDSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
SID      IKJIDENT 'SYSTEM ID',UPPERCASE,FIRST=ALPHANUM,MAXLNTH=8,OTHER=*
               ALPHANUM,PROMPT='SYSTEM ID'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
USESUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
UFL      IKJIDENT 'USER FIELD',UPPERCASE,FIRST=ALPHANUM,MAXLNTH=8,     *
               OTHER=ALPHANUM,PROMPT='USER FIELD'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
CIDSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
CID      IKJIDENT 'COMPONENT ID',UPPERCASE,FIRST=ANY,MAXLNTH=10,OTHER=A*
               NY,PROMPT='SUSPECTED FAILING COMPONENT ID'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
OWNSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
OWN      IKJIDENT 'OWNER',UPPERCASE,FIRST=ALPHA,MAXLNTH=7,OTHER=ALPHANU*
               M,PROMPT='OWNER OF THE PROBLEM'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
SEVSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
SEV      IKJIDENT 'SEVERITY',UPPERCASE,FIRST=NUMERIC,MAXLNTH=1,PROMPT='*
               SEVERITY ASSOCIATED WITH THIS PROBLEM',VALIDCK=BLSDSV00
@DATD    DSECT
BLSEADPR CSECT
         SPACE
PSTATSUB IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
PSTTYPE  IKJKEYWD DEFAULT='INITIAL'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'ACTIVE'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'CLAPAR'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'CLDUP'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'CLFIX'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'CLNTF'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'CLOTHER'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'CLPTF'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'INACTIVE'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'INITIAL'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
IBMSTSUB IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
IBMFLDWD IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'NONE'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'ABY'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'ACK'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'APARED'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'CAN'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'DOC'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'DUA'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'DUB'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'DUU'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'MCH'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'PER'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'PRS'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'PSRR'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'REPORTED'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'RET'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'ROP'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'SUG'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'UR1'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'UR2'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'UR3'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'UR4'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'UR5'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'USE'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
PTFSTSUB IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
PTFFLDWD IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'NONE'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'ACPT'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'INST'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'RCVD'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'REJD'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'RQST'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
FIXSTSUB IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
FIXFLDWD IKJKEYWD
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'NONE'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'ACPT'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'INST'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'RCVD'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'REJD'
@DATD    DSECT
BLSEADPR CSECT
         IKJNAME 'RQST'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
APARSUB  IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
APR      IKJIDENT 'APAR',UPPERCASE,FIRST=ALPHA,MAXLNTH=7,OTHER=NONATNUM*
               ,PROMPT='APAR IDENTIFIER ASSIGNED TO THIS PROBLEM',     *
               VALIDCK=BLSDC070
@DATD    DSECT
BLSEADPR CSECT
         SPACE
PTFSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
PTF      IKJIDENT 'PTF',UPPERCASE,FIRST=ALPHA,MAXLNTH=7,OTHER=NONATNUM,*
               PROMPT='PTF IDENTIFIER ASSIGNED TO THIS PROBLEM',       *
               VALIDCK=BLSDC070
@DATD    DSECT
BLSEADPR CSECT
         SPACE
FIXSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
FIX      IKJPOSIT QSTRING,UPPERCASE,PROMPT='FIX IDENTIFIER ASSIGNED TO *
               THIS PROBLEM',VALIDCK=BLSDC600
@DATD    DSECT
BLSEADPR CSECT
         SPACE
ABSSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
ABS      IKJPOSIT QSTRING,UPPERCASE,HELP=('ABSTRACT OF PROBLEM ENTERED *
               AS QUOTED TEXT'),PROMPT='ABSTRACT - 128 CHARACTERS MAXIM*
               UM',VALIDCK=BLSDC128
@DATD    DSECT
BLSEADPR CSECT
         SPACE
DESCSUB  IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
DSC      IKJPOSIT QSTRING,UPPERCASE,HELP=('DESCRIPTION OF PROBLEM ENTER*
               ED AS QUOTED TEXT'),PROMPT='DESCRIPTION OF PROBLEM'
@DATD    DSECT
BLSEADPR CSECT
         SPACE
DSDSUB   IKJSUBF
@DATD    DSECT
BLSEADPR CSECT
DDS      IKJPOSIT DSNAME,USID,UPPERCASE,PROMPT='DATA SET NAME CONTAININ*
               G DESCRIPTION'
@DATD    DSECT
PD       DSECT
LISTEND  DS    0C
BLSEADPR CSECT
         IKJENDP
         SPACE 2
***********************************************************************
* IKJENDP--END SYNTAX DESCRIPTION                                     *
***********************************************************************
         SPACE
@DATD    DSECT
         SPACE 2
***********************************************************************
* ALIGN END OF DATA ON A DOUBLEWORD BOUNDARY                          *
***********************************************************************
         SPACE
         DS    0D
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSEADPR CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
J        EQU   @03
I        EQU   @02
DESBUFP  EQU   @09
PNUM     EQU   @02
RETC     EQU   @07
BUFPTR   EQU   @08
ZZ2PTR   EQU   @06
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R9       EQU   @09
RB       EQU   @11
RD       EQU   @13
RE       EQU   @14
RF       EQU   @15
PDRPTR   EQU   @05
GPR15F   EQU   @15
GPR01F   EQU   @01
GPR00F   EQU   @00
GPR01P   EQU   @01
GPR4P    EQU   @04
GPR5F    EQU   @05
GPR6P    EQU   @06
GPR7F    EQU   @07
RA       EQU   @10
RC       EQU   @12
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
ZZ1      EQU   0
ZZ1ZZ2P  EQU   ZZ1+36
ZZ1PDRP  EQU   ZZ1+40
ZZ1FPP   EQU   ZZ1+140
ZZ1ATTN  EQU   ZZ1+360
ZZ1EVE   EQU   ZZ1ATTN+4
ZZ1F     EQU   ZZ1+368
ZZ1N     EQU   ZZ1+1116
ZZ2      EQU   0
ZZ2AMD   EQU   ZZ2
@NM00013 EQU   ZZ2AMD+7
ZZ2PRT   EQU   ZZ2+138
ZZ2PRTT  EQU   ZZ2PRT+4
ZZ2PRTT1 EQU   ZZ2PRTT+1
ZZ2A     EQU   ZZ2+272
ZZ2AF    EQU   ZZ2A+16
ZZ2AFX   EQU   ZZ2AF+5
ZZ2APID  EQU   ZZ2A+64
ZZ2AD    EQU   ZZ2A+74
ZZ2ADD   EQU   ZZ2AD
ZZ2ADDT  EQU   ZZ2ADD+2
ZZ2ADM   EQU   ZZ2AD+46
ZZ2ADMT  EQU   ZZ2ADM+2
ZZ2ADP   EQU   ZZ2AD+56
ZZ2ADPT  EQU   ZZ2ADP+2
ZZ2AQAS  EQU   ZZ2A+144
ZZ2AQD   EQU   ZZ2A+160
ZZ2AQDT  EQU   ZZ2AQD+10
ZZ2AQDF  EQU   ZZ2AQD+52
ZZ2STG   EQU   ZZ2+960
ZZ2ALLOP EQU   ZZ2+992
ZZ2FREEP EQU   ZZ2+996
ZZ2FF19P EQU   ZZ2+1000
ZZ2FRE1P EQU   ZZ2+1004
ZZ2FF18P EQU   ZZ2+1008
ZZ2DYNAP EQU   ZZ2+1012
ZZ2ZZ2CP EQU   ZZ2+1016
ZZ2ZZ2DP EQU   ZZ2+1020
ZZ2STAIP EQU   ZZ2+1024
ZZ2FF02P EQU   ZZ2+1028
ZZ2GETLP EQU   ZZ2+1032
ZZ2PARSP EQU   ZZ2+1036
ZZ2PTGTP EQU   ZZ2+1040
ZZ2PUTLP EQU   ZZ2+1044
ZZ2SCANP EQU   ZZ2+1048
ZZ2STCKP EQU   ZZ2+1052
ZZ2ALOCP EQU   ZZ2+1056
ZZ2MSGSP EQU   ZZ2+1060
ZZ2TRMOP EQU   ZZ2+1064
ZZ2TRMVP EQU   ZZ2+1068
ZZ2MSG0P EQU   ZZ2+1076
ZZ2PUTNP EQU   ZZ2+1084
ZZ2TRMNP EQU   ZZ2+1088
ZZ2ENQ0P EQU   ZZ2+1092
ZZ2ADSDP EQU   ZZ2+1096
ZZ2APDRP EQU   ZZ2+1100
ZZ2FDSDP EQU   ZZ2+1104
ZZ2FPDRP EQU   ZZ2+1108
ZZ2ZZ1P  EQU   ZZ2+1264
ZZ2DVTP  EQU   ZZ2+1276
ZZ2BVTP  EQU   ZZ2+1280
ZZ2CPPL  EQU   ZZ2+1292
ZZ2CPPLC EQU   ZZ2CPPL
ZZ2ITR   EQU   ZZ2+2840
ZZ2ITRE  EQU   ZZ2ITR+16
ZZ2ITSE  EQU   ZZ2+2864
ZZ2ES    EQU   ZZ2+2872
ZZ2AMDX  EQU   ZZ2+7160
ZZ2AXO   EQU   ZZ2+7934
ZZ2AXOT  EQU   ZZ2AXO+2
CMD      EQU   0
CMDT     EQU   CMD+4
PSCB     EQU   0
PSCBUSER EQU   PSCB
PSCBUSRL EQU   PSCB+7
PSCBATR1 EQU   PSCB+16
ECT      EQU   0
ECTSWS   EQU   ECT+28
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
UPT      EQU   0
UPTSWS   EQU   UPT+12
SA       EQU   0
SA1      EQU   SA
SAR      EQU   SA+12
BLSUPARI EQU   0
BVT      EQU   0
BVTPUTLP EQU   BVT+4
BVTPUTOP EQU   BVT+12
BVTPUTTP EQU   BVT+16
BVTPUTVP EQU   BVT+20
BVTPUTAP EQU   BVT+24
BVTPRTTP EQU   BVT+28
BVTPRTAP EQU   BVT+32
BVTPUTDP EQU   BVT+36
BVTMONP  EQU   BVT+40
BVTMON2P EQU   BVT+44
BVTVSARP EQU   BVT+48
BVTVSENP EQU   BVT+64
BVTVSERP EQU   BVT+68
BVTVSGEP EQU   BVT+72
BVTVSGUP EQU   BVT+76
BVTVSPOP EQU   BVT+80
BVTVSPUP EQU   BVT+84
BVTMPKNP EQU   BVT+104
BVTMONLP EQU   BVT+108
BVTPUTCP EQU   BVT+132
BVTMPK1P EQU   BVT+136
BVTZZ2RP EQU   BVT+140
BVTPGMRP EQU   BVT+144
BVTMONAP EQU   BVT+148
BVTBLDDP EQU   BVT+152
BVTBLDLP EQU   BVT+156
BVTPGMCP EQU   BVT+160
BVTPGMDP EQU   BVT+164
BVTPGMLP EQU   BVT+168
BVTMONCP EQU   BVT+180
BVTMONDP EQU   BVT+184
BVTMONTP EQU   BVT+188
BVTPARIP EQU   BVT+192
BVTPARUP EQU   BVT+196
BVTPRTNP EQU   BVT+204
BVTVSCRP EQU   BVT+208
BVTVSMRP EQU   BVT+212
BVTMONXP EQU   BVT+216
BVTTRMAP EQU   BVT+228
BLSDMSGS EQU   0
BLSDMSG0 EQU   0
DVT      EQU   0
DVTDEQPP EQU   DVT+8
DVTENQPP EQU   DVT+12
DVTAUTHP EQU   DVT+20
DVTLPCLP EQU   DVT+24
DVTBP00P EQU   DVT+28
DVTCN00P EQU   DVT+32
DVTDF00P EQU   DVT+36
DVTDS00P EQU   DVT+44
DVTFL00P EQU   DVT+48
DVTFP00P EQU   DVT+52
DVTGD00P EQU   DVT+56
DVTGG00P EQU   DVT+60
DVTGP00P EQU   DVT+64
DVTND00P EQU   DVT+68
DVTND01P EQU   DVT+72
DVTOD00P EQU   DVT+76
DVTPS00P EQU   DVT+80
DVTSD00P EQU   DVT+84
DVTSL00P EQU   DVT+88
DVTTL00P EQU   DVT+92
DVTUD00P EQU   DVT+96
DVTUP00P EQU   DVT+100
DVTLP00P EQU   DVT+104
DVTLALLP EQU   DVT+108
DVTLPFMP EQU   DVT+112
DVTCLOSP EQU   DVT+116
DVTOPENP EQU   DVT+120
DVTPERAP EQU   DVT+124
DVTDALLP EQU   DVT+128
PCCSECT  EQU   0
PDDSECT  EQU   0
PDXP     EQU   PDDSECT+1
PDL      EQU   PDDSECT+5
DTEI     EQU   0
TMEI     EQU   0
GRPI     EQU   0
SIDI     EQU   0
UFLI     EQU   0
CIDI     EQU   0
OWNI     EQU   0
SEVI     EQU   0
APRI     EQU   0
PTFI     EQU   0
FIXQ     EQU   0
ABSQ     EQU   0
DSCQ     EQU   0
PDREC    EQU   0
PDRKEY   EQU   PDREC
PDRGRP   EQU   PDRKEY
PDRKRCTY EQU   PDRGRP
PDRKPID  EQU   PDRGRP+2
PDRKPREF EQU   PDRKPID
PDRKPNUM EQU   PDRKPID+3
PDRRECSQ EQU   PDRKEY+10
PDRINFO  EQU   PDREC+16
FPBLOK   EQU   0
FPPIDP   EQU   FPBLOK+96
FPDBPIDP EQU   FPBLOK+100
FPSYSID  EQU   FPBLOK+104
FPGRPID  EQU   FPBLOK+112
FPADMNM  EQU   FPBLOK+120
FPDELNM  EQU   FPBLOK+128
MYBUF    EQU   0
DMCB     EQU   0
DMCBID   EQU   DMCB
DMCBFTY  EQU   DMCB+20
DMCBOPN  EQU   DMCB+21
DMCBRQST EQU   DMCB+22
DMCBRMOD EQU   DMCB+23
DMCBOUT  EQU   DMCBRMOD
DMCBTMP  EQU   DMCBOUT
DMCBRM6  EQU   DMCBRMOD
DMCBRM5  EQU   DMCBRMOD
DMCBOPTS EQU   DMCB+24
DMCBKYD  EQU   DMCBOPTS
DMCBGKY  EQU   DMCBOPTS
DMCBAPX  EQU   DMCBOPTS
DMCBUPD  EQU   DMCBOPTS
DMCBMFLG EQU   DMCB+28
DMCBBUFP EQU   DMCB+32
DMCBBLEN EQU   DMCB+36
DMCBORL  EQU   DMCB+40
DMCBKEYP EQU   DMCB+44
DMCBKEYL EQU   DMCB+48
DMCBMSG  EQU   DMCB+52
DMCBRI   EQU   DMCB+64
DMCBACBE EQU   DMCB+124
DMCBSPEC EQU   DMCB+380
DMCBAMS  EQU   DMCB+416
DMCBAUDT EQU   DMCB+568
DMCBLSCP EQU   DMCBAUDT+16
DMCBDMGR EQU   0
I015F    EQU   0
BLSCALOC EQU   0
BLSDADSD EQU   0
BLSDAPDR EQU   0
BLSDDEQP EQU   0
BLSDENQP EQU   0
BLSDENQ0 EQU   0
BLSDFDSD EQU   0
BLSDFPDR EQU   0
BLSEAUTH EQU   0
BLSELPCL EQU   0
BLSELPFM EQU   0
BLSFBP00 EQU   0
BLSFCLOS EQU   0
BLSFCN00 EQU   0
BLSFDALL EQU   0
BLSFDF00 EQU   0
BLSFDS00 EQU   0
BLSFFL00 EQU   0
BLSFFP00 EQU   0
BLSFGD00 EQU   0
BLSFGG00 EQU   0
BLSFGP00 EQU   0
BLSFLALL EQU   0
BLSFLP00 EQU   0
BLSFND00 EQU   0
BLSFND01 EQU   0
BLSFOD00 EQU   0
BLSFOPEN EQU   0
BLSFPERA EQU   0
BLSFPS00 EQU   0
BLSFSD00 EQU   0
BLSFSL00 EQU   0
BLSFTL00 EQU   0
BLSFUD00 EQU   0
BLSFUP00 EQU   0
BLSUALLO EQU   0
BLSUBLDD EQU   0
BLSUBLDL EQU   0
BLSUDYNA EQU   0
BLSUFREE EQU   0
BLSUFRE1 EQU   0
BLSUMON  EQU   0
BLSUMONA EQU   0
BLSUMONC EQU   0
BLSUMOND EQU   0
BLSUMONL EQU   0
BLSUMONT EQU   0
BLSUMONX EQU   0
BLSUMON2 EQU   0
BLSUMPKN EQU   0
BLSUMPK1 EQU   0
BLSUPARU EQU   0
BLSUPGMC EQU   0
BLSUPGMD EQU   0
BLSUPGML EQU   0
BLSUPGMR EQU   0
BLSUPRTA EQU   0
BLSUPRTN EQU   0
BLSUPRTT EQU   0
BLSUPUTA EQU   0
BLSUPUTC EQU   0
BLSUPUTD EQU   0
BLSUPUTL EQU   0
BLSUPUTN EQU   0
BLSUPUTO EQU   0
BLSUPUTT EQU   0
BLSUPUTV EQU   0
BLSUSTAI EQU   0
BLSUTRMA EQU   0
BLSUTRMN EQU   0
BLSUTRMO EQU   0
BLSUTRMV EQU   0
BLSUVSAR EQU   0
BLSUVSCR EQU   0
BLSUVSEN EQU   0
BLSUVSER EQU   0
BLSUVSGE EQU   0
BLSUVSGU EQU   0
BLSUVSMR EQU   0
BLSUVSPO EQU   0
BLSUVSPU EQU   0
BLSUZZ2C EQU   0
BLSUZZ2D EQU   0
BLSUZZ2R EQU   0
DDSD     EQU   0
DDSM     EQU   0
DDSP     EQU   0
DMCBRQC  EQU   0
IKJEFF02 EQU   0
IKJEFF18 EQU   0
IKJEFF19 EQU   0
IKJGETL  EQU   0
IKJPARS  EQU   0
IKJPTGT  EQU   0
IKJPUTL  EQU   0
IKJSCAN  EQU   0
IKJSTCK  EQU   0
I001C    EQU   0
I008P    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
DTEIP    EQU   DTE
DTEIL    EQU   DTE+4
DTEIF    EQU   DTE+6
DTEIFP   EQU   DTEIF
TMEIP    EQU   TME
TMEIL    EQU   TME+4
TMEIF    EQU   TME+6
TMEIFP   EQU   TMEIF
GRPIP    EQU   GRP
GRPIL    EQU   GRP+4
GRPIF    EQU   GRP+6
GRPIFP   EQU   GRPIF
SIDIP    EQU   SID
SIDIL    EQU   SID+4
SIDIF    EQU   SID+6
SIDIFP   EQU   SIDIF
UFLIP    EQU   UFL
UFLIL    EQU   UFL+4
UFLIF    EQU   UFL+6
UFLIFP   EQU   UFLIF
CIDIP    EQU   CID
CIDIL    EQU   CID+4
CIDIF    EQU   CID+6
CIDIFP   EQU   CIDIF
OWNIP    EQU   OWN
OWNIL    EQU   OWN+4
OWNIF    EQU   OWN+6
OWNIFP   EQU   OWNIF
SEVIP    EQU   SEV
SEVIF    EQU   SEV+6
SEVIFP   EQU   SEVIF
APRIP    EQU   APR
APRIL    EQU   APR+4
APRIF    EQU   APR+6
APRIFP   EQU   APRIF
PTFIP    EQU   PTF
PTFIL    EQU   PTF+4
PTFIF    EQU   PTF+6
PTFIFP   EQU   PTFIF
FIXQP    EQU   FIX
FIXQL    EQU   FIX+4
FIXQF    EQU   FIX+6
FIXQFP   EQU   FIXQF
ABSQP    EQU   ABS
ABSQL    EQU   ABS+4
ABSQF    EQU   ABS+6
ABSQFP   EQU   ABSQF
DSCQP    EQU   DSC
DSCQL    EQU   DSC+4
DSCQF    EQU   DSC+6
DSCQFP   EQU   DSCQF
DDSDP    EQU   DDS
DDSDF    EQU   DDS+6
DDSDFP   EQU   DDSDF
DDSMP    EQU   DDS+8
DDSMF    EQU   DDS+14
DDSPP    EQU   DDS+16
DDSPF    EQU   DDS+22
CPPL     EQU   ZZ2CPPL
CPPLUPT  EQU   CPPL+4
CPPLPSCB EQU   CPPL+8
CPPLECT  EQU   CPPL+12
PDRSTREC EQU   PDRINFO
PDRODATE EQU   PDRSTREC
PDROTIME EQU   PDRSTREC+8
PDRCOMP  EQU   PDRSTREC+16
PDRSEV   EQU   PDRSTREC+26
PDROWNNM EQU   PDRSTREC+32
PDROWNID EQU   PDROWNNM
PDROWNLN EQU   PDROWNNM+7
PDRGROUP EQU   PDRSTREC+40
PDRSYS   EQU   PDRSTREC+48
PDRUSER  EQU   PDRSTREC+56
PDRPSTAT EQU   PDRSTREC+64
PDRPDATE EQU   PDRSTREC+72
PDRPTIME EQU   PDRSTREC+80
PDRRDATE EQU   PDRSTREC+88
PDRRTIME EQU   PDRSTREC+96
PDRISTAT EQU   PDRSTREC+104
PDRIDATE EQU   PDRSTREC+112
PDRITIME EQU   PDRSTREC+120
PDRAPRID EQU   PDRSTREC+128
PDRTSTAT EQU   PDRSTREC+140
PDRTDATE EQU   PDRSTREC+144
PDRTTIME EQU   PDRSTREC+152
PDRPTFID EQU   PDRSTREC+160
PDRFSTAT EQU   PDRSTREC+172
PDRFDATE EQU   PDRSTREC+176
PDRFTIME EQU   PDRSTREC+184
PDRFIXID EQU   PDRSTREC+192
PDRABS   EQU   PDRSTREC+256
PDRDESCL EQU   PDRSTREC+384
PDRDSSEQ EQU   PDRSTREC+396
PDRDEREC EQU   PDRINFO
PDRDESCR EQU   PDRDEREC
PDRDESC  EQU   PDRDESCR
PDRTRREC EQU   PDRINFO
PDRTRARR EQU   PDRTRREC
PDRHSREC EQU   PDRINFO
PDRDSREC EQU   PDRINFO
PDRDSNM  EQU   PDRDSREC
PDRSVALU EQU   PDRODATE
PDRSVNUM EQU   PDRSVALU+3
DMCBVSM  EQU   DMCBAMS
DMCBQSM  EQU   DMCBAMS
*                                      START UNREFERENCED COMPONENTS
DMCBRES7 EQU   DMCBQSM+96
DMCBDCB  EQU   DMCBQSM
DMCBACB  EQU   DMCBVSM+76
DMCBRPL  EQU   DMCBVSM
PDRSVRES EQU   PDRSVALU
PDRDSRES EQU   PDRDSREC+52
PDRMEMB  EQU   PDRDSNM+44
PDRDSN   EQU   PDRDSNM
PDRHYMSD EQU   PDRHSREC+4
PDRHSLEN EQU   PDRHSREC
PDRTRKD  EQU   PDRTRARR
PDRRES6  EQU   PDRSTREC+392
PDRTRKL  EQU   PDRSTREC+388
PDRRES5  EQU   PDRSTREC+252
PDRRES4  EQU   PDRSTREC+167
PDRRES3  EQU   PDRSTREC+135
PDRRES1  EQU   PDRSTREC+27
CPPLCBUF EQU   CPPL
@NM00100 EQU   DDS+24
@NM00099 EQU   DDS+23
DDSPF8   EQU   DDSPF
DDSPF7   EQU   DDSPF
DDSPF6   EQU   DDSPF
DDSPF5   EQU   DDSPF
DDSPF4   EQU   DDSPF
DDSPF3   EQU   DDSPF
DDSPF2   EQU   DDSPF
DDSPFP   EQU   DDSPF
DDSPL    EQU   DDS+20
@NM00098 EQU   DDS+15
DDSMF8   EQU   DDSMF
DDSMF7   EQU   DDSMF
DDSMF6   EQU   DDSMF
DDSMF5   EQU   DDSMF
DDSMF4   EQU   DDSMF
DDSMF3   EQU   DDSMF
DDSMF2   EQU   DDSMF
DDSMFP   EQU   DDSMF
DDSML    EQU   DDS+12
@NM00097 EQU   DDS+7
@NM00096 EQU   DDSDF
DDSDFQ   EQU   DDSDF
DDSDL    EQU   DDS+4
@NM00095 EQU   DSC+8
@NM00094 EQU   DSC+7
DSCQF8   EQU   DSCQF
DSCQF7   EQU   DSCQF
DSCQF6   EQU   DSCQF
DSCQF5   EQU   DSCQF
DSCQF4   EQU   DSCQF
DSCQF3   EQU   DSCQF
DSCQF2   EQU   DSCQF
@NM00093 EQU   ABS+8
@NM00092 EQU   ABS+7
ABSQF8   EQU   ABSQF
ABSQF7   EQU   ABSQF
ABSQF6   EQU   ABSQF
ABSQF5   EQU   ABSQF
ABSQF4   EQU   ABSQF
ABSQF3   EQU   ABSQF
ABSQF2   EQU   ABSQF
@NM00091 EQU   FIX+8
@NM00090 EQU   FIX+7
FIXQF8   EQU   FIXQF
FIXQF7   EQU   FIXQF
FIXQF6   EQU   FIXQF
FIXQF5   EQU   FIXQF
FIXQF4   EQU   FIXQF
FIXQF3   EQU   FIXQF
FIXQF2   EQU   FIXQF
@NM00089 EQU   PTF+8
@NM00088 EQU   PTF+7
PTFIF8   EQU   PTFIF
PTFIF7   EQU   PTFIF
PTFIF6   EQU   PTFIF
PTFIF5   EQU   PTFIF
PTFIF4   EQU   PTFIF
PTFIF3   EQU   PTFIF
PTFIF2   EQU   PTFIF
@NM00087 EQU   APR+8
@NM00086 EQU   APR+7
APRIF8   EQU   APRIF
APRIF7   EQU   APRIF
APRIF6   EQU   APRIF
APRIF5   EQU   APRIF
APRIF4   EQU   APRIF
APRIF3   EQU   APRIF
APRIF2   EQU   APRIF
@NM00085 EQU   SEV+8
@NM00084 EQU   SEV+7
SEVIF8   EQU   SEVIF
SEVIF7   EQU   SEVIF
SEVIF6   EQU   SEVIF
SEVIF5   EQU   SEVIF
SEVIF4   EQU   SEVIF
SEVIF3   EQU   SEVIF
SEVIF2   EQU   SEVIF
SEVIL    EQU   SEV+4
@NM00083 EQU   OWN+8
@NM00082 EQU   OWN+7
OWNIF8   EQU   OWNIF
OWNIF7   EQU   OWNIF
OWNIF6   EQU   OWNIF
OWNIF5   EQU   OWNIF
OWNIF4   EQU   OWNIF
OWNIF3   EQU   OWNIF
OWNIF2   EQU   OWNIF
@NM00081 EQU   CID+8
@NM00080 EQU   CID+7
CIDIF8   EQU   CIDIF
CIDIF7   EQU   CIDIF
CIDIF6   EQU   CIDIF
CIDIF5   EQU   CIDIF
CIDIF4   EQU   CIDIF
CIDIF3   EQU   CIDIF
CIDIF2   EQU   CIDIF
@NM00079 EQU   UFL+8
@NM00078 EQU   UFL+7
UFLIF8   EQU   UFLIF
UFLIF7   EQU   UFLIF
UFLIF6   EQU   UFLIF
UFLIF5   EQU   UFLIF
UFLIF4   EQU   UFLIF
UFLIF3   EQU   UFLIF
UFLIF2   EQU   UFLIF
@NM00077 EQU   SID+8
@NM00076 EQU   SID+7
SIDIF8   EQU   SIDIF
SIDIF7   EQU   SIDIF
SIDIF6   EQU   SIDIF
SIDIF5   EQU   SIDIF
SIDIF4   EQU   SIDIF
SIDIF3   EQU   SIDIF
SIDIF2   EQU   SIDIF
@NM00075 EQU   GRP+8
@NM00074 EQU   GRP+7
GRPIF8   EQU   GRPIF
GRPIF7   EQU   GRPIF
GRPIF6   EQU   GRPIF
GRPIF5   EQU   GRPIF
GRPIF4   EQU   GRPIF
GRPIF3   EQU   GRPIF
GRPIF2   EQU   GRPIF
@NM00073 EQU   TME+8
@NM00072 EQU   TME+7
TMEIF8   EQU   TMEIF
TMEIF7   EQU   TMEIF
TMEIF6   EQU   TMEIF
TMEIF5   EQU   TMEIF
TMEIF4   EQU   TMEIF
TMEIF3   EQU   TMEIF
TMEIF2   EQU   TMEIF
@NM00071 EQU   DTE+8
@NM00070 EQU   DTE+7
DTEIF8   EQU   DTEIF
DTEIF7   EQU   DTEIF
DTEIF6   EQU   DTEIF
DTEIF5   EQU   DTEIF
DTEIF4   EQU   DTEIF
DTEIF3   EQU   DTEIF
DTEIF2   EQU   DTEIF
DMCBWRK  EQU   DMCB+648
DMCBRES8 EQU   DMCB+640
DMCBMODN EQU   DMCB+632
DMCBCARY EQU   DMCBAUDT+20
DMCBCLC  EQU   DMCBAUDT+12
DMCBOPC  EQU   DMCBAUDT+8
DMCBFRC  EQU   DMCBAUDT+4
DMCBALC  EQU   DMCBAUDT
DMCBFR   EQU   DMCB+412
DMCBRES6 EQU   DMCB+410
DMCBIRSC EQU   DMCB+408
DMCBSUBC EQU   DMCB+404
DMCBDRBP EQU   DMCB+400
DMCBRSZM EQU   DMCB+398
DMCBRSZA EQU   DMCB+396
DMCBCISZ EQU   DMCB+394
DMCBDCBL EQU   DMCB+392
DMCBDCLR EQU   DMCB+390
DMCBDCFM EQU   DMCB+389
DMCBRES5 EQU   DMCB+388
DMCBLBRT EQU   DMCB+386
DMCBLBSQ EQU   DMCB+384
DMCBLBPS EQU   DMCB+383
DMCBLBTY EQU   DMCB+382
DMCBRES4 EQU   DMCB+381
DMCBSPRS EQU   DMCBSPEC
DMCBSPRN EQU   DMCBSPEC
DMCBSPCT EQU   DMCBSPEC
DMCBSPRL EQU   DMCBSPEC
DMCBSPSE EQU   DMCB+376
DMCBSPPR EQU   DMCB+372
DMCBSPTY EQU   DMCB+369
DMCBODIS EQU   DMCB+368
DMCBDISP EQU   DMCB+367
DMCBSTAT EQU   DMCB+366
DMCBRES3 EQU   DMCB+364
DMCBMEMB EQU   DMCB+356
DMCBMODL EQU   DMCB+348
DMCBRES9 EQU   DMCB+340
DMCBPID  EQU   DMCB+332
DMCBTYPE EQU   DMCB+328
DMCBDSN  EQU   DMCB+284
DMCBUNIT EQU   DMCB+276
DMCBDSOR EQU   DMCB+274
DMCBVOL  EQU   DMCB+268
DMCBDDNM EQU   DMCB+260
DMCBSYNM EQU   DMCB+132
DMCBRPLF EQU   DMCB+128
DMCBDCBE EQU   DMCBACBE
DMCBARC  EQU   DMCB+120
DMCBCPC  EQU   DMCB+116
DMCBRET  EQU   DMCB+112
DMCBSTL  EQU   DMCB+96
DMCBEOB  EQU   DMCB+92
DMCBFRE  EQU   DMCB+88
DMCBRES2 EQU   DMCB+85
DMCBSPID EQU   DMCB+84
DMCBRESC EQU   DMCB+80
DMCBZZ1P EQU   DMCB+76
DMCBMSGS EQU   DMCB+72
DMCBMSG0 EQU   DMCB+68
DMCBRRL  EQU   DMCB+60
DMCBRBA  EQU   DMCB+56
DMCBKPC  EQU   DMCBKEYP
DMCBBFPC EQU   DMCBBUFP
DMCBRES1 EQU   DMCB+31
DMCBACCM EQU   DMCB+30
DMCBREJ  EQU   DMCB+29
DMCBRESB EQU   DMCBMFLG
DMCBFMOD EQU   DMCBMFLG
DMCBLOPT EQU   DMCB+27
DMCBLRM  EQU   DMCB+26
DMCBLRQ  EQU   DMCB+25
DMCBOPRS EQU   DMCBOPTS
DMCBLRD  EQU   DMCBOPTS
DMCBBWD  EQU   DMCBOPTS
DMCBRNO  EQU   DMCBGKY
DMCBRMRS EQU   DMCBRMOD
DMCBRESA EQU   DMCBOPN
DMCBSOUT EQU   DMCBOPN
DMCBSIN  EQU   DMCBOPN
DMCBVSF  EQU   DMCBFTY
DMCBKSF  EQU   DMCBFTY
DMCBFTRS EQU   DMCBFTY
DMCBSHF  EQU   DMCBFTY
DMCBIRL  EQU   DMCB+16
DMCBRTC  EQU   DMCB+12
DMCBTVP  EQU   DMCB+8
DMCBNEXT EQU   DMCB+4
FPRES6   EQU   FPBLOK+136
FPDELLN  EQU   FPDELNM+7
FPDELID  EQU   FPDELNM
FPADMLN  EQU   FPADMNM+7
FPADMID  EQU   FPADMNM
FPRES4   EQU   FPBLOK+103
FPRES3   EQU   FPBLOK+99
FPRES2   EQU   FPBLOK+92
FPDSDS   EQU   FPBLOK+48
FPRES1   EQU   FPBLOK+44
FPPDDS   EQU   FPBLOK
PDRRESV  EQU   PDREC+14
PDSP     EQU   PDDSECT+4
@NM00069 EQU   PDDSECT
DVT99999 EQU   DVT+256
DVT0064P EQU   DVT+252
DVT0063P EQU   DVT+248
DVT0062P EQU   DVT+244
DVT0061P EQU   DVT+240
DVT0060P EQU   DVT+236
DVT0059P EQU   DVT+232
DVT0058P EQU   DVT+228
DVT0057P EQU   DVT+224
DVT0056P EQU   DVT+220
DVT0055P EQU   DVT+216
DVT0054P EQU   DVT+212
DVT0053P EQU   DVT+208
DVT0052P EQU   DVT+204
DVT0051P EQU   DVT+200
DVT0050P EQU   DVT+196
DVT0049P EQU   DVT+192
DVT0048P EQU   DVT+188
DVT0047P EQU   DVT+184
DVT0046P EQU   DVT+180
DVT0045P EQU   DVT+176
DVT0044P EQU   DVT+172
DVT0043P EQU   DVT+168
DVT0042P EQU   DVT+164
DVT0041P EQU   DVT+160
DVT0040P EQU   DVT+156
DVT0039P EQU   DVT+152
DVT0038P EQU   DVT+148
DVT0037P EQU   DVT+144
DVT0036P EQU   DVT+140
DVT0035P EQU   DVT+136
DVT0034P EQU   DVT+132
DVT0011P EQU   DVT+40
DVT0005P EQU   DVT+16
DVT0002P EQU   DVT+4
DVT0001P EQU   DVT
BVT99999 EQU   BVT+256
BVT0064P EQU   BVT+252
BVT0063P EQU   BVT+248
BVT0062P EQU   BVT+244
BVT0061P EQU   BVT+240
BVT0060P EQU   BVT+236
BVT0059P EQU   BVT+232
BVT0057P EQU   BVT+224
BVT0056P EQU   BVT+220
BVTSTBLP EQU   BVT+200
BVT0045P EQU   BVT+176
BVT0044P EQU   BVT+172
BVT0033P EQU   BVT+128
BVT0032P EQU   BVT+124
BVT0031P EQU   BVT+120
BVT0030P EQU   BVT+116
BVT0029P EQU   BVT+112
BVT0026P EQU   BVT+100
BVT0025P EQU   BVT+96
BVT0024P EQU   BVT+92
BVT0023P EQU   BVT+88
BVT0016P EQU   BVT+60
BVT0015P EQU   BVT+56
BVT0014P EQU   BVT+52
BVT0003P EQU   BVT+8
BVT0001P EQU   BVT
SA99     EQU   SA+72
SARC     EQU   SAR+56
SARB     EQU   SAR+52
SARA     EQU   SAR+48
SAR9     EQU   SAR+44
SAR8     EQU   SAR+40
SAR7     EQU   SAR+36
SAR6     EQU   SAR+32
SAR5     EQU   SAR+28
SAR4     EQU   SAR+24
SAR3     EQU   SAR+20
SAR2     EQU   SAR+16
SAR1     EQU   SAR+12
SAR0     EQU   SAR+8
SARF     EQU   SAR+4
SARE     EQU   SAR
SAFWD    EQU   SA+8
SABAK    EQU   SA+4
SA1L     EQU   SA1+1
SA1P     EQU   SA1
UPTPREFL EQU   UPT+23
UPTPREFX EQU   UPT+16
@NM00068 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
UPTRCVR  EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00067 EQU   UPT
@NM00066 EQU   ECT+52
@NM00065 EQU   ECT+48
@NM00064 EQU   ECT+44
@NM00063 EQU   ECTSWS2+1
@NM00062 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00061 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTPCMD  EQU   ECT+12
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
ECTIOWA  EQU   ECT+4
ECTRTCD  EQU   ECT+1
ECTRCDF  EQU   ECT
PSCBU    EQU   PSCB+64
PSCBRSZ  EQU   PSCB+60
PSCBLINE EQU   PSCB+59
PSCBCHAR EQU   PSCB+58
PSCBUPTL EQU   PSCB+56
PSCBUPT  EQU   PSCB+52
PSCBRLGB EQU   PSCB+48
PSCBDEST EQU   PSCB+40
@NM00060 EQU   PSCB+36
@NM00059 EQU   PSCB+32
@NM00058 EQU   PSCB+28
PSCBLTI2 EQU   PSCB+24
PSCBLTIM EQU   PSCB+20
PSCBATR2 EQU   PSCB+18
@NM00057 EQU   PSCBATR1
@NM00056 EQU   PSCBATR1
@NM00055 EQU   PSCBATR1
PSCBATTN EQU   PSCBATR1
PSCBVMNT EQU   PSCBATR1
PSCBJCL  EQU   PSCBATR1
PSCBACCT EQU   PSCBATR1
PSCBCTRL EQU   PSCBATR1
PSCBGPNM EQU   PSCB+8
CMDT1    EQU   CMDT
CMDO     EQU   CMD+2
CMDL     EQU   CMD
ZZ299999 EQU   ZZ2+8192
ZZ2AXOT1 EQU   ZZ2AXOT
ZZ2AXOL  EQU   ZZ2AXO
@NM00054 EQU   ZZ2+7288
@NM00053 EQU   ZZ2AMDX+4
ZZ2AMDXC EQU   ZZ2AMDX
ZZ2HSD   EQU   ZZ2+3056
@NM00052 EQU   ZZ2ES
@NM00051 EQU   ZZ2+2868
ZZ2ITSEC EQU   ZZ2ITSE+1
@NM00050 EQU   ZZ2ITSE
ZZ2ITSEP EQU   ZZ2ITSE
ZZ2ITSEW EQU   ZZ2ITSE
@NM00049 EQU   ZZ2ITR+20
ZZ2ITREC EQU   ZZ2ITRE+1
@NM00048 EQU   ZZ2ITRE
ZZ2ITREP EQU   ZZ2ITRE
ZZ2ITREW EQU   ZZ2ITRE
@NM00047 EQU   ZZ2ITR+9
ZZ2ITRRC EQU   ZZ2ITR+8
ZZ2ITR2P EQU   ZZ2ITR+4
ZZ2ITRPP EQU   ZZ2ITR
@NM00046 EQU   ZZ2+1544
ZZ2PGM   EQU   ZZ2+1536
@NM00045 EQU   ZZ2+1526
ZZ2CW    EQU   ZZ2+1524
@NM00044 EQU   ZZ2+1504
@NM00043 EQU   ZZ2+1352
ZZ2FFSYP EQU   ZZ2+1348
ZZ2SASYP EQU   ZZ2+1344
ZZ2RDSYP EQU   ZZ2+1340
ZZ2RASYP EQU   ZZ2+1336
ZZ2PHSYP EQU   ZZ2+1332
ZZ2ESSYP EQU   ZZ2+1328
ZZ200SYP EQU   ZZ2+1324
ZZ2SCWP  EQU   ZZ2+1320
ZZ2TTLP  EQU   ZZ2+1316
ZZ2LOADP EQU   ZZ2+1312
ZZ2VRESP EQU   ZZ2+1308
ZZ2CPPLE EQU   ZZ2CPPL+12
ZZ2CPPLP EQU   ZZ2CPPL+8
ZZ2CPPLU EQU   ZZ2CPPL+4
ZZ2VRSAP EQU   ZZ2+1288
ZZ2RVTP  EQU   ZZ2+1284
@NM00042 EQU   ZZ2+1272
@NM00041 EQU   ZZ2+1268
ZZ2RPLP  EQU   ZZ2+1260
ZZ2TCBP  EQU   ZZ2+1256
@NM00040 EQU   ZZ2+1252
ZZ2ZZ2P  EQU   ZZ2+1248
@NM00039 EQU   ZZ2+1112
@NM00038 EQU   ZZ2+1080
ZZ2FT25P EQU   ZZ2+1072
@NM00037 EQU   ZZ2+976
ZZ2TOD   EQU   ZZ2+968
ZZ2STGN  EQU   ZZ2STG+4
ZZ2STGP  EQU   ZZ2STG
@NM00036 EQU   ZZ2+952
ZZ2SCMDE EQU   ZZ2+944
ZZ2SCMDN EQU   ZZ2+936
ZZ2IDENT EQU   ZZ2+928
ZZ2A9999 EQU   ZZ2A+656
@NM00035 EQU   ZZ2A+224
@NM00034 EQU   ZZ2A+220
ZZ2AQD99 EQU   ZZ2AQD+60
@NM00033 EQU   ZZ2AQD+56
@NM00032 EQU   ZZ2AQDF
ZZ2AQDFA EQU   ZZ2AQDF
ZZ2AQDIL EQU   ZZ2AQD+48
ZZ2AQDIM EQU   ZZ2AQD+44
ZZ2AQDT9 EQU   ZZ2AQDT+34
ZZ2AQDTE EQU   ZZ2AQDT+33
ZZ2AQDTD EQU   ZZ2AQDT+2
@NM00031 EQU   ZZ2AQDT+1
ZZ2AQDTY EQU   ZZ2AQDT
ZZ2AQDT0 EQU   ZZ2AQDT
ZZ2AQDLB EQU   ZZ2AQD+9
ZZ2AQDOB EQU   ZZ2AQD+8
ZZ2AQDLE EQU   ZZ2AQD+4
ZZ2AQDOF EQU   ZZ2AQD
ZZ2AQD00 EQU   ZZ2AQD
ZZ2AQAS9 EQU   ZZ2AQAS+16
@NM00030 EQU   ZZ2AQAS+12
ZZ2AQAS2 EQU   ZZ2AQAS+8
ZZ2AQAS1 EQU   ZZ2AQAS+4
@NM00029 EQU   ZZ2AQAS+2
ZZ2AQAST EQU   ZZ2AQAS
ZZ2AQAS0 EQU   ZZ2AQAS
ZZ2AZZ6P EQU   ZZ2A+140
ZZ2ADPTA EQU   ZZ2ADPT
ZZ2ADPL  EQU   ZZ2ADP
ZZ2ADMTA EQU   ZZ2ADMT
ZZ2ADML  EQU   ZZ2ADM
ZZ2ADDTA EQU   ZZ2ADDT
ZZ2ADDL  EQU   ZZ2ADD
@NM00028 EQU   ZZ2A+72
ZZ2APIDB EQU   ZZ2APID+3
ZZ2APIDA EQU   ZZ2APID
@NM00027 EQU   ZZ2A+24
@NM00026 EQU   ZZ2AF+5
@NM00025 EQU   ZZ2AF+3
ZZ2AFS   EQU   ZZ2AF+2
ZZ2AFD   EQU   ZZ2AF+2
ZZ2AFQ   EQU   ZZ2AF+2
ZZ2AF$   EQU   ZZ2AF+2
@NM00024 EQU   ZZ2AF+2
ZZ2AFM   EQU   ZZ2AF+2
@NM00023 EQU   ZZ2AF+2
@NM00022 EQU   ZZ2AF+1
ZZ2AFV   EQU   ZZ2AF+1
@NM00021 EQU   ZZ2AF+1
ZZ2AFC   EQU   ZZ2AF+1
@NM00020 EQU   ZZ2AF
ZZ2AFFS  EQU   ZZ2AF
ZZ2AFT   EQU   ZZ2AF
ZZ2AFP   EQU   ZZ2AF
@NM00019 EQU   ZZ2A+8
ZZ2ALINE EQU   ZZ2A+4
@NM00018 EQU   ZZ2A+3
ZZ2ASE   EQU   ZZ2A+2
ZZ2ACH   EQU   ZZ2A
@NM00017 EQU   ZZ2+264
@NM00016 EQU   ZZ2+263
ZZ2PRTT0 EQU   ZZ2PRTT
ZZ2PRTO  EQU   ZZ2PRT+2
ZZ2PRTL  EQU   ZZ2PRT
@NM00015 EQU   ZZ2AMD+56
ZZ2AMDXP EQU   ZZ2AMD+52
ZZ2AMDD  EQU   ZZ2AMD+48
ZZ2AMDL  EQU   ZZ2AMD+44
ZZ2AMDU  EQU   ZZ2AMD+28
ZZ2AMDF  EQU   ZZ2AMD+24
ZZ2AMDS  EQU   ZZ2AMD+20
ZZ2AMDC  EQU   ZZ2AMD+16
ZZ2AMDP  EQU   ZZ2AMD+12
ZZ2AMDB  EQU   ZZ2AMD+8
@NM00014 EQU   @NM00013
ZZ2AMD2  EQU   @NM00013
ZZ2AMD1  EQU   @NM00013
ZZ2AMD0  EQU   ZZ2AMD+6
ZZ2AMDA  EQU   ZZ2AMD+4
ZZ2AMDT  EQU   ZZ2AMD
ZZ199999 EQU   ZZ1+3072
@NM00012 EQU   ZZ1+2160
ZZ1TRTAS EQU   ZZ1+1904
ZZ1TRUPC EQU   ZZ1+1648
ZZ1TRCTX EQU   ZZ1+1392
ZZ1NASID EQU   ZZ1N+274
ZZ1NSTRL EQU   ZZ1N+272
ZZ1NOFF  EQU   ZZ1N+268
ZZ1NBDY  EQU   ZZ1N+264
ZZ1NADE  EQU   ZZ1N+260
ZZ1NADB  EQU   ZZ1N+256
ZZ1NSTR  EQU   ZZ1N
@NM00011 EQU   ZZ1+1080
ZZ1TREBC EQU   ZZ1+824
ZZ1TRHEX EQU   ZZ1+568
@NM00010 EQU   ZZ1+377
ZZ1USTAE EQU   ZZ1+376
@NM00009 EQU   ZZ1F+1
@NM00008 EQU   ZZ1F
ZZ1FM    EQU   ZZ1F
ZZ1FX    EQU   ZZ1F
ZZ1FU    EQU   ZZ1F
ZZ1EVEC  EQU   ZZ1EVE+1
@NM00007 EQU   ZZ1EVE
ZZ1EVEP  EQU   ZZ1EVE
ZZ1EVEW  EQU   ZZ1EVE
ZZ1ACMP  EQU   ZZ1ATTN
@NM00006 EQU   ZZ1+144
ZZ1ZZ6P  EQU   ZZ1+136
@NM00005 EQU   ZZ1+84
ZZ1PLINE EQU   ZZ1+80
ZZ1PGSZ  EQU   ZZ1+76
ZZ1PCNT  EQU   ZZ1+72
@NM00004 EQU   ZZ1+68
ZZ1TPAGE EQU   ZZ1+64
ZZ1TLINE EQU   ZZ1+60
@NM00003 EQU   ZZ1+52
ZZ1DMCBP EQU   ZZ1+48
ZZ1DSDP  EQU   ZZ1+44
ZZ1327WP EQU   ZZ1+32
ZZ1ACBP  EQU   ZZ1+28
@NM00002 EQU   ZZ1+24
ZZ1PDCBP EQU   ZZ1+20
ZZ1BLRBL EQU   ZZ1+16
@NM00001 EQU   ZZ1+12
ZZ1PNULL EQU   ZZ1+8
ZZ1NULL  EQU   ZZ1+4
ZZ1IDE   EQU   ZZ1
*                                      END UNREFERENCED COMPONENTS
@RC00467 EQU   @EL00003
@RC00562 EQU   @EL00005
@RC00616 EQU   @EL00006
@RC00905 EQU   @RC00867
@RC00908 EQU   @RC00905
@ENDDATA EQU   *
         END   BLSEADPR,(C'PLS0954',0701,78067)

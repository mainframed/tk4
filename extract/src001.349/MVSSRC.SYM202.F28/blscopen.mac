         TITLE 'BLSCOPEN -- IPCS DAS OPEN EXECUTOR                     *
                        '
*     /* CHANGE ACTIVITY
*    THIS MODULE IS WRITTEN FOR @G57LPSR
BLSCOPEN CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'BLSCOPEN  78.062'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         BLSCGETS R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
*   CBPTR=GPR01P;                   /* GET ADDRESSABILITY TO THE DMCB*/
         LR    CBPTR,GPR01P                                        0030
*   RFY                                                            0031
*     GPR01P UNRSTD;                                               0031
*   MODNAME=LMODNMC;                /* MARK AUTOMATIC AREA           */
         MVC   MODNAME(8),@CC00682                                 0032
*   SUBCODE=F0C;                    /* INIT THE SUBROUTINE RETURN  0033
*                                      CODE                          */
         SLR   @10,@10                                             0033
         ST    @10,SUBCODE                                         0033
*   DMCBOPTS=LHEX0C;                /* OPEN DOESNT USE THE OPTIONS SO
*                                      ZERO THEM OUT                 */
         MVI   DMCBOPTS(CBPTR),X'00'                               0034
*   DCBPTR=ADDR(DMCBDCB);           /* MAP THE DCB IN THE DMCB FOR 0035
*                                      QSAM                          */
*                                                                  0035
         LA    DCBPTR,DMCBDCB(,CBPTR)                              0035
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DMCB IS ALREADY OPEN THEN RETURN A CODE OF EIGHT       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0036
*   IF DMCBOPN^=LHEX0C THEN         /* TEST DMCB ISNT CLOSED         */
         CLI   DMCBOPN(CBPTR),X'00'                                0036
         BE    @RF00036                                            0036
*     DO;                           /* IF DMCB ISNT CLOSED           */
*       DMCBRTC=ERROR;                                             0038
         MVC   DMCBRTC(4,CBPTR),@CF00044                           0038
*     END;                          /* IF DMCB ISNT CLOSED           */
*   ELSE                                                           0040
*     DO;                           /* DATA SET NOT OPEN             */
         B     @RC00036                                            0040
@RF00036 DS    0H                                                  0041
*       DMCBCPC=F0C;                /* CLEAR ABEND COMPLETION CODE   */
         SLR   @10,@10                                             0041
         ST    @10,DMCBCPC(,CBPTR)                                 0041
         EJECT
*       IF DMCBVSF=ON THEN          /* IS VSAM BIT SET               */
         TM    DMCBVSF(CBPTR),B'00000001'                          0042
         BNO   @RF00042                                            0042
*         DO;                       /* VSAM OPEN                     */
*                                                                  0043
*           /*********************************************************/
*           /*                                                       */
*           /* VSAM OPEN                                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0044
*           IF DMCBACCM=F1C×        /* TEST FOR HIGH CONTENTION    0044
*                                      PROTOCOL REQUEST              */
*               DMCBACCM=F4C THEN                                  0044
         CLI   DMCBACCM(CBPTR),1                                   0044
         BE    @RT00044                                            0044
         CLI   DMCBACCM(CBPTR),4                                   0044
         BNE   @RF00044                                            0044
@RT00044 DS    0H                                                  0045
*             DO;                   /* HIGH CONTENTION PROTOCOL    0045
*                                      REQUEST                       */
*               CALL BLSCVALT(DMCB);/* OPEN ENQUEUE VALIDITY CHECK   */
         ST    CBPTR,@AL00001                                      0046
         L     @15,@CV00632                                        0046
         LA    @01,@AL00001                                        0046
         BALR  @14,@15                                             0046
*               RFY                                                0047
*                 GPR15F RSTD;                                     0047
*               DMCBRTC=GPR15F;     /* SAVE RETURN CODE              */
         ST    GPR15F,DMCBRTC(,CBPTR)                              0048
*               RFY                                                0049
*                 GPR15F UNRSTD;                                   0049
*               IF DMCBRTC^=F0C THEN/* TEST FOR VALIDITY CHECK FAILED*/
         L     @10,DMCBRTC(,CBPTR)                                 0050
         LTR   @10,@10                                             0050
         BZ    @RF00050                                            0050
*                 DO;               /* ABEND(F131C) DUMP USER        */
*                   RESPECIFY                                      0052
*                    (GPR01F) RESTRICTED;                          0052
*                   GPR01F=(F131C)&'00000FFF'X;/* COMP CODE IN BITS
*                                      20-31                         */
         LA    GPR01F,131                                          0053
*                   GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS
*                                      FLAG                          */
         O     GPR01F,@CF00674                                     0054
*                   SVC(13);        /* ISSUE ABEND SVC               */
         SVC   13                                                  0055
*                   RESPECIFY                                      0056
*                    (GPR01F) UNRESTRICTED;                        0056
*                 END;              /* ABEND(F131C) DUMP USER OPEN 0057
*                                      ENQUEUE VALIDITY CHK FAILED   */
*               ELSE                                               0058
*                 DO;               /* VALIDITY CHECK OK,ISSUE     0058
*                                      ENQUEUE                       */
         B     @RC00050                                            0058
@RF00050 DS    0H                                                  0059
*                   IF DMCBOUT=ON THEN/* TEST OPEN FOR OUTPUT        */
         TM    DMCBOUT(CBPTR),B'10000000'                          0059
         BNO   @RF00059                                            0059
*                     QTYPE=QEXCC;  /* ENQUEUE EXCLUSIVE             */
         MVI   QTYPE,C'E'                                          0060
*                   ELSE                                           0061
*                     QTYPE=QSHRC;  /* ENQUEUE SHARE                 */
         B     @RC00059                                            0061
@RF00059 MVI   QTYPE,C'S'                                          0061
*                   CALL BLSDENQ0(ZZ2,QNAME,DMCBDSN,LENGTH(DMCBDSN),
*                       QTYPE);     /* ISSUE ENQUEUE TIMER WAIT LOOP */
@RC00059 L     @10,DMCBTVP(,CBPTR)                                 0062
         ST    @10,@AL00001                                        0062
         LA    @10,@CC00653                                        0062
         ST    @10,@AL00001+4                                      0062
         LA    @10,DMCBDSN(,CBPTR)                                 0062
         ST    @10,@AL00001+8                                      0062
         LA    @10,@CF00119                                        0062
         ST    @10,@AL00001+12                                     0062
         LA    @10,QTYPE                                           0062
         ST    @10,@AL00001+16                                     0062
         L     @15,@CV00638                                        0062
         LA    @01,@AL00001                                        0062
         BALR  @14,@15                                             0062
*                   RFY                                            0063
*                     GPR15F RSTD;                                 0063
*                   DMCBRTC=GPR15F; /* SAVE RETURN CODE              */
         ST    GPR15F,DMCBRTC(,CBPTR)                              0064
*                   RFY                                            0065
*                     GPR15F UNRSTD;                               0065
*                 END;              /* VALIDITY CHECK OK,ISSUE     0066
*                                      ENQUEUE                       */
*             END;                  /* HIGH CONTENTION PROTOCOL    0067
*                                      REQUEST                       */
@RC00050 DS    0H                                                  0068
*           IF DMCBRTC=F0C THEN     /* TEST OK SO FAR (NO ENQUEUE  0068
*                                      ATTENTION)                    */
@RF00044 L     @10,DMCBRTC(,CBPTR)                                 0068
         LTR   @10,@10                                             0068
         BNZ   @RF00068                                            0068
*             DO;                   /* VSAM OK SO FAR, PROCEED       */
*               IF DMCBOUT=ON THEN  /* IS REQUEST OPEN FOR OUTPUT    */
         TM    DMCBOUT(CBPTR),B'10000000'                          0070
         BNO   @RF00070                                            0070
*                 DO;               /* OPEN FOR OUTPUT               */
*                   ACBIN=ON;       /* PERMIT GET                    */
*                   ACBOUT=ON;      /* PERMIT PUT                    */
         OI    ACBIN+492(CBPTR),B'00000110'                        0073
*                   DMCBSIN=ON;     /* INPUT ALWAYS ALLOWED FOR VSAM */
*                   DMCBSOUT=ON;    /* INDICATE OPEN FOR OUTPUT      */
         OI    DMCBSIN(CBPTR),B'11000000'                          0075
*                 END;              /* OPEN FOR OUTPUT               */
*               ELSE                                               0077
*                 DO;               /* OPEN FOR INPUT                */
         B     @RC00070                                            0077
@RF00070 DS    0H                                                  0078
*                   ACBIN=ON;       /* PERMIT GET                    */
*                   ACBOUT=OFF;     /* FORCE PUT OFF                 */
         OI    ACBIN+492(CBPTR),B'00000100'                        0079
         NI    ACBOUT+492(CBPTR),B'11111101'                       0079
*                   DMCBSIN=ON;     /* INPUT ALWAYS ALLOWED FOR VSAM */
*                   DMCBSOUT=OFF;   /* FORCE OUTPUT MARK OFF         */
         OI    DMCBSIN(CBPTR),B'10000000'                          0081
         NI    DMCBSOUT(CBPTR),B'10111111'                         0081
*                 END;              /* OPEN FOR INPUT                */
*                                                                  0082
*               /*****************************************************/
*               /*                                                   */
*               /* PERFORM THE ACTUAL OPEN                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0083
*               WAITFLAG=OFF;       /* DATA SET AVAILABLE FLAG       */
@RC00070 NI    WAITFLAG,B'01111111'                                0083
*               DO UNTIL WAITFLAG=ON;/* LOOP UNTIL DATA SET IS     0084
*                                      AVAILABLE                     */
@DL00084 DS    0H                                                  0085
*                 RFY                                              0085
*                   GPR02P RSTD;                                   0085
*                 GPR02P=ADDR(DMCBACB);/* ADDRESS ACB WITHIN DMCB    */
         LA    GPR02P,DMCBACB(,CBPTR)                              0086
*                 OPENLIST=OPENIN;  /* FOR VSAM THE OPEN OPTIONS DONT
*                                      MATTER                        */
         L     @10,OPENIN                                          0087
         ST    @10,OPENLIST                                        0087
*                 GEN REFS(GPR02P) SETS(GPR01P,GPR00F,GPR15F)      0088
*                     (OPEN ((GPR02P)),MF=(E,OPENLIST));           0088
         OPEN ((GPR02P)),MF=(E,OPENLIST)
*                 RFY                                              0089
*                   GPR02P UNRSTD;                                 0089
*                 RFY                                              0090
*                   GPR15F RSTD;                                   0090
*                 DMCBSUBC=GPR15F;  /* SAVE OPEN RETURN CODE         */
         ST    GPR15F,DMCBSUBC(,CBPTR)                             0091
*                 RFY                                              0092
*                   GPR15F UNRSTD;                                 0092
*                 IF DMCBSUBC=ERROR&/* TEST FOR DATA SET NOT       0093
*                                      AVAILABLE                     */
*                     ACBERFLG=F168C THEN                          0093
         L     @10,DMCBSUBC(,CBPTR)                                0093
         CL    @10,@CF00044                                        0093
         BNE   @RF00093                                            0093
         CLI   ACBERFLG+492(CBPTR),168                             0093
         BNE   @RF00093                                            0093
*                   DO;             /* DATA SET NOT AVAILABLE        */
*                     CALL BLSDWAIT(DMCB);/* WAIT AWHILE             */
         ST    CBPTR,@AL00001                                      0095
         L     @15,@CV00637                                        0095
         LA    @01,@AL00001                                        0095
         BALR  @14,@15                                             0095
*                     IF DMCBRTC=F4C THEN/* TEST FOR ATTENTION ISSUED*/
         CLC   DMCBRTC(4,CBPTR),@CF00037                           0096
         BNE   @RF00096                                            0096
*                       WAITFLAG=ON;/* WAIT NO LONGER - ATTENTION WAS
*                                      ISSUED                        */
         OI    WAITFLAG,B'10000000'                                0097
*                   END;            /* DATA SET NOT AVAILABLE        */
*                 ELSE                                             0099
*                   WAITFLAG=ON;                                   0099
         B     @RC00093                                            0099
@RF00093 OI    WAITFLAG,B'10000000'                                0099
*               END;                /* LOOP UNTIL DATA SET IS      0100
*                                      AVAILABLE                     */
@RC00093 DS    0H                                                  0100
@DE00084 TM    WAITFLAG,B'10000000'                                0100
         BNO   @DL00084                                            0100
*               IF DMCBSUBC=F4C&    /* TEST FOR WARNING FROM VSAM  0101
*                                      OPEN                          */
*                   DMCBOUT=ON THEN /* AND OPENING FOR UPDATE        */
         CLC   DMCBSUBC(4,CBPTR),@CF00037                          0101
         BNE   @RF00101                                            0101
         TM    DMCBOUT(CBPTR),B'10000000'                          0101
         BNO   @RF00101                                            0101
*                 DO;               /* VSAM OPEN ISSUED WARNING -  0102
*                                      ISSUE MESSAGES AND CLOSE      */
*                   DMCBRTC=ERROR;  /* SET THE DAS RETURN CODE       */
         MVC   DMCBRTC(4,CBPTR),@CF00044                           0103
*                   DMCBMODN=MODNAME;/* ERROR MODULE FOR MESSAGE     */
         MVC   DMCBMODN(8,CBPTR),MODNAME                           0104
*                   DMCBACBE=ACBERFLG;/* PASS ERROR REASON TO DMCB   */
         SLR   @10,@10                                             0105
         IC    @10,ACBERFLG+492(,CBPTR)                            0105
         ST    @10,DMCBACBE(,CBPTR)                                0105
*                   CALL BLSCANLE(DMCB);/* ISSUE VSAMFAIL MESSAGES 0106
*                                      FOR OPEN                      */
         ST    CBPTR,@AL00001                                      0106
         L     @15,@CV00635                                        0106
         LA    @01,@AL00001                                        0106
         BALR  @14,@15                                             0106
*                   DMCBRQST=DMCBCLR;/* SETUP FOR CLOSE REQUEST      */
         MVI   DMCBRQST(CBPTR),X'02'                               0107
*                   RFY                                            0108
*                     GPR01P RSTD;                                 0108
*                   GPR01P=CBPTR;   /* PASS THE DMCB POINTER         */
         LR    GPR01P,CBPTR                                        0109
*                   CALL BLSCCLSE;  /* CLOSE THE DATA SET            */
         L     @15,@CV00634                                        0110
         BALR  @14,@15                                             0110
*                   RFY                                            0111
*                     GPR01P UNRSTD;                               0111
*                   RFY                                            0112
*                     GPR15F RSTD;                                 0112
*                   DMCBSUBC=GPR15F;/* SAVE CLOSE RETURN CODE        */
         ST    GPR15F,DMCBSUBC(,CBPTR)                             0113
*                   RFY                                            0114
*                     GPR15F UNRSTD;                               0114
*                   IF DMCBSUBC=F4C THEN/* TEST FOR VSAM CLOSE ERROR */
         L     @10,DMCBSUBC(,CBPTR)                                0115
         CL    @10,@CF00037                                        0115
         BNE   @RF00115                                            0115
*                     DO;           /* VSAM CLOSE ERROR - ISSUE    0116
*                                      MESSAGES AND ABEND            */
*                       DMCBRTC=ERROR;/* SET THE DAS RETURN CODE     */
         MVC   DMCBRTC(4,CBPTR),@CF00044                           0117
*                       DMCBACBE=ACBERFLG;/* PASS ERROR REASON TO  0118
*                                      DMCB                          */
         SLR   @10,@10                                             0118
         IC    @10,ACBERFLG+492(,CBPTR)                            0118
         ST    @10,DMCBACBE(,CBPTR)                                0118
*                       CALL BLSCANLE(DMCB);/* ISSUE VSAMFAIL      0119
*                                      MESSAGES FOR CLOSE            */
         ST    CBPTR,@AL00001                                      0119
         L     @15,@CV00635                                        0119
         LA    @01,@AL00001                                        0119
         BALR  @14,@15                                             0119
*                       DO;         /* BLSDMSG (ZZ2,NOMSG,DMCBMSG,0)
*                                      ROUTE(TERM)                   */
*                         CALL BLSDMSG0(ZZ2,NOMSG,DMCBMSG,0,'00010000'B
*                             ,0);  /* BUILD MESSAGE                 */
         MVC   @AL00001+4(20),@AL00121                             0121
         L     @10,DMCBTVP(,CBPTR)                                 0121
         ST    @10,@AL00001                                        0121
         LA    @10,DMCBMSG(,CBPTR)                                 0121
         ST    @10,@AL00001+8                                      0121
         L     @15,@CV00636                                        0121
         LA    @01,@AL00001                                        0121
         BALR  @14,@15                                             0121
*                       END;        /* BLSDMSG (ZZ2,NOMSG,DMCBMSG,0)
*                                      ROUTE(TERM) ROUTE MESSAGES TO
*                                      TERMINAL                      */
*                       DO;         /* ABEND(F140C) DUMP USER        */
*                         RESPECIFY                                0124
*                          (GPR01F) RESTRICTED;                    0124
*                         GPR01F=(F140C)&'00000FFF'X;/* COMP CODE IN
*                                      BITS 20-31                    */
         LA    GPR01F,140                                          0125
*                         GPR01F=GPR01F×'80000000'X;/*             0126
*                                      DUMP/STEP/DUMPOPTS FLAG       */
         O     GPR01F,@CF00674                                     0126
*                         SVC(13);  /* ISSUE ABEND SVC               */
         SVC   13                                                  0127
*                         RESPECIFY                                0128
*                          (GPR01F) UNRESTRICTED;                  0128
*                       END;        /* ABEND(F140C) DUMP USER        */
*                     END;          /* VSAM CLOSE ERROR - ISSUE    0130
*                                      MESSAGES AND ABEND            */
*                   DMCBRQST=DMCBOPR;/* RESTORE OPEN REQUEST         */
@RF00115 MVI   DMCBRQST(CBPTR),X'01'                               0131
*                   DMCBOPN=LHEX0C; /* INDICATE DMCB IS NOT OPEN     */
         MVI   DMCBOPN(CBPTR),X'00'                                0132
*                   DMCBRTC=ERROR×LBIT0C;/* OPEN FAILED. TELL      0133
*                                      BLSCRQST DON'T CALL BLSCANLE  */
         MVC   DMCBRTC(4,CBPTR),@CF00708                           0133
*                 END;              /* VSAM OPEN ISSUED WARNING -  0134
*                                      ISSUE MESSAGES AND CLOSE      */
*               IF DMCBSUBC>=ERROR THEN/* TEST RETURN CODE FROM VSAM
*                                      OPEN                          */
@RF00101 LA    @10,8                                               0135
         CL    @10,DMCBSUBC(,CBPTR)                                0135
         BH    @RF00135                                            0135
*                 DO;               /* VSAM OPEN ERROR               */
*                   DMCBRTC=ERROR;  /* OPEN JUST PLAIN FAILED        */
         ST    @10,DMCBRTC(,CBPTR)                                 0137
*                   DMCBACBE=ACBERFLG;/* PASS ERROR REASON TO DMCB   */
         SLR   @10,@10                                             0138
         IC    @10,ACBERFLG+492(,CBPTR)                            0138
         ST    @10,DMCBACBE(,CBPTR)                                0138
*                   DMCBOPN=LHEX0C; /* INDICATE DMCB IS NOT OPEN     */
         MVI   DMCBOPN(CBPTR),X'00'                                0139
*                 END;              /* VSAM OPEN ERROR               */
*             END;                  /* VSAM OK SO FAR, PROCEED       */
         EJECT
*         END;                      /* VSAM OPEN                     */
*       ELSE                                                       0143
*         DO;                       /* QSAM OPEN                     */
*                                                                  0143
         B     @RC00042                                            0143
@RF00042 DS    0H                                                  0144
*           /*********************************************************/
*           /*                                                       */
*           /* QSAM OPEN                                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0144
*           IF DMCBOUT=ON           /* OPEN FOR OUTPUT               */
*             THEN                                                 0144
         TM    DMCBOUT(CBPTR),B'10000000'                          0144
         BNO   @RF00144                                            0144
*             DO;                   /* QSAM OPEN FOR OUTPUT          */
*               OPENLIST=OPENOUT;   /* OPEN IS FOR OUTPUT            */
         L     @10,OPENOUT                                         0146
         ST    @10,OPENLIST                                        0146
*               DMCBSOUT=ON;                                       0147
         OI    DMCBSOUT(CBPTR),B'01000000'                         0147
*             END;                  /* QSAM OPEN FOR OUTPUT          */
*           ELSE                                                   0149
*             DO;                   /* QSAM OPEN FOR INPUT           */
         B     @RC00144                                            0149
@RF00144 DS    0H                                                  0150
*               OPENLIST=OPENIN;    /* OPEN IS FOR INPUT             */
         L     @10,OPENIN                                          0150
         ST    @10,OPENLIST                                        0150
*               DMCBSIN=ON;                                        0151
         OI    DMCBSIN(CBPTR),B'10000000'                          0151
*             END;                  /* QSAM OPEN FOR INPUT           */
*                                                                  0152
*           /*********************************************************/
*           /*                                                       */
*           /* QSAM OPEN MAY ABEND SO SET A ESTAE EXIT TO COVER THE  */
*           /* POSSIBILITY                                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0153
*           DMCBRET=ADDR(RETRY);    /* INDICATE RETRY ADDRESS        */
@RC00144 LA    @10,RETRY                                           0153
         ST    @10,DMCBRET(,CBPTR)                                 0153
*           DMCBARC=SEVERE;         /* SET THE RETURN CODE SHOULD THE
*                                      OPEN REQUEST ABEND            */
         MVC   DMCBARC(4,CBPTR),@CF00325                           0154
*           ESTAEPRM=ESTAELST;                                     0155
         MVC   ESTAEPRM(16),ESTAELST                               0155
*           RFY                                                    0156
*            (GPR02P,                                              0156
*             GPR03P,                                              0156
*             GPR04P) RSTD;                                        0156
*           GPR02P=ADDR(ESTAEPRM);  /* ADDRESS ESTAE PARAMETER LIST  */
         LA    GPR02P,ESTAEPRM                                     0157
*           GPR03P=ADDR(BLSCRECV);  /* ADDRESS ESTAE EXIT            */
         L     GPR03P,@CV00633                                     0158
*           GPR04P=CBPTR;           /* PARM TO ESTAE EXIT IS DMCB    */
         LR    GPR04P,CBPTR                                        0159
*           GEN(ESTAE  (GPR03P),PARAM=(GPR04P),MF=(E,(GPR02P)))    0160
*           REFS(GPR02P,GPR03P,GPR04P);                            0160
         ESTAE  (GPR03P),PARAM=(GPR04P),MF=(E,(GPR02P))
*           RFY                                                    0161
*            (GPR02P,                                              0161
*             GPR03P,                                              0161
*             GPR04P) UNRSTD;                                      0161
*                                                                  0161
*           /*********************************************************/
*           /*                                                       */
*           /* DO THE QSAM OPEN. IF ANY ERRORS OCCUR THEY WILL BE    */
*           /* TRAPPED BY THE ESTAE EXIT                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0162
*           RFY                                                    0162
*             GPR02P RSTD;                                         0162
*           GPR02P=ADDR(DMCBDCB);   /* ADDRESS THE DCB IN THE DMCB   */
         LA    GPR02P,DMCBDCB(,CBPTR)                              0163
*           GEN(OPEN ((GPR02P)),MF=(E,OPENLIST))                   0164
*           REFS(GPR02P,OPENLIST);                                 0164
         OPEN ((GPR02P)),MF=(E,OPENLIST)
*           RFY                                                    0165
*             GPR02P UNRSTD;                                       0165
*RETRY:                                                            0166
*           IF DMCBRTC^=F0C THEN    /* DID OPEN FAIL                 */
RETRY    L     @10,DMCBRTC(,CBPTR)                                 0166
         LTR   @10,@10                                             0166
         BZ    @RF00166                                            0166
*             DO;                   /* OPEN ABENDED                  */
*               DMCBOPN=LHEX0C;     /* FLAG DMCB AS NOT OPEN         */
         MVI   DMCBOPN(CBPTR),X'00'                                0168
*             END;                  /* OPEN ABENDED                  */
*           ELSE                                                   0170
*             IF DCBOFOPN^=ON THEN  /* IS THE DCB OPEN ?             */
         B     @RC00166                                            0170
@RF00166 TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0170
         BO    @RF00170                                            0170
*               DO;                 /* DCB NOT OPEN                  */
*                 DMCBRTC=ERROR;    /* OPEN FAILED, DCB IS IN      0172
*                                      PRE-OPEN CONDITION            */
         MVC   DMCBRTC(4,CBPTR),@CF00044                           0172
*                 DMCBOPN=LHEX0C;   /* FLAG DMCB AS NOT OPEN         */
         MVI   DMCBOPN(CBPTR),X'00'                                0173
*               END;                /* DCB NOT OPEN                  */
*                                                                  0174
*           /*********************************************************/
*           /*                                                       */
*           /* CANCEL THE ESTAE EXIT                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0175
*           ESTAEPRM=ESTAELST;                                     0175
@RF00170 DS    0H                                                  0175
@RC00166 MVC   ESTAEPRM(16),ESTAELST                               0175
*           RFY                                                    0176
*             GPR02P RSTD;                                         0176
*           GPR02P=ADDR(ESTAEPRM);  /* ADDRESS ESTAE CANCEL PARM LIST*/
         LA    GPR02P,ESTAEPRM                                     0177
*           GEN REFS(GPR02P)(ESTAE 0,MF=(E,(GPR02P)));             0178
         ESTAE 0,MF=(E,(GPR02P))
*           RFY                                                    0179
*             GPR02P UNRSTD;                                       0179
*         END;                      /* QSAM OPEN                     */
*     END;                          /* DATA SET NOT OPEN             */
@RC00042 DS    0H                                                  0182
*   IF DMCBRTC^=F0C THEN            /* TEST FOR ERROR                */
@RC00036 L     @10,DMCBRTC(,CBPTR)                                 0182
         LTR   @10,@10                                             0182
         BZ    @RF00182                                            0182
*     DMCBMODN=MODNAME;             /* ERROR MODULE FOR MESSAGE      */
         MVC   DMCBMODN(8,CBPTR),MODNAME                           0183
*   RETURN CODE(DMCBRTC);                                          0184
@RF00182 L     @10,DMCBRTC(,CBPTR)                                 0184
         L     @13,4(,@13)                                         0184
         L     @00,@SIZDATD                                        0184
         LR    @01,@11                                             0184
         BLSCFRES R,LV=(0),A=(1)
         LR    @15,@10                                             0184
         L     @14,12(,@13)                                        0184
         LM    @00,@12,20(@13)                                     0184
         BR    @14                                                 0184
         EJECT
*                                                                  0185
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0185
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                     0185
*     GPR01F FIXED(31) REG(1),                                     0185
*     GPR15F FIXED(31) REG(15),                                    0185
*     GPR01P PTR(31) REG(1),                                       0185
*     GPR02P PTR(31) REG(2),                                       0185
*     GPR03P PTR(31) REG(3),                                       0185
*     GPR04P PTR(31) REG(4);                                       0185
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0186
*     I031F FIXED(31) BASED,                                       0186
*     I031P PTR(31) BASED,                                         0186
*     I015F FIXED(15) BASED,                                       0186
*     I015P PTR(15) BASED,                                         0186
*     I008P PTR(8) BASED,                                          0186
*     I001C CHAR(1) BASED;                                         0186
*   DCL                                                            0187
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0187
*   END BLSCOPEN                                                   0188
*                                                                  0188
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*                                                                  0188
*       ;                                                          0188
@DATA    DS    0H
         DS    0F
@AL00121 DC    A(@CF00672)             LIST WITH   5 ARGUMENT(S)
         DS    F
         DC    A(@CF00631)
         DC    A(@CB00692)
         DC    A(@CF00631)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@AL00001 DS    6A
BLSCOPEN CSECT
         DS    0F
@CF00631 DC    F'0'
@CF00037 DC    F'4'
@CF00044 DC    F'8'
@CF00325 DC    F'12'
@CF00119 DC    F'44'
@CF00708 DC    F'-2147483640'
@CF00672 DC    F'-1'
@CF00674 DC    XL4'80000000'
@DATD    DSECT
         DS    0D
OPENLIST DS    F
         DS    CL4
ESTAEPRM DS    CL16
QTYPE    DS    CL1
WAITFLAG DS    BL1
         DS    CL2
MODSTAT  DS    CL12
         ORG   MODSTAT
MODNAME  DS    CL8
SUBCODE  DS    FL4
         ORG   MODSTAT+12
BLSCOPEN CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00632 DC    V(BLSCVALT)
@CV00633 DC    V(BLSCRECV)
@CV00634 DC    V(BLSCCLSE)
@CV00635 DC    V(BLSCANLE)
@CV00636 DC    V(BLSDMSG0)
@CV00637 DC    V(BLSDWAIT)
@CV00638 DC    V(BLSDENQ0)
         DS    0D
@CC00653 DC    C'SYSBLSDS'
@CC00682 DC    C'BLSCOPEN'
@CB00692 DC    B'00010000'
         DS    CL7
DASPATCH DS    CL80
         ORG   DASPATCH
DASPATA  DC    20A(0)
         ORG   DASPATCH+80
BLSCOPEN CSECT
ESTAELST ESTAE 0,MF=L
OPENIN   OPEN  (,(INPUT)),MF=L
OPENOUT  OPEN  (,(OUTPUT)),MF=L
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSCOPEN CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DCBPTR   EQU   @06
CBPTR    EQU   @05
GPR01P   EQU   @01
GPR15F   EQU   @15
GPR01F   EQU   @01
GPR02P   EQU   @02
GPR00F   EQU   @00
GPR03P   EQU   @03
GPR04P   EQU   @04
DMCB     EQU   0
DMCBTVP  EQU   DMCB+8
DMCBRTC  EQU   DMCB+12
DMCBFTY  EQU   DMCB+20
DMCBVSF  EQU   DMCBFTY
DMCBOPN  EQU   DMCB+21
DMCBSIN  EQU   DMCBOPN
DMCBSOUT EQU   DMCBOPN
DMCBRQST EQU   DMCB+22
DMCBRMOD EQU   DMCB+23
DMCBOUT  EQU   DMCBRMOD
DMCBOPTS EQU   DMCB+24
DMCBGKY  EQU   DMCBOPTS
DMCBMFLG EQU   DMCB+28
DMCBACCM EQU   DMCB+30
DMCBBUFP EQU   DMCB+32
DMCBKEYP EQU   DMCB+44
DMCBMSG  EQU   DMCB+52
DMCBFRE  EQU   DMCB+88
DMCBEOB  EQU   DMCB+92
DMCBRET  EQU   DMCB+112
DMCBCPC  EQU   DMCB+116
DMCBARC  EQU   DMCB+120
DMCBACBE EQU   DMCB+124
DMCBDSN  EQU   DMCB+284
DMCBSPEC EQU   DMCB+380
DMCBSUBC EQU   DMCB+404
DMCBAMS  EQU   DMCB+416
DMCBAUDT EQU   DMCB+568
DMCBLSCP EQU   DMCBAUDT+16
DMCBMODN EQU   DMCB+632
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBDVIND EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBERFLG EQU   ACBCOMN+49
ACBINFLG EQU   ACBCOMN+50
ACBVVIC  EQU   ACBINFLG
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS02 EQU   0
IHADCS04 EQU   0
DCBPRBYT EQU   IHADCS04+3
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFPCT EQU   DCBIFLGS
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
DCBCNTRL EQU   IHADCS40+12
DCBEROPT EQU   DCBCNTRL
ZZ2      EQU   0
DMCBRQC  EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
DMCBVSM  EQU   DMCBAMS
DMCBACB  EQU   DMCBVSM+76
DMCBQSM  EQU   DMCBAMS
DMCBDCB  EQU   DMCBQSM
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
DMCBRES7 EQU   DMCBQSM+96
DMCBRPL  EQU   DMCBVSM
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00041 EQU   IHADCS40+16
DCBCNTRA EQU   DCBCNTRL+1
@NM00040 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
DCBLRECL EQU   IHADCS40+10
@NM00039 EQU   IHADCS40+9
@NM00038 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00037 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
@NM00036 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00035 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00034 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00033 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBBLKSI EQU   IHADCS36+10
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00032 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00031 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
DCBOPTJ  EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00030 EQU   DCBPUT
DCBDEBA  EQU   DCBDEBAD+1
@NM00029 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00028 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00027 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00026 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00025 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00024 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
@NM00023 EQU   DCBDSRG1
@NM00022 EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRCID EQU   DCBPRBYT
@NM00021 EQU   DCBPRBYT
DCBPRTOV EQU   IHADCS04+2
@NM00020 EQU   IHADCS04+1
DCBPRTSP EQU   IHADCS04
@NM00019 EQU   IHADCS02+19
DCBDEN   EQU   IHADCS02+18
@NM00018 EQU   IHADCS02+17
DCBTRTCH EQU   IHADCS02+16
DCBBLKCT EQU   IHADCS02+12
@NM00017 EQU   IHADCS02
DCBTRBAL EQU   IHADCS01+6
@NM00016 EQU   IHADCS01+5
@NM00015 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00014 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00013 EQU   IHADCB
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00012 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
@NM00011 EQU   ACBINFLG+1
ACBBYPSS EQU   ACBINFLG
ACBSDS   EQU   ACBVVIC
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00010 EQU   ACBINFLG
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00009 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00008 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00007 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00006 EQU   ACBDSORG
ACBOPTJ  EQU   ACBDVIND
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00005 EQU   ACBCCTYP
ACBTRCID EQU   ACBCCTYP
@NM00004 EQU   ACBRECFM
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00003 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00002 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00001 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
DMCBWRK  EQU   DMCB+648
DMCBRES8 EQU   DMCB+640
DMCBCARY EQU   DMCBAUDT+20
DMCBCLC  EQU   DMCBAUDT+12
DMCBOPC  EQU   DMCBAUDT+8
DMCBFRC  EQU   DMCBAUDT+4
DMCBALC  EQU   DMCBAUDT
DMCBFR   EQU   DMCB+412
DMCBRES6 EQU   DMCB+410
DMCBIRSC EQU   DMCB+408
DMCBDRBP EQU   DMCB+400
DMCBRSZM EQU   DMCB+398
DMCBRSZA EQU   DMCB+396
DMCBCISZ EQU   DMCB+394
DMCBDCBL EQU   DMCB+392
DMCBDCLR EQU   DMCB+390
DMCBDCFM EQU   DMCB+389
DMCBRES5 EQU   DMCB+388
DMCBLBRT EQU   DMCB+386
DMCBLBSQ EQU   DMCB+384
DMCBLBPS EQU   DMCB+383
DMCBLBTY EQU   DMCB+382
DMCBRES4 EQU   DMCB+381
DMCBSPRS EQU   DMCBSPEC
DMCBSPRN EQU   DMCBSPEC
DMCBSPCT EQU   DMCBSPEC
DMCBSPRL EQU   DMCBSPEC
DMCBSPSE EQU   DMCB+376
DMCBSPPR EQU   DMCB+372
DMCBSPTY EQU   DMCB+369
DMCBODIS EQU   DMCB+368
DMCBDISP EQU   DMCB+367
DMCBSTAT EQU   DMCB+366
DMCBRES3 EQU   DMCB+364
DMCBMEMB EQU   DMCB+356
DMCBMODL EQU   DMCB+348
DMCBRES9 EQU   DMCB+340
DMCBPID  EQU   DMCB+332
DMCBTYPE EQU   DMCB+328
DMCBUNIT EQU   DMCB+276
DMCBDSOR EQU   DMCB+274
DMCBVOL  EQU   DMCB+268
DMCBDDNM EQU   DMCB+260
DMCBSYNM EQU   DMCB+132
DMCBRPLF EQU   DMCB+128
DMCBDCBE EQU   DMCBACBE
DMCBSTL  EQU   DMCB+96
DMCBRES2 EQU   DMCB+85
DMCBSPID EQU   DMCB+84
DMCBRESC EQU   DMCB+80
DMCBZZ1P EQU   DMCB+76
DMCBMSGS EQU   DMCB+72
DMCBMSG0 EQU   DMCB+68
DMCBRI   EQU   DMCB+64
DMCBRRL  EQU   DMCB+60
DMCBRBA  EQU   DMCB+56
DMCBKEYL EQU   DMCB+48
DMCBKPC  EQU   DMCBKEYP
DMCBORL  EQU   DMCB+40
DMCBBLEN EQU   DMCB+36
DMCBBFPC EQU   DMCBBUFP
DMCBRES1 EQU   DMCB+31
DMCBREJ  EQU   DMCB+29
DMCBRESB EQU   DMCBMFLG
DMCBFMOD EQU   DMCBMFLG
DMCBLOPT EQU   DMCB+27
DMCBLRM  EQU   DMCB+26
DMCBLRQ  EQU   DMCB+25
DMCBOPRS EQU   DMCBOPTS
DMCBLRD  EQU   DMCBOPTS
DMCBBWD  EQU   DMCBOPTS
DMCBUPD  EQU   DMCBOPTS
DMCBAPX  EQU   DMCBOPTS
DMCBRNO  EQU   DMCBGKY
DMCBKYD  EQU   DMCBOPTS
DMCBRMRS EQU   DMCBRMOD
DMCBRM5  EQU   DMCBRMOD
DMCBRM6  EQU   DMCBRMOD
DMCBTMP  EQU   DMCBOUT
DMCBRESA EQU   DMCBOPN
DMCBKSF  EQU   DMCBFTY
DMCBFTRS EQU   DMCBFTY
DMCBSHF  EQU   DMCBFTY
DMCBIRL  EQU   DMCB+16
DMCBNEXT EQU   DMCB+4
DMCBID   EQU   DMCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00096 EQU   @RC00093
@RF00068 EQU   @RC00042
@RF00135 EQU   @RC00042
@ENDDATA EQU   *
         END   BLSCOPEN,(C'PLS1931',0701,78062)

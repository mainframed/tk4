         TITLE 'EP=BLSCFAMS -- IPCS DAS ACCESS METHOD SERVICES INTERFAC*
               CE       '
*     /* CHANGE ACTIVITY
*    THIS MODULE IS WRITTEN FOR @G57LPSR
BLSCFAMS CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'BLSCFAMS  78.135'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         BLSCGETF R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(8),0(@01)                                  0002
*                                                                  0023
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MODULE STATUS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0023
*   DMCBPTR=ADDR(DMCBPARM);         /* BASE THE DMCB                 */
         L     DMCBPTR,@PC00001                                    0023
*   MODNAME=LMODNMC;                /* INIT THE MODULE NAME          */
         MVC   MODNAME(8),@CC00369                                 0024
*   RETCODE=F0C;                    /* INIT THE MODULE RETURN CODE   */
         SLR   @10,@10                                             0025
         ST    @10,RETCODE                                         0025
*   SUBCODE=F0C;                    /* INIT THE SUBROUTINE RETURN  0026
*                                      CODE                          */
*                                                                  0026
         ST    @10,SUBCODE                                         0026
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IDCAMS PARAMETER LIST ELEMENTS                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0027
*   OPTLLEN=F0C;                    /* NULL IDCAMS OPTION LIST       */
         STH   @10,OPTLLEN                                         0027
*   DNAMLLEN=F0C;                   /* NULL IDCAMS DNAME LIST        */
         STH   @10,DNAMLLEN                                        0028
*   PNLLEN=F0C;                     /* NULL IDCAMS PAGE NUMBER LIST  */
         STH   @10,PNLLEN                                          0029
*   IOLNUM=F2C;                     /* SYSIN AND SYSPRINT ARE TO BE
*                                      MANAGED                       */
         MVC   IOLNUM(4),@CF00076                                  0030
*   IOLINDDP=ADDR(INDD);            /* ADDRESS OF SYSIN DDNAME ENTRY */
         LA    @04,@CC00323                                        0031
         ST    @04,IOLINDDP                                        0031
*   IOLMINP=ADDR(BLSCAMIN);         /* SYSIN IN-CORE GET ROUTINE     */
         L     @04,@CV00239                                        0032
         ST    @04,IOLMINP                                         0032
*   IOLINCBP=ADDR(INCB);            /* ADDR OF BLSCAMIN CONTROL BLOCK*/
         LA    @04,INCB                                            0033
         ST    @04,IOLINCBP                                        0033
*   IOLOUDDP=ADDR(OUDD);            /* ADDR OF SYSPRINT DDNAME ENTRY */
         LA    @04,@CC00326                                        0034
         ST    @04,IOLOUDDP                                        0034
*   IOLMPRP=ADDR(BLSCAMPR);         /* SYSPRINT IN-CORE PUT ROUTINE  */
         L     @04,@CV00240                                        0035
         ST    @04,IOLMPRP                                         0035
*   IOLOUCBP=ADDR(OUCB);            /* ADDR OF BLSCAMPR CONTROL BLOCK*/
         LA    @04,OUCB                                            0036
         ST    @04,IOLOUCBP                                        0036
*   OUHEAD=F0C;                     /* SYSPRINT CONTROL BLOCK        */
         ST    @10,OUHEAD                                          0037
*   OUCUR=F0C;                                                     0038
         ST    @10,OUCUR                                           0038
*   OUTAIL=F0C;                                                    0039
         ST    @10,OUTAIL                                          0039
*   INHEAD=F0C;                     /* SYSIN CONTROL BLOCK           */
         ST    @10,INHEAD                                          0040
*   INCUR=F0C;                                                     0041
         ST    @10,INCUR                                           0041
*   INTAIL=F0C;                                                    0042
*                                                                  0042
         ST    @10,INTAIL                                          0042
*   /*****************************************************************/
*   /*                                                               */
*   /* PREPARE IDCAMS SYSIN TEXT STREAM FOR FREE REQUEST             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0043
*   CALL BLDSTR(ADDR(BLSCFMSM),PLIST);/* BUILD IDCAMS SYSIN STREAM 0043
*                                      FROM FREE(DELETE) MODEL       */
*                                                                  0043
         L     @10,@CV00243                                        0043
         ST    @10,@AFTEMPS+12                                     0043
         LA    @10,@AFTEMPS+12                                     0043
         ST    @10,@AL00001                                        0043
         L     @10,@PC00001+4                                      0043
         ST    @10,@AL00001+4                                      0043
         LA    @01,@AL00001                                        0043
         BAL   @14,BLDSTR                                          0043
*   /*****************************************************************/
*   /*                                                               */
*   /* INVOKE ACCESS METHOD SERVICES TO FREE SPACE FOR DATA SET      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0044
*   IF RETCODE=F0C THEN             /* TEST THAT ALL IS WELL         */
         L     @10,RETCODE                                         0044
         LTR   @10,@10                                             0044
         BNZ   @RF00044                                            0044
*     DO;                           /* OK TO INVOKE IDCAMS           */
*       CALL INVAMS;                /* INVOKE IDCAMS TO GET SPACE FOR
*                                      VSAM DATA SET                 */
         BAL   @14,INVAMS                                          0046
*     END;                          /* OK TO INVOKE IDCAMS           */
*                                                                  0047
*   /*****************************************************************/
*   /*                                                               */
*   /* IDCAMS FREE DATA SET COMPLETE, RETURN TO CALLER               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0048
*   RETURN CODE(RETCODE);                                          0048
@RF00044 L     @10,RETCODE                                         0048
         L     @13,4(,@13)                                         0048
         L     @00,@SIZDATD                                        0048
         LR    @01,@11                                             0048
         BLSCFREF R,LV=(0),A=(1)
         LR    @15,@10                                             0048
         L     @14,12(,@13)                                        0048
         LM    @00,@12,20(@13)                                     0048
         BR    @14                                                 0048
         EJECT
*                                                                  0049
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO INVOKE IDCAMS TO FREE SPACE FOR VSAM DATA SET    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0049
*INVAMS:                                                           0049
*   PROCEDURE;                      /* INVOKE IDCAMS TO FREE SPACE 0049
*                                      FOR VSAM DATA SET             */
INVAMS   STM   @14,@12,@SA00002                                    0049
*   GEN FLOWS(LINKERR);                                            0050
*                        /* TELL COMPILER ABOUT
*                                      ERRET(LINKERR) IN LINK MACRO
*   DO;                             /* LINK EP(LINKNAME) PARAM(AMSOPT
*                                      L,AMSDNAML,AMSPNL,AMSIOL) VL
*                                      ERRET(LINKERR)                */
*     I00601='00'X;                 /* EP/DE FLAG                    */
         MVI   I00601,X'00'                                        0052
*     I00602=ADDR(LINKNAME);        /* ADDR OF EP/DE                 */
         LA    @10,@CC00367                                        0053
         STCM  @10,7,I00602                                        0053
*     I00604=0;                     /* DCB PTR                       */
         SLR   @10,@10                                             0054
         STCM  @10,7,I00604                                        0054
*     I00603='80'X;                 /* ERRET FLAG                    */
         MVI   I00603,X'80'                                        0055
*     I00605=ADDR(LINKERR);         /* ERRET PTR                     */
         LA    @10,LINKERR                                         0056
         ST    @10,I00605                                          0056
*     IOPTLIST(1)=ADDR(AMSOPTL);    /* ADDR OF PROB PROG PARM        */
         LA    @10,AMSOPTL                                         0057
         ST    @10,IOPTLIST                                        0057
*     IOPTLIST(2)=ADDR(AMSDNAML);   /* ADDR OF PROB PROG PARM        */
         LA    @10,AMSDNAML                                        0058
         ST    @10,IOPTLIST+4                                      0058
*     IOPTLIST(3)=ADDR(AMSPNL);     /* ADDR OF PROB PROG PARM        */
         LA    @10,AMSPNL                                          0059
         ST    @10,IOPTLIST+8                                      0059
*     IOPTLIST(4)=ADDR(AMSIOL);     /* ADDR OF PROB PROG PARM        */
         LA    @10,AMSIOL                                          0060
         ST    @10,IOPTLIST+12                                     0060
*     IOPTLIST(4)=IOPTLIST(4)×'80000000'X;/* SET VL BIT              */
         O     @10,@CF00386                                        0061
         ST    @10,IOPTLIST+12                                     0061
*     RESPECIFY                                                    0062
*      (GPR01P) RESTRICTED;                                        0062
*     GPR01P=ADDR(IOPTLIST);        /* ADDR OF OPTLIST               */
         LA    GPR01P,IOPTLIST                                     0063
*     RESPECIFY                                                    0064
*      (GPR15P) RESTRICTED;                                        0064
*     GPR15P=ADDR(I006);            /* ADDR OF LINK LIST             */
         LA    GPR15P,I006                                         0065
*     SVC(6);                       /* ISSUE LINK SVC                */
         SVC   6                                                   0066
*     RESPECIFY                                                    0067
*      (GPR01P) UNRESTRICTED;                                      0067
*     RESPECIFY                                                    0068
*      (GPR15P) UNRESTRICTED;                                      0068
*   END;                            /* LINK EP(LINKNAME) PARAM(AMSOPT
*                                      L,AMSDNAML,AMSPNL,AMSIOL) VL
*                                      ERRET(LINKERR) FREE SPACE FOR
*                                      VSAM DATA SET                 */
*   RFY                                                            0070
*     GPR15F RSTD;                                                 0070
*   SUBCODE=GPR15F;                 /* SAVE THE RETURN CODE          */
         ST    GPR15F,SUBCODE                                      0071
*   RFY                                                            0072
*     GPR15F UNRSTD;                                               0072
*   IF SUBCODE^=F0C THEN            /* TEST FOR IDCAMS ERROR         */
         L     @10,SUBCODE                                         0073
         LTR   @10,@10                                             0073
         BZ    @RF00073                                            0073
*     DO;                           /* IDCAMS ERROR                  */
*       STATCODE=F3C;               /* IDCAMS ERROR                  */
         MVC   STATCODE(4),@CF00105                                0075
*       IF SUBCODE<ERROR THEN       /* TEST FOR WARNING              */
         C     @10,@CF00048                                        0076
         BNL   @RF00076                                            0076
*         RETCODE=SUBCODE;          /* SET TO SUBCODE                */
         ST    @10,RETCODE                                         0077
*       ELSE                                                       0078
*         RETCODE=ERROR;            /* FORCE ERROR TO CALLER         */
         B     @RC00076                                            0078
@RF00076 MVC   RETCODE(4),@CF00048                                 0078
*       DO;                         /* BLSDMSG                     0079
*                                      (ZZ2,F3111C,DMCBMSG,BLSDMSGS)
*                                      INSERT(MODNAME,DMCBMODL)      */
@RC00076 DS    0H                                                  0080
*         IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT      */
         LA    @10,IOPTLIST+12                                     0080
         ST    @10,IOPTLIST                                        0080
*         IOPTLIST(2)=ADDR(MODNAME);/* INSERT NAME POINTER           */
         LA    @10,MODNAME                                         0081
         ST    @10,IOPTLIST+4                                      0081
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0082
         ST    @10,IOPTLIST+8                                      0082
*         RFY                                                      0083
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(MODNAME);    /* INSERT LENGTH                 */
         LA    @04,8                                               0084
         LA    @15,IOPTLIST+8                                      0084
         STH   @04,I015F(,@15)                                     0084
*         IOPTLIST(4)=0;            /* LAST INSERT                   */
         ST    @10,IOPTLIST+12                                     0085
*         IOPTLIST(5)=ADDR(DMCBMODL);/* INSERT NAME POINTER          */
         LA    @15,DMCBMODL(,DMCBPTR)                              0086
         ST    @15,IOPTLIST+16                                     0086
*         IOPTLIST(6)=0;            /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0087
*         RFY                                                      0088
*           I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2       */
*         I015F=LENGTH(DMCBMODL);   /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+20                                     0089
         STH   @04,I015F(,@10)                                     0089
*         CALL BLSDMSG0(ZZ2,F3111C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(
*             IOPTLIST));           /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0090
         ST    @10,@AL00001                                        0090
         LA    @10,@CF00348                                        0090
         ST    @10,@AL00001+4                                      0090
         LA    @10,DMCBMSG(,DMCBPTR)                               0090
         ST    @10,@AL00001+8                                      0090
         L     @10,DMCBMSGS(,DMCBPTR)                              0090
         ST    @10,@AL00001+12                                     0090
         LA    @10,@CB00398                                        0090
         ST    @10,@AL00001+16                                     0090
         LA    @10,IOPTLIST                                        0090
         ST    @10,@AFTEMPS                                        0090
         LA    @10,@AFTEMPS                                        0090
         ST    @10,@AL00001+20                                     0090
         L     @15,DMCBMSG0(,DMCBPTR)                              0090
         LA    @01,@AL00001                                        0090
         BALR  @14,@15                                             0090
*       END;                        /* BLSDMSG                     0091
*                                      (ZZ2,F3111C,DMCBMSG,BLSDMSGS)
*                                      INSERT(MODNAME,DMCBMODL) BUILD
*                                      ERROR MESSAGE                 */
*       CALL BLSCHOK(DMCB,DMCBMSG,OUHEAD);/* APPEND IDCAMS SYSPRINT
*                                      TO MESSAGE LIST               */
         ST    DMCBPTR,@AL00001                                    0092
         LA    @10,DMCBMSG(,DMCBPTR)                               0092
         ST    @10,@AL00001+4                                      0092
         LA    @10,OUHEAD                                          0092
         ST    @10,@AL00001+8                                      0092
         L     @15,@CV00242                                        0092
         LA    @01,@AL00001                                        0092
         BALR  @14,@15                                             0092
*     END;                          /* IDCAMS ERROR                  */
*   ELSE                                                           0094
*     DO;                           /* IDCAMS OK                     */
*                                                                  0094
         B     @RC00073                                            0094
@RF00073 DS    0H                                                  0095
*       /*************************************************************/
*       /*                                                           */
*       /* IDCAMS OK, FREEMAIN IN-CORE SYSPRINT RECORDS              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0095
*       OUPTR=OUHEAD;               /* HEAD OF SYSPRINT RECORD LIST  */
         L     @10,OUHEAD                                          0095
         ST    @10,OUPTR                                           0095
*       DO WHILE OUPTR^=F0C;        /* LOOP THRU SYSPRINT RECORD LIST*/
         B     @DE00096                                            0096
@DL00096 DS    0H                                                  0097
*         OUHEAD=MSGWNXT;           /* UNHOOK THIS RECORD FROM LIST  */
         L     @10,OUPTR                                           0097
         L     @04,MSGWNXT(,@10)                                   0097
         ST    @04,OUHEAD                                          0097
*         OUFPTR=OUPTR-LENGTH(MSGDPRF);/* BASE MSGDENT FOR FREEMAIN  */
         SL    @10,@CF00048                                        0098
         LR    OUFPTR,@10                                          0098
*         DO;                       /* FREEMAIN(RC)                0099
*                                      LV(MSGDFLEN)A(MSGDENT)      0099
*                                      SP(MSGDSPID)                  */
*           RESPECIFY                                              0100
*            (GPR01F,                                              0100
*             GPR15F,                                              0100
*             GPR00F) RESTRICTED;                                  0100
*           GPR01F=0;               /* REG 1 MUST BE ZERO            */
         SLR   GPR01F,GPR01F                                       0101
*           GPR15F=1;               /* SET TYPE                      */
         LA    GPR15F,1                                            0102
*           GPR00F=MSGDFLEN;        /* LENGTH REQUESTED              */
         L     GPR00F,MSGDFLEN-1(,OUFPTR)                          0103
         ICM   GPR00F,8,@CB00379                                   0103
*           GPR01F=ADDR(MSGDENT);   /* SET REGISTER ONE              */
         LR    GPR01F,OUFPTR                                       0104
*           GPR15F=GPR15F+((MSGDSPID)*256);/* SUBPOOL VALUE          */
         SLR   @14,@14                                             0105
         IC    @14,MSGDSPID(,OUFPTR)                               0105
         SLA   @14,8                                               0105
         ALR   GPR15F,@14                                          0105
*           SVC(120);               /* RC/RU-FORM OF GETMAIN         */
         SVC   120                                                 0106
*           RESPECIFY                                              0107
*            (GPR01F,                                              0107
*             GPR15F,                                              0107
*             GPR00F) UNRESTRICTED;                                0107
*         END;                      /* FREEMAIN(RC)                0108
*                                      LV(MSGDFLEN)A(MSGDENT)      0108
*                                      SP(MSGDSPID) FREE THIS      0108
*                                      SYSPRINT RECORD               */
*         OUPTR=OUHEAD;             /* SET BASE TO NEXT SYSPRINT LINE*/
         L     @10,OUHEAD                                          0109
         ST    @10,OUPTR                                           0109
*       END;                        /* LOOP THRU SYSPRINT RECORD LIST*/
@DE00096 L     @10,OUPTR                                           0110
         LTR   @10,@10                                             0110
         BNZ   @DL00096                                            0110
*     END;                          /* IDCAMS OK                     */
*   RETURN;                                                        0112
*                                                                  0112
@EL00002 DS    0H                                                  0112
@EF00002 DS    0H                                                  0112
@ER00002 LM    @14,@12,@SA00002                                    0112
         BR    @14                                                 0112
*/* START OF SPECIFICATIONS*******************************************/
*/*                                                                  */
*/*   MODULE NAME:  LINKERR (BLSCLKR)                                */
*/*                                                                  */
*/*   DESCRIPTIVE NAME:  IPCS DAS LINK SVC ERROR RETURN ROUTINE      */
*/*                                                                  */
*/*   COPYRIGHT: NONE                                                */
*/*                                                                  */
*/*   STATUS: SU57 RELEASE 1, LEVEL 0                                */
*/*                                                                  */
*/*   FUNCTION:                                                      */
*/*     PROVIDE INCLUDED CODE FOR A LINK SVC ERROR RETURN THAT       */
*/*     PRODUCES MESSAGE BLS03110 AND HOOKS IT TO THE DMCBMSG        */
*/*     MESSAGE CHAIN ANCHOR.                                        */
*/*                                                                  */
*/*   NOTES:                                                         */
*/*                                                                  */
*/*     DEPENDENCIES:                                                */
*/*       THE FOLLOWING SYMBOLS MUST BE DEFINED IN THE ENCLOSING     */
*/*       PROCEDURE:                                                 */
*/*          RETCODE                                                 */
*/*          SUBCODE                                                 */
*/*          ERROR                                                   */
*/*          GPR01F                                                  */
*/*          GPR15F                                                  */
*/*          ABENDC                                                  */
*/*          REASON                                                  */
*/*          RESULT                                                  */
*/*          MODNAME                                                 */
*/*          LINKNAME                                                */
*/*          CHSTR88                                                 */
*/*          CHSTR847                                                */
*/*          CTEMP                                                   */
*/*          CTEMP18                                                 */
*/*          HEXTBL                                                  */
*/*          HEX0FC                                                  */
*/*          F3110C                                                  */
*/*                                                                  */
*/*     RESTRICTIONS:   NONE                                         */
*/*                                                                  */
*/*     REGISTER CONVENTIONS:                                        */
*/*       GPR01F - (1)                                               */
*/*       GPR15F - (15)                                              */
*/*                                                                  */
*/*     PATCH LABEL:  N/A                                            */
*/*                                                                  */
*/*     SERIALIZATION REQUIREMENTS: NONE                             */
*/*                                                                  */
*/*   MODULE TYPE:  INCLUDED EXECUTABLE CODE                         */
*/*                                                                  */
*/*     PROCESSOR: PLS/2                                             */
*/*                                                                  */
*/*     MODULE SIZE: N/A                                             */
*/*                                                                  */
*/*     ATTRIBUTES:                                                  */
*/*      EXECUTABLE          PROBLEM STATE      REENTRANT            */
*/*                                                                  */
*/*   ENTRY POINT:  LINKERR                                          */
*/*                                                                  */
*/*     PURPOSE:  SEE FUNCTION                                       */
*/*                                                                  */
*/*     LINKAGE:                                                     */
*/*       R01 LOADED WITH ABEND CODE                                 */
*/*       R15 LOADED WITH ABEND REASON CODE                          */
*/*                                                                  */
*/*     METHOD OF ACCESS:  SYSTEM LINK SVC ERRET                     */
*/*                                                                  */
*/*   INPUT:  SEE LINKAGE                                            */
*/*                                                                  */
*/*   OUTPUT:                                                        */
*/*      MESSAGE BLS03110 CHAINED FROM DMCBMSG IN IPCS DM/PM FORMAT. */
*/*      THE OUTPUT MESSAGE LIST FORMAT IS DESCRIBED IN THE BLSDMSG0 */
*/*      MODULE DESCRIPTION.                                         */
*/*                                                                  */
*/*   EXIT-NORMAL:  RETURN TO LINK SVC                               */
*/*     RETCODE = 8   MESSAGE BLS03110 IS ISSUED.                    */
*/*                                                                  */
*/*   EXIT-ERROR:  NONE                                              */
*/*                                                                  */
*/*   EXTERNAL REFERENCES:                                           */
*/*                                                                  */
*/*     ROUTINES:                                                    */
*/*       BLSDMSG0      IPCS DM/PM MESSAGE TEXT BUILD FUNCTION       */
*/*                                                                  */
*/*     DATA AREAS: SEE SYMBOLS DEFINED UNDER DEPENDENCIES           */
*/*                                                                  */
*/*     CONTROL BLOCKS: DMCB      R,W                                */
*/*                     BLSDMSGS  R                                  */
*/*                     ZZ2       R                                  */
*/*                                                                  */
*/*   TABLES/WORKAREAS: NONE                                         */
*/*                                                                  */
*/*   MACROS: BLSDMSG                                                */
*/*                                                                  */
*/*   CHANGE ACTIVITY:                                               */
*/*     THIS MODULE IS WRITTEN FOR @G57LPSR.                         */
*/*                                                                  */
*/*   MESSAGES ISSUED:                                               */
*/*        BLS03110I LINK SVC TO LINKNAME FROM MODNAME FAILED.       */
*/*                  ABEND CODE=XXXXXXXX, REASON CODE=YYYYYYYY       */
*/*                                                                  */
*/*   ABEND CODES:  NONE                                             */
*/*                                                                  */
*/*   DATA SETS ACCESSED:  NONE                                      */
*/*                                                                  */
*/*** END OF SPECIFICATIONS*******************************************/
*                                                                  0113
*LINKERR:                                                          0113
*   RFY                                                            0113
*    (GPR01F,                                                      0113
*     GPR15F) RSTD;                                                0113
LINKERR  DS    0H                                                  0114
*   ABENDC=GPR01F;                  /* SAVE THE ABEND CODE           */
         LR    ABENDC,GPR01F                                       0114
*   REASON=GPR15F;                  /* SAVE THE ABEND REASON CODE    */
         LR    REASON,GPR15F                                       0115
*   RFY                                                            0116
*    (GPR01F,                                                      0116
*     GPR15F) UNRSTD;                                              0116
*   CHSTR847=ABENDC;                /* GET ABEND CODE FIELD          */
         STCM  ABENDC,15,CHSTR847                                  0117
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0118
*   UNPK(CTEMP,CHSTR8);                                            0119
         UNPK  CTEMP(9),CHSTR8(8)                                  0119
*   TR(CTEMP,HEXTBL);                                              0120
         TR    CTEMP(9),HEXTBL                                     0120
*   RESULT=CTEMP18;                 /* STORE THE RESULT              */
         MVC   RESULT(8),CTEMP18                                   0121
*   CHSTR847=REASON;                /* GET REASON CODE FIELD         */
         STCM  REASON,15,CHSTR847                                  0122
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */
         MVI   CHSTR88,X'0F'                                       0123
*   UNPK(CTEMP,CHSTR8);                                            0124
         UNPK  CTEMP(9),CHSTR8(8)                                  0124
*   TR(CTEMP,HEXTBL);                                              0125
         TR    CTEMP(9),HEXTBL                                     0125
*   DO;                             /* BLSDMSG                     0126
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)
*                                      INSERT(LINKNAME,MODNAME,RESULT
*                                      ,CTEMP18)                     */
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */
         LA    @10,IOPTLIST+12                                     0127
         ST    @10,IOPTLIST                                        0127
*     IOPTLIST(2)=ADDR(LINKNAME);   /* INSERT NAME POINTER           */
         LA    @10,@CC00367                                        0128
         ST    @10,IOPTLIST+4                                      0128
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0129
         ST    @10,IOPTLIST+8                                      0129
*     RFY                                                          0130
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(LINKNAME);       /* INSERT LENGTH                 */
         LA    @04,8                                               0131
         LA    @15,IOPTLIST+8                                      0131
         STH   @04,I015F(,@15)                                     0131
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */
         LA    @15,IOPTLIST+24                                     0132
         ST    @15,IOPTLIST+12                                     0132
*     IOPTLIST(5)=ADDR(MODNAME);    /* INSERT NAME POINTER           */
         LA    @15,MODNAME                                         0133
         ST    @15,IOPTLIST+16                                     0133
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0134
*     RFY                                                          0135
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(MODNAME);        /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+20                                     0136
         STH   @04,I015F(,@15)                                     0136
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */
         LA    @15,IOPTLIST+36                                     0137
         ST    @15,IOPTLIST+24                                     0137
*     IOPTLIST(8)=ADDR(RESULT);     /* INSERT NAME POINTER           */
         LA    @15,RESULT                                          0138
         ST    @15,IOPTLIST+28                                     0138
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+32                                     0139
*     RFY                                                          0140
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */
*     I015F=LENGTH(RESULT);         /* INSERT LENGTH                 */
         LA    @15,IOPTLIST+32                                     0141
         STH   @04,I015F(,@15)                                     0141
*     IOPTLIST(10)=0;               /* LAST INSERT                   */
         ST    @10,IOPTLIST+36                                     0142
*     IOPTLIST(11)=ADDR(CTEMP18);   /* INSERT NAME POINTER           */
         LA    @15,CTEMP18                                         0143
         ST    @15,IOPTLIST+40                                     0143
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+44                                     0144
*     RFY                                                          0145
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */
*     I015F=LENGTH(CTEMP18);        /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+44                                     0146
         STH   @04,I015F(,@10)                                     0146
*     CALL BLSDMSG0(ZZ2,F3110C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0147
*         IOPTLIST));               /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0147
         ST    @10,@AL00001                                        0147
         LA    @10,@CF00346                                        0147
         ST    @10,@AL00001+4                                      0147
         LA    @10,DMCBMSG(,DMCBPTR)                               0147
         ST    @10,@AL00001+8                                      0147
         L     @10,DMCBMSGS(,DMCBPTR)                              0147
         ST    @10,@AL00001+12                                     0147
         LA    @10,@CB00398                                        0147
         ST    @10,@AL00001+16                                     0147
         LA    @10,IOPTLIST                                        0147
         ST    @10,@AFTEMPS                                        0147
         LA    @10,@AFTEMPS                                        0147
         ST    @10,@AL00001+20                                     0147
         L     @15,DMCBMSG0(,DMCBPTR)                              0147
         LA    @01,@AL00001                                        0147
         BALR  @14,@15                                             0147
*   END;                            /* BLSDMSG                     0148
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)
*                                      INSERT(LINKNAME,MODNAME,RESULT
*                                      ,CTEMP18) BUILD LINK SVC ERROR
*                                      MESSAGE                       */
*   RETCODE=ERROR;                  /* MARK ERROR TO CALLER          */
         MVC   RETCODE(4),@CF00048                                 0149
*   END INVAMS;                     /* INVOKE IDCAMS TO FREE SPACE 0150
*                                      FOR DATA SET                  */
         B     @EL00002                                            0150
         EJECT
*                                                                  0151
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO BUILD IDCAMS SYSIN STREAM                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0151
*BLDSTR:                                                           0151
*   PROCEDURE(BLDSTRP,PLISTA);      /* BUILD IDCAMS SYSIN STREAM     */
BLDSTR   STM   @14,@12,@SA00003                                    0151
         MVC   @PC00003(8),0(@01)                                  0151
*   DCL                                                            0152
*     BLDSTRP PTR(31),              /* PASSED TEXT RECORD STREAM PTR */
*     PLISTA CHAR(*),               /* PASSED FREE KEYWORD PARM LIST */
*     MAMSLP PTR(31),               /* WORK TEXT RECORD STREAM PTR   */
*     MVLEN FIXED(31),              /* MODEL SYSIN TEXT MOVE LENGTH  */
*     RECLEN BIN(31),               /* LENGTH OF INREC               */
*     PLEN BIN(31),                 /* PASSWORD LENGTH               */
*     PPTR PTR(31),                 /* PASSWORD BASE TEMP            */
*     DSWITCH BIT(1);               /* FOUND DATA SET NAME MODEL PARM*/
         SPACE 2
*   PLEN=F0C;                       /* INIT PASSWORD LENGTH TO NO  0153
*                                      PASSWORD                      */
         SLR   @10,@10                                             0153
         ST    @10,PLEN                                            0153
*   PPTR=F0C;                       /* INIT PASSWORD BASE TO NO    0154
*                                      PASSWORD                      */
         ST    @10,PPTR                                            0154
*   CALL PASSPARM(PLISTA,PLEN,PPTR);/* OBTAIN PASSWORD IF PRESENT    */
         L     @10,@PC00003+4                                      0155
         ST    @10,@AL00001                                        0155
         LA    @10,PLEN                                            0155
         ST    @10,@AL00001+4                                      0155
         LA    @10,PPTR                                            0155
         ST    @10,@AL00001+8                                      0155
         LA    @01,@AL00001                                        0155
         BAL   @14,PASSPARM                                        0155
*   IF RETCODE=F0C THEN             /* TEST FOR FREE PARMLIST ERROR  */
         L     @10,RETCODE                                         0156
         LTR   @10,@10                                             0156
         BNZ   @RF00156                                            0156
*     DO;                           /* PARMLIST OK                   */
*       DSWITCH=OFF;                /* INIT DATA SET MODEL PARM FOUND
*                                      SWITCH NOT FOUND              */
         NI    DSWITCH,B'01111111'                                 0158
*       MAMSLP=BLDSTRP;             /* HEAD OF AMS TEXT RECORD STREAM*/
         L     @10,@PC00003                                        0159
         L     MAMSLP,BLDSTRP(,@10)                                0159
*       RFY                                                        0160
*         MMAMSREC BASED(MAMSLP);   /* BASE THE MODEL AMS TEXT RECORD
*                                      MAP                           */
*       MVLEN=MMAMSLEN;             /* INIT RECORD LENGTH            */
         SLR   MVLEN,MVLEN                                         0161
         ICM   MVLEN,3,MMAMSLEN(MAMSLP)                            0161
*       DO WHILE MVLEN>F0C&RETCODE=F0C;/* LOOP THRU IDCAMS TEXT    0162
*                                      RECORDS                       */
         B     @DE00162                                            0162
@DL00162 DS    0H                                                  0163
*         RECLEN=MAX(LENGTH(INRECF),MVLEN);/* LENGTH OF INREC        */
         LA    RECLEN,68                                           0163
         CR    RECLEN,MVLEN                                        0163
         BNL   *+6
         LR    RECLEN,MVLEN                                        0163
*         DO;                       /* GETMAIN (RC) LV(RECLEN+F4C) 0164
*                                      SP(DMCBSPID) RTCD(SUBCODE)    */
*           RESPECIFY                                              0165
*            (GPR01F,                                              0165
*             GPR15F,                                              0165
*             GPR00F) RESTRICTED;                                  0165
*           GPR01F=0;               /* REG 1 MUST BE ZERO            */
         SLR   GPR01F,GPR01F                                       0166
*           GPR15F=0;               /* RC-TYPE GETMAIN               */
         SLR   GPR15F,GPR15F                                       0167
*           GPR00F=RECLEN+F4C;      /* LENGTH REQUESTED              */
         LA    GPR00F,4                                            0168
         ALR   GPR00F,RECLEN                                       0168
*           GPR15F=GPR15F×((DMCBSPID)*256);/* SP IN BYTE 2           */
         SLR   @14,@14                                             0169
         IC    @14,DMCBSPID(,DMCBPTR)                              0169
         SLA   @14,8                                               0169
         OR    GPR15F,@14                                          0169
*           SVC(120);               /* RC/RU-FORM OF GETMAIN         */
         SVC   120                                                 0170
*           SUBCODE=GPR15F;         /* SET RETURN CODE               */
         ST    GPR15F,SUBCODE                                      0171
*           RESPECIFY                                              0172
*            (GPR01F,                                              0172
*             GPR15F,                                              0172
*             GPR00F) UNRESTRICTED;                                0172
*         END;                      /* GETMAIN (RC) LV(RECLEN+F4C) 0173
*                                      SP(DMCBSPID) RTCD(SUBCODE)  0173
*                                      SPACE FOR TEXT LINE           */
*         RFY                                                      0174
*           GPR01P RSTD;                                           0174
*         INPTR=GPR01P;             /* ADDRESS OF TEXT LINE          */
         ST    GPR01P,INPTR                                        0175
*         RFY                                                      0176
*           GPR01P UNRSTD;                                         0176
*         IF SUBCODE^=F0C THEN      /* TEST FOR GETMAIN ERROR        */
         L     @10,SUBCODE                                         0177
         LTR   @10,@10                                             0177
         BZ    @RF00177                                            0177
*           DO;                     /* GETMAIN FAILED                */
*             RETCODE=ERROR;        /* NOTIFY CALLER                 */
         MVC   RETCODE(4),@CF00048                                 0179
*             CALL BLSCGMF(DMCB,DMCBMSG,MODNAME);/* BUILD GETMAIN  0180
*                                      FAILURE MESSAGE               */
         ST    DMCBPTR,@AL00001                                    0180
         LA    @10,DMCBMSG(,DMCBPTR)                               0180
         ST    @10,@AL00001+4                                      0180
         LA    @10,MODNAME                                         0180
         ST    @10,@AL00001+8                                      0180
         L     @15,@CV00241                                        0180
         LA    @01,@AL00001                                        0180
         BALR  @14,@15                                             0180
*           END;                    /* GETMAIN FAILED                */
*         ELSE                                                     0182
*           DO;                     /* GETMAIN OK                    */
         B     @RC00177                                            0182
@RF00177 DS    0H                                                  0183
*             IF INHEAD=F0C THEN    /* TEST FOR FIRST ENTRY          */
         L     @10,INHEAD                                          0183
         LTR   @10,@10                                             0183
         BNZ   @RF00183                                            0183
*               INHEAD=INPTR;       /* INIT TEXT LIST HEADER         */
         L     @10,INPTR                                           0184
         ST    @10,INHEAD                                          0184
*             ELSE                                                 0185
*               DO;                 /* NOT FIRST SYSIN TEXT LINE     */
         B     @RC00183                                            0185
@RF00183 DS    0H                                                  0186
*                 INTAIL->INNEXT=INPTR;/* HOOK THIS LINE TO LIST     */
         L     @10,INPTR                                           0186
         L     @09,INTAIL                                          0186
         ST    @10,INNEXT(,@09)                                    0186
*               END;                /* NOT FIRST SYSIN TEXT LINE     */
*             INTAIL=INPTR;         /* END OF LIST                   */
@RC00183 L     @10,INPTR                                           0188
         ST    @10,INTAIL                                          0188
*             INNEXT=F0C;           /* MARK END OF LIST              */
         SLR   @09,@09                                             0189
         ST    @09,INNEXT(,@10)                                    0189
*             INRECF=LBLNKC;        /* BLANK THE SYSIN TEXT RECORD 0190
*                                      AREA                          */
         MVI   INRECF+1(@10),C' '                                  0190
         MVC   INRECF+2(66,@10),INRECF+1(@10)                      0190
         MVI   INRECF(@10),C' '                                    0190
*             INREC(F1C:MVLEN)=MMAMSREC(F1C:MVLEN);/* MOVE RECORD TO
*                                      SYSIN LIST                    */
         LR    @09,MVLEN                                           0191
         BCTR  @09,0                                               0191
         EX    @09,@SM00506                                        0191
*             INLEN=RECLEN;         /* FORCE CORRECT LENGTH FOR    0192
*                                      FREEMAIN                      */
         STH   RECLEN,INLEN(,@10)                                  0192
*             CALL SCANRP(PLEN,PPTR,DSWITCH);/* SEARCH FOR IDCAMS  0193
*                                      MODEL PARAMETERS TO BE      0193
*                                      OVERRIDDEN            @ZA32131*/
         LA    @10,PLEN                                            0193
         ST    @10,@AL00001                                        0193
         LA    @10,PPTR                                            0193
         ST    @10,@AL00001+4                                      0193
         LA    @10,DSWITCH                                         0193
         ST    @10,@AL00001+8                                      0193
         LA    @01,@AL00001                                        0193
         BAL   @14,SCANRP                                          0193
*             MAMSLP=MAMSLP+MVLEN;  /* BUMP MODEL RECORD BASE        */
         ALR   MAMSLP,MVLEN                                        0194
*             MVLEN=MMAMSLEN;       /* NEW RECORD LENGTH             */
         SLR   MVLEN,MVLEN                                         0195
         ICM   MVLEN,3,MMAMSLEN(MAMSLP)                            0195
*           END;                    /* GETMAIN OK                    */
*       END;                        /* LOOP THRU IDCAMS TEXT RECORDS */
@RC00177 DS    0H                                                  0197
@DE00162 SLR   @10,@10                                             0197
         CR    MVLEN,@10                                           0197
         BNH   @DC00162                                            0197
         C     @10,RETCODE                                         0197
         BE    @DL00162                                            0197
@DC00162 DS    0H                                                  0198
*       IF DSWITCH=OFF THEN         /* TEST DATA SET MODEL PARM NOT
*                                      FOUND                         */
         TM    DSWITCH,B'10000000'                                 0198
         BNZ   @RF00198                                            0198
*         DO;                       /* ABEND(F130C) DUMP USER        */
*           RESPECIFY                                              0200
*            (GPR01F) RESTRICTED;                                  0200
*           GPR01F=(F130C)&'00000FFF'X;/* COMP CODE IN BITS 20-31    */
         LA    GPR01F,130                                          0201
*           GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */
         O     GPR01F,@CF00386                                     0202
*           SVC(13);                /* ISSUE ABEND SVC               */
         SVC   13                                                  0203
*           RESPECIFY                                              0204
*            (GPR01F) UNRESTRICTED;                                0204
*         END;                      /* ABEND(F130C) DUMP USER DATA 0205
*                                      SET MODEL PARM NOT FOUND      */
*     END;                          /* PARMLIST OK                   */
*   END BLDSTR;                     /* BUILD IDCAMS SYSIN STREAM     */
@EL00003 DS    0H                                                  0207
@EF00003 DS    0H                                                  0207
@ER00003 LM    @14,@12,@SA00003                                    0207
         BR    @14                                                 0207
         EJECT
*                                                                  0208
*   /*****************************************************************/
*   /*                                                               */
*   /* OBTAIN PASSWORD PARAMETER FROM LIST                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0208
*PASSPARM:                                                         0208
*   PROCEDURE(PLISTB,PLENA,PPTRA);                                 0208
PASSPARM STM   @14,@12,@SA00004                                    0208
         MVC   @PC00004(12),0(@01)                                 0208
*   DCL                                                            0209
*     PLISTB CHAR(*),               /* PASSED FREE KEYWORD PARM LIST */
*     PLENA BIN(31),                /* PASSWORD LENGTH               */
*     PPTRA PTR(31);                /* PASSWORD BASE TEMP            */
         SPACE 2
*   ALBAS=ADDR(PLISTB);             /* BASE THE PARM LIST            */
         L     ALBAS,@PC00004                                      0210
*   IF ALPTR^=F0C THEN              /* TEST FOR OVERRIDE PARM LIST 0211
*                                      EXISTENCE                     */
         L     @10,ALPTR(,ALBAS)                                   0211
         LTR   @10,@10                                             0211
         BZ    @RF00211                                            0211
*     DO;                           /* PARM LIST EXISTS              */
*       ALSW=OFF;                   /* INIT LOOP SWITCH              */
         NI    ALSW,B'01111111'                                    0213
*       DO WHILE ALSW=OFF;          /* LOOP THROUGH PARM LIST        */
         B     @DE00214                                            0214
@DL00214 DS    0H                                                  0215
*         ALOPT=ALOP&LHEX7FC;       /* MASK LAST ENTRY BIT FROM KEY
*                                      CODE                          */
         LA    ALOPT,127                                           0215
         SLR   @10,@10                                             0215
         IC    @10,ALOP(,ALBAS)                                    0215
         NR    ALOPT,@10                                           0215
*         IF ALOPT=DISPOP THEN      /* TEST FOR DISP PARAMETER       */
         C     ALOPT,@CF00052                                      0216
         BNE   @RF00216                                            0216
*           DO;                     /* DISP PARAMETER                */
*             IF ALPRB4F1=F0C THEN  /* TEST FOR INDIRECT DISP PARM   */
         CLI   ALPRB4F1(ALBAS),0                                   0218
         BNE   @RF00218                                            0218
*               ALBAS=ALBAS+F4C;    /* INDIRECT DISP PARM            */
         AL    ALBAS,@CF00041                                      0219
*           END;                    /* DISP PARAMETER                */
*         ELSE                                                     0221
*           IF ALOPT=PASSOP THEN    /* TEST FOR PASSWORD PARAMETER   */
         B     @RC00216                                            0221
@RF00216 C     ALOPT,@CF00355                                      0221
         BNE   @RF00221                                            0221
*             DO;                   /* PASSWORD PARAMETER            */
*               CALL PASSPROC(PLENA,PPTRA);/* GET PASSWORD POINTER   */
         L     @10,@PC00004+4                                      0223
         ST    @10,@AL00001                                        0223
         L     @10,@PC00004+8                                      0223
         ST    @10,@AL00001+4                                      0223
         LA    @01,@AL00001                                        0223
         BAL   @14,PASSPROC                                        0223
*             END;                  /* PASSWORD PARAMETER            */
*           ELSE                                                   0225
*             DO;                   /* INVALID PARAMETER KEY CODE    */
         B     @RC00221                                            0225
@RF00221 DS    0H                                                  0226
*               CHSTR867=ALOPT;     /* GET KEY FIELD                 */
         STCM  ALOPT,3,CHSTR867                                    0226
*               CHSTR88=LHEX0FC;    /* TRANSLATE IT TO CHARACTER HEX */
         MVI   CHSTR88,X'0F'                                       0227
*               UNPK(CTEMP,CHSTR8);                                0228
         UNPK  CTEMP(9),CHSTR8(8)                                  0228
*               TR(CTEMP,HEXTBL);                                  0229
         TR    CTEMP(9),HEXTBL                                     0229
*               DO;                 /* BLSDMSG                     0230
*                                      (ZZ2,F3117C,DMCBMSG,BLSDMSGS)
*                                      INSERT(MODNAME,CTEMP72)       */
*                 IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT   0231
*                                      INSERT                        */
         LA    @10,IOPTLIST+12                                     0231
         ST    @10,IOPTLIST                                        0231
*                 IOPTLIST(2)=ADDR(MODNAME);/* INSERT NAME POINTER   */
         LA    @10,MODNAME                                         0232
         ST    @10,IOPTLIST+4                                      0232
*                 IOPTLIST(3)=0;    /* ZERO RESERVED FIELD           */
         SLR   @10,@10                                             0233
         ST    @10,IOPTLIST+8                                      0233
*                 RFY                                              0234
*                   I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 0234
*                                      1-2                           */
*                 I015F=LENGTH(MODNAME);/* INSERT LENGTH             */
         LA    @04,IOPTLIST+8                                      0235
         MVC   I015F(2,@04),@CH00048                               0235
*                 IOPTLIST(4)=0;    /* LAST INSERT                   */
         ST    @10,IOPTLIST+12                                     0236
*                 IOPTLIST(5)=ADDR(CTEMP72);/* INSERT NAME POINTER   */
         LA    @04,CTEMP72                                         0237
         ST    @04,IOPTLIST+16                                     0237
*                 IOPTLIST(6)=0;    /* ZERO RESERVED FIELD           */
         ST    @10,IOPTLIST+20                                     0238
*                 RFY                                              0239
*                   I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 0239
*                                      1-2                           */
*                 I015F=LENGTH(CTEMP72);/* INSERT LENGTH             */
         LA    @10,IOPTLIST+20                                     0240
         MVC   I015F(2,@10),@CH00076                               0240
*                 CALL BLSDMSG0(ZZ2,F3117C,DMCBMSG,BLSDMSGS,'00000000'B
*                     ,ADDR(IOPTLIST));/* BUILD MESSAGE              */
         L     @10,DMCBTVP(,DMCBPTR)                               0241
         ST    @10,@AL00001                                        0241
         LA    @10,@CF00350                                        0241
         ST    @10,@AL00001+4                                      0241
         LA    @10,DMCBMSG(,DMCBPTR)                               0241
         ST    @10,@AL00001+8                                      0241
         L     @10,DMCBMSGS(,DMCBPTR)                              0241
         ST    @10,@AL00001+12                                     0241
         LA    @10,@CB00398                                        0241
         ST    @10,@AL00001+16                                     0241
         LA    @10,IOPTLIST                                        0241
         ST    @10,@AFTEMPS+4                                      0241
         LA    @10,@AFTEMPS+4                                      0241
         ST    @10,@AL00001+20                                     0241
         L     @15,DMCBMSG0(,DMCBPTR)                              0241
         LA    @01,@AL00001                                        0241
         BALR  @14,@15                                             0241
*               END;                /* BLSDMSG                     0242
*                                      (ZZ2,F3117C,DMCBMSG,BLSDMSGS)
*                                      INSERT(MODNAME,CTEMP72) BUILD
*                                      ERROR MESSAGE                 */
*               ALSW=ON;            /* SET END OF LOOP               */
         OI    ALSW,B'10000000'                                    0243
*               RETCODE=ERROR;      /* MARK ERROR                    */
         MVC   RETCODE(4),@CF00048                                 0244
*               DO;                 /* ABEND(110) DUMP USER          */
*                 RESPECIFY                                        0246
*                  (GPR01F) RESTRICTED;                            0246
*                 GPR01F=(110)&'00000FFF'X;/* COMP CODE IN BITS 20-31*/
         LA    GPR01F,110                                          0247
*                 GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS  0248
*                                      FLAG                          */
         O     GPR01F,@CF00386                                     0248
*                 SVC(13);          /* ISSUE ABEND SVC               */
         SVC   13                                                  0249
*                 RESPECIFY                                        0250
*                  (GPR01F) UNRESTRICTED;                          0250
*               END;                /* ABEND(110) DUMP USER INTERNAL
*                                      ERROR                         */
*             END;                  /* INVALID PARAMETER KEY CODE    */
*         IF ALSW=ON×               /* TEST FOR TERMINATE LOOP       */
*             ALVL=ON THEN          /* TEST FOR LAST LIST ELEMENT    */
@RC00221 DS    0H                                                  0253
@RC00216 TM    ALSW,B'10000000'                                    0253
         BO    @RT00253                                            0253
         TM    ALVL(ALBAS),B'10000000'                             0253
         BNO   @RF00253                                            0253
@RT00253 DS    0H                                                  0254
*           DO;                     /* LAST LIST ELEMENT             */
*             ALSW=ON;              /* TERMINATE LIST PROCESSING     */
         OI    ALSW,B'10000000'                                    0255
*           END;                    /* LAST LIST ELEMENT             */
*         ELSE                                                     0257
*           ALBAS=ALBAS+F4C;        /* SET UP FOR NEXT PLIST ENTRY   */
         B     @RC00253                                            0257
@RF00253 AL    ALBAS,@CF00041                                      0257
*       END;                        /* LOOP THROUGH PARM LIST        */
@RC00253 DS    0H                                                  0258
@DE00214 TM    ALSW,B'10000000'                                    0258
         BZ    @DL00214                                            0258
*     END;                          /* PARM LIST EXISTS              */
*   END PASSPARM;                                                  0260
@EL00004 DS    0H                                                  0260
@EF00004 DS    0H                                                  0260
@ER00004 LM    @14,@12,@SA00004                                    0260
         BR    @14                                                 0260
         EJECT
*                                                                  0261
*   /*****************************************************************/
*   /*                                                               */
*   /* INTERNAL PROCEDURE TO OBTAIN THE PASSWORD POINTER             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0261
*PASSPROC:                                                         0261
*   PROCEDURE(MLEN,PPTRB);                                         0261
PASSPROC STM   @14,@01,@SA00005                                    0261
         STM   @03,@12,@SA00005+16                                 0261
         MVC   @PC00005(8),0(@01)                                  0261
*   DCL                                                            0262
*     MLEN BIN(31),                 /* PASSWORD LENGTH               */
*     PPTRB PTR(31);                /* PASSWORD BASE TEMP            */
*   DCL                                                            0263
*     PASSWKY CHAR(8) CONSTANT('PASSWORD'),/* ERROR MESSAGE VALUE    */
*     LIM BIN(31) CONSTANT(8);      /* MAX VALID PASSWORD LENGTH     */
         SPACE 2
*   ALBAS=ALBAS+F4C;                /* BUMP PLIST BASE TO PARM LENGTH
*                                      ADDR                          */
         LA    @10,4                                               0264
         ALR   ALBAS,@10                                           0264
*   MLEN=ALPTF31;                   /* GET PASSWORD LENGTH           */
         L     @04,@PC00005                                        0265
         L     @03,ALPTR(,ALBAS)                                   0265
         L     @03,ALPTF31(,@03)                                   0265
         ST    @03,MLEN(,@04)                                      0265
*   ALBAS=ALBAS+F4C;                /* BUMP ALPARM BASE TO GET PTR TO
*                                      VL PARM FIELD                 */
         ALR   ALBAS,@10                                           0266
*   IF MLEN^=F0C THEN               /* TEST FOR NON-NULL PARAMETER   */
         SLR   @10,@10                                             0267
         CR    @03,@10                                             0267
         BE    @RF00267                                            0267
*     DO;                           /* LENGTH IS NOT EQUAL ZERO      */
*       IF MLEN<0×MLEN>LIM THEN     /* TEST FOR INVALID PARM LENGTH  */
         CR    @03,@10                                             0269
         BL    @RT00269                                            0269
         C     @03,@CF00048                                        0269
         BNH   @RF00269                                            0269
@RT00269 DS    0H                                                  0270
*         DO;                       /* INVALID PARAMETER LENGTH      */
*           CHSTR847=MLEN;          /* GET PARAMETER LENGTH FIELD    */
         L     @10,@PC00005                                        0271
         MVC   CHSTR847(4),MLEN(@10)                               0271
*           CHSTR88=LHEX0FC;        /* TRANSLATE FIELD TO CHAR HEX   */
         MVI   CHSTR88,X'0F'                                       0272
*           UNPK(CTEMP,CHSTR8);                                    0273
         UNPK  CTEMP(9),CHSTR8(8)                                  0273
*           TR(CTEMP,HEXTBL);                                      0274
         TR    CTEMP(9),HEXTBL                                     0274
*           DO;                     /* BLSDMSG                     0275
*                                      (ZZ2,F3119C,DMCBMSG,BLSDMSGS)
*                                      INSERT(PASSWKY,MODNAME,PASSWKY
*                                      ,(ALPTCVL,LIM),CTEMP63)       */
*             IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT  */
         LA    @10,IOPTLIST+12                                     0276
         ST    @10,IOPTLIST                                        0276
*             IOPTLIST(2)=ADDR(PASSWKY);/* INSERT NAME POINTER       */
         LA    @10,@CC00456                                        0277
         ST    @10,IOPTLIST+4                                      0277
*             IOPTLIST(3)=0;        /* ZERO RESERVED FIELD           */
         SLR   @04,@04                                             0278
         ST    @04,IOPTLIST+8                                      0278
*             RFY                                                  0279
*               I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2   */
*             I015F=LENGTH(PASSWKY);/* INSERT LENGTH                 */
         LA    @03,8                                               0280
         LA    @15,IOPTLIST+8                                      0280
         STH   @03,I015F(,@15)                                     0280
*             IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT  */
         LA    @15,IOPTLIST+24                                     0281
         ST    @15,IOPTLIST+12                                     0281
*             IOPTLIST(5)=ADDR(MODNAME);/* INSERT NAME POINTER       */
         LA    @15,MODNAME                                         0282
         ST    @15,IOPTLIST+16                                     0282
*             IOPTLIST(6)=0;        /* ZERO RESERVED FIELD           */
         ST    @04,IOPTLIST+20                                     0283
*             RFY                                                  0284
*               I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2   */
*             I015F=LENGTH(MODNAME);/* INSERT LENGTH                 */
         LA    @15,IOPTLIST+20                                     0285
         STH   @03,I015F(,@15)                                     0285
*             IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT */
         LA    @15,IOPTLIST+36                                     0286
         ST    @15,IOPTLIST+24                                     0286
*             IOPTLIST(8)=ADDR(PASSWKY);/* INSERT NAME POINTER       */
         ST    @10,IOPTLIST+28                                     0287
*             IOPTLIST(9)=0;        /* ZERO RESERVED FIELD           */
         ST    @04,IOPTLIST+32                                     0288
*             RFY                                                  0289
*               I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2   */
*             I015F=LENGTH(PASSWKY);/* INSERT LENGTH                 */
         LA    @10,IOPTLIST+32                                     0290
         STH   @03,I015F(,@10)                                     0290
*             IOPTLIST(10)=ADDR(IOPTLIST(13));/* CHAIN TO NEXT INSERT*/
         LA    @10,IOPTLIST+48                                     0291
         ST    @10,IOPTLIST+36                                     0291
*             IOPTLIST(11)=ADDR(ALPTCVL);/* INSERT NAME POINTER      */
         L     @10,ALPTR(,ALBAS)                                   0292
         ST    @10,IOPTLIST+40                                     0292
*             IOPTLIST(12)=0;       /* ZERO RESERVED FIELD           */
         ST    @04,IOPTLIST+44                                     0293
*             RFY                                                  0294
*               I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2  */
*             I015F=LIM;            /* INSERT LENGTH                 */
         LA    @10,IOPTLIST+44                                     0295
         STH   @03,I015F(,@10)                                     0295
*             IOPTLIST(13)=0;       /* LAST INSERT                   */
         ST    @04,IOPTLIST+48                                     0296
*             IOPTLIST(14)=ADDR(CTEMP63);/* INSERT NAME POINTER      */
         LA    @10,CTEMP63                                         0297
         ST    @10,IOPTLIST+52                                     0297
*             IOPTLIST(15)=0;       /* ZERO RESERVED FIELD           */
         ST    @04,IOPTLIST+56                                     0298
*             RFY                                                  0299
*               I015F BASED(ADDR(IOPTLIST(15)));/* ACCESS BYTES 1-2  */
*             I015F=LENGTH(CTEMP63);/* INSERT LENGTH                 */
         LA    @10,IOPTLIST+56                                     0300
         MVC   I015F(2,@10),@CH00105                               0300
*             CALL BLSDMSG0(ZZ2,F3119C,DMCBMSG,BLSDMSGS,'00000000'B,
*                 ADDR(IOPTLIST));  /* BUILD MESSAGE                 */
         L     @10,DMCBTVP(,DMCBPTR)                               0301
         ST    @10,@AL00001                                        0301
         LA    @10,@CF00352                                        0301
         ST    @10,@AL00001+4                                      0301
         LA    @10,DMCBMSG(,DMCBPTR)                               0301
         ST    @10,@AL00001+8                                      0301
         L     @10,DMCBMSGS(,DMCBPTR)                              0301
         ST    @10,@AL00001+12                                     0301
         LA    @10,@CB00398                                        0301
         ST    @10,@AL00001+16                                     0301
         LA    @10,IOPTLIST                                        0301
         ST    @10,@AFTEMPS+8                                      0301
         LA    @10,@AFTEMPS+8                                      0301
         ST    @10,@AL00001+20                                     0301
         L     @15,DMCBMSG0(,DMCBPTR)                              0301
         LA    @01,@AL00001                                        0301
         BALR  @14,@15                                             0301
*           END;                    /* BLSDMSG                     0302
*                                      (ZZ2,F3119C,DMCBMSG,BLSDMSGS)
*                                      INSERT(PASSWKY,MODNAME,PASSWKY
*                                      ,(ALPTCVL,LIM),CTEMP63) BUILD
*                                      INVALID PASSWORD LENGTH MSG   */
*           RETCODE=ERROR;          /* MARK ERROR                    */
         MVC   RETCODE(4),@CF00048                                 0303
*           ALSW=ON;                /* TERMINATE LIST PROCESSING     */
         OI    ALSW,B'10000000'                                    0304
*           MLEN=F0C;               /* MARK PASSWORD LENGTH NULL     */
         L     @10,@PC00005                                        0305
         SLR   @04,@04                                             0305
         ST    @04,MLEN(,@10)                                      0305
*           DO;                     /* ABEND(110) DUMP USER          */
*             RESPECIFY                                            0307
*              (GPR01F) RESTRICTED;                                0307
*             GPR01F=(110)&'00000FFF'X;/* COMP CODE IN BITS 20-31    */
         LA    GPR01F,110                                          0308
*             GPR01F=GPR01F×'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG   */
         O     GPR01F,@CF00386                                     0309
*             SVC(13);              /* ISSUE ABEND SVC               */
         SVC   13                                                  0310
*             RESPECIFY                                            0311
*              (GPR01F) UNRESTRICTED;                              0311
*           END;                    /* ABEND(110) DUMP USER INTERNAL
*                                      ERROR                         */
*         END;                      /* INVALID PARAMETER LENGTH      */
*       ELSE                                                       0314
*         DO;                       /* VALID PARAMETER LENGTH        */
         B     @RC00269                                            0314
@RF00269 DS    0H                                                  0315
*           PPTRB=ALBAS;            /* REMEMBER THE BASE POINTER     */
         L     @10,@PC00005+4                                      0315
         ST    ALBAS,PPTRB(,@10)                                   0315
*         END;                      /* VALID PARAMETER LENGTH        */
*     END;                          /* LENGTH IS NOT EQUAL TO ZERO   */
*   END PASSPROC;                   /* END INTERNAL PROCEDURE        */
@EL00005 DS    0H                                                  0318
@EF00005 DS    0H                                                  0318
@ER00005 LM    @14,@01,@SA00005                                    0318
         LM    @03,@12,@SA00005+16                                 0318
         BR    @14                                                 0318
         EJECT
*                                                                  0319
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE TO SCAN IDCAMS MODEL PARAMETER FOR OVERRIDE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0319
*SCANRP:                                                           0319
*   PROCEDURE(PLENC,PPTRC,DSWITCHC);                               0319
SCANRP   STM   @14,@12,12(@13)                                     0319
         MVC   @PC00006(12),0(@01)                                 0319
*   DCL                                                            0320
*     PLENC BIN(31),                /* PASSWORD LENGTH               */
*     PPTRC PTR(31),                /* PASSWORD BASE TEMP            */
*     DSWITCHC BIT(1);              /* FOUND DATA SET NAME MODEL PARM*/
*   DCL                                                            0321
*     LSLSHC CHAR(3) CONSTANT(' / ');/* IDCAMS PASSWORD DELIMITER    */
*   DCL                                                            0322
*     LDENDC CHAR(2) CONSTANT(' -');/* IDCAMS DELETE LINE END        */
*   DCL                                                            0323
*     L12345C CHAR(6) CONSTANT(' 12345');/* IDCAMS VERB              */
*   DCL                                                            0324
*     1 DELTXT DEF(INTEXT),         /* DELETE OVERRIDE MAP           */
*      2 * CHAR(1),                 /* BYTE 1                        */
*      2 DELVAL CHAR(44),           /* DATA SET NAME                 */
*      2 DELSLSH CHAR(LENGTH(LSLSHC)),/* OPTIONAL SLASH TEXT         */
*      2 DELPASS CHAR(8),           /* PASSWORD (OPTIONAL)           */
*      2 DELEND CHAR(LENGTH(LDENDC));/* LINE END TEXT                */
*   DCL                                                            0325
*     DELTYP CHAR(LENGTH(L12345C)) DEF(DELTXT);/* DELETE VERB FIELD  */
         SPACE 1
*   IF DELTYP=L12345C THEN          /* TEST FOR DELETE VERB          */
         L     @10,INPTR                                           0326
         CLC   DELTYP(6,@10),@CC00483                              0326
         BNE   @RF00326                                            0326
*     DO;                           /* BUILD DELETE TEXT RECORD      */
*       DELVAL=DMCBDSN;             /* MOVE IN DATA SET NAME         */
         MVC   DELVAL(44,@10),DMCBDSN(DMCBPTR)                     0328
*       IF PLENC>F0C THEN           /* TEST FOR PASSWORD PRESENT     */
         SLR   @04,@04                                             0329
         L     @15,@PC00006                                        0329
         L     @14,PLENC(,@15)                                     0329
         CR    @14,@04                                             0329
         BNH   @RF00329                                            0329
*         DO;                       /* PASSWORD PRESENT              */
*           ALBAS=PPTRC;            /* SET PASSWORD BASE POINTER     */
         L     @09,@PC00006+4                                      0331
         L     ALBAS,PPTRC(,@09)                                   0331
*           DELSLSH=LSLSHC;         /* SET PASSWORD DELIMETER        */
         MVC   DELSLSH(3,@10),@CC00479                             0332
*           DELPASS(F1C:PLENC)=ALPTCVL(F1C:PLENC);/* MOVE IN PASSWORD*/
         BCTR  @14,0                                               0333
         L     @03,ALPTR(,ALBAS)                                   0333
         EX    @14,@SM00509                                        0333
*           ALBAS=F0C;              /* CLEAN UP BEHIND US            */
         SLR   ALBAS,ALBAS                                         0334
*           PPTRC=F0C;              /* CLEAN UP BEHIND US            */
         ST    @04,PPTRC(,@09)                                     0335
*           PLENC=F0C;              /* CLEAN UP BEHIND US            */
         ST    @04,PLENC(,@15)                                     0336
*           DELEND=LDENDC;          /* MOVE IN LINE END              */
         MVC   DELEND(2,@10),@CC00481                              0337
*         END;                      /* PASSWORD PRESENT      @ZA32131*/
*       DSWITCHC=ON;                /* MARK DATA SET MODEL PARM FOUND*/
@RF00329 L     @10,@PC00006+8                                      0339
         OI    DSWITCHC(@10),B'10000000'                           0339
*     END;                          /* BUILD DELETE TEXT RECORD      */
*   END SCANRP;                                                    0341
@EL00006 DS    0H                                                  0341
@EF00006 DS    0H                                                  0341
@ER00006 LM    @14,@12,12(@13)                                     0341
         BR    @14                                                 0341
         EJECT
*                                                                  0342
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0342
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                     0342
*     GPR01F FIXED(31) REG(1),                                     0342
*     GPR15F FIXED(31) REG(15),                                    0342
*     GPR01P PTR(31) REG(1),                                       0342
*     GPR15P PTR(31) REG(15);                                      0342
*   DCL                                                            0343
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */
*      2 I00602 PTR(24),            /* EP/DE PTR                     */
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */
*      2 I00604 PTR(24),            /* DCB PTR                       */
*      2 I00605 PTR(31);            /* ERRET PTR                     */
*   DECLARE                                                        0344
*     ILIST CHAR(12) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0345
*     I031F FIXED(31) BASED,                                       0345
*     I031P PTR(31) BASED,                                         0345
*     I015F FIXED(15) BASED,                                       0345
*     I015P PTR(15) BASED,                                         0345
*     I008P PTR(8) BASED,                                          0345
*     I001C CHAR(1) BASED;                                         0345
*   DECLARE                                                        0346
*     IOPTLIST(15) PTR(31) BDY(WORD);/* OPTION LIST ARRAY            */
*   DCL                                                            0347
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0347
*   GEN DATA DEFS(HEXTBL);                                         0348
*   END BLSCFAMS                                                   0349
*                                                                  0349
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (BLSDMSGD)                                       */
*/*%INCLUDE SYSLIB  (BLSCAMCB)                                       */
*/*%INCLUDE SYSLIB  (BLSCLKR )                                       */
*                                                                  0349
*       ;                                                          0349
@EL00001 L     @13,4(,@13)                                         0349
@EF00001 L     @00,@SIZDATD                                        0349
         LR    @01,@11                                             0349
         BLSCFREF R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0349
         BR    @14                                                 0349
@DATA    DS    0H
@SM00506 MVC   INREC(0,@10),MMAMSREC(MAMSLP)
@SM00509 MVC   DELPASS(0,@10),ALPTCVL(@03)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@SA00003 DS    15F
@PC00003 DS    2F
@SA00002 DS    15F
@SA00004 DS    15F
@PC00004 DS    3F
@PC00006 DS    3F
@SA00005 DS    14F
@PC00005 DS    2F
@AL00001 DS    6A
@AFTEMPS DS    4F
BLSCFAMS CSECT
         DS    0F
@CF00076 DC    F'2'
@CH00076 EQU   @CF00076+2
@CF00105 DC    F'3'
@CH00105 EQU   @CF00105+2
@CF00041 DC    F'4'
@CF00052 DC    F'5'
@CF00048 DC    F'8'
@CH00048 EQU   @CF00048+2
@CF00355 DC    F'80'
@CF00346 DC    F'3110'
@CF00348 DC    F'3111'
@CF00350 DC    F'3117'
@CF00352 DC    F'3119'
@CF00386 DC    XL4'80000000'
@DATD    DSECT
         DS    0D
PLEN     DS    F
PPTR     DS    A
MODSTAT  DS    CL20
         ORG   MODSTAT
MODNAME  DS    CL8
RETCODE  DS    FL4
STATCODE DS    FL4
SUBCODE  DS    FL4
         ORG   MODSTAT+20
ALSW     DS    BL1
         DS    CL3
CHSTR8   DS    CL8
         ORG   CHSTR8
@NM00002 DS    CL3
CHSTR847 DS    CL4
         ORG   CHSTR847
@NM00003 DS    CL2
CHSTR867 DS    CL2
         ORG   CHSTR8+7
CHSTR88  DS    CL1
         ORG   CHSTR8+8
CTEMP    DS    CL9
         ORG   CTEMP
CTEMP18  DS    CL8
         ORG   CTEMP18
@NM00004 DS    CL5
CTEMP63  DS    CL3
         ORG   CTEMP63
@NM00005 DS    CL1
CTEMP72  DS    CL2
         ORG   CTEMP+9
RESULT   DS    CL8
         DS    CL3
BLSCAMCB DS    CL96
         ORG   BLSCAMCB
MCBOPTL  DS    CL4
MCBDNAML DS    CL4
MCBPNL   DS    CL4
MCBIOL   DS    CL28
MCBINCB  DS    CL24
MCBOUCB  DS    CL24
MCBINPTR DS    AL4
MCBOUPTR DS    AL4
         ORG   BLSCAMCB+96
DSWITCH  DS    BL1
         DS    CL3
ILIST    DS    CL12
IOPTLIST DS    15A
BLSCFAMS CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00239 DC    V(BLSCAMIN)
@CV00240 DC    V(BLSCAMPR)
@CV00241 DC    V(BLSCGMF)
@CV00242 DC    V(BLSCHOK)
@CV00243 DC    V(BLSCFMSM)
         DS    0D
@CC00323 DC    C'DDSYSIN   '
@CC00326 DC    C'DDSYSPRINT'
@CC00367 DC    C'IDCAMS  '
@CC00369 DC    C'BLSCFAMS'
@CC00456 DC    C'PASSWORD'
@CC00483 DC    C' 12345'
@CC00479 DC    C' / '
@CC00481 DC    C' -'
@CB00379 DC    X'00'
@CB00398 DC    B'00000000'
         DS    CL7
DASPATCH DS    CL80
         ORG   DASPATCH
DASPATA  DC    20A(0)
         ORG   DASPATCH+80
BLSCFAMS CSECT
*                         /*
HEXTBL   EQU   *-240
         DC    CL16'0123456789ABCDEF'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
BLSCFAMS CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RECLEN   EQU   @08
MVLEN    EQU   @06
MAMSLP   EQU   @07
REASON   EQU   @04
ABENDC   EQU   @06
ALOPT    EQU   @03
ALBAS    EQU   @02
OUFPTR   EQU   @05
DMCBPTR  EQU   @05
GPR01P   EQU   @01
GPR15P   EQU   @15
GPR15F   EQU   @15
GPR01F   EQU   @01
GPR00F   EQU   @00
DMCB     EQU   0
DMCBTVP  EQU   DMCB+8
DMCBFTY  EQU   DMCB+20
DMCBOPN  EQU   DMCB+21
DMCBRMOD EQU   DMCB+23
DMCBOUT  EQU   DMCBRMOD
DMCBOPTS EQU   DMCB+24
DMCBGKY  EQU   DMCBOPTS
DMCBMFLG EQU   DMCB+28
DMCBBUFP EQU   DMCB+32
DMCBKEYP EQU   DMCB+44
DMCBMSG  EQU   DMCB+52
DMCBRI   EQU   DMCB+64
DMCBMSG0 EQU   DMCB+68
DMCBMSGS EQU   DMCB+72
DMCBSPID EQU   DMCB+84
DMCBFRE  EQU   DMCB+88
DMCBEOB  EQU   DMCB+92
DMCBACBE EQU   DMCB+124
DMCBDSN  EQU   DMCB+284
DMCBMODL EQU   DMCB+348
DMCBSPEC EQU   DMCB+380
DMCBAMS  EQU   DMCB+416
DMCBAUDT EQU   DMCB+568
DMCBLSCP EQU   DMCBAUDT+16
MMAMSREC EQU   0
MMAMSLEN EQU   MMAMSREC
MSGDENT  EQU   0
MSGDPRF  EQU   MSGDENT
MSGDSPID EQU   MSGDPRF
MSGDFLEN EQU   MSGDPRF+1
MSGDWRT  EQU   MSGDENT+8
MSGDMOV  EQU   MSGDWRT+4
MSGWENT  EQU   0
MSGWNXT  EQU   MSGWENT
MSGWMOV  EQU   MSGWENT+4
ALPTR    EQU   0
ALOP     EQU   ALPTR
ALVL     EQU   ALOP
ALPRB4C1 EQU   ALPTR+3
ALPRB4F1 EQU   ALPRB4C1
ALPTF31  EQU   0
ALPTCVL  EQU   0
BLSDMSGS EQU   0
BLSDMSG0 EQU   0
ZZ2      EQU   0
INENT    EQU   0
INNEXT   EQU   INENT
INLEN    EQU   INENT+4
INTEXT   EQU   INENT+8
OUENT    EQU   0
I015F    EQU   0
DMCBDMGR EQU   0
DMCBRQC  EQU   0
I001C    EQU   0
I008P    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
DMCBPARM EQU   0
PLIST    EQU   0
BLDSTRP  EQU   0
PLISTA   EQU   0
PLISTB   EQU   0
PLENA    EQU   0
PPTRA    EQU   0
MLEN     EQU   0
PPTRB    EQU   0
PLENC    EQU   0
PPTRC    EQU   0
DSWITCHC EQU   0
DMCBVSM  EQU   DMCBAMS
DMCBQSM  EQU   DMCBAMS
OUPTR    EQU   MCBOUPTR
AMSOPTL  EQU   MCBOPTL
OPTLLEN  EQU   AMSOPTL
AMSDNAML EQU   MCBDNAML
DNAMLLEN EQU   AMSDNAML
AMSPNL   EQU   MCBPNL
PNLLEN   EQU   AMSPNL
AMSIOL   EQU   MCBIOL
IOLNUM   EQU   AMSIOL
IOLINDDP EQU   AMSIOL+4
IOLMINP  EQU   AMSIOL+8
IOLINCBP EQU   AMSIOL+12
IOLOUDDP EQU   AMSIOL+16
IOLMPRP  EQU   AMSIOL+20
IOLOUCBP EQU   AMSIOL+24
INCB     EQU   MCBINCB
INHEAD   EQU   INCB
INCUR    EQU   INCB+4
INTAIL   EQU   INCB+8
OUCB     EQU   MCBOUCB
OUHEAD   EQU   OUCB
OUCUR    EQU   OUCB+4
OUTAIL   EQU   OUCB+8
INPTR    EQU   MCBINPTR
INREC    EQU   INENT+4
INRECF   EQU   INENT+4
I006     EQU   ILIST
I00601   EQU   I006
I00602   EQU   I006+1
I00603   EQU   I006+4
I00604   EQU   I006+5
I00605   EQU   I006+8
DELTXT   EQU   INTEXT
DELVAL   EQU   DELTXT+1
DELSLSH  EQU   DELTXT+45
DELPASS  EQU   DELTXT+48
DELEND   EQU   DELTXT+56
DELTYP   EQU   DELTXT
OUREC    EQU   OUENT+4
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00007 EQU   DELTXT
INTXTF   EQU   INRECF+4
@NM00006 EQU   INRECF
OURESV01 EQU   OUCB+20
OUECODE  EQU   OUCB+16
OURCODE  EQU   OUCB+12
INRESV01 EQU   INCB+20
INECODE  EQU   INCB+16
INRCODE  EQU   INCB+12
PNLTXT   EQU   AMSPNL+2
DNAMLENT EQU   AMSDNAML+2
OPTLTXT  EQU   AMSOPTL+2
DMCBRES7 EQU   DMCBQSM+96
DMCBDCB  EQU   DMCBQSM
DMCBACB  EQU   DMCBVSM+76
DMCBRPL  EQU   DMCBVSM
OUTEXT   EQU   OUENT+8
OUPAD    EQU   OUENT+6
OULEN    EQU   OUENT+4
OUNEXT   EQU   OUENT
INPAD    EQU   INENT+6
@NM00001 EQU   ALPTR+1
MSGWTXT  EQU   MSGWMOV+4
MSGWPAD  EQU   MSGWMOV+2
MSGWLEN  EQU   MSGWMOV
MSGDTXT  EQU   MSGDMOV+4
MSGDPAD  EQU   MSGDMOV+2
MSGDLEN  EQU   MSGDMOV
MSGDNXT  EQU   MSGDWRT
MSGDBAK  EQU   MSGDPRF+4
MMAMSTXT EQU   MMAMSREC+4
MMAMSPAD EQU   MMAMSREC+2
DMCBWRK  EQU   DMCB+648
DMCBRES8 EQU   DMCB+640
DMCBMODN EQU   DMCB+632
DMCBCARY EQU   DMCBAUDT+20
DMCBCLC  EQU   DMCBAUDT+12
DMCBOPC  EQU   DMCBAUDT+8
DMCBFRC  EQU   DMCBAUDT+4
DMCBALC  EQU   DMCBAUDT
DMCBFR   EQU   DMCB+412
DMCBRES6 EQU   DMCB+410
DMCBIRSC EQU   DMCB+408
DMCBSUBC EQU   DMCB+404
DMCBDRBP EQU   DMCB+400
DMCBRSZM EQU   DMCB+398
DMCBRSZA EQU   DMCB+396
DMCBCISZ EQU   DMCB+394
DMCBDCBL EQU   DMCB+392
DMCBDCLR EQU   DMCB+390
DMCBDCFM EQU   DMCB+389
DMCBRES5 EQU   DMCB+388
DMCBLBRT EQU   DMCB+386
DMCBLBSQ EQU   DMCB+384
DMCBLBPS EQU   DMCB+383
DMCBLBTY EQU   DMCB+382
DMCBRES4 EQU   DMCB+381
DMCBSPRS EQU   DMCBSPEC
DMCBSPRN EQU   DMCBSPEC
DMCBSPCT EQU   DMCBSPEC
DMCBSPRL EQU   DMCBSPEC
DMCBSPSE EQU   DMCB+376
DMCBSPPR EQU   DMCB+372
DMCBSPTY EQU   DMCB+369
DMCBODIS EQU   DMCB+368
DMCBDISP EQU   DMCB+367
DMCBSTAT EQU   DMCB+366
DMCBRES3 EQU   DMCB+364
DMCBMEMB EQU   DMCB+356
DMCBRES9 EQU   DMCB+340
DMCBPID  EQU   DMCB+332
DMCBTYPE EQU   DMCB+328
DMCBUNIT EQU   DMCB+276
DMCBDSOR EQU   DMCB+274
DMCBVOL  EQU   DMCB+268
DMCBDDNM EQU   DMCB+260
DMCBSYNM EQU   DMCB+132
DMCBRPLF EQU   DMCB+128
DMCBDCBE EQU   DMCBACBE
DMCBARC  EQU   DMCB+120
DMCBCPC  EQU   DMCB+116
DMCBRET  EQU   DMCB+112
DMCBSTL  EQU   DMCB+96
DMCBRES2 EQU   DMCB+85
DMCBRESC EQU   DMCB+80
DMCBZZ1P EQU   DMCB+76
DMCBRRL  EQU   DMCB+60
DMCBRBA  EQU   DMCB+56
DMCBKEYL EQU   DMCB+48
DMCBKPC  EQU   DMCBKEYP
DMCBORL  EQU   DMCB+40
DMCBBLEN EQU   DMCB+36
DMCBBFPC EQU   DMCBBUFP
DMCBRES1 EQU   DMCB+31
DMCBACCM EQU   DMCB+30
DMCBREJ  EQU   DMCB+29
DMCBRESB EQU   DMCBMFLG
DMCBFMOD EQU   DMCBMFLG
DMCBLOPT EQU   DMCB+27
DMCBLRM  EQU   DMCB+26
DMCBLRQ  EQU   DMCB+25
DMCBOPRS EQU   DMCBOPTS
DMCBLRD  EQU   DMCBOPTS
DMCBBWD  EQU   DMCBOPTS
DMCBUPD  EQU   DMCBOPTS
DMCBAPX  EQU   DMCBOPTS
DMCBRNO  EQU   DMCBGKY
DMCBKYD  EQU   DMCBOPTS
DMCBRMRS EQU   DMCBRMOD
DMCBRM5  EQU   DMCBRMOD
DMCBRM6  EQU   DMCBRMOD
DMCBTMP  EQU   DMCBOUT
DMCBRQST EQU   DMCB+22
DMCBRESA EQU   DMCBOPN
DMCBSOUT EQU   DMCBOPN
DMCBSIN  EQU   DMCBOPN
DMCBVSF  EQU   DMCBFTY
DMCBKSF  EQU   DMCBFTY
DMCBFTRS EQU   DMCBFTY
DMCBSHF  EQU   DMCBFTY
DMCBIRL  EQU   DMCB+16
DMCBRTC  EQU   DMCB+12
DMCBNEXT EQU   DMCB+4
DMCBID   EQU   DMCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00073 EQU   @EL00002
@RF00156 EQU   @EL00003
@RF00198 EQU   @EL00003
@RF00218 EQU   @RC00216
@RF00211 EQU   @EL00004
@RF00267 EQU   @EL00005
@RC00269 EQU   @EL00005
@RF00326 EQU   @EL00006
@ENDDATA EQU   *
         END   BLSCFAMS,(C'PLS1737',0701,78135)

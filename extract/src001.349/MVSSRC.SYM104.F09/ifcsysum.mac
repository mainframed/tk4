         TITLE 'IFCSYSUM-SYSTEM SUMMARY FOR EREP PROCESSING            *
                        '
IFCSYSUM CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCSYSUM  78.108'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  LA    @11,4095(,@10)                                      0001
         LA    @12,4095(,@11)                                      0001
         USING @PSTART,@10                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@12                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         B     @PB00002                                            0145
CONVBIN  STM   @14,@12,@SA00002                                    0145
* R8 = BINWORD;                  /*LOAD THE ITEM TO CONVERT  @Z427VLS*/
         L     R8,BINWORD                                          0146
* GEN(CVD   R8,DBLWORD);         /*CONVERT THE NUMBER        @Z427VLS*/
         CVD   R8,DBLWORD
* GEN(UNPK   WORK(8),DBLWORD);   /*UNPACK THE CONVERTED NUMBER       */
         UNPK   WORK(8),DBLWORD
* GEN(OI  WORK+7,X'F0');         /*MAKE SURE NO PROBLEM      @Z427VLS*/
         OI  WORK+7,X'F0'
* SWITCH4 = OFF;                 /*CLEAR THE SWITCH PRIOR TO START   */
         NI    SWITCH4,B'11101111'                                 0150
* DO L = 1 BY 1 TO 7 WHILE (SWITCH4 = OFF);                /*@Z427VLS*/
         LA    @03,1                                               0151
         ST    @03,L                                               0151
@DL00151 TM    SWITCH4,B'00010000'                                 0151
         BNZ   @DC00151                                            0151
*  IF WORKOVER(L)  = 'F0'X       /*IS IT A 0 IF SO MAKE IT A BLANK   */
*    THEN                                                          0152
         LA    @01,WORKOVER-1(@03)                                 0152
         CLI   0(@01),X'F0'                                        0152
         BNE   @RF00152                                            0152
*      WORKOVER(L) = '40'X;      /*SET TO A BLANK            @Z427VLS*/
         LA    @01,WORKOVER-1(@03)                                 0153
         MVI   0(@01),X'40'                                        0153
*    ELSE                                                          0154
*      SWITCH4 = ON;             /*SET SWITCH TO TERMINATE DO LOOP   */
         B     @RC00152                                            0154
@RF00152 OI    SWITCH4,B'00010000'                                 0154
* END;                                                     /*@Z427VLS*/
@RC00152 LA    @03,1                                               0155
         AL    @03,L                                               0155
         ST    @03,L                                               0155
         C     @03,@CF00080                                        0155
         BNH   @DL00151                                            0155
@DC00151 DS    0H                                                  0156
* IF (TEN   - L) > BNDECNUM      /*IS THE CONVERTED NUMBER TO LARGE  */
*    THEN                                                          0156
         L     @03,TEN                                             0156
         SL    @03,L                                               0156
         C     @03,BNDECNUM                                        0156
         BNH   @RF00156                                            0156
*      DO;                                                 /*@Z427VLS*/
*        GEN(MVI   WORKOVER,X'F9');  /*SET FIRST NINE IN THE MEASSAGE*/
         MVI   WORKOVER,X'F9'
*        GEN(MVC   WORKOVER+1(7),WORKOVER);/*FILL WITH NINES @Z427VLS*/
         MVC   WORKOVER+1(7),WORKOVER
*      END;                                                /*@Z427VLS*/
* R8 = ADDR(WORKOVER) + (8-BNDECNUM);/*SET WHERE TO MOVE FROM ADDRESS*/
@RF00156 LA    R8,WORKOVER                                         0161
         L     @03,BNDECNUM                                        0161
         LA    @15,8                                               0161
         SLR   @15,@03                                             0161
         ALR   R8,@15                                              0161
* R9 = BNDECNUM - ONE;           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/
         SL    @03,ONE                                             0162
         LR    R9,@03                                              0162
* RESPECIFY (R6) RESTRICTED;                               /*@Z427VLS*/
* R6 = DECADDR;                  /*ADDRESS TO MOVE TO        @Z427VLS*/
         L     R6,DECADDR                                          0164
* GEN(EX    R9,MVCINS);          /*MOVE DATA TO REQUESTED LOCATION   */
         EX    R9,MVCINS
* GENERATE DATA;                                           /*@Z427VLS*/
* RESPECIFY (R6) UNRESTRICTED;                             /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00002 DS    0H                                                  0168
@EF00002 DS    0H                                                  0168
@ER00002 LM    @14,@12,@SA00002                                    0168
         BR    @14                                                 0168
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL CONVERT THE HEX DATA INTO PRINTABLE    @Z427VLS*/
*/*                                                          @Z427VLS*/
*/*    IF IT IS NECESSARY TO CONVERT ONLY 1/2 OF FIRST BYTE(CUA FOR  */
*/*    EXP. THEN THE USER SHOULD SET THE SWITCH1 TO THEON CONDITION  */
*CONVERT: PROC;                                            /*@Z427VLS*/
CONVERT  STM   @14,@12,12(@13)                                     0169
* DO P = NUMBER BY -1 TO 1;      /*# = # OF BYTES TO CONVERT TO PRINT*/
         L     @03,NUMBER                                          0170
         ST    @03,P                                               0170
         B     @DE00170                                            0170
@DL00170 DS    0H                                                  0171
*   R8 = NEXTBYTE(P);            /*LOAD THE NEXT BYTE TO CONVERT     */
         L     @01,NEXTBY                                          0171
         BCTR  @01,0                                               0171
         SLR   R8,R8                                               0171
         IC    R8,NEXTBYTE(@03,@01)                                0171
*   X =  TWO * P;                /*OUTPUT INDEX MUST BE TWICE INPUT  */
         L     @01,TWO                                             0172
         MR    @00,@03                                             0172
         ST    @01,X                                               0172
*   SRDL  (R8,FOUR);             /*MOVE 1/2 IN TO NEXT REG   @Z427VLS*/
         SRDL  R8,4                                                0173
*   SRL   (R9,TWOEIGHT);         /*SHIFT THE REG 28 BITS     @Z427VLS*/
         L     @15,TWOEIGHT                                        0174
         SRL   R9,0(@15)                                           0174
*   R9  =  R9 + NUMBER1;         /*INSURE INDEX BY 0 DOES NOT AFFECT */
         L     @15,NUMBER1                                         0175
         ALR   R9,@15                                              0175
*   R8  =  R8 + NUMBER1;         /*SAME                      @Z427VLS*/
         ALR   R8,@15                                              0176
*   IF SWITCH1 = ON & P = ONE    /*DO WE NOT PUT THE HALF BYTE OUT   */
*    THEN                                                          0177
         TM    SWITCH1,B'10000000'                                 0177
         BNO   @RF00177                                            0177
         C     @03,ONE                                             0177
         BNE   @RF00177                                            0177
*     SWITCH1 = OFF;             /*TURN OFF THE SWITCH       @Z427VLS*/
         NI    SWITCH1,B'01111111'                                 0178
*    ELSE                                                          0179
*     ADDNUM(X-ONE) = CHARS(R8);/*PUT THE PRINT CHAR INTO THE OUTPUT*/
         B     @RC00177                                            0179
@RF00177 L     @03,X                                               0179
         SL    @03,ONE                                             0179
         L     @01,ADDNXT                                          0179
         ALR   @01,@03                                             0179
         BCTR  @01,0                                               0179
         LA    @03,CHARS-1(R8)                                     0179
         MVC   ADDNUM(1,@01),0(@03)                                0179
*     ADDNUM(X)  = CHARS(R9);   /*FINSH THE BYTE             @Z427VLS*/
@RC00177 L     @03,ADDNXT                                          0180
         AL    @03,X                                               0180
         BCTR  @03,0                                               0180
         LA    @01,CHARS-1(R9)                                     0180
         MVC   ADDNUM(1,@03),0(@01)                                0180
* END;                                                     /*@Z427VLS*/
         SLR   @03,@03                                             0181
         BCTR  @03,0                                               0181
         AL    @03,P                                               0181
         ST    @03,P                                               0181
@DE00170 LTR   @03,@03                                             0181
         BP    @DL00170                                            0181
*END;                                                      /*@Z427VLS*/
@EL00003 DS    0H                                                  0182
@EF00003 DS    0H                                                  0182
@ER00003 LM    @14,@12,12(@13)                                     0182
         BR    @14                                                 0182
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL FORMAT THE DATE OF THE RUN & THE START STOP    */
*/*    DATES OF THE DATA AND PRINT THE TOP THREE LINES OF THE HEADING*/
*/*    FOR THE PART-1 OUTPUT                                 @Z427VLS*/
*/*                                                          @Z427VLS*/
*HEADING1:  PROC;                                          /*@Z427VLS*/
HEADING1 STM   @14,@12,@SA00004                                    0183
*  SPACING = UPSPACE;      /*SET FOR A NEW PAGE              @Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0184
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0185
*  SPACING = SINGLE;                                       /*@Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0186
*  DAYSDATE = DATENOW;     /*MOVE TODAYS DATE FROM PARM TABLE        */
         MVC   DAYSDATE(6),DATENOW(R2)                             0187
*  HEADMOVE= LINE1;        /*MOVE IN THE FIRST LINE OF THE HEADING   */
         MVC   HEADMOVE(59),LINE1                                  0188
*  CALL PRINTIT;           /*GO PRINT THE FIRST LINE OF THE HEADING  */
         BAL   @14,PRINTIT                                         0189
*  NUMBER = TWO;           /*SET UP TO CONVERT TWO BYTES OF DATA     */
         L     @03,TWO                                             0190
         ST    @03,NUMBER                                          0190
*  SRL(EVSDAY,FOUR);      /*DROP THE SIGN 1/2 BYTE           @Z427VLS*/
         LH    @03,EVSDAY(,R2)                                     0191
         N     @03,@CF00907                                        0191
         SRL   @03,4                                               0191
         STH   @03,EVSDAY(,R2)                                     0191
*  NEXTBY = ADDR(EVSDAY);  /*SET WHERE TO FIND THE DATA TO CONVERT   */
         LA    @03,EVSDAY(,R2)                                     0192
         ST    @03,NEXTBY                                          0192
*  ADDNXT = ADDR(FROMDATE)-1;/*  WHERE TO PUT THE CONVERTED TO PRINT */
         LA    @03,FROMDATE                                        0193
         BCTR  @03,0                                               0193
         ST    @03,ADDNXT                                          0193
*  SWITCH1 = ON;           /*SET SO WILL NOT CONVERT THE LAST 1/2 BYT*/
         OI    SWITCH1,B'10000000'                                 0194
*  CALL CONVERT;           /*GO AND CONVERT THE DATA TO PRINTABLE    */
         BAL   @14,CONVERT                                         0195
*  NUMBER = ONE;           /*SET UP TO CONVERT ONE BYTE  OF DATA     */
         L     @03,ONE                                             0196
         ST    @03,NUMBER                                          0196
*  NEXTBY = ADDR(EVSYEAR); /*SET WHERE TO FIND THE YEAR TO CONVERT   */
         LA    @03,EVSYEAR(,R2)                                    0197
         ST    @03,NEXTBY                                          0197
*  ADDNXT = ADDR(FROMYEAR);/*SET WHERE TO PUT CONVERTED YEAR @Z427VLS*/
         LA    @03,FROMYEAR                                        0198
         ST    @03,ADDNXT                                          0198
*  CALL CONVERT;           /*GO AND CONVERT THE YEAR TO PRINTABLE    */
         BAL   @14,CONVERT                                         0199
*  HEADMOVE= LINE2;        /*MOVE SECOND LINE OF THE HEADING INTO LNE*/
         MVC   HEADMOVE(59),LINE2                                  0200
*  CALL PRINTIT;           /*GO AND PRINT THE SECOND LINE OF HEADING */
         BAL   @14,PRINTIT                                         0201
*  SRL(EVDAY,FOUR);        /*HAVE TO SHIFT OUT THE F IN THE DAY      */
         L     @03,EVPTR(,R2)                                      0202
         SLR   @15,@15                                             0202
         ICM   @15,3,EVDAY(@03)                                    0202
         SRL   @15,4                                               0202
         STCM  @15,3,EVDAY(@03)                                    0202
*  NEXTBY = ADDR(EVDAY);   /*SET UP ADDRESS OF THE LAST DAY OF INPUT */
         LA    @03,EVDAY(,@03)                                     0203
         ST    @03,NEXTBY                                          0203
*  ADDNXT = ADDR(TODATE)-1;/*WHERE TO PUT THE CONVERTED DAY  @Z427VLS*/
         LA    @03,TODATE                                          0204
         BCTR  @03,0                                               0204
         ST    @03,ADDNXT                                          0204
*  SWITCH1 = ON;           /*AS DAY IS 3 BYTES SET TO DROP 1/2 BYTE  */
         OI    SWITCH1,B'10000000'                                 0205
*  NUMBER = TWO;           /*SET TO PROCESS TWO BYTES OF DATA        */
         L     @03,TWO                                             0206
         ST    @03,NUMBER                                          0206
*  CALL CONVERT;           /*GO AND CONVERT THE DAY TO PRINTABLE     */
         BAL   @14,CONVERT                                         0207
*  NUMBER = ONE;           /*SET UP FOR ONE BYTE IN 2 OUT IN PRINTABL*/
         L     @03,ONE                                             0208
         ST    @03,NUMBER                                          0208
*  ADDNXT = ADDR(TOYEAR);  /*ADDRESS OF WHERE TO PUT CONVERTED DATA  */
         LA    @03,TOYEAR                                          0209
         ST    @03,ADDNXT                                          0209
*  NEXTBY = ADDR(EVYEAR);  /*ADDRESS OF WHERE THE DATA TO CONVERT IS */
         L     @03,EVPTR(,R2)                                      0210
         ST    @03,NEXTBY                                          0210
*  CALL CONVERT;           /*GO CONVERT THE DATA TO PRINTABLE        */
         BAL   @14,CONVERT                                         0211
*  HEADMOVE= LINE3;        /*MOVE THE LAST HEADING TO PRINT BUFFER   */
         MVC   HEADMOVE(59),LINE3                                  0212
*  CALL PRINTIT;           /*GO AND PRINT THE LAST LINE      @Z427VLS*/
         BAL   @14,PRINTIT                                         0213
*  SPACING= DOUBLE;        /*SPACE THE PAGE UP 3 LINES       @Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0214
*  CALL PRINTIT;           /*GO UPSPACE THE PRINTABLE        @Z427VLS*/
         BAL   @14,PRINTIT                                         0215
*  R9 =SIX * EVNUM + FIVE; /*SET UP NUMBER OF CHARS/CPU + TOTAL      */
         L     @03,EVPTR(,R2)                                      0216
         L     R9,SIX                                              0216
         MH    R9,EVNUM(,@03)                                      0216
         AL    R9,FIVE                                             0216
*  R8 = ADDR(TOTAHED);                                     /*@Z427VLS*/
         LA    R8,TOTAHED                                          0217
*  RESPECIFY (R6) RESTRICTED;                              /*@Z427VLS*/
*  R6 = ADDR(PRTLINE) + 20;                                /*@Z427VLS*/
         LA    R6,PRTLINE                                          0219
         AL    R6,@CF00719                                         0219
*  RESPECIFY (R6) UNRESTRICTED;                            /*@Z427VLS*/
*  GEN(EX   R9,MOVETOTL);  /*EXEC MOVE CHAR R9 = # OF CHARS TO MOVE  */
         EX   R9,MOVETOTL
*  CALL PRINTIT;           /*GO PRINT THE LINE WITH TOTAL & CPU-A ETC*/
         BAL   @14,PRINTIT                                         0222
*  SPACING= SINGLE;        /*GO BACK TO SINGLE SPACING       @Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0223
*  GENERATE DATA;                                          /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00004 DS    0H                                                  0225
@EF00004 DS    0H                                                  0225
@ER00004 LM    @14,@12,@SA00004                                    0225
         BR    @14                                                 0225
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*   THIS PROC WILL CONTROL THE OUTPUT FOR PART-1 BY CALLING PROCS  */
*/*   TO PROCESS EACH DIFFERENT SECTION OF THE REPORT        @Z427VLS*/
*/*                                                          @Z427VLS*/
*TOTAL1:  PROC;                                            /*@Z427VLS*/
TOTAL1   STM   @14,@12,@SA00005                                    0226
* ADDRSAVE = SYSUMPTR;       /*SAVE ADDRESS OF THE FIRST TABLE       */
         L     ADDRSAVE,SYSUMPTR(,R2)                              0227
* CALL IPLWORK;                /*GO FORMAT CONVERT AND PRINT IPL DATA*/
         BAL   @14,IPLWORK                                         0228
* CALL MCHWORK;                /*GO PROCESS INFO ABOUT MCH RECORDS   */
         BAL   @14,MCHWORK                                         0229
* CALL CCHWORK;                /*GO PROCESS CCH TYPE DATA    @Z427VLS*/
         BAL   @14,CCHWORK                                         0230
* CALL PROGERR;               /*HANDLE SOFTWARE DATA         @Z427VLS*/
         BAL   @14,PROGERR                                         0231
* CALL EODWORK;                /*GO PROCESS EOD RECORDS IF ANY       */
         BAL   @14,EODWORK                                         0232
* CALL PRT1TOT;                /*PRINT THE TOTAL FOR ALL     @Z427VLS*/
         BAL   @14,PRT1TOT                                         0233
* IF DEBUG21 = ON THEN         /*REQUESTING HEX-DUMP OF PART 1 INFO  */
         TM    DEBUG21(R2),B'00000100'                             0234
         BNO   @RF00234                                            0234
*  DO;                                                     /*@Z427VLS*/
*   DDTYPE = 'F1'X;           /*MOVE OUTPUT TO TOURIST  DD   @Z427VLS*/
         MVI   DDTYPE,X'F1'                                        0236
*   DO I = 1 BY 1 TO NUMTODO;                              /*@Z427VLS*/
         LA    @15,1                                               0237
         ST    @15,I                                               0237
         B     @DE00237                                            0237
@DL00237 DS    0H                                                  0238
*    ADDNXT = ADDR(PRTLINE);  /*ADDRESS OF WHERE TO PUT OUTPUT       */
         LA    @15,PRTLINE                                         0238
         ST    @15,ADDNXT                                          0238
*    NEXTBY = SYSUMPTR;       /*WHERE THE DATA IS TO HEX DUMP        */
         L     @15,SYSUMPTR(,R2)                                   0239
         ST    @15,NEXTBY                                          0239
*    NUMBER = 52;             /*HAD TO STOP SOMEWHERE TO MANY FOR 1  */
         MVC   NUMBER(4),@CF00820                                  0240
*    CALL CONVERT;            /*SET UP CORE DATA FOR PRINTING        */
         BAL   @14,CONVERT                                         0241
*    CALL PRINTIT;            /*PRINT THE FIRST LINE         @Z427VLS*/
         BAL   @14,PRINTIT                                         0242
*    NEXTBY = NEXTBY + 52;    /*MOVE POINTER PAST ALREADY DONE DATA  */
         LA    @15,52                                              0243
         AL    @15,NEXTBY                                          0243
         ST    @15,NEXTBY                                          0243
*    NUMBER = 48;             /*SET UP TO PRINT REST OF TABLE        */
         MVC   NUMBER(4),@CF00821                                  0244
*    CALL CONVERT;            /*GO CONVERT DATA TO PRINTABLE @Z427VLS*/
         BAL   @14,CONVERT                                         0245
*    CALL PRINTIT;                                         /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0246
*    SYSUMPTR = SYSUMNXT;     /*SET ADDRESSABILITY FOR NEXT TABLE    */
         L     @01,SYSUMPTR(,R2)                                   0247
         L     @15,SYSUMNXT(,@01)                                  0247
         ST    @15,SYSUMPTR(,R2)                                   0247
*   END;                                                   /*@Z427VLS*/
         LA    @15,1                                               0248
         AL    @15,I                                               0248
         ST    @15,I                                               0248
@DE00237 C     @15,NUMTODO                                         0248
         BNH   @DL00237                                            0248
*  SYSUMPTR = ADDRSAVE;       /*RESTORE ADDRESS POINTER TO START     */
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0249
*  DDTYPE = 'F0'X;            /*RETURN TO THE CORRECT PRINT DATA SET */
         MVI   DDTYPE,X'F0'                                        0250
* END;                                                     /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00005 DS    0H                                                  0252
@EF00005 DS    0H                                                  0252
@ER00005 LM    @14,@12,@SA00005                                    0252
         BR    @14                                                 0252
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PROCESS THE DATA FOR PROGERR DATA      @Z427VLS*/
*PROGERR: PROC;                                            /*@Z427VLS*/
PROGERR  STM   @14,@12,@SA00006                                    0253
* COUNTER = 22;                /*SET INDEX TO PROGER         @Z427VLS*/
         MVC   COUNTER(4),@CF00475                                 0254
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0255
* DATAINFO = DISCRIPT(COUNTER);/*MOVE MAIN HEADING FOR PROGERR IN    */
         L     @15,COUNTER                                         0256
         MH    @15,@CH00466                                        0256
         LA    @14,DISCRIPT-17(@15)                                0256
         MVC   DATAINFO(17),0(@14)                                 0256
* CALL PRINTIT;                 /*PRINT THE HEADING          @Z427VLS*/
         BAL   @14,PRINTIT                                         0257
* CALL PRINTIT;                /*ADD A BLANK LINE            @Z427VLS*/
         BAL   @14,PRINTIT                                         0258
* COUNTER = COUNTER + ONE;      /*SPACE TO FIRST SUB GROUP OF PROGERR*/
         L     @15,COUNTER                                         0259
         AL    @15,ONE                                             0259
         ST    @15,COUNTER                                         0259
* DATAINFO = DISCRIPT(COUNTER);                            /*@Z427VLS*/
         MH    @15,@CH00466                                        0260
         LA    @14,DISCRIPT-17(@15)                                0260
         MVC   DATAINFO(17),0(@14)                                 0260
* DECADDR = ADDR(TOTAL);                                   /*@Z427VLS*/
         LA    @15,TOTAL                                           0261
         ST    @15,DECADDR                                         0261
* DO I = 1 BY 1 TO NUMTODO;                                /*@Z427VLS*/
         LA    @15,1                                               0262
         ST    @15,I                                               0262
         B     @DE00262                                            0262
@DL00262 DS    0H                                                  0263
*  BINWORD = SYSUMPEI;                                     /*@Z427VLS*/
         L     @01,SYSUMPTR(,R2)                                   0263
         L     @14,SYSUMPEI(,@01)                                  0263
         ST    @14,BINWORD                                         0263
*   TOTALPRM(I) = TOTALPRM(I) + BINWORD; /*KEEP TRACK OF OVERALL TOT*/
         SLA   @15,2                                               0264
         AL    @14,TOTALPRM-4(@15)                                 0264
         ST    @14,TOTALPRM-4(@15)                                 0264
*  CALL CONVBIN;                                           /*@Z427VLS*/
         BAL   @14,CONVBIN                                         0265
*  DECADDR = DECADDR + SIX;                                /*@Z427VLS*/
         L     @15,DECADDR                                         0266
         AL    @15,SIX                                             0266
         ST    @15,DECADDR                                         0266
*  SYSUMPTR = SYSUMNXT;         /*KEEP THE ADDRESABITY CORRECT       */
         L     @01,SYSUMPTR(,R2)                                   0267
         L     @15,SYSUMNXT(,@01)                                  0267
         ST    @15,SYSUMPTR(,R2)                                   0267
* END;                                                     /*@Z427VLS*/
         LA    @15,1                                               0268
         AL    @15,I                                               0268
         ST    @15,I                                               0268
@DE00262 C     @15,NUMTODO                                         0268
         BNH   @DL00262                                            0268
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0269
* DECADDR = ADDR(TOTAL);                                   /*@Z427VLS*/
         LA    @15,TOTAL                                           0270
         ST    @15,DECADDR                                         0270
* COUNTER = COUNTER + ONE;                                 /*@Z427VLS*/
         L     @15,COUNTER                                         0271
         AL    @15,ONE                                             0271
         ST    @15,COUNTER                                         0271
* SYSUMPTR = ADDRSAVE;                                     /*@Z427VLS*/
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0272
* DATAINFO = DISCRIPT(COUNTER);                            /*@Z427VLS*/
         MH    @15,@CH00466                                        0273
         LA    @14,DISCRIPT-17(@15)                                0273
         MVC   DATAINFO(17),0(@14)                                 0273
* DO I = 1 BY 1 TO NUMTODO;                                /*@Z427VLS*/
         LA    @15,1                                               0274
         ST    @15,I                                               0274
         B     @DE00274                                            0274
@DL00274 DS    0H                                                  0275
*  BINWORD = SYSUMPEA;                                     /*@Z427VLS*/
         L     @01,SYSUMPTR(,R2)                                   0275
         L     @14,SYSUMPEA(,@01)                                  0275
         ST    @14,BINWORD                                         0275
*   TOTALPRM(I) = TOTALPRM(I) + BINWORD; /*KEEP TRACK OF OVERALL TOT*/
         SLA   @15,2                                               0276
         AL    @14,TOTALPRM-4(@15)                                 0276
         ST    @14,TOTALPRM-4(@15)                                 0276
*  CALL CONVBIN;                                           /*@Z427VLS*/
         BAL   @14,CONVBIN                                         0277
*  DECADDR = DECADDR + SIX;                                /*@Z427VLS*/
         L     @15,DECADDR                                         0278
         AL    @15,SIX                                             0278
         ST    @15,DECADDR                                         0278
*  SYSUMPTR = SYSUMNXT;         /*KEEP THE ADDRESSABILIITY CORRECT   */
         L     @01,SYSUMPTR(,R2)                                   0279
         L     @15,SYSUMNXT(,@01)                                  0279
         ST    @15,SYSUMPTR(,R2)                                   0279
* END;                                                     /*@Z427VLS*/
         LA    @15,1                                               0280
         AL    @15,I                                               0280
         ST    @15,I                                               0280
@DE00274 C     @15,NUMTODO                                         0280
         BNH   @DL00274                                            0280
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0281
* DECADDR = ADDR(TOTAL);                                   /*@Z427VLS*/
         LA    @15,TOTAL                                           0282
         ST    @15,DECADDR                                         0282
* SYSUMPTR = ADDRSAVE;                                     /*@Z427VLS*/
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0283
* COUNTER = COUNTER + ONE;                                 /*@Z427VLS*/
         L     @15,COUNTER                                         0284
         AL    @15,ONE                                             0284
         ST    @15,COUNTER                                         0284
* DATAINFO = DISCRIPT(COUNTER);                            /*@Z427VLS*/
         MH    @15,@CH00466                                        0285
         LA    @14,DISCRIPT-17(@15)                                0285
         MVC   DATAINFO(17),0(@14)                                 0285
* DO I = 1 BY 1 TO NUMTODO;                                /*@Z427VLS*/
         LA    @15,1                                               0286
         ST    @15,I                                               0286
         B     @DE00286                                            0286
@DL00286 DS    0H                                                  0287
*  BINWORD = SYSUMPER;                                     /*@Z427VLS*/
         L     @01,SYSUMPTR(,R2)                                   0287
         L     @14,SYSUMPER(,@01)                                  0287
         ST    @14,BINWORD                                         0287
*   TOTALPRM(I) = TOTALPRM(I) + BINWORD; /*KEEP TRACK OF OVERALL TOT*/
         SLA   @15,2                                               0288
         AL    @14,TOTALPRM-4(@15)                                 0288
         ST    @14,TOTALPRM-4(@15)                                 0288
*  CALL CONVBIN;                                           /*@Z427VLS*/
         BAL   @14,CONVBIN                                         0289
*  SYSUMPTR = SYSUMNXT;         /*KEEP THE ADDRESSABILIITY CORRECT   */
         L     @01,SYSUMPTR(,R2)                                   0290
         L     @15,SYSUMNXT(,@01)                                  0290
         ST    @15,SYSUMPTR(,R2)                                   0290
*  DECADDR = DECADDR + SIX;                                /*@Z427VLS*/
         L     @15,DECADDR                                         0291
         AL    @15,SIX                                             0291
         ST    @15,DECADDR                                         0291
* END;                                                     /*@Z427VLS*/
         LA    @15,1                                               0292
         AL    @15,I                                               0292
         ST    @15,I                                               0292
@DE00286 C     @15,NUMTODO                                         0292
         BNH   @DL00286                                            0292
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0293
* SYSUMPTR = ADDRSAVE;          /*RESTORE THE ADDRESSABILITY @Z427VLS*/
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0294
*END;                                                      /*@Z427VLS*/
@EL00006 DS    0H                                                  0295
@EF00006 DS    0H                                                  0295
@ER00006 LM    @14,@12,@SA00006                                    0295
         BR    @14                                                 0295
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PROCESS THE DATA FOR EOD OUTPUT        @Z427VLS*/
*/*                                                          @Z427VLS*/
*EODWORK: PROC;                                            /*@Z427VLS*/
EODWORK  STM   @14,@12,@SA00007                                    0296
* CALL PRINTIT;                /*FOR SPACE BETWEEN LINES     @Z427VLS*/
         BAL   @14,PRINTIT                                         0297
* DECADDR = ADDR(TOTAL);       /*SET POINTER TO PRINT START  @Z427VLS*/
         LA    @15,TOTAL                                           0298
         ST    @15,DECADDR                                         0298
* DATAINFO = DISCRIPT(26);     /*MOVE THE DISCRIPTION INTO PRINT LINE*/
         MVC   DATAINFO(17),DISCRIPT+425                           0299
*  DO I = 1 BY 1 TO NUMTODO;                               /*@Z427VLS*/
         LA    @15,1                                               0300
         ST    @15,I                                               0300
         B     @DE00300                                            0300
@DL00300 DS    0H                                                  0301
*  BINWORD = SYSUMEOD;          /*SET UP ITEM TO CONVERT TO PRINT    */
         L     @01,SYSUMPTR(,R2)                                   0301
         L     @14,SYSUMEOD(,@01)                                  0301
         ST    @14,BINWORD                                         0301
*   TOTALPRM(I) = TOTALPRM(I) + BINWORD; /*KEEP TRACK OF OVERALL TOT*/
         SLA   @15,2                                               0302
         AL    @14,TOTALPRM-4(@15)                                 0302
         ST    @14,TOTALPRM-4(@15)                                 0302
*  CALL CONVBIN;                /*GO DO THE BINARY TO PRINT CONVERT  */
         BAL   @14,CONVBIN                                         0303
*  DECADDR = DECADDR + SIX;     /*MOVE THE POINTER DOWN THE PRINT LNE*/
         L     @15,DECADDR                                         0304
         AL    @15,SIX                                             0304
         ST    @15,DECADDR                                         0304
*  SYSUMPTR = SYSUMNXT;         /*CHANGE ADDRESSABILITY FOR NEXT BLOK*/
         L     @01,SYSUMPTR(,R2)                                   0305
         L     @15,SYSUMNXT(,@01)                                  0305
         ST    @15,SYSUMPTR(,R2)                                   0305
* END;                                                     /*@Z427VLS*/
         LA    @15,1                                               0306
         AL    @15,I                                               0306
         ST    @15,I                                               0306
@DE00300 C     @15,NUMTODO                                         0306
         BNH   @DL00300                                            0306
* SPACING= DOUBLE;              /*AS NEW TYPE SKIP AN EXTRA LINE     */
         MVC   SPACING(1),DOUBLE                                   0307
* CALL PRINTIT;                 /*GO PRINT THE MESSAGE       @Z427VLS*/
         BAL   @14,PRINTIT                                         0308
* SPACING= SINGLE;              /*RESTORE THE SPACING TO SINGLE      */
         MVC   SPACING(1),SINGLE                                   0309
* SYSUMPTR = ADDRSAVE;          /*RESTORE THE ADDRESSABILITY FOR NEXT*/
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0310
*END;                                                      /*@Z427VLS*/
@EL00007 DS    0H                                                  0311
@EF00007 DS    0H                                                  0311
@ER00007 LM    @14,@12,@SA00007                                    0311
         BR    @14                                                 0311
*/********************************************************************/
*/*    THIS PROC WILL PROCESS THE COUNTS FOR CHANNEL CHECKS  @Z427VLS*/
*CCHWORK: PROC;                                            /*@Z427VLS*/
CCHWORK  STM   @14,@12,@SA00008                                    0312
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0313
* DATAINFO = DISCRIPT(5);    /*MOVE IN THE MAIN CHANNEL CHECK HEADING*/
         MVC   DATAINFO(17),DISCRIPT+68                            0314
* CALL PRINTIT;              /*GO PRINT THE HEADING          @Z427VLS*/
         BAL   @14,PRINTIT                                         0315
* CALL PRINTIT;              /*GO PRINT BLANK LINE           @Z427VLS*/
         BAL   @14,PRINTIT                                         0316
* COUNTER = SIX;             /*SET INDEX TO FIRST CHANNEL VERBAGE    */
         L     @15,SIX                                             0317
         ST    @15,COUNTER                                         0317
*/* SPACING = DOUBLE    AT C.E.S REQUEST SINGLE SPACE OCT 16,1976*****/
* DO J = 1 BY 1 TO 16;       /*DO ALL 16 DIFFERENT CHANNELS + TOTAL  */
         LA    @15,1                                               0318
         ST    @15,J                                               0318
@DL00318 DS    0H                                                  0319
*   DECADDR = ADDR(TOTAL);  /*SE UP THE ADDRESS OF WHERE TO PUT DATA*/
         LA    @15,TOTAL                                           0319
         ST    @15,DECADDR                                         0319
*   DATAINFO = DISCRIPT(COUNTER);/*MOVE DATA DISCRIPTION IN PRINT LIN*/
         L     @15,COUNTER                                         0320
         MH    @15,@CH00466                                        0320
         LA    @14,DISCRIPT-17(@15)                                0320
         MVC   DATAINFO(17),0(@14)                                 0320
*   SYSUMPTR = ADDRSAVE;     /*SET UP ADDRESSABLE TO FIRST BLOCK OF  */
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0321
*   DO I = 1 BY 1  TO NUMTODO;                             /*@Z427VLS*/
         LA    @15,1                                               0322
         ST    @15,I                                               0322
         B     @DE00322                                            0322
@DL00322 DS    0H                                                  0323
*     BINWORD = SYSUMCH(J);  /*PICK UP BINARY INFO FROM CHANNEL DATA */
         L     @14,J                                               0323
         SLA   @14,2                                               0323
         L     @01,SYSUMPTR(,R2)                                   0323
         L     @14,SYSUMCH-4(@14,@01)                              0323
         ST    @14,BINWORD                                         0323
*   TOTALPRM(I) = TOTALPRM(I) + BINWORD; /*KEEP TRACK OF OVERALL TOT*/
         SLA   @15,2                                               0324
         AL    @14,TOTALPRM-4(@15)                                 0324
         ST    @14,TOTALPRM-4(@15)                                 0324
*     CALL CONVBIN;          /*CONVERT THE BINARY TO PRINTABLE       */
         BAL   @14,CONVBIN                                         0325
*     DECADDR = DECADDR + SIX; /*MOVE DOWN PRINT LINE FOR EACH CPU   */
         L     @15,DECADDR                                         0326
         AL    @15,SIX                                             0326
         ST    @15,DECADDR                                         0326
*     SYSUMPTR = SYSUMNXT;   /*SET UP THE ADDRESS FOR THE NEXT BLOCK */
         L     @01,SYSUMPTR(,R2)                                   0327
         L     @15,SYSUMNXT(,@01)                                  0327
         ST    @15,SYSUMPTR(,R2)                                   0327
*   END;                                                   /*@Z427VLS*/
         LA    @15,1                                               0328
         AL    @15,I                                               0328
         ST    @15,I                                               0328
@DE00322 C     @15,NUMTODO                                         0328
         BNH   @DL00322                                            0328
*   CALL PRINTIT;            /*GO AND PRINT THE INFORMATION  @Z427VLS*/
         BAL   @14,PRINTIT                                         0329
*   COUNTER = COUNTER + ONE; /*MOVE INDEX TO NEXT CHANNEL DISCRIPTION*/
         L     @15,COUNTER                                         0330
         AL    @15,ONE                                             0330
         ST    @15,COUNTER                                         0330
* END;                                                     /*@Z427VLS*/
         LA    @15,1                                               0331
         AL    @15,J                                               0331
         ST    @15,J                                               0331
         C     @15,@CF00086                                        0331
         BNH   @DL00318                                            0331
*SYSUMPTR = ADDRSAVE;        /*SET UP ADDRESSABILITY FOR NEXT SECTION*/
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0332
*SPACING = SINGLE;           /*RESET TO SINGLE SPACING       @Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0333
*END;                                                      /*@Z427VLS*/
@EL00008 DS    0H                                                  0334
@EF00008 DS    0H                                                  0334
@ER00008 LM    @14,@12,@SA00008                                    0334
         BR    @14                                                 0334
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PROCESS THE DATA FOR MCH OUTPUT        @Z427VLS*/
*MCHWORK: PROC;                                            /*@Z427VLS*/
MCHWORK  STM   @14,@12,@SA00009                                    0335
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0336
* DECADDR = ADDR(TOTAL);       /*SET POINTER TO PRINT START  @Z427VLS*/
         LA    @15,TOTAL                                           0337
         ST    @15,DECADDR                                         0337
* DATAINFO = DISCRIPT(TWO);    /*MOVE THE DISCRIPTION INTO PRINT LINE*/
         L     @15,TWO                                             0338
         MH    @15,@CH00466                                        0338
         LA    @14,DISCRIPT-17(@15)                                0338
         MVC   DATAINFO(17),0(@14)                                 0338
* CALL PRINTIT;                /*GO AND PRINT THE MAIN MCH HEADING   */
         BAL   @14,PRINTIT                                         0339
* CALL PRINTIT;                /*GO AND PRINT BLANK LINE     @Z427VLS*/
         BAL   @14,PRINTIT                                         0340
* DATAINFO = DISCRIPT(3);      /*MOVE FIRST MCH TYPE INTO LINE       */
         MVC   DATAINFO(17),DISCRIPT+34                            0341
* DO I = 1 BY 1 TO NUMTODO;/*PROCESS ALL CPUS + 1 FOR TOTAL  @Z427VLS*/
         LA    @15,1                                               0342
         ST    @15,I                                               0342
         B     @DE00342                                            0342
@DL00342 DS    0H                                                  0343
*  BINWORD = SYSUMMCR;          /*SET UP ITEM TO CONVERT TO PRINT    */
         L     @01,SYSUMPTR(,R2)                                   0343
         L     @14,SYSUMMCR(,@01)                                  0343
         ST    @14,BINWORD                                         0343
*   TOTALPRM(I) = TOTALPRM(I) + BINWORD; /*KEEP TRACK OF OVERALL TOT*/
         SLA   @15,2                                               0344
         AL    @14,TOTALPRM-4(@15)                                 0344
         ST    @14,TOTALPRM-4(@15)                                 0344
*  CALL CONVBIN;                /*GO DO THE BINARY TO PRINT CONVERT  */
         BAL   @14,CONVBIN                                         0345
*  DECADDR = DECADDR + SIX;     /*MOVE THE POINTER DOWN THE PRINT LNE*/
         L     @15,DECADDR                                         0346
         AL    @15,SIX                                             0346
         ST    @15,DECADDR                                         0346
*  SYSUMPTR = SYSUMNXT;         /*CHANGE ADDRESSABILITY FOR NEXT BLOK*/
         L     @01,SYSUMPTR(,R2)                                   0347
         L     @15,SYSUMNXT(,@01)                                  0347
         ST    @15,SYSUMPTR(,R2)                                   0347
* END;                                                     /*@Z427VLS*/
         LA    @15,1                                               0348
         AL    @15,I                                               0348
         ST    @15,I                                               0348
@DE00342 C     @15,NUMTODO                                         0348
         BNH   @DL00342                                            0348
* CALL PRINTIT;                 /*GO PRINT THE MESSAGE       @Z427VLS*/
         BAL   @14,PRINTIT                                         0349
* DATAINFO = DISCRIPT(4);       /*MOVE NON-RECOVERABLE WORDS TO LINE */
         MVC   DATAINFO(17),DISCRIPT+51                            0350
* DECADDR = ADDR(TOTAL);        /*BACK UP POINTER FOR NEW OUTPUT     */
         LA    @15,TOTAL                                           0351
         ST    @15,DECADDR                                         0351
* SYSUMPTR = ADDRSAVE;          /*RESTORE ADDRESSABILITY TO START    */
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0352
* DO I = 1 BY 1 TO NUMTODO;/*CPU'S + ONE FOR THE TOTALS      @Z427VLS*/
         LA    @15,1                                               0353
         ST    @15,I                                               0353
         B     @DE00353                                            0353
@DL00353 DS    0H                                                  0354
*  BINWORD = SYSUMMCN;          /*MOVE # TO CONVERT TO PRINTABLE     */
         L     @01,SYSUMPTR(,R2)                                   0354
         L     @14,SYSUMMCN(,@01)                                  0354
         ST    @14,BINWORD                                         0354
*   TOTALPRM(I) = TOTALPRM(I) + BINWORD; /*KEEP TRACK OF OVERALL TOT*/
         SLA   @15,2                                               0355
         AL    @14,TOTALPRM-4(@15)                                 0355
         ST    @14,TOTALPRM-4(@15)                                 0355
*  CALL CONVBIN;/*CONVERT BINWORD TO PRINTABLE               @Z427VLS*/
         BAL   @14,CONVBIN                                         0356
*  DECADDR = DECADDR + SIX;     /*MOVE DOWN THE PRINT LINE NEXT CPU  */
         L     @15,DECADDR                                         0357
         AL    @15,SIX                                             0357
         ST    @15,DECADDR                                         0357
*  SYSUMPTR = SYSUMNXT ;        /*CHANGE THE BASE FOR NEXT BLOCK     */
         L     @01,SYSUMPTR(,R2)                                   0358
         L     @15,SYSUMNXT(,@01)                                  0358
         ST    @15,SYSUMPTR(,R2)                                   0358
* END;                                                     /*@Z427VLS*/
         LA    @15,1                                               0359
         AL    @15,I                                               0359
         ST    @15,I                                               0359
@DE00353 C     @15,NUMTODO                                         0359
         BNH   @DL00353                                            0359
* CALL PRINTIT;                 /*GO PRINT LAST MCH DATA LINE        */
         BAL   @14,PRINTIT                                         0360
* SYSUMPTR = ADDRSAVE;          /*RESTORE THE ADDRESSABILITY TO START*/
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0361
*END;                                                      /*@Z427VLS*/
@EL00009 DS    0H                                                  0362
@EF00009 DS    0H                                                  0362
@ER00009 LM    @14,@12,@SA00009                                    0362
         BR    @14                                                 0362
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PROCESS THE DATA FOR CPU OUTPUT        @Z427VLS*/
*/*                                                          @Z427VLS*/
*CPUINFO: PROC;                                            /*@Z427VLS*/
CPUINFO  STM   @14,@12,@SA00010                                    0363
*  SPACING = DOUBLE;           /*OFFSET ON THE PAGE          @Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0364
*  CALL PRINTIT;               /*UPSPACE THREE LINE PRIOR TO START   */
         BAL   @14,PRINTIT                                         0365
*  IF (LINECT - MYLINECT) < (EVNUM + 2  ) THEN                     0366
         LH    @03,LINECT(,R2)                                     0366
         SL    @03,MYLINECT                                        0366
         L     @01,EVPTR(,R2)                                      0366
         LA    @00,2                                               0366
         AH    @00,EVNUM(,@01)                                     0366
         CR    @03,@00                                             0366
         BNL   @RF00366                                            0366
*   DO;                                                    /*@Z427VLS*/
*    MYLINECT = ZERO;                                      /*@Z427VLS*/
         SLR   @03,@03                                             0368
         ST    @03,MYLINECT                                        0368
*    SPACING = UPSPACE;                                    /*@Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0369
*    CALL PRINTIT;                                         /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0370
*    SPACING = DOUBLE;                                     /*@Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0371
*   END;                                                   /*@Z427VLS*/
*  CPULINE1 = CPULINE;         /*SET UP THE HEADING FOR CPU SERIAL   */
@RF00366 MVC   CPULINE1(24),CPULINE                                0373
*  CALL PRINTIT ;              /*GO AND PRINT OUT THE HEADING        */
         BAL   @14,PRINTIT                                         0374
*  SPACING = SINGLE;           /*RETURN SPACING TO SINGLE OR NORMAL  */
         MVC   SPACING(1),SINGLE                                   0375
*  DO I = 1 BY 1 TO NUMTODO-1; /*SET TO PROCESS ALL CPUS + TOTALS    */
         LA    @03,1                                               0376
         ST    @03,I                                               0376
         B     @DE00376                                            0376
@DL00376 DS    0H                                                  0377
*   CPUTYPE = EVLETTER(I);     /*SET IN ACTUAL LETTER        @Z427VLS*/
         MH    @03,@CH00078                                        0377
         L     @15,EVPTR(,R2)                                      0377
         ST    @03,@TF00001                                        0377
         ALR   @03,@15                                             0377
         MVC   CPUTYPE(1),EVLETTER-6(@03)                          0377
*   NUMBER = TWO;              /*DO 2 BYTES OF DATA          @Z427VLS*/
         L     @03,TWO                                             0378
         ST    @03,NUMBER                                          0378
*   ADDNXT = ADDR(CPUMODEL);   /*WHERE THE INFO IS TO BE PLACED      */
         LA    @03,CPUMODEL                                        0379
         ST    @03,ADDNXT                                          0379
*   NEXTBY = ADDR(EVMODEL(I)); /*ADDRESS OF WHERE THE DATA IS        */
         L     @03,@TF00001                                        0380
         LA    @03,EVMODEL-6(@03,@15)                              0380
         ST    @03,NEXTBY                                          0380
*   CALL CONVERT;              /*GO AND CONVERTB THE DATA    @Z427VLS*/
         BAL   @14,CONVERT                                         0381
*   NUMBER = THREE;            /*SERIAL SHOULD HAVE 6 BYTES OF PRINT */
         MVC   NUMBER(4),@CF00073                                  0382
*   ADDNXT = ADDR(CPUSERAL);   /*WHERE THE SERIAL INFO IS STORED     */
         LA    @03,CPUSERAL                                        0383
         ST    @03,ADDNXT                                          0383
*   NEXTBY = ADDR(EVSERIAL(I));                            /*@Z427VLS*/
         L     @03,I                                               0384
         MH    @03,@CH00078                                        0384
         L     @01,EVPTR(,R2)                                      0384
         LA    @03,EVSERIAL-6(@03,@01)                             0384
         ST    @03,NEXTBY                                          0384
*   CALL CONVERT;              /*GO AND CONVERT THE DATA     @Z427VLS*/
         BAL   @14,CONVERT                                         0385
*   MOVECPU = CPUDATA;         /*MOVE CPU DATA TO PRINT BUFFER       */
         MVC   MOVECPU(22),CPUDATA                                 0386
*   CALL PRINTIT;              /*GO AND PRINT THE RESULTS OF THIS    */
         BAL   @14,PRINTIT                                         0387
*  END;                                                    /*@Z427VLS*/
         LA    @03,1                                               0388
         AL    @03,I                                               0388
         ST    @03,I                                               0388
@DE00376 L     @15,NUMTODO                                         0388
         BCTR  @15,0                                               0388
         CR    @03,@15                                             0388
         BNH   @DL00376                                            0388
*END;                                                      /*@Z427VLS*/
@EL00010 DS    0H                                                  0389
@EF00010 DS    0H                                                  0389
@ER00010 LM    @14,@12,@SA00010                                    0389
         BR    @14                                                 0389
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PROCESS THE DATA FOR THE IPL PART OF THE REPORT*/
*/*                                                          @Z427VLS*/
*IPLWORK: PROC;                                            /*@Z427VLS*/
IPLWORK  STM   @14,@12,@SA00011                                    0390
*  DATAINFO = DISCRIPT(ONE);    /*MOVE IN IPL LABEL          @Z427VLS*/
         L     @15,ONE                                             0391
         MH    @15,@CH00466                                        0391
         LA    @14,DISCRIPT-17(@15)                                0391
         MVC   DATAINFO(17),0(@14)                                 0391
*  DECADDR = ADDR(TOTAL);     /*SET UP ADDRESS TO PUT THE DATA       */
         LA    @15,TOTAL                                           0392
         ST    @15,DECADDR                                         0392
*  DO I = 1 BY 1 TO NUMTODO;                               /*@Z427VLS*/
         LA    @15,1                                               0393
         ST    @15,I                                               0393
         B     @DE00393                                            0393
@DL00393 DS    0H                                                  0394
*   BINWORD = SYSUMIPL;      /*LOAD THE VALUE TO CONVERT     @Z427VLS*/
         L     @01,SYSUMPTR(,R2)                                   0394
         L     @14,SYSUMIPL(,@01)                                  0394
         ST    @14,BINWORD                                         0394
*   TOTALPRM(I) = TOTALPRM(I) + BINWORD; /*KEEP TRACK OF OVERALL TOT*/
         SLA   @15,2                                               0395
         AL    @14,TOTALPRM-4(@15)                                 0395
         ST    @14,TOTALPRM-4(@15)                                 0395
*   CALL CONVBIN;            /*GO CONVERT THE BINARY VALUE TO PRINT  */
         BAL   @14,CONVBIN                                         0396
*   DECADDR = DECADDR + SIX; /*MOVE WHERE TO PUT THE DATA IN LINE    */
         L     @15,DECADDR                                         0397
         AL    @15,SIX                                             0397
         ST    @15,DECADDR                                         0397
*   SYSUMPTR = SYSUMNXT;     /*CHANGE THE BASE FOR NEXT BLOCK OF DATA*/
         L     @01,SYSUMPTR(,R2)                                   0398
         L     @15,SYSUMNXT(,@01)                                  0398
         ST    @15,SYSUMPTR(,R2)                                   0398
*  END;                                                    /*@Z427VLS*/
         LA    @15,1                                               0399
         AL    @15,I                                               0399
         ST    @15,I                                               0399
@DE00393 C     @15,NUMTODO                                         0399
         BNH   @DL00393                                            0399
*  CALL PRINTIT;/*GO AND PRINT THE LINE OF DATA TO OUT       @Z427VLS*/
         BAL   @14,PRINTIT                                         0400
*  SYSUMPTR = ADDRSAVE;      /*RESTORE THE ADDRESS ABILIITY TO START */
         ST    ADDRSAVE,SYSUMPTR(,R2)                              0401
*END;                                                      /*@Z427VLS*/
@EL00011 DS    0H                                                  0402
@EF00011 DS    0H                                                  0402
@ER00011 LM    @14,@12,@SA00011                                    0402
         BR    @14                                                 0402
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PRINT THE TOTAL COUNTS FOR EACH COLUMN PART-1  */
*/*                                                          @Z427VLS*/
*PRT1TOT: PROC;                                            /*@Z427VLS*/
PRT1TOT  STM   @14,@12,@SA00012                                    0403
* PRTLINE = TOTCT;        /*MOVE IN THE LINE LABLE           @Z427VLS*/
         MVI   PRTLINE+13,C' '                                     0404
         MVC   PRTLINE+14(138),PRTLINE+13                          0404
         MVC   PRTLINE(13),TOTCT                                   0404
* BNDECNUM = FIVE;           /*ALLOW FIVE PRINT POSITIONS IN CONVBIN*/
         L     @03,FIVE                                            0405
         ST    @03,BNDECNUM                                        0405
* DECADDR = ADDR(TOTAL);     /*ADDRESS OF WHERE TO PUT TOTAL VALUE   */
         LA    @03,TOTAL                                           0406
         ST    @03,DECADDR                                         0406
* DO I = 1 BY 1 TO NUMTODO;  /*# CPUS + ONE FOR THE TOTAL    @Z427VLS*/
         LA    @03,1                                               0407
         ST    @03,I                                               0407
         B     @DE00407                                            0407
@DL00407 DS    0H                                                  0408
*  BINWORD = TOTALPRM(I);    /*PICK UP THE VALUE TO CONVERT  @Z427VLS*/
         SLA   @03,2                                               0408
         L     @03,TOTALPRM-4(@03)                                 0408
         ST    @03,BINWORD                                         0408
*  CALL CONVBIN;             /*GO AND CONVERT THE VALUE      @Z427VLS*/
         BAL   @14,CONVBIN                                         0409
*  DECADDR = DECADDR + SIX;  /*MOVE DOWN THE PRINT LINE      @Z427VLS*/
         L     @03,DECADDR                                         0410
         AL    @03,SIX                                             0410
         ST    @03,DECADDR                                         0410
* END;                                                     /*@Z427VLS*/
         LA    @03,1                                               0411
         AL    @03,I                                               0411
         ST    @03,I                                               0411
@DE00407 C     @03,NUMTODO                                         0411
         BNH   @DL00407                                            0411
* CALL PRINTIT;              /*TELL THE WORLD THE TOTAL COUNTS FOR AL*/
         BAL   @14,PRINTIT                                         0412
* GEN(XC  TOTALPRM(68),TOTALPRM);/*CLEAR THE TABLE FOR PART 2        */
         XC  TOTALPRM(68),TOTALPRM
*END;                                                      /*@Z427VLS*/
@EL00012 DS    0H                                                  0414
@EF00012 DS    0H                                                  0414
@ER00012 LM    @14,@12,@SA00012                                    0414
         BR    @14                                                 0414
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PRINT THE CPU PERM TEMP LINE OF DISCRIPTION    */
*/*                                                          @Z427VLS*/
*TOPLINE: PROC;                                            /*@Z427VLS*/
TOPLINE  STM   @14,@12,@SA00013                                    0415
* RESPECIFY (R6) RESTRICTED;                               /*@Z427VLS*/
* CALL PRINTIT;              /*PRINT BLANK LINE              @Z427VLS*/
         BAL   @14,PRINTIT                                         0417
* R9 = 22 + 10 * EVNUM;      /*DETERMINE # OF HEADING TO MOVE        */
         L     @07,EVPTR(,R2)                                      0418
         LH    R9,EVNUM(,@07)                                      0418
         MH    R9,@CH00272                                         0418
         AL    R9,@CF00475                                         0418
* R8 = ADDR(HEAD2);          /*WHERE THE HEADING IS          @Z427VLS*/
         LA    R8,HEAD2                                            0419
* R6 = ADDR(PRTLINE);        /*WHERE TO MOVE THE DATA TO     @Z427VLS*/
         LA    R6,PRTLINE                                          0420
* GEN(EX   R9,MOVETOTL);     /*ONLY WAY FOR VARABLE # OF CHARACTERS  */
         EX   R9,MOVETOTL
* CALL PRINTIT;              /*GO PRINT THE HEADING LINE 1   @Z427VLS*/
         BAL   @14,PRINTIT                                         0422
* R9 = 24 + 10 * EVNUM;      /*CHARS TO MOVE FOR THE SECOND LINE     */
         L     @07,EVPTR(,R2)                                      0423
         LH    R9,EVNUM(,@07)                                      0423
         MH    R9,@CH00272                                         0423
         AL    R9,@CF00225                                         0423
* R8 = ADDR(HEAD20);         /*WHERE THE DATA FO  2 LINE IS AT       */
         LA    R8,HEAD20                                           0424
* GEN(EX  R9,MOVETOTL);      /*MOVE THE CHARACTERS TO PRINTLINE      */
         EX  R9,MOVETOTL
* CALL PRINTIT;              /*GO PRINT THE HEADING          @Z427VLS*/
         BAL   @14,PRINTIT                                         0426
* RESPECIFY (R6) UNRESTRICTED;                             /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00013 DS    0H                                                  0428
@EF00013 DS    0H                                                  0428
@ER00013 LM    @14,@12,@SA00013                                    0428
         BR    @14                                                 0428
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PRINT DEBUG INFORMATION FOR THE USER   @Z427VLS*/
*/*                                                          @Z427VLS*/
*DODEBUG: PROC;                                            /*@Z427VLS*/
DODEBUG  STM   @14,@12,@SA00014                                    0429
* DDTYPE = '1';              /*CHANGE THE DD SET DATA PRINTED ON     */
         MVI   DDTYPE,C'1'                                         0430
* PRTLINE = BUG18;   /*MOVE THE HEADING INTO THE PRINT LINE  @0001VLS*/
         MVI   PRTLINE+19,C' '                                     0431
         MVC   PRTLINE+20(132),PRTLINE+19                          0431
         MVC   PRTLINE(19),BUG18                                   0431
* CALL PRINTIT;      /*GO PRINT THE DEBUG HEADING            @0001VLS*/
         BAL   @14,PRINTIT                                         0432
* DECADDR = ADDR(GROUPNUM) ; /*WHERE TO PUT CONVERTED NUMBER @Z427VLS*/
         LA    @03,GROUPNUM                                        0433
         ST    @03,DECADDR                                         0433
* BNDECNUM = SIX;            /*SET UP FOR SIX CHARACTERS FROM BINARY#*/
         L     @03,SIX                                             0434
         ST    @03,BNDECNUM                                        0434
* DO I = 1 BY 1 TO SIX;      /*CURRENNT LENGTY OF DEV GROUP  @Z427VLS*/
         LA    @03,1                                               0435
         ST    @03,I                                               0435
         B     @DE00435                                            0435
@DL00435 DS    0H                                                  0436
*  BINWORD = DBUGCT(I);      /*PICK UP THE COUNT             @Z427VLS*/
         SLA   @03,2                                               0436
         L     @03,DBUGCT-4(@03)                                   0436
         ST    @03,BINWORD                                         0436
*  CALL CONVBIN;             /*GO AND CONVERT THE BINARY NUMBER      */
         BAL   @14,CONVBIN                                         0437
*  GPNAME = DEVGROUP(I);     /*MOVE IN THE NAME OF THE GROUP @Z427VLS*/
         L     @03,I                                               0438
         SLA   @03,3                                               0438
         LA    @01,DEVGROUP-8(@03)                                 0438
         MVC   GPNAME(8),0(@01)                                    0438
*  PRTLINE = GROUPCT;        /*MOVE THE MESSAGE TO THE OUTPUT BUFFER */
         MVI   PRTLINE+32,C' '                                     0439
         MVC   PRTLINE+33(119),PRTLINE+32                          0439
         MVC   PRTLINE(32),GROUPCT                                 0439
*  CALL PRINTIT;             /*GO PRINT THE BUFFER           @Z427VLS*/
         BAL   @14,PRINTIT                                         0440
* END;                                                     /*@Z427VLS*/
         LA    @03,1                                               0441
         AL    @03,I                                               0441
         ST    @03,I                                               0441
@DE00435 C     @03,SIX                                             0441
         BNH   @DL00435                                            0441
* BINWORD = CT - ONE;        /*MUST - 1 AS CT ONE AHEAD AT THIS TIME */
         L     @03,CT                                              0442
         SL    @03,ONE                                             0442
         ST    @03,BINWORD                                         0442
* DECADDR = ADDR(TOTALCT);   /*WHERE TO PUT THE CONVERTED ITEM       */
         LA    @03,TOTALCT                                         0443
         ST    @03,DECADDR                                         0443
* CALL  CONVBIN; /*GO AND CONVERT THE ITEM TO PRINTABLE      @Z427VLS*/
         BAL   @14,CONVBIN                                         0444
* PRTLINE = TOTALS;          /*MOVE MESSAGE TO THE PRINT LINE        */
         MVI   PRTLINE+22,C' '                                     0445
         MVC   PRTLINE+23(129),PRTLINE+22                          0445
         MVC   PRTLINE(22),TOTALS                                  0445
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0446
* PRTLINE = BUGHEAD;         /*PRINT OUT THE WORDS DEBUG COUNTS      */
         MVI   PRTLINE+16,C' '                                     0447
         MVC   PRTLINE+17(135),PRTLINE+16                          0447
         MVC   PRTLINE(16),BUGHEAD                                 0447
* CALL PRINTIT;              /*GO PRINT THE MESSAGE          @Z427VLS*/
         BAL   @14,PRINTIT                                         0448
* PRTLINE = DBUGCT1;         /*MOVE THE HEADER IN TO BUFFER  @Z427VLS*/
         MVI   PRTLINE+34,C' '                                     0449
         MVC   PRTLINE+35(117),PRTLINE+34                          0449
         MVC   PRTLINE(34),DBUGCT1                                 0449
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0450
* DO I = 1 BY 1 TO NUMTODO - 1;                            /*@Z427VLS*/
         LA    @03,1                                               0451
         ST    @03,I                                               0451
         B     @DE00451                                            0451
@DL00451 DS    0H                                                  0452
*  CPULETTR = EVLETTER(I);  /*MOVE IN CPU LETTER             @Z427VLS*/
         LR    @15,@03                                             0452
         MH    @15,@CH00078                                        0452
         L     @01,EVPTR(,R2)                                      0452
         ALR   @01,@15                                             0452
         MVC   CPULETTR(1),EVLETTER-6(@01)                         0452
*  BINWORD  = PRIMEYES(I);    /*MOVE IN BINARY COUNT FOR THIS CPU     *
         SLA   @03,2                                               0453
         L     @03,PRIMEYES-4(@03)                                 0453
         ST    @03,BINWORD                                         0453
*  DECADDR = ADDR(PRTLINE) + 14;                           /*@Z427VLS*/
         LA    @03,PRTLINE                                         0454
         AL    @03,@CF00727                                        0454
         ST    @03,DECADDR                                         0454
*  CALL CONVBIN;                                           /*@Z427VLS*/
         BAL   @14,CONVBIN                                         0455
*  BINWORD = PRIMENO(I);                                   /*@Z427VLS*/
         L     @03,I                                               0456
         SLA   @03,2                                               0456
         L     @03,PRIMENO-4(@03)                                  0456
         ST    @03,BINWORD                                         0456
*  DECADDR = DECADDR + TEN;          /*SPACE DOWN THE PRINT LINE BY10*/
         L     @03,DECADDR                                         0457
         AL    @03,TEN                                             0457
         ST    @03,DECADDR                                         0457
*  CALL CONVBIN;                                           /*@Z427VLS*/
         BAL   @14,CONVBIN                                         0458
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0459
* END;                                                     /*@Z427VLS*/
         LA    @03,1                                               0460
         AL    @03,I                                               0460
         ST    @03,I                                               0460
@DE00451 L     @15,NUMTODO                                         0460
         BCTR  @15,0                                               0460
         CR    @03,@15                                             0460
         BNH   @DL00451                                            0460
* IF SPCHANGE ^= ZERO THEN     /*ONLY PRINT IF HAD ODD CUA-DEV*/   0461
         L     @03,SPCHANGE                                        0461
         LTR   @03,@03                                             0461
         BZ    @RF00461                                            0461
*  DO;                                                     /*@0001VLS*/
*   BINWORD = SPCHANGE;        /*SET UP THE NUMBER TO CONVERT   */ 0463
         ST    @03,BINWORD                                         0463
*   DECADDR = ADDR(SPNUM);     /*SET ADDRESS OF WHERE TO PUT IT */ 0464
         LA    @03,SPNUM                                           0464
         ST    @03,DECADDR                                         0464
*   CALL CONVBIN;              /*GO CONVERT THE ITEM TO PRINTABLE*/
         BAL   @14,CONVBIN                                         0465
*   PRTLINE = SPCHNG;          /*MOVE THE LINE OF PRINT TO BUFFER */
         MVI   PRTLINE+50,C' '                                     0466
         MVC   PRTLINE+51(101),PRTLINE+50                          0466
         MVC   PRTLINE(50),SPCHNG                                  0466
*   CALL PRINTIT;              /*GO PRINT THE MESSAGE        @0001VLS*/
         BAL   @14,PRINTIT                                         0467
*  END;                                                    /*@0001VLS*/
*END;                                                      /*@Z427VLS*/
@EL00014 DS    0H                                                  0469
@EF00014 DS    0H                                                  0469
@ER00014 LM    @14,@12,@SA00014                                    0469
         BR    @14                                                 0469
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PRINT THE RESULT OF THE PROC DOCOUNT   @Z427VLS*/
*/*                                                          @Z427VLS*/
*DATALINE:  PROC;                                          /*@Z427VLS*/
DATALINE STM   @14,@12,@SA00015                                    0470
*  R9 = CT - ONE;            /*SET UP TO LOOK BACK ON ENTRY  @0001VLS*/
         L     @03,ONE                                             0471
         L     R9,CT                                               0471
         SLR   R9,@03                                              0471
* BNDECNUM = FIVE;                                         /*@Z427VLS*/
         L     @15,FIVE                                            0472
         ST    @15,BNDECNUM                                        0472
* IF R9 > ZERO & SYSDEV(R9) ^= SAVEDEV & OLDGROUP ^= FIVE THEN     0473
         LTR   R9,R9                                               0473
         BNP   @RF00473                                            0473
         LR    @14,R9                                              0473
         MH    @14,@CH00703                                        0473
         L     @01,SORTADR(,R2)                                    0473
         ALR   @01,@14                                             0473
         AL    @01,@CF00909                                        0473
         CLC   SYSDEV-5(2,@01),SAVEDEV                             0473
         BE    @RF00473                                            0473
         C     @15,OLDGROUP                                        0473
         BE    @RF00473                                            0473
*  DO;                                                     /*@0001VLS*/
*   SPCHANGE = SPCHANGE + ONE; /*KEEP TRACK OF ODD CASES     @0001VLS*/
         AL    @03,SPCHANGE                                        0475
         ST    @03,SPCHANGE                                        0475
*  CALL DEVTYPE;          /*JUST IN CASE THE DEVICES ARE DIFFERENT*/
         BAL   @14,DEVTYPE                                         0476
*                         /*ON DIFFERENT CPUS & SAME CUA     @Z427VLS*/
*  END;                                                    /*@0001VLS*/
* DECADDR = ADDR(TOTE2) - 3;  /*SETUP ADDRESS OF WHERE TO PUT THE DAT*/
@RF00473 LA    @03,TOTE2                                           0478
         SL    @03,@CF00073                                        0478
         ST    @03,DECADDR                                         0478
* BINWORD = SYS2TPRM;        /*SET UP TO CONVERT THE TOTAL OF PERMS  */
         L     @03,SYS2TPRM                                        0479
         ST    @03,BINWORD                                         0479
* CALL CONVBIN;              /*GO CONVERT THE BINARY TO PRINTABLE    */
         BAL   @14,CONVBIN                                         0480
* DECADDR = DECADDR + SIX ;  /*MOVE DOWN THE PRINT LINE FOR TOTAL TEM*/
         L     @03,DECADDR                                         0481
         AL    @03,SIX                                             0481
         ST    @03,DECADDR                                         0481
* BINWORD = SYS2TTOT;        /*MOVE IN THE TEMPARY TOTAL     @Z427VLS*/
         L     @03,SYS2TTOT                                        0482
         ST    @03,BINWORD                                         0482
* CALL CONVBIN;              /*GO AND CONVERT THE # TO PRINTABLE     */
         BAL   @14,CONVBIN                                         0483
* DECADDR = DECADDR + TWO;                                 /*@Z427VLS*/
         L     @03,DECADDR                                         0484
         AL    @03,TWO                                             0484
         ST    @03,DECADDR                                         0484
* BNDECNUM = FOUR;                                         /*@Z427VLS*/
         MVC   BNDECNUM(4),@CF00060                                0485
* DO R = 1 BY 1 TO EVNUM;                                  /*@Z427VLS*/
         LA    @03,1                                               0486
         ST    @03,R                                               0486
         B     @DE00486                                            0486
@DL00486 DS    0H                                                  0487
*  IF SHRFLGS(R) = ON THEN                                         0487
         SLR   @15,@15                                             0487
         IC    @15,SHRFLGS-1(@03)                                  0487
         C     @15,@CF00052                                        0487
         BNE   @RF00487                                            0487
*   DO;                                                    /*@Z427VLS*/
*   DECADDR = DECADDR + FIVE;/*MOVE FIVE DOWN THE PRINT LINE @Z427VLS*/
         L     @15,DECADDR                                         0489
         AL    @15,FIVE                                            0489
         ST    @15,DECADDR                                         0489
*   BINWORD = SYS2PERM(R);   /*PICK UP THE PERM ERRORS FOR NEXT CPU  */
         SLA   @03,2                                               0490
         L     @03,SYS2PERM-4(@03)                                 0490
         ST    @03,BINWORD                                         0490
*   CALL CONVBIN;            /*GO CONVERT THE ITEM TO PRINTABLE      */
         BAL   @14,CONVBIN                                         0491
*   DECADDR = DECADDR + FIVE;/*MOVE DOWN THE PRINT LINE FOR TEMP     */
         L     @03,DECADDR                                         0492
         AL    @03,FIVE                                            0492
         ST    @03,DECADDR                                         0492
*   BINWORD = SYS2TEMP(R);   /*PICK UP THE NEXT TEMPARY COUNT TO CONV*/
         L     @03,R                                               0493
         SLA   @03,2                                               0493
         L     @03,SYS2TEMP-4(@03)                                 0493
         ST    @03,BINWORD                                         0493
*   CALL CONVBIN;            /*GO CONVERT THE TEMPARY COUNT  @Z427VLS*/
         BAL   @14,CONVBIN                                         0494
*   END;                                                   /*@Z427VLS*/
*   ELSE                                                           0496
*    DO;                                                   /*@Z427VLS*/
         B     @RC00487                                            0496
@RF00487 DS    0H                                                  0497
*     R9 = DECADDR + EIGHT;  /*WHERE TO PUT THE DASH         @Z427VLS*/
         LA    R9,8                                                0497
         AL    R9,DECADDR                                          0497
*     GEN(MVI  0(R9),X'60'); /*PUT THE DASHH IN WHERE A ZERO WOULD BE*/
         MVI  0(R9),X'60'
*     R9 = R9 + FIVE;        /*MOVE THE POINTER TO THE NEXT LOCATION */
         AL    R9,FIVE                                             0499
*     GEN(MVI  0(R9),X'60'); /*ANGAIN MOVE IN A DASH         @Z427VLS*/
         MVI  0(R9),X'60'
*     DECADDR = DECADDR + TEN;/*MOVE POINTER DOWN THE PRINT LINE     */
         L     @03,DECADDR                                         0501
         AL    @03,TEN                                             0501
         ST    @03,DECADDR                                         0501
*    END;                                                  /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
@RC00487 LA    @03,1                                               0503
         AL    @03,R                                               0503
         ST    @03,R                                               0503
@DE00486 L     @01,EVPTR(,R2)                                      0503
         CH    @03,EVNUM(,@01)                                     0503
         BNH   @DL00486                                            0503
* CALL PRINTIT;              /*GO PRINT THIS GREAT INFO      @Z427VLS*/
         BAL   @14,PRINTIT                                         0504
* SYS2TPRM = ZERO;           /*ZERO FOR THE NEXT PASS        @Z427VLS*/
         SLR   @03,@03                                             0505
         ST    @03,SYS2TPRM                                        0505
* SYS2TTOT = ZERO;           /*SAME AS ABOVE                 @Z427VLS*/
         ST    @03,SYS2TTOT                                        0506
*   IF SWITCH2 = ON & CT ^> MAXLIMIT THEN /*CHECK IF DONE FIRST    */
         TM    SWITCH2,B'01000000'                                 0507
         BNO   @RF00507                                            0507
         L     @03,CT                                              0507
         C     @03,MAXLIMIT                                        0507
         BH    @RF00507                                            0507
*  DO;                       /*PROC CALLING PROC THAT WOULD CALL     */
*   CALL HEADING2;           /*CALLING PROC                  @Z427VLS*/
         BAL   @14,HEADING2                                        0509
*   CALL TOPLINE;            /*GOT TO HAVE COMLPETE HEADING  @Z427VLS*/
         BAL   @14,TOPLINE                                         0510
*   SWITCH2 = OFF;           /*SO DONT RETURN TILL NEEDED    @Z427VLS*/
         NI    SWITCH2,B'10111111'                                 0511
*   CALL PRTGROUP;           /*TELL THEM AGAIN ABOUT THE GROUP NAME  */
         BAL   @14,PRTGROUP                                        0512
*   CALL DEVTYPE;            /*PUT IN TO THE PRINT LINE      @Z427VLS*/
         BAL   @14,DEVTYPE                                         0513
*   CALL DOCUX;              /*PUT THE CUX INTO THE PRINT LINE       */
         BAL   @14,DOCUX                                           0514
*  END;                                                    /*@Z427VLS*/
* IF DEBUG22 = ON THEN                                             0516
@RF00507 TM    DEBUG22(R2),B'00000010'                             0516
         BNO   @RF00516                                            0516
*  DO;                                                     /*@Z427VLS*/
* PRTLINE = BUG22MSG;           /*MOVE IN A LABLE FOR DEBUG DATA  */
         MVI   PRTLINE+16,C' '                                     0518
         MVC   PRTLINE+17(135),PRTLINE+16                          0518
         MVC   PRTLINE(16),BUG22MSG                                0518
*   DECADDR= ADDR(TOTE2) + 3;   /*ADDRESS OF WHERE TO PUT THE DATA */
         LA    @03,TOTE2                                           0519
         AL    @03,@CF00073                                        0519
         ST    @03,DECADDR                                         0519
*   BINWORD = NUMP;               /*NUMBER OF TIMES THIS PRIME CPU   */
         L     @03,NUMP                                            0520
         ST    @03,BINWORD                                         0520
*   CALL CONVBIN;                 /*GO CONVERT TO PRINTABLE  @Z427VLS*/
         BAL   @14,CONVBIN                                         0521
*   DO R = 1 BY 1 TO NUMTODO -1;  /*SET UP LOOP CONTROLS FOR ALL CPUS*/
         LA    @03,1                                               0522
         ST    @03,R                                               0522
         B     @DE00522                                            0522
@DL00522 DS    0H                                                  0523
*    DECADDR= DECADDR+ TEN;       /*MOVE DOWN THE PRINT LINE @Z427VLS*/
         L     @15,DECADDR                                         0523
         AL    @15,TEN                                             0523
         ST    @15,DECADDR                                         0523
*    BINWORD = NUMS(R);           /*LOAD COUNT OF ITEM IN SEC CPU    */
         SLA   @03,2                                               0524
         L     @03,NUMS-4(@03)                                     0524
         ST    @03,BINWORD                                         0524
*    CALL CONVBIN;                /*CONVERT # OF ITEMS SUMED THIS CPU*/
         BAL   @14,CONVBIN                                         0525
*   END;                                                   /*@Z427VLS*/
         LA    @03,1                                               0526
         AL    @03,R                                               0526
         ST    @03,R                                               0526
@DE00522 L     @15,NUMTODO                                         0526
         BCTR  @15,0                                               0526
         CR    @03,@15                                             0526
         BNH   @DL00522                                            0526
*   CALL PRINTIT;                 /*GO PRINT THE DEBUG COUNTS        */
         BAL   @14,PRINTIT                                         0527
*   NUMP = ZERO;                  /*CLEAR THE COUNTER        @Z427VLS*/
         SLR   @03,@03                                             0528
         ST    @03,NUMP                                            0528
*   GEN(XC NUMS(64),NUMS);        /*CLEAR THE ARRAY          @Z427VLS*/
         XC NUMS(64),NUMS
*  END;                                                    /*@Z427VLS*/
* GEN(XC  SHRFLGS(16),SHRFLGS);/*CLEAR PRINT FLAGS FOR NEXT ENTRY    */
@RF00516 DS    0H                                                  0531
         XC  SHRFLGS(16),SHRFLGS
* GEN(MVI SYS2TEMP,X'00');   /*CAN'T DO ALL FOUR AT ONCE DO TO COMPLI*/
         MVI SYS2TEMP,X'00'
* GEN(MVC SYS2TEMP+1(127),SYS2TEMP);/*MAY PUT SINGLE ITEMS AWAY FROM */
         MVC SYS2TEMP+1(127),SYS2TEMP
*                            /*WHERE IT PUTS THE ARRAYS WHY(?)       */
*END;                                                      /*@Z427VLS*/
@EL00015 DS    0H                                                  0534
@EF00015 DS    0H                                                  0534
@ER00015 LM    @14,@12,@SA00015                                    0534
         BR    @14                                                 0534
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL DO THE WORK OF ADDING THE RECORDS UP   @Z427VLS*/
*/*    SHRFLGS SETTING OF THIS TABLE IS TO SUPPRES THE # OF ZERO'S   */
*/*    IN THE PRINT OUT WITH A BYTE FOR EACH CPU & ONE FOR THE TOTALS*/
*/*    THE TOTALS IS ALWAYS INIT TO ONE SO ALWAYS PRINT TOTAL       */
*/*    FOR THE REST IF NO DATA FROM CPU PRIME OR SECONDARY THE NOTHIN*/
*/*                                                          @Z427VLS*/
*DOCOUNT:  PROC;                                           /*@Z427VLS*/
DOCOUNT  STM   @14,@12,12(@13)                                     0535
*       R8 = LASTCPU + '10'X;      /*PICK UP PRIME CPU       @Z427VLS*/
         LA    R8,16                                               0536
         AL    R8,LASTCPU                                          0536
*       SRL(R8,FOUR);             /*SET UP FOR INDEXING      @Z427VLS*/
         SRL   R8,4                                                0537
*       SHRFLGS(R8) = ON;                                  /*@Z427VLS*/
         LA    @03,1                                               0538
         STC   @03,SHRFLGS-1(R8)                                   0538
*       IF DEBUG22 = ON THEN      /*COUNT THE NUMBER FOR EACH SORT B */
         TM    DEBUG22(R2),B'00000010'                             0539
         BNO   @RF00539                                            0539
*        DO;                                               /*@Z427VLS*/
*         NUMP = NUMP + ONE;      /*COUNT OF # OF PRIME THIS SORT BRE*/
         L     @03,ONE                                             0541
         L     @15,NUMP                                            0541
         ALR   @15,@03                                             0541
         ST    @15,NUMP                                            0541
*         NUMS(R8) = NUMS(R8) + ONE;/*SECONDARY CPU THIS SORT BREAK  */
         LR    @15,R8                                              0542
         SLA   @15,2                                               0542
         AL    @03,NUMS-4(@15)                                     0542
         ST    @03,NUMS-4(@15)                                     0542
*        END;                                              /*@Z427VLS*/
*       R9 = R8;                  /*SAVE FOR LATTER USE      @Z427VLS*/
@RF00539 LR    R9,R8                                               0544
*       R8 = (SYSITEM(CT) & '0F'X) + ONE;/*INX TO POINTER TO OLD CPU*/
         L     @03,ONE                                             0545
         L     @15,CT                                              0545
         MH    @15,@CH00703                                        0545
         L     @14,SORTADR(,R2)                                    0545
         LA    R8,15                                               0545
         LA    @01,0(@15,@14)                                      0545
         AL    @01,@CF00911                                        0545
         SLR   @00,@00                                             0545
         IC    @00,SYSITEM-4(,@01)                                 0545
         NR    R8,@00                                              0545
         ALR   R8,@03                                              0545
*       SHRFLGS(R8) = ON;         /*A PRINT TIME IF ZERO NO PRINT    */
         LA    @07,1                                               0546
         STC   @07,SHRFLGS-1(R8)                                   0546
*     SYS2TPRM = SYS2TPRM + SYSPERM(CT);                   /*@0099VLS*/
         ST    @15,@TF00001                                        0547
         ALR   @15,@14                                             0547
         AL    @15,@CF00912                                        0547
         ICM   @15,12,SYSPERM-7(@15)                               0547
         SRA   @15,16                                              0547
         L     @07,SYS2TPRM                                        0547
         ALR   @07,@15                                             0547
         ST    @07,SYS2TPRM                                        0547
*     SYS2PERM(R8) = SYS2PERM(R8) + SYSPERM(CT);           /*@0099VLS*/
         LR    @07,R8                                              0548
         SLA   @07,2                                               0548
         L     @06,SYS2PERM-4(@07)                                 0548
         ALR   @06,@15                                             0548
         ST    @06,SYS2PERM-4(@07)                                 0548
*     TOTALPRM(R8) = TOTALPRM(R8) + SYSPERM(CT);           /*@0099VLS*/
         L     @06,TOTALPRM-4(@07)                                 0549
         ALR   @06,@15                                             0549
         ST    @06,TOTALPRM-4(@07)                                 0549
*     TOTALTOT = TOTALTOT + SYSPERM(CT);                   /*@0099VLS*/
         AL    @15,TOTALTOT                                        0550
         ST    @15,TOTALTOT                                        0550
*       SYS2TEMP(R8) = SYS2TEMP(R8) + SYSTEMP(CT);         /*@Z427VLS*/
         AL    @14,@TF00001                                        0551
         AL    @14,@CF00913                                        0551
         ICM   @15,15,SYSTEMP-9(@14)                               0551
         L     @14,SYS2TEMP-4(@07)                                 0551
         ALR   @14,@15                                             0551
         ST    @14,SYS2TEMP-4(@07)                                 0551
*       SYS2TTOT = SYS2TTOT + SYSTEMP(CT);                 /*@Z427VLS*/
         L     @14,SYS2TTOT                                        0552
         ALR   @14,@15                                             0552
         ST    @14,SYS2TTOT                                        0552
*         TOTALTP = TOTALTP+ SYSTEMP(CT);                  /*@Z427VLS*/
         L     @14,TOTALTP                                         0553
         ALR   @14,@15                                             0553
         ST    @14,TOTALTP                                         0553
*         TOTALTMP(R8) = TOTALTMP(R8) + SYSTEMP(CT);       /*@Z427VLS*/
         AL    @15,TOTALTMP-4(@07)                                 0554
         ST    @15,TOTALTMP-4(@07)                                 0554
*       IF DEBUG18 = ON THEN                                       0555
         TM    DEBUG18(R2),B'00100000'                             0555
         BNO   @RF00555                                            0555
*        DO;                                               /*@Z427VLS*/
*         DBUGCT(OLDGROUP) = DBUGCT(OLDGROUP) + ONE;       /*@Z427VLS*/
         L     @06,OLDGROUP                                        0557
         SLA   @06,2                                               0557
         L     @15,DBUGCT-4(@06)                                   0557
         ALR   @15,@03                                             0557
         ST    @15,DBUGCT-4(@06)                                   0557
*         PRIMEYES(R8) = PRIMEYES(R8) + ONE;               /*@Z427VLS*/
         L     @06,PRIMEYES-4(@07)                                 0558
         ALR   @06,@03                                             0558
         ST    @06,PRIMEYES-4(@07)                                 0558
*         IF R8 ^= R9 THEN           /*IS THE ENTRY FROM A SHARED DEV*/
         CR    R8,R9                                               0559
         BE    @RF00559                                            0559
*         PRIMENO(R9) = PRIMENO(R9) + ONE;                 /*@Z427VLS*/
         LR    @15,R9                                              0560
         SLA   @15,2                                               0560
         AL    @03,PRIMENO-4(@15)                                  0560
         ST    @03,PRIMENO-4(@15)                                  0560
*        END;                                              /*@Z427VLS*/
@RF00559 DS    0H                                                  0562
*       CT = CT + ONE;                                     /*@Z427VLS*/
@RF00555 L     @03,CT                                              0562
         AL    @03,ONE                                             0562
         ST    @03,CT                                              0562
*END;                                                      /*@Z427VLS*/
@EL00016 DS    0H                                                  0563
@EF00016 DS    0H                                                  0563
@ER00016 LM    @14,@12,12(@13)                                     0563
         BR    @14                                                 0563
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL MOVE THE DEVICE TYPE INTO THE PRINT BUFFER     */
*/*    IF THE DEVICE TYPE IS ALL ZEROS WORD UKNO IS MOVED IN @Z427VLS*/
*/*                                                          @Z427VLS*/
*DEVTYPE: PROC;                                            /*@Z427VLS*/
DEVTYPE  STM   @14,@12,@SA00017                                    0564
*IF SYSDEV(CT) ^= '0000'X THEN                                     0565
         L     @03,CT                                              0565
         MH    @03,@CH00703                                        0565
         L     @15,SORTADR(,R2)                                    0565
         ST    @03,@TF00001                                        0565
         ALR   @03,@15                                             0565
         AL    @03,@CF00909                                        0565
         CLC   SYSDEV-5(2,@03),@CB00206                            0565
         BE    @RF00565                                            0565
* DO;                                                      /*@Z427VLS*/
* ADDNXT = ADDR(DEVTYP);          /*SET UP WHERE TO PUT CONVERTED    */
         LA    @03,DEVTYP                                          0567
         ST    @03,ADDNXT                                          0567
* NUMBER = TWO;                   /*SET UP TO CHANGE 2 BYTES TO PRINT*/
         L     @03,TWO                                             0568
         ST    @03,NUMBER                                          0568
* NEXTBY = ADDR(SYSDEV(CT));      /*ADDRESS OF WHERE TO GET THE DATA */
         L     @03,@TF00001                                        0569
         AL    @15,@CF00909                                        0569
         LA    @03,SYSDEV-5(@03,@15)                               0569
         ST    @03,NEXTBY                                          0569
* CALL CONVERT;                   /*GO CONVERT THE ITEM TO PRINTABLE */
         BAL   @14,CONVERT                                         0570
* END;                                                     /*@Z427VLS*/
* ELSE                                                             0572
* DEVTYP = UKNO;                  /*MOVE UKNO INTO PRINT BUFFER      */
         B     @RC00565                                            0572
@RF00565 MVC   DEVTYP(4),UKNO                                      0572
* SAVEDEV = SYSDEV(CT);   /*SAVE FOR LATER CHECK             @Z427VLS*/
@RC00565 L     @03,CT                                              0573
         MH    @03,@CH00703                                        0573
         L     @01,SORTADR(,R2)                                    0573
         ALR   @01,@03                                             0573
         AL    @01,@CF00909                                        0573
         MVC   SAVEDEV(2),SYSDEV-5(@01)                            0573
*END;                                                      /*@Z427VLS*/
@EL00017 DS    0H                                                  0574
@EF00017 DS    0H                                                  0574
@ER00017 LM    @14,@12,@SA00017                                    0574
         BR    @14                                                 0574
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL MOVE THE CUA INTO THE PRINT BUFFER AND FOR SOME*/
*/*    GROUPS WILL FORCE AN X IN THE LAST POSITION OF THE CUA        */
*/*                                                          @Z427VLS*/
*DOCUX: PROC;                                              /*@Z427VLS*/
DOCUX    STM   @14,@12,@SA00018                                    0575
* ADDNXT = ADDR(CUX);             /*SET UP WHERE TO PUT CONVERTED    */
         LA    @03,CUX                                             0576
         ST    @03,ADDNXT                                          0576
* NUMBER = TWO;                   /*SET UP TO CHANGE 2 BYTES TO PRINT*/
         L     @03,TWO                                             0577
         ST    @03,NUMBER                                          0577
* SWITCH1 = ON;                   /*SET NOT TO USE 1/2 OF FIRST BYTE */
         OI    SWITCH1,B'10000000'                                 0578
* R8 = SYSRT(CT);                 /*PULL UP WORD WITH CUX INFO       */
         L     @03,CT                                              0579
         MH    @03,@CH00703                                        0579
         L     @01,SORTADR(,R2)                                    0579
         ALR   @01,@03                                             0579
         AL    @01,@CF00914                                        0579
         SLR   R8,R8                                               0579
         ICM   R8,3,SYSRT-1(@01)                                   0579
* SRL(R8,FOUR);                   /*DUMP JUNK BITS & POSITION CORRECT*/
         SRL   R8,4                                                0580
* TEMPCUA =  R8;                  /*SET VALUE IN ITEM TO CONVERT     */
         STH   R8,TEMPCUA                                          0581
* NEXTBY = ADDR(TEMPCUA);         /*SET UP ADDRESS OF WHERE DATA KEPT*/
         LA    @03,TEMPCUA                                         0582
         ST    @03,NEXTBY                                          0582
* CALL CONVERT;                   /*GO CONVERT THE DATA TO PRINTABLE */
         BAL   @14,CONVERT                                         0583
* IF SYSGROUP(CT) = TWO                                           0584
*    SYSGROUP(CT) = THREE                                         0584
*    SYSGROUP(CT) = FOUR                                           0584
*   THEN                                                           0584
         L     @03,CT                                              0584
         MH    @03,@CH00703                                        0584
         L     @01,SORTADR(,R2)                                    0584
         AL    @01,@CF00915                                        0584
         SLR   @15,@15                                             0584
         IC    @15,SYSGROUP(@03,@01)                               0584
         C     @15,TWO                                             0584
         BE    @RT00584                                            0584
         C     @15,@CF00073                                        0584
         BE    @RT00584                                            0584
         C     @15,@CF00060                                        0584
         BNE   @RF00584                                            0584
@RT00584 DS    0H                                                  0585
*     GEN(MVI  CUX+3,X'E7');       /*MOVE IN TO LAST BYTE AN 'X'    */
         MVI  CUX+3,X'E7'
*END;                                                      /*@Z427VLS*/
@EL00018 DS    0H                                                  0586
@EF00018 DS    0H                                                  0586
@ER00018 LM    @14,@12,@SA00018                                    0586
         BR    @14                                                 0586
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PRINT OUT THE HEADING FOR THE SECOND PART      */
*/*                                                          @Z427VLS*/
*HEADING2:  PROC;                                          /*@Z427VLS*/
HEADING2 STM   @14,@12,@SA00019                                    0587
*  IF SWITCH2 = OFF THEN /*AVOID A BLANK PAGE                @Z427VLS*/
         TM    SWITCH2,B'01000000'                                 0588
         BNZ   @RF00588                                            0588
*  DO;                                                     /*@Z427VLS*/
*  SPACING = UPSPACE;    /*LET'S START ON A FRESH PAGE BY SKIP CHN 1 */
         MVC   SPACING(1),UPSPACE                                  0590
*  MYLINECT = ZERO;                                        /*@Z427VLS*/
         SLR   @03,@03                                             0591
         ST    @03,MYLINECT                                        0591
*  CALL PRINTIT;         /*GP SKIP TO CHANNEL ONE            @Z427VLS*/
         BAL   @14,PRINTIT                                         0592
*  END;                                                    /*@Z427VLS*/
*  SPACING = SINGLE ;    /*RESTORE THE SPACING TO SINGLE     @Z427VLS*/
@RF00588 MVC   SPACING(1),SINGLE                                   0594
*  PART1 = PART2;        /*SET UP THE FIRST LINE TO REFLECT SECOND   */
         MVC   PART1(8),PART2                                      0595
*  CHANGE1 = CHANGE2 ;   /*CHANGE SECOND LINE TO 2 PART OF OUTPUT    */
         MVC   CHANGE1(23),CHANGE2                                 0596
*  HEADMOVE = LINE1;     /*MOVE IN THE FIRST LINE TO BUFFER  @Z427VLS*/
         MVC   HEADMOVE(59),LINE1                                  0597
*  CALL PRINTIT;         /*GO & PRINT OUT THE FIRST LINE     @Z427VLS*/
         BAL   @14,PRINTIT                                         0598
*  HEADMOVE = LINE2;     /*MOVE SECOND LINE TO THE OUTPUT BUFFER     */
         MVC   HEADMOVE(59),LINE2                                  0599
*  CALL PRINTIT;         /*GO AND PRINT THE OUTPUT           @Z427VLS*/
         BAL   @14,PRINTIT                                         0600
*  HEADMOVE = LINE3;     /*MOVE IN THE THIRD LINE OF HEADING @Z427VLS*/
         MVC   HEADMOVE(59),LINE3                                  0601
*  CALL PRINTIT;         /*GO & PRINT THE LINE               @Z427VLS*/
         BAL   @14,PRINTIT                                         0602
*END;                                                      /*@Z427VLS*/
@EL00019 DS    0H                                                  0603
@EF00019 DS    0H                                                  0603
@ER00019 LM    @14,@12,@SA00019                                    0603
         BR    @14                                                 0603
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL SETUP LINKAGE TO ACCESS I/O SERVICE PRINT      */
*/*                                                          @Z427VLS*/
*PRINTIT: PROC;                                            /*@Z427VLS*/
PRINTIT  STM   @14,@12,@SA00020                                    0604
*  PRINTADR = ADDR(PRINTLNE); /*HAVE TO PASS I/O ADDRESS OF BUFFER   */
         LA    @03,PRINTLNE                                        0605
         ST    @03,PRINTADR(,R2)                                   0605
*  CALL IOHND(RITEPRTR);      /*PASS CONTROL TO I/O HANDLER  @Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0606
         LA    @01,@AL00606                                        0606
         BALR  @14,@15                                             0606
*  IF SPACING= SINGLE & DDTYPE = '0' THEN                          0607
         CLC   SPACING(1),SINGLE                                   0607
         BNE   @RF00607                                            0607
         CLI   DDTYPE,C'0'                                         0607
         BNE   @RF00607                                            0607
*   MYLINECT = MYLINECT + ONE;                             /*@Z427VLS*/
         L     @03,MYLINECT                                        0608
         AL    @03,ONE                                             0608
         ST    @03,MYLINECT                                        0608
*   ELSE                                                           0609
*    IF SPACING= DOUBLE THEN  /*DOUBLE SPACING               @Z427VLS*/
         B     @RC00607                                            0609
@RF00607 CLC   SPACING(1),DOUBLE                                   0609
         BNE   @RF00609                                            0609
*     MYLINECT = MYLINECT + TWO; /*ADD 2 TO THE COUNT        @Z427VLS*/
         L     @03,MYLINECT                                        0610
         AL    @03,TWO                                             0610
         ST    @03,MYLINECT                                        0610
*      ELSE                                                        0611
*       IF SPACING = TRIPLE      /* RIGHT,TRIPLE SPACING     @Z427VLS*/
*         THEN MYLINECT = MYLINECT + THREE;/*OTHER WISE UPSPACE      */
         B     @RC00609                                            0611
@RF00609 CLC   SPACING(1),TRIPLE                                   0611
         BNE   @RF00611                                            0611
         LA    @03,3                                               0612
         AL    @03,MYLINECT                                        0612
         ST    @03,MYLINECT                                        0612
*       ELSE                                                       0613
*        IF SPACING = UPSPACE THEN /*DO WE NEED TO RESET COUNT       */
         B     @RC00611                                            0613
@RF00611 CLC   SPACING(1),UPSPACE                                  0613
         BNE   @RF00613                                            0613
*          MYLINECT = ZERO;      /*AVOID MULTI UPSPACES      @Z427VLS*/
         SLR   @03,@03                                             0614
         ST    @03,MYLINECT                                        0614
*    IF MYLINECT =>  LINECT      /*LINECT SET BY USER DEFAULT = 50   */
*      THEN                                                        0615
@RF00613 DS    0H                                                  0615
@RC00611 DS    0H                                                  0615
@RC00609 DS    0H                                                  0615
@RC00607 L     @03,MYLINECT                                        0615
         CH    @03,LINECT(,R2)                                     0615
         BL    @RF00615                                            0615
*       DO;                                                /*@Z427VLS*/
*        SPACING= UPSPACE;       /*CHANGE THE CHARIAGE CONTROL CHAR  */
         MVC   SPACING(1),UPSPACE                                  0617
*        MYLINECT = ZERO;                                  /*@Z427VLS*/
         SLR   @03,@03                                             0618
         ST    @03,MYLINECT                                        0618
*        PRINTADR = ADDR(PRINTLNE);                        /*@Z427VLS*/
         LA    @03,PRINTLNE                                        0619
         ST    @03,PRINTADR(,R2)                                   0619
*        CALL IOHND(RITEPRTR);                             /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0620
         LA    @01,@AL00620                                        0620
         BALR  @14,@15                                             0620
*        SPACING= SINGLE;        /*CHANGE CC BACK TO SINGLE SPACE    */
         MVC   SPACING(1),SINGLE                                   0621
*        IF SWITCH3 = ON THEN    /*MAKE SURE WE ARE IN PART 2        */
         TM    SWITCH3,B'00100000'                                 0622
         BNO   @RF00622                                            0622
*        SWITCH2 = ON;           /*IF PART TWO WANT NEW HEADING      */
         OI    SWITCH2,B'01000000'                                 0623
*       END;                                               /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00020 DS    0H                                                  0625
@EF00020 DS    0H                                                  0625
@ER00020 LM    @14,@12,@SA00020                                    0625
         BR    @14                                                 0625
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*    THIS PROC WILL BUILD THE COUNTS FOR PART TWO OF THE REPORT    */
*/*    THE TABLE BEING USED IS BUILT BY IFCFILT2 PRIOR TO THIS BEING */
*/*    CALLED.  3705 IS BROKEN OUT AS IT HAD EXTRA BREAK POINT AND  */
*/*    DID NOT FIT INTO OVER ALL SET UP.  WILL PROCESS UP TO 16      */
*/*    DIFFERENT CPUS BUT WILL ONLY PRINT OUT 11 (MAX FIT ON PAGE)   */
*/*    WAS EASIER TO DO IT THIS WAY IF EVER DECIDED TO USE A WRAP    */
*/*    AROUND IDEA TO PRINT ALL 16 GOOD LUCK AS WILL BE ALL BROKEN UP*/
*/*    NOTE IF GROUP ORDER IS CHANGED SYSUM WILL FALL APART MAKE SURE*/
*/*    THEY ARE ADDED AT THE BOTTOM IN IFCFILT2 THEN THERE WILL BE   */
*/*    IMPACT ONLY TO DEVGROUP                               @Z427VLS*/
*/*    THE FOLLOWING IS THE LAY OUT OF THE TABLE USED BY TOTAL2      */
*/*                                                          @Z427VLS*/
*/*     DCL   1    SYSUM2(*)   BASED(SORTADR), SORTADR SET BY FILT2 **/
*/*            2   SYSUMKEY,                                 @Z427VLS*/
*/*             3  SYSGROUP   FIXED(8) BDY(BYTE)             @Z427VLS*/
*/*             3  SYSRT      BIT(16)                        @Z427VLS*/
*/*              4 SYSCUA     BIT(12)                        @Z427VLS*/
*/*              4   *        BIT(4)                         @Z427VLS*/
*/*             3  SYSCPUS    BIT(8)                         @Z427VLS*/
*/*              4 SYSCPU     BIT(4)                         @Z427VLS*/
*/*              4 SYSOLD     BIT(4)  WILL ALWAYS BE ZERO    @Z427VLS*/
*/*            2   SYSITEM    BIT(8)                         @Z427VLS*/
*/*             3  SYS3705    BIT(4)                         @Z427VLS*/
*/*             3  SYSOLDA    BIT(4)                         @Z427VLS*/
*/*            2   SYSDEV     CHAR(2)                        @Z427VLS*/
*/*            2   SYSTEMP    FIXED(31)                      @Z427VLS*/
*/*             3  SYSPERM    BIT(1)                         @Z427VLS*/
*/*             3     *       BIT(15)                        @Z427VLS*/
*/*                                                          @Z427VLS*/
*TOTAL2: PROC;                                             /*@Z427VLS*/
TOTAL2   STM   @14,@12,@SA00021                                    0626
* MAXLIMIT = SORTNUM;                                      /*@Z427VLS*/
         L     @03,SORTNUM(,R2)                                    0627
         ST    @03,MAXLIMIT                                        0627
* OLDGROUP=  SYSGROUP(ONE);       /*SET INITIAL GROUP CONTROL       */
         L     @03,ONE                                             0628
         MH    @03,@CH00703                                        0628
         L     @15,SORTADR(,R2)                                    0628
         AL    @03,@CF00915                                        0628
         SLR   @14,@14                                             0628
         IC    @14,SYSGROUP(@03,@15)                               0628
         ST    @14,OLDGROUP                                        0628
* LASTCPU = (SYSCPUS(1) & 'F0'X); /*SET CPU = FIRST ENTRY FOR FIRST  */
         LA    @03,240                                             0629
         SLR   @14,@14                                             0629
         IC    @14,SYSCPUS(,@15)                                   0629
         NR    @03,@14                                             0629
         ST    @03,LASTCPU                                         0629
* LASTCUA = (SYSRT(1) ); /*SET CUA = FIRST ENTRY FOR FIRST   @Z427VLS*/
         SLR   @03,@03                                             0630
         ICM   @03,3,SYSRT(@15)                                    0630
         ST    @03,LASTCUA                                         0630
* CALL TOPLINE;                   /*PRINT OUT TOTAL PERM TEMP WORDS  */
         BAL   @14,TOPLINE                                         0631
* CT = ONE;                       /*SET UP THE INDEX         @Z427VLS*/
         L     @03,ONE                                             0632
         ST    @03,CT                                              0632
* DO UNTIL (CT  > MAXLIMIT);                               /*@Z427VLS*/
@DL00633 DS    0H                                                  0634
*    IF OLDGROUP ^= FIVE THEN /*3705 TAKEN CARE OF IN NEXT PROC  */
         L     @03,FIVE                                            0634
         C     @03,OLDGROUP                                        0634
         BE    @RF00634                                            0634
*     DO;                                                  /*@0001VLS*/
*       IF   MYLINECT > (LINECT - FIVE )  THEN                     0636
         LCR   @03,@03                                             0636
         AH    @03,LINECT(,R2)                                     0636
         C     @03,MYLINECT                                        0636
         BNL   @RF00636                                            0636
*         CALL HEAD2P;         /*HEADING WITH GROUP          @0001VLS*/
         BAL   @14,HEAD2P                                          0637
*        ELSE                                                      0638
*         CALL PRTGROUP;       /*JUST PRINT THE GROUP LABLE  @0001VLS*/
         B     @RC00636                                            0638
@RF00636 BAL   @14,PRTGROUP                                        0638
*     END;                                                 /*@0001VLS*/
@RC00636 DS    0H                                                  0640
* DO UNTIL(CT > MAXLIMIT        /*GROUP IS MAJOR BREAKPOINT @ZA25332*/
*   OLDGROUP  ^=  SYSGROUP(CT));                           /*@ZA25332*/
@RF00634 DS    0H                                                  0640
@DL00640 DS    0H                                                  0641
*    IF OLDGROUP = FIVE           /*3705 IS SPECIAL PAIN IN THE      */
*      THEN                                                        0641
         CLC   OLDGROUP(4),FIVE                                    0641
         BNE   @RF00641                                            0641
*       CALL DO3705;                                       /*@Z427VLS*/
         BAL   @14,DO3705                                          0642
*    IF CT ^> MAXLIMIT THEN                                        0643
@RF00641 L     @03,CT                                              0643
         C     @03,MAXLIMIT                                        0643
         BH    @RF00643                                            0643
*    DO;                                                   /*@Z427VLS*/
*   CALL DOCUX;                    /* MOVE IN THE CUA OR CUX @0001VLS*/
         BAL   @14,DOCUX                                           0645
*   CALL DEVTYPE;                  /* MOVE IN THE DEVICE TYPE        */
         BAL   @14,DEVTYPE                                         0646
* DO UNTIL(CT > MAXLIMIT          /*SECOND MAJOR BREAKPOINT @ZA25332*/
*    (SYSRT(CT)) ^= LASTCUA)                              /*@ZA25332*/
*            OLDGROUP^= SYSGROUP(CT);                      /*@Z427VLS*/
@DL00647 DS    0H                                                  0648
*     CALL DOCUX;                                          /*@Z427VLS*/
         BAL   @14,DOCUX                                           0648
* DO UNTIL(CT > MAXLIMIT          /*THIRD  MAJOR BREAKPOINT @ZA25332*/
*    (SYSCPUS(CT) & 'F0'X) ^= LASTCPU                              0649
*              LASTCUA ^=(SYSRT(CT) )                             0649
*              OLDGROUP^= SYSGROUP(CT));                  /*@Z427VLS*/
@DL00649 DS    0H                                                  0650
*              CALL DOCOUNT;       /*GO ADD UP HTE RECORDS   @Z427VLS*/
         BAL   @14,DOCOUNT                                         0650
*     END;                                                 /*@Z427VLS*/
@DE00649 L     @03,CT                                              0651
         C     @03,MAXLIMIT                                        0651
         BH    @DC00649                                            0651
         MH    @03,@CH00703                                        0651
         L     @15,SORTADR(,R2)                                    0651
         LA    @14,240                                             0651
         LA    @01,0(@03,@15)                                      0651
         AL    @01,@CF00917                                        0651
         SLR   @00,@00                                             0651
         IC    @00,SYSCPUS-3(,@01)                                 0651
         NR    @14,@00                                             0651
         C     @14,LASTCPU                                         0651
         BNE   @DC00649                                            0651
         L     @14,LASTCUA                                         0651
         ST    @03,@TF00001                                        0651
         ALR   @03,@15                                             0651
         AL    @03,@CF00914                                        0651
         SLR   @07,@07                                             0651
         ICM   @07,3,SYSRT-1(@03)                                  0651
         CR    @14,@07                                             0651
         BNE   @DC00649                                            0651
         L     @03,OLDGROUP                                        0651
         L     @14,@TF00001                                        0651
         AL    @15,@CF00915                                        0651
         SLR   @07,@07                                             0651
         IC    @07,SYSGROUP(@14,@15)                               0651
         CR    @03,@07                                             0651
         BE    @DL00649                                            0651
@DC00649 DS    0H                                                  0652
*    CALL DATALINE ;               /*GO PRINT THE DATA ACCUMLATED   */
         BAL   @14,DATALINE                                        0652
*    IF CT ^> MAXLIMIT THEN                                        0653
         L     @03,CT                                              0653
         C     @03,MAXLIMIT                                        0653
         BH    @RF00653                                            0653
*      LASTCPU = (SYSCPUS(CT) &'F0'X);                     /*@Z427VLS*/
         MH    @03,@CH00703                                        0654
         L     @01,SORTADR(,R2)                                    0654
         LA    @00,240                                             0654
         AL    @01,@CF00917                                        0654
         SLR   @15,@15                                             0654
         IC    @15,SYSCPUS-3(@03,@01)                              0654
         NR    @00,@15                                             0654
         ST    @00,LASTCPU                                         0654
*    END;                                                  /*@Z427VLS*/
@RF00653 DS    0H                                                  0655
@DE00647 L     @03,CT                                              0655
         C     @03,MAXLIMIT                                        0655
         BH    @DC00647                                            0655
         MH    @03,@CH00703                                        0655
         L     @15,SORTADR(,R2)                                    0655
         ST    @03,@TF00001                                        0655
         ALR   @03,@15                                             0655
         AL    @03,@CF00914                                        0655
         SLR   @14,@14                                             0655
         ICM   @14,3,SYSRT-1(@03)                                  0655
         C     @14,LASTCUA                                         0655
         BNE   @DC00647                                            0655
         L     @03,OLDGROUP                                        0655
         L     @14,@TF00001                                        0655
         AL    @15,@CF00915                                        0655
         SLR   @07,@07                                             0655
         IC    @07,SYSGROUP(@14,@15)                               0655
         CR    @03,@07                                             0655
         BE    @DL00647                                            0655
@DC00647 DS    0H                                                  0656
*    IF CT ^> MAXLIMIT THEN                                        0656
         L     @03,CT                                              0656
         C     @03,MAXLIMIT                                        0656
         BH    @RF00656                                            0656
*      LASTCUA = (SYSRT(CT) );/*SET FOR NEW CUA              @Z427VLS*/
         MH    @03,@CH00703                                        0657
         L     @01,SORTADR(,R2)                                    0657
         ALR   @01,@03                                             0657
         AL    @01,@CF00914                                        0657
         SLR   @03,@03                                             0657
         ICM   @03,3,SYSRT-1(@01)                                  0657
         ST    @03,LASTCUA                                         0657
*  END;                                                    /*@Z427VLS*/
@RF00656 DS    0H                                                  0659
* END;                                                     /*@Z427VLS*/
@RF00643 DS    0H                                                  0659
@DE00640 L     @03,CT                                              0659
         C     @03,MAXLIMIT                                        0659
         BH    @DC00640                                            0659
         MH    @03,@CH00703                                        0659
         L     @01,SORTADR(,R2)                                    0659
         L     @00,OLDGROUP                                        0659
         AL    @01,@CF00915                                        0659
         SLR   @15,@15                                             0659
         IC    @15,SYSGROUP(@03,@01)                               0659
         CR    @00,@15                                             0659
         BE    @DL00640                                            0659
@DC00640 DS    0H                                                  0660
*  IF CT ^> MAXLIMIT THEN                                          0660
         L     @03,CT                                              0660
         C     @03,MAXLIMIT                                        0660
         BH    @RF00660                                            0660
*    OLDGROUP = SYSGROUP(CT);    /*RESET THE CONTROL TO NEW GROUP   */
         MH    @03,@CH00703                                        0661
         L     @01,SORTADR(,R2)                                    0661
         AL    @01,@CF00915                                        0661
         SLR   @00,@00                                             0661
         IC    @00,SYSGROUP(@03,@01)                               0661
         ST    @00,OLDGROUP                                        0661
*  SPACING = DOUBLE;                                       /*@Z427VLS*/
@RF00660 MVC   SPACING(1),DOUBLE                                   0662
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0663
*  SPACING = SINGLE;                                       /*@Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0664
*END;                                                      /*@Z427VLS*/
@DE00633 L     @03,CT                                              0665
         C     @03,MAXLIMIT                                        0665
         BNH   @DL00633                                            0665
*CALL ALLTOTAL;                /*PRINT TOTAL OF ALL COLUMNS  @Z427VLS*/
         BAL   @14,ALLTOTAL                                        0666
* END;                                                     /*@Z427VLS*/
@EL00021 DS    0H                                                  0667
@EF00021 DS    0H                                                  0667
@ER00021 LM    @14,@12,@SA00021                                    0667
         BR    @14                                                 0667
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*     THIS PROC WILL PROCESS GROUP 4(3705 TYPES) AS THEY REQUIRE   */
*/*     SPECIAL PROCESSING  THEY ARE DONE COMPLETLY IN THIS PROC     */
*/*     UPON EXIT ALL ITEM WILL BE SET TO PROCESS FOLLOWING GROUPS   */
*DO3705: PROC;                                             /*@Z427VLS*/
DO3705   STM   @14,@12,@SA00022                                    0668
* IF MYLINECT > LINECT - TWELVE                                    0669
*  THEN                                                            0669
         LH    @03,LINECT(,R2)                                     0669
         SL    @03,@CF00064                                        0669
         C     @03,MYLINECT                                        0669
         BNL   @RF00669                                            0669
*   CALL HEAD2P;               /*HEADING WITH THE GROUP LABLE      */
         BAL   @14,HEAD2P                                          0670
*  ELSE                                                            0671
*   CALL PRTGROUP;             /*JUST PRINT THE GROUP OUT    @0001VLS*/
         B     @RC00669                                            0671
@RF00669 BAL   @14,PRTGROUP                                        0671
* DO UNTIL(CT > MAXLIMIT                                  /*@ZA25332*/
*   OLDGROUP  ^=  SYSGROUP(CT));                           /*@ZA25332*/
@RC00669 DS    0H                                                  0672
@DL00672 DS    0H                                                  0673
*   LASTCPU = (SYSCPUS(CT) & 'F0'X);/*SET UP LAST CPU CONTROL       */
         LA    @03,240                                             0673
         L     @15,CT                                              0673
         MH    @15,@CH00703                                        0673
         L     @14,SORTADR(,R2)                                    0673
         LA    @01,0(@15,@14)                                      0673
         AL    @01,@CF00917                                        0673
         SLR   @00,@00                                             0673
         IC    @00,SYSCPUS-3(,@01)                                 0673
         NR    @00,@03                                             0673
         ST    @00,LASTCPU                                         0673
*   LASTCUA = (SYSRT(CT) ); /*SET UP LAST CUA                @Z427VLS*/
         ST    @15,@TF00001                                        0674
         ALR   @15,@14                                             0674
         AL    @15,@CF00914                                        0674
         SLR   @07,@07                                             0674
         ICM   @07,3,SYSRT-1(@15)                                  0674
         ST    @07,LASTCUA                                         0674
*   OLD3705 =(SYSITEM(CT)& 'F0'X); /*SET 3705 ODD BREAK POINT       */
         L     @15,@TF00001                                        0675
         AL    @14,@CF00911                                        0675
         SLR   @07,@07                                             0675
         IC    @07,SYSITEM-4(@15,@14)                              0675
         NR    @03,@07                                             0675
         ST    @03,OLD3705                                         0675
* DO UNTIL(CT > MAXLIMIT                                  /*@ZA25332*/
*   LASTCUA ^= (SYSRT(CT) & 'FFF0'X)    /*CHECK FOR NEW CUA  @ZA25332*/
*           OLDGROUP^= SYSGROUP(CT));                     /*@Z427VLS*/
@DL00676 DS    0H                                                  0677
*  IF MYLINECT  >  LINECT - EIGHT THEN /*MUST HAVE ROOM FOR ALL   */
         LH    @03,LINECT(,R2)                                     0677
         SL    @03,@CF00062                                        0677
         C     @03,MYLINECT                                        0677
         BNL   @RF00677                                            0677
*   CALL HEAD2P;              /*THEN PRINT HEADING WITH GROUP      */
         BAL   @14,HEAD2P                                          0678
*   CALL DEVTYPE;                  /*GO MOVE IN DEVICE TYPE  @Z427VLS*/
@RF00677 BAL   @14,DEVTYPE                                         0679
*   CALL DOCUX;                    /*GO MOVE IN THE CUX      @Z427VLS*/
         BAL   @14,DOCUX                                           0680
*   CALL PRINTIT;                  /*GO PRINT THE DEVICE TYPE & CUA  */
         BAL   @14,PRINTIT                                         0681
*     DO UNTIL (CT > MAXLIMIT      /*DO ALL OF SAME CPU      @XA21538*/
*        (SYSCPUS(CT) & 'F0'X) ^= LASTCPU /*                @XA21538*/
*        (LASTCUA ^= (SYSRT(CT) ))                                0682
*        OLDGROUP ^= SYSGROUP(CT));                       /*@Z427VLS*/
@DL00682 DS    0H                                                  0683
*       R8 = SYSITEM(CT) + '10'X;   /*ADD ONE TO 3705 VALUE  @Z427VLS*/
         L     @03,CT                                              0683
         MH    @03,@CH00703                                        0683
         L     @01,SORTADR(,R2)                                    0683
         LA    R8,16                                               0683
         AL    @01,@CF00911                                        0683
         SLR   @00,@00                                             0683
         IC    @00,SYSITEM-4(@03,@01)                              0683
         ALR   R8,@00                                              0683
*       SRL(R8,FOUR);                                      /*@Z427VLS*/
         SRL   R8,4                                                0684
*       AT3705 = IS3705(R8);                               /*@Z427VLS*/
         LR    @03,R8                                              0685
         MH    @03,@CH00078                                        0685
         LA    @01,IS3705-6(@03)                                   0685
         MVC   AT3705(6),0(@01)                                    0685
* DO UNTIL(CT > MAXLIMIT                                  /*@ZA25332*/
*   OLD3705 ^= (SYSITEM(CT) & 'F0'X)                       /*@ZA25332*/
*                (SYSCPUS(CT) & 'F0'X) ^= LASTCPU                 0686
*                 LASTCUA ^= (SYSRT(CT) & 'FFF0'X)                0686
*                 OLDGROUP^= SYSGROUP(CT));               /*@Z427VLS*/
@DL00686 DS    0H                                                  0687
*         CALL DOCOUNT;             /*GO PROCESS ALL RECORDS @Z427VLS*/
         BAL   @14,DOCOUNT                                         0687
*       END;                                               /*@Z427VLS*/
@DE00686 L     @03,CT                                              0688
         C     @03,MAXLIMIT                                        0688
         BH    @DC00686                                            0688
         LA    @15,240                                             0688
         MH    @03,@CH00703                                        0688
         L     @14,SORTADR(,R2)                                    0688
         LA    @01,0(@03,@14)                                      0688
         AL    @01,@CF00911                                        0688
         SLR   @00,@00                                             0688
         IC    @00,SYSITEM-4(,@01)                                 0688
         NR    @00,@15                                             0688
         C     @00,OLD3705                                         0688
         BNE   @DC00686                                            0688
         LA    @01,0(@03,@14)                                      0688
         AL    @01,@CF00917                                        0688
         SLR   @00,@00                                             0688
         IC    @00,SYSCPUS-3(,@01)                                 0688
         NR    @15,@00                                             0688
         C     @15,LASTCPU                                         0688
         BNE   @DC00686                                            0688
         L     @15,@CF00889                                        0688
         ST    @03,@TF00001                                        0688
         ALR   @03,@14                                             0688
         AL    @03,@CF00914                                        0688
         SLR   @07,@07                                             0688
         ICM   @07,3,SYSRT-1(@03)                                  0688
         NR    @15,@07                                             0688
         C     @15,LASTCUA                                         0688
         BNE   @DC00686                                            0688
         L     @03,OLDGROUP                                        0688
         L     @15,@TF00001                                        0688
         AL    @14,@CF00915                                        0688
         SLR   @07,@07                                             0688
         IC    @07,SYSGROUP(@15,@14)                               0688
         CR    @03,@07                                             0688
         BE    @DL00686                                            0688
@DC00686 DS    0H                                                  0689
*       CALL DATALINE;              /*GO BUILD THE DATA LINE FOR PRT */
         BAL   @14,DATALINE                                        0689
*       IF CT ^> MAXLIMIT THEN                                     0690
         L     @03,CT                                              0690
         C     @03,MAXLIMIT                                        0690
         BH    @RF00690                                            0690
*         OLD3705 =(SYSITEM(CT) & 'F0'X);/*CHANGE CONTROL    @Z427VLS*/
         MH    @03,@CH00703                                        0691
         L     @01,SORTADR(,R2)                                    0691
         LA    @00,240                                             0691
         AL    @01,@CF00911                                        0691
         SLR   @15,@15                                             0691
         IC    @15,SYSITEM-4(@03,@01)                              0691
         NR    @00,@15                                             0691
         ST    @00,OLD3705                                         0691
*     END;                                                 /*@Z427VLS*/
@RF00690 DS    0H                                                  0692
@DE00682 L     @03,CT                                              0692
         C     @03,MAXLIMIT                                        0692
         BH    @DC00682                                            0692
         MH    @03,@CH00703                                        0692
         L     @15,SORTADR(,R2)                                    0692
         LA    @14,240                                             0692
         LA    @01,0(@03,@15)                                      0692
         AL    @01,@CF00917                                        0692
         SLR   @00,@00                                             0692
         IC    @00,SYSCPUS-3(,@01)                                 0692
         NR    @14,@00                                             0692
         C     @14,LASTCPU                                         0692
         BNE   @DC00682                                            0692
         L     @14,LASTCUA                                         0692
         ST    @03,@TF00001                                        0692
         ALR   @03,@15                                             0692
         AL    @03,@CF00914                                        0692
         SLR   @07,@07                                             0692
         ICM   @07,3,SYSRT-1(@03)                                  0692
         CR    @14,@07                                             0692
         BNE   @DC00682                                            0692
         L     @03,OLDGROUP                                        0692
         L     @14,@TF00001                                        0692
         AL    @15,@CF00915                                        0692
         SLR   @07,@07                                             0692
         IC    @07,SYSGROUP(@14,@15)                               0692
         CR    @03,@07                                             0692
         BE    @DL00682                                            0692
@DC00682 DS    0H                                                  0693
*    IF CT ^> MAXLIMIT THEN                                        0693
         L     @03,CT                                              0693
         C     @03,MAXLIMIT                                        0693
         BH    @RF00693                                            0693
*      LASTCPU =(SYSCPUS(CT) & 'F0'X);                     /*@Z427VLS*/
         MH    @03,@CH00703                                        0694
         L     @01,SORTADR(,R2)                                    0694
         LA    @00,240                                             0694
         AL    @01,@CF00917                                        0694
         SLR   @15,@15                                             0694
         IC    @15,SYSCPUS-3(@03,@01)                              0694
         NR    @00,@15                                             0694
         ST    @00,LASTCPU                                         0694
*   END;                                                   /*@Z427VLS*/
@RF00693 DS    0H                                                  0695
@DE00676 L     @03,CT                                              0695
         C     @03,MAXLIMIT                                        0695
         BH    @DC00676                                            0695
         MH    @03,@CH00703                                        0695
         L     @15,SORTADR(,R2)                                    0695
         L     @14,@CF00889                                        0695
         ST    @03,@TF00001                                        0695
         ALR   @03,@15                                             0695
         AL    @03,@CF00914                                        0695
         SLR   @07,@07                                             0695
         ICM   @07,3,SYSRT-1(@03)                                  0695
         NR    @14,@07                                             0695
         C     @14,LASTCUA                                         0695
         BNE   @DC00676                                            0695
         L     @03,OLDGROUP                                        0695
         L     @14,@TF00001                                        0695
         AL    @15,@CF00915                                        0695
         SLR   @07,@07                                             0695
         IC    @07,SYSGROUP(@14,@15)                               0695
         CR    @03,@07                                             0695
         BE    @DL00676                                            0695
@DC00676 DS    0H                                                  0696
*  END;                                                    /*@Z427VLS*/
@DE00672 L     @03,CT                                              0696
         C     @03,MAXLIMIT                                        0696
         BH    @DC00672                                            0696
         MH    @03,@CH00703                                        0696
         L     @01,SORTADR(,R2)                                    0696
         L     @00,OLDGROUP                                        0696
         AL    @01,@CF00915                                        0696
         SLR   @15,@15                                             0696
         IC    @15,SYSGROUP(@03,@01)                               0696
         CR    @00,@15                                             0696
         BE    @DL00672                                            0696
@DC00672 DS    0H                                                  0697
*END;                                                      /*@Z427VLS*/
@EL00022 DS    0H                                                  0697
@EF00022 DS    0H                                                  0697
@ER00022 LM    @14,@12,@SA00022                                    0697
         BR    @14                                                 0697
*/*****************************************************************/
*/*            PROC WILL PRINT THE HEADING FOR PART 2 WITH THE GROUP*/
*/*            INFORMATION ALSO                              @0001VLS*/
*HEAD2P: PROC;                                             /*@0001VLS*/
HEAD2P   STM   @14,@12,@SA00023                                    0698
* CALL HEADING2 ;              /*PRINT THE TOP PART OF THE HEADING*/
         BAL   @14,HEADING2                                        0699
* CALL TOPLINE;                /*PRINT THE CPU TYPES ACROSS THE PAGE*/
         BAL   @14,TOPLINE                                         0700
* CALL PRTGROUP;               /*PRINT THE GROUP TYPE LABLE  @0001VLS*/
         BAL   @14,PRTGROUP                                        0701
*END;                                                      /*@0001VLS*/
@EL00023 DS    0H                                                  0702
@EF00023 DS    0H                                                  0702
@ER00023 LM    @14,@12,@SA00023                                    0702
         BR    @14                                                 0702
*/********************************************************************/
*/*    THIS PROC WILL PRINT OUT THE DEVICE GROUP             @Z427VLS*/
*PRTGROUP: PROC;                                           /*@Z427VLS*/
PRTGROUP STM   @14,@12,@SA00024                                    0703
* IF OLDGROUP ^= ZERO THEN                                         0704
         L     @03,OLDGROUP                                        0704
         LTR   @03,@03                                             0704
         BZ    @RF00704                                            0704
*   DO;                                                    /*@Z427VLS*/
*  IF MYLINECT => LINECT - 3 THEN                                  0706
         LH    @03,LINECT(,R2)                                     0706
         SL    @03,@CF00073                                        0706
         C     @03,MYLINECT                                        0706
         BH    @RF00706                                            0706
*  DO;                                                     /*@Z427VLS*/
*   CALL HEADING2;                                         /*@Z427VLS*/
         BAL   @14,HEADING2                                        0708
*   CALL TOPLINE;                                          /*@Z427VLS*/
         BAL   @14,TOPLINE                                         0709
*  END;                                                    /*@Z427VLS*/
* DEVGRP = DEVGROUP(OLDGROUP);/*MOVE THE NAME INTO THE PRINT LINE  */
@RF00706 L     @03,OLDGROUP                                        0711
         SLA   @03,3                                               0711
         LA    @01,DEVGROUP-8(@03)                                 0711
         MVC   DEVGRP(8),0(@01)                                    0711
* R9 = 15 + 10 * EVNUM;   /*# OF ASTRICKS TO BUILD           @Z427VLS*/
         L     @03,EVPTR(,R2)                                      0712
         LH    R9,EVNUM(,@03)                                      0712
         MH    R9,@CH00272                                         0712
         AL    R9,@CF00035                                         0712
* GEN(MVI PRTLINE+10,X'5C');                               /*@Z427VLS*/
         MVI PRTLINE+10,X'5C'
* GEN(EX  R9,MOVEGRP);                                     /*@Z427VLS*/
         EX  R9,MOVEGRP
* GENERATE DATA;                                           /*@Z427VLS*/
* CALL PRINTIT;               /*PRINT THE GROUP LABLE        @Z427VLS*/
         BAL   @14,PRINTIT                                         0716
* CALL PRINTIT;               /*ADD A SPACE                  @Z427VLS*/
         BAL   @14,PRINTIT                                         0717
*END;                                                      /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00024 DS    0H                                                  0719
@EF00024 DS    0H                                                  0719
@ER00024 LM    @14,@12,@SA00024                                    0719
         BR    @14                                                 0719
*/********************************************************************/
*/*    THIS PROC WILL PRINT TOTALS OF EACH CPU               @Z427VLS*/
* ALLTOTAL: PROC;                                          /*@Z427VLS*/
ALLTOTAL STM   @14,@12,@SA00025                                    0720
*  PRTLINE = TOTLABLE;       /*MOVE IN THE LABLE FOR LINE    @Z427VLS*/
         MVI   PRTLINE+6,C' '                                      0721
         MVC   PRTLINE+7(145),PRTLINE+6                            0721
         MVC   PRTLINE(6),TOTLABLE                                 0721
*  BNDECNUM = FIVE;          /*FOR THE TOTAL OF TOTALS       @Z427VLS*/
         L     @03,FIVE                                            0722
         ST    @03,BNDECNUM                                        0722
*  BINWORD = TOTALTOT;       /*PRINT TOTAL OF THE TOTALS     @Z427VLS*/
         L     @03,TOTALTOT                                        0723
         ST    @03,BINWORD                                         0723
*  DECADDR = ADDR(TOTE2) - 3;                              /*@Z427VLS*/
         LA    @03,TOTE2                                           0724
         SL    @03,@CF00073                                        0724
         ST    @03,DECADDR                                         0724
*  CALL CONVBIN;             /*GO CONVERT THE ITEM TO PRINTABLE      */
         BAL   @14,CONVBIN                                         0725
*  DECADDR = DECADDR + SIX; /*MOVE DOWN THE PRINT LINE BY SIX      */
         L     @03,DECADDR                                         0726
         AL    @03,SIX                                             0726
         ST    @03,DECADDR                                         0726
*  BINWORD = TOTALTP;        /*PICK UP TOTA OF TEMP TOTALS MAY OVER  */
         L     @03,TOTALTP                                         0727
         ST    @03,BINWORD                                         0727
*                            /*FLOW 5 PRINT POSITIONS BUT THATS TO BD*/
*  CALL CONVBIN;             /*GO AND CONVERT THE ITEM TO PRINTABLE  */
         BAL   @14,CONVBIN                                         0728
*  DECADDR = DECADDR + 2;                                  /*@Z427VLS*/
         LA    @03,2                                               0729
         AL    @03,DECADDR                                         0729
         ST    @03,DECADDR                                         0729
*  BNDECNUM = FOUR;          /*CHANGE BACK TO ONLY FOUR CHARS OUT    */
         MVC   BNDECNUM(4),@CF00060                                0730
*  DO R = 1 BY 1 TO NUMTODO -ONE;                          /*@Z427VLS*/
         LA    @03,1                                               0731
         ST    @03,R                                               0731
         B     @DE00731                                            0731
@DL00731 DS    0H                                                  0732
*   DECADDR = DECADDR + FIVE;/*MOVE DOWN THE LINE FIVE PRINT POSITION*/
         L     @15,DECADDR                                         0732
         AL    @15,FIVE                                            0732
         ST    @15,DECADDR                                         0732
*   BINWORD = TOTALPRM(R);   /*PICK UP TOTAL PERM ERRORS THIS ENTRY */
         SLA   @03,2                                               0733
         L     @03,TOTALPRM-4(@03)                                 0733
         ST    @03,BINWORD                                         0733
*   CALL CONVBIN;            /*GO CONVERT TO PRINTABLE       @Z427VLS*/
         BAL   @14,CONVBIN                                         0734
*   DECADDR = DECADDR + FIVE;/*RIGHT DOWN THE PRINT LINE 5 MORE CHARS*/
         L     @03,DECADDR                                         0735
         AL    @03,FIVE                                            0735
         ST    @03,DECADDR                                         0735
*   BINWORD = TOTALTMP(R);   /*PICK UP THE NEXT TEMP TOTAL   @Z427VLS*/
         L     @03,R                                               0736
         SLA   @03,2                                               0736
         L     @03,TOTALTMP-4(@03)                                 0736
         ST    @03,BINWORD                                         0736
*   CALL CONVBIN;            /*GO CONVERT THE ITEM TO PRINTABLE      */
         BAL   @14,CONVBIN                                         0737
*  END;                                                    /*@Z427VLS*/
         LA    @03,1                                               0738
         AL    @03,R                                               0738
         ST    @03,R                                               0738
@DE00731 L     @15,NUMTODO                                         0738
         SL    @15,ONE                                             0738
         CR    @03,@15                                             0738
         BNH   @DL00731                                            0738
* END;                                                     /*@Z427VLS*/
@EL00025 DS    0H                                                  0739
@EF00025 DS    0H                                                  0739
@ER00025 LM    @14,@12,@SA00025                                    0739
         BR    @14                                                 0739
@PB00025 DS    0H                                                  0740
*/********************************************************************/
*/*    THIS IS THE MAIN BODY OF THE PROGRAM                  @Z427VLS*/
*/*    THE TABLES BUILT IN THE PARM TABLE BY IFCFILT2 ARE    @Z427VLS*/
*/*                   USED BY TOTAL1 OF THIS SECTION-THE ITEMS HAVE  */
*/*                   BEEN TOTALED BY THE FILTER AND ARE JUST        */
*/*                   FORMATED & THEN PRINTED BY THIS SECTION        */
*/*                   USED BY TOTAL2 IS FOR THE SECOND PART OF THE   */
*/*                   REPORT  THESE ITEMS HAVE NOT BEEN TOTALED THIS */
*/*                   IS DONE BY THIS SECTION ONE LINE AT A TIME THEN*/
*/*                   PRINTED  ONLY GLITCH IS CAUSED BY THE 3705     */
*IF DEBUG4  = ON THEN        /*PRINT NAME AND COMPILE DATE   @Z427VLS*/
         TM    DEBUG4(R2),B'00001000'                              0740
         BNO   @RF00740                                            0740
* DO;                                                      /*@Z427VLS*/
*  DDTYPE = '1';                                           /*@Z427VLS*/
         MVI   DDTYPE,C'1'                                         0742
*  R15 = R10 - 27;                                         /*@Z427VLS*/
         LR    R15,R10                                             0743
         SL    R15,@CF00899                                        0743
*  GEN(MVC  PRTLINE(16),0(R15));                           /*@Z427VLS*/
         MVC  PRTLINE(16),0(R15)
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0745
*  DDTYPE = '0';                                           /*@Z427VLS*/
         MVI   DDTYPE,C'0'                                         0746
* END;                                                     /*@Z427VLS*/
*NUMTODO = EVNUM + ONE;      /*SET UP LOOP CONTROL           @Z427VLS*/
@RF00740 L     @03,EVPTR(,R2)                                      0748
         LH    @03,EVNUM(,@03)                                     0748
         AL    @03,ONE                                             0748
         ST    @03,NUMTODO                                         0748
*CALL HEADING1;              /*GO PRINT OUT THE HEADING      @Z427VLS*/
         BAL   @14,HEADING1                                        0749
*CALL TOTAL1;                /*GO COMPUTE THE TOTALS AND PRINT THEM  */
         BAL   @14,TOTAL1                                          0750
*CALL CPUINFO;              /*PRINT THE CPU AND LETTER ASSOCIATED   */
         BAL   @14,CPUINFO                                         0751
*IF SORTNUM ^= ZERO THEN                                           0752
         L     @03,SORTNUM(,R2)                                    0752
         LTR   @03,@03                                             0752
         BZ    @RF00752                                            0752
*DO;                                                       /*@Z427VLS*/
*SWITCH3 = ON;               /*TELL  PRINTIT WE ARE DOING PART 2     */
         OI    SWITCH3,B'00100000'                                 0754
*CALL HEADING2;              /*GO PRINT OUT THE HEADING PART 2       */
         BAL   @14,HEADING2                                        0755
*CALL TOTAL2;                /*GO ADD UP THE TOTALS FOR PART 2       */
         BAL   @14,TOTAL2                                          0756
*CALL CPUINFO;              /*PRINT OUT THE CPU AND LETTER   @Z427VLS*/
         BAL   @14,CPUINFO                                         0757
*IF DEBUG18 = ON THEN       /*USER WANTS EXTRA DATA ABOUT THE PROGRAM*/
         TM    DEBUG18(R2),B'00100000'                             0758
         BNO   @RF00758                                            0758
* CALL DODEBUG;                                            /*@Z427VLS*/
         BAL   @14,DODEBUG                                         0759
*END;                                                      /*@Z427VLS*/
@RF00758 DS    0H                                                  0761
*IF DEBUG12 = ON THEN       /*USER REQUESTED US TO DUMP CORE @Z427VLS*/
@RF00752 TM    DEBUG12(R2),B'00001000'                             0761
         BNO   @RF00761                                            0761
* GEN(ABEND  240,DUMP);                                    /*@Z427VLS*/
         ABEND  240,DUMP
*/********************************************************************/
*/********************************************************************/
*RETURN;                                                   /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         0763
@EF00001 DS    0H                                                  0763
@ER00001 L     @14,12(,@13)                                        0763
         LM    @00,@12,20(@13)                                     0763
         BR    @14                                                 0763
*END                                                       /*@Z427VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 0764
         B     @EL00001                                            0764
@DATA    DS    0H
@CH00071 DC    H'2'
@CH00078 DC    H'6'
@CH00272 DC    H'10'
@CH00703 DC    H'13'
@CH00466 DC    H'17'
         DS    0F
@AL00606 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00620 DC    A(@CH00071)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00004 DS    15F
@SA00020 DS    15F
@SA00005 DS    15F
@SA00011 DS    15F
@SA00009 DS    15F
@SA00008 DS    15F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00012 DS    15F
@SA00010 DS    15F
@SA00013 DS    15F
@SA00014 DS    15F
@SA00015 DS    15F
@SA00017 DS    15F
@SA00019 DS    15F
@SA00024 DS    15F
@SA00018 DS    15F
@SA00021 DS    15F
@SA00023 DS    15F
@SA00022 DS    15F
@SA00025 DS    15F
@TF00001 DS    F
         DS    0F
@CF00073 DC    F'3'
@CF00060 DC    F'4'
@CF00080 DC    F'7'
@CF00062 DC    F'8'
@CF00064 DC    F'12'
@CF00727 DC    F'14'
@CF00035 DC    F'15'
@CF00086 DC    F'16'
@CF00719 DC    F'20'
@CF00475 DC    F'22'
@CF00225 DC    F'24'
@CF00899 DC    F'27'
@CF00821 DC    F'48'
@CF00820 DC    F'52'
@CF00915 DC    F'-13'
@CF00914 DC    F'-12'
@CF00917 DC    F'-10'
@CF00911 DC    F'-9'
@CF00909 DC    F'-8'
@CF00912 DC    F'-6'
@CF00913 DC    F'-4'
@CF00907 DC    XL4'0000FFFF'
@CF00889 DC    XL4'FFF0'
@CF00052 DC    BL4'1'
         DS    0D
PRT      DC    F'0'
COUNTER  DC    F'0'
TEN      DC    F'10'
FIVE     DC    F'5'
ONE      DC    F'1'
TWOEIGHT DC    F'28'
NEXTBY   DC    F'0'
ADDNXT   DC    F'0'
BINWORD  DC    F'0'
NUMBER1  DC    F'1'
BNDECNUM DC    F'5'
DECADDR  DC    F'0'
NUMTODO  DC    F'0'
I        DC    F'0'
NUMBER   DC    F'0'
TWO      DC    F'2'
MINUS1   DC    F'-1'
SPCHANGE DC    F'0'
J        DC    F'0'
SYS2TPRM DC    F'0'
SYS2TTOT DC    F'0'
X        DC    F'0'
SIX      DC    F'6'
L        DC    F'0'
P        DC    F'0'
R        DC    F'0'
CT       DC    F'0'
OLDGROUP DC    F'0'
LASTCUA  DC    F'0'
MYLINECT DC    F'0'
NUMP     DC    F'0'
LASTCPU  DC    F'0'
OLD3705  DC    F'0'
TOTALTOT DC    F'0'
TOTALTP  DC    F'0'
BIGPERM  DC    F'0'
MAXLIMIT DC    F'0'
TEMPCUA  DC    H'0'
@CB00206 DC    X'0000'
PRINTLNE DS    CL134
         ORG   PRINTLNE
DDTYPE   DC    CL1'0'
SPACING  DC    CL1' '
PRTLINE  DC    CL152' '
         ORG   PRINTLNE+154
TOTAHED  DC    CL121'TOTAL CPU-A CPU-B CPU-C CPU-D CPU-E CPU-F CPU-G CPC
               U-H CPU-I CPU-J CPU-K CPU-L CPU-M CPU-N CPU-O CPU-P     C
               '
PART2    DC    CL8'(PART 2)'
HEADING  DS    CL177
         ORG   HEADING
LINE1    DS    CL59
         ORG   LINE1
@NM00015 DC    CL53'S Y S T E M  S U M M A R Y               REPORT DATC
               E '
DAYSDATE DC    CL6'XXX XX'
         ORG   HEADING+59
LINE2    DS    CL59
         ORG   LINE2
@NM00016 DC    CL9'         '
PART1    DC    CL8'(PART 1)'
@NM00017 DC    CL36'                        PERIOD FROM '
FROMDATE DC    CL3'   '
@NM00018 DC    CL1' '
FROMYEAR DC    CL2'  '
         ORG   HEADING+118
LINE3    DS    CL59
         ORG   LINE3
CHANGE   DC    CL23'CPU/CHANNEL/STORAGE/SCP'
@NM00019 DC    CL30'                           TO '
TODATE   DC    CL3'   '
@NM00020 DC    CL1' '
TOYEAR   DC    CL2'  '
         ORG   HEADING+177
CPULINE  DC    CL24'CPU   MODEL   SERIAL NO.'
CPUDATA  DC    CL22' '
         ORG   CPUDATA
@NM00021 DS    CL1
CPUTYPE  DS    CL1
@NM00022 DS    CL5
CPUMODEL DS    CL3
@NM00023 DS    CL6
CPUSERAL DS    CL6
         ORG   CPUDATA+22
CHANGE2  DC    CL23'      I/O SUBSYSTEM    '
UPSPACE  DC    X'89'
SINGLE   DC    X'09'
DOUBLE   DC    X'11'
NOTAPPLY DC    CL8'  N/A   '
CHARS    DC    CL16'0123456789ABCDEF'
         DS    CL4
WORK     DS    CL8
BUG18    DC    CL19'DEBUG18 INFORMATION'
SPCHNG   DC    CL50' '
         ORG   SPCHNG
SPNUM    DS    CL5
@NM00024 DC    CL45'     SAME CUA # WITH DIFFERENT DEVICES TYPES'
         ORG   SPCHNG+50
SHAREFLG DS    CL17
         ORG   SHAREFLG
TOTFLG   DC    BL1'1'
SHRFLGS  DC    16AL1(0)
         ORG   SHAREFLG+17
SWITCHE  DC    AL1(0)
         ORG   SWITCHE
SWITCH1  DS    BL1
SWITCH2  EQU   SWITCHE+0
SWITCH3  EQU   SWITCHE+0
SWITCH4  EQU   SWITCHE+0
         ORG   SWITCHE+1
TRIPLE   DC    X'1B'
UKNO     DC    CL4'UKNO'
TOTLABLE DC    CL6'TOTALS'
TOTCT    DC    CL13'TOTAL RECORDS'
BUG22MSG DC    CL16'COUNT/BREAKPOINT'
HEAD20   DS    CL135
         ORG   HEAD20
@NM00025 DC    CL12' '
@NM00026 DC    CL13'PERM  TEMP   '
@NM00027 DC    11CL10'PERM TEMP '
         ORG   HEAD20+135
BUGHEAD  DS    CL16
         ORG   BUGHEAD
@NM00028 DC    CL16'    DEBUG COUNTS'
         ORG   BUGHEAD+16
HEAD2    DC    CL132' '
         ORG   HEAD2
@NM00031 DC    CL15' '
@NM00032 DC    CL5'TOTAL'
@NM00033 DC    CL2'  '
@NM00034 DC    CL10'     CPU-A'
         DC    CL10'     CPU-B'
         DC    CL10'     CPU-C'
         DC    CL10'     CPU-D'
         DC    CL10'     CPU-E'
         DC    CL10'     CPU-F'
         DC    CL10'     CPU-G'
         DC    CL10'     CPU-H'
         DC    CL10'     CPU-I'
         DC    CL10'     CPU-J'
         DS    1XL10
         ORG   HEAD2+132
DBUGCT1  DS    CL34
         ORG   DBUGCT1
@NM00035 DC    CL11'CPU COUNTS '
@NM00036 DC    CL11'AS PRIMARY '
@NM00037 DC    CL12'AS SECONDARY'
         ORG   DBUGCT1+34
TOTALS   DS    CL22
         ORG   TOTALS
TOTALCT  DC    CL6'      '
@NM00038 DC    CL16'  OVER ALL COUNT'
         ORG   TOTALS+22
GROUPCT  DS    CL32
         ORG   GROUPCT
GROUPNUM DC    CL6'      '
@NM00039 DC    CL2'  '
@NM00040 DC    CL14'ITEMS IN GROUP'
@NM00041 DC    CL2'  '
GPNAME   DC    CL8'        '
         ORG   GROUPCT+32
SAVEDEV  DC    X'0000'
         DS    CL4
DBLWORD  DS    CL8
SUPERZAP DC    3CL10'SUPERZAP'
DISCRIPT DC    CL17'IPL              '
         DC    CL17'MACHINE CHECK    '
         DC    CL17'  RECOVERABLE    '
         DC    CL17'  NON-RECOVERABLE'
         DC    CL17'CHANNEL CHECK    '
         DC    CL17'  CHANNEL 0      '
         DC    CL17'  CHANNEL 1      '
         DC    CL17'  CHANNEL 2      '
         DC    CL17'  CHANNEL 3      '
         DC    CL17'  CHANNEL 4      '
         DC    CL17'  CHANNEL 5      '
         DC    CL17'  CHANNEL 6      '
         DC    CL17'  CHANNEL 7      '
         DC    CL17'  CHANNEL 8      '
         DC    CL17'  CHANNEL 9      '
         DC    CL17'  CHANNEL A      '
         DC    CL17'  CHANNEL B      '
         DC    CL17'  CHANNEL C      '
         DC    CL17'  CHANNEL D      '
         DC    CL17'  CHANNEL E      '
         DC    CL17'  CHANNEL F      '
         DC    CL17'PROGRAM ERROR    '
         DC    CL17' PRGM INT        '
         DC    CL17' ABEND           '
         DC    CL17' RESTART         '
         DC    CL17'END OF DAY       '
DEVGROUP DC    CL8'CONS +UR'
         DC    CL8'DASD    '
         DC    CL8'TAPE    '
         DC    CL8'DISPLAY '
         DC    CL8'TP CNTRL'
         DC    CL8'TERMINAL'
         DS    2XL8
IS3705   DC    CL6'CNTRLR'
         DC    CL6'NCP   '
         DC    CL6'LINES '
         DS    CL2
SYS2TEMP DC    16F'0'
SYS2PERM DC    16F'0'
NUMS     DC    16F'0'
PATCH    DC    20F'0'
DBUGCT   DC    16F'0'
TOTALTMP DC    16F'0'
TOTALPRM DC    17F'0'
PRIMEYES DC    16F'0'
PRIMENO  DC    16F'0'
IFCSYSUM CSECT
         DC    S(SUPERZAP)
IFCSYSUM CSECT
    DC  S(PATCH)
IFCSYSUM CSECT
MVCINS  MVC   R0(R0,R6),0(R8)
IFCSYSUM CSECT
MOVETOTL   MVC  R0(R0,R6),0(R8)
IFCSYSUM CSECT
MOVEGRP  MVC   PRTLINE+11(0),PRTLINE+10
IFCSYSUM CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ADDRSAVE EQU   @03
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
R2       EQU   @02
R6       EQU   @06
R8       EQU   @08
R9       EQU   @09
R15      EQU   @15
R0       EQU   @00
R1       EQU   @01
R13      EQU   @13
R14      EQU   @14
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R7       EQU   @07
IOHND    EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
DEBUG    EQU   PARM+4
DEBUG4   EQU   DEBUG
DEBUG12  EQU   DEBUG+1
DEBUG18  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
EVSYEAR  EQU   STRTDATE
EVSDAY   EQU   STRTDATE+1
@NM00007 EQU   PARM+75
SORTNUM  EQU   PARM+84
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
LINECT   EQU   PARM+120
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVYEAR   EQU   EVSTOP
EVDAY    EQU   EVSTOP+1
EVNUM    EQU   EVTABLE+4
EVKEY    EQU   EVTABLE+6
EVMODEL  EQU   EVKEY
EVSERIAL EQU   EVKEY+2
EVLETTER EQU   EVKEY+5
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUMIPL EQU   SYSUMONE+4
SYSUMNXT EQU   SYSUMONE+8
SYSUMMCR EQU   SYSUMONE+12
SYSUMMCN EQU   SYSUMONE+16
SYSUMCH  EQU   SYSUMONE+20
SYSUMPEI EQU   SYSUMONE+84
SYSUMPEA EQU   SYSUMONE+88
SYSUMPER EQU   SYSUMONE+92
SYSUMEOD EQU   SYSUMONE+96
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSGROUP EQU   SYSUMKEY
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SYSDEV   EQU   SYSUM2+5
SYSPERM  EQU   SYSUM2+7
SYSTEMP  EQU   SYSUM2+9
SHARE    EQU   0
SHAREIO  EQU   SHARE+2
SHRCUCPU EQU   SHAREIO
SHARECUA EQU   SHRCUCPU
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
NEXTBYTE EQU   0
ADDNUM   EQU   0
IFCMSG   EQU   0
PRTOVER  EQU   PRTLINE
DATAINFO EQU   PRTOVER
TOTALHD  EQU   PRTOVER+20
TOTAL    EQU   TOTALHD
MOVECPU  EQU   PRTLINE
HEADMOVE EQU   PRTLINE
CPULINE1 EQU   PRTLINE
DEVGRP   EQU   PRTLINE
CHANGE1  EQU   CHANGE
DEVTYP   EQU   PRTLINE
CUX      EQU   PRTLINE+5
AT3705   EQU   PRTLINE+3
WORKOVER EQU   WORK
CPULETTR EQU   PRTLINE+2
NHEADL   EQU   PRTLINE
TOTE2    EQU   NHEADL+14
ERRDATA  EQU   SYSUMPEI
SHAREPT  EQU   TOTFLG
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
TEMP2    EQU   TOTE2+5
@NM00030 EQU   TOTE2+4
PERM2    EQU   TOTE2
@NM00029 EQU   NHEADL
@NM00014 EQU   TOTALHD+13
CPUA     EQU   TOTALHD+8
@NM00013 EQU   TOTALHD+5
@NM00012 EQU   PRTOVER+17
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+10
SHARSERB EQU   SHAREIO+7
SHARECUB EQU   SHAREIO+5
SHARSERA EQU   SHRCUCPU+2
SHAREDX  EQU   SHARECUA
SHARENUM EQU   SHARE
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSCUA   EQU   SYSRT
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
RECLNGTH EQU   CCHHRLNG+6
@NM00009 EQU   CCHHRLNG+5
RECCCHHR EQU   CCHHRLNG
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
TABSIZE  EQU   PARM+80
SYSRETRN EQU   @NM00007
@NM00006 EQU   PARM+72
WRTHRSH  EQU   PARM+69
RDTHRSH  EQU   PARM+66
TERM     EQU   PARM+58
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00234 EQU   @EL00005
@RF00461 EQU   @EL00014
@RF00584 EQU   @EL00018
@RF00615 EQU   @EL00020
@RF00622 EQU   @EL00020
@RF00704 EQU   @EL00024
@PB00024 EQU   @PB00025
@RF00761 EQU   @EL00001
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IFCSYSUM

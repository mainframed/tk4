         TITLE 'IFCTREND - SYSTEM SUMMARY FOR EREP PROCESSING          *
                        '
IFCTREND CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCTREND  77.315'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS IS THE ROOT SEGMENT.                                @Z427VLS*/
*/* IT EXECUTES THE PROCS WHICH PRINT PARTS 1 AND 2 OF THE TREND     */
*/* REPORT.                                                  @Z427VLS*/
*/*                                                          @Z427VLS*/
*/* PART 1 - THE TRENDONE TABLE PROVIDES CPU ERROR DATA TO PRODUCE   */
*/*          A SYSTEM OVERVIEW BY DAY, BY CPU.               @Z427VLS*/
*/*                                                          @Z427VLS*/
*  IF DEBUG4 = ON THEN       /*PRINT THE NAME AND THE COMPILE DATE   */
         TM    DEBUG4(R2),B'00001000'                              0123
         BNO   @RF00123                                            0123
*   DO;                                                    /*@Z427VLS*/
*R15 = R12 -27;                                            /*@0099VLS*/
         LR    R15,R12                                             0125
         SL    R15,@CF00672                                        0125
*    DDTYPE = '1';                                         /*@Z427VLS*/
         MVI   DDTYPE,C'1'                                         0126
*    GEN(MVC  PRTLINE(16),0(R15));                         /*@Z427VLS*/
         MVC  PRTLINE(16),0(R15)
*    CALL PRINT2;                                          /*@Z427VLS*/
         BAL   @14,PRINT2                                          0128
*    DDTYPE = '0';                                         /*@Z427VLS*/
         MVI   DDTYPE,C'0'                                         0129
*   END;                                                   /*@Z427VLS*/
*  IF DEBUG21 = ON THEN                                            0131
@RF00123 TM    DEBUG21(R2),B'00000100'                             0131
         BNO   @RF00131                                            0131
*   CALL HEXDUMP;                                          /*@Z427VLS*/
         BAL   @14,HEXDUMP                                         0132
*  CALL HEADING1;            /* PRINT REPORT HEADING.        @Z427VLS*/
@RF00131 BAL   @14,HEADING1                                        0133
*  CALL HEADING2;            /* PRINT DAY HEADING.           @Z427VLS*/
         BAL   @14,HEADING2                                        0134
*  MYLINECT = FOUR;              /* LINECT AFTER HEADER      @ZA26429*/
         MVC   MYLINECT(4),@CF00063                                0135
*  CALL CPUERREC;            /* PRINT ERROR COUNTS.          @Z427VLS*/
         BAL   @14,CPUERREC                                        0136
*  CALL CPUMODSN;            /* PRINT CPU, MODEL, SERIAL NO. LIST.   */
         BAL   @14,CPUMODSN                                        0137
*                            /* FREE TRENDONE STORAGE        @Z427VLS*/
*/* PART 2 - THE TREND2 TABLE PROVIDES I/O SUBSYSTEM ERROR DATA TO   */
*/*          PRODUCE A SUBSYSTEM SUMMARY BY DAY, BY CUA.     @Z427VLS*/
*/*                                                          @Z427VLS*/
*  IF SORTNUM ^= ZERO & DEBUG51 ^= ON THEN                         0138
         L     @03,SORTNUM(,R2)                                    0138
         LTR   @03,@03                                             0138
         BZ    @RF00138                                            0138
         TM    DEBUG51(R2),B'00010000'                             0138
         BO    @RF00138                                            0138
*    DO;                                                   /*@Z427VLS*/
*      CALL INITPRT2;        /* INITIALIZE REPORT HEADING,PARAMETERS.*/
         BAL   @14,INITPRT2                                        0140
*      CALL HEADING1;        /* PRINT REPORT HEADING.        @Z427VLS*/
         BAL   @14,HEADING1                                        0141
*      CALL HEADING2;        /* PRINT DAY HEADING.           @Z427VLS*/
         BAL   @14,HEADING2                                        0142
*      MYLINECT = FOUR;          /* LINECT AFTER HEADER      @ZA26429*/
         MVC   MYLINECT(4),@CF00063                                0143
*      CALL CUAERREC;        /* SUMMARIZE ERROR COUNTS, PRINT.       */
         BAL   @14,CUAERREC                                        0144
*      CALL CPUMODSN;        /* PRINT CPU, MODEL, SERIAL NO. LIST.   */
         BAL   @14,CPUMODSN                                        0145
*    END;                                                  /*@Z427VLS*/
*  IF DEBUG12 = ON THEN                                            0147
@RF00138 TM    DEBUG12(R2),B'00001000'                             0147
         BNO   @RF00147                                            0147
*    GEN(ABEND 340,DUMP);                                  /*@Z427VLS*/
         ABEND 340,DUMP
*  RESPECIFY (R15) RESTRICTED;                             /*@Z427VLS*/
@RF00147 DS    0H                                                  0150
*  R15 = RETCODE;            /* NORMAL RETURN                @Z427VLS*/
         LH    R15,RETCODE                                         0150
*  RESPECIFY (R15) UNRESTRICTED;                           /*@Z427VLS*/
*  RETURN;                                                 /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         0152
@EF00001 DS    0H                                                  0152
@ER00001 L     @14,12(,@13)                                        0152
         LM    @00,@12,20(@13)                                     0152
         BR    @14                                                 0152
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC PRINTS THE REPORT HEADING FOR PARTS 1 AND 2.   @Z427VLS*/
*/*                                                          @Z427VLS*/
*HEADING1:  PROC;                                          /*@Z427VLS*/
HEADING1 STM   @14,@12,@SA00002                                    0153
*  CALL PRINT2;              /* PRINT BLANK LINE - SKIP TO NEW PAGE  */
         BAL   @14,PRINT2                                          0154
*  SPACING = SINGLE;                                       /*@Z427VLS*/
         MVI   SPACING,X'09'                                       0155
*  LNESPACE = ONE;                                         /*@Z427VLS*/
         MVC   LNESPACE(4),@CF00054                                0156
*  DAYSDATE = DATENOW;       /* MOVE REPORT DATE TO PRINT LINE       */
         MVC   DAYSDATE(6),DATENOW(R2)                             0157
*  HEADMOVE = LINE1;         /* MOVE LINE 1 OF HEADING TO PRINT AREA */
         MVC   HEADMOVE(57),LINE1                                  0158
*  CALL PRINT2;              /* PRINT HEADING - 1ST LINE  - NEW PAGE */
         BAL   @14,PRINT2                                          0159
*  NUMBER = TWO;             /* TWO BYTES TO BE CONVERTED    @Z427VLS*/
         MVC   NUMBER(4),@CF00073                                  0160
*  SAVEDAY = EVSDAY;                                       /*@Z427VLS*/
         MVC   SAVEDAY(2),EVSDAY(R2)                               0161
*  SRL (SAVEDAY,FOUR);       /* REMOVE SIGN                  @Z427VLS*/
         SLR   @03,@03                                             0162
         ICM   @03,3,SAVEDAY                                       0162
         SRL   @03,4                                               0162
         STCM  @03,3,SAVEDAY                                       0162
*  NEXTBY = ADDR(SAVEDAY);   /* DATA SOURCE                  @Z427VLS*/
         LA    @03,SAVEDAY                                         0163
         ST    @03,NEXTBY                                          0163
*  ADDNXT = ADDR(FROMDATE)-1;/* DATA DESTINATION - 2ND PRINT LINE    */
         LA    @03,FROMDATE                                        0164
         BCTR  @03,0                                               0164
         ST    @03,ADDNXT                                          0164
*  SWITCH1 = ON;             /* DON'T CONVERT LEFT-MOST HALF BYTE    */
         OI    SWITCH1,B'00001000'                                 0165
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' DAY TO EBCDIC  */
         BAL   @14,CONVERT                                         0166
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/
         MVC   NUMBER(4),@CF00054                                  0167
*  NEXTBY = ADDR(EVSYEAR);   /* DATA SOURCE - PARM TABLE     @Z427VLS*/
         LA    @03,EVSYEAR(,R2)                                    0168
         ST    @03,NEXTBY                                          0168
*  ADDNXT = ADDR(FROMYEAR);  /* DATA DESTINATION - 2ND PRINT LINE    */
         LA    @03,FROMYEAR                                        0169
         ST    @03,ADDNXT                                          0169
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' YEAR TO EBCDIC */
         BAL   @14,CONVERT                                         0170
*  HEADMOVE = LINE2;         /* MOVE LINE 2 OF HEADING TO PRINT AREA */
         MVC   HEADMOVE(57),LINE2                                  0171
*  CALL PRINT2;              /* PRINT HEADING - 2ND LINE     @Z427VLS*/
         BAL   @14,PRINT2                                          0172
*  NUMBER = TWO;             /* TWO BYTES TO BE CONVERTED    @Z427VLS*/
         MVC   NUMBER(4),@CF00073                                  0173
*  SAVEDAY = EVDAY;                                        /*@Z427VLS*/
         L     @03,EVPTR(,R2)                                      0174
         MVC   SAVEDAY(2),EVDAY(@03)                               0174
*  SRL (SAVEDAY,FOUR);       /* REMOVE SIGN                  @Z427VLS*/
         SLR   @03,@03                                             0175
         ICM   @03,3,SAVEDAY                                       0175
         SRL   @03,4                                               0175
         STCM  @03,3,SAVEDAY                                       0175
*  NEXTBY = ADDR(SAVEDAY);   /* DATA SOURCE                  @Z427VLS*/
         LA    @03,SAVEDAY                                         0176
         ST    @03,NEXTBY                                          0176
*  ADDNXT = ADDR(TODATE)-1;  /* DATA DESTINATION - 3RD PRINT LINE    */
         LA    @03,TODATE                                          0177
         BCTR  @03,0                                               0177
         ST    @03,ADDNXT                                          0177
*  SWITCH1 = ON;             /* DON'T CONVERT LEFT-MOST HALF BYTE    */
         OI    SWITCH1,B'00001000'                                 0178
*  CALL CONVERT;             /* CONVERT 'PERIOD TO' DAY TO EBCDIC    */
         BAL   @14,CONVERT                                         0179
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/
         MVC   NUMBER(4),@CF00054                                  0180
*  NEXTBY = ADDR(EVYEAR);    /* DATA SOURCE - PARM TABLE     @Z427VLS*/
         L     @03,EVPTR(,R2)                                      0181
         ST    @03,NEXTBY                                          0181
*  ADDNXT = ADDR(TOYEAR);    /* DATA DESTINATION - 3RD PRINT LINE    */
         LA    @03,TOYEAR                                          0182
         ST    @03,ADDNXT                                          0182
*  CALL CONVERT;             /* CONVERT 'PERIOD TO' YEAR TO EBCDIC   */
         BAL   @14,CONVERT                                         0183
*  HEADMOVE = LINE3;         /* MOVE LINE 3 OF HEADING TO PRINT AREA */
         MVC   HEADMOVE(57),LINE3                                  0184
*  CALL PRINT2;              /* PRINT HEADING - 3RD LINE     @Z427VLS*/
         BAL   @14,PRINT2                                          0185
*END;                                                      /*@Z427VLS*/
@EL00002 DS    0H                                                  0186
@EF00002 DS    0H                                                  0186
@ER00002 LM    @14,@12,@SA00002                                    0186
         BR    @14                                                 0186
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC PRINTS THE DAY HEADING FOR PARTS 1 AND 2.      @Z427VLS*/
*/*                                                          @Z427VLS*/
*HEADING2:  PROC;                                          /*@Z427VLS*/
HEADING2 STM   @14,@12,@SA00003                                    0187
*  CALL PRINT2;              /* PRINT BLANK LINE             @Z427VLS*/
         BAL   @14,PRINT2                                          0188
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/
         MVC   NUMBER(4),@CF00054                                  0189
*  NEXTBY = ADDR(PSTYR);     /* DATA SOURCE - PARM TABLE     @Z427VLS*/
         LA    @03,PSTYR(,R2)                                      0190
         ST    @03,NEXTBY                                          0190
*  ADDNXT = ADDR(JYEAR);     /* DATA DESTINATION - 1ST PRINT LINE    */
         LA    @03,JYEAR                                           0191
         ST    @03,ADDNXT                                          0191
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' YEAR TO EBCDIC */
         BAL   @14,CONVERT                                         0192
*                            /*                              @Z427VLS*/
*                            /* CONVERT STARTING DAY FROM HEX PLUS   */
*                            /* SIGN(PACKED) TO BINARY TO COMPUTE    */
*                            /* SUCCESSIVE DAYS FOR LINE 2 OF HEADING*/
*                            /* THEN, CONVERT DAYS TO EBCDIC AND     */
*                            /* FILL IN PRINT LINE           @Z427VLS*/
*  CVB  (BINWORD,PSTDY);    /* - BINWORD - INPUT TO 'CONVBIN'       */
         XC    @TS00001(8),@TS00001                                0193
         MVC   @TS00001+6(2),PSTDY(R2)                             0193
         CVB   @03,@TS00001                                        0193
         ST    @03,BINWORD                                         0193
*  DO M = 1 TO NUMDAYS;                                    /*@Z427VLS*/
         LA    @03,1                                               0194
         B     @DE00194                                            0194
@DL00194 DS    0H                                                  0195
*    DECADDR = ADDR(DAYNO(M))+1;  /* POINT TO DAY SLOT IN PRINT LINE */
         SLA   @03,2                                               0195
         LA    @03,DAYNO-4(@03)                                    0195
         AL    @03,@CF00054                                        0195
         ST    @03,DECADDR                                         0195
*    CALL CONVBIN;                /* CONVERT DAY TO EBCDIC   @Z427VLS*/
         BAL   @14,CONVBIN                                         0196
*    IF BINWORD = 365 THEN                                         0197
         CLC   BINWORD(4),@CF00693                                 0197
         BNE   @RF00197                                            0197
*      DO;                                                 /*@Z427VLS*/
*        SAVEYR(2) = EVSYEAR;                              /*@Z427VLS*/
         MVC   SAVEYR+1(1),EVSYEAR(R2)                             0199
*        SLL (SAVEYR,FOUR);                                /*@Z427VLS*/
         SLR   @03,@03                                             0200
         ICM   @03,3,SAVEYR                                        0200
         SLL   @03,4                                               0200
         STCM  @03,3,SAVEYR                                        0200
*        SAVEYR(2) = SAVEYR(2) × SIGNPLUS;                 /*@Z427VLS*/
         OI    SAVEYR+1,X'0F'                                      0201
*        CVB (BINYR,SAVEYR);                               /*@Z427VLS*/
         XC    @TS00001(8),@TS00001                                0202
         MVC   @TS00001+6(2),SAVEYR                                0202
         CVB   @03,@TS00001                                        0202
         ST    @03,BINYR                                           0202
*        IF (BINYR/4 * 4) ^= BINYR THEN                            0203
         LR    @00,@03                                             0203
         SRDA  @00,32                                              0203
         D     @00,@CF00063                                        0203
         SLA   @01,2                                               0203
         CR    @01,@03                                             0203
         BE    @RF00203                                            0203
*          BINWORD = ZERO;        /* NORMAL YEAR             @Z427VLS*/
         SLR   @03,@03                                             0204
         ST    @03,BINWORD                                         0204
*      END;                                                /*@Z427VLS*/
*    ELSE                                                          0206
*      DO;                                                 /*@Z427VLS*/
         B     @RC00197                                            0206
@RF00197 DS    0H                                                  0207
*        IF BINWORD = 366 THEN                                     0207
         CLC   BINWORD(4),@CF00695                                 0207
         BNE   @RF00207                                            0207
*          BINWORD = ZERO;        /* RESET DAY TALLY         @Z427VLS*/
         SLR   @03,@03                                             0208
         ST    @03,BINWORD                                         0208
*      END;                                                /*@Z427VLS*/
@RF00207 DS    0H                                                  0210
*      IF BINWORD = ZERO THEN     /*GOT TO MOVE IN ANOTHER YEAR LABEL*/
@RC00197 L     @03,BINWORD                                         0210
         LTR   @03,@03                                             0210
         BNZ   @RF00210                                            0210
*       DO;                                                /*@Z427VLS*/
*        NUMBER = ONE;                                     /*@Z427VLS*/
         MVC   NUMBER(4),@CF00054                                  0212
*        NEXTBY = ADDR(PENYR);/* PICK UP NEXT YEAR           @Z427VLS*/
         LA    @03,PENYR(,R2)                                      0213
         ST    @03,NEXTBY                                          0213
*        ADDNXT =(DECADDR + 5 - ADDR(DAYNO))+ (ADDR(LN1) + EIGHT); 0214
         LA    @03,5                                               0214
         AL    @03,DECADDR                                         0214
         LA    @15,DAYNO                                           0214
         SLR   @03,@15                                             0214
         LA    @15,LN1                                             0214
         AL    @15,@CF00065                                        0214
         ALR   @03,@15                                             0214
         ST    @03,ADDNXT                                          0214
*        CALL  CONVERT;      /* GO CONVERT TO PRINT          @Z427VLS*/
         BAL   @14,CONVERT                                         0215
*       END;                                               /*@Z427VLS*/
*      BINWORD = BINWORD + ONE;   /* SET NEXT DAY            @Z427VLS*/
@RF00210 LA    @03,1                                               0217
         AL    @03,BINWORD                                         0217
         ST    @03,BINWORD                                         0217
*  END;                                                    /*@Z427VLS*/
         LA    @03,1                                               0218
         AL    @03,M                                               0218
@DE00194 ST    @03,M                                               0218
         C     @03,NUMDAYS(,R2)                                    0218
         BNH   @DL00194                                            0218
*  HD2MOVE = LN1;            /* MOVE YEAR HEADING LINE TO PRINT AREA */
         MVC   HD2MOVE(128),LN1                                    0219
*  CALL PRINT2;              /* PRINT YEAR HEADING           @Z427VLS*/
         BAL   @14,PRINT2                                          0220
*  HD2MOVE = LN2;            /* MOVE DAY HEADING LINE TO PRINT AREA  */
         MVC   HD2MOVE(128),LN2                                    0221
*  CALL PRINT2;              /* PRINT DAY HEADING            @Z427VLS*/
         BAL   @14,PRINT2                                          0222
*  CALL PRINT2;              /* BLANK LINE                   @Z427VLS*/
         BAL   @14,PRINT2                                          0223
*END;                                                      /*@Z427VLS*/
@EL00003 DS    0H                                                  0224
@EF00003 DS    0H                                                  0224
@ER00003 LM    @14,@12,@SA00003                                    0224
         BR    @14                                                 0224
*HEXDUMP: PROC;                                            /*@Z427VLS*/
HEXDUMP  STM   @14,@12,@SA00004                                    0225
*DCL BYTECT FIXED(31) INIT(0);                             /*@Z427VLS*/
*SAVEPTR = TRENPTR;                                        /*@Z427VLS*/
         L     @03,TRENPTR(,R2)                                    0227
         ST    @03,SAVEPTR                                         0227
*DDTYPE = '1';                                             /*@Z427VLS*/
         MVI   DDTYPE,C'1'                                         0228
*BYTECT =(76 * NUMDAYS) + EIGHT;                           /*@0099VLS*/
         L     @03,NUMDAYS(,R2)                                    0229
         MH    @03,@CH00700                                        0229
         AL    @03,@CF00065                                        0229
         ST    @03,BYTECT                                          0229
*DO J = 1 BY 1 TO EVNUM;                                   /*@Z427VLS*/
         LA    @03,1                                               0230
         ST    @03,J                                               0230
         B     @DE00230                                            0230
@DL00230 DS    0H                                                  0231
* NUMBER = 66;                                             /*@Z427VLS*/
         LA    @03,66                                              0231
         ST    @03,NUMBER                                          0231
* ADDNXT =ADDR(PRTLINE);                                   /*@Z427VLS*/
         LA    @15,PRTLINE                                         0232
         ST    @15,ADDNXT                                          0232
* NEXTBY = TRENPTR;                                        /*@Z427VLS*/
         L     @15,TRENPTR(,R2)                                    0233
         ST    @15,NEXTBY                                          0233
* DO I = 66 BY 66 TO BYTECT;                               /*@0099VLS*/
         ST    @03,I                                               0234
         B     @DE00234                                            0234
@DL00234 DS    0H                                                  0235
*  CALL CONVERT;                                           /*@Z427VLS*/
         BAL   @14,CONVERT                                         0235
*  NEXTBY = NEXTBY + 66;                                   /*@Z427VLS*/
         LA    @03,66                                              0236
         AL    @03,NEXTBY                                          0236
         ST    @03,NEXTBY                                          0236
*  CALL PRINT2;                                            /*@Z427VLS*/
         BAL   @14,PRINT2                                          0237
* END;                                                     /*@Z427VLS*/
         LA    @03,66                                              0238
         AL    @03,I                                               0238
         ST    @03,I                                               0238
@DE00234 C     @03,BYTECT                                          0238
         BNH   @DL00234                                            0238
* IF NUMBER = BYTECT -(J - 66) THEN                                0239
         LA    @03,66                                              0239
         SL    @03,J                                               0239
         AL    @03,BYTECT                                          0239
         C     @03,NUMBER                                          0239
         BNE   @RF00239                                            0239
*  DO;                                                     /*@Z427VLS*/
*   CALL CONVERT;                                          /*@Z427VLS*/
         BAL   @14,CONVERT                                         0241
*   CALL PRINT2;                                           /*@Z427VLS*/
         BAL   @14,PRINT2                                          0242
*  END;                                                    /*@Z427VLS*/
* TRENPTR = TRENEXT;                                       /*@Z427VLS*/
@RF00239 L     @03,TRENPTR(,R2)                                    0244
         L     @03,TRENEXT(,@03)                                   0244
         ST    @03,TRENPTR(,R2)                                    0244
*END;                                                      /*@Z427VLS*/
         LA    @03,1                                               0245
         AL    @03,J                                               0245
         ST    @03,J                                               0245
@DE00230 L     @01,EVPTR(,R2)                                      0245
         CH    @03,EVNUM(,@01)                                     0245
         BNH   @DL00230                                            0245
*TRENPTR = SAVEPTR;                                        /*@Z427VLS*/
         L     @03,SAVEPTR                                         0246
         ST    @03,TRENPTR(,R2)                                    0246
*DDTYPE = '0';                                             /*@Z427VLS*/
         MVI   DDTYPE,C'0'                                         0247
*J = ZERO;                                                 /*@Z427VLS*/
         SLR   @03,@03                                             0248
         ST    @03,J                                               0248
*X = ZERO;                                                 /*@Z427VLS*/
         ST    @03,X                                               0249
*END;                                                      /*@Z427VLS*/
@EL00004 DS    0H                                                  0250
@EF00004 DS    0H                                                  0250
@ER00004 LM    @14,@12,@SA00004                                    0250
         BR    @14                                                 0250
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC PRINTS ERROR COUNTS BY DAY BY CPU BY TYPE OF CPU       */
*/* ERROR  - I.E. - IPL, MACHINE CHECK, CHANNEL CHECK, PROGRAM ERROR */
*/*                                                          @Z427VLS*/
*CPUERREC:  PROC;                                          /*@Z427VLS*/
CPUERREC STM   @14,@12,@SA00005                                    0251
*DCL TREND6(16,30) FIXED(31) INIT((480)0);                 /*@0099VLS*/
*DCL 1 NEWSW BIT(8) INIT('00'X),                                   0253
*    2 FOUND BIT(1) ,                                              0253
*    2 OUTSWTCH BIT(1);                                    /*@0099VLS*/
*DCL NOFOUND CHAR(29) INIT('NO ERRORS FOUND FOR THIS CPU');/*@0099VLS*/
*DCL CHAN CHAR(4) INIT('CHAN');                            /*@0099VLS*/
*DCL Z1 FIXED(31) INIT(0);                                 /*@0099VLS*/
*DCL Q FIXED(31) INIT(0);                                  /*@0099VLS*/
*DCL Z2 FIXED(31) INIT(0);                                 /*@0099VLS*/
*DCL ZCPU CHAR(3) INIT('CPU');                             /*@0099VLS*/
*DCL   CHANZ(16) CHAR(6)                                           0260
*   INIT(' CHN-0',                                                 0260
*        ' CHN-1',                                                 0260
*        ' CHN-2',                                                 0260
*        ' CHN-3',                                                 0260
*        ' CHN-4',                                                 0260
*        ' CHN-5',                                                 0260
*        ' CHN-6',                                                 0260
*        ' CHN-7',                                                 0260
*        ' CHN-8',                                                 0260
*        ' CHN-9',                                                 0260
*        ' CHN-A',                                                 0260
*        ' CHN-B',                                                 0260
*        ' CHN-C',                                                 0260
*        ' CHN-D',                                                 0260
*        ' CHN-E',                                                 0260
*        ' CHN-F');                                        /*@0099VLS*/
*DCL CHANID CHAR(6) DEFINED(LIN2) POS(3);                  /*@0099VLS*/
*  SAVEPTR = TRENPTR;        /* SAVE POINTER TO ERROR TABLE - 1ST CPU*/
         L     @03,TRENPTR(,R2)                                    0262
         ST    @03,SAVEPTR                                         0262
*  DO I = 1 TO FOUR;         /* LOOP FOR 4 CPU ERROR TYPES   @Z427VLS*/
         LA    @03,1                                               0263
         ST    @03,I                                               0263
@DL00263 DS    0H                                                  0264
*    CALL PRINT1;            /* PRINT BLANK LINE             @Z427VLS*/
         BAL   @14,PRINT1                                          0264
*    DSCRPT = DESCRIPT(I);   /* MOVE ERROR TYPE TO HEADING LINE      */
         MVI   DSCRPT+13,C' '                                      0265
         MVC   DSCRPT+14(3),DSCRPT+13                              0265
         L     @03,I                                               0265
         MH    @03,@CH00540                                        0265
         LA    @01,DESCRIPT-13(@03)                                0265
         MVC   DSCRPT(13),0(@01)                                   0265
*    HD3MOVE = LIN1;         /* MOVE PRINT LINE TO PRINT AREA        */
         MVC   HD3MOVE(128),LIN1                                   0266
*    CALL PRINT1;            /* PRINT ERROR TYPE HEADING     @Z427VLS*/
         BAL   @14,PRINT1                                          0267
*    NUMCPUS = EVNUM;        /* NUMBER OF CPU'S - LOOP CONTROL       */
         L     @03,EVPTR(,R2)                                      0268
         LH    @03,EVNUM(,@03)                                     0268
         ST    @03,NUMCPUS                                         0268
*  IF I = 3 THEN                                                   0269
         CLC   I(4),@CF00075                                       0269
         BNE   @RF00269                                            0269
*   DO Q  = 1 BY 1 TO NUMCPUS;                             /*@0099VLS*/
         LA    @03,1                                               0270
         ST    @03,Q                                               0270
         B     @DE00270                                            0270
@DL00270 DS    0H                                                  0271
*   FOUND = NO;                                            /*@0099VLS*/
         NI    FOUND,B'01111111'                                   0271
*    DO J = 1 BY 1 TO NUMDAYS;                             /*@0099VLS*/
         LA    @03,1                                               0272
         ST    @03,J                                               0272
         B     @DE00272                                            0272
@DL00272 DS    0H                                                  0273
*     TREND6(1,J) = TRECCH0(J);                            /*@0099VLS*/
         LR    @15,@03                                             0273
         SLA   @15,2                                               0273
         LR    @14,@03                                             0273
         MH    @14,@CH00700                                        0273
         L     @09,TRENPTR(,R2)                                    0273
         LA    @01,0(@14,@09)                                      0273
         AL    @01,@CF00814                                        0273
         L     @08,TRECCH0-16(,@01)                                0273
         ST    @08,TREND6-4(@15)                                   0273
*     TREND6(2,J) = TRECCH1(J);                            /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0274
         AL    @01,@CF00815                                        0274
         L     @08,TRECCH1-20(,@01)                                0274
         ST    @08,TREND6+116(@15)                                 0274
*     TREND6(3,J) = TRECCH2(J);                            /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0275
         AL    @01,@CF00816                                        0275
         L     @08,TRECCH2-24(,@01)                                0275
         ST    @08,TREND6+236(@15)                                 0275
*     TREND6(4,J) = TRECCH3(J);                            /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0276
         AL    @01,@CF00817                                        0276
         L     @08,TRECCH3-28(,@01)                                0276
         ST    @08,TREND6+356(@15)                                 0276
*     TREND6(5,J) = TRECCH4(J);                            /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0277
         AL    @01,@CF00818                                        0277
         L     @08,TRECCH4-32(,@01)                                0277
         ST    @08,TREND6+476(@15)                                 0277
*     TREND6(6,J) = TRECCH5(J);                            /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0278
         AL    @01,@CF00819                                        0278
         L     @08,TRECCH5-36(,@01)                                0278
         ST    @08,TREND6+596(@15)                                 0278
*     TREND6(7,J) = TRECCH6(J);                            /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0279
         AL    @01,@CF00820                                        0279
         L     @08,TRECCH6-40(,@01)                                0279
         ST    @08,TREND6+716(@15)                                 0279
*     TREND6(8,J) = TRECCH7(J);                            /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0280
         AL    @01,@CF00821                                        0280
         L     @08,TRECCH7-44(,@01)                                0280
         ST    @08,TREND6+836(@15)                                 0280
*     TREND6(9,J) = TRECCH8(J);                            /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0281
         AL    @01,@CF00822                                        0281
         L     @08,TRECCH8-48(,@01)                                0281
         ST    @08,TREND6+956(@15)                                 0281
*     TREND6(10,J) = TRECCH9(J);                           /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0282
         AL    @01,@CF00823                                        0282
         L     @08,TRECCH9-52(,@01)                                0282
         ST    @08,TREND6+1076(@15)                                0282
*     TREND6(11,J) = TRECCHA(J);                           /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0283
         AL    @01,@CF00824                                        0283
         L     @08,TRECCHA-56(,@01)                                0283
         ST    @08,TREND6+1196(@15)                                0283
*     TREND6(12,J) = TRECCHB(J);                           /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0284
         AL    @01,@CF00825                                        0284
         L     @08,TRECCHB-60(,@01)                                0284
         ST    @08,TREND6+1316(@15)                                0284
*     TREND6(13,J) = TRECCHC(J);                           /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0285
         AL    @01,@CF00826                                        0285
         L     @08,TRECCHC-64(,@01)                                0285
         ST    @08,TREND6+1436(@15)                                0285
*     TREND6(14,J) = TRECCHD(J);                           /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0286
         AL    @01,@CF00827                                        0286
         L     @08,TRECCHD-68(,@01)                                0286
         ST    @08,TREND6+1556(@15)                                0286
*     TREND6(15,J) = TRECCHE(J);                           /*@0099VLS*/
         LA    @01,0(@14,@09)                                      0287
         AL    @01,@CF00828                                        0287
         L     @08,TRECCHE-72(,@01)                                0287
         ST    @08,TREND6+1676(@15)                                0287
*     TREND6(16,J) = TRECCHF(J);                           /*@0099VLS*/
         L     @14,TRECCHF-76(@14,@09)                             0288
         ST    @14,TREND6+1796(@15)                                0288
*    END;                                                  /*@0099VLS*/
         AL    @03,@CF00054                                        0289
         ST    @03,J                                               0289
@DE00272 C     @03,NUMDAYS(,R2)                                    0289
         BNH   @DL00272                                            0289
*    DO Z1 = 1 BY 1 TO 16;                                 /*@0099VLS*/
         LA    @03,1                                               0290
         ST    @03,Z1                                              0290
@DL00290 DS    0H                                                  0291
*    LIN2 = LIN2 && LIN2;                                  /*@0099VLS*/
         XC    LIN2(128),LIN2                                      0291
*    OUTSWTCH = OFF;                                       /*@0099VLS*/
         NI    OUTSWTCH,B'10111111'                                0292
*    DO Z2 = 1 BY  1 TO NUMDAYS WHILE(OUTSWTCH = OFF);     /*@0099VLS*/
         LA    @03,1                                               0293
         ST    @03,Z2                                              0293
         B     @DE00293                                            0293
@DL00293 TM    OUTSWTCH,B'01000000'                                0293
         BNZ   @DC00293                                            0293
*     IF TREND6(Z1,Z2) ^= 0 THEN                                   0294
         L     @15,Z1                                              0294
         MH    @15,@CH00538                                        0294
         ALR   @15,@03                                             0294
         SLA   @15,2                                               0294
         L     @03,TREND6-124(@15)                                 0294
         LTR   @03,@03                                             0294
         BZ    @RF00294                                            0294
*      OUTSWTCH = ON;                                      /*@0099VLS*/
         OI    OUTSWTCH,B'01000000'                                0295
*    END;                                                  /*@0099VLS*/
@RF00294 LA    @03,1                                               0296
         AL    @03,Z2                                              0296
         ST    @03,Z2                                              0296
@DE00293 C     @03,NUMDAYS(,R2)                                    0296
         BNH   @DL00293                                            0296
@DC00293 DS    0H                                                  0297
*    IF OUTSWTCH = ON THEN                                         0297
         TM    OUTSWTCH,B'01000000'                                0297
         BNO   @RF00297                                            0297
*     DO;                                                  /*@0099VLS*/
*    IF FOUND = OFF THEN                                           0299
         TM    FOUND,B'10000000'                                   0299
         BNZ   @RF00299                                            0299
*    DO;                                                   /*@0099VLS*/
*    LIN2(3:5) = ZCPU;                                     /*@0099VLS*/
         MVC   LIN2+2(3),ZCPU                                      0301
*    LETTER = EVLETTER(Q);                                 /*@0099VLS*/
         L     @03,Q                                               0302
         MH    @03,@CH00080                                        0302
         L     @01,EVPTR(,R2)                                      0302
         ALR   @01,@03                                             0302
         MVC   LETTER(1),EVLETTER-6(@01)                           0302
*    HD3MOVE = LIN2;                                       /*@0099VLS*/
         MVC   HD3MOVE(128),LIN2                                   0303
*    CALL PRINT1;                                          /*@0099VLS*/
         BAL   @14,PRINT1                                          0304
*    END;                                                  /*@0099VLS*/
*      FOUND = ON;                                         /*@0099VLS*/
@RF00299 OI    FOUND,B'10000000'                                   0306
*      CHANID = CHANZ(Z1);                                 /*@0099VLS*/
         L     @03,Z1                                              0307
         MH    @03,@CH00080                                        0307
         LA    @01,CHANZ-6(@03)                                    0307
         MVC   CHANID(6),0(@01)                                    0307
*      DO K = 1 BY 1 TO NUMDAYS;                           /*@0099VLS*/
         LA    @03,1                                               0308
         ST    @03,K                                               0308
         B     @DE00308                                            0308
@DL00308 DS    0H                                                  0309
*       BINWORD = TREND6(Z1,K);                            /*@0099VLS*/
         L     @15,Z1                                              0309
         MH    @15,@CH00538                                        0309
         ALR   @15,@03                                             0309
         SLA   @15,2                                               0309
         L     @15,TREND6-124(@15)                                 0309
         ST    @15,BINWORD                                         0309
*       DECADDR = ADDR(ERCNT(K)) + 1;                      /*@0099VLS*/
         SLA   @03,2                                               0310
         LA    @03,ERCNT-4(@03)                                    0310
         AL    @03,@CF00054                                        0310
         ST    @03,DECADDR                                         0310
*       CALL CONVBIN;                                      /*@0099VLS*/
         BAL   @14,CONVBIN                                         0311
*      END;                                                /*@0099VLS*/
         LA    @03,1                                               0312
         AL    @03,K                                               0312
         ST    @03,K                                               0312
@DE00308 C     @03,NUMDAYS(,R2)                                    0312
         BNH   @DL00308                                            0312
*      HD3MOVE = LIN2;                                     /*@0099VLS*/
         MVC   HD3MOVE(128),LIN2                                   0313
*      CALL PRINT1;                                        /*@0099VLS*/
         BAL   @14,PRINT1                                          0314
*      LIN2 = HD3MOVE;                                     /*@0099VLS*/
         MVC   LIN2(128),HD3MOVE                                   0315
*     END;                                                 /*@0099VLS*/
*    END;                                                  /*@0099VLS*/
@RF00297 LA    @03,1                                               0317
         AL    @03,Z1                                              0317
         ST    @03,Z1                                              0317
         C     @03,@CF00088                                        0317
         BNH   @DL00290                                            0317
*    IF FOUND = NO THEN                                            0318
         TM    FOUND,B'10000000'                                   0318
         BNZ   @RF00318                                            0318
*    DO;                                                   /*@0099VLS*/
*    DO K = 1 BY 1 TO NUMDAYS;                             /*@0099VLS*/
         LA    @03,1                                               0320
         ST    @03,K                                               0320
         B     @DE00320                                            0320
@DL00320 DS    0H                                                  0321
*     ERCNT(K) = '404040F0'X;                              /*@0099VLS*/
         LR    @15,@03                                             0321
         SLA   @15,2                                               0321
         LA    @14,ERCNT-4(@15)                                    0321
         MVC   0(4,@14),@CB00741                                   0321
*    END;                                                  /*@0099VLS*/
         AL    @03,@CF00054                                        0322
         ST    @03,K                                               0322
@DE00320 C     @03,NUMDAYS(,R2)                                    0322
         BNH   @DL00320                                            0322
*    LETTER = EVLETTER(Q);                                 /*@0099VLS*/
         L     @03,Q                                               0323
         MH    @03,@CH00080                                        0323
         L     @01,EVPTR(,R2)                                      0323
         ALR   @01,@03                                             0323
         MVC   LETTER(1),EVLETTER-6(@01)                           0323
*    LIN2(3:5) = ZCPU;                                     /*@0099VLS*/
         MVC   LIN2+2(3),ZCPU                                      0324
*    HD3MOVE = LIN2;                                       /*@0099VLS*/
         MVC   HD3MOVE(128),LIN2                                   0325
*    CALL PRINT1;                                          /*@0099VLS*/
         BAL   @14,PRINT1                                          0326
*    END;                                                  /*@0099VLS*/
*  TRENPTR = TRENEXT;                                      /*@0099VLS*/
@RF00318 L     @03,TRENPTR(,R2)                                    0328
         L     @03,TRENEXT(,@03)                                   0328
         ST    @03,TRENPTR(,R2)                                    0328
*  LIN2(3:5) = ZCPU;                                       /*@0099VLS*/
         MVC   LIN2+2(3),ZCPU                                      0329
* END;                                                     /*@0099VLS*/
         LA    @03,1                                               0330
         AL    @03,Q                                               0330
         ST    @03,Q                                               0330
@DE00270 C     @03,NUMCPUS                                         0330
         BNH   @DL00270                                            0330
* ELSE                                                             0331
* DO;                                                      /*@0099VLS*/
         B     @RC00269                                            0331
@RF00269 DS    0H                                                  0332
*  IF I = 4 THEN I = 19; /*MAKE UP FOR CHANNEL COUNTS        @0199VLS*/
         CLC   I(4),@CF00063                                       0332
         BNE   @RF00332                                            0332
         MVC   I(4),@CF00617                                       0333
*  LIN2(3:5) = ZCPU;                                       /*@0099VLS*/
@RF00332 MVC   LIN2+2(3),ZCPU                                      0334
*  TRENPTR = SAVEPTR;                                      /*@0099VLS*/
         L     @03,SAVEPTR                                         0335
         ST    @03,TRENPTR(,R2)                                    0335
*    DO J = 1 TO NUMCPUS;    /* LOOP FOR NUMBER OF CPU'S     @Z427VLS*/
         LA    @03,1                                               0336
         B     @DE00336                                            0336
@DL00336 DS    0H                                                  0337
*      LETTER = EVLETTER(J); /* MOVE CPU LETTER TO PRINT LINE        */
         MH    @03,@CH00080                                        0337
         L     @01,EVPTR(,R2)                                      0337
         ALR   @01,@03                                             0337
         MVC   LETTER(1),EVLETTER-6(@01)                           0337
*      DO K = 1 TO NUMDAYS;  /* LOOP FOR NUMBER OF DAYS      @Z427VLS*/
         LA    @03,1                                               0338
         B     @DE00338                                            0338
@DL00338 DS    0H                                                  0339
*        BINWORD = TREITM(K,I);   /* ERROR COUNT DATA        @Z427VLS*/
         LR    @15,@03                                             0339
         MH    @15,@CH00617                                        0339
         AL    @15,I                                               0339
         SLA   @15,2                                               0339
         L     @01,TRENPTR(,R2)                                    0339
         AL    @01,@CF00832                                        0339
         L     @15,TREITM-8(@15,@01)                               0339
         ST    @15,BINWORD                                         0339
*        DECADDR = ADDR(ERCNT(K)) + 1; /* DAY SLOT IN PRINT LINE     */
         SLA   @03,2                                               0340
         LA    @03,ERCNT-4(@03)                                    0340
         AL    @03,@CF00054                                        0340
         ST    @03,DECADDR                                         0340
*        CALL CONVBIN;            /* CONVERT ERROR DATA TO EBCDIC    */
         BAL   @14,CONVBIN                                         0341
*      END;                                                /*@Z427VLS*/
         LA    @03,1                                               0342
         AL    @03,K                                               0342
@DE00338 ST    @03,K                                               0342
         C     @03,NUMDAYS(,R2)                                    0342
         BNH   @DL00338                                            0342
*      HD3MOVE = LIN2;       /* MOVE PRINT LINE TO PRINT AREA        */
         MVC   HD3MOVE(128),LIN2                                   0343
*      CALL PRINT1;          /* PRINT DAILY ERROR COUNTS - THIS CPU  */
         BAL   @14,PRINT1                                          0344
*      TRENPTR = TRENEXT;    /* POINT TO ERROR TABLE - NEXT CPU      */
         L     @03,TRENPTR(,R2)                                    0345
         L     @03,TRENEXT(,@03)                                   0345
         ST    @03,TRENPTR(,R2)                                    0345
*    END;                                                  /*@Z427VLS*/
         LA    @03,1                                               0346
         AL    @03,J                                               0346
@DE00336 ST    @03,J                                               0346
         C     @03,NUMCPUS                                         0346
         BNH   @DL00336                                            0346
*  END;                                                    /*@0099VLS*/
*    TRENPTR = SAVEPTR;      /* RE-SET POINT TO ERROR TABLE - 1ST    */
@RC00269 L     @03,SAVEPTR                                         0348
         ST    @03,TRENPTR(,R2)                                    0348
*                            /* CPU - TO PROCESS NEXT ERROR TYPE     */
*  END;                                                    /*@Z427VLS*/
         LA    @03,1                                               0349
         AL    @03,I                                               0349
         ST    @03,I                                               0349
         C     @03,@CF00063                                        0349
         BNH   @DL00263                                            0349
*END;                                                      /*@Z427VLS*/
@EL00005 DS    0H                                                  0350
@EF00005 DS    0H                                                  0350
@ER00005 LM    @14,@12,@SA00005                                    0350
         BR    @14                                                 0350
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC PRINTS THE MODEL AND SERIAL NO. OF THE CPU'S FOR WHICH */
*/* ERROR COUNTS HAVE BEEN PRINTED                           @Z427VLS*/
*/*                                                          @Z427VLS*/
*CPUMODSN:  PROC;                                          /*@Z427VLS*/
CPUMODSN STM   @14,@12,@SA00006                                    0351
*  IF ((LINECT - TWO) - MYLINECT) < (FIVE + NUMCPUS) THEN          0352
         LH    @03,LINECT(,R2)                                     0352
         BCTR  @03,0                                               0352
         BCTR  @03,0                                               0352
         SL    @03,MYLINECT                                        0352
         LA    @15,5                                               0352
         AL    @15,NUMCPUS                                         0352
         CR    @03,@15                                             0352
         BNL   @RF00352                                            0352
*    DO;                     /* DATA TO BE PRINTED WILL NOT FIT IN   */
*      MYLINECT = ZERO;      /* REMAINING VERTICAL SPACE     @Z427VLS*/
         SLR   @03,@03                                             0354
         ST    @03,MYLINECT                                        0354
*      SPACING = UPSPACE;                                  /*@Z427VLS*/
         MVI   SPACING,X'89'                                       0355
*      CALL HEADING1;                                      /*@Z427VLS*/
         BAL   @14,HEADING1                                        0356
*    END;                                                  /*@Z427VLS*/
*      MYLINECT = ZERO;      /* REMAINING VERTICAL SPACE     @Z427VLS*/
@RF00352 SLR   @03,@03                                             0358
         ST    @03,MYLINECT                                        0358
*      SPACING = TRIPLE;                                   /*@Z427VLS*/
         MVI   SPACING,X'19'                                       0359
*      LNESPACE = THREE;                                   /*@Z427VLS*/
         MVC   LNESPACE(4),@CF00075                                0360
*      CALL PRINT1;          /* SKIP 3 LINES                 @Z427VLS*/
         BAL   @14,PRINT1                                          0361
*      SPACING = SINGLE;                                   /*@Z427VLS*/
         MVI   SPACING,X'09'                                       0362
*      LNESPACE = ONE;                                     /*@Z427VLS*/
         MVC   LNESPACE(4),@CF00054                                0363
*      CPULINE1 = CPULINE;   /* MOVE HEADING LINE TO PRINT AREA      */
         MVC   CPULINE1(24),CPULINE                                0364
*      CALL PRINT1;          /* PRINT HEADING                @Z427VLS*/
         BAL   @14,PRINT1                                          0365
*      CALL PRINT1;          /* PRINT BLANK LINE             @Z427VLS*/
         BAL   @14,PRINT1                                          0366
*      DO I = 1 TO NUMCPUS;                                /*@Z427VLS*/
         LA    @03,1                                               0367
         B     @DE00367                                            0367
@DL00367 DS    0H                                                  0368
*        CPUTYPE = EVLETTER(I);   /* MOVE CPU LETTER TO PRINT LINE   */
         MH    @03,@CH00080                                        0368
         L     @15,EVPTR(,R2)                                      0368
         ST    @03,@TF00001                                        0368
         ALR   @03,@15                                             0368
         MVC   CPUTYPE(1),EVLETTER-6(@03)                          0368
*        NUMBER = TWO;            /* TWO BYTES TO BE CONVERTED       */
         MVC   NUMBER(4),@CF00073                                  0369
*        NEXTBY = ADDR(EVMODEL(I));    /* DATA SOURCE - PARM TABLE   */
         L     @03,@TF00001                                        0370
         LA    @03,EVMODEL-6(@03,@15)                              0370
         ST    @03,NEXTBY                                          0370
*        ADDNXT = ADDR(CPUMODEL); /* DATA DESTINATION - PRINT LINE   */
         LA    @03,CPUMODEL                                        0371
         ST    @03,ADDNXT                                          0371
*        CALL CONVERT;            /* CONVERT CPU MODEL NO. TO EBCDIC */
         BAL   @14,CONVERT                                         0372
*        NUMBER = THREE;          /* THREE BYTES TO BE CONVERTED     */
         MVC   NUMBER(4),@CF00075                                  0373
*        NEXTBY = ADDR(EVSERIAL(I));   /* DATA SOURCE - PARM TABLE   */
         L     @03,I                                               0374
         MH    @03,@CH00080                                        0374
         L     @01,EVPTR(,R2)                                      0374
         LA    @03,EVSERIAL-6(@03,@01)                             0374
         ST    @03,NEXTBY                                          0374
*        ADDNXT = ADDR(CPUSERAL);  /* DATA DESTINATION - PRINT LINE  */
         LA    @03,CPUSERAL                                        0375
         ST    @03,ADDNXT                                          0375
*        CALL CONVERT;            /* CONVERT CPU SERIAL NO. TO EBCDIC*/
         BAL   @14,CONVERT                                         0376
*        CPULINE1 = CPUDATA;      /* MOVE PRINT LINE TO PRINT AREA   */
         MVI   CPULINE1+20,C' '                                    0377
         MVC   CPULINE1+21(3),CPULINE1+20                          0377
         MVC   CPULINE1(20),CPUDATA                                0377
*        CALL PRINT1;             /* PRINT CPU, MODEL, SERIAL NO.    */
         BAL   @14,PRINT1                                          0378
*      END;                                                /*@Z427VLS*/
         LA    @03,1                                               0379
         AL    @03,I                                               0379
@DE00367 ST    @03,I                                               0379
         C     @03,NUMCPUS                                         0379
         BNH   @DL00367                                            0379
*END;                                                      /*@Z427VLS*/
@EL00006 DS    0H                                                  0380
@EF00006 DS    0H                                                  0380
@ER00006 LM    @14,@12,@SA00006                                    0380
         BR    @14                                                 0380
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC INITIALIZES PRINT CONTROLS AND LINES 2 AND 3 OF THE    */
*/* REPORT HEADING FOR PART 2.                               @Z427VLS*/
*INITPRT2:  PROC OPTIONS(NOSAVEAREA);                      /*@Z427VLS*/
INITPRT2 STM   @14,@12,12(@13)                                     0381
*  SPACING = UPSPACE;        /* SET CARRIAGE CONTROL TO NEXT PAGE    */
         MVI   SPACING,X'89'                                       0382
*  MYLINECT = ZERO;          /* CLEAR PRINT LINE COUNTER     @Z427VLS*/
         SLR   @03,@03                                             0383
         ST    @03,MYLINECT                                        0383
*  LNESPACE = ZERO;          /* SET LINE COUNTER INCREMENT TO 0      */
         ST    @03,LNESPACE                                        0384
*  LINE2 = LINE2P2;          /* CHANGE LINES 2, 3 OF REPORT HEADING  */
         MVI   LINE2+51,C' '                                       0385
         MVC   LINE2+52(5),LINE2+51                                0385
         MVC   LINE2(51),LINE2P2                                   0385
*  LINE3 = LINE3P2;          /* TO PART 2 DATA               @Z427VLS*/
         MVI   LINE3+51,C' '                                       0386
         MVC   LINE3+52(5),LINE3+51                                0386
         MVC   LINE3(51),LINE3P2                                   0386
*  DO J = 1 TO 30;                                         /*@Z427VLS*/
         LA    @03,1                                               0387
         ST    @03,J                                               0387
@DL00387 DS    0H                                                  0388
*    PERMCT(J) = ZERO;                                     /*@Z427VLS*/
         SLR   @15,@15                                             0388
         LR    @14,@03                                             0388
         SLA   @14,2                                               0388
         LA    @01,PERMCT-4(@14)                                   0388
         STCM  @15,15,0(@01)                                       0388
*    TEMPCT(J) = ZERO;                                     /*@Z427VLS*/
         LA    @01,TEMPCT-4(@14)                                   0389
         STCM  @15,15,0(@01)                                       0389
*  END;                                                    /*@Z427VLS*/
         AL    @03,@CF00054                                        0390
         ST    @03,J                                               0390
         C     @03,@CF00538                                        0390
         BNH   @DL00387                                            0390
* END;                                                     /*@Z427VLS*/
@EL00007 DS    0H                                                  0391
@EF00007 DS    0H                                                  0391
@ER00007 LM    @14,@12,12(@13)                                     0391
         BR    @14                                                 0391
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC PERFORMS INITIALIZATION FOR TWO OTHER PROCS - ACCUMERR */
*/* AND PRINTALL - WHICH SUMMARIZE OBR,MDR TEMPORARY AND PERMANENT   */
*/* ERROR COUNTS BY DAY,BY CUA AND THEN PRINT RESPECTIVELY. SHARED   */
*/* I/O IS REFLECTED IN THE REPORT,IF REQUESTED.             @Z427VLS*/
*/*                                                          @Z427VLS*/
*CUAERREC:  PROC;                                          /*@Z427VLS*/
CUAERREC STM   @14,@12,@SA00008                                    0392
*  PREVGRP = TRENDGRP(1);               /* FIRST GROUP       @Z427VLS*/
         L     @15,SORTADR(,R2)                                    0393
         SLR   PREVGRP,PREVGRP                                     0393
         IC    PREVGRP,TRENDGRP(,@15)                              0393
*  PREVDEV = TRENDDEV(1);               /* FIRST DEVICE      @Z427VLS*/
         MVC   PREVDEV(2),TRENDDEV(@15)                            0394
*  PREVCPU = TRENCPUS(1) & 'F0'X;       /* FIRST CPU         @Z427VLS*/
         MVC   PREVCPU(1),TRENCPUS(@15)                            0395
         NI    PREVCPU,X'F0'                                       0395
*  PREVCUA = TRENDRT(1) & 'FFF0'X;      /* FIRST CUA         @Z427VLS*/
         MVC   PREVCUA(2),TRENDRT(@15)                             0396
         NC    PREVCUA(2),@CB00752                                 0396
*  I = 1;                                                  /*@Z427VLS*/
         MVC   I(4),@CF00054                                       0397
*  DO UNTIL (I > SORTNUM);                                 /*@Z427VLS*/
@DL00398 DS    0H                                                  0399
*    CALL PRTGROUP;               /* PRINT GROUP HEADING     @Z427VLS*/
         BAL   @14,PRTGROUP                                        0399
*    DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I));      /*@Z427VLS*/
@DL00400 DS    0H                                                  0401
*      IF PREVGRP = 5 THEN                                         0401
         C     PREVGRP,@CF00078                                    0401
         BNE   @RF00401                                            0401
*        CALL TPCNTRL;               /* DO TP CONTROLLER     @Z427VLS*/
         BAL   @14,TPCNTRL                                         0402
*      IF I ^> SORTNUM THEN                                        0403
@RF00401 L     @15,I                                               0403
         C     @15,SORTNUM(,R2)                                    0403
         BH    @RF00403                                            0403
*       DO;                                                /*@Z427VLS*/
*      CALL DODEVTYP;               /* PRINT THE DEVICE TYPE @Z427VLS*/
         BAL   @14,DODEVTYP                                        0405
*      DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I) ×            0406
*                PREVDEV ^= TRENDDEV(I));                  /*@Z427VLS*/
@DL00406 DS    0H                                                  0407
*        CALL DOCUA;                 /* DETERMINE THE CUA    @Z427VLS*/
         BAL   @14,DOCUA                                           0407
*        DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I) ×          0408
*                  PREVDEV ^= TRENDDEV(I) ×                        0408
*                  PREVCUA ^= (TRENDRT(I) & 'FFF0'X));     /*@Z427VLS*/
@DL00408 DS    0H                                                  0409
*          CPUWORK = PREVCPU;                              /*@Z427VLS*/
         MVC   CPUWORK(1),PREVCPU                                  0409
*          SRL (CPUWORK,FOUR);                             /*@Z427VLS*/
         SLR   @15,@15                                             0410
         IC    @15,CPUWORK                                         0410
         SRL   @15,4                                               0410
         STC   @15,CPUWORK                                         0410
*          LABELCPU(CPU+1) = 1;      /* SET FOR BASE CPU     @Z427VLS*/
         SLR   @01,@01                                             0411
         IC    @01,CPU                                             0411
         LA    @00,1                                               0411
         STC   @00,LABELCPU(@01)                                   0411
*          DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I) ×        0412
*                    PREVDEV ^= TRENDDEV(I) ×                      0412
*                    PREVCUA ^= (TRENDRT(I) & 'FFF0'X) ×           0412
*                    PREVCPU ^= (TRENCPUS(I) & 'F0'X));    /*@Z427VLS*/
@DL00412 DS    0H                                                  0413
*            CALL ACCUMERR;           /* TOTAL INTO THE BUCKETS      */
         BAL   @14,ACCUMERR                                        0413
*          END;                                            /*@Z427VLS*/
@DE00412 L     @15,I                                               0414
         C     @15,SORTNUM(,R2)                                    0414
         BH    @DC00412                                            0414
         MH    @15,@CH00476                                        0414
         L     @14,SORTADR(,R2)                                    0414
         LA    @01,0(@15,@14)                                      0414
         AL    @01,@CF00833                                        0414
         SLR   @00,@00                                             0414
         IC    @00,TRENDGRP(,@01)                                  0414
         CR    PREVGRP,@00                                         0414
         BNE   @DC00412                                            0414
         ST    @15,@TF00001                                        0414
         ALR   @15,@14                                             0414
         AL    @15,@CF00827                                        0414
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0414
         BNE   @DC00412                                            0414
         LR    @15,@14                                             0414
         AL    @15,@TF00001                                        0414
         AL    @15,@CF00834                                        0414
         MVC   @TS00001(2),TRENDRT-1(@15)                          0414
         NC    @TS00001(2),@CB00752                                0414
         CLC   PREVCUA(2),@TS00001                                 0414
         BNE   @DC00412                                            0414
         AL    @14,@TF00001                                        0414
         AL    @14,@CF00835                                        0414
         MVC   @TS00001(1),TRENCPUS-3(@14)                         0414
         NI    @TS00001,X'F0'                                      0414
         CLC   PREVCPU(1),@TS00001                                 0414
         BE    @DL00412                                            0414
@DC00412 DS    0H                                                  0415
*          CALL OUTCUA;               /* OUTPUT CUA AND CPU LETTERS  */
         BAL   @14,OUTCUA                                          0415
*          CALL CNVRTPRT;             /* OUTPUT THE ERROR LINES      */
         BAL   @14,CNVRTPRT                                        0416
*          IF I ^> SORTNUM THEN                                    0417
         L     @15,I                                               0417
         C     @15,SORTNUM(,R2)                                    0417
         BH    @RF00417                                            0417
*            PREVCPU = TRENCPUS(I) & 'F0'X;                /*@Z427VLS*/
         MH    @15,@CH00476                                        0418
         L     @01,SORTADR(,R2)                                    0418
         ALR   @01,@15                                             0418
         AL    @01,@CF00835                                        0418
         MVC   PREVCPU(1),TRENCPUS-3(@01)                          0418
         NI    PREVCPU,X'F0'                                       0418
*        END;                                              /*@Z427VLS*/
@RF00417 DS    0H                                                  0419
@DE00408 L     @15,I                                               0419
         C     @15,SORTNUM(,R2)                                    0419
         BH    @DC00408                                            0419
         MH    @15,@CH00476                                        0419
         L     @14,SORTADR(,R2)                                    0419
         LA    @01,0(@15,@14)                                      0419
         AL    @01,@CF00833                                        0419
         SLR   @00,@00                                             0419
         IC    @00,TRENDGRP(,@01)                                  0419
         CR    PREVGRP,@00                                         0419
         BNE   @DC00408                                            0419
         ST    @15,@TF00001                                        0419
         ALR   @15,@14                                             0419
         AL    @15,@CF00827                                        0419
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0419
         BNE   @DC00408                                            0419
         AL    @14,@TF00001                                        0419
         AL    @14,@CF00834                                        0419
         MVC   @TS00001(2),TRENDRT-1(@14)                          0419
         NC    @TS00001(2),@CB00752                                0419
         CLC   PREVCUA(2),@TS00001                                 0419
         BE    @DL00408                                            0419
@DC00408 DS    0H                                                  0420
*        IF I ^> SORTNUM THEN                                      0420
         L     @15,I                                               0420
         C     @15,SORTNUM(,R2)                                    0420
         BH    @RF00420                                            0420
*          PREVCUA = TRENDRT(I) & 'FFF0'X;                 /*@Z427VLS*/
         MH    @15,@CH00476                                        0421
         L     @01,SORTADR(,R2)                                    0421
         ALR   @01,@15                                             0421
         AL    @01,@CF00834                                        0421
         MVC   PREVCUA(2),TRENDRT-1(@01)                           0421
         NC    PREVCUA(2),@CB00752                                 0421
*      END;                                                /*@Z427VLS*/
@RF00420 DS    0H                                                  0422
@DE00406 L     @15,I                                               0422
         C     @15,SORTNUM(,R2)                                    0422
         BH    @DC00406                                            0422
         MH    @15,@CH00476                                        0422
         L     @14,SORTADR(,R2)                                    0422
         LA    @01,0(@15,@14)                                      0422
         AL    @01,@CF00833                                        0422
         SLR   @00,@00                                             0422
         IC    @00,TRENDGRP(,@01)                                  0422
         CR    PREVGRP,@00                                         0422
         BNE   @DC00406                                            0422
         ALR   @14,@15                                             0422
         AL    @14,@CF00827                                        0422
         CLC   PREVDEV(2),TRENDDEV-6(@14)                          0422
         BE    @DL00406                                            0422
@DC00406 DS    0H                                                  0423
*      IF I ^> SORTNUM THEN                                        0423
         L     @15,I                                               0423
         C     @15,SORTNUM(,R2)                                    0423
         BH    @RF00423                                            0423
*        PREVDEV = TRENDDEV(I);                            /*@Z427VLS*/
         MH    @15,@CH00476                                        0424
         L     @01,SORTADR(,R2)                                    0424
         ALR   @01,@15                                             0424
         AL    @01,@CF00827                                        0424
         MVC   PREVDEV(2),TRENDDEV-6(@01)                          0424
*     END;                           /*END TO THE IF  STATEMENT     */
@RF00423 DS    0H                                                  0426
*    END;                                                  /*@Z427VLS*/
@RF00403 DS    0H                                                  0426
@DE00400 L     @15,I                                               0426
         C     @15,SORTNUM(,R2)                                    0426
         BH    @DC00400                                            0426
         MH    @15,@CH00476                                        0426
         L     @01,SORTADR(,R2)                                    0426
         AL    @01,@CF00833                                        0426
         SLR   @14,@14                                             0426
         IC    @14,TRENDGRP(@15,@01)                               0426
         CR    PREVGRP,@14                                         0426
         BE    @DL00400                                            0426
@DC00400 DS    0H                                                  0427
*    IF I ^> SORTNUM THEN                                          0427
         L     @15,I                                               0427
         C     @15,SORTNUM(,R2)                                    0427
         BH    @RF00427                                            0427
*      DO;                                                 /*@Z427VLS*/
*        CALL PRINT1;                /* SKIP A LINE          @Z427VLS*/
         BAL   @14,PRINT1                                          0429
*        PREVGRP = TRENDGRP(I);                            /*@Z427VLS*/
         L     @15,I                                               0430
         MH    @15,@CH00476                                        0430
         L     @01,SORTADR(,R2)                                    0430
         AL    @01,@CF00833                                        0430
         SLR   PREVGRP,PREVGRP                                     0430
         IC    PREVGRP,TRENDGRP(@15,@01)                           0430
*      END;                                                /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
@RF00427 DS    0H                                                  0432
@DE00398 L     @15,I                                               0432
         C     @15,SORTNUM(,R2)                                    0432
         BNH   @DL00398                                            0432
*END;                                                      /*@Z427VLS*/
@EL00008 DS    0H                                                  0433
@EF00008 DS    0H                                                  0433
@ER00008 LM    @14,@12,@SA00008                                    0433
         BR    @14                                                 0433
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC TOTALS THE TEMPORARY AND PERMANENT COUNTS INTO THE     */
*/* BUCKET FOR THE APPORPRIATE DAY.                          @Z427VLS*/
*/*                                                          @Z427VLS*/
*ACCUMERR:  PROC;                                          /*@Z427VLS*/
ACCUMERR STM   @14,@12,12(@13)                                     0434
*  CPUWORK = TRENDITM(I) & '0F'X;  /* BASE CPU - LEFT JUSTIFIED      */
         L     @03,I                                               0435
         LR    @15,@03                                             0435
         MH    @15,@CH00476                                        0435
         L     @14,SORTADR(,R2)                                    0435
         ST    @15,@TF00001                                        0435
         ALR   @15,@14                                             0435
         AL    @15,@CF00836                                        0435
         MVC   CPUWORK(1),TRENDITM-4(@15)                          0435
         NI    CPUWORK,X'0F'                                       0435
*  LABELCPU(CPU+1) = 1;                                    /*@Z427VLS*/
         LA    @15,1                                               0436
         SLR   @01,@01                                             0436
         IC    @01,CPU                                             0436
         STC   @15,LABELCPU(@01)                                   0436
*  J = TRENDDAT(I);                    /* SET THE DATE INDEX @Z427VLS*/
         L     @01,@TF00001                                        0437
         AL    @01,@CF00837                                        0437
         SLR   @00,@00                                             0437
         IC    @00,TRENDDAT-5(@01,@14)                             0437
         ST    @00,J                                               0437
*     PERMCT(J) = PERMCT(J) + TREPRM(I);                   /*@0099VLS*/
         SLA   @00,2                                               0438
         LR    @01,@00                                             0438
         LA    @09,PERMCT-4(@01)                                   0438
         ICM   @08,15,0(@09)                                       0438
         LR    @09,@14                                             0438
         AL    @09,@TF00001                                        0438
         AL    @09,@CF00838                                        0438
         ICM   @09,12,TREPRM-8(@09)                                0438
         SRA   @09,16                                              0438
         ALR   @08,@09                                             0438
         LR    @09,@00                                             0438
         LA    @01,PERMCT-4(@09)                                   0438
         STCM  @08,15,0(@01)                                       0438
*     TEMPCT(J) = TEMPCT(J) + TRETMP(I);                   /*@0099VLS*/
         LR    @01,@00                                             0439
         LA    @09,TEMPCT-4(@01)                                   0439
         ICM   @08,15,0(@09)                                       0439
         AL    @14,@TF00001                                        0439
         AL    @14,@CF00828                                        0439
         ICM   @09,15,TRETMP-10(@14)                               0439
         ALR   @08,@09                                             0439
         LR    @09,@00                                             0439
         LA    @01,TEMPCT-4(@09)                                   0439
         STCM  @08,15,0(@01)                                       0439
*  I = I + 1;                                              /*@Z427VLS*/
         ALR   @03,@15                                             0440
         ST    @03,I                                               0440
*END;                                                      /*@Z427VLS*/
@EL00009 DS    0H                                                  0441
@EF00009 DS    0H                                                  0441
@ER00009 LM    @14,@12,12(@13)                                     0441
         BR    @14                                                 0441
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC PRINT THE GROUP HEADING.                       @Z427VLS*/
*/*                                                          @Z427VLS*/
*PRTGROUP: PROC;                                           /*@Z427VLS*/
PRTGROUP STM   @14,@12,12(@13)                                     0442
*  GROUPLBL = DEVGROUP(PREVGRP);                           /*@Z427VLS*/
         LR    @15,PREVGRP                                         0443
         SLA   @15,3                                               0443
         LA    @14,DEVGROUP-8(@15)                                 0443
         MVC   GROUPLBL(8),0(@14)                                  0443
*  LINESPRT = LINESPRT + NUMBER1;       /* PRINT A LINE      @Z427VLS*/
         LA    @15,1                                               0444
         AL    @15,LINESPRT                                        0444
         ST    @15,LINESPRT                                        0444
*  GRPOUT = ON;                                            /*@Z427VLS*/
         OI    GRPOUT,B'10000000'                                  0445
*END;                                                      /*@Z427VLS*/
@EL00010 DS    0H                                                  0446
@EF00010 DS    0H                                                  0446
@ER00010 LM    @14,@12,12(@13)                                     0446
         BR    @14                                                 0446
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC PRINT THE DEVICE TYPE HEADING.                 @Z427VLS*/
*/*                                                          @Z427VLS*/
*DODEVTYP: PROC;                                           /*@Z427VLS*/
DODEVTYP STM   @14,@12,@SA00011                                    0447
*  IF PREVDEV ^= '0000'X THEN                                      0448
         CLC   PREVDEV(2),@CB00208                                 0448
         BE    @RF00448                                            0448
*  DO;                                                     /*@Z427VLS*/
*  NUMBER = TWO;                                           /*@Z427VLS*/
         MVC   NUMBER(4),@CF00073                                  0450
*  NEXTBY = ADDR(PREVDEV);                                 /*@Z427VLS*/
         LA    @03,PREVDEV                                         0451
         ST    @03,NEXTBY                                          0451
*  ADDNXT = ADDR(CUDEV);                                   /*@Z427VLS*/
         LA    @03,CUDEV                                           0452
         ST    @03,ADDNXT                                          0452
*  CALL CONVERT;                                           /*@Z427VLS*/
         BAL   @14,CONVERT                                         0453
*  END;                                                    /*@Z427VLS*/
*  ELSE                                                            0455
*  CUDEV = UKNO;         /*DEVICE IS UKNOWN (FROM FILTER)    @Z427VLS*/
         B     @RC00448                                            0455
@RF00448 MVC   CUDEV(4),UKNO                                       0455
*  LINESPRT = LINESPRT + NUMBER1;        /* PRINT A LINE     @Z427VLS*/
@RC00448 LA    @03,1                                               0456
         AL    @03,LINESPRT                                        0456
         ST    @03,LINESPRT                                        0456
*  DEVOUT = ON;                                            /*@Z427VLS*/
         OI    DEVOUT,B'01000000'                                  0457
*END;                                                      /*@Z427VLS*/
@EL00011 DS    0H                                                  0458
@EF00011 DS    0H                                                  0458
@ER00011 LM    @14,@12,@SA00011                                    0458
         BR    @14                                                 0458
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC CREATED THE CUA HEADING.                       @Z427VLS*/
*/*                                                          @Z427VLS*/
*DOCUA: PROC;                                              /*@Z427VLS*/
DOCUA    STM   @14,@12,@SA00012                                    0459
*  CUACONV = PREVCUA;                                      /*@Z427VLS*/
         MVC   CUACONV(2),PREVCUA                                  0460
*  SRL (CUACONV,FOUR);                                     /*@Z427VLS*/
         SLR   @03,@03                                             0461
         ICM   @03,3,CUACONV                                       0461
         SRL   @03,4                                               0461
         STCM  @03,3,CUACONV                                       0461
*  NUMBER = TWO;                                           /*@Z427VLS*/
         MVC   NUMBER(4),@CF00073                                  0462
*  NEXTBY = ADDR(CUACONV);                                 /*@Z427VLS*/
         LA    @03,CUACONV                                         0463
         ST    @03,NEXTBY                                          0463
*  ADDNXT = ADDR(CUADATA);                                 /*@Z427VLS*/
         LA    @03,CUADATA                                         0464
         ST    @03,ADDNXT                                          0464
*  SWITCH1 = ON;                                           /*@Z427VLS*/
         OI    SWITCH1,B'00001000'                                 0465
*  CALL CONVERT;                                           /*@Z427VLS*/
         BAL   @14,CONVERT                                         0466
*END;                                                      /*@Z427VLS*/
@EL00012 DS    0H                                                  0467
@EF00012 DS    0H                                                  0467
@ER00012 LM    @14,@12,@SA00012                                    0467
         BR    @14                                                 0467
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC OUTPUTS THE CUA HEADING AND THE CPU LETTERS.   @Z427VLS*/
*/*                                                          @Z427VLS*/
*OUTCUA: PROC;                                             /*@Z427VLS*/
OUTCUA   STM   @14,@12,12(@13)                                     0468
*  K = 1;                                                  /*@Z427VLS*/
         LA    @03,1                                               0469
         ST    @03,K                                               0469
*  DO J = 1 TO 16;                                         /*@Z427VLS*/
         ST    @03,J                                               0470
@DL00470 DS    0H                                                  0471
*    IF LABELCPU (J) = 1 THEN                                      0471
         LA    @15,1                                               0471
         SLR   @14,@14                                             0471
         IC    @14,LABELCPU-1(@03)                                 0471
         CR    @15,@14                                             0471
         BNE   @RF00471                                            0471
*      DO;                                                 /*@Z427VLS*/
*        CPULBL(K) = EVLETTER(J);         /*  PLACE THE CPU LETTER   */
         L     @14,K                                               0473
         LA    @01,CPULBL-1(@14)                                   0473
         LR    @09,@03                                             0473
         MH    @09,@CH00080                                        0473
         L     @08,EVPTR(,R2)                                      0473
         ALR   @08,@09                                             0473
         MVC   0(1,@01),EVLETTER-6(@08)                            0473
*        K = K + 1;                                        /*@Z427VLS*/
         ALR   @14,@15                                             0474
         ST    @14,K                                               0474
*        LABELCPU(J) = ZERO;                               /*@Z427VLS*/
         SLR   @15,@15                                             0475
         STC   @15,LABELCPU-1(@03)                                 0475
*      END;                                                /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
@RF00471 LA    @03,1                                               0477
         AL    @03,J                                               0477
         ST    @03,J                                               0477
         C     @03,@CF00088                                        0477
         BNH   @DL00470                                            0477
*  LINESPRT = LINESPRT + NUMBER1;         /* PRINT ONE LINE  @Z427VLS*/
         LA    @03,1                                               0478
         AL    @03,LINESPRT                                        0478
         ST    @03,LINESPRT                                        0478
*  CUAOUT = ON;                                            /*@Z427VLS*/
         OI    CUAOUT,B'00100000'                                  0479
*END;                                                      /*@Z427VLS*/
@EL00013 DS    0H                                                  0480
@EF00013 DS    0H                                                  0480
@ER00013 LM    @14,@12,12(@13)                                     0480
         BR    @14                                                 0480
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC PROCESSES THE TP CONTROLLER GROUP.             @Z427VLS*/
*/*                                                          @Z427VLS*/
*TPCNTRL:   PROC;                                          /*@Z427VLS*/
TPCNTRL  STM   @14,@12,@SA00014                                    0481
*  DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I));        /*@Z427VLS*/
@DL00482 DS    0H                                                  0483
*    PREVCPU = TRENCPUS(I) & 'F0'X;       /* CPU             @Z427VLS*/
         L     @15,I                                               0483
         MH    @15,@CH00476                                        0483
         L     @14,SORTADR(,R2)                                    0483
         ST    @15,@TF00001                                        0483
         ALR   @15,@14                                             0483
         AL    @15,@CF00835                                        0483
         MVC   PREVCPU(1),TRENCPUS-3(@15)                          0483
         NI    PREVCPU,X'F0'                                       0483
*    PREVDEV = TRENDDEV(I);               /* DEVICE          @Z427VLS*/
         LR    @15,@14                                             0484
         AL    @15,@TF00001                                        0484
         AL    @15,@CF00827                                        0484
         MVC   PREVDEV(2),TRENDDEV-6(@15)                          0484
*    PREVCUA = TRENDRT(I) & 'FFF0'X;      /* CUA             @Z427VLS*/
         LR    @15,@14                                             0485
         AL    @15,@TF00001                                        0485
         AL    @15,@CF00834                                        0485
         MVC   PREVCUA(2),TRENDRT-1(@15)                           0485
         NC    PREVCUA(2),@CB00752                                 0485
*    PREV37  = TRENDITM(I) & 'F0'X;       /* 3705 FLAG       @Z427VLS*/
         AL    @14,@TF00001                                        0486
         AL    @14,@CF00836                                        0486
         MVC   PREV37(1),TRENDITM-4(@14)                           0486
         NI    PREV37,X'F0'                                        0486
*    CALL DODEVTYP;                      /* PRINT THE DEVICE TYPE   */
         BAL   @14,DODEVTYP                                        0487
*    DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I) ×              0488
*              PREVDEV ^= TRENDDEV(I));                    /*@Z427VLS*/
@DL00488 DS    0H                                                  0489
*      CALL DOCUA;              /* CREATE THE CUA            @Z427VLS*/
         BAL   @14,DOCUA                                           0489
*      DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I) ×            0490
*                PREVDEV ^= TRENDDEV(I) ×                          0490
*                PREVCUA ^= (TRENDRT(I) & 'FFF0'X));       /*@Z427VLS*/
@DL00490 DS    0H                                                  0491
*        CPUWORK = PREVCPU;                                /*@Z427VLS*/
         MVC   CPUWORK(1),PREVCPU                                  0491
*        SRL (CPUWORK,FOUR);                               /*@Z427VLS*/
         SLR   @15,@15                                             0492
         IC    @15,CPUWORK                                         0492
         SRL   @15,4                                               0492
         STC   @15,CPUWORK                                         0492
*        LABELCPU(CPU+1) = 1;        /* SET CPU INDICATOR    @Z427VLS*/
         SLR   @01,@01                                             0493
         IC    @01,CPU                                             0493
         LA    @00,1                                               0493
         STC   @00,LABELCPU(@01)                                   0493
*        DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I) ×          0494
*                  PREVDEV ^= TRENDDEV(I) ×                        0494
*                  PREVCUA ^= (TRENDRT(I) & 'FFF0'X) ×             0494
*                  PREVCPU ^= (TRENCPUS(I) & 'F0'X));      /*@Z427VLS*/
@DL00494 DS    0H                                                  0495
*          J = TRENDITM(I);                                /*@Z427VLS*/
         L     @15,I                                               0495
         MH    @15,@CH00476                                        0495
         L     @01,SORTADR(,R2)                                    0495
         AL    @01,@CF00836                                        0495
         SLR   @14,@14                                             0495
         IC    @14,TRENDITM-4(@15,@01)                             0495
         ST    @14,J                                               0495
*          SRL (J,FOUR);                                   /*@Z427VLS*/
         SRL   @14,4                                               0496
         ST    @14,J                                               0496
*          CONTRLBL = TPLABEL(J+1);    /* 3705 LABELS.       @Z427VLS*/
         L     @15,J                                               0497
         SLA   @15,3                                               0497
         LA    @14,TPLABEL(@15)                                    0497
         MVC   CONTRLBL(8),0(@14)                                  0497
*          DO UNTIL (I > SORTNUM × PREVGRP ^= TRENDGRP(I) ×        0498
*                    PREVDEV ^= TRENDDEV(I) ×                      0498
*                    PREVCUA ^= (TRENDRT(I) & 'FFF0'X) ×           0498
*                    PREVCPU ^= (TRENCPUS(I) & 'F0'X) ×            0498
*                    PREV37 ^= (TRENDITM(I) & 'F0'X));     /*@Z427VLS*/
@DL00498 DS    0H                                                  0499
*            CALL ACCUMERR;                                /*@Z427VLS*/
         BAL   @14,ACCUMERR                                        0499
*          END;                                            /*@Z427VLS*/
@DE00498 L     @15,I                                               0500
         C     @15,SORTNUM(,R2)                                    0500
         BH    @DC00498                                            0500
         MH    @15,@CH00476                                        0500
         L     @14,SORTADR(,R2)                                    0500
         LA    @01,0(@15,@14)                                      0500
         AL    @01,@CF00833                                        0500
         SLR   @00,@00                                             0500
         IC    @00,TRENDGRP(,@01)                                  0500
         CR    PREVGRP,@00                                         0500
         BNE   @DC00498                                            0500
         ST    @15,@TF00001                                        0500
         ALR   @15,@14                                             0500
         AL    @15,@CF00827                                        0500
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0500
         BNE   @DC00498                                            0500
         LR    @15,@14                                             0500
         AL    @15,@TF00001                                        0500
         AL    @15,@CF00834                                        0500
         MVC   @TS00001(2),TRENDRT-1(@15)                          0500
         NC    @TS00001(2),@CB00752                                0500
         CLC   PREVCUA(2),@TS00001                                 0500
         BNE   @DC00498                                            0500
         LR    @15,@14                                             0500
         AL    @15,@TF00001                                        0500
         AL    @15,@CF00835                                        0500
         MVC   @TS00001(1),TRENCPUS-3(@15)                         0500
         NI    @TS00001,X'F0'                                      0500
         CLC   PREVCPU(1),@TS00001                                 0500
         BNE   @DC00498                                            0500
         AL    @14,@TF00001                                        0500
         AL    @14,@CF00836                                        0500
         MVC   @TS00001(1),TRENDITM-4(@14)                         0500
         NI    @TS00001,X'F0'                                      0500
         CLC   PREV37(1),@TS00001                                  0500
         BE    @DL00498                                            0500
@DC00498 DS    0H                                                  0501
*          CALL OUTCUA;           /* OUTPUT THE CUA          @Z427VLS*/
         BAL   @14,OUTCUA                                          0501
*          N3705OUT = ON;                                  /*@Z427VLS*/
         OI    N3705OUT,B'00010000'                                0502
*          LINESPRT = LINESPRT + 7;                        /*@Z427VLS*/
         LA    @15,7                                               0503
         AL    @15,LINESPRT                                        0503
         ST    @15,LINESPRT                                        0503
*          CALL CNVRTPRT;         /* OUTPUT THE ERROR LINES  @Z427VLS*/
         BAL   @14,CNVRTPRT                                        0504
*          IF I ^> SORTNUM THEN                                    0505
         L     @15,I                                               0505
         C     @15,SORTNUM(,R2)                                    0505
         BH    @RF00505                                            0505
*            PREV37 = TRENDITM(I) & 'F0'X;                 /*@Z427VLS*/
         MH    @15,@CH00476                                        0506
         L     @01,SORTADR(,R2)                                    0506
         ALR   @01,@15                                             0506
         AL    @01,@CF00836                                        0506
         MVC   PREV37(1),TRENDITM-4(@01)                           0506
         NI    PREV37,X'F0'                                        0506
*        END;                                              /*@Z427VLS*/
@RF00505 DS    0H                                                  0507
@DE00494 L     @15,I                                               0507
         C     @15,SORTNUM(,R2)                                    0507
         BH    @DC00494                                            0507
         MH    @15,@CH00476                                        0507
         L     @14,SORTADR(,R2)                                    0507
         LA    @01,0(@15,@14)                                      0507
         AL    @01,@CF00833                                        0507
         SLR   @00,@00                                             0507
         IC    @00,TRENDGRP(,@01)                                  0507
         CR    PREVGRP,@00                                         0507
         BNE   @DC00494                                            0507
         ST    @15,@TF00001                                        0507
         ALR   @15,@14                                             0507
         AL    @15,@CF00827                                        0507
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0507
         BNE   @DC00494                                            0507
         LR    @15,@14                                             0507
         AL    @15,@TF00001                                        0507
         AL    @15,@CF00834                                        0507
         MVC   @TS00001(2),TRENDRT-1(@15)                          0507
         NC    @TS00001(2),@CB00752                                0507
         CLC   PREVCUA(2),@TS00001                                 0507
         BNE   @DC00494                                            0507
         AL    @14,@TF00001                                        0507
         AL    @14,@CF00835                                        0507
         MVC   @TS00001(1),TRENCPUS-3(@14)                         0507
         NI    @TS00001,X'F0'                                      0507
         CLC   PREVCPU(1),@TS00001                                 0507
         BE    @DL00494                                            0507
@DC00494 DS    0H                                                  0508
*        IF I ^> SORTNUM THEN                                      0508
         L     @15,I                                               0508
         C     @15,SORTNUM(,R2)                                    0508
         BH    @RF00508                                            0508
*          PREVCPU = TRENCPUS(I) & 'F0'X;                  /*@Z427VLS*/
         MH    @15,@CH00476                                        0509
         L     @01,SORTADR(,R2)                                    0509
         ALR   @01,@15                                             0509
         AL    @01,@CF00835                                        0509
         MVC   PREVCPU(1),TRENCPUS-3(@01)                          0509
         NI    PREVCPU,X'F0'                                       0509
*      END;                                                /*@Z427VLS*/
@RF00508 DS    0H                                                  0510
@DE00490 L     @15,I                                               0510
         C     @15,SORTNUM(,R2)                                    0510
         BH    @DC00490                                            0510
         MH    @15,@CH00476                                        0510
         L     @14,SORTADR(,R2)                                    0510
         LA    @01,0(@15,@14)                                      0510
         AL    @01,@CF00833                                        0510
         SLR   @00,@00                                             0510
         IC    @00,TRENDGRP(,@01)                                  0510
         CR    PREVGRP,@00                                         0510
         BNE   @DC00490                                            0510
         ST    @15,@TF00001                                        0510
         ALR   @15,@14                                             0510
         AL    @15,@CF00827                                        0510
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0510
         BNE   @DC00490                                            0510
         AL    @14,@TF00001                                        0510
         AL    @14,@CF00834                                        0510
         MVC   @TS00001(2),TRENDRT-1(@14)                          0510
         NC    @TS00001(2),@CB00752                                0510
         CLC   PREVCUA(2),@TS00001                                 0510
         BE    @DL00490                                            0510
@DC00490 DS    0H                                                  0511
*      IF I ^> SORTNUM THEN                                        0511
         L     @15,I                                               0511
         C     @15,SORTNUM(,R2)                                    0511
         BH    @RF00511                                            0511
*        PREVCUA = TRENDRT(I) & 'FFF0'X;                   /*@Z427VLS*/
         MH    @15,@CH00476                                        0512
         L     @01,SORTADR(,R2)                                    0512
         ALR   @01,@15                                             0512
         AL    @01,@CF00834                                        0512
         MVC   PREVCUA(2),TRENDRT-1(@01)                           0512
         NC    PREVCUA(2),@CB00752                                 0512
*    END;                                                  /*@Z427VLS*/
@RF00511 DS    0H                                                  0513
@DE00488 L     @15,I                                               0513
         C     @15,SORTNUM(,R2)                                    0513
         BH    @DC00488                                            0513
         MH    @15,@CH00476                                        0513
         L     @14,SORTADR(,R2)                                    0513
         LA    @01,0(@15,@14)                                      0513
         AL    @01,@CF00833                                        0513
         SLR   @00,@00                                             0513
         IC    @00,TRENDGRP(,@01)                                  0513
         CR    PREVGRP,@00                                         0513
         BNE   @DC00488                                            0513
         ALR   @14,@15                                             0513
         AL    @14,@CF00827                                        0513
         CLC   PREVDEV(2),TRENDDEV-6(@14)                          0513
         BE    @DL00488                                            0513
@DC00488 DS    0H                                                  0514
*    IF I ^> SORTNUM THEN                                          0514
         L     @15,I                                               0514
         C     @15,SORTNUM(,R2)                                    0514
         BH    @RF00514                                            0514
*      PREVDEV = TRENDDEV(I);                              /*@Z427VLS*/
         MH    @15,@CH00476                                        0515
         L     @01,SORTADR(,R2)                                    0515
         ALR   @01,@15                                             0515
         AL    @01,@CF00827                                        0515
         MVC   PREVDEV(2),TRENDDEV-6(@01)                          0515
*  END;                                                    /*@Z427VLS*/
@RF00514 DS    0H                                                  0516
@DE00482 L     @15,I                                               0516
         C     @15,SORTNUM(,R2)                                    0516
         BH    @DC00482                                            0516
         MH    @15,@CH00476                                        0516
         L     @01,SORTADR(,R2)                                    0516
         AL    @01,@CF00833                                        0516
         SLR   @14,@14                                             0516
         IC    @14,TRENDGRP(@15,@01)                               0516
         CR    PREVGRP,@14                                         0516
         BE    @DL00482                                            0516
@DC00482 DS    0H                                                  0517
*END;                                                      /*@Z427VLS*/
@EL00014 DS    0H                                                  0517
@EF00014 DS    0H                                                  0517
@ER00014 LM    @14,@12,@SA00014                                    0517
         BR    @14                                                 0517
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC CONVERTS THE SUMMARIZED PERMANENT AND TEMPORARY ERROR  */
*/* COUNT DATA TO EBCDIC FOR PRINTING AND THEN PRINTS BOTH LINES.    */
*/*                                                          @Z427VLS*/
*CNVRTPRT:  PROC;                                          /*@Z427VLS*/
CNVRTPRT STM   @14,@12,@SA00015                                    0518
*  LINESPRT = LINESPRT + 2;   /* TOTAL NUMBER OF LINES TO PRINT      */
         LA    @03,2                                               0519
         L     @15,LINESPRT                                        0519
         ALR   @15,@03                                             0519
         ST    @15,LINESPRT                                        0519
*  IF LINESPRT + MYLINECT => (LINECT - TWO) THEN                   0520
         AL    @15,MYLINECT                                        0520
         LCR   @03,@03                                             0520
         AH    @03,LINECT(,R2)                                     0520
         CR    @15,@03                                             0520
         BL    @RF00520                                            0520
*    DO;                                                   /*@Z427VLS*/
*      SPACING = UPSPACE;    /* UPSPACE TO A NEW PAGE        @Z427VLS*/
         MVI   SPACING,X'89'                                       0522
*      CALL HEADING1;                                      /*@Z427VLS*/
         BAL   @14,HEADING1                                        0523
*      CALL HEADING2;                                      /*@Z427VLS*/
         BAL   @14,HEADING2                                        0524
*      MYLINECT = FOUR;                                    /*@Z427VLS*/
         MVC   MYLINECT(4),@CF00063                                0525
*    END;                                                  /*@Z427VLS*/
*  LINESPRT = ZERO;                                        /*@Z427VLS*/
@RF00520 SLR   @03,@03                                             0527
         ST    @03,LINESPRT                                        0527
*  IF GRPOUT = ON THEN                                             0528
         TM    GRPOUT,B'10000000'                                  0528
         BNO   @RF00528                                            0528
*    DO;                                                   /*@Z427VLS*/
*      LABELLNE = GROUPLBL;   /* GROUP LABEL                 @Z427VLS*/
         MVC   LABELLNE(8),GROUPLBL                                0530
*      CALL PRINT1;                                        /*@Z427VLS*/
         BAL   @14,PRINT1                                          0531
*      GRPOUT = OFF;                                       /*@Z427VLS*/
         NI    GRPOUT,B'01111111'                                  0532
*    END;                                                  /*@Z427VLS*/
*  IF DEVOUT = ON THEN                                             0534
@RF00528 TM    DEVOUT,B'01000000'                                  0534
         BNO   @RF00534                                            0534
*    DO;                                                   /*@Z427VLS*/
*      LABELLNE = CUDVDATA;   /* DEVICE LINE                 @Z427VLS*/
         MVC   LABELLNE(8),CUDVDATA                                0536
*      CALL PRINT1;                                        /*@Z427VLS*/
         BAL   @14,PRINT1                                          0537
*      DEVOUT = OFF;                                       /*@Z427VLS*/
         NI    DEVOUT,B'10111111'                                  0538
*    END;                                                  /*@Z427VLS*/
*  IF CUAOUT = ON THEN                                             0540
@RF00534 TM    CUAOUT,B'00100000'                                  0540
         BNO   @RF00540                                            0540
*    DO;                                                   /*@Z427VLS*/
*      LABELLNE = CUALINE;    /* CUA CPU LINE                @Z427VLS*/
         MVC   LABELLNE(8),CUALINE                                 0542
*      CALL PRINT1;                                        /*@Z427VLS*/
         BAL   @14,PRINT1                                          0543
*      CUAOUT = OFF;                                       /*@Z427VLS*/
         NI    CUAOUT,B'11011111'                                  0544
*    END;                                                  /*@Z427VLS*/
*  IF N3705OUT = ON THEN                                           0546
@RF00540 TM    N3705OUT,B'00010000'                                0546
         BNO   @RF00546                                            0546
*    DO;                                                   /*@Z427VLS*/
*      LABELLNE = CONTRLBL;   /* 3705 FLAG LINE              @Z427VLS*/
         MVC   LABELLNE(8),CONTRLBL                                0548
*      CALL PRINT1;                                        /*@Z427VLS*/
         BAL   @14,PRINT1                                          0549
*      N3705OUT = OFF;                                     /*@Z427VLS*/
         NI    N3705OUT,B'11101111'                                0550
*    END;                                                  /*@Z427VLS*/
*  DO J = 1 TO NUMDAYS;                                    /*@Z427VLS*/
@RF00546 LA    @03,1                                               0552
         B     @DE00552                                            0552
@DL00552 DS    0H                                                  0553
*    BINWORD = PERMCT(J);    /* PERMANENT ERROR DATA TO BE CONVERTED.*/
         SLA   @03,2                                               0553
         LA    @01,PERMCT-4(@03)                                   0553
         ICM   @00,15,0(@01)                                       0553
         ST    @00,BINWORD                                         0553
*    DECADDR = ADDR(PERM(J)) + 1; /*  WHERE - POSITION IN PRINT LINE.*/
         LA    @03,PERM-4(@03)                                     0554
         AL    @03,@CF00054                                        0554
         ST    @03,DECADDR                                         0554
*    CALL CONVBIN;           /* CONVERT TO EBCDIC.           @Z427VLS*/
         BAL   @14,CONVBIN                                         0555
*    BINWORD = TEMPCT(J);    /* TEMPORARY ERROR DATA TO BE CONVERTED.*/
         L     @03,J                                               0556
         SLA   @03,2                                               0556
         LA    @01,TEMPCT-4(@03)                                   0556
         ICM   @00,15,0(@01)                                       0556
         ST    @00,BINWORD                                         0556
*    DECADDR = ADDR(TEMP(J)) + 1; /*  WHERE - POSITION IN PRINT LINE.*/
         LA    @03,TEMP-4(@03)                                     0557
         AL    @03,@CF00054                                        0557
         ST    @03,DECADDR                                         0557
*    CALL CONVBIN;           /* CONVERT TO EBCDIC.           @Z427VLS*/
         BAL   @14,CONVBIN                                         0558
*  END;                                                    /*@Z427VLS*/
         LA    @03,1                                               0559
         AL    @03,J                                               0559
@DE00552 ST    @03,J                                               0559
         C     @03,NUMDAYS(,R2)                                    0559
         BNH   @DL00552                                            0559
*  HD2MOVE = PERMELNE;       /* MOVE PRINT LINE TO PRINT AREA.       */
         MVC   HD2MOVE(128),PERMELNE                               0560
*  CALL PRINT1;              /* PRINT PERMANENT ERROR SUMMARY LINE.  */
         BAL   @14,PRINT1                                          0561
*  HD2MOVE = TEMPELNE;       /* MOVE PRINT LINE TO PRINT AREA.       */
         MVC   HD2MOVE(128),TEMPELNE                               0562
*  CALL PRINT1;              /* PRINT TEMPORARY ERROR SUMMARY LINE.  */
         BAL   @14,PRINT1                                          0563
*  DO J = 1 TO 30;                                         /*@Z427VLS*/
         LA    @03,1                                               0564
         ST    @03,J                                               0564
@DL00564 DS    0H                                                  0565
*    PERMCT(J) = ZERO;       /* CLEAR PERM COUNT TO ZERO     @Z427VLS*/
         SLR   @15,@15                                             0565
         LR    @14,@03                                             0565
         SLA   @14,2                                               0565
         LA    @01,PERMCT-4(@14)                                   0565
         STCM  @15,15,0(@01)                                       0565
*    TEMPCT(J) = ZERO;       /* CLEAR TEMP COUNT TO ZERO     @Z427VLS*/
         LA    @01,TEMPCT-4(@14)                                   0566
         STCM  @15,15,0(@01)                                       0566
*    CPULBL(J) = ' ';        /* CLEAR CPU LABELS TO BLANKS   @Z427VLS*/
         LA    @01,CPULBL-1(@03)                                   0567
         MVI   0(@01),C' '                                         0567
*  END;                                                    /*@Z427VLS*/
         AL    @03,@CF00054                                        0568
         ST    @03,J                                               0568
         C     @03,@CF00538                                        0568
         BNH   @DL00564                                            0568
*END;                                                      /*@Z427VLS*/
@EL00015 DS    0H                                                  0569
@EF00015 DS    0H                                                  0569
@ER00015 LM    @14,@12,@SA00015                                    0569
         BR    @14                                                 0569
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC SETS UP LINKAGE TO ACCESS I/O SERVICE PRINT -  @Z427VLS*/
*/*                                                          @Z427VLS*/
*PRINT1:    PROC;                                          /*@Z427VLS*/
PRINT1   STM   @14,@12,@SA00016                                    0570
*  CALL PRINT2;                                            /*@Z427VLS*/
         BAL   @14,PRINT2                                          0571
*  MYLINECT = MYLINECT + LNESPACE;          /* BUMP LINE COUNTER     */
         L     @03,MYLINECT                                        0572
         AL    @03,LNESPACE                                        0572
         ST    @03,MYLINECT                                        0572
*      IF MYLINECT => (LINECT-TWO) &  /* IF PAGE OVERFLOW AND @0001VLS*
*         I ^> SORTNUM THEN           /* NOT LAST RCD, PRINT  @0001VLS*
         LH    @15,LINECT(,R2)                                     0573
         BCTR  @15,0                                               0573
         BCTR  @15,0                                               0573
         CR    @03,@15                                             0573
         BL    @RF00573                                            0573
         L     @03,I                                               0573
         C     @03,SORTNUM(,R2)                                    0573
         BH    @RF00573                                            0573
*    DO;                                    /* DAY HEADING - NEXT PG.*/
*      SPACING = UPSPACE;                                  /*@Z427VLS*/
         MVI   SPACING,X'89'                                       0575
*      CALL HEADING1;                                      /*@Z427VLS*/
         BAL   @14,HEADING1                                        0576
*      CALL HEADING2;                                      /*@Z427VLS*/
         BAL   @14,HEADING2                                        0577
*      MYLINECT = FOUR;                     /* CLEAR LINE COUNTER    */
         MVC   MYLINECT(4),@CF00063                                0578
*    END;                                                  /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00016 DS    0H                                                  0580
@EF00016 DS    0H                                                  0580
@ER00016 LM    @14,@12,@SA00016                                    0580
         BR    @14                                                 0580
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* WRITE TO THE PRINTER                                     @Z427VLS*/
*/*                                                          @Z427VLS*/
*PRINT2:    PROC;                                          /*@Z427VLS*/
PRINT2   STM   @14,@12,@SA00017                                    0581
*  PRINTADR = ADDR(PRINTLNE);               /* LINE TO BE PRINTED    */
         LA    @03,PRINTLNE                                        0582
         ST    @03,PRINTADR(,R2)                                   0582
*  CALL IOHND(RITEPRTR);                    /* PRINT IT      @Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0583
         LA    @01,@AL00583                                        0583
         BALR  @14,@15                                             0583
*END;                                                      /*@Z427VLS*/
@EL00017 DS    0H                                                  0584
@EF00017 DS    0H                                                  0584
@ER00017 LM    @14,@12,@SA00017                                    0584
         BR    @14                                                 0584
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC CONVERTS THE BINARY NUMBER IN ITEM BINWORD TO DISPLAY. */
*/* IF THE CONVERTED NUMBER IS > THAN THE NUMBER OF DIGITS REQUESTED */
*/* (IN ITEM BNDECNUM), A NINE IS PLACED IN EACH PRINT POSITION.     */
*/* LEADING ZEROS ARE SUPPRESSED.                            @Z427VLS*/
*/*                                                          @Z427VLS*/
*CONVBIN:   PROC;                                          /*@Z427VLS*/
CONVBIN  STM   @14,@12,@SA00018                                    0585
*  RESPECIFY (R8,R9) RESTRICTED;                           /*@Z427VLS*/
*  R8 = BINWORD;             /* DATA TO BE CONVERTED.        @Z427VLS*/
         L     R8,BINWORD                                          0587
*  GEN(CVD R8,DBLWORD);      /* CONVERT TO PACKED DECIMAL.   @Z427VLS*/
         CVD R8,DBLWORD
*  GEN(UNPK WORK(8),DBLWORD);   /* UNPACK CONVERTED NO.      @Z427VLS*/
         UNPK WORK(8),DBLWORD
*  GEN(OI WORK+7,X'F0');     /* INSERT 'PLUS' SIGN.          @Z427VLS*/
         OI WORK+7,X'F0'
*  SWITCH2 = OFF;            /* TURN OFF SWITCH.             @Z427VLS*/
         NI    SWITCH2,B'11111011'                                 0591
*  DO L = 1 TO 7 WHILE (SWITCH2 = OFF);  /* SCAN NUMBER -    @Z427VLS*/
         LA    @03,1                                               0592
         ST    @03,L                                               0592
@DL00592 TM    SWITCH2,B'00000100'                                 0592
         BNZ   @DC00592                                            0592
*    IF WORKOVER(L) = 'F0'X THEN                                   0593
         LA    @01,WORKOVER-1(@03)                                 0593
         CLI   0(@01),X'F0'                                        0593
         BNE   @RF00593                                            0593
*      WORKOVER(L) = '40'X;  /* SET LEADING 0'S TO BLANKS.   @Z427VLS*/
         LA    @01,WORKOVER-1(@03)                                 0594
         MVI   0(@01),X'40'                                        0594
*    ELSE                                                          0595
*      SWITCH2 = ON;         /* TURN ON SWITCH TO TERMINATE LOOP     */
         B     @RC00593                                            0595
@RF00593 OI    SWITCH2,B'00000100'                                 0595
*  END;                      /* WHEN 1ST NON-ZERO DIGIT FOUND.       */
@RC00593 LA    @03,1                                               0596
         AL    @03,L                                               0596
         ST    @03,L                                               0596
         C     @03,@CF00082                                        0596
         BNH   @DL00592                                            0596
@DC00592 DS    0H                                                  0597
*  IF (10 - L) > BNDECNUM THEN                                     0597
         LA    @03,10                                              0597
         SL    @03,L                                               0597
         C     @03,BNDECNUM                                        0597
         BNH   @RF00597                                            0597
*    DO;                                                   /*@Z427VLS*/
*      GEN(MVI WORKOVER,X'F9');          /* NUMBER TOO LARGE -       */
         MVI WORKOVER,X'F9'
*      GEN(MVC WORKOVER+1(7),WORKOVER);  /* REPLACE WITH 9'S.        */
         MVC WORKOVER+1(7),WORKOVER
*    END;                                                  /*@Z427VLS*/
*  R8 = ADDR(WORKOVER) + (8-BNDECNUM);   /* ADDRESS - BEGIN. OF DATA.*/
@RF00597 LA    R8,WORKOVER                                         0602
         L     @03,BNDECNUM                                        0602
         LA    @15,8                                               0602
         SLR   @15,@03                                             0602
         ALR   R8,@15                                              0602
*  R9 = BNDECNUM - ONE;                  /* NO. OF BYTES TO MOVE.    */
         BCTR  @03,0                                               0603
         LR    R9,@03                                              0603
*  RESPECIFY (R6) RESTRICTED;                              /*@Z427VLS*/
*  R6 = DECADDR;                         /* ADDRESS - DATA DESTINAT. */
         L     R6,DECADDR                                          0605
*  GEN(EX R9,MVCINS);                    /* MOVE DATA.       @Z427VLS*/
         EX R9,MVCINS
*  GENERATE DATA;                                          /*@Z427VLS*/
*  RESPECIFY (R6) UNRESTRICTED;                            /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00018 DS    0H                                                  0609
@EF00018 DS    0H                                                  0609
@ER00018 LM    @14,@12,@SA00018                                    0609
         BR    @14                                                 0609
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/* THIS PROC CONVERTS HEX DATA TO DISPLAY.                  @Z427VLS*/
*/* TO SUPPRESS CONVERSION OF LEFT-MOST HALF OF HIGH ORDER BYTE,     */
*/* USER SHOULD SET SWITCH1 ON.                              @Z427VLS*/
*/*                                                          @Z427VLS*/
*CONVERT:   PROC;                                          /*@Z427VLS*/
CONVERT  STM   @14,@12,12(@13)                                     0610
*  RESPECIFY (R8,R9) RESTRICTED;                           /*@Z427VLS*/
*  DO P = NUMBER BY -1 TO 1; /* NUMBER OF BYTES TO CONVERT.  @Z427VLS*/
         L     @03,NUMBER                                          0612
         ST    @03,P                                               0612
         B     @DE00612                                            0612
@DL00612 DS    0H                                                  0613
*    R8 = NEXTBYTE(P);       /* NEXT BYTE TO CONVERT.        @Z427VLS*/
         L     @01,NEXTBY                                          0613
         BCTR  @01,0                                               0613
         SLR   R8,R8                                               0613
         IC    R8,NEXTBYTE(@03,@01)                                0613
*    X =  TWO * P;           /* OUTPUT INDEX MUST BE TWICE INPUT.    */
         LR    @15,@03                                             0614
         ALR   @15,@15                                             0614
         ST    @15,X                                               0614
*    SRDL  (R8,FOUR);        /* MOVE 1/2 BYTE INTO NEXT REGISTER.    */
         SRDL  R8,4                                                0615
*    SRL   (R9,TWOEIGHT);    /* SHIFT TO LOW END.            @Z427VLS*/
         SRL   R9,28                                               0616
*    R9 = R9 + NUMBER1;                                    /*@Z427VLS*/
         LA    @15,1                                               0617
         ALR   R9,@15                                              0617
*    R8 = R8 + NUMBER1;                                    /*@Z427VLS*/
         ALR   R8,@15                                              0618
*    IF SWITCH1 = ON & P = ONE THEN    /* IF HIGH ORDER BYTE AND NO  */
         TM    SWITCH1,B'00001000'                                 0619
         BNO   @RF00619                                            0619
         CR    @03,@15                                             0619
         BNE   @RF00619                                            0619
*      SWITCH1 = OFF;                  /* LEFT-HALF CONVERSION, TURN */
         NI    SWITCH1,B'11110111'                                 0620
*                                      /* OFF SWITCH.        @Z427VLS*/
*    ELSE                                                          0621
*      ADDNUM(X-ONE) = CHARS(R8);      /* PUT PRINT CHAR. INTO OUTPUT*/
         B     @RC00619                                            0621
@RF00619 L     @03,ADDNXT                                          0621
         AL    @03,X                                               0621
         BCTR  @03,0                                               0621
         BCTR  @03,0                                               0621
         LA    @01,CHARS-1(R8)                                     0621
         MVC   ADDNUM(1,@03),0(@01)                                0621
*      ADDNUM(X) = CHARS(R9);          /* FINISH BYTE.       @Z427VLS*/
@RC00619 L     @03,ADDNXT                                          0622
         AL    @03,X                                               0622
         BCTR  @03,0                                               0622
         LA    @01,CHARS-1(R9)                                     0622
         MVC   ADDNUM(1,@03),0(@01)                                0622
*  END;                                                    /*@Z427VLS*/
         SLR   @03,@03                                             0623
         BCTR  @03,0                                               0623
         AL    @03,P                                               0623
         ST    @03,P                                               0623
@DE00612 LTR   @03,@03                                             0623
         BP    @DL00612                                            0623
*END;                                                      /*@Z427VLS*/
@EL00019 DS    0H                                                  0624
@EF00019 DS    0H                                                  0624
@ER00019 LM    @14,@12,12(@13)                                     0624
         BR    @14                                                 0624
*END  /* CLOSING END TO IFCTREND                             @Z427VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 0625
@DATA    DS    0H
@CH00080 DC    H'6'
@CH00540 DC    H'13'
@CH00476 DC    H'14'
@CH00700 DC    H'76'
         DS    0F
@AL00583 DC    A(@CF00073+2)           LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@SA00017 DS    15F
@SA00004 DS    15F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00008 DS    15F
@SA00018 DS    15F
@SA00016 DS    15F
@SA00014 DS    15F
@SA00011 DS    15F
@SA00012 DS    15F
@SA00015 DS    15F
@TF00001 DS    F
         DS    0F
@CF00054 DC    F'1'
@CF00073 DC    F'2'
@CF00075 DC    F'3'
@CF00063 DC    F'4'
@CF00078 DC    F'5'
@CF00082 DC    F'7'
@CF00065 DC    F'8'
@CF00088 DC    F'16'
@CF00617 DC    F'19'
@CH00617 EQU   @CF00617+2
@CF00672 DC    F'27'
@CF00538 DC    F'30'
@CH00538 EQU   @CF00538+2
@CF00693 DC    F'365'
@CF00695 DC    F'366'
@CF00832 DC    F'-72'
@CF00814 DC    F'-60'
@CF00815 DC    F'-56'
@CF00816 DC    F'-52'
@CF00817 DC    F'-48'
@CF00818 DC    F'-44'
@CF00819 DC    F'-40'
@CF00820 DC    F'-36'
@CF00821 DC    F'-32'
@CF00822 DC    F'-28'
@CF00823 DC    F'-24'
@CF00824 DC    F'-20'
@CF00825 DC    F'-16'
@CF00833 DC    F'-14'
@CF00834 DC    F'-13'
@CF00826 DC    F'-12'
@CF00835 DC    F'-11'
@CF00836 DC    F'-10'
@CF00837 DC    F'-9'
@CF00827 DC    F'-8'
@CF00838 DC    F'-6'
@CF00828 DC    F'-4'
         DS    0D
NEXTBY   DC    F'0'
ADDNXT   DC    F'0'
LINESPRT DC    F'0'
NUMBER   DC    F'0'
L        DC    F'0'
MYLINECT DC    F'0'
P        DC    F'0'
X        DC    F'0'
LNESPACE DC    F'0'
I        DC    F'0'
BINWORD  DC    F'0'
BNDECNUM DC    F'3'
DECADDR  DC    F'0'
SAVEPTR  DC    F'0'
J        DC    F'0'
K        DC    F'1'
NUMCPUS  DC    F'0'
BINYR    DC    F'0'
M        DC    F'0'
BYTECT   DC    F'0'
Z1       DC    F'0'
Q        DC    F'0'
Z2       DC    F'0'
RETCODE  DC    H'0'
         DS    0D
@TS00001 DS    CL8
@CB00741 DC    X'404040F0'
@CB00208 DC    X'0000'
@CB00752 DC    X'FFF0'
PRINTLNE DS    CL134
         ORG   PRINTLNE
DDTYPE   DC    CL1'0'
SPACING  DC    X'89'
PRTLINE  DC    CL132' '
         ORG   PRINTLNE+134
HEAD1    DC    CL171' '
         ORG   HEAD1
LINE1    DS    CL57
         ORG   LINE1
@NM00012 DC    CL25'T R E N D S   R E P O R T'
@NM00013 DC    CL14' '
@NM00014 DC    CL12'REPORT DATE '
DAYSDATE DC    CL6'XXX XX'
         ORG   HEAD1+57
LINE2    DS    CL57
         ORG   LINE2
@NM00015 DC    CL17'         (PART 1)'
@NM00016 DC    CL22' '
@NM00017 DC    CL12'PERIOD FROM '
FROMDATE DS    CL3
@NM00018 DC    CL1' '
FROMYEAR DS    CL2
         ORG   HEAD1+114
LINE3    DS    CL57
         ORG   LINE3
@NM00019 DC    CL24' CPU/CHANNEL/STORAGE/SCP'
@NM00020 DC    CL22' '
@NM00021 DC    CL5'TO   '
TODATE   DS    CL3
@NM00022 DC    CL1' '
TOYEAR   DS    CL2
         ORG   HEAD1+171
CPULINE  DC    CL24'CPU   MODEL   SERIAL NO.'
CPUDATA  DC    CL20' '
         ORG   CPUDATA
@NM00023 DC    CL1' '
CPUTYPE  DS    CL1
@NM00024 DC    CL5' '
CPUMODEL DS    CL3
@NM00025 DC    CL4' '
CPUSERAL DS    CL6
         ORG   CPUDATA+20
HEAD2    DC    CL256' '
         ORG   HEAD2
LN1      DS    CL128
         ORG   LN1
@NM00026 DC    CL10' JULIAN   '
JYEAR    DS    CL2
@NM00027 DC    CL116' '
         ORG   HEAD2+128
LN2      DS    CL128
         ORG   LN2
@NM00028 DC    CL8'   DAY  '
DAYNO    DC    CL4' '
         DS    29XL4
         ORG   HEAD2+256
HEAD3    DC    CL256' '
         ORG   HEAD3
LIN1     DS    CL128
         ORG   LIN1
DSCRPT   DS    CL17
@NM00029 DC    CL111' '
         ORG   HEAD3+128
LIN2     DS    CL128
         ORG   LIN2
@NM00030 DC    CL6'  CPU '
@NM00031 DC    CL1' '
LETTER   DC    CL1'X'
ERCNT    DC    CL4' '
         DS    29XL4
         ORG   HEAD3+256
SWITCHE  DC    AL1(0)
         ORG   SWITCHE
GRPOUT   DS    BL1
DEVOUT   EQU   SWITCHE+0
CUAOUT   EQU   SWITCHE+0
N3705OUT EQU   SWITCHE+0
SWITCH1  EQU   SWITCHE+0
SWITCH2  EQU   SWITCHE+0
         ORG   SWITCHE+1
CHARS    DC    CL16'0123456789ABCDEF'
SAVEDAY  DC    CL2' '
SAVEYR   DC    CL2' '
         DS    CL6
WORK     DS    CL8
HEAD1P2  DC    CL102' '
         ORG   HEAD1P2
LINE2P2  DS    CL51
         ORG   LINE2P2
@NM00032 DC    CL17'         (PART 2)'
@NM00033 DS    CL22
@NM00034 DC    CL12'PERIOD FROM '
         ORG   HEAD1P2+51
LINE3P2  DS    CL51
         ORG   LINE3P2
@NM00035 DC    CL24'     I/O SUBSYSTEM      '
@NM00036 DS    CL22
@NM00037 DC    CL5'TO   '
         ORG   HEAD1P2+102
GROUPLBL DC    CL8' '
CUDVDATA DC    CL8' '
         ORG   CUDVDATA
CUDEV    DC    CL4' '
@NM00038 DS    CL4
         ORG   CUDVDATA+8
CUALINE  DC    CL128' '
         ORG   CUALINE
CUADATA  DS    CL3
@NM00039 DS    CL2
CPULBL   DC    CL1' '
         DS    29XL1
         ORG   CUALINE+128
         DS    CL2
ERSUMLNE DC    CL256' '
         ORG   ERSUMLNE
PERMELNE DS    CL128
         ORG   PERMELNE
@NM00040 DC    CL8'  PERM  '
PERM     DC    CL4' '
         DS    29XL4
         ORG   ERSUMLNE+128
TEMPELNE DS    CL128
         ORG   TEMPELNE
@NM00041 DC    CL8'  TEMP  '
TEMP     DC    CL4' '
         DS    29XL4
         ORG   ERSUMLNE+256
UKNO     DC    CL4'UKNO'
CONTRLBL DC    CL8' '
PREVCUA  DS    BL2
PREV37   DS    CL1
PREVCPU  DS    BL1
PREVDEV  DS    CL2
SAVECUA  DS    BL2
CPUWORK  DS    BL1
NEWSW    DC    X'00'
         ORG   NEWSW
FOUND    DS    BL1
OUTSWTCH EQU   NEWSW+0
         ORG   NEWSW+1
NOFOUND  DC    CL29'NO ERRORS FOUND FOR THIS CPU'
CHAN     DC    CL4'CHAN'
ZCPU     DC    CL3'CPU'
         DS    CL6
DBLWORD  DS    CL8
OLDWORK  DS    BL1
SUPERZAP DC    3CL10'SUPERZAP'
DEVGROUP DC    CL8'CONS+UR '
         DC    CL8'DASD    '
         DC    CL8'TAPE    '
         DC    CL8'DISPLAY '
         DC    CL8'TP CNTRL'
         DC    CL8'TERMINAL'
DESCRIPT DC    CL13'IPL          '
         DC    CL13'MACHINE CHECK'
         DC    CL13'CHANNEL CHECK'
         DC    CL13'PROGRAM ERROR'
         DS    CL1
PATCH    DC    30F'0'
TPLABEL  DC    CL8'  CNTRLR'
         DC    CL8'  NCP   '
         DC    CL8'  LINES '
LABELCPU DC    16AL1(0)
TREND6   DC    480F'0'
CHANZ    DC    CL6' CHN-0'
         DC    CL6' CHN-1'
         DC    CL6' CHN-2'
         DC    CL6' CHN-3'
         DC    CL6' CHN-4'
         DC    CL6' CHN-5'
         DC    CL6' CHN-6'
         DC    CL6' CHN-7'
         DC    CL6' CHN-8'
         DC    CL6' CHN-9'
         DC    CL6' CHN-A'
         DC    CL6' CHN-B'
         DC    CL6' CHN-C'
         DC    CL6' CHN-D'
         DC    CL6' CHN-E'
         DC    CL6' CHN-F'
IFCTREND CSECT
         DC    S(SUPERZAP)
IFCTREND CSECT
    DC  S(PATCH)
IFCTREND CSECT
MVCINS  MVC  R0(R0,R6),0(R8)
IFCTREND CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
PREVGRP  EQU   @03
R2       EQU   @02
R6       EQU   @06
R8       EQU   @08
R9       EQU   @09
R12      EQU   @12
R15      EQU   @15
R0       EQU   @00
R1       EQU   @01
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R14      EQU   @14
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R7       EQU   @07
IOHND    EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
DEBUG    EQU   PARM+4
DEBUG4   EQU   DEBUG
DEBUG12  EQU   DEBUG+1
DEBUG21  EQU   DEBUG+2
DEBUGA   EQU   PARM+8
DEBUG51  EQU   DEBUGA+2
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
PSTYR    EQU   PSTD
PSTDY    EQU   PSTD+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
PENYR    EQU   PEND
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
EVSYEAR  EQU   STRTDATE
EVSDAY   EQU   STRTDATE+1
@NM00007 EQU   PARM+75
SORTNUM  EQU   PARM+84
NUMDAYS  EQU   PARM+88
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
LINECT   EQU   PARM+120
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TRENEXT  EQU   TRENDONE
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TRECCH1  EQU   TREGEN+12
TRECCH2  EQU   TREGEN+16
TRECCH3  EQU   TREGEN+20
TRECCH4  EQU   TREGEN+24
TRECCH5  EQU   TREGEN+28
TRECCH6  EQU   TREGEN+32
TRECCH7  EQU   TREGEN+36
TRECCH8  EQU   TREGEN+40
TRECCH9  EQU   TREGEN+44
TRECCHA  EQU   TREGEN+48
TRECCHB  EQU   TREGEN+52
TRECCHC  EQU   TREGEN+56
TRECCHD  EQU   TREGEN+60
TRECCHE  EQU   TREGEN+64
TRECCHF  EQU   TREGEN+68
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDGRP EQU   TRENDKEY
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
TRENDDAT EQU   TRENDKEY+5
TRENDDEV EQU   TREND2+6
TREPRM   EQU   TREND2+8
TRETMP   EQU   TREND2+10
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVYEAR   EQU   EVSTOP
EVDAY    EQU   EVSTOP+1
EVNUM    EQU   EVTABLE+4
EVKEY    EQU   EVTABLE+6
EVMODEL  EQU   EVKEY
EVSERIAL EQU   EVKEY+2
EVLETTER EQU   EVKEY+5
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHAREIO  EQU   SHARE+2
SHRCUCPU EQU   SHAREIO
SHARECUA EQU   SHRCUCPU
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
NEXTBYTE EQU   0
ADDNUM   EQU   0
IFCMSG   EQU   0
HEADMOVE EQU   PRTLINE
CPULINE1 EQU   PRTLINE
HD2MOVE  EQU   PRTLINE
HD3MOVE  EQU   PRTLINE
WORKOVER EQU   WORK
TREITM   EQU   TREGEN
LABELLNE EQU   PRTLINE
PERMCT   EQU   PERM
TEMPCT   EQU   TEMP
CUACONV  EQU   SAVECUA
CPU      EQU   CPUWORK
CHANID   EQU   LIN2+2
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+10
SHARSERB EQU   SHAREIO+7
SHARECUB EQU   SHAREIO+5
SHARSERA EQU   SHRCUCPU+2
SHAREDX  EQU   SHARECUA
SHARENUM EQU   SHARE
SYSTEMP  EQU   SYSUM2+9
SYSPERM  EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TREPRE   EQU   TREGEN+72
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
RECLNGTH EQU   CCHHRLNG+6
@NM00009 EQU   CCHHRLNG+5
RECCCHHR EQU   CCHHRLNG
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
TABSIZE  EQU   PARM+80
SYSRETRN EQU   @NM00007
@NM00006 EQU   PARM+72
WRTHRSH  EQU   PARM+69
RDTHRSH  EQU   PARM+66
TERM     EQU   PARM+58
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00203 EQU   @RC00197
@RF00573 EQU   @EL00016
@ENDDATA EQU   *
         END   IFCTREND,(C'PLS0627',0701,77315)

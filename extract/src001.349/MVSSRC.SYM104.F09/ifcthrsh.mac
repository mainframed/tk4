         TITLE 'IFCTHRSH - CONTROL FOR THRESHOLD PROCESSING            *
                        '
IFCTHRSH CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCTHRSH  77.316'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         LA    @05,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@05                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         B     @PB00002                                            0169
SORT     STM   @14,@12,@SA00002                                    0169
*SRTCONT = ((NUMENT - ONE) * ELEVEN) + CURRPTR;            /*@0001VLS*/
         L     @03,CURRPTR                                         0171
         L     @15,NUMENT                                          0171
         BCTR  @15,0                                               0171
         MH    @15,@CH00034                                        0171
         ALR   @15,@03                                             0171
         ST    @15,SRTCONT                                         0171
*R7 = CURRPTR;                     /* START OF THE SORT TABLE        */
         LR    R7,@03                                              0172
*GENERATE REFS(CONTRTAB);                                  /*@0001VLS*/
         LA    R15,ELEVEN          LOAD THE INCREMENT VALUE
         L     R4,SRTCONT          LOAD THE MAX LIMIT
         LR    R1,R7               SET UP THE STOP LIMIT ON BACK UP
         B     DOIT                GO AROUND THIS CODE FIRST TIME
LOOPBCK1 ALR   R7,R15              MOVE THE POINTER TO NEXT ENTRY
         CR    R7,R4               ARE WE POINTING TO LAST ENTRY
         BNL   DONE                FINISHED WITH THE SORT SO EXIT
DOIT     CLC   CONTRTAB(ELEVEN,R7),CONTRTAB+ELEVEN(R7)
         BNH   LOOPBCK1            DONT NEED TO SORT ITEM
         XC    CONTRTAB(ELEVEN,R7),CONTRTAB+ELEVEN(R7)
         XC    CONTRTAB+ELEVEN(ELEVEN,R7),CONTRTAB(R7)
         XC    CONTRTAB(ELEVEN,R7),CONTRTAB+ELEVEN(R7)
         LR    R6,R7               SET NEW POINTER(BACKWARD)
LOOPBCK2 SR    R6,R15              POINT TO LAST ENTRY
         CR    R6,R1               DONT BACK OUT OF THE TABLE
         BL    LOOPBCK1            START WITH NEXT ENTRY
         CLC   CONTRTAB(ELEVEN,R6),CONTRTAB+ELEVEN(R6)
         BNH   LOOPBCK1            NO FUTHER SHUFFEL THIS SAMPLE
         XC    CONTRTAB+ELEVEN(ELEVEN,R6),CONTRTAB(R6)
         XC    CONTRTAB(ELEVEN,R6),CONTRTAB+ELEVEN(R6)
         XC    CONTRTAB+ELEVEN(ELEVEN,R6),CONTRTAB(R6)
         B     LOOPBCK2            DOES IT NEED TO BE MOVED AGAIN
DONE     EQU   *
ELEVEN   EQU   11
*RESPECIFY (R6) UNRESTRICTED;                              /*@0001VLS*/
*IF DEBUG8 = ON THEN                                               0175
         TM    DEBUG8(R2),B'10000000'                              0175
         BNO   @RF00175                                            0175
*  CALL DUMP;                    /*DUMP THE SORT TABLE       @0001VLS*/
         BAL   @14,DUMP                                            0176
*MSGDS = CHARS(1);               /* EREPPT DATA SET OUTPUT   @0001VLS*/
@RF00175 MVC   MSGDS(1),CHARS                                      0177
*END;                                                      /*@0001VLS*/
@EL00002 DS    0H                                                  0178
@EF00002 DS    0H                                                  0178
@ER00002 LM    @14,@12,@SA00002                                    0178
         BR    @14                                                 0178
*/*                                                          @0001VLS*/
*/* OUTPUT THE TWO HEADERS AT THE TOP OF THE PAGE.           @0001VLS*/
*/*                                                          @0001VLS*/
*OUTHED12: PROC;                                           /*@0001VLS*/
OUTHED12 STM   @14,@12,@SA00003                                    0179
*  CALL PAGEJECT;                        /* NEW PAGE         @0001VLS*/
         BAL   @14,PAGEJECT                                        0180
*  MSGADDR(40:39+LENGTH(CUASH1)) = CUASH1;                 /*@0001VLS*/
         MVC   MSGADDR+39(40),CUASH1                               0181
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0182
*  TEMPAREA(1:2) = CONTRCUA;             /* PRIMARY CUA      @0001VLS*/
         L     @06,CURRPTR                                         0183
         MVC   TEMPAREA(2),CONTRCUA(@06)                           0183
*  SRL (TEMPAREA(1:2),FOUR);             /* CONTROL UNIT     @0001VLS*/
         SLR   @06,@06                                             0184
         ICM   @06,3,TEMPAREA                                      0184
         SRL   @06,4                                               0184
         STCM  @06,3,TEMPAREA                                      0184
*  CALL CONVERT (TEMPAREA(2),CUASH2C,ONE);                 /*@0001VLS*/
         LA    @01,@AL00185                                        0185
         BAL   @14,CONVERT                                         0185
*  MSGADDR(40:39+LENGTH(CUASH2)) = CUASH2;                 /*@0001VLS*/
         MVC   MSGADDR+39(40),CUASH2                               0186
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0187
*  MYLINCT = MYLINCT - TWO;                                /*@0001VLS*/
         L     @06,MYLINCT                                         0188
         BCTR  @06,0                                               0188
         BCTR  @06,0                                               0188
         ST    @06,MYLINCT                                         0188
*  HEAD1 = ON;                                             /*@0001VLS*/
         OI    HEAD1,B'00010000'                                   0189
* END;                                                     /*@0001VLS*/
@EL00003 DS    0H                                                  0190
@EF00003 DS    0H                                                  0190
@ER00003 LM    @14,@12,@SA00003                                    0190
         BR    @14                                                 0190
*/*                                                          @0001VLS*/
*/* OUTPUT THE NO RECORDS EXCEEDING THRESHOLD MESSAGE.       @0001VLS*/
*/*                                                          @0001VLS*/
*NOHEAD1: PROC;                                            /*@0001VLS*/
NOHEAD1  STM   @14,@12,@SA00004                                    0191
*  CALL OUTHED12;                        /* DISMOUNT HEADERS @0001VLS*/
         BAL   @14,OUTHED12                                        0192
*  CALL FINDDATE;                        /* FIND THE DATE RANGE      */
         BAL   @14,FINDDATE                                        0193
*  CALL CONVERT (LOWDATE,TEMPAREA,THREE);                  /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00194                              0194
         L     @06,DATEPTR                                         0194
         LA    @06,LOWDATE(,@06)                                   0194
         ST    @06,@AL00001                                        0194
         LA    @01,@AL00001                                        0194
         BAL   @14,CONVERT                                         0194
*  CUASH6D1 = TEMPAREA(1:5);                               /*@0001VLS*/
         MVC   CUASH6D1(5),TEMPAREA                                0195
*  CALL CONVERT (HIDATE,TEMPAREA,THREE);                   /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00196                              0196
         L     @06,DATEPTR                                         0196
         LA    @06,HIDATE(,@06)                                    0196
         ST    @06,@AL00001                                        0196
         LA    @01,@AL00001                                        0196
         BAL   @14,CONVERT                                         0196
*  CUASH6D2 = TEMPAREA(1:5);                               /*@0001VLS*/
         MVC   CUASH6D2(5),TEMPAREA                                0197
*  MSGADDR(20:19+LENGTH(CUASH6)) = CUASH6;                 /*@0001VLS*/
         MVC   MSGADDR+19(42),CUASH6                               0198
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0199
*  MYLINCT = MYLINCT - ONE;                                /*@0001VLS*/
         L     @06,MYLINCT                                         0200
         BCTR  @06,0                                               0200
         ST    @06,MYLINCT                                         0200
* END;                                                     /*@0001VLS*/
@EL00004 DS    0H                                                  0201
@EF00004 DS    0H                                                  0201
@ER00004 LM    @14,@12,@SA00004                                    0201
         BR    @14                                                 0201
*/*                                                          @0001VLS*/
*/* OUTPUT THE NO PERMANENT ERRORS MESSAGE.                  @0001VLS*/
*/*                                                          @0001VLS*/
*NOHEAD2: PROC;                                            /*@0001VLS*/
NOHEAD2  STM   @14,@12,@SA00005                                    0202
*  MSGADDR = SPACER;                     /* SPACER LINE      @0001VLS*/
         MVC   MSGADDR(132),SPACER                                 0203
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0204
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0205
*  MYLINCT = MYLINCT - TWO;                                /*@0001VLS*/
         L     @06,MYLINCT                                         0206
         BCTR  @06,0                                               0206
         BCTR  @06,0                                               0206
         ST    @06,MYLINCT                                         0206
*  IF MYLINCT < FOUR THEN                /* EJECT TO NEW PAGE IF REST*/
         C     @06,@CF00064                                        0207
         BNL   @RF00207                                            0207
*    CALL PAGEJECT;                      /* OF REPORT WILL NOT FIT   */
         BAL   @14,PAGEJECT                                        0208
*  MSGADDR(44:43+LENGTH(CUAPH1)) = CUAPH1;                 /*@0001VLS*/
@RF00207 MVC   MSGADDR+43(25),CUAPH1                               0209
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0210
*  CALL FINDDATE;                        /* FIND THE DATE RANGE      */
         BAL   @14,FINDDATE                                        0211
*  CALL CONVERT(LOWDATE,TEMPAREA,THREE);                   /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00212                              0212
         L     @06,DATEPTR                                         0212
         LA    @06,LOWDATE(,@06)                                   0212
         ST    @06,@AL00001                                        0212
         LA    @01,@AL00001                                        0212
         BAL   @14,CONVERT                                         0212
*  CUAPH5D1 = TEMPAREA(1:5);                               /*@0001VLS*/
         MVC   CUAPH5D1(5),TEMPAREA                                0213
*  CALL CONVERT(HIDATE,TEMPAREA,THREE);                    /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00214                              0214
         L     @06,DATEPTR                                         0214
         LA    @06,HIDATE(,@06)                                    0214
         ST    @06,@AL00001                                        0214
         LA    @01,@AL00001                                        0214
         BAL   @14,CONVERT                                         0214
*  CUAPH5D2 = TEMPAREA(1:5);                               /*@0001VLS*/
         MVC   CUAPH5D2(5),TEMPAREA                                0215
*  MSGADDR(20:19+LENGTH(CUAPH5)) = CUAPH5;                 /*@0001VLS*/
         MVC   MSGADDR+19(47),CUAPH5                               0216
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0217
*  MYLINCT = MYLINCT - TWO;                                /*@0001VLS*/
         L     @06,MYLINCT                                         0218
         BCTR  @06,0                                               0218
         BCTR  @06,0                                               0218
         ST    @06,MYLINCT                                         0218
*  HEAD2 = ON;                                             /*@0001VLS*/
         OI    HEAD2,B'00001000'                                   0219
*END;                                                      /*@0001VLS*/
@EL00005 DS    0H                                                  0220
@EF00005 DS    0H                                                  0220
@ER00005 LM    @14,@12,@SA00005                                    0220
         BR    @14                                                 0220
*/*                                                          @0001VLS*/
*/* EJECT TO A NEW PAGE.                                     @0001VLS*/
*/*                                                          @0001VLS*/
*PAGEJECT: PROC;                                           /*@0001VLS*/
PAGEJECT STM   @14,@12,@SA00006                                    0221
* MSGCC = EJECT;                                           /*@0001VLS*/
         MVI   MSGCC,X'89'                                         0222
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0223
* MSGCC = SPACE;                                           /*@0001VLS*/
         MVI   MSGCC,X'09'                                         0224
* MYLINCT = LINECT - ONE;                                  /*@0001VLS*/
         LH    @06,LINECT(,R2)                                     0225
         BCTR  @06,0                                               0225
         ST    @06,MYLINCT                                         0225
*END;                                                      /*@0001VLS*/
@EL00006 DS    0H                                                  0226
@EF00006 DS    0H                                                  0226
@ER00006 LM    @14,@12,@SA00006                                    0226
         BR    @14                                                 0226
*/*                                                          @0001VLS*/
*/* OUTPUT THE PERMANENT ERROR SECTION OF THE REPORT.  IF THE HEADERS*/
*/* HAVE NOT BEEN PRINTED, PRINT THE SPACER, AND THEN THE HEADERS.   */
*/* IF THE HEADERS FOR THE DISMOUNT SECTION HAVE NOT BEEN PRINTED,   */
*/* PRINT THE HEADERS, AND THE MESSAGE THAT NO RECORDS EXCEED        */
*/* THRESHOLD.                                               @0001VLS*/
*/*                                                          @0001VLS*/
*CUAPERMS: PROC;                                           /*@0001VLS*/
CUAPERMS STM   @14,@12,@SA00007                                    0227
* RECCPU = CPU;                          /* INITIALIZE FOR SEARCH TO */
         L     @06,CURRPTR                                         0228
         MVC   RECCPU(3),CPU(@06)                                  0228
* RECCUA = CONTRCUA;                     /* FIND DATE RANGE. @0001VLS*/
         MVC   RECCUA(2),CONTRCUA(@06)                             0229
* IF HEAD1 = OFF THEN                                              0230
         TM    HEAD1,B'00010000'                                   0230
         BNZ   @RF00230                                            0230
*    CALL NOHEAD1;                       /* SECTION ONE HEADERS      */
         BAL   @14,NOHEAD1                                         0231
* IF HEAD2 = OFF THEN                                              0232
@RF00230 TM    HEAD2,B'00001000'                                   0232
         BNZ   @RF00232                                            0232
*    DO;                                                   /*@0001VLS*/
*      MSGADDR = SPACER;                 /* SPACER LINE      @0001VLS*/
         MVC   MSGADDR(132),SPACER                                 0234
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0235
*      CALL PRINTIT;                     /* BLANK LINE       @0001VLS*/
         BAL   @14,PRINTIT                                         0236
*      MYLINCT = MYLINCT - TWO;                            /*@0001VLS*/
         L     @06,MYLINCT                                         0237
         BCTR  @06,0                                               0237
         BCTR  @06,0                                               0237
         ST    @06,MYLINCT                                         0237
*      IF MYLINCT < TWELVE THEN          /* EJECT TO A NEW PAGE IF   */
         C     @06,@CF00033                                        0238
         BNL   @RF00238                                            0238
*        CALL PAGEJECT;                  /* REST OF REPORT WONT FIT  */
         BAL   @14,PAGEJECT                                        0239
*      MSGADDR(44:43+LENGTH(CUAPH1)) = CUAPH1;             /*@0001VLS*/
@RF00238 MVC   MSGADDR+43(25),CUAPH1                               0240
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0241
*      MSGADDR(74:73+LENGTH(CUAPH2)) = CUAPH2;             /*@0001VLS*/
         MVC   MSGADDR+73(11),CUAPH2                               0242
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0243
*      MSGADDR(81:80+LENGTH(CUAPH3)) = CUAPH3;             /*@0001VLS*/
         MVC   MSGADDR+80(42),CUAPH3                               0244
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0245
*      MSGADDR = CUAPH4;                                   /*@0001VLS*/
         MVI   MSGADDR+120,C' '                                    0246
         MVC   MSGADDR+121(11),MSGADDR+120                         0246
         MVC   MSGADDR(120),CUAPH4                                 0246
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0247
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0248
*      MYLINCT = MYLINCT - FIVE;                           /*@0001VLS*/
         L     @06,MYLINCT                                         0249
         SL    @06,@CF00036                                        0249
         ST    @06,MYLINCT                                         0249
*      HEAD2 = ON;                                         /*@0001VLS*/
         OI    HEAD2,B'00001000'                                   0250
*    END;                                                  /*@0001VLS*/
* IF MYLINCT < SEVEN THEN                /* EJECT TO NEW PAGE IF REST*/
@RF00232 L     @06,MYLINCT                                         0252
         C     @06,@CF00082                                        0252
         BNL   @RF00252                                            0252
*   DO;                                  /* OF REPORT WILL NOT FIT   */
*     CALL PAGEJECT;                                       /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0254
*     MSGADDR(44:43+LENGTH(CUAPH1)) = CUAPH1;              /*@0001VLS*/
         MVC   MSGADDR+43(25),CUAPH1                               0255
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0256
*     MSGADDR(74:73+LENGTH(CUAPH2)) = CUAPH2;              /*@0001VLS*/
         MVC   MSGADDR+73(11),CUAPH2                               0257
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0258
*     MSGADDR(81:80+LENGTH(CUAPH3)) = CUAPH3;              /*@0001VLS*/
         MVC   MSGADDR+80(42),CUAPH3                               0259
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0260
*     MSGADDR = CUAPH4;                                    /*@0001VLS*/
         MVI   MSGADDR+120,C' '                                    0261
         MVC   MSGADDR+121(11),MSGADDR+120                         0261
         MVC   MSGADDR(120),CUAPH4                                 0261
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0262
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0263
*     MYLINCT = MYLINCT - FIVE;                            /*@0001VLS*/
         L     @06,MYLINCT                                         0264
         SL    @06,@CF00036                                        0264
         ST    @06,MYLINCT                                         0264
*   END;                                                   /*@0001VLS*/
* CALL CONVERT (SECUA2,TEMPAREA,TWO);    /* SECONDARY CUA    @0001VLS*/
@RF00252 MVC   @AL00001+4(8),@AL00266                              0266
         LA    @06,SECUA2(,R7)                                     0266
         ST    @06,@AL00001                                        0266
         LA    @01,@AL00001                                        0266
         BAL   @14,CONVERT                                         0266
* OUTDEV = TEMPAREA(2:4);                                  /*@0001VLS*/
         MVC   OUTDEV(3),TEMPAREA+1                                0267
* IF OSER74XX ^= HEXZEROS THEN                                     0268
         CLC   OSER74XX(2,R7),@CB00208                             0268
         BE    @RF00268                                            0268
*   CALL CONVBIN2(OSER74XX,OUTSER);      /* TAPE UNIT SERIAL NUMBER  */
         LA    @06,OSER74XX(,R7)                                   0269
         ST    @06,@AL00001                                        0269
         LA    @06,OUTSER                                          0269
         ST    @06,@AL00001+4                                      0269
         LA    @01,@AL00001                                        0269
         BAL   @14,CONVBIN2                                        0269
* ELSE                                                             0270
*   OUTSER = NA;                                           /*@0001VLS*/
         B     @RC00268                                            0270
@RF00268 MVC   OUTSER(5),@CC00483                                  0270
* IF SENSBIT3(1) = OFF THEN              /* PERMANENT ERROR  @0001VLS*/
@RC00268 TM    SENSBIT3(R7),B'00010000'                            0271
         BNZ   @RF00271                                            0271
*   IF SENSBIT5(2) = ON THEN                                       0272
         TM    SENSBIT5+1(R7),B'00000100'                          0272
         BNO   @RF00272                                            0272
*     OUTERR = ERRTABC(1);                                 /*@0001VLS*/
         MVC   OUTERR(2),ERRTABC                                   0273
*   ELSE                                                           0274
*     OUTERR = ERRTABC(2);                                 /*@0001VLS*/
         B     @RC00272                                            0274
@RF00272 MVC   OUTERR(2),ERRTABC+34                                0274
* ELSE                                                             0275
*   IF SENSBIT5(8) = ON THEN             /* EQUIPMENT CHECK  @0001VLS*/
         B     @RC00271                                            0275
@RF00271 TM    SENSBIT5+7(R7),B'00000100'                          0275
         BNO   @RF00275                                            0275
*     OUTERR = ERRTABC(5);                                 /*@0001VLS*/
         MVC   OUTERR(2),ERRTABC+136                               0276
*   ELSE                                                           0277
*     IF SENSBIT7(8) = ON THEN                                     0277
         B     @RC00275                                            0277
@RF00275 TM    SENSBIT7+7(R7),B'00000001'                          0277
         BNO   @RF00277                                            0277
*       OUTERR = ERRTABC(7);                               /*@0001VLS*/
         MVC   OUTERR(2),ERRTABC+204                               0278
*     ELSE                                                         0279
*       IF SENSBIT6(8) = ON THEN                                   0279
         B     @RC00277                                            0279
@RF00277 TM    SENSBIT6+7(R7),B'00000010'                          0279
         BNO   @RF00279                                            0279
*         OUTERR = ERRTABC(8);                             /*@0001VLS*/
         MVC   OUTERR(2),ERRTABC+238                               0280
*       ELSE                                                       0281
*         IF SENSBIT3(8) = ON THEN                                 0281
         B     @RC00279                                            0281
@RF00279 TM    SENSBIT3+7(R7),B'00010000'                          0281
         BNO   @RF00281                                            0281
*           OUTERR = ERRTABC(11);                          /*@0001VLS*/
         MVC   OUTERR(2),ERRTABC+340                               0282
*         ELSE                                                     0283
*           IF SENSBIT5(11) = ON THEN                              0283
         B     @RC00281                                            0283
@RF00281 TM    SENSBIT5+10(R7),B'00000100'                         0283
         BNO   @RF00283                                            0283
*             OUTERR = ERRTABC(9);                         /*@0001VLS*/
         MVC   OUTERR(2),ERRTABC+272                               0284
*           ELSE                                                   0285
*             IF SENSBIT7(11) = ON THEN                            0285
         B     @RC00283                                            0285
@RF00283 TM    SENSBIT7+10(R7),B'00000001'                         0285
         BNO   @RF00285                                            0285
*               OUTERR = ERRTABC(10);                      /*@0001VLS*/
         MVC   OUTERR(2),ERRTABC+306                               0286
*             ELSE                                                 0287
*               OUTERR = ERRTABC(4);                       /*@0001VLS*/
         B     @RC00285                                            0287
@RF00285 MVC   OUTERR(2),ERRTABC+102                               0287
* PVOL = VOLID;                          /* VOLUME IDENTIFICATION    */
@RC00285 DS    0H                                                  0288
@RC00283 DS    0H                                                  0288
@RC00281 DS    0H                                                  0288
@RC00279 DS    0H                                                  0288
@RC00277 DS    0H                                                  0288
@RC00275 DS    0H                                                  0288
@RC00271 MVC   PVOL(6),VOLID(R7)                                   0288
* CALL CONVERT (FAILCCW,PCCW,EIGHT);     /* FAILING CCW      @0001VLS*/
         MVC   @AL00001+4(8),@AL00289                              0289
         LA    @06,FAILCCW(,R7)                                    0289
         ST    @06,@AL00001                                        0289
         LA    @01,@AL00001                                        0289
         BAL   @14,CONVERT                                         0289
* CALL CONVERT (CSW,PCSW,FOUR);          /* FAILING CSW      @0001VLS*/
         MVC   @AL00001+4(8),@AL00290                              0290
         LA    @06,CSW(,R7)                                        0290
         ST    @06,@AL00001                                        0290
         LA    @01,@AL00001                                        0290
         BAL   @14,CONVERT                                         0290
* DO Z = ONE TO 24;                                        /*@0001VLS*/
         LA    @06,1                                               0291
         ST    @06,Z                                               0291
@DL00291 DS    0H                                                  0292
*   CALL CONVERT (SENSE(Z),PSNSB(Z),ONE);  /* SENSE BYTES    @0001VLS*/
         LA    @03,SENSE-1(@06,R7)                                 0292
         ST    @03,@AL00001                                        0292
         MH    @06,@CH00076                                        0292
         LA    @06,PSNSB-3(@06)                                    0292
         ST    @06,@AL00001+4                                      0292
         LA    @06,@CF00055                                        0292
         ST    @06,@AL00001+8                                      0292
         LA    @01,@AL00001                                        0292
         BAL   @14,CONVERT                                         0292
* END;                                                     /*@0001VLS*/
         LA    @06,1                                               0293
         AL    @06,Z                                               0293
         ST    @06,Z                                               0293
         C     @06,@CF00227                                        0293
         BNH   @DL00291                                            0293
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0294
* MYLINCT = MYLINCT - ONE;                                 /*@0001VLS*/
         L     @06,MYLINCT                                         0295
         BCTR  @06,0                                               0295
         ST    @06,MYLINCT                                         0295
*END;                                                      /*@0001VLS*/
@EL00007 DS    0H                                                  0296
@EF00007 DS    0H                                                  0296
@ER00007 LM    @14,@12,@SA00007                                    0296
         BR    @14                                                 0296
*/*                                                          @0001VLS*/
*/* OUTPUT THE DISMOUNT SECTION OF THE REPORT.  IF THE HEADERS HAVE  */
*/* NOT BEEN PRINTED, THEN PRINT THE HEADERS FOR SECTION ONE.        */
*/*                                                          @0001VLS*/
* CUASTATS: PROC;                                          /*@0001VLS*/
CUASTATS STM   @14,@12,@SA00008                                    0297
*    IF HEAD1 = OFF THEN            /* PRINT HEADERS         @0001VLS*/
         TM    HEAD1,B'00010000'                                   0298
         BNZ   @RF00298                                            0298
*      DO;                                                 /*@0001VLS*/
*        CALL OUTHED12;                                    /*@0001VLS*/
         BAL   @14,OUTHED12                                        0300
*        CUASH3R = RDTHRSH;         /* READ THRESHOLD        @0001VLS*/
         MVC   CUASH3R(3),RDTHRSH(R2)                              0301
*        CUASH3W = WRTHRSH;         /* WRITE THRESHOLD       @0001VLS*/
         MVC   CUASH3W(3),WRTHRSH(R2)                              0302
*        MSGADDR(30:29+LENGTH(CUASH3)) = CUASH3;           /*@0001VLS*/
         MVC   MSGADDR+29(61),CUASH3                               0303
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0304
*        CALL PRINTIT;              /* BLANK LINE            @0001VLS*/
         BAL   @14,PRINTIT                                         0305
*        MSGADDR = CUASH4;                                 /*@0001VLS*/
         MVI   MSGADDR+130,C' '                                    0306
         MVI   MSGADDR+131,C' '                                    0306
         MVC   MSGADDR(130),CUASH4                                 0306
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0307
*        MSGADDR = CUASH5;                                 /*@0001VLS*/
         MVI   MSGADDR+129,C' '                                    0308
         MVC   MSGADDR+130(2),MSGADDR+129                          0308
         MVC   MSGADDR(129),CUASH5                                 0308
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0309
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0310
*        MYLINCT = MYLINCT - FIVE;                         /*@0001VLS*/
         L     @06,MYLINCT                                         0311
         SL    @06,@CF00036                                        0311
         ST    @06,MYLINCT                                         0311
*      END;                                                /*@0001VLS*/
*    IF MYLINCT < THREE THEN              /* EJECT TO NEW PAGE IF    */
@RF00298 L     @06,MYLINCT                                         0313
         C     @06,@CF00076                                        0313
         BNL   @RF00313                                            0313
*      DO;                                /* REST OF REPORT WONT FIT */
*        CALL PAGEJECT;                                    /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0315
*        MSGADDR(40:39+LENGTH(CUASH1)) = CUASH1;           /*@0001VLS*/
         MVC   MSGADDR+39(40),CUASH1                               0316
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0317
*        MSGADDR(40:39+LENGTH(CUASH2)) = CUASH2;           /*@0001VLS*/
         MVC   MSGADDR+39(40),CUASH2                               0318
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0319
*        MSGADDR(30:29+LENGTH(CUASH3)) = CUASH3;           /*@0001VLS*/
         MVC   MSGADDR+29(61),CUASH3                               0320
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0321
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0322
*        MSGADDR = CUASH4;                                 /*@0001VLS*/
         MVI   MSGADDR+130,C' '                                    0323
         MVI   MSGADDR+131,C' '                                    0323
         MVC   MSGADDR(130),CUASH4                                 0323
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0324
*        MSGADDR = CUASH5;                                 /*@0001VLS*/
         MVI   MSGADDR+129,C' '                                    0325
         MVC   MSGADDR+130(2),MSGADDR+129                          0325
         MVC   MSGADDR(129),CUASH5                                 0325
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0326
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0327
*        MYLINCT = MYLINCT - SEVEN;                        /*@0001VLS*/
         L     @06,MYLINCT                                         0328
         SL    @06,@CF00082                                        0328
         ST    @06,MYLINCT                                         0328
*      END;                                                /*@0001VLS*/
*    CALL CONVERT (OCUA2,TEMPAREA,TWO);   /* PRIMARY CUA     @0001VLS*/
@RF00313 MVC   @AL00001+4(8),@AL00330                              0330
         LA    @06,OCUA2(,R7)                                      0330
         ST    @06,@AL00001                                        0330
         LA    @01,@AL00001                                        0330
         BAL   @14,CONVERT                                         0330
*    OUTCUA = TEMPAREA(2:4);                               /*@0001VLS*/
         MVC   OUTCUA(3),TEMPAREA+1                                0331
*    IF SNSCNT <= 9 × OSER74XX = HEXZEROS THEN                     0332
         CLC   SNSCNT(2,R7),@CH00085                               0332
         BNH   @RT00332                                            0332
         CLC   OSER74XX(2,R7),@CB00208                             0332
         BNE   @RF00332                                            0332
@RT00332 DS    0H                                                  0333
*      TUSER = NA;                                         /*@0001VLS*/
         MVC   TUSER(5),@CC00483                                   0333
*    ELSE                                                          0334
*      CALL CONVBIN2(OSER74XX,TUSER);     /* TAPE UNIT SERIAL NUMBER */
         B     @RC00332                                            0334
@RF00332 LA    @06,OSER74XX(,R7)                                   0334
         ST    @06,@AL00001                                        0334
         LA    @06,TUSER                                           0334
         ST    @06,@AL00001+4                                      0334
         LA    @01,@AL00001                                        0334
         BAL   @14,CONVBIN2                                        0334
*    CALL CONVERT (DATE(2:4),TEMPAREA,SIX);                /*@0001VLS*/
@RC00332 MVC   @AL00001+4(8),@AL00335                              0335
         LA    @06,DATE+1(,R7)                                     0335
         ST    @06,@AL00001                                        0335
         LA    @01,@AL00001                                        0335
         BAL   @14,CONVERT                                         0335
*    DAY = TEMPAREA(3:5);                                  /*@0001VLS*/
         MVC   DAY(3),TEMPAREA+2                                   0336
*    YEAR = TEMPAREA(1:2);                                 /*@0001VLS*/
         MVC   YEAR(2),TEMPAREA                                    0337
*    OVOLUME = VOLID;               /* VOLUME                @0001VLS*/
         MVC   OVOLUME(6),VOLID(R7)                                0338
*    CALL CONVERT (TIME,TEMPAREA,EIGHT);                   /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00339                              0339
         LA    @06,TIME(,R7)                                       0339
         ST    @06,@AL00001                                        0339
         LA    @01,@AL00001                                        0339
         BAL   @14,CONVERT                                         0339
*    HH = TEMPAREA(1:2);                                   /*@0001VLS*/
         MVC   HH(2),TEMPAREA                                      0340
*    MM = TEMPAREA(3:4);                                   /*@0001VLS*/
         MVC   MM(2),TEMPAREA+2                                    0341
*    SS = TEMPAREA(5:6);                                   /*@0001VLS*/
         MVC   SS(2),TEMPAREA+4                                    0342
*    POINT = PERIOD;                                       /*@0001VLS*/
         MVI   POINT,C'.'                                          0343
*    TH = TEMPAREA(7:8);                                   /*@0001VLS*/
         MVC   TH(2),TEMPAREA+6                                    0344
*    CALL CONVBIN1(READTH,OREADS);  /* TEMPORARY READ ERRORS @0001VLS*/
         LA    @06,READTH(,R7)                                     0345
         ST    @06,@AL00001                                        0345
         LA    @06,OREADS                                          0345
         ST    @06,@AL00001+4                                      0345
         LA    @01,@AL00001                                        0345
         BAL   @14,CONVBIN1                                        0345
*    CALL CONVBIN1(RITETH,WRTS);    /* TEMPORARY WRITE ERRORS        */
         LA    @06,RITETH(,R7)                                     0346
         ST    @06,@AL00001                                        0346
         LA    @06,WRTS                                            0346
         ST    @06,@AL00001+4                                      0346
         LA    @01,@AL00001                                        0346
         BAL   @14,CONVBIN1                                        0346
*    CALL CONVBIN2(RECSIOS,SIOCNT); /* SIO COUNT             @0001VLS*/
         LA    @06,RECSIOS(,R7)                                    0347
         ST    @06,@AL00001                                        0347
         LA    @06,SIOCNT                                          0347
         ST    @06,@AL00001+4                                      0347
         LA    @01,@AL00001                                        0347
         BAL   @14,CONVBIN2                                        0347
*    NRZIN = NA;                    /* ONLY VALID FOR 800 BPI        */
         MVC   NRZIN(5),@CC00483                                   0348
*    IF OSER74XX = HEXZEROS THEN                                   0349
         CLC   OSER74XX(2,R7),@CB00208                             0349
         BNE   @RF00349                                            0349
*      DENSITY = NA;                /* NO DENSITY            @0001VLS*/
         MVC   DENSITY(4),@CC00483                                 0350
*    ELSE                                                          0351
*      IF SENSBIT5(4) = ON THEN                                    0351
         B     @RC00349                                            0351
@RF00349 TM    SENSBIT5+3(R7),B'00000100'                          0351
         BNO   @RF00351                                            0351
*        DENSITY = BPI1600;                                /*@0001VLS*/
         MVC   DENSITY(4),@CC00479                                 0352
*      ELSE                                                        0353
*        IF SENSBIT4(7) = ON THEN   /* BIRCH DEVICE          @0001VLS*/
         B     @RC00351                                            0353
@RF00351 TM    SENSBIT4+6(R7),B'00001000'                          0353
         BNO   @RF00353                                            0353
*          DENSITY = BPI6250;                              /*@0001VLS*/
         MVC   DENSITY(4),@CC00481                                 0354
*        ELSE                                                      0355
*          DO;                                             /*@0001VLS*/
         B     @RC00353                                            0355
@RF00353 DS    0H                                                  0356
*            DENSITY = BPI800;                             /*@0001VLS*/
         MVC   DENSITY(4),@CC00477                                 0356
*            CALL CONVBIN1(NOISE,NRZIN);   /* CONVERT NRZI NOISE     */
         LA    @06,NOISE(,R7)                                      0357
         ST    @06,@AL00001                                        0357
         LA    @06,NRZIN                                           0357
         ST    @06,@AL00001+4                                      0357
         LA    @01,@AL00001                                        0357
         BAL   @14,CONVBIN1                                        0357
*          END;                                            /*@0001VLS*/
*    CALL CONVBIN1(RWVRC,ORWVRC);                          /*@0001VLS*/
@RC00353 DS    0H                                                  0359
@RC00351 DS    0H                                                  0359
@RC00349 LA    @06,RWVRC(,R7)                                      0359
         ST    @06,@AL00001                                        0359
         LA    @06,ORWVRC                                          0359
         ST    @06,@AL00001+4                                      0359
         LA    @01,@AL00001                                        0359
         BAL   @14,CONVBIN1                                        0359
*    IF SNSCNT <= 9 THEN                                           0360
         CLC   SNSCNT(2,R7),@CH00085                               0360
         BH    @RF00360                                            0360
*      DO;                                                 /*@0001VLS*/
*        WRTGVRC = NA;                                     /*@0001VLS*/
         MVC   WRTGVRC(5),@CC00483                                 0362
*        ERLYBOR = NA;                                     /*@0001VLS*/
         MVC   ERLYBOR(5),@CC00483                                 0363
*        OVELCHG = NA;                                     /*@0001VLS*/
         MVC   OVELCHG(5),@CC00483                                 0364
*      END;                                                /*@0001VLS*/
*    ELSE                                                          0366
*      DO;                                                 /*@0001VLS*/
         B     @RC00360                                            0366
@RF00360 DS    0H                                                  0367
*        I = CCOMVRC & ZEROFOX;           /* RIGHT HALF OF THE FIELD */
         LA    @06,15                                              0367
         SLR   @03,@03                                             0367
         IC    @03,CCOMVRC(,R7)                                    0367
         NR    @06,@03                                             0367
         STH   @06,I                                               0367
*        CALL CONVBIN2(I,WRTGVRC);                         /*@0001VLS*/
         LA    @01,@AL00368                                        0368
         BAL   @14,CONVBIN2                                        0368
*        I = EXPEARL & ZEROFOX;           /* RIGHT HALF OF THE FIELD */
         LA    @06,15                                              0369
         SLR   @03,@03                                             0369
         IC    @03,EXPEARL(,R7)                                    0369
         NR    @06,@03                                             0369
         STH   @06,I                                               0369
*        CALL CONVBIN2 (I,ERLYBOR);                        /*@0001VLS*/
         LA    @01,@AL00370                                        0370
         BAL   @14,CONVBIN2                                        0370
*        I = RECVEL & ZEROFOX;            /* RIGHT HALF OF THE FIELD */
         LA    @06,15                                              0371
         SLR   @03,@03                                             0371
         IC    @03,RECVEL(,R7)                                     0371
         NR    @06,@03                                             0371
         STH   @06,I                                               0371
*        CALL CONVBIN2 (I,OVELCHG);                        /*@0001VLS*/
         LA    @01,@AL00372                                        0372
         BAL   @14,CONVBIN2                                        0372
*      END;                                                /*@0001VLS*/
*    CALL CONVBIN1 (MTELRCR,LRCMTE);                       /*@0001VLS*/
@RC00360 LA    @06,MTELRCR(,R7)                                    0374
         ST    @06,@AL00001                                        0374
         LA    @06,LRCMTE                                          0374
         ST    @06,@AL00001+4                                      0374
         LA    @01,@AL00001                                        0374
         BAL   @14,CONVBIN1                                        0374
*    CALL CONVBIN1 (EDCCRC,CRCEDC);                        /*@0001VLS*/
         LA    @06,EDCCRC(,R7)                                     0375
         ST    @06,@AL00001                                        0375
         LA    @06,CRCEDC                                          0375
         ST    @06,@AL00001+4                                      0375
         LA    @01,@AL00001                                        0375
         BAL   @14,CONVBIN1                                        0375
*    CALL CONVBIN1 (RECVRC,ECCENV);                        /*@0001VLS*/
         LA    @06,RECVRC(,R7)                                     0376
         ST    @06,@AL00001                                        0376
         LA    @06,ECCENV                                          0376
         ST    @06,@AL00001+4                                      0376
         LA    @01,@AL00001                                        0376
         BAL   @14,CONVBIN1                                        0376
*    I = RECOVER & ZEROFOX;               /* RIGHT HALF OF THE FIELD */
         LA    @06,15                                              0377
         SLR   @03,@03                                             0377
         IC    @03,RECOVER(,R7)                                    0377
         NR    @06,@03                                             0377
         STH   @06,I                                               0377
*    CALL CONVBIN2 (I,SKEWERR);                            /*@0001VLS*/
         LA    @01,@AL00378                                        0378
         BAL   @14,CONVBIN2                                        0378
*    CALL CONVERT (CPUMOD,MCPU,TWO);                       /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00379                              0379
         LA    @06,CPUMOD(,R7)                                     0379
         ST    @06,@AL00001                                        0379
         LA    @01,@AL00001                                        0379
         BAL   @14,CONVERT                                         0379
*    CALL CONVERT (CPUSER,SERCPU,THREE);                   /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00380                              0380
         LA    @06,CPUSER(,R7)                                     0380
         ST    @06,@AL00001                                        0380
         LA    @01,@AL00001                                        0380
         BAL   @14,CONVERT                                         0380
*    IF HDRSER = HEXZEROS THEN                                     0381
         CLC   HDRSER(2,R7),@CB00208                               0381
         BNE   @RF00381                                            0381
*      HEADSER = NA;                                       /*@0001VLS*/
         MVC   HEADSER(5),@CC00483                                 0382
*    ELSE                                                          0383
*      CALL CONVBIN2 (HDRSER,HEADSER);                     /*@0001VLS*/
         B     @RC00381                                            0383
@RF00381 LA    @06,HDRSER(,R7)                                     0383
         ST    @06,@AL00001                                        0383
         LA    @06,HEADSER                                         0383
         ST    @06,@AL00001+4                                      0383
         LA    @01,@AL00001                                        0383
         BAL   @14,CONVBIN2                                        0383
*    CALL PRINTIT;                                         /*@0001VLS*/
@RC00381 BAL   @14,PRINTIT                                         0384
*    MYLINCT = MYLINCT - ONE;                              /*@0001VLS*/
         L     @06,MYLINCT                                         0385
         BCTR  @06,0                                               0385
         ST    @06,MYLINCT                                         0385
* END;                                                     /*@0001VLS*/
@EL00008 DS    0H                                                  0386
@EF00008 DS    0H                                                  0386
@ER00008 LM    @14,@12,@SA00008                                    0386
         BR    @14                                                 0386
*FINDDATE: PROC;                                           /*@0001VLS*/
FINDDATE STM   @14,@12,@SA00009                                    0387
*   FOUND = OFF;                                           /*@0001VLS*/
         NI    FOUND,B'11011111'                                   0388
*   CHAIN = CHAIN && CHAIN;                                /*@0001VLS*/
         XC    CHAIN(5),CHAIN                                      0389
*   CHAINCPU = RECCPU;             /* CPU SERIAL NUMBER      @0001VLS*/
         MVC   CHAINCPU(3),RECCPU                                  0390
*   CHAINCUX = RECCUA;                                     /*@0001VLS*/
         MVC   CHAINCUX(2),RECCUA                                  0391
*   CHAINCUX(2) = CHAINCUX(2) & FOXZERO;   /* CONTROL UNIT   @0001VLS*/
         NI    CHAINCUX+1,X'F0'                                    0392
*   DATEPTR = LHDATPTR;            /* INITIALIZE FOR SEARCH  @0001VLS*/
         L     @06,LHDATPTR                                        0393
         ST    @06,DATEPTR                                         0393
*   DO WHILE(DATEPTR ^= ZERO & FOUND = OFF);               /*@0001VLS*/
         B     @DE00394                                            0394
@DL00394 DS    0H                                                  0395
*     IF CHAIN = DATECC THEN                                       0395
         L     @06,DATEPTR                                         0395
         CLC   CHAIN(5),DATECC(@06)                                0395
         BNE   @RF00395                                            0395
*       FOUND = ON;                /* FOUND THE APPROPRIATE SET      */
         OI    FOUND,B'00100000'                                   0396
*     ELSE                                                         0397
*       DO;                                                /*@0001VLS*/
         B     @RC00395                                            0397
@RF00395 DS    0H                                                  0398
*         Z = DATEPTR;             /* SAVE THIS VALUE        @0001VLS*/
         L     @06,DATEPTR                                         0398
         ST    @06,Z                                               0398
*         DATEPTR = NEXTDATE;      /* NEXT ENTRY             @0001VLS*/
         L     @06,NEXTDATE(,@06)                                  0399
         ST    @06,DATEPTR                                         0399
*       END;                                               /*@0001VLS*/
*   END;                                                   /*@0001VLS*/
@RC00395 DS    0H                                                  0401
@DE00394 L     @06,DATEPTR                                         0401
         LTR   @06,@06                                             0401
         BZ    @DC00394                                            0401
         TM    FOUND,B'00100000'                                   0401
         BZ    @DL00394                                            0401
@DC00394 DS    0H                                                  0402
*   IF DATEPTR = ZERO THEN                                         0402
         L     @06,DATEPTR                                         0402
         LTR   @06,@06                                             0402
         BNZ   @RF00402                                            0402
*     DO;                          /* GENERATE A NEW SET OF ENTRIES  */
*       RESPECIFY (R0,R15) RESTRICTED;                     /*@0001VLS*/
*       R0 = LENGTH(DATEAREA);                             /*@0001VLS*/
         LA    R0,15                                               0405
*       GEN(GETMAIN EC,LV=(0),A=DATEPTR);                  /*@0001VLS*/
         GETMAIN EC,LV=(0),A=DATEPTR
*       RETCODE = R15;                                     /*@0001VLS*/
         ST    R15,RETCODE                                         0407
*       RESPECIFY (R0,R15) UNRESTRICTED;                   /*@0001VLS*/
*       IF RETCODE = ZERO THEN                                     0409
         L     @06,RETCODE                                         0409
         SLR   @03,@03                                             0409
         CR    @06,@03                                             0409
         BNE   @RF00409                                            0409
*         DO;                                              /*@0001VLS*/
*           NEXTDATE = ZERO;       /* CLEAR NEXT AREA POINTER        */
         L     @06,DATEPTR                                         0411
         ST    @03,NEXTDATE(,@06)                                  0411
*           LOWDATE = DATE(2:4);                           /*@0001VLS*/
         MVC   LOWDATE(3,@06),DATE+1(R7)                           0412
*           HIDATE = DATE(2:4);                            /*@0001VLS*/
         MVC   HIDATE(3,@06),DATE+1(R7)                            0413
*           DATECC = CHAIN;                                /*@0001VLS*/
         MVC   DATECC(5,@06),CHAIN                                 0414
*           IF LHDATPTR = ZERO THEN                                0415
         C     @03,LHDATPTR                                        0415
         BNE   @RF00415                                            0415
*             LHDATPTR = DATEPTR;  /* POINT TO FIRST ENTRY   @0001VLS*/
         ST    @06,LHDATPTR                                        0416
*           ELSE                                                   0417
*             Z -> NEXTDATE = DATEPTR;                     /*@0001VLS*/
         B     @RC00415                                            0417
@RF00415 L     @06,DATEPTR                                         0417
         L     @03,Z                                               0417
         ST    @06,NEXTDATE(,@03)                                  0417
*         END;                                             /*@0001VLS*/
@RC00415 DS    0H                                                  0419
*     END;                                                 /*@0001VLS*/
@RF00409 DS    0H                                                  0420
*   IF HVOLDATE > DATE(2:4) THEN                                   0420
@RF00402 CLC   HVOLDATE(3),DATE+1(R7)                              0420
         BNH   @RF00420                                            0420
*     HVOLDATE = DATE(2:4);        /* HIGH VOLUME DATE       @0001VLS*/
         MVC   HVOLDATE(3),DATE+1(R7)                              0421
*   IF LVOLDATE < DATE(2:4) THEN                                   0422
@RF00420 CLC   LVOLDATE(3),DATE+1(R7)                              0422
         BNL   @RF00422                                            0422
*     LVOLDATE = DATE(2:4);        /* LOW VOLUME DATE        @0001VLS*/
         MVC   LVOLDATE(3),DATE+1(R7)                              0423
* END;                                                     /*@0001VLS*/
@EL00009 DS    0H                                                  0424
@EF00009 DS    0H                                                  0424
@ER00009 LM    @14,@12,@SA00009                                    0424
         BR    @14                                                 0424
*OUTTYPES: PROC;                   /* SORT BREAK PROCESSING  @0001VLS*/
OUTTYPES STM   @14,@12,@SA00010                                    0425
* IF HEAD3 = OFF THEN                                              0426
         TM    HEAD3,B'00000100'                                   0426
         BNZ   @RF00426                                            0426
*   DO;                                                    /*@0001VLS*/
*     IF HEAD2 = ON THEN                                           0428
         TM    HEAD2,B'00001000'                                   0428
         BNO   @RF00428                                            0428
*       CALL OUTCODES;             /* THE ERROR CODES        @0001VLS*/
         BAL   @14,OUTCODES                                        0429
*     MSGADDR = SPACER;            /* SPACER LINE            @0001VLS*/
@RF00428 MVC   MSGADDR(132),SPACER                                 0430
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0431
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0432
*     MYLINCT = MYLINCT - TWO;                             /*@0001VLS*/
         LA    @06,2                                               0433
         L     @03,MYLINCT                                         0433
         SLR   @03,@06                                             0433
         ST    @03,MYLINCT                                         0433
*     IF MYLINCT < TWO THEN        /* BOTH LINES WILL NOT FIT ON PAGE*/
         CR    @03,@06                                             0434
         BNL   @RF00434                                            0434
*       CALL PAGEJECT;                                     /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0435
*     MSGADDR(40:39+LENGTH(CUATH1)) = CUATH1;              /*@0001VLS*/
@RF00434 MVC   MSGADDR+39(44),CUATH1                               0436
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0437
*     MSGADDR(20:19+LENGTH(NOTOTALS)) = NOTOTALS;          /*@0001VLS*/
         MVC   MSGADDR+19(32),NOTOTALS                             0438
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0439
*   END;                                                   /*@0001VLS*/
* HEAD1 = OFF;                                             /*@0001VLS*/
@RF00426 DS    0H                                                  0442
* HEAD2 = OFF;                                             /*@0001VLS*/
* HEAD3 = OFF;                                             /*@0001VLS*/
         NI    HEAD1,B'11100011'                                   0443
* IF EOTABLE ^= 'FFFF'X THEN                                       0444
         L     @06,CURRPTR                                         0444
         CLC   EOTABLE(2,@06),@CB00261                             0444
         BE    @RF00444                                            0444
*   OLDCPUCU = SORTCPUC;                                   /*@0001VLS*/
         MVC   OLDCPUCU(5),SORTCPUC(@06)                           0445
* END;                                                     /*@0001VLS*/
@EL00010 DS    0H                                                  0446
@EF00010 DS    0H                                                  0446
@ER00010 LM    @14,@12,@SA00010                                    0446
         BR    @14                                                 0446
*/*                                                          @0001VLS*/
*/* OUTPUT THE TEMPORARY ERROR SUMMARY.  ONLY PRODUCE A LINE FOR EACH*/
*/* CUA FOR WHICH THERE WERE ANY SIOS.                       @0001VLS*/
*/*                                                          @0001VLS*/
*TEMPSUM:  PROC;                                           /*@0001VLS*/
TEMPSUM  STM   @14,@12,@SA00011                                    0447
*   SYSSIOS = ZERO;                                        /*@0001VLS*/
         SLR   @06,@06                                             0448
         ST    @06,SYSSIOS                                         0448
*   SYSRDS = ZERO;                                         /*@0001VLS*/
         ST    @06,SYSRDS                                          0449
*   SYSRTS = ZERO;                                         /*@0001VLS*/
         ST    @06,SYSRTS                                          0450
*   SYSMNTS = ZERO;                                        /*@0001VLS*/
         ST    @06,SYSMNTS                                         0451
*   RECCPU = CPU;                      /* INITIALIZE FOR THE SEARCH  */
         L     @06,CURRPTR                                         0452
         MVC   RECCPU(3),CPU(@06)                                  0452
*   RECCUA = CONTRCUA;                 /* OF THE DATE RANGE  @0001VLS*/
         MVC   RECCUA(2),CONTRCUA(@06)                             0453
*   IF HEAD1 = OFF THEN                                            0454
         TM    HEAD1,B'00010000'                                   0454
         BNZ   @RF00454                                            0454
*     CALL NOHEAD1;                    /* OUTPUT NO PART 1 MESSAGE   */
         BAL   @14,NOHEAD1                                         0455
*   IF HEAD2 = OFF THEN                                            0456
@RF00454 TM    HEAD2,B'00001000'                                   0456
         BNZ   @RF00456                                            0456
*     CALL NOHEAD2;                    /* OUTPUT NO PART2 MESSAGE    */
         BAL   @14,NOHEAD2                                         0457
*   ELSE                                                           0458
*     CALL OUTCODES;                   /* OUTPUT ERROR CODES @0001VLS*/
         B     @RC00456                                            0458
@RF00456 BAL   @14,OUTCODES                                        0458
*   MSGADDR = SPACER;                                      /*@0001VLS*/
@RC00456 MVC   MSGADDR(132),SPACER                                 0459
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0460
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0461
*   MYLINCT = MYLINCT - TWO;                               /*@0001VLS*/
         L     @06,MYLINCT                                         0462
         BCTR  @06,0                                               0462
         BCTR  @06,0                                               0462
         ST    @06,MYLINCT                                         0462
*   IF MYLINCT < EIGHT THEN            /* PAGE EJECT IF REST OF REPRT*/
         C     @06,@CF00066                                        0463
         BNL   @RF00463                                            0463
*     CALL PAGEJECT;                   /* WILL NOT FIT       @0001VLS*/
         BAL   @14,PAGEJECT                                        0464
*   MSGADDR(40:39+LENGTH(CUATH1)) = CUATH1;                /*@0001VLS*/
@RF00463 MVC   MSGADDR+39(44),CUATH1                               0465
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0466
*   MSGADDR(7:6+LENGTH(CUATH2)) = CUATH2;                  /*@0001VLS*/
         MVC   MSGADDR+6(82),CUATH2                                0467
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0468
*   MSGADDR(11:10+LENGTH(CUATH3)) = CUATH3;                /*@0001VLS*/
         MVC   MSGADDR+10(108),CUATH3                              0469
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0470
*   MSGADDR = CUATH4;                                      /*@0001VLS*/
         MVI   MSGADDR+119,C' '                                    0471
         MVC   MSGADDR+120(12),MSGADDR+119                         0471
         MVC   MSGADDR(119),CUATH4                                 0471
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0472
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0473
*   SUMPTR = TABCCHHR(1:4);            /* ADDRESS OF THE COUNTERS    */
         L     @06,CURRPTR                                         0474
         MVC   SUMPTR(4),TABCCHHR(@06)                             0474
*   DO I = 1 TO 16;                                        /*@0001VLS*/
         LA    @06,1                                               0475
         STH   @06,I                                               0475
@DL00475 DS    0H                                                  0476
*     IF SIOS(I) ^= ZERO THEN                                      0476
         MH    @06,@CH01401                                        0476
         L     @03,SUMPTR                                          0476
         AL    @03,@CF01417                                        0476
         L     @06,SIOS-16(@06,@03)                                0476
         LTR   @06,@06                                             0476
         BZ    @RF00476                                            0476
*       DO;                            /* ANY SIOS           @0001VLS*/
*         IF MYLINCT < THREE THEN      /* NEW PAGE IF REST OF REPORT */
         L     @06,MYLINCT                                         0478
         C     @06,@CF00076                                        0478
         BNL   @RF00478                                            0478
*           DO;                        /* WILL NOT FIT       @0001VLS*/
*             CALL PAGEJECT;                               /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0480
*             MSGADDR(40:30+LENGTH(CUATH1)) = CUATH1;      /*@0001VLS*/
         MVC   MSGADDR+39(35),CUATH1                               0481
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0482
*             MSGADDR(7:6+LENGTH(CUATH2)) = CUATH2;        /*@0001VLS*/
         MVC   MSGADDR+6(82),CUATH2                                0483
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0484
*             MSGADDR(11:10+LENGTH(CUATH3)) = CUATH3;      /*@0001VLS*/
         MVC   MSGADDR+10(108),CUATH3                              0485
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0486
*             MSGADDR = CUATH4;                            /*@0001VLS*/
         MVI   MSGADDR+119,C' '                                    0487
         MVC   MSGADDR+120(12),MSGADDR+119                         0487
         MVC   MSGADDR(119),CUATH4                                 0487
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0488
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0489
*             MYLINCT = MYLINCT - FIVE;                    /*@0001VLS*/
         L     @06,MYLINCT                                         0490
         SL    @06,@CF00036                                        0490
         ST    @06,MYLINCT                                         0490
*           END;                                           /*@0001VLS*/
*         TEMPAREA(19:20) = CUX × (I-1);  /* CONVERT THE CUA @0001VLS*/
@RF00478 LH    @06,I                                               0492
         BCTR  @06,0                                               0492
         L     @03,SUMPTR                                          0492
         SLR   @15,@15                                             0492
         ICM   @15,3,CUX(@03)                                      0492
         OR    @06,@15                                             0492
         STCM  @06,3,TEMPAREA+18                                   0492
*         CALL CONVERT(TEMPAREA(19:20),TEMPAREA,TWO);      /*@0001VLS*/
         LA    @01,@AL00493                                        0493
         BAL   @14,CONVERT                                         0493
*         SUMCUA = TEMPAREA(2:4);                          /*@0001VLS*/
         MVC   SUMCUA(3),TEMPAREA+1                                0494
*         CALL CALCPERC(READER(I),SIOS(I),READPERC);       /*@0001VLS*/
         L     @06,SUMPTR                                          0495
         LH    @03,I                                               0495
         MH    @03,@CH01401                                        0495
         LA    @01,0(@03,@06)                                      0495
         AL    @01,@CF01418                                        0495
         ST    @01,@AL00001                                        0495
         AL    @06,@CF01417                                        0495
         LA    @06,SIOS-16(@03,@06)                                0495
         ST    @06,@AL00001+4                                      0495
         LA    @06,READPERC                                        0495
         ST    @06,@AL00001+8                                      0495
         LA    @01,@AL00001                                        0495
         BAL   @14,CALCPERC                                        0495
*         CALL CALCPERC(WRITER(I),SIOS(I),RITEPERC);       /*@0001VLS*/
         L     @06,SUMPTR                                          0496
         LH    @03,I                                               0496
         MH    @03,@CH01401                                        0496
         LA    @01,0(@03,@06)                                      0496
         AL    @01,@CF01419                                        0496
         ST    @01,@AL00001                                        0496
         AL    @06,@CF01417                                        0496
         LA    @06,SIOS-16(@03,@06)                                0496
         ST    @06,@AL00001+4                                      0496
         LA    @06,RITEPERC                                        0496
         ST    @06,@AL00001+8                                      0496
         LA    @01,@AL00001                                        0496
         BAL   @14,CALCPERC                                        0496
*         CALL CONVERT (FDATE(I),TEMPAREA,THREE);          /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00497                              0497
         LH    @06,I                                               0497
         MH    @06,@CH01401                                        0497
         L     @03,SUMPTR                                          0497
         LA    @06,FDATE-48(@06,@03)                               0497
         ST    @06,@AL00001                                        0497
         LA    @01,@AL00001                                        0497
         BAL   @14,CONVERT                                         0497
*         SUMFDATE = TEMPAREA(1:5);                        /*@0001VLS*/
         MVC   SUMFDATE(5),TEMPAREA                                0498
*         CALL CONVERT (TDATE(I),TEMPAREA,THREE);          /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00499                              0499
         LH    @06,I                                               0499
         MH    @06,@CH01401                                        0499
         L     @03,SUMPTR                                          0499
         LA    @06,TDATE-48(@06,@03)                               0499
         ST    @06,@AL00001                                        0499
         LA    @01,@AL00001                                        0499
         BAL   @14,CONVERT                                         0499
*         SUMTDATE = TEMPAREA(1:5);                        /*@0001VLS*/
         MVC   SUMTDATE(5),TEMPAREA                                0500
*         CALL CONVBIN3(SIOS(I),SUMSIOS);                  /*@0001VLS*/
         LH    @06,I                                               0501
         MH    @06,@CH01401                                        0501
         L     @03,SUMPTR                                          0501
         AL    @03,@CF01417                                        0501
         LA    @06,SIOS-16(@06,@03)                                0501
         ST    @06,@AL00001                                        0501
         LA    @06,SUMSIOS                                         0501
         ST    @06,@AL00001+4                                      0501
         LA    @01,@AL00001                                        0501
         BAL   @14,CONVBIN3                                        0501
*         SYSSIOS = SYSSIOS + SIOS(I);   /* TOTAL ALL SIOS   @0001VLS*/
         L     @06,SUMPTR                                          0502
         LH    @03,I                                               0502
         MH    @03,@CH01401                                        0502
         L     @15,SYSSIOS                                         0502
         LA    @14,0(@03,@06)                                      0502
         AL    @14,@CF01417                                        0502
         AL    @15,SIOS-16(,@14)                                   0502
         ST    @15,SYSSIOS                                         0502
*         CALL CONVBIN (MOUNTS(I),SUMMNTS);                /*@0001VLS*/
         AL    @06,@CF01420                                        0503
         LA    @06,MOUNTS-36(@03,@06)                              0503
         ST    @06,@AL00001                                        0503
         LA    @06,SUMMNTS                                         0503
         ST    @06,@AL00001+4                                      0503
         LA    @01,@AL00001                                        0503
         BAL   @14,CONVBIN                                         0503
*         SYSMNTS = SYSMNTS + MOUNTS(I);  /* TOTAL ALL MOUNTS        */
         L     @06,SUMPTR                                          0504
         LH    @03,I                                               0504
         MH    @03,@CH01401                                        0504
         L     @15,SYSMNTS                                         0504
         LA    @14,0(@03,@06)                                      0504
         AL    @14,@CF01420                                        0504
         AL    @15,MOUNTS-36(,@14)                                 0504
         ST    @15,SYSMNTS                                         0504
*         SUMP1 = PERIOD;                                  /*@0001VLS*/
         MVI   SUMP1,C'.'                                          0505
*         CALL CONVBIN (READER(I),SUMREAD);                /*@0001VLS*/
         AL    @06,@CF01418                                        0506
         LA    @06,READER-20(@03,@06)                              0506
         ST    @06,@AL00001                                        0506
         LA    @06,SUMREAD                                         0506
         ST    @06,@AL00001+4                                      0506
         LA    @01,@AL00001                                        0506
         BAL   @14,CONVBIN                                         0506
*         SYSRDS = SYSRDS + READER(I);                     /*@0001VLS*/
         L     @06,SUMPTR                                          0507
         LH    @03,I                                               0507
         MH    @03,@CH01401                                        0507
         L     @15,SYSRDS                                          0507
         LA    @14,0(@03,@06)                                      0507
         AL    @14,@CF01418                                        0507
         AL    @15,READER-20(,@14)                                 0507
         ST    @15,SYSRDS                                          0507
*         CALL CONVBIN (CLEANER(I),SUMCLEAN);              /*@0001VLS*/
         AL    @06,@CF01421                                        0508
         LA    @06,CLEANER-24(@03,@06)                             0508
         ST    @06,@AL00001                                        0508
         LA    @06,SUMCLEAN                                        0508
         ST    @06,@AL00001+4                                      0508
         LA    @01,@AL00001                                        0508
         BAL   @14,CONVBIN                                         0508
*         SUMP2 = PERIOD;                                  /*@0001VLS*/
         MVI   SUMP2,C'.'                                          0509
*         CALL CONVBIN (WRITER(I),SUMWRITE);               /*@0001VLS*/
         LH    @06,I                                               0510
         MH    @06,@CH01401                                        0510
         L     @03,SUMPTR                                          0510
         AL    @03,@CF01419                                        0510
         LA    @06,WRITER-28(@06,@03)                              0510
         ST    @06,@AL00001                                        0510
         LA    @06,SUMWRITE                                        0510
         ST    @06,@AL00001+4                                      0510
         LA    @01,@AL00001                                        0510
         BAL   @14,CONVBIN                                         0510
*         SYSRTS = SYSRTS + WRITER(I);                     /*@0001VLS*/
         L     @06,SUMPTR                                          0511
         LH    @03,I                                               0511
         MH    @03,@CH01401                                        0511
         L     @15,SYSRTS                                          0511
         LA    @14,0(@03,@06)                                      0511
         AL    @14,@CF01419                                        0511
         AL    @15,WRITER-28(,@14)                                 0511
         ST    @15,SYSRTS                                          0511
*         CALL CONVBIN (ERASE(I),SUMERASE);                /*@0001VLS*/
         AL    @06,@CF01422                                        0512
         LA    @06,ERASE-32(@03,@06)                               0512
         ST    @06,@AL00001                                        0512
         LA    @06,SUMERASE                                        0512
         ST    @06,@AL00001+4                                      0512
         LA    @01,@AL00001                                        0512
         BAL   @14,CONVBIN                                         0512
*         SUMP3 = PERIOD;                                  /*@0001VLS*/
         MVI   SUMP3,C'.'                                          0513
*         CALL CONVBIN2(VRC(I),SUMVRC);                    /*@0001VLS*/
         LH    @06,I                                               0514
         MH    @06,@CH01401                                        0514
         L     @03,SUMPTR                                          0514
         AL    @03,@CF01423                                        0514
         LA    @06,VRC-40(@06,@03)                                 0514
         ST    @06,@AL00001                                        0514
         LA    @06,SUMVRC                                          0514
         ST    @06,@AL00001+4                                      0514
         LA    @01,@AL00001                                        0514
         BAL   @14,CONVBIN2                                        0514
*         CALL CONVBIN2(STRDCHK(I),SUMSTRD);               /*@0001VLS*/
         LH    @06,I                                               0515
         MH    @06,@CH01401                                        0515
         L     @03,SUMPTR                                          0515
         AL    @03,@CF01424                                        0515
         LA    @06,STRDCHK-42(@06,@03)                             0515
         ST    @06,@AL00001                                        0515
         LA    @06,SUMSTRD                                         0515
         ST    @06,@AL00001+4                                      0515
         LA    @01,@AL00001                                        0515
         BAL   @14,CONVBIN2                                        0515
*         CALL CONVBIN2(PARTRECK(I),SUMPART);              /*@0001VLS*/
         LH    @06,I                                               0516
         MH    @06,@CH01401                                        0516
         L     @03,SUMPTR                                          0516
         AL    @03,@CF01425                                        0516
         LA    @06,PARTRECK-44(@06,@03)                            0516
         ST    @06,@AL00001                                        0516
         LA    @06,SUMPART                                         0516
         ST    @06,@AL00001+4                                      0516
         LA    @01,@AL00001                                        0516
         BAL   @14,CONVBIN2                                        0516
*         CALL CONVBIN2(OVERRUNS(I),SUMOVER);              /*@0001VLS*/
         LH    @06,I                                               0517
         MH    @06,@CH01401                                        0517
         L     @03,SUMPTR                                          0517
         BCTR  @03,0                                               0517
         BCTR  @03,0                                               0517
         LA    @06,OVERRUNS-46(@06,@03)                            0517
         ST    @06,@AL00001                                        0517
         LA    @06,SUMOVER                                         0517
         ST    @06,@AL00001+4                                      0517
         LA    @01,@AL00001                                        0517
         BAL   @14,CONVBIN2                                        0517
*         CALL CONVBIN2(VELCHGS(I),SUMVEL);                /*@0001VLS*/
         LH    @06,I                                               0518
         MH    @06,@CH01401                                        0518
         L     @03,SUMPTR                                          0518
         LA    @06,VELCHGS-48(@06,@03)                             0518
         ST    @06,@AL00001                                        0518
         LA    @06,SUMVEL                                          0518
         ST    @06,@AL00001+4                                      0518
         LA    @01,@AL00001                                        0518
         BAL   @14,CONVBIN2                                        0518
*         CALL CONVBIN2(IBG(I),SUMIBG);                    /*@0001VLS*/
         LH    @06,I                                               0519
         MH    @06,@CH01401                                        0519
         L     @03,SUMPTR                                          0519
         LA    @06,IBG-48(@06,@03)                                 0519
         ST    @06,@AL00001                                        0519
         LA    @06,SUMIBG                                          0519
         ST    @06,@AL00001+4                                      0519
         LA    @01,@AL00001                                        0519
         BAL   @14,CONVBIN2                                        0519
*         CALL PRINTIT;                                    /*@0001VLS*/
         BAL   @14,PRINTIT                                         0520
*         MYLINCT = MYLINCT - ONE;                         /*@0001VLS*/
         L     @06,MYLINCT                                         0521
         BCTR  @06,0                                               0521
         ST    @06,MYLINCT                                         0521
*       END;                                               /*@0001VLS*/
*   END;                                                   /*@0001VLS*/
@RF00476 LA    @06,1                                               0523
         AH    @06,I                                               0523
         STH   @06,I                                               0523
         C     @06,@CF00088                                        0523
         BNH   @DL00475                                            0523
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0524
*   IF SYSSIOS ^= ZERO THEN                                        0525
         L     @06,SYSSIOS                                         0525
         LTR   @06,@06                                             0525
         BZ    @RF00525                                            0525
*     DO;                              /* TOTALS LINE        @0001VLS*/
*       SUMT1 = TOTAL;                                     /*@0001VLS*/
         MVC   SUMT1(6),@CC00500                                   0527
*       CALL CALCPERC(SYSRDS,SYSSIOS,READPERC);            /*@0001VLS*/
         LA    @01,@AL00528                                        0528
         BAL   @14,CALCPERC                                        0528
*       CALL CALCPERC(SYSRTS,SYSSIOS,RITEPERC);            /*@0001VLS*/
         LA    @01,@AL00529                                        0529
         BAL   @14,CALCPERC                                        0529
*       CALL CONVBIN3(SYSSIOS,SUMSIOS);                    /*@0001VLS*/
         LA    @01,@AL00530                                        0530
         BAL   @14,CONVBIN3                                        0530
*       CALL CONVBIN (SYSMNTS,SUMMNTS);                    /*@0001VLS*/
         LA    @01,@AL00531                                        0531
         BAL   @14,CONVBIN                                         0531
*       CALL CONVBIN (SYSRDS,SUMREAD);                     /*@0001VLS*/
         LA    @01,@AL00532                                        0532
         BAL   @14,CONVBIN                                         0532
*       CALL CONVBIN (SYSRTS,SUMWRITE);                    /*@0001VLS*/
         LA    @01,@AL00533                                        0533
         BAL   @14,CONVBIN                                         0533
*     END;                                                 /*@0001VLS*/
*   ELSE                                                           0535
*     MSGADDR(1:LENGTH(NOTOTALS)) = NOTOTALS;              /*@0001VLS*/
         B     @RC00525                                            0535
@RF00525 MVC   MSGADDR(32),NOTOTALS                                0535
*   CALL PRINTIT;                                          /*@0001VLS*/
@RC00525 BAL   @14,PRINTIT                                         0536
*   HEAD3 = ON;                                            /*@0001VLS*/
         OI    HEAD3,B'00000100'                                   0537
*   CONTRVOL(1:2) = EOT;                                   /*@0001VLS*/
         L     @06,CURRPTR                                         0538
         MVC   CONTRVOL(2,@06),@CB00261                            0538
* END;                                                     /*@0001VLS*/
@EL00011 DS    0H                                                  0539
@EF00011 DS    0H                                                  0539
@ER00011 LM    @14,@12,@SA00011                                    0539
         BR    @14                                                 0539
*/*                                                          @0001VLS*/
*/* OUTPUT THE VOLUME SECTION OF THE REPORT.  FIRST PUT OUT THE      */
*/* HEADERS.  IF NO RECORDS ARE PRESENT, THEN PUT OUT THE NO RECORDS */
*/* MESSAGE.  OTHERWISE OUTPUT ONE LINE FOR EACH VOLUME.     @0001VLS*/
*/*                                                          @0001VLS*/
*OUTVOLID:  PROC;                                          /*@0001VLS*/
OUTVOLID STM   @14,@12,@SA00012                                    0540
*     CALL PAGEJECT;                                       /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0541
*     VOLH1R = RDTHRSH;                /* READ THRESHOLD     @0001VLS*/
         MVC   VOLH1R(3),RDTHRSH(R2)                               0542
*     VOLH1W = WRTHRSH;                /* WRITE THRESHOLD    @0001VLS*/
         MVC   VOLH1W(3),WRTHRSH(R2)                               0543
*     MSGADDR = VOLHEAD1;                                  /*@0001VLS*/
         MVI   MSGADDR+104,C' '                                    0544
         MVC   MSGADDR+105(27),MSGADDR+104                         0544
         MVC   MSGADDR(104),VOLHEAD1                               0544
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0545
*     IF EXCTHRES(1) = ZERO & EXCTHRES(2) = ZERO THEN              0546
         SLR   @06,@06                                             0546
         C     @06,EXCTHRES                                        0546
         BNE   @RF00546                                            0546
         C     @06,EXCTHRES+4                                      0546
         BNE   @RF00546                                            0546
*       DO;                            /* NO VOLUMES PRESENT @0001VLS*/
*         CALL CONVERT (LVOLDATE,TEMPAREA,THREE);  /* LOW DATE       */
         LA    @01,@AL00548                                        0548
         BAL   @14,CONVERT                                         0548
*         VOLH5L = TEMPAREA(1:5);                          /*@0001VLS*/
         MVC   VOLH5L(5),TEMPAREA                                  0549
*         CALL CONVERT (HVOLDATE,TEMPAREA,THREE);  /* HIGH DATE      */
         LA    @01,@AL00550                                        0550
         BAL   @14,CONVERT                                         0550
*         VOLH5H = TEMPAREA(1:5);                          /*@0001VLS*/
         MVC   VOLH5H(5),TEMPAREA                                  0551
*         MSGADDR(40:39+LENGTH(NOVOLS)) = NOVOLS;          /*@0001VLS*/
         MVC   MSGADDR+39(46),NOVOLS                               0552
*         CALL PRINTIT;                                    /*@0001VLS*/
         BAL   @14,PRINTIT                                         0553
*       END;                                               /*@0001VLS*/
*     ELSE                                                         0555
*       DO;                                                /*@0001VLS*/
         B     @RC00546                                            0555
@RF00546 DS    0H                                                  0556
*         MSGADDR = VOLH2;             /* HEADER             @0001VLS*/
         MVC   MSGADDR(132),VOLH2                                  0556
*         CALL PRINTIT;                                    /*@0001VLS*/
         BAL   @14,PRINTIT                                         0557
*         MSGADDR = VOLH3;             /* HEADER             @0001VLS*/
         MVC   MSGADDR(132),VOLH3                                  0558
*         CALL PRINTIT;                                    /*@0001VLS*/
         BAL   @14,PRINTIT                                         0559
*         CALL PRINTIT;                /* BLANK LINE         @0001VLS*/
         BAL   @14,PRINTIT                                         0560
*         MYLINCT = MYLINCT - FIVE;                        /*@0001VLS*/
         L     @06,MYLINCT                                         0561
         SL    @06,@CF00036                                        0561
         ST    @06,MYLINCT                                         0561
*         DO CURRPTR = CURRPTR BY ELEVEN WHILE(EOTABLE ^= EOT);    0562
         B     @DE00562                                            0562
@DL00562 DS    0H                                                  0563
*           RECCCHHR = TABCCHHR;          /* RECORD LOCATION @0001VLS*/
         L     @06,CURRPTR                                         0563
         MVC   RECCCHHR(5,R2),TABCCHHR(@06)                        0563
*           RESPECIFY (R15) RESTRICTED;                    /*@0001VLS*/
*           CALL IOHND(READIRCT);                          /*@0001VLS*/
         L     @15,ADIOHND(,R2)                                    0565
         LA    @01,@AL00565                                        0565
         BALR  @14,@15                                             0565
*           RETCODE = R15;                                 /*@0001VLS*/
         ST    R15,RETCODE                                         0566
*           RESPECIFY (R15) UNRESTRICTED;                  /*@0001VLS*/
*           IF RETCODE = ZERO THEN                                 0568
         L     @06,RETCODE                                         0568
         SLR   @03,@03                                             0568
         CR    @06,@03                                             0568
         BNE   @RF00568                                            0568
*             DO;                                          /*@0001VLS*/
*               IF MYLINCT <= ZERO THEN       /* LINE WILL NOT FIT   */
         C     @03,MYLINCT                                         0570
         BL    @RF00570                                            0570
*                 DO;                         /* ON PAGE     @0001VLS*/
*                   CALL PAGEJECT;                         /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0572
*                   MSGADDR = VOLHEAD1;                    /*@0001VLS*/
         MVI   MSGADDR+104,C' '                                    0573
         MVC   MSGADDR+105(27),MSGADDR+104                         0573
         MVC   MSGADDR(104),VOLHEAD1                               0573
*                   CALL PRINTIT;                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0574
*                   MSGADDR = VOLH2;                       /*@0001VLS*/
         MVC   MSGADDR(132),VOLH2                                  0575
*                   CALL PRINTIT;                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0576
*                   MSGADDR = VOLH3;                       /*@0001VLS*/
         MVC   MSGADDR(132),VOLH3                                  0577
*                   CALL PRINTIT;                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0578
*                   CALL PRINTIT;                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0579
*                   MYLINCT = MYLINCT - FIVE;              /*@0001VLS*/
         L     @06,MYLINCT                                         0580
         SL    @06,@CF00036                                        0580
         ST    @06,MYLINCT                                         0580
*                 END;                                     /*@0001VLS*/
*               VVOLUME = VOLID;                           /*@0001VLS*/
@RF00570 MVC   VVOLUME(6),VOLID(R7)                                0582
*               CALL CONVERT(DATE(2:4),TEMPAREA,SIX);      /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00583                              0583
         LA    @06,DATE+1(,R7)                                     0583
         ST    @06,@AL00001                                        0583
         LA    @01,@AL00001                                        0583
         BAL   @14,CONVERT                                         0583
*               VDAY = TEMPAREA(3:5);                      /*@0001VLS*/
         MVC   VDAY(3),TEMPAREA+2                                  0584
*               VYEAR = TEMPAREA(1:2);                     /*@0001VLS*/
         MVC   VYEAR(2),TEMPAREA                                   0585
*               CALL CONVERT(TIME,TEMPAREA,EIGHT);         /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00586                              0586
         LA    @06,TIME(,R7)                                       0586
         ST    @06,@AL00001                                        0586
         LA    @01,@AL00001                                        0586
         BAL   @14,CONVERT                                         0586
*               VHH = TEMPAREA(1:2);                       /*@0001VLS*/
         MVC   VHH(2),TEMPAREA                                     0587
*               VMM = TEMPAREA(3:4);                       /*@0001VLS*/
         MVC   VMM(2),TEMPAREA+2                                   0588
*               VSS = TEMPAREA(5:6);                       /*@0001VLS*/
         MVC   VSS(2),TEMPAREA+4                                   0589
*               VPOINT = PERIOD;                           /*@0001VLS*/
         MVI   VPOINT,C'.'                                         0590
*               VTH = TEMPAREA(7:8);                       /*@0001VLS*/
         MVC   VTH(2),TEMPAREA+6                                   0591
*               CALL CONVERT(OCUA2,TEMPAREA,TWO);          /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00592                              0592
         LA    @06,OCUA2(,R7)                                      0592
         ST    @06,@AL00001                                        0592
         LA    @01,@AL00001                                        0592
         BAL   @14,CONVERT                                         0592
*               VCUA = TEMPAREA(2:4);                      /*@0001VLS*/
         MVC   VCUA(3),TEMPAREA+1                                  0593
*               IF SNSCNT <= 9 × OSER74XX = HEXZEROS THEN          0594
         CLC   SNSCNT(2,R7),@CH00085                               0594
         BNH   @RT00594                                            0594
         CLC   OSER74XX(2,R7),@CB00208                             0594
         BNE   @RF00594                                            0594
@RT00594 DS    0H                                                  0595
*                 DO;                                      /*@0001VLS*/
*                   VTUSER = NA;                           /*@0001VLS*/
         MVC   VTUSER(5),@CC00483                                  0596
*                   VMODEL = NA;                           /*@0001VLS*/
         MVC   VMODEL(5),@CC00483                                  0597
*                   VDENS = NA;                            /*@0001VLS*/
         MVC   VDENS(5),@CC00483                                   0598
*                   VHDRSER = NA;                          /*@0001VLS*/
         MVC   VHDRSER(5),@CC00483                                 0599
*                 END;                                     /*@0001VLS*/
*               ELSE                                               0601
*                 DO;                                      /*@0001VLS*/
         B     @RC00594                                            0601
@RF00594 DS    0H                                                  0602
*                   CALL CONVBIN2(OSER74XX,VTUSER);        /*@0001VLS*/
         LA    @06,OSER74XX(,R7)                                   0602
         ST    @06,@AL00001                                        0602
         LA    @06,VTUSER                                          0602
         ST    @06,@AL00001+4                                      0602
         LA    @01,@AL00001                                        0602
         BAL   @14,CONVBIN2                                        0602
*                   IF SENSBIT5(4) = ON THEN                       0603
         TM    SENSBIT5+3(R7),B'00000100'                          0603
         BNO   @RF00603                                            0603
*                     VDENS = BPI1600;                     /*@0001VLS*/
         MVI   VDENS+4,C' '                                        0604
         MVC   VDENS(4),@CC00479                                   0604
*                   ELSE                                           0605
*                     IF SENSBIT4(7) = ON THEN                     0605
         B     @RC00603                                            0605
@RF00603 TM    SENSBIT4+6(R7),B'00001000'                          0605
         BNO   @RF00605                                            0605
*                       VDENS = BPI6250;                   /*@0001VLS*/
         MVI   VDENS+4,C' '                                        0606
         MVC   VDENS(4),@CC00481                                   0606
*                     ELSE                                         0607
*                       VDENS = BPI800;                    /*@0001VLS*/
         B     @RC00605                                            0607
@RF00605 MVI   VDENS+4,C' '                                        0607
         MVC   VDENS(4),@CC00477                                   0607
*                   I = SENSE(7) & ZEROFOX;                /*@0001VLS*/
@RC00605 DS    0H                                                  0608
@RC00603 LA    @06,15                                              0608
         SLR   @03,@03                                             0608
         IC    @03,SENSE+6(,R7)                                    0608
         NR    @06,@03                                             0608
         STH   @06,I                                               0608
*                   VMODEL(3:3) = MODNO(I+1);              /*@0001VLS*/
         LA    @03,MODNO(@06)                                      0609
         MVC   VMODEL+2(1),0(@03)                                  0609
*                   CALL CONVBIN2(HDRSER,VHDRSER);         /*@0001VLS*/
         LA    @06,HDRSER(,R7)                                     0610
         ST    @06,@AL00001                                        0610
         LA    @06,VHDRSER                                         0610
         ST    @06,@AL00001+4                                      0610
         LA    @01,@AL00001                                        0610
         BAL   @14,CONVBIN2                                        0610
*                 END;                                     /*@0001VLS*/
*               IF DISMNT = OFF THEN                               0612
@RC00594 TM    DISMNT(R7),B'00000100'                              0612
         BNZ   @RF00612                                            0612
*                 IF SENSBIT3(1) = OFF THEN                        0613
         TM    SENSBIT3(R7),B'00010000'                            0613
         BNZ   @RF00613                                            0613
*                   IF SENSBIT5(2) = ON THEN                       0614
         TM    SENSBIT5+1(R7),B'00000100'                          0614
         BNO   @RF00614                                            0614
*                     VRDWRT = CHARW;            /* PERMANENT WRITE  */
         MVI   VRDWRT,C'W'                                         0615
*                   ELSE                                           0616
*                     VRDWRT = CHARR;            /* PERMANENT READ   */
         B     @RC00614                                            0616
@RF00614 MVI   VRDWRT,C'R'                                         0616
*                 ELSE                                             0617
*                   VRDWRT = CHARE;              /* EQUIPMENT CHECK  */
         B     @RC00613                                            0617
@RF00613 MVI   VRDWRT,C'E'                                         0617
*               CALL CONVBIN1(PERMRDS,VPRDS);              /*@0001VLS*/
@RC00613 DS    0H                                                  0618
@RF00612 LA    @06,PERMRDS(,R7)                                    0618
         ST    @06,@AL00001                                        0618
         LA    @06,VPRDS                                           0618
         ST    @06,@AL00001+4                                      0618
         LA    @01,@AL00001                                        0618
         BAL   @14,CONVBIN1                                        0618
*               CALL CONVBIN1(PERMRTS,VPRTS);              /*@0001VLS*/
         LA    @06,PERMRTS(,R7)                                    0619
         ST    @06,@AL00001                                        0619
         LA    @06,VPRTS                                           0619
         ST    @06,@AL00001+4                                      0619
         LA    @01,@AL00001                                        0619
         BAL   @14,CONVBIN1                                        0619
*               CALL CONVBIN1(READTH,VTRDS);               /*@0001VLS*/
         LA    @06,READTH(,R7)                                     0620
         ST    @06,@AL00001                                        0620
         LA    @06,VTRDS                                           0620
         ST    @06,@AL00001+4                                      0620
         LA    @01,@AL00001                                        0620
         BAL   @14,CONVBIN1                                        0620
*               CALL CONVBIN1(RITETH,VTRTS);               /*@0001VLS*/
         LA    @06,RITETH(,R7)                                     0621
         ST    @06,@AL00001                                        0621
         LA    @06,VTRTS                                           0621
         ST    @06,@AL00001+4                                      0621
         LA    @01,@AL00001                                        0621
         BAL   @14,CONVBIN1                                        0621
*               CALL CONVBIN2(RECLEAN,VCLEAN);             /*@0001VLS*/
         LA    @06,RECLEAN(,R7)                                    0622
         ST    @06,@AL00001                                        0622
         LA    @06,VCLEAN                                          0622
         ST    @06,@AL00001+4                                      0622
         LA    @01,@AL00001                                        0622
         BAL   @14,CONVBIN2                                        0622
*               CALL CONVBIN2(RECERASE,VERASE);            /*@0001VLS*/
         LA    @06,RECERASE(,R7)                                   0623
         ST    @06,@AL00001                                        0623
         LA    @06,VERASE                                          0623
         ST    @06,@AL00001+4                                      0623
         LA    @01,@AL00001                                        0623
         BAL   @14,CONVBIN2                                        0623
*               CALL CONVBIN2(RECSIOS,VSIOS);              /*@0001VLS*/
         LA    @06,RECSIOS(,R7)                                    0624
         ST    @06,@AL00001                                        0624
         LA    @06,VSIOS                                           0624
         ST    @06,@AL00001+4                                      0624
         LA    @01,@AL00001                                        0624
         BAL   @14,CONVBIN2                                        0624
*               CALL CONVBIN2(BLKLENG,VBLOCK);             /*@0001VLS*/
         LA    @06,BLKLENG(,R7)                                    0625
         ST    @06,@AL00001                                        0625
         LA    @06,VBLOCK                                          0625
         ST    @06,@AL00001+4                                      0625
         LA    @01,@AL00001                                        0625
         BAL   @14,CONVBIN2                                        0625
*               VPGMID = JOBID;                            /*@0001VLS*/
         MVC   VPGMID(8),JOBID(R7)                                 0626
*               CALL CONVERT(CPUMOD,VCPUMOD,TWO);          /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00627                              0627
         LA    @06,CPUMOD(,R7)                                     0627
         ST    @06,@AL00001                                        0627
         LA    @01,@AL00001                                        0627
         BAL   @14,CONVERT                                         0627
*               CALL CONVERT(CPUSER,VCPUSER,THREE);        /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00628                              0628
         LA    @06,CPUSER(,R7)                                     0628
         ST    @06,@AL00001                                        0628
         LA    @01,@AL00001                                        0628
         BAL   @14,CONVERT                                         0628
*               CALL PRINTIT;                              /*@0001VLS*/
         BAL   @14,PRINTIT                                         0629
*               MYLINCT = MYLINCT - ONE;                   /*@0001VLS*/
         L     @06,MYLINCT                                         0630
         BCTR  @06,0                                               0630
         ST    @06,MYLINCT                                         0630
*             END;                                         /*@0001VLS*/
*         END;                                             /*@0001VLS*/
@RF00568 LA    @06,11                                              0632
         AL    @06,CURRPTR                                         0632
         ST    @06,CURRPTR                                         0632
@DE00562 L     @06,CURRPTR                                         0632
         CLC   EOTABLE(2,@06),@CB00261                             0632
         BNE   @DL00562                                            0632
*       END;                                               /*@0001VLS*/
* END;                                                     /*@0001VLS*/
@EL00012 DS    0H                                                  0634
@EF00012 DS    0H                                                  0634
@ER00012 LM    @14,@12,@SA00012                                    0634
         BR    @14                                                 0634
*/********************************************************************/
*/* THIS PROCEDURE WILL MAKE ENTRIES INTO THE SORT TABLE.  FOR EACH  */
*/* PERM ERROR OR EACH DISMOUNT RECORD WHICH EXCEEDS THRESHOLD, AN   */
*/* ENTRY IS MADE.  ALL DISMOUNT RECORDS ARE SUMMED INTO THE @0001VLS*/
*/* APPROPRIATE CPU/CONTROL UNIT COUNTERS FOR THE TEMPORARY SUMMARY. */
*/********************************************************************/
*TABENT: PROC;                                             /*@0001VLS*/
TABENT   STM   @14,@12,@SA00013                                    0635
*  RECCOUNT = RECCOUNT + ONE;                              /*@0001VLS*/
         LH    @06,RECCOUNT                                        0636
         LA    @06,1(,@06)                                         0636
         STH   @06,RECCOUNT                                        0636
*  RECCUA = OCUA2;                    /* RECORD CUA FOR SHARE CONVERT*/
         MVC   RECCUA(2),OCUA2(R7)                                 0637
*  RECCPU = CPUSER;                   /* RECORD CPU FOR SHARE CONVERT*/
         MVC   RECCPU(3),CPUSER(R7)                                0638
*  IF SHAREPTR ^= ZERO THEN                                        0639
         L     @06,SHAREPTR(,R2)                                   0639
         LTR   @06,@06                                             0639
         BZ    @RF00639                                            0639
*    CALL CUASHARE;                   /* PERFORM ANY SHARE CONVERSION*/
         BAL   @14,CUASHARE                                        0640
*  CALL FINDDATE;                     /* SET UP DATE RANGES  @0001VLS*/
@RF00639 BAL   @14,FINDDATE                                        0641
*  IF LOWDATE > DATE(2:4) THEN                                     0642
         L     @06,DATEPTR                                         0642
         CLC   LOWDATE(3,@06),DATE+1(R7)                           0642
         BNH   @RF00642                                            0642
*    LOWDATE = DATE(2:4);             /* NEW LOW DATE        @0001VLS*/
         MVC   LOWDATE(3,@06),DATE+1(R7)                           0643
*  IF HIDATE < DATE(2:4) THEN                                      0644
@RF00642 L     @06,DATEPTR                                         0644
         CLC   HIDATE(3,@06),DATE+1(R7)                            0644
         BNL   @RF00644                                            0644
*    HIDATE = DATE(2:4);              /* NEW HIGH DATE       @0001VLS*/
         MVC   HIDATE(3,@06),DATE+1(R7)                            0645
*  IF DISMNT = ON THEN                /* DISMOUNT RECORD     @0001VLS*/
@RF00644 TM    DISMNT(R7),B'00000100'                              0646
         BNO   @RF00646                                            0646
*    DO;                                                   /*@0001VLS*/
*      CALL TEMPTOT;                  /* TOTAL FOR TEMP SUMMARY      */
         BAL   @14,TEMPTOT                                         0648
*      IF RETCODE = ZERO & (READTH >= READS × RITETH >= WRITES) THEN
         L     @06,RETCODE                                         0649
         LTR   @06,@06                                             0649
         BNZ   @RF00649                                            0649
         CLC   READTH(1,R7),READS                                  0649
         BNL   @RT00649                                            0649
         CLC   RITETH(1,R7),WRITES                                 0649
         BL    @RF00649                                            0649
@RT00649 DS    0H                                                  0650
*        DO EXCTHRES(1) = EXCTHRES(1) + ONE;               /*@0001VLS*/
         LA    @06,1                                               0650
         AL    @06,EXCTHRES                                        0650
         ST    @06,EXCTHRES                                        0650
*          CALL SAVEREC(ONE);         /* ENTER INTO TABLE AS TYPE 1  */
         LA    @01,@AL00651                                        0651
         BAL   @14,SAVEREC                                         0651
*        END;                                              /*@0001VLS*/
*    END;                                                  /*@0001VLS*/
*  ELSE                                                            0654
*    IF (CSW34XX & UNITCK) = UNITCK THEN                           0654
         B     @RC00646                                            0654
@RF00646 MVC   @TS00001(1),CSW34XX(R7)                             0654
         NI    @TS00001,X'02'                                      0654
         CLI   @TS00001,X'02'                                      0654
         BNE   @RF00654                                            0654
*      DO EXCTHRES(2) = EXCTHRES(2) + ONE;                 /*@0001VLS*/
         LA    @06,1                                               0655
         AL    @06,EXCTHRES+4                                      0655
         ST    @06,EXCTHRES+4                                      0655
*        CALL SAVEREC(TWO);           /* ENTER INTO TABLE AS TYPE 2  */
         LA    @01,@AL00656                                        0656
         BAL   @14,SAVEREC                                         0656
*      END;                                                /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00013 DS    0H                                                  0658
@EF00013 DS    0H                                                  0658
@ER00013 LM    @14,@12,@SA00013                                    0658
         BR    @14                                                 0658
*/********************************************************************/
*/* A RECORD IS SAVED IN THE SORT TABLE.  IF THE RECORD WAS INPUT    */
*/* FROM HISTORY TAPE, THEN IT IS SAVED ON DIRECTWK.  THE TYPE IS    */
*/* ENTERED FROM THE PARAMETER PASSED.                       @0001VLS*/
*/*      TYPE 1 = DISMOUNT RECORD                            @0001VLS*/
*/*      TYPE 2 = PERM ERROR                                 @0001VLS*/
*/*      TYPE 3 = POINTER TO TEMP SUMMARY TABLE              @0001VLS*/
*/********************************************************************/
*SAVEREC: PROC(TYPEENT);                                   /*@0001VLS*/
SAVEREC  STM   @14,@12,@SA00014                                    0659
         MVC   @PC00014(4),0(@01)                                  0659
*   DCL TYPEENT FIXED(31);                                 /*@0001VLS*/
*   IF PHIST = ON THEN                 /* HISTORY INPUT      @0001VLS*/
         TM    PHIST(R2),B'00100000'                               0661
         BNO   @RF00661                                            0661
*     DO;                                                  /*@0001VLS*/
*       RESPECIFY (R15) RESTRICTED;                        /*@0001VLS*/
*       CALL IOHND(RITESCRT);                              /*@0001VLS*/
         L     @15,ADIOHND(,R2)                                    0664
         LA    @01,@AL00664                                        0664
         BALR  @14,@15                                             0664
*       RETCODE = R15;                                     /*@0001VLS*/
         ST    R15,RETCODE                                         0665
*       RESPECIFY (R15) UNRESTRICTED;                      /*@0001VLS*/
*     END;                                                 /*@0001VLS*/
*   IF RETCODE = ZERO THEN                                         0668
@RF00661 L     @06,RETCODE                                         0668
         LTR   @06,@06                                             0668
         BNZ   @RF00668                                            0668
*     DO;                                                  /*@0001VLS*/
*       CONTRCUA = RECCUA;             /* STORE CUA          @0001VLS*/
         L     @06,CURRPTR                                         0670
         MVC   CONTRCUA(2,@06),RECCUA                              0670
*       CONTRCUA(2) = CONTRCUA(2) & FOXZERO;   /* CONTROL UNIT ENTRY */
         NI    CONTRCUA+1(@06),X'F0'                               0671
*       CPU = RECCPU;                  /* STORE CPU          @0001VLS*/
         MVC   CPU(3,@06),RECCPU                                   0672
*       TABCCHHR = RECCCHHR;           /* AUX STORAGE ADDRESS        */
         MVC   TABCCHHR(5,@06),RECCCHHR(R2)                        0673
*       TYPE = TYPEENT;                /* TYPE OF ENTRY      @0001VLS*/
         L     @03,@PC00014                                        0674
         L     @03,TYPEENT(,@03)                                   0674
         STC   @03,TYPE(,@06)                                      0674
*       NUMENT = NUMENT + ONE;                             /*@0001VLS*/
         LA    @03,1                                               0675
         AL    @03,NUMENT                                          0675
         ST    @03,NUMENT                                          0675
*       CURRPTR = CURRPTR - ELEVEN;    /* POINT TO NEXT ENTRY        */
         SL    @06,@CF00034                                        0676
         ST    @06,CURRPTR                                         0676
*     END;                                                 /*@0001VLS*/
* END;                                                     /*@0001VLS*/
@EL00014 DS    0H                                                  0678
@EF00014 DS    0H                                                  0678
@ER00014 LM    @14,@12,@SA00014                                    0678
         BR    @14                                                 0678
*/********************************************************************/
*/* TOTAL THE DISMOUNT DATA INTO THE APPROPRIATE CPU/CONTROL UNIT    */
*/* COUNTERS.  IF NONE EXIST, A NEW SET IS CREATED, AN ENTRY MADE IN */
*/* THE SORT TABLE, AND THE ADDRESS OF THE COUNTERS STORED THERE.    */
*/********************************************************************/
*TEMPTOT: PROC;                                            /*@0001VLS*/
TEMPTOT  STM   @14,@12,@SA00015                                    0679
*CUAINDEX = RECCUA & ZZZF;             /* UNITS ADDRESS      @0001VLS*/
         LA    @06,15                                              0680
         SLR   @03,@03                                             0680
         ICM   @03,3,RECCUA                                        0680
         NR    @06,@03                                             0680
         ST    @06,CUAINDEX                                        0680
*CUAINDEX = CUAINDEX + ONE;                                /*@0001VLS*/
         AL    @06,@CF00055                                        0681
         ST    @06,CUAINDEX                                        0681
*CALL FINDTOTS;                           /* FIND COUNTER AREA       */
         BAL   @14,FINDTOTS                                        0682
*IF RETCODE = ZERO THEN                                            0683
         L     @06,RETCODE                                         0683
         LTR   @06,@06                                             0683
         BNZ   @RF00683                                            0683
*  DO;                                                     /*@0001VLS*/
*    IF DATE(2:4) > TDATE(CUAINDEX) THEN                           0685
         L     @06,SUMPTR                                          0685
         L     @03,CUAINDEX                                        0685
         MH    @03,@CH01401                                        0685
         ST    @03,@TF00001                                        0685
         ALR   @03,@06                                             0685
         CLC   DATE+1(3,R7),TDATE-48(@03)                          0685
         BNH   @RF00685                                            0685
*      TDATE(CUAINDEX) = DATE(2:4);       /* HIGHER TO DATE  @0001VLS*/
         AL    @06,@TF00001                                        0686
         MVC   TDATE-48(3,@06),DATE+1(R7)                          0686
*    IF DATE(2:4) < FDATE(CUAINDEX) THEN                           0687
@RF00685 L     @06,SUMPTR                                          0687
         L     @03,CUAINDEX                                        0687
         MH    @03,@CH01401                                        0687
         ST    @03,@TF00001                                        0687
         ALR   @03,@06                                             0687
         CLC   DATE+1(3,R7),FDATE-48(@03)                          0687
         BNL   @RF00687                                            0687
*      FDATE(CUAINDEX) = DATE(2:4);       /* LOWER FROM DATE @0001VLS*/
         AL    @06,@TF00001                                        0688
         MVC   FDATE-48(3,@06),DATE+1(R7)                          0688
*    READER(CUAINDEX) = READER(CUAINDEX) + READTH;  /* # TEMP READS  */
@RF00687 L     @06,SUMPTR                                          0689
         L     @03,CUAINDEX                                        0689
         MH    @03,@CH01401                                        0689
         SLR   @15,@15                                             0689
         IC    @15,READTH(,R7)                                     0689
         LA    @14,0(@03,@06)                                      0689
         AL    @14,@CF01418                                        0689
         AL    @15,READER-20(,@14)                                 0689
         LA    @14,0(@03,@06)                                      0689
         AL    @14,@CF01418                                        0689
         ST    @15,READER-20(,@14)                                 0689
*    WRITER(CUAINDEX) = WRITER(CUAINDEX) + RITETH;  /* # TEMP WRITES */
         SLR   @15,@15                                             0690
         IC    @15,RITETH(,R7)                                     0690
         LA    @14,0(@03,@06)                                      0690
         AL    @14,@CF01419                                        0690
         AL    @15,WRITER-28(,@14)                                 0690
         LA    @14,0(@03,@06)                                      0690
         AL    @14,@CF01419                                        0690
         ST    @15,WRITER-28(,@14)                                 0690
*    SIOS(CUAINDEX) = SIOS(CUAINDEX) + RECSIOS;     /* # SIOS        */
         SLR   @15,@15                                             0691
         ICM   @15,3,RECSIOS(R7)                                   0691
         LA    @14,0(@03,@06)                                      0691
         AL    @14,@CF01417                                        0691
         AL    @15,SIOS-16(,@14)                                   0691
         LA    @14,0(@03,@06)                                      0691
         AL    @14,@CF01417                                        0691
         ST    @15,SIOS-16(,@14)                                   0691
*    CLEANER(CUAINDEX) = CLEANER(CUAINDEX) + RECLEAN; /* # CLEANER   */
         SLR   @15,@15                                             0692
         ICM   @15,3,RECLEAN(R7)                                   0692
         LA    @14,0(@03,@06)                                      0692
         AL    @14,@CF01421                                        0692
         AL    @15,CLEANER-24(,@14)                                0692
         LA    @14,0(@03,@06)                                      0692
         AL    @14,@CF01421                                        0692
         ST    @15,CLEANER-24(,@14)                                0692
*    ERASE(CUAINDEX) = ERASE(CUAINDEX) + RECERASE;  /* # ERASE GAPS  */
         SLR   @15,@15                                             0693
         ICM   @15,3,RECERASE(R7)                                  0693
         LA    @14,0(@03,@06)                                      0693
         AL    @14,@CF01422                                        0693
         AL    @15,ERASE-32(,@14)                                  0693
         LA    @14,0(@03,@06)                                      0693
         AL    @14,@CF01422                                        0693
         ST    @15,ERASE-32(,@14)                                  0693
*    IF DISMNT = ON & EOD = OFF THEN                               0694
         TM    DISMNT(R7),B'00000100'                              0694
         BNO   @RF00694                                            0694
         TM    EOD(R7),B'10000000'                                 0694
         BNZ   @RF00694                                            0694
*      MOUNTS(CUAINDEX) = MOUNTS(CUAINDEX) + ONE;   /* ADD 1 TO MOUNT*/
         LA    @15,1                                               0695
         LA    @14,0(@03,@06)                                      0695
         AL    @14,@CF01420                                        0695
         AL    @15,MOUNTS-36(,@14)                                 0695
         AL    @06,@CF01420                                        0695
         ST    @15,MOUNTS-36(@03,@06)                              0695
*    VRC(CUAINDEX) = VRC(CUAINDEX) + RECVRC;               /*@0001VLS*/
@RF00694 L     @06,SUMPTR                                          0696
         L     @03,CUAINDEX                                        0696
         MH    @03,@CH01401                                        0696
         SLR   @15,@15                                             0696
         IC    @15,RECVRC(,R7)                                     0696
         LA    @14,0(@03,@06)                                      0696
         AL    @14,@CF01423                                        0696
         AH    @15,VRC-40(,@14)                                    0696
         LA    @14,0(@03,@06)                                      0696
         AL    @14,@CF01423                                        0696
         STH   @15,VRC-40(,@14)                                    0696
*    I = RECSTRD & ZEROFOX;                                /*@0001VLS*/
         LA    @15,15                                              0697
         SLR   @14,@14                                             0697
         IC    @14,RECSTRD(,R7)                                    0697
         NR    @14,@15                                             0697
         STH   @14,I                                               0697
*    STRDCHK(CUAINDEX) = STRDCHK(CUAINDEX) + I;            /*@0001VLS*/
         LA    @01,0(@03,@06)                                      0698
         AL    @01,@CF01424                                        0698
         AH    @14,STRDCHK-42(,@01)                                0698
         LA    @01,0(@03,@06)                                      0698
         AL    @01,@CF01424                                        0698
         STH   @14,STRDCHK-42(,@01)                                0698
*    I = RECPART;                                          /*@0001VLS*/
         SLR   @14,@14                                             0699
         IC    @14,RECPART(,R7)                                    0699
         STH   @14,I                                               0699
*    SRL(I,FOUR);                                          /*@0001VLS*/
         SRL   @14,4                                               0700
         STH   @14,I                                               0700
*    PARTRECK(CUAINDEX) = PARTRECK(CUAINDEX) + I;          /*@0001VLS*/
         LA    @01,0(@03,@06)                                      0701
         AL    @01,@CF01425                                        0701
         LH    @14,PARTRECK-44(,@01)                               0701
         AH    @14,I                                               0701
         LA    @01,0(@03,@06)                                      0701
         AL    @01,@CF01425                                        0701
         STH   @14,PARTRECK-44(,@01)                               0701
*    I = RECOVER;                                          /*@0001VLS*/
         SLR   @14,@14                                             0702
         IC    @14,RECOVER(,R7)                                    0702
         STH   @14,I                                               0702
*    SRL(I,FOUR);                                          /*@0001VLS*/
         SRL   @14,4                                               0703
         STH   @14,I                                               0703
*    OVERRUNS(CUAINDEX) = OVERRUNS(CUAINDEX) + I;          /*@0001VLS*/
         LA    @01,0(@03,@06)                                      0704
         BCTR  @01,0                                               0704
         BCTR  @01,0                                               0704
         LH    @14,OVERRUNS-46(,@01)                               0704
         AH    @14,I                                               0704
         LA    @01,0(@03,@06)                                      0704
         BCTR  @01,0                                               0704
         BCTR  @01,0                                               0704
         STH   @14,OVERRUNS-46(,@01)                               0704
*    I = RECVEL & ZEROFOX;                                 /*@0001VLS*/
         SLR   @14,@14                                             0705
         IC    @14,RECVEL(,R7)                                     0705
         NR    @15,@14                                             0705
         STH   @15,I                                               0705
*    VELCHGS(CUAINDEX) = VELCHGS(CUAINDEX) + I;            /*@0001VLS*/
         AH    @15,VELCHGS-48(@03,@06)                             0706
         STH   @15,VELCHGS-48(@03,@06)                             0706
*    I = RECIBG;                                           /*@0001VLS*/
         SLR   @15,@15                                             0707
         IC    @15,RECIBG(,R7)                                     0707
         STH   @15,I                                               0707
*    SRL(I,FOUR);                                          /*@0001VLS*/
         SRL   @15,4                                               0708
         STH   @15,I                                               0708
*    IBG(CUAINDEX) = IBG(CUAINDEX) + I;                    /*@0001VLS*/
         LH    @15,IBG-48(@03,@06)                                 0709
         AH    @15,I                                               0709
         STH   @15,IBG-48(@03,@06)                                 0709
*  END;                                                    /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00015 DS    0H                                                  0711
@EF00015 DS    0H                                                  0711
@ER00015 LM    @14,@12,@SA00015                                    0711
         BR    @14                                                 0711
*/********************************************************************/
*/* OUTPUT THE CUA STATISTICS PORTION OF THE REPORT.         @0001VLS*/
*/********************************************************************/
*PRINTCUA: PROC;                                           /*@0001VLS*/
PRINTCUA STM   @14,@12,@SA00016                                    0712
* OLDCPUCU = SORTCPUC;                /* INITIALIZE SORT BREAK       */
         L     @06,CURRPTR                                         0713
         MVC   OLDCPUCU(5),SORTCPUC(@06)                           0713
* DO CURRPTR = CURRPTR BY ELEVEN WHILE (EOTABLE ^= EOT);   /*@0001VLS*/
         B     @DE00714                                            0714
@DL00714 DS    0H                                                  0715
*   IF OLDCPUCU ^= SORTCPUC THEN                                   0715
         L     @06,CURRPTR                                         0715
         CLC   OLDCPUCU(5),SORTCPUC(@06)                           0715
         BE    @RF00715                                            0715
*     CALL OUTTYPES;                  /* SORT BREAK.         @0001VLS*/
         BAL   @14,OUTTYPES                                        0716
*   IF TYPE = THREE THEN                                           0717
@RF00715 L     @06,CURRPTR                                         0717
         CLI   TYPE(@06),3                                         0717
         BNE   @RF00717                                            0717
*     CALL TEMPSUM;                   /* OUTPUT THE SUMMARY SECTION  */
         BAL   @14,TEMPSUM                                         0718
*   ELSE                                                           0719
*     DO;                                                  /*@0001VLS*/
         B     @RC00717                                            0719
@RF00717 DS    0H                                                  0720
*       RECCCHHR = TABCCHHR;          /* SET LOCATION OF RECORD      */
         L     @06,CURRPTR                                         0720
         MVC   RECCCHHR(5,R2),TABCCHHR(@06)                        0720
*       RESPECIFY (R15) RESTRICTED;                        /*@0001VLS*/
*       CALL IOHND(READIRCT);         /* GET A RECORD        @0001VLS*/
         L     @15,ADIOHND(,R2)                                    0722
         LA    @01,@AL00722                                        0722
         BALR  @14,@15                                             0722
*       RETCODE = R15;                /* RETURN CODE         @0001VLS*/
         ST    R15,RETCODE                                         0723
*       RESPECIFY (R15) UNRESTRICTED;                      /*@0001VLS*/
*       IF RETCODE = ZERO THEN                                     0725
         L     @06,RETCODE                                         0725
         LTR   @06,@06                                             0725
         BNZ   @RF00725                                            0725
*         DO;                                              /*@0001VLS*/
*           IF TYPE = ONE THEN                                     0727
         L     @06,CURRPTR                                         0727
         CLI   TYPE(@06),1                                         0727
         BNE   @RF00727                                            0727
*             CALL CUASTATS;          /* RECORD EXCEEDS THRESHOLD    */
         BAL   @14,CUASTATS                                        0728
*           ELSE                                                   0729
*             CALL CUAPERMS;          /* RECORD IS PERM ERROR        */
         B     @RC00727                                            0729
@RF00727 BAL   @14,CUAPERMS                                        0729
*           CONTRVOL= VOLID;          /* INSERT THE VOLID FOR PASS 2 */
@RC00727 L     @06,CURRPTR                                         0730
         MVC   CONTRVOL(6,@06),VOLID(R7)                           0730
*         END;                                             /*@0001VLS*/
*       ELSE                                                       0732
*         CONTRVOL = CONTRVOL && CONTRVOL;  /* ERROR - DO NOTHING    */
         B     @RC00725                                            0732
@RF00725 L     @06,CURRPTR                                         0732
         XC    CONTRVOL(6,@06),CONTRVOL(@06)                       0732
*     END;                                                 /*@0001VLS*/
@RC00725 DS    0H                                                  0734
*  END;                                                    /*@0001VLS*/
@RC00717 LA    @06,11                                              0734
         AL    @06,CURRPTR                                         0734
         ST    @06,CURRPTR                                         0734
@DE00714 L     @06,CURRPTR                                         0734
         CLC   EOTABLE(2,@06),@CB00261                             0734
         BNE   @DL00714                                            0734
*  CALL OUTTYPES;                                          /*@0001VLS*/
         BAL   @14,OUTTYPES                                        0735
*END;                                                      /*@0001VLS*/
@EL00016 DS    0H                                                  0736
@EF00016 DS    0H                                                  0736
@ER00016 LM    @14,@12,@SA00016                                    0736
         BR    @14                                                 0736
*/********************************************************************/
*/* OUTPUT THE ERROR CODES FOR PERMANENT ERRORS.             @0001VLS*/
*/********************************************************************/
*OUTCODES: PROC;                                           /*@0001VLS*/
OUTCODES STM   @14,@12,@SA00017                                    0737
* OUTCODE(1) = ERRTABLE(1);                                /*@0001VLS*/
         MVC   OUTCODE(34),ERRTABLE                                0738
* OUTCODE(2) = ERRTABLE(2);                                /*@0001VLS*/
         MVC   OUTCODE+40(34),ERRTABLE+34                          0739
* OUTCODE(3) = ERRTABLE(3);                                /*@0001VLS*/
         MVC   OUTCODE+80(34),ERRTABLE+68                          0740
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0741
* OUTCODE(1) = ERRTABLE(4);                                /*@0001VLS*/
         MVC   OUTCODE(34),ERRTABLE+102                            0742
* OUTCODE(2) = ERRTABLE(5);                                /*@0001VLS*/
         MVC   OUTCODE+40(34),ERRTABLE+136                         0743
* OUTCODE(3) = ERRTABLE(6);                                /*@0001VLS*/
         MVC   OUTCODE+80(34),ERRTABLE+170                         0744
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0745
* OUTCODE(1) = ERRTABLE(7);                                /*@0001VLS*/
         MVC   OUTCODE(34),ERRTABLE+204                            0746
* OUTCODE(2) = ERRTABLE(8);                                /*@0001VLS*/
         MVC   OUTCODE+40(34),ERRTABLE+238                         0747
* OUTCODE(3) = ERRTABLE(9);                                /*@0001VLS*/
         MVC   OUTCODE+80(34),ERRTABLE+272                         0748
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0749
* OUTCODE(1) = ERRTABLE(10);                               /*@0001VLS*/
         MVC   OUTCODE(34),ERRTABLE+306                            0750
* OUTCODE(2) = ERRTABLE(11);                               /*@0001VLS*/
         MVC   OUTCODE+40(34),ERRTABLE+340                         0751
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0752
* MYLINCT = MYLINCT - FOUR;                                /*@0001VLS*/
         L     @06,MYLINCT                                         0753
         SL    @06,@CF00064                                        0753
         ST    @06,MYLINCT                                         0753
*END;                                                      /*@0001VLS*/
@EL00017 DS    0H                                                  0754
@EF00017 DS    0H                                                  0754
@ER00017 LM    @14,@12,@SA00017                                    0754
         BR    @14                                                 0754
*/********************************************************************/
*/* A SEARCH IS MADE FOR THE APPROPRIATE SET OF CPU/CONTROL UNIT CTRS*/
*/********************************************************************/
*FINDTOTS: PROC;                                           /*@0001VLS*/
FINDTOTS STM   @14,@12,@SA00018                                    0755
* FOUND = OFF;                        /* INIT SEARCH VARIABLE        */
         NI    FOUND,B'11011111'                                   0756
* SUMPTR = TOTALPTR;                                       /*@0001VLS*/
         L     @06,TOTALPTR                                        0757
         ST    @06,SUMPTR                                          0757
* DO WHILE (SUMPTR ^= ZERO & FOUND = OFF);                 /*@0001VLS*/
         B     @DE00758                                            0758
@DL00758 DS    0H                                                  0759
*   IF CHAIN = CPUCUX THEN                                         0759
         L     @06,SUMPTR                                          0759
         CLC   CHAIN(5),CPUCUX(@06)                                0759
         BNE   @RF00759                                            0759
*     FOUND = ON;                                          /*@0001VLS*/
         OI    FOUND,B'00100000'                                   0760
*   ELSE                                                           0761
*     DO;                                                  /*@0001VLS*/
         B     @RC00759                                            0761
@RF00759 DS    0H                                                  0762
*       Z = SUMPTR;                   /* SAVE THE POINTER TO LAST ONE*/
         L     @06,SUMPTR                                          0762
         ST    @06,Z                                               0762
*       SUMPTR = NEXTCPU;             /* NEXT ONE            @0001VLS*/
         L     @06,NEXTCPU(,@06)                                   0763
         ST    @06,SUMPTR                                          0763
*     END;                                                 /*@0001VLS*/
* END;                                                     /*@0001VLS*/
@RC00759 DS    0H                                                  0765
@DE00758 L     @06,SUMPTR                                          0765
         LTR   @06,@06                                             0765
         BZ    @DC00758                                            0765
         TM    FOUND,B'00100000'                                   0765
         BZ    @DL00758                                            0765
@DC00758 DS    0H                                                  0766
* IF SUMPTR = ZERO THEN               /* MUST CREATE A NEW AREA      */
         L     @06,SUMPTR                                          0766
         LTR   @06,@06                                             0766
         BNZ   @RF00766                                            0766
*  DO;                                                     /*@0001VLS*/
*    RESPECIFY (R0,R15) RESTRICTED;                        /*@0001VLS*/
*    R0 = LENGTH(SUMAREA);            /* SIZE OF NEW AREA    @0001VLS*/
         LA    R0,784                                              0769
*    GEN(GETMAIN EC,LV=(0),A=SUMPTR);                      /*@0001VLS*/
         GETMAIN EC,LV=(0),A=SUMPTR
*    RETCODE = R15;                                        /*@0001VLS*/
         ST    R15,RETCODE                                         0771
*    RESPECIFY (R0,R15) UNRESTRICTED;                      /*@0001VLS*/
*    IF RETCODE = ZERO THEN                                        0773
         L     @06,RETCODE                                         0773
         LTR   @06,@06                                             0773
         BNZ   @RF00773                                            0773
*      DO;                                                 /*@0001VLS*/
*        DO I = ONE TO 16;                                 /*@0001VLS*/
         LA    @06,1                                               0775
         STH   @06,I                                               0775
@DL00775 DS    0H                                                  0776
*          SUMTEMP(I) = SUMTEMP(I) && SUMTEMP(I);   /* CLEAR AREA    */
         L     @03,SUMPTR                                          0776
         LR    @15,@06                                             0776
         MH    @15,@CH01401                                        0776
         ST    @15,@TF00001                                        0776
         ALR   @15,@03                                             0776
         AL    @15,@CF01417                                        0776
         XC    SUMTEMP-16(42,@15),SUMTEMP-16(@15)                  0776
*          FDATE(I,1:2) = EOT;                             /*@0001VLS*/
         AL    @03,@TF00001                                        0777
         MVC   FDATE-48(2,@03),@CB00261                            0777
*        END;                                              /*@0001VLS*/
         AL    @06,@CF00055                                        0778
         STH   @06,I                                               0778
         C     @06,@CF00088                                        0778
         BNH   @DL00775                                            0778
*        IF TOTALPTR = ZERO THEN                                   0779
         L     @06,TOTALPTR                                        0779
         LTR   @06,@06                                             0779
         BNZ   @RF00779                                            0779
*          TOTALPTR = SUMPTR;                              /*@0001VLS*/
         L     @06,SUMPTR                                          0780
         ST    @06,TOTALPTR                                        0780
*        ELSE                                                      0781
*          Z -> NEXTCPU = SUMPTR;                          /*@0001VLS*/
         B     @RC00779                                            0781
@RF00779 L     @06,SUMPTR                                          0781
         L     @03,Z                                               0781
         ST    @06,NEXTCPU(,@03)                                   0781
*        NEXTCPU = ZERO;                /* NOTHING IN CHAIN  @0001VLS*/
@RC00779 L     @06,SUMPTR                                          0782
         SLR   @03,@03                                             0782
         ST    @03,NEXTCPU(,@06)                                   0782
*        CPUCUX = CHAIN;                /* CPU SERIAL/MODEL CUA      */
         MVC   CPUCUX(5,@06),CHAIN                                 0783
*        CONTRCUA = CUX;                /* SORT TABLE ENTRY  @0001VLS*/
         L     @03,CURRPTR                                         0784
         MVC   CONTRCUA(2,@03),CUX(@06)                            0784
*        CPU = RECCPU;                  /* SORT TABLE CPU ENTRY      */
         MVC   CPU(3,@03),RECCPU                                   0785
*        TABCCHHR = SUMPTRC;            /* LOCATION OF SUMMARY AREA  */
         MVI   TABCCHHR+4(@03),C' '                                0786
         MVC   TABCCHHR(4,@03),SUMPTRC                             0786
*        TYPE = THREE;                                     /*@0001VLS*/
         MVI   TYPE(@03),X'03'                                     0787
*        NUMENT = NUMENT + ONE;                            /*@0001VLS*/
         LA    @15,1                                               0788
         AL    @15,NUMENT                                          0788
         ST    @15,NUMENT                                          0788
*        CURRPTR = CURRPTR - ELEVEN;    /* DECREMENT TO NEXT ENTRY   */
         SL    @03,@CF00034                                        0789
         ST    @03,CURRPTR                                         0789
*        FDATE(CUAINDEX) = DATE(2:4);   /* FROM DATE         @0001VLS*/
         L     @03,CUAINDEX                                        0790
         MH    @03,@CH01401                                        0790
         ST    @03,@TF00001                                        0790
         ALR   @03,@06                                             0790
         MVC   FDATE-48(3,@03),DATE+1(R7)                          0790
*        TDATE(CUAINDEX) = DATE(2:4);   /* TO DATE           @0001VLS*/
         AL    @06,@TF00001                                        0791
         MVC   TDATE-48(3,@06),DATE+1(R7)                          0791
*      END;                                                /*@0001VLS*/
*    ELSE                                                          0793
*      DO;                                                 /*@0001VLS*/
         B     @RC00773                                            0793
@RF00773 DS    0H                                                  0794
*        CALL IFCMSG(53,ADDR(MSGADDR));                    /*@0001VLS*/
         LA    @06,MSGADDR                                         0794
         ST    @06,@AFTEMPS                                        0794
         L     @15,ADIFCMSG(,R2)                                   0794
         LA    @01,@AL00794                                        0794
         BALR  @14,@15                                             0794
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0795
*      END;                                                /*@0001VLS*/
*  END;                                                    /*@0001VLS*/
* END;                                                     /*@0001VLS*/
@EL00018 DS    0H                                                  0798
@EF00018 DS    0H                                                  0798
@ER00018 LM    @14,@12,@SA00018                                    0798
         BR    @14                                                 0798
*/********************************************************************/
*/*    THIS PROC WILL PRINT THE DEBUG COUNTS SAVE AT VARIOUS POINTS  */
*/*    THE COUNTS ARE ONLY FROM IFCTHRSH NOT CUA OR EEDIT    @0001VLS*/
*/********************************************************************/
*BUGDATA: PROC;               /* PRINT DEBUG16 DATA          @0001VLS*/
BUGDATA  STM   @14,@12,@SA00019                                    0799
*MSGADDR = BUG16;                /*MOVE THE DEBUG HEADING INTO BUFFER*/
         MVI   MSGADDR+31,C' '                                     0800
         MVC   MSGADDR+32(100),MSGADDR+31                          0800
         MVC   MSGADDR(31),BUG16                                   0800
*CALL PRINTIT;                   /*GO PRINT THE MESSAGE      @0001VLS*/
         BAL   @14,PRINTIT                                         0801
*CALL CONVBIN(TOTREC,BUG10);          /* TOTAL NUMBER OF RECORDS READ*/
         LA    @01,@AL00802                                        0802
         BAL   @14,CONVBIN                                         0802
*MSGADDR = BUG10;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+26,C' '                                     0803
         MVC   MSGADDR+27(105),MSGADDR+26                          0803
         MVC   MSGADDR(26),BUG10                                   0803
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0804
*CALL CONVBIN(OBRCT,BUG20);           /* NUMBER OF OBR RECORDS READ  */
         LA    @01,@AL00805                                        0805
         BAL   @14,CONVBIN                                         0805
*MSGADDR = BUG20;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+24,C' '                                     0806
         MVC   MSGADDR+25(107),MSGADDR+24                          0806
         MVC   MSGADDR(24),BUG20                                   0806
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0807
*CALL CONVBIN(NUMSHORT,BUG30);        /* NUMBER OF SHORT RECORDS     */
         LA    @01,@AL00808                                        0808
         BAL   @14,CONVBIN                                         0808
*MSGADDR = BUG30;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+36,C' '                                     0809
         MVC   MSGADDR+37(95),MSGADDR+36                           0809
         MVC   MSGADDR(36),BUG30                                   0809
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0810
*CALL CONVBIN(BADDEV,BUG31);          /* NUMBER OF NON-8003 DEVICES  */
         LA    @01,@AL00811                                        0811
         BAL   @14,CONVBIN                                         0811
*MSGADDR = BUG31;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+30,C' '                                     0812
         MVC   MSGADDR+31(101),MSGADDR+30                          0812
         MVC   MSGADDR(30),BUG31                                   0812
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0813
*CALL CONVBIN(BADDAY,BUG40);        /* NUM RECORDS FAILED DATE RANGE */
         LA    @01,@AL00814                                        0814
         BAL   @14,CONVBIN                                         0814
*MSGADDR = BUG40;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+37,C' '                                     0815
         MVC   MSGADDR+38(94),MSGADDR+37                           0815
         MVC   MSGADDR(37),BUG40                                   0815
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0816
*CALL CONVBIN(BADTIME,BUG50);       /* NUM RECORDS FAILED TIME RANGE */
         LA    @01,@AL00817                                        0817
         BAL   @14,CONVBIN                                         0817
*MSGADDR = BUG50;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+37,C' '                                     0818
         MVC   MSGADDR+38(94),MSGADDR+37                           0818
         MVC   MSGADDR(37),BUG50                                   0818
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0819
*CALL CONVBIN(DROP3RD,BUG60);       /* NUM RECORDS FAILED 3RD SHIFT  */
         LA    @01,@AL00820                                        0820
         BAL   @14,CONVBIN                                         0820
*MSGADDR = BUG60;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+33,C' '                                     0821
         MVC   MSGADDR+34(98),MSGADDR+33                           0821
         MVC   MSGADDR(33),BUG60                                   0821
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0822
*CALL CONVBIN(BADCPU,BUG70);        /* NUM RECORDS FAILED CPU SPECS  */
         LA    @01,@AL00823                                        0823
         BAL   @14,CONVBIN                                         0823
*MSGADDR = BUG70;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+35,C' '                                     0824
         MVC   MSGADDR+36(96),MSGADDR+35                           0824
         MVC   MSGADDR(35),BUG70                                   0824
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0825
*CALL CONVBIN(BADCUA,BUG80);        /* NUM RECORDS FAILED CUA RANGE  */
         LA    @01,@AL00826                                        0826
         BAL   @14,CONVBIN                                         0826
*MSGADDR = BUG80;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+35,C' '                                     0827
         MVC   MSGADDR+36(96),MSGADDR+35                           0827
         MVC   MSGADDR(35),BUG80                                   0827
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0828
*CALL CONVBIN(BADVOL,BUG90);        /* NUM RECORDS FAILED VOL SPECS  */
         LA    @01,@AL00829                                        0829
         BAL   @14,CONVBIN                                         0829
*MSGADDR = BUG90;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+37,C' '                                     0830
         MVC   MSGADDR+38(94),MSGADDR+37                           0830
         MVC   MSGADDR(37),BUG90                                   0830
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0831
*CALL CONVBIN(BADSER,BUG100);        /* NUM RECORDS FAILED DEVSER    */
         LA    @01,@AL00832                                        0832
         BAL   @14,CONVBIN                                         0832
*MSGADDR = BUG100;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+45,C' '                                     0833
         MVC   MSGADDR+46(86),MSGADDR+45                           0833
         MVC   MSGADDR(45),BUG100                                  0833
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0834
*CALL CONVBIN(SHAREMOD,BUG110);       /* NUM SHARE CHGS AS CONTROLLER*/
         LA    @01,@AL00835                                        0835
         BAL   @14,CONVBIN                                         0835
*MSGADDR = BUG110;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+66,C' '                                     0836
         MVC   MSGADDR+67(65),MSGADDR+66                           0836
         MVC   MSGADDR(66),BUG110                                  0836
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0837
*CALL CONVBIN(SHARECU,BUG120);        /* NUM SHARE CHGS AS CUA       */
         LA    @01,@AL00838                                        0838
         BAL   @14,CONVBIN                                         0838
*MSGADDR = BUG120;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+56,C' '                                     0839
         MVC   MSGADDR+57(75),MSGADDR+56                           0839
         MVC   MSGADDR(56),BUG120                                  0839
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0840
*CALL CONVBIN(EXCTHRES(1),BUG130);        /* NUM THRESHOLD EXCEEDS   */
         LA    @01,@AL00841                                        0841
         BAL   @14,CONVBIN                                         0841
*MSGADDR = BUG130;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+33,C' '                                     0842
         MVC   MSGADDR+34(98),MSGADDR+33                           0842
         MVC   MSGADDR(33),BUG130                                  0842
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0843
*CALL CONVBIN(EXCTHRES(2),BUG140);        /* NUM PERM ERRORS @0001VLS*/
         LA    @01,@AL00844                                        0844
         BAL   @14,CONVBIN                                         0844
*MSGADDR = BUG140;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+30,C' '                                     0845
         MVC   MSGADDR+31(101),MSGADDR+30                          0845
         MVC   MSGADDR(30),BUG140                                  0845
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         0846
*END;                                                      /*@0001VLS*/
@EL00019 DS    0H                                                  0847
@EF00019 DS    0H                                                  0847
@ER00019 LM    @14,@12,@SA00019                                    0847
         BR    @14                                                 0847
*/*                                                          @0001VLS*/
*/* LOOK UP THE CUA IN THE SHARE TABLE FOR THE CONVERTED SHARE VALUE. *
*/* IF IT IS FOUND, RETURN THE CONVERTED VALUE IN NEW CUA. IF NOT,    *
*/* RETURN THE ORIGINAL VALUE IN NEWCUA.                     @0001VLS*/
*/*                                                          @0001VLS*/
*CUASHARE: PROC;                                           /*@0001VLS*/
CUASHARE STM   @14,@12,12(@13)                                     0848
*    VALIDSHR = OFF;                          /* TURN OFF FOR SEARCH  *
         NI    VALIDSHR,B'01111111'                                0849
*    SHR74CUA = OCUA2;                        /* CUA FOR COMPARISON   *
         MVC   SHR74CUA(2),OCUA2(R7)                               0850
*    SHR74CPU = CPUIDENT;                     /* CPU FOR COMPARISON   *
         MVC   SHR74CPU(3),CPUIDENT(R7)                            0851
*    SHR74XXD = SHR74XXX;                     /* FOR CONTROLLER COMPR *
         MVC   SHR74XXD(5),SHR74XXX                                0852
*    SHR74CUX = SHR74CUX & FOXZERO;                        /*@0001VLS*/
         NI    SHR74CUX,X'F0'                                      0853
*    SHR74XDD = ON;                                        /*@0001VLS*/
         OI    SHR74XDD,B'10000000'                                0854
*    DO I = 1 TO SHARENUM BY 1 WHILE(VALIDSHR = OFF);      /*@0001VLS*/
         LA    @06,1                                               0855
         STH   @06,I                                               0855
         B     @DE00855                                            0855
@DL00855 TM    VALIDSHR,B'10000000'                                0855
         BNZ   @DC00855                                            0855
*      IF SHAREDX(I) = ON THEN                                     0856
         MH    @06,@CH00034                                        0856
         L     @03,SHAREPTR(,R2)                                   0856
         ST    @06,@TF00001                                        0856
         ALR   @06,@03                                             0856
         AL    @06,@CF01429                                        0856
         TM    SHAREDX-2(@06),B'10000000'                          0856
         BNO   @RF00856                                            0856
*        DO;                                  /* CHECK FOR CONTROLLER *
*          IF SHR74XXD = SHRCUCPU(I) THEN                          0858
         LR    @06,@03                                             0858
         AL    @06,@TF00001                                        0858
         AL    @06,@CF01429                                        0858
         CLC   SHR74XXD(5),SHRCUCPU-2(@06)                         0858
         BNE   @RF00858                                            0858
*            DO;                                           /*@0001VLS*/
*              /*                                            @0001VLS*/
*              /* PUT IN CUA FROM SHARE TABLE WITH UNITS ADDR FROM REC*
*              /*                                            @0001VLS*/
*              SHAREMOD = SHAREMOD + ONE; /*CONTROLLER LEVEL CHANGE*/
         LA    @06,1                                               0860
         AL    @06,SHAREMOD                                        0860
         ST    @06,SHAREMOD                                        0860
*              SHR74CUA = SHARECUB(I);                     /*@0001VLS*/
         LR    @06,@03                                             0861
         AL    @06,@TF00001                                        0861
         AL    @06,@CF01425                                        0861
         MVC   SHR74CUA(2),SHARECUB-7(@06)                         0861
*              SHR74CUA = SHR74CUA & ZFFF;                 /*@0001VLS*/
         NC    SHR74CUA(2),@CB00463                                0862
*              RECCUA = OCUA2 & ZZZF;                      /*@0001VLS*/
         MVC   RECCUA(2),OCUA2(R7)                                 0863
         NC    RECCUA(2),@CB00465                                  0863
*              RECCUA = RECCUA × SHR74CUA;                 /*@0001VLS*/
         OC    RECCUA(2),SHR74CUA                                  0864
*              RECCPU = SHARSERB(I);                       /*@0001VLS*/
         AL    @03,@TF00001                                        0865
         BCTR  @03,0                                               0865
         BCTR  @03,0                                               0865
         MVC   RECCPU(3),SHARSERB-9(@03)                           0865
*              VALIDSHR = ON;                              /*@0001VLS*/
         OI    VALIDSHR,B'10000000'                                0866
*            END;                                          /*@0001VLS*/
*        END;                                              /*@0001VLS*/
*      ELSE                                                        0869
*        IF SHR74XXX = SHRCUCPU(I) THEN                            0869
         B     @RC00856                                            0869
@RF00856 LH    @06,I                                               0869
         MH    @06,@CH00034                                        0869
         L     @03,SHAREPTR(,R2)                                   0869
         ST    @06,@TF00001                                        0869
         ALR   @06,@03                                             0869
         AL    @06,@CF01429                                        0869
         CLC   SHR74XXX(5),SHRCUCPU-2(@06)                         0869
         BNE   @RF00869                                            0869
*          DO;                                /* CUA ONLY.   @0001VLS*/
*            SHARECU = SHARECU + ONE;   /*CUA LEVEL CHANGE   @0001VLS*/
         LA    @06,1                                               0871
         AL    @06,SHARECU                                         0871
         ST    @06,SHARECU                                         0871
*            RECCUA = SHARECUB(I);                         /*@0001VLS*/
         LR    @06,@03                                             0872
         AL    @06,@TF00001                                        0872
         AL    @06,@CF01425                                        0872
         MVC   RECCUA(2),SHARECUB-7(@06)                           0872
*            RECCPU = SHARSERB(I);                         /*@0001VLS*/
         AL    @03,@TF00001                                        0873
         BCTR  @03,0                                               0873
         BCTR  @03,0                                               0873
         MVC   RECCPU(3),SHARSERB-9(@03)                           0873
*            VALIDSHR = ON;                                /*@0001VLS*/
         OI    VALIDSHR,B'10000000'                                0874
*          END;                                            /*@0001VLS*/
*    END;                                                  /*@0001VLS*/
@RF00869 DS    0H                                                  0876
@RC00856 LA    @06,1                                               0876
         AH    @06,I                                               0876
         STH   @06,I                                               0876
@DE00855 L     @03,SHAREPTR(,R2)                                   0876
         CH    @06,SHARENUM(,@03)                                  0876
         BNH   @DL00855                                            0876
@DC00855 DS    0H                                                  0877
*    RETURN;                                               /*@0001VLS*/
@EL00020 DS    0H                                                  0877
@EF00020 DS    0H                                                  0877
@ER00020 LM    @14,@12,12(@13)                                     0877
         BR    @14                                                 0877
* END;                                                     /*@0001VLS*/
*/*                                                          @0001VLS*/
*/*****************************************************************/
*/*    THIS PROC WILL HEX DUMP THE SORT TABLE ENTRIES ONE/LINE    */
*DUMP: PROC;                                               /*@0001VLS*/
DUMP     STM   @14,@12,@SA00021                                    0879
* MSGDS = CHARS(2);              /* TOURIST DATA SET OUTPUT  @0001VLS*/
         MVC   MSGDS(1),CHARS+1                                    0880
* MSGADDR = BUG8;                                          /*@0001VLS*/
         MVI   MSGADDR+33,C' '                                     0881
         MVC   MSGADDR+34(98),MSGADDR+33                           0881
         MVC   MSGADDR(33),BUG8                                    0881
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0882
* DO Z = ONE BY ONE TO SORTNUM;                            /*@0001VLS*/
         LA    @06,1                                               0883
         ST    @06,Z                                               0883
         B     @DE00883                                            0883
@DL00883 DS    0H                                                  0884
*  CALL CONVERT(SORTTAB(Z),MSGADDR,ELEVEN);                /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00884                              0884
         MH    @06,@CH00034                                        0884
         L     @03,SORTADR(,R2)                                    0884
         AL    @03,@CF01430                                        0884
         LA    @06,SORTTAB(@06,@03)                                0884
         ST    @06,@AL00001                                        0884
         LA    @01,@AL00001                                        0884
         BAL   @14,CONVERT                                         0884
*  CALL PRINTIT;                 /*PRINT THIS ENTRY OF THE SORT TABLE*/
         BAL   @14,PRINTIT                                         0885
* END;                                                     /*@0001VLS*/
         LA    @06,1                                               0886
         AL    @06,Z                                               0886
         ST    @06,Z                                               0886
@DE00883 C     @06,SORTNUM(,R2)                                    0886
         BNH   @DL00883                                            0886
*END;                                                      /*@0001VLS*/
@EL00021 DS    0H                                                  0887
@EF00021 DS    0H                                                  0887
@ER00021 LM    @14,@12,@SA00021                                    0887
         BR    @14                                                 0887
*CONVBIN1: PROC(BWORD1,DADDR1);                            /*@0001VLS*/
CONVBIN1 STM   @14,@12,@SA00022                                    0888
         MVC   @PC00022(8),0(@01)                                  0888
* DCL  BWORD1 FIXED(8);                                    /*@0001VLS*/
* DCL  DADDR1 CHAR(20);                                    /*@0001VLS*/
* L = BWORD1;                                              /*@0001VLS*/
         L     @06,@PC00022                                        0891
         SLR   @03,@03                                             0891
         IC    @03,BWORD1(,@06)                                    0891
         ST    @03,L                                               0891
* CALL CONVBIN(L,DADDR1);                                  /*@0001VLS*/
         LA    @06,L                                               0892
         ST    @06,@AL00001                                        0892
         L     @06,@PC00022+4                                      0892
         ST    @06,@AL00001+4                                      0892
         LA    @01,@AL00001                                        0892
         BAL   @14,CONVBIN                                         0892
*END;                                                      /*@0001VLS*/
@EL00022 DS    0H                                                  0893
@EF00022 DS    0H                                                  0893
@ER00022 LM    @14,@12,@SA00022                                    0893
         BR    @14                                                 0893
*CONVBIN2: PROC(BWORD2,DADDR2);                            /*@0001VLS*/
CONVBIN2 STM   @14,@12,@SA00023                                    0894
         MVC   @PC00023(8),0(@01)                                  0894
* DCL  BWORD2 FIXED(15);                                   /*@0001VLS*/
* DCL  DADDR2 CHAR(20);                                    /*@0001VLS*/
* L = BWORD2;                                              /*@0001VLS*/
         L     @06,@PC00023                                        0897
         LH    @06,BWORD2(,@06)                                    0897
         ST    @06,L                                               0897
* CALL CONVBIN(L,DADDR2);                                  /*@0001VLS*/
         LA    @06,L                                               0898
         ST    @06,@AL00001                                        0898
         L     @06,@PC00023+4                                      0898
         ST    @06,@AL00001+4                                      0898
         LA    @01,@AL00001                                        0898
         BAL   @14,CONVBIN                                         0898
*END;                                                      /*@0001VLS*/
@EL00023 DS    0H                                                  0899
@EF00023 DS    0H                                                  0899
@ER00023 LM    @14,@12,@SA00023                                    0899
         BR    @14                                                 0899
*CONVBIN3: PROC(BWORD3,DADDR3);                            /*@0001VLS*/
CONVBIN3 STM   @14,@12,12(@13)                                     0900
         MVC   @PC00024(8),0(@01)                                  0900
* DCL  BWORD3 FIXED(32) UNSIGNED;                          /*@0001VLS*/
* DCL  DADDR3 CHAR(20);                                    /*@0001VLS*/
* CVD(BWORD3,DBLWORD);                                     /*@0001VLS*/
         L     @06,@PC00024                                        0903
         L     @06,BWORD3(,@06)                                    0903
         CVD   @06,DBLWORD                                         0903
* UNPK(WORK(1:8),DBLWORD);                                 /*@0001VLS*/
         UNPK  WORK(8),DBLWORD(8)                                  0904
* WORK(8) = WORK(8) × FOXZERO;                             /*@0001VLS*/
         OI    WORK+7,X'F0'                                        0905
* SWITCH1 = OFF;                                           /*@0001VLS*/
         NI    SWITCH1,B'10111111'                                 0906
* DO L = 1 BY 1 TO 7 WHILE(SWITCH1 = OFF);                 /*@0001VLS*/
         LA    @06,1                                               0907
         ST    @06,L                                               0907
@DL00907 TM    SWITCH1,B'01000000'                                 0907
         BNZ   @DC00907                                            0907
*  IF WORKOVER(L) = FOXZERO THEN /*REMOVE THE LEADING ZEROS  @0001VLS*/
         LA    @03,WORKOVER-1(@06)                                 0908
         CLI   0(@03),X'F0'                                        0908
         BNE   @RF00908                                            0908
*    WORKOVER(L) = BLANK;        /*REPLACE WITH A BLANK CHARACTER*/
         LA    @03,WORKOVER-1(@06)                                 0909
         MVI   0(@03),C' '                                         0909
*   ELSE                                                           0910
*    SWITCH1 = ON;               /*TELL LOOP THE END OF LEADING ZEROS*/
         B     @RC00908                                            0910
@RF00908 OI    SWITCH1,B'01000000'                                 0910
* END;                                                     /*@0001VLS*/
@RC00908 LA    @06,1                                               0911
         AL    @06,L                                               0911
         ST    @06,L                                               0911
         C     @06,@CF00082                                        0911
         BNH   @DL00907                                            0911
@DC00907 DS    0H                                                  0912
* DADDR3(1:8) = WORK(1:8);       /* MOVE THE DATA TO THE OUTPUT LINE */
         L     @06,@PC00024+4                                      0912
         MVC   DADDR3(8,@06),WORK                                  0912
*END;                                                      /*@0001VLS*/
@EL00024 DS    0H                                                  0913
@EF00024 DS    0H                                                  0913
@ER00024 LM    @14,@12,12(@13)                                     0913
         BR    @14                                                 0913
*CONVBIN: PROC(BINWORD,DECADDR);                           /*@0001VLS*/
CONVBIN  STM   @14,@12,12(@13)                                     0914
         MVC   @PC00025(8),0(@01)                                  0914
* DCL  BINWORD FIXED(31);                                  /*@0001VLS*/
* DCL  DECADDR CHAR(20);                                   /*@0001VLS*/
* RESPECIFY (R8) RESTRICTED;                               /*@0001VLS*/
* R8 = BINWORD;                  /*LOAD THE ITEM TO CONVERT  @0001VLS*/
         L     @06,@PC00025                                        0918
         L     R8,BINWORD(,@06)                                    0918
* CVD(R8,DBLWORD);                                         /*@0001VLS*/
         CVD   R8,DBLWORD                                          0919
* UNPK(WORK(1:8),DBLWORD);                                 /*@0001VLS*/
         UNPK  WORK(8),DBLWORD(8)                                  0920
* WORK(8) = WORK(8) × FOXZERO;                             /*@0001VLS*/
         OI    WORK+7,X'F0'                                        0921
* SWITCH1 = OFF;                                           /*@0001VLS*/
         NI    SWITCH1,B'10111111'                                 0922
* DO L = 1 BY 1 TO 7 WHILE(SWITCH1 = OFF);                 /*@0001VLS*/
         LA    @09,1                                               0923
         ST    @09,L                                               0923
@DL00923 TM    SWITCH1,B'01000000'                                 0923
         BNZ   @DC00923                                            0923
*  IF WORKOVER(L) = FOXZERO THEN /*REMOVE THE LEADING ZEROS  @0001VLS*/
         LA    @06,WORKOVER-1(@09)                                 0924
         CLI   0(@06),X'F0'                                        0924
         BNE   @RF00924                                            0924
*    WORKOVER(L) = BLANK;        /*REPLACE WITH A BLANK CHARACTER*/
         LA    @06,WORKOVER-1(@09)                                 0925
         MVI   0(@06),C' '                                         0925
*   ELSE                                                           0926
*    SWITCH1 = ON;               /*TELL LOOP THE END OF LEADING ZEROS*/
         B     @RC00924                                            0926
@RF00924 OI    SWITCH1,B'01000000'                                 0926
* END;                                                     /*@0001VLS*/
@RC00924 LA    @09,1                                               0927
         AL    @09,L                                               0927
         ST    @09,L                                               0927
         C     @09,@CF00082                                        0927
         BNH   @DL00923                                            0927
@DC00923 DS    0H                                                  0928
* DECADDR(1:5) = WORK(4:8);      /* MOVE THE DATA TO THE OUTPUT LINE */
         L     @09,@PC00025+4                                      0928
         MVC   DECADDR(5,@09),WORK+3                               0928
* RESPECIFY (R8) UNRESTRICTED;                             /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00025 DS    0H                                                  0930
@EF00025 DS    0H                                                  0930
@ER00025 LM    @14,@12,12(@13)                                     0930
         BR    @14                                                 0930
*PRINTIT: PROC;                /*SET UP LINKAGE FOR I/O TO PRINT LINE*/
PRINTIT  STM   @14,@12,@SA00026                                    0931
* IF DEBUG27 = OFF THEN                                            0932
         TM    DEBUG27(R2),B'00010000'                             0932
         BNZ   @RF00932                                            0932
*PRINTADR = ADDR(MESSAGE);     /*TELL I/O ADDRESS OF OUT BUFFER*/  0933
         LA    @06,MESSAGE                                         0933
         ST    @06,PRINTADR(,R2)                                   0933
*CALL IOHND(RITEPRTR);         /*PASS CONTROL TO I/O TO PRINT MESSAGE*/
@RF00932 L     @15,ADIOHND(,R2)                                    0934
         LA    @01,@AL00934                                        0934
         BALR  @14,@15                                             0934
*END;                                                      /*@0001VLS*/
@EL00026 DS    0H                                                  0935
@EF00026 DS    0H                                                  0935
@ER00026 LM    @14,@12,@SA00026                                    0935
         BR    @14                                                 0935
* /*                                                         @0001VLS*/
* /* CONVERT CHARACTERS TO PRINTABLE                         @0001VLS*/
* /*                                                         @0001VLS*/
*CONVERT: PROC(NEXTBYTE,ADDNUM,LENNUM);                    /*@0001VLS*/
CONVERT  STM   @14,@12,12(@13)                                     0936
         MVC   @PC00027(12),0(@01)                                 0936
* DCL NEXTBYTE  CHAR(11);                                  /*@0001VLS*/
* DCL ADDNUM    CHAR(133);                                 /*@0001VLS*/
* DCL LENNUM    FIXED(31);        /* HOW MUCH TO CONVERT     @0001VLS*/
* RESPECIFY (R8,R9) RESTRICTED;                            /*@0001VLS*/
* DO P = LENNUM BY -1 TO ONE;                              /*@0001VLS*/
         L     @06,@PC00027+8                                      0941
         L     @06,LENNUM(,@06)                                    0941
         ST    @06,P                                               0941
         B     @DE00941                                            0941
@DL00941 DS    0H                                                  0942
*  R8 = NEXTBYTE(P);              /* LOAD THE NEXT BYTE      @0001VLS*/
         L     @03,@PC00027                                        0942
         BCTR  @03,0                                               0942
         SLR   R8,R8                                               0942
         IC    R8,NEXTBYTE(@06,@03)                                0942
*  X = TWO * P;                   /* INDEX FOR STORING CONVERTED 1/2 */
         LR    @03,@06                                             0943
         ALR   @03,@03                                             0943
         ST    @03,X                                               0943
*                                 /* BYTE.  INPUT IS 2 CHARS @0001VLS*/
*  SRDL(R8,FOUR);                 /* SPLIT THE BYTE IN HALF  @0001VLS*/
         SRDL  R8,4                                                0944
*  SRL(R9,28);                    /* RIGHT JUSTIFY SPLIT HALF BYTE   */
         SRL   R9,28                                               0945
*  R9 = R9 + ONE;                                          /*@0001VLS*/
         LA    @15,1                                               0946
         ALR   R9,@15                                              0946
*  R8 = R8 + ONE;                                          /*@0001VLS*/
         ALR   R8,@15                                              0947
*  ADDNUM(X-ONE) = CHARS(R8);     /* CHARS IS 16 CHAR STRING FOR     */
         L     @15,@PC00027+4                                      0948
         ALR   @03,@15                                             0948
         BCTR  @03,0                                               0948
         BCTR  @03,0                                               0948
         LA    @01,CHARS-1(R8)                                     0948
         MVC   ADDNUM(1,@03),0(@01)                                0948
*  ADDNUM(X)     = CHARS(R9);     /* CONVERTINAG HEX NUMS TO PRINT   */
         L     @03,X                                               0949
         ALR   @15,@03                                             0949
         BCTR  @15,0                                               0949
         LA    @03,CHARS-1(R9)                                     0949
         MVC   ADDNUM(1,@15),0(@03)                                0949
* END;                                                     /*@0001VLS*/
         BCTR  @06,0                                               0950
         ST    @06,P                                               0950
@DE00941 LTR   @06,@06                                             0950
         BP    @DL00941                                            0950
*END;                                                      /*@0001VLS*/
@EL00027 DS    0H                                                  0951
@EF00027 DS    0H                                                  0951
@ER00027 LM    @14,@12,12(@13)                                     0951
         BR    @14                                                 0951
*RESPECIFY (R8,R9) UNRESTRICTED;                           /*@0001VLS*/
* /*                                                         @0001VLS*/
* /* CALCULATE THE PERCENTAGE FOR THE TEMPORARY SUMMARY      @0001VLS*/
* /*                                                         @0001VLS*/
*CALCPERC: PROC(DIVEND,DIVSOR,OUTLOC);                     /*@0001VLS*/
CALCPERC STM   @14,@12,@SA00028                                    0953
         MVC   @PC00028(12),0(@01)                                 0953
* DCL DIVEND    FIXED(31);        /* DIVIDEND                @0001VLS*/
* DCL DIVSOR    FIXED(32) UNSIGNED;  /* DIVISOR              @0001VLS*/
* DCL OUTLOC    CHAR(5);          /* OUTPUT LOCATION         @0001VLS*/
* /* Z = (DIVEND * 200000 * 100) / DIVSOR                    @0001VLS*/
* RESPECIFY (R8,R9) RESTRICTED;                            /*@0001VLS*/
* R8 = ZERO;                      /* CLEAR HIGH ORDER PART OF REGS   */
         SLR   R8,R8                                               0958
* R9 = DIVEND;                    /* MULTIPLICAND            @0001VLS*/
         L     @06,@PC00028                                        0959
         L     R9,DIVEND(,@06)                                     0959
* R7 = 20000000;                  /* MULTIPLIER              @0001VLS*/
         L     R7,@CF01365                                         0960
* GEN (MR R8,R7);                 /* PRODUCT/DIVIDEND        @0001VLS*/
         MR R8,R7
* R7 = DIVSOR;                    /* DIVISOR                 @0001VLS*/
         L     @03,@PC00028+4                                      0962
         L     R7,DIVSOR(,@03)                                     0962
* GEN (DR R8,R7);                                          /*@0001VLS*/
         DR R8,R7
* Z = R9;                         /* QUOTIENT                @0001VLS*/
         ST    R9,Z                                                0964
* RESPECIFY (R8,R9) UNRESTRICTED;                          /*@0001VLS*/
* IF Z >= 10000 THEN                                               0966
         L     @06,Z                                               0966
         C     @06,@CF01366                                        0966
         BL    @RF00966                                            0966
*   OUTLOC = HUNDPLUS;            /* OVER 100 PERCENT        @0001VLS*/
         L     @06,@PC00028+8                                      0967
         MVC   OUTLOC(5,@06),@CC00502                              0967
* ELSE                                                             0968
*   DO;                                                    /*@0001VLS*/
         B     @RC00966                                            0968
@RF00966 DS    0H                                                  0969
*     CVD (Z,DBLWORD);                                     /*@0001VLS*/
         L     @06,Z                                               0969
         CVD   @06,DBLWORD                                         0969
*     UNPK (TEMPAREA(1:8),DBLWORD);                        /*@0001VLS*/
         UNPK  TEMPAREA(8),DBLWORD(8)                              0970
*     TEMPAREA(8) = TEMPAREA(8) × FOXZERO;                 /*@0001VLS*/
         OI    TEMPAREA+7,X'F0'                                    0971
*     IF TEMPAREA(5) = FOXZERO THEN                                0972
         CLI   TEMPAREA+4,X'F0'                                    0972
         BNE   @RF00972                                            0972
*       TEMPAREA(5) = BLANK;        /* CHANGE LEADING ZERO TO BLANK  */
         MVI   TEMPAREA+4,C' '                                     0973
*     OUTLOC(1:2) = TEMPAREA(5:6);  /* TENS AND UNITS DIGITS @0001VLS*/
@RF00972 L     @06,@PC00028+8                                      0974
         MVC   OUTLOC(2,@06),TEMPAREA+4                            0974
*     OUTLOC(3) = PERIOD;                                  /*@0001VLS*/
         MVI   OUTLOC+2(@06),C'.'                                  0975
*     OUTLOC(4:5) = TEMPAREA(7:8);  /* TENTHS AND HUNDREDTHS @0001VLS*/
         MVC   OUTLOC+3(2,@06),TEMPAREA+6                          0976
*   END;                                                   /*@0001VLS*/
* END;                                                     /*@0001VLS*/
@EL00028 DS    0H                                                  0978
@EF00028 DS    0H                                                  0978
@ER00028 LM    @14,@12,@SA00028                                    0978
         BR    @14                                                 0978
*/*                                                          @0001VLS*/
*/* THE RECORD IS PASSED AGAINST THE FILTERING CRITERIA SET UP BY THE*/
*/* PARAMETER ROUTINE.                                       @0001VLS*/
*/*                                                          @0001VLS*/
*FILTER: PROC;                                             /*@0001VLS*/
FILTER   STM   @14,@12,12(@13)                                     0979
*  TOTREC = TOTREC + ONE;         /* KEEP TRACK OF TOTAL RECORDS READ*/
         LA    @06,1                                               0980
         L     @03,TOTREC                                          0980
         ALR   @03,@06                                             0980
         ST    @03,TOTREC                                          0980
*  PASSFLAG = OFF;                /* ASSUME THE RECORD WILL FAIL     */
         NI    PASSFLAG(R2),B'11111110'                            0981
*  IF (RECTYP & FOXZERO) = OBRREC THEN  /* IS IT AN OBR RECORD       */
         MVC   @TS00001(1),RECTYP(R7)                              0982
         NI    @TS00001,X'F0'                                      0982
         CLI   @TS00001,X'30'                                      0982
         BNE   @RF00982                                            0982
*    DO OBRCT = OBRCT + ONE;                               /*@0001VLS*/
         AL    @06,OBRCT                                           0983
         ST    @06,OBRCT                                           0983
*      IF SHORT = OFF THEN        /* IF SHORT RECORD, THEN DISCARD   */
         TM    SHORT(R7),B'00100000'                               0984
         BNZ   @RF00984                                            0984
*        DO;                                               /*@0001VLS*/
*          IF DEV2 = SAVEDEV THEN /* IS THIS DEVICE USED BY THIS RPT */
         CLC   DEV2(2,R7),@CB00498                                 0986
         BNE   @RF00986                                            0986
*            DO;                                           /*@0001VLS*/
*              IF DATE >= STDATE &            /* IS DATE IN RANGE    */
*                DATE <= ENDDATE THEN                              0988
         CLC   DATE(4,R7),STDATE(R2)                               0988
         BL    @RF00988                                            0988
         CLC   DATE(4,R7),ENDDATE(R2)                              0988
         BH    @RF00988                                            0988
*                DO;                                       /*@0001VLS*/
*                  IF (TIME >= STTIME1 & TIME <= ENDTIME1) ×       0990
*                    (TIME >= STTIME2 & TIME <= ENDTIME2)  THEN    0990
         CLC   TIME(4,R7),STTIME1(R2)                              0990
         BL    @GL00009                                            0990
         CLC   TIME(4,R7),ENDTIME1(R2)                             0990
         BNH   @RT00990                                            0990
@GL00009 CLC   TIME(4,R7),STTIME2(R2)                              0990
         BL    @RF00990                                            0990
         CLC   TIME(4,R7),ENDTIME2(R2)                             0990
         BH    @RF00990                                            0990
@RT00990 DS    0H                                                  0991
*                    DO;                                   /*@0001VLS*/
*                      IF SHIFT3RD = ON &                          0992
*                        ((DATE = STDATE & TIME < STTIME1) ×       0992
*                        (DATE = ENDDATE & TIME > ENDTIME2)) THEN  0992
         TM    SHIFT3RD(R2),B'00010000'                            0992
         BNO   @RF00992                                            0992
         CLC   DATE(4,R7),STDATE(R2)                               0992
         BNE   @GL00013                                            0992
         CLC   TIME(4,R7),STTIME1(R2)                              0992
         BL    @RT00992                                            0992
@GL00013 CLC   DATE(4,R7),ENDDATE(R2)                              0992
         BNE   @RF00992                                            0992
         CLC   TIME(4,R7),ENDTIME2(R2)                             0992
         BNH   @RF00992                                            0992
@RT00992 DS    0H                                                  0993
*                         DROP3RD = DROP3RD + ONE; /* NUM FAIL TIME  */
         LA    @06,1                                               0993
         AL    @06,DROP3RD                                         0993
         ST    @06,DROP3RD                                         0993
*                      ELSE                                        0994
*                        PASSFLAG = ON;       /* SET FLAG TO PASS RCD*/
         B     @RC00992                                            0994
@RF00992 OI    PASSFLAG(R2),B'00000001'                            0994
*                    END;                                  /*@0001VLS*/
*                  ELSE                                            0996
*                    BADTIME = BADTIME + ONE; /* # OF REC OUT OF TIME*/
         B     @RC00990                                            0996
@RF00990 LA    @06,1                                               0996
         AL    @06,BADTIME                                         0996
         ST    @06,BADTIME                                         0996
*                END;                                      /*@0001VLS*/
*              ELSE                                                0998
*                BADDAY = BADDAY + ONE;       /* # OF REC FAILING DAY*/
         B     @RC00988                                            0998
@RF00988 LA    @06,1                                               0998
         AL    @06,BADDAY                                          0998
         ST    @06,BADDAY                                          0998
*            END;                                          /*@0001VLS*/
*         ELSE                                                     1000
*           BADDEV = BADDEV + ONE;        /* # OF DEVICES NOT 8003   */
         B     @RC00986                                            1000
@RF00986 LA    @06,1                                               1000
         AL    @06,BADDEV                                          1000
         ST    @06,BADDEV                                          1000
*        END;                                              /*@0001VLS*/
*      ELSE                                                        1002
*        NUMSHORT = NUMSHORT + ONE;       /* OBR WITH SHORT SW ON    */
         B     @RC00984                                            1002
@RF00984 LA    @06,1                                               1002
         AL    @06,NUMSHORT                                        1002
         ST    @06,NUMSHORT                                        1002
*    END;                                                  /*@0001VLS*/
@RC00984 DS    0H                                                  1004
*  ELSE                                                            1004
*    BADREC = BADREC + ONE;               /* # REC THAT ARE NOT OBRS */
         B     @RC00982                                            1004
@RF00982 LA    @06,1                                               1004
         AL    @06,BADREC                                          1004
         ST    @06,BADREC                                          1004
*  VALIDCUA = OFF;                                         /*@0001VLS*/
@RC00982 NI    VALIDCUA,B'10111111'                                1005
*  VALIDCPU = OFF;                                         /*@0001VLS*/
*  VALIDSER = OFF;                                         /*@0001VLS*/
         NI    VALIDCPU,B'11111100'                                1007
*  VALIDVOL = OFF;                                         /*@0001VLS*/
         NI    VALIDVOL,B'11011111'                                1008
*  IF PASSFLAG = YES THEN                 /* ALLOW RECORD TO CONTINUE*/
         TM    PASSFLAG(R2),B'00000001'                            1009
         BNO   @RF01009                                            1009
*    DO;                                                   /*@0001VLS*/
*      /*                                                    @0001VLS*/
*      /* THIS SECTION OF CODE COMPARES THE OBR JUST READ WITH THE   */
*      /* PARAMETERS BUILT BY THE PARAM ROUTINE.             @0001VLS*/
*      /* IF NO CUA WAS SPECIFIED, THE POINTER TO THE CUA TABLE WILL */
*      /* BE ZERO.  IF IT IS NOT, THEN A MAXIMUM OF SIXTEEN SINGLE   */
*      /* OR RANGE CUAS MUST BE COMPARED WITH THE CUA IN THE RECORD. */
*      /*                                                    @0001VLS*/
*      IF CUAPTR ^= ZERO THEN               /* ARE ALL CUA'S WANTED  */
         L     @06,CUAPTR(,R2)                                     1011
         LTR   @06,@06                                             1011
         BZ    @RF01011                                            1011
*        DO I = 1 TO CUANUM BY 1 WHILE (VALIDCUA = OFF);   /*@0001VLS*/
         LA    @06,1                                               1012
         STH   @06,I                                               1012
         B     @DE01012                                            1012
@DL01012 TM    VALIDCUA,B'01000000'                                1012
         BNZ   @DC01012                                            1012
*          IF OCUA2 >= CUA1(I) &            /* DOES THE CUA LIE IN   */
*            OCUA2 <= CUA2(I) THEN          /* RANGE SPECIFIED       */
         SLA   @06,2                                               1013
         L     @03,CUAPTR(,R2)                                     1013
         ST    @06,@TF00001                                        1013
         ALR   @06,@03                                             1013
         BCTR  @06,0                                               1013
         BCTR  @06,0                                               1013
         CLC   OCUA2(2,R7),CUA1-2(@06)                             1013
         BL    @RF01013                                            1013
         AL    @03,@TF00001                                        1013
         CLC   OCUA2(2,R7),CUA2-4(@03)                             1013
         BH    @RF01013                                            1013
*            VALIDCUA = ON;                 /* ACCEPT RECORD @0001VLS*/
         OI    VALIDCUA,B'01000000'                                1014
*        END;                                              /*@0001VLS*/
@RF01013 LA    @06,1                                               1015
         AH    @06,I                                               1015
         STH   @06,I                                               1015
@DE01012 L     @03,CUAPTR(,R2)                                     1015
         CH    @06,CUANUM(,@03)                                    1015
         BNH   @DL01012                                            1015
@DC01012 DS    0H                                                  1016
*      ELSE                                                        1016
*        VALIDCUA = ON;                     /* ACCEPT RECORD @0001VLS*/
         B     @RC01011                                            1016
@RF01011 OI    VALIDCUA,B'01000000'                                1016
*      /*                                                    @0001VLS*/
*      /* A CHECK IS MADE TO SEE IF A LIST OF VOLIS'S WAS PASSED IN  */
*      /* THE PARAMETER LIST.  IF IT WAS, THE VOLID IN THE RECORD IS */
*      /* COMPARED TO THE VOLIDS IN THE LIST TO SEE IF THE RECORD    */
*      /* SHOULD BE INCLUDED IN THE REPORTS.                 @0001VLS*/
*      /*                                                    @0001VLS*/
*      IF VOLPTR ^= ZERO THEN               /* WAS A VOLID SPECIFIED */
@RC01011 L     @06,VOLPTR(,R2)                                     1017
         LTR   @06,@06                                             1017
         BZ    @RF01017                                            1017
*        DO I = 1 TO VOLNUM BY 1 WHILE(VALIDVOL = OFF);    /*@0001VLS*/
         LA    @06,1                                               1018
         STH   @06,I                                               1018
         B     @DE01018                                            1018
@DL01018 TM    VALIDVOL,B'00100000'                                1018
         BNZ   @DC01018                                            1018
*          IF VOLVAL(I) = VOLID THEN        /* VOLUME IN LIST        */
         MH    @06,@CH00080                                        1019
         L     @03,VOLPTR(,R2)                                     1019
         ALR   @03,@06                                             1019
         AL    @03,@CF01425                                        1019
         CLC   VOLVAL-2(6,@03),VOLID(R7)                           1019
         BNE   @RF01019                                            1019
*            VALIDVOL = ON;                 /* ACCEPT RECORD @0001VLS*/
         OI    VALIDVOL,B'00100000'                                1020
*        END;                                              /*@0001VLS*/
@RF01019 LA    @06,1                                               1021
         AH    @06,I                                               1021
         STH   @06,I                                               1021
@DE01018 L     @03,VOLPTR(,R2)                                     1021
         CH    @06,VOLNUM(,@03)                                    1021
         BNH   @DL01018                                            1021
@DC01018 DS    0H                                                  1022
*      ELSE                                                        1022
*        VALIDVOL = ON;                     /* ACCEPT RECORD @0001VLS*/
         B     @RC01017                                            1022
@RF01017 OI    VALIDVOL,B'00100000'                                1022
*      /*                                                    @0001VLS*/
*      /* A CHECK IS MADE TO SEE ANY CPUS WERE SPECIFIED.    @0001VLS*/
*      /*                                                    @0001VLS*/
*      IF CPUPTR ^= ZERO THEN                                      1023
@RC01017 L     @06,CPUPTR(,R2)                                     1023
         LTR   @06,@06                                             1023
         BZ    @RF01023                                            1023
*        DO I = 1 TO CPUNUM BY 1 WHILE(VALIDCPU = OFF);    /*@0001VLS*/
         LA    @06,1                                               1024
         STH   @06,I                                               1024
         B     @DE01024                                            1024
@DL01024 TM    VALIDCPU,B'00000001'                                1024
         BNZ   @DC01024                                            1024
*          IF CPUIDENT = CPUVAL(I) THEN                            1025
         MH    @06,@CH00036                                        1025
         L     @03,CPUPTR(,R2)                                     1025
         ALR   @03,@06                                             1025
         AL    @03,@CF01435                                        1025
         CLC   CPUIDENT(5,R7),CPUVAL-2(@03)                        1025
         BNE   @RF01025                                            1025
*            VALIDCPU = ON;                                /*@0001VLS*/
         OI    VALIDCPU,B'00000001'                                1026
*        END;                                              /*@0001VLS*/
@RF01025 LA    @06,1                                               1027
         AH    @06,I                                               1027
         STH   @06,I                                               1027
@DE01024 L     @03,CPUPTR(,R2)                                     1027
         CH    @06,CPUNUM(,@03)                                    1027
         BNH   @DL01024                                            1027
@DC01024 DS    0H                                                  1028
*      ELSE                                                        1028
*        VALIDCPU = ON;                                    /*@0001VLS*/
         B     @RC01023                                            1028
@RF01023 OI    VALIDCPU,B'00000001'                                1028
*      /*                                                    @0001VLS*/
*      /* A CHECK IS MADE AGAINST ANY DEVICE SERIALS SPECIFIED.      */
*      /*                                                    @0001VLS*/
*      IF SERPTR ^= ZERO THEN                                      1029
@RC01023 L     @06,SERPTR(,R2)                                     1029
         LTR   @06,@06                                             1029
         BZ    @RF01029                                            1029
*        DO I = 1 TO SERNUM BY 1 WHILE(VALIDSER = OFF);    /*@0001VLS*/
         LA    @06,1                                               1030
         STH   @06,I                                               1030
         B     @DE01030                                            1030
@DL01030 TM    VALIDSER,B'00000010'                                1030
         BNZ   @DC01030                                            1030
*          IF OSER74XX = SERVAL(I) THEN                            1031
         ALR   @06,@06                                             1031
         L     @03,SERPTR(,R2)                                     1031
         ALR   @03,@06                                             1031
         CLC   OSER74XX(2,R7),SERVAL-2(@03)                        1031
         BNE   @RF01031                                            1031
*            VALIDSER = ON;                                /*@0001VLS*/
         OI    VALIDSER,B'00000010'                                1032
*        END;                                              /*@0001VLS*/
@RF01031 LA    @06,1                                               1033
         AH    @06,I                                               1033
         STH   @06,I                                               1033
@DE01030 L     @03,SERPTR(,R2)                                     1033
         CH    @06,SERNUM(,@03)                                    1033
         BNH   @DL01030                                            1033
@DC01030 DS    0H                                                  1034
*      ELSE                                                        1034
*        VALIDSER = ON;                                    /*@0001VLS*/
         B     @RC01029                                            1034
@RF01029 OI    VALIDSER,B'00000010'                                1034
*      /*                                                    @0001VLS*/
*      IF DEBUG16 = ON THEN    /*IF YES CHECK TO ADD ANY DROPPED REC */
@RC01029 TM    DEBUG16(R2),B'10000000'                             1035
         BNO   @RF01035                                            1035
*        DO;                                               /*@0001VLS*/
*          IF VALIDCUA = OFF THEN                                  1037
         TM    VALIDCUA,B'01000000'                                1037
         BNZ   @RF01037                                            1037
*            BADCUA = BADCUA + ONE; /*NUMBER DROPPED FOR CUA @0001VLS*/
         LA    @06,1                                               1038
         AL    @06,BADCUA                                          1038
         ST    @06,BADCUA                                          1038
*          ELSE                                                    1039
*            IF VALIDVOL = OFF THEN                                1039
         B     @RC01037                                            1039
@RF01037 TM    VALIDVOL,B'00100000'                                1039
         BNZ   @RF01039                                            1039
*              BADVOL = BADVOL + ONE; /* NUMBER DROPPED FOR VOLID    */
         LA    @06,1                                               1040
         AL    @06,BADVOL                                          1040
         ST    @06,BADVOL                                          1040
*            ELSE                                                  1041
*              IF VALIDSER = OFF THEN                              1041
         B     @RC01039                                            1041
@RF01039 TM    VALIDSER,B'00000010'                                1041
         BNZ   @RF01041                                            1041
*                BADSER = BADSER + ONE;  /*INCORRECT SERIAL NUMBER   */
         LA    @06,1                                               1042
         AL    @06,BADSER                                          1042
         ST    @06,BADSER                                          1042
*              ELSE                                                1043
*                IF VALIDCPU =  OFF THEN                           1043
         B     @RC01041                                            1043
@RF01041 TM    VALIDCPU,B'00000001'                                1043
         BNZ   @RF01043                                            1043
*                  BADCPU = BADCPU + ONE; /* CPU DOES NOT MATCH PARMS*/
         LA    @06,1                                               1044
         AL    @06,BADCPU                                          1044
         ST    @06,BADCPU                                          1044
*        END;                                              /*@0001VLS*/
*    END;                                                  /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00029 DS    0H                                                  1047
@EF00029 DS    0H                                                  1047
@ER00029 LM    @14,@12,12(@13)                                     1047
         BR    @14                                                 1047
*/*                                                          @0001VLS*/
*/* AT END OF FILE THE PART OF THE CONTROL TABLE THAT HAS NOT BEEN   */
*/* USED IS FREED AND THEN CONTROL IS PASSED TO SORT THE TABLE.      */
*/*                                                          @0001VLS*/
*ENDOFILE: PROC;                                           /*@0001VLS*/
ENDOFILE STM   @14,@12,@SA00030                                    1048
* IF CURRPTR < TABPTR THEN               /* NOT ENOUGH TABLE SPACE   */
         CLC   CURRPTR(4),TABPTR                                   1049
         BNL   @RF01049                                            1049
*   DO;                                                    /*@0001VLS*/
*     CALL IFCMSG(53,ADDR(MSGADDR));                       /*@0001VLS*/
         LA    @06,MSGADDR                                         1051
         ST    @06,@AFTEMPS+4                                      1051
         L     @15,ADIFCMSG(,R2)                                   1051
         LA    @01,@AL01051                                        1051
         BALR  @14,@15                                             1051
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         1052
*   END;                                                   /*@0001VLS*/
* CURRPTR = CURRPTR + ELEVEN;            /* PUT WITHIN BOUNDS        */
@RF01049 LA    @06,11                                              1054
         AL    @06,CURRPTR                                         1054
         ST    @06,CURRPTR                                         1054
* CALL IFCMSG(54,ADDR(MSGADDR));                           /*@0001VLS*/
         LA    @06,MSGADDR                                         1055
         ST    @06,@AFTEMPS+4                                      1055
         L     @15,ADIFCMSG(,R2)                                   1055
         LA    @01,@AL01055                                        1055
         BALR  @14,@15                                             1055
* CVD (RECCOUNT,TEMPAREA(1:8));          /* CONVERT TO DECIMAL       */
         LH    @06,RECCOUNT                                        1056
         CVD   @06,TEMPAREA                                        1056
* UNPK (NUMRECP,TEMPAREA(1:8));          /* PRINTABLE CHARACTERS     */
         UNPK  NUMRECP(7),TEMPAREA(8)                              1057
* NUMRECP(7) = NUMRECP(7) × FOXZERO;                       /*@0001VLS*/
         OI    NUMRECP+6,X'F0'                                     1058
* I = 1;                                                   /*@0001VLS*/
         MVC   I(2),@CH00055                                       1059
* DO UNTIL (I > 6 × NUMRECP(I) ^= FOXZERO);                /*@0001VLS*/
@DL01060 DS    0H                                                  1061
*   NUMRECP(I) = BLANK;                  /* SET LEADING ZERO TO BLANK*/
         LH    @06,I                                               1061
         LA    @03,NUMRECP-1(@06)                                  1061
         MVI   0(@03),C' '                                         1061
*   I = I + 1;                                             /*@0001VLS*/
         LA    @06,1(,@06)                                         1062
         STH   @06,I                                               1062
* END;                                                     /*@0001VLS*/
@DE01060 LH    @06,I                                               1063
         C     @06,@CF00080                                        1063
         BH    @DC01060                                            1063
         LA    @03,NUMRECP-1(@06)                                  1063
         CLI   0(@03),X'F0'                                        1063
         BE    @DL01060                                            1063
@DC01060 DS    0H                                                  1064
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         1064
* FREESIZE = (CURRPTR - TABPTR);         /* UNUSED SPACE     @0001VLS*/
         L     @06,TABPTR                                          1065
         L     @03,CURRPTR                                         1065
         SLR   @03,@06                                             1065
         ST    @03,FREESIZE                                        1065
* IF FREESIZE > EIGHT THEN               /* OUTPUT MESSAGE   @0001VLS*/
         C     @03,@CF00066                                        1066
         BNH   @RF01066                                            1066
*   DO;                                                    /*@0001VLS*/
*     FREESIZE = FREESIZE & 'FFFFF8'X;   /* DOUBLE WORD AMOUNT       */
         N     @03,@CF01376                                        1068
         ST    @03,FREESIZE                                        1068
*     RESPECIFY (R0,R1) RESTRICTED;                        /*@0001VLS*/
*     R0 = FREESIZE;                                       /*@0001VLS*/
         LR    R0,@03                                              1070
*     R1 = TABPTR;                                         /*@0001VLS*/
         LR    R1,@06                                              1071
*     GEN(FREEMAIN R,LV=(R0),A=(R1));                      /*@0001VLS*/
         FREEMAIN R,LV=(R0),A=(R1)
*     RESPECIFY (R0,R1) UNRESTRICTED;                      /*@0001VLS*/
*   END;                                                   /*@0001VLS*/
* TABPTR = CURRPTR;                      /* SAVE ADDRESS OF NEW TABLE*/
@RF01066 L     @06,CURRPTR                                         1075
         ST    @06,TABPTR                                          1075
* SORTNUM = NUMENT;                      /* STORE THE NUMBER OF RCDS */
         L     @03,NUMENT                                          1076
         ST    @03,SORTNUM(,R2)                                    1076
* SORTADR = TABPTR;                      /* LOCATION OF SORT TABLE   */
         ST    @06,SORTADR(,R2)                                    1077
* IF PHIST = ON THEN                     /* HISTORY INPUT    @0001VLS*/
         TM    PHIST(R2),B'00100000'                               1078
         BNO   @RF01078                                            1078
*   DO;                                                    /*@0001VLS*/
*     /*                                                     @0001VLS*/
*     /* INPUT DATA SETS MUST BE CLOSED IF HISTORY IS INPUT  @0001VLS*/
*     /*                                                     @0001VLS*/
*     CLOSEIO = CLOSEIO && CLOSEIO;                        /*@0001VLS*/
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           1080
*     IF PLOGREC = ON THEN                                         1081
         TM    PLOGREC(R2),B'00000010'                             1081
         BNO   @RF01081                                            1081
*       CSERLOG = ON;                                      /*@0001VLS*/
         OI    CSERLOG(R2),B'00100000'                             1082
*     CDRCTWRK = ON;                                       /*@0001VLS*/
@RF01081 OI    CDRCTWRK(R2),B'00000010'                            1083
*     CALL IOHND (IOCLOSE);                                /*@0001VLS*/
         L     @15,ADIOHND(,R2)                                    1084
         LA    @01,@AL01084                                        1084
         BALR  @14,@15                                             1084
*   END;                                                   /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00030 DS    0H                                                  1086
@EF00030 DS    0H                                                  1086
@ER00030 LM    @14,@12,@SA00030                                    1086
         BR    @14                                                 1086
@PB00030 DS    0H                                                  1087
*/*                                                          @0001VLS*/
*/* INITIALLY THE ADDRESS OF THE PARAMETER LIST IS SAVED.  NEXT AN    *
*/* AREA OF CORE IS GOTTEN FOR THE CONTROL TABLE.            @0001VLS*/
*/*                                                          @0001VLS*/
*  SAVEPARM = R2;                     /* SAVE ADDR TO PARM TABLE     */
         ST    R2,SAVEPARM                                         1087
*  RESPECIFY (R12,R15) RESTRICTED;                         /*@0001VLS*/
*  IF DEBUG4 = ON THEN                /* DUMP PGM NAMES AND DATES    */
         TM    DEBUG4(R2),B'00001000'                              1089
         BNO   @RF01089                                            1089
*    DO R15 = R12 - 27;                                    /*@0001VLS*/
         LR    R15,R12                                             1090
         SL    R15,@CF01377                                        1090
*      GEN(MVC  MSGADDR(16),0(R15));                       /*@0001VLS*/
         MVC  MSGADDR(16),0(R15)
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         1092
*    END;                                                  /*@0001VLS*/
*  RESPECIFY (R0) RESTRICTED;                              /*@0001VLS*/
@RF01089 DS    0H                                                  1095
*  R0 = TABSIZE / FOUR;               /* GET SIZE FOR TABLE  @0001VLS*/
         L     R0,TABSIZE(,R2)                                     1095
         SRDA  R0,32                                               1095
         D     R0,@CF00064                                         1095
         LR    R0,@01                                              1095
*  GEN(GETMAIN EC,LV=(0),A=TABPTR GET SPACE FOR TABLE);    /*@0001VLS*/
         GETMAIN EC,LV=(0),A=TABPTR GET SPACE FOR TABLE
*  RETCODE = R15;                                          /*@0001VLS*/
         ST    R15,RETCODE                                         1097
*  RESPECIFY (R0,R12,R15) UNRESTRICTED;                    /*@0001VLS*/
*  IF RETCODE = ZERO THEN             /* IF GOOD RET CODE, CONTINUE  */
         L     @06,RETCODE                                         1099
         LTR   @06,@06                                             1099
         BNZ   @RF01099                                            1099
*    DO;                                                   /*@0001VLS*/
*      PACK(TEMPAREA(1:8),RDTHRSH);   /* CONVERT THE THRESHOLD VALUE */
         PACK  TEMPAREA(8),RDTHRSH(3,R2)                           1101
*      CVB(CURRPTR,TEMPAREA(1:8));    /* TO A VALUE SIMILAR TO THAT  */
         CVB   @06,TEMPAREA                                        1102
         ST    @06,CURRPTR                                         1102
*      READS = CURRPTR;               /* IN THE RECORD       @0001VLS*/
         STC   @06,READS                                           1103
*      PACK(TEMPAREA(1:8),WRTHRSH);   /* CONVERT THE THRESHOLD VALUE */
         PACK  TEMPAREA(8),WRTHRSH(3,R2)                           1104
*      CVB(CURRPTR,TEMPAREA(1:8));    /* TO A VALUE SIMILAR TO THAT  */
         CVB   @06,TEMPAREA                                        1105
         ST    @06,CURRPTR                                         1105
*      WRITES = CURRPTR;              /* IN THE RECORD       @0001VLS*/
         STC   @06,WRITES                                          1106
*      CURRPTR = TABPTR + (TABSIZE / FOUR) - 2;            /*@0001VLS*/
         L     @00,TABSIZE(,R2)                                    1107
         SRDA  @00,32                                              1107
         D     @00,@CF00064                                        1107
         AL    @01,TABPTR                                          1107
         BCTR  @01,0                                               1107
         BCTR  @01,0                                               1107
         ST    @01,CURRPTR                                         1107
*      EOTABLE = EOT;                 /* PUT IN END OF TABLE INDICAT */
         MVC   EOTABLE(2,@01),@CB00261                             1108
*      CURRPTR = CURRPTR - ELEVEN;                         /*@0001VLS*/
         SL    @01,@CF00034                                        1109
         ST    @01,CURRPTR                                         1109
*      RESPECIFY (R15) RESTRICTED;                         /*@0001VLS*/
*      CALL IOHND(READSEQ);           /* GET AN INPUT RECORD @0001VLS*/
         L     @15,ADIOHND(,R2)                                    1111
         LA    @01,@AL01111                                        1111
         BALR  @14,@15                                             1111
*      RETCODE = R15;                                      /*@0001VLS*/
         ST    R15,RETCODE                                         1112
*      RESPECIFY (R15) UNRESTRICTED;                       /*@0001VLS*/
*      DO WHILE (CURRPTR >= TABPTR & RETCODE = ZERO);      /*@0001VLS*/
         B     @DE01114                                            1114
@DL01114 DS    0H                                                  1115
*        CALL FILTER;                                      /*@0001VLS*/
         BAL   @14,FILTER                                          1115
*        IF VALIDCUA = ON & VALIDVOL = ON & VALIDCPU = ON &        1116
*          VALIDSER = ON THEN                                      1116
         TM    VALIDCUA,B'01100000'                                1116
         BNO   @RF01116                                            1116
         TM    VALIDCPU,B'00000011'                                1116
         BNO   @RF01116                                            1116
*          CALL TABENT;                      /* MAKE A TABLE ENTRY   */
         BAL   @14,TABENT                                          1117
*        IF RETCODE = ZERO THEN                                    1118
@RF01116 L     @06,RETCODE                                         1118
         LTR   @06,@06                                             1118
         BNZ   @RF01118                                            1118
*          DO;                                             /*@0001VLS*/
*            RESPECIFY (R15) RESTRICTED;                   /*@0001VLS*/
*            CALL IOHND (READSEQ);            /* GET ANOTHER RECORD  */
         L     @15,ADIOHND(,R2)                                    1121
         LA    @01,@AL01121                                        1121
         BALR  @14,@15                                             1121
*            RETCODE = R15;                                /*@0001VLS*/
         ST    R15,RETCODE                                         1122
*            RESPECIFY (R15) UNRESTRICTED;                 /*@0001VLS*/
*          END;                                            /*@0001VLS*/
*      END;                                                /*@0001VLS*/
@RF01118 DS    0H                                                  1125
@DE01114 CLC   CURRPTR(4),TABPTR                                   1125
         BL    @DC01114                                            1125
         L     @06,RETCODE                                         1125
         LTR   @06,@06                                             1125
         BZ    @DL01114                                            1125
@DC01114 DS    0H                                                  1126
*      CALL ENDOFILE;                                      /*@0001VLS*/
         BAL   @14,ENDOFILE                                        1126
*      /*                                                    @0001VLS*/
*      /* WHEN END OF FILE HAS BEEN REACHED OR THE CONTROL TABLE IS  */
*      /* FULL, THE ENTRIES ARE SORTED FOR PROCESSING.  THE COUNT OF */
*      /* RECORDS AND ADDRESS OF THE FIRST ENTRY IS SAVED FOR SECOND */
*      /* PASS.                                              @0001VLS*/
*      /*                                                    @0001VLS*/
*      IF RECCOUNT ^= ZERO THEN       /* ARE THERE ANY VALID RECORDS */
         LH    @06,RECCOUNT                                        1127
         LTR   @06,@06                                             1127
         BZ    @RF01127                                            1127
*        DO;                                               /*@0001VLS*/
*          IF DEBUG16 = ON THEN       /* DO THEY WANT THE DEBUG CTS  */
         TM    DEBUG16(R2),B'10000000'                             1129
         BNO   @RF01129                                            1129
*            CALL BUGDATA;            /* GO PRINT THE COUNTS @0001VLS*/
         BAL   @14,BUGDATA                                         1130
*          IF NUMENT > ONE THEN                                    1131
@RF01129 L     @06,NUMENT                                          1131
         C     @06,@CF00055                                        1131
         BNH   @RF01131                                            1131
*            CALL SORT;               /* SORT FOR CUA        @0001VLS*/
         BAL   @14,SORT                                            1132
*          IF DEBUG11 = ON THEN       /* ABEND REQUESTED?    @0001VLS*/
@RF01131 TM    DEBUG11(R2),B'00010000'                             1133
         BNO   @RF01133                                            1133
*            GEN (ABEND 520,DUMP);                         /*@0001VLS*/
         ABEND 520,DUMP
*          CALL PRINTCUA;             /* OUTPUT THE CUA STATISTICS   */
@RF01133 BAL   @14,PRINTCUA                                        1135
*          SORTFLG = ON;                                   /*@0001VLS*/
         OI    SORTFLG,B'10000000'                                 1136
*        DEBUG27 = OFF;                                    /*@0001VLS*/
         NI    DEBUG27(R2),B'11101111'                             1137
*          CURRPTR = TABPTR;                               /*@0001VLS*/
         L     @06,TABPTR                                          1138
         ST    @06,CURRPTR                                         1138
*          IF NUMENT > ONE THEN                                    1139
         L     @06,NUMENT                                          1139
         C     @06,@CF00055                                        1139
         BNH   @RF01139                                            1139
*            CALL SORT;               /* SORT FOR VOLUME ID  @0001VLS*/
         BAL   @14,SORT                                            1140
*          CALL OUTVOLID;             /* OUTPUT THE VOLUME SECTION   */
@RF01139 BAL   @14,OUTVOLID                                        1141
*        END;                                              /*@0001VLS*/
*    END;                                                  /*@0001VLS*/
*  ELSE                                                            1144
*    DO;                                                   /*@0001VLS*/
         B     @RC01099                                            1144
@RF01099 DS    0H                                                  1145
*      CALL IFCMSG(55,ADDR(MSGADDR)); /* MSG FOR GETMAIN FAIL        */
         LA    @06,MSGADDR                                         1145
         ST    @06,@AFTEMPS+8                                      1145
         L     @15,ADIFCMSG(,R2)                                   1145
         LA    @01,@AL01145                                        1145
         BALR  @14,@15                                             1145
*      CALL PRINTIT;                  /* PRINT THE ERROR OUT @0001VLS*/
         BAL   @14,PRINTIT                                         1146
*    END;                                                  /*@0001VLS*/
*  IF DEBUG12 = ON THEN               /* ABEND REQUESTED?    @0001VLS*/
@RC01099 TM    DEBUG12(R2),B'00001000'                             1148
         BNO   @RF01148                                            1148
*    GEN(ABEND 540,DUMP);                                  /*@0001VLS*/
         ABEND 540,DUMP
*  RETURN;                                                 /*@0001VLS*/
@EL00001 L     @13,4(,@13)                                         1150
@EF00001 DS    0H                                                  1150
@ER00001 L     @14,12(,@13)                                        1150
         LM    @00,@12,20(@13)                                     1150
         BR    @14                                                 1150
* END                                                      /*@0001VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 1151
         B     @EL00001                                            1151
@DATA    DS    0H
@CH00085 DC    H'9'
@CH01401 DC    H'48'
         DS    0F
@AL00185 DC    A(TEMPAREA+1)           LIST WITH   3 ARGUMENT(S)
         DC    A(CUASH2C)
@AL00651 DC    A(@CF00055)             LIST WITH   1 ARGUMENT(S)
@AL00289 DC    A(PCCW)                 LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00066)
@AL00290 DC    A(PCSW)                 LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00064)
@AL00335 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00583 DC    A(TEMPAREA)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00080)
@AL00339 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00586 DC    A(TEMPAREA)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00066)
@AL00368 DC    A(I)                    LIST WITH   2 ARGUMENT(S)
         DC    A(WRTGVRC)
@AL00370 DC    A(I)                    LIST WITH   2 ARGUMENT(S)
         DC    A(ERLYBOR)
@AL00372 DC    A(I)                    LIST WITH   2 ARGUMENT(S)
         DC    A(OVELCHG)
@AL00378 DC    A(I)                    LIST WITH   2 ARGUMENT(S)
         DC    A(SKEWERR)
@AL00379 DC    A(MCPU)                 LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00074)
@AL00380 DC    A(SERCPU)               LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00076)
@AL00493 DC    A(TEMPAREA+18)          LIST WITH   3 ARGUMENT(S)
@AL00266 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00330 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00592 DC    A(TEMPAREA)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00074)
@AL00528 DC    A(SYSRDS)               LIST WITH   3 ARGUMENT(S)
         DC    A(SYSSIOS)
         DC    A(READPERC)
@AL00529 DC    A(SYSRTS)               LIST WITH   3 ARGUMENT(S)
         DC    A(SYSSIOS)
         DC    A(RITEPERC)
@AL00530 DC    A(SYSSIOS)              LIST WITH   2 ARGUMENT(S)
         DC    A(SUMSIOS)
@AL00531 DC    A(SYSMNTS)              LIST WITH   2 ARGUMENT(S)
         DC    A(SUMMNTS)
@AL00532 DC    A(SYSRDS)               LIST WITH   2 ARGUMENT(S)
         DC    A(SUMREAD)
@AL00533 DC    A(SYSRTS)               LIST WITH   2 ARGUMENT(S)
         DC    A(SUMWRITE)
@AL00548 DC    A(LVOLDATE)             LIST WITH   3 ARGUMENT(S)
         DC    A(TEMPAREA)
         DC    A(@CF00076)
@AL00550 DC    A(HVOLDATE)             LIST WITH   3 ARGUMENT(S)
@AL00194 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00196 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00212 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00214 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00497 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00499 DC    A(TEMPAREA)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00076)
@AL00565 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00722 DC    A(@CF00080+2)           LIST WITH   1 ARGUMENT(S)
@AL00627 DC    A(VCPUMOD)              LIST WITH   2 ARGUMENT(S)
@AL00656 DC    A(@CF00074)             LIST WITH   1 ARGUMENT(S)
@AL00628 DC    A(VCPUSER)              LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00076)
@AL00664 DC    A(@CF00036+2)           LIST WITH   1 ARGUMENT(S)
@AL00794 DC    A(@CF01299)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00802 DC    A(TOTREC)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG10)
@AL00805 DC    A(OBRCT)                LIST WITH   2 ARGUMENT(S)
         DC    A(BUG20)
@AL00808 DC    A(NUMSHORT)             LIST WITH   2 ARGUMENT(S)
         DC    A(BUG30)
@AL00811 DC    A(BADDEV)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG31)
@AL00814 DC    A(BADDAY)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG40)
@AL00817 DC    A(BADTIME)              LIST WITH   2 ARGUMENT(S)
         DC    A(BUG50)
@AL00820 DC    A(DROP3RD)              LIST WITH   2 ARGUMENT(S)
         DC    A(BUG60)
@AL00823 DC    A(BADCPU)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG70)
@AL00826 DC    A(BADCUA)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG80)
@AL00829 DC    A(BADVOL)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG90)
@AL00832 DC    A(BADSER)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG100)
@AL00835 DC    A(SHAREMOD)             LIST WITH   2 ARGUMENT(S)
         DC    A(BUG110)
@AL00838 DC    A(SHARECU)              LIST WITH   2 ARGUMENT(S)
         DC    A(BUG120)
@AL00841 DC    A(EXCTHRES)             LIST WITH   2 ARGUMENT(S)
         DC    A(BUG130)
@AL00844 DC    A(EXCTHRES+4)           LIST WITH   2 ARGUMENT(S)
         DC    A(BUG140)
@AL00884 DC    A(MSGADDR)              LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00034)
@AL00934 DC    A(@CF00074+2)           LIST WITH   1 ARGUMENT(S)
@AL01051 DC    A(@CF01299)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL01055 DC    A(@CF01375)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL01084 DC    A(@CF00082+2)           LIST WITH   1 ARGUMENT(S)
@AL01111 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01121 DC    A(@CF00076+2)           LIST WITH   1 ARGUMENT(S)
@AL01145 DC    A(@CF01380)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+8)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00021 DS    15F
@SA00003 DS    15F
@SA00006 DS    15F
@SA00026 DS    15F
@PC00027 DS    3F
@SA00004 DS    15F
@SA00009 DS    15F
@SA00005 DS    15F
@SA00007 DS    15F
@SA00023 DS    15F
@PC00023 DS    2F
@SA00008 DS    15F
@SA00022 DS    15F
@PC00022 DS    2F
@SA00010 DS    15F
@SA00017 DS    15F
@SA00011 DS    15F
@SA00028 DS    15F
@PC00028 DS    3F
@PC00024 DS    2F
@PC00025 DS    2F
@SA00012 DS    15F
@SA00013 DS    15F
@SA00015 DS    15F
@SA00014 DS    15F
@PC00014 DS    1F
@SA00018 DS    15F
@SA00016 DS    15F
@SA00019 DS    15F
@SA00030 DS    15F
@AL00001 DS    3A
@TF00001 DS    F
@AFTEMPS DS    3F
         DS    0F
@CF00055 DC    F'1'
@CH00055 EQU   @CF00055+2
@CF00074 DC    F'2'
@CF00076 DC    F'3'
@CH00076 EQU   @CF00076+2
@CF00064 DC    F'4'
@CF00036 DC    F'5'
@CH00036 EQU   @CF00036+2
@CF00080 DC    F'6'
@CH00080 EQU   @CF00080+2
@CF00082 DC    F'7'
@CF00066 DC    F'8'
@CF00034 DC    F'11'
@CH00034 EQU   @CF00034+2
@CF00033 DC    F'12'
@CF00088 DC    F'16'
@CF00227 DC    F'24'
@CF01377 DC    F'27'
@CF01299 DC    F'53'
@CF01375 DC    F'54'
@CF01380 DC    F'55'
@CF01366 DC    F'10000'
@CF01365 DC    F'20000000'
@CF01417 DC    F'-32'
@CF01418 DC    F'-28'
@CF01421 DC    F'-24'
@CF01419 DC    F'-20'
@CF01422 DC    F'-16'
@CF01420 DC    F'-12'
@CF01430 DC    F'-11'
@CF01429 DC    F'-9'
@CF01423 DC    F'-8'
@CF01424 DC    F'-6'
@CF01425 DC    F'-4'
@CF01435 DC    F'-3'
@CF01376 DC    XL4'FFFFF8'
         DS    0D
MYLINCT  DC    F'0'
SAVEPARM DS    F
CURRPTR  DS    A
TABPTR   DS    A
RETCODE  DS    F
FREESIZE DC    F'8192'
TOTREC   DC    F'0'
OBRCT    DC    F'0'
NUMSHORT DC    F'0'
BADDEV   DC    F'0'
BADDAY   DC    F'0'
BADTIME  DC    F'0'
DROP3RD  DC    F'0'
BADCPU   DC    F'0'
BADCUA   DC    F'0'
BADVOL   DC    F'0'
BADSER   DC    F'0'
BADREC   DC    F'0'
SHAREMOD DC    F'0'
SHARECU  DC    F'0'
Z        DC    F'0'
L        DC    F'0'
P        DC    F'0'
X        DC    F'0'
TOTALPTR DC    A(0)
SUMPTR   DC    A(0)
NUMENT   DC    F'0'
SYSSIOS  DS    F
SYSRDS   DS    F
SYSRTS   DS    F
SYSMNTS  DS    F
SRTCONT  DC    F'0'
CUAINDEX DS    F
LHDATPTR DC    A(0)
DATEPTR  DC    A(0)
RECCOUNT DC    H'0'
I        DS    H
@TS00001 DS    CL1
@CC00500 DC    C'TOTALS'
@CC00483 DC    C' N/A '
@CC00502 DC    C'100+ '
@CC00477 DC    C' 800'
@CC00479 DC    C'1600'
@CC00481 DC    C'6250'
@CB00208 DC    X'0000'
@CB00261 DC    X'FFFF'
@CB00463 DC    X'0FFF'
@CB00465 DC    X'000F'
@CB00498 DC    X'8003'
         DS    CL1
DBLWORD  DS    CL8
WORK     DS    CL8
RECCPU   DC    CL3' '
RECCUA   DC    CL2' '
READS    DS    CL1
WRITES   DS    CL1
SWITCH   DC    X'8000'
         ORG   SWITCH
SORTFLG  DS    BL1
SWITCH1  EQU   SWITCH+0
FOUND    EQU   SWITCH+0
HEAD1    EQU   SWITCH+0
HEAD2    EQU   SWITCH+0
HEAD3    EQU   SWITCH+0
VALIDSER EQU   SWITCH+0
VALIDCPU EQU   SWITCH+0
VALIDSHR DS    BL1
VALIDCUA EQU   SWITCH+1
VALIDVOL EQU   SWITCH+1
         ORG   SWITCH+2
         DS    CL7
TEMPAREA DS    CL20
OLDCPUCU DS    CL5
@NM00012 DS    CL10
         ORG   @NM00012
SHR74XXX DS    CL5
         ORG   SHR74XXX
SHR74CUA DS    BL2
SHR74CPU DS    CL3
         ORG   @NM00012+5
SHR74XXD DS    CL5
         ORG   SHR74XXD
@NM00013 DS    CL2
         ORG   @NM00013
SHR74XDD DS    BL1
@NM00014 EQU   @NM00013+0
SHR74CUX DS    BL1
         ORG   SHR74XXD+2
@NM00015 DS    CL3
         ORG   @NM00012+10
HVOLDATE DC    X'000000'
LVOLDATE DC    X'FFFFFF'
CHARS    DC    CL16'0123456789ABCDEF'
BUG16    DC    CL31'DEBUG16 - INFORMATIONAL COUNTS'
BUG10    DC    CL26'       TOTAL RECORDS FOUND'
BUG20    DC    CL24'       OBR RECORDS FOUND'
BUG30    DC    CL36'       SHORT RECORDS FOUND && DROPPED'
BUG31    DC    CL30'       DROPPED NOT DEVICE 34XX'
BUG40    DC    CL37'       DROPPED, OUT OF THE DATE RANGE'
BUG50    DC    CL37'       DROPPED, OUT OF THE TIME RANGE'
BUG60    DC    CL33'       DROPPED DUE TO THIRD SHIFT'
BUG70    DC    CL35'       DROPPED DUE TO CPU SELECTION'
BUG80    DC    CL35'       DROPPED DUE TO CUA SELECTION'
BUG90    DC    CL37'       DROPPED DUE TO VOLID SELECTION'
BUG8     DC    CL33'DEBUG8 HEX DUMP OF THE SORT TABLE'
BUG100   DC    CL45'       DROPPED DUE TO DEVICE SERIAL SELECTION'
BUG110   DC    CL66'       CUAS AT THE CONTROLLER LEVEL MODIFIED DUE TOC
                SHARE CARDS   '
BUG120   DC    CL56'       CUAS AT THE CUA LEVEL MODIFIED DUE TO SHARE C
               CARDS'
BUG130   DC    CL33'       RECORDS EXCEEDED THRESHOLD'
BUG140   DC    CL30'       RECORDS WITH PERM ERROR'
CUAPH1   DC    CL25'PERMANENT ERROR SUMMARY'
CUAPH2   DC    CL11'...SENSE...'
CUAPH3   DC    CL42'1  1  1  1  1  1  1  1  1  1  2  2  2  2'
CUAPH4   DS    CL120
         ORG   CUAPH4
@NM00016 DC    CL40'DEV  SERIAL ERR  VOLID     LAST CCW     '
@NM00017 DC    CL40'CSW44-47  0  1  2  3  4  5  6  7  8  9  '
@NM00018 DC    CL40'0  1  2  3  4  5  6  7  8  9  0  1  2  3'
         ORG   CUAPH4+120
CUASH1   DC    CL40'XXXXX 34XX/3803 SUBSYSTEM SUMMARY XXXXX'
CUASH2   DC    CL40'XXXXX      PRIMARY CUA - NNX      XXXXX'
CUASH3   DS    CL61
         ORG   CUASH3
@NM00019 DC    CL32'CUA STATISTICS - CUAS EXCEEDING '
CUASH3R  DC    CL3' '
@NM00020 DC    CL13' TEMP RDS OR '
CUASH3W  DC    CL3' '
@NM00021 DC    CL10' TEMP WRTS'
         ORG   CUASH3+61
CUASH4   DS    CL130
         ORG   CUASH4
@NM00022 DC    CL10' '
@NM00023 DC    CL50'TU    DATE   VOLUME     TIME      --TEMP--   SIO'
@NM00024 DC    CL50'DEN- NRZI  R/W WR TG  LRC  CRC  ECC  SKEW ERLY VEL'
@NM00025 DC    CL20'  ----CPU----  HDR'
         ORG   CUASH4+130
CUASH5   DS    CL129
         ORG   CUASH5
@NM00026 DC    CL2' '
@NM00027 DC    CL52' CUA  SERIAL DAY YR  SERIAL  HH MM SS.TH   RDS WRTSC
               '
@NM00028 DC    CL52'COUNT SITY NOISE VRC  VRC   MTE  EDC  ENV  ERR  BORC
               '
@NM00029 DC    CL23' CHG   ID  SERIAL  SER'
         ORG   CUASH5+129
CUASH6   DS    CL42
         ORG   CUASH6
@NM00030 DC    CL28'NO CUAS EXCEEDED THRESHOLD: '
CUASH6D1 DC    CL5' '
@NM00031 DC    CL4' TO '
CUASH6D2 DC    CL5' '
         ORG   CUASH6+42
SPACER   DS    CL132
         ORG   SPACER
@NM00032 DC    132CL1'X'
         ORG   SPACER+132
VOLHEAD1 DS    CL104
         ORG   VOLHEAD1
@NM00033 DC    CL30'  VOLUME STATISTICS - VOLUMES'
@NM00034 DC    CL10'EXCEEDING'
VOLH1R   DC    CL3' '
@NM00035 DC    CL20' TEMPORARY READS OR'
VOLH1W   DC    CL3' '
@NM00036 DC    CL38' TEMPORARY WRITES OR PERMANENT ERRORS'
         ORG   VOLHEAD1+104
NOVOLS   DS    CL46
         ORG   NOVOLS
@NM00037 DC    CL32'NO VOLUMES EXCEEDED THRESHOLD:'
VOLH5L   DC    CL5' '
@NM00038 DC    CL4' TO '
VOLH5H   DC    CL5' '
         ORG   NOVOLS+46
VOLH2    DS    CL132
         ORG   VOLH2
@NM00039 DC    CL36'VOLUME  DATE      TIME'
@NM00040 DC    CL36'TU     RD/ --PERM--  --TEMP--  CLNER'
@NM00041 DC    CL36' ERASE  SIO  BLOCK  PROGRAM  ----CPU'
@NM00042 DC    CL24'----   MOD   DEN-   HDR'
         ORG   VOLH2+132
VOLH3    DS    CL132
         ORG   VOLH3
@NM00043 DC    CL36'SERIAL DAY YR  HH MM SS TH   CUA   S'
@NM00044 DC    CL36'ERIAL  WRT  RDS WRTS  RDS WRTS ACTNS'
@NM00045 DC    CL36' GAPS  COUNT LENGTH   ID      ID  SE'
@NM00046 DC    CL24'RIAL  NUMBER SITY   SER'
         ORG   VOLH3+132
CUATH1   DC    CL44'34XX/3803 SUBSYSTEM TEMPORARY ERROR SUMMARY'
CUATH2   DS    CL82
         ORG   CUATH2
@NM00047 DC    CL50' ERRORS/100K'
@NM00048 DC    CL16'READ'
@NM00049 DC    CL13'WRITE'
@NM00050 DC    CL3'ECC'
         ORG   CUATH2+82
CUATH3   DS    CL108
         ORG   CUATH3
@NM00051 DC    CL34'SIOS           DATE      TOTAL'
@NM00052 DC    CL41'TOTAL    STATISTICS       STATISTICS'
@NM00053 DC    CL33'VRC   STRD  PART  OVER  VEL   IBG'
         ORG   CUATH3+108
CUATH4   DS    CL119
         ORG   CUATH4
@NM00054 DC    CL1' '
@NM00055 DC    CL45'CUA   READ  WRITE  -FROM---TO--    SIOS   MOU'
@NM00056 DC    CL45'NTS. ERRORS  CLNRAC . ERRORS  ERSGAP . ENV'
@NM00057 DC    CL28'CHK   RECK  RUN   CHG   DET'
         ORG   CUATH4+119
CUAPH5   DS    CL47
         ORG   CUAPH5
@NM00058 DC    CL33'NO PERMANENT ERRORS ENCOUNTERED:'
CUAPH5D1 DC    CL5' '
@NM00059 DC    CL4' TO'
CUAPH5D2 DC    CL5' '
         ORG   CUAPH5+47
NOTOTALS DC    CL32'NO TEMPORARY ERRORS ENCOUNTERED'
MESSAGE  DS    CL134
         ORG   MESSAGE
MSGDS    DC    CL1'1'
MSGCC    DC    CL1' '
MSGADDR  DC    CL132' '
         ORG   MSGADDR
@NM00060 DS    CL8
NUMRECP  DS    CL7
         ORG   MESSAGE+134
CHAIN    DS    CL5
         ORG   CHAIN
CHAINCPU DS    CL3
CHAINCUX DS    CL2
         ORG   CHAIN+5
SUPERZAP DC    3CL10'SUPERZAP'
EXCTHRES DC    F'0'
         DS    1XL4
MODNO    DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'3'
         DC    CL1'5'
         DC    CL1'7'
         DC    5CL1' '
         DC    CL1'4'
         DC    CL1'6'
         DC    CL1'8'
         DC    2CL1' '
ERRTABLE DC    CL34'PW  PERMANENT WRITE'
         ORG   ERRTABLE+0
ERRTABC  DS    CL2
         ORG   ERRTABLE+34
         DC    CL34'PR  PERMANENT READ'
         ORG   ERRTABLE+68
         DC    CL34'PF  CAUSE UNKNOWN'
         ORG   ERRTABLE+102
         DC    CL34'EC  EQUIPMENT CHECK, CAUSE UNKNOWN'
         ORG   ERRTABLE+136
         DC    CL34'EE  ERASE HEAD'
         ORG   ERRTABLE+170
         DC    CL34'EB  TAPE BOTTOM, LEFT OR RIGHT'
         ORG   ERRTABLE+204
         DC    CL34'EL  LOAD FAILURE'
         ORG   ERRTABLE+238
         DC    CL34'EP  AIR BEARING PRESSURE'
         ORG   ERRTABLE+272
         DC    CL34'ET  TACH START FAILURE'
         ORG   ERRTABLE+306
         DC    CL34'EV  VELOCITY CHECK'
         ORG   ERRTABLE+340
         DC    CL34'ER  RESET KEY'
         ORG   ERRTABLE+374
PATCH    DC    20H'0'
IFCTHRSH CSECT
         DC    S(SUPERZAP)
IFCTHRSH CSECT
         DC    S(PATCH)
IFCTHRSH CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R4       EQU   @04
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
R12      EQU   @12
R15      EQU   @15
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R14      EQU   @14
R3       EQU   @03
R5       EQU   @05
IOHND    EQU   0
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
SHIFT3RD EQU   SWITCHES+1
DEBUG    EQU   PARM+4
DEBUG4   EQU   DEBUG
DEBUG8   EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUG16  EQU   DEBUG+2
DEBUG27  EQU   DEBUG+3
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PHIST    EQU   MISC
PRINTES  EQU   MISC
PLOGREC  EQU   MISC
PASSFLAG EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
CSERLOG  EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
RDTHRSH  EQU   PARM+66
WRTHRSH  EQU   PARM+69
@NM00007 EQU   PARM+75
TABSIZE  EQU   PARM+80
SORTNUM  EQU   PARM+84
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
LINECT   EQU   PARM+120
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHARENUM EQU   SHARE
SHAREIO  EQU   SHARE+2
SHRCUCPU EQU   SHAREIO
SHARECUA EQU   SHRCUCPU
SHAREDX  EQU   SHARECUA
SHARECUB EQU   SHAREIO+5
SHARSERB EQU   SHAREIO+7
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUANUM   EQU   CUA
CUAVAL   EQU   CUA+2
CUA1     EQU   CUAVAL
CUA2     EQU   CUAVAL+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
SERNUM   EQU   DEVSERAL
SERVAL   EQU   DEVSERAL+2
VOLUME   EQU   0
VOLNUM   EQU   VOLUME
VOLVAL   EQU   VOLUME+2
CPUS     EQU   0
CPUNUM   EQU   CPUS
CPUVAL   EQU   CPUS+2
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
CONTRTAB EQU   0
CONTRVOL EQU   CONTRTAB
SORTCPUC EQU   CONTRVOL
CONTRCUA EQU   SORTCPUC
EOTABLE  EQU   CONTRCUA
CPU      EQU   SORTCPUC+2
TYPE     EQU   CONTRVOL+5
TABCCHHR EQU   CONTRTAB+6
SORTTAB  EQU   0
BUFFER   EQU   0
RECTYP   EQU   BUFFER
SWITCHE  EQU   BUFFER+2
SW2      EQU   SWITCHE+1
EOD      EQU   SW2
SHORT    EQU   SW2
DISMNT   EQU   SW2
DATE     EQU   BUFFER+8
TIME     EQU   BUFFER+12
CPUIDENT EQU   BUFFER+17
CPUSER   EQU   CPUIDENT
CPUMOD   EQU   CPUIDENT+3
JOBID    EQU   BUFFER+24
FAILCCW  EQU   BUFFER+32
CSW      EQU   BUFFER+44
CSW34XX  EQU   CSW
SECUA    EQU   BUFFER+49
SECUA2   EQU   SECUA+1
ODEVICE  EQU   BUFFER+52
DEV2     EQU   ODEVICE+2
OCUA     EQU   BUFFER+57
OCUA2    EQU   OCUA+1
SNSCNT   EQU   BUFFER+62
VOLID    EQU   BUFFER+64
BLKLENG  EQU   BUFFER+70
HDRSER   EQU   BUFFER+72
READTH   EQU   BUFFER+76
RITETH   EQU   BUFFER+77
RECSIOS  EQU   BUFFER+78
PERMRDS  EQU   BUFFER+80
PERMRTS  EQU   BUFFER+81
RECERASE EQU   BUFFER+84
RECLEAN  EQU   BUFFER+86
NOISE    EQU   BUFFER+89
RWVRC    EQU   BUFFER+90
MTELRCR  EQU   BUFFER+91
EDCCRC   EQU   BUFFER+92
RECVRC   EQU   BUFFER+93
RECOVER  EQU   BUFFER+94
CCOMVRC  EQU   BUFFER+95
@NM00141 EQU   BUFFER+96
RECSTRD  EQU   BUFFER+98
RECPART  EQU   BUFFER+99
RECIBG   EQU   BUFFER+100
EXPEARL  EQU   BUFFER+101
@NM00143 EQU   BUFFER+102
@NM00144 EQU   BUFFER+103
RECVEL   EQU   BUFFER+104
@NM00145 EQU   BUFFER+105
@NM00146 EQU   BUFFER+107
SENSE24  EQU   BUFFER+108
SENSE    EQU   SENSE24
SENSBIT3 EQU   SENSE
SENSBIT4 EQU   SENSE
SENSBIT5 EQU   SENSE
SENSBIT6 EQU   SENSE
SENSBIT7 EQU   SENSE
SUMAREA  EQU   0
NEXTCPU  EQU   SUMAREA
CPUCUX   EQU   SUMAREA+4
CUX      EQU   CPUCUX+3
SUMTEMP  EQU   SUMAREA+16
SIOS     EQU   SUMTEMP
READER   EQU   SUMTEMP+4
CLEANER  EQU   SUMTEMP+8
WRITER   EQU   SUMTEMP+12
ERASE    EQU   SUMTEMP+16
MOUNTS   EQU   SUMTEMP+20
VRC      EQU   SUMTEMP+24
STRDCHK  EQU   SUMTEMP+26
PARTRECK EQU   SUMTEMP+28
OVERRUNS EQU   SUMTEMP+30
VELCHGS  EQU   SUMTEMP+32
IBG      EQU   SUMTEMP+34
FDATE    EQU   SUMTEMP+36
TDATE    EQU   SUMTEMP+39
DATEAREA EQU   0
NEXTDATE EQU   DATEAREA
DATECC   EQU   DATEAREA+4
LOWDATE  EQU   DATEAREA+9
HIDATE   EQU   DATEAREA+12
TYPEENT  EQU   0
BWORD1   EQU   0
DADDR1   EQU   0
BWORD2   EQU   0
DADDR2   EQU   0
BWORD3   EQU   0
DADDR3   EQU   0
BINWORD  EQU   0
DECADDR  EQU   0
NEXTBYTE EQU   0
ADDNUM   EQU   0
LENNUM   EQU   0
DIVEND   EQU   0
DIVSOR   EQU   0
OUTLOC   EQU   0
WORKOVER EQU   WORK
SUMPTRC  EQU   SUMPTR
CUASH2C  EQU   CUASH2+25
@NM00061 EQU   MSGADDR
OUTCUA   EQU   @NM00061+3
TUSER    EQU   @NM00061+9
DAY      EQU   @NM00061+15
YEAR     EQU   @NM00061+19
OVOLUME  EQU   @NM00061+23
HH       EQU   @NM00061+31
MM       EQU   @NM00061+34
SS       EQU   @NM00061+37
POINT    EQU   @NM00061+39
TH       EQU   @NM00061+40
OREADS   EQU   @NM00061+43
WRTS     EQU   @NM00061+48
SIOCNT   EQU   @NM00061+54
DENSITY  EQU   @NM00061+60
NRZIN    EQU   @NM00061+65
ORWVRC   EQU   @NM00061+70
WRTGVRC  EQU   @NM00061+75
LRCMTE   EQU   @NM00061+80
CRCEDC   EQU   @NM00061+85
ECCENV   EQU   @NM00061+90
SKEWERR  EQU   @NM00061+96
ERLYBOR  EQU   @NM00061+101
OVELCHG  EQU   @NM00061+106
MCPU     EQU   @NM00061+112
SERCPU   EQU   @NM00061+117
HEADSER  EQU   @NM00061+124
@NM00078 EQU   MSGADDR
OUTDEV   EQU   @NM00078
OUTSER   EQU   @NM00078+6
OUTERR   EQU   @NM00078+12
PVOL     EQU   @NM00078+16
PCCW     EQU   @NM00078+23
PCSW     EQU   @NM00078+40
PSNS     EQU   @NM00078+48
PSNSB    EQU   PSNS+1
@NM00085 EQU   MSGADDR
VVOLUME  EQU   @NM00085
VDAY     EQU   @NM00085+7
VYEAR    EQU   @NM00085+11
VHH      EQU   @NM00085+15
VMM      EQU   @NM00085+18
VSS      EQU   @NM00085+21
VPOINT   EQU   @NM00085+23
VTH      EQU   @NM00085+24
VCUA     EQU   @NM00085+29
VTUSER   EQU   @NM00085+35
VRDWRT   EQU   @NM00085+44
VPRDS    EQU   @NM00085+46
VPRTS    EQU   @NM00085+51
VTRDS    EQU   @NM00085+56
VTRTS    EQU   @NM00085+61
VCLEAN   EQU   @NM00085+67
VERASE   EQU   @NM00085+73
VSIOS    EQU   @NM00085+79
VBLOCK   EQU   @NM00085+85
VPGMID   EQU   @NM00085+92
VCPUMOD  EQU   @NM00085+101
VCPUSER  EQU   @NM00085+106
VMODEL   EQU   @NM00085+114
VDENS    EQU   @NM00085+120
VHDRSER  EQU   @NM00085+127
@NM00105 EQU   MSGADDR
@NM00106 EQU   @NM00105
OUTCODE  EQU   @NM00106
@NM00108 EQU   MSGADDR
SUMT1    EQU   @NM00108
SUMCUA   EQU   SUMT1+1
READPERC EQU   @NM00108+7
RITEPERC EQU   @NM00108+14
SUMFDATE EQU   @NM00108+20
SUMTDATE EQU   @NM00108+27
SUMSIOS  EQU   @NM00108+34
SUMMNTS  EQU   @NM00108+43
SUMP1    EQU   @NM00108+49
SUMREAD  EQU   @NM00108+52
SUMCLEAN EQU   @NM00108+60
SUMP2    EQU   @NM00108+66
SUMWRITE EQU   @NM00108+69
SUMERASE EQU   @NM00108+77
SUMP3    EQU   @NM00108+83
SUMVRC   EQU   @NM00108+84
SUMSTRD  EQU   @NM00108+90
SUMPART  EQU   @NM00108+96
SUMOVER  EQU   @NM00108+102
SUMVEL   EQU   @NM00108+108
SUMIBG   EQU   @NM00108+114
OSER74XX EQU   SENSE24+15
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00127 EQU   @NM00108+113
@NM00126 EQU   @NM00108+107
@NM00125 EQU   @NM00108+101
@NM00124 EQU   @NM00108+95
@NM00123 EQU   @NM00108+89
@NM00122 EQU   @NM00108+82
@NM00121 EQU   @NM00108+74
@NM00120 EQU   @NM00108+67
@NM00119 EQU   @NM00108+65
@NM00118 EQU   @NM00108+57
@NM00117 EQU   @NM00108+50
@NM00116 EQU   @NM00108+48
@NM00115 EQU   @NM00108+42
@NM00114 EQU   @NM00108+32
@NM00113 EQU   @NM00108+25
@NM00112 EQU   @NM00108+19
@NM00111 EQU   @NM00108+12
@NM00110 EQU   @NM00108+6
@NM00109 EQU   SUMT1
@NM00107 EQU   @NM00106+34
@NM00104 EQU   @NM00085+125
@NM00103 EQU   @NM00085+119
@NM00102 EQU   @NM00085+112
@NM00101 EQU   @NM00085+105
@NM00100 EQU   @NM00085+100
@NM00099 EQU   @NM00085+90
@NM00098 EQU   @NM00085+84
@NM00097 EQU   @NM00085+78
@NM00096 EQU   @NM00085+72
@NM00095 EQU   @NM00085+66
@NM00094 EQU   @NM00085+45
@NM00093 EQU   @NM00085+40
@NM00092 EQU   @NM00085+32
@NM00091 EQU   @NM00085+26
@NM00090 EQU   @NM00085+20
@NM00089 EQU   @NM00085+17
@NM00088 EQU   @NM00085+13
@NM00087 EQU   @NM00085+10
@NM00086 EQU   @NM00085+6
@NM00084 EQU   PSNS
@NM00083 EQU   @NM00078+39
@NM00082 EQU   @NM00078+22
@NM00081 EQU   @NM00078+14
@NM00080 EQU   @NM00078+11
@NM00079 EQU   @NM00078+3
@NM00077 EQU   @NM00061+123
@NM00076 EQU   @NM00061+116
@NM00075 EQU   @NM00061+111
@NM00074 EQU   @NM00061+95
@NM00073 EQU   @NM00061+64
@NM00072 EQU   @NM00061+59
@NM00071 EQU   @NM00061+53
@NM00070 EQU   @NM00061+42
@NM00069 EQU   @NM00061+36
@NM00068 EQU   @NM00061+33
@NM00067 EQU   @NM00061+29
@NM00066 EQU   @NM00061+21
@NM00065 EQU   @NM00061+18
@NM00064 EQU   @NM00061+14
@NM00063 EQU   @NM00061+6
@NM00062 EQU   @NM00061
CPUMSER  EQU   CPUCUX
SENSBIT2 EQU   SENSE
SENSBIT1 EQU   SENSE
SENSBIT0 EQU   SENSE
ALUHRDER EQU   @NM00146
BUSOCHK  EQU   @NM00146
BACKWARD EQU   BUFFER+106
EXP3     EQU   @NM00145
EXP3A    EQU   @NM00145
VELCHNG  EQU   RECVEL
EXP2     EQU   RECVEL
VELRETRY EQU   @NM00144
SLWNDRD  EQU   @NM00144
SLBGRD   EQU   @NM00143
EARLNDRD EQU   @NM00143
EARLBGRD EQU   EXPEARL
EXP      EQU   EXPEARL
FEEDTHRU EQU   RECIBG
ORDROP   EQU   RECIBG
EXCPAMB  EQU   RECPART
PARTREC  EQU   RECPART
@NM00142 EQU   RECSTRD
WRTTMCHK EQU   RECSTRD
TRKINERR EQU   BUFFER+97
PARITY   EQU   @NM00141
MASKEXP  EQU   @NM00141
PEIDCHK  EQU   @NM00141
WRTTRVRC EQU   CCOMVRC
CCOMPARE EQU   CCOMVRC
SKEWCHK  EQU   RECOVER
OVERRUN  EQU   RECOVER
SPAR     EQU   BUFFER+88
@NM00140 EQU   BUFFER+83
NOISEBLK EQU   BUFFER+82
@NM00139 EQU   BUFFER+74
IORETRY  EQU   BUFFER+60
@NM00138 EQU   OCUA
@NM00137 EQU   BUFFER+56
@NM00136 EQU   ODEVICE
@NM00135 EQU   SECUA
@NM00134 EQU   BUFFER+48
@NM00133 EQU   BUFFER+40
@NM00132 EQU   BUFFER+22
CPUVER   EQU   BUFFER+16
@NM00131 EQU   BUFFER+4
@NM00130 EQU   SW2
@NM00129 EQU   SW2
@NM00128 EQU   SWITCHE
SYSREL   EQU   BUFFER+1
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+10
SHARSERA EQU   SHRCUCPU+2
SYSTEMP  EQU   SYSUM2+9
SYSPERM  EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
RECLNGTH EQU   CCHHRLNG+6
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SYSRETRN EQU   @NM00007
@NM00006 EQU   PARM+72
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00272 EQU   @RC00271
@RF00422 EQU   @EL00009
@RF00444 EQU   @EL00010
@RC00614 EQU   @RC00613
@RC00546 EQU   @EL00012
@RF00654 EQU   @EL00013
@RC00646 EQU   @EL00013
@RF00668 EQU   @EL00014
@RF00683 EQU   @EL00015
@RF00766 EQU   @EL00018
@RC00773 EQU   @EL00018
@RF00858 EQU   @RC00856
@RC00966 EQU   @EL00028
@RC00986 EQU   @RC00984
@RF01009 EQU   @EL00029
@RF01035 EQU   @EL00029
@RF01043 EQU   @EL00029
@RC01041 EQU   @EL00029
@RC01039 EQU   @EL00029
@RC01037 EQU   @EL00029
@PB00029 EQU   @PB00030
@RF01078 EQU   @EL00030
@RF01127 EQU   @RC01099
@RF01148 EQU   @EL00001
@RF00649 EQU   @RC00646
@PB00028 EQU   @PB00029
@RC00988 EQU   @RC00986
@PB00027 EQU   @PB00028
@RC00990 EQU   @RC00988
@PB00026 EQU   @PB00027
@RC00992 EQU   @RC00990
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IFCTHRSH,(C'PLS0947',0701,77316)

         TITLE 'IEFTB723 - SMF EXIT WRITE-TO-PROGRAMMER PROCESSOR      *
                        '
IEFTB723 CSECT ,                                                   0001
IEFYS    DS    0H                                                  0001
         ENTRY IEFYS
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IEFTB723  74.087'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @10,@01                                             0001
         USING @DATD,@10                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @15,@01,16(@13)                                     0001
         ST    @10,8(,@13)                                         0001
         LR    @13,@10                                             0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
*                                           TEXT (MAX 126 CHARS)     */
*                                                                  0014
* /************************** END OF WPL *****************************/
*WPLPTR=ADDR(WPLIST);                  /* ADDRESS OF WTP BUFFER TO BE
*                                         CONSTRUCTED                */
         LA    WPLPTR,WPLIST                                       0015
*WPLIST=WPLIST&&WPLIST;                /* ZERO OUT ENTIRE WTP BUFFER */
         XC    WPLIST(140),WPLIST                                  0016
*WPLMCSFA='1'B;                        /* INDICATE ROUTING AND     0017
*                                         DESCRIPTOR CODES PRESENT   */
         OI    WPLMCSFA(WPLPTR),B'10000000'                        0017
*WPLLGH=MSGLEN;                        /* SET WTP LENGTH (NOT      0018
*                                         INCLUDING LEN OF HEADER)   */
         LH    @03,MSGLEN(,LCTPTR)                                 0018
         STH   @03,WPLLGH(,WPLPTR)                                 0018
*IF WPLLGH>ZERO THEN                   /* TEXT TO BE PROCESSED       */
         LTR   @03,@03                                             0019
         BNP   @RF00019                                            0019
*  DO;                                 /* THEN BUILD WTP LIST        */
*    IF WPLLGH>132 THEN                /* MAX LENGTH EXCEEDED@YM06959*/
         LA    @15,132                                             0021
         CR    @03,@15                                             0021
         BNH   @RF00021                                            0021
*      WPLLGH=132;                     /* THEN TRUNCATE MSG  @YM06959*/
         STH   @15,WPLLGH(,WPLPTR)                                 0022
*    WPLTXT(ONE:WPLLGH)=MESSAGE(ONE:WPLLGH); /* MOVE TEXT TO WTP LIST*/
@RF00021 LH    @03,WPLLGH(,WPLPTR)                                 0023
         LR    @15,@03                                             0023
         BCTR  @15,0                                               0023
         L     @01,MSGPTR(,LCTPTR)                                 0023
         EX    @15,@SM00392                                        0023
*    WPLLGH=WPLLGH+FOUR;               /* UPDATE WTP LENGTH TO     0024
*                                         INCLUDE LENGTH OF HEADER   */
         AH    @03,@CH00040                                        0024
         STH   @03,WPLLGH(,WPLPTR)                                 0024
*    WPLPTR=ADDR(WPLIST)+WPLLGH;       /* POINT TO ROUT AND DESC   0025
*                                         CODE SECTION OF WTP        */
         LA    @15,WPLIST                                          0025
         ALR   @03,@15                                             0025
         LR    WPLPTR,@03                                          0025
*    WPLROUTK='1'B;                    /* SET WTP ROUTING CODE ON    */
         OI    WPLROUTK(WPLPTR),B'00100000'                        0026
*    CALL IEEAB400(ADDR(WPLIST),LCTJSCB); /* HAVE WTP PLACED INTO  0027
*                                         WTP BUFFER                 */
         ST    @15,@TF00001                                        0027
         LA    @15,@TF00001                                        0027
         ST    @15,@AL00001                                        0027
         LA    @15,LCTJSCB(,LCTPTR)                                0027
         ST    @15,@AL00001+4                                      0027
         L     @15,@CV00038                                        0027
         LA    @01,@AL00001                                        0027
         BALR  @14,@15                                             0027
*  END;                                                            0028
*END IEFTB723                                                      0029
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (B723SPEC)                                        *
*/*%INCLUDE SYSLIB  (B723DCLS)                                        *
*/*%INCLUDE SYSLIB  (IEFALLCT)                                        *
*/*%INCLUDE SYSLIB  (IEZWPL  )                                        *
*;                                                                 0029
@EL00001 L     @13,4(,@13)                                         0029
@EF00001 L     @00,@SIZDATD                                        0029
         LR    @01,@10                                             0029
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0029
         BR    @14                                                 0029
@DATA    DS    0H
@CH00040 DC    H'4'
@SM00392 MVC   WPLTXT(0,WPLPTR),MESSAGE(@01)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@AL00001 DS    2A
@TF00001 DS    F
IEFTB723 CSECT
         DS    0F
@DATD    DSECT
         DS    0D
WPLIST   DS    CL140
IEFTB723 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00038 DC    V(IEEAB400)
         DS    0D
IEFTB723 CSECT
         DS   0H
PATCHES DC (50)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFTB723 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
WPLPTR   EQU   @02
LCTPTR   EQU   @12
MESSAGE  EQU   0
LCT      EQU   0
LCTQDRTY EQU   LCT
LCTSRTAD EQU   LCT+4
LCTTCBAD EQU   LCT+8
LCTQENTY EQU   LCT+12
@NM00007 EQU   LCTQENTY
LCTJCTAD EQU   LCT+16
LCTSCTAD EQU   LCT+20
LCTSCTDA EQU   LCT+24
LCTWORKA EQU   LCTSCTDA
LCTPSPAR EQU   LCT+28
LCTERROR EQU   LCT+32
LCTERR   EQU   LCTERROR
LCTPARM1 EQU   LCT+36
LCTPARM2 EQU   LCT+40
LCTCMCBA EQU   LCT+52
LCTNSPAD EQU   LCT+56
LCTJFCBH EQU   LCT+57
LCTSMBAD EQU   LCT+60
LCTCOMCD EQU   LCT+68
LCTRTRN  EQU   LCT+72
LCTSREG  EQU   LCTRTRN
@NM00034 EQU   LCT+76
LCTINTSW EQU   @NM00034
LCTTMWRK EQU   LCT+80
LCTTJTU4 EQU   LCTTMWRK
LCTTSTL4 EQU   LCTTMWRK+4
LCTTSTR4 EQU   LCTTMWRK+8
LCTSMF   EQU   LCTTSTR4
LCTTMBYT EQU   LCTSMF
LCTTSTU4 EQU   LCTTMWRK+12
LCTJOBLB EQU   LCT+96
LCTATLST EQU   LCT+100
LCTECBAD EQU   LCT+328
ECBLIST  EQU   LCTECBAD
LCTIDENT EQU   LCT+332
LCTSPIL  EQU   LCTIDENT+4
LCTALCFG EQU   LCTSPIL+2
LCTTSRB4 EQU   LCT+348
LCTENTR  EQU   LCT+352
LCTEXIT  EQU   LCTENTR
LCTOPSW1 EQU   LCTEXIT
@NM00060 EQU   LCT+356
LCTOPSW2 EQU   @NM00060
LCTJSCB  EQU   LCT+360
LCTOPSW3 EQU   LCTJSCB
LCTJCTDA EQU   LCT+408
LCTSTATA EQU   LCT+416
LCTSTATB EQU   LCT+417
LCTRFB   EQU   LCT+418
@NM00074 EQU   LCT+420
LCTINTS2 EQU   @NM00074+1
WPLRF    EQU   0
WPLRPTR  EQU   WPLRF
WPL      EQU   0
WPLLGH   EQU   WPL
WPLMCSF  EQU   WPL+2
WPLMCSF1 EQU   WPLMCSF
WPLMCSFA EQU   WPLMCSF1
WPLMCSF2 EQU   WPLMCSF+1
WPLTXT   EQU   WPL+4
WPLFLGS  EQU   0
WPLDESC  EQU   WPLFLGS
WPLDESC1 EQU   WPLDESC
WPLDESC2 EQU   WPLDESC+1
WPLROUT  EQU   WPLFLGS+2
WPLROUT1 EQU   WPLROUT
WPLROUT2 EQU   WPLROUT+1
WPLROUTK EQU   WPLROUT2
WPLMSGTY EQU   WPLFLGS+4
WPLMSGT1 EQU   WPLMSGTY
WPLMSGT2 EQU   WPLMSGTY+1
WPLLS01  EQU   0
WPLLTF   EQU   WPLLS01
WPLLTF1  EQU   WPLLTF
WPLML    EQU   0
WPLMLLTF EQU   WPLML+2
WPLMLLT1 EQU   WPLMLLTF
MSGPTR   EQU   LCTPARM1
MSGLEN   EQU   LCTPARM2+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
WPLMLTXT EQU   WPLML+4
WPLMLLT2 EQU   WPLMLLTF+1
WPLRSV24 EQU   WPLMLLT1
WPLRSV23 EQU   WPLMLLT1
WPLRSV22 EQU   WPLMLLT1
WPLRSV21 EQU   WPLMLLT1
WPLMLLTD EQU   WPLMLLT1
WPLMLLTC EQU   WPLMLLT1
WPLMLLTB EQU   WPLMLLT1
WPLMLLTA EQU   WPLMLLT1
WPLMLLEN EQU   WPLML+1
WPLML0   EQU   WPLML
WPLLINES EQU   WPLLS01+3
WPLAREA  EQU   WPLLS01+2
WPLLTF2  EQU   WPLLTF+1
WPLRSV20 EQU   WPLLTF1
WPLRSV19 EQU   WPLLTF1
WPLRSV18 EQU   WPLLTF1
WPLRSV17 EQU   WPLLTF1
WPLLTFD  EQU   WPLLTF1
WPLLTFC  EQU   WPLLTF1
WPLLTFB  EQU   WPLLTF1
WPLLTFA  EQU   WPLLTF1
WPLQID   EQU   WPLFLGS+6
WPLRSV32 EQU   WPLMSGT2
WPLRSV31 EQU   WPLMSGT2
WPLRSV30 EQU   WPLMSGT2
WPLRSV29 EQU   WPLMSGT2
WPLRSV28 EQU   WPLMSGT2
WPLRSV27 EQU   WPLMSGT2
WPLRSV26 EQU   WPLMSGT2
WPLRSV25 EQU   WPLMSGT2
WPLRSV16 EQU   WPLMSGT1
WPLRSV15 EQU   WPLMSGT1
WPLMSGTF EQU   WPLMSGT1
WPLRSV14 EQU   WPLMSGT1
WPLMSGTD EQU   WPLMSGT1
WPLMSGTC EQU   WPLMSGT1
WPLMSGTB EQU   WPLMSGT1
WPLMSGTA EQU   WPLMSGT1
WPLRSV13 EQU   WPLROUT2
WPLROUTO EQU   WPLROUT2
WPLROUTN EQU   WPLROUT2
WPLROUTM EQU   WPLROUT2
WPLROUTL EQU   WPLROUT2
WPLROUTJ EQU   WPLROUT2
WPLROUTI EQU   WPLROUT2
WPLROUTH EQU   WPLROUT1
WPLROUTG EQU   WPLROUT1
WPLROUTF EQU   WPLROUT1
WPLROUTE EQU   WPLROUT1
WPLROUTD EQU   WPLROUT1
WPLROUTC EQU   WPLROUT1
WPLROUTB EQU   WPLROUT1
WPLROUTA EQU   WPLROUT1
WPLRSV12 EQU   WPLDESC2
WPLRSV11 EQU   WPLDESC2
WPLRSV10 EQU   WPLDESC2
WPLRSV09 EQU   WPLDESC2
WPLRSV08 EQU   WPLDESC2
WPLRSV07 EQU   WPLDESC2
WPLDESCJ EQU   WPLDESC2
WPLDESCI EQU   WPLDESC2
WPLDESCH EQU   WPLDESC1
WPLDESCG EQU   WPLDESC1
WPLDESCF EQU   WPLDESC1
WPLDESCE EQU   WPLDESC1
WPLDESCD EQU   WPLDESC1
WPLDESCC EQU   WPLDESC1
WPLDESCB EQU   WPLDESC1
WPLDESCA EQU   WPLDESC1
WPLTXTL  EQU   WPLTXT+125
@NM00077 EQU   WPLTXT
WPLRSV05 EQU   WPLMCSF2
WPLRSV04 EQU   WPLMCSF2
WPLMCSFN EQU   WPLMCSF2
WPLRSV03 EQU   WPLMCSF2
WPLNOWTP EQU   WPLMCSF2
WPLMCSFK EQU   WPLMCSF2
WPLMCSFJ EQU   WPLMCSF2
WPLMCSFI EQU   WPLMCSF2
WPLMCSFH EQU   WPLMCSF1
WPLMCSFG EQU   WPLMCSF1
WPLMCSFF EQU   WPLMCSF1
WPLMCSFE EQU   WPLMCSF1
WPLMCSFD EQU   WPLMCSF1
WPLMCSFC EQU   WPLMCSF1
WPLMCSFB EQU   WPLMCSF1
WPLRECB  EQU   WPLRF+4
WPLRPTRA EQU   WPLRPTR+1
WPLRLN   EQU   WPLRPTR
@NM00076 EQU   LCT+436
LCTIMSG  EQU   LCT+432
LCTLBWAP EQU   LCT+428
@NM00075 EQU   LCT+424
LCTSYS   EQU   LCTINTS2
LCTTSIZ  EQU   @NM00074
LCTRFB1  EQU   LCT+419
@NM00073 EQU   LCTRFB
LCTRFBRP EQU   LCTRFB
LCTRFBEF EQU   LCTRFB
LCTRFBMS EQU   LCTRFB
LCTRFBDC EQU   LCTRFB
LCTRFBRV EQU   LCTRFB
LCTRFBCR EQU   LCTRFB
LCTRFBSM EQU   LCTRFB
LCTMFTIO EQU   LCTSTATB
LCTNPKEY EQU   LCTSTATB
LCTSBPOL EQU   LCTSTATB
LCTNREAD EQU   LCTSTATB
LCTWRITE EQU   LCTSTATB
LCTNOATC EQU   LCTSTATB
LCTNOREG EQU   LCTSTATB
LCTECBPB EQU   LCTSTATB
LCTCPART EQU   LCTSTATA
LCTNOGCB EQU   LCTSTATA
LCTNOSDP EQU   LCTSTATA
LCTJCPIB EQU   LCTSTATA
LCTNECBL EQU   LCTSTATA
LCTBTJOB EQU   LCTSTATA
LCTSNOWK EQU   LCTSTATA
LCTSUSPD EQU   LCTSTATA
LCTTIOTI EQU   LCT+412
@NM00072 EQU   LCTJCTDA+3
LCTJCTVA EQU   LCTJCTDA
LCTSSOBA EQU   LCT+404
LCTSTEPL EQU   LCT+400
@NM00071 EQU   LCT+364
@NM00070 EQU   LCTJSCB+1
@NM00069 EQU   LCTOPSW3
@NM00068 EQU   LCTOPSW3
LCTALERR EQU   LCTOPSW3
LCTJNLF  EQU   LCTOPSW3
@NM00067 EQU   LCTOPSW3
LCTNSYS  EQU   LCTOPSW3
LCTRDER  EQU   LCTOPSW3
@NM00066 EQU   LCTOPSW3
@NM00065 EQU   @NM00060+1
LCTENQU  EQU   LCTOPSW2
LCTNORC  EQU   LCTOPSW2
@NM00064 EQU   LCTOPSW2
@NM00063 EQU   LCTOPSW2
@NM00062 EQU   LCTOPSW2
@NM00061 EQU   LCTOPSW2
LCTCRF   EQU   LCTOPSW2
LCTTIMEF EQU   LCTOPSW2
@NM00059 EQU   LCTEXIT+1
@NM00058 EQU   LCTOPSW1
@NM00057 EQU   LCTOPSW1
LCTONEJF EQU   LCTOPSW1
LCTCANF  EQU   LCTOPSW1
@NM00056 EQU   LCTOPSW1
@NM00055 EQU   LCTOPSW1
LCTDWFF  EQU   LCTOPSW1
LCTDPSWA EQU   LCTOPSW1
LCTTSRB3 EQU   LCTTSRB4+1
@NM00054 EQU   LCTTSRB4
@NM00053 EQU   LCT+340
@NM00052 EQU   LCTSPIL+3
@NM00051 EQU   LCTALCFG
@NM00050 EQU   LCTALCFG
@NM00049 EQU   LCTALCFG
@NM00048 EQU   LCTALCFG
@NM00047 EQU   LCTALCFG
@NM00046 EQU   LCTALCFG
LCTMSGWT EQU   LCTALCFG
LCTODSFL EQU   LCTALCFG
LCTDSBCT EQU   LCTSPIL
LCTPIB   EQU   LCTIDENT
@NM00045 EQU   ECBLIST+1
@NM00044 EQU   ECBLIST
LCTJMRAD EQU   LCT+324
LCTASCBA EQU   LCT+320
@NM00043 EQU   LCT+284
QMGR1    EQU   LCT+248
REGSAVE  EQU   LCT+104
@NM00042 EQU   LCTATLST+1
@NM00041 EQU   LCTATLST
@NM00040 EQU   LCTJOBLB+1
@NM00039 EQU   LCTJOBLB
LCTTSTU3 EQU   LCTTSTU4+1
@NM00038 EQU   LCTTSTU4
LCTTSTR3 EQU   LCTSMF+1
LCTTTIFJ EQU   LCTTMBYT
LCTTSTL3 EQU   LCTTSTL4+1
@NM00037 EQU   LCTTSTL4
LCTTJTU3 EQU   LCTTJTU4+1
@NM00036 EQU   LCTTJTU4
@NM00035 EQU   @NM00034+1
LCTNDSI  EQU   LCTINTSW
LCTABEND EQU   LCTINTSW
LCTSTOP  EQU   LCTINTSW
LCTSTART EQU   LCTINTSW
LCTMINRG EQU   LCTINTSW
LCTPPAA  EQU   LCTINTSW
LCTPRIV  EQU   LCTINTSW
LCTINPPT EQU   LCTINTSW
@NM00033 EQU   LCTSREG+1
@NM00032 EQU   LCTSREG
LCTCOMD2 EQU   LCTCOMCD+2
LCTCOMD1 EQU   LCTCOMCD
LCTBATMN EQU   LCT+64
@NM00031 EQU   LCTSMBAD+1
@NM00030 EQU   LCTSMBAD
LCTACTON EQU   LCT+59
LCTSNUMB EQU   LCT+58
@NM00029 EQU   LCTJFCBH
@NM00028 EQU   LCTJFCBH
@NM00027 EQU   LCTJFCBH
@NM00026 EQU   LCTJFCBH
@NM00025 EQU   LCTJFCBH
LCTS2FES EQU   LCTJFCBH
LCTS2COP EQU   LCTJFCBH
LCTS2PEM EQU   LCTJFCBH
LCTSTIND EQU   LCTNSPAD
@NM00024 EQU   LCTCMCBA+1
@NM00023 EQU   LCTCMCBA
LCTPARM4 EQU   LCT+48
LCTPARM3 EQU   LCT+44
LCTACOMP EQU   LCTERR
LCTSFAIL EQU   LCTERR
LCTPALCD EQU   LCTERR
LCTSALCD EQU   LCTERR
LCTJFAIL EQU   LCTERR
@NM00022 EQU   LCTPSPAR+1
@NM00021 EQU   LCTPSPAR
@NM00020 EQU   LCTWORKA+3
LCTSCTVA EQU   LCTWORKA
@NM00019 EQU   LCTSCTAD+1
@NM00018 EQU   LCTSCTAD
@NM00017 EQU   LCTJCTAD+1
@NM00016 EQU   LCTJCTAD
@NM00015 EQU   LCTQENTY+1
LCTERRM  EQU   @NM00007
@NM00014 EQU   @NM00007
@NM00013 EQU   @NM00007
@NM00012 EQU   @NM00007
@NM00011 EQU   @NM00007
@NM00010 EQU   @NM00007
@NM00009 EQU   @NM00007
@NM00008 EQU   @NM00007
@NM00006 EQU   LCTTCBAD+1
@NM00005 EQU   LCTTCBAD
@NM00004 EQU   LCTSRTAD+1
@NM00003 EQU   LCTSRTAD
@NM00002 EQU   LCTQDRTY+1
@NM00001 EQU   LCTQDRTY
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00019 EQU   @EL00001
@ENDDATA EQU   *
         END   IEFTB723

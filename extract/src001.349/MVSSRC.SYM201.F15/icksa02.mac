         TITLE '*******    ICKSA02  SYSTEM ADAPTER SERVICE MODULE      *
                ******* '
ICKSA02 CSECT
MAINENT DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(BEGIN-MAINENT)
        DC    C'ICKSA02 '
ICKSACL DS    0H                      UCALL ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSACL1-ICKSACL)
        ENTRY ICKSACL
ICKSALD DS    0H                      ULOAD ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSALD1-ICKSALD)
        ENTRY ICKSALD
ICKSADE DS    0H                      UDELETE ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSADE1-ICKSADE)
        ENTRY ICKSADE
ICKSAGS DS    0H                      UGSPACE ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSAGS1-ICKSAGS)
        ENTRY ICKSAGS
ICKSAFS DS    0H                      UFSPACE ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSAFS1-ICKSAFS)
        ENTRY ICKSAFS
ICKSAGP DS    0H                      UGPOOL ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSAGP1-ICKSAGP)
        ENTRY ICKSAGP
ICKSAFP DS    0H                      UFPOOL ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSAFP1-ICKSAFP)
        ENTRY ICKSAFP
ICKSATI DS    0H                      UTIME ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSATI1-ICKSATI)
        ENTRY ICKSATI
ICKSASN DS    0H                      USNAP ENTRY POINT
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSASN1-ICKSASN)
        ENTRY ICKSASN
        DROP  REG15
PROLOG  STM   REG14,REG12,12(REG13)
        BALR  REG10,0
PSTART  LA    REG12,4095(REG10)
        USING PSTART,REG10
        USING PSTART+4095,REG12
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        LR    REG11,REG1
        USING @DATD,REG11
        LM    REG15,REG1,16(REG13)
        ST    REG13,@SA00001+4
        ST    REG11,8(REG13)
        LR    REG13,REG11
        AH    REG15,4(REG15)
        BR    REG15
BEGIN   DS    0H
*                                                                  0222
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* UCALL ENTRY POINT                                        */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0223
*DMSSACL:  ENTRY(GDTTBLX,CLNAMEX);                                 0223
*                                                                  0223
@EC00223 DS    0H                                                  0224
*DMSSACL1:                                                         0224
*                                                                  0224
*        DCL CLNAME CHAR(8) BASED;     /* ENTRY POINT NAME FOR UCALL */
*                                                                  0224
DMSSACL1 DS    0H                                                  0225
*        RESPECIFY CLNAME BASED(PARMPTR2);                         0225
*                                      /* BASE CLNAME                */
*        DCL CLENTPT PTR(31);          /* ENTRY POINT CALLED RTN     */
*                                                                  0226
*                                                                  0226
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0227
*        RESPECIFY (REG1PTR) RSTD;                                 0227
*        GDTPR = ADDR1;                                            0228
         L     GDTPR,ADDR1(,REG1PTR)                               0228
*        PARMPTR2 = ADDR2;                                         0229
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0229
*        RESPECIFY (REG1PTR) UNRSTD;                               0230
*                                                                  0230
*        OLDERID2 = NEWERID2;                                      0231
         L     @02,GDTTR2(,GDTPR)                                  0231
         MVC   @TS00001(95),NEWERID2(@02)                          0231
         MVC   OLDERID2(95,@02),@TS00001                           0231
*        NEWID2 = 'SACL';                                          0232
*                                                                  0232
         MVC   NEWID2(4,@02),@CC00579                              0232
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE CALL TO FINDNAME RTN TO GET ENTRY POINT            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0233
*        TEMPEPN = CLNAME;                                         0233
         MVC   TEMPEPN(8),CLNAME(PARMPTR2)                         0233
*        RESPECIFY (REG0) RSTD;                                    0234
*        CALL FINDNAME(TEMPEPN,CLENTPT);                           0235
*                                                                  0235
         LA    @01,TEMPEPN                                         0235
         ST    @01,@AL00001                                        0235
         LA    @01,CLENTPT                                         0235
         ST    @01,@AL00001+4                                      0235
         LA    @01,@AL00001                                        0235
         BAL   @14,FINDNAME                                        0235
*        /************************************************************/
*        /*                                                          */
*        /* TEMPORARILY STORE THE ADDRESS OF THE ENTRY POINT TO BE   */
*        /* BRANCHED TO INTO REGISTER 2,                             */
*        /* STORE THE OLD SAVEAREA POINTER INTO REGISTER 3, AND CHECK*/
*        /* WHETHER OR NOT THIS MODULE'S AUTOMATIC STORAGE AREA IS TO*/
*        /* BE FREED.                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0236
*        RESPECIFY (REG0,REG1,REG2,REG3,REG13,REG14,REG15) RSTD;   0236
*        REG2 = CLENTPT;                                           0237
         L     REG2,CLENTPT                                        0237
*        GEN(L     REG3,4(REG13));                                 0238
         L     REG3,4(REG13)
*        STATUS(3) = STATUS(3) - 1;                                0239
*                                                                  0239
         L     @07,GDTSAH(,GDTPR)                                  0239
         L     @07,AUTOPTR(,@07)                                   0239
         LH    @06,STATUS+24(,@07)                                 0239
         BCTR  @06,0                                               0239
         STH   @06,STATUS+24(,@07)                                 0239
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF ANY OTHER ACTIVE CALLERS OF ICKSA02             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0240
*        IF STATUS(3) > 0                                          0240
*          THEN                                                    0240
*                                                                  0240
         LTR   @06,@06                                             0240
         BNP   @RF00240                                            0240
*            /********************************************************/
*            /*                                                      */
*            /* FREE THE AREA                                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  0241
*            DO;                                                   0241
*              TEMPPTR = REG11 - 8;                                0242
         LR    @07,REG11                                           0242
         SL    @07,@CF00154                                        0242
         ST    @07,TEMPPTR                                         0242
*              REG0 = AUTOSIZE;                                    0243
         L     REG0,AUTOSIZE(,@07)                                 0243
*              REG1 = TEMPPTR;                                     0244
         LR    REG1,@07                                            0244
*LFREMN0:      GEN(FREEMAIN R,LV=(0),A=(1));                       0245
LFREMN0  FREEMAIN R,LV=(0),A=(1)
*            END;                                                  0246
*                                                                  0246
*        /************************************************************/
*        /*                                                          */
*        /* RESTORE OLD SAVEAREA POINTER,                            */
*        /* LOAD THE ADDRESS OF THE ENTRY POINT TO BE BRANCHED TO    */
*        /* INTO REGISTER 15, AND RESTORE REGISTERS EXCLUDING        */
*        /* REGISTER 15 WHICH IS USED IN THE BRANCH                  */
*        /*                                                          */
*        /* PREPARE FOR LINKAGE BY ADJUSTING THE ADDRESS LIST FOR    */
*        /* THE PARAMETER LIST RECEIVED (ADDRESS OF MODULE NAME      */
*        /* TO BE CALLED IS NO LONGER NEEDED) AND EXECUTE A BRANCH   */
*        /* ON REGISTER 15.                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0247
*        REG13 = REG3;                                             0247
@RF00240 LR    REG13,REG3                                          0247
*        REG15 = REG2;                                             0248
         LR    REG15,REG2                                          0248
*        GENERATE;                                                 0249
        L     REG14,12(REG13)
        LM    REG0,REG12,20(REG13)
        MVC   4(4,REG1),0(REG1)
        LA    REG1,4(REG1)
        BR    REG15
*        RESPECIFY(REG0,REG1,REG2,REG3,REG13,REG14,REG15) UNRSTD;  0250
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* ULOAD ENTRY POINT                                        */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0251
*DMSSALD:  ENTRY(GDTTBLX,LDMODX,LDPOINTX);                         0251
*                                                                  0251
@EC00251 DS    0H                                                  0252
*DMSSALD1:                                                         0252
*                                                                  0252
*        DCL LDMOD CHAR(8) BASED;      /* MODULE NAME FOR ULOAD      */
*                                                                  0252
DMSSALD1 DS    0H                                                  0253
*        DCL LDPOINT PTR(31) BASED;    /* MODULE ADDRESS FOR ULOAD   */
*                                                                  0253
*        RESPECIFY LDMOD BASED(PARMPTR2);                          0254
*                                      /* BASE LDMOD                 */
*                                                                  0255
*        RESPECIFY LDPOINT BASED(PARMPTR3);                        0255
*                                      /* BASE LDPOINT               */
*                                                                  0256
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0256
*        RESPECIFY (REG1PTR) RSTD;                                 0256
*        GDTPR = ADDR1;                                            0257
         L     GDTPR,ADDR1(,REG1PTR)                               0257
*        PARMPTR2 = ADDR2;                                         0258
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0258
*        PARMPTR3 = ADDR3;                                         0259
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0259
*        RESPECIFY (REG1PTR) UNRSTD;                               0260
*                                                                  0260
*        OLDERID2 = NEWERID2;                                      0261
         L     @15,GDTTR2(,GDTPR)                                  0261
         MVC   @TS00001(95),NEWERID2(@15)                          0261
         MVC   OLDERID2(95,@15),@TS00001                           0261
*        NEWID2 = 'SALD';                                          0262
*                                                                  0262
         MVC   NEWID2(4,@15),@CC00598                              0262
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE CALL TO FINDNAME RTN TO GET MODULE ENRTY POINT    */
*        /*  IF MODULE IS LOADED THEN ONLY UP USE COUNT BY ONE       */
*        /*  IF NOT IN LOAD LIST LOAD THE MODULE MAKE USE COUNT      */
*        /*  ONE AND RETURN ENTRY POINT EITHER CONDITION             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0263
*        TEMPEPN = LDMOD;                                          0263
         MVC   TEMPEPN(8),LDMOD(PARMPTR2)                          0263
*        CALL FINDNAME(TEMPEPN,LDPOINT);                           0264
*                                                                  0264
         LA    @03,TEMPEPN                                         0264
         ST    @03,@AL00001                                        0264
         ST    PARMPTR3,@AL00001+4                                 0264
         LA    @01,@AL00001                                        0264
         BAL   @14,FINDNAME                                        0264
*        /************************************************************/
*        /*                                                          */
*        /* RETURN CONTROL TO THE ULOAD CALLER                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0265
*        CALL ICKSAEP0(GDTTBL,MODID);                              0265
         ST    GDTPR,@AL00001                                      0265
         LA    @15,MODID                                           0265
         ST    @15,@AL00001+4                                      0265
         MVI   @AL00001+4,X'80'                                    0265
         L     @15,GDTEPL(,GDTPR)                                  0265
         LA    @01,@AL00001                                        0265
         BALR  @14,@15                                             0265
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* UDELETE ENTRY POINT                                      */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0266
*DMSSADE:  ENTRY(GDTTBLX,DEMODX);                                  0266
*                                                                  0266
@EC00266 DS    0H                                                  0267
*DMSSADE1:                                                         0267
*                                                                  0267
*        DCL DEMOD CHAR(8) BASED;      /* MODULE NAME FOR UDELETE    */
*                                                                  0267
DMSSADE1 DS    0H                                                  0268
*        RESPECIFY DEMOD BASED(PARMPTR2);                          0268
*                                      /* BASE DEMOD                 */
*                                                                  0269
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0269
*        RESPECIFY (REG1PTR) RSTD;                                 0269
*        GDTPR = ADDR1;                                            0270
         L     GDTPR,ADDR1(,REG1PTR)                               0270
*        PARMPTR2 = ADDR2;                                         0271
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0271
*        RESPECIFY (REG1PTR) UNRSTD;                               0272
*                                                                  0272
*                                                                  0272
*        OLDERID2 = NEWERID2;                                      0273
         L     @15,GDTTR2(,GDTPR)                                  0273
         MVC   @TS00001(95),NEWERID2(@15)                          0273
         MVC   OLDERID2(95,@15),@TS00001                           0273
*        NEWID2 = 'SADE';                                          0274
*                                                                  0274
*                                                                  0274
         MVC   NEWID2(4,@15),@CC00610                              0274
*        /************************************************************/
*        /*                                                          */
*        /*  UDELETE RTN NOW WILL SEARCH LLBLK(S)                    */
*        /*  FOR MATCH OF NAME AND REDUCE USE CTR BY ONE             */
*        /*  UNLESS ITS ZERO ALREADY.THIS SHOULD NOT HAPPEN.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0275
*        IX = 0;                                                   0275
         SLR   IX,IX                                               0275
*        LOOPCTL = OFF;                                            0276
         NI    LOOPCTL,B'01111111'                                 0276
*        NAMEFND = OFF;                                            0277
         NI    NAMEFND,B'01111111'                                 0277
*        DO WHILE LOOPCTL = OFF;                                   0278
         B     @DE00278                                            0278
@DL00278 DS    0H                                                  0279
*          IF IX = 0                                               0279
*                                                                  0279
*          /**********************************************************/
*          /*                                                        */
*          /*    FIRST TIME USE POINTER IN SYSTEM                    */
*          /*    HIST SAVE AREA TO LOAD LIST BLOCK                   */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0279
*            THEN                                                  0279
         LTR   IX,IX                                               0279
         BNZ   @RF00279                                            0279
*              P = LLBLKPTR;                                       0280
         L     @02,GDTSAH(,GDTPR)                                  0280
         L     P,LLBLKPTR(,@02)                                    0280
*            ELSE;                                                 0281
*                                                                  0281
@RF00279 DS    0H                                                  0282
*          DO IX = 1 TO LLSLTCNT BY 1 WHILE LOOPCTL = OFF;         0282
*                                                                  0282
         LA    IX,1                                                0282
@DL00282 TM    LOOPCTL,B'10000000'                                 0282
         BNZ   @DC00282                                            0282
*          /**********************************************************/
*          /*                                                        */
*          /*  LOOK FOR MATCH OF NAME IN LLBLK                       */
*          /*  WHEN FOUND REDUCE USE CTR BY ONE                      */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0283
*            IF DEMOD = LLNAME(IX)                                 0283
*              THEN                                                0283
         LR    @15,IX                                              0283
         SLA   @15,4                                               0283
         ST    @15,@TF00001                                        0283
         ALR   @15,P                                               0283
         AL    @15,@CF00812                                        0283
         CLC   DEMOD(8,PARMPTR2),LLNAME-8(@15)                     0283
         BNE   @RF00283                                            0283
*                DO;                                               0284
*                  LOOPCTL = ON;                                   0285
         OI    LOOPCTL,B'10000000'                                 0285
*                  NAMEFND = ON;                                   0286
         OI    NAMEFND,B'10000000'                                 0286
*                    IF LLUSECTR(IX) = 0                           0287
*                      THEN                                        0287
         L     @01,@TF00001                                        0287
         SLR   @00,@00                                             0287
         IC    @00,LLUSECTR-16(@01,P)                              0287
         C     @00,@CF00087                                        0287
         BNE   @RF00287                                            0287
*                        NAMEFND = OFF;                            0288
         NI    NAMEFND,B'01111111'                                 0288
*                      ELSE                                        0289
*                        LLUSECTR(IX) = LLUSECTR(IX)-1;            0289
         B     @RC00287                                            0289
@RF00287 LR    @15,IX                                              0289
         SLA   @15,4                                               0289
         SLR   @14,@14                                             0289
         IC    @14,LLUSECTR-16(@15,P)                              0289
         BCTR  @14,0                                               0289
         STC   @14,LLUSECTR-16(@15,P)                              0289
*                END;                                              0290
*              ELSE;                                               0291
@RF00283 DS    0H                                                  0292
*          END;                                                    0292
@RC00283 AL    IX,@CF00158                                         0292
         C     IX,@CF00278                                         0292
         BNH   @DL00282                                            0292
@DC00282 DS    0H                                                  0293
*            IF LLNXTBLK = 0                                       0293
*                                                                  0293
*            /********************************************************/
*            /*                                                      */
*            /*     WHEN ZERO THIS IS LAST LLBLK                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0293
*              THEN                                                0293
         L     @15,LLNXTBLK(,P)                                    0293
         LTR   @15,@15                                             0293
         BNZ   @RF00293                                            0293
*                LOOPCTL = ON;                                     0294
         OI    LOOPCTL,B'10000000'                                 0294
*              ELSE                                                0295
*                P = LLNXTBLK;                                     0295
         B     @RC00293                                            0295
@RF00293 L     P,LLNXTBLK(,P)                                      0295
*        END;                                                      0296
*                                                                  0296
*                                                                  0296
@RC00293 DS    0H                                                  0296
@DE00278 TM    LOOPCTL,B'10000000'                                 0296
         BZ    @DL00278                                            0296
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO THE UDELETE CALLER                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0297
*        CALL ICKSAEP0(GDTTBL,MODID);                              0297
         ST    GDTPR,@AL00001                                      0297
         LA    @15,MODID                                           0297
         ST    @15,@AL00001+4                                      0297
         MVI   @AL00001+4,X'80'                                    0297
         L     @15,GDTEPL(,GDTPR)                                  0297
         LA    @01,@AL00001                                        0297
         BALR  @14,@15                                             0297
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* UGSPACE ENTRY POINT                                      */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0298
*DMSSAGS:  ENTRY(GDTTBLX,GSSIZEX,GSPOINTX,GSINITX,GSSPIDX);        0298
*                                                                  0298
@EC00298 DS    0H                                                  0299
*DMSSAGS1:                                                         0299
*                                                                  0299
*        DCL GSSIZE FIXED(31) BASED;   /* SPACE SIZE FOR UGSPACE     */
*                                                                  0299
DMSSAGS1 DS    0H                                                  0300
*        DCL GSPOINT PTR(31) BASED;    /* SPACE ADDR FOR UGSPACE     */
*                                                                  0300
*        DCL GSINIT CHAR(4) BASED;     /* UGSPACE INIT ARGUMENT      */
*                                                                  0301
*        DCL GSSPID FIXED(8) BASED;    /*UGSPACE SUBPOOL ID          */
*                                                                  0302
*        RESPECIFY GSSIZE BASED(PARMPTR2);                         0303
*                                      /* BASE GSSIZE                */
*                                                                  0304
*        RESPECIFY GSPOINT BASED(PARMPTR3);                        0304
*                                      /* BASE GSPOINT               */
*                                                                  0305
*        RESPECIFY GSINIT BASED(PARMPTR4);                         0305
*                                      /* BASE GSINIT                */
*                                                                  0306
*        RESPECIFY GSSPID BASED(PARMPTR5);                         0306
*                                      /* BASE GSSID                 */
*                                                                  0307
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0307
*        RESPECIFY (REG1PTR) RSTD;                                 0307
*        GDTPR = ADDR1;                                            0308
         L     GDTPR,ADDR1(,REG1PTR)                               0308
*        PARMPTR2 = ADDR2;                                         0309
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0309
*        PARMPTR3 = ADDR3;                                         0310
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0310
*        PARMPTR4 = ADDR4;                                         0311
         L     PARMPTR4,ADDR4+12(,REG1PTR)                         0311
*        PARMPTR5 = ADDR5;                                         0312
         L     @04,ADDR5+16(,REG1PTR)                              0312
         ST    @04,PARMPTR5                                        0312
*        RESPECIFY (REG1PTR) UNRSTD;                               0313
*                                                                  0313
*                                                                  0313
*                                                                  0314
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0314
*        GEN;                                                      0314
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0315
         LA    @04,1                                               0315
         STC   @04,LISTLN                                          0315
@DL00315 L     @15,LISTSCAN                                        0315
         TM    LISTTEST(@15),B'10000000'                           0315
         BNZ   @DC00315                                            0315
*          LISTSCAN = LISTSCAN + 4;                                0316
         AL    @15,@CF00037                                        0316
         ST    @15,LISTSCAN                                        0316
*        END;                                                      0317
*                                                                  0317
         AL    @04,@CF00158                                        0317
         STC   @04,LISTLN                                          0317
         C     @04,@CF00634                                        0317
         BNH   @DL00315                                            0317
@DC00315 DS    0H                                                  0318
*        OLDERID2 = NEWERID2;                                      0318
         L     @07,GDTTR2(,GDTPR)                                  0318
         MVC   @TS00001(95),NEWERID2(@07)                          0318
         MVC   OLDERID2(95,@07),@TS00001                           0318
*        NEWID2 = 'SAGS';                                          0319
*                                                                  0319
         MVC   NEWID2(4,@07),@CC00635                              0319
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE PLUS CONTROL      */
*        /* INFORMATION AREA                                         */
*        /* NOTE - CORE IS ALWAYS GOTTEN FROM SUBPOOL 0, BUT         */
*        /* THE USER REQUESTED SUBPOOL ID IS PLACED IN THE           */
*        /* CONTROL INFORMATION AREA.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0320
*        GETLIST = GETGEN;                                         0320
         MVC   GETLIST(10),GETGEN                                  0320
*        GETSZ = GSSIZE + 8;                                       0321
         LA    @07,8                                               0321
         AL    @07,GSSIZE(,PARMPTR2)                               0321
         ST    @07,GETSZ                                           0321
*        GETPT = ADDR(TEMPPTR);                                    0322
         LA    @07,TEMPPTR                                         0322
         ST    @07,GETPT                                           0322
*        CALL GETSTG;                                              0323
*                                                                  0323
*                                                                  0323
         BAL   @14,GETSTG                                          0323
*        /************************************************************/
*        /*                                                          */
*        /* IF NO CORE AVAILABLE FREE MODULES NOT IN USE             */
*        /* AND TRY TO GETCORE AGAIN                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0324
*        IF TESTRC ^= 0                                            0324
*          THEN                                                    0324
         LTR   TESTRC,TESTRC                                       0324
         BZ    @RF00324                                            0324
*            DO;                                                   0325
*              CALL RELECORE;                                      0326
         BAL   @14,RELECORE                                        0326
*              CALL GETSTG;                                        0327
*                                                                  0327
         BAL   @14,GETSTG                                          0327
*              /******************************************************/
*              /*                                                    */
*              /* CHECK RETURN CODE FROM CORE REQUEST                */
*              /*                                                    */
*              /******************************************************/
*                                                                  0328
*              IF TESTRC ^= 0                                      0328
*                THEN                                              0328
         SLR   @07,@07                                             0328
         CR    TESTRC,@07                                          0328
         BE    @RF00328                                            0328
*                  DO;                                             0329
*                    SETRC = 4;                                    0330
         MVC   SETRC(2),@CH00037                                   0330
*                    GSPOINT = 0;                                  0331
         ST    @07,GSPOINT(,PARMPTR3)                              0331
*                  END;                                            0332
*                ELSE                                              0333
*                  SETRC = 0;                                      0333
         B     @RC00328                                            0333
@RF00328 SLR   @04,@04                                             0333
         STH   @04,SETRC                                           0333
*            END;                                                  0334
*          ELSE                                                    0335
*            SETRC = 0;                                            0335
         B     @RC00324                                            0335
@RF00324 SLR   @04,@04                                             0335
         STH   @04,SETRC                                           0335
*        IF SETRC = 0                                              0336
*          THEN                                                    0336
@RC00324 LH    @04,SETRC                                           0336
         LTR   @04,@04                                             0336
         BNZ   @RF00336                                            0336
*            DO;                                                   0337
*                                                                  0337
*                                                                  0337
*              /******************************************************/
*              /*                                                    */
*              /* INITIALIZE THE UGSPACE AREA CONTROL INFORMATION,   */
*              /* AND INITIALIZE THE UGSPACE AREA POINTER RETURNED   */
*              /* TO THE USER                                        */
*              /*                                                    */
*              /******************************************************/
*                                                                  0338
*              GSLEN = GETSZ;                                      0338
         L     @04,TEMPPTR                                         0338
         L     @15,GETSZ                                           0338
         ST    @15,GSLEN(,@04)                                     0338
*              GSID = ' ';                                         0339
         MVI   GSID+1(@04),C' '                                    0339
         MVC   GSID+2(2,@04),GSID+1(@04)                           0339
         MVI   GSID(@04),C' '                                      0339
*              GSPOINT = TEMPPTR + 8;                              0340
*                                                                  0340
         LA    @15,8                                               0340
         ALR   @15,@04                                             0340
         ST    @15,GSPOINT(,PARMPTR3)                              0340
*              /******************************************************/
*              /*                                                    */
*              /* BEFORE SETTING SUB-POOL ID, CHECK IF FIFTH         */
*              /* ARGUMENT IS SPECIFIED                              */
*              /*                                                    */
*              /******************************************************/
*                                                                  0341
*              IF LISTLN = 5                                       0341
*                THEN                                              0341
         CLI   LISTLN,5                                            0341
         BNE   @RF00341                                            0341
*                  GSSUBPID=GSSPID;                                0342
         L     @01,PARMPTR5                                        0342
         IC    @00,GSSPID(,@01)                                    0342
         STC   @00,GSSUBPID(,@04)                                  0342
*                ELSE                                              0343
*                  GSSUBPID = 0;                                   0343
*                                                                  0343
         B     @RC00341                                            0343
@RF00341 L     @04,TEMPPTR                                         0343
         MVI   GSSUBPID(@04),X'00'                                 0343
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF CORE INITIALIZATION REQUESTED BY CHECKING */
*              /* FOR FOURTH ARGUMENT                                */
*              /*                                                    */
*              /******************************************************/
*                                                                  0344
*              IF LISTLN >= 4                                      0344
*                THEN                                              0344
@RC00341 CLI   LISTLN,4                                            0344
         BL    @RF00344                                            0344
*                  DO;                                             0345
*                                                                  0345
*                    /************************************************/
*                    /*                                              */
*                    /* PREPARE FOR CORE INITIALIZATION              */
*                    /*                                              */
*                    /************************************************/
*                                                                  0346
*                    INITSIZE = GSSIZE;                            0346
         L     @04,GSSIZE(,PARMPTR2)                               0346
         ST    @04,INITSIZE                                        0346
*                    INITPTR = GSPOINT;                            0347
*                                                                  0347
         L     @04,GSPOINT(,PARMPTR3)                              0347
         ST    @04,INITPTR                                         0347
*                    /************************************************/
*                    /*                                              */
*                    /* CHECK FOR INVALID FOURTH ARGUMENT, ABORT     */
*                    /* IF INVALID                                   */
*                    /*                                              */
*                    /************************************************/
*                                                                  0348
*                    IF GSINIT ^= 'ZERO' & GSINIT ^= 'BLNK'        0348
*                              & GSINIT ^= 'NSET'         /*         */
*                      THEN                                        0348
*                                                                  0348
         CLC   GSINIT(4,PARMPTR4),@CC00138                         0348
         BE    @RF00348                                            0348
         CLC   GSINIT(4,PARMPTR4),@CC00140                         0348
         BE    @RF00348                                            0348
         CLC   GSINIT(4,PARMPTR4),@CC00142                         0348
         BE    @RF00348                                            0348
*                        DO;                                       0349
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      0350
*                          REG15 = ARGERR;                         0351
         LA    REG15,40                                            0351
*                          REG14 = GDTABT;                         0352
         L     REG14,GDTABT(,GDTPR)                                0352
*                          REG13 = GDTABH;                         0353
         L     REG13,GDTABH(,GDTPR)                                0353
*                          GEN(BR    REG14);                       0354
         BR    REG14
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     0355
*                        END;                                      0356
*                                                                  0356
*                    /************************************************/
*                    /*                                              */
*                    /* CHECK FOR ZERO INITIALIZATION REQUEST        */
*                    /*                                              */
*                    /************************************************/
*                                                                  0357
*                    IF GSINIT = 'ZERO'                            0357
*                      THEN                                        0357
*                                                                  0357
@RF00348 CLC   GSINIT(4,PARMPTR4),@CC00138                         0357
         BNE   @RF00357                                            0357
*                        /********************************************/
*                        /*                                          */
*                        /* ZERO AREA                                */
*                        /*                                          */
*                        /********************************************/
*                                                                  0358
*                        CALL COREINIT(INITSIZE,INITPTR,SET0);     0358
*                                                                  0358
         LA    @15,INITSIZE                                        0358
         ST    @15,@AL00001                                        0358
         LA    @15,INITPTR                                         0358
         ST    @15,@AL00001+4                                      0358
         LA    @15,SET0                                            0358
         ST    @15,@AL00001+8                                      0358
         LA    @01,@AL00001                                        0358
         BAL   @14,COREINIT                                        0358
*                        /********************************************/
*                        /*                                          */
*                        /* CHECK FOR BLANK INITIALIZATION           */
*                        /*                                          */
*                        /********************************************/
*                                                                  0359
*                      ELSE                                        0359
*                        IF GSINIT = 'BLNK'                        0359
*                          THEN                                    0359
*                                                                  0359
         B     @RC00357                                            0359
@RF00357 CLC   GSINIT(4,PARMPTR4),@CC00140                         0359
         BNE   @RF00359                                            0359
*                            /****************************************/
*                            /*                                      */
*                            /* BLANK AREA                           */
*                            /*                                      */
*                            /****************************************/
*                                                                  0360
*                            CALL COREINIT(INITSIZE,INITPTR,SETB); 0360
         LA    @15,INITSIZE                                        0360
         ST    @15,@AL00001                                        0360
         LA    @15,INITPTR                                         0360
         ST    @15,@AL00001+4                                      0360
         LA    @15,SETB                                            0360
         ST    @15,@AL00001+8                                      0360
         LA    @01,@AL00001                                        0360
         BAL   @14,COREINIT                                        0360
*                  END;                                            0361
*            END;                                                  0362
*          ELSE;                                                   0363
*                                                                  0363
@RF00336 DS    0H                                                  0364
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO THE UGSPACE CALLER                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0364
*        CALL ICKSAEP0(GDTTBL,MODID,SETRC);                        0364
@RC00336 ST    GDTPR,@AL00001                                      0364
         LA    @15,MODID                                           0364
         ST    @15,@AL00001+4                                      0364
         LA    @15,SETRC                                           0364
         ST    @15,@AL00001+8                                      0364
         MVI   @AL00001+8,X'80'                                    0364
         L     @15,GDTEPL(,GDTPR)                                  0364
         LA    @01,@AL00001                                        0364
         BALR  @14,@15                                             0364
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* UFSPACE ENTRY POINT                                      */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0365
*DMSSAFS:  ENTRY(GDTTBLX,FSPOINTX);                                0365
*                                                                  0365
@EC00365 DS    0H                                                  0366
*DMSSAFS1:                                                         0366
*                                                                  0366
*        DCL FSPOINT PTR(31) BASED;    /* SPACE ADDR FOR UGSPACE     */
*                                                                  0366
DMSSAFS1 DS    0H                                                  0367
*        RESPECIFY FSPOINT BASED(PARMPTR2);                        0367
*                                      /* BASE FSPOINT               */
*                                                                  0368
*        DCL SPIDPTR PTR(31);          /* PTR TO SUBPOOL ID          */
*                                                                  0368
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0369
*        RESPECIFY (REG1PTR) RSTD;                                 0369
*        GDTPR = ADDR1;                                            0370
         L     GDTPR,ADDR1(,REG1PTR)                               0370
*        PARMPTR2 = ADDR2;                                         0371
         LA    @15,4                                               0371
         LR    @14,REG1PTR                                         0371
         ALR   @14,@15                                             0371
         L     PARMPTR2,ADDR2(,@14)                                0371
*        RESPECIFY (REG1PTR) UNRSTD;                               0372
*                                                                  0372
*        OLDERID2 = NEWERID2;                                      0373
         L     @02,GDTTR2(,GDTPR)                                  0373
         MVC   @TS00001(95),NEWERID2(@02)                          0373
         MVC   OLDERID2(95,@02),@TS00001                           0373
*        NEWID2 = 'SAFS';                                          0374
*                                                                  0374
         MVC   NEWID2(4,@02),@CC00652                              0374
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF AREA TO BE FREED IS A UGSPACE OR UGPOOL AREA    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0375
*        TEMPPTR = FSPOINT - 4;                                    0375
         L     @02,FSPOINT(,PARMPTR2)                              0375
         SLR   @02,@15                                             0375
         ST    @02,TEMPPTR                                         0375
*        IF FREEID(1:3) = '   '                           /*         */
*          THEN                                                    0376
         CLC   FREEID(3,@02),@CC00653                              0376
         BNE   @RF00376                                            0376
*            DO;                                                   0377
*                                                                  0377
*              /******************************************************/
*              /*                                                    */
*              /* FREE UGSPACE AREA                                  */
*              /*                                                    */
*              /******************************************************/
*                                                                  0378
*              SPIDPTR = TEMPPTR - 4;                              0378
         L     @14,TEMPPTR                                         0378
         LCR   @15,@15                                             0378
         ALR   @15,@14                                             0378
         LR    SPIDPTR,@15                                         0378
*              SPIDPTR->GSLENID = FREEID(4:4);                     0379
         IC    @03,FREEID+3(,@14)                                  0379
         STC   @03,GSLENID(,SPIDPTR)                               0379
*              TEMPPTR = TEMPPTR - 4;                              0380
         ST    @15,TEMPPTR                                         0380
*              FREEPT = TEMPPTR;                                   0381
         ST    @15,FREEPT                                          0381
*              FREESZ = GSLEN;                                     0382
         L     @15,GSLEN(,@15)                                     0382
         ST    @15,FREESZ                                          0382
*              CALL FREESTG;                                       0383
         BAL   @14,FREESTG                                         0383
*            END;                                                  0384
*          ELSE                                                    0385
*            DO;                                                   0385
*                                                                  0385
         B     @RC00376                                            0385
@RF00376 DS    0H                                                  0386
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF UGPOOL AREA TO BE FREED IS THE LAST AREA  */
*              /* IN THE UGPOOL CHAIN                                */
*              /*                                                    */
*              /******************************************************/
*                                                                  0386
*              TEMPPTR = TEMPPTR - 12;                             0386
         L     @15,TEMPPTR                                         0386
         SL    @15,@CF00033                                        0386
         ST    @15,TEMPPTR                                         0386
*              IF GPLAST = TEMPPTR                                 0387
*                THEN                                              0387
         L     @14,GDTSAH(,GDTPR)                                  0387
         C     @15,GPLAST(,@14)                                    0387
         BNE   @RF00387                                            0387
*                  DO;                                             0388
*                                                                  0388
*                    /************************************************/
*                    /*                                              */
*                    /* UPDATE FORWARD CHAIN POINTER AND LAST UGPOOL */
*                    /* AREA POINTER                                 */
*                    /*                                              */
*                    /************************************************/
*                                                                  0389
*                    PREFWD = 0;                                   0389
         L     @15,GPBACK(,@15)                                    0389
         SLR   @07,@07                                             0389
         ST    @07,PREFWD(,@15)                                    0389
*                    GPLAST = GPBACK;                              0390
         ST    @15,GPLAST(,@14)                                    0390
*                  END;                                            0391
*                ELSE                                              0392
*                  DO;                                             0392
*                                                                  0392
         B     @RC00387                                            0392
@RF00387 DS    0H                                                  0393
*                    /************************************************/
*                    /*                                              */
*                    /* UPDATE FORWARD AND BACKWARD CHAIN POINTERS   */
*                    /*                                              */
*                    /************************************************/
*                                                                  0393
*                    PREFWD = GPFORWRD;                            0393
         L     @15,TEMPPTR                                         0393
         L     @14,GPBACK(,@15)                                    0393
         L     @15,GPFORWRD(,@15)                                  0393
         ST    @15,PREFWD(,@14)                                    0393
*                    PASBACK = GPBACK;                             0394
         ST    @14,PASBACK(,@15)                                   0394
*                  END;                                            0395
*                                                                  0395
*              /******************************************************/
*              /*                                                    */
*              /* FREE UGPOOL AREA                                   */
*              /*                                                    */
*              /******************************************************/
*                                                                  0396
*              FREEPT = TEMPPTR;                                   0396
@RC00387 L     @15,TEMPPTR                                         0396
         ST    @15,FREEPT                                          0396
*              FREESZ = GPLEN;                                     0397
         L     @15,GPLEN(,@15)                                     0397
         ST    @15,FREESZ                                          0397
*              CALL FREESTG;                                       0398
         BAL   @14,FREESTG                                         0398
*            END;                                                  0399
*                                                                  0399
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO THE UFSPACE CALLER                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0400
*        CALL ICKSAEP0(GDTTBL,MODID);                              0400
@RC00376 ST    GDTPR,@AL00001                                      0400
         LA    @15,MODID                                           0400
         ST    @15,@AL00001+4                                      0400
         MVI   @AL00001+4,X'80'                                    0400
         L     @15,GDTEPL(,GDTPR)                                  0400
         LA    @01,@AL00001                                        0400
         BALR  @14,@15                                             0400
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* UGPOOL ENTRY POINT                                       */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0401
*DMSSAGP:  ENTRY(GDTTBLX,GPSIZEX,GPPOINTX,GPIDVARX,GPINITX);       0401
*                                                                  0401
@EC00401 DS    0H                                                  0402
*DMSSAGP1:                                                         0402
*                                                                  0402
*        DCL GPSIZE FIXED(31) BASED;   /* SIZE FOR UGPOOL            */
*                                                                  0402
DMSSAGP1 DS    0H                                                  0403
*        DCL GPPOINT PTR(31) BASED;    /* ADDR FOR UGPOOL            */
*                                                                  0403
*        DCL GPIDVAR CHAR(4) BASED;    /* ID FOR UGPOOL              */
*                                                                  0404
*        DCL GPINIT CHAR(4) BASED;     /* UGPOOL INIT ARGUMENT       */
*                                                                  0405
*        DCL GPFCHAIN PTR(31) BASED(GPLAST);                       0406
*                                      /* UGPOOL FORWARD CHAIN       */
*                                                                  0407
*        RESPECIFY GPSIZE BASED(PARMPTR2);                         0407
*                                      /* BASE GPSIZE                */
*                                                                  0408
*        RESPECIFY GPPOINT BASED(PARMPTR3);                        0408
*                                      /* BASE GPPOINT               */
*                                                                  0409
*        RESPECIFY GPIDVAR BASED(PARMPTR4);                        0409
*                                      /* BASE GPIDVAR               */
*                                                                  0410
*        RESPECIFY GPINIT BASED(PARMPTR5);                         0410
*                                      /* BASE GPINIT                */
*                                                                  0411
*        DCL PGCNTPTR PTR(31);         /* PTR TO 24-BYTE CONTROL INFO
*                                                                    */
*                                                                  0411
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0412
*        RESPECIFY (REG1PTR) RSTD;                                 0412
*        GDTPR = ADDR1;                                            0413
         L     GDTPR,ADDR1(,REG1PTR)                               0413
*        PARMPTR2 = ADDR2;                                         0414
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0414
*        PARMPTR3 = ADDR3;                                         0415
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0415
*        PARMPTR4 = ADDR4;                                         0416
         L     PARMPTR4,ADDR4+12(,REG1PTR)                         0416
*        PARMPTR5 = ADDR5;                                         0417
         L     @04,ADDR5+16(,REG1PTR)                              0417
         ST    @04,PARMPTR5                                        0417
*        RESPECIFY (REG1PTR) UNRSTD;                               0418
*                                                                  0418
*                                                                  0418
*                                                                  0419
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0419
*        GEN;                                                      0419
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0420
         LA    @04,1                                               0420
         STC   @04,LISTLN                                          0420
@DL00420 L     @15,LISTSCAN                                        0420
         TM    LISTTEST(@15),B'10000000'                           0420
         BNZ   @DC00420                                            0420
*          LISTSCAN = LISTSCAN + 4;                                0421
         AL    @15,@CF00037                                        0421
         ST    @15,LISTSCAN                                        0421
*        END;                                                      0422
*                                                                  0422
         AL    @04,@CF00158                                        0422
         STC   @04,LISTLN                                          0422
         C     @04,@CF00634                                        0422
         BNH   @DL00420                                            0422
@DC00420 DS    0H                                                  0423
*        OLDERID2 = NEWERID2;                                      0423
         L     @04,GDTTR2(,GDTPR)                                  0423
         MVC   @TS00001(95),NEWERID2(@04)                          0423
         MVC   OLDERID2(95,@04),@TS00001                           0423
*        NEWID2 = 'SAGP';                                          0424
*                                                                  0424
         MVC   NEWID2(4,@04),@CC00680                              0424
*        RESPECIFY (REG4) RSTD;                                    0425
*                                                                  0425
*        /************************************************************/
*        /*                                                          */
*        /* CHECK FOR A GET POOL REQUEST ON A PAGE BOUNDARY, IF YES, */
*        /* A GETMAIN MUST BE ISSUED FOR THE PAGE BOUNDARY           */
*        /* CORE WITH NO CONTROL INFORMATION AREA, OTHERWISE         */
*        /* THE CONTROL INFORMATION IS ADDED TO THE GETMAIN          */
*        /* REQUEST.                                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0426
*        IF GPIDVAR(3:4) = 'PG'                                    0426
*          THEN                                                    0426
         CLC   GPIDVAR+2(2,PARMPTR4),@CC00681                      0426
         BNE   @RF00426                                            0426
*            DO;                                                   0427
*              GETLIST = GETGENPG;                                 0428
         MVC   GETLIST(10),GETGENPG                                0428
*              GETSZ = GPSIZE;                                     0429
         L     @15,GPSIZE(,PARMPTR2)                               0429
         ST    @15,GETSZ                                           0429
*            END;                                                  0430
*          ELSE                                                    0431
*            DO;                                                   0431
         B     @RC00426                                            0431
@RF00426 DS    0H                                                  0432
*              GETLIST = GETGEN;                                   0432
         MVC   GETLIST(10),GETGEN                                  0432
*              GETSZ = GPSIZE + 16;                                0433
         LA    @15,16                                              0433
         AL    @15,GPSIZE(,PARMPTR2)                               0433
         ST    @15,GETSZ                                           0433
*            END;                                                  0434
*                                                                  0434
*        /************************************************************/
*        /*                                                          */
*        /* OBTAIN THE REQUESTED STORAGE                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0435
*        GETPT = ADDR(TEMPPTR);                                    0435
@RC00426 LA    @07,TEMPPTR                                         0435
         ST    @07,GETPT                                           0435
*        CALL GETSTG;                                              0436
*                                                                  0436
*                                                                  0436
         BAL   @14,GETSTG                                          0436
*        /************************************************************/
*        /*                                                          */
*        /* CHECK RETURN CODE FROM CORE REQUEST                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0437
*        IF TESTRC ^= 0                                            0437
*          THEN                                                    0437
         LTR   TESTRC,TESTRC                                       0437
         BZ    @RF00437                                            0437
*            DO;                                                   0438
*              /******************************************************/
*              /*                                                    */
*              /* NO CORE AVAILABLE DELETE MODULES NOT IN            */
*              /* USE AND TRY GET CORE AGAIN                         */
*              /*                                                    */
*              /******************************************************/
*                                                                  0439
*              CALL RELECORE;                                      0439
         BAL   @14,RELECORE                                        0439
*              CALL GETSTG;                                        0440
*                                                                  0440
         BAL   @14,GETSTG                                          0440
*              /******************************************************/
*              /*                                                    */
*              /* CHECK RETURN CODE FROM CORE REQUEST                */
*              /*                                                    */
*              /******************************************************/
*                                                                  0441
*              IF TESTRC ^= 0                                      0441
*                THEN                                              0441
         SLR   @07,@07                                             0441
         CR    TESTRC,@07                                          0441
         BE    @RF00441                                            0441
*                  DO;                                             0442
*                    SETRC = 4;                                    0443
         MVC   SETRC(2),@CH00037                                   0443
*                    GPPOINT = 0;                                  0444
         ST    @07,GPPOINT(,PARMPTR3)                              0444
*                  END;                                            0445
*                ELSE                                              0446
*                  SETRC = 0;                                      0446
         B     @RC00441                                            0446
@RF00441 SLR   @07,@07                                             0446
         STH   @07,SETRC                                           0446
*            END;                                                  0447
*          ELSE                                                    0448
*            SETRC = 0;                                            0448
         B     @RC00437                                            0448
@RF00437 SLR   @07,@07                                             0448
         STH   @07,SETRC                                           0448
*        IF TESTRC = 0                                             0449
*          THEN                                                    0449
@RC00437 LTR   TESTRC,TESTRC                                       0449
         BNZ   @RF00449                                            0449
*            DO;                                                   0450
*                                                                  0450
*                                                                  0450
*              /******************************************************/
*              /*                                                    */
*              /* CHECK FOR A GET POOL REQUEST ON A PAGE BOUNDARY,   */
*              /* IF YES, ISSUE GETMAIN FOR A 24-BYTE                */
*              /* CONTROL INFORMATION AREA.                          */
*              /*                                                    */
*              /******************************************************/
*                                                                  0451
*              IF GPIDVAR(3:4) = 'PG'                              0451
*                THEN                                              0451
         CLC   GPIDVAR+2(2,PARMPTR4),@CC00681                      0451
         BNE   @RF00451                                            0451
*PGCNTRL:          DO;                                             0452
PGCNTRL  DS    0H                                                  0453
*                    GETLIST = GETGEN;                             0453
         MVC   GETLIST(10),GETGEN                                  0453
*                    GETSZ = PGCTLEN;                              0454
         L     @07,PGCTLEN                                         0454
         ST    @07,GETSZ                                           0454
*                    GETPT = ADDR(PGCNTPTR);                       0455
         LA    @07,PGCNTPTR                                        0455
         ST    @07,GETPT                                           0455
*                    CALL GETSTG;                                  0456
*                                                                  0456
         BAL   @14,GETSTG                                          0456
*                    /************************************************/
*                    /*                                              */
*                    /* CKECK RETURN CODE FROM CORE REQUEST          */
*                    /*                                              */
*                    /************************************************/
*                                                                  0457
*                    IF TESTRC ^= 0                                0457
*                      THEN                                        0457
         LTR   TESTRC,TESTRC                                       0457
         BZ    @RF00457                                            0457
*                        DO;                                       0458
*                                                                  0458
*                          /******************************************/
*                          /*                                        */
*                          /* NO CORE AVAILABLE DELETE MODULES       */
*                          /* NOT IN USE AND TRY TO GET CORE AGAIN   */
*                          /*                                        */
*                          /******************************************/
*                                                                  0459
*                          CALL RELECORE;                          0459
         BAL   @14,RELECORE                                        0459
*                          CALL GETSTG;                            0460
*                                                                  0460
         BAL   @14,GETSTG                                          0460
*                            IF TESTRC ^= 0                        0461
*                              THEN                                0461
         SLR   @08,@08                                             0461
         CR    TESTRC,@08                                          0461
         BE    @RF00461                                            0461
*                                DO;                               0462
*                                  /**********************************/
*                                  /*                                */
*                                  /* THE REQUEST FOR MAIN STORAGE   */
*                                  /* FAILED,SET THE RETURN CODE,ZERO*/
*                                  /* OUT USER GETPOOL PTR, FREE THE */
*                                  /* PAGE BOUNDARY CORE AND RETURN  */
*                                  /* TO THE UGPOOL CALLER.          */
*                                  /*                                */
*                                  /**********************************/
*                                                                  0463
*                                  SETRC = 4;                      0463
         MVC   SETRC(2),@CH00037                                   0463
*                                  GPPOINT = 0;                    0464
*                                                                  0464
         ST    @08,GPPOINT(,PARMPTR3)                              0464
*                                  FREEPT = TEMPPTR;               0465
         L     @08,TEMPPTR                                         0465
         ST    @08,FREEPT                                          0465
*                                  FREESZ = GPSIZE;                0466
         L     @08,GPSIZE(,PARMPTR2)                               0466
         ST    @08,FREESZ                                          0466
*                                  CALL FREESTG;                   0467
*                                                                  0467
         BAL   @14,FREESTG                                         0467
*                                  CALL ICKSAEP0(GDTTBL,MODID,SETRC);
         ST    GDTPR,@AL00001                                      0468
         LA    @08,MODID                                           0468
         ST    @08,@AL00001+4                                      0468
         LA    @08,SETRC                                           0468
         ST    @08,@AL00001+8                                      0468
         MVI   @AL00001+8,X'80'                                    0468
         L     @15,GDTEPL(,GDTPR)                                  0468
         LA    @01,@AL00001                                        0468
         BALR  @14,@15                                             0468
*                                END;                              0469
*                        END;                                      0470
@RF00461 DS    0H                                                  0471
*                  END PGCNTRL;                                    0471
*                                                                  0471
@RF00457 DS    0H                                                  0472
*              /******************************************************/
*              /*                                                    */
*              /* INITIALIZE THE UGPOOL AREA CONTROL INFORMATION,    */
*              /* AND INITIALIZE THE UGPOOL AREA POINTER RETURNED TO */
*              /* THE USER                                           */
*              /* NOTE - FOR A 24-BYTE CONTROL INFORMATION           */
*              /* AREA, THE ADDR AND LEN OF THE PAGE BOUNDARY        */
*              /* CORE IS STORED IN WORDS 5 AND 6.                   */
*              /*                                                    */
*              /******************************************************/
*                                                                  0472
*              IF GPIDVAR(3:4) = 'PG'                              0472
*                THEN                                              0472
@RF00451 CLC   GPIDVAR+2(2,PARMPTR4),@CC00681                      0472
         BNE   @RF00472                                            0472
*                  DO;                                             0473
*                    PGCNTPTR->GPADRPG = TEMPPTR;                  0474
         L     @08,TEMPPTR                                         0474
         L     @15,PGCNTPTR                                        0474
         ST    @08,GPADRPG(,@15)                                   0474
*                    PGCNTPTR->GPLENPG = GPSIZE;                   0475
         L     @14,GPSIZE(,PARMPTR2)                               0475
         ST    @14,GPLENPG(,@15)                                   0475
*                    PGCNTPTR->GPLEN = PGCTLEN;                    0476
         L     @14,PGCTLEN                                         0476
         ST    @14,GPLEN(,@15)                                     0476
*                    GPPOINT = TEMPPTR;                            0477
         ST    @08,GPPOINT(,PARMPTR3)                              0477
*                    TEMPPTR = PGCNTPTR;                           0478
         ST    @15,TEMPPTR                                         0478
*                  END;                                            0479
*                ELSE                                              0480
*                  DO;                                             0480
         B     @RC00472                                            0480
@RF00472 DS    0H                                                  0481
*                    GPLEN = GPSIZE + 16;                          0481
         L     @08,TEMPPTR                                         0481
         LA    @15,16                                              0481
         L     @14,GPSIZE(,PARMPTR2)                               0481
         ALR   @14,@15                                             0481
         ST    @14,GPLEN(,@08)                                     0481
*                    GPPOINT = TEMPPTR + 16;                       0482
         ALR   @08,@15                                             0482
         ST    @08,GPPOINT(,PARMPTR3)                              0482
*                  END;                                            0483
*                                                                  0483
*                                                                  0483
*              GPFORWRD = 0;                                       0484
@RC00472 L     @08,TEMPPTR                                         0484
         SLR   @15,@15                                             0484
         ST    @15,GPFORWRD(,@08)                                  0484
*              GPID = GPIDVAR;                                     0485
         MVC   GPID(4,@08),GPIDVAR(PARMPTR4)                       0485
*              GPBACK = GPLAST;                                    0486
         L     @05,GDTSAH(,GDTPR)                                  0486
         L     @15,GPLAST(,@05)                                    0486
         ST    @15,GPBACK(,@08)                                    0486
*              GPFCHAIN = TEMPPTR;                                 0487
         ST    @08,GPFCHAIN(,@15)                                  0487
*              GPLAST = TEMPPTR;                                   0488
*                                                                  0488
         ST    @08,GPLAST(,@05)                                    0488
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF CORE INITIALIZATION REQUESTED             */
*              /*                                                    */
*              /******************************************************/
*                                                                  0489
*              IF LISTLN = 5                                       0489
*                THEN                                              0489
         CLI   LISTLN,5                                            0489
         BNE   @RF00489                                            0489
*                  DO;                                             0490
*                                                                  0490
*                    /************************************************/
*                    /*                                              */
*                    /* PREPARE FOR CORE INITIALIZATION              */
*                    /*                                              */
*                    /************************************************/
*                                                                  0491
*                    INITSIZE = GPSIZE;                            0491
         L     @08,GPSIZE(,PARMPTR2)                               0491
         ST    @08,INITSIZE                                        0491
*                    INITPTR = GPPOINT;                            0492
*                                                                  0492
         L     @08,GPPOINT(,PARMPTR3)                              0492
         ST    @08,INITPTR                                         0492
*                    /************************************************/
*                    /*                                              */
*                    /* CHECK FOR INVALID LAST ARGUMENT              */
*                    /*                                              */
*                    /************************************************/
*                                                                  0493
*                    IF GPINIT ^= 'BLNK' & GPINIT ^= 'ZERO'        0493
*                      THEN                                        0493
*                                                                  0493
         L     @08,PARMPTR5                                        0493
         CLC   GPINIT(4,@08),@CC00140                              0493
         BE    @RF00493                                            0493
         CLC   GPINIT(4,@08),@CC00138                              0493
         BE    @RF00493                                            0493
*                        DO;                                       0494
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      0495
*                          REG15 = ARGERR;                         0496
         LA    REG15,40                                            0496
*                          REG14 = GDTABT;                         0497
         L     REG14,GDTABT(,GDTPR)                                0497
*                          REG13 = GDTABH;                         0498
         L     REG13,GDTABH(,GDTPR)                                0498
*                          GEN(BR    REG14);                       0499
         BR    REG14
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     0500
*                        END;                                      0501
*                                                                  0501
*                    /************************************************/
*                    /*                                              */
*                    /* CHECK FOR ZERO INITIALIZATION REQUEST        */
*                    /*                                              */
*                    /************************************************/
*                                                                  0502
*                    IF GPINIT = 'ZERO'                            0502
*                      THEN                                        0502
*                                                                  0502
@RF00493 L     @08,PARMPTR5                                        0502
         CLC   GPINIT(4,@08),@CC00138                              0502
         BNE   @RF00502                                            0502
*                        /********************************************/
*                        /*                                          */
*                        /* ZERO AREA                                */
*                        /*                                          */
*                        /********************************************/
*                                                                  0503
*                        CALL COREINIT(INITSIZE,INITPTR,SET0);     0503
         LA    @08,INITSIZE                                        0503
         ST    @08,@AL00001                                        0503
         LA    @08,INITPTR                                         0503
         ST    @08,@AL00001+4                                      0503
         LA    @08,SET0                                            0503
         ST    @08,@AL00001+8                                      0503
         LA    @01,@AL00001                                        0503
         BAL   @14,COREINIT                                        0503
*                      ELSE                                        0504
*                                                                  0504
*                        /********************************************/
*                        /*                                          */
*                        /* BLANK AREA                               */
*                        /*                                          */
*                        /********************************************/
*                                                                  0504
*                        CALL COREINIT(INITSIZE,INITPTR,SETB);     0504
         B     @RC00502                                            0504
@RF00502 LA    @08,INITSIZE                                        0504
         ST    @08,@AL00001                                        0504
         LA    @08,INITPTR                                         0504
         ST    @08,@AL00001+4                                      0504
         LA    @08,SETB                                            0504
         ST    @08,@AL00001+8                                      0504
         LA    @01,@AL00001                                        0504
         BAL   @14,COREINIT                                        0504
*                  END;                                            0505
*            END;                                                  0506
*          ELSE;                                                   0507
*                                                                  0507
@RF00449 DS    0H                                                  0508
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO THE UGPOOL CALLER                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0508
*        CALL ICKSAEP0(GDTTBL,MODID,SETRC);                        0508
@RC00449 ST    GDTPR,@AL00001                                      0508
         LA    @08,MODID                                           0508
         ST    @08,@AL00001+4                                      0508
         LA    @08,SETRC                                           0508
         ST    @08,@AL00001+8                                      0508
         MVI   @AL00001+8,X'80'                                    0508
         L     @15,GDTEPL(,GDTPR)                                  0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* UFPOOL ENTRY POINT                                       */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0509
*DMSSAFP:  ENTRY(GDTTBLX,FPIDVARX,FPALLX);                         0509
*                                                                  0509
@EC00509 DS    0H                                                  0510
*DMSSAFP1:                                                         0510
*                                                                  0510
*        DCL FPIDVAR CHAR(4) BASED;    /* SPACE ID FOR UFPOOL        */
*                                                                  0510
DMSSAFP1 DS    0H                                                  0511
*        DCL FPALL CHAR(3) BASED;      /* UFPOOL ALL ARGUMENT        */
*                                                                  0511
*        RESPECIFY FPIDVAR BASED(PARMPTR2);                        0512
*                                      /* BASE FPIDVAR               */
*                                                                  0513
*        RESPECIFY FPALL BASED(PARMPTR3);                          0513
*                                      /* BASE FPALL                 */
*                                                                  0514
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0514
*        RESPECIFY (REG1PTR) RSTD;                                 0514
*        GDTPR = ADDR1;                                            0515
         L     GDTPR,ADDR1(,REG1PTR)                               0515
*        PARMPTR2 = ADDR2;                                         0516
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0516
*        PARMPTR3 = ADDR3;                                         0517
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0517
*        RESPECIFY (REG1PTR) UNRSTD;                               0518
*                                                                  0518
*                                                                  0518
*                                                                  0519
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0519
*        GEN;                                                      0519
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0520
         LA    @08,1                                               0520
         STC   @08,LISTLN                                          0520
@DL00520 L     @05,LISTSCAN                                        0520
         TM    LISTTEST(@05),B'10000000'                           0520
         BNZ   @DC00520                                            0520
*          LISTSCAN = LISTSCAN + 4;                                0521
         AL    @05,@CF00037                                        0521
         ST    @05,LISTSCAN                                        0521
*        END;                                                      0522
*                                                                  0522
         AL    @08,@CF00158                                        0522
         STC   @08,LISTLN                                          0522
         C     @08,@CF00634                                        0522
         BNH   @DL00520                                            0522
@DC00520 DS    0H                                                  0523
*        OLDERID2 = NEWERID2;                                      0523
         L     @08,GDTTR2(,GDTPR)                                  0523
         MVC   @TS00001(95),NEWERID2(@08)                          0523
         MVC   OLDERID2(95,@08),@TS00001                           0523
*        NEWID2 = 'SAFP';                                          0524
*                                                                  0524
         MVC   NEWID2(4,@08),@CC00699                              0524
*        /************************************************************/
*        /*                                                          */
*        /* CHECK FOR INVALID LAST ARGUMENT                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0525
*        IF LISTPTR = 3 & FPALL ^= 'ALL'                           0525
*          THEN                                                    0525
*                                                                  0525
         CLC   LISTPTR(4),@CF00129                                 0525
         BNE   @RF00525                                            0525
         CLC   FPALL(3,PARMPTR3),@CC00130                          0525
         BE    @RF00525                                            0525
*            DO;                                                   0526
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0527
*              REG15 = ARGERR;                                     0528
         LA    REG15,40                                            0528
*              REG14 = GDTABT;                                     0529
         L     REG14,GDTABT(,GDTPR)                                0529
*              REG13 = GDTABH;                                     0530
         L     REG13,GDTABH(,GDTPR)                                0530
*              GEN(BR    REG14);                                   0531
         BR    REG14
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0532
*            END;                                                  0533
*                                                                  0533
*        /************************************************************/
*        /*                                                          */
*        /* CHECK FOR NO UGPOOL AREAS TO FREE                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0534
*        IF GPFIRST = 0                                            0534
*          THEN                                                    0534
@RF00525 L     @08,GDTSAH(,GDTPR)                                  0534
         L     @08,GPFIRST(,@08)                                   0534
         LTR   @08,@08                                             0534
         BNZ   @RF00534                                            0534
*            DO;                                                   0535
*              CALL ICKSAEP0(GDTTBL,MODID);                        0536
         ST    GDTPR,@AL00001                                      0536
         LA    @08,MODID                                           0536
         ST    @08,@AL00001+4                                      0536
         MVI   @AL00001+4,X'80'                                    0536
         L     @15,GDTEPL(,GDTPR)                                  0536
         LA    @01,@AL00001                                        0536
         BALR  @14,@15                                             0536
*            END;                                                  0537
*                                                                  0537
*        /************************************************************/
*        /*                                                          */
*        /* SCAN UGPOOL AREAS AND RELEASE AREAS TO BE RELEASED       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0538
*        DOCNTRL = ON;                                             0538
@RF00534 OI    DOCNTRL,B'10000000'                                 0538
*        TEMPPTR = GPFIRST;                                        0539
         L     @08,GDTSAH(,GDTPR)                                  0539
         L     @08,GPFIRST(,@08)                                   0539
         ST    @08,TEMPPTR                                         0539
*FPDO:   DO WHILE (DOCNTRL = ON);                                  0540
*                                                                  0540
FPDO     B     @DE00540                                            0540
@DL00540 DS    0H                                                  0541
*          /**********************************************************/
*          /*                                                        */
*          /* CHECK IF THIS AREA IS TO BE FREED                      */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0541
*          IF (LISTLN=3 & GPID(1:2)=FPIDVAR(1:2))  (GPID=FPIDVAR) 0541
*            THEN                                                  0541
         CLI   LISTLN,3                                            0541
         BNE   @GL00005                                            0541
         L     @08,TEMPPTR                                         0541
         CLC   GPID(2,@08),FPIDVAR(PARMPTR2)                       0541
         BE    @RT00541                                            0541
@GL00005 L     @08,TEMPPTR                                         0541
         CLC   GPID(4,@08),FPIDVAR(PARMPTR2)                       0541
         BNE   @RF00541                                            0541
@RT00541 DS    0H                                                  0542
*              DO;                                                 0542
*                                                                  0542
*                /****************************************************/
*                /*                                                  */
*                /* CHECK IF UGPOOL AREA TO BE FREED IS THE LAST AREA*/
*                /* IN THE UGPOOL CHAIN                              */
*                /*                                                  */
*                /****************************************************/
*                                                                  0543
*                IF GPLAST = TEMPPTR                               0543
*                  THEN                                            0543
         L     @08,TEMPPTR                                         0543
         L     @05,GDTSAH(,GDTPR)                                  0543
         C     @08,GPLAST(,@05)                                    0543
         BNE   @RF00543                                            0543
*                    DO;                                           0544
*                                                                  0544
*                      /**********************************************/
*                      /*                                            */
*                      /* UPDATE FORWARD CHAIN POINTER AND LAST      */
*                      /* UGPOOL AREA POINTER, AND SET DOCNTRL TO    */
*                      /* FALL OUT OF DO WHILE LOOP                  */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0545
*                      DOCNTRL = OFF;                              0545
         NI    DOCNTRL,B'01111111'                                 0545
*                      PREFWD = 0;                                 0546
         L     @08,GPBACK(,@08)                                    0546
         SLR   @02,@02                                             0546
         ST    @02,PREFWD(,@08)                                    0546
*                      GPLAST = GPBACK;                            0547
         ST    @08,GPLAST(,@05)                                    0547
*                    END;                                          0548
*                  ELSE                                            0549
*                    DO;                                           0549
*                                                                  0549
         B     @RC00543                                            0549
@RF00543 DS    0H                                                  0550
*                      /**********************************************/
*                      /*                                            */
*                      /* UPDATE FORWARD AND BACKWARD CHAIN POINTERS */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0550
*                      PREFWD = GPFORWRD;                          0550
         L     @08,TEMPPTR                                         0550
         L     @05,GPBACK(,@08)                                    0550
         L     @08,GPFORWRD(,@08)                                  0550
         ST    @08,PREFWD(,@05)                                    0550
*                      PASBACK = GPBACK;                           0551
         ST    @05,PASBACK(,@08)                                   0551
*                    END;                                          0552
*                                                                  0552
*                /****************************************************/
*                /*                                                  */
*                /* CHECK FOR A 24-BYTE CONTROL INFORMATION AREA     */
*                /* REQUIRED FOR THE SPACE GOTTEN ON THE PAGE        */
*                /* BOUNDARY.                                        */
*                /*                                                  */
*                /****************************************************/
*                                                                  0553
*                IF GPID(3:4) = 'PG'                               0553
*                  THEN                                            0553
*                                                                  0553
@RC00543 L     @08,TEMPPTR                                         0553
         CLC   GPID+2(2,@08),@CC00681                              0553
         BNE   @RF00553                                            0553
*                    /************************************************/
*                    /*                                              */
*                    /* FREE THE PAGE BOUNDARY AREA.  THE SPACE      */
*                    /* TO BE FREED IS POINTED TO BY THE 5-WORD      */
*                    /* OF THE 24-BYTE CONTROL INFORMATION           */
*                    /* AREA.                                        */
*                    /*                                              */
*                    /************************************************/
*                                                                  0554
*                    DO;                                           0554
*                      FREEPT = GPADRPG;                           0555
         L     @05,GPADRPG(,@08)                                   0555
         ST    @05,FREEPT                                          0555
*                      FREESZ = GPLENPG;                           0556
         L     @08,GPLENPG(,@08)                                   0556
         ST    @08,FREESZ                                          0556
*                      CALL FREESTG;                               0557
         BAL   @14,FREESTG                                         0557
*                    END;                                          0558
*                                                                  0558
*                /****************************************************/
*                /*                                                  */
*                /* FREE UGPOOL AREA                                 */
*                /*                                                  */
*                /****************************************************/
*                                                                  0559
*                FREEPT = TEMPPTR;                                 0559
@RF00553 L     @08,TEMPPTR                                         0559
         ST    @08,FREEPT                                          0559
*                FREESZ = GPLEN;                                   0560
         L     @05,GPLEN(,@08)                                     0560
         ST    @05,FREESZ                                          0560
*                TEMPPTR = GPFORWRD;                               0561
         L     @08,GPFORWRD(,@08)                                  0561
         ST    @08,TEMPPTR                                         0561
*                CALL FREESTG;                                     0562
         BAL   @14,FREESTG                                         0562
*              END;                                                0563
*            ELSE                                                  0564
*              DO;                                                 0564
*                                                                  0564
         B     @RC00541                                            0564
@RF00541 DS    0H                                                  0565
*                /****************************************************/
*                /*                                                  */
*                /* CHECK IF UGPOOL AREA EXAMINED IS THE LAST AREA   */
*                /* IN THE UGPOOL CHAIN                              */
*                /*                                                  */
*                /****************************************************/
*                                                                  0565
*                IF GPLAST = TEMPPTR                               0565
*                  THEN                                            0565
*                                                                  0565
         L     @08,GDTSAH(,GDTPR)                                  0565
         CLC   GPLAST(4,@08),TEMPPTR                               0565
         BNE   @RF00565                                            0565
*                    /************************************************/
*                    /*                                              */
*                    /* SET DOCNTRL TO FALL OUT OF DO WHILE LOOP     */
*                    /*                                              */
*                    /************************************************/
*                                                                  0566
*                    DOCNTRL = OFF;                                0566
         NI    DOCNTRL,B'01111111'                                 0566
*                  ELSE                                            0567
*                                                                  0567
*                    /************************************************/
*                    /*                                              */
*                    /* UPDATE UGPOOL AREA SCAN POINTER FOR NEXT     */
*                    /* ITERATION                                    */
*                    /*                                              */
*                    /************************************************/
*                                                                  0567
*                    TEMPPTR = GPFORWRD;                           0567
         B     @RC00565                                            0567
@RF00565 L     @08,TEMPPTR                                         0567
         L     @08,GPFORWRD(,@08)                                  0567
         ST    @08,TEMPPTR                                         0567
*              END;                                                0568
@RC00565 DS    0H                                                  0569
*        END FPDO;                                                 0569
*                                                                  0569
@RC00541 DS    0H                                                  0569
@DE00540 TM    DOCNTRL,B'10000000'                                 0569
         BO    @DL00540                                            0569
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO THE UFPOOL CALLER                              */
*        /*                                                          */
*        /************************************************************/
*        CALL ICKSAEP0(GDTTBL,MODID);                              0570
         ST    GDTPR,@AL00001                                      0570
         LA    @08,MODID                                           0570
         ST    @08,@AL00001+4                                      0570
         MVI   @AL00001+4,X'80'                                    0570
         L     @15,GDTEPL(,GDTPR)                                  0570
         LA    @01,@AL00001                                        0570
         BALR  @14,@15                                             0570
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* UTIME ENTRY POINT                                        */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0571
*DMSSATI:  ENTRY(GDTTBLX,TITIMEX,TIDATEX,TIFORMX);                 0571
*                                                                  0571
@EC00571 DS    0H                                                  0572
*DMSSATI1:                                                         0572
*                                                                  0572
*        DCL TIDATE CHAR(8) BASED;     /* DATE FOR UTIME             */
*                                                                  0572
DMSSATI1 DS    0H                                                  0573
*        DCL TITIME CHAR(8) BASED;     /* TIME FOR UTIME             */
*                                                                  0573
*        DCL TIFORM CHAR(4) BASED;     /* FORMAT FOR UTIME           */
*                                                                  0574
*        RESPECIFY TIDATE BASED(PARMPTR3);                         0575
*                                      /* BASE TIDATE                */
*                                                                  0576
*        RESPECIFY TITIME BASED(PARMPTR2);                         0576
*                                      /* BASE TITIME                */
*                                                                  0577
*        RESPECIFY TIFORM BASED(PARMPTR4);                         0577
*                                      /* BASE TIFORM                */
*                                                                  0578
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0578
*        RESPECIFY (REG1PTR) RSTD;                                 0578
*        GDTPR = ADDR1;                                            0579
         L     GDTPR,ADDR1(,REG1PTR)                               0579
*        PARMPTR2 = ADDR2;                                         0580
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0580
*        PARMPTR3 = ADDR3;                                         0581
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0581
*        PARMPTR4 = ADDR4;                                         0582
         L     PARMPTR4,ADDR4+12(,REG1PTR)                         0582
*        RESPECIFY (REG1PTR) UNRSTD;                               0583
*                                                                  0583
*                                                                  0583
*                                                                  0584
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0584
*        GEN;                                                      0584
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0585
         LA    @08,1                                               0585
         STC   @08,LISTLN                                          0585
@DL00585 L     @15,LISTSCAN                                        0585
         TM    LISTTEST(@15),B'10000000'                           0585
         BNZ   @DC00585                                            0585
*          LISTSCAN = LISTSCAN + 4;                                0586
         AL    @15,@CF00037                                        0586
         ST    @15,LISTSCAN                                        0586
*        END;                                                      0587
*                                                                  0587
         AL    @08,@CF00158                                        0587
         STC   @08,LISTLN                                          0587
         C     @08,@CF00634                                        0587
         BNH   @DL00585                                            0587
@DC00585 DS    0H                                                  0588
*        OLDERID2 = NEWERID2;                                      0588
         L     @08,GDTTR2(,GDTPR)                                  0588
         MVC   @TS00001(95),NEWERID2(@08)                          0588
         MVC   OLDERID2(95,@08),@TS00001                           0588
*        NEWID2 = 'SATI';                                          0589
*                                                                  0589
         MVC   NEWID2(4,@08),@CC00721                              0589
*        /************************************************************/
*        /*                                                          */
*        /* CALL THE UTIME MODULE ICKSA05                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0590
*        CALL ICKSACL0(GDTTBL,'ICKSA05 ',TITIME,TIDATE,TIFORM,LISTLN);
*                                                                  0590
         ST    GDTPR,@AL00001                                      0590
         LA    @08,@CC00722                                        0590
         ST    @08,@AL00001+4                                      0590
         ST    PARMPTR2,@AL00001+8                                 0590
         ST    PARMPTR3,@AL00001+12                                0590
         ST    PARMPTR4,@AL00001+16                                0590
         LA    @08,LISTLN                                          0590
         ST    @08,@AL00001+20                                     0590
         MVI   @AL00001+20,X'80'                                   0590
         L     @15,GDTCAL(,GDTPR)                                  0590
         LA    @01,@AL00001                                        0590
         BALR  @14,@15                                             0590
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO THE UTIME CALLER                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0591
*        CALL ICKSAEP0(GDTTBL,MODID);                              0591
         ST    GDTPR,@AL00001                                      0591
         LA    @08,MODID                                           0591
         ST    @08,@AL00001+4                                      0591
         MVI   @AL00001+4,X'80'                                    0591
         L     @15,GDTEPL(,GDTPR)                                  0591
         LA    @01,@AL00001                                        0591
         BALR  @14,@15                                             0591
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* USNAP ENTRY POINT                                        */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0592
*DMSSASN:  ENTRY(GDTTBLX,SNAPIDX);                                 0592
*                                                                  0592
@EC00592 DS    0H                                                  0593
*DMSSASN1:                                                         0593
*                                                                  0593
*                                                                  0593
*        DCL SNAPID FIXED(15) BASED;   /* SNAP IDENTIFIER            */
*                                                                  0593
DMSSASN1 DS    0H                                                  0594
*        RESPECIFY SNAPID BASED(PARMPTR2);                         0594
*                                      /* BASE SNAPID                */
*                                                                  0595
*        /* OPEN MACRO LIST                                          */
*        DCL 1 OPENLIST CHAR(4) BDY(WORD),                         0595
*              2 OPENOPT CHAR(1),      /* OPEN OPTIONS               */
*              2 OPENADDR PTR(24);     /* DCB ADDRESS                */
*                                                                  0595
*        /* SNAP MACRO LIST                                          */
*        DCL 1 SNAPLIST CHAR(16) BDY(WORD),                        0596
*              2 SNAPIDEN FIXED(8),    /* SNAP ID                    */
*              2 SNAPOPT CHAR(3),      /* SNAP OPTIONS               */
*              2 SNAPPTR PTR(31),      /* SNAP DCB ADDRESS           */
*              2 SNAPTCB PTR(31),      /* SNAP TCB ADDRESS           */
*              2 SNAPLST PTR(31);      /* SNAP-SHOT LIST ADDR        */
*                                                                  0596
*        DCL DUMPDCB CHAR(88) BDY(WORD);                           0597
*                                      /* FULL REGION (SNAP) DUMP DCB*/
*                                                                  0598
*        /* DCB ADDRESS FOR CLOSING                                  */
*        DCL 1 SADCB PTR(31) BDY(WORD),                            0598
*              2 BLOCKFLG BIT(1);      /* CONTROL BLOCK ADDRESS FLAG */
*                                                                  0598
*        DCL OPENGEN CHAR(4) GENERATED;/*GENERATED LIST FORM OPEN    */
*                                                                  0599
*        DCL SNAPGEN CHAR(16) GENERATED;                           0600
*                                      /* GENERATED LIST FORM OF SNAP*/
*                                                                  0601
*        DCL DCBGEN CHAR(88) GENERATED;/* GENERATED SNAP DCB         */
*                                                                  0601
*        DCL BADSNAP FIXED(31) CONSTANT(44);                       0602
*                                      /* UABORT MESSAGE FOR         */
*                                      /* UNSUCCESSFUL SNAP          */
*                                                                  0603
*        /************************************************************/
*        /*                                                          */
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0603
*        RESPECIFY (REG1PTR) RSTD;                                 0603
*        GDTPR = ADDR1;                                            0604
         L     GDTPR,ADDR1(,REG1PTR)                               0604
*        PARMPTR2 = ADDR2;                                         0605
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0605
*        RESPECIFY (REG1PTR) UNRSTD;                               0606
*                                                                  0606
*        OLDERID2 = NEWERID2;                                      0607
         L     @08,GDTTR2(,GDTPR)                                  0607
         MVC   @TS00001(95),NEWERID2(@08)                          0607
         MVC   OLDERID2(95,@08),@TS00001                           0607
*        NEWID2 = 'SASN';                                          0608
*                                                                  0608
         MVC   NEWID2(4,@08),@CC00752                              0608
*        /************************************************************/
*        /*                                                          */
*        /* MOVE DCB AND OPEN LISTS INTO DYNAMIC STORAGE AND OPEN    */
*        /* THE SNAP DCB FOR PROCESSING                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0609
*        DUMPDCB = DCBGEN;                                         0609
         MVC   DUMPDCB(88),DCBGEN                                  0609
*        OPENLIST = OPENGEN;                                       0610
         MVC   OPENLIST(4),OPENGEN                                 0610
*        OPENADDR = ADDR(DUMPDCB);                                 0611
         LA    @08,DUMPDCB                                         0611
         STCM  @08,7,OPENADDR                                      0611
*        RESPECIFY (REG1) RSTD;                                    0612
*        REG1 = ADDR(OPENLIST);                                    0613
         LA    REG1,OPENLIST                                       0613
*LOPEN2: GEN(OPEN  MF=(E,(REG1)));                                 0614
LOPEN2   OPEN  MF=(E,(REG1))
*        RESPECIFY (REG1) UNRSTD;                                  0615
*                                                                  0615
*        /************************************************************/
*        /*                                                          */
*        /* MOVE SNAP MACRO LIST INTO DYNAMIC STORAGE AND ISSUE THE  */
*        /* SNAP MACRO FOR A FULL REGION DUMP                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0616
*        SNAPLIST = SNAPGEN;                                       0616
         MVC   SNAPLIST(16),SNAPGEN                                0616
*        SNAPPTR = ADDR(DUMPDCB);                                  0617
         LA    @08,DUMPDCB                                         0617
         ST    @08,SNAPPTR                                         0617
*        SNAPIDEN = SNAPID;                                        0618
         LH    @08,SNAPID(,PARMPTR2)                               0618
         STC   @08,SNAPIDEN                                        0618
*        RESPECIFY (REG1) RSTD;                                    0619
*        REG1 = ADDR(SNAPLIST);                                    0620
         LA    REG1,SNAPLIST                                       0620
*LSNAP2: GEN(SNAP  MF=(E,(REG1)));                                 0621
LSNAP2   SNAP  MF=(E,(REG1))
*        RESPECIFY (REG15) RSTD;                                   0622
*        RESPECIFY RTNREG RSTD;                                    0623
*        TESTRC = RTNREG;                                          0624
         LR    TESTRC,RTNREG                                       0624
*        RESPECIFY RTNREG UNRSTD;                                  0625
*        RESPECIFY (REG15) UNRSTD;                                 0626
*                                                                  0626
*        /************************************************************/
*        /*                                                          */
*        /* CLOSE THE SNAP DCB                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0627
*        SADCB = ADDR(DUMPDCB);                                    0627
         LA    @08,DUMPDCB                                         0627
         ST    @08,SADCB                                           0627
*        BLOCKFLG = ON;                                            0628
         OI    BLOCKFLG,B'10000000'                                0628
*        REG1 = ADDR(SADCB);                                       0629
         LA    REG1,SADCB                                          0629
*LCLOSE3:GEN(CLOSE MF=(E,(REG1)));                                 0630
LCLOSE3  CLOSE MF=(E,(REG1))
*        RESPECIFY (REG1) UNRSTD;                                  0631
*                                                                  0631
*        /************************************************************/
*        /*                                                          */
*        /* CHECK RETURN CODE FROM SNAP MACRO AND ABORT IF IT IS BAD */
*        /*                                                          */
*        /************************************************************/
*                                                                  0632
*        IF TESTRC ^= 0                                            0632
*          THEN                                                    0632
*                                                                  0632
         LTR   TESTRC,TESTRC                                       0632
         BZ    @RF00632                                            0632
*            DO;                                                   0633
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0634
*              REG15 = BADSNAP;                                    0635
         LA    REG15,44                                            0635
*              REG14 = GDTABT;                                     0636
         L     REG14,GDTABT(,GDTPR)                                0636
*              REG13 = GDTABH;                                     0637
         L     REG13,GDTABH(,GDTPR)                                0637
*              GEN(BR    REG14);                                   0638
         BR    REG14
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0639
*            END;                                                  0640
*                                                                  0640
*                                                                  0640
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO THE USNAP CALLER                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0641
*        CALL ICKSAEP0(GDTTBL,MODID);                              0641
@RF00632 ST    GDTPR,@AL00001                                      0641
         LA    @08,MODID                                           0641
         ST    @08,@AL00001+4                                      0641
         MVI   @AL00001+4,X'80'                                    0641
         L     @15,GDTEPL(,GDTPR)                                  0641
         LA    @01,@AL00001                                        0641
         BALR  @14,@15                                             0641
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - GETSTG                                 */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE OBTAINS MAIN                  */
*        /*             STORAGE AS REQUESTED.                        */
*        /*                                                          */
*        /*  INPUT -    PARAMETER LIST DEFINED BY THE AREA           */
*        /*             LABELLED GETLIST.                            */
*        /*                                                          */
*        /*  OUTPUT -   RETURN CODE IN TESTRC.                       */
*        /*             ADDRESS OF THE AREA OBTAINED IS IN           */
*        /*             THE AREA POINTED TO BY GETPT.                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0642
*GETSTG: PROCEDURE;                                                0642
*                                                                  0642
*                                                                  0642
         B     @PB00002                                            0642
GETSTG   STM   @14,@05,@SA00002                                    0642
         STM   @07,@12,@SA00002+32                                 0642
*LGETMN: GEN(GETMAIN MF=(E,GETLIST))                               0643
*          REFS(GETLIST);                                          0643
LGETMN   GETMAIN MF=(E,GETLIST)
*        RESPECIFY RTNREG RSTD;                                    0644
*        TESTRC = RTNREG;                                          0645
         LR    TESTRC,RTNREG                                       0645
*        RESPECIFY RTNREG UNRSTD;                                  0646
*                                                                  0646
*                                                                  0646
*        END GETSTG;                                               0647
*                                                                  0647
@EL00002 DS    0H                                                  0647
@EF00002 DS    0H                                                  0647
@ER00002 LM    @14,@05,@SA00002                                    0647
         LM    @07,@12,@SA00002+32                                 0647
         BR    @14                                                 0647
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - FREESTG                                */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE RELEASES MAIN                 */
*        /*             STORAGE AS REQUESTED.                        */
*        /*                                                          */
*        /*  INPUT -    PARAMETER LIST DEFINED BY THE AREA           */
*        /*             LABELLED FREELIST.                           */
*        /*                                                          */
*        /*  OUTPUT -   NONE.                                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0648
*FREESTG: PROCEDURE;                                               0648
*                                                                  0648
FREESTG  STM   @14,@12,@SA00003                                    0648
*        RESPECIFY (REG0,REG1) RSTD;                               0649
*        REG0 = FREESZ;                                            0650
         L     REG0,FREESZ                                         0650
*        REG1 = FREEPT;                                            0651
         L     REG1,FREEPT                                         0651
*LFREMN: GEN(FREEMAIN R,LV=(0),A=(1));                             0652
LFREMN   FREEMAIN R,LV=(0),A=(1)
*        RESPECIFY (REG0,REG1) UNRSTD;                             0653
*                                                                  0653
*        END FREESTG;                                              0654
*                                                                  0654
@EL00003 DS    0H                                                  0654
@EF00003 DS    0H                                                  0654
@ER00003 LM    @14,@12,@SA00003                                    0654
         BR    @14                                                 0654
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - COREINIT                               */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE INITIALIZES CORE.  THE ADDRESS*/
*        /*             OF THE CORE AND THE VALUE IT IS TO BE        */
*        /*             INITIALIZED TO ARE PROVIDED BY THE CALLER    */
*        /*                                                          */
*        /*  INPUT - PARAMETER LIST CONTAINING THE ADDRESS OF A SIZE */
*        /*          ARGUMENT, THE ADDRESS OF A VARIABLE CONTAINING  */
*        /*          THE ADDRESS OF THE CORE TO BE INITIALIZED, AND  */
*        /*          THE ADDRESS OF AN ARGUMENT INDICATING THE VALUE */
*        /*          TO WHICH THE CORE IS TO BE INITIALIZED.         */
*        /*                                                          */
*        /*  OUTPUT - THE INITIALIZED CORE                           */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /* CORE INITIALIZATION REQUEST INNER PROCEDURE              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0655
*COREINIT: PROCEDURE(ZSIZE,ZPTR,INITC);                            0655
*                                                                  0655
COREINIT STM   @14,@12,@SA00004                                    0655
         MVC   @PC00004(12),0(@01)                                 0655
*        DCL ZSIZE FIXED(31);          /* SIZE OF AREA TO INITIALIZE */
*                                                                  0656
*        DCL ZPTR PTR(31);             /* ADDRESS OF AREA TO         */
*                                      /* INITIALIZE                 */
*                                                                  0658
*        DCL ALLINIT CHAR(256);        /* AREA TO INITIALIZE FROM    */
*                                                                  0658
*        DCL INITCHAR CHAR(*) BASED(ZPTR);                         0659
*                                      /* AREA TO BE INITIALIZED     */
*                                                                  0660
*        DCL INITC CHAR(1);            /* INITIALIZATION CHARACTER   */
*                                      /* PASSED                     */
*                                                                  0661
*        DCL CHARIN CHAR(1);           /* INITIALIZATION CHARACTER   */
*                                                                  0661
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE 256 BYTE AREA ALLINIT TO VALUE OF REQUEST     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0662
*        CHARIN = INITC;                                           0662
         L     @08,@PC00004+8                                      0662
         MVC   CHARIN(1),INITC(@08)                                0662
*        GEN(MVC   ALLINIT(1),CHARIN);                             0663
         MVC   ALLINIT(1),CHARIN
*        GEN(MVC   ALLINIT+1(255),ALLINIT);                        0664
         MVC   ALLINIT+1(255),ALLINIT
*        DOCNTRL = ON;                                             0665
         OI    DOCNTRL,B'10000000'                                 0665
*INITDO: DO WHILE (DOCNTRL = ON);                                  0666
*                                                                  0666
INITDO   B     @DE00666                                            0666
@DL00666 DS    0H                                                  0667
*          /**********************************************************/
*          /*                                                        */
*          /* CHECK FOR MORE THAN 256 BYTES TO INITIALIZE            */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0667
*          IF ZSIZE > 256                                          0667
*            THEN                                                  0667
         LA    @08,256                                             0667
         L     @05,@PC00004                                        0667
         L     @15,ZSIZE(,@05)                                     0667
         CR    @15,@08                                             0667
         BNH   @RF00667                                            0667
*              DO;                                                 0668
*                                                                  0668
*                /****************************************************/
*                /*                                                  */
*                /* INITIALIZE 256 BYTES AND UPDATE SIZE AND POINTER */
*                /* VARIABLES FOR NEXT ITERATION                     */
*                /*                                                  */
*                /****************************************************/
*                                                                  0669
*                INITCHAR(1:256) = ALLINIT(1:256);                 0669
         L     @14,@PC00004+4                                      0669
         L     @07,ZPTR(,@14)                                      0669
         MVC   INITCHAR(256,@07),ALLINIT                           0669
*                ZSIZE = ZSIZE - 256;                              0670
         SLR   @15,@08                                             0670
         ST    @15,ZSIZE(,@05)                                     0670
*                ZPTR = ZPTR + 256;                                0671
         ALR   @07,@08                                             0671
         ST    @07,ZPTR(,@14)                                      0671
*              END;                                                0672
*            ELSE                                                  0673
*              DO;                                                 0673
*                                                                  0673
         B     @RC00667                                            0673
@RF00667 DS    0H                                                  0674
*                /****************************************************/
*                /*                                                  */
*                /* INITIALIZE ZSIZE BYTES AND SET DOCNTRL TO FALL   */
*                /* OUT OF LOOP                                      */
*                /*                                                  */
*                /****************************************************/
*                                                                  0674
*                INITCHAR(1:ZSIZE) = ALLINIT(1:ZSIZE);             0674
         L     @08,@PC00004+4                                      0674
         L     @08,ZPTR(,@08)                                      0674
         L     @05,@PC00004                                        0674
         L     @05,ZSIZE(,@05)                                     0674
         BCTR  @05,0                                               0674
         EX    @05,@SM00814                                        0674
*                DOCNTRL = OFF;                                    0675
         NI    DOCNTRL,B'01111111'                                 0675
*              END;                                                0676
*        END INITDO;                                               0677
@RC00667 DS    0H                                                  0677
@DE00666 TM    DOCNTRL,B'10000000'                                 0677
         BO    @DL00666                                            0677
*        END COREINIT;                                             0678
@EL00004 DS    0H                                                  0678
@EF00004 DS    0H                                                  0678
@ER00004 LM    @14,@12,@SA00004                                    0678
         BR    @14                                                 0678
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - FINDNAME                               */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE WILL SEARCH THE LOAD          */
*        /*             LIST BLOCKS TO SEE IF MODULE HAS             */
*        /*             BEEN LOADED AND STILL IN CORE.IF IT          */
*        /*             IS RETURN WITH ENTRY POINT.IF NOT            */
*        /*             LOAD THE CALLED MODULE,PUT NAME IN           */
*        /*             IN LOAD BLOCK,THEN UP USE COUNTER            */
*        /*             ONE AND RETURN WITH ENTRY POINT.             */
*        /*                                                          */
*        /*  INPUT - MODULE NAME                                     */
*        /*                                                          */
*        /*  OUTPUT - ENTRY POINT OF MODULE                          */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*        /************************************************************/
*        /*                                                          */
*        /*   FINDNAME THIS WILL LOAD MODULE IF NOT                  */
*        /*   IN CORE  -  THEN RETURN ENTRY POINT                    */
*        /*                                                          */
*        /************************************************************/
*        /************************************************************/
*                                                                  0679
*FINDNAME:   PROC(CLNAMX,ENTPT);                                   0679
FINDNAME STM   @14,@07,@SA00005                                    0679
         STM   @09,@12,@SA00005+40                                 0679
         MVC   @PC00005(8),0(@01)                                  0679
*        DCL CLNAMX    CHAR(8);        /* NAME OF MODULE             */
*        DCL ENTPT     PTR(31);        /* ENTRY POINT                */
*        DCL INDX      FIXED(15);      /* LOAD LIST INDEX            */
*        DCL SLTOUSE  PTR(31);         /* SLOT TO USE PTR            */
*        DCL LOADNAME CHAR(8);         /* NAME OF MODULE             */
*                                                                  0684
*        INDX = 0;                                                 0685
         SLR   INDX,INDX                                           0685
*        LOOPCTL = OFF;                                            0686
         NI    LOOPCTL,B'01111111'                                 0686
*        NAMEFND = OFF;                                            0687
*                                                                  0687
         NI    NAMEFND,B'01111111'                                 0687
*        /************************************************************/
*        /*                                                          */
*        /* SEARCH LLBLKS FOR MATCH OF MODULE NAME                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0688
*FNDO:   DO WHILE LOOPCTL = OFF;                                   0688
FNDO     B     @DE00688                                            0688
@DL00688 DS    0H                                                  0689
*          IF INDX = 0                                             0689
*            THEN                                                  0689
*                                                                  0689
         LTR   INDX,INDX                                           0689
         BNZ   @RF00689                                            0689
*              /******************************************************/
*              /*                                                    */
*              /*   FIRST TIME USE PTR IN SAHIST                     */
*              /*                                                    */
*              /******************************************************/
*                                                                  0690
*              P= LLBLKPTR;                                        0690
         L     @05,GDTSAH(,GDTPR)                                  0690
         L     P,LLBLKPTR(,@05)                                    0690
*            ELSE;                                                 0691
*                                                                  0691
@RF00689 DS    0H                                                  0692
*          /**********************************************************/
*          /*                                                        */
*          /*    SEARCH FOR MODULE MATCH                             */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0692
*          DO INDX = 1 TO LLSLTCNT WHILE LOOPCTL = OFF;            0692
         LA    INDX,1                                              0692
@DL00692 TM    LOOPCTL,B'10000000'                                 0692
         BNZ   @DC00692                                            0692
*            IF LLNOMOD(INDX) = 0                                  0693
*                                                                  0693
*            /********************************************************/
*            /*                                                      */
*            /*  NO MODULE IN THIS SLOT WHEN 0 IS FOUND              */
*            /*                                                      */
*            /********************************************************/
*                                                                  0693
*              THEN;                                               0693
         LR    @05,INDX                                            0693
         SLA   @05,4                                               0693
         AL    @05,@CF00816                                        0693
         L     @05,LLNOMOD-12(@05,P)                               0693
         LTR   @05,@05                                             0693
         BZ    @RT00693                                            0693
*              ELSE                                                0695
*                DO;                                               0695
*                  IF CLNAMX = LLNAME(INDX)                        0696
*                    THEN                                          0696
         L     @05,@PC00005                                        0696
         LR    @03,INDX                                            0696
         SLA   @03,4                                               0696
         ST    @03,@TF00001                                        0696
         ALR   @03,P                                               0696
         AL    @03,@CF00812                                        0696
         CLC   CLNAMX(8,@05),LLNAME-8(@03)                         0696
         BNE   @RF00696                                            0696
*                      DO;                                         0697
*                                                                  0697
*                      /**********************************************/
*                      /*                                            */
*                      /*   GOT A MATCH ON MODULE NAME               */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0698
*                        LOOPCTL = ON;                             0698
         OI    LOOPCTL,B'10000000'                                 0698
*                        NAMEFND = ON;                             0699
         OI    NAMEFND,B'10000000'                                 0699
*                        ENTPT = LLADDR(INDX);                     0700
         L     @05,@PC00005+4                                      0700
         L     @03,@TF00001                                        0700
         L     @03,LLADDR-16(@03,P)                                0700
         ST    @03,ENTPT(,@05)                                     0700
*                        LLUSECTR(INDX) = LLUSECTR(INDX)+1;        0701
         LA    @05,1                                               0701
         L     @03,@TF00001                                        0701
         SLR   @15,@15                                             0701
         IC    @15,LLUSECTR-16(@03,P)                              0701
         ALR   @05,@15                                             0701
         L     @03,@TF00001                                        0701
         STC   @05,LLUSECTR-16(@03,P)                              0701
*                        END;                                      0702
*                    ELSE;                                         0703
@RF00696 DS    0H                                                  0704
*                END;                                              0704
*          END;                                                    0705
*                                                                  0705
@RT00693 AL    INDX,@CF00158                                       0705
         C     INDX,@CF00278                                       0705
         BNH   @DL00692                                            0705
@DC00692 DS    0H                                                  0706
*          /**********************************************************/
*          /*                                                        */
*          /*   USE CHAIN PTR IN LLBLK(S) IF 0 LAST LLBLK            */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0706
*          IF LLNXTBLK = 0                                         0706
*            THEN                                                  0706
         L     @05,LLNXTBLK(,P)                                    0706
         LTR   @05,@05                                             0706
         BNZ   @RF00706                                            0706
*              LOOPCTL = ON;                                       0707
         OI    LOOPCTL,B'10000000'                                 0707
*            ELSE                                                  0708
*              P = LLNXTBLK;                                       0708
         B     @RC00706                                            0708
@RF00706 L     P,LLNXTBLK(,P)                                      0708
*        END FNDO;                                                 0709
*                                                                  0709
@RC00706 DS    0H                                                  0709
@DE00688 TM    LOOPCTL,B'10000000'                                 0709
         BZ    @DL00688                                            0709
*        LOOPCTL = OFF;                                            0710
         NI    LOOPCTL,B'01111111'                                 0710
*          IF NAMEFND = ON                                         0711
*            THEN;                                                 0711
         TM    NAMEFND,B'10000000'                                 0711
         BO    @RT00711                                            0711
*            ELSE                                                  0713
*              /******************************************************/
*              /*                                                    */
*              /*     MODULE WAS NOT IN LLBLK PREPARE TO             */
*              /*     LOAD NEEDED MODULE AND                         */
*              /*     FIND A AVAILABLE SLOT FOR THIS MODULE          */
*              /*                                                    */
*              /******************************************************/
*              DO;                                                 0713
*              P = LLBLKPTR;                                       0714
         L     @05,GDTSAH(,GDTPR)                                  0714
         L     P,LLBLKPTR(,@05)                                    0714
*                DO WHILE LLFSTSLT = 0;                            0715
*                                                                  0715
*                                                                  0715
         B     @DE00715                                            0715
@DL00715 DS    0H                                                  0716
*                  IF LLNXTBLK = 0                                 0716
*                    THEN                                          0716
         L     @05,LLNXTBLK(,P)                                    0716
         LTR   @05,@05                                             0716
         BNZ   @RF00716                                            0716
*                      DO;                                         0717
*                                                                  0717
*                      /**********************************************/
*                      /*                                            */
*                      /* NO SLOTS AVAIL.BUILD A NEW LLBLK           */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0718
*                        OLDERID2 = NEWERID2;                      0718
         L     @07,GDTTR2(,GDTPR)                                  0718
         MVC   @TS00001(95),NEWERID2(@07)                          0718
         MVC   OLDERID2(95,@07),@TS00001                           0718
*                        NEWID2 = 'SABB';                          0719
         MVC   NEWID2(4,@07),@CC00796                              0719
*                        CALL ICKSAGS0(GDTTBL,(LLSLTCNT*(LENGTH(LLSLOT)
*)                                                                 0720
*                        +(LENGTH(LLHDR)),LLNXTBLK,SETZERO);       0720
*                                                                  0720
         ST    GDTPR,@AL00001                                      0720
         LA    @07,@CF00809                                        0720
         ST    @07,@AL00001+4                                      0720
         LA    @07,LLNXTBLK(,P)                                    0720
         ST    @07,@AL00001+8                                      0720
         LA    @07,@CC00138                                        0720
         ST    @07,@AL00001+12                                     0720
         MVI   @AL00001+12,X'80'                                   0720
         L     @15,GDTGSP(,GDTPR)                                  0720
         LA    @01,@AL00001                                        0720
         BALR  @14,@15                                             0720
*                        RFY (RTNREG) RSTD;                        0721
*                        TESTRC = RTNREG;                          0722
         LR    TESTRC,RTNREG                                       0722
*                        RFY (RTNREG) UNRSTD;                      0723
*                          IF TESTRC ^= 0                          0724
*                            THEN                                  0724
*                                                                  0724
         LTR   TESTRC,TESTRC                                       0724
         BZ    @RF00724                                            0724
*                              DO;                                 0725
*                                RESPECIFY(REG13,REG14,REG15) RSTD;
*                                REG15 = NOSPACE;                  0727
         LA    REG15,28                                            0727
*                                REG14 = GDTABT;                   0728
         L     REG14,GDTABT(,GDTPR)                                0728
*                                REG13 = GDTABH;                   0729
         L     REG13,GDTABH(,GDTPR)                                0729
*                                GEN(BR    REG14);                 0730
         BR    REG14
*                                RESPECIFY(REG13,REG14,REG15)UNRSTD;
*                              END;                                0732
*                            ELSE                                  0733
*                              DO;                                 0733
*                                                                  0733
         B     @RC00724                                            0733
@RF00724 DS    0H                                                  0734
*                              /**************************************/
*                              /*                                    */
*                              /* FORMAT AND CHAIN NEW LLBLK         */
*                              /*                                    */
*                              /**************************************/
*                                                                  0734
*                              P= LLNXTBLK;                        0734
         L     P,LLNXTBLK(,P)                                      0734
*                              LLFSTSLT = ADDR(LLNXTSLT(1));       0735
*                                                                  0735
         LA    @05,LLNXTSLT(,P)                                    0735
         ST    @05,LLFSTSLT(,P)                                    0735
*                                DO INDX = 1 TO LLSLTCNT;          0736
         LA    INDX,1                                              0736
@DL00736 DS    0H                                                  0737
*                                  LLNXTSLT(INDX) =                0737
*                                  ADDR(LLNXTSLT(INDX+1));         0737
         LR    @05,INDX                                            0737
         SLA   @05,4                                               0737
         LA    @03,LLNXTSLT(@05,P)                                 0737
         AL    @05,@CF00812                                        0737
         ST    @03,LLNXTSLT-8(@05,P)                               0737
*                                END;                              0738
         AL    INDX,@CF00158                                       0738
         C     INDX,@CF00278                                       0738
         BNH   @DL00736                                            0738
*                              LLNXTSLT(LLSLTCNT) = 0;             0739
         SLR   @05,@05                                             0739
         ST    @05,LLNXTSLT+368(,P)                                0739
*                            END;                                  0740
*                      END;                                        0741
*                    ELSE                                          0742
*                      P = LLNXTBLK;                               0742
         B     @RC00716                                            0742
@RF00716 L     P,LLNXTBLK(,P)                                      0742
*                END;                                              0743
@RC00716 DS    0H                                                  0743
@DE00715 L     @05,LLFSTSLT(,P)                                    0743
         LTR   @05,@05                                             0743
         BZ    @DL00715                                            0743
*                SLTOUSE = LLFSTSLT;                               0744
*                                                                  0744
         LR    SLTOUSE,@05                                         0744
*                /****************************************************/
*                /*                                                  */
*                /*  CALCULATE THE INDX VALUE FOR SLOT               */
*                /*  THAT WILL BE USED FOR THIS MODULE               */
*                /*                                                  */
*                /****************************************************/
*                                                                  0745
*                INDX = ((SLTOUSE -P -(LENGTH(LLHDR)))  /          0745
*                (LENGTH(LLSLOT))) +1;                             0745
*                                                                  0745
         LR    @00,SLTOUSE                                         0745
         SLR   @00,P                                               0745
         SL    @00,@CF00154                                        0745
         SRDA  @00,32                                              0745
         D     @00,@CF00262                                        0745
         AL    @01,@CF00158                                        0745
         LR    INDX,@01                                            0745
*                LLFSTSLT = LLNXTSLT(INDX);                        0746
*                                                                  0746
         LR    @05,INDX                                            0746
         SLA   @05,4                                               0746
         AL    @05,@CF00812                                        0746
         L     @05,LLNXTSLT-8(@05,P)                               0746
         ST    @05,LLFSTSLT(,P)                                    0746
*                /****************************************************/
*                /*                                                  */
*                /*      LOAD THE MODULE                             */
*                /*                                                  */
*                /****************************************************/
*                                                                  0747
*                RESPECIFY (REG0,REG1) RSTD;                       0747
*                LOADNAME = CLNAMX;                                0748
         L     @05,@PC00005                                        0748
         MVC   LOADNAME(8),CLNAMX(@05)                             0748
*LLDA1:          GEN(LOAD EPLOC=LOADNAME);                         0749
LLDA1    LOAD EPLOC=LOADNAME
*                LLNAME(INDX) = CLNAMX;                            0750
         LR    @05,INDX                                            0750
         SLA   @05,4                                               0750
         ST    @05,@TF00001                                        0750
         ALR   @05,P                                               0750
         AL    @05,@CF00812                                        0750
         L     @03,@PC00005                                        0750
         MVC   LLNAME-8(8,@05),CLNAMX(@03)                         0750
*                LLMODSZ(INDX) = REG1;                             0751
*                                                                  0751
         LR    @05,P                                               0751
         AL    @05,@TF00001                                        0751
         STCM  REG1,7,LLMODSZ-16(@05)                              0751
*                /****************************************************/
*                /*                                                  */
*                /*     PUT MODULE ENTRY POINT                       */
*                /*    IN DMS LOAD LIST BLOCK                        */
*                /*                                                  */
*                /****************************************************/
*                                                                  0752
*                ENTPT = REG0;                                     0752
         L     @05,@PC00005+4                                      0752
         ST    REG0,ENTPT(,@05)                                    0752
*                LLADDR(INDX) = ENTPT;                             0753
*                                                                  0753
         L     @05,@PC00005+4                                      0753
         L     @05,ENTPT(,@05)                                     0753
         L     @03,@TF00001                                        0753
         ST    @05,LLADDR-16(@03,P)                                0753
*                /****************************************************/
*                /*                                                  */
*                /*  UP USE CTR.FOR MODULE                           */
*                /*                                                  */
*                /****************************************************/
*                                                                  0754
*                LLUSECTR(INDX) = LLUSECTR(INDX)+1;                0754
         LA    @05,1                                               0754
         L     @03,@TF00001                                        0754
         SLR   @15,@15                                             0754
         IC    @15,LLUSECTR-16(@03,P)                              0754
         ALR   @05,@15                                             0754
         L     @03,@TF00001                                        0754
         STC   @05,LLUSECTR-16(@03,P)                              0754
*                RESPECIFY (REG0,REG1) UNRSTD;                     0755
*            END;                                                  0756
*        RETURN;                                                   0757
*                                                                  0757
@EL00005 DS    0H                                                  0757
@EF00005 DS    0H                                                  0757
@ER00005 LM    @14,@07,@SA00005                                    0757
         LM    @09,@12,@SA00005+40                                 0757
         BR    @14                                                 0757
*        END FINDNAME;                                             0758
*                                                                  0758
*                                                                  0758
         B     @EL00005                                            0758
*            /********************************************************/
*            /********************************************************/
*            /*                                                      */
*            /*  PROCEDURE NAME - RELECORE                           */
*            /*                                                      */
*            /*  FUNCTION                                            */
*            /*      THIS RTN WILL SEARCH DMS LOAD LIST,             */
*            /*      FREE MODULES NOT IN USE(USE CTR WILL BE         */
*            /*      ZERO) THIS SHOULD FREE SOME CORE                */
*            /*                                                      */
*            /*  INPUT - NONE                                        */
*            /*                                                      */
*            /*  OUTPUT - NONE                                       */
*            /*                                                      */
*            /********************************************************/
*            /********************************************************/
*                                                                  0759
*RELECORE: PROC;                                                   0759
*                                                                  0759
RELECORE STM   @14,@07,@SA00006                                    0759
         STM   @09,@12,@SA00006+40                                 0759
*            OLDERID2 = NEWERID2;                                  0760
         L     @05,GDTTR2(,GDTPR)                                  0760
         MVC   @TS00001(95),NEWERID2(@05)                          0760
         MVC   OLDERID2(95,@05),@TS00001                           0760
*            NEWID2 = 'SAD3';                                      0761
         MVC   NEWID2(4,@05),@CC00802                              0761
*            IX = 0;                                               0762
         SLR   IX,IX                                               0762
*            LOOPCTL = OFF;                                        0763
*                                                                  0763
         NI    LOOPCTL,B'01111111'                                 0763
*RELDO:        DO WHILE LOOPCTL = OFF;                             0764
RELDO    B     @DE00764                                            0764
@DL00764 DS    0H                                                  0765
*                IF IX = 0                                         0765
*                  THEN                                            0765
*                                                                  0765
         LTR   IX,IX                                               0765
         BNZ   @RF00765                                            0765
*                      /**********************************************/
*                      /*                                            */
*                      /*   FIRST TIME USE POINTER IN                */
*                      /*   SYSTEM HIST AREA TO LOAD                 */
*                      /*   LIST BLOCK                               */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0766
*                      P = LLBLKPTR;                               0766
         L     @05,GDTSAH(,GDTPR)                                  0766
         L     P,LLBLKPTR(,@05)                                    0766
*                  ELSE;                                           0767
*                                                                  0767
@RF00765 DS    0H                                                  0768
*                /****************************************************/
*                /*                                                  */
*                /*           SEARCH EACH LOAD LIST                  */
*                /*           BLOCK.WHEN MODULE NAME IS              */
*                /*           IN SLOT AND USE CTR IS ZERO            */
*                /*           THEN DELETE MODULE FROM CORE           */
*                /*                                                  */
*                /****************************************************/
*                                                                  0768
*                  DO IX = 1 TO LLSLTCNT;                          0768
         LA    IX,1                                                0768
@DL00768 DS    0H                                                  0769
*                    IF LLNOMOD(IX) = 0  LLUSECTR(IX) ^= 0        0769
*                                                                  0769
*                      THEN;                                       0769
         SLR   @05,@05                                             0769
         LR    @03,IX                                              0769
         SLA   @03,4                                               0769
         LR    @01,P                                               0769
         AL    @01,@CF00816                                        0769
         C     @05,LLNOMOD-12(@03,@01)                             0769
         BE    @RT00769                                            0769
         SLR   @15,@15                                             0769
         IC    @15,LLUSECTR-16(@03,P)                              0769
         CR    @05,@15                                             0769
         BNE   @RT00769                                            0769
*                      ELSE                                        0771
*                        DO;                                       0771
*                          RFY REG0 RSTD;                          0772
*                          REG0 =  ADDR(LLNAME(IX));               0773
         LR    @05,IX                                              0773
         SLA   @05,4                                               0773
         AL    @05,@CF00812                                        0773
         LA    REG0,LLNAME-8(@05,P)                                0773
*LDEL2:                    GEN(DELETE  EPLOC=(REG0));              0774
LDEL2    DELETE  EPLOC=(REG0)
*                          RFY REG0 UNRSTD;                        0775
*                          LLNOMOD(IX) = 0;                        0776
         LR    @05,IX                                              0776
         SLA   @05,4                                               0776
         SLR   @03,@03                                             0776
         LR    @01,P                                               0776
         AL    @01,@CF00816                                        0776
         ST    @03,LLNOMOD-12(@05,@01)                             0776
*                          LLNXTSLT(IX) = LLFSTSLT;                0777
         L     @03,LLFSTSLT(,P)                                    0777
         LR    @01,P                                               0777
         AL    @01,@CF00812                                        0777
         ST    @03,LLNXTSLT-8(@05,@01)                             0777
*                          LLFSTSLT = ADDR(LLNXTSLT(IX));          0778
         AL    @05,@CF00812                                        0778
         LA    @05,LLNXTSLT-8(@05,P)                               0778
         ST    @05,LLFSTSLT(,P)                                    0778
*                        END;                                      0779
*                  END;                                            0780
@RT00769 AL    IX,@CF00158                                         0780
         C     IX,@CF00278                                         0780
         BNH   @DL00768                                            0780
*                IF LLNXTBLK = 0                                   0781
*                  THEN                                            0781
         L     @05,LLNXTBLK(,P)                                    0781
         LTR   @05,@05                                             0781
         BNZ   @RF00781                                            0781
*                    LOOPCTL = ON;                                 0782
         OI    LOOPCTL,B'10000000'                                 0782
*                  ELSE                                            0783
*                    P = LLNXTBLK;                                 0783
         B     @RC00781                                            0783
@RF00781 L     P,LLNXTBLK(,P)                                      0783
*              END RELDO;                                          0784
*                                                                  0784
@RC00781 DS    0H                                                  0784
@DE00764 TM    LOOPCTL,B'10000000'                                 0784
         BZ    @DL00764                                            0784
*            IF GDTDBG = NULLPTR                                   0785
*              THEN;                                               0785
         L     @05,GDTDBG(,GDTPR)                                  0785
         LTR   @05,@05                                             0785
         BZ    @RT00785                                            0785
*              ELSE                                                0787
*                CALL ICKDB010(GDTTBL,'SAD4');                     0787
         ST    GDTPR,@AL00001                                      0787
         LA    @05,@CC00807                                        0787
         ST    @05,@AL00001+4                                      0787
         MVI   @AL00001+4,X'80'                                    0787
         L     @15,GDTDBG(,GDTPR)                                  0787
         LA    @01,@AL00001                                        0787
         BALR  @14,@15                                             0787
*            RETURN;                                               0788
@EL00006 DS    0H                                                  0788
@EF00006 DS    0H                                                  0788
@ER00006 LM    @14,@07,@SA00006                                    0788
         LM    @09,@12,@SA00006+40                                 0788
         BR    @14                                                 0788
*        END RELECORE;                                             0789
*                                                                  0789
         B     @EL00006                                            0789
@PB00006 DS    0H                                                  0790
*        /************************************************************/
*        /*                                                          */
*        /* LIST FORM OF GETMAIN MACRO--MOVED INTO A DYNAMIC AREA FOR*/
*        /* USE                                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0790
*        GENERATE DATA;                                            0790
*                                                                  0790
*        /************************************************************/
*        /*                                                          */
*        /* LIST FORM OF THE GETMAIN MACRO, SPECIFYING PAGE          */
*        /* BOUNDARY--MOVED INTO A DYNAMIC AREA FOR USE              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0791
*        GENERATE DATA;                                            0791
*                                                                  0791
*        /************************************************************/
*        /*                                                          */
*        /* FULL REGION (SNAP) DUMP DCB - THIS IS COPIED INTO A      */
*        /* DYNAMIC AREA FOR USE                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0792
*        GENERATE DATA;                                            0792
*                                                                  0792
*        /************************************************************/
*        /*                                                          */
*        /* LIST FORM OF OPEN MACRO--MOVED INTO A DYNAMIC AREA FOR   */
*        /* USE WITH SNAP                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0793
*        GENERATE DATA;                                            0793
*                                                                  0793
*        /************************************************************/
*        /*                                                          */
*        /* LIST FORM OF SNAP MACRO--MOVED INTO A DYNAMIC AREA FOR   */
*        /* USE                                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0794
*        GENERATE DATA;                                            0794
*                                                                  0794
*        /************************************************************/
*        /*                                                          */
*        /* DECLARATION ALLOWING MODULE ICKSA01 ACCESS TO THIS       */
*        /* MODULE'S AUTOMATIC STORAGE SIZE VALUE                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0795
*        GENERATE DATA;                                            0795
*        RESPECIFY (GDTPR) UNRSTD;                                 0796
*        END ICKSA02                                               0797
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF09 )                                        *
*;                                                                 0797
@EL00001 L     @13,4(,@13)                                         0797
@EF00001 L     @00,@SIZDATD                                        0797
         LR    @01,@11                                             0797
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0797
         BR    @14                                                 0797
@DATA    DS    0H
@SM00814 MVC   INITCHAR(0,@08),ALLINIT
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    20F
@SA00005 DS    14F
@PC00005 DS    2F
@SA00002 DS    14F
@SA00006 DS    14F
@SA00004 DS    15F
@PC00004 DS    3F
@SA00003 DS    15F
@AL00001 DS    6A
@TF00001 DS    F
ICKSA02  CSECT
         DS    0F
@CF00087 DC    F'0'
@CF00158 DC    F'1'
@CF00129 DC    F'3'
@CF00037 DC    F'4'
@CH00037 EQU   @CF00037+2
@CF00154 DC    F'8'
@CF00033 DC    F'12'
@CF00262 DC    F'16'
@CF00278 DC    F'24'
@CF00634 DC    F'255'
@CF00809 DC    F'392'
@CF00812 DC    F'-8'
@CF00816 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTPTR  DS    A
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
PARMPTR5 DS    A
TEMPPTR  DS    A
INITPTR  DS    A
INITSIZE DS    F
CLENTPT  DS    A
PGCNTPTR DS    A
SADCB    DS    AL4
         ORG   SADCB
BLOCKFLG DS    BL1
         ORG   SADCB+4
DELPARM  DS    F
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
DOCNTRL  DS    BL1
         DS    CL1
TEMPEPN  DS    CL8
LOOPCTL  DS    BL1
NAMEFND  DS    BL1
         DS    CL2
GETLIST  DS    CL10
         ORG   GETLIST
GETSZ    DS    FL4
GETPT    DS    AL4
GETFLG   DS    CL2
         ORG   GETLIST+10
         DS    CL2
FREELIST DS    CL8
         ORG   FREELIST
FREEPT   DS    AL4
FREESZ   DS    FL4
         ORG   FREELIST+8
OPENLIST DS    CL4
         ORG   OPENLIST
OPENOPT  DS    CL1
OPENADDR DS    AL3
         ORG   OPENLIST+4
SNAPLIST DS    CL16
         ORG   SNAPLIST
SNAPIDEN DS    FL1
SNAPOPT  DS    CL3
SNAPPTR  DS    AL4
SNAPTCB  DS    AL4
SNAPLST  DS    AL4
         ORG   SNAPLIST+16
DUMPDCB  DS    CL88
ALLINIT  DS    CL256
CHARIN   DS    CL1
LOADNAME DS    CL8
         DS    CL3
MSGAREA  DS    CL20
ICKSA02  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
PGCTLEN  DC    AL4(24)
@CC00722 DC    C'ICKSA05 '
@CC00138 DC    C'ZERO'
@CC00140 DC    C'BLNK'
@CC00142 DC    C'NSET'
@CC00579 DC    C'SACL'
@CC00598 DC    C'SALD'
@CC00610 DC    C'SADE'
@CC00635 DC    C'SAGS'
@CC00652 DC    C'SAFS'
@CC00680 DC    C'SAGP'
@CC00699 DC    C'SAFP'
@CC00721 DC    C'SATI'
@CC00752 DC    C'SASN'
@CC00796 DC    C'SABB'
@CC00802 DC    C'SAD3'
@CC00807 DC    C'SAD4'
@CC00130 DC    C'ALL'
@CC00653 DC    C'   '
@CC00681 DC    C'PG'
FIXAREA  DS    CL300
         ORG   FIXAREA
@NM00018 DC    300X'00'
         ORG   FIXAREA+300
MODID    DC    CL4'SA02'
SETB     DC    CL1' '
SET0     DC    X'00'
@DATD    DSECT
ICKSA02 CSECT
GETGEN  GETMAIN EC,LV=8,A=GETGEN,MF=L
@DATD    DSECT
ICKSA02 CSECT
GETGENPG GETMAIN EC,LV=8,A=GETGENPG,BNDRY=PAGE,MF=L
@DATD    DSECT
ICKSA02 CSECT
DCBGEN   DCB   DSORG=PS,RECFM=VBA,MACRF=(W),BLKSIZE=882,LRECL=125,    XX
               DDNAME=DMSDUMP
@DATD    DSECT
ICKSA02 CSECT
OPENGEN  OPEN  (,(OUTPUT)),MF=L
@DATD    DSECT
ICKSA02 CSECT
SNAPGEN  SNAP  DCB=DCBGEN,SDATA=(CB,Q),PDATA=(ALL),ID=(00),MF=L
@DATD    DSECT
ICKSA02 CSECT
ICKSAS2 DC    A(@SIZDATD)
        ENTRY ICKSAS2
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKSA02  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SLTOUSE  EQU   @03
INDX     EQU   @02
SPIDPTR  EQU   @02
P        EQU   @08
IX       EQU   @02
PARMPTR4 EQU   @05
PARMPTR3 EQU   @02
PARMPTR2 EQU   @03
TESTRC   EQU   @06
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG11    EQU   @11
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
GDTPR    EQU   @09
REG1PTR  EQU   @01
REG10    EQU   @10
REG12    EQU   @12
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTSAH   EQU   GDTTBL+32
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
ICKSACL0 EQU   0
ICKSAEP0 EQU   0
ICKSAGS0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
LISTTEST EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
ADDR1    EQU   0
ADDR2    EQU   0
ADDR3    EQU   0
ADDR4    EQU   0
ADDR5    EQU   0
FREEID   EQU   0
LLBLK    EQU   0
LLHDR    EQU   LLBLK
LLFSTSLT EQU   LLHDR
LLNXTBLK EQU   LLHDR+4
LLSLOT   EQU   LLBLK+8
LLNAME   EQU   LLSLOT
LLNXTSLT EQU   LLNAME
LLNOMOD  EQU   LLNAME+4
LLADDR   EQU   LLSLOT+8
LLUSECTR EQU   LLSLOT+12
LLMODSZ  EQU   LLSLOT+13
SAHIST   EQU   0
GPFIRST  EQU   SAHIST
GPLAST   EQU   SAHIST+4
AUTOPTR  EQU   SAHIST+8
LLBLKPTR EQU   SAHIST+16
AUTOTBL  EQU   0
AUTOARAY EQU   AUTOTBL
STATUS   EQU   AUTOARAY+4
@NM00019 EQU   0
AUTOSIZE EQU   @NM00019
GSCNTRL  EQU   0
GSLEN    EQU   GSCNTRL
GSLENID  EQU   GSLEN
GSID     EQU   GSCNTRL+4
GSSUBPID EQU   GSID+3
GPCNTRL  EQU   0
GPFORWRD EQU   GPCNTRL
GPBACK   EQU   GPCNTRL+4
GPLEN    EQU   GPCNTRL+8
GPID     EQU   GPCNTRL+12
GPADRPG  EQU   GPCNTRL+16
GPLENPG  EQU   GPCNTRL+20
PRECNTRL EQU   0
PREFWD   EQU   PRECNTRL
PASCNTRL EQU   0
PASBACK  EQU   PASCNTRL+4
CLNAME   EQU   0
LDMOD    EQU   0
LDPOINT  EQU   0
DEMOD    EQU   0
GSSIZE   EQU   0
GSPOINT  EQU   0
GSINIT   EQU   0
GSSPID   EQU   0
FSPOINT  EQU   0
GPSIZE   EQU   0
GPPOINT  EQU   0
GPIDVAR  EQU   0
GPINIT   EQU   0
GPFCHAIN EQU   0
FPIDVAR  EQU   0
FPALL    EQU   0
TIDATE   EQU   0
TITIME   EQU   0
TIFORM   EQU   0
SNAPID   EQU   0
INITCHAR EQU   0
DMPTRM   EQU   0
ICKDVCL0 EQU   0
ICKDVIN0 EQU   0
ICKDVON0 EQU   0
ICKDVOP0 EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSADE0 EQU   0
ICKSAFP0 EQU   0
ICKSAFS0 EQU   0
ICKSAGP0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPPR0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
NEWERID1 EQU   5
GDTTBLX  EQU   0
CLNAMEX  EQU   0
LDMODX   EQU   0
LDPOINTX EQU   0
DEMODX   EQU   0
GSSIZEX  EQU   0
GSPOINTX EQU   0
GSINITX  EQU   0
GSSPIDX  EQU   0
FSPOINTX EQU   0
GPSIZEX  EQU   0
GPPOINTX EQU   0
GPIDVARX EQU   0
GPINITX  EQU   0
FPIDVARX EQU   0
FPALLX   EQU   0
TITIMEX  EQU   0
TIDATEX  EQU   0
TIFORMX  EQU   0
SNAPIDX  EQU   0
ZSIZE    EQU   0
ZPTR     EQU   0
INITC    EQU   0
CLNAMX   EQU   0
ENTPT    EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PASFWD   EQU   PASCNTRL
@NM00021 EQU   GSID
@NM00020 EQU   GSLEN+1
AUTOID   EQU   @NM00019+4
PTR1     EQU   AUTOARAY+8
ASIZE    EQU   AUTOARAY+6
AREAID   EQU   AUTOARAY
SAHSTA   EQU   SAHIST+12
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00287 EQU   @RC00283
@RC00328 EQU   @RC00324
@RF00344 EQU   @RC00336
@RF00359 EQU   @RC00336
@RC00357 EQU   @RC00336
@RC00441 EQU   @RC00437
@RF00489 EQU   @RC00449
@RC00502 EQU   @RC00449
@RC00724 EQU   @RC00716
@RT00711 EQU   @EL00005
@PB00005 EQU   @PB00006
@RT00785 EQU   @EL00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   ICKSA02,(C'PLS1738',0701,78192)

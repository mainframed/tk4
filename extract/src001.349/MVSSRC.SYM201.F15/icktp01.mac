         TITLE '          **********  ICKTP01 - FORMAT MODULE  *********
               ***      '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKTP01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00002-@MAINENT)
         DC    AL1(16)                                             0002
         DC    C'ICKTP01   78.192'                                 0002
ICKTPES  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00276-ICKTPES)
         ENTRY ICKTPES
ICKTPEA  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00283-ICKTPEA)
         ENTRY ICKTPEA
ICKTPRS  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00290-ICKTPRS)
         ENTRY ICKTPRS
ICKTPRE  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00297-ICKTPRE)
         ENTRY ICKTPRE
ICKTPPR  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00304-ICKTPPR)
         ENTRY ICKTPPR
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         USING @DATD,@08                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @15,@01,16(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         AH    @15,4(,@15)                                         0002
         BR    @15                                                 0002
@EP00002 DS    0H                                                  0003
*                                                                  0275
*        /* ENTRY POINT FOR THE ESTS MACRO.                         */
*                                                                  0276
*ICKTPES: ENTRY (GDTTBLX,FILENAME,STIDS);                          0276
         B     @EC00276                                            0276
@EP00276 MVC   @PC00001(12),0(@01)                                 0276
@EC00276 DS    0H                                                  0277
*        GDTPR = ADDR(GDTTBLX);                                    0277
         L     GDTPR,@PC00001                                      0277
*        CALL ICKSACL0 (GDTTBLX,TP04ENT,ESTSARG,FILENAME,STIDS);   0278
         L     @06,@PC00001                                        0278
         ST    @06,@AL00001                                        0278
         LA    @06,TP04ENT                                         0278
         ST    @06,@AL00001+4                                      0278
         LA    @06,ESTSARG                                         0278
         ST    @06,@AL00001+8                                      0278
         L     @06,@PC00001+4                                      0278
         ST    @06,@AL00001+12                                     0278
         L     @06,@PC00001+8                                      0278
         ST    @06,@AL00001+16                                     0278
         MVI   @AL00001+16,X'80'                                   0278
         L     @15,GDTCAL(,GDTPR)                                  0278
         LA    @01,@AL00001                                        0278
         BALR  @14,@15                                             0278
*        RESPECIFY RTNREG RSTD;                                    0279
*        TESTRC = RTNREG;                                          0280
         STH   RTNREG,TESTRC                                       0280
*        RESPECIFY RTNREG UNRSTD;                                  0281
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0282
*                                                                  0282
         ST    GDTPR,@AL00001                                      0282
         LA    @06,MODID                                           0282
         ST    @06,@AL00001+4                                      0282
         LA    @06,TESTRC                                          0282
         ST    @06,@AL00001+8                                      0282
         MVI   @AL00001+8,X'80'                                    0282
         L     @15,GDTEPL(,GDTPR)                                  0282
         LA    @01,@AL00001                                        0282
         BALR  @14,@15                                             0282
*        /* ENTRY POINT FOR THE ESTA MACRO.                         */
*                                                                  0283
*ICKTPEA: ENTRY (GDTTBLX,FILENAME,PCALIST);                        0283
         B     @EC00283                                            0283
@EP00283 MVC   @PC00001(8),0(@01)                                  0283
         MVC   @PC00001+12(4),8(@01)                               0283
@EC00283 DS    0H                                                  0284
*        GDTPR = ADDR(GDTTBLX);                                    0284
         L     GDTPR,@PC00001                                      0284
*        CALL ICKSACL0 (GDTTBLX,TP04ENT,ESTAARG,FILENAME,PCALIST); 0285
         L     @06,@PC00001                                        0285
         ST    @06,@AL00001                                        0285
         LA    @06,TP04ENT                                         0285
         ST    @06,@AL00001+4                                      0285
         LA    @06,ESTAARG                                         0285
         ST    @06,@AL00001+8                                      0285
         L     @06,@PC00001+4                                      0285
         ST    @06,@AL00001+12                                     0285
         L     @06,@PC00001+12                                     0285
         ST    @06,@AL00001+16                                     0285
         MVI   @AL00001+16,X'80'                                   0285
         L     @15,GDTCAL(,GDTPR)                                  0285
         LA    @01,@AL00001                                        0285
         BALR  @14,@15                                             0285
*        RESPECIFY RTNREG RSTD;                                    0286
*        TESTRC = RTNREG;                                          0287
         STH   RTNREG,TESTRC                                       0287
*        RESPECIFY RTNREG UNRSTD;                                  0288
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0289
*                                                                  0289
         ST    GDTPR,@AL00001                                      0289
         LA    @06,MODID                                           0289
         ST    @06,@AL00001+4                                      0289
         LA    @06,TESTRC                                          0289
         ST    @06,@AL00001+8                                      0289
         MVI   @AL00001+8,X'80'                                    0289
         L     @15,GDTEPL(,GDTPR)                                  0289
         LA    @01,@AL00001                                        0289
         BALR  @14,@15                                             0289
*        /* ENTRY POINT FOR THE REST MACRO.                         */
*ICKTPRS: ENTRY (GDTTBLX,FILENAME,PTR1,PTR2,PTR3,PTR4,PTR5,PTR6,PTR7);
         B     @EC00290                                            0290
@EP00290 MVC   @PC00001(8),0(@01)                                  0290
         MVC   @PC00001+16(28),8(@01)                              0290
@EC00290 DS    0H                                                  0291
*        GDTPR = ADDR(GDTTBLX);                                    0291
         L     GDTPR,@PC00001                                      0291
*        CALL ICKSACL0 (GDTTBLX,TP04ENT,RESTARG,FILENAME,PTR1,PTR2,PTR3
*PTR4,                                                             0292
*        PTR5,PTR6,PTR7);                                          0292
         L     @06,@PC00001                                        0292
         ST    @06,@AL00001                                        0292
         LA    @06,TP04ENT                                         0292
         ST    @06,@AL00001+4                                      0292
         LA    @06,RESTARG                                         0292
         ST    @06,@AL00001+8                                      0292
         L     @06,@PC00001+4                                      0292
         ST    @06,@AL00001+12                                     0292
         L     @06,@PC00001+16                                     0292
         ST    @06,@AL00001+16                                     0292
         L     @06,@PC00001+20                                     0292
         ST    @06,@AL00001+20                                     0292
         L     @06,@PC00001+24                                     0292
         ST    @06,@AL00001+24                                     0292
         L     @06,@PC00001+28                                     0292
         ST    @06,@AL00001+28                                     0292
         L     @06,@PC00001+32                                     0292
         ST    @06,@AL00001+32                                     0292
         L     @06,@PC00001+36                                     0292
         ST    @06,@AL00001+36                                     0292
         L     @06,@PC00001+40                                     0292
         ST    @06,@AL00001+40                                     0292
         MVI   @AL00001+40,X'80'                                   0292
         L     @15,GDTCAL(,GDTPR)                                  0292
         LA    @01,@AL00001                                        0292
         BALR  @14,@15                                             0292
*        RESPECIFY RTNREG RSTD;                                    0293
*        TESTRC = RTNREG;                                          0294
         STH   RTNREG,TESTRC                                       0294
*        RESPECIFY RTNREG UNRSTD;                                  0295
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0296
*                                                                  0296
         ST    GDTPR,@AL00001                                      0296
         LA    @06,MODID                                           0296
         ST    @06,@AL00001+4                                      0296
         LA    @06,TESTRC                                          0296
         ST    @06,@AL00001+8                                      0296
         MVI   @AL00001+8,X'80'                                    0296
         L     @15,GDTEPL(,GDTPR)                                  0296
         LA    @01,@AL00001                                        0296
         BALR  @14,@15                                             0296
*        /* ENTRY POINT FOR THE RESET MACRO.                        */
*                                                                  0297
*ICKTPRE: ENTRY (GDTTBLX,FILENAME,PGNOPTR);                        0297
         B     @EC00297                                            0297
@EP00297 MVC   @PC00001(8),0(@01)                                  0297
         MVC   @PC00001+44(4),8(@01)                               0297
@EC00297 DS    0H                                                  0298
*        GDTPR = ADDR(GDTTBLX);                                    0298
         L     GDTPR,@PC00001                                      0298
*        CALL ICKSACL0 (GDTTBLX,TP04ENT,RSETARG,FILENAME,PGNOPTR); 0299
         L     @06,@PC00001                                        0299
         ST    @06,@AL00001                                        0299
         LA    @06,TP04ENT                                         0299
         ST    @06,@AL00001+4                                      0299
         LA    @06,RSETARG                                         0299
         ST    @06,@AL00001+8                                      0299
         L     @06,@PC00001+4                                      0299
         ST    @06,@AL00001+12                                     0299
         L     @06,@PC00001+44                                     0299
         ST    @06,@AL00001+16                                     0299
         MVI   @AL00001+16,X'80'                                   0299
         L     @15,GDTCAL(,GDTPR)                                  0299
         LA    @01,@AL00001                                        0299
         BALR  @14,@15                                             0299
*        RESPECIFY RTNREG RSTD;                                    0300
*        TESTRC = RTNREG;                                          0301
         STH   RTNREG,TESTRC                                       0301
*        RESPECIFY RTNREG UNRSTD;                                  0302
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0303
         ST    GDTPR,@AL00001                                      0303
         LA    @06,MODID                                           0303
         ST    @06,@AL00001+4                                      0303
         LA    @06,TESTRC                                          0303
         ST    @06,@AL00001+8                                      0303
         MVI   @AL00001+8,X'80'                                    0303
         L     @15,GDTEPL(,GDTPR)                                  0303
         LA    @01,@AL00001                                        0303
         BALR  @14,@15                                             0303
*         /***********************************************************/
*         /*                                                         */
*         /* THE RUNNING CODE BEGINS HERE.  FIRST, WE MUST SET UP    */
*         /* WORKING STORAGE.                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0304
*ICKTPPR: ENTRY (GDTTBLX,FILENAME,DDPTR,FMPTR);                    0304
*                                                                  0304
*                                                                  0304
         B     @EC00304                                            0304
@EP00304 MVC   @PC00001(8),0(@01)                                  0304
         MVC   @PC00001+48(8),8(@01)                               0304
@EC00304 DS    0H                                                  0305
*                                                                  0305
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0305
*        GEN;                                                      0305
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0306
         LA    @06,1                                               0306
         STC   @06,LISTLN                                          0306
@DL00306 L     @03,LISTSCAN                                        0306
         TM    LISTTEST(@03),B'10000000'                           0306
         BNZ   @DC00306                                            0306
*          LISTSCAN = LISTSCAN + 4;                                0307
         AL    @03,@CF00036                                        0307
         ST    @03,LISTSCAN                                        0307
*        END;                                                      0308
*                                                                  0308
*                                                                  0308
         AL    @06,@CF00160                                        0308
         STC   @06,LISTLN                                          0308
         C     @06,@CF00779                                        0308
         BNH   @DL00306                                            0308
@DC00306 DS    0H                                                  0309
*         GDTPR = ADDR(GDTTBLX);                                   0309
         L     GDTPR,@PC00001                                      0309
*         IF GDTTPH = NULLPTR                                      0310
*           THEN                                                   0310
         L     @06,GDTTPH(,GDTPR)                                  0310
         LTR   @06,@06                                             0310
         BNZ   @RF00310                                            0310
*             /*******************************************************/
*             /*                                                     */
*             /* AN ENTRY AT THIS POINT WITHOUT A PCT POINTER IS     */
*             /* A CATASTROPHE.                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0311
*                                                                  0311
*             DO;                                                  0311
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0312
*               REG15 = 24;                                        0313
         LA    REG15,24                                            0313
*               REG14 = GDTABT;                                    0314
         L     REG14,GDTABT(,GDTPR)                                0314
*               REG13 = GDTABH;                                    0315
         L     REG13,GDTABH(,GDTPR)                                0315
*               GEN(BR    REG14);                                  0316
         BR    REG14
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0317
*             END;                                                 0318
*                                                                  0318
*         DDSTRU = DDPTR;                                          0319
@RF00310 L     @04,@PC00001+48                                     0319
         L     DDSTRU,DDPTR(,@04)                                  0319
*         PCTPTR = GDTTPH;              /* SET LOCAL PCT PTR.        */
         L     PCTPTR,GDTTPH(,GDTPR)                               0320
*         IF PCTSPP ^= NULLPTR                                     0321
*           THEN                                                   0321
         L     @04,PCTSPP(,PCTPTR)                                 0321
         LTR   @04,@04                                             0321
         BZ    @RF00321                                            0321
*             PCTPTR = PCTSPP;          /* SET SECONDARY PCT PTR     */
         LR    PCTPTR,@04                                          0322
*         FFMFLAG = ''B;                /* CLEAR THE CONTROL FLAGS   */
@RF00321 XC    FFMFLAG(2),FFMFLAG                                  0323
*         FFMREDOS = 0;                 /* CLEAR REDO START.         */
         SLR   @04,@04                                             0324
         ST    @04,FFMREDOS                                        0324
*         FFMREDOC = 0;                 /* INITIALIZE REDO COUNT.    */
         STH   @04,FFMREDOC                                        0325
*         FFMBDP = DARGDBP;             /* SET DATA BLOCK POINTER.   */
         L     @03,DARGDBP(,DDSTRU)                                0326
         ST    @03,FFMBDP                                          0326
*         FFMRBOFF = 0;                 /* INITIALIZE REDO OFFSET.   */
         STH   @04,FFMRBOFF                                        0327
*         IF DARGFULL = ON              /* IF THIS IS A              */
*           THEN                        /* PRINT REQUEST             */
         CLC   DARGFULL(4),@CF00463                                0328
         BNE   @RF00328                                            0328
*             CVPRETP = NULLPTR;        /* FROM THE PRINT            */
         ST    @04,CVPRETP                                         0329
*           ELSE                        /* FSR, THEN SETUP           */
*             CVPRETP = DARGRETP;       /* FOR HANDLING              */
         B     @RC00328                                            0330
@RF00328 L     @04,DARGRETP(,DDSTRU)                               0330
         ST    @04,CVPRETP                                         0330
*         DARGILP1 = NULLPTR;           /* LARGE BLOCKS              */
@RC00328 SLR   @04,@04                                             0331
         ST    @04,DARGILP1                                        0331
*         CVPRETC = DARGRETL;           /* SET RETURN AREA LENGTH.   */
         LH    @03,DARGRETL(,DDSTRU)                               0332
         STH   @03,CVPRETC                                         0332
*         FFMPASS = ON;                 /* TURN ON THE FIRST PASS SW */
         OI    FFMPASS,B'00010000'                                 0333
*         PRTBUFF = ' ';                /* SET OUTPUT BUFFER BLANK   */
         MVI   PRTBUFF+1,C' '                                      0334
         MVC   PRTBUFF+2(131),PRTBUFF+1                            0334
         MVI   PRTBUFF,C' '                                        0334
*         SAVERC = 0;                   /* INITIALIZE RETURN CODE.   */
         STH   @04,SAVERC                                          0335
*         PCTAPC = 0;                   /* CLEAR NEXT PRINT POSITION */
         STH   @04,PCTAPC(,PCTPTR)                                 0336
*         PCTIOP = FILENAME;            /* SET ALTERNATE IOCS PTR    */
         L     @03,@PC00001+4                                      0337
         L     @03,FILENAME(,@03)                                  0337
         ST    @03,PCTIOP(,PCTPTR)                                 0337
*         PCTPMN =''B;                  /*RESET PUT MSG NBR          */
*                                                                  0338
         SLR   @03,@03                                             0338
         STH   @03,PCTPMN(,PCTPTR)                                 0338
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE FORMAT STRUCTURED ARGUMENT LIST ADDRESSING.  */
*         /* IF AN STID EXISTS IN THE DYNAMIC DATA STRUCTURE,        */
*         /* SEARCH THE QUEUED LIST FOR IT AND IF NOT FOUND, GET     */
*         /* IT WITH A CALL TO ICKTP05. (GET STATIC TEXT)            */
*         /* IF NO STID EXISTS, THEN SET UP THE ADDRESSING FROM THE  */
*         /* POINTER PASSED WITH THE CALL.                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0339
*         IF GDTDBG = NULLPTR                                      0339
*           THEN;                                                  0339
         C     @04,GDTDBG(,GDTPR)                                  0339
         BE    @RT00339                                            0339
*           ELSE                                                   0341
*             CALL ICKDB010 (GDTTBL,'TPSI');                       0341
*                                                                  0341
         ST    GDTPR,@AL00001                                      0341
         LA    @04,@CC00783                                        0341
         ST    @04,@AL00001+4                                      0341
         MVI   @AL00001+4,X'80'                                    0341
         L     @15,GDTDBG(,GDTPR)                                  0341
         LA    @01,@AL00001                                        0341
         BALR  @14,@15                                             0341
*         IF DARGSTID ^= NULLPTR                                   0342
*           THEN                                                   0342
@RT00339 L     @04,DARGSTID(,DDSTRU)                               0342
         LTR   @04,@04                                             0342
         BZ    @RF00342                                            0342
*             DO;                                                  0343
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH THE STATIC TEXT QUEUE FOR THIS STID.         */
*             /*  THIS QUEUE IS KEPT DURING EACH FSR EXECUTION.      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0344
*               QENTP = PCTSQP;                                    0344
         L     @04,PCTSQP(,PCTPTR)                                 0344
         ST    @04,QENTP                                           0344
*               DO WHILE QENTP ^= NULLPTR & QSTID ^= DARGSTID;     0345
         B     @DE00345                                            0345
@DL00345 DS    0H                                                  0346
*                 QENTP = QCHAIN;                                  0346
         L     @04,QENTP                                           0346
         L     @04,QCHAIN(,@04)                                    0346
         ST    @04,QENTP                                           0346
*               END;                                               0347
@DE00345 L     @04,QENTP                                           0347
         LTR   @04,@04                                             0347
         BZ    @DC00345                                            0347
         CLC   QSTID(4,@04),DARGSTID(DDSTRU)                       0347
         BNE   @DL00345                                            0347
@DC00345 DS    0H                                                  0348
*               IF QENTP = NULLPTR                                 0348
*                 THEN                                             0348
         L     @04,QENTP                                           0348
         LTR   @04,@04                                             0348
         BNZ   @RF00348                                            0348
*                   DO;                                            0349
*                                                                  0349
*                   /*************************************************/
*                   /*                                               */
*                   /* MAKE THE CALL TO GET STATIC TEXT (ICKTP05)    */
*                   /* THE ADDRESSING TO THE FORMAT LIST IS SET BY   */
*                   /* THE ADDRESS RETURNED FROM GET STATIC TEXT.    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0350
*                       CALL ICKSACL0 (GDTTBL,'ICKTP05 ',          0350
*                       DARGSTID,SBPOOL,QENTP);                    0350
*                                                                  0350
         ST    GDTPR,@AL00001                                      0350
         LA    @04,@CC00784                                        0350
         ST    @04,@AL00001+4                                      0350
         LA    @04,DARGSTID(,DDSTRU)                               0350
         ST    @04,@AL00001+8                                      0350
         LA    @04,SBPOOL                                          0350
         ST    @04,@AL00001+12                                     0350
         LA    @04,QENTP                                           0350
         ST    @04,@AL00001+16                                     0350
         MVI   @AL00001+16,X'80'                                   0350
         L     @15,GDTCAL(,GDTPR)                                  0350
         LA    @01,@AL00001                                        0350
         BALR  @14,@15                                             0350
*                       RESPECIFY RTNREG RSTD;                     0351
*                       TESTRC = RTNREG;                           0352
         STH   RTNREG,TESTRC                                       0352
*                       RESPECIFY RTNREG UNRSTD;                   0353
*                       IF TESTRC ^= 0                             0354
*                         THEN                                     0354
         LH    @04,TESTRC                                          0354
         LTR   @04,@04                                             0354
         BZ    @RF00354                                            0354
*                           DO;                                    0355
*                             CALL ERROR(6);                       0356
         LA    @01,@AL00356                                        0356
         BAL   @14,ERROR                                           0356
*                             CALL ICKSAEP0(GDTTBL,MODID,TESTRC);  0357
         ST    GDTPR,@AL00001                                      0357
         LA    @04,MODID                                           0357
         ST    @04,@AL00001+4                                      0357
         LA    @04,TESTRC                                          0357
         ST    @04,@AL00001+8                                      0357
         MVI   @AL00001+8,X'80'                                    0357
         L     @15,GDTEPL(,GDTPR)                                  0357
         LA    @01,@AL00001                                        0357
         BALR  @14,@15                                             0357
*                           END;                                   0358
*                   END;                                           0359
*                                                                  0359
@RF00354 DS    0H                                                  0360
*               /*****************************************************/
*               /*                                                   */
*               /* IF THIS STATIC TEXT STRUCTURE IS FOR A HEADER,    */
*               /* SET UP THE HEADING INFORMATION IN THE PCT.        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0360
*               IF QHEADF = ON                                     0360
*                 THEN                                             0360
@RF00348 L     @04,QENTP                                           0360
         TM    QHEADF(@04),B'01000000'                             0360
         BNO   @RF00360                                            0360
*                   DO;                                            0361
*                     PCTHLC = QHLC;                               0362
         IC    @03,QHLC(,@04)                                      0362
         STC   @03,PCTHLC(,PCTPTR)                                 0362
*                     PCTHSC = QHSC;                               0363
         IC    @03,QHSC(,@04)                                      0363
         STC   @03,PCTHSC(,PCTPTR)                                 0363
*                     PCTH1F = ON;                                 0364
*                     PCTH2F = OFF;                                0365
         OI    PCTH1F(PCTPTR),B'10000000'                          0365
         NI    PCTH2F(PCTPTR),B'10111111'                          0365
*                   END;                                           0366
*               IF QMSGF = ON                                      0367
*                 THEN                                             0367
@RF00360 L     @04,QENTP                                           0367
         TM    QMSGF(@04),B'10000000'                              0367
         BNO   @RF00367                                            0367
*                   DO;                                            0368
*                     FFMPMSF = ON;                                0369
         OI    FFMPMSF,B'00010000'                                 0369
*                     PCTPMN = -1;                                 0370
         MVC   PCTPMN(2,PCTPTR),@CH00786                           0370
*                   END;                                           0371
*               FSADDR = ADDR(QTEXT);                              0372
@RF00367 L     FSADDR,QENTP                                        0372
         LA    FSADDR,QTEXT(,FSADDR)                               0372
*             END;                                                 0373
*                                                                  0373
*             /*******************************************************/
*             /*                                                     */
*             /* SET THE ADDRESSING TO THE FORMAT LIST WHEN NO STID  */
*             /* IS PASSED IN THE DYNAMIC ARGUMENT LIST.             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0374
*           ELSE                                                   0374
*             DO;                                                  0374
         B     @RC00342                                            0374
@RF00342 DS    0H                                                  0375
*               IF LISTLN = 4                                      0375
*                 THEN                                             0375
         CLI   LISTLN,4                                            0375
         BNE   @RF00375                                            0375
*                   FSADDR = FMPTR;                                0376
         L     @04,@PC00001+52                                     0376
         L     FSADDR,FMPTR(,@04)                                  0376
*                 ELSE                                             0377
*                   DO;                                            0377
         B     @RC00375                                            0377
@RF00375 DS    0H                                                  0378
*                     CALL ERROR (1);                              0378
         LA    @01,@AL00378                                        0378
         BAL   @14,ERROR                                           0378
*                     RETURN CODE(RCQUIT);                         0379
         LH    @03,RCQUIT                                          0379
         L     @13,4(,@13)                                         0379
         L     @00,@SIZDATD                                        0379
         LR    @01,@08                                             0379
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@03                                             0379
         L     @14,12(,@13)                                        0379
         LM    @00,@12,20(@13)                                     0379
         BR    @14                                                 0379
*                   END;                                           0380
*             END;                                                 0381
@RC00375 DS    0H                                                  0382
*         FFMSTRS = FSADDR;                                        0382
*                                                                  0382
@RC00342 ST    FSADDR,FFMSTRS                                      0382
*         /***********************************************************/
*         /*                                                         */
*         /* IF NO INITIAL SPACING SUB-STRUCTURE EXISTS, SET DEFAULT.*/
*         /* SPACING FOR THE FIRST LINE.                             */
*         /* DEFAULT SPACING IS SET FROM THE DEFAULT SPACE CHARACTER */
*         /* IN THE PRINT CONTROL TABLE SET UP BY THE UEST OR UREST  */
*         /* MACROS.                                                 */
*         /* SPACE TYPE IS SET TO 'R'. (RELATIVE)                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0383
*         IF FMTSCF = OFF                                          0383
*           THEN                                                   0383
         TM    FMTSCF(FSADDR),B'01000000'                          0383
         BNZ   @RF00383                                            0383
*             DO;                                                  0384
*               PRTSPF = PCTDSC;        /* SET DEFAULT SPACE FACTOR  */
         LH    @04,PCTDSC(,PCTPTR)                                 0385
         STH   @04,PRTSPF                                          0385
*               PRTSPT = 'R';           /* SET RELATIVE SPACING.     */
         MVI   PRTSPT,C'R'                                         0386
*             END;                                                 0387
*                                                                  0387
*         /***********************************************************/
*         /*                                                         */
*         /* THIS IS THE BASE DO LOOP FOR EXECUTION OF THE FORMAT    */
*         /* STRUCTURES.                                             */
*         /* THIS LOOP SCANS THROUGH THE FORMAT LIST SUB-STRUCTURES  */
*         /* SETTING UP PARAMETERS FOR THE CALL TO THE CONVERSION    */
*         /* PROCEDURE(CONVERT) AND CALLING THAT PROC ONCE FOR EACH  */
*         /* FORMAT SUB-STRUCTURE THAT DEFINES DATA.  (BLOCK, INSERT,*/
*         /* STATIC TEXT OR DEFAULT SUB-STRUCTURES)                  */
*         /* SPACE AND REDO SUB-STRUCTURES ARE HANDLED ENTIRELY      */
*         /* WITHIN THIS PROCEDURE                                   */
*         /* THE END OF THIS DO LOOP IS AFTER THE REDO LOOPING       */
*         /* CONTROLS NEAR THE END OF THIS MAIN PROCEDURE.           */
*         /* CONTROL FLAGS USED IN THIS ROUTINE ARE AS FOLLOWS       */
*         /*    FFMEOS - END OF THE SUB-STRUCTURES.                  */
*         /*    FFMVS - A VALID SUB-STRUCTURE FOUND.                 */
*         /*    FFMDATA - A DATA SUB-STRUCTURE HAS BEEN FOUND.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0388
*STRLOOP: DO WHILE FFMEOS = OFF;        /* END OF STRUCT LIST FLAG   */
@RF00383 DS    0H                                                  0388
STRLOOP  B     @DE00388                                            0388
@DL00388 DS    0H                                                  0389
*           IF FMTSCF = ON              /* SPACE CONTROL FLAG.       */
*             THEN                                                 0389
         TM    FMTSCF(FSADDR),B'01000000'                          0389
         BNO   @RF00389                                            0389
*               DO;                                                0390
*                 /***************************************************/
*                 /*                                                 */
*                 /* HANDLE A SPACING SUB-STRUCTURE.                 */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0391
*                 FFMVS = ON;                                      0391
*                                                                  0391
         OI    FFMVS,B'01000000'                                   0391
*                 CALL SPACE;                                      0392
*                                                                  0392
         BAL   @14,SPACE                                           0392
*                 RESPECIFY RTNREG RSTD;                           0393
*                 TESTRC = RTNREG;                                 0394
         STH   RTNREG,TESTRC                                       0394
*                 RESPECIFY RTNREG UNRSTD;                         0395
*                 IF TESTRC ^= 0                                   0396
*                   THEN                                           0396
         LH    @04,TESTRC                                          0396
         LTR   @04,@04                                             0396
         BZ    @RF00396                                            0396
*                     CALL ICKSAEP0(GDTTBL,MODID,RCQUIT);          0397
*                                                                  0397
         MVC   @AL00001+4(8),@AL00397                              0397
         ST    GDTPR,@AL00001                                      0397
         L     @15,GDTEPL(,GDTPR)                                  0397
         LA    @01,@AL00001                                        0397
         BALR  @14,@15                                             0397
*               END;                                               0398
*             ELSE                                                 0399
*               IF FMTREPF = ON         /* REDO FLAG.                */
*                 THEN                                             0399
         B     @RC00389                                            0399
@RF00389 TM    FMTREPF(FSADDR),B'00001000'                         0399
         BNO   @RF00399                                            0399
*                   DO;                                            0400
*                   /*************************************************/
*                   /*                                               */
*                   /* HANDLE A REDO OR REPLICATION SUB-STRUCTURE.   */
*                   /*                                               */
*                   /*************************************************/
*                     FFMVS = ON;                                  0401
*                                                                  0401
         OI    FFMVS,B'01000000'                                   0401
*                     CALL REDO;                                   0402
*                                                                  0402
         BAL   @14,REDO                                            0402
*                   END;                                           0403
*                 ELSE                                             0404
*                   IF FMTSTF = ON      /* STATIC TEXT FLAG.         */
*                     THEN                                         0404
         B     @RC00399                                            0404
@RF00399 TM    FMTSTF(FSADDR),B'00000100'                          0404
         BNO   @RF00404                                            0404
*                       DO;                                        0405
*                       /*********************************************/
*                       /*                                           */
*                       /* HANDLE A STATIC TEXT SUB-STRUCTURE.       */
*                       /*                                           */
*                       /*********************************************/
*                         FFMDATA = ON;                            0406
         OI    FFMDATA,B'00000010'                                 0406
*                         FFMVS = ON;                              0407
*                                                                  0407
         OI    FFMVS,B'01000000'                                   0407
*                         CALL STATIC;                             0408
*                                                                  0408
         BAL   @14,STATIC                                          0408
*                       END;                                       0409
*                     ELSE                                         0410
*                       IF FMTBDF = ON  /* BLOCK DATA FLAG.          */
*                         THEN                                     0410
         B     @RC00404                                            0410
@RF00404 TM    FMTBDF(FSADDR),B'00010000'                          0410
         BNO   @RF00410                                            0410
*                           DO;                                    0411
*                           /*****************************************/
*                           /*                                       */
*                           /* HANDLE A BLOCK DATA SUB-STRUCTURE.    */
*                           /*                                       */
*                           /*****************************************/
*                             FFMDATA = ON;                        0412
         OI    FFMDATA,B'00000010'                                 0412
*                             FFMVS = ON;                          0413
*                                                                  0413
         OI    FFMVS,B'01000000'                                   0413
*                             CALL BLOCK;                          0414
*                                                                  0414
         BAL   @14,BLOCK                                           0414
*                           END;                                   0415
*                         ELSE                                     0416
*                           IF FMTIDF = ON                         0416
*                                       /* INSERT DATA FLAG.         */
*                             THEN                                 0416
         B     @RC00410                                            0416
@RF00410 TM    FMTIDF(FSADDR),B'00100000'                          0416
         BNO   @RF00416                                            0416
*                               DO;                                0417
*                               /*************************************/
*                               /*                                   */
*                               /* HANDLE A DATA INSERT  DATA        */
*                               /* SUB-STRUCTURE.                    */
*                               /*                                   */
*                               /*************************************/
*                                 FFMDATA = ON;                    0418
         OI    FFMDATA,B'00000010'                                 0418
*                                 FFMVS = ON;                      0419
*                                                                  0419
         OI    FFMVS,B'01000000'                                   0419
*                                 CALL INSERT;                     0420
*                                                                  0420
         BAL   @14,INSERT                                          0420
*                               END;                               0421
*                       ELSE                                       0422
*                         IF FMTDFF = ON                           0422
*                                       /* DEFAULT DATA FLAG.        */
*                           THEN                                   0422
         B     @RC00416                                            0422
@RF00416 TM    FMTDFF(FSADDR),B'00000010'                          0422
         BNO   @RF00422                                            0422
*                             DO;                                  0423
*                             /***************************************/
*                             /*                                     */
*                             /* BYPASS A DEFAULT DATA SUB-STRUCTURE */
*                             /* IF A DEFAULT DATA SUB-STRUCTURE     */
*                             /* IS USED, IT IS USED IN THE INSERT   */
*                             /* HANDLING CODE BECAUSE THE REFERENCE */
*                             /* NUMBER WAS NOT FOUND IN THE USERS   */
*                             /* DYNAMIC ARGUMENT LIST.  THERE FORE, */
*                             /* IT IS NEVER USED IN LINE.           */
*                             /*                                     */
*                             /***************************************/
*                               STRSTP = 12;                       0424
         MVC   STRSTP(2),@CH00034                                  0424
*                               FFMVS = ON;                        0425
         OI    FFMVS,B'01000000'                                   0425
*                             END;                                 0426
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK TO INSURE THAT A VALID SUB-STRUCTURE WAS FOUND. */
*           /* IF NONE WAS FOUND, ISSUE ERROR MESSAGE AND RETURN.    */
*           /*                                                       */
*           /*********************************************************/
*           IF FFMVS = OFF                                         0427
*             THEN                                                 0427
@RF00422 DS    0H                                                  0427
@RC00416 DS    0H                                                  0427
@RC00410 DS    0H                                                  0427
@RC00404 DS    0H                                                  0427
@RC00399 DS    0H                                                  0427
@RC00389 TM    FFMVS,B'01000000'                                   0427
         BNZ   @RF00427                                            0427
*               DO;                                                0428
*                                                                  0428
*                 CALL ERROR(1);                                   0429
*                                                                  0429
         LA    @01,@AL00429                                        0429
         BAL   @14,ERROR                                           0429
*                 CALL ICKSAEP0(GDTTBL,MODID,RCERR);               0430
*                                                                  0430
         MVC   @AL00001+4(8),@AL00430                              0430
         ST    GDTPR,@AL00001                                      0430
         L     @15,GDTEPL(,GDTPR)                                  0430
         LA    @01,@AL00001                                        0430
         BALR  @14,@15                                             0430
*               END;                                               0431
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE SUB STRUCTURE WAS A DATA HANDLING  STRUCTURE     */
*         /* (A STATIC TEXT, BLOCK DATA OR INSERT DATA SUB-STRUCTURE)*/
*         /* CONTINUE HERE WITH THE HANDLING OF THAT STRUCTURE.      */
*         /* VERIFY AND SET UP THE OUTPUT COLUMN AND LENGTH FOR THE  */
*         /* DATA TYPE TO BE HANDLED.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0432
*           IF FFMDATA = ON & FFMPINH = OFF                        0432
*             THEN                                                 0432
@RF00427 TM    FFMDATA,B'00000010'                                 0432
         BNO   @RF00432                                            0432
         TM    FFMPINH,B'10000000'                                 0432
         BNZ   @RF00432                                            0432
*DATALOOP:      DO;                                                0433
*                                                                  0433
DATALOOP DS    0H                                                  0434
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET UP THE CONVERSION FLAGS IN THE PRINT AND    */
*                 /* CONVERSION ARGUMENT LIST.                       */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0434
*                 CVPTYF = FMTCNVF;                                0434
         MVC   CVPTYF(2),FMTCNVF(FSADDR)                           0434
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET THE PARAMETERS FOR THE CONVERSION CALL.     */
*                 /* THE PARAMETERS SET ARE-                         */
*                 /*    CVPIADD - THE INPUT STRING ADDRESS.          */
*                 /*        SET IN INPUT SUB-STRUCTURE HANDLING      */
*                 /*    CVPPADD - THE PRINT LINE POSITION ADDRESS.   */
*                 /*    CVPIL - THE INPUT STRING LENGTH.             */
*                 /*        SET IN INPUT SUB-STRUCTURE HANDLING      */
*                 /*    CVPOL THE OUTPUT STRING LENGTH.              */
*                 /*    CVPRETC = THE RETURN AREA LENGTH.            */
*                 /*    CVPRETP - THE RETURN AREA POINTER.           */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0435
*                 IF FMTBS = ON         /* IF BLANK SUPPRESSION.     */
*                   THEN                /* ADD OFFSET IN FMTOCOL TO  */
         TM    FMTBS(FSADDR),B'00010000'                           0435
         BNO   @RF00435                                            0435
*                                       /* LAST AVAILABLE POSITION.  */
*                     CVPPADD = ADDR(PRTBUFF) + FMTOCOL + PCTAPC;  0436
         LA    @04,PRTBUFF                                         0436
         AH    @04,FMTOCOL(,FSADDR)                                0436
         AH    @04,PCTAPC(,PCTPTR)                                 0436
         ST    @04,CVPPADD                                         0436
*                   ELSE                /* PRINT COLUMN IN FMTOCOL   */
*                                       /* TO A POSSIBLE INDENT.     */
*                     CVPPADD = ADDR(PRTBUFF) + FMTOCOL - 1 + DARGIND;
         B     @RC00435                                            0437
@RF00435 LA    @04,PRTBUFF                                         0437
         AH    @04,FMTOCOL(,FSADDR)                                0437
         BCTR  @04,0                                               0437
         SLR   @15,@15                                             0437
         IC    @15,DARGIND(,DDSTRU)                                0437
         ALR   @04,@15                                             0437
         ST    @04,CVPPADD                                         0437
*                 CVPOL = FMTOLEN;      /* SET OUTPUT LENGTH.        */
*                                                                  0438
@RC00435 LH    @04,FMTOLEN(,FSADDR)                                0438
         ST    @04,CVPOL                                           0438
*                 /***************************************************/
*                 /*                                                 */
*                 /* ASSURE PRINT COLUMN IS WITHIN THE PRINT LINE.   */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0439
*                 IF CVPPADD > (ADDR(PRTBUFF) + PCTPLW - 1)        0439
*                   THEN                                           0439
         LA    @04,PRTBUFF                                         0439
         AL    @04,PCTPLW(,PCTPTR)                                 0439
         BCTR  @04,0                                               0439
         C     @04,CVPPADD                                         0439
         BNL   @RF00439                                            0439
*                     DO;                                          0440
*                                                                  0440
*                       CALL ERROR(2);                             0441
*                                                                  0441
         LA    @01,@AL00441                                        0441
         BAL   @14,ERROR                                           0441
*                       FFMPINH = ON;                              0442
         OI    FFMPINH,B'10000000'                                 0442
*                     END;                                         0443
*                                                                  0443
*         /***********************************************************/
*         /*                                                         */
*         /* COMPUTE THE CONVERTED LENGTH FOR THE VARIOUS DATA TYPES */
*         /* CONVL IS USED IN THIS SECTION OF CODE TO HOLD THE       */
*         /* COMPUTED OUTPUT LENGTH FOR THE SELECTED DATA TYPE.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0444
*           CONVL = 0;                                             0444
*                                                                  0444
@RF00439 SLR   @04,@04                                             0444
         ST    @04,CONVL                                           0444
*           /* SET BINARY TO HEXIDECIMAL OR PACKED TO UNPACKED       */
*           /*  OR BINARY TO HEXADECIMAL APOSTROPHE.                 */
*                                                                  0445
*           IF CVPBH = ON  CVPPU = ON  CVPBHA = ON               0445
*             THEN                                                 0445
         TM    CVPBH,B'11001000'                                   0445
         BZ    @RF00445                                            0445
*               CONVL = CVPIL + CVPIL;                             0446
*                                                                  0446
         L     @04,CVPIL                                           0446
         LR    @15,@04                                             0446
         ALR   @15,@04                                             0446
         ST    @15,CONVL                                           0446
*           /* CHECK FOR MAXIMUM PACKED TO UNPACKED OUTPUT LENGTH.   */
*                                                                  0447
*           IF CVPPU = ON                                          0447
*             THEN                                                 0447
@RF00445 TM    CVPPU,B'00001000'                                   0447
         BNO   @RF00447                                            0447
*               DO;                                                0448
*                 IF CVPOL > 16  CVPIL > 8                        0449
*                   THEN                                           0449
         L     @04,CVPOL                                           0449
         C     @04,@CF00264                                        0449
         BH    @RT00449                                            0449
         L     @04,CVPIL                                           0449
         C     @04,@CF00156                                        0449
         BNH   @RF00449                                            0449
@RT00449 DS    0H                                                  0450
*                     DO;                                          0450
*                                                                  0450
*                       CALL ERROR(3);                             0451
*                                                                  0451
         LA    @01,@AL00451                                        0451
         BAL   @14,ERROR                                           0451
*                       IF CVPIL > 8                               0452
*                         THEN                                     0452
         LA    @04,8                                               0452
         C     @04,CVPIL                                           0452
         BNL   @RF00452                                            0452
*                           CVPIL = 8;                             0453
         ST    @04,CVPIL                                           0453
*                     END;                                         0454
@RF00452 DS    0H                                                  0455
*                CONVL = 16;                                       0455
@RF00449 MVC   CONVL(4),@CF00264                                   0455
*               END;                                               0456
*                                                                  0456
*           /* CHECK FOR MAXIMUM BINARY TO DECIMAL LENGTHS.          */
*                                                                  0457
*          IF CVPBD = ON                                           0457
*            THEN                                                  0457
@RF00447 TM    CVPBD,B'00010000'                                   0457
         BNO   @RF00457                                            0457
*              DO;                                                 0458
*                IF CVPIL > 4  CVPOL > 16                         0459
*                  THEN                                            0459
         L     @04,CVPIL                                           0459
         C     @04,@CF00036                                        0459
         BH    @RT00459                                            0459
         L     @04,CVPOL                                           0459
         C     @04,@CF00264                                        0459
         BNH   @RF00459                                            0459
@RT00459 DS    0H                                                  0460
*                    DO;                                           0460
*                                                                  0460
*                      CALL ERROR(3);                              0461
*                                                                  0461
         LA    @01,@AL00461                                        0461
         BAL   @14,ERROR                                           0461
*                      IF CVPIL > 4                                0462
*                        THEN                                      0462
         LA    @04,4                                               0462
         C     @04,CVPIL                                           0462
         BNL   @RF00462                                            0462
*                          CVPIL = 4;                              0463
         ST    @04,CVPIL                                           0463
*                    END;                                          0464
@RF00462 DS    0H                                                  0465
*                CONVL = 16;                                       0465
@RF00459 MVC   CONVL(4),@CF00264                                   0465
*              END;                                                0466
*                                                                  0466
*           /* IF NONE OF THE ABOVE, THEN SET TO THE INPUT LENGTH.   */
*                                                                  0467
*           IF CONVL = 0                                           0467
*             THEN                                                 0467
@RF00457 L     @04,CONVL                                           0467
         LTR   @04,@04                                             0467
         BNZ   @RF00467                                            0467
*               CONVL = CVPIL;                                     0468
*                                                                  0468
         L     @04,CVPIL                                           0468
         ST    @04,CONVL                                           0468
*         /***********************************************************/
*         /*                                                         */
*         /*  SET OUTPUT LENGTH FOR ANY DEFAULTED LENGTH FIELD.      */
*         /* CALLER SPECIFIED NO LENGTH IN THE FORMAT STRUCTURE.     */
*         /* OR SPECIFIED LENGTH WAS LESS THAN DATA LENGTH.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0469
*           IF CVPOL = 0  CONVL < CVPOL                           0469
*             THEN                                                 0469
@RF00467 L     @04,CVPOL                                           0469
         LTR   @04,@04                                             0469
         BZ    @RT00469                                            0469
         C     @04,CONVL                                           0469
         BNH   @RF00469                                            0469
@RT00469 DS    0H                                                  0470
*               CVPOL = CONVL;                                     0470
         L     @04,CONVL                                           0470
         ST    @04,CVPOL                                           0470
*                                                                  0471
*           /*********************************************************/
*           /*                                                       */
*           /* IF INPUT OR OUTPUT LENGTH IS LESS THAN ONE, THEN      */
*           /* PUT OUT AN ERROR MESSAGE HERE AND TERMINATE.          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0471
*           IF CVPOL < 1  CVPIL < 1                               0471
*             THEN                                                 0471
@RF00469 LA    @04,1                                               0471
         C     @04,CVPOL                                           0471
         BH    @RT00471                                            0471
         C     @04,CVPIL                                           0471
         BNH   @RF00471                                            0471
@RT00471 DS    0H                                                  0472
*               DO;                                                0472
*                                                                  0472
*                 CALL ERROR(1);                                   0473
*                                                                  0473
         LA    @01,@AL00473                                        0473
         BAL   @14,ERROR                                           0473
*                 CALL ICKSAEP0(GDTTBL,MODID,RCERR);               0474
*                                                                  0474
         MVC   @AL00001+4(8),@AL00474                              0474
         ST    GDTPR,@AL00001                                      0474
         L     @15,GDTEPL(,GDTPR)                                  0474
         LA    @01,@AL00001                                        0474
         BALR  @14,@15                                             0474
*               END;                                               0475
*                                                                  0475
*         /***********************************************************/
*         /*                                                         */
*         /* ADJUST OUTPUT LENGTH FOR BINARY TO HEXADECIMAL.         */
*         /* INSURE EVEN NUMBER OF OUTPUT BYTES FOR BINARY TO HEX    */
*         /* CONVERSION.                                             */
*         /*                                                         */
*         /***********************************************************/
*         IF CVPBH = ON  CVPBHA = ON                              0476
*           THEN                                                   0476
@RF00471 TM    CVPBH,B'11000000'                                   0476
         BZ    @RF00476                                            0476
*             DO;                                                  0477
*               IF CVPOL//2 ^= 0                                   0478
*                 THEN                                             0478
         L     @04,CVPOL                                           0478
         LR    @00,@04                                             0478
         SRDA  @00,32                                              0478
         D     @00,@CF00111                                        0478
         LTR   @00,@00                                             0478
         BZ    @RF00478                                            0478
*                   CVPOL = CVPOL + 1;                             0479
         AL    @04,@CF00160                                        0479
         ST    @04,CVPOL                                           0479
*             END;                                                 0480
*                                                                  0480
@RF00478 DS    0H                                                  0481
*           IF CVPBHA = ON                                         0481
*             THEN                                                 0481
@RF00476 TM    CVPBHA,B'01000000'                                  0481
         BNO   @RF00481                                            0481
*               CVPOL = CVPOL + 3;                                 0482
*                                                                  0482
*                                                                  0482
         LA    @04,3                                               0482
         AL    @04,CVPOL                                           0482
         ST    @04,CVPOL                                           0482
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE SUB-STRUCTURE IS FOR A BINARY TO HEXIDECIMAL     */
*         /* DUMP, CHECK FOR ANY PREVIOUS FORMATTING AS THAT LINE    */
*         /* MUST BE PRINTED PRIOR TO CONVERTING THE DUMP.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0483
*           IF CVPBHD = ON                                         0483
*             THEN                                                 0483
@RF00481 TM    CVPBHD,B'00100000'                                  0483
         BNO   @RF00483                                            0483
*               DO;                                                0484
*                                                                  0484
*                 IF FFMFMTF = ON                                  0485
*                   THEN                                           0485
         TM    FFMFMTF,B'00000001'                                 0485
         BNO   @RF00485                                            0485
*                     DO;                                          0486
*                                                                  0486
*                       CALL LINEPRT;                              0487
*                                                                  0487
         BAL   @14,LINEPRT                                         0487
*                       RESPECIFY RTNREG RSTD;                     0488
*                       TESTRC = RTNREG;                           0489
         STH   RTNREG,TESTRC                                       0489
*                       RESPECIFY RTNREG UNRSTD;                   0490
*                       IF TESTRC >0                               0491
*                         THEN                                     0491
         LH    @04,TESTRC                                          0491
         LTR   @04,@04                                             0491
         BNP   @RF00491                                            0491
*                           CALL ICKSAEP0(GDTTBL,MODID,RCQUIT);    0492
         MVC   @AL00001+4(8),@AL00492                              0492
         ST    GDTPR,@AL00001                                      0492
         L     @15,GDTEPL(,GDTPR)                                  0492
         LA    @01,@AL00001                                        0492
         BALR  @14,@15                                             0492
*                     END;                                         0493
*                                                                  0493
@RF00491 DS    0H                                                  0494
*                 /* SET THE PRINT ADDRESS FOR BINARY TO HEX DUMP.   */
*                                                                  0494
*                 CVPPADD = ADDR(PRTBUFF);                         0494
@RF00485 LA    @04,PRTBUFF                                         0494
         ST    @04,CVPPADD                                         0494
*               END;                                               0495
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP IS COMPLETE AND WE ARE NOW READY TO CALL THE     */
*         /* CONVERSION PROCEDURE(CONVERT) FOR THE CONVERSION OF THIS*/
*         /* SEGMENT.                                                */
*         /* RETURN CODES ARE                                        */
*         /*    0 - GOOD RETURN                                      */
*         /*    4 - GOOD RETURN BUT LINE OVERFLOW OCCURED AND ALL    */
*         /*        PREVIOUSLY FORMATTED DATA HAS BEEN PRINTED.      */
*         /*    8 - PACKED DECIMAL INPUT IS INVALID.                 */
*         /*    OTHER - ERROR IN CONVERSION OR PRINTING.             */
*         /*        GREATER THAN 8 IS TERMINATING.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0496
*           IF FFMPINH = OFF                                       0496
*             THEN                                                 0496
@RF00483 TM    FFMPINH,B'10000000'                                 0496
         BNZ   @RF00496                                            0496
*               DO;                                                0497
*                                                                  0497
*                 OLDERID2 = NEWERID2;                             0498
         L     @04,GDTTR2(,GDTPR)                                  0498
         MVC   @TS00001(95),NEWERID2(@04)                          0498
         MVC   OLDERID2(95,@04),@TS00001                           0498
*                 NEWID2 = 'TPCC';                                 0499
*                                                                  0499
         MVC   NEWID2(4,@04),@CC00798                              0499
*                 CALL CONVERT;                                    0500
*                                                                  0500
         BAL   @14,CONVERT                                         0500
*                 RESPECIFY RTNREG RSTD;                           0501
*                 TESTRC = RTNREG;                                 0502
         STH   RTNREG,TESTRC                                       0502
*                 RESPECIFY RTNREG UNRSTD;                         0503
*                 IF TESTRC > 8                                    0504
*                   THEN                                           0504
*                                                                  0504
         LH    @04,TESTRC                                          0504
         C     @04,@CF00156                                        0504
         BNH   @RF00504                                            0504
*                     CALL ICKSAEP0(GDTTBL,MODID,RCQUIT);          0505
*                                                                  0505
         MVC   @AL00001+4(8),@AL00505                              0505
         ST    GDTPR,@AL00001                                      0505
         L     @15,GDTEPL(,GDTPR)                                  0505
         LA    @01,@AL00001                                        0505
         BALR  @14,@15                                             0505
*                 IF TESTRC = 8                                    0506
*                   THEN                                           0506
@RF00504 CLC   TESTRC(2),@CH00156                                  0506
         BNE   @RF00506                                            0506
*                     DO;                                          0507
*                                                                  0507
*                       CALL ERROR (7);                            0508
*                                                                  0508
         LA    @01,@AL00508                                        0508
         BAL   @14,ERROR                                           0508
*                     END;                                         0509
*                 IF TESTRC = 0                                    0510
*                   THEN                                           0510
@RF00506 LH    @04,TESTRC                                          0510
         LTR   @04,@04                                             0510
         BNZ   @RF00510                                            0510
*                     FFMFMTF = ON;                                0511
         OI    FFMFMTF,B'00000001'                                 0511
*               END;                                               0512
@RF00510 DS    0H                                                  0513
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE REDO FLAG (FFMREDOF) IS ON, HANDLE THE LOOPING   */
*         /* CONTROLS FOR REDO HERE.                                 */
*         /*                                                         */
*         /* PARAMETERS CONTROLING REPLICATION ARE AS FOLLOWS:       */
*         /*                                                         */
*         /* FFMREDOF - FLAG INDICATING A REPLICATION IS OPERATING.  */
*         /* FFMREDOC - COUNT OF REDO STRUCTURES IN THE FORMAT LIST  */
*         /* FFMREDOL - COUNT OF THE NUMBER OF REPLICATIONS.         */
*         /* FFMREDOO - OFFSET IN BLOCK DATA FOR EACH REPLICATION.   */
*         /* FFMRBOFF - CURRENT INPUT BLOCK OFFSET.                  */
*         /* REDOCSAV - AREA FOR SAVING COUNT OF REDO FORMAT         */
*         /*            SUB-STRUCTURES.                              */
*         /* FFMREDOS - AREA FOR SAVING START OF REDO FORMAT         */
*         /*            SUB-STRUCTURES.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0513
*            END DATALOOP;                                         0513
@RF00496 DS    0H                                                  0514
*           IF FFMREDOF = ON & FFMDATA = ON                        0514
*             THEN                                                 0514
@RF00432 TM    FFMREDOF,B'10000010'                                0514
         BNO   @RF00514                                            0514
*               DO;                                                0515
*                                                                  0515
*                 /***************************************************/
*                 /*                                                 */
*                 /* REDUCE SUB-STRUCTURE COUNT BY ONE.              */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0516
*                 FFMREDOC = FFMREDOC - 1;                         0516
*                                                                  0516
         LH    @04,FFMREDOC                                        0516
         BCTR  @04,0                                               0516
         STH   @04,FFMREDOC                                        0516
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE REDO COUNT IS ZERO, THIS IS THE LAST     */
*                 /* SUB-STRUCTURE OF THE LOOP SO PRINT              */
*                 /* THE LINE.                                       */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0517
*                 IF FFMREDOC = 0        /* IS THIS THE LAST STRUCT  */
*                   THEN                                           0517
         LTR   @04,@04                                             0517
         BNZ   @RF00517                                            0517
*                     DO;                                          0518
*                                                                  0518
*                       /*********************************************/
*                       /*                                           */
*                       /* PRINT THIS COMPLETE LINE                  */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0519
*                       IF FFMFMTF = ON                            0519
*                         THEN                                     0519
         TM    FFMFMTF,B'00000001'                                 0519
         BNO   @RF00519                                            0519
*                           DO;                                    0520
*                                                                  0520
*                             CALL LINEPRT;                        0521
*                                                                  0521
         BAL   @14,LINEPRT                                         0521
*                             RESPECIFY RTNREG RSTD;               0522
*                             TESTRC = RTNREG;                     0523
         STH   RTNREG,TESTRC                                       0523
*                             RESPECIFY RTNREG UNRSTD;             0524
*                             IF TESTRC ^= 0                       0525
*                               THEN                               0525
         LH    @04,TESTRC                                          0525
         LTR   @04,@04                                             0525
         BZ    @RF00525                                            0525
*                                 CALL ICKSAEP0(GDTTBL,MODID,RCQUIT);
         MVC   @AL00001+4(8),@AL00526                              0526
         ST    GDTPR,@AL00001                                      0526
         L     @15,GDTEPL(,GDTPR)                                  0526
         LA    @01,@AL00001                                        0526
         BALR  @14,@15                                             0526
*                             IF FFMPMSF = ON     /* REDO A MESSAGE */
*                               THEN                               0527
@RF00525 TM    FFMPMSF,B'00010000'                                 0527
         BNO   @RF00527                                            0527
*                                 PCTPMN = -1;                     0528
         MVC   PCTPMN(2,PCTPTR),@CH00786                           0528
*                           END;                                   0529
*                                                                  0529
@RF00527 DS    0H                                                  0530
*                       /*********************************************/
*                       /*                                           */
*                       /* REDUCE THE LOOPING COUNT BY ONE.          */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0530
*                       FFMREDOL = FFMREDOL - 1;                   0530
*                                                                  0530
@RF00519 LH    @04,FFMREDOL                                        0530
         BCTR  @04,0                                               0530
         STH   @04,FFMREDOL                                        0530
*                       /*********************************************/
*                       /*                                           */
*                       /* IF THE LOOP COUNT IS ZERO, THIS IS THE    */
*                       /* LAST REPLICATION SO CLEAN UP AND END.     */
*                       /*                                           */
*                       /*********************************************/
*                       IF FFMREDOL = 0 /* IS THIS THE LAST TIME     */
*                         THEN                                     0531
         SLR   @15,@15                                             0531
         CR    @04,@15                                             0531
         BNE   @RF00531                                            0531
*                           DO;                                    0532
*                                                                  0532
*                             /* IF YES, CLEAR THE REDO FIELDS       */
*                                                                  0533
*                             FFMREDOF = OFF;                      0533
*                             FFMIDINH = OFF;                      0534
         NI    FFMREDOF,B'01110111'                                0534
*                             FFMREDOS = 0;                        0535
         ST    @15,FFMREDOS                                        0535
*                             FFMRBOFF = 0;                        0536
         STH   @15,FFMRBOFF                                        0536
*                           END;                                   0537
*                         ELSE                                     0538
*                           DO;                                    0538
*                                                                  0538
         B     @RC00531                                            0538
@RF00531 DS    0H                                                  0539
*                             /***************************************/
*                             /*                                     */
*                             /* IF NOT, RESTORE TO START OF STRUCT  */
*                             /* STEP THE INPUT OFFSET AND DO AGAIN  */
*                             /*                                     */
*                             /***************************************/
*                                                                  0539
*                             FFMREDOC = REDOCSAV;                 0539
         LH    @04,REDOCSAV                                        0539
         STH   @04,FFMREDOC                                        0539
*                             FSADDR = FFMREDOS;                   0540
         L     FSADDR,FFMREDOS                                     0540
*                             STRSTP = 0;                          0541
         SLR   @04,@04                                             0541
         STH   @04,STRSTP                                          0541
*                             FFMRBOFF = FFMRBOFF + FFMREDOO;      0542
         LH    @04,FFMRBOFF                                        0542
         AH    @04,FFMREDOO                                        0542
         STH   @04,FFMRBOFF                                        0542
*                             FFMIDINH = ON;                       0543
         OI    FFMIDINH,B'00001000'                                0543
*                           END;                                   0544
*                     END;                                         0545
@RC00531 DS    0H                                                  0546
*               END;                                               0546
@RF00517 DS    0H                                                  0547
*             FFMPASS = OFF;                                       0547
@RF00514 DS    0H                                                  0548
*             FFMDATA = OFF;                                       0548
*                                                                  0548
         NI    FFMPASS,B'11101101'                                 0548
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR END OF THE SUB-STRUCTURE LIST AND SET END     */
*         /* FLAG IF IT IS FINISHED.                                 */
*         /* TO BE AT THE END OF THE STRUCTURE, REDO FLAG MUST BE    */
*         /* OFF                                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0549
*           IF FMTEOLF = ON & FFMREDOF = OFF                       0549
*             THEN                                                 0549
         TM    FMTEOLF(FSADDR),B'10000000'                         0549
         BNO   @RF00549                                            0549
         TM    FFMREDOF,B'10000000'                                0549
         BNZ   @RF00549                                            0549
*               FFMEOS = ON;                                       0550
*                                                                  0550
         OI    FFMEOS,B'01000000'                                  0550
*         /***********************************************************/
*         /*                                                         */
*         /* STEP TO THE NEXT SUB-STRUCTURE.                         */
*         /* STRSTP CONTAINS THE INCREMENT TO STEP THE STRUCTURE     */
*         /* BASE ADDRESS FOR ADDRESSING THE NEXT SUB-STRUCTURE.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0551
*           FSADDR = FSADDR + STRSTP;                              0551
@RF00549 AH    FSADDR,STRSTP                                       0551
*           FFMVS = OFF;                                           0552
*           FFMPINH = OFF;                                         0553
*                                                                  0553
         NI    FFMVS,B'00111111'                                   0553
*         /***********************************************************/
*         /*                                                         */
*         /* THE SUB-STRUCTURE HANDLING LOOP ENDS HERE.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0554
*         END STRLOOP;                                             0554
@DE00388 TM    FFMEOS,B'01000000'                                  0554
         BZ    @DL00388                                            0554
*         /***********************************************************/
*         /*                                                         */
*         /* THE SUB-STRUCTURE LOOP IS COMPLETED.  CLEAN UP          */
*         /* AND RETURN TO THE CALLER.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0555
*         IF FFMFMTF = ON                                          0555
*           THEN                                                   0555
         TM    FFMFMTF,B'00000001'                                 0555
         BNO   @RF00555                                            0555
*             DO;                                                  0556
*                                                                  0556
*               CALL LINEPRT;                                      0557
*                                                                  0557
         BAL   @14,LINEPRT                                         0557
*               RESPECIFY RTNREG RSTD;                             0558
*               TESTRC = RTNREG;                                   0559
         STH   RTNREG,TESTRC                                       0559
*               RESPECIFY RTNREG UNRSTD;                           0560
*               SAVERC = TESTRC;                                   0561
         LH    @03,TESTRC                                          0561
         STH   @03,SAVERC                                          0561
*             END;                                                 0562
*         IF GDTDBG = NULLPTR                                      0563
*           THEN;                                                  0563
@RF00555 L     @03,GDTDBG(,GDTPR)                                  0563
         LTR   @03,@03                                             0563
         BZ    @RT00563                                            0563
*           ELSE                                                   0565
*             CALL ICKDB010 (GDTTBL,'TP1N');                       0565
*                                                                  0565
         ST    GDTPR,@AL00001                                      0565
         LA    @03,@CC00800                                        0565
         ST    @03,@AL00001+4                                      0565
         MVI   @AL00001+4,X'80'                                    0565
         L     @15,GDTDBG(,GDTPR)                                  0565
         LA    @01,@AL00001                                        0565
         BALR  @14,@15                                             0565
*         CALL ICKSAEP0(GDTTBL,MODID,SAVERC);                      0566
@RT00563 ST    GDTPR,@AL00001                                      0566
         LA    @03,MODID                                           0566
         ST    @03,@AL00001+4                                      0566
         LA    @03,SAVERC                                          0566
         ST    @03,@AL00001+8                                      0566
         MVI   @AL00001+8,X'80'                                    0566
         L     @15,GDTEPL(,GDTPR)                                  0566
         LA    @01,@AL00001                                        0566
         BALR  @14,@15                                             0566
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCEDURE NAME - SPACE CONTROL PROCEDURE.              */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE SETS UP SPACING DICTATED BY   */
*         /* SPACE SUB-STRUCTURE IN THE FORMAT LIST.  IN ADDITION,   */
*         /* IT CAUSES THE PRINTING OF A LINE EACH TIME THIS ITEM    */
*         /* IS ENCOUNTERED AFTER ANY DATA IS FORMATTED.             */
*         /*                                                         */
*         /* INPUT - INPUT IS THE SPACING SUB-STRUCTURE AS DEFINED   */
*         /* BY THE FORMAT STRUCTURED ARGUMENT LIST IN THE GLOBAL    */
*         /* INCLUDE.                                                */
*         /*                                                         */
*         /* OUTPUT - THE SPACING SET UP IN THE PRINT ARGUMENT LIST  */
*         /* PASSED TO THE LINE PRINT PROCEDURE.(LINEPRT)            */
*         /* SEE CVPSTRU IN THIS LISTING.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0567
*SPACE:   PROC;                                                    0567
*                                                                  0567
*                                                                  0567
         B     @PB00002                                            0567
SPACE    STM   @14,@06,@SA00002                                    0567
         STM   @08,@12,@SA00002+36                                 0567
*         /***********************************************************/
*         /*                                                         */
*         /* IF THIS IS NOT THE FIRST PASS, PRINT THE LINE.          */
*         /* FFMPASS IS TURNED ON BY THE FIRST ENTRY TO THE          */
*         /* CONVERSION ROUTINE.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0568
*         IF FFMPASS = OFF                                         0568
*           THEN                                                   0568
         TM    FFMPASS,B'00010000'                                 0568
         BNZ   @RF00568                                            0568
*             DO;                                                  0569
*               IF FFMFMTF = ON                                    0570
*                 THEN                                             0570
         TM    FFMFMTF,B'00000001'                                 0570
         BNO   @RF00570                                            0570
*                   DO;                                            0571
*                                                                  0571
*                     CALL LINEPRT;                                0572
*                                                                  0572
         BAL   @14,LINEPRT                                         0572
*                     RESPECIFY RTNREG RSTD;                       0573
*                     TESTRC = RTNREG;                             0574
         STH   RTNREG,TESTRC                                       0574
*                     RESPECIFY RTNREG UNRSTD;                     0575
*                     IF TESTRC > 0                                0576
*                       THEN                                       0576
         LH    @06,TESTRC                                          0576
         LTR   @06,@06                                             0576
         BNP   @RF00576                                            0576
*                         RETURN CODE (RCQUIT);                    0577
         LH    @15,RCQUIT                                          0577
         L     @14,@SA00002                                        0577
         LM    @00,@06,@SA00002+8                                  0577
         LM    @08,@12,@SA00002+36                                 0577
         BR    @14                                                 0577
*                   END;                                           0578
@RF00576 DS    0H                                                  0579
*             END;                                                 0579
*                                                                  0579
@RF00570 DS    0H                                                  0580
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE SPACING ARGUMENTS FOR THIS SUB-STRUCTURE.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0580
*         PRTSPF = FMTSPF;              /* SET SPACING FACTOR.       */
@RF00568 LH    @06,FMTSPF(,FSADDR)                                 0580
         STH   @06,PRTSPF                                          0580
*         PRTSPT = FMTSPT;              /* SET SPACING TYPE.         */
         MVC   PRTSPT(1),FMTSPT(FSADDR)                            0581
*         STRSTP = 6;                   /* SET FORMAT LIST STEPPING  */
         MVC   STRSTP(2),@CH00114                                  0582
*         FFMPASS = OFF;                /* ASSURE 1ST PASS SWITCH OFF*/
*                                                                  0583
         NI    FFMPASS,B'11101111'                                 0583
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE SPACE PROCEDURE.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0584
*         RETURN CODE (0);                                         0584
         SLR   @15,@15                                             0584
         L     @14,@SA00002                                        0584
         LM    @00,@06,@SA00002+8                                  0584
         LM    @08,@12,@SA00002+36                                 0584
         BR    @14                                                 0584
*         END SPACE;                                               0585
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - REPLICATION INITIALIZATION             */
*         /*                                                         */
*         /* FUNCTION - INITIALIZES PARAMETERS TO CONTROL THE REDO   */
*         /* OPERATION.                                              */
*         /*                                                         */
*         /* INPUT - THE REDO SUB-STRUCTURE OF THE FORMAT ARGUMENT   */
*         /* AS DESCRIBED IN THE GLOBAL INCLUDE.  (FMTLIST)          */
*         /*                                                         */
*         /* OUTPUT - THE PARAMETERS CONTROLLING THE REPLICATION AS  */
*         /* FOLLOWS.                                                */
*         /*                                                         */
*         /* FFMREDOF - A FLAG INDICATING REDO IS IN PROCESS.        */
*         /* FFMREDOC - THE COUNT OF THE NUMBER OF SUB-STRUCTURES    */
*         /*            REDO IS TO SPAN.                             */
*         /* REDOCSAV - A SAVE AREA FOR THE COUNT.                   */
*         /* FFMREDOL - THE COUNT OF THE NUMBER OF TIMES TO REDO.    */
*         /* FFMREDOO - THE INPUT DATA BLOCK OFFSET FOR EACH REDO.   */
*         /* FFMREDOS - THE ADDRESS OF THE FIRST SUB-STRUCTURE OF    */
*         /*            THE SET.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0586
*REDO:    PROC;                                                    0586
*                                                                  0586
REDO     STM   @14,@06,@SA00003                                    0586
         STM   @08,@12,@SA00003+36                                 0586
*         /***********************************************************/
*         /*                                                         */
*         /* ASSURE THAT THIS IS NOT A NESTED REDO SUB-STRUCTURE.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0587
*         IF FFMREDOF = ON                                         0587
*           THEN                                                   0587
         TM    FFMREDOF,B'10000000'                                0587
         BNO   @RF00587                                            0587
*             DO;                                                  0588
*                                                                  0588
*               CALL ERROR (4);                                    0589
*                                                                  0589
         LA    @01,@AL00589                                        0589
         BAL   @14,ERROR                                           0589
*               FFMREDOC = 0;             /* ZERO CURR STRU COUNT.   */
         SLR   @15,@15                                             0590
         STH   @15,FFMREDOC                                        0590
*               FFMREDOL = 0;             /* ZERO CURRENT LOOP COUNT */
         STH   @15,FFMREDOL                                        0591
*               STRSTP = 8;               /* SET FMT LIST STEP COUNT */
         MVC   STRSTP(2),@CH00156                                  0592
*               RETURN ;                                           0593
@EL00003 DS    0H                                                  0593
@EF00003 DS    0H                                                  0593
@ER00003 LM    @14,@06,@SA00003                                    0593
         LM    @08,@12,@SA00003+36                                 0593
         BR    @14                                                 0593
*             END;                                                 0594
*                                                                  0594
*         /***********************************************************/
*         /*                                                         */
*         /* LOCATE THE DYNAMIC DATA ARGUMENT LIST TO OBTAIN THE     */
*         /* DYNAMIC DATA FOR THE REDO.  THIS INCLUDES THE NUMBER    */
*         /* OF TIMES TO LOOP THROUGH THE STRUCTURES                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0595
*           DO DSINDX = 1 TO DARGCNT BY 1 WHILE DARGREP(DSINDX) ^= 0595
*               FMTRFNO;                                           0595
@RF00587 LA    @15,1                                               0595
         ST    @15,DSINDX                                          0595
         B     @DE00595                                            0595
@DL00595 LR    @14,@15                                             0595
         SLA   @14,3                                               0595
         LH    @14,DARGREP-8(@14,DDSTRU)                           0595
         CH    @14,FMTRFNO(,FSADDR)                                0595
         BE    @DC00595                                            0595
*           END;                                                   0596
*                                                                  0596
         AL    @15,@CF00160                                        0596
         ST    @15,DSINDX                                          0596
@DE00595 CH    @15,DARGCNT(,DDSTRU)                                0596
         BNH   @DL00595                                            0596
@DC00595 DS    0H                                                  0597
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE REDO PARAMETERS IF DYNAMIC ARGUMENT FOUND.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0597
*         IF DSINDX <= DARGCNT                                     0597
*           THEN                                                   0597
         L     @15,DSINDX                                          0597
         CH    @15,DARGCNT(,DDSTRU)                                0597
         BH    @RF00597                                            0597
*             DO;                                                  0598
*               FFMREDOL = DARGPCT(DSINDX);                        0599
         SLA   @15,3                                               0599
         LH    @15,DARGPCT-8(@15,DDSTRU)                           0599
         STH   @15,FFMREDOL                                        0599
*               FFMREDOF = ON;          /* TURN REDO FLAG ON.        */
         OI    FFMREDOF,B'10000000'                                0600
*               FFMREDOS = FSADDR + 8;  /* REDO START SUB-STRU       */
         LA    @15,8                                               0601
         ALR   @15,FSADDR                                          0601
         ST    @15,FFMREDOS                                        0601
*               FFMREDOC = FMTTRBC;     /* REDO SUB-STRUC COUNT.     */
         LH    @15,FMTTRBC(,FSADDR)                                0602
         STH   @15,FFMREDOC                                        0602
*               REDOCSAV = FFMREDOC;    /* SAVE IT.                  */
         STH   @15,REDOCSAV                                        0603
*               FFMREDOO = FMTRIO;      /* REDO INPUT OFFSET.        */
         LH    @15,FMTRIO(,FSADDR)                                 0604
         STH   @15,FFMREDOO                                        0604
*             END;                                                 0605
*         STRSTP = 8;                   /* STRUCTURE STEP = 8.       */
*                                                                  0606
@RF00597 MVC   STRSTP(2),@CH00156                                  0606
*         /***********************************************************/
*         /*                                                         */
*         /* IF DYNAMIC ARGUMENT SUB-STRUCTURE NOT FOUND IGNORE THE  */
*         /* REPLICATION BLOCK AND CONTINUE ON.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0607
*         RETURN;                                                  0607
         B     @EL00003                                            0607
*         END REDO;                                                0608
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - STATIC TEXT SET UP.                    */
*         /*                                                         */
*         /* FUNCTION - SETS UP THE CONVERSION ARGUMENT LIST FOR A   */
*         /* STATIC TEXT SUB-STRUCTURE.                              */
*         /*                                                         */
*         /* INPUT - THE STATIC TEXT SUB-STRUCTURE OF THE FORMAT     */
*         /*         LIST.  (FMTLIST)                                */
*         /*                                                         */
*         /* OUTPUT - ARGUMENTS IN THE CONVERSION CALL. (CVPSTRU)    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0609
*STATIC:  PROC;                                                    0609
*                                                                  0609
STATIC   STM   @14,@12,12(@13)                                     0609
*         CVPIADD = FFMSTRS + FMTSTO;   /* INPUT DATA ADDRESS.       */
         LH    @15,FMTSTO(,FSADDR)                                 0610
         AL    @15,FFMSTRS                                         0610
         ST    @15,CVPIADD                                         0610
*         CVPIL = FMTSTL;               /* INPUT DATA LENGTH.        */
         LH    @15,FMTSTL(,FSADDR)                                 0611
         ST    @15,CVPIL                                           0611
*         STRSTP = 12;                  /* FMT STRUCTURE STEP COUNT  */
         MVC   STRSTP(2),@CH00034                                  0612
*         RETURN;                                                  0613
*                                                                  0613
@EL00004 DS    0H                                                  0613
@EF00004 DS    0H                                                  0613
@ER00004 LM    @14,@12,12(@13)                                     0613
         BR    @14                                                 0613
*         END STATIC;                                              0614
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - BLOCK DATA SET UP.                     */
*         /*                                                         */
*         /* FUNCTION - SET UP CONVERSION ARGUMENTS FOR BLOCK DATA.  */
*         /*                                                         */
*         /* INPUT - THE BLOCK DATA SUB-STRUCTURE OF THE FORMAT      */
*         /*         LIST.  (FMTLIST)                                */
*         /*                                                         */
*         /* OUTPUT - ARGUMENTS IN THE CONVERSION CALL.  (CVPSTRU)   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0615
*BLOCK:   PROC;                                                    0615
*                                                                  0615
BLOCK    STM   @14,@12,12(@13)                                     0615
*          IF DARGFULL = ON                                        0616
*            THEN                                                  0616
         CLC   DARGFULL(4),@CF00463                                0616
         BNE   @RF00616                                            0616
*              DARGILP1 = DARGRETP;                                0617
         L     @07,DARGRETP(,DDSTRU)                               0617
         ST    @07,DARGILP1                                        0617
*            ELSE                                                  0618
*              DARGILP2 = DARGILP;                                 0618
*                                                                  0618
         B     @RC00616                                            0618
@RF00616 LH    @07,DARGILP(,DDSTRU)                                0618
         STH   @07,DARGILP2                                        0618
*         CVPIADD = FFMBDP + FFMRBOFF + FMTIOFF;                   0619
*                                                                  0619
@RC00616 LH    @07,FFMRBOFF                                        0619
         AL    @07,FFMBDP                                          0619
         LH    @15,FMTIOFF(,FSADDR)                                0619
         ALR   @07,@15                                             0619
         ST    @07,CVPIADD                                         0619
*         IF FMTILEN > (DARGILP1-FMTIOFF)  FMTILEN = 0            0620
*           THEN                                                   0620
         LH    @07,FMTILEN(,FSADDR)                                0620
         LCR   @15,@15                                             0620
         AL    @15,DARGILP1                                        0620
         CR    @07,@15                                             0620
         BH    @RT00620                                            0620
         LTR   @07,@07                                             0620
         BNZ   @RF00620                                            0620
@RT00620 DS    0H                                                  0621
*             CVPIL = (DARGILP1-FMTIOFF);                          0621
         L     @07,DARGILP1                                        0621
         SH    @07,FMTIOFF(,FSADDR)                                0621
         ST    @07,CVPIL                                           0621
*           ELSE                                                   0622
*             CVPIL = FMTILEN;                                     0622
         B     @RC00620                                            0622
@RF00620 LH    @07,FMTILEN(,FSADDR)                                0622
         ST    @07,CVPIL                                           0622
*         STRSTP = 12;                                             0623
*                                                                  0623
@RC00620 MVC   STRSTP(2),@CH00034                                  0623
*         RETURN;                                                  0624
*                                                                  0624
@EL00005 DS    0H                                                  0624
@EF00005 DS    0H                                                  0624
@ER00005 LM    @14,@12,12(@13)                                     0624
         BR    @14                                                 0624
*         END BLOCK;                                               0625
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - INSERT DATA HANDLER.                   */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE SETS UP THE CONVERSION        */
*         /* ARGUMENT LISTS FOR INSERT DATA FORMAT SUB-STRUCTURES.   */
*         /* (SEE FMTLIST). IT SEARCHES THE DYNAMIC DATA STRUCTURE   */
*         /* FOR THE GIVEN REFERENCE NUMBER AND IF FOUND, SETS UP    */
*         /* THE DATA ARGUMENTS FROM IT.  IF NO FIND IS MADE, IT WILL*/
*         /* EXAMINE THE NEXT SUB-STRUCTURE IN THE LIST TO SEE IF IT */
*         /* IS A DEFAULT DATA SUB-STRUCTURE.  IF IT IS, IT WILL SET */
*         /* UP THE STATIC TEXT ASSOCIATED WITH IT.  IF IT IS NOT,   */
*         /* THIS STRUCTURE WILL BE IGNORED BY TURNING ON THE PRINT  */
*         /* INHIBIT FLAG. (FFMPINH)                                 */
*         /*                                                         */
*         /* INPUT - THE INSERT DATA SUB-STRUCTURE AND DYNAMIC DATA  */
*         /* SUB-STRUCTURE AS DEFINED IN FMTLIST AND DARGLIST        */
*         /*                                                         */
*         /* OUTPUT - THE DATA ARGUMENTS IN THE PRINT ARGUMENT LIST. */
*         /* (CVPSTRU)                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0626
*INSERT:  PROC;                                                    0626
*                                                                  0626
INSERT   STM   @14,@02,12(@13)                                     0626
         STM   @04,@12,36(@13)                                     0626
*         IF FFMIDINH = OFF             /* INSERT INHIBITED IN REDO  */
*           THEN                                                   0627
         TM    FFMIDINH,B'00001000'                                0627
         BNZ   @RF00627                                            0627
*             DO;                                                  0628
*                                                                  0628
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH THE DYNAMIC LIST (DARGLIST) FOR THE          */
*             /* REFERENCE NUMBER GIVEN.                             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0629
*               DO DSINDX = 1 TO DARGCNT BY 1 WHILE DARGINS(DSINDX) ^=
*                   FMTRFNO;                                       0629
         LA    @07,1                                               0629
         ST    @07,DSINDX                                          0629
         B     @DE00629                                            0629
@DL00629 LR    @15,@07                                             0629
         SLA   @15,3                                               0629
         LH    @15,DARGINS-8(@15,DDSTRU)                           0629
         CH    @15,FMTRFNO(,FSADDR)                                0629
         BE    @DC00629                                            0629
*               END;                                               0630
         AL    @07,@CF00160                                        0630
         ST    @07,DSINDX                                          0630
@DE00629 CH    @07,DARGCNT(,DDSTRU)                                0630
         BNH   @DL00629                                            0630
@DC00629 DS    0H                                                  0631
*               IF DSINDX <= DARGCNT                               0631
*                 THEN                                             0631
         L     @07,DSINDX                                          0631
         CH    @07,DARGCNT(,DDSTRU)                                0631
         BH    @RF00631                                            0631
*                   DO;                                            0632
*                                                                  0632
*                   /*************************************************/
*                   /*                                               */
*                   /* THE REFERENCE NUMBER IS FOUND.  SET UP THE    */
*                   /* ARGUMENTS FROM THE FOUND LIST.                */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0633
*                     CVPIADD = DARGDTM(DSINDX);                   0633
         SLA   @07,3                                               0633
         L     @15,DARGDTM-8(@07,DDSTRU)                           0633
         ST    @15,CVPIADD                                         0633
*                     CVPIL = DARGINL(DSINDX);                     0634
         LH    @07,DARGINL-8(@07,DDSTRU)                           0634
         ST    @07,CVPIL                                           0634
*                   END;                                           0635
*                 ELSE                                             0636
*                   DO;                                            0636
*                                                                  0636
         B     @RC00631                                            0636
@RF00631 DS    0H                                                  0637
*                 /***************************************************/
*                 /*                                                 */
*                 /* STEP FORMAT STRUCTURE ADDRESS TO CHECK FOR A    */
*                 /* POSSIBLE DEFAULT DATA STRUCTURE AS THE INSERT   */
*                 /* ITEM WAS NOT FOUND IN THE DYNAMIC STRUCTURE.    */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0637
*                     IF FMTEOLF = OFF                             0637
*                       THEN                                       0637
         TM    FMTEOLF(FSADDR),B'10000000'                         0637
         BNZ   @RF00637                                            0637
*                         DO;                                      0638
*                         FSADDR = FSADDR +12;                     0639
         AL    FSADDR,@CF00034                                     0639
*                         IF FMTDFF = ON                           0640
*                           THEN                                   0640
         TM    FMTDFF(FSADDR),B'00000010'                          0640
         BNO   @RF00640                                            0640
*                             DO;                                  0641
*                                                                  0641
*                         /*******************************************/
*                         /*                                         */
*                         /* A DEFAULT DATA SUB-STRUCTURE IS FOUND.  */
*                         /* SET UP THE ARGUMENTS FROM IT.           */
*                         /*                                         */
*                         /*******************************************/
*                                                                  0642
*                               CVPIADD = FFMSTRS + FMTSTO;        0642
         LH    @07,FMTSTO(,FSADDR)                                 0642
         AL    @07,FFMSTRS                                         0642
         ST    @07,CVPIADD                                         0642
*                               CVPIL = FMTSTL;                    0643
         LH    @07,FMTSTL(,FSADDR)                                 0643
         ST    @07,CVPIL                                           0643
*                             END;                                 0644
*                           ELSE                                   0645
*                             DO;                                  0645
*                                                                  0645
         B     @RC00640                                            0645
@RF00640 DS    0H                                                  0646
*                 /***************************************************/
*                 /*                                                 */
*                 /* NO DEFAULT DATA STRUCTURE WAS FOUND SO RESTORE  */
*                 /* THE FORMAT STRUCTURE ADDRESS TO ITS ORIGINAL    */
*                 /* SETTING AND SUPPRESS CONVERSION AND PRINTING    */
*                 /* FOR THIS SUB-STRUCTURE.                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0646
*                               FFMPINH = ON;                      0646
         OI    FFMPINH,B'10000000'                                 0646
*                               FSADDR = FSADDR - 12;              0647
         SL    FSADDR,@CF00034                                     0647
*                             END;                                 0648
*                         END;                                     0649
*                       ELSE                                       0650
*                         FFMPINH = ON;                            0650
         B     @RC00637                                            0650
@RF00637 OI    FFMPINH,B'10000000'                                 0650
*                   END;                                           0651
*             END;                                                 0652
*           ELSE                                                   0653
*             FFMPINH = ON;             /* INHIBIT INSERT ON A REDO. */
         B     @RC00627                                            0653
@RF00627 OI    FFMPINH,B'10000000'                                 0653
*           STRSTP = 12;                                           0654
@RC00627 MVC   STRSTP(2),@CH00034                                  0654
*         END INSERT;                                              0655
@EL00006 DS    0H                                                  0655
@EF00006 DS    0H                                                  0655
@ER00006 LM    @14,@02,12(@13)                                     0655
         LM    @04,@12,36(@13)                                     0655
         BR    @14                                                 0655
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - DATA CONVERSION PROCEDURE.                      */
*/*                                                                  */
*/* FUNCTION - CONVERTS DATA TO A PRINTABLE FORM.  CONVERSIONS       */
*/*      PROVIDED ARE:                                               */
*/*        EBCDIC TO CHARACTER.                                      */
*/*        BINARY TO HEXIDECIMAL.                                    */
*/*        BINARY TO HEXIDECIMAL ENCLOSED AS X'NNNN'                 */
*/*        BINARY TO HEXIDECIMAL DUMP FORMAT.                        */
*/*        PACKED DECIMAL TO UNPACKED DECIMAL.                       */
*/*        BINARY TO UNPACKED DECIMAL.                               */
*/*                                                                  */
*/* INPUT - THE CONVERSION ARGUMENT LIST CVPSTRU.                    */
*/*                                                                  */
*/* OUTPUT - THE CONVERTED DATA IN THE PRINT BUFFER (PRTBUFF)        */
*/*      OR MORE THAN ONE PRINTED LINE IF PRINT LINE OVERFLOW        */
*/*      OCCURS AS A RESULT OF THE DATA BEING MORE THAN THE LENGTH   */
*/*      OF THE PRINT BUFFER.                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0656
*CONVERT: PROCEDURE;                                               0656
*                                                                  0656
CONVERT  STM   @14,@06,@SA00007                                    0656
         STM   @08,@12,@SA00007+36                                 0656
*         OLDERID2 = NEWERID2;                                     0657
         L     @06,GDTTR2(,GDTPR)                                  0657
         MVC   @TS00001(95),NEWERID2(@06)                          0657
         MVC   OLDERID2(95,@06),@TS00001                           0657
*         NEWID2 = 'TP2I';                                         0658
*                                                                  0658
         MVC   NEWID2(4,@06),@CC00819                              0658
*         CVFLAG = '0000'X;             /* CLEAR THE FLAG BYTES.     */
*                                                                  0659
         MVC   CVFLAG(2),@CB00820                                  0659
*         IF GDTDBG = NULLPTR                                      0660
*           THEN;                                                  0660
         L     @06,GDTDBG(,GDTPR)                                  0660
         LTR   @06,@06                                             0660
         BZ    @RT00660                                            0660
*           ELSE                                                   0662
*             CALL ICKDB010 (GDTTBL,'TP2I');                       0662
*                                                                  0662
         ST    GDTPR,@AL00001                                      0662
         LA    @06,@CC00819                                        0662
         ST    @06,@AL00001+4                                      0662
         MVI   @AL00001+4,X'80'                                    0662
         L     @15,GDTDBG(,GDTPR)                                  0662
         LA    @01,@AL00001                                        0662
         BALR  @14,@15                                             0662
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR POSSIBLE PRINT LINE OVERFLOW AND SET UP TO    */
*         /* HANDLE IT.                                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0663
*         IF (CVPPADD - ADDR(PRTBUFF) + CVPOL) > PCTPLW            0663
*           THEN                                                   0663
@RT00660 LA    @06,PRTBUFF                                         0663
         LCR   @06,@06                                             0663
         AL    @06,CVPPADD                                         0663
         AL    @06,CVPOL                                           0663
         C     @06,PCTPLW(,PCTPTR)                                 0663
         BNH   @RF00663                                            0663
*             DO;                                                  0664
*               PLOVF = ON;                                        0665
         OI    PLOVF,B'10000000'                                   0665
*             END;                                                 0666
*                                                                  0666
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP REMAINING PARAMETERS FOR THE INITIAL SEGMENT.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0667
*         CVSL = CVPOL;                 /* SET COMPLET OUTPUT LENGTH */
@RF00663 L     CVSL,CVPOL                                          0667
*         CVSTA = CVPPADD;              /* SET PRINT START.          */
         L     CVSTA,CVPPADD                                       0668
*         FMRIL = CVPIL;                /* SET REMAINING INPUT LEN.  */
         L     @04,CVPIL                                           0669
         ST    @04,FMRIL                                           0669
*         FMRIP = CVPIADD;              /* SET REMAINING INPUT LOC.  */
         L     @04,CVPIADD                                         0670
         ST    @04,FMRIP                                           0670
*         /***********************************************************/
*         /*                                                         */
*         /* TEST FOR EITHER BYTE TO HEXIDECIMAL OR HEXIDECIMAL      */
*         /* APOSTROPHE CONVERSION AND CALL BHCONV PROCEDURE IF ON.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0671
*         IF CVPBH = ON  CVPBHA = ON                              0671
*           THEN                                                   0671
*                                                                  0671
         TM    CVPBH,B'11000000'                                   0671
         BZ    @RF00671                                            0671
*             CALL BHCONV;                                         0672
*                                                                  0672
         BAL   @14,BHCONV                                          0672
*         /***********************************************************/
*         /*                                                         */
*         /* IF BYTE TO HEXIDECIMAL DUMP CONVERSION IS ON            */
*         /* THEN CALL BHDCONV PROCEDURE.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0673
*         IF CVPBHD = ON                                           0673
*           THEN                                                   0673
*                                                                  0673
@RF00671 TM    CVPBHD,B'00100000'                                  0673
         BNO   @RF00673                                            0673
*             CALL BHDCONV;                                        0674
*                                                                  0674
         BAL   @14,BHDCONV                                         0674
*         /***********************************************************/
*         /*                                                         */
*         /* IF PACKED TO UNPACKED CONVERSION IS ON THEN CALL        */
*         /* PUPCONV PROCEDURE.                                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0675
*         IF CVPPU = ON                                            0675
*           THEN                                                   0675
@RF00673 TM    CVPPU,B'00001000'                                   0675
         BNO   @RF00675                                            0675
*             DO;                                                  0676
*                                                                  0676
*               CALL PUPCONV;                                      0677
*                                                                  0677
         BAL   @14,PUPCONV                                         0677
*               RESPECIFY RTNREG RSTD;                             0678
*               TESTRC = RTNREG;                                   0679
         STH   RTNREG,TESTRC                                       0679
*               RESPECIFY RTNREG UNRSTD;                           0680
*               IF TESTRC > 0                                      0681
*                 THEN                                             0681
         LH    @04,TESTRC                                          0681
         LTR   @04,@04                                             0681
         BNP   @RF00681                                            0681
*                   RETURN CODE(TESTRC);                           0682
         LR    @15,@04                                             0682
         L     @14,@SA00007                                        0682
         LM    @00,@06,@SA00007+8                                  0682
         LM    @08,@12,@SA00007+36                                 0682
         BR    @14                                                 0682
*             END;                                                 0683
*                                                                  0683
@RF00681 DS    0H                                                  0684
*         /***********************************************************/
*         /*                                                         */
*         /* IF BINARY TO DECIMAL CONVERSION FLAG IS ON CALL BDCONV  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0684
*         IF CVPBD = ON                                            0684
*           THEN                                                   0684
@RF00675 TM    CVPBD,B'00010000'                                   0684
         BNO   @RF00684                                            0684
*             DO;                                                  0685
*                                                                  0685
*               CALL BDCONV;                                       0686
*                                                                  0686
         BAL   @14,BDCONV                                          0686
*               RESPECIFY RTNREG RSTD;                             0687
*               TESTRC = RTNREG;                                   0688
         STH   RTNREG,TESTRC                                       0688
*               RESPECIFY RTNREG UNRSTD;                           0689
*               IF TESTRC > 0                                      0690
*                 THEN                                             0690
*                                                                  0690
         LH    @04,TESTRC                                          0690
         LTR   @04,@04                                             0690
         BNP   @RF00690                                            0690
*                   RETURN CODE(TESTRC);                           0691
*                                                                  0691
         LR    @15,@04                                             0691
         L     @14,@SA00007                                        0691
         LM    @00,@06,@SA00007+8                                  0691
         LM    @08,@12,@SA00007+36                                 0691
         BR    @14                                                 0691
*             END;                                                 0692
*                                                                  0692
@RF00690 DS    0H                                                  0693
*         /***********************************************************/
*         /*                                                         */
*         /* IF ALL CONVERSION FLAGS ARE OFF, THEN CONVERT THE LINE  */
*         /* AS AN EBCDIC LINE BY CALLING EBCDIC.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0693
*         IF CVPBH = OFF &                                         0693
*           CVPBHA = OFF &                                         0693
*           CVPBHD = OFF &                                         0693
*           CVPBD = OFF &                                          0693
*           CVPPU = OFF                                            0693
*           THEN                                                   0693
@RF00684 TM    CVPBH,B'11111000'                                   0693
         BNZ   @RF00693                                            0693
*             DO;                                                  0694
*                                                                  0694
*               CALL EBCDIC;                                       0695
*                                                                  0695
         BAL   @14,EBCDIC                                          0695
*               RESPECIFY RTNREG RSTD;                             0696
*               TESTRC = RTNREG;                                   0697
         STH   RTNREG,TESTRC                                       0697
*               RESPECIFY RTNREG UNRSTD;                           0698
*               IF TESTRC > 0                                      0699
*                 THEN                                             0699
         LH    @06,TESTRC                                          0699
         LTR   @06,@06                                             0699
         BNP   @RF00699                                            0699
*                   RETURN CODE(RCQUIT);                           0700
         LH    @15,RCQUIT                                          0700
         L     @14,@SA00007                                        0700
         LM    @00,@06,@SA00007+8                                  0700
         LM    @08,@12,@SA00007+36                                 0700
         BR    @14                                                 0700
*             END;                                                 0701
@RF00699 DS    0H                                                  0702
*         OLDERID2 = NEWERID2;                                     0702
@RF00693 L     @06,GDTTR2(,GDTPR)                                  0702
         MVC   @TS00001(95),NEWERID2(@06)                          0702
         MVC   OLDERID2(95,@06),@TS00001                           0702
*         NEWID2 = 'TP2N';                                         0703
*                                                                  0703
         MVC   NEWID2(4,@06),@CC00826                              0703
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE RETURN CODE NEEDED AND RETURN TO THE FORMAT     */
*         /* ROUTINE.                                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0704
*         IF PLOVF = ON                                            0704
*           THEN                                                   0704
         TM    PLOVF,B'10000000'                                   0704
         BNO   @RF00704                                            0704
*             SETRC = 4;                /* ADVISE FORMAT OF OVERFLOW */
         LA    SETRC,4                                             0705
*           ELSE                                                   0706
*             SETRC = 0;                                           0706
*                                                                  0706
         B     @RC00704                                            0706
@RF00704 SLR   SETRC,SETRC                                         0706
*         IF GDTDBG = NULLPTR                                      0707
*           THEN;                                                  0707
@RC00704 L     @06,GDTDBG(,GDTPR)                                  0707
         LTR   @06,@06                                             0707
         BZ    @RT00707                                            0707
*           ELSE                                                   0709
*             CALL ICKDB010 (GDTTBL,'TP2N');                       0709
*                                                                  0709
         ST    GDTPR,@AL00001                                      0709
         LA    @06,@CC00826                                        0709
         ST    @06,@AL00001+4                                      0709
         MVI   @AL00001+4,X'80'                                    0709
         L     @15,GDTDBG(,GDTPR)                                  0709
         LA    @01,@AL00001                                        0709
         BALR  @14,@15                                             0709
*         RETURN CODE(SETRC);                                      0710
@RT00707 LR    @15,SETRC                                           0710
         L     @14,@SA00007                                        0710
         LM    @00,@06,@SA00007+8                                  0710
         LM    @08,@12,@SA00007+36                                 0710
         BR    @14                                                 0710
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - BINARY TO HEXADECIMAL CONVERSION.      */
*         /*                                                         */
*         /* FUNCTION - CONVERTS BINARY INPUT TO PRINTABLE           */
*         /* HEXADECIMAL OUTPUT, PUTTING THE CONVERTED BYTES         */
*         /* DIRECTLY INTO THE PRINT LINE.  UP TO 32K BYTES MAY BE   */
*         /* TRANSLATED IN ANY ONE SEGMENT.                          */
*         /*                                                         */
*         /* INPUT - THE DATA INPUT POINTER  AND LENGTH              */
*         /* (CONVL) AND THE POINTER TO THE PRINT LINE               */
*         /* POSITION WHERE THE CONVERTED OUTPUT IS TO BE            */
*         /* PLACED (CVSTA).                                         */
*         /* IF BINARY TO HEXADECIMAL (WITHOUT APOSTROPHES)          */
*         /* IS REQUESTED, AND                                       */
*         /* IF THE INPUT LENGTH IS LARGE ENOUGH TO CAUSE THE PRINT  */
*         /* LINE TO OVERFLOW, THEN THAT LINE WILL BE PRINTED AND    */
*         /* FURTHER LINES WILL BE CONVERTED AND PRINTED UNTIL ALL OF*/
*         /* THE INPUT DATA HAS BEEN CONVERTED.  IF THE PRINT LINE   */
*         /* DOES NOT OVERFLOW, THEN NO PRINTING OCCURS HERE.        */
*         /* CONVERSION FOR ALL LINES WILL BEGIN AT THE SAME POINT   */
*         /* IN THE PRINT LINE AS THE FIRST LINE.                    */
*         /*                                                         */
*         /* OUTPUT - CONVERTED DATA IN THE PRINT LINE.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0711
*BHCONV:  PROC;                                                    0711
*                                                                  0711
BHCONV   STM   @14,@02,@SA00008                                    0711
         STM   @04,@05,@SA00008+20                                 0711
         STM   @08,@12,@SA00008+28                                 0711
*         /***********************************************************/
*         /*                                                         */
*         /* IF THIS IS A BYTE TO HEX APOST, SET THE LEADING X'.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0712
*         FMSIL = CONVL/2;                                         0712
*                                                                  0712
         LA    @04,2                                               0712
         L     @00,CONVL                                           0712
         SRDA  @00,32                                              0712
         DR    @00,@04                                             0712
         STH   @01,FMSIL                                           0712
*         IF CVPBHA = ON                                           0713
*           THEN                                                   0713
         TM    CVPBHA,B'01000000'                                  0713
         BNO   @RF00713                                            0713
*             DO;                                                  0714
*               CVPB(1:2) = 'X''';                                 0715
         MVC   CVPB(2,CVSTA),@CC00830                              0715
*               CVSTA = CVSTA + 2;                                 0716
*                                                                  0716
         ALR   CVSTA,@04                                           0716
*               /*****************************************************/
*               /*                                                   */
*               /* TRUNCATE BHA FORMAT AT END OF LINE                */
*               /*                                                   */
*               /*****************************************************/
*               IF PLOVF = ON                                      0717
*                 THEN                                             0717
         TM    PLOVF,B'10000000'                                   0717
         BNO   @RF00717                                            0717
*                  FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF))     0718
*                          - 3) / 2;                               0718
         LA    @06,PRTBUFF                                         0718
         LCR   @06,@06                                             0718
         AL    @06,CVPPADD                                         0718
         LR    @00,@06                                             0718
         LCR   @00,@00                                             0718
         AL    @00,PCTPLW(,PCTPTR)                                 0718
         SL    @00,@CF00131                                        0718
         SRDA  @00,32                                              0718
         DR    @00,@04                                             0718
         STH   @01,FMSIL                                           0718
*               PLOVF = OFF;                                       0719
@RF00717 NI    PLOVF,B'01111111'                                   0719
*               CVSL = FMSIL + FMSIL;                              0720
         LH    @04,FMSIL                                           0720
         LR    CVSL,@04                                            0720
         ALR   CVSL,@04                                            0720
*             END;                                                 0721
*                                                                  0721
*           ELSE                                                   0722
*             IF PLOVF = ON                                        0722
*               THEN                                               0722
         B     @RC00713                                            0722
@RF00713 TM    PLOVF,B'10000000'                                   0722
         BNO   @RF00722                                            0722
*                 FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)))     0723
*                         / 2;                                     0723
*                                                                  0723
         LA    @04,PRTBUFF                                         0723
         LCR   @04,@04                                             0723
         AL    @04,CVPPADD                                         0723
         LR    @00,@04                                             0723
         LCR   @00,@00                                             0723
         AL    @00,PCTPLW(,PCTPTR)                                 0723
         SRDA  @00,32                                              0723
         D     @00,@CF00111                                        0723
         STH   @01,FMSIL                                           0723
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT THE BYTE SEGMENT TO PRINTABLE HEXADECIMAL.      */
*         /* CONVERSION IS DIRECTLY TO THE PRINT BUFFER.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0724
*         DO WHILE CVSL > 0;                                       0724
*                                                                  0724
@RF00722 DS    0H                                                  0724
@RC00713 B     @DE00724                                            0724
@DL00724 DS    0H                                                  0725
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING IS THE ACTUAL CONVERSION DO LOOP.         */
*         /* CVCHR HOLDS THE TRANSLATE TABLE OFFSET FOR THE FIRST    */
*         /* HALF BYTE.                                              */
*         /* TTOFF HOLDS THE TRANSLATE TABLE OFFSET FOR THE SECOND   */
*         /* HALF BYTE.                                              */
*         /* BHTRTB IS THE TRANSLATE TABLE.                          */
*         /* TRBUF HOLDS THE INPUT SOURCE.                           */
*         /* CVPB HOLDS THE OUTPUT TRANSLATED DATA.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0725
*           DO N = 1 TO FMSIL;                                     0725
         LA    N,1                                                 0725
         B     @DE00725                                            0725
@DL00725 DS    0H                                                  0726
*             CVPB(2*N-1) = BHTRTB(TRBUF(N)/16+1);                 0726
         LR    @04,N                                               0726
         ALR   @04,@04                                             0726
         ST    @04,@TF00001                                        0726
         ALR   @04,CVSTA                                           0726
         BCTR  @04,0                                               0726
         BCTR  @04,0                                               0726
         L     @01,FMRIP                                           0726
         BCTR  @01,0                                               0726
         SLR   @15,@15                                             0726
         IC    @15,TRBUF(N,@01)                                    0726
         LR    @14,@15                                             0726
         SRL   @14,4                                               0726
         LA    @01,BHTRTB(@14)                                     0726
         MVC   CVPB(1,@04),0(@01)                                  0726
*             CVPB(2*N) = BHTRTB((TRBUF(N) & '0F'X) + 1);          0727
         LR    @04,CVSTA                                           0727
         AL    @04,@TF00001                                        0727
         BCTR  @04,0                                               0727
         N     @15,@CF00831                                        0727
         LA    @14,BHTRTB(@15)                                     0727
         MVC   CVPB(1,@04),0(@14)                                  0727
*           END;                                                   0728
         AL    N,@CF00160                                          0728
@DE00725 CH    N,FMSIL                                             0728
         BNH   @DL00725                                            0728
*           CVSL = CVSL - FMSIL * 2;                               0729
*                                                                  0729
         LH    @04,FMSIL                                           0729
         ALR   @04,@04                                             0729
         SLR   CVSL,@04                                            0729
*         /***********************************************************/
*         /*                                                         */
*         /* IF NO PRINT LINE OVERFLOW, SET UP THE TRAILING '.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0730
*           IF PLOVF = OFF & CVPBHA = ON                           0730
*             THEN                                                 0730
         TM    PLOVF,B'10000000'                                   0730
         BNZ   @RF00730                                            0730
         TM    CVPBHA,B'01000000'                                  0730
         BNO   @RF00730                                            0730
*               DO;                                                0731
*                 IF CVSTA + 2*N <= ADDR(PRTBUFF) + PCTPLW         0732
*                   THEN                                           0732
         LR    @04,N                                               0732
         ALR   @04,@04                                             0732
         LR    @15,CVSTA                                           0732
         ALR   @15,@04                                             0732
         LA    @14,PRTBUFF                                         0732
         AL    @14,PCTPLW(,PCTPTR)                                 0732
         CR    @15,@14                                             0732
         BH    @RF00732                                            0732
*                     CVPB(2*N-1) = '''';                          0733
         ALR   @04,CVSTA                                           0733
         BCTR  @04,0                                               0733
         BCTR  @04,0                                               0733
         MVI   CVPB(@04),C''''                                     0733
*               END;                                               0734
*                                                                  0734
@RF00732 DS    0H                                                  0735
*           /*********************************************************/
*           /*                                                       */
*           /* SET ACTUAL PRINT COLUMN                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0735
*           PCTAPC = CVSTA + FMSIL + FMSIL - ADDR(PRTBUFF);        0735
*                                                                  0735
@RF00730 LH    @04,FMSIL                                           0735
         LR    @15,CVSTA                                           0735
         ALR   @15,@04                                             0735
         ALR   @15,@04                                             0735
         LA    @04,PRTBUFF                                         0735
         SLR   @15,@04                                             0735
         STH   @15,PCTAPC(,PCTPTR)                                 0735
*           IF CVPBHA = ON                                         0736
*             THEN                                                 0736
         TM    CVPBHA,B'01000000'                                  0736
         BNO   @RF00736                                            0736
*               PCTAPC = PCTAPC + 3;                               0737
*                                                                  0737
         AL    @15,@CF00131                                        0737
         STH   @15,PCTAPC(,PCTPTR)                                 0737
*         /***********************************************************/
*         /*                                                         */
*         /* SINCE A PRINT LINE OVER FLOW HAS OCCURRED, PRINT THE    */
*         /* LINE JUST CONVERTED.                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0738
*           IF PLOVF = ON                                          0738
*             THEN                                                 0738
@RF00736 TM    PLOVF,B'10000000'                                   0738
         BNO   @RF00738                                            0738
*               DO;                                                0739
*                                                                  0739
*                 CALL LINEPRT;                                    0740
*                                                                  0740
         BAL   @14,LINEPRT                                         0740
*                 RESPECIFY RTNREG RSTD;                           0741
*                 TESTRC = RTNREG;                                 0742
         STH   RTNREG,TESTRC                                       0742
*                 RESPECIFY RTNREG UNRSTD;                         0743
*                 IF TESTRC ^= 0                                   0744
*                   THEN                                           0744
         LH    @04,TESTRC                                          0744
         LTR   @04,@04                                             0744
         BZ    @RF00744                                            0744
*                     RETURN CODE(RCQUIT);                         0745
*                                                                  0745
         LH    @15,RCQUIT                                          0745
         L     @14,@SA00008                                        0745
         LM    @00,@02,@SA00008+8                                  0745
         LM    @04,@05,@SA00008+20                                 0745
         LM    @08,@12,@SA00008+28                                 0745
         BR    @14                                                 0745
*                 PRTSPF = 1;                                      0746
*                                                                  0746
@RF00744 MVC   PRTSPF(2),@CH00160                                  0746
*                 /***************************************************/
*                 /*                                                 */
*                 /* UPDATE FOR THE REPETITION IF PRINT LINE         */
*                 /* OVERFLOW.                                       */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0747
*                 FMRIP = FMRIP + FMSIL;                           0747
         LH    @04,FMSIL                                           0747
         AL    @04,FMRIP                                           0747
         ST    @04,FMRIP                                           0747
*                 CVSTA = CVPPADD;                                 0748
         L     @04,CVPPADD                                         0748
         LR    CVSTA,@04                                           0748
*                 IF CVSL > (ADDR(PRTBUFF) + PCTPLW - CVPPADD)     0749
*                   THEN                                           0749
         LA    @15,PRTBUFF                                         0749
         AL    @15,PCTPLW(,PCTPTR)                                 0749
         SLR   @15,@04                                             0749
         CR    CVSL,@15                                            0749
         BNH   @RF00749                                            0749
*                     FMSIL = (ADDR(PRTBUFF) + PCTPLW - CVPPADD)/2;
         LR    @00,@15                                             0750
         SRDA  @00,32                                              0750
         D     @00,@CF00111                                        0750
         STH   @01,FMSIL                                           0750
*                   ELSE                                           0751
*                     FMSIL = CVSL/2;                              0751
         B     @RC00749                                            0751
@RF00749 LR    @00,CVSL                                            0751
         SRDA  @00,32                                              0751
         D     @00,@CF00111                                        0751
         STH   @01,FMSIL                                           0751
*               END;                                               0752
@RC00749 DS    0H                                                  0753
*         END;                                                     0753
*                                                                  0753
@RF00738 DS    0H                                                  0753
@DE00724 SLR   @04,@04                                             0753
         CR    CVSL,@04                                            0753
         BH    @DL00724                                            0753
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAN UP AND RETURN TO THE MAIN PROCEDURE.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0754
*         RETURN CODE (0);                                         0754
         LR    @15,@04                                             0754
         L     @14,@SA00008                                        0754
         LM    @00,@02,@SA00008+8                                  0754
         LM    @04,@05,@SA00008+20                                 0754
         LM    @08,@12,@SA00008+28                                 0754
         BR    @14                                                 0754
*         END BHCONV;                                              0755
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - BINARY TO HEX DUMP CONVERSION.         */
*         /*                                                         */
*         /* FUNCTION - CONVERTS BINARY INPUT TO DUMP FORMATTED      */
*         /* OUTPUT.  CONVERSION ALWAYS BEGINS AT POSITION ONE IN    */
*         /* THE PRINT LINE.                                         */
*         /*                                                         */
*         /* INPUT - THE DATA INPUT POINTER AND LENGTH.              */
*         /*                                                         */
*         /* OUTPUT - DUMP FORMATTED PRINT LINE(S).                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0756
*BHDCONV: PROC;                                                    0756
*                                                                  0756
BHDCONV  STM   @14,@06,@SA00009                                    0756
         STM   @08,@12,@SA00009+36                                 0756
*         /***********************************************************/
*         /*                                                         */
*         /* INITIALIZE THE OUTPUT INDEX COUNT AND SEGMENT LENGTH.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0757
*         OLDERID2 = NEWERID2;                                     0757
         L     @06,GDTTR2(,GDTPR)                                  0757
         MVC   @TS00001(95),NEWERID2(@06)                          0757
         MVC   OLDERID2(95,@06),@TS00001                           0757
*         NEWID2 = 'TP2M';                                         0758
         MVC   NEWID2(4,@06),@CC00836                              0758
*         HDINDEXB = 0;                                            0759
         SLR   @06,@06                                             0759
         STH   @06,HDINDEXB                                        0759
*         SETRC = 0;                                               0760
         SLR   SETRC,SETRC                                         0760
*         IF FMRIL > 32                                            0761
*           THEN                                                   0761
         LA    @06,32                                              0761
         C     @06,FMRIL                                           0761
         BNL   @RF00761                                            0761
*             FMSIL = 32;                                          0762
         STH   @06,FMSIL                                           0762
*           ELSE                                                   0763
*             FMSIL = FMRIL;                                       0763
*                                                                  0763
         B     @RC00761                                            0763
@RF00761 L     @06,FMRIL                                           0763
         STH   @06,FMSIL                                           0763
*         /***********************************************************/
*         /*                                                         */
*         /* THIS CODE BEGINS THE MAJOR CONVERSION LOOP.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0764
*         DO WHILE FMRIL > 0;                                      0764
@RC00761 B     @DE00764                                            0764
@DL00764 DS    0H                                                  0765
*           HDCVB(1:64) = ' ';                                     0765
*                                                                  0765
         MVI   HDCVB+1,C' '                                        0765
         MVC   HDCVB+2(62),HDCVB+1                                 0765
         MVI   HDCVB,C' '                                          0765
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE EBCDIC PORTION OF THE HEX DUMP FORMAT.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0766
*           HDSEG3(1:FMSIL) = TRBUF;                               0766
         L     @04,CVPPADD                                         0766
         LH    @03,FMSIL                                           0766
         BCTR  @03,0                                               0766
         L     @01,FMRIP                                           0766
         EX    @03,@SM00915                                        0766
*           HDST1 = '*';                                           0767
         MVI   HDST1(@04),C'*'                                     0767
*           HDST2 = '*';                                           0768
*                                                                  0768
         MVI   HDST2(@04),C'*'                                     0768
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE INDEX FOR THE FORMAT IN COLS 1 THROUGH 4.       */
*         /* HDINDEXC(B) CONTAINS THE UPDATED INDEX TO BE TRANSLATED */
*         /* HDINDEX IS THE INDEX LOCATION ON THE PRINT LINE.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0769
*           DO N = 1 TO 2 BY 1;                                    0769
         LA    N,1                                                 0769
@DL00769 DS    0H                                                  0770
*             HDINDEX(2*N-1) = BHTRTB(HDINDEXC(N)/16+1);           0770
         L     @06,CVPPADD                                         0770
         LR    @04,N                                               0770
         ALR   @04,@04                                             0770
         ST    @04,@TF00001                                        0770
         ALR   @04,@06                                             0770
         BCTR  @04,0                                               0770
         BCTR  @04,0                                               0770
         SLR   @03,@03                                             0770
         IC    @03,HDINDEXC-1(N)                                   0770
         SRL   @03,4                                               0770
         LA    @01,BHTRTB(@03)                                     0770
         MVC   HDINDEX(1,@04),0(@01)                               0770
*             HDINDEX(2*N) = BHTRTB((HDINDEXC(N) & '0F'X) + 1);    0771
         AL    @06,@TF00001                                        0771
         BCTR  @06,0                                               0771
         LA    @04,15                                              0771
         SLR   @03,@03                                             0771
         IC    @03,HDINDEXC-1(N)                                   0771
         NR    @04,@03                                             0771
         LA    @03,BHTRTB(@04)                                     0771
         MVC   HDINDEX(1,@06),0(@03)                               0771
*           END;                                                   0772
*                                                                  0772
         AL    N,@CF00160                                          0772
         C     N,@CF00111                                          0772
         BNH   @DL00769                                            0772
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT THE DUMP SEGMENTS FROM BYTE TO HEXADECIMAL.     */
*         /* TRBUF  CONTAINS THE INPUT BYTE STRING TO BE TRANSLATED  */
*         /* HDCVB CONTAINS THE TRANSLATED OUTPUT SEGMENTS.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0773
*           DO N = 1 TO FMSIL BY 1;                                0773
         LA    N,1                                                 0773
         B     @DE00773                                            0773
@DL00773 DS    0H                                                  0774
*             HDCVB(2*N-1) = BHTRTB(TRBUF(N)/16+1);                0774
         LR    @06,N                                               0774
         ALR   @06,@06                                             0774
         LA    @04,HDCVB-2(@06)                                    0774
         L     @03,FMRIP                                           0774
         BCTR  @03,0                                               0774
         SLR   @15,@15                                             0774
         IC    @15,TRBUF(N,@03)                                    0774
         LR    @03,@15                                             0774
         SRL   @03,4                                               0774
         LA    @01,BHTRTB(@03)                                     0774
         MVC   0(1,@04),0(@01)                                     0774
*             HDCVB(2*N) = BHTRTB((TRBUF(N) & '0F'X) + 1);         0775
         LA    @04,HDCVB-1(@06)                                    0775
         N     @15,@CF00831                                        0775
         LA    @06,BHTRTB(@15)                                     0775
         MVC   0(1,@04),0(@06)                                     0775
*           END;                                                   0776
*                                                                  0776
         AL    N,@CF00160                                          0776
@DE00773 CH    N,FMSIL                                             0776
         BNH   @DL00773                                            0776
*         /***********************************************************/
*         /*                                                         */
*         /* MOVE THE CONVERTED SEGMENTS TO THE PRINT BUFFER.        */
*         /* HDSEG1 IS THE FIRST HALF (4 - 8 BYTE SEGMENTS) OF THE   */
*         /* PRINT LINE.                                             */
*         /* HDSEG2 IS THE SECOND HALF (4 - 8 BYTE SEGMENTS) OF THE  */
*         /* PRINT LINE.                                             */
*         /* HDCVB CONTAINS THE CONVERTED SEGMENTS WITH NO SPACES.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0777
*           J =1;                                                  0777
         LA    @04,1                                               0777
         LR    J,@04                                               0777
*           DO N = 1 TO 28 BY 9;                                   0778
         LR    N,@04                                               0778
@DL00778 DS    0H                                                  0779
*             HDSEG1(N:N+8) = HDCVB(J:J+7);                        0779
         L     @06,CVPPADD                                         0779
         LR    @04,@06                                             0779
         ALR   @04,N                                               0779
         MVI   HDSEG1+7(@04),C' '                                  0779
         LA    @01,HDCVB-1(J)                                      0779
         MVC   HDSEG1-1(8,@04),0(@01)                              0779
*             HDSEG2(N:N+8) = HDCVB(J+32:J+39);                    0780
         ALR   @06,N                                               0780
         MVI   HDSEG2+7(@06),C' '                                  0780
         LA    @04,HDCVB+31(J)                                     0780
         MVC   HDSEG2-1(8,@06),0(@04)                              0780
*             J = J+8;                                             0781
         AL    J,@CF00156                                          0781
*           END;                                                   0782
*                                                                  0782
         AL    N,@CF00254                                          0782
         C     N,@CF00288                                          0782
         BNH   @DL00778                                            0782
*         /***********************************************************/
*         /*                                                         */
*         /* CALL THE PRINT CALL SUB-ROUTINE TO PRINT THIS LINE.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0783
*         CALL LINEPRT;                                            0783
*                                                                  0783
         BAL   @14,LINEPRT                                         0783
*         RESPECIFY RTNREG RSTD;                                   0784
*         TESTRC = RTNREG;                                         0785
         STH   RTNREG,TESTRC                                       0785
*         RESPECIFY RTNREG UNRSTD;                                 0786
*         IF TESTRC ^= 0                                           0787
*           THEN                                                   0787
         LH    @06,TESTRC                                          0787
         LTR   @06,@06                                             0787
         BZ    @RF00787                                            0787
*             RETURN CODE(RCQUIT);                                 0788
*                                                                  0788
         LH    @15,RCQUIT                                          0788
         L     @14,@SA00009                                        0788
         LM    @00,@06,@SA00009+8                                  0788
         LM    @08,@12,@SA00009+36                                 0788
         BR    @14                                                 0788
*         PRTSPF = 1;                                              0789
*                                                                  0789
@RF00787 MVC   PRTSPF(2),@CH00160                                  0789
*         /***********************************************************/
*         /*                                                         */
*         /* UPDATE THE INPUT POINTERS FOR THE NEXT LINE.            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0790
*           HDINDEXB = HDINDEXB + 32;   /* INCREMENT INDEX.          */
         LA    @06,32                                              0790
         LH    @04,HDINDEXB                                        0790
         ALR   @04,@06                                             0790
         STH   @04,HDINDEXB                                        0790
*           FMRIP = FMRIP + FMSIL;      /* INCREMENT INPUT PTR.      */
         LH    @04,FMSIL                                           0791
         L     @03,FMRIP                                           0791
         ALR   @03,@04                                             0791
         ST    @03,FMRIP                                           0791
*           FMRIL = FMRIL - FMSIL;      /* DECREMENT INPUT LENGTH.   */
         LCR   @04,@04                                             0792
         AL    @04,FMRIL                                           0792
         ST    @04,FMRIL                                           0792
*           IF FMRIL > 32                                          0793
*             THEN                                                 0793
         CR    @04,@06                                             0793
         BNH   @RF00793                                            0793
*               FMSIL = 32;             /* SET SEGMENT LENGTH.       */
         STH   @06,FMSIL                                           0794
*             ELSE                                                 0795
*               FMSIL = FMRIL;          /* SET SEGMENT LENGTH.       */
         B     @RC00793                                            0795
@RF00793 L     @06,FMRIL                                           0795
         STH   @06,FMSIL                                           0795
*         END;                                                     0796
*                                                                  0796
@RC00793 DS    0H                                                  0796
@DE00764 SLR   @06,@06                                             0796
         C     @06,FMRIL                                           0796
         BL    @DL00764                                            0796
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAN UP AND END THE BHD CONVERSION PROCEDURE.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0797
*         RETURN CODE (0);                                         0797
*                                                                  0797
         LR    @15,@06                                             0797
         L     @14,@SA00009                                        0797
         LM    @00,@06,@SA00009+8                                  0797
         LM    @08,@12,@SA00009+36                                 0797
         BR    @14                                                 0797
*         END BHDCONV;                                             0798
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - EBCDIC CONVERSION PROCEDURE.           */
*         /*                                                         */
*         /* FUNCTION - MOVES EBCDIC DATA TO BE PRINTED TO THE PRINT */
*         /* LINE.                                                   */
*         /* IF PRINT LINE OVERFLOW OCCURS, ALL LINES RESULTING FROM */
*         /* THE OVERFLOW ARE PRINTED PRIOR TO RETURN TO ICKTP01.    */
*         /*                                                         */
*         /* INPUT - THE INPUT DATA POINTER AND LENGTH AND THE PRINT */
*         /* POSITION ADDRESS.                                       */
*         /*                                                         */
*         /* OUTPUT - DATA FORMATTED ON THE PRINT LINE.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0799
*EBCDIC:  PROC;                                                    0799
*                                                                  0799
EBCDIC   STM   @14,@06,@SA00010                                    0799
         STM   @08,@12,@SA00010+36                                 0799
*         ALIGNBUF = ' ';               /* SET BUFFER BLANK          */
*                                                                  0800
         MVI   ALIGNBUF+1,C' '                                     0800
         MVC   ALIGNBUF+2(118),ALIGNBUF+1                          0800
         MVI   ALIGNBUF,C' '                                       0800
*         IF PLOVF = ON                                            0801
*           THEN                                                   0801
         TM    PLOVF,B'10000000'                                   0801
         BNO   @RF00801                                            0801
*             DO;                                                  0802
*                                                                  0802
*             /*******************************************************/
*             /*                                                     */
*             /* IF PRINT LINE OVERFLOW WILL OCCUR, THEN THIS CODE   */
*             /* WILL BREAK THE INPUT DATA INTO SEGMENTS AND PUT IT  */
*             /* INTO THE PRINT LINE, INVOKING LINEPRT FOR EACH LINE */
*             /* UNTIL ALL INPUT DATA HAS BEEN PRINTED.              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0803
*               FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)));      0803
         LA    @04,PRTBUFF                                         0803
         LCR   @04,@04                                             0803
         AL    @04,CVPPADD                                         0803
         LCR   @04,@04                                             0803
         AL    @04,PCTPLW(,PCTPTR)                                 0803
         STH   @04,FMSIL                                           0803
*               DO WHILE CVSL > 0;                                 0804
         B     @DE00804                                            0804
@DL00804 DS    0H                                                  0805
*                 CVPB(1:FMSIL) = TRBUF;                           0805
         LH    @04,FMSIL                                           0805
         LR    @15,@04                                             0805
         BCTR  @15,0                                               0805
         L     @14,FMRIP                                           0805
         EX    @15,@SM00917                                        0805
*                                       /* MOVE THE SEGMENT.         */
*                 CVSL = CVSL - FMSIL;                             0806
         SLR   CVSL,@04                                            0806
*                                       /* STEP SEGMENT LENGTH.      */
*                 FMRIP = FMRIP + FMSIL;                           0807
         ALR   @14,@04                                             0807
         ST    @14,FMRIP                                           0807
*                                       /* STEP THE INPUT POINTER.   */
*                                                                  0808
*                 CALL LINEPRT;                                    0808
*                                                                  0808
         BAL   @14,LINEPRT                                         0808
*                 RESPECIFY RTNREG RSTD;                           0809
*                 TESTRC = RTNREG;                                 0810
         STH   RTNREG,TESTRC                                       0810
*                 RESPECIFY RTNREG UNRSTD;                         0811
*                   IF TESTRC > 0                                  0812
*                     THEN                                         0812
         LH    @04,TESTRC                                          0812
         LTR   @04,@04                                             0812
         BNP   @RF00812                                            0812
*                       RETURN CODE(RCQUIT);                       0813
*                                                                  0813
         LH    @15,RCQUIT                                          0813
         L     @14,@SA00010                                        0813
         LM    @00,@06,@SA00010+8                                  0813
         LM    @08,@12,@SA00010+36                                 0813
         BR    @14                                                 0813
*                 PRTSPF = 1;                                      0814
@RF00812 MVC   PRTSPF(2),@CH00160                                  0814
*                 CVSTA = CVPPADD;      /* RESET THE PRINT START ADDR*/
         L     @04,CVPPADD                                         0815
         LR    CVSTA,@04                                           0815
*                 IF CVSL > (ADDR(PRTBUFF) + PCTPLW - CVPPADD)     0816
*                   THEN                /*IF MORE THAN ONE PRINT LINE*/
         LA    @15,PRTBUFF                                         0816
         AL    @15,PCTPLW(,PCTPTR)                                 0816
         SLR   @15,@04                                             0816
         CR    CVSL,@15                                            0816
         BNH   @RF00816                                            0816
*                     FMSIL = (ADDR(PRTBUFF) + PCTPLW - CVPPADD);  0817
         STH   @15,FMSIL                                           0817
*                                       /* MOVE A COMPLETE SEGMENT.  */
*                   ELSE                /* IF LESS THEN ONE LINE     */
*                     DO;                                          0818
         B     @RC00816                                            0818
@RF00816 DS    0H                                                  0819
*                       FMSIL = CVSL;   /* SET LENGTH FOR REMAINDER  */
         STH   CVSL,FMSIL                                          0819
*                       PCTAPC = 0;                                0820
         SLR   @04,@04                                             0820
         STH   @04,PCTAPC(,PCTPTR)                                 0820
*                     END;                                         0821
*               END;                                               0822
@RC00816 DS    0H                                                  0822
@DE00804 LTR   CVSL,CVSL                                           0822
         BP    @DL00804                                            0822
*             END;                                                 0823
*           ELSE                                                   0824
*             DO;                                                  0824
*                                                                  0824
         B     @RC00801                                            0824
@RF00801 DS    0H                                                  0825
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE A PARTIAL LINE SEGMENT.                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0825
*               FMSIL = CVPOL;                                     0825
         L     @07,CVPOL                                           0825
         STH   @07,FMSIL                                           0825
*               ALIGNBUF(1:CVSL) = TRBUF;                          0826
*                                                                  0826
         LR    @07,CVSL                                            0826
         BCTR  @07,0                                               0826
         L     @04,FMRIP                                           0826
         EX    @07,@SM00919                                        0826
*               /*****************************************************/
*               /*                                                   */
*               /* LOCATE THE LAST NON BLANK CHARACTER AND SET THE   */
*               /* OFFSET FOR BLANK SUPPRESSION.  IF ENTIRE FIELD    */
*               /* IS BLANKS THEN PRINT BLANK FIELD.                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0827
*               DO N = CVSL TO 1 BY -1 WHILE ALIGNBUF(N) = ' ';    0827
         LR    N,CVSL                                              0827
         B     @DE00827                                            0827
@DL00827 LA    @04,ALIGNBUF-1(N)                                   0827
         CLI   0(@04),C' '                                         0827
         BNE   @DC00827                                            0827
*               END;                                               0828
*                                                                  0828
         BCTR  N,0                                                 0828
@DE00827 LTR   N,N                                                 0828
         BP    @DL00827                                            0828
@DC00827 DS    0H                                                  0829
*               IF N = 0 THEN N = CVSL;                            0829
*                                                                  0829
         LTR   N,N                                                 0829
         BNZ   @RF00829                                            0829
         LR    N,CVSL                                              0830
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE LINE SEGMENT INTO PRINT BUFFER AND           */
*               /* UPDATE THE AUTO PRINT COLUMN.                     */
*               /*                                                   */
*               /*****************************************************/
*               IF FMTAR = ON & N ^= CVSL                          0831
*                 THEN                                             0831
@RF00829 CLC   FMTAR(4),@CF00463                                   0831
         BNE   @RF00831                                            0831
         CR    N,CVSL                                              0831
         BE    @RF00831                                            0831
*                   DO;                                            0832
*                   CVPB(CVSL-(N-1) : CVSL) = ALIGNBUF;            0833
         LA    @04,1                                               0833
         SLR   @04,N                                               0833
         ALR   @04,CVSL                                            0833
         ST    @04,@TF00001                                        0833
         ALR   @04,CVSTA                                           0833
         BCTR  @04,0                                               0833
         LR    @15,CVSL                                            0833
         SL    @15,@TF00001                                        0833
         EX    @15,@SM00921                                        0833
*                   PCTAPC = (CVSTA + CVSL -ADDR(PRTBUFF));        0834
         LR    @04,CVSTA                                           0834
         ALR   @04,CVSL                                            0834
         LA    @15,PRTBUFF                                         0834
         SLR   @04,@15                                             0834
         STH   @04,PCTAPC(,PCTPTR)                                 0834
*                   END;                                           0835
*                 ELSE                                             0836
*                   DO;                                            0836
         B     @RC00831                                            0836
@RF00831 DS    0H                                                  0837
*                   CVPB(1:CVSL) = ALIGNBUF;                       0837
         LR    @04,CVSL                                            0837
         BCTR  @04,0                                               0837
         EX    @04,@SM00923                                        0837
*                   PCTAPC = (CVSTA + N) - ADDR(PRTBUFF);          0838
         LR    @06,CVSTA                                           0838
         ALR   @06,N                                               0838
         LA    @04,PRTBUFF                                         0838
         SLR   @06,@04                                             0838
         STH   @06,PCTAPC(,PCTPTR)                                 0838
*                   END;                                           0839
*             END;                                                 0840
*                                                                  0840
@RC00831 DS    0H                                                  0841
*         /***********************************************************/
*         /*                                                         */
*         /* IF PCTPMN = -1 THEN THIS IS A MESSAGE LINE.  CONVERT    */
*         /* THE MESSAGE NUMBER TO BINARY AND PUT IT BACK INTO PCTPMN*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0841
*         IF PCTPMN = -1                                           0841
*           THEN                                                   0841
@RC00801 CLC   PCTPMN(2,PCTPTR),@CH00786                           0841
         BNE   @RF00841                                            0841
*             DO;                                                  0842
*               MSGNO = PRTBUFF(5:7);                              0843
         MVC   MSGNO(3),PRTBUFF+4                                  0843
*               GEN   (PACK  UNPKWD,MSGNO);                        0844
         PACK  UNPKWD,MSGNO
*               GEN   (CVB   CVDREG,UNPKWD);                       0845
         CVB   CVDREG,UNPKWD
*               PCTPMN = CVDREG;                                   0846
         STH   CVDREG,PCTPMN(,PCTPTR)                              0846
*             END;                                                 0847
*                                                                  0847
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAN UP AND END THE EBCDIC PRINT PROCEDURE.            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0848
*         RETURN CODE (0);                                         0848
*                                                                  0848
@RF00841 SLR   @15,@15                                             0848
         L     @14,@SA00010                                        0848
         LM    @00,@06,@SA00010+8                                  0848
         LM    @08,@12,@SA00010+36                                 0848
         BR    @14                                                 0848
*         END EBCDIC;                                              0849
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - PACKED TO UNPACKED DECIMAL CONVERSION. */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE CONVERTS PACKED TO UNPACKED   */
*         /* DECIMAL DATA. IT IS CALLED BY THE BINARY TO DECIMAL     */
*         /* PROCEDURE IN ADDITION TO HANDLING STRAIGHT PACKED TO    */
*         /* UNPACKED.  IT IS, THEREFORE USED TO HANDLE ALL SIGN     */
*         /* CONTROL, LEFT ALIGNMENT AND ZERO SUPPRESSION.           */
*         /*                                                         */
*         /* INPUT - THE INPUT DATA POINTER, DATA LENGTH, OUTPUT     */
*         /* PRINT POSITION POINTER, ALIGN LEFT FLAG, ZERO SUPPRESS  */
*         /* FLAG AND SIGN SUPPRESS FLAG.                            */
*         /*                                                         */
*         /* OUTPUT - CONVERTED DATA IN THE PRINT LINE.  PRINT LINE  */
*         /* OVERFLOW DOES NOT OCCUR ON PACKED TO UNPACKED CONVERTS. */
*         /* IF THE CONDITION OCCURS, THE DATA OUT IS TRUNCATED.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0850
*PUPCONV: PROC;                                                    0850
*                                                                  0850
PUPCONV  STM   @14,@06,12(@13)                                     0850
         STM   @08,@12,52(@13)                                     0850
*         PLOVF = OFF;                  /* OVERFLOW NOT ALLOWED.     */
         NI    PLOVF,B'01111111'                                   0851
*         SETRC = 0;                                               0852
*                                                                  0852
         SLR   SETRC,SETRC                                         0852
*         /***********************************************************/
*         /*                                                         */
*         /* INITIALIZE COUNTERS USED FOR PACKED TO UNPACKED.        */
*         /* INITIALIZE FLAGS TO CONTROL ZERO SUPPRESS & LEFT ALIGN  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0853
*         PUPOCT = 1;                                              0853
         LA    @07,1                                               0853
         STH   @07,PUPOCT                                          0853
*         PUPPSC = 1;                                              0854
         LR    PUPPSC,@07                                          0854
*         IF CVPZS = OFF                /* IS IT ZERO SUPPRESS.      */
*           THEN                                                   0855
         TM    CVPZS,B'10000000'                                   0855
         BNZ   @RF00855                                            0855
*             PUPPSF = ON;              /* SET TO PRINT ZEROS.       */
         OI    PUPPSF,B'01000000'                                  0856
*           ELSE                                                   0857
*             PUPPSF = OFF;             /* SET TO SUPPRESS ZEROS.    */
         B     @RC00855                                            0857
@RF00855 NI    PUPPSF,B'10111111'                                  0857
*         IF CVPAL = OFF                /* IS IT ALIGN LEFT.         */
*           THEN                                                   0858
@RC00855 TM    CVPAL,B'01000000'                                   0858
         BNZ   @RF00858                                            0858
*             PUPIOF = ON;              /* SUPPRESS OUTPUT POINTER   */
         OI    PUPIOF,B'00100000'                                  0859
*                                       /* STEPPING IF IT IS.        */
*           ELSE                                                   0860
*             PUPIOF = OFF;             /* ALLOW OUTPUT PTR STEPPING */
*                                                                  0860
         B     @RC00858                                            0860
@RF00858 NI    PUPIOF,B'11011111'                                  0860
*         /***********************************************************/
*         /*                                                         */
*         /* BEGIN THE CONVERSION LOOP HERE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0861
*         OLDERID2 = NEWERID2;                                     0861
@RC00858 L     @07,GDTTR2(,GDTPR)                                  0861
         MVC   @TS00001(95),NEWERID2(@07)                          0861
         MVC   OLDERID2(95,@07),@TS00001                           0861
*         NEWID2 = 'TP2D';                                         0862
         MVC   NEWID2(4,@07),@CC00846                              0862
*         IF CVPPU = ON                                            0863
*           THEN                                                   0863
         TM    CVPPU,B'00001000'                                   0863
         BNO   @RF00863                                            0863
*             FMSIL = CVPIL;            /* SET PACKED TO UNPACKED    */
         L     @07,CVPIL                                           0864
         STH   @07,FMSIL                                           0864
*                                       /* LENGTH FIELD.             */
*                                                                  0865
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE SIGN UNDER CONTROL OF THE SIGN SUPPRESS FLAG */
*         /* IN THE INPUT PARAMETERS.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0865
*         IF CVPSS = OFF                /* IS SIGN SUPPRESS OFF.     */
*           THEN                                                   0865
@RF00863 TM    CVPSS,B'00100000'                                   0865
         BNZ   @RF00865                                            0865
*             DO;                                                  0866
*               SIGNT = (TRBUF(FMSIL) & '0F'X);                    0867
         LH    @01,FMSIL                                           0867
         LA    SIGNT,15                                            0867
         L     @15,FMRIP                                           0867
         BCTR  @15,0                                               0867
         SLR   @14,@14                                             0867
         IC    @14,TRBUF(@01,@15)                                  0867
         NR    SIGNT,@14                                           0867
*                                       /* GET THE SIGN.             */
*               IF SIGNT = 11  SIGNT = 13                         0868
*                                       /* IF IT IS EITHER, MINUS.   */
*                 THEN                                             0868
         C     SIGNT,@CF00033                                      0868
         BE    @RT00868                                            0868
         C     SIGNT,@CF00259                                      0868
         BNE   @RF00868                                            0868
@RT00868 DS    0H                                                  0869
*                   SIGN = MINUS;       /* SET THE MINUS SIGN.       */
         MVI   SIGN,C'-'                                           0869
*                 ELSE                                             0870
*                   SIGN = PLUS;        /* SET THE PLUS SIGN.        */
         B     @RC00868                                            0870
@RF00868 MVI   SIGN,C'+'                                           0870
*               PUPPSC = PUPPSC + 1;    /* STEP PRINT BUFF PTR.      */
@RC00868 AL    PUPPSC,@CF00160                                     0871
*             END;                                                 0872
*                                                                  0872
*         DO N = 1 TO FMSIL BY 1;                                  0873
*                                                                  0873
@RF00865 LA    N,1                                                 0873
         B     @DE00873                                            0873
@DL00873 DS    0H                                                  0874
*           /*********************************************************/
*           /*                                                       */
*           /* GET THE HIGH ORDER HALF BYTE AND CHECK FOR A VALID    */
*           /* PACKED DECIMAL DIGIT.                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0874
*           DECT = TRBUF(N)/16;         /* GET HIGH ORDER HALF CHAR  */
         L     @01,FMRIP                                           0874
         BCTR  @01,0                                               0874
         SLR   @00,@00                                             0874
         IC    @00,TRBUF(N,@01)                                    0874
         SRL   @00,4                                               0874
         STH   @00,DECT                                            0874
*           IF DECT > 9                 /* COMPARE TO MAXIMUM.       */
*             THEN                                                 0875
*                                                                  0875
         C     @00,@CF00254                                        0875
         BNH   @RF00875                                            0875
*             /*******************************************************/
*             /*                                                     */
*             /* RETURN TO THE CALLER ON A NON-VALID PACKED DECIMAL  */
*             /* DECIMAL DIGIT.                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0876
*               DO;                                                0876
*                 RETURN CODE (8);                                 0877
         LA    @15,8                                               0877
         L     @14,12(,@13)                                        0877
         LM    @00,@06,20(@13)                                     0877
         LM    @08,@12,52(@13)                                     0877
         BR    @14                                                 0877
*               END;                                               0878
*                                                                  0878
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE THIS HALF BYTE TO THE OUTPUT BUFFER.           */
*             /* UNDER CONTROL OF THE ALIGN LEFT AND ZERO SUPPRESS   */
*             /* CONTROL FLAGS.                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0879
*             IF DECT ^= 0              /* IS IT NON ZERO            */
*               THEN                                               0879
@RF00875 LH    @15,DECT                                            0879
         LTR   @15,@15                                             0879
         BZ    @RF00879                                            0879
*                 DO;                                              0880
*                   PUPPSF = ON;        /* TURN PRINT START ON.      */
*                   PUPIOF = ON;        /* TURN OUTPUT STEP ON.      */
         OI    PUPPSF,B'01100000'                                  0882
*                 END;                                             0883
*             IF FMSIL*2 - PUPOCT <=CVPOL                          0884
*                                      /* CHECK OUTPUT START.        */
*               THEN                                               0884
@RF00879 LH    @15,FMSIL                                           0884
         ALR   @15,@15                                             0884
         SH    @15,PUPOCT                                          0884
         C     @15,CVPOL                                           0884
         BH    @RF00884                                            0884
*                 DO;                                              0885
*                   IF PUPPSF = ON     /* IS PRINT START ON         */
*                     THEN                                         0886
         TM    PUPPSF,B'01000000'                                  0886
         BNO   @RF00886                                            0886
*                       DO;                                        0887
*                         CVPB(PUPPSC) = BHTRTB(DECT+1);           0888
         LR    @01,CVSTA                                           0888
         ALR   @01,PUPPSC                                          0888
         BCTR  @01,0                                               0888
         LH    @15,DECT                                            0888
         LA    @14,BHTRTB(@15)                                     0888
         MVC   CVPB(1,@01),0(@14)                                  0888
*                                       /* MOVE CONVERTED DIGIT.     */
*                         IF SIGNPOS = OFF & CVPSS = OFF           0889
*                           THEN                                   0889
         TM    SIGNPOS,B'00010000'                                 0889
         BNZ   @RF00889                                            0889
         TM    CVPSS,B'00100000'                                   0889
         BNZ   @RF00889                                            0889
*                             DO;                                  0890
*                                                                  0890
*                             /***************************************/
*                             /*                                     */
*                             /* MOVE SIGN TO BUFFER.                */
*                             /*                                     */
*                             /***************************************/
*                                                                  0891
*                               PUPPSC=PUPPSC-1;                   0891
         BCTR  PUPPSC,0                                            0891
*                               CVPB(PUPPSC) = SIGN;               0892
         LR    @01,CVSTA                                           0892
         ALR   @01,PUPPSC                                          0892
         BCTR  @01,0                                               0892
         MVC   CVPB(1,@01),SIGN                                    0892
*                               PUPPSC=PUPPSC+1;                   0893
         AL    PUPPSC,@CF00160                                     0893
*                               SIGNPOS = ON;                      0894
         OI    SIGNPOS,B'00010000'                                 0894
*                             END;                                 0895
*                       END;                                       0896
@RF00889 DS    0H                                                  0897
*                   IF PUPIOF = ON      /* CAN OUTPUT PTR BE STEPPED */
*                     THEN                                         0897
@RF00886 TM    PUPIOF,B'00100000'                                  0897
         BNO   @RF00897                                            0897
*                       PUPPSC = PUPPSC + 1;                       0898
         AL    PUPPSC,@CF00160                                     0898
*                   IF CVSTA + PUPPSC > ADDR(PRTBUFF) + PCTPLW     0899
*                                       /* IS IT END OF LINE.        */
*                     THEN                                         0899
@RF00897 LR    @15,CVSTA                                           0899
         ALR   @15,PUPPSC                                          0899
         LA    @14,PRTBUFF                                         0899
         AL    @14,PCTPLW(,PCTPTR)                                 0899
         CR    @15,@14                                             0899
         BNH   @RF00899                                            0899
*                       DO;                                        0900
*                         OLDERID2 = NEWERID2;                     0901
         L     @04,GDTTR2(,GDTPR)                                  0901
         MVC   @TS00001(95),NEWERID2(@04)                          0901
         MVC   OLDERID2(95,@04),@TS00001                           0901
*                         NEWID2 = 'TP2O';                         0902
         MVC   NEWID2(4,@04),@CC00847                              0902
*                         RETURN CODE(0);                          0903
         SLR   @15,@15                                             0903
         L     @14,12(,@13)                                        0903
         LM    @00,@06,20(@13)                                     0903
         LM    @08,@12,52(@13)                                     0903
         BR    @14                                                 0903
*                       END;                                       0904
*                 END;                                             0905
@RF00899 DS    0H                                                  0906
*           PUPOCT = PUPOCT + 1;                                   0906
*                                                                  0906
@RF00884 LH    @01,PUPOCT                                          0906
         LA    @01,1(,@01)                                         0906
         STH   @01,PUPOCT                                          0906
*           /*********************************************************/
*           /*                                                       */
*           /* GET THE LOW ORDER HALF BYTE OF THE INPUT BYTE.        */
*           /* IF THIS IS THE LAST BYTE, THIS WILL BE THE SIGN.      */
*           /* IF THIS IS THE CASE, IGNORE IT & TERMINATE.           */
*           /* IF THIS IS ANY OTHER THAN THE LAST BYTE, CHECK IT FOR */
*           /* VALIDITY.                                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0907
*           DECT = TRBUF(N) & '0F'X;                               0907
         LA    @15,15                                              0907
         L     @14,FMRIP                                           0907
         BCTR  @14,0                                               0907
         SLR   @01,@01                                             0907
         IC    @01,TRBUF(N,@14)                                    0907
         NR    @15,@01                                             0907
         STH   @15,DECT                                            0907
*           IF DECT > 9                 /* IS IT A VALID PACK DIGIT  */
*             THEN                                                 0908
         C     @15,@CF00254                                        0908
         BNH   @RF00908                                            0908
*               DO;                                                0909
*                 IF N = FMSIL          /* IF NOT, IS IT A SIGN.     */
*                   THEN;                                          0910
         CH    N,FMSIL                                             0910
         BE    @RT00910                                            0910
*                   ELSE                                           0912
*                     DO;               /* IF NEITHER THEN ERROR RET */
*                       OLDERID2 = NEWERID2;                       0913
         L     @04,GDTTR2(,GDTPR)                                  0913
         MVC   @TS00001(95),NEWERID2(@04)                          0913
         MVC   OLDERID2(95,@04),@TS00001                           0913
*                       NEWID2 = 'TP2I';                           0914
         MVC   NEWID2(4,@04),@CC00819                              0914
*                       RETURN CODE (8);                           0915
         LA    @15,8                                               0915
         L     @14,12(,@13)                                        0915
         LM    @00,@06,20(@13)                                     0915
         LM    @08,@12,52(@13)                                     0915
         BR    @14                                                 0915
*                     END;                                         0916
*               END;                                               0917
*                                                                  0917
@RT00910 DS    0H                                                  0918
*           /*********************************************************/
*           /*                                                       */
*           /* MOVE THE LOW ORDER HALF BYTE TO THE OUTPUT BUFFER.    */
*           /* UNDER CONTROL OF THE ALIGN LEFT AND ZERO SUPPRESS     */
*           /* CONTROL FLAGS.                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0918
*           IF N < FMSIL                /* CHECK FOR SIGN POSITION.  */
*             THEN                                                 0918
@RF00908 CH    N,FMSIL                                             0918
         BNL   @RF00918                                            0918
*               DO;                                                0919
*                 IF DECT ^= 0          /* CHECK FIRST NON-ZERO.     */
*                   THEN                                           0920
         LH    @15,DECT                                            0920
         LTR   @15,@15                                             0920
         BZ    @RF00920                                            0920
*                     DO;                                          0921
*                       PUPPSF = ON;    /* PRINT START ON.           */
*                       PUPIOF = ON;    /* OUTPUT STEP ON.           */
         OI    PUPPSF,B'01100000'                                  0923
*                     END;                                         0924
*                 IF FMSIL*2 - PUPOCT <= CVPOL                     0925
*                                      /* CHECK OUTPUT START.        */
*                   THEN                                           0925
@RF00920 LH    @15,FMSIL                                           0925
         ALR   @15,@15                                             0925
         SH    @15,PUPOCT                                          0925
         C     @15,CVPOL                                           0925
         BH    @RF00925                                            0925
*                     DO;                                          0926
*                       IF PUPPSF = ON  /* IS PRINT START ON.        */
*                         THEN                                     0927
         TM    PUPPSF,B'01000000'                                  0927
         BNO   @RF00927                                            0927
*                           DO;                                    0928
*                             CVPB(PUPPSC) = BHTRTB(DECT + 1);     0929
         LR    @01,CVSTA                                           0929
         ALR   @01,PUPPSC                                          0929
         BCTR  @01,0                                               0929
         LH    @15,DECT                                            0929
         LA    @14,BHTRTB(@15)                                     0929
         MVC   CVPB(1,@01),0(@14)                                  0929
*                                       /* MOVE THE CHARACTER.       */
*                             IF SIGNPOS = OFF & CVPSS = OFF       0930
*                               THEN                               0930
         TM    SIGNPOS,B'00010000'                                 0930
         BNZ   @RF00930                                            0930
         TM    CVPSS,B'00100000'                                   0930
         BNZ   @RF00930                                            0930
*                                 DO;   /* SET THE SIGN.             */
*                                   PUPPSC=PUPPSC-1;               0932
         BCTR  PUPPSC,0                                            0932
*                                   CVPB(PUPPSC) = SIGN;           0933
         LR    @01,CVSTA                                           0933
         ALR   @01,PUPPSC                                          0933
         BCTR  @01,0                                               0933
         MVC   CVPB(1,@01),SIGN                                    0933
*                                   PUPPSC=PUPPSC+1;               0934
         AL    PUPPSC,@CF00160                                     0934
*                                   SIGNPOS = ON;                  0935
         OI    SIGNPOS,B'00010000'                                 0935
*                                 END;                             0936
*                           END;                                   0937
@RF00930 DS    0H                                                  0938
*                       IF PUPIOF = ON                             0938
*                         THEN                                     0938
@RF00927 TM    PUPIOF,B'00100000'                                  0938
         BNO   @RF00938                                            0938
*                           PUPPSC = PUPPSC + 1;                   0939
         AL    PUPPSC,@CF00160                                     0939
*                       IF CVSTA + PUPPSC > ADDR(PRTBUFF) + PCTPLW + 1
*                                       /* IS IT END OF PRINT LINE   */
*                         THEN                                     0940
@RF00938 LR    @15,CVSTA                                           0940
         ALR   @15,PUPPSC                                          0940
         LA    @14,PRTBUFF                                         0940
         AL    @14,PCTPLW(,PCTPTR)                                 0940
         AL    @14,@CF00160                                        0940
         CR    @15,@14                                             0940
         BNH   @RF00940                                            0940
*                           DO;                                    0941
*                             OLDERID2 = NEWERID2;                 0942
         L     @04,GDTTR2(,GDTPR)                                  0942
         MVC   @TS00001(95),NEWERID2(@04)                          0942
         MVC   OLDERID2(95,@04),@TS00001                           0942
*                             NEWID2 = 'TP2V';                     0943
         MVC   NEWID2(4,@04),@CC00848                              0943
*                             RETURN CODE(0);                      0944
         SLR   @15,@15                                             0944
         L     @14,12(,@13)                                        0944
         LM    @00,@06,20(@13)                                     0944
         LM    @08,@12,52(@13)                                     0944
         BR    @14                                                 0944
*                           END;                                   0945
*                     END;                                         0946
@RF00940 DS    0H                                                  0947
*               END;                                               0947
@RF00925 DS    0H                                                  0948
*             PUPOCT = PUPOCT + 1;                                 0948
@RF00918 LH    @01,PUPOCT                                          0948
         LA    @01,1(,@01)                                         0948
         STH   @01,PUPOCT                                          0948
*         END;                                                     0949
*                                                                  0949
         AL    N,@CF00160                                          0949
@DE00873 CH    N,FMSIL                                             0949
         BNH   @DL00873                                            0949
*         /***********************************************************/
*         /*                                                         */
*         /* SET ZERO IN ALL ZERO FIELD, IF ZERO SUPPRESS AND        */
*         /* NO NONZERO DIGITS FOUND.                                */
*         /*                                                         */
*         /***********************************************************/
*         IF CVPZS = ON & PUPPSF = OFF                             0950
*           THEN                                                   0950
         TM    CVPZS,B'10000000'                                   0950
         BNO   @RF00950                                            0950
         TM    PUPPSF,B'01000000'                                  0950
         BNZ   @RF00950                                            0950
*             IF CVPAL = OFF                                       0951
*               THEN                                               0951
         TM    CVPAL,B'01000000'                                   0951
         BNZ   @RF00951                                            0951
*                 CVPB(CVSL) = '0';                                0952
         LR    @07,CVSTA                                           0952
         ALR   @07,CVSL                                            0952
         BCTR  @07,0                                               0952
         MVI   CVPB(@07),C'0'                                      0952
*               ELSE                                               0953
*                 CVPB(1) = '0';                                   0953
*                                                                  0953
         B     @RC00951                                            0953
@RF00951 MVI   CVPB(CVSTA),C'0'                                    0953
*         /***********************************************************/
*         /*                                                         */
*         /* LOCATE THE LAST NON BLANK CHARACTER AND SET THE         */
*         /* OFFSET FOR BLANK SUPPRESSION.  IF ENTIRE FIELD          */
*         /* IS BLANKS THEN PRINT A BLANK FIELD.                     */
*         /***********************************************************/
*                                                                  0954
*         DO N = CVSL TO 1 BY -1 WHILE CVPB(N) = ' ';              0954
@RC00951 DS    0H                                                  0954
@RF00950 LR    N,CVSL                                              0954
         B     @DE00954                                            0954
@DL00954 LR    @04,CVSTA                                           0954
         ALR   @04,N                                               0954
         BCTR  @04,0                                               0954
         CLI   CVPB(@04),C' '                                      0954
         BNE   @DC00954                                            0954
*         END;                                                     0955
         BCTR  N,0                                                 0955
@DE00954 LTR   N,N                                                 0955
         BP    @DL00954                                            0955
@DC00954 DS    0H                                                  0956
*         IF N = 0 THEN N = CVSL;                                  0956
         LTR   N,N                                                 0956
         BNZ   @RF00956                                            0956
         LR    N,CVSL                                              0957
*         PCTAPC = (CVSTA + N) - ADDR(PRTBUFF);                    0958
*                                                                  0958
@RF00956 LR    @04,CVSTA                                           0958
         ALR   @04,N                                               0958
         LA    @15,PRTBUFF                                         0958
         SLR   @04,@15                                             0958
         STH   @04,PCTAPC(,PCTPTR)                                 0958
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE PACKED TO UNPACKED DECIMAL CONVERSION.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0959
*         OLDERID2 = NEWERID2;                                     0959
         L     @04,GDTTR2(,GDTPR)                                  0959
         MVC   @TS00001(95),NEWERID2(@04)                          0959
         MVC   OLDERID2(95,@04),@TS00001                           0959
*         NEWID2 = 'TP2U';                                         0960
         MVC   NEWID2(4,@04),@CC00850                              0960
*         RETURN CODE (0);                                         0961
         SLR   @15,@15                                             0961
         L     @14,12(,@13)                                        0961
         LM    @00,@06,20(@13)                                     0961
         LM    @08,@12,52(@13)                                     0961
         BR    @14                                                 0961
*         END PUPCONV;                                             0962
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - BINARY TO DECIMAL CONVERSION.          */
*         /*                                                         */
*         /* FUNCTION - CONVERTS BINARY TO PACKED DECIMAL THEN CALLS */
*         /* THE PACKED TO UNPACKED DECIMAL CONVERSION PROCEDURE TO  */
*         /* CONVERT THE PACKED DECIMAL TO UNPACKED DECIMAL.         */
*         /* THE CONVERT BINARY-TO-DECIMAL INSTRUCTION DOES          */
*         /* NOT HANDLE FOUR BYTE BINARY NUMBERS WITH THE            */
*         /* HIGH-ORDER BIT REPRESENTING DATA. IF THE VALUE          */
*         /* TO BE CONVERTED IS FOUR BYTES IN LENGTH, HAS THE        */
*         /* HIGH-ORDER BIT ON AND THE SUPPRESS SIGN FLAG IS         */
*         /* ON, THE HIGH-ORDER BIT IS TURNED OFF AND A              */
*         /* A PACKED DECIMAL VALUE IS ADDED TO THE VALUE            */
*         /* RETURNED BY THE CONVERT BINARY-TO-DECIMAL               */
*         /* INSTRUCTION.                                            */
*         /*                                                         */
*         /* INPUT - THE INPUT DATA POINTER, DATA LENGTH AND PRINT   */
*         /* POSITION ADDRESS.                                       */
*         /*                                                         */
*         /* OUTPUT - CONVERTED DECIMAL DATA IN THE PRINT LINE.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0963
*BDCONV:  PROC;                                                    0963
*                                                                  0963
BDCONV   STM   @14,@06,@SA00012                                    0963
         STM   @08,@12,@SA00012+36                                 0963
*         BDLEN = 5 - CVPIL;                                       0964
         L     @07,CVPIL                                           0964
         LA    @04,5                                               0964
         SLR   @04,@07                                             0964
         ST    @04,BDLEN                                           0964
*         HIORDRF = OFF;                /* SET THE HI-ORDER          */
         NI    HIORDRF,B'11110111'                                 0965
*                                       /* DATA FLAG.                */
*         IF CVPIL = 2                  /* IS INPUT HALF WORD.       */
*           THEN                                                   0966
         C     @07,@CF00111                                        0966
         BNE   @RF00966                                            0966
*             DO;                       /* SET UP HALF WORD INPUT.   */
*               BINHALFC(1:2) = CVPIADD ->TRBUF;                   0968
         L     @07,CVPIADD                                         0968
         MVC   BINHALFC(2),TRBUF(@07)                              0968
*               BINACC = BINHALF;                                  0969
         LH    @07,BINHALF                                         0969
         ST    @07,BINACC                                          0969
*             END;                                                 0970
*           ELSE                                                   0971
*             DO;                       /* SET UP OTHER LENGTH INPUT */
         B     @RC00966                                            0971
@RF00966 DS    0H                                                  0972
*               BINACC = 0;                                        0972
         SLR   @07,@07                                             0972
         ST    @07,BINACC                                          0972
*               BINACCC(BDLEN:4) = CVPIADD ->TRBUF;                0973
*                                                                  0973
         L     @07,BDLEN                                           0973
         LA    @04,BINACCC-1(@07)                                  0973
         LCR   @07,@07                                             0973
         AL    @07,@CF00036                                        0973
         L     @01,CVPIADD                                         0973
         EX    @07,@SM00929                                        0973
*               /*******************************************@OX17492*/
*               /*                                          @OX17492*/
*               /* DETERMINE IF THE HIGH-ORDER BIT CONTAINS @OX17492*/
*               /* DATA. DATA IS ASSUMED IF VALUE IS FOUR   @OX17492*/
*               /* BYTES LONG, THE HIGH-ORDER BIT IS ON AND @OX17492*/
*               /* THE SUPPRESS SIGN FLAG IS ON.            @OX17492*/
*               /*                                          @OX17492*/
*               /*******************************************@OX17492*/
*                                                                  0974
*               IF BINACCC(1) > MAXPLUS /* IS HIGH-ORDER    @OX17492*/
*                 THEN                  /* BIT ON ?         @OX17492*/
         CLI   BINACCC,X'7F'                                       0974
         BNH   @RF00974                                            0974
*                   IF CVPSS = ON       /* SIGN SUPPRESS?   @OX17492*/
*                     THEN                                /*@OX17492*/
         TM    CVPSS,B'00100000'                                   0975
         BNO   @RF00975                                            0975
*                       DO;                               /*@OX17492*/
*                       HIORDRF = ON;   /* SET HI-ORDER     @OX17492*/
         OI    HIORDRF,B'00001000'                                 0977
*                                       /* DATA BIT FLAG    @OX17492*/
*                       BINACCC(1) = BINACCC(1) & MAXPLUS;/*@OX17492*/
         NI    BINACCC,X'7F'                                       0978
*                                       /* CLEAR HIGH-ORDER @OX17492*/
*                                       /* BIT              @OX17492*/
*                       END;                              /*@OX17492*/
*                     ELSE;                               /*@OX17492*/
@RF00975 DS    0H                                                  0981
*                 ELSE;                                   /*@OX17492*/
@RF00974 DS    0H                                                  0982
*             END;                                                 0982
*                                                                  0982
*GEN      (L   CVDREG,BINACC);                                     0983
@RC00966 DS    0H                                                  0983
         L   CVDREG,BINACC
*GEN      (CVD CVDREG,UNPKWD);                                     0984
*                                                                  0984
         CVD CVDREG,UNPKWD
*         /**************************************************        */
*         /*                                                         */
*         /* IF THE HIGH-ORDER BIT CONTAINED DATA, IT MUST           */
*         /* BE ADDED TO THE CONVERTED DECIMAL VALUE. THE            */
*         /* DECIMAL EQUIVALENT MUST BE ADDED IN TWO PARTS           */
*         /* EQUAL TO HALF THE REQUIRED VALUE BECAUSE ONE            */
*         /* CONSTANT CANNOT BE DEFINED LARGE ENOUGH.                */
*         /*                                                         */
*         /**************************************************        */
*                                                                  0985
*         IF HIORDRF = ON               /* HIGH-ORDER BIT            */
*           THEN                        /* CONTAINS DATA ?           */
         TM    HIORDRF,B'00001000'                                 0985
         BNO   @RF00985                                            0985
*             DO;                                                  0986
*             AP (UNPKWD,PKDECE);       /* ADD PACKED DECIMAL        */
         AP    UNPKWD(8),@CB00710(8)                               0987
*             AP (UNPKWD,PKDECE);       /* EQUIVALEN OF              */
         AP    UNPKWD(8),@CB00710(8)                               0988
*             END;                      /* X'80000000' BACK          */
*           ELSE;                       /* IN TWO PARTS              */
*                                                                  0990
@RF00985 DS    0H                                                  0991
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE PARAMETERS FOR THE CALL TO THE PACKED TO     */
*         /* UNPACKED CONVERSION AND MAKE THE CALL TO THAT PROCEDURE */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0991
*         FMRIP = ADDR(UNPKWD);                                    0991
         LA    @04,UNPKWD                                          0991
         ST    @04,FMRIP                                           0991
*         FMSIL = 8;                                               0992
*                                                                  0992
         MVC   FMSIL(2),@CH00156                                   0992
*         CALL PUPCONV;                                            0993
*                                                                  0993
         BAL   @14,PUPCONV                                         0993
*         RESPECIFY RTNREG RSTD;                                   0994
*         TESTRC = RTNREG;                                         0995
         STH   RTNREG,TESTRC                                       0995
*         RESPECIFY RTNREG UNRSTD;                                 0996
*         RETURN CODE (TESTRC);                                    0997
         LH    @06,TESTRC                                          0997
         LR    @15,@06                                             0997
         L     @14,@SA00012                                        0997
         LM    @00,@06,@SA00012+8                                  0997
         LM    @08,@12,@SA00012+36                                 0997
         BR    @14                                                 0997
*         END BDCONV;                                              0998
*         END CONVERT;                                             0999
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - DATA RETURN PROCEDURE.                 */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE RETURNS DATA TO A CALLER.     */
*         /* THE DATA IS RETURNED TO THE AREA POINTED TO BY DARGRETP */
*         /* TO THE LENGTH PROVIDED BY DARGRETC.  IF THE DATA LENGTH */
*         /* TO BE FORMATTED IS LESS THAN THE COUNT IN DARGRETC THEN */
*         /* THE AREA IS NOT PADDED WITH BLANKS.  IF DARGRETC IS LESS*/
*         /* THAN THE THE LENGTH OF THE DATA TO BE FORMATTED, THEN   */
*         /* FORMATTING IS STOPPED WHEN DARGRETC IS REACHED.  IN     */
*         /* EITHER CASE, NO MESSAGE IS PRINTED OR ERROR CONDITION   */
*         /* RETURNED.                                               */
*         /*                                                         */
*         /* INPUT - THE FULLY CONVERTED AND FORMATTED LINE IN THE   */
*         /* PRINT ARGUMENT LIST (CVPSTRU).                          */
*         /*                                                         */
*         /* OUTPUT - THE RETURNED DATA IN THE AREA DESIGNATED BY    */
*         /* THE CALLER.                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1000
*LINERET: PROC;                                                    1000
*                                                                  1000
LINERET  STM   @14,@12,12(@13)                                     1000
*   OLDERID2 = NEWERID2;                                           1001
         L     @04,GDTTR2(,GDTPR)                                  1001
         MVC   @TS00001(95),NEWERID2(@04)                          1001
         MVC   OLDERID2(95,@04),@TS00001                           1001
*   NEWID2 = 'TPDR';                                               1002
*                                                                  1002
         MVC   NEWID2(4,@04),@CC00859                              1002
*         /***********************************************************/
*         /*                                                         */
*         /* RETURN THE FORMATTED LINE TO THE CALLER.                */
*         /* RETLN IS USED TO CONTAIN THE LENGTH OF THE AREA TO BE   */
*         /* MOVED.                                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1003
*         IF CVPRETC > PCTPLW                                      1003
*           THEN                                                   1003
         LH    @04,CVPRETC                                         1003
         L     @03,PCTPLW(,PCTPTR)                                 1003
         CR    @04,@03                                             1003
         BNH   @RF01003                                            1003
*             DO;                                                  1004
*                                                                  1004
*             /*******************************************************/
*             /*                                                     */
*             /* SET THE SEGMENT LENGTH TO                           */
*             /* MOVE AN ENTIRE LINE TO USERS DATA AREA.             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1005
*               RETLN = PCTPLW;                                    1005
         ST    @03,RETLN                                           1005
*               CVPRETC = CVPRETC - PCTPLW;                        1006
         SLR   @04,@03                                             1006
         STH   @04,CVPRETC                                         1006
*             END;                                                 1007
*           ELSE                                                   1008
*             DO;                                                  1008
*                                                                  1008
         B     @RC01003                                            1008
@RF01003 DS    0H                                                  1009
*             /*******************************************************/
*             /*                                                     */
*             /* SET THE SEGMENT LENGTH TO                           */
*             /* MOVE A PARTIAL LINE.                                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1009
*               RETLN = CVPRETC;                                   1009
         LH    @04,CVPRETC                                         1009
         ST    @04,RETLN                                           1009
*               CVPRETC = 0;                                       1010
         SLR   @04,@04                                             1010
         STH   @04,CVPRETC                                         1010
*             END;                                                 1011
*         IF RETLN > 0                                             1012
*           THEN                                                   1012
@RC01003 L     @04,RETLN                                           1012
         LTR   @04,@04                                             1012
         BNP   @RF01012                                            1012
*             DO;                                                  1013
*                                                                  1013
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE THE LINE SEGMENT TO THE USERS AREA.          */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1014
*               RETAREA(1:RETLN) = PRTBUFF;                        1014
         L     @03,CVPRETP                                         1014
         LR    @15,@04                                             1014
         BCTR  @15,0                                               1014
         EX    @15,@SM00931                                        1014
*               CVPRETP = CVPRETP + RETLN;                         1015
         ALR   @03,@04                                             1015
         ST    @03,CVPRETP                                         1015
*             END;                                                 1016
*             FFMFMTF = OFF;                                       1017
@RF01012 NI    FFMFMTF,B'11111110'                                 1017
*             PRTBUFF = ' ';                                       1018
*                                                                  1018
         MVI   PRTBUFF+1,C' '                                      1018
         MVC   PRTBUFF+2(131),PRTBUFF+1                            1018
         MVI   PRTBUFF,C' '                                        1018
*         RETURN;                                                  1019
@EL00013 DS    0H                                                  1019
@EF00013 DS    0H                                                  1019
@ER00013 LM    @14,@12,12(@13)                                     1019
         BR    @14                                                 1019
*         END LINERET;                                             1020
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - LINE PRINT PROCEDURE.                  */
*         /*                                                         */
*         /* FUNCTION - MAINTAINS PAGE FORMATTING INFORMATION,       */
*         /* PRINTING TITLE, HEADING AND FOOTING LINES AS REQUIRED   */
*         /* AND PRINTS THE LINES REQUESTED.  THIS PROCEDURE IS      */
*         /* ALSWAYS CALLED FROM THE MAIN FORMAT PROCEDURE OR FROM   */
*         /* THE CONVERSION PROCEDURE.                               */
*         /*                                                         */
*         /* INPUT - THE CONVERSION/PRINT ARGUMENT LIST. (CVPSTRU)   */
*         /*                                                         */
*         /* OUTPUT - THE PRINTED PAGE.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1021
*LINEPRT: PROC;                                                    1021
*                                                                  1021
LINEPRT  STM   @14,@06,@SA00014                                    1021
         STM   @08,@12,@SA00014+36                                 1021
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE DATA IS TO BE RETURNED TO THE USER INSTEAD OF    */
*         /* BEING PRINTED, CALL THE LINE RETURN PROCEDURE.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1022
*         IF CVPRETP ^= NULLPTR                                    1022
*           THEN                                                   1022
         L     @06,CVPRETP                                         1022
         LTR   @06,@06                                             1022
         BZ    @RF01022                                            1022
*             DO;                                                  1023
*                                                                  1023
*               CALL LINERET;                                      1024
*                                                                  1024
         BAL   @14,LINERET                                         1024
*               FFMFMTF = OFF;                                     1025
         NI    FFMFMTF,B'11111110'                                 1025
*               PRTBUFF = ' ';                                     1026
         MVI   PRTBUFF+1,C' '                                      1026
         MVC   PRTBUFF+2(131),PRTBUFF+1                            1026
         MVI   PRTBUFF,C' '                                        1026
*               RETURN CODE(0);                                    1027
         SLR   @15,@15                                             1027
         L     @14,@SA00014                                        1027
         LM    @00,@06,@SA00014+8                                  1027
         LM    @08,@12,@SA00014+36                                 1027
         BR    @14                                                 1027
*             END;                                                 1028
*                                                                  1028
*         IF GDTDBG = NULLPTR                                      1029
*           THEN;                                                  1029
@RF01022 L     @06,GDTDBG(,GDTPR)                                  1029
         LTR   @06,@06                                             1029
         BZ    @RT01029                                            1029
*           ELSE                                                   1031
*             CALL ICKDB010 (GDTTBL,'TP3I');                       1031
*                                                                  1031
         ST    GDTPR,@AL00001                                      1031
         LA    @06,@CC00863                                        1031
         ST    @06,@AL00001+4                                      1031
         MVI   @AL00001+4,X'80'                                    1031
         L     @15,GDTDBG(,GDTPR)                                  1031
         LA    @01,@AL00001                                        1031
         BALR  @14,@15                                             1031
*         PRLINE = ' ';                 /* SET BUFFER TO BLANKS      */
@RT01029 MVI   PRLINE+1,C' '                                       1032
         MVC   PRLINE+2(118),PRLINE+1                              1032
         MVI   PRLINE,C' '                                         1032
*         PRCC = PRCCON(2);             /* CARR CONT = SINGLE SPACE  */
         MVC   PRCC(1),PRCCON+1                                    1033
*         SPFSAV = PRTSPF;              /* SAVE SPACING FACTOR       */
*                                                                  1034
         LH    SPFSAV,PRTSPF                                       1034
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE ALTERNATE PRINT FILE POINTER IS NULL AND THE     */
*         /* ALTERNATE PRINT FILE FLAG IS ON THEN THE FILES MUST BE  */
*         /* SWITCHED TO REFLECT THIS CHANGE.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1035
*         IOCSPTR=PCTIOC;                                          1035
         L     @06,PCTIOC(,PCTPTR)                                 1035
         ST    @06,IOCSPTR                                         1035
*         IF PCTIOP = NULLPTR & PCTAPF = ON                        1036
*           THEN                                                   1036
         SLR   @06,@06                                             1036
         C     @06,PCTIOP(,PCTPTR)                                 1036
         BNE   @RF01036                                            1036
         TM    PCTAPF(PCTPTR),B'00001000'                          1036
         BNO   @RF01036                                            1036
*             DO;                                                  1037
*                                                                  1037
*               /*****************************************************/
*               /*                                                   */
*               /* IF PRINT LINES ARE IN THE BUFFER, FLUSH THE STACK */
*               /* PRIOR TO CHANGING THE FILE POINTERS.              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1038
*               IF PCTLNM ^= 0                                     1038
*                 THEN                                             1038
         CH    @06,PCTLNM(,PCTPTR)                                 1038
         BE    @RF01038                                            1038
*                   DO;                                            1039
*                     FFMPSFF = ON;                                1040
*                                                                  1040
         OI    FFMPSFF,B'00100000'                                 1040
*                     CALL STACKPUT (PRCC);                        1041
*                                                                  1041
         LA    @06,PRCC                                            1041
         ST    @06,@AL00001                                        1041
         LA    @01,@AL00001                                        1041
         BAL   @14,STACKPUT                                        1041
*                     RESPECIFY RTNREG RSTD;                       1042
*                     TESTRC = RTNREG;                             1043
         STH   RTNREG,TESTRC                                       1043
*                     RESPECIFY RTNREG UNRSTD;                     1044
*                     IF TESTRC ^= 0                               1045
*                       THEN                                       1045
         LH    @06,TESTRC                                          1045
         LTR   @06,@06                                             1045
         BZ    @RF01045                                            1045
*                         RETURN CODE(RCQUIT);                     1046
         LH    @15,RCQUIT                                          1046
         L     @14,@SA00014                                        1046
         LM    @00,@06,@SA00014+8                                  1046
         LM    @08,@12,@SA00014+36                                 1046
         BR    @14                                                 1046
*                   END;                                           1047
*                                                                  1047
@RF01045 DS    0H                                                  1048
*               /*****************************************************/
*               /*                                                   */
*               /* SWITCH THE IOCS PARMS TO THE STANDARD IOCS FILE.  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1048
*               PCTLPL = PCTAPL;                                   1048
@RF01038 MVC   PCTLPL(4,PCTPTR),PCTAPL(PCTPTR)                     1048
*               PCTACT = PCTSTD;                                   1049
         MVC   PCTACT(8,PCTPTR),PCTSTD(PCTPTR)                     1049
*               PCTAPF = OFF;                                      1050
         NI    PCTAPF(PCTPTR),B'11110111'                          1050
*             END;                                                 1051
*                                                                  1051
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE ALTERNATE PRINT FILE POINTER IS NOT NULL AND THE */
*         /* ALTERNATE PRINT FILE FLAG IS OFF THEN THE FILES MUST BE */
*         /* SWITCHED TO REFLECT THIS CHANGE.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1052
*         IF PCTIOP ^= NULLPTR & PCTAPF = OFF                      1052
*           THEN                                                   1052
@RF01036 SLR   @06,@06                                             1052
         C     @06,PCTIOP(,PCTPTR)                                 1052
         BE    @RF01052                                            1052
         TM    PCTAPF(PCTPTR),B'00001000'                          1052
         BNZ   @RF01052                                            1052
*             DO;                                                  1053
*               /*****************************************************/
*               /*                                                   */
*               /* IF PRINT LINES ARE IN THE BUFFER, FLUSH THE STACK */
*               /* PRIOR TO CHANGING THE FILE POINTERS.              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1054
*               IF PCTLNM ^= 0                                     1054
*                 THEN                                             1054
         CH    @06,PCTLNM(,PCTPTR)                                 1054
         BE    @RF01054                                            1054
*                   DO;                                            1055
*                     FFMPSFF = ON;                                1056
*                                                                  1056
         OI    FFMPSFF,B'00100000'                                 1056
*                     CALL STACKPUT (PRCC);                        1057
*                                                                  1057
         LA    @06,PRCC                                            1057
         ST    @06,@AL00001                                        1057
         LA    @01,@AL00001                                        1057
         BAL   @14,STACKPUT                                        1057
*                     RESPECIFY RTNREG RSTD;                       1058
*                     TESTRC = RTNREG;                             1059
         STH   RTNREG,TESTRC                                       1059
*                     RESPECIFY RTNREG UNRSTD;                     1060
*                     IF TESTRC ^= 0                               1061
*                       THEN                                       1061
         LH    @06,TESTRC                                          1061
         LTR   @06,@06                                             1061
         BZ    @RF01061                                            1061
*                         RETURN CODE(RCQUIT);                     1062
         LH    @15,RCQUIT                                          1062
         L     @14,@SA00014                                        1062
         LM    @00,@06,@SA00014+8                                  1062
         LM    @08,@12,@SA00014+36                                 1062
         BR    @14                                                 1062
*                   END;                                           1063
*                                                                  1063
@RF01061 DS    0H                                                  1064
*               /*****************************************************/
*               /*                                                   */
*               /* SWITCH THE IOCS PARMS TO THE ALTERNATE IOCS FILE  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1064
*               PCTSTD = PCTACT;                                   1064
@RF01054 MVC   PCTSTD(8,PCTPTR),PCTACT(PCTPTR)                     1064
*               PCTACT = PCTALT;                                   1065
         MVC   PCTACT(8,PCTPTR),PCTALT(PCTPTR)                     1065
*               PCTAPF = ON;                                       1066
         OI    PCTAPF(PCTPTR),B'00001000'                          1066
*             END;                                                 1067
*                                                                  1067
*         IOCSPTR = PCTIOC;             /* SET THE IOCS POINTER.     */
@RF01052 L     @04,PCTIOC(,PCTPTR)                                 1068
         ST    @04,IOCSPTR                                         1068
*         NLISAV = PCTNLI;              /* SAVE THE NEXT LINE NUMBER */
*                                                                  1069
         LH    NLISAV,PCTNLI(,PCTPTR)                              1069
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE PREVIOUS LINE WAS A MESSAGE, ADD AN EXTRA SPACE  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1070
*         IF PRTSPT = 'R' & PCTLLM = ON & PCTPMN = 0 & QSECMF = OFF
*           THEN                                                   1070
         CLI   PRTSPT,C'R'                                         1070
         BNE   @RF01070                                            1070
         TM    PCTLLM(PCTPTR),B'00010000'                          1070
         BNO   @RF01070                                            1070
         LH    @04,PCTPMN(,PCTPTR)                                 1070
         LTR   @04,@04                                             1070
         BNZ   @RF01070                                            1070
         L     @04,QENTP                                           1070
         TM    QSECMF(@04),B'00100000'                             1070
         BNZ   @RF01070                                            1070
*             DO;                                                  1071
*               SPFSAV = SPFSAV+1;                                 1072
         AL    SPFSAV,@CF00160                                     1072
*               PCTLLM = OFF;                                      1073
         NI    PCTLLM(PCTPTR),B'11101111'                          1073
*             END;                                                 1074
*                                                                  1074
*         /***********************************************************/
*         /*                                                         */
*         /* IF THIS IS AN INITIAL HEADER CHECK FOR SPACE FOR THE    */
*         /* HEADING PLUS 1 PRINT LINE AND IF THIS MUCH SPACE IS     */
*         /* NOT LEFT ON THIS PAGE, FORCE A PAGE OVERFLOW.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1075
*         IF PCTH1F = ON & (PCTNLI + PCTHSC) > PCTLDL              1075
*           THEN                                                   1075
@RF01070 TM    PCTH1F(PCTPTR),B'10000000'                          1075
         BNO   @RF01075                                            1075
         SLR   @04,@04                                             1075
         IC    @04,PCTHSC(,PCTPTR)                                 1075
         AH    @04,PCTNLI(,PCTPTR)                                 1075
         CH    @04,PCTLDL(,PCTPTR)                                 1075
         BNH   @RF01075                                            1075
*             PCTNLI = 999;                                        1076
         MVC   PCTNLI(2,PCTPTR),@CH00865                           1076
*         /***********************************************************/
*         /*                                                         */
*         /*  CONVERT ABSOLUTE TO RELATIVE SPACING IF NEEDED         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1077
*         IF PRTSPT = 'A'                                          1077
*           THEN                                                   1077
@RF01075 CLI   PRTSPT,C'A'                                         1077
         BNE   @RF01077                                            1077
*             DO;                                                  1078
*               IF SPFSAV <= PCTLDL & SPFSAV >= PCTFDL             1079
*                 THEN                                             1079
         CH    SPFSAV,PCTLDL(,PCTPTR)                              1079
         BH    @RF01079                                            1079
         CH    SPFSAV,PCTFDL(,PCTPTR)                              1079
         BL    @RF01079                                            1079
*                   DO;                                            1080
*                     IF SPFSAV >= PCTNLI                          1081
*                       THEN                                       1081
         LH    @04,PCTNLI(,PCTPTR)                                 1081
         CR    SPFSAV,@04                                          1081
         BL    @RF01081                                            1081
*                         SPFSAV = SPFSAV + 1 - PCTNLI;            1082
         LA    @15,1                                               1082
         ALR   @15,SPFSAV                                          1082
         SLR   @15,@04                                             1082
         LR    SPFSAV,@15                                          1082
*                       ELSE                                       1083
*                         DO;                                      1083
         B     @RC01081                                            1083
@RF01081 DS    0H                                                  1084
*                           SPFSAV = 1;                            1084
         LA    SPFSAV,1                                            1084
*                           PCTNLI = 999;                          1085
         MVC   PCTNLI(2,PCTPTR),@CH00865                           1085
*                         END;                                     1086
*                   END;                                           1087
*                                                                  1087
*         /***********************************************************/
*         /*                                                         */
*         /*  ABSOLUTE LINE NUMBER IS OUT OF RANGE.                  */
*         /*  FORCE AN EJECT AND PRINT ON FIRST LINE OF NEXT PAGE.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1088
*                 ELSE                                             1088
*                   DO;                                            1088
         B     @RC01079                                            1088
@RF01079 DS    0H                                                  1089
*                     SPFSAV = 1;        /* SET SINGLE SPACE CONTROL  *
         LA    SPFSAV,1                                            1089
*                     PCTNLI = 999;     /* FORCE AN EJECT            */
         MVC   PCTNLI(2,PCTPTR),@CH00865                           1090
*                   END;                                           1091
*             END;                                                 1092
@RC01079 DS    0H                                                  1093
*         /***********************************************************/
*         /*                                                         */
*         /* TEST FOR OVERFLOW OR EJECT AND HANDLE IF NEEDED.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1093
*         IF (PCTNLI + SPFSAV) > PCTLDL  PRTSPT = 'E'             1093
*           THEN                                                   1093
@RF01077 LR    @04,SPFSAV                                          1093
         AH    @04,PCTNLI(,PCTPTR)                                 1093
         CH    @04,PCTLDL(,PCTPTR)                                 1093
         BH    @RT01093                                            1093
         CLI   PRTSPT,C'E'                                         1093
         BNE   @RF01093                                            1093
@RT01093 DS    0H                                                  1094
*OFLOOP:      DO;                                                  1094
OFLOOP   DS    0H                                                  1095
*               SPFSAV = 2;                                        1095
*                                                                  1095
         LA    SPFSAV,2                                            1095
*         /***********************************************************/
*         /*                                                         */
*         /*  WRITE THE FOOTING LINES IF THEY ARE REQUIRED           */
*         /* CURLI IS USED TO POINT TO THE CURRENT FOOTING LINE TO   */
*         /* BE PRINTED.                                             */
*         /* LINCT IS USED AS A LOOP CONTROL CELL AND IS SET         */
*         /* INITIALLY TO THE FOOTING LINE COUNT. (PCTFLC)           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1096
*               IF PCTFLC ^= 0                                     1096
*                 THEN                                             1096
         LH    @04,PCTFLC(,PCTPTR)                                 1096
         LTR   @04,@04                                             1096
         BZ    @RF01096                                            1096
*                   DO;                                            1097
*                     PRFTSP = PCTFLN + 1 - NLISAV;                1098
*                                                                  1098
         LA    PRFTSP,1                                            1098
         AH    PRFTSP,PCTFLN(,PCTPTR)                              1098
         SLR   PRFTSP,NLISAV                                       1098
*                     /***********************************************/
*                     /*                                             */
*                     /* SPACE TO THE FIRST FOOTING LINE.            */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1099
*                     PRCC = PRCCON(4);                            1099
         MVC   PRCC(1),PRCCON+3                                    1099
*                     DO WHILE PRFTSP > 3;                         1100
         B     @DE01100                                            1100
@DL01100 DS    0H                                                  1101
*                       PRFTSP = PRFTSP - 3;                       1101
*                                                                  1101
         SL    PRFTSP,@CF00131                                     1101
*                       CALL STACKPUT (PRCC);                      1102
*                                                                  1102
         LA    @06,PRCC                                            1102
         ST    @06,@AL00001                                        1102
         LA    @01,@AL00001                                        1102
         BAL   @14,STACKPUT                                        1102
*                     END;                                         1103
*                                                                  1103
@DE01100 C     PRFTSP,@CF00131                                     1103
         BH    @DL01100                                            1103
*                     /***********************************************/
*                     /*                                             */
*                     /* PRINT THE FOOTING LINES.                    */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1104
*                     TTLPT = PCTFLP;   /* SET TEMP FOOTING LINE PTR */
         L     TTLPT,PCTFLP(,PCTPTR)                               1104
*                     FLCC(1) = PRCCON(PRFTSP+ 1);                 1105
         LA    @01,PRCCON(PRFTSP)                                  1105
         MVC   FLCC(1,TTLPT),0(@01)                                1105
*                     DO LINCT = PCTFLC BY -1 TO 1;                1106
*                                                                  1106
         LH    @04,PCTFLC(,PCTPTR)                                 1106
         ST    @04,LINCT                                           1106
         B     @DE01106                                            1106
@DL01106 DS    0H                                                  1107
*                       CALL STACKPUT (FTLI);                      1107
*                                                                  1107
         ST    TTLPT,@AL00001                                      1107
         LA    @01,@AL00001                                        1107
         BAL   @14,STACKPUT                                        1107
*                       TTLPT = TTLPT + STDLWPS;                   1108
         AH    TTLPT,STDLWPS                                       1108
*                     END;                                         1109
         SLR   @04,@04                                             1109
         BCTR  @04,0                                               1109
         AL    @04,LINCT                                           1109
         ST    @04,LINCT                                           1109
@DE01106 LTR   @04,@04                                             1109
         BP    @DL01106                                            1109
*                   END;                                           1110
*                 /***************************************************/
*                 /*                                                 */
*                 /*  WRITE THE TITLE LINES REQUIRED BY THE OVER FLOW*/
*                 /* LINCT IS USED AS A LOOP CONTROL CELL AND IS SET */
*                 /* INITIALLY TO THE TITLE LINE COUNT.(PCTMLC) OR   */
*                 /* (PCTSLC)                                        */
*                 /*                                                 */
*                 /***************************************************/
*                 /*                                                 */
*                 /* WRITE THE MAIN TITLE LINES FIRST.               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1111
*                   PCTNLI = 2;         /* SET NEXT LINE NUMBER      */
@RF01096 MVC   PCTNLI(2,PCTPTR),@CH00111                           1111
*                   PCTCPN = PCTCPN + PCTPNI;                      1112
         LH    @04,PCTCPN(,PCTPTR)                                 1112
         AH    @04,PCTPNI(,PCTPTR)                                 1112
         STH   @04,PCTCPN(,PCTPTR)                                 1112
*                                       /* SET NEXT PAGE NUMBER.     */
*                                                                  1113
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET UP THE PAGE NUMBER IN THE MAIN TITLE LINE   */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1113
*                   CVDREG = PCTCPN;    /* CONVERT PAGE NUMBER       */
         LR    CVDREG,@04                                          1113
*                   GEN (CVD   CVDREG,UNPKWD);                     1114
         CVD   CVDREG,UNPKWD
*                   GEN (UNPK  MTPN,UNPKWD);                       1115
         UNPK  MTPN,UNPKWD
*                   GEN (OI    MTPN+3,X'F0');                      1116
*                                                                  1116
         OI    MTPN+3,X'F0'
*                   MTLINE(PCTPNL:PCTPNL + 4) = MTPN;              1117
         LH    @04,PCTPNL(,PCTPTR)                                 1117
         L     @01,PCTMLP(,PCTPTR)                                 1117
         ALR   @01,@04                                             1117
         BCTR  @01,0                                               1117
         MVI   MTLINE+4(@01),C' '                                  1117
         MVC   MTLINE(4,@01),MTPN                                  1117
*                                       /* MOVE PAGE NUMBER TO LINE  */
*                                                                  1118
*                   /*************************************************/
*                   /*                                               */
*                   /* SET LEADING PAGE NUMBER ZEROS TO BLANKS.      */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1118
*                   LINCT = PCTPNL;                                1118
         ST    @04,LINCT                                           1118
*                   DO N = 1 TO 3 BY 1 WHILE MTLINE(LINCT) = '0';  1119
         LA    N,1                                                 1119
@DL01119 L     @06,LINCT                                           1119
         L     @04,PCTMLP(,PCTPTR)                                 1119
         ALR   @06,@04                                             1119
         BCTR  @06,0                                               1119
         CLI   MTLINE(@06),C'0'                                    1119
         BNE   @DC01119                                            1119
*                     MTLINE(LINCT) = ' ';                         1120
         L     @06,LINCT                                           1120
         ALR   @04,@06                                             1120
         BCTR  @04,0                                               1120
         MVI   MTLINE(@04),C' '                                    1120
*                                       /* SET PRECEDING ZEROS BLANK */
*                     LINCT = LINCT +1;                            1121
         AL    @06,@CF00160                                        1121
         ST    @06,LINCT                                           1121
*                   END;                                           1122
*                                                                  1122
         AL    N,@CF00160                                          1122
         C     N,@CF00131                                          1122
         BNH   @DL01119                                            1122
@DC01119 DS    0H                                                  1123
*                   /*************************************************/
*                   /*                                               */
*                   /* PUT THE MAIN TITLE LINE TO SYSPRINT.          */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1123
*                                                                  1123
*                   CALL STACKPUT (MTLINE);                        1123
*                                                                  1123
         L     @06,PCTMLP(,PCTPTR)                                 1123
         ST    @06,@AL00001                                        1123
         LA    @01,@AL00001                                        1123
         BAL   @14,STACKPUT                                        1123
*                   RESPECIFY RTNREG RSTD;                         1124
*                   TESTRC = RTNREG;                               1125
         STH   RTNREG,TESTRC                                       1125
*                   RESPECIFY RTNREG UNRSTD;                       1126
*                   IF TESTRC ^= 0                                 1127
*                     THEN                                         1127
         LH    @06,TESTRC                                          1127
         LTR   @06,@06                                             1127
         BZ    @RF01127                                            1127
*                       RETURN CODE(RCQUIT);                       1128
*                                                                  1128
         LH    @15,RCQUIT                                          1128
         L     @14,@SA00014                                        1128
         LM    @00,@06,@SA00014+8                                  1128
         LM    @08,@12,@SA00014+36                                 1128
         BR    @14                                                 1128
*                   /*************************************************/
*                   /*                                               */
*                   /*  WRITE THE SUB TITLE LINES                    */
*                   /* THERE MAY BE FROM ONE TO THREE TITLE LINES,   */
*                   /* EACH WITH SPACING OF ONE TO THREE LINES.      */
*                   /* THIS ROUTINE WRITES THOSE LINES AND KEEPS     */
*                   /* TRACK OF THE SPACING TO DETERMINE WHAT WILL   */
*                   /* BE THE FIRST DATA LINE.                       */
*                   /* PCTSLP POINTS TO THE TITLE LINES.             */
*                   /* PCTSLC CONTAINS A COUNT OF THE NUMBER OF LINES*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1129
*                   TTLPT = PCTSLP;    /* SET TEMP SUB-TITLE PTR    */
@RF01127 L     TTLPT,PCTSLP(,PCTPTR)                               1129
*                   IF PCTSLC ^= 0                                 1130
*                     THEN                                         1130
         LH    @04,PCTSLC(,PCTPTR)                                 1130
         LTR   @04,@04                                             1130
         BZ    @RF01130                                            1130
*                       /*********************************************/
*                       /*                                           */
*                       /* COMPUTE THE LINE SPACE FOR EACH           */
*                       /* SUB-TITLE LINE FOR LOCATION OF FIRST DATA */
*                       /* LINE.                                     */
*                       /*                                           */
*                       /*********************************************/
*                                                                  1131
*                       DO LINCT = 1 TO PCTSLC;                    1131
         LA    @04,1                                               1131
         B     @DE01131                                            1131
@DL01131 DS    0H                                                  1132
*                         IF STLCC = ' '                           1132
*                           THEN       /* FIGURE LINE SPACING.       */
         CLI   STLCC(TTLPT),64                                     1132
         BNE   @RF01132                                            1132
*                             PCTNLI = PCTNLI + 1;                 1133
         LA    @04,1                                               1133
         AH    @04,PCTNLI(,PCTPTR)                                 1133
         STH   @04,PCTNLI(,PCTPTR)                                 1133
*                         IF STLCC = '0'                           1134
*                           THEN                                   1134
@RF01132 CLI   STLCC(TTLPT),240                                    1134
         BNE   @RF01134                                            1134
*                             PCTNLI = PCTNLI + 2;                 1135
         LA    @04,2                                               1135
         AH    @04,PCTNLI(,PCTPTR)                                 1135
         STH   @04,PCTNLI(,PCTPTR)                                 1135
*                         IF STLCC = '-'                           1136
*                           THEN                                   1136
@RF01134 CLI   STLCC(TTLPT),96                                     1136
         BNE   @RF01136                                            1136
*                             PCTNLI = PCTNLI + 3;                 1137
*                                                                  1137
         LA    @04,3                                               1137
         AH    @04,PCTNLI(,PCTPTR)                                 1137
         STH   @04,PCTNLI(,PCTPTR)                                 1137
*                       /*********************************************/
*                       /*                                           */
*                       /* PUT THE SUB-TITLE LINE TO SYSPRINT.       */
*                       /*                                           */
*                       /*********************************************/
*                                                                  1138
*                         CALL STACKPUT (STLINE);                  1138
*                                                                  1138
@RF01136 ST    TTLPT,@AL00001                                      1138
         LA    @01,@AL00001                                        1138
         BAL   @14,STACKPUT                                        1138
*                         RESPECIFY RTNREG RSTD;                   1139
*                         TESTRC = RTNREG;                         1140
         STH   RTNREG,TESTRC                                       1140
*                         RESPECIFY RTNREG UNRSTD;                 1141
*                         IF TESTRC ^= 0                           1142
*                           THEN                                   1142
         LH    @04,TESTRC                                          1142
         LTR   @04,@04                                             1142
         BZ    @RF01142                                            1142
*                             RETURN CODE(RCQUIT);                 1143
         LH    @15,RCQUIT                                          1143
         L     @14,@SA00014                                        1143
         LM    @00,@06,@SA00014+8                                  1143
         LM    @08,@12,@SA00014+36                                 1143
         BR    @14                                                 1143
*                         TTLPT = TTLPT + STDLWPS;                 1144
@RF01142 AH    TTLPT,STDLWPS                                       1144
*                                       /* STEP TO NEXT LINE.        */
*                       END;                                       1145
         LA    @04,1                                               1145
         AL    @04,LINCT                                           1145
@DE01131 ST    @04,LINCT                                           1145
         CH    @04,PCTSLC(,PCTPTR)                                 1145
         BNH   @DL01131                                            1145
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF HEADINGS ARE TO BE PRINTED, DO IT HERE.      */
*                 /* HEADING LINES ARE KEPT IN A QUEUE ANCHORED ON   */
*                 /* PCTAHP.  IF PCTHAF IS ON AND PCTH1F IS OFF      */
*                 /* DURING PAGE OVERFLOW, ALL HEADING LINES IN THE  */
*                 /* QUEUE ARE PRINTED.                              */
*                 /* PCTHAF INDICATES A HEADING IS ACTIVE.           */
*                 /* PCTH1F INDICATES THE CURRENT LINE IS THE FIRST  */
*                 /*        LINE OF A NEW HEADING SET.               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1146
*                 IF PCTHAF = ON & PCTH1F = OFF                    1146
*                   THEN                                           1146
@RF01130 TM    PCTHAF(PCTPTR),B'00100000'                          1146
         BNO   @RF01146                                            1146
         TM    PCTH1F(PCTPTR),B'10000000'                          1146
         BNZ   @RF01146                                            1146
*                     DO;                                          1147
*                       HEADPTR = PCTAHP;                          1148
         L     @06,PCTAHP(,PCTPTR)                                 1148
         ST    @06,HEADPTR                                         1148
*                       DO WHILE HEADPTR > 0;                      1149
*                                                                  1149
         B     @DE01149                                            1149
@DL01149 DS    0H                                                  1150
*                         /*******************************************/
*                         /*                                         */
*                         /* COMPUTE THE LINE SPACE FOR EACH         */
*                         /* HEADING LINE FOR LOCATION OF THE FIRST  */
*                         /* DATA LINE.                              */
*                         /*                                         */
*                         /*******************************************/
*                                                                  1150
*                         IF HEADCC = ' '                          1150
*                           THEN                                   1150
         L     @06,HEADPTR                                         1150
         CLI   HEADCC(@06),C' '                                    1150
         BNE   @RF01150                                            1150
*                             PCTNLI = PCTNLI + 1;                 1151
         LA    @06,1                                               1151
         AH    @06,PCTNLI(,PCTPTR)                                 1151
         STH   @06,PCTNLI(,PCTPTR)                                 1151
*                         IF HEADCC = '0'                          1152
*                           THEN                                   1152
@RF01150 L     @06,HEADPTR                                         1152
         CLI   HEADCC(@06),C'0'                                    1152
         BNE   @RF01152                                            1152
*                             PCTNLI = PCTNLI + 2;                 1153
         LA    @06,2                                               1153
         AH    @06,PCTNLI(,PCTPTR)                                 1153
         STH   @06,PCTNLI(,PCTPTR)                                 1153
*                         IF HEADCC = '-'                          1154
*                           THEN                                   1154
@RF01152 L     @06,HEADPTR                                         1154
         CLI   HEADCC(@06),C'-'                                    1154
         BNE   @RF01154                                            1154
*                             PCTNLI = PCTNLI + 3;                 1155
*                                                                  1155
         LA    @06,3                                               1155
         AH    @06,PCTNLI(,PCTPTR)                                 1155
         STH   @06,PCTNLI(,PCTPTR)                                 1155
*                         /*******************************************/
*                         /*                                         */
*                         /* WRITE THE HEADING LINES.                */
*                         /*                                         */
*                         /*******************************************/
*                                                                  1156
*                         CALL STACKPUT (HEADCC);                  1156
*                                                                  1156
@RF01154 L     @06,HEADPTR                                         1156
         LA    @06,HEADCC(,@06)                                    1156
         ST    @06,@AL00001                                        1156
         LA    @01,@AL00001                                        1156
         BAL   @14,STACKPUT                                        1156
*                         RESPECIFY RTNREG RSTD;                   1157
*                         TESTRC = RTNREG;                         1158
         STH   RTNREG,TESTRC                                       1158
*                         RESPECIFY RTNREG UNRSTD;                 1159
*                         IF TESTRC ^= 0                           1160
*                           THEN                                   1160
         LH    @06,TESTRC                                          1160
         LTR   @06,@06                                             1160
         BZ    @RF01160                                            1160
*                             RETURN CODE(RCQUIT);                 1161
         LH    @15,RCQUIT                                          1161
         L     @14,@SA00014                                        1161
         LM    @00,@06,@SA00014+8                                  1161
         LM    @08,@12,@SA00014+36                                 1161
         BR    @14                                                 1161
*                         HEADPTR = HEADQP;                        1162
@RF01160 L     @06,HEADPTR                                         1162
         L     @06,HEADQP(,@06)                                    1162
         ST    @06,HEADPTR                                         1162
*                                       /* STEP HEADER LINE PTR.     */
*                       END;                                       1163
@DE01149 L     @06,HEADPTR                                         1163
         LTR   @06,@06                                             1163
         BP    @DL01149                                            1163
*                     END;                                         1164
*                                                                  1164
*             END OFLOOP;                                          1165
@RF01146 DS    0H                                                  1166
*         /***********************************************************/
*         /*                                                         */
*         /*  DO THE REQUIRED SPACING FOR THE LINE TO BE PRINTED     */
*         /*  SET UP TRIPLE LINE SPACES TO GET TO THE REQUIRED LINE  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1166
*         PRCC = PRCCON(4);             /* SET TRIPLE SPACE CHAR     */
@RF01093 MVC   PRCC(1),PRCCON+3                                    1166
*         DO WHILE SPFSAV > 3;                                     1167
         B     @DE01167                                            1167
@DL01167 DS    0H                                                  1168
*           PCTNLI = PCTNLI + 3;        /* ADVANCE LINE COUNT        */
         LA    @06,3                                               1168
         LH    @04,PCTNLI(,PCTPTR)                                 1168
         ALR   @04,@06                                             1168
         STH   @04,PCTNLI(,PCTPTR)                                 1168
*           SPFSAV = SPFSAV - 3;        /* REDUCE REQUEST COUNT      */
*                                                                  1169
         SLR   SPFSAV,@06                                          1169
*           CALL STACKPUT (PRCC);                                  1170
*                                                                  1170
         LA    @06,PRCC                                            1170
         ST    @06,@AL00001                                        1170
         LA    @01,@AL00001                                        1170
         BAL   @14,STACKPUT                                        1170
*           RESPECIFY RTNREG RSTD;                                 1171
*           TESTRC = RTNREG;                                       1172
         STH   RTNREG,TESTRC                                       1172
*           RESPECIFY RTNREG UNRSTD;                               1173
*           IF TESTRC ^= 0                                         1174
*             THEN                                                 1174
         LH    @06,TESTRC                                          1174
         LTR   @06,@06                                             1174
         BZ    @RF01174                                            1174
*               RETURN CODE(RCQUIT);                               1175
         LH    @15,RCQUIT                                          1175
         L     @14,@SA00014                                        1175
         LM    @00,@06,@SA00014+8                                  1175
         LM    @08,@12,@SA00014+36                                 1175
         BR    @14                                                 1175
*         END;                                                     1176
*                                                                  1176
@RF01174 DS    0H                                                  1176
@DE01167 C     SPFSAV,@CF00131                                     1176
         BH    @DL01167                                            1176
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE AND TRANSLATE THIS DATA LINE                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1177
*         PRCC = PRCCON(SPFSAV+1);      /* SET PROPER SPACE CHAR     */
         LA    @06,PRCCON(SPFSAV)                                  1177
         MVC   PRCC(1),0(@06)                                      1177
*         IF PCTPMN ^= 0                                           1178
*           THEN                                                   1178
         LH    @06,PCTPMN(,PCTPTR)                                 1178
         LTR   @06,@06                                             1178
         BZ    @RF01178                                            1178
*               PRLINE(1:72) = PRTBUFF;                            1179
         MVC   PRLINE(72),PRTBUFF                                  1179
*           ELSE                                                   1180
*               PRLINE = PRTBUFF;       /* MOVE LINE FOR PRINT       */
*                                                                  1180
         B     @RC01178                                            1180
@RF01178 MVC   PRLINE(120),PRTBUFF                                 1180
*         CVDREG = PCTTRP;              /* GET TRANSLATE TABLE ADDR. */
@RC01178 L     CVDREG,PCTTRP(,PCTPTR)                              1181
*GENERATE (TR    PRLINE,0(CVDREG));     /* TRANSLATE THE LINE        */
*                                                                  1182
         TR    PRLINE,0(CVDREG)
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE ARGUMENTS FOR THE ADAPTER.                   */
*         /* THEN PRINT THIS LINE.                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1183
*         CALL STACKPUT (PRCC);                                    1183
*                                                                  1183
         LA    @06,PRCC                                            1183
         ST    @06,@AL00001                                        1183
         LA    @01,@AL00001                                        1183
         BAL   @14,STACKPUT                                        1183
*         RESPECIFY RTNREG RSTD;                                   1184
*         TESTRC = RTNREG;                                         1185
         STH   RTNREG,TESTRC                                       1185
*         RESPECIFY RTNREG UNRSTD;                                 1186
*         IF TESTRC ^= 0                                           1187
*           THEN                                                   1187
         LH    @06,TESTRC                                          1187
         LTR   @06,@06                                             1187
         BZ    @RF01187                                            1187
*             RETURN CODE(RCQUIT);                                 1188
         LH    @15,RCQUIT                                          1188
         L     @14,@SA00014                                        1188
         LM    @00,@06,@SA00014+8                                  1188
         LM    @08,@12,@SA00014+36                                 1188
         BR    @14                                                 1188
*         PCTPMN = 0;                                              1189
@RF01187 SLR   @06,@06                                             1189
         STH   @06,PCTPMN(,PCTPTR)                                 1189
*         PCTNLI = PCTNLI + SPFSAV;                                1190
*                                                                  1190
         LR    @06,SPFSAV                                          1190
         AH    @06,PCTNLI(,PCTPTR)                                 1190
         STH   @06,PCTNLI(,PCTPTR)                                 1190
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE LINE JUST PRINTED WAS A NEW HEADING LINE, SET IT */
*         /* UP IN THE HEADER QUEUE HERE.  THE CORE FOR THIS QUEUE   */
*         /* IS OBTAINED FROM POOL 'TP03'.  IF THERE WAS A PREVIOUS  */
*         /* HEADER, ITS CORE IS FREED PRIOR TO GETTING CORE FOR     */
*         /* THIS HEADER.  ALL HEADER CORE IS FREED WHEN A RESET IS  */
*         /* ISSUED AT ANY TIME.                                     */
*         /* PCTHAF IS A FLAG INDICATING THAT A HEADER IS ACTIVE.    */
*         /* PCTH1F IS A FLAG INDICATING THAT THE CURRENT LINE       */
*         /*        IS THE FIRST OF A NEW SERIES OF HEADER LINES.    */
*         /* PCTH2F IS A FLAG INDICATING THAT THE CURRENT LINE IS A  */
*         /*        CONTINUATION LINE OF A SET OF HEADERS BEING      */
*         /*        ENTERED.                                         */
*         /* PCTAHP IS THE ANCHOR POINT FOR THE HEADER QUEUE IN THE  */
*         /*        PRINT CONTROL TABLE.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1191
*         /***********************************************************/
*         /*                                                         */
*         /* IF A HEADING EXISTS AND THIS LINE IS A NEW ONE, FREE    */
*         /* THE POOL SPACE FOR THE EXISTING HEADER.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1191
*         IF PCTH1F = ON & PCTHAF = ON                             1191
*           THEN                                                   1191
         TM    PCTH1F(PCTPTR),B'10100000'                          1191
         BNO   @RF01191                                            1191
*             DO;                                                  1192
*                                                                  1192
*               CALL ICKSAFP0 (GDTTBL,HDPOOL);                     1193
*                                                                  1193
         ST    GDTPR,@AL00001                                      1193
         LA    @06,HDPOOL                                          1193
         ST    @06,@AL00001+4                                      1193
         MVI   @AL00001+4,X'80'                                    1193
         L     @15,GDTFPL(,GDTPR)                                  1193
         LA    @01,@AL00001                                        1193
         BALR  @14,@15                                             1193
*               PCTAHP = ''B;                                      1194
         SLR   @06,@06                                             1194
         ST    @06,PCTAHP(,PCTPTR)                                 1194
*             END;                                                 1195
*                                                                  1195
*         /***********************************************************/
*         /*                                                         */
*         /* GET THE POOL STORAGE FOR THE NEW HEADER LINE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1196
*         IF PCTH1F = ON  PCTH2F = ON                             1196
*           THEN                                                   1196
@RF01191 TM    PCTH1F(PCTPTR),B'11000000'                          1196
         BZ    @RF01196                                            1196
*             DO;                                                  1197
*               CURLI = PCTPLW + 4;                                1198
*                                                                  1198
         LA    @06,4                                               1198
         AL    @06,PCTPLW(,PCTPTR)                                 1198
         ST    @06,CURLI                                           1198
*               CALL ICKSAGP0 (GDTTBL,CURLI,HEADPTR,HDPOOL,SETZERO);
         ST    GDTPR,@AL00001                                      1199
         LA    @06,CURLI                                           1199
         ST    @06,@AL00001+4                                      1199
         LA    @06,HEADPTR                                         1199
         ST    @06,@AL00001+8                                      1199
         LA    @06,HDPOOL                                          1199
         ST    @06,@AL00001+12                                     1199
         LA    @06,@CC00140                                        1199
         ST    @06,@AL00001+16                                     1199
         MVI   @AL00001+16,X'80'                                   1199
         L     @15,GDTGPL(,GDTPR)                                  1199
         LA    @01,@AL00001                                        1199
         BALR  @14,@15                                             1199
*                                       /* GET THE POOL CORE.        */
*                                                                  1200
*               RESPECIFY RTNREG RSTD;                             1200
*               TESTRC = RTNREG;                                   1201
         STH   RTNREG,TESTRC                                       1201
*               RESPECIFY RTNREG UNRSTD;                           1202
*                 IF TESTRC ^= 0                                   1203
*                   THEN                                           1203
*                                                                  1203
         LH    @06,TESTRC                                          1203
         LTR   @06,@06                                             1203
         BZ    @RF01203                                            1203
*                     DO;                                          1204
*                       RESPECIFY(REG13,REG14,REG15) RSTD;         1205
*                       REG15 = 28;                                1206
         LA    REG15,28                                            1206
*                       REG14 = GDTABT;                            1207
         L     REG14,GDTABT(,GDTPR)                                1207
*                       REG13 = GDTABH;                            1208
         L     REG13,GDTABH(,GDTPR)                                1208
*                       GEN(BR    REG14);                          1209
         BR    REG14
*                       RESPECIFY(REG13,REG14,REG15)UNRSTD;        1210
*                     END;                                         1211
*                                                                  1211
*               IF PCTH1F = ON                                     1212
*                 THEN                                             1212
*                                                                  1212
@RF01203 TM    PCTH1F(PCTPTR),B'10000000'                          1212
         BNO   @RF01212                                            1212
*                 /***************************************************/
*                 /*                                                 */
*                 /* INITIALIZE A NEW HEADER QUEUE.                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1213
*                   DO;                                            1213
*                     PCTAHP = HEADPTR;                            1214
         L     @06,HEADPTR                                         1214
         ST    @06,PCTAHP(,PCTPTR)                                 1214
*                     HEADCC = PRCCON(3);                          1215
         MVC   HEADCC(1,@06),PRCCON+2                              1215
*                   END;                                           1216
*               IF PCTH2F = ON                                     1217
*                 THEN                                             1217
@RF01212 TM    PCTH2F(PCTPTR),B'01000000'                          1217
         BNO   @RF01217                                            1217
*                 /***************************************************/
*                 /*                                                 */
*                 /* ADD A NEW LINE TO THE HEADER QUEUE.             */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1218
*                   DO;                                            1218
*                     IF PCTAHP = NULLPTR                          1219
*                       THEN                                       1219
         L     @06,PCTAHP(,PCTPTR)                                 1219
         LTR   @06,@06                                             1219
         BNZ   @RF01219                                            1219
*                         DO;                                      1220
*                           /*****************************************/
*                           /*                                       */
*                           /* WE ARE PART WAY THROUGH A HEADING     */
*                           /* WITH A RESET HAVING BEEN ISSUED.      */
*                           /* RETURN WITH CONDITION 12.             */
*                           /*                                       */
*                           /*****************************************/
*                                                                  1221
*                           PCTH2F = OFF;                          1221
*                           PCTHAF = OFF;                          1222
         NI    PCTH2F(PCTPTR),B'10011111'                          1222
*                           PCTHLC = ''B;                          1223
         SLR   @06,@06                                             1223
         STC   @06,PCTHLC(,PCTPTR)                                 1223
*                           PCTHSC = ''B;                          1224
         SLR   @06,@06                                             1224
         STC   @06,PCTHSC(,PCTPTR)                                 1224
*                           RETURN CODE(RCQUIT);                   1225
         LH    @15,RCQUIT                                          1225
         L     @14,@SA00014                                        1225
         LM    @00,@06,@SA00014+8                                  1225
         LM    @08,@12,@SA00014+36                                 1225
         BR    @14                                                 1225
*                         END;                                     1226
*                     HDQPTR = PCTAHP;                             1227
@RF01219 L     @06,PCTAHP(,PCTPTR)                                 1227
         ST    @06,HDQPTR                                          1227
*                     DO WHILE HDQPTR->HEADQP ^= NULLPTR;          1228
         B     @DE01228                                            1228
@DL01228 DS    0H                                                  1229
*                       HDQPTR = HDQPTR->HEADQP;                   1229
         L     @06,HDQPTR                                          1229
         L     @06,HEADQP(,@06)                                    1229
         ST    @06,HDQPTR                                          1229
*                     END;                                         1230
@DE01228 L     @06,HDQPTR                                          1230
         L     @04,HEADQP(,@06)                                    1230
         LTR   @04,@04                                             1230
         BNZ   @DL01228                                            1230
*                     HDQPTR->HEADQP = HEADPTR;                    1231
         L     @04,HEADPTR                                         1231
         ST    @04,HEADQP(,@06)                                    1231
*                     HEADCC = PRCC;                               1232
         MVC   HEADCC(1,@04),PRCC                                  1232
*                   END;                                           1233
*                                                                  1233
*               /*****************************************************/
*               /*                                                   */
*               /* THIS STATEMENT MOVES ALL HEADING LINES TO THE     */
*               /* SPACE AQUIRED FOR THEM.                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1234
*               HEADLI(1:PCTPLW) = PRLINE(1:PCTPLW);               1234
*                                                                  1234
@RF01217 L     @06,HEADPTR                                         1234
         L     @04,PCTPLW(,PCTPTR)                                 1234
         BCTR  @04,0                                               1234
         EX    @04,@SM00934                                        1234
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK IF THIS IS THE LAST OF THE SET AND SET      */
*               /* FLAGS ACCORDINGLY.                                */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1235
*               PCTHLC = PCTHLC - 1;                               1235
         SLR   @06,@06                                             1235
         IC    @06,PCTHLC(,PCTPTR)                                 1235
         BCTR  @06,0                                               1235
         STC   @06,PCTHLC(,PCTPTR)                                 1235
*               PCTH1F = OFF;                                      1236
         NI    PCTH1F(PCTPTR),B'01111111'                          1236
*               IF PCTHLC > 0                                      1237
*                 THEN                                             1237
         CLI   PCTHLC(PCTPTR),0                                    1237
         BNH   @RF01237                                            1237
*                    PCTH2F = ON;                                  1238
         OI    PCTH2F(PCTPTR),B'01000000'                          1238
*                  ELSE                                            1239
*                    PCTH2F = OFF;                                 1239
         B     @RC01237                                            1239
@RF01237 NI    PCTH2F(PCTPTR),B'10111111'                          1239
*               PCTHAF = ON;                                       1240
@RC01237 OI    PCTHAF(PCTPTR),B'00100000'                          1240
*             END;                                                 1241
*                                                                  1241
*         IF GDTDBG = NULLPTR                                      1242
*           THEN;                                                  1242
@RF01196 L     @06,GDTDBG(,GDTPR)                                  1242
         LTR   @06,@06                                             1242
         BZ    @RT01242                                            1242
*           ELSE                                                   1244
*             CALL ICKDB010 (GDTTBL,'TP3N');                       1244
*                                                                  1244
         ST    GDTPR,@AL00001                                      1244
         LA    @06,@CC00871                                        1244
         ST    @06,@AL00001+4                                      1244
         MVI   @AL00001+4,X'80'                                    1244
         L     @15,GDTDBG(,GDTPR)                                  1244
         LA    @01,@AL00001                                        1244
         BALR  @14,@15                                             1244
*         FFMFMTF = OFF;                                           1245
@RT01242 NI    FFMFMTF,B'11111110'                                 1245
*         PRTBUFF = ' ';                                           1246
         MVI   PRTBUFF+1,C' '                                      1246
         MVC   PRTBUFF+2(131),PRTBUFF+1                            1246
         MVI   PRTBUFF,C' '                                        1246
*         RETURN CODE(TESTRC);                                     1247
*                                                                  1247
         LH    @15,TESTRC                                          1247
         L     @14,@SA00014                                        1247
         LM    @00,@06,@SA00014+8                                  1247
         LM    @08,@12,@SA00014+36                                 1247
         BR    @14                                                 1247
*         END LINEPRT;                                             1248
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - LINE STACKING AND UPUT PROCEDURE.      */
*         /*                                                         */
*         /* FUNCTION - PUT THE PRINT LINES INTO THE OUTPUT BUFFER.  */
*         /*     A UPUT IS ISSUED FOR THIS BUFFER WHEN THE BUFFER    */
*         /*     IS FULL OR WHEN THE NEXT LINE TO BE PRINTED IS A    */
*         /*     MESSAGE.  THIS BUFFER IS NORMALLY 2048 BYTES LONG   */
*         /*     BUT MAY BE CHANGED BY ALTERING THE CONSTANT PRBUFL  */
*         /*     BOTH HERE AND IN THE MODULE ICKTP04.                */
*         /*     IF THE FLAG FFMPSFF IS ON, THERE IS NO LINE TO BE   */
*         /*     ADDED BUT THE STACK IS TO BE PRINTED OUT.           */
*         /*                                                         */
*         /* INPUT - A LINE WIDTH BYTE AREA CONTAINING THE CARRIAGE  */
*         /*     CONTROL CHARACTER AND THE DATA LINE.                */
*         /*                                                         */
*         /* OUTPUT - PRINT LINES TO THE IO ADAPTOR.                 */
*         /*     AS LINES ARE PUT INTO THE BUFFER OR IN THE CASE OF  */
*         /*     MESSAGES, AS THEY ARE PUT DIRECTLY TO THE IO        */
*         /*     ADAPTOR, TRAILING BLANKS ARE STRIPPED TO A MINIMUM  */
*         /*     A 1 BYTE DATA LINE PLUS THE CARRIAGE CONTROL        */
*         /*     CHARACTER.                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1249
*STACKPUT: PROC (PUTLINE);                                         1249
*                                                                  1249
STACKPUT STM   @14,@06,@SA00015                                    1249
         STM   @08,@12,@SA00015+36                                 1249
         MVC   @PC00015(4),0(@01)                                  1249
*         DCL PUTLINE CHAR(121);       /* INPUT ARGUMENT (DATA LINE) */
*                                                                  1250
*         /***********************************************************/
*         /*                                                         */
*         /* LOCATE AND STRIP THE TRAILING BLANKS                    */
*         /* IF A LINE IS TO BE ADDED OR PRINTED.  (FFMPSFF OFF)     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1251
*         IF FFMPSFF = OFF                                         1251
*           THEN                                                   1251
         TM    FFMPSFF,B'00100000'                                 1251
         BNZ   @RF01251                                            1251
*               DO N = (PCTPLW + 1) TO 10 BY -1 WHILE PUTLINE(N) = ' ';
*                                                                  1252
         LA    N,1                                                 1252
         AL    N,PCTPLW(,PCTPTR)                                   1252
         B     @DE01252                                            1252
@DL01252 L     @06,@PC00015                                        1252
         ALR   @06,N                                               1252
         BCTR  @06,0                                               1252
         CLI   PUTLINE(@06),C' '                                   1252
         BNE   @DC01252                                            1252
*               END;                                               1253
*                                                                  1253
         BCTR  N,0                                                 1253
@DE01252 C     N,@CF00032                                          1253
         BNL   @DL01252                                            1253
@DC01252 DS    0H                                                  1254
*         /***********************************************************/
*         /*                                                         */
*         /* IF LINES ARE IN THE STACK AND IF THE STACK IS FULL OR   */
*         /* THE CURRENT LINE IS A MESSAGE, OR THE FLUSH FLAG IS ON  */
*         /* PUT THE STACK TO THE IO ADAPTOR.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1254
*         IF PCTLNM ^= 0 & ((PCTBNL + (N+2) > (PCTBUF + PRBUFL))   1254
*            FFMPMSF = ON                                         1254
*            FFMPSFF = ON)                                        1254
*           THEN                                                   1254
@RF01251 LH    @06,PCTLNM(,PCTPTR)                                 1254
         LTR   @06,@06                                             1254
         BZ    @RF01254                                            1254
         LA    @06,2                                               1254
         ALR   @06,N                                               1254
         AL    @06,PCTBNL(,PCTPTR)                                 1254
         LH    @04,PRBUFL                                          1254
         AL    @04,PCTBUF(,PCTPTR)                                 1254
         CR    @06,@04                                             1254
         BH    @RT01254                                            1254
         TM    FFMPMSF,B'00110000'                                 1254
         BZ    @RF01254                                            1254
@RT01254 DS    0H                                                  1255
*             DO;                                                  1255
*               IOCDLN = PCTBNL - PCTBUF;                          1256
         L     @06,IOCSPTR                                         1256
         L     @04,PCTBUF(,PCTPTR)                                 1256
         L     @03,PCTBNL(,PCTPTR)                                 1256
         SLR   @03,@04                                             1256
         ST    @03,IOCDLN(,@06)                                    1256
*               IOCDAD = PCTBUF;                                   1257
         ST    @04,IOCDAD(,@06)                                    1257
*               IOCPNM = PCTLNM;                                   1258
         LH    @03,PCTLNM(,PCTPTR)                                 1258
         STH   @03,IOCPNM(,@06)                                    1258
*               PCTBNL = PCTBUF;                                   1259
         ST    @04,PCTBNL(,PCTPTR)                                 1259
*               PCTLNM = 0;                                        1260
*                                                                  1260
         SLR   @06,@06                                             1260
         STH   @06,PCTLNM(,PCTPTR)                                 1260
*               CALL ICKIOPT0 (GDTTBL,PCTIOC,NULLPMN);             1261
*                                                                  1261
         ST    GDTPR,@AL00001                                      1261
         LA    @06,PCTIOC(,PCTPTR)                                 1261
         ST    @06,@AL00001+4                                      1261
         LA    @06,NULLPMN                                         1261
         ST    @06,@AL00001+8                                      1261
         MVI   @AL00001+8,X'80'                                    1261
         L     @15,GDTPUT(,GDTPR)                                  1261
         LA    @01,@AL00001                                        1261
         BALR  @14,@15                                             1261
*               RESPECIFY RTNREG RSTD;                             1262
*               TESTRC = RTNREG;                                   1263
         STH   RTNREG,TESTRC                                       1263
*               RESPECIFY RTNREG UNRSTD;                           1264
*               IF TESTRC ^= 0                                     1265
*                 THEN                                             1265
*                                                                  1265
         LH    @06,TESTRC                                          1265
         LTR   @06,@06                                             1265
         BZ    @RF01265                                            1265
*                   DO;                                            1266
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           1267
*                     REG15 = 36;                                  1268
         LA    REG15,36                                            1268
*                     REG14 = GDTABT;                              1269
         L     REG14,GDTABT(,GDTPR)                                1269
*                     REG13 = GDTABH;                              1270
         L     REG13,GDTABH(,GDTPR)                                1270
*                     GEN(BR    REG14);                            1271
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          1272
*                   END;                                           1273
*                                                                  1273
*             END;                                                 1274
*                                                                  1274
*                                                                  1274
@RF01265 DS    0H                                                  1275
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE CURRENT LINE IS A MESSAGE, PUT IT DIRECTLY.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1275
*         IF FFMPMSF = ON & FFMPSFF = OFF                          1275
*           THEN                                                   1275
@RF01254 TM    FFMPMSF,B'00010000'                                 1275
         BNO   @RF01275                                            1275
         TM    FFMPSFF,B'00100000'                                 1275
         BNZ   @RF01275                                            1275
*             DO;                                                  1276
*               IOCDLN = N;                                        1277
         L     @06,IOCSPTR                                         1277
         ST    N,IOCDLN(,@06)                                      1277
*               IOCDAD = ADDR(PUTLINE);                            1278
         L     @04,@PC00015                                        1278
         ST    @04,IOCDAD(,@06)                                    1278
*               IOCPNM = ''B;                                      1279
*                                                                  1279
         SLR   @04,@04                                             1279
         STH   @04,IOCPNM(,@06)                                    1279
*               CALL ICKIOPT0 (GDTTBL,PCTIOC,PCTPMN);              1280
*                                                                  1280
         ST    GDTPR,@AL00001                                      1280
         LA    @06,PCTIOC(,PCTPTR)                                 1280
         ST    @06,@AL00001+4                                      1280
         LA    @06,PCTPMN(,PCTPTR)                                 1280
         ST    @06,@AL00001+8                                      1280
         MVI   @AL00001+8,X'80'                                    1280
         L     @15,GDTPUT(,GDTPR)                                  1280
         LA    @01,@AL00001                                        1280
         BALR  @14,@15                                             1280
*               RESPECIFY RTNREG RSTD;                             1281
*               TESTRC = RTNREG;                                   1282
         STH   RTNREG,TESTRC                                       1282
*               RESPECIFY RTNREG UNRSTD;                           1283
*               IF TESTRC ^= 0                                     1284
*                 THEN                                             1284
*                                                                  1284
         LH    @06,TESTRC                                          1284
         LTR   @06,@06                                             1284
         BZ    @RF01284                                            1284
*                   DO;                                            1285
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           1286
*                     REG15 = 36;                                  1287
         LA    REG15,36                                            1287
*                     REG14 = GDTABT;                              1288
         L     REG14,GDTABT(,GDTPR)                                1288
*                     REG13 = GDTABH;                              1289
         L     REG13,GDTABH(,GDTPR)                                1289
*                     GEN(BR    REG14);                            1290
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          1291
*                   END;                                           1292
*                                                                  1292
*               PCTPMN = ''B;                                      1293
@RF01284 SLR   @06,@06                                             1293
         STH   @06,PCTPMN(,PCTPTR)                                 1293
*               PCTLLM = ON;                                       1294
*                                                                  1294
         OI    PCTLLM(PCTPTR),B'00010000'                          1294
*               RETURN CODE(0);                                    1295
*                                                                  1295
         SLR   @15,@15                                             1295
         L     @14,@SA00015                                        1295
         LM    @00,@06,@SA00015+8                                  1295
         LM    @08,@12,@SA00015+36                                 1295
         BR    @14                                                 1295
*             END;                                                 1296
*         /***********************************************************/
*         /*                                                         */
*         /* PUT THIS CURRENT LINE IN THE STACK.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1297
*         IF FFMPSFF = OFF                                         1297
*           THEN                                                   1297
@RF01275 TM    FFMPSFF,B'00100000'                                 1297
         BNZ   @RF01297                                            1297
*             DO;                                                  1298
*               STACKLL = N;                                       1299
         L     @06,PCTBNL(,PCTPTR)                                 1299
         STCM  N,3,STACKLL(@06)                                    1299
*               STACKDL(1:N) = PUTLINE(1:N);                       1300
         LR    @04,N                                               1300
         BCTR  @04,0                                               1300
         L     @03,@PC00015                                        1300
         EX    @04,@SM00936                                        1300
*               PCTLNM = PCTLNM + 1;                               1301
         LA    @04,1                                               1301
         AH    @04,PCTLNM(,PCTPTR)                                 1301
         STH   @04,PCTLNM(,PCTPTR)                                 1301
*               PCTBNL = PCTBNL + N + 2;                           1302
         ALR   @06,N                                               1302
         AL    @06,@CF00111                                        1302
         ST    @06,PCTBNL(,PCTPTR)                                 1302
*             END;                                                 1303
*         FFMPSFF = OFF;                                           1304
*                                                                  1304
@RF01297 NI    FFMPSFF,B'11011111'                                 1304
*         RETURN CODE(0);                                          1305
*                                                                  1305
         SLR   @15,@15                                             1305
         L     @14,@SA00015                                        1305
         LM    @00,@06,@SA00015+8                                  1305
         LM    @08,@12,@SA00015+36                                 1305
         BR    @14                                                 1305
*         END STACKPUT;                                            1306
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - ERROR PROCEDURE.                       */
*         /*                                                         */
*         /* FUNCTION - CAUSE THE PRINTING OF TP ERROR MESSAGES.     */
*         /*                                                         */
*         /* INPUT - A CODE INDICATING THE ERROR MESSAGE TO BE PUT.  */
*         /*                                                         */
*         /* OUTPUT - A TEXT PROCESSING ERROR MESSAGE.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1307
*ERROR:   PROC (ERRCODE);                                          1307
*                                                                  1307
ERROR    STM   @14,@06,@SA00016                                    1307
         STM   @08,@12,@SA00016+36                                 1307
         MVC   @PC00016(4),0(@01)                                  1307
*         DCL CVPSAVP PTR(31);                                     1308
*         DCL CVPSAV CHAR(LENGTH(CVPSTRU)) BASED(CVPSAVP);         1309
*                                                                  1309
*         IF GDTDBG = NULLPTR                                      1310
*           THEN;                                                  1310
         L     @06,GDTDBG(,GDTPR)                                  1310
         LTR   @06,@06                                             1310
         BZ    @RT01310                                            1310
*           ELSE                                                   1312
*             CALL ICKDB010 (GDTTBL,'TPER');                       1312
*                                                                  1312
         ST    GDTPR,@AL00001                                      1312
         LA    @06,@CC00885                                        1312
         ST    @06,@AL00001+4                                      1312
         MVI   @AL00001+4,X'80'                                    1312
         L     @15,GDTDBG(,GDTPR)                                  1312
         LA    @01,@AL00001                                        1312
         BALR  @14,@15                                             1312
*         STIDMOD = STMODID;           /* SET MODULE IDENT           */
@RT01310 MVC   STIDMOD(3),STMODID                                  1313
*         STIDENT = ERRCODE;            /* SET THE ENTRY NUMBER.     */
*                                                                  1314
         L     @06,@PC00016                                        1314
         L     @06,ERRCODE(,@06)                                   1314
         STC   @06,STIDENT                                         1314
*         CALL ICKSACL0 (GDTTBL,'ICKTP05 ',STID,GPOOL,MSGAREA);    1315
*                                                                  1315
         ST    GDTPR,@AL00001                                      1315
         LA    @06,@CC00784                                        1315
         ST    @06,@AL00001+4                                      1315
         LA    @06,STID                                            1315
         ST    @06,@AL00001+8                                      1315
         LA    @06,GPOOL                                           1315
         ST    @06,@AL00001+12                                     1315
         LA    @06,MSGAREA                                         1315
         ST    @06,@AL00001+16                                     1315
         MVI   @AL00001+16,X'80'                                   1315
         L     @15,GDTCAL(,GDTPR)                                  1315
         LA    @01,@AL00001                                        1315
         BALR  @14,@15                                             1315
*         RESPECIFY RTNREG RSTD;                                   1316
*         TESTRC = RTNREG;                                         1317
         STH   RTNREG,TESTRC                                       1317
*         RESPECIFY RTNREG UNRSTD;                                 1318
*         IF TESTRC ^= 0                                           1319
*           THEN                                                   1319
         LH    @06,TESTRC                                          1319
         LTR   @06,@06                                             1319
         BZ    @RF01319                                            1319
*             RETURN CODE(RCQUIT);                                 1320
*                                                                  1320
         LH    @15,RCQUIT                                          1320
         L     @14,@SA00016                                        1320
         LM    @00,@06,@SA00016+8                                  1320
         LM    @08,@12,@SA00016+36                                 1320
         BR    @14                                                 1320
*         CALL ICKSAGS0 (GDTTBL,LENGTH(CVPSTRU),CVPSAVP);          1321
*                                                                  1321
@RF01319 ST    GDTPR,@AL00001                                      1321
         LA    @06,@CF00888                                        1321
         ST    @06,@AL00001+4                                      1321
         LA    @06,CVPSAVP                                         1321
         ST    @06,@AL00001+8                                      1321
         MVI   @AL00001+8,X'80'                                    1321
         L     @15,GDTGSP(,GDTPR)                                  1321
         LA    @01,@AL00001                                        1321
         BALR  @14,@15                                             1321
*         RESPECIFY RTNREG RSTD;                                   1322
*         TESTRC = RTNREG;                                         1323
         STH   RTNREG,TESTRC                                       1323
*         RESPECIFY RTNREG UNRSTD;                                 1324
*         IF TESTRC ^= 0                                           1325
*           THEN                                                   1325
*                                                                  1325
         LH    @06,TESTRC                                          1325
         LTR   @06,@06                                             1325
         BZ    @RF01325                                            1325
*             DO;                                                  1326
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 1327
*               REG15 = 28;                                        1328
         LA    REG15,28                                            1328
*               REG14 = GDTABT;                                    1329
         L     REG14,GDTABT(,GDTPR)                                1329
*               REG13 = GDTABH;                                    1330
         L     REG13,GDTABH(,GDTPR)                                1330
*               GEN(BR    REG14);                                  1331
         BR    REG14
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                1332
*             END;                                                 1333
*                                                                  1333
*         PCTPMN = ERRCODE + 949;       /* SET MESSAGE NUMBER.       */
@RF01325 L     @06,@PC00016                                        1334
         LA    @04,949                                             1334
         AL    @04,ERRCODE(,@06)                                   1334
         STH   @04,PCTPMN(,PCTPTR)                                 1334
*         CVPSAV = CVPSTRU;             /* SAVE THE CURRENT ARG.     */
         L     @06,CVPSAVP                                         1335
         MVC   CVPSAV(162,@06),CVPSTRU                             1335
*         PCTLLM = ON;                  /* SET MESSAGE FLAG.         */
         OI    PCTLLM(PCTPTR),B'00010000'                          1336
*         PRTSPF = 2;                   /* SET SPACING FACTOR.       */
         MVC   PRTSPF(2),@CH00111                                  1337
*         PRTSPT = 'R ';                /* SET SPACING TYPE.         */
         MVI   PRTSPT,C'R'                                         1338
*         PRTBUFF = ' ';                /* CLEAR THE BUFFER.         */
         MVI   PRTBUFF+1,C' '                                      1339
         MVC   PRTBUFF+2(131),PRTBUFF+1                            1339
         MVI   PRTBUFF,C' '                                        1339
*         PRTBUFF(1:MSGLEN) = MSGTXT(1:MSGLEN);                    1340
         L     @06,MSGAREA                                         1340
         LH    @04,MSGLEN(,@06)                                    1340
         BCTR  @04,0                                               1340
         EX    @04,@SM00938                                        1340
*                                       /* MOVE MESSAGE TO BUFFER.   */
*                                                                  1341
*         CALL LINEPRT;                                            1341
*                                                                  1341
         BAL   @14,LINEPRT                                         1341
*         RESPECIFY RTNREG RSTD;                                   1342
*         TESTRC = RTNREG;                                         1343
         STH   RTNREG,TESTRC                                       1343
*         RESPECIFY RTNREG UNRSTD;                                 1344
*         CVPSTRU = CVPSAV;             /* RESTORE CURRENT ARGUMENT  */
*                                                                  1345
         L     @06,CVPSAVP                                         1345
         MVC   CVPSTRU(162),CVPSAV(@06)                            1345
*         CALL ICKSAFS0 (GDTTBL,CVPSAVP);/*                        1346
*                                          FREE PRINT ARGUMENT SPACE */
*                                                                  1346
         ST    GDTPR,@AL00001                                      1346
         LA    @06,CVPSAVP                                         1346
         ST    @06,@AL00001+4                                      1346
         L     @15,GDTFSP(,GDTPR)                                  1346
         LA    @01,@AL00001                                        1346
         BALR  @14,@15                                             1346
*         CALL ICKSAFS0 (GDTTBL,MSGAREA);/*                        1347
*                                          FREE STATIC TEXT SPACE.   */
*                                                                  1347
         ST    GDTPR,@AL00001                                      1347
         LA    @06,MSGAREA                                         1347
         ST    @06,@AL00001+4                                      1347
         L     @15,GDTFSP(,GDTPR)                                  1347
         LA    @01,@AL00001                                        1347
         BALR  @14,@15                                             1347
*         RETURN CODE (TESTRC);                                    1348
         LH    @15,TESTRC                                          1348
         L     @14,@SA00016                                        1348
         LM    @00,@06,@SA00016+8                                  1348
         LM    @08,@12,@SA00016+36                                 1348
         BR    @14                                                 1348
*         END ERROR;                                               1349
@PB00016 DS    0H                                                  1350
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE FORMAT PROCEDURE.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1350
*                                                                  1350
*         GENERATE DATA;                                           1350
*                                                                  1350
*         END ICKTP01                                              1351
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF07 )                                        *
*;                                                                 1351
@EL00001 L     @13,4(,@13)                                         1351
@EF00001 L     @00,@SIZDATD                                        1351
         LR    @01,@08                                             1351
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     1351
         BR    @14                                                 1351
@DATA    DS    0H
@CH00865 DC    H'999'
@CH00786 DC    H'-1'
@SM00915 MVC   HDSEG3(0,@04),TRBUF(@01)
@SM00917 MVC   CVPB(0,CVSTA),TRBUF(@14)
@SM00919 MVC   ALIGNBUF(0),TRBUF(@04)
@SM00921 MVC   CVPB(0,@04),ALIGNBUF
@SM00923 MVC   CVPB(0,CVSTA),ALIGNBUF
@SM00929 MVC   0(0,@04),TRBUF(@01)
@SM00931 MVC   RETAREA(0,@03),PRTBUFF
@SM00934 MVC   HEADLI(0,@06),PRLINE
@SM00936 MVC   STACKDL(0,@06),PUTLINE(@03)
@SM00938 MVC   PRTBUFF(0),MSGTXT(@06)
         DS    0F
@AL00356 DC    A(@CF00114)             LIST WITH   1 ARGUMENT(S)
@AL00378 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00429 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00473 DC    A(@CF00160)             LIST WITH   1 ARGUMENT(S)
@AL00397 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00492 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00505 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00526 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(RCQUIT)
@AL00430 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00474 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(RCERR)
@AL00441 DC    A(@CF00111)             LIST WITH   1 ARGUMENT(S)
@AL00451 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00461 DC    A(@CF00131)             LIST WITH   1 ARGUMENT(S)
@AL00508 DC    A(@CF00180)             LIST WITH   1 ARGUMENT(S)
@AL00589 DC    A(@CF00036)             LIST WITH   1 ARGUMENT(S)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    14F
@SA00016 DS    14F
@PC00016 DS    1F
@SA00002 DS    14F
@SA00003 DS    14F
@SA00014 DS    14F
@SA00007 DS    14F
@SA00008 DS    12F
@SA00009 DS    14F
@SA00012 DS    14F
@SA00010 DS    14F
@SA00015 DS    14F
@PC00015 DS    1F
@AL00001 DS    11A
@TF00001 DS    F
ICKTP01  CSECT
         DS    0F
@CF00160 DC    F'1'
@CH00160 EQU   @CF00160+2
@CF00111 DC    F'2'
@CH00111 EQU   @CF00111+2
@CF00131 DC    F'3'
@CF00036 DC    F'4'
@CF00114 DC    F'6'
@CH00114 EQU   @CF00114+2
@CF00180 DC    F'7'
@CF00156 DC    F'8'
@CH00156 EQU   @CF00156+2
@CF00254 DC    F'9'
@CF00032 DC    F'10'
@CF00033 DC    F'11'
@CF00034 DC    F'12'
@CH00034 EQU   @CF00034+2
@CF00259 DC    F'13'
@CF00264 DC    F'16'
@CF00288 DC    F'28'
@CF00888 DC    F'162'
@CF00779 DC    F'255'
@CF00831 DC    XL4'0F'
@CF00463 DC    BL4'1'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DMPINDEX DS    A
QENTP    DS    A
FMRIP    DS    A
HEADPTR  DS    A
MSGAREA  DS    A
TEMP1    DS    F
FFMSTRS  DS    A
FFMREDOS DS    A
FFMBDP   DS    A
FMRIL    DS    F
BINACC   DS    F
LINCT    DS    F
TEMP2    DS    F
DARGILP1 DS    FL4
         ORG   DARGILP1
@NM00027 DS    FL2
DARGILP2 DS    FL2
         ORG   DARGILP1+4
DARGFULL DS    F
FMTAR    DS    F
CVPSAVP  DS    A
LISTPTR  DS    A
TESTRC   DS    H
SAVERC   DS    H
STRSTP   DS    H
FFMRBOFF DS    H
FFMREDOL DS    H
FFMREDOO DS    H
FFMREDOC DS    H
REDOCSAV DS    H
FMSIL    DS    H
DECT     DS    H
BINHALF  DS    H
PUPOCT   DS    H
PLLEN    DS    H
PRSPF    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
CVPSTRU  DS    CL162
         ORG   CVPSTRU
CVPIADD  DS    AL4
CVPPADD  DS    AL4
CVPIL    DS    FL4
CVPOL    DS    FL4
CVPTYF   DS    BL2
         ORG   CVPTYF
CVPBH    DS    BL1
CVPBHA   EQU   CVPTYF+0
CVPBHD   EQU   CVPTYF+0
CVPBD    EQU   CVPTYF+0
CVPPU    EQU   CVPTYF+0
@NM00019 EQU   CVPTYF+0
CVPZS    DS    BL1
CVPAL    EQU   CVPTYF+1
CVPSS    EQU   CVPTYF+1
CVPBS    EQU   CVPTYF+1
CVPAR    EQU   CVPTYF+1
@NM00020 EQU   CVPTYF+1
         ORG   CVPSTRU+18
CVPRETC  DS    FL2
CVPRETP  DS    AL4
PRTSPF   DS    FL2
PRTSPT   DS    CL1
PRTBUFF  DS    CL133
PRTBFOVF DS    CL2
         ORG   CVPSTRU+162
ALIGNBUF DS    CL120
         DS    CL6
UNPKWD   DS    CL8
HDINDEXC DS    CL2
HDCVB    DS    CL64
CVFLAG   DS    BL2
         ORG   CVFLAG
PLOVF    DS    BL1
PUPPSF   EQU   CVFLAG+0
PUPIOF   EQU   CVFLAG+0
SIGNPOS  EQU   CVFLAG+0
HIORDRF  EQU   CVFLAG+0
         ORG   CVFLAG+2
SIGN     DS    CL1
MSGNO    DS    CL3
MTPN     DS    CL4
PRBUFF   DS    CL121
         ORG   PRBUFF
PRCC     DS    CL1
PRLINE   DS    CL120
         ORG   PRBUFF+121
STID     DS    CL4
         ORG   STID
STIDMOD  DS    CL3
STIDENT  DS    AL1
         ORG   STID+4
FFMFLAG  DS    BL2
         ORG   FFMFLAG
FFMREDOF DS    BL1
FFMEOS   EQU   FFMFLAG+0
FFMEOS1  EQU   FFMFLAG+0
FFMPASS  EQU   FFMFLAG+0
FFMIDINH EQU   FFMFLAG+0
FFMNOFM  EQU   FFMFLAG+0
FFMDATA  EQU   FFMFLAG+0
FFMFMTF  EQU   FFMFLAG+0
FFMPINH  DS    BL1
FFMVS    EQU   FFMFLAG+1
FFMPSFF  EQU   FFMFLAG+1
FFMPMSF  EQU   FFMFLAG+1
@NM00026 EQU   FFMFLAG+1
         ORG   FFMFLAG+2
ICKTP01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
GPOOL    DC    F'0'
NULLPMN  DC    H'0'
STDLWPS  DC    H'121'
RCQUIT   DC    H'12'
RCERR    DC    H'4'
PRBUFL   DC    H'2048'
@CC00784 DC    C'ICKTP05 '
@CC00140 DC    C'ZERO'
@CC00783 DC    C'TPSI'
@CC00798 DC    C'TPCC'
@CC00800 DC    C'TP1N'
@CC00819 DC    C'TP2I'
@CC00826 DC    C'TP2N'
@CC00836 DC    C'TP2M'
@CC00846 DC    C'TP2D'
@CC00847 DC    C'TP2O'
@CC00848 DC    C'TP2V'
@CC00850 DC    C'TP2U'
@CC00859 DC    C'TPDR'
@CC00863 DC    C'TP3I'
@CC00871 DC    C'TP3N'
@CC00885 DC    C'TPER'
@CC00830 DC    C'X'''
@CB00710 DC    X'000001073741824C'
@CB00820 EQU   @CB00710
MODID    DC    CL4'TP01'
FIXAREA  DC    X'00'
         DC    XL255'0'
SBPOOL   DC    CL4'TP01'
BHTRTB   DC    CL16'0123456789ABCDEF'
PRCCON   DC    CL4'+ 0-'
PRECON   DC    CL1'1'
HDPOOL   DC    CL4'TP03'
STMODID  DC    CL3'TP1'
TP04ENT  DC    CL8'ICKTP04'
ESTSARG  DC    CL3'STS'
ESTAARG  DC    CL3'STA'
RESTARG  DC    CL3'RES'
RSETARG  DC    CL3'RST'
@DATD    DSECT
ICKTP01  CSECT
         ENTRY ICKTPS1
ICKTPS1  DC A(@SIZDATD)
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKTP01  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
NLISAV   EQU   @06
PRFTSP   EQU   @04
SPFSAV   EQU   @03
J        EQU   @03
N        EQU   @07
SIGNT    EQU   @07
PUPPSC   EQU   @04
CVSL     EQU   @06
TTLPT    EQU   @06
CVSTA    EQU   @03
PCTPTR   EQU   @05
FSADDR   EQU   @03
DDSTRU   EQU   @06
SETRC    EQU   @04
RTNREG   EQU   @15
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
CVDREG   EQU   @02
GDTPR    EQU   @09
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTTPH   EQU   GDTTBL+28
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
ICKSACL0 EQU   0
ICKSAEP0 EQU   0
ICKSAGS0 EQU   0
ICKSAFS0 EQU   0
ICKSAGP0 EQU   0
ICKSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
LISTTEST EQU   0
ICKIOPT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
IOCPNM   EQU   IOCSTR+28
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGIND  EQU   DARGLIST+18
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGREP  EQU   DARGINS
DARGINL  EQU   DARGARY+2
DARGPCT  EQU   DARGINL
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTEOLF  EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTSTL   EQU   FMTILEN
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTSPT   EQU   FMTSTO
FMTOCOL  EQU   FMTLIST+6
FMTRIO   EQU   FMTOCOL
FMTOLEN  EQU   FMTLIST+8
FMTCNVF  EQU   FMTLIST+10
FMTBS    EQU   FMTCNVF+1
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
PCTTAB   EQU   0
PCTFLG   EQU   PCTTAB+4
PCTH1F   EQU   PCTFLG
PCTH2F   EQU   PCTFLG
PCTHAF   EQU   PCTFLG
PCTLLM   EQU   PCTFLG
PCTAPF   EQU   PCTFLG
PCTSPP   EQU   PCTTAB+8
PCTACT   EQU   PCTTAB+12
PCTIOC   EQU   PCTACT
PCTAPL   EQU   PCTACT+4
PCTCPN   EQU   PCTAPL
PCTNLI   EQU   PCTAPL+2
PCTSTD   EQU   PCTTAB+20
PCTSPL   EQU   PCTSTD+4
PCTALT   EQU   PCTTAB+28
PCTIOP   EQU   PCTALT
PCTLPL   EQU   PCTALT+4
PCTSQP   EQU   PCTTAB+48
PCTAHP   EQU   PCTTAB+52
PCTMLP   EQU   PCTTAB+56
PCTSLP   EQU   PCTTAB+60
PCTTRP   EQU   PCTTAB+64
PCTPLW   EQU   PCTTAB+68
PCTSLC   EQU   PCTTAB+74
PCTFLP   EQU   PCTTAB+76
PCTFLC   EQU   PCTTAB+80
PCTHLC   EQU   PCTTAB+82
PCTHSC   EQU   PCTTAB+83
PCTPNL   EQU   PCTTAB+84
PCTPMN   EQU   PCTTAB+86
PCTAPC   EQU   PCTTAB+88
PCTDSC   EQU   PCTTAB+92
PCTPNI   EQU   PCTTAB+94
PCTFDL   EQU   PCTTAB+96
PCTLDL   EQU   PCTTAB+98
PCTFLN   EQU   PCTTAB+100
PCTLNM   EQU   PCTTAB+102
PCTBUF   EQU   PCTTAB+104
PCTBNL   EQU   PCTTAB+108
RETAREA  EQU   0
QENTRY   EQU   0
QSTID    EQU   QENTRY
QCHAIN   EQU   QENTRY+4
QFLAGS   EQU   QENTRY+8
QMSGF    EQU   QFLAGS
QHEADF   EQU   QFLAGS
QSECMF   EQU   QFLAGS
QHLC     EQU   QENTRY+10
QHSC     EQU   QENTRY+11
QTEXT    EQU   QENTRY+12
CVPB     EQU   0
TRBUF    EQU   0
HDPRLI   EQU   0
HDINDEX  EQU   HDPRLI
HDSEG1   EQU   HDPRLI+6
HDSEG2   EQU   HDPRLI+44
HDST1    EQU   HDPRLI+82
HDSEG3   EQU   HDPRLI+83
HDST2    EQU   HDPRLI+115
FTLI     EQU   0
FLCC     EQU   FTLI
MTLINE   EQU   0
STLINE   EQU   0
HEADQUE  EQU   0
HEADQP   EQU   HEADQUE
HEADCC   EQU   HEADQUE+4
HEADLI   EQU   HEADQUE+5
MESSAGE  EQU   0
MSGLEN   EQU   MESSAGE+2
MSGTXT   EQU   MESSAGE+12
STACKMAP EQU   0
STACKLL  EQU   STACKMAP
STACKDL  EQU   STACKMAP+2
CVPSAV   EQU   0
DMPTRM   EQU   0
ICKDVCL0 EQU   0
ICKDVIN0 EQU   0
ICKDVON0 EQU   0
ICKDVOP0 EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOTM0 EQU   0
ICKSADE0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPPR0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
NEWERID1 EQU   5
PCTTRT   EQU   0
GDTTBLX  EQU   0
FILENAME EQU   0
STIDS    EQU   0
PCALIST  EQU   0
PTR1     EQU   0
PTR2     EQU   0
PTR3     EQU   0
PTR4     EQU   0
PTR5     EQU   0
PTR6     EQU   0
PTR7     EQU   0
PGNOPTR  EQU   0
DDPTR    EQU   0
FMPTR    EQU   0
PUTLINE  EQU   0
ERRCODE  EQU   0
STLCC    EQU   STLINE
CONVL    EQU   TEMP1
DSINDX   EQU   TEMP1
RETLN    EQU   TEMP1
BDLEN    EQU   TEMP1
HDINDEXB EQU   HDINDEXC
BINHALFC EQU   BINHALF
BINACCC  EQU   BINACC
CURLI    EQU   TEMP2
HDQPTR   EQU   TEMP2
MTLCC    EQU   MTLINE
TRBUFB   EQU   TRBUF
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00025 EQU   MESSAGE+10
@NM00024 EQU   MESSAGE+8
@NM00023 EQU   MESSAGE+6
MSGOFF   EQU   MESSAGE+4
@NM00022 EQU   MESSAGE
FL1      EQU   FTLI+1
HDSP3    EQU   HDPRLI+80
HDSP2    EQU   HDPRLI+42
HDSP1    EQU   HDPRLI+4
@NM00021 EQU   QFLAGS
PCTPPD   EQU   PCTTAB+90
PCTMLC   EQU   PCTTAB+72
PCTSME   EQU   PCTTAB+44
PCTSTM   EQU   PCTTAB+36
PCTANL   EQU   PCTLPL+2
PCTAPN   EQU   PCTLPL
PCTSNL   EQU   PCTSPL+2
PCTSPN   EQU   PCTSPL
PCTIOS   EQU   PCTSTD
@NM00018 EQU   PCTFLG
PCTIDN   EQU   PCTTAB
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
@NM00012 EQU   DARGLIST+19
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00396 EQU   @RC00389
@RC00631 EQU   @RC00627
@RC00637 EQU   @RC00627
@RC01081 EQU   @RC01079
@PB00015 EQU   @PB00016
@RC00640 EQU   @RC00637
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00007 EQU   @PB00013
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   ICKTP01,(C'PLS1755',0701,78192)

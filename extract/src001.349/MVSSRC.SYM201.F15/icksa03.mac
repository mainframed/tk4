         TITLE '******* ICKSA03  SYSTEM ADAPTER PROL/UEPIL MODULE      *
                 *******'
ICKSA03 CSECT
MAINENT DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(BEGIN-MAINENT)
        DC    C'ICKSA03 '
ICKSAPR DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSAPR1-ICKSAPR)
        ENTRY ICKSAPR
ICKSAEP DS    0H
        USING *,REG15
        B     PROLOG
        DC    AL2(DMSSAEP1-ICKSAEP)
        ENTRY ICKSAEP
        DROP  REG15
PROLOG  AH    REG15,4(REG15)
        BR    REG15
BEGIN   DS    0H
*                                                                  0213
*                                                                  0213
*        /************************************************************/
*        /*                                                          */
*        /* PROL ROUTINE ENTRY POINT                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0214
*ICKSAPR:  ENTRY(MODIDX,PSIZEX);                                   0214
*                                                                  0214
@EC00214 DS    0H                                                  0215
*DMSSAPR1:                                                         0215
*                                                                  0215
*        /************************************************************/
*        /*                                                          */
*        /* PROLOG CODE FOR PROL ROUTINE                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0215
*        GEN;                                                      0215
*                                                                  0215
DMSSAPR1 DS    0H                                                  0215
        L     REG15,24(REG13)         REGISTER 1 FROM SAVEAREA
        L     REG15,0(REG15)          GDTTBL ADDRESS
        L     REG15,GDTSPR(REG15)     FROZEN AUTOMATIC STORAGE ADDR
        USING @DATD,REG15             DATA ADDRESSABILITY
        STM   REG2,REG12,PROLSAV      SAVE REGISTERS
        DROP  REG15
        L     REG2,24(REG13)          REGISTER 1 FROM SAVEAREA
        L     REG2,0(REG2)            GDTTBL ADDRESS
        LR    REG11,REG15             FROZEN AUTOMATIC STORAGE ADDR
        USING @DATD,REG11             DATA ADDRESSABILITY
        ST    REG13,@SA00001+4
        ST    REG11,8(REG13)
        LR    REG13,REG11
        BALR  REG12,0
PSTART1 DS    0H
        USING PSTART1,REG12           CODE ADDRESSABILITY
*        /************************************************************/
*        /*                                                          */
*        /* BASE FOR THE GDTTBL IS ALREADY SET UP IN THE PROL CODE   */
*        /* FOR THIS ROUTINE--NOW SET UP BASE FOR MODID AND PSIZE    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0216
*        RESPECIFY (REG1,REG14) RSTD;                              0216
*        GEN(L     MODIDPR,0(REG1));                               0217
         L     MODIDPR,0(REG1)
*        GEN(L     SIZEPR,4(REG1));                                0218
         L     SIZEPR,4(REG1)
*        RESPECIFY (REG1) UNRSTD;                                  0219
*                                                                  0219
*        /************************************************************/
*        /*                                                          */
*        /* SAVE THE RETURN ADDRESS IN REGISTER 14                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0220
*        RTNADDR = REG14;                                          0220
         LR    RTNADDR,REG14                                       0220
*        RESPECIFY (REG14) UNRSTD;                                 0221
*                                                                  0221
*        TEMPID = MODID;                                           0222
*                                                                  0222
         MVC   TEMPID(4),MODID(MODIDPR)                            0222
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE IF MODULE ID IS CONTAINED IN FROZEN AUTOMATIC  */
*        /* STORAGE TABLE                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0223
*        DOCNTRL = ON;                                             0223
         OI    DOCNTRL,B'10000000'                                 0223
*PRDO:   DO I=1 TO DIM(AUTOARAY) WHILE(DOCNTRL = ON);              0224
*                                                                  0224
PRDO     LA    I,1                                                 0224
@DL00224 TM    DOCNTRL,B'10000000'                                 0224
         BNO   @DC00224                                            0224
*          /**********************************************************/
*          /*                                                        */
*          /* DETERMINE IF MODULE ID MATCHES ID IN FROZEN AUTOMATIC  */
*          /* STORAGE TABLE                                          */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0225
*          IF AREAID(I) = TEMPID                                   0225
*            THEN                                                  0225
         LR    @08,I                                               0225
         MH    @08,@CH00032                                        0225
         L     @07,GDTSAH(,GDTPR)                                  0225
         L     @07,AUTOPTR(,@07)                                   0225
         ALR   @07,@08                                             0225
         AL    @07,@CF00595                                        0225
         CLC   AREAID(4,@07),TEMPID                                0225
         BNE   @RF00225                                            0225
*              DOCNTRL = OFF;                                      0226
         NI    DOCNTRL,B'01111111'                                 0226
*        END PRDO;                                                 0227
*                                                                  0227
@RF00225 AL    I,@CF00157                                          0227
         C     I,@CF00111                                          0227
         BNH   @DL00224                                            0227
@DC00224 DS    0H                                                  0228
*        /************************************************************/
*        /*                                                          */
*        /* CHECK WHETHER OR NOT MODULE ID IS CONTAINED IN FROZEN    */
*        /* AUTOMATIC STORAGE TABLE                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0228
*        IF DOCNTRL = ON                                           0228
*          THEN                                                    0228
         TM    DOCNTRL,B'10000000'                                 0228
         BNO   @RF00228                                            0228
*            DO;                                                   0229
*                                                                  0229
*              /******************************************************/
*              /*                                                    */
*              /* MODULE ID IS NOT CONTAINED IN FROZEN AUTOMATIC     */
*              /* STORAGE TABLE SO CALL GETCORE ROUTINE TO GET CORE  */
*              /* PLUS 8 BYTES FOR CONTROL INFORMATION               */
*              /*                                                    */
*              /******************************************************/
*                                                                  0230
*              TEMPSIZE = PSIZE + 8;                               0230
         LA    @08,8                                               0230
         AL    @08,PSIZE(,SIZEPR)                                  0230
         ST    @08,TEMPSIZE                                        0230
*              CALL GETCORE(TEMPSIZE,TEMPPTR);                     0231
*                                                                  0231
         LA    @08,TEMPSIZE                                        0231
         ST    @08,@AL00001                                        0231
         LA    @08,TEMPPTR                                         0231
         ST    @08,@AL00001+4                                      0231
         LA    @01,@AL00001                                        0231
         BAL   @14,GETCORE                                         0231
*              /******************************************************/
*              /*                                                    */
*              /* STORE ADDRESS OF ACQUIRED CORE INTO REGISTER 5 AND */
*              /* INSERT CONTROL INFORMATION IN FRONT OF AREA        */
*              /*                                                    */
*              /******************************************************/
*                                                                  0232
*              RESPECIFY (REG5) RSTD;                              0232
*              REG5 = TEMPPTR + 8;                                 0233
         L     @08,TEMPPTR                                         0233
         LA    REG5,8                                              0233
         ALR   REG5,@08                                            0233
*              AUTOID = TEMPID;                                    0234
         MVC   AUTOID(4,@08),TEMPID                                0234
*              AUTOSIZE = TEMPSIZE;                                0235
         L     @15,TEMPSIZE                                        0235
         ST    @15,AUTOSIZE(,@08)                                  0235
*            END;                                                  0236
*          ELSE                                                    0237
*                                                                  0237
*            /********************************************************/
*            /*                                                      */
*            /* MODULE ID IS CONTAINED IN AUTOMATIC STORAGE TABLE SO */
*            /* USE THIS TABLE FOR AUTOMATIC STORAGE REQUEST         */
*            /* ALLOCATION                                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0237
*            DO;                                                   0237
         B     @RC00228                                            0237
@RF00228 DS    0H                                                  0238
*              I = I -1;                                           0238
*                                                                  0238
         BCTR  I,0                                                 0238
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF STATUS IS ZERO, INDICATING THAT THE FROZEN*/
*              /* AREA IS NOT BEING USED                             */
*              /*                                                    */
*              /******************************************************/
*                                                                  0239
*              IF STATUS(I) = 0                                    0239
*                THEN                                              0239
*                                                                  0239
         LR    @08,I                                               0239
         MH    @08,@CH00032                                        0239
         L     @07,GDTSAH(,GDTPR)                                  0239
         L     @07,AUTOPTR(,@07)                                   0239
         LA    @01,0(@08,@07)                                      0239
         AL    @01,@CF00597                                        0239
         LH    @15,STATUS-4(,@01)                                  0239
         LTR   @15,@15                                             0239
         BNZ   @RF00239                                            0239
*                  /**************************************************/
*                  /*                                                */
*                  /* INSERT ADDRESS OF PREALLOCATED FROZEN          */
*                  /* AUTOMATIC STORAGE INTO REGISTER 5              */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0240
*                  REG5 = PTR1(I);                                 0240
         AL    @07,@CF00598                                        0240
         L     REG5,PTR1-8(@08,@07)                                0240
*                ELSE                                              0241
*                  DO;                                             0241
*                                                                  0241
         B     @RC00239                                            0241
@RF00239 DS    0H                                                  0242
*                    /************************************************/
*                    /*                                              */
*                    /* CALL GETCORE ROUTINE TO ALLOCATE STORAGE + 8 */
*                    /* BYTES FOR CONTROL INFORMATION                */
*                    /*                                              */
*                    /************************************************/
*                                                                  0242
*                    TEMPSIZE = PSIZE + 8;                         0242
         LA    @08,8                                               0242
         AL    @08,PSIZE(,SIZEPR)                                  0242
         ST    @08,TEMPSIZE                                        0242
*                    CALL GETCORE(TEMPSIZE,TEMPPTR);               0243
*                                                                  0243
         LA    @08,TEMPSIZE                                        0243
         ST    @08,@AL00001                                        0243
         LA    @08,TEMPPTR                                         0243
         ST    @08,@AL00001+4                                      0243
         LA    @01,@AL00001                                        0243
         BAL   @14,GETCORE                                         0243
*                    /************************************************/
*                    /*                                              */
*                    /* STORE ADDRESS OF ACQUIRED CORE INTO REGISTER */
*                    /* 5 (SO WON'T BE DESTROYED BY ANY CALLS)       */
*                    /* AND INSERT CONTROL INFORMATION IN FRONT OF   */
*                    /* AREA                                         */
*                    /*                                              */
*                    /************************************************/
*                                                                  0244
*                    REG5 = TEMPPTR + 8;                           0244
         L     @08,TEMPPTR                                         0244
         LA    REG5,8                                              0244
         ALR   REG5,@08                                            0244
*                    AUTOID = IDENT;                               0245
         MVC   AUTOID(4,@08),IDENT                                 0245
*                    AUTOSIZE = TEMPSIZE;                          0246
         L     @07,TEMPSIZE                                        0246
         ST    @07,AUTOSIZE(,@08)                                  0246
*                  END;                                            0247
*                                                                  0247
*              /******************************************************/
*              /*                                                    */
*              /* INCREMENT STATUS BY ONE                            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0248
*              STATUS(I) = STATUS(I) + 1;                          0248
@RC00239 LR    @08,I                                               0248
         MH    @08,@CH00032                                        0248
         L     @07,GDTSAH(,GDTPR)                                  0248
         L     @07,AUTOPTR(,@07)                                   0248
         LA    @15,1                                               0248
         LA    @14,0(@08,@07)                                      0248
         AL    @14,@CF00597                                        0248
         AH    @15,STATUS-4(,@14)                                  0248
         AL    @07,@CF00597                                        0248
         STH   @15,STATUS-4(@08,@07)                               0248
*            END;                                                  0249
*                                                                  0249
*        /************************************************************/
*        /*                                                          */
*        /* UPDATE INTER MODULE TRACE TABLE WITH USER'S MODULE ID    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0250
*        OLDERID1 = NEWERID1;                                      0250
@RC00228 L     @08,GDTTR1(,GDTPR)                                  0250
         MVC   @TS00001(95),NEWERID1(@08)                          0250
         MVC   OLDERID1(95,@08),@TS00001                           0250
*        NEWID1 = TEMPID;                                          0251
*                                                                  0251
         MVC   NEWID1(4,@08),TEMPID                                0251
*        /************************************************************/
*        /*                                                          */
*        /* RESTORE THE RETURN ADDRESS INTO REGISTER 14              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0252
*        RESPECIFY (REG14) RSTD;                                   0252
*        REG14 = RTNADDR;                                          0253
*                                                                  0253
         LR    REG14,RTNADDR                                       0253
*        /************************************************************/
*        /*                                                          */
*        /* RESTORE SAVEAREA POINTER AND STORE USER'S MODULE ID INTO */
*        /* THE FIRST 4 BYTES OF THE SAVEAREA THAT HE SAVED IN       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0254
*        RESPECIFY (REG13) RSTD;                                   0254
*        GEN(L     REG13,4(REG13));                                0255
         L     REG13,4(REG13)
*        GEN(MVC   0(4,REG13),TEMPID);                             0256
         MVC   0(4,REG13),TEMPID
*        RESPECIFY (REG13) UNRSTD;                                 0257
*                                                                  0257
*        /************************************************************/
*        /*                                                          */
*        /* THE PROL ROUTINE AUTOMATIC STORAGE AREA DOESN'T NEED     */
*        /* TO BE RELEASED AS IT IS USED AGAIN--NOW LOAD THE ADDRESS */
*        /* OF THE GOTTEN CORE INTO REGISTER 1, RESTORE REGISTERS    */
*        /* 2 THROUGH 12 FROM THE SAVEAREA SAVED IN BY THIS ROUTINE  */
*        /* (PROLSAVE) AND BRANCH ON REGISTER 14 (RETURN TO THE      */
*        /* CALLER)                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0258
*        RESPECIFY (REG1) RSTD;                                    0258
*        REG1 = REG5;                                              0259
         LR    REG1,REG5                                           0259
*        RESPECIFY(REG5) UNRSTD;                                   0260
*        GEN(LM    REG2,REG12,PROLSAV);                            0261
         LM    REG2,REG12,PROLSAV
*        GEN(BR    REG14);                                         0262
         BR    REG14
*        RESPECIFY (REG1,REG14) UNRSTD;                            0263
*        /************************************************************/
*        /*                                                          */
*        /* UEPIL ROUTINE ENTRY POINT                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0264
*ICKSAEP:  ENTRY(GDTTBLX,MODIDX,RCODEX);                           0264
*                                                                  0264
@EC00264 DS    0H                                                  0265
*DMSSAEP1:                                                         0265
*                                                                  0265
*        /************************************************************/
*        /*                                                          */
*        /* PROLOG CODE FOR THE UEPIL ROUTINE                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0265
*        GEN;                                                      0265
*                                                                  0265
DMSSAEP1 DS    0H                                                  0265
        BALR  REG12,0
PSTART2 SH    REG12,8(REG12)          CODE ADDRESSABILITY
        B     *+6
        DC    AL2(PSTART2-PSTART1)
        L     REG11,0(REG1)           GDTTBL ADDRESS
        L     REG11,GDTSPR(REG11)     FROZEN AUTOMATIC STORAGE ADDR
        USING @DATD,REG11             DATA ADDRESSABILITY
        ST    REG13,@SA00001+4
        ST    REG11,8(REG13)
        LR    REG13,REG11
*        /************************************************************/
*        /*                                                          */
*        /* SET UP BASE FOR GDTTBL, MODID AND RCODE                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0266
*        RESPECIFY (REG1) RSTD;                                    0266
*        GEN(L     GDTPR,0(REG1));                                 0267
         L     GDTPR,0(REG1)
*        GEN(L     MODIDPR,4(REG1));                               0268
         L     MODIDPR,4(REG1)
*        GEN(L     RCODEPR,8(REG1));                               0269
*                                                                  0269
*                                                                  0269
         L     RCODEPR,8(REG1)
*                                                                  0270
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0270
*        GEN;                                                      0270
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0271
         LA    LISTLN,1                                            0271
@DL00271 L     @10,LISTSCAN                                        0271
         TM    LISTTEST(@10),B'10000000'                           0271
         BNZ   @DC00271                                            0271
*          LISTSCAN = LISTSCAN + 4;                                0272
         AL    @10,@CF00036                                        0272
         ST    @10,LISTSCAN                                        0272
*        END;                                                      0273
*                                                                  0273
         AL    LISTLN,@CF00157                                     0273
         C     LISTLN,@CF00559                                     0273
         BNH   @DL00271                                            0273
@DC00271 DS    0H                                                  0274
*        RESPECIFY (REG1) UNRSTD;                                  0274
*                                                                  0274
*        /************************************************************/
*        /*                                                          */
*        /* GET ADDRESS OF CALLER'S AUTOMATIC STORAGE (TEMPPTR),     */
*        /* GET ADDRESS OF SAVEAREA THAT THE CALLER SAVED REGISTERS  */
*        /* IN (RTNSAVE), AND ZERO THIS SAVEAREA FORWARD CHAIN       */
*        /* POINTER                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0275
*        RESPECIFY (REG13) RSTD;                                   0275
*        GEN(L     REG13,4(REG13));                                0276
         L     REG13,4(REG13)
*        TEMPPTR = REG13;                                          0277
         ST    REG13,TEMPPTR                                       0277
*        GEN(L     REG13,4(REG13));                                0278
         L     REG13,4(REG13)
*        RTNSAVE = REG13;                                          0279
         LR    RTNSAVE,REG13                                       0279
*        SAVEFWD = NULLPTR;                                        0280
         SLR   @08,@08                                             0280
         ST    @08,SAVEFWD+8(,SAVEPTR)                             0280
*        REG13 = TEMPPTR;                                          0281
         L     REG13,TEMPPTR                                       0281
*        GEN(L     REG13,8(REG13));                                0282
         L     REG13,8(REG13)
*        RESPECIFY (REG13) UNRSTD;                                 0283
*                                                                  0283
*        /************************************************************/
*        /*                                                          */
*        /* CALCULATE ADDRESS OF AREA TO BE FREED--USER'S AUTOMATIC  */
*        /* STORAGE AREA POINTER MINUS 8 (CONTROL INFORMATION)       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0284
*        TEMPPTR = TEMPPTR - 8;                                    0284
*                                                                  0284
         L     @08,TEMPPTR                                         0284
         SL    @08,@CF00153                                        0284
         ST    @08,TEMPPTR                                         0284
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF USER SPECIFIED A RETURN CODE                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0285
*        IF LISTLN = 3                                             0285
*          THEN                                                    0285
         C     LISTLN,@CF00128                                     0285
         BNE   @RF00285                                            0285
*            SETRC = RCODE;                                        0286
         LH    SETRC,RCODE(,RCODEPR)                               0286
*          ELSE                                                    0287
*            SETRC = 0;                                            0287
*                                                                  0287
         B     @RC00285                                            0287
@RF00285 SLR   SETRC,SETRC                                         0287
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE IF MODULE ID IS CONTAINED IN FROZEN AUTOMATIC  */
*        /* STORAGE TABLE                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0288
*        DOCNTRL = ON;                                             0288
@RC00285 OI    DOCNTRL,B'10000000'                                 0288
*EPDO:   DO I=1 TO DIM(AUTOARAY) WHILE(DOCNTRL = ON);              0289
*                                                                  0289
EPDO     LA    I,1                                                 0289
@DL00289 TM    DOCNTRL,B'10000000'                                 0289
         BNO   @DC00289                                            0289
*          /**********************************************************/
*          /*                                                        */
*          /* DETERMINE IF MODULE ID MATCHES ID IN FROZEN AUTOMATIC  */
*          /* STORAGE TABLE                                          */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0290
*          IF AREAID(I) = MODID                                    0290
*            THEN                                                  0290
         LR    @08,I                                               0290
         MH    @08,@CH00032                                        0290
         L     @05,GDTSAH(,GDTPR)                                  0290
         L     @05,AUTOPTR(,@05)                                   0290
         ALR   @05,@08                                             0290
         AL    @05,@CF00595                                        0290
         CLC   AREAID(4,@05),MODID(MODIDPR)                        0290
         BNE   @RF00290                                            0290
*              DOCNTRL = OFF;                                      0291
         NI    DOCNTRL,B'01111111'                                 0291
*        END EPDO;                                                 0292
*                                                                  0292
@RF00290 AL    I,@CF00157                                          0292
         C     I,@CF00111                                          0292
         BNH   @DL00289                                            0292
@DC00289 DS    0H                                                  0293
*        /************************************************************/
*        /*                                                          */
*        /* RELEASE USER'S AUTOMATIC STORAGE AREA                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0293
*        IF DOCNTRL = ON                                           0293
*          THEN                                                    0293
*                                                                  0293
         TM    DOCNTRL,B'10000000'                                 0293
         BNO   @RF00293                                            0293
*            /********************************************************/
*            /*                                                      */
*            /* MODULE ID IS NOT CONTAINED IN FROZEN AUTOMATIC       */
*            /* STORAGE TABLE                                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  0294
*             DO;                                                  0294
*              RESPECIFY (REG0,REG1) RSTD;                         0295
*              REG0 = AUTOSIZE;                                    0296
         L     @08,TEMPPTR                                         0296
         L     REG0,AUTOSIZE(,@08)                                 0296
*              REG1 = TEMPPTR;                                     0297
         LR    REG1,@08                                            0297
*LFREM1:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));                 0298
LFREM1   FREEMAIN R,LV=(REG0),A=(REG1)
*              RESPECIFY (REG0,REG1) UNRSTD;                       0299
*            END;                                                  0300
*          ELSE                                                    0301
*                                                                  0301
*            /********************************************************/
*            /*                                                      */
*            /* MODULE ID IS CONTAINED IN FROZEN AUTOMATIC STORAGE   */
*            /* TABLE SO USE THIS TABLE FOR RELEASE REQUEST          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0301
*            DO;                                                   0301
         B     @RC00293                                            0301
@RF00293 DS    0H                                                  0302
*              I = I - 1;                                          0302
*                                                                  0302
         BCTR  I,0                                                 0302
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF STATUS IS GREATER THAT ONE, INDICATING    */
*              /* THAT IT IS NOT THE FROZEN AREA TO BE RELEASED      */
*              /*                                                    */
*              /******************************************************/
*                                                                  0303
*              IF STATUS(I) > 1                                    0303
*                THEN                                              0303
*                                                                  0303
         LR    @08,I                                               0303
         MH    @08,@CH00032                                        0303
         L     @05,GDTSAH(,GDTPR)                                  0303
         L     @05,AUTOPTR(,@05)                                   0303
         AL    @05,@CF00597                                        0303
         LH    @08,STATUS-4(@08,@05)                               0303
         C     @08,@CF00157                                        0303
         BNH   @RF00303                                            0303
*                  /**************************************************/
*                  /*                                                */
*                  /* IS NOT A FROZEN AREA SO FREE IT                */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0304
*                  DO;                                             0304
*                    RESPECIFY (REG0,REG1) RSTD;                   0305
*                    REG0 = AUTOSIZE;                              0306
         L     @08,TEMPPTR                                         0306
         L     REG0,AUTOSIZE(,@08)                                 0306
*                    REG1 = TEMPPTR;                               0307
         LR    REG1,@08                                            0307
*LFREM2:             GEN(FREEMAIN R,LV=(REG0),A=(REG1));           0308
LFREM2   FREEMAIN R,LV=(REG0),A=(REG1)
*                    RESPECIFY (REG0,REG1) UNRSTD;                 0309
*                  END;                                            0310
*                                                                  0310
*              /******************************************************/
*              /*                                                    */
*              /* DECREMENT STATUS BY 1                              */
*              /*                                                    */
*              /******************************************************/
*                                                                  0311
*              STATUS(I) = STATUS(I) - 1;                          0311
@RF00303 LR    @08,I                                               0311
         MH    @08,@CH00032                                        0311
         L     @05,GDTSAH(,GDTPR)                                  0311
         L     @05,AUTOPTR(,@05)                                   0311
         LA    @01,0(@08,@05)                                      0311
         AL    @01,@CF00597                                        0311
         LH    @15,STATUS-4(,@01)                                  0311
         BCTR  @15,0                                               0311
         AL    @05,@CF00597                                        0311
         STH   @15,STATUS-4(@08,@05)                               0311
*            END;                                                  0312
*                                                                  0312
*        /************************************************************/
*        /*                                                          */
*        /*  IF MODULE IS  ONE OF THE CSECTS OF THE MAIN LOAD        */
*        /*  MODULE ICKDMS (CAN TELL FROM THE MODID) THAT RECIEVES   */
*        /*  CONTROL MANY TIMES DURING AN EXECUTION THEN DONT LOOK   */
*        /*  FOR IT IN LLBLK BECAUSE ITS NOT THERE SAVE TIME         */
*        /*  SEARCHING BLOCKS.DB01 IS IN LIST BECAUSE IT IS          */
*        /*  LOADED AND SHOULD NOT BE DELETED TILL DMS               */
*        /*  IS COMPLETED (IT CONTAINS UDUMP ROUTINE)                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0313
*        IF MODID ^= 'SA02' & MODID ^= 'DB01' & MODID ^= 'SA03' &  0313
*           MODID ^= 'EX01' & MODID ^= 'TP01' & MODID ^= 'IO01'    0313
*                                                                  0313
*          THEN                                                    0313
@RC00293 CLC   MODID(4,MODIDPR),@CC00566                           0313
         BE    @RF00313                                            0313
         CLC   MODID(4,MODIDPR),@CC00567                           0313
         BE    @RF00313                                            0313
         CLC   MODID(4,MODIDPR),@CC00493                           0313
         BE    @RF00313                                            0313
         CLC   MODID(4,MODIDPR),@CC00568                           0313
         BE    @RF00313                                            0313
         CLC   MODID(4,MODIDPR),@CC00569                           0313
         BE    @RF00313                                            0313
         CLC   MODID(4,MODIDPR),@CC00570                           0313
         BE    @RF00313                                            0313
*            DO;                                                   0314
*                                                                  0314
*              /******************************************************/
*              /*                                                    */
*              /*  BUILD MODULE NAME FOR SEARCH LLBLK RTN            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0315
*              TEMPEPN(1:8) = 'ICK     ';                          0315
         MVC   TEMPEPN(8),@CC00571                                 0315
*              TEMPEPN(4:7) = MODID(1:4);                          0316
*                                                                  0316
         MVC   TEMPEPN+3(4),MODID(MODIDPR)                         0316
*              /******************************************************/
*              /*                                                    */
*              /*  SEARCH LLBLK RTN WILL SEARCH LLBLK(S)             */
*              /*  FOR MATCH OF NAME AND REDUCE USE CTR              */
*              /*  BY ONE                                            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0317
*              IX = 0;                                             0317
         SLR   IX,IX                                               0317
*              LOOPCTL = OFF;                                      0318
         NI    LOOPCTL,B'01111111'                                 0318
*              NAMEFND = OFF;                                      0319
*                                                                  0319
         NI    NAMEFND,B'01111111'                                 0319
*              DO WHILE LOOPCTL = OFF;                             0320
         B     @DE00320                                            0320
@DL00320 DS    0H                                                  0321
*                IF IX = 0                                         0321
*                                                                  0321
*                /****************************************************/
*                /*                                                  */
*                /*    FIRST TIME USE POINTER IN SYSTEM              */
*                /*    HIST SAVE AREA TO LOAD LIST BLOCK             */
*                /*                                                  */
*                /****************************************************/
*                                                                  0321
*                  THEN                                            0321
         LTR   IX,IX                                               0321
         BNZ   @RF00321                                            0321
*                    P = LLBLKPTR;                                 0322
         L     @06,GDTSAH(,GDTPR)                                  0322
         L     P,LLBLKPTR(,@06)                                    0322
*                  ELSE;                                           0323
@RF00321 DS    0H                                                  0324
*                DO IX = 1 TO LLSLTCNT BY 1 WHILE LOOPCTL = OFF;   0324
*                                                                  0324
*                                                                  0324
         LA    IX,1                                                0324
@DL00324 TM    LOOPCTL,B'10000000'                                 0324
         BNZ   @DC00324                                            0324
*                /****************************************************/
*                /*                                                  */
*                /*    LOOK FOR MATCH OF NAME IN LLBLK               */
*                /*    WHEN FOUND REDUCE USE CTR BY ONE              */
*                /*  UNLESS IT IS ZERO.THIS SHOULD NOT BE.           */
*                /*                                                  */
*                /****************************************************/
*                                                                  0325
*                  IF TEMPEPN = LLNAME(IX)                         0325
*                    THEN                                          0325
         LR    @08,IX                                              0325
         SLA   @08,4                                               0325
         ST    @08,@TF00001                                        0325
         ALR   @08,P                                               0325
         AL    @08,@CF00597                                        0325
         CLC   TEMPEPN(8),LLNAME-8(@08)                            0325
         BNE   @RF00325                                            0325
*                      DO;                                         0326
*                        LOOPCTL = ON;                             0327
         OI    LOOPCTL,B'10000000'                                 0327
*                        NAMEFND = ON;                             0328
         OI    NAMEFND,B'10000000'                                 0328
*                          IF LLUSECTR(IX) = 0                     0329
*                            THEN                                  0329
         L     @08,@TF00001                                        0329
         SLR   @06,@06                                             0329
         IC    @06,LLUSECTR-16(@08,P)                              0329
         C     @06,@CF00086                                        0329
         BNE   @RF00329                                            0329
*                              NAMEFND = OFF;                      0330
         NI    NAMEFND,B'01111111'                                 0330
*                            ELSE                                  0331
*                              LLUSECTR(IX) = LLUSECTR(IX)-1;      0331
*                                                                  0331
         B     @RC00329                                            0331
@RF00329 LR    @08,IX                                              0331
         SLA   @08,4                                               0331
         SLR   @06,@06                                             0331
         IC    @06,LLUSECTR-16(@08,P)                              0331
         BCTR  @06,0                                               0331
         STC   @06,LLUSECTR-16(@08,P)                              0331
*                      END;                                        0332
*                    ELSE;                                         0333
@RF00325 DS    0H                                                  0334
*                END;                                              0334
*                                                                  0334
@RC00325 AL    IX,@CF00157                                         0334
         C     IX,@CF00278                                         0334
         BNH   @DL00324                                            0334
@DC00324 DS    0H                                                  0335
*                IF LLNXTBLK = 0                                   0335
*                                                                  0335
*                /****************************************************/
*                /*                                                  */
*                /*  WHEN ZERO THIS IS LAST LLBLK                    */
*                /*                                                  */
*                /****************************************************/
*                                                                  0335
*                  THEN                                            0335
         L     @08,LLNXTBLK(,P)                                    0335
         LTR   @08,@08                                             0335
         BNZ   @RF00335                                            0335
*                    LOOPCTL = ON;                                 0336
         OI    LOOPCTL,B'10000000'                                 0336
*                  ELSE                                            0337
*                    P = LLNXTBLK;                                 0337
         B     @RC00335                                            0337
@RF00335 L     P,LLNXTBLK(,P)                                      0337
*              END;                                                0338
@RC00335 DS    0H                                                  0338
@DE00320 TM    LOOPCTL,B'10000000'                                 0338
         BZ    @DL00320                                            0338
*            END;                                                  0339
*                                                                  0339
*        /************************************************************/
*        /*                                                          */
*        /* RESTORE SAVE AREA POINTER TO SAVE AREA USER SAVED IN,    */
*        /* UPDATE INTER MODULE TRACE TABLE WITH MODULE ID OF MODULE */
*        /* TO BE RETURNED TO (FOUND IN THE FIRST 4 BYTES OF THE SAVE*/
*        /* AREA SAVED IN BY THE MODULE TO BE RETURNED TO)           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0340
*        OLDERID1 = NEWERID1;                                      0340
@RF00313 L     @06,GDTTR1(,GDTPR)                                  0340
         MVC   @TS00001(95),NEWERID1(@06)                          0340
         MVC   OLDERID1(95,@06),@TS00001                           0340
*        RESPECIFY (REG13) RSTD;                                   0341
*        REG13 = RTNSAVE;                                          0342
         LR    REG13,RTNSAVE                                       0342
*        GEN(L     REG13,4(REG13));                                0343
         L     REG13,4(REG13)
*        GEN(MVC   TEMPID(4),0(REG13));                            0344
         MVC   TEMPID(4),0(REG13)
*        GEN(L     REG13,8(REG13));                                0345
         L     REG13,8(REG13)
*        NEWID1 = TEMPID;                                          0346
*                                                                  0346
         L     @10,GDTTR1(,GDTPR)                                  0346
         MVC   NEWID1(4,@10),TEMPID                                0346
*        /************************************************************/
*        /*                                                          */
*        /* THE UEPIL ROUTINE AUTOMATIC STORAGE DOESN'T NEED TO BE   */
*        /* RELEASED AS IT IS USED OVER AGAIN--PLACE USER RETURN CODE*/
*        /* IN REGISTER 15, RESTORE REGISTERS FOR MODULE TO BE       */
*        /* RETURNED TO (EXCLUDING REGISTER 15), AND BRANCH          */
*        /* ON REGISTER 14 (RETURN TO THE MODULE THAT CALLED THE USER*/
*        /* OF THE UEPIL ROUTINE)                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0347
*        RESPECIFY (REG14,REG15) RSTD;                             0347
*        REG15 = SETRC;                                            0348
         LR    REG15,SETRC                                         0348
*        GEN(L     REG14,12(REG13));                               0349
         L     REG14,12(REG13)
*        GEN(LM    REG0,REG12,20(REG13));                          0350
         LM    REG0,REG12,20(REG13)
*        GEN(BR    REG14);                                         0351
         BR    REG14
*        RESPECIFY (REG13,REG14,REG15) UNRSTD;                     0352
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - GETCORE                                */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE GETS THE REQUESTED CORE AND   */
*        /*             PASSES BACK THE ADDRESS OF THIS CORE         */
*        /*                                                          */
*        /*  INPUT - PARAMETER LIST CONTAINING THE ADDRESS OF THE    */
*        /*          SIZE ARGUMENT AND THE ADDRESS OF A VARIABLE TO  */
*        /*          CONTAIN THE ADDRESS OF THE ACQUIRED CORE        */
*        /*                                                          */
*        /*  OUTPUT - THE ADDRESS OF THE ACQUIRED CORE               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0353
*GETCORE:  PROCEDURE(ZSIZE,ZPTR);                                  0353
*                                                                  0353
         B     @PB00002                                            0353
GETCORE  STM   @14,@08,@SA00002                                    0353
         STM   @10,@12,@SA00002+44                                 0353
         MVC   @PC00002(8),0(@01)                                  0353
*        DCL ZSIZE FIXED(31);          /* SIZE OF REQUESTED AREA     */
*                                                                  0354
*        DCL ZPTR PTR(31);             /* VARIABLE TO CONTAIN THE    */
*                                      /* ACQUIRED CORE ADDRESS      */
*                                                                  0356
*        /* GETMAIN MACRO LIST                                       */
*        DCL 1 GETLIST CHAR(10) BDY(WORD),                         0356
*              2 GETSZ FIXED(31),      /* GETMAIN SIZE               */
*              2 GETPT PTR(31),        /* ADDRESS OF AREA WHERE ADDR */
*                                      /* OF GOTTEN CORE IS TO BE PUT*/
*              2 GETFLG CHAR(2);       /* GETMAIN FLAGS              */
*                                                                  0356
*        DCL LIST1 GENERATED LABEL;    /* GETMAIN MACRO LIST LABEL   */
*                                                                  0357
*        DCL GETGEN CHAR(10) DEFINED(LIST1);                       0358
*                                      /* GENERATED LIST FORM OF     */
*                                      /* GETMAIN MACRO              */
*                                                                  0359
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0359
*        GETLIST = GETGEN;                                         0359
         MVC   GETLIST(10),GETGEN                                  0359
*        GETSZ = ZSIZE;                                            0360
         L     @10,@PC00002                                        0360
         L     @10,ZSIZE(,@10)                                     0360
         ST    @10,GETSZ                                           0360
*        GETPT = ADDR(ZPTR);                                       0361
         L     @10,@PC00002+4                                      0361
         ST    @10,GETPT                                           0361
*        RESPECIFY (REG1) RSTD;                                    0362
*        REG1 = ADDR(GETLIST);                                     0363
         LA    REG1,GETLIST                                        0363
*LGETM1: GEN(GETMAIN MF=(E,(REG1)));                               0364
LGETM1   GETMAIN MF=(E,(REG1))
*        RESPECIFY (REG1) UNRSTD;                                  0365
*                                                                  0365
*        /************************************************************/
*        /*                                                          */
*        /* CHECK RETURN CODE FROM CORE REQUEST                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0366
*        RESPECIFY (RTNREG) RSTD;                                  0366
*        IF RTNREG ^= 0                                            0367
*          THEN                                                    0367
         LTR   RTNREG,RTNREG                                       0367
         BZ    @RF00367                                            0367
*DELMOD:     DO;                                                   0368
*                                                                  0368
DELMOD   DS    0H                                                  0369
*            /********************************************************/
*            /*                                                      */
*            /*  CORE IS NEEDED AND NOT AVAILABLE                    */
*            /*  FREE MODULES NOT IN USE (USE CTR WILL BE            */
*            /*  ZERO) THEN TRY ONE MORE GETCORE                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0369
*              IX = 0;                                             0369
         SLR   IX,IX                                               0369
*              LOOPCTL = OFF;                                      0370
         NI    LOOPCTL,B'01111111'                                 0370
*                DO WHILE LOOPCTL = OFF;                           0371
*                                                                  0371
         B     @DE00371                                            0371
@DL00371 DS    0H                                                  0372
*                  IF IX = 0                                       0372
*                    THEN                                          0372
*                                                                  0372
         LTR   IX,IX                                               0372
         BNZ   @RF00372                                            0372
*                      /**********************************************/
*                      /*                                            */
*                      /*   FIRST TIME USE POINTER IN                */
*                      /*   SYSTEM HIST AREA TO LOAD                 */
*                      /*   LIST BLOCK                               */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0373
*                      P = LLBLKPTR;                               0373
         L     @14,GDTSAH(,GDTPR)                                  0373
         L     P,LLBLKPTR(,@14)                                    0373
*                    ELSE;                                         0374
*                                                                  0374
@RF00372 DS    0H                                                  0375
*                  /*****************************************        */
*                  /*                                                */
*                  /*  SEARCH EACH LOAD LIST BLOCK WHEN              */
*                  /*  MODULE NAME IS IN SLOT AND  USE CTR           */
*                  /*  IS ZERO THEN DELETE MODULE FROM CORE          */
*                  /*                                                */
*                  /*****************************************        */
*                                                                  0375
*                  DO IX = 1 TO LLSLTCNT;                          0375
         LA    IX,1                                                0375
@DL00375 DS    0H                                                  0376
*                    IF LLNOMOD(IX) = 0  LLUSECTR(IX) ^= 0        0376
*                                                                  0376
*                      THEN;                                       0376
         SLR   @14,@14                                             0376
         LR    @10,IX                                              0376
         SLA   @10,4                                               0376
         LR    @08,P                                               0376
         AL    @08,@CF00598                                        0376
         C     @14,LLNOMOD-12(@10,@08)                             0376
         BE    @RT00376                                            0376
         SLR   @08,@08                                             0376
         IC    @08,LLUSECTR-16(@10,P)                              0376
         CR    @14,@08                                             0376
         BNE   @RT00376                                            0376
*                      ELSE                                        0378
*                        DO;                                       0378
*                          RFY REG0 RSTD;                          0379
*                          REG0 = ADDR(LLNAME(IX));                0380
         LR    @14,IX                                              0380
         SLA   @14,4                                               0380
         AL    @14,@CF00597                                        0380
         LA    REG0,LLNAME-8(@14,P)                                0380
*LDEL1:                    GEN(DELETE  EPLOC=(REG0));              0381
LDEL1    DELETE  EPLOC=(REG0)
*                          RFY REG0 UNRSTD;                        0382
*                          LLNOMOD(IX) = 0;                        0383
         LR    @14,IX                                              0383
         SLA   @14,4                                               0383
         SLR   @10,@10                                             0383
         LR    @08,P                                               0383
         AL    @08,@CF00598                                        0383
         ST    @10,LLNOMOD-12(@14,@08)                             0383
*                          LLNXTSLT(IX) = LLFSTSLT;                0384
         L     @10,LLFSTSLT(,P)                                    0384
         LR    @08,P                                               0384
         AL    @08,@CF00597                                        0384
         ST    @10,LLNXTSLT-8(@14,@08)                             0384
*                          LLFSTSLT = ADDR(LLNXTSLT(IX));          0385
         AL    @14,@CF00597                                        0385
         LA    @14,LLNXTSLT-8(@14,P)                               0385
         ST    @14,LLFSTSLT(,P)                                    0385
*                        END;                                      0386
*                  END;                                            0387
@RT00376 AL    IX,@CF00157                                         0387
         C     IX,@CF00278                                         0387
         BNH   @DL00375                                            0387
*                  IF LLNXTBLK = 0                                 0388
*                    THEN                                          0388
         L     @14,LLNXTBLK(,P)                                    0388
         LTR   @14,@14                                             0388
         BNZ   @RF00388                                            0388
*                      LOOPCTL = ON;                               0389
         OI    LOOPCTL,B'10000000'                                 0389
*                    ELSE                                          0390
*                      P = LLNXTBLK;                               0390
         B     @RC00388                                            0390
@RF00388 L     P,LLNXTBLK(,P)                                      0390
*                END;                                              0391
@RC00388 DS    0H                                                  0391
@DE00371 TM    LOOPCTL,B'10000000'                                 0391
         BZ    @DL00371                                            0391
*               /********************************************        */
*               /*                                                   */
*               /*  TRY TO GET CORE AGAIN NOW THAT                   */
*               /*  SOME MODULES HAVE BEEN DELETED                   */
*               /*                                                   */
*               /********************************************        */
*                                                                  0392
*               RESPECIFY (REG1) RSTD;                             0392
*               REG1 = ADDR(GETLIST);                              0393
         LA    REG1,GETLIST                                        0393
*LGETM1X:       GEN(GETMAIN MF=(E,(REG1)));                        0394
LGETM1X  GETMAIN MF=(E,(REG1))
*               RESPECIFY (REG1) UNRSTD;                           0395
*                                                                  0395
*                 /******************************************        */
*                 /*                                                 */
*                 /* CHECK RETURN CODE FROM GET CORE REQUEST         */
*                 /*                                                 */
*                 /******************************************        */
*                                                                  0396
*                 IF RTNREG ^= 0                                   0396
*                   THEN                                           0396
*                                                                  0396
         LTR   RTNREG,RTNREG                                       0396
         BZ    @RF00396                                            0396
*                     DO;                                          0397
*                       RESPECIFY(REG13,REG14,REG15) RSTD;         0398
*                       REG15 = NOSPACE;                           0399
         LA    REG15,28                                            0399
*                       REG14 = GDTABT;                            0400
         L     REG14,GDTABT(,GDTPR)                                0400
*                       REG13 = GDTABH;                            0401
         L     REG13,GDTABH(,GDTPR)                                0401
*                       GEN(BR    REG14);                          0402
         BR    REG14
*                       RESPECIFY(REG13,REG14,REG15)UNRSTD;        0403
*                     END;                                         0404
*                   ELSE;                                          0405
@RF00396 DS    0H                                                  0406
*            END DELMOD;                                           0406
*          ELSE;                                                   0407
@RF00367 DS    0H                                                  0408
*        RESPECIFY (RTNREG) UNRSTD;                                0408
*        END GETCORE;                                              0409
@EL00002 DS    0H                                                  0409
@EF00002 DS    0H                                                  0409
@ER00002 LM    @14,@08,@SA00002                                    0409
         LM    @10,@12,@SA00002+44                                 0409
         BR    @14                                                 0409
@PB00002 DS    0H                                                  0410
*        /************************************************************/
*        /*                                                          */
*        /* LIST FORM OF GETMAIN MACRO - MOVED INTO A DYNAMIC AREA   */
*        /* FOR USE                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0410
*        GENERATE DATA;                                            0410
*                                                                  0410
*                                                                  0410
*        /************************************************************/
*        /*                                                          */
*        /* DECLARATIONS ALLOWING MODULE ICKSA01 ACCESS TO THIS      */
*        /* MODULE'S AUTOMATIC STORAGE SIZE VALUE                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0411
*        GENERATE DATA;                                            0411
*        RESPECIFY (REG2,REG3,REG4) UNRSTD;                        0412
*        END ICKSA03                                               0413
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF09 )                                        *
*;                                                                 0413
@EL00001 L     @13,4(,@13)                                         0413
@EF00001 L     @00,@SIZDATD                                        0413
         LR    @01,@11                                             0413
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0413
         BR    @14                                                 0413
@DATA    DS    0H
@CH00032 DC    H'12'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
@SA00002 DS    14F
@PC00002 DS    2F
@AL00001 DS    2A
@TF00001 DS    F
ICKSA03  CSECT
         DS    0F
@CF00086 DC    F'0'
@CF00157 DC    F'1'
@CF00128 DC    F'3'
@CF00036 DC    F'4'
@CF00111 DC    F'6'
@CF00153 DC    F'8'
@CF00278 DC    F'24'
@CF00559 DC    F'255'
@CF00595 DC    F'-12'
@CF00597 DC    F'-8'
@CF00598 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
TEMPSIZE DS    F
TEMPPTR  DS    A
DELPARM  DS    F
LISTPTR  DS    A
TESTRC   DS    H
@TS00001 DS    CL95
DOCNTRL  DS    BL1
TEMPEPN  DS    CL8
TEMPID   DS    CL4
NAMEFND  DS    BL1
LOOPCTL  DS    BL1
GETLIST  DS    CL10
         ORG   GETLIST
GETSZ    DS    FL4
GETPT    DS    AL4
GETFLG   DS    CL2
         ORG   GETLIST+10
         DS    CL2
PROLSAV  DS    CL44
ICKSA03  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00571 DC    C'ICK     '
@CC00493 DC    C'SA03'
@CC00566 DC    C'SA02'
@CC00567 DC    C'DB01'
@CC00568 DC    C'EX01'
@CC00569 DC    C'TP01'
@CC00570 DC    C'IO01'
FIXAREA  DS    CL150
         ORG   FIXAREA
@NM00018 DC    150X'00'
         ORG   FIXAREA+150
IDENT    DC    CL4'SA03'
@DATD    DSECT
ICKSA03 CSECT
LIST1   GETMAIN EC,LV=8,A=LIST1,MF=L
@DATD    DSECT
ICKSA03 CSECT
ICKSAS3 DC    A(@SIZDATD)
        ENTRY ICKSAS3
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKSA03  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
IX       EQU   @05
P        EQU   @09
I        EQU   @06
RTNADDR  EQU   @10
RTNSAVE  EQU   @10
SETRC    EQU   @07
LISTLN   EQU   @05
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
GDTPR    EQU   @02
MODIDPR  EQU   @03
SIZEPR   EQU   @04
RCODEPR  EQU   @04
SAVEPTR  EQU   @13
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTSAH   EQU   GDTTBL+32
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+160
GDTSPR   EQU   GDTTBL+164
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
NEWID1   EQU   TRACE1+95
NEWERID1 EQU   5
TRACE2   EQU   0
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
LISTTEST EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
DMPITM   EQU   0
DMPARY   EQU   0
MODID    EQU   0
PSIZE    EQU   0
RCODE    EQU   0
@NM00019 EQU   0
AUTOSIZE EQU   @NM00019
AUTOID   EQU   @NM00019+4
SAVEFWD  EQU   0
LLBLK    EQU   0
LLHDR    EQU   LLBLK
LLFSTSLT EQU   LLHDR
LLNXTBLK EQU   LLHDR+4
LLSLOT   EQU   LLBLK+8
LLNAME   EQU   LLSLOT
LLNXTSLT EQU   LLNAME
LLNOMOD  EQU   LLNAME+4
LLUSECTR EQU   LLSLOT+12
SAHIST   EQU   0
AUTOPTR  EQU   SAHIST+8
LLBLKPTR EQU   SAHIST+16
AUTOTBL  EQU   0
AUTOARAY EQU   AUTOTBL
AREAID   EQU   AUTOARAY
STATUS   EQU   AUTOARAY+4
PTR1     EQU   AUTOARAY+8
DMPTRM   EQU   0
ICKDB010 EQU   0
ICKDVCL0 EQU   0
ICKDVIN0 EQU   0
ICKDVON0 EQU   0
ICKDVOP0 EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSACL0 EQU   0
ICKSADE0 EQU   0
ICKSAEP0 EQU   0
ICKSAFP0 EQU   0
ICKSAFS0 EQU   0
ICKSAGP0 EQU   0
ICKSAGS0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPPR0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
NEWERID2 EQU   5
RESOLVE  EQU   0
MODIDX   EQU   0
PSIZEX   EQU   0
GDTTBLX  EQU   0
RCODEX   EQU   0
ZSIZE    EQU   0
ZPTR     EQU   0
GETGEN   EQU   LIST1
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ASIZE    EQU   AUTOARAY+6
SAHSTA   EQU   SAHIST+12
GPLAST   EQU   SAHIST+4
GPFIRST  EQU   SAHIST
LLMODSZ  EQU   LLSLOT+13
LLADDR   EQU   LLSLOT+8
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID2   EQU   TRACE2+95
OLDERID2 EQU   TRACE2
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
GDTCVR   EQU   GDTTBL+184
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00329 EQU   @RC00325
@ENDDATA EQU   *
         END   ICKSA03,(C'PLS1739',0701,78192)

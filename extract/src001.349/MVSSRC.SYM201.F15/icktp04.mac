         TITLE '**********  DMS PAGE CONTROL MODULE  **********        *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKTP04  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'ICKTP04   78.192'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @11,0                                               0002
@PSTART  LA    @12,4095(,@11)                                      0002
         USING @PSTART,@11                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @10,@01                                             0002
         USING @DATD,@10                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @10,8(,@13)                                         0002
         LR    @13,@10                                             0002
         MVC   @PC00001(40),0(@01)                                 0002
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0222
         LA    LISTLN,1                                            0222
@DL00222 L     @09,LISTSCAN                                        0222
         TM    LISTTEST(@09),B'10000000'                           0222
         BNZ   @DC00222                                            0222
*          LISTSCAN = LISTSCAN + 4;                                0223
         AL    @09,@CF00055                                        0223
         ST    @09,LISTSCAN                                        0223
*        END;                                                      0224
*                                                                  0224
         AL    LISTLN,@CF00178                                     0224
         C     LISTLN,@CF00640                                     0224
         BNH   @DL00222                                            0224
@DC00222 DS    0H                                                  0225
*         IF MACARG = ('STS')                                      0225
*           THEN                                                   0225
         L     @09,@PC00001+4                                      0225
         CLC   MACARG(3,@09),@CC00641                              0225
         BNE   @RF00225                                            0225
*             DO;                                                  0226
*               CALL ESTSCONT(ARG1);                               0227
         L     @09,@PC00001+12                                     0227
         ST    @09,@AL00001                                        0227
         LA    @01,@AL00001                                        0227
         BAL   @14,ESTSCONT                                        0227
*               RESPECIFY RTNREG RSTD;                             0228
*               TESTRC = RTNREG;                                   0229
         LR    TESTRC,RTNREG                                       0229
*               RESPECIFY RTNREG UNRSTD;                           0230
*               SETRC = TESTRC;                                    0231
         STH   TESTRC,SETRC                                        0231
*             END;                                                 0232
*         IF MACARG = ('STA')                                      0233
*           THEN                                                   0233
@RF00225 L     @09,@PC00001+4                                      0233
         CLC   MACARG(3,@09),@CC00643                              0233
         BNE   @RF00233                                            0233
*             DO;                                                  0234
*               CALL ESTACONT(ARG1);                               0235
         L     @09,@PC00001+12                                     0235
         ST    @09,@AL00001                                        0235
         LA    @01,@AL00001                                        0235
         BAL   @14,ESTACONT                                        0235
*               RESPECIFY RTNREG RSTD;                             0236
*               TESTRC = RTNREG;                                   0237
         LR    TESTRC,RTNREG                                       0237
*               RESPECIFY RTNREG UNRSTD;                           0238
*               SETRC = TESTRC;                                    0239
         STH   TESTRC,SETRC                                        0239
*             END;                                                 0240
*         IF MACARG = ('RES')                                      0241
*           THEN                                                   0241
@RF00233 L     @09,@PC00001+4                                      0241
         CLC   MACARG(3,@09),@CC00645                              0241
         BNE   @RF00241                                            0241
*             DO;                                                  0242
*               CALL RESTCONT;                                     0243
         BAL   @14,RESTCONT                                        0243
*               RESPECIFY RTNREG RSTD;                             0244
*               TESTRC = RTNREG;                                   0245
         LR    TESTRC,RTNREG                                       0245
*               RESPECIFY RTNREG UNRSTD;                           0246
*               SETRC = TESTRC;                                    0247
         STH   TESTRC,SETRC                                        0247
*             END;                                                 0248
*         IF MACARG = ('RST')                                      0249
*           THEN                                                   0249
@RF00241 L     @09,@PC00001+4                                      0249
         CLC   MACARG(3,@09),@CC00647                              0249
         BNE   @RF00249                                            0249
*             DO;                                                  0250
*               IF LISTLN = 5 & ARG1 ^= NULLPTR                    0251
*                 THEN                                             0251
         C     LISTLN,@CF00268                                     0251
         BNE   @RF00251                                            0251
         L     @09,@PC00001+12                                     0251
         L     @09,ARG1(,@09)                                      0251
         LTR   @09,@09                                             0251
         BZ    @RF00251                                            0251
*                   PGNOF = ON;                                    0252
         OI    PGNOF,B'01000000'                                   0252
*                 ELSE                                             0253
*                   PGNOF = OFF;                                   0253
         B     @RC00251                                            0253
@RF00251 NI    PGNOF,B'10111111'                                   0253
*               CALL RESETCON(ARG1);                               0254
@RC00251 L     @03,@PC00001+12                                     0254
         ST    @03,@AL00001                                        0254
         LA    @01,@AL00001                                        0254
         BAL   @14,RESETCON                                        0254
*               RESPECIFY RTNREG RSTD;                             0255
*               TESTRC = RTNREG;                                   0256
         LR    TESTRC,RTNREG                                       0256
*               RESPECIFY RTNREG UNRSTD;                           0257
*               SETRC = TESTRC;                                    0258
         STH   TESTRC,SETRC                                        0258
*             END;                                                 0259
*         CALL ICKSAEP0(GDTTBL,MODID,SETRC);                       0260
@RF00249 L     @03,@PC00001                                        0260
         ST    @03,@AL00001                                        0260
         LA    @15,MODID                                           0260
         ST    @15,@AL00001+4                                      0260
         LA    @15,SETRC                                           0260
         ST    @15,@AL00001+8                                      0260
         MVI   @AL00001+8,X'80'                                    0260
         L     @15,GDTEPL(,@03)                                    0260
         LA    @01,@AL00001                                        0260
         BALR  @14,@15                                             0260
*                                                                  0261
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - ESTS HANDLER                           */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE CONTROLS THE ESTABLISHMENT    */
*         /* OF THE PRINT CONTROL TABLE THRU USE OF THE (UESTS)      */
*         /* MACRO.  IT ALSO OPENS THE PRINT DATA SET.               */
*         /*                                                         */
*         /* INPUT - A STATIC TEXT IDENTIFIER (STID) IDENTIFYING     */
*         /* THE NON-DEFAULT DATA TO BE SET IN THAT TABLE.           */
*         /*                                                         */
*         /* OUTPUT - A PRINT CONTROL TABLE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0261
*ESTSCONT: PROC (STIDS);                                           0261
*                                                                  0261
@EL00001 L     @13,4(,@13)                                         0261
@EF00001 L     @00,@SIZDATD                                        0261
         LR    @01,@10                                             0261
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0261
         BR    @14                                                 0261
ESTSCONT STM   @14,@12,@SA00002                                    0261
         MVC   @PC00002(4),0(@01)                                  0261
*         /***********************************************************/
*         /*                                                         */
*         /* GET THE CORE FOR THE PCT AND INITIALIZE IT.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0262
*         SAVERC = 0;                                              0262
         SLR   SAVERC,SAVERC                                       0262
*         PCTPTR = GDTTPH;                                         0263
         L     @06,@PC00001                                        0263
         L     @06,GDTTPH(,@06)                                    0263
         LR    PCTPTR,@06                                          0263
*         IF GDTTPH = NULLPTR                                      0264
*           THEN                                                   0264
         LTR   @06,@06                                             0264
         BNZ   @RF00264                                            0264
*             PRIPCT = ON;                                         0265
         OI    PRIPCT,B'10000000'                                  0265
*           ELSE                                                   0266
*             PRIPCT = OFF;                                        0266
         B     @RC00264                                            0266
@RF00264 NI    PRIPCT,B'01111111'                                  0266
*         OLDERID2 = NEWERID2;                                     0267
@RC00264 L     @06,@PC00001                                        0267
         L     @06,GDTTR2(,@06)                                    0267
         MVC   @TS00001(95),NEWERID2(@06)                          0267
         MVC   OLDERID2(95,@06),@TS00001                           0267
*         NEWID2 = 'TP4I';                                         0268
*                                                                  0268
         MVC   NEWID2(4,@06),@CC00654                              0268
*         IF PRIPCT = OFF & PCTSPP ^= NULLPTR                      0269
*           THEN                                                   0269
         TM    PRIPCT,B'10000000'                                  0269
         BNZ   @RF00269                                            0269
         L     @06,PCTSPP(,PCTPTR)                                 0269
         LTR   @06,@06                                             0269
         BZ    @RF00269                                            0269
*             PCTPTR = PCTSPP;                                     0270
*                                                                  0270
         LR    PCTPTR,@06                                          0270
*         CALL INITPCT;                                            0271
*                                                                  0271
@RF00269 BAL   @14,INITPCT                                         0271
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE REQUEST IS FOR A PRIMARY PRINT CONTROL TABLE,    */
*         /* THEN THE STANDARD SYSPRINT TABLE MUST BE OPENED.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0272
*         IF PRIPCT = ON                                           0272
*           THEN                                                   0272
         TM    PRIPCT,B'10000000'                                  0272
         BNO   @RF00272                                            0272
*             DO;                                                  0273
*               OPNPTR = ADDR(PROPEN);  /* SET OPNAGL ADDRESS.       */
         LA    OPNPTR,PROPEN                                       0274
*               OPNAGL = ''B;           /* SET OPEN LIST TO ZEROS.   */
         XC    OPNAGL(32,OPNPTR),OPNAGL(OPNPTR)                    0275
*               OPNTYPSO = ON;          /* SYSTEM OUTPUT FLAG.       */
         OI    OPNTYPSO(OPNPTR),B'01000000'                        0276
*               OPNIOC = ADDR(PCTIOC);  /* IOC ADDRESS PTR.          */
         LA    @06,PCTIOC(,PCTPTR)                                 0277
         ST    @06,OPNIOC(,OPNPTR)                                 0277
*               OPNMODAC = ON;          /* ASA CARRIAGE CONTROL CHAR */
*                                                                  0278
         OI    OPNMODAC(OPNPTR),B'10000000'                        0278
*               CALL ICKIOOP0 (GDTTBL,OPNAGL);                     0279
*                                                                  0279
         L     @06,@PC00001                                        0279
         ST    @06,@AL00001                                        0279
         ST    OPNPTR,@AL00001+4                                   0279
         MVI   @AL00001+4,X'80'                                    0279
         L     @15,GDTOPN(,@06)                                    0279
         LA    @01,@AL00001                                        0279
         BALR  @14,@15                                             0279
*               OLDERID2 = NEWERID2;                               0280
         L     @06,@PC00001                                        0280
         L     @04,GDTTR2(,@06)                                    0280
         MVC   @TS00001(95),NEWERID2(@04)                          0280
         MVC   OLDERID2(95,@04),@TS00001                           0280
*               NEWID2 = 'TP4A';                                   0281
*                                                                  0281
         MVC   NEWID2(4,@04),@CC00658                              0281
*               /*****************************************************/
*               /*                                                   */
*               /* GET STORAGE FOR THE PRINT LINE STACK BUFFER.      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0282
*               CALL ICKSAGS0 (GDTTBL,PRBUFL,PCTBUF);              0282
         ST    @06,@AL00001                                        0282
         LA    @04,PRBUFL                                          0282
         ST    @04,@AL00001+4                                      0282
         LA    @04,PCTBUF(,PCTPTR)                                 0282
         ST    @04,@AL00001+8                                      0282
         MVI   @AL00001+8,X'80'                                    0282
         L     @15,GDTGSP(,@06)                                    0282
         LA    @01,@AL00001                                        0282
         BALR  @14,@15                                             0282
*               RESPECIFY RTNREG RSTD;                             0283
*               TESTRC = RTNREG;                                   0284
         LR    TESTRC,RTNREG                                       0284
*               RESPECIFY RTNREG UNRSTD;                           0285
*               IF TESTRC ^= 0                                     0286
*                 THEN                                             0286
*                                                                  0286
         LTR   TESTRC,TESTRC                                       0286
         BZ    @RF00286                                            0286
*                   DO;                                            0287
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0288
*                     REG15 = 28;                                  0289
         LA    REG15,28                                            0289
*                     REG14 = GDTABT;                              0290
         L     @06,@PC00001                                        0290
         L     REG14,GDTABT(,@06)                                  0290
*                     REG13 = GDTABH;                              0291
         L     REG13,GDTABH(,@06)                                  0291
*                     GEN(BR    REG14);                            0292
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0293
*                   END;                                           0294
*               PCTBNL = PCTBUF;                                   0295
@RF00286 L     @06,PCTBUF(,PCTPTR)                                 0295
         ST    @06,PCTBNL(,PCTPTR)                                 0295
*            END;                                                  0296
*                                                                  0296
*         /***********************************************************/
*         /*                                                         */
*         /* GET THE STATIC TEXT ENTRY FOR THE REQUEST.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0297
*         CALL ICKSACL0 (GDTTBL,'ICKTP05 ',STIDS,SUBPZ,PCAADDR);   0297
*                                                                  0297
@RF00272 L     @06,@PC00001                                        0297
         ST    @06,@AL00001                                        0297
         LA    @04,@CC00659                                        0297
         ST    @04,@AL00001+4                                      0297
         L     @04,@PC00002                                        0297
         ST    @04,@AL00001+8                                      0297
         LA    @04,SUBPZ                                           0297
         ST    @04,@AL00001+12                                     0297
         LA    @04,PCAADDR                                         0297
         ST    @04,@AL00001+16                                     0297
         MVI   @AL00001+16,X'80'                                   0297
         L     @15,GDTCAL(,@06)                                    0297
         LA    @01,@AL00001                                        0297
         BALR  @14,@15                                             0297
*         RESPECIFY RTNREG RSTD;                                   0298
*         TESTRC = RTNREG;                                         0299
         LR    TESTRC,RTNREG                                       0299
*         RESPECIFY RTNREG UNRSTD;                                 0300
*         IF TESTRC ^= 0                                           0301
*           THEN                                                   0301
         LTR   TESTRC,TESTRC                                       0301
         BZ    @RF00301                                            0301
*             RETURN CODE(TESTRC);                                 0302
         LR    @15,TESTRC                                          0302
         L     @14,@SA00002                                        0302
         LM    @00,@12,@SA00002+8                                  0302
         BR    @14                                                 0302
*         /***********************************************************/
*         /*                                                         */
*         /*  SET UP THE ADDRESSES FROM THE OFFSETS.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0303
*         IF PCMTLP ^= NULLPTR                                     0303
*           THEN                                                   0303
@RF00301 L     @06,PCAADDR                                         0303
         L     @04,PCMTLP(,@06)                                    0303
         LTR   @04,@04                                             0303
         BZ    @RF00303                                            0303
*             PCMTLP = PCMTLP + PCAADDR;                           0304
         ALR   @04,@06                                             0304
         ST    @04,PCMTLP(,@06)                                    0304
*         IF PCSTLP ^= NULLPTR                                     0305
*           THEN                                                   0305
@RF00303 L     @06,PCAADDR                                         0305
         L     @04,PCSTLP(,@06)                                    0305
         LTR   @04,@04                                             0305
         BZ    @RF00305                                            0305
*             PCSTLP = PCSTLP + PCAADDR;                           0306
         ALR   @04,@06                                             0306
         ST    @04,PCSTLP(,@06)                                    0306
*         IF PCFLP ^= NULLPTR                                      0307
*           THEN                                                   0307
@RF00305 L     @06,PCAADDR                                         0307
         L     @04,PCFLP(,@06)                                     0307
         LTR   @04,@04                                             0307
         BZ    @RF00307                                            0307
*             PCFLP = PCFLP + PCAADDR;                             0308
         ALR   @04,@06                                             0308
         ST    @04,PCFLP(,@06)                                     0308
*         IF PCPCP ^= NULLPTR                                      0309
*           THEN                                                   0309
@RF00307 L     @06,PCAADDR                                         0309
         L     @04,PCPCP(,@06)                                     0309
         LTR   @04,@04                                             0309
         BZ    @RF00309                                            0309
*             PCPCP = PCPCP + PCAADDR;                             0310
*                                                                  0310
         ALR   @04,@06                                             0310
         ST    @04,PCPCP(,@06)                                     0310
*         /***********************************************************/
*         /*                                                         */
*         /*  THE INPUT PARAMETER LIST IS SET UP.  CALL THE PROCEDURE*/
*         /*  TO INITIALIZE THE PARAMETERS.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0311
*         CALL P04SETUP;                                           0311
*                                                                  0311
@RF00309 BAL   @14,P04SETUP                                        0311
*         /***********************************************************/
*         /*                                                         */
*         /* CALL THE ROUTINE TO SET UP THE PARAMETERS IN THE PCT    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0312
*         CALL PCTSETUP;                                           0312
*                                                                  0312
         BAL   @14,PCTSETUP                                        0312
*         RESPECIFY RTNREG RSTD;                                   0313
*         TESTRC = RTNREG;                                         0314
         LR    TESTRC,RTNREG                                       0314
*         RESPECIFY RTNREG UNRSTD;                                 0315
*         SAVERC = TESTRC;                                         0316
*                                                                  0316
         LR    SAVERC,TESTRC                                       0316
*         IF GDTDBG = NULLPTR                                      0317
*           THEN;                                                  0317
         L     @06,@PC00001                                        0317
         L     @06,GDTDBG(,@06)                                    0317
         LTR   @06,@06                                             0317
         BZ    @RT00317                                            0317
*           ELSE                                                   0319
*             CALL ICKDB010  (GDTTBL,'TP4S');                      0319
*                                                                  0319
         L     @06,@PC00001                                        0319
         ST    @06,@AL00001                                        0319
         LA    @03,@CC00662                                        0319
         ST    @03,@AL00001+4                                      0319
         MVI   @AL00001+4,X'80'                                    0319
         L     @15,GDTDBG(,@06)                                    0319
         LA    @01,@AL00001                                        0319
         BALR  @14,@15                                             0319
*         CALL ICKSAFS0 (GDTTBL,PCAADDR);/*                        0320
*                                          FREE STATIC TEXT CORE.    */
*                                                                  0320
@RT00317 L     @06,@PC00001                                        0320
         ST    @06,@AL00001                                        0320
         LA    @03,PCAADDR                                         0320
         ST    @03,@AL00001+4                                      0320
         L     @15,GDTFSP(,@06)                                    0320
         LA    @01,@AL00001                                        0320
         BALR  @14,@15                                             0320
*         RETURN CODE(SAVERC);                                     0321
         LR    @15,SAVERC                                          0321
         L     @14,@SA00002                                        0321
         LM    @00,@12,@SA00002+8                                  0321
         BR    @14                                                 0321
*         END ESTSCONT;                                            0322
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - ESTA HANDLER.                          */
*         /*                                                         */
*         /* FUNCTION - ESTABLISHES A PRINT CONTROL TABLE FROM THE   */
*         /* ARGUMENTS PASSED WITH THE CALL.  STATIC TEXT IS NOT     */
*         /* REFERENCED IN THIS TYPE OF CALL.                        */
*         /*                                                         */
*         /* INPUT - THE ARGUMENT LIST DEFINED BY PCALIST IN THIS    */
*         /* PROCEDURE.                                              */
*         /*                                                         */
*         /* OUTPUT - A PRINT CONTROL TABLE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0323
*ESTACONT: PROC (PCALIST);                                         0323
*                                                                  0323
ESTACONT STM   @14,@12,@SA00003                                    0323
         MVC   @PC00003(4),0(@01)                                  0323
*         SAVERC = 0;                                              0324
         SLR   SAVERC,SAVERC                                       0324
*         PCTPTR = GDTTPH;                                         0325
*                                                                  0325
         L     @06,@PC00001                                        0325
         L     @06,GDTTPH(,@06)                                    0325
         LR    PCTPTR,@06                                          0325
*         PCAADDR = ADDR(PCALIST);     /* SET STRUCTURE ADDRESS      */
*                                                                  0326
         L     @04,@PC00003                                        0326
         ST    @04,PCAADDR                                         0326
*         /***********************************************************/
*         /*                                                         */
*         /* GET AND INITIALIZE THE PRINT CONTROL TABLE AREA.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0327
*         IF GDTTPH = NULLPTR                                      0327
*           THEN                                                   0327
         LTR   @06,@06                                             0327
         BNZ   @RF00327                                            0327
*             PRIPCT = ON;              /* PRIMARY CONTROL TABLE ON. */
         OI    PRIPCT,B'10000000'                                  0328
*           ELSE                                                   0329
*             PRIPCT = OFF;             /* PRIMARY CONTROL TABLE OFF */
         B     @RC00327                                            0329
@RF00327 NI    PRIPCT,B'01111111'                                  0329
*         IF PRIPCT = OFF & PCTSPP ^= NULLPTR                      0330
*           THEN                                                   0330
@RC00327 TM    PRIPCT,B'10000000'                                  0330
         BNZ   @RF00330                                            0330
         L     @06,PCTSPP(,PCTPTR)                                 0330
         LTR   @06,@06                                             0330
         BZ    @RF00330                                            0330
*             PCTPTR = PCTSPP;                                     0331
*                                                                  0331
         LR    PCTPTR,@06                                          0331
*         CALL INITPCT;                /* GET CORE FOR THE PCT.     */
*                                                                  0332
@RF00330 BAL   @14,INITPCT                                         0332
*         /***********************************************************/
*         /*                                                         */
*         /*  CALL THE PROCEDURE TO INITIALIZE THE PARAMETERS.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0333
*         CALL P04SETUP;                                           0333
*                                                                  0333
         BAL   @14,P04SETUP                                        0333
*         /***********************************************************/
*         /*                                                         */
*         /*  CALL THE ROUTINE TO SET UP THE PARAMETERS IN THE PCT   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0334
*         CALL PCTSETUP;                                           0334
*                                                                  0334
         BAL   @14,PCTSETUP                                        0334
*         RESPECIFY RTNREG RSTD;                                   0335
*         TESTRC = RTNREG;                                         0336
         LR    TESTRC,RTNREG                                       0336
*         RESPECIFY RTNREG UNRSTD;                                 0337
*         SAVERC = TESTRC;                                         0338
*                                                                  0338
         LR    SAVERC,TESTRC                                       0338
*         IF GDTDBG = NULLPTR                                      0339
*           THEN;                                                  0339
         L     @06,@PC00001                                        0339
         L     @06,GDTDBG(,@06)                                    0339
         LTR   @06,@06                                             0339
         BZ    @RT00339                                            0339
*           ELSE                                                   0341
*             CALL ICKDB010  (GDTTBL,'TP4A');                      0341
*                                                                  0341
         L     @06,@PC00001                                        0341
         ST    @06,@AL00001                                        0341
         LA    @03,@CC00658                                        0341
         ST    @03,@AL00001+4                                      0341
         MVI   @AL00001+4,X'80'                                    0341
         L     @15,GDTDBG(,@06)                                    0341
         LA    @01,@AL00001                                        0341
         BALR  @14,@15                                             0341
*         RETURN CODE(SAVERC);                                     0342
@RT00339 LR    @15,SAVERC                                          0342
         L     @14,@SA00003                                        0342
         LM    @00,@12,@SA00003+8                                  0342
         BR    @14                                                 0342
*         END ESTACONT;                                            0343
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - PRINT WORK TABLE INITIALIZATION.       */
*         /*                                                         */
*         /* FUNCTION - INITIALIZES MOST OF THE DEFAULT VALUES IN    */
*         /* IN THE PRINT WORK TABLE.                                */
*         /* THIS PROCEDURE IS CALLED FROM THE TP04A & TP04B         */
*         /* PROCEDURES AND MOVES THE INPUT ARGUMENTS INTO THE       */
*         /* COMMON WORK TABLE SO THEY CAN BE MORE EFFICIENTLY       */
*         /* HANDLED.                                                */
*         /*                                                         */
*         /* INPUT - NONE.                                           */
*         /*                                                         */
*         /* OUTPUT - A PARTIALLY INITIALIZED PRINT WORK TABLE.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0344
*P04SETUP: PROC;                                                   0344
*                                                                  0344
P04SETUP STM   @14,@12,12(@13)                                     0344
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE WORKING PARAMETER TABLE.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0345
*         P04WT = ''B;                                             0345
         XC    P04WT(42),P04WT                                     0345
*         P04MTP = PCMTLP;              /* SET MAIN TITLE LINE PTR   */
         L     @03,PCAADDR                                         0346
         L     @15,PCMTLP(,@03)                                    0346
         ST    @15,P04MTP                                          0346
*         P04MTC = PCMTLC;              /* SET MAIN TITLE LINE COUNT */
         LH    @15,PCMTLC(,@03)                                    0347
         STH   @15,P04MTC                                          0347
*         P04STP = PCSTLP;              /* SET SUB-TITLE LINE PTR    */
         L     @15,PCSTLP(,@03)                                    0348
         ST    @15,P04STP                                          0348
*         P04STC = PCSTLC;              /* SET SUB-TITLE LINE COUNT  */
         LH    @15,PCSTLC(,@03)                                    0349
         STH   @15,P04STC                                          0349
*         P04FP = PCFLP;                /* SET FOOTING LINE PTR      */
         L     @15,PCFLP(,@03)                                     0350
         ST    @15,P04FP                                           0350
*         P04FC = PCFLC;                /* SET FOOTING LINE COUNT    */
         LH    @15,PCFLC(,@03)                                     0351
         STH   @15,P04FC                                           0351
*         P04PCP = PCPCP;               /* SET CHAIN POINTER.        */
         L     @15,PCPCP(,@03)                                     0352
         ST    @15,P04PCP                                          0352
*         P04PNL = PCPNL;               /* SET PAGE NUMBER LOCATION  */
         LH    @15,PCPNL(,@03)                                     0353
         STH   @15,P04PNL                                          0353
*         P04TL = PCPTL;                /* SET TIME LOCATION         */
         LH    @15,PCPTL(,@03)                                     0354
         STH   @15,P04TL                                           0354
*         P04DL = PCPDL;                /* SET DATE LOCATION         */
         LH    @15,PCPDL(,@03)                                     0355
         STH   @15,P04DL                                           0355
*         P04LW = PCLW;                 /* SET THE LINE WIDTH.       */
         LH    @15,PCLW(,@03)                                      0356
         STH   @15,P04LW                                           0356
*         P04PD = PCPD;                 /* SET PAGE DEPTH            */
         LH    @15,PCPD(,@03)                                      0357
         STH   @15,P04PD                                           0357
*         P04DSC = PCDSC;               /* SET DEFAULT SPACE CHAR    */
         SLR   @15,@15                                             0358
         IC    @15,PCDSC(,@03)                                     0358
         STH   @15,P04DSC                                          0358
*         END P04SETUP;                                            0359
@EL00004 DS    0H                                                  0359
@EF00004 DS    0H                                                  0359
@ER00004 LM    @14,@12,12(@13)                                     0359
         BR    @14                                                 0359
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - REST HANDLER.                          */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE CONTROL THE SETTING UP OF     */
*         /* PARAMETERS IN THE PRINT CONTROL TABLE PASSED BY THE     */
*         /* UREST MACRO.                                            */
*         /*                                                         */
*         /* INPUT - THE ARGUMENT LIST DEFINED BY THE PCR STRUCTURE  */
*         /* IN THIS PROCEDURE.                                      */
*         /*                                                         */
*         /* OUTPUT - A MODIFIED EXISTING PRINT CONTROL TABLE.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0360
*RESTCONT: PROC;                                                   0360
*                                                                  0360
RESTCONT STM   @14,@12,@SA00005                                    0360
*         IF GDTTPH = NULLPTR                                      0361
*           THEN                                                   0361
*                                                                  0361
         L     @09,@PC00001                                        0361
         L     @03,GDTTPH(,@09)                                    0361
         LTR   @03,@03                                             0361
         BNZ   @RF00361                                            0361
*             DO;                                                  0362
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0363
*               REG15 = 24;                                        0364
         LA    REG15,24                                            0364
*               REG14 = GDTABT;                                    0365
         L     REG14,GDTABT(,@09)                                  0365
*               REG13 = GDTABH;                                    0366
         L     REG13,GDTABH(,@09)                                  0366
*               GEN(BR    REG14);                                  0367
         BR    REG14
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0368
*             END;                                                 0369
*         PRIPCT = OFF;                                            0370
@RF00361 NI    PRIPCT,B'01111111'                                  0370
*         SAVERC = 0;                                              0371
*                                                                  0371
         SLR   SAVERC,SAVERC                                       0371
*         PCTPTR = GDTTPH;                                         0372
         L     @09,@PC00001                                        0372
         L     PCTPTR,GDTTPH(,@09)                                 0372
*         IF PCTSPP ^= NULLPTR                                     0373
*           THEN                                                   0373
         L     @09,PCTSPP(,PCTPTR)                                 0373
         LTR   @09,@09                                             0373
         BZ    @RF00373                                            0373
*             PCTPTR = PCTSPP;                                     0374
*                                                                  0374
         LR    PCTPTR,@09                                          0374
*         /***********************************************************/
*         /*                                                         */
*         /* FLUSH THE STACK BUFFER BEFORE MAKING ANY CHANGES.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0375
*         CALL STACKFL;                                            0375
*                                                                  0375
@RF00373 BAL   @14,STACKFL                                         0375
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING ARE DECLARES USED EXCLUSIVELY IN THIS     */
*         /* PROCEDURE.  THE FIRST IS THE TABLE USED IN GETTING THE  */
*         /* TRANSLATE TABLE REQUIRED BY VARIOUS PRINT CHAINS.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0376
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING IS A THREE BYTE WIDE TABLE OF THE VARIOUS */
*         /* STANDARD PRINT CHAINS.  THE FIRST TWO BYTES OF EACH     */
*         /* ENTRY CONTAIN THE PRINT CHAIN ID, THE THIRD BYTE        */
*         /* CONTAINS THE STATIC TEXT ENTRY NUMBER IN THE MODULE     */
*         /* ICKTSTP0 THAT CONTAINS THE TRANSLATE TABLE FOR THAT     */
*         /* TYPE OF CHAIN.                                          */
*         /*                                                         */
*         /***********************************************************/
*         DCL PCTAB (7) CHAR (3) INIT                              0376
*           ('C1D501'X,                 /* AN CHAIN.                 */
*            'C8D506'X,                 /* HN CHAIN.                 */
*            'D7D502'X,                 /* PN CHAIN.                 */
*            'D8D503'X,                 /* QN CHAIN.                 */
*            'D9D507'X,                 /* RN CHAIN.                 */
*            'E2D504'X,                 /* SN CHAIN.                 */
*            'E3D505'X);                /* TN CHAIN.                 */
*                                                                  0376
*         DCL RESTARG(7) PTR(31);                                  0377
*                                                                  0378
*         /***********************************************************/
*         /*                                                         */
*         /* RUNNING CODE BEGINS HERE.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0378
*         P04WT = ''B;                  /* CLEAR THE WORK TABLE. */
         XC    P04WT(42),P04WT                                     0378
*         RESTARG(1)=ADDR(ARG1);                                   0379
         L     @09,@PC00001+12                                     0379
         ST    @09,RESTARG                                         0379
*         RESTARG(2)=ADDR(ARG2);                                   0380
         L     @09,@PC00001+16                                     0380
         ST    @09,RESTARG+4                                       0380
*         RESTARG(3)=ADDR(ARG3);                                   0381
         L     @09,@PC00001+20                                     0381
         ST    @09,RESTARG+8                                       0381
*         RESTARG(4)=ADDR(ARG4);                                   0382
         L     @09,@PC00001+24                                     0382
         ST    @09,RESTARG+12                                      0382
*         RESTARG(5)=ADDR(ARG5);                                   0383
         L     @09,@PC00001+28                                     0383
         ST    @09,RESTARG+16                                      0383
*         RESTARG(6)=ADDR(ARG6);                                   0384
         L     @09,@PC00001+32                                     0384
         ST    @09,RESTARG+20                                      0384
*         RESTARG(7)=ADDR(ARG7);                                   0385
         L     @09,@PC00001+36                                     0385
         ST    @09,RESTARG+24                                      0385
*         DO ARGNMB = 1 TO (LISTLN - 3) BY 1;                      0386
         LA    ARGNMB,1                                            0386
         B     @DE00386                                            0386
@DL00386 DS    0H                                                  0387
*                                       /* LOOP THROUGH THE ARGS.    */
*           PCRADDR = RESTARG(ARGNMB);  /* SET PARM ADDRESS          */
*                                                                  0387
         LR    @04,ARGNMB                                          0387
         SLA   @04,2                                               0387
         L     PCRADDR,RESTARG-4(@04)                              0387
*           /*********************************************************/
*           /*                                                       */
*           /* IF SUB_TITLE ARGUMENT ENTERED, INITIALIZE THEM.       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0388
*           IF PCRTYP = 'ST'            /* TEST FOR SUB-TITLE LINE   */
*             THEN                                                 0388
         CLC   PCRTYP(2,PCRADDR),@CC00684                          0388
         BNE   @RF00388                                            0388
*               DO;                                                0389
*                 IF PCRPTR = NULLPTR                              0390
*                   THEN                                           0390
         L     @04,PCRPTR(,PCRADDR)                                0390
         LTR   @04,@04                                             0390
         BNZ   @RF00390                                            0390
*                     P04STC = -1;      /* SET TO CLEAR EXISTING.    */
         MVC   P04STC(2),@CH00685                                  0391
*                   ELSE                                           0392
*                     DO;               /* SET NEW SUB-TITLE PTR.    */
         B     @RC00390                                            0392
@RF00390 DS    0H                                                  0393
*                       P04STP = PCRPTR;                           0393
         L     @04,PCRPTR(,PCRADDR)                                0393
         ST    @04,P04STP                                          0393
*                       P04STC = PCRLC;                            0394
         LH    @04,PCRLC(,PCRADDR)                                 0394
         STH   @04,P04STC                                          0394
*                     END;                                         0395
*               END;                                               0396
*                                                                  0396
@RC00390 DS    0H                                                  0397
*           /*********************************************************/
*           /*                                                       */
*           /* IF FOOTING LINE ARGUMENT ENTERED INITIALIZE THEM.     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0397
*           IF PCRTYP = 'FT'            /* CHECK FOR FOOTING LINE    */
*             THEN                                                 0397
@RF00388 CLC   PCRTYP(2,PCRADDR),@CC00686                          0397
         BNE   @RF00397                                            0397
*               DO;                                                0398
*                 IF PCRPTR = NULLPTR                              0399
*                   THEN                                           0399
         L     @04,PCRPTR(,PCRADDR)                                0399
         LTR   @04,@04                                             0399
         BNZ   @RF00399                                            0399
*                     P04FC = -1;       /* SET TO CLEAR EXISTING.    */
         MVC   P04FC(2),@CH00685                                   0400
*                   ELSE                                           0401
*                     DO;               /* SET NEW FOOTING PTR.      */
         B     @RC00399                                            0401
@RF00399 DS    0H                                                  0402
*                       P04FP = PCRPTR;                            0402
         L     @04,PCRPTR(,PCRADDR)                                0402
         ST    @04,P04FP                                           0402
*                       P04FC = PCRLC;                             0403
         LH    @04,PCRLC(,PCRADDR)                                 0403
         STH   @04,P04FC                                           0403
*                     END;                                         0404
*               END;                                               0405
*                                                                  0405
@RC00399 DS    0H                                                  0406
*           /*********************************************************/
*           /*                                                       */
*           /* IF LINE WIDTH ARGUMENTS ENTERED, INITIALIZE THEM      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0406
*           IF PCRTYP = 'LW'            /* TEST FOR NEW LINE WIDTH   */
*             THEN                                                 0406
@RF00397 CLC   PCRTYP(2,PCRADDR),@CC00687                          0406
         BNE   @RF00406                                            0406
*               DO;                                                0407
*                 P04LW = PCRLC;        /* SET NEW LINE WIDTH        */
         LH    @04,PCRLC(,PCRADDR)                                 0408
         STH   @04,P04LW                                           0408
*                 IF PCRLC = 0                                     0409
*                   THEN                                           0409
         LTR   @04,@04                                             0409
         BNZ   @RF00409                                            0409
*                     P04LW = STDLW;    /* SET TO RESTORE DEFAULT.   */
         L     @04,STDLW                                           0410
         STH   @04,P04LW                                           0410
*               END;                                               0411
*                                                                  0411
@RF00409 DS    0H                                                  0412
*           /*********************************************************/
*           /*                                                       */
*           /* IF PAGE DEPTH ARGUMENTS ENTERED, INITIALIZE THEM.     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0412
*           IF PCRTYP = 'PD'            /* TEST FOR NEW PAGE DEPTH   */
*             THEN                                                 0412
@RF00406 CLC   PCRTYP(2,PCRADDR),@CC00688                          0412
         BNE   @RF00412                                            0412
*               DO;                                                0413
*                 P04PD = PCRLC;        /* SET NEW PAGE DEPTH        */
         LH    @04,PCRLC(,PCRADDR)                                 0414
         STH   @04,P04PD                                           0414
*                 IF PCRLC = 0                                     0415
*                   THEN                                           0415
         LTR   @04,@04                                             0415
         BNZ   @RF00415                                            0415
*                     P04PD = STDPD;    /* SET TO RESTORE DEFAULT.   */
         MVC   P04PD(2),@CH00619                                   0416
*               END;                                               0417
*                                                                  0417
@RF00415 DS    0H                                                  0418
*           /*********************************************************/
*           /*                                                       */
*           /* IF DEFAULT SPACE CHARACTER ENTERED, INITIALIZE IT.    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0418
*           IF PCRTYP = 'SC'            /* TEST FOR NEW DEFAULT SPACE*/
*             THEN                                                 0418
@RF00412 CLC   PCRTYP(2,PCRADDR),@CC00689                          0418
         BNE   @RF00418                                            0418
*               DO;                                                0419
*                 P04DSC = PCRLC;       /* SET NEW DSC               */
         LH    @04,PCRLC(,PCRADDR)                                 0420
         STH   @04,P04DSC                                          0420
*                 IF PCRLC = 0                                     0421
*                   THEN                                           0421
         LTR   @04,@04                                             0421
         BNZ   @RF00421                                            0421
*                     P04DSC = 1;       /* SET TO RESTORE DEFAULT.   */
         MVC   P04DSC(2),@CH00178                                  0422
*               END;                                               0423
*                                                                  0423
@RF00421 DS    0H                                                  0424
*           /*********************************************************/
*           /*                                                       */
*           /* IF PRINT CHAIN ARGUMENTS ENTERED, INITIALIZE IT.      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0424
*         IF PCRTYP = 'PC'              /* TEST FOR PRINT CHAIN */ 0424
*           THEN                                                   0424
@RF00418 CLC   PCRTYP(2,PCRADDR),@CC00690                          0424
         BNE   @RF00424                                            0424
*             DO;                                                  0425
*               IF PCRLC ^= 0                                      0426
*                 THEN                                             0426
*                                                                  0426
         LH    @04,PCRLC(,PCRADDR)                                 0426
         LTR   @04,@04                                             0426
         BZ    @RF00426                                            0426
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF PCRLC IS NON-ZERO, A STANDARD PRINT CHAIN    */
*                 /* ID HAS BEEN FURNISHED.                          */
*                 /* SEARCH THE TABLE FOR THE PRINT CHAIN ENTERED.   */
*                 /* CHAIN ENTERED.                                  */
*                 /* IF A MATCH IS FOUND, GO TO ICKTP05 TO GET IT.   */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0427
*                   DO;                                            0427
*                     STID(1:3) = 'TP0';                           0428
         MVC   STID(3),@CC00691                                    0428
*                                       /* SET UP THE STID FOR CHAIN */
*                     DO N = 1 TO 7 BY 1;                          0429
         LA    N,1                                                 0429
@DL00429 DS    0H                                                  0430
*                       IF PCTAB(N,1:2) = PCRLCC                   0430
*                         THEN                                     0430
         LR    @04,N                                               0430
         MH    @04,@CH00149                                        0430
         LA    @01,PCTAB-3(@04)                                    0430
         CLC   0(2,@01),PCRLCC(PCRADDR)                            0430
         BNE   @RF00430                                            0430
*                           STID(4) = PCTAB(N,3);                  0431
         LA    @01,PCTAB-1(@04)                                    0431
         MVC   STID+3(1),0(@01)                                    0431
*                                       /* SET THE ENTRY NUMBER.     */
*                     END;                                         0432
@RF00430 AL    N,@CF00178                                          0432
         C     N,@CF00198                                          0432
         BNH   @DL00429                                            0432
*                     IF STID(4) ^= 0                              0433
*                       THEN                                       0433
         CLI   STID+3,0                                            0433
         BE    @RF00433                                            0433
*                         DO;                                      0434
*                                                                  0434
*                           CALL ICKSACL0 (GDTTBL,'ICKTP05 ',STID,SUBPZ
*P04PCP);                                                          0435
*                                                                  0435
         L     @04,@PC00001                                        0435
         ST    @04,@AL00001                                        0435
         LA    @15,@CC00659                                        0435
         ST    @15,@AL00001+4                                      0435
         LA    @15,STID                                            0435
         ST    @15,@AL00001+8                                      0435
         LA    @15,SUBPZ                                           0435
         ST    @15,@AL00001+12                                     0435
         LA    @15,P04PCP                                          0435
         ST    @15,@AL00001+16                                     0435
         MVI   @AL00001+16,X'80'                                   0435
         L     @15,GDTCAL(,@04)                                    0435
         LA    @01,@AL00001                                        0435
         BALR  @14,@15                                             0435
*                           RESPECIFY RTNREG RSTD;                 0436
*                           TESTRC = RTNREG;                       0437
         LR    TESTRC,RTNREG                                       0437
*                           RESPECIFY RTNREG UNRSTD;               0438
*                           SAVERC = TESTRC;                       0439
         LR    SAVERC,TESTRC                                       0439
*                         END;                                     0440
*                   END;                                           0441
*                                                                  0441
@RF00433 DS    0H                                                  0442
*               /*****************************************************/
*               /*                                                   */
*               /* IF PCRPTR IS NON-ZERO, A LOADMODULE NAME WAS      */
*               /* GIVEN SO LOAD THE MODULE AND SET THE POINTER TO   */
*               /* THE ENTRY POINT OF THE LOAD MODULE AS THE START   */
*               /* OF THE TRANSLATE TABLE.                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0442
*               IF PCRPTR ^= NULLPTR                               0442
*                 THEN                                             0442
@RF00426 L     @04,PCRPTR(,PCRADDR)                                0442
         LTR   @04,@04                                             0442
         BZ    @RF00442                                            0442
*                   DO;                                            0443
*                                                                  0443
*                     CALL ICKSALD0 (GDTTBL,TTDSN,P04PCP);         0444
*                                                                  0444
         L     @03,@PC00001                                        0444
         ST    @03,@AL00001                                        0444
         ST    @04,@AL00001+4                                      0444
         LA    @04,P04PCP                                          0444
         ST    @04,@AL00001+8                                      0444
         L     @15,GDTLOD(,@03)                                    0444
         LA    @01,@AL00001                                        0444
         BALR  @14,@15                                             0444
*                   END;                                           0445
*             END;                                                 0446
*                                                                  0446
@RF00442 DS    0H                                                  0447
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR A NEW PAGE NUMBER ENTERED                    */
*           /* CONVERT TO BINARY AND ENTER IN TABLE.                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0447
*           IF PCRTYP = 'PN' & PGNOLIN ^= 0                        0447
*             THEN                                                 0447
@RF00424 CLC   PCRTYP(2,PCRADDR),@CC00692                          0447
         BNE   @RF00447                                            0447
         L     @04,PCRPTR(,PCRADDR)                                0447
         LH    @03,PGNOLIN(,@04)                                   0447
         LTR   @03,@03                                             0447
         BZ    @RF00447                                            0447
*               DO;                                                0448
*                 PAGE = ''B;                                      0449
         XC    PAGE(4),PAGE                                        0449
*                 PAGE((5-PGNOLIN):4) = PGNOCIN(1:PGNOLIN);        0450
         LCR   @03,@03                                             0450
         AL    @03,@CF00268                                        0450
         LA    @01,PAGE-1(@03)                                     0450
         LCR   @03,@03                                             0450
         AL    @03,@CF00055                                        0450
         EX    @03,@SM00724                                        0450
*GEN     (PACK  PACKWD,PAGE);                                      0451
         PACK  PACKWD,PAGE
*GEN     (CVB   CVDREG,PACKWD);                                    0452
         CVB   CVDREG,PACKWD
*                 P04CPN = CVDREG - 1;                             0453
         LR    @06,CVDREG                                          0453
         BCTR  @06,0                                               0453
         STH   @06,P04CPN                                          0453
*               END;                                               0454
*         END;                                                     0455
@RF00447 AL    ARGNMB,@CF00178                                     0455
@DE00386 LR    @06,LISTLN                                          0455
         SL    @06,@CF00149                                        0455
         CR    ARGNMB,@06                                          0455
         BNH   @DL00386                                            0455
*         /***********************************************************/
*         /*                                                         */
*         /*  CALL THE PROCEDURE TO SET THE PCT                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0456
*         CALL PCTSETUP;                                           0456
*                                                                  0456
         BAL   @14,PCTSETUP                                        0456
*         IF GDTDBG = NULLPTR                                      0457
*           THEN;                                                  0457
         L     @09,@PC00001                                        0457
         L     @09,GDTDBG(,@09)                                    0457
         LTR   @09,@09                                             0457
         BZ    @RT00457                                            0457
*           ELSE                                                   0459
*             CALL ICKDB010 (GDTTBL,'TP4R');                       0459
*                                                                  0459
         L     @09,@PC00001                                        0459
         ST    @09,@AL00001                                        0459
         LA    @06,@CC00693                                        0459
         ST    @06,@AL00001+4                                      0459
         MVI   @AL00001+4,X'80'                                    0459
         L     @15,GDTDBG(,@09)                                    0459
         LA    @01,@AL00001                                        0459
         BALR  @14,@15                                             0459
*         RETURN CODE(SAVERC);                                     0460
@RT00457 LR    @15,SAVERC                                          0460
         L     @14,@SA00005                                        0460
         LM    @00,@12,@SA00005+8                                  0460
         BR    @14                                                 0460
*         END RESTCONT;                                            0461
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - PCT SETTING PROCEDURE.                 */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE CHECKS AND SETS VALUES        */
*         /* ENTERED AND SET INTO THE PRINT CONTROL WORK TABLE INTO  */
*         /* THE PRINT CONTROL TABLE.                                */
*         /*                                                         */
*         /* INPUT - THE PRINT CONTROL WORK TABLE (P04WT).           */
*         /*                                                         */
*         /* OUTPUT - THE PRINT CONTROL TABLE.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0462
*PCTSETUP: PROC;                                                   0462
*                                                                  0462
PCTSETUP STM   @14,@06,@SA00006                                    0462
         STM   @08,@12,@SA00006+36                                 0462
*         /***********************************************************/
*         /*                                                         */
*         /* TEST FOR PRIMARY CONTROL TABLE BUILD AND IF TRUE, BUILD */
*         /* TABLE WITH ALL THE DEFAULTS.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0463
*         PCTNLI = 999;                 /* FORCE A PAGE OVERFLOW.    */
         LA    @06,999                                             0463
         STH   @06,PCTNLI(,PCTPTR)                                 0463
*         PCTANL = 999;                 /* FOR ALTERNATE FILE ALSO.  */
         STH   @06,PCTANL(,PCTPTR)                                 0464
*         IF PRIPCT = ON                                           0465
*           THEN                                                   0465
         TM    PRIPCT,B'10000000'                                  0465
         BNO   @RF00465                                            0465
*             DO;                                                  0466
*               /*****************************************************/
*               /*                                                   */
*               /* GET THE STANDARD PRINT CHAIN TRANSLATE            */
*               /* TABLE.                                            */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0467
*               STID(1:3) = 'TP0';                                 0467
         MVC   STID(3),@CC00691                                    0467
*               STID(4) = '02'X;                                   0468
*                                                                  0468
         MVI   STID+3,X'02'                                        0468
*               CALL ICKSACL0 (GDTTBL,'ICKTP05 ',STID,SUBPZ,PCTTRP);
*                                                                  0469
         L     @06,@PC00001                                        0469
         ST    @06,@AL00001                                        0469
         LA    @04,@CC00659                                        0469
         ST    @04,@AL00001+4                                      0469
         LA    @04,STID                                            0469
         ST    @04,@AL00001+8                                      0469
         LA    @04,SUBPZ                                           0469
         ST    @04,@AL00001+12                                     0469
         LA    @04,PCTTRP(,PCTPTR)                                 0469
         ST    @04,@AL00001+16                                     0469
         MVI   @AL00001+16,X'80'                                   0469
         L     @15,GDTCAL(,@06)                                    0469
         LA    @01,@AL00001                                        0469
         BALR  @14,@15                                             0469
*               RESPECIFY RTNREG RSTD;                             0470
*               TESTRC = RTNREG;                                   0471
         LR    TESTRC,RTNREG                                       0471
*               RESPECIFY RTNREG UNRSTD;                           0472
*               IF TESTRC ^= 0                                     0473
*                 THEN                                             0473
*                                                                  0473
         LTR   TESTRC,TESTRC                                       0473
         BZ    @RF00473                                            0473
*                   DO;                                            0474
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0475
*                     REG15 = 28;                                  0476
         LA    REG15,28                                            0476
*                     REG14 = GDTABT;                              0477
         L     @06,@PC00001                                        0477
         L     REG14,GDTABT(,@06)                                  0477
*                     REG13 = GDTABH;                              0478
         L     REG13,GDTABH(,@06)                                  0478
*                     GEN(BR    REG14);                            0479
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0480
*                   END;                                           0481
*                                                                  0481
*               /*****************************************************/
*               /*                                                   */
*               /* INITIALIZE FIRST DATA LINE AND LAST DATA LINE.    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0482
*               PCTPNI = 1;                                        0482
@RF00473 MVC   PCTPNI(2,PCTPTR),@CH00178                           0482
*               PCTFDL = 4;                                        0483
         MVC   PCTFDL(2,PCTPTR),@CH00055                           0483
*               PCTLDL = 60;                                       0484
         MVC   PCTLDL(2,PCTPTR),@CH00699                           0484
*             END;                                                 0485
*         /***********************************************************/
*         /*                                                         */
*         /* BEGIN TO VERIFY AND SET THE PRINT CONTROL TABLE ENTRIES */
*         /* ENTERED WITH THIS REQUEST.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0486
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP A TRANSLATE TABLE ENTERED WITH THIS REQUEST.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0486
*         IF P04PCP ^= 0                                           0486
*           THEN                                                   0486
@RF00465 L     @06,P04PCP                                          0486
         LTR   @06,@06                                             0486
         BZ    @RF00486                                            0486
*             PCTTRP = P04PCP;                                     0487
*                                                                  0487
         ST    @06,PCTTRP(,PCTPTR)                                 0487
*         /***********************************************************/
*         /*                                                         */
*         /*  VERIFY AND SET CHANGES TO LINE WIDTH                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0488
*         IF P04LW > 0 & P04LW < 133                               0488
*           THEN                                                   0488
@RF00486 LH    @06,P04LW                                           0488
         LTR   @06,@06                                             0488
         BNP   @RF00488                                            0488
         C     @06,@CF00700                                        0488
         BNL   @RF00488                                            0488
*             PCTPLW = P04LW;                                      0489
         ST    @06,PCTPLW(,PCTPTR)                                 0489
*           ELSE                                                   0490
*             DO;                                                  0490
         B     @RC00488                                            0490
@RF00488 DS    0H                                                  0491
*               IF P04LW ^= 0                                      0491
*                 THEN                                             0491
         LH    @06,P04LW                                           0491
         LTR   @06,@06                                             0491
         BZ    @RF00491                                            0491
*                   SAVERC = 4;                                    0492
         LA    SAVERC,4                                            0492
*             END;                                                 0493
*                                                                  0493
@RF00491 DS    0H                                                  0494
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET CHANGES TO THE PAGE DEPTH.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0494
*         IF P04PD > 0                                             0494
*           THEN                                                   0494
@RC00488 LH    @06,P04PD                                           0494
         LTR   @06,@06                                             0494
         BNP   @RF00494                                            0494
*             DO;                                                  0495
*               PCTPPD = P04PD;                                    0496
         STH   @06,PCTPPD(,PCTPTR)                                 0496
*               PCTLDL = PCTPPD - OFLOSS;                          0497
         SH    @06,OFLOSS                                          0497
         STH   @06,PCTLDL(,PCTPTR)                                 0497
*             END;                                                 0498
*                                                                  0498
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET CHANGES TO DEFAULT SPACE CHARACTER.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0499
*         IF P04DSC > 0                                            0499
*           THEN                                                   0499
@RF00494 LH    @06,P04DSC                                          0499
         LTR   @06,@06                                             0499
         BNP   @RF00499                                            0499
*             DO;                                                  0500
*               IF P04DSC < 4                                      0501
*                 THEN                                             0501
         C     @06,@CF00055                                        0501
         BNL   @RF00501                                            0501
*                   PCTDSC = P04DSC;                               0502
         STH   @06,PCTDSC(,PCTPTR)                                 0502
*                 ELSE                                             0503
*                   SAVERC = 4;                                    0503
         B     @RC00501                                            0503
@RF00501 LA    SAVERC,4                                            0503
*             END;                                                 0504
*                                                                  0504
@RC00501 DS    0H                                                  0505
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET CHANGES TO CURRENT PAGE NUMBER           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0505
*         IF P04CPN > 0                                            0505
*           THEN                                                   0505
@RF00499 LH    @06,P04CPN                                          0505
         LTR   @06,@06                                             0505
         BNP   @RF00505                                            0505
*             PCTCPN = P04CPN;                                     0506
*                                                                  0506
         STH   @06,PCTCPN(,PCTPTR)                                 0506
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET CHANGES TO PAGE NUMBER INCREMENT.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0507
*         IF P04PNI > 0                                            0507
*           THEN                                                   0507
@RF00505 LH    @06,P04PNI                                          0507
         LTR   @06,@06                                             0507
         BNP   @RF00507                                            0507
*             DO;                                                  0508
*               IF P04PNI > 9999                                   0509
*                 THEN                                             0509
         C     @06,@CF00701                                        0509
         BNH   @RF00509                                            0509
*                   SAVERC = 4;                                    0510
         LA    SAVERC,4                                            0510
*                 ELSE                                             0511
*                   PCTPNI = P04PNI;                               0511
         B     @RC00509                                            0511
@RF00509 LH    @06,P04PNI                                          0511
         STH   @06,PCTPNI(,PCTPTR)                                 0511
*             END;                                                 0512
*                                                                  0512
@RC00509 DS    0H                                                  0513
*         /***********************************************************/
*         /*                                                         */
*         /*  VERIFY AND SET CHANGES TO THE MAIN TITLE LINE          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0513
*         IF P04MTP > 0                                            0513
*           THEN                                                   0513
@RF00507 L     @06,P04MTP                                          0513
         LTR   @06,@06                                             0513
         BNP   @RF00513                                            0513
*             DO;                                                  0514
*               /*****************************************************/
*               /*                                                   */
*               /* GET CORE FOR THE MAIN TITLE LINE.                 */
*               /* GET POOL ZERO FOR PRIMARY CONTROL TABLE.          */
*               /* GET POOL TP01 FOR SECONDARY CONTROL TABLE.        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0515
*               IF PRIPCT = ON                                     0515
*                 THEN                                             0515
         TM    PRIPCT,B'10000000'                                  0515
         BNO   @RF00515                                            0515
*                   DO;                                            0516
*                                                                  0516
*                     CALL ICKSAGS0 (GDTTBL,STDLW,PCTMLP);         0517
*                                                                  0517
         L     @06,@PC00001                                        0517
         ST    @06,@AL00001                                        0517
         LA    @04,STDLW                                           0517
         ST    @04,@AL00001+4                                      0517
         LA    @04,PCTMLP(,PCTPTR)                                 0517
         ST    @04,@AL00001+8                                      0517
         MVI   @AL00001+8,X'80'                                    0517
         L     @15,GDTGSP(,@06)                                    0517
         LA    @01,@AL00001                                        0517
         BALR  @14,@15                                             0517
*                     RESPECIFY RTNREG RSTD;                       0518
*                     TESTRC = RTNREG;                             0519
         LR    TESTRC,RTNREG                                       0519
*                     RESPECIFY RTNREG UNRSTD;                     0520
*                     IF TESTRC ^= 0                               0521
*                       THEN                                       0521
*                                                                  0521
         LTR   TESTRC,TESTRC                                       0521
         BZ    @RF00521                                            0521
*                         DO;                                      0522
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0523
*                           REG15 = 28;                            0524
         LA    REG15,28                                            0524
*                           REG14 = GDTABT;                        0525
         L     @06,@PC00001                                        0525
         L     REG14,GDTABT(,@06)                                  0525
*                           REG13 = GDTABH;                        0526
         L     REG13,GDTABH(,@06)                                  0526
*                           GEN(BR    REG14);                      0527
         BR    REG14
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0528
*                         END;                                     0529
*                   END;                                           0530
*                                                                  0530
*                 ELSE                                             0531
*                   DO;                                            0531
*                                                                  0531
         B     @RC00515                                            0531
@RF00515 DS    0H                                                  0532
*                     CALL ICKSAGP0 (GDTTBL,STDLW,PCTMLP,TPPOOL);  0532
*                                                                  0532
         L     @06,@PC00001                                        0532
         ST    @06,@AL00001                                        0532
         LA    @04,STDLW                                           0532
         ST    @04,@AL00001+4                                      0532
         LA    @04,PCTMLP(,PCTPTR)                                 0532
         ST    @04,@AL00001+8                                      0532
         LA    @04,TPPOOL                                          0532
         ST    @04,@AL00001+12                                     0532
         MVI   @AL00001+12,X'80'                                   0532
         L     @15,GDTGPL(,@06)                                    0532
         LA    @01,@AL00001                                        0532
         BALR  @14,@15                                             0532
*                     RESPECIFY RTNREG RSTD;                       0533
*                     TESTRC = RTNREG;                             0534
         LR    TESTRC,RTNREG                                       0534
*                     RESPECIFY RTNREG UNRSTD;                     0535
*                     IF TESTRC ^= 0                               0536
*                       THEN                                       0536
*                                                                  0536
         LTR   TESTRC,TESTRC                                       0536
         BZ    @RF00536                                            0536
*                         DO;                                      0537
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0538
*                           REG15 = 28;                            0539
         LA    REG15,28                                            0539
*                           REG14 = GDTABT;                        0540
         L     @06,@PC00001                                        0540
         L     REG14,GDTABT(,@06)                                  0540
*                           REG13 = GDTABH;                        0541
         L     REG13,GDTABH(,@06)                                  0541
*                           GEN(BR    REG14);                      0542
         BR    REG14
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0543
*                         END;                                     0544
*                   END;                                           0545
*                                                                  0545
@RF00536 DS    0H                                                  0546
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE THE MAIN TITLE LINE TO THE AREA              */
*               /* OBTAINED.                                         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0546
*               MTLBUFF(1:120) = MTLINBF(1:120);                   0546
@RC00515 L     @06,PCTMLP(,PCTPTR)                                 0546
         L     @04,P04MTP                                          0546
         MVC   MTLBUFF(120,@06),MTLINBF(@04)                       0546
*               MTLCC = EJECT;                                     0547
*                                                                  0547
         MVI   MTLCC(@06),C'1'                                     0547
*               /*****************************************************/
*               /*                                                   */
*               /* VERIFY AND SET PAGE NUMBER LOCATION CHANGES.      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0548
*               IF P04PNL > 0                                      0548
*                 THEN                                             0548
         LH    @06,P04PNL                                          0548
         LTR   @06,@06                                             0548
         BNP   @RF00548                                            0548
*                   DO;                                            0549
*                     IF P04PNL < PCTPLW -4                        0550
*                       THEN                                       0550
         L     @04,PCTPLW(,PCTPTR)                                 0550
         SL    @04,@CF00055                                        0550
         CR    @06,@04                                             0550
         BNL   @RF00550                                            0550
*                         PCTPNL = P04PNL;                         0551
         STH   @06,PCTPNL(,PCTPTR)                                 0551
*                       ELSE                                       0552
*                         SAVERC = 4;                              0552
         B     @RC00550                                            0552
@RF00550 LA    SAVERC,4                                            0552
*                   END;                                           0553
*                                                                  0553
@RC00550 DS    0H                                                  0554
*               /*****************************************************/
*               /*                                                   */
*               /* VERIFY AND SET TIME LOCATION CHANGES.             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0554
*               IF P04TL > 0                                       0554
*                 THEN                                             0554
@RF00548 LH    @06,P04TL                                           0554
         LTR   @06,@06                                             0554
         BNP   @RF00554                                            0554
*                   DO;                                            0555
*                     IF P04TL < PCTPLW - 6                        0556
*                       THEN;                                      0556
         L     @04,PCTPLW(,PCTPTR)                                 0556
         SL    @04,@CF00132                                        0556
         CR    @06,@04                                             0556
         BL    @RT00556                                            0556
*                       ELSE                                       0558
*                         SAVERC = 4;                              0558
         LA    SAVERC,4                                            0558
*                   END;                                           0559
*                                                                  0559
@RT00556 DS    0H                                                  0560
*               /*****************************************************/
*               /*                                                   */
*               /* VERIFY AND SET DATE LOCATION CHANGES.             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0560
*               IF P04DL > 0                                       0560
*                 THEN                                             0560
@RF00554 LH    @06,P04DL                                           0560
         LTR   @06,@06                                             0560
         BNP   @RF00560                                            0560
*                   DO;                                            0561
*                     IF P04DL < PCTPLW - 6                        0562
*                       THEN;                                      0562
         L     @04,PCTPLW(,PCTPTR)                                 0562
         SL    @04,@CF00132                                        0562
         CR    @06,@04                                             0562
         BL    @RT00562                                            0562
*                       ELSE                                       0564
*                         SAVERC = 4;                              0564
         LA    SAVERC,4                                            0564
*                   END;                                           0565
*                                                                  0565
@RT00562 DS    0H                                                  0566
*               /*****************************************************/
*               /*                                                   */
*               /* INITIALIZE THE TIME AND DATE LOCATIONS IN THE     */
*               /* MAIN TITLE LINE.                                  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0566
*               CALL ICKSATI0 (GDTTBL,MTLBUFF(P04TL:P04TL+7),      0566
*                     MTLBUFF(P04DL:P04DL+7),FORMAT);              0566
@RF00560 L     @06,@PC00001                                        0566
         ST    @06,@AL00001                                        0566
         LH    @04,P04TL                                           0566
         L     @03,PCTMLP(,PCTPTR)                                 0566
         LA    @04,MTLBUFF-1(@04,@03)                              0566
         ST    @04,@AL00001+4                                      0566
         LH    @04,P04DL                                           0566
         LA    @04,MTLBUFF-1(@04,@03)                              0566
         ST    @04,@AL00001+8                                      0566
         LA    @04,@CC00152                                        0566
         ST    @04,@AL00001+12                                     0566
         MVI   @AL00001+12,X'80'                                   0566
         L     @15,GDTTIM(,@06)                                    0566
         LA    @01,@AL00001                                        0566
         BALR  @14,@15                                             0566
*             END;                                                 0567
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET SUB-TITLE LINE CHANGES.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0568
*         IF P04STP > 0                                            0568
*           THEN                                                   0568
@RF00513 L     @06,P04STP                                          0568
         LTR   @06,@06                                             0568
         BNP   @RF00568                                            0568
*             DO;                                                  0569
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK NUMBER OF LINES ENTERED.                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0570
*               IF P04STC < 1  P04STC > 3                         0570
*                 THEN                                             0570
         LH    @06,P04STC                                          0570
         LTR   @06,@06                                             0570
         BNP   @RT00570                                            0570
         C     @06,@CF00149                                        0570
         BNH   @RF00570                                            0570
@RT00570 DS    0H                                                  0571
*                   SAVERC = 4;                                    0571
         LA    SAVERC,4                                            0571
*                 ELSE                                             0572
*                   DO;                                            0572
*                                                                  0572
         B     @RC00570                                            0572
@RF00570 DS    0H                                                  0573
*                   /*************************************************/
*                   /*                                               */
*                   /* GET CORE FOR THE NUMBER OF LINES REQUIRED.    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0573
*                     SPCCNT = P04STC * STDLW;                     0573
*                                                                  0573
         L     @06,STDLW                                           0573
         MH    @06,P04STC                                          0573
         ST    @06,SPCCNT                                          0573
*                     CALL ICKSAGP0 (GDTTBL,SPCCNT,PCTSLP,TPPOOL); 0574
*                                                                  0574
         L     @06,@PC00001                                        0574
         ST    @06,@AL00001                                        0574
         LA    @04,SPCCNT                                          0574
         ST    @04,@AL00001+4                                      0574
         LA    @04,PCTSLP(,PCTPTR)                                 0574
         ST    @04,@AL00001+8                                      0574
         LA    @04,TPPOOL                                          0574
         ST    @04,@AL00001+12                                     0574
         MVI   @AL00001+12,X'80'                                   0574
         L     @15,GDTGPL(,@06)                                    0574
         LA    @01,@AL00001                                        0574
         BALR  @14,@15                                             0574
*                     RESPECIFY RTNREG RSTD;                       0575
*                     TESTRC = RTNREG;                             0576
         LR    TESTRC,RTNREG                                       0576
*                     RESPECIFY RTNREG UNRSTD;                     0577
*                     IF TESTRC ^= 0                               0578
*                       THEN                                       0578
*                                                                  0578
         LTR   TESTRC,TESTRC                                       0578
         BZ    @RF00578                                            0578
*                         DO;                                      0579
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0580
*                           REG15 = 28;                            0581
         LA    REG15,28                                            0581
*                           REG14 = GDTABT;                        0582
         L     @06,@PC00001                                        0582
         L     REG14,GDTABT(,@06)                                  0582
*                           REG13 = GDTABH;                        0583
         L     REG13,GDTABH(,@06)                                  0583
*                           GEN(BR    REG14);                      0584
         BR    REG14
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0585
*                         END;                                     0586
*                                                                  0586
*                     SPCCNT = 0;                                  0587
*                                                                  0587
@RF00578 SLR   @06,@06                                             0587
         ST    @06,SPCCNT                                          0587
*                     /***********************************************/
*                     /*                                             */
*                     /* COMPUTE THE LINE SPACES REQUIRED FOR THE    */
*                     /* SUB-TITLE LINES ENTERED.                    */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0588
*                     DO N = 1 TO P04STC BY 1;                     0588
         LA    N,1                                                 0588
         B     @DE00588                                            0588
@DL00588 DS    0H                                                  0589
*                       STLINE(N) = P04STP -> STLINE(1);           0589
         LR    @06,N                                               0589
         MH    @06,@CH00617                                        0589
         L     @04,PCTSLP(,PCTPTR)                                 0589
         ST    @06,@TF00001                                        0589
         ALR   @06,@04                                             0589
         AL    @06,@CF00726                                        0589
         L     @01,P04STP                                          0589
         MVC   STLINE(121,@06),STLINE(@01)                         0589
*                       IF STLCC(N) = SINGLE                       0590
*                         THEN                                     0590
         AL    @04,@TF00001                                        0590
         AL    @04,@CF00726                                        0590
         CLI   STLCC(@04),C' '                                     0590
         BNE   @RF00590                                            0590
*                           SPCCNT = SPCCNT + 1;                   0591
         LA    @06,1                                               0591
         AL    @06,SPCCNT                                          0591
         ST    @06,SPCCNT                                          0591
*                       IF STLCC(N) = DOUBLE                       0592
*                         THEN                                     0592
@RF00590 LR    @06,N                                               0592
         MH    @06,@CH00617                                        0592
         L     @04,PCTSLP(,PCTPTR)                                 0592
         ALR   @04,@06                                             0592
         AL    @04,@CF00726                                        0592
         CLI   STLCC(@04),C'0'                                     0592
         BNE   @RF00592                                            0592
*                           SPCCNT = SPCCNT + 2;                   0593
         LA    @06,2                                               0593
         AL    @06,SPCCNT                                          0593
         ST    @06,SPCCNT                                          0593
*                       IF STLCC(N) = TRIPLE                       0594
*                         THEN                                     0594
@RF00592 LR    @06,N                                               0594
         MH    @06,@CH00617                                        0594
         L     @04,PCTSLP(,PCTPTR)                                 0594
         ALR   @04,@06                                             0594
         AL    @04,@CF00726                                        0594
         CLI   STLCC(@04),C'-'                                     0594
         BNE   @RF00594                                            0594
*                           SPCCNT = SPCCNT + 3;                   0595
*                                                                  0595
         LA    @06,3                                               0595
         AL    @06,SPCCNT                                          0595
         ST    @06,SPCCNT                                          0595
*                       /*********************************************/
*                       /*                                           */
*                       /* CHECK TO ASSURE THAT THE SPACING CHAR IS  */
*                       /* VALID AND IF NOT, SET DOUBLE SPACE.       */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0596
*                       IF STLCC(N) ^= SINGLE                      0596
*                         & STLCC(N) ^= DOUBLE                     0596
*                         & STLCC(N) ^= TRIPLE                     0596
*                         THEN                                     0596
@RF00594 LR    @06,N                                               0596
         MH    @06,@CH00617                                        0596
         L     @04,PCTSLP(,PCTPTR)                                 0596
         ST    @06,@TF00001                                        0596
         ALR   @06,@04                                             0596
         AL    @06,@CF00726                                        0596
         CLI   STLCC(@06),C' '                                     0596
         BE    @RF00596                                            0596
         LR    @06,@04                                             0596
         AL    @06,@TF00001                                        0596
         AL    @06,@CF00726                                        0596
         CLI   STLCC(@06),C'0'                                     0596
         BE    @RF00596                                            0596
         LR    @06,@04                                             0596
         AL    @06,@TF00001                                        0596
         AL    @06,@CF00726                                        0596
         CLI   STLCC(@06),C'-'                                     0596
         BE    @RF00596                                            0596
*                           DO;                                    0597
*                             STLCC(N) = DOUBLE;                   0598
         AL    @04,@TF00001                                        0598
         AL    @04,@CF00726                                        0598
         MVI   STLCC(@04),C'0'                                     0598
*                             SPCCNT = SPCCNT + 2;                 0599
         LA    @06,2                                               0599
         AL    @06,SPCCNT                                          0599
         ST    @06,SPCCNT                                          0599
*                           END;                                   0600
*                       P04STP = P04STP + STDLW;                   0601
@RF00596 L     @06,P04STP                                          0601
         AL    @06,STDLW                                           0601
         ST    @06,P04STP                                          0601
*                     END;                                         0602
         AL    N,@CF00178                                          0602
@DE00588 CH    N,P04STC                                            0602
         BNH   @DL00588                                            0602
*                     PCTSLC = P04STC;                             0603
*                                                                  0603
         LH    @06,P04STC                                          0603
         STH   @06,PCTSLC(,PCTPTR)                                 0603
*                     /***********************************************/
*                     /*                                             */
*                     /* MOVE THE FIRST DATA LINE DOWN BY THE SPACE  */
*                     /* TAKEN BY THE SUB-TITLE LINES.               */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0604
*                     PCTFDL = PCTFDL + SPCCNT + 2;                0604
         LH    @06,PCTFDL(,PCTPTR)                                 0604
         AL    @06,SPCCNT                                          0604
         AL    @06,@CF00129                                        0604
         STH   @06,PCTFDL(,PCTPTR)                                 0604
*                   END;                                           0605
*             END;                                                 0606
*                                                                  0606
@RC00570 DS    0H                                                  0607
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET FOOTING LINE CHANGES.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0607
*         IF P04FP > 0                                             0607
*           THEN                                                   0607
@RF00568 L     @06,P04FP                                           0607
         LTR   @06,@06                                             0607
         BNP   @RF00607                                            0607
*             DO;                                                  0608
*                                                                  0608
*             /*******************************************************/
*             /*                                                     */
*             /* ASSURE THE FOOTING LINE COUNT IS VALID.             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0609
*               IF P04FC < 1  P04FC > 3                           0609
*                 THEN                                             0609
         LH    @06,P04FC                                           0609
         LTR   @06,@06                                             0609
         BNP   @RT00609                                            0609
         C     @06,@CF00149                                        0609
         BNH   @RF00609                                            0609
@RT00609 DS    0H                                                  0610
*                   SAVERC = 4;                                    0610
         LA    SAVERC,4                                            0610
*                 ELSE                                             0611
*                   DO;                                            0611
*                                                                  0611
         B     @RC00609                                            0611
@RF00609 DS    0H                                                  0612
*                   /*************************************************/
*                   /*                                               */
*                   /* GET CORE FOR THE FOOTING LINES ENTERED.       */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0612
*                     SPCCNT = P04FC * STDLW;                      0612
         LH    @06,P04FC                                           0612
         LR    @01,@06                                             0612
         M     @00,STDLW                                           0612
         ST    @01,SPCCNT                                          0612
*                     PCTFLC = P04FC;                              0613
*                                                                  0613
         STH   @06,PCTFLC(,PCTPTR)                                 0613
*                     CALL ICKSAGP0 (GDTTBL,SPCCNT,PCTFLP,TPPOOL); 0614
*                                                                  0614
         L     @06,@PC00001                                        0614
         ST    @06,@AL00001                                        0614
         LA    @04,SPCCNT                                          0614
         ST    @04,@AL00001+4                                      0614
         LA    @04,PCTFLP(,PCTPTR)                                 0614
         ST    @04,@AL00001+8                                      0614
         LA    @04,TPPOOL                                          0614
         ST    @04,@AL00001+12                                     0614
         MVI   @AL00001+12,X'80'                                   0614
         L     @15,GDTGPL(,@06)                                    0614
         LA    @01,@AL00001                                        0614
         BALR  @14,@15                                             0614
*                     RESPECIFY RTNREG RSTD;                       0615
*                     TESTRC = RTNREG;                             0616
         LR    TESTRC,RTNREG                                       0616
*                     RESPECIFY RTNREG UNRSTD;                     0617
*                     IF TESTRC ^= 0                               0618
*                       THEN                                       0618
*                                                                  0618
         LTR   TESTRC,TESTRC                                       0618
         BZ    @RF00618                                            0618
*                         DO;                                      0619
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0620
*                           REG15 = 28;                            0621
         LA    REG15,28                                            0621
*                           REG14 = GDTABT;                        0622
         L     @06,@PC00001                                        0622
         L     REG14,GDTABT(,@06)                                  0622
*                           REG13 = GDTABH;                        0623
         L     REG13,GDTABH(,@06)                                  0623
*                           GEN(BR    REG14);                      0624
         BR    REG14
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0625
*                         END;                                     0626
*                                                                  0626
*                     SPCCNT = 0;                                  0627
*                                                                  0627
@RF00618 SLR   @06,@06                                             0627
         ST    @06,SPCCNT                                          0627
*                     /***********************************************/
*                     /*                                             */
*                     /* COMPUTE THE SPACE REQUIRED BY THE FOOTING   */
*                     /* LINES.                                      */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0628
*                     DO N = 1 TO P04FC BY 1;                      0628
         LA    N,1                                                 0628
         B     @DE00628                                            0628
@DL00628 DS    0H                                                  0629
*                       FTLINE(N) = P04FP -> FTLINE(1);            0629
         LR    @06,N                                               0629
         MH    @06,@CH00617                                        0629
         L     @04,PCTFLP(,PCTPTR)                                 0629
         ST    @06,@TF00001                                        0629
         ALR   @06,@04                                             0629
         AL    @06,@CF00726                                        0629
         L     @01,P04FP                                           0629
         MVC   FTLINE(121,@06),FTLINE(@01)                         0629
*                       IF FTLCC(N) = SINGLE                       0630
*                         THEN                                     0630
         AL    @04,@TF00001                                        0630
         AL    @04,@CF00726                                        0630
         CLI   FTLCC(@04),C' '                                     0630
         BNE   @RF00630                                            0630
*                           SPCCNT = SPCCNT + 1;                   0631
         LA    @06,1                                               0631
         AL    @06,SPCCNT                                          0631
         ST    @06,SPCCNT                                          0631
*                       IF FTLCC(N) = DOUBLE                       0632
*                         THEN                                     0632
@RF00630 LR    @06,N                                               0632
         MH    @06,@CH00617                                        0632
         L     @04,PCTFLP(,PCTPTR)                                 0632
         ALR   @04,@06                                             0632
         AL    @04,@CF00726                                        0632
         CLI   FTLCC(@04),C'0'                                     0632
         BNE   @RF00632                                            0632
*                           SPCCNT = SPCCNT + 2;                   0633
         LA    @06,2                                               0633
         AL    @06,SPCCNT                                          0633
         ST    @06,SPCCNT                                          0633
*                       IF FTLCC(N) = TRIPLE                       0634
*                         THEN                                     0634
@RF00632 LR    @06,N                                               0634
         MH    @06,@CH00617                                        0634
         L     @04,PCTFLP(,PCTPTR)                                 0634
         ALR   @04,@06                                             0634
         AL    @04,@CF00726                                        0634
         CLI   FTLCC(@04),C'-'                                     0634
         BNE   @RF00634                                            0634
*                           SPCCNT = SPCCNT + 3;                   0635
*                                                                  0635
         LA    @06,3                                               0635
         AL    @06,SPCCNT                                          0635
         ST    @06,SPCCNT                                          0635
*                       /*********************************************/
*                       /*                                           */
*                       /* CHECK THE CARRIAGE CONTROL CHAR FOR       */
*                       /* VALIDITY (1, 2 OR 3) AND IF INVALID SET   */
*                       /* TO 1.                                     */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0636
*                       IF FTLCC(N) ^= SINGLE                      0636
*                          FTLCC(N) ^= DOUBLE                     0636
*                          FTLCC(N) ^= TRIPLE                     0636
*                           THEN                                   0636
@RF00634 LR    @06,N                                               0636
         MH    @06,@CH00617                                        0636
         L     @04,PCTFLP(,PCTPTR)                                 0636
         ST    @06,@TF00001                                        0636
         ALR   @06,@04                                             0636
         AL    @06,@CF00726                                        0636
         CLI   FTLCC(@06),C' '                                     0636
         BNE   @RT00636                                            0636
         LR    @06,@04                                             0636
         AL    @06,@TF00001                                        0636
         AL    @06,@CF00726                                        0636
         CLI   FTLCC(@06),C'0'                                     0636
         BNE   @RT00636                                            0636
         AL    @04,@TF00001                                        0636
         AL    @04,@CF00726                                        0636
         CLI   FTLCC(@04),C'-'                                     0636
         BE    @RF00636                                            0636
@RT00636 DS    0H                                                  0637
*                             DO;                                  0637
*                               FTLCC(N) = SINGLE;                 0638
         LR    @06,N                                               0638
         MH    @06,@CH00617                                        0638
         L     @04,PCTFLP(,PCTPTR)                                 0638
         ALR   @04,@06                                             0638
         AL    @04,@CF00726                                        0638
         MVI   FTLCC(@04),C' '                                     0638
*                               SPCCNT = SPCCNT + 1;               0639
         LA    @06,1                                               0639
         AL    @06,SPCCNT                                          0639
         ST    @06,SPCCNT                                          0639
*                             END;                                 0640
*                       P04FP = P04FP + STDLW;                     0641
@RF00636 L     @06,P04FP                                           0641
         AL    @06,STDLW                                           0641
         ST    @06,P04FP                                           0641
*                     END;                                         0642
*                                                                  0642
         AL    N,@CF00178                                          0642
@DE00628 CH    N,P04FC                                             0642
         BNH   @DL00628                                            0642
*                     /***********************************************/
*                     /*                                             */
*                     /* ADJUST THE LAST DATA LINE PER FOOTING LINE  */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0643
*                     PCTFLN = PCTPPD - SPCCNT - 3;                0643
         LH    @06,PCTPPD(,PCTPTR)                                 0643
         SL    @06,SPCCNT                                          0643
         SL    @06,@CF00149                                        0643
         STH   @06,PCTFLN(,PCTPTR)                                 0643
*                     PCTLDL = PCTFLN - 2;                         0644
         BCTR  @06,0                                               0644
         BCTR  @06,0                                               0644
         STH   @06,PCTLDL(,PCTPTR)                                 0644
*                   END;                                           0645
*             END;                                                 0646
*                                                                  0646
@RC00609 DS    0H                                                  0647
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE VERIFY AND PCT SETTING PROCEDURE.            */
*         /* THEN RETURN TO THE CALLING PROCEDURE.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0647
*         RETURN CODE (SAVERC);                                    0647
@RF00607 LR    @15,SAVERC                                          0647
         L     @14,@SA00006                                        0647
         LM    @00,@06,@SA00006+8                                  0647
         LM    @08,@12,@SA00006+36                                 0647
         BR    @14                                                 0647
*         END PCTSETUP;                                            0648
*                                                                  0648
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - RESET FUNCTION HANDLER.                */
*         /*                                                         */
*         /* FUNCTION - RESETS THE PRINT CONTROL TABLE TO THE        */
*         /* INITIAL DEFAULT VALUES AND RELEASES ALL 'TP' POOL       */
*         /* STORAGE.  IN ADDITION, IT RETURNS THE LAST PAGE NUMBER  */
*         /* USED TO THE CALLING ROUTINE.                            */
*         /*                                                         */
*         /* INPUT - PAGE NUMBER LOCATION.                           */
*         /*                                                         */
*         /* OUTPUT - REVISED PRINT CONTROL TABLE.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0649
*RESETCON: PROC (PGNOPTR);                                         0649
*                                                                  0649
RESETCON STM   @14,@12,@SA00007                                    0649
         MVC   @PC00007(4),0(@01)                                  0649
*         /***********************************************************/
*         /*                                                         */
*         /* THE ARGUMENT STRUCTURE PASSED WITH THE URESET MACRO FOR */
*         /* RETURN OF THE PAGE NUMBER TO THE CALLER.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0650
*         DCL PGNOPTR PTR(31);                                     0650
*         DCL 1 PGNO BASED(PGNOPTR),                               0651
*              2 PGNOL FIXED(15),      /* LENGTH OF PAGE NUMBER.     */
*              2 PGNOC CHAR(4);        /* CHARACTERS OF PAGE NUMBER  */
*                                                                  0651
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK TO ASSURE THAT A PRINT CONTROL TABLE EXISTS.      */
*         /* IF NONE EXISTS, SOMETHING IS OUT OF SEQUENCE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0652
*         IF GDTTPH = NULLPTR                                      0652
*           THEN                                                   0652
         L     @03,@PC00001                                        0652
         L     @15,GDTTPH(,@03)                                    0652
         LTR   @15,@15                                             0652
         BNZ   @RF00652                                            0652
*             DO;                                                  0653
*                                                                  0653
*               DO;                                                0654
*                 RESPECIFY(REG13,REG14,REG15) RSTD;               0655
*                 REG15 = 24;                                      0656
         LA    REG15,24                                            0656
*                 REG14 = GDTABT;                                  0657
         L     REG14,GDTABT(,@03)                                  0657
*                 REG13 = GDTABH;                                  0658
         L     REG13,GDTABH(,@03)                                  0658
*                 GEN(BR    REG14);                                0659
         BR    REG14
*                 RESPECIFY(REG13,REG14,REG15)UNRSTD;              0660
*               END;                                               0661
*             END;                                                 0662
*                                                                  0662
*         /***********************************************************/
*         /*                                                         */
*         /* SET ADDRESSABILITY TO THE CURRENT PCT.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0663
*         PCTPTR = GDTTPH;                                         0663
@RF00652 L     @06,@PC00001                                        0663
         L     PCTPTR,GDTTPH(,@06)                                 0663
*         SAVERC = 0;                                              0664
         SLR   SAVERC,SAVERC                                       0664
*         IF PCTSPP ^= NULLPTR                                     0665
*           THEN                                                   0665
         L     @04,PCTSPP(,PCTPTR)                                 0665
         LTR   @04,@04                                             0665
         BZ    @RF00665                                            0665
*             DO;                                                  0666
*               PCTPTR = PCTSPP;                                   0667
         LR    PCTPTR,@04                                          0667
*               PCTNLI = 999;                                      0668
         LA    @04,999                                             0668
         STH   @04,PCTNLI(,PCTPTR)                                 0668
*               PCTSNL = 999;                                      0669
         STH   @04,PCTSNL(,PCTPTR)                                 0669
*             END;                                                 0670
*                                                                  0670
*         /***********************************************************/
*         /*                                                         */
*         /* FLUSH THE STACK BUFFER BEFORE MAKING CHANGES.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0671
*         CALL STACKFL;                                            0671
*                                                                  0671
@RF00665 BAL   @14,STACKFL                                         0671
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT AND RETURN THE PAGE NUMBER TO THE CALLERS AREA. */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0672
*         IF PGNOF = ON                                            0672
*           THEN                                                   0672
         TM    PGNOF,B'01000000'                                   0672
         BNO   @RF00672                                            0672
*             DO;                                                  0673
*               CVDREG = PCTCPN;                                   0674
         LH    CVDREG,PCTCPN(,PCTPTR)                              0674
*GEN     (CVD   CVDREG,PACKWD);                                    0675
         CVD   CVDREG,PACKWD
*GEN     (UNPK  PAGE,PACKWD);                                      0676
*                                                                  0676
         UNPK  PAGE,PACKWD
*               PAGE(4) = PAGE(4)  'F0'X;  /* TURN OFF SIGN.        */
         OI    PAGE+3,X'F0'                                        0677
*               PGNOC(1:PGNOL) = PAGE((5-PGNOL):4);                0678
         L     @04,@PC00007                                        0678
         L     @04,PGNOPTR(,@04)                                   0678
         LH    @03,PGNOL(,@04)                                     0678
         LR    @15,@03                                             0678
         BCTR  @15,0                                               0678
         LCR   @03,@03                                             0678
         AL    @03,@CF00268                                        0678
         LA    @01,PAGE-1(@03)                                     0678
         EX    @15,@SM00727                                        0678
*             END;                                                 0679
*         GDTTPH ->PCTSTM = PCTSTM;                                0680
@RF00672 L     @04,@PC00001                                        0680
         L     @04,GDTTPH(,@04)                                    0680
         MVC   PCTSTM(8,@04),PCTSTM(PCTPTR)                        0680
*         GDTTPH ->PCTSME = PCTSME;                                0681
         L     @03,PCTSME(,PCTPTR)                                 0681
         ST    @03,PCTSME(,@04)                                    0681
*         IF PCTAPF = ON                                           0682
*           THEN                                                   0682
         TM    PCTAPF(PCTPTR),B'00001000'                          0682
         BNO   @RF00682                                            0682
*             GDTTPH->PCTACT = PCTSTD;                             0683
         MVC   PCTACT(8,@04),PCTSTD(PCTPTR)                        0683
*           ELSE                                                   0684
*             GDTTPH ->PCTACT = PCTACT;                            0684
*                                                                  0684
         B     @RC00682                                            0684
@RF00682 L     @04,@PC00001                                        0684
         L     @04,GDTTPH(,@04)                                    0684
         MVC   PCTACT(8,@04),PCTACT(PCTPTR)                        0684
*         /***********************************************************/
*         /*                                                         */
*         /* FREE  THE TP01 SUB-POOL AND RETURN TO THE CALLER.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0685
*         CALL ICKSAFP0 (GDTTBL,TPPOOL,ALL);                       0685
*                                                                  0685
@RC00682 MVC   @AL00001+4(8),@AL00685                              0685
         L     @04,@PC00001                                        0685
         ST    @04,@AL00001                                        0685
         L     @15,GDTFPL(,@04)                                    0685
         LA    @01,@AL00001                                        0685
         BALR  @14,@15                                             0685
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAR THE STID AND HEADER QUEUE POINTERS.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0686
*         PCTPTR = GDTTPH;                                         0686
         L     @03,@PC00001                                        0686
         L     PCTPTR,GDTTPH(,@03)                                 0686
*         PCTSPP = NULLPTR;                                        0687
         SLR   @04,@04                                             0687
         ST    @04,PCTSPP(,PCTPTR)                                 0687
*         PCTSQP = NULLPTR;                                        0688
         ST    @04,PCTSQP(,PCTPTR)                                 0688
*         PCTAHP = NULLPTR;                                        0689
         ST    @04,PCTAHP(,PCTPTR)                                 0689
*         PCTBNL = PCTBUF;                                         0690
*                                                                  0690
         L     @03,PCTBUF(,PCTPTR)                                 0690
         ST    @03,PCTBNL(,PCTPTR)                                 0690
*         RETURN CODE(0);                                          0691
         LR    @15,@04                                             0691
         L     @14,@SA00007                                        0691
         LM    @00,@12,@SA00007+8                                  0691
         BR    @14                                                 0691
*         END RESETCON;                                            0692
*                                                                  0692
*         /*                                                         */
*         /* PROCEDURE NAME - GET PRINT CONTROL TABLE.               */
*         /*                                                         */
*         /* FUNCTION - GETS CORE FOR AND INITIALIZES THE PRINT      */
*         /* CONTROL TABLE.                                          */
*         /*                                                         */
*         /* INPUT - NONE.                                           */
*         /*                                                         */
*         /* OUTPUT - NEW UNINITIALIZED PRINT CONTROL TABLE.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0693
*INITPCT: PROC;                                                    0693
*                                                                  0693
INITPCT  STM   @14,@04,@SA00008                                    0693
         STM   @06,@12,@SA00008+28                                 0693
*         /***********************************************************/
*         /*                                                         */
*         /* FLUSH THE STACK BUFFER BEFORE MAKING CHANGES.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0694
*         IF GDTTPH ^= NULLPTR                                     0694
*           THEN                                                   0694
*                                                                  0694
         L     @04,@PC00001                                        0694
         L     @04,GDTTPH(,@04)                                    0694
         LTR   @04,@04                                             0694
         BZ    @RF00694                                            0694
*             CALL STACKFL;                                        0695
*                                                                  0695
         BAL   @14,STACKFL                                         0695
*         PCTPTR = GDTTPH;                                         0696
*                                                                  0696
@RF00694 L     @03,@PC00001                                        0696
         L     @03,GDTTPH(,@03)                                    0696
         LR    PCTPTR,@03                                          0696
*         /***********************************************************/
*         /*                                                         */
*         /* IF AN EXISTING SECONDARY TABLE EXISTS, FREE IT.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0697
*         IF GDTTPH ^= NULLPTR & PCTSPP ^= NULLPTR                 0697
*           THEN                                                   0697
         SLR   @04,@04                                             0697
         CR    @03,@04                                             0697
         BE    @RF00697                                            0697
         L     @15,PCTSPP(,PCTPTR)                                 0697
         CR    @15,@04                                             0697
         BE    @RF00697                                            0697
*             DO;                                                  0698
*               PCTPTR = PCTSPP;                                   0699
         LR    PCTPTR,@15                                          0699
*               IF GDTTPH -> PCTAPF = ON                           0700
*                 THEN                                             0700
         TM    PCTAPF(@03),B'00001000'                             0700
         BNO   @RF00700                                            0700
*                   GDTTPH->PCTACT = PCTSTD;                       0701
         MVC   PCTACT(8,@03),PCTSTD(PCTPTR)                        0701
*                 ELSE                                             0702
*                   GDTTPH->PCTACT = PCTACT;                       0702
         B     @RC00700                                            0702
@RF00700 L     @04,@PC00001                                        0702
         L     @04,GDTTPH(,@04)                                    0702
         MVC   PCTACT(8,@04),PCTACT(PCTPTR)                        0702
*               PCTPTR = GDTTPH;                                   0703
*                                                                  0703
@RC00700 L     @03,@PC00001                                        0703
         L     PCTPTR,GDTTPH(,@03)                                 0703
*               CALL ICKSAFP0 (GDTTBL,TPPOOL,ALL);                 0704
*                                                                  0704
         MVC   @AL00001+4(8),@AL00704                              0704
         ST    @03,@AL00001                                        0704
         L     @15,GDTFPL(,@03)                                    0704
         LA    @01,@AL00001                                        0704
         BALR  @14,@15                                             0704
*               GDTTPH->PCTSQP = NULLPTR;                          0705
*                                                                  0705
         L     @04,@PC00001                                        0705
         L     @04,GDTTPH(,@04)                                    0705
         SLR   @03,@03                                             0705
         ST    @03,PCTSQP(,@04)                                    0705
*             END;                                                 0706
*                                                                  0706
*             OLDERID2 = NEWERID2;                                 0707
@RF00697 L     @04,@PC00001                                        0707
         L     @03,GDTTR2(,@04)                                    0707
         MVC   @TS00001(95),NEWERID2(@03)                          0707
         MVC   OLDERID2(95,@03),@TS00001                           0707
*             NEWID2 = 'TP4G';                                     0708
*                                                                  0708
         MVC   NEWID2(4,@03),@CC00714                              0708
*         /***********************************************************/
*         /*                                                         */
*         /* IF REQUEST IS FOR PRIMARY PCT, GET NON POOL CORE.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0709
*         IF GDTTPH = NULLPTR                                      0709
*           THEN                                                   0709
         L     @03,GDTTPH(,@04)                                    0709
         LTR   @03,@03                                             0709
         BNZ   @RF00709                                            0709
*             DO;                                                  0710
*                                                                  0710
*               CALL ICKSAGS0 (GDTTBL,PCTLEN,GDTTPH,SETZERO);      0711
*                                                                  0711
         ST    @04,@AL00001                                        0711
         LA    @05,PCTLEN                                          0711
         ST    @05,@AL00001+4                                      0711
         LA    @05,GDTTPH(,@04)                                    0711
         ST    @05,@AL00001+8                                      0711
         LA    @05,@CC00158                                        0711
         ST    @05,@AL00001+12                                     0711
         MVI   @AL00001+12,X'80'                                   0711
         L     @15,GDTGSP(,@04)                                    0711
         LA    @01,@AL00001                                        0711
         BALR  @14,@15                                             0711
*               RESPECIFY RTNREG RSTD;                             0712
*               TESTRC = RTNREG;                                   0713
         LR    TESTRC,RTNREG                                       0713
*               RESPECIFY RTNREG UNRSTD;                           0714
*               IF TESTRC ^= 0                                     0715
*                 THEN                                             0715
*                                                                  0715
         LTR   TESTRC,TESTRC                                       0715
         BZ    @RF00715                                            0715
*                   DO;                                            0716
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0717
*                     REG15 = 28;                                  0718
         LA    REG15,28                                            0718
*                     REG14 = GDTABT;                              0719
         L     @03,@PC00001                                        0719
         L     REG14,GDTABT(,@03)                                  0719
*                     REG13 = GDTABH;                              0720
         L     REG13,GDTABH(,@03)                                  0720
*                     GEN(BR    REG14);                            0721
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0722
*                   END;                                           0723
*               PCTPTR = GDTTPH;                                   0724
@RF00715 L     @03,@PC00001                                        0724
         L     PCTPTR,GDTTPH(,@03)                                 0724
*               PCTIDN = 'PCT1';                                   0725
         MVC   PCTIDN(4,PCTPTR),@CC00715                           0725
*             END;                                                 0726
*                                                                  0726
*           /*********************************************************/
*           /*                                                       */
*           /* IF REQUEST IS FOR SECONDARY PCT, GET TP POOL CORE.    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0727
*           ELSE                                                   0727
*             DO;                                                  0727
*                                                                  0727
         B     @RC00709                                            0727
@RF00709 DS    0H                                                  0728
*               CALL ICKSAGP0 (GDTTBL,PCTLEN,PCTSPP,TPPOOL,SETZERO);
*                                                                  0728
         MVC   @AL00001+4(16),@AL00728                             0728
         L     @04,@PC00001                                        0728
         ST    @04,@AL00001                                        0728
         LA    @15,PCTSPP(,PCTPTR)                                 0728
         ST    @15,@AL00001+8                                      0728
         L     @15,GDTGPL(,@04)                                    0728
         LA    @01,@AL00001                                        0728
         BALR  @14,@15                                             0728
*               RESPECIFY RTNREG RSTD;                             0729
*               TESTRC = RTNREG;                                   0730
         LR    TESTRC,RTNREG                                       0730
*               RESPECIFY RTNREG UNRSTD;                           0731
*               IF TESTRC ^= 0                                     0732
*                 THEN                                             0732
*                                                                  0732
         LTR   TESTRC,TESTRC                                       0732
         BZ    @RF00732                                            0732
*                   DO;                                            0733
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0734
*                     REG15 = 28;                                  0735
         LA    REG15,28                                            0735
*                     REG14 = GDTABT;                              0736
         L     @04,@PC00001                                        0736
         L     REG14,GDTABT(,@04)                                  0736
*                     REG13 = GDTABH;                              0737
         L     REG13,GDTABH(,@04)                                  0737
*                     GEN(BR    REG14);                            0738
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0739
*                   END;                                           0740
*                                                                  0740
*               PCTPTR = PCTSPP;                                   0741
@RF00732 L     PCTPTR,PCTSPP(,PCTPTR)                              0741
*               PCTTAB = GDTTPH->PCTTAB;                           0742
         L     @04,@PC00001                                        0742
         L     @04,GDTTPH(,@04)                                    0742
         MVC   PCTTAB(112,PCTPTR),PCTTAB(@04)                      0742
*               PCTSPP = NULLPTR;                                  0743
         SLR   @04,@04                                             0743
         ST    @04,PCTSPP(,PCTPTR)                                 0743
*               PCTSQP = NULLPTR;                                  0744
         ST    @04,PCTSQP(,PCTPTR)                                 0744
*               PCTAHP = NULLPTR;                                  0745
         ST    @04,PCTAHP(,PCTPTR)                                 0745
*               PCTIDN = 'PCT2';                                   0746
         MVC   PCTIDN(4,PCTPTR),@CC00716                           0746
*             END;                                                 0747
*         END INITPCT;                                             0748
@EL00008 DS    0H                                                  0748
@EF00008 DS    0H                                                  0748
@ER00008 LM    @14,@04,@SA00008                                    0748
         LM    @06,@12,@SA00008+28                                 0748
         BR    @14                                                 0748
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - PRINT STACK BUFFER FLUSHING.           */
*         /*                                                         */
*         /* FUNCTION - CLEARS OUT ANY LINES THAT MAY HAVE BEEN LEFT */
*         /* IN THE STACK BUFFER BY PREVIOUS OPERATIONS BY PUTTING   */
*         /* THEM TO THE IO ADAPTOR.                                 */
*         /*                                                         */
*         /* INPUT - PRINT CONTROL TABLE & STACK BUFFER.             */
*         /*                                                         */
*         /* OUTPUT - PRINTED LINES TO SYSPRINT.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0749
*STACKFL: PROC;                                                    0749
*                                                                  0749
STACKFL  STM   @14,@12,@SA00009                                    0749
*         IF PCTLNM = 0                                            0750
*           THEN                                                   0750
         SLR   @04,@04                                             0750
         CH    @04,PCTLNM(,PCTPTR)                                 0750
         BNE   @RF00750                                            0750
*             RETURN CODE(0);                                      0751
*                                                                  0751
         LR    @15,@04                                             0751
         L     @14,@SA00009                                        0751
         LM    @00,@12,@SA00009+8                                  0751
         BR    @14                                                 0751
*         IOCSPTR = PCTIOC;             /* SET IOCS ADDRESSABILITY   */
@RF00750 L     IOCSPTR,PCTIOC(,PCTPTR)                             0752
*         IOCDLN = PCTBNL - PCTBUF;     /* SET DATA LENGTH.          */
         L     @04,PCTBUF(,PCTPTR)                                 0753
         L     @15,PCTBNL(,PCTPTR)                                 0753
         SLR   @15,@04                                             0753
         ST    @15,IOCDLN(,IOCSPTR)                                0753
*         IOCDAD = PCTBUF;              /* SET DATA ADDRESS.         */
         ST    @04,IOCDAD(,IOCSPTR)                                0754
*         IOCPNM = PCTLNM;              /* SET LINE COUNT.           */
*                                                                  0755
         LH    @04,PCTLNM(,PCTPTR)                                 0755
         STH   @04,IOCPNM(,IOCSPTR)                                0755
*         CALL ICKIOPT0 (GDTTBL,PCTIOC,NULLPMN);                   0756
*                                                                  0756
         L     @04,@PC00001                                        0756
         ST    @04,@AL00001                                        0756
         LA    @15,PCTIOC(,PCTPTR)                                 0756
         ST    @15,@AL00001+4                                      0756
         LA    @15,NULLPMN                                         0756
         ST    @15,@AL00001+8                                      0756
         MVI   @AL00001+8,X'80'                                    0756
         L     @15,GDTPUT(,@04)                                    0756
         LA    @01,@AL00001                                        0756
         BALR  @14,@15                                             0756
*         RESPECIFY RTNREG RSTD;                                   0757
*         TESTRC = RTNREG;                                         0758
         LR    TESTRC,RTNREG                                       0758
*         RESPECIFY RTNREG UNRSTD;                                 0759
*         IF TESTRC ^= 0                                           0760
*           THEN                                                   0760
*                                                                  0760
         LTR   TESTRC,TESTRC                                       0760
         BZ    @RF00760                                            0760
*             DO;                                                  0761
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0762
*               REG15 = 28;                                        0763
         LA    REG15,28                                            0763
*               REG14 = GDTABT;                                    0764
         L     @04,@PC00001                                        0764
         L     REG14,GDTABT(,@04)                                  0764
*               REG13 = GDTABH;                                    0765
         L     REG13,GDTABH(,@04)                                  0765
*               GEN(BR    REG14);                                  0766
         BR    REG14
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0767
*             END;                                                 0768
*                                                                  0768
*         GDTTPH->PCTLNM = NULLPTR;                                0769
@RF00760 SLR   @04,@04                                             0769
         L     @03,@PC00001                                        0769
         L     @03,GDTTPH(,@03)                                    0769
         STH   @04,PCTLNM(,@03)                                    0769
*         GDTTPH->PCTBNL = PCTBUF;                                 0770
         L     @15,PCTBUF(,PCTPTR)                                 0770
         ST    @15,PCTBNL(,@03)                                    0770
*         PCTLNM = NULLPTR;                                        0771
         STH   @04,PCTLNM(,PCTPTR)                                 0771
*         PCTBNL = PCTBUF;                                         0772
*                                                                  0772
         ST    @15,PCTBNL(,PCTPTR)                                 0772
*         END STACKFL;                                             0773
*                                                                  0773
@EL00009 DS    0H                                                  0773
@EF00009 DS    0H                                                  0773
@ER00009 LM    @14,@12,@SA00009                                    0773
         BR    @14                                                 0773
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE PAGE CONTROL MAJOR PROCEDURE.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0774
*         END ICKTP04                                              0774
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF07 )                                        *
*;                                                                 0774
@DATA    DS    0H
@CH00699 DC    H'60'
@CH00619 DC    H'66'
@CH00617 DC    H'121'
@CH00685 DC    H'-1'
@SM00724 MVC   0(0,@01),PGNOCIN(@04)
@SM00727 MVC   PGNOC(0,@04),0(@01)
         DS    0F
@AL00685 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00704 DC    A(TPPOOL)               LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(@CC00150)
@AL00728 DC    A(PCTLEN)               LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(TPPOOL)
         DC    AL1(X'80')
         DC    AL3(@CC00158)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    10F
@SA00002 DS    15F
@PC00002 DS    1F
@SA00003 DS    15F
@PC00003 DS    1F
@SA00005 DS    15F
@SA00007 DS    15F
@PC00007 DS    1F
@SA00008 DS    14F
@SA00006 DS    14F
@SA00009 DS    15F
@AL00001 DS    5A
@TF00001 DS    F
ICKTP04  CSECT
         DS    0F
@CF00178 DC    F'1'
@CH00178 EQU   @CF00178+2
@CF00129 DC    F'2'
@CF00149 DC    F'3'
@CH00149 EQU   @CF00149+2
@CF00055 DC    F'4'
@CH00055 EQU   @CF00055+2
@CF00268 DC    F'5'
@CF00132 DC    F'6'
@CF00198 DC    F'7'
@CF00700 DC    F'133'
@CF00640 DC    F'255'
@CF00701 DC    F'9999'
@CF00726 DC    F'-121'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
PCAADDR  DS    A
SPCCNT   DS    F
LISTPTR  DS    A
TEMPTR   DS    A
SETRC    DS    H
@TS00001 DS    CL95
         DS    CL3
P04WT    DS    CL42
         ORG   P04WT
P04MTP   DS    AL4
P04STP   DS    AL4
P04FP    DS    AL4
P04FNP   DS    AL4
P04PCP   DS    AL4
P04MTC   DS    FL2
P04STC   DS    FL2
P04FC    DS    FL2
P04LW    DS    FL2
P04PD    DS    FL2
P04DSC   DS    FL2
P04CPN   DS    FL2
P04PNI   DS    FL2
P04PNL   DS    FL2
P04TL    DS    FL2
P04DL    DS    FL2
         ORG   P04WT+42
         DS    CL2
PROPEN   DS    CL48
P04FLG   DS    BL1
         ORG   P04FLG
PRIPCT   DS    BL1
PGNOF    EQU   P04FLG+0
         ORG   P04FLG+1
STID     DS    CL4
PAGE     DS    CL4
         DS    CL7
PACKWD   DS    CL8
RESTARG  DS    7A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKTP04  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
PCTLEN   DC    AL4(112)
STDLW    DC    F'121'
PRBUFL   DC    F'2048'
SUBPZ    DC    F'0'
IOPLSP   DC    F'40'
TTSIZE   DC    H'256'
OFLOSS   DC    H'12'
NULLPMN  DC    H'0'
@CC00659 DC    C'ICKTP05 '
@CC00152 DC    C'FORM'
@CC00158 DC    C'ZERO'
@CC00654 DC    C'TP4I'
@CC00658 DC    C'TP4A'
@CC00662 DC    C'TP4S'
@CC00693 DC    C'TP4R'
@CC00714 DC    C'TP4G'
@CC00715 DC    C'PCT1'
@CC00716 DC    C'PCT2'
@CC00150 DC    C'ALL'
@CC00641 DC    C'STS'
@CC00643 DC    C'STA'
@CC00645 DC    C'RES'
@CC00647 DC    C'RST'
@CC00691 DC    C'TP0'
@CC00684 EQU   @CC00641
@CC00686 DC    C'FT'
@CC00687 DC    C'LW'
@CC00688 DC    C'PD'
@CC00689 DC    C'SC'
@CC00690 EQU   @CC00715
@CC00692 DC    C'PN'
MODID    DC    CL4'TP04'
TPPOOL   DC    CL4'TP01'
DUMPID   DC    CL4'TP04'
FIXAREA  DS    CL220
PCTAB    DC    X'C1D501'
         DC    X'C8D506'
         DC    X'D7D502'
         DC    X'D8D503'
         DC    X'D9D507'
         DC    X'E2D504'
         DC    X'E3D505'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
N        EQU   @03
ARGNMB   EQU   @09
SAVERC   EQU   @07
PCRADDR  EQU   @06
PCTPTR   EQU   @05
OPNPTR   EQU   @03
IOCSPTR  EQU   @03
TESTRC   EQU   @03
LISTLN   EQU   @08
RTNREG   EQU   @15
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
CVDREG   EQU   @02
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
ICKSACL0 EQU   0
ICKSALD0 EQU   0
ICKSAEP0 EQU   0
ICKSAGS0 EQU   0
ICKSAFS0 EQU   0
ICKSAGP0 EQU   0
ICKSAFP0 EQU   0
ICKSATI0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
LISTTEST EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
IOCPNM   EQU   IOCSTR+28
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNTYPSO EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNMODAC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
PCTTAB   EQU   0
PCTIDN   EQU   PCTTAB
PCTFLG   EQU   PCTTAB+4
PCTAPF   EQU   PCTFLG
PCTSPP   EQU   PCTTAB+8
PCTACT   EQU   PCTTAB+12
PCTIOC   EQU   PCTACT
PCTAPL   EQU   PCTACT+4
PCTCPN   EQU   PCTAPL
PCTNLI   EQU   PCTAPL+2
PCTSTD   EQU   PCTTAB+20
PCTSPL   EQU   PCTSTD+4
PCTSNL   EQU   PCTSPL+2
PCTALT   EQU   PCTTAB+28
PCTLPL   EQU   PCTALT+4
PCTANL   EQU   PCTLPL+2
PCTSTM   EQU   PCTTAB+36
PCTSME   EQU   PCTTAB+44
PCTSQP   EQU   PCTTAB+48
PCTAHP   EQU   PCTTAB+52
PCTMLP   EQU   PCTTAB+56
PCTSLP   EQU   PCTTAB+60
PCTTRP   EQU   PCTTAB+64
PCTPLW   EQU   PCTTAB+68
PCTSLC   EQU   PCTTAB+74
PCTFLP   EQU   PCTTAB+76
PCTFLC   EQU   PCTTAB+80
PCTPNL   EQU   PCTTAB+84
PCTPPD   EQU   PCTTAB+90
PCTDSC   EQU   PCTTAB+92
PCTPNI   EQU   PCTTAB+94
PCTFDL   EQU   PCTTAB+96
PCTLDL   EQU   PCTTAB+98
PCTFLN   EQU   PCTTAB+100
PCTLNM   EQU   PCTTAB+102
PCTBUF   EQU   PCTTAB+104
PCTBNL   EQU   PCTTAB+108
MTLINE   EQU   0
MTLCC    EQU   MTLINE
MTLBUFF  EQU   MTLINE+1
MTINL    EQU   0
MTLINBF  EQU   MTINL+1
STLINE   EQU   0
STLCC    EQU   STLINE
FTLINE   EQU   0
FTLCC    EQU   FTLINE
PCA      EQU   0
PCMTLP   EQU   PCA
PCSTLP   EQU   PCA+4
PCFLP    EQU   PCA+8
PCPCP    EQU   PCA+12
PCPNL    EQU   PCA+16
PCPTL    EQU   PCA+18
PCPDL    EQU   PCA+20
PCMTLC   EQU   PCA+22
PCSTLC   EQU   PCA+24
PCFLC    EQU   PCA+26
PCLW     EQU   PCA+28
PCPD     EQU   PCA+30
PCDSC    EQU   PCA+32
PCR      EQU   0
PCRTYP   EQU   PCR
PCRLC    EQU   PCR+2
PCRPTR   EQU   PCR+4
TTDSN    EQU   0
PGNOIN   EQU   0
PGNOLIN  EQU   PGNOIN
PGNOCIN  EQU   PGNOIN+2
PGNO     EQU   0
PGNOL    EQU   PGNO
PGNOC    EQU   PGNO+2
DMPTRM   EQU   0
ICKDVCL0 EQU   0
ICKDVIN0 EQU   0
ICKDVON0 EQU   0
ICKDVOP0 EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOTM0 EQU   0
ICKSADE0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPPR0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
NEWERID1 EQU   5
TRANTAB  EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTTPH   EQU   GDTTBL+28
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
MACARG   EQU   0
FILENAME EQU   0
ARG1     EQU   0
ARG2     EQU   0
ARG3     EQU   0
ARG4     EQU   0
ARG5     EQU   0
ARG6     EQU   0
ARG7     EQU   0
STIDS    EQU   0
PCALIST  EQU   0
PGNOPTR  EQU   0
PCRLCC   EQU   PCRLC
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
FTBUFF   EQU   FTLINE+1
STLBUFF  EQU   STLINE+1
MTLINCC  EQU   MTINL
PCTAPC   EQU   PCTTAB+88
PCTPMN   EQU   PCTTAB+86
PCTHSC   EQU   PCTTAB+83
PCTHLC   EQU   PCTTAB+82
PCTMLC   EQU   PCTTAB+72
PCTAPN   EQU   PCTLPL
PCTIOP   EQU   PCTALT
PCTSPN   EQU   PCTSPL
PCTIOS   EQU   PCTSTD
@NM00018 EQU   PCTFLG
PCTLLM   EQU   PCTFLG
PCTHAF   EQU   PCTFLG
PCTH2F   EQU   PCTFLG
PCTH1F   EQU   PCTFLG
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00521 EQU   @RC00515
@RC00709 EQU   @EL00008
@PB00009 EQU   @EL00001
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   ICKTP04,(C'PLS1800',0701,78192)

         TITLE '****** ICKRI03: READER/INTER. COMMAND TERMINATION MODUL*
               LE ******'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKRI03  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'ICKRI03   78.192'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(8),0(@01)                                  0002
*        /************************************************************/
*        /*                                                          */
*        /*  ** ICKRI03 **  R/I COMMAND TERMINATION ROUTINE          */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0193
*          THEN;                                                   0193
         L     @10,@PC00001                                        0193
         L     @10,GDTDBG(,@10)                                    0193
         LTR   @10,@10                                             0193
         BZ    @RT00193                                            0193
*          ELSE                                                    0195
*            CALL ICKDB010(GDTTBL,'RITM');                         0195
*                                                                  0195
         L     @10,@PC00001                                        0195
         ST    @10,@AL00001                                        0195
         LA    @15,@CC00527                                        0195
         ST    @15,@AL00001+4                                      0195
         MVI   @AL00001+4,X'80'                                    0195
         L     @15,GDTDBG(,@10)                                    0195
         LA    @01,@AL00001                                        0195
         BALR  @14,@15                                             0195
*        DDSTRU=ADDR(PRNTAREA);                                    0196
@RT00193 LA    @10,PRNTAREA                                        0196
         ST    @10,DDSTRU                                          0196
*        PRNTAREA=''B;                                             0197
*                                                                  0197
         XC    PRNTAREA(20),PRNTAREA                               0197
*        CALL ICKSAFP0(GDTTBL,RIPOOLID,ALL);                       0198
*                                                                  0198
         MVC   @AL00001+4(8),@AL00198                              0198
         L     @10,@PC00001                                        0198
         ST    @10,@AL00001                                        0198
         L     @15,GDTFPL(,@10)                                    0198
         LA    @01,@AL00001                                        0198
         BALR  @14,@15                                             0198
*        IF RISTATUS^=0                                            0199
*          THEN                                                    0199
         L     @10,@PC00001+4                                      0199
         LH    @15,RISTATUS(,@10)                                  0199
         LTR   @15,@15                                             0199
         BZ    @RF00199                                            0199
*            IF RISTATUS=EOFILE                                    0200
*                                                                  0200
*              /******************************************************/
*              /*                                                    */
*              /* WHEN END-OF-FILE HAS BEEN ENCOUNTERED ON THE INPUT */
*              /* DATA SET, FREE UP PREVIOUSLY ALLOCATED SPACE AND   */
*              /* DELETE LOADED MODULES BASED UPON WHETHER END-OF-   */
*              /* FILE COULD PROPERLY HAVE OCCURRED AT THIS TIME.    */
*              /* (PRINT AN ERROR MESSAGE IF END-OF-FILE OCCURRED    */
*              /* WHILE SCANNING A COMMAND.)                         */
*              /*                                                    */
*              /******************************************************/
*              THEN                                                0200
         CH    @15,@CH00103                                        0200
         BNE   @RF00200                                            0200
*                DO;                                               0201
*                IF EOFOK=NO                                       0202
*                  THEN                                            0202
         TM    EOFOK(@10),B'01000000'                              0202
         BNZ   @RF00202                                            0202
*                    DO;                                           0203
*                    MAXCC=MAX(MAXCC,BADERROR);                    0204
         LH    @15,MAXCC(,@10)                                     0204
         LA    @14,12                                              0204
         CR    @15,@14                                             0204
         BNL   *+6
         LR    @15,@14                                             0204
         STH   @15,MAXCC(,@10)                                     0204
*                    DARGSMOD=RISTID;                              0205
         L     @10,DDSTRU                                          0205
         MVC   DARGSMOD(3,@10),RISTID                              0205
*                    DARGSENT=BADEOF;                              0206
*                                                                  0206
         MVI   DARGSENT(@10),X'25'                                 0206
*                    CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);         0207
*                                                                  0207
         L     @10,@PC00001                                        0207
         ST    @10,@AL00001                                        0207
         LA    @15,@CF00087                                        0207
         ST    @15,@AL00001+4                                      0207
         LA    @15,DDSTRU                                          0207
         ST    @15,@AL00001+8                                      0207
         MVI   @AL00001+8,X'80'                                    0207
         L     @15,GDTPRT(,@10)                                    0207
         LA    @01,@AL00001                                        0207
         BALR  @14,@15                                             0207
*                    CALL ICKSADE0(GDTTBL,DESCNAME);               0208
         L     @10,@PC00001                                        0208
         ST    @10,@AL00001                                        0208
         L     @15,@PC00001+4                                      0208
         LA    @15,DESCNAME(,@15)                                  0208
         ST    @15,@AL00001+4                                      0208
         L     @15,GDTDEL(,@10)                                    0208
         LA    @01,@AL00001                                        0208
         BALR  @14,@15                                             0208
*                    CALL ICKSAFP0(GDTTBL,POOLID);                 0209
*                                                                  0209
         L     @10,@PC00001                                        0209
         ST    @10,@AL00001                                        0209
         L     @15,@PC00001+4                                      0209
         LA    @15,POOLID(,@15)                                    0209
         ST    @15,@AL00001+4                                      0209
         MVI   @AL00001+4,X'80'                                    0209
         L     @15,GDTFPL(,@10)                                    0209
         LA    @01,@AL00001                                        0209
         BALR  @14,@15                                             0209
*                    END;                                          0210
*                                                                  0210
*                CALL ICKSAFS0(GDTTBL,GDTRIH);                     0211
*                                                                  0211
@RF00202 L     @10,@PC00001                                        0211
         ST    @10,@AL00001                                        0211
         LA    @15,GDTRIH(,@10)                                    0211
         ST    @15,@AL00001+4                                      0211
         L     @15,GDTFSP(,@10)                                    0211
         LA    @01,@AL00001                                        0211
         BALR  @14,@15                                             0211
*                GDTRIH=NULLPTR;                                   0212
*                                                                  0212
         L     @10,@PC00001                                        0212
         SLR   @15,@15                                             0212
         ST    @15,GDTRIH(,@10)                                    0212
*                CALL ICKSADE0(GDTTBL,LTBLNAME);                   0213
         ST    @10,@AL00001                                        0213
         LA    @15,LTBLNAME                                        0213
         ST    @15,@AL00001+4                                      0213
         L     @15,GDTDEL(,@10)                                    0213
         LA    @01,@AL00001                                        0213
         BALR  @14,@15                                             0213
*                CALL ICKSADE0(GDTTBL,KTBLNAME);                   0214
*                                                                  0214
         L     @10,@PC00001                                        0214
         ST    @10,@AL00001                                        0214
         LA    @15,KTBLNAME                                        0214
         ST    @15,@AL00001+4                                      0214
         L     @15,GDTDEL(,@10)                                    0214
         LA    @01,@AL00001                                        0214
         BALR  @14,@15                                             0214
*                END;                                              0215
*                                                                  0215
*              /******************************************************/
*              /*                                                    */
*              /* WHEN THE INTERNAL STATUS CODE IS BAD BECAUSE OF    */
*              /* SOMETHING OTHER THAN END-OF-FILE, THEN PRINT AN    */
*              /* ERROR MESSAGE, RELEASE SPACE, & DELETE LOAD MODULES*/
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                0216
*DOGRP1:         DO;                                               0216
*                                                                  0216
         B     @RC00200                                            0216
@RF00200 DS    0H                                                  0216
DOGRP1   DS    0H                                                  0217
*                CALL ICKSADE0(GDTTBL,DESCNAME);                   0217
         L     @10,@PC00001                                        0217
         ST    @10,@AL00001                                        0217
         L     @15,@PC00001+4                                      0217
         LA    @15,DESCNAME(,@15)                                  0217
         ST    @15,@AL00001+4                                      0217
         L     @15,GDTDEL(,@10)                                    0217
         LA    @01,@AL00001                                        0217
         BALR  @14,@15                                             0217
*                CALL ICKSAFP0(GDTTBL,POOLID);                     0218
*                                                                  0218
         L     @10,@PC00001                                        0218
         ST    @10,@AL00001                                        0218
         L     @15,@PC00001+4                                      0218
         LA    @15,POOLID(,@15)                                    0218
         ST    @15,@AL00001+4                                      0218
         MVI   @AL00001+4,X'80'                                    0218
         L     @15,GDTFPL(,@10)                                    0218
         LA    @01,@AL00001                                        0218
         BALR  @14,@15                                             0218
*                /**************************************************/
*                /*                                                */
*                /* IF THE ERROR WAS IN THE PARAMETER OPTIONS      */
*                /* STRING, SET A STATUS CODE INDICATING THIS      */
*                /* AND UP THE SEVERITY CODE TO INDICATE A         */
*                /* TERMINATING ERROR.                             */
*                /*                                                */
*                /**************************************************/
*                IF OPTSFLAG=ON                                    0219
*                  THEN                                            0219
         L     @10,@PC00001+4                                      0219
         TM    OPTSFLAG(@10),B'00100000'                           0219
         BNO   @RF00219                                            0219
*                    DO;                                           0220
*                    RISTATUS=SKIPREST;                            0221
         MVC   RISTATUS(2,@10),@CH00154                            0221
*                    LASTCC=TERMERR;                               0222
         MVC   LASTCC(2,@10),@CH00265                              0222
*                    END;                                          0223
*                                                                  0223
*                /**************************************************/
*                /*                                                */
*                /* IF THE ERROR MEANS TERMINATING DMS, PRINT ERROR*/
*                /* MESSAGE(S), RELEASE R/I TABLES AND SPACE.      */
*                /*                                                */
*                /**************************************************/
*                IF LASTCC>=TERMERR × MAXCC>=TERMERR               0224
*                  THEN                                            0224
@RF00219 LA    @10,16                                              0224
         L     @15,@PC00001+4                                      0224
         CH    @10,LASTCC(,@15)                                    0224
         BNH   @RT00224                                            0224
         CH    @10,MAXCC(,@15)                                     0224
         BH    @RF00224                                            0224
@RT00224 DS    0H                                                  0225
*                    DO;                                           0225
*                    IF RISTATUS^=NOSPACE                          0226
*                      THEN                                        0226
         L     @10,@PC00001+4                                      0226
         LH    @10,RISTATUS(,@10)                                  0226
         CH    @10,@CH00269                                        0226
         BE    @RF00226                                            0226
*                        DO;                                       0227
*                        DARGSMOD=RISTID;                          0228
         L     @15,DDSTRU                                          0228
         MVC   DARGSMOD(3,@15),RISTID                              0228
*                        DARGSENT=RISTATUS;                        0229
         STC   @10,DARGSENT(,@15)                                  0229
*                        END;                                      0230
*                      ELSE                                        0231
*                        DO;                                       0231
         B     @RC00226                                            0231
@RF00226 DS    0H                                                  0232
*                        DARGSMOD='UV0';                           0232
         L     @10,DDSTRU                                          0232
         MVC   DARGSMOD(3,@10),@CC00533                            0232
*                        DARGSENT=4;                               0233
         MVI   DARGSENT(@10),X'04'                                 0233
*                        END;                                      0234
*                                                                  0234
*                    CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);         0235
*                                                                  0235
@RC00226 L     @10,@PC00001                                        0235
         ST    @10,@AL00001                                        0235
         LA    @15,@CF00087                                        0235
         ST    @15,@AL00001+4                                      0235
         LA    @15,DDSTRU                                          0235
         ST    @15,@AL00001+8                                      0235
         MVI   @AL00001+8,X'80'                                    0235
         L     @15,GDTPRT(,@10)                                    0235
         LA    @01,@AL00001                                        0235
         BALR  @14,@15                                             0235
*                    IF RISTATUS^=SKIPREST                         0236
*                      THEN                                        0236
         L     @10,@PC00001+4                                      0236
         CLC   RISTATUS(2,@10),@CH00154                            0236
         BE    @RF00236                                            0236
*                        DO;                                       0237
*                        DARGSMOD=RISTID;                          0238
         L     @10,DDSTRU                                          0238
         MVC   DARGSMOD(3,@10),RISTID                              0238
*                        DARGSENT=SKIPREST;                        0239
*                                                                  0239
         MVI   DARGSENT(@10),X'08'                                 0239
*                        CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);     0240
*                                                                  0240
         L     @10,@PC00001                                        0240
         ST    @10,@AL00001                                        0240
         LA    @15,@CF00087                                        0240
         ST    @15,@AL00001+4                                      0240
         LA    @15,DDSTRU                                          0240
         ST    @15,@AL00001+8                                      0240
         MVI   @AL00001+8,X'80'                                    0240
         L     @15,GDTPRT(,@10)                                    0240
         LA    @01,@AL00001                                        0240
         BALR  @14,@15                                             0240
*                        END;                                      0241
*                    IF GDTRIH ^= NULLPTR                          0242
*                      THEN                                        0242
*                                                                  0242
@RF00236 L     @10,@PC00001                                        0242
         L     @15,GDTRIH(,@10)                                    0242
         LTR   @15,@15                                             0242
         BZ    @RF00242                                            0242
*                        CALL ICKSAFS0(GDTTBL,GDTRIH);             0243
*                                                                  0243
         ST    @10,@AL00001                                        0243
         LA    @15,GDTRIH(,@10)                                    0243
         ST    @15,@AL00001+4                                      0243
         L     @15,GDTFSP(,@10)                                    0243
         LA    @01,@AL00001                                        0243
         BALR  @14,@15                                             0243
*                    GDTRIH=NULLPTR;                               0244
*                                                                  0244
@RF00242 L     @10,@PC00001                                        0244
         SLR   @15,@15                                             0244
         ST    @15,GDTRIH(,@10)                                    0244
*                    CALL ICKSADE0(GDTTBL,KTBLNAME);               0245
         ST    @10,@AL00001                                        0245
         LA    @15,KTBLNAME                                        0245
         ST    @15,@AL00001+4                                      0245
         L     @15,GDTDEL(,@10)                                    0245
         LA    @01,@AL00001                                        0245
         BALR  @14,@15                                             0245
*                    CALL ICKSADE0(GDTTBL,LTBLNAME);               0246
*                                                                  0246
         L     @10,@PC00001                                        0246
         ST    @10,@AL00001                                        0246
         LA    @15,LTBLNAME                                        0246
         ST    @15,@AL00001+4                                      0246
         L     @15,GDTDEL(,@10)                                    0246
         LA    @01,@AL00001                                        0246
         BALR  @14,@15                                             0246
*                    END;                                          0247
*                  ELSE                                            0248
*                                                                  0248
*                    /************************************************/
*                    /*                                              */
*                    /* IF NOT A TERMINATING ERROR, PREPARE TO SCAN  */
*                    /* THE NEXT COMMAND.  PRINT AN ERROR MESSAGE IF */
*                    /* PART OF THE PREVIOUS COMMAND WAS SKIPPED.    */
*                    /*                                              */
*                    /************************************************/
*                    DO;                                           0248
         B     @RC00224                                            0248
@RF00224 DS    0H                                                  0249
*                    IF SKIPPAST=YES                               0249
*                      THEN                                        0249
         L     @10,@PC00001+4                                      0249
         TM    SKIPPAST(@10),B'00001000'                           0249
         BNO   @RF00249                                            0249
*                        DO;                                       0250
*                        DARGSMOD=RISTID;                          0251
         L     @15,DDSTRU                                          0251
         MVC   DARGSMOD(3,@15),RISTID                              0251
*                        IF SCANONLY=NO                            0252
*                          THEN                                    0252
         TM    SCANONLY(@10),B'00010000'                           0252
         BNZ   @RF00252                                            0252
*                            DARGSENT=GOTONXT1;                    0253
         MVI   DARGSENT(@15),X'03'                                 0253
*                          ELSE                                    0254
*                            DARGSENT=GOTONXT2;                    0254
*                                                                  0254
         B     @RC00252                                            0254
@RF00252 L     @10,DDSTRU                                          0254
         MVI   DARGSENT(@10),X'11'                                 0254
*                        CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);     0255
*                                                                  0255
@RC00252 L     @10,@PC00001                                        0255
         ST    @10,@AL00001                                        0255
         LA    @15,@CF00087                                        0255
         ST    @15,@AL00001+4                                      0255
         LA    @15,DDSTRU                                          0255
         ST    @15,@AL00001+8                                      0255
         MVI   @AL00001+8,X'80'                                    0255
         L     @15,GDTPRT(,@10)                                    0255
         LA    @01,@AL00001                                        0255
         BALR  @14,@15                                             0255
*                        END;                                      0256
*                    RISTATUS=0;                                   0257
@RF00249 L     @10,@PC00001+4                                      0257
         SLR   @15,@15                                             0257
         STH   @15,RISTATUS(,@10)                                  0257
*                    END;                                          0258
*                  MAXCC=MAX(MAXCC,LASTCC);                        0259
@RC00224 L     @10,@PC00001+4                                      0259
         LH    @15,MAXCC(,@10)                                     0259
         LH    @14,LASTCC(,@10)                                    0259
         CR    @15,@14                                             0259
         BNL   *+6
         LR    @15,@14                                             0259
         STH   @15,MAXCC(,@10)                                     0259
*                END DOGRP1;                                       0260
*          ELSE                                                    0261
*                                                                  0261
*            /********************************************************/
*            /*                                                      */
*            /* IF STATUS CODE IS OKAY, SAVE HISTORICAL DATA AND SET */
*            /* UP TO RETURN A COMPLETED FDT TO THE DMS EXECUTIVE,   */
*            /* UNLESS THE COMMAND WAS BEING SCANNED ONLY TO CHECK   */
*            /* FOR CORRECT COMMAND SYNTAX AND SEMANTICS.            */
*            /*                                                      */
*            /********************************************************/
*DOGRP2:     DO;                                                   0261
         B     @RC00199                                            0261
@RF00199 DS    0H                                                  0261
DOGRP2   DS    0H                                                  0262
*            OLDERID2 = NEWERID2;                                  0262
         L     @10,@PC00001                                        0262
         L     @10,GDTTR2(,@10)                                    0262
         MVC   @TS00001(95),NEWERID2(@10)                          0262
         MVC   OLDERID2(95,@10),@TS00001                           0262
*            NEWID2='RI99';                                        0263
         MVC   NEWID2(4,@10),@CC00536                              0263
*            IF OPTSFLAG=ON                                        0264
*              THEN                                                0264
         L     @10,@PC00001+4                                      0264
         TM    OPTSFLAG(@10),B'00100000'                           0264
         BNO   @RF00264                                            0264
*                OPTSFLAG=OFF;                                     0265
*                                                                  0265
         NI    OPTSFLAG(@10),B'11011111'                           0265
*            CALL ICKSADE0(GDTTBL,DESCNAME);                       0266
*                                                                  0266
@RF00264 L     @10,@PC00001                                        0266
         ST    @10,@AL00001                                        0266
         L     @15,@PC00001+4                                      0266
         LA    @15,DESCNAME(,@15)                                  0266
         ST    @15,@AL00001+4                                      0266
         L     @15,GDTDEL(,@10)                                    0266
         LA    @01,@AL00001                                        0266
         BALR  @14,@15                                             0266
*            IF SCANONLY = NO                                      0267
*              THEN                                                0267
         L     @10,@PC00001+4                                      0267
         TM    SCANONLY(@10),B'00010000'                           0267
         BNZ   @RF00267                                            0267
*                GOODCMD=YES;                                      0268
         OI    GOODCMD(@10),B'10000000'                            0268
*              ELSE                                                0269
*                DO;                                               0269
         B     @RC00267                                            0269
@RF00267 DS    0H                                                  0270
*                DARGSMOD=RISTID;                                  0270
         L     @10,DDSTRU                                          0270
         MVC   DARGSMOD(3,@10),RISTID                              0270
*                DARGSENT=NOTEXEC;                                 0271
*                                                                  0271
         MVI   DARGSENT(@10),X'05'                                 0271
*                CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);             0272
*                                                                  0272
         L     @10,@PC00001                                        0272
         ST    @10,@AL00001                                        0272
         LA    @15,@CF00087                                        0272
         ST    @15,@AL00001+4                                      0272
         LA    @15,DDSTRU                                          0272
         ST    @15,@AL00001+8                                      0272
         MVI   @AL00001+8,X'80'                                    0272
         L     @15,GDTPRT(,@10)                                    0272
         LA    @01,@AL00001                                        0272
         BALR  @14,@15                                             0272
*                CALL ICKSAFP0(GDTTBL,POOLID);                     0273
*                                                                  0273
         L     @10,@PC00001                                        0273
         ST    @10,@AL00001                                        0273
         L     @15,@PC00001+4                                      0273
         LA    @15,POOLID(,@15)                                    0273
         ST    @15,@AL00001+4                                      0273
         MVI   @AL00001+4,X'80'                                    0273
         L     @15,GDTFPL(,@10)                                    0273
         LA    @01,@AL00001                                        0273
         BALR  @14,@15                                             0273
*                END;                                              0274
*            END DOGRP2;                                           0275
*                                                                  0275
@RC00267 DS    0H                                                  0276
*        CALL ICKSAEP0(GDTTBL,MODID);                              0276
@RC00199 L     @10,@PC00001                                        0276
         ST    @10,@AL00001                                        0276
         LA    @15,MODID                                           0276
         ST    @15,@AL00001+4                                      0276
         MVI   @AL00001+4,X'80'                                    0276
         L     @15,GDTEPL(,@10)                                    0276
         LA    @01,@AL00001                                        0276
         BALR  @14,@15                                             0276
*        END ICKRI03                                               0277
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF05 )                                        *
*;                                                                 0277
@EL00001 L     @13,4(,@13)                                         0277
@EF00001 L     @00,@SIZDATD                                        0277
         LR    @01,@11                                             0277
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0277
         BR    @14                                                 0277
@DATA    DS    0H
@CH00154 DC    H'8'
@CH00265 DC    H'16'
@CH00269 DC    H'18'
@CH00103 DC    H'100'
         DS    0F
@AL00198 DC    A(RIPOOLID)             LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(@CC00130)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@AL00001 DS    3A
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICKRI03  CSECT
         DS    0F
@CF00087 DC    F'0'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
LISTPTR  DS    A
SETRC    DS    H
TESTRC   DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
PRNTAREA DS    BL20
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKRI03  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00527 DC    C'RITM'
@CC00536 DC    C'RI99'
@CC00130 DC    C'ALL'
@CC00533 DC    C'UV0'
MODID    DC    CL4'RI03'
RIPOOLID DC    CL4'RI  '
LTBLNAME DC    CL8'ICKRILT '
KTBLNAME DC    CL8'ICKRIKT '
FIXAREA  DS    CL100
         ORG   FIXAREA
@NM00020 DC    100X'00'
         ORG   FIXAREA+100
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
RTNREG   EQU   @15
ICKSADE0 EQU   0
ICKSAEP0 EQU   0
ICKSAFS0 EQU   0
ICKSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
ICKTPPR0 EQU   0
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
HDAREA   EQU   0
MODLFLGS EQU   HDAREA+18
DMPTRM   EQU   0
ICKDVCL0 EQU   0
ICKDVIN0 EQU   0
ICKDVON0 EQU   0
ICKDVOP0 EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSACL0 EQU   0
ICKSAGP0 EQU   0
ICKSAGS0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTRIH   EQU   GDTTBL+24
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
COMMAREA EQU   0
RISTATUS EQU   COMMAREA+16
LASTCC   EQU   COMMAREA+22
MAXCC    EQU   COMMAREA+24
POOLID   EQU   COMMAREA+34
DESCNAME EQU   COMMAREA+46
GOODCMD  EQU   COMMAREA+54
EOFOK    EQU   COMMAREA+54
OPTSFLAG EQU   COMMAREA+54
SCANONLY EQU   COMMAREA+54
SKIPPAST EQU   COMMAREA+54
RISTID   EQU   MODID
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00018 EQU   COMMAREA+54
VERBNAME EQU   COMMAREA+38
FSRLNAME EQU   COMMAREA+26
SCNLIMIT EQU   COMMAREA+20
SCANINDX EQU   COMMAREA+18
WORKPTR  EQU   COMMAREA+12
DESCPTR  EQU   COMMAREA+8
FDTADDR  EQU   COMMAREA+4
RECRDPTR EQU   COMMAREA
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00019 EQU   MODLFLGS+1
SKIPFLAG EQU   MODLFLGS+1
ELSEFLAG EQU   MODLFLGS+1
THENFLAG EQU   MODLFLGS+1
DOFLAG   EQU   MODLFLGS+1
NULLDO   EQU   MODLFLGS
NESTLVL  EQU   HDAREA+16
ADDRIOCS EQU   HDAREA+12
KWTBLPTR EQU   HDAREA+8
LOADTPTR EQU   HDAREA+4
RIGHTMGN EQU   HDAREA+2
LEFTMGN  EQU   HDAREA
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00200 EQU   @RC00199
@ENDDATA EQU   *
         END   ICKRI03,(C'PLS1730',0701,78192)

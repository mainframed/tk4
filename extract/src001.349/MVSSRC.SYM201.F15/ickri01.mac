         TITLE '*********  ICKRI01:  READER/INTERPRETER MAIN MODULE   **
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKRI01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'ICKRI01   78.192'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         LA    @08,4095(,@09)                                      0002
         LA    @07,4095(,@08)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         USING @PSTART+16380,@08                                   0002
         USING @PSTART+20475,@07                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @06,@01                                             0002
         USING @DATD,@06                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @06,8(,@13)                                         0002
         LR    @13,@06                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(24),0(@01)                                 0002
*        GDTPTR=ADDR(GDTTBLX);                                     0310
*                                                                  0310
         L     @15,@PC00001                                        0310
         ST    @15,GDTPTR                                          0310
*        IF GDTDBG = NULLPTR                                       0311
*          THEN;                                                   0311
         L     @15,GDTDBG(,@15)                                    0311
         LTR   @15,@15                                             0311
         BZ    @RT00311                                            0311
*          ELSE                                                    0313
*            CALL ICKDB010(GDTTBL,'RIEX');                         0313
         L     @15,GDTPTR                                          0313
         ST    @15,@AL00001                                        0313
         LA    @14,@CC00787                                        0313
         ST    @14,@AL00001+4                                      0313
         MVI   @AL00001+4,X'80'                                    0313
         L     @15,GDTDBG(,@15)                                    0313
         LA    @01,@AL00001                                        0313
         BALR  @14,@15                                             0313
*        RISTATUS=0;                                               0314
@RT00311 SLR   @15,@15                                             0314
         STH   @15,RISTATUS                                        0314
*        VERBNAME=BLANK;                                           0315
         MVI   VERBNAME+1,C' '                                     0315
         MVC   VERBNAME+2(6),VERBNAME+1                            0315
         MVI   VERBNAME,C' '                                       0315
*        OPTSFLAG=OFF;                                             0316
         NI    OPTSFLAG,B'11011111'                                0316
*        UNITINDX=0;                                               0317
         STH   @15,UNITINDX                                        0317
*        CHAR1=BLANK;                                              0318
         MVI   CHAR1,C' '                                          0318
*        CONTNEXT=NO;                                              0319
         NI    CONTNEXT,B'11110111'                                0319
*        VLISTID1='RI';                                            0320
*                                                                  0320
         MVC   VLISTID1(2),@CC00788                                0320
*        DDSTRU=ADDR(PRNTAREA);                                    0321
         LA    @14,PRNTAREA                                        0321
         ST    @14,DDSTRU                                          0321
*        PRNTAREA=''B;                                             0322
*                                                                  0322
         XC    PRNTAREA(20),PRNTAREA                               0322
*        /************************************************************/
*        /*                                                          */
*        /* STORE INPUT PARAMETER DATA INTO R/I'S OWN DATA AREA      */
*        /*                                                          */
*        /************************************************************/
*        POOLID=SPACEID;                                           0323
         L     @14,@PC00001+8                                      0323
         MVC   POOLID(4),SPACEID(@14)                              0323
*        MAXCC=DMSMAX;                                             0324
         L     @14,@PC00001+12                                     0324
         MVC   MAXCC(2),DMSMAX(@14)                                0324
*        LASTCC=DMSLAST;                                           0325
*                                                                  0325
         L     @14,@PC00001+16                                     0325
         MVC   LASTCC(2),DMSLAST(@14)                              0325
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TO SEE IF R/I INITIALIZATION NEEDS TO BE DONE     */
*        /*  AND TERMINATE IF INITIALIZATION WAS NOT COMPLETED OKAY  */
*        /*                                                          */
*        /************************************************************/
*        IF GDTRIH = NULLPTR                                       0326
*          THEN                                                    0326
         L     @01,GDTPTR                                          0326
         C     @15,GDTRIH(,@01)                                    0326
         BNE   @RF00326                                            0326
*            DO;                                                   0327
*                                                                  0327
*            CALL RIINIT;                                          0328
*                                                                  0328
         BAL   @14,RIINIT                                          0328
*            IF RISTATUS^=0                                        0329
*              THEN                                                0329
*                                                                  0329
         LH    @15,RISTATUS                                        0329
         LTR   @15,@15                                             0329
         BZ    @RF00329                                            0329
*                CALL ICKRI03(GDTTBL,COMMAREA);                    0330
*                                                                  0330
         L     @01,GDTPTR                                          0330
         ST    @01,@AL00001                                        0330
         LA    @15,COMMAREA                                        0330
         ST    @15,@AL00001+4                                      0330
         L     @15,@CV00514                                        0330
         LA    @01,@AL00001                                        0330
         BALR  @14,@15                                             0330
*            END;                                                  0331
*                                                                  0331
@RF00329 DS    0H                                                  0332
*        /************************************************************/
*        /*                                                          */
*        /* SCAN AND INTERPRET INPUT FUNCTION AND MODAL COMMANDS     */
*        /* UNTIL A FUNCTION COMMAND TO BE EXECUTED IS FOUND.  THEN  */
*        /* ENCODE THIS COMMAND INTO THE FUNCTION DATA TABLE (FDT).  */
*        /*                                                          */
*        /************************************************************/
*        GOODCMD=NO;                                               0332
@RF00326 NI    GOODCMD,B'01111111'                                 0332
*        DO WHILE(RISTATUS=0 & GOODCMD=NO);                        0333
*                                                                  0333
         B     @DE00333                                            0333
@DL00333 DS    0H                                                  0334
*          CALL SCANCMD;                                           0334
*                                                                  0334
         BAL   @14,SCANCMD                                         0334
*          CALL ICKRI03(GDTTBL,COMMAREA);                          0335
*                                                                  0335
         L     @01,GDTPTR                                          0335
         ST    @01,@AL00001                                        0335
         LA    @15,COMMAREA                                        0335
         ST    @15,@AL00001+4                                      0335
         L     @15,@CV00514                                        0335
         LA    @01,@AL00001                                        0335
         BALR  @14,@15                                             0335
*        END;                                                      0336
*                                                                  0336
@DE00333 LH    @15,RISTATUS                                        0336
         LTR   @15,@15                                             0336
         BNZ   @DC00333                                            0336
         TM    GOODCMD,B'10000000'                                 0336
         BZ    @DL00333                                            0336
@DC00333 DS    0H                                                  0337
*        /************************************************************/
*        /*                                                          */
*        /* UPDATE PARAMETER DATA, PREPARING TO RETURN TO EXECUTIVE  */
*        /*                                                          */
*        /************************************************************/
*        FDTLOC=FDTADDR;                                           0337
         L     @15,@PC00001+4                                      0337
         MVC   FDTLOC(4,@15),FDTADDR                               0337
*        FUNCNAME=FSRLNAME;                                        0338
         L     @15,@PC00001+20                                     0338
         MVC   FUNCNAME(8,@15),FSRLNAME                            0338
*        DMSMAX=MAXCC;                                             0339
         L     @15,@PC00001+12                                     0339
         MVC   DMSMAX(2,@15),MAXCC                                 0339
*        DMSLAST=LASTCC;                                           0340
*                                                                  0340
         L     @15,@PC00001+16                                     0340
         MVC   DMSLAST(2,@15),LASTCC                               0340
*        CALL ICKSAEP0(GDTTBL,MODID,RISTATUS);                     0341
*                                                                  0341
         L     @15,GDTPTR                                          0341
         ST    @15,@AL00001                                        0341
         LA    @14,MODID                                           0341
         ST    @14,@AL00001+4                                      0341
         LA    @14,RISTATUS                                        0341
         ST    @14,@AL00001+8                                      0341
         MVI   @AL00001+8,X'80'                                    0341
         L     @15,GDTEPL(,@15)                                    0341
         LA    @01,@AL00001                                        0341
         BALR  @14,@15                                             0341
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - RIINIT                                         */
*/*                                                                  */
*/*  FUNCTION - THIS PROCEDURE OBTAINS AND INITIALIZES SPACE FOR THE */
*/*             READER/INTERPRETER HISTORICAL DATA AREA (R/I HDA),   */
*/*             OBTAINS SPACE FOR AND SETS UP REFERENCE TO THE UPRINT*/
*/*             ARGUMENT STRUCTURE, AND LOADS THE DESCRIPTOR LOAD    */
*/*             MODULE NAME TABLE.  FINALLY, IT SETS UP PARAMETER    */
*/*             OPTION INPUT IF IT EXISTS.                           */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          OPTSPTR - POINTER TO PARAMETER OPTIONS STRING           */
*/*          OPTSLEN - LENGTH OF PARAMETER OPTIONS STRING            */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FIRSTCHR- SIGNALS THAT THE LOCATION AND LENGTH OF THE   */
*/*                    INPUT CHARACTERS TO BE SCANNED ARE NOT TO BE  */
*/*                    FOUND IN THE R/I HDA.                         */
*/*          GDTRIH -  POINTER TO R/I HDA.                           */
*/*          LEFTMGN - LEFT COMMAND STREAM SOURCE MARGIN TO BE USED  */
*/*          RIGHTMGN- RIGHT COMMAND STREAM SOURCE MARGIN TO BE USED */
*/*          OPNIOC -  OPEN FLAGS AND POINTERS SET WHEN OPENING THE  */
*/*          OPNPTR    COMMAND INPUT STREAM FOR INPUT.               */
*/*          OPNAGL                                                  */
*/*          OPNTYPSI                                                */
*/*          OPTSFLAG- FLAG NOTING THAT PARAMETER OPTIONS ARE        */
*/*                    BEING SCANNED.                                */
*/*          RECRDPTR- POINTER TO CHARACTER STRING TO BE SCANNED     */
*/*          SCNLIMIT- POSITION OF LAST CHARACTER OF THE STRING TO   */
*/*                    BE SCANNED.                                   */
*/*          CHAR1 -   FIRST CHARACTER OF PARAMETER OPTIONS STRING   */
*/*          SCANINDX- POSITION WITHIN CHARACTER STRING BEING        */
*/*                    SCANNED AT WHICH TO BEGIN THE SCANNING.       */
*/*          VERBNAME- VERB NAME GENERATED WHEN PARAMETER OPTIONS    */
*/*                    ARE BEING SCANNED.                            */
*/*          LASTCC -  LAST DMS SYSTEM CONDITION CODE                */
*/*          RISTATUS- R/I INTERNAL STATUS CODE                      */
*/*          LOADTPTR- POINTER TO DESCRIPTOR LOAD MODULE NAME TABLE  */
*/*          KWTBLPTR- POINTER TO MODAL COMMAND KEYWORD AND VERB     */
*/*                    SYMBOL TABLE                                  */
*/*          FINALCHR- SIGNALS THAT EOF HAS NOT BEEN FOUND YET       */
*/*                                                                  */
*/********************************************************************/
*RIINIT: PROCEDURE;                                                0342
@EL00001 L     @13,4(,@13)                                         0342
@EF00001 L     @00,@SIZDATD                                        0342
         LR    @01,@06                                             0342
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0342
         BR    @14                                                 0342
RIINIT   STM   @14,@12,@SA00002                                    0342
*        /************************************************************/
*        /*                                                          */
*        /* READER/INTERPRETER INITIALIZATION DATA DEFINITIONS       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0343
*        DCL OPTSPTR PTR(31)           /*POINTER TO PARAMETER OPTIONS*/
*                    BASED(GDTPRM);                                0343
*                                                                  0343
*        /*PARAMETER OPTIONS CHARACTER STRING                        */
*        DCL 1 PARMOPTS CHAR(*) BASED(OPTSPTR) BDY(HWORD),         0344
*              2 OPTSLEN FIXED(15);    /*LENGTH OF OPTIONS STRING    */
*                                                                  0344
*        DCL LMGNDFLT FIXED(15)        /*LEFT COMMAND MARGIN DEFAULT */
*                     CONSTANT(2);                                 0345
*        DCL RMGNDFLT FIXED(15)        /*RIGHT COMMAND MARGIN DEFAULT*/
*                     CONSTANT(72);                                0346
*        DCL LTBLNAME CHAR(8)          /*LOAD NAME OF THE DESCRIPTOR */
*                     INIT('ICKRILT ');/* LOAD MODULE NAME TABLE     */
*        DCL KTBLNAME CHAR(8)          /*LOAD NAME OF TABLE OF       */
*                     INIT('ICKRIKT ');/* MODAL KEYWORDS             */
*        /************************************************************/
*        /*                                                          */
*        /*  ** RIINIT **  READER/INTERPRETER INITIALIZATION ROUTINE */
*        /*                                                          */
*        /************************************************************/
*                                                                  0349
*        /************************************************************/
*        /*                                                          */
*        /*  OBTAIN SPACE FOR THE R/I HISTORICAL DATA AREA AND FOR   */
*        /*  THE UPRINT ARGUMENT STRUCTURE , INITIALIZING THE SPACE  */
*        /*  TO ZEROES.                                              */
*        /*                                                          */
*        /************************************************************/
*        AMTTOGET=HDASIZE;                                         0349
*                                                                  0349
         MVC   AMTTOGET(4),@CF00685                                0349
*        CALL ICKSAGS0(GDTTBL,AMTTOGET,GDTRIH,SETZERO);            0350
         L     @15,GDTPTR                                          0350
         ST    @15,@AL00001                                        0350
         LA    @14,AMTTOGET                                        0350
         ST    @14,@AL00001+4                                      0350
         LA    @14,GDTRIH(,@15)                                    0350
         ST    @14,@AL00001+8                                      0350
         LA    @14,@CC00153                                        0350
         ST    @14,@AL00001+12                                     0350
         MVI   @AL00001+12,X'80'                                   0350
         L     @15,GDTGSP(,@15)                                    0350
         LA    @01,@AL00001                                        0350
         BALR  @14,@15                                             0350
*        RESPECIFY RTNREG RSTD;                                    0351
*        TESTRC = RTNREG;                                          0352
         STH   RTNREG,TESTRC                                       0352
*        RESPECIFY RTNREG UNRSTD;                                  0353
*                                                                  0353
*        IF TESTRC^=0                                              0354
*          THEN                                                    0354
         LH    @15,TESTRC                                          0354
         LTR   @15,@15                                             0354
         BZ    @RF00354                                            0354
*            DO;                                                   0355
*            LASTCC=TERMERR;                                       0356
         MVC   LASTCC(2),@CH00274                                  0356
*            RISTATUS=NOSPACE;                                     0357
         MVC   RISTATUS(2),@CH00278                                0357
*            END;                                                  0358
*                                                                  0358
*          /**********************************************************/
*          /*                                                        */
*          /* OBTAIN DESCRIPTOR LOAD MODULE NAME TABLE , OBTAIN THE  */
*          /* MODAL COMMAND KEYWORD TABLE (CONTAINS THE KEYWORDS TO  */
*          /* BE USED FOR MODAL COMMANDS - MAY BE IN ANY LANGUAGE),  */
*          /* INITIALIZE COMMAND SOURCE MARGINS, AND OPEN SYSIN FILE.*/
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    0359
*            DO;                                                   0359
*                                                                  0359
         B     @RC00354                                            0359
@RF00354 DS    0H                                                  0360
*              CALL ICKSALD0(GDTTBL,LTBLNAME,LOADTPTR);            0360
         L     @15,GDTPTR                                          0360
         ST    @15,@AL00001                                        0360
         LA    @14,LTBLNAME                                        0360
         ST    @14,@AL00001+4                                      0360
         L     @01,GDTRIH(,@15)                                    0360
         LA    @14,LOADTPTR(,@01)                                  0360
         ST    @14,@AL00001+8                                      0360
         L     @15,GDTLOD(,@15)                                    0360
         LA    @01,@AL00001                                        0360
         BALR  @14,@15                                             0360
*              CALL ICKSALD0(GDTTBL,KTBLNAME,KWTBLPTR);            0361
*                                                                  0361
         L     @15,GDTPTR                                          0361
         ST    @15,@AL00001                                        0361
         LA    @14,KTBLNAME                                        0361
         ST    @14,@AL00001+4                                      0361
         L     @01,GDTRIH(,@15)                                    0361
         LA    @14,KWTBLPTR(,@01)                                  0361
         ST    @14,@AL00001+8                                      0361
         L     @15,GDTLOD(,@15)                                    0361
         LA    @01,@AL00001                                        0361
         BALR  @14,@15                                             0361
*              LEFTMGN=LMGNDFLT;                                   0362
         L     @15,GDTPTR                                          0362
         L     @14,GDTRIH(,@15)                                    0362
         MVC   LEFTMGN(2,@14),@CH00124                             0362
*              RIGHTMGN=RMGNDFLT;                                  0363
*                                                                  0363
         MVC   RIGHTMGN(2,@14),@CH00800                            0363
*              OPNPTR=ADDR(OPENAREA);                              0364
         LA    @05,OPENAREA                                        0364
         ST    @05,OPNPTR                                          0364
*              OPNAGL=''B;                                         0365
         XC    OPNAGL(32,@05),OPNAGL(@05)                          0365
*              OPNTYPSI=ON;                                        0366
         OI    OPNTYPSI(@05),B'10000000'                           0366
*              OPNIOC=ADDR(ADDRIOCS);                              0367
*                                                                  0367
         LA    @04,ADDRIOCS(,@14)                                  0367
         ST    @04,OPNIOC(,@05)                                    0367
*              CALL ICKIOOP0(GDTTBL,OPNAGL);                       0368
         ST    @15,@AL00001                                        0368
         ST    @05,@AL00001+4                                      0368
         MVI   @AL00001+4,X'80'                                    0368
         L     @15,GDTOPN(,@15)                                    0368
         LA    @01,@AL00001                                        0368
         BALR  @14,@15                                             0368
*              RESPECIFY RTNREG RSTD;                              0369
*              TESTRC = RTNREG;                                    0370
         STH   RTNREG,TESTRC                                       0370
*              RESPECIFY RTNREG UNRSTD;                            0371
*                                                                  0371
*              IF TESTRC ^= 0                                      0372
*                THEN                                              0372
         LH    @15,TESTRC                                          0372
         LTR   @15,@15                                             0372
         BZ    @RF00372                                            0372
*                  DO;                                             0373
*                  LASTCC=TERMERR;                                 0374
         MVC   LASTCC(2),@CH00274                                  0374
*                  RISTATUS=SKIPREST;                              0375
         MVC   RISTATUS(2),@CH00042                                0375
*                  END;                                            0376
*                ELSE                                              0377
*                                                                  0377
*                  /**************************************************/
*                  /*                                                */
*                  /*  IF A PARAMETER OPTIONS STRING EXISTS THEN SET */
*                  /*  IT UP AS IF IT WERE THE PARAMETER SET OF A    */
*                  /*  'PARM' COMMAND. ALSO PRINT THE OPTIONS.       */
*                  /*                                                */
*                  /**************************************************/
*                  IF GDTPRM^=0 & OPTSPTR^=0 & OPTSLEN^=0          0377
*                    THEN                                          0377
         B     @RC00372                                            0377
@RF00372 SLR   @15,@15                                             0377
         L     @14,GDTPTR                                          0377
         L     @05,GDTPRM(,@14)                                    0377
         CR    @05,@15                                             0377
         BE    @RF00377                                            0377
         L     @05,OPTSPTR(,@05)                                   0377
         CR    @05,@15                                             0377
         BE    @RF00377                                            0377
         LH    @04,OPTSLEN(,@05)                                   0377
         CR    @04,@15                                             0377
         BE    @RF00377                                            0377
*                      DO;                                         0378
*                      OPTSFLAG=ON;                                0379
         OI    OPTSFLAG,B'00100000'                                0379
*                      MORTOCOM=NO;                                0380
*                      FIRSTCHR=NO;                                0381
         NI    MORTOCOM,B'11101011'                                0381
*                      RECRDPTR=OPTSPTR+2;                         0382
         AH    @05,@CH00124                                        0382
         ST    @05,RECRDPTR                                        0382
*                      SCNLIMIT=OPTSLEN+1;                         0383
         LA    @15,1                                               0383
         LR    @03,@04                                             0383
         ALR   @03,@15                                             0383
         STH   @03,SCNLIMIT                                        0383
*                      CHAR1=INREC(1);                             0384
         MVC   CHAR1(1),INREC(@05)                                 0384
*                      CHAR2=INREC(2);                             0385
         MVC   CHAR2(1),INREC+1(@05)                               0385
*                      SCANINDX=1;                                 0386
         STH   @15,SCANINDX                                        0386
*                      VERBNAME=PARMSYM;                           0387
*                                                                  0387
         L     @01,GDTRIH(,@14)                                    0387
         L     @01,KWTBLPTR(,@01)                                  0387
         MVC   VERBNAME(8),PARMSYM(@01)                            0387
*                      DARGDBP=RECRDPTR;                           0388
         L     @15,DDSTRU                                          0388
         ST    @05,DARGDBP(,@15)                                   0388
*                      DARGILP=OPTSLEN;                            0389
         STH   @04,DARGILP(,@15)                                   0389
*                      DARGSMOD=RISTID;                            0390
         MVC   DARGSMOD(3,@15),RISTID                              0390
*                      DARGSENT=INRECID;                           0391
*                                                                  0391
         MVI   DARGSENT(@15),X'27'                                 0391
*                      CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);       0392
*                                                                  0392
         ST    @14,@AL00001                                        0392
         LA    @15,@CF00102                                        0392
         ST    @15,@AL00001+4                                      0392
         LA    @15,DDSTRU                                          0392
         ST    @15,@AL00001+8                                      0392
         MVI   @AL00001+8,X'80'                                    0392
         L     @15,GDTPRT(,@14)                                    0392
         LA    @01,@AL00001                                        0392
         BALR  @14,@15                                             0392
*                      END;                                        0393
*                                                                  0393
*            END;                                                  0394
*                                                                  0394
*        END RIINIT;                                               0395
@EL00002 DS    0H                                                  0395
@EF00002 DS    0H                                                  0395
@ER00002 LM    @14,@12,@SA00002                                    0395
         BR    @14                                                 0395
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SCANCMD                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS THE INPUT COMMAND, USING THE      */
*/*             COMMAND DESCRIPTOR AS A BASIS FOR SCANNING.  KEYWORDS*/
*/*             ARE INTERPRETED AND SCALAR DATA IS EXTRACTED AND     */
*/*             USED TO BUILD A FUNCTION DATA TABLE.  SYNTAX AND     */
*/*             SEMANTIC CHECKING AND FDT BUILDING ARE DONE BASED    */
*/*             UPON COMMAND DESCRIPTOR INFORMATION.                 */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          OPTSFLAG- FLAG INDICATING WHETHER OR NOT A PARAMETER    */
*/*                    OPTIONS STRING IS BEING CURRENTLY SCANNED     */
*/*          RISTATUS- INTERNAL R/I STATUS CODE INDICATING WHETHER   */
*/*                    OR NOT AN ERROR HAS OCCURRED.                 */
*/*          CHAR1 -   MOST RECENT INPUT CHARACTER EXTRACTED         */
*/*          COMMAND DESCRIPTOR - DATA STRUCTURE CONTAINING DATA     */
*/*                               THAT DESCRIBES THE CURRENT COMMAND */
*/*                               BEING SCANNED.                     */
*/*          SUPERID - PUSHDOWN STACK OF PARAMETER ID#S OF           */
*/*                    SUPERPARAMETERS OF SUBPARAMETER LISTS         */
*/*                    CURRENTLY BEING SCANNED.                      */
*/*          REPDEPTH- LEVEL OF "REPEATEDNESS" NESTING OF PARAMETER  */
*/*                    LIST CURRENTLY BEING SCANNED.                 */
*/*          PARMLVL - LEVEL OF SUBPARAMETER NESTING OF PARAMETER    */
*/*                    LIST CURRENTLY BEING SCANNED.                 */
*/*          SCANONLY- FLAG INDICATING WHETHER OR NOT THE CURRENT    */
*/*                    COMMAND IS TO HAVE AN FDT BUILT OR IF IT IS   */
*/*                    JUST BEING SCANNED FOR SYNTAX ERRORS.         */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*          SUBSYET - INDICATES WHETHER OR NOT ANY SUBPARAMETERS    */
*/*                    HAVE BEEN FOUND YET IN CURRENT SUBPARM. LIST  */
*/*          PPARMCNT- ARRAY OF COUNTS OF POSITIONAL SUBPARAMETERS   */
*/*                    FOUND SO FAR IN CURRENT SUBPARM. LISTS        */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE                                     */
*/*          FINALCHR- FLAG INDICATING THAT THE LAST INPUT CHAR.     */
*/*                    HAS JUST BEEN EXTRACTED.                      */
*/*          INQUOTED- FLAG INDICATING THAT THE R/I IS CURRENTLY     */
*/*                    SCANNING WITHIN A QUOTED STRING.              */
*/*          PARMLVL - (SEE 'INPUT')                                 */
*/*          PPARMCNT- PUSHDOWN STACK OF COUNTS, EACH INDICATING     */
*/*                    HOW MANY POSITIONAL PARAMETERS HAVE BEEN      */
*/*                    FOUND AT A LEVEL OF PARAMETER LIST NESTING.   */
*/*          SUPERID - (SEE 'INPUT')                                 */
*/*          REPDEPTH- (SEE 'INPUT')                                 */
*/*          SKIPPAST- INDICATES THAT INITIALLY NO COMMAND HAS JUST  */
*/*                    BEEN BYPASSED DUE TO AN ERROR IN IT.          */
*/*          EOFOK -   FLAG INDICATING WHETHER OR NOT THE SCAN IS    */
*/*                    CURRENTLY AT A POINT WHERE THE OCCURRENCE OF  */
*/*                    INPUT END-OF-FILE WOULD NOT BE AN ERROR.      */
*/*          BLKLEFT - NUMBER OF BYTES OF SPACE REMAINING TO BE      */
*/*                    ALLOCATED FOR FDT SCALAR DATA STRUCTURES.     */
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING EXAMINED     */
*/*          FDTPTR -  PRIMARY FDT VECTOR OF POINTERS.               */
*/*          ARRYPTR - POINTER TO AN INTERMEDIATE FDT POINTER VECTOR */
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */
*/*          SUBSYET - SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*SCANCMD:PROCEDURE;                                                0396
SCANCMD  STM   @14,@12,@SA00003                                    0396
*        /************************************************************/
*        /*                                                          */
*        /* SCANCMD PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*        DCL STMTEND  BIT(1);          /*SIGNALS THAT THE END OF THE
*                                        COMMAND HAS BEEN FOUND      */
*        DCL PRMFOUND BIT(1);          /*SIGNALS THAT NEXT PARAMETER
*                                        IS TO BE EXTRACTED          */
*        DCL WORKPTR2 PTR(31);         /*VARIABLE TO CONTAIN       0399
*                                        A TEMPORARY POINTER VALUE   */
*        DCL WORKPTR3 PTR(31);         /*VARIABLE TO CONTAIN       0400
*                                        A TEMPORARY POINTER VALUE   */
*        DCL SETUPERR FIXED(31);       /*ERROR CODE FOR ERROR FOUND
*                                        DURING DESCRIPTOR SET-UP    */
*                                                                  0401
*        /*STATIC ERROR MESSAGE CODES                                */
*        DCL BADPOS   FIXED(31)        /*TOO MANY POSITIONAL PARM'S  */
*                     CONSTANT(1);                                 0402
*        DCL TOOMANY  FIXED(31)        /*TOO MANY RIGHT PARENTHESES  */
*                     CONSTANT(34);    /* AT COMMAND TERMINATION     */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SCANCMD **  SCAN INPUT COMMAND & BUILD FDT           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0404
*        IF GDTDBG = NULLPTR                                       0404
*          THEN;                                                   0404
         L     @01,GDTPTR                                          0404
         L     @15,GDTDBG(,@01)                                    0404
         LTR   @15,@15                                             0404
         BZ    @RT00404                                            0404
*          ELSE                                                    0406
*            CALL ICKDB010(GDTTBL,'RISC');                         0406
*                                                                  0406
         L     @15,GDTPTR                                          0406
         ST    @15,@AL00001                                        0406
         LA    @14,@CC00815                                        0406
         ST    @14,@AL00001+4                                      0406
         MVI   @AL00001+4,X'80'                                    0406
         L     @15,GDTDBG(,@15)                                    0406
         LA    @01,@AL00001                                        0406
         BALR  @14,@15                                             0406
*        STMTEND=NO;                                               0407
@RT00404 NI    STMTEND,B'01111111'                                 0407
*        FINALCHR=NO;                                              0408
         NI    FINALCHR,B'11111101'                                0408
*        PARMLVL=1;                                                0409
         LA    @15,1                                               0409
         STH   @15,PARMLVL                                         0409
*        PPARMCNT(1)=1;                                            0410
         STH   @15,PPARMCNT                                        0410
*        SUPERID(1)=0;                                             0411
         SLR   @15,@15                                             0411
         STH   @15,SUPERID                                         0411
*        REPDEPTH=0;                                               0412
         STH   @15,REPDEPTH                                        0412
*        SKIPPAST=NO;                                              0413
*        EOFOK=YES;                                                0414
         OI    EOFOK,B'01000000'                                   0414
         NI    SKIPPAST,B'11110111'                                0414
*        BLKLEFT=0;                                                0415
         ST    @15,BLKLEFT                                         0415
*        SCANONLY=NO;                                              0416
*                                                                  0416
         NI    SCANONLY,B'11101111'                                0416
*        /************************************************************/
*        /*                                                          */
*        /* EXTRACT THE COMMAND VERB (UNLESS NOW SCANNING PARAMETER  */
*        /* OPTIONS) AND CALL 'ICKRI02' TO SET UP THE APPROPRIATE    */
*        /* COMMAND DESCRIPTOR AND TO PREPARE FOR COMMAND SCANNING.  */
*        /* IF AN ERROR IS ENCOUNTERED DOING THIS, BYPASS THE        */
*        /* COMMAND.                                                 */
*        /*                                                          */
*        /************************************************************/
*        IF OPTSFLAG=OFF                                           0417
*          THEN                                                    0417
*                                                                  0417
         TM    OPTSFLAG,B'00100000'                                0417
         BNZ   @RF00417                                            0417
*            CALL GETNEXT;                                         0418
*                                                                  0418
         BAL   @14,GETNEXT                                         0418
*          ELSE                                                    0419
*                                                                  0419
*            CALL SCANSEP(NO);                                     0419
*                                                                  0419
         B     @RC00417                                            0419
@RF00417 LA    @01,@AL00419                                        0419
         BAL   @14,SCANSEP                                         0419
*        IF RISTATUS=0                                             0420
*          THEN                                                    0420
@RC00417 LH    @15,RISTATUS                                        0420
         LTR   @15,@15                                             0420
         BNZ   @RF00420                                            0420
*            DO;                                                   0421
*                                                                  0421
*            CALL ICKRI02(GDTTBL,COMMAREA);                        0422
*                                                                  0422
         L     @01,GDTPTR                                          0422
         ST    @01,@AL00001                                        0422
         LA    @15,COMMAREA                                        0422
         ST    @15,@AL00001+4                                      0422
         L     @15,@CV00513                                        0422
         LA    @01,@AL00001                                        0422
         BALR  @14,@15                                             0422
*            IF RISTATUS^=0                                        0423
*              THEN                                                0423
         LH    @15,RISTATUS                                        0423
         LTR   @15,@15                                             0423
         BZ    @RF00423                                            0423
*                DO;                                               0424
*                SETUPERR=RISTATUS;                                0425
         ST    @15,SETUPERR                                        0425
*                IF SETUPERR=NOSPACE                               0426
*                  THEN                                            0426
*                                                                  0426
         CH    @15,@CH00278                                        0426
         BNE   @RF00426                                            0426
*                    CALL ERROR1(SETUPERR);                        0427
*                                                                  0427
         LA    @15,SETUPERR                                        0427
         ST    @15,@AL00001                                        0427
         LA    @01,@AL00001                                        0427
         BAL   @14,ERROR1                                          0427
*                  ELSE                                            0428
*                                                                  0428
*                    CALL ERROR2(SETUPERR,LENGTH(ERRFIELD),        0428
*                                ADDR(ERRFIELD));                  0428
*                                                                  0428
         B     @RC00426                                            0428
@RF00426 LA    @15,SETUPERR                                        0428
         ST    @15,@AL00001                                        0428
         LA    @15,@CF00282                                        0428
         ST    @15,@AL00001+4                                      0428
         LA    @15,ERRFIELD                                        0428
         ST    @15,@AFTEMPS+12                                     0428
         LA    @15,@AFTEMPS+12                                     0428
         ST    @15,@AL00001+8                                      0428
         LA    @01,@AL00001                                        0428
         BAL   @14,ERROR2                                          0428
*                END;                                              0429
@RC00426 DS    0H                                                  0430
*            END;                                                  0430
*                                                                  0430
@RF00423 DS    0H                                                  0431
*        /************************************************************/
*        /*                                                          */
*        /* SCAN THE PARAMETER SET, EXTRACTING ONE PARAMETER AT A    */
*        /* TIME UNTIL THE STATEMENT END IS FOUND OR AN ERROR OCCURS.*/
*        /*                                                          */
*        /************************************************************/
*DOLOOP5:DO WHILE(STMTEND=NO & RISTATUS=0);                        0431
@RF00420 DS    0H                                                  0431
DOLOOP5  B     @DE00431                                            0431
@DL00431 DS    0H                                                  0432
*          OLDERID2 = NEWERID2;                                    0432
         L     @01,GDTPTR                                          0432
         L     @15,GDTTR2(,@01)                                    0432
         MVC   @TS00001(95),NEWERID2(@15)                          0432
         MVC   OLDERID2(95,@15),@TS00001                           0432
*          NEWID2='RI01';                                          0433
         MVC   NEWID2(4,@15),@CC00706                              0433
*          IF CHAR1=ENDDELIM                                       0434
*            THEN                                                  0434
         CLI   CHAR1,C';'                                          0434
         BNE   @RF00434                                            0434
*DOGRP5:       DO;                                                 0435
DOGRP5   DS    0H                                                  0436
*                STMTEND=YES;                                      0436
*                                                                  0436
         OI    STMTEND,B'10000000'                                 0436
*                /****************************************************/
*                /*                                                  */
*                /* APPLY DEFAULTS AND PERFORM SEMANTIC CHECKING AT  */
*                /* COMMAND TERMINATION.  ISSUE A WARNING IF TOO FEW */
*                /* PARENTHESES APPEAR AT COMMAND END.               */
*                /*                                                  */
*                /****************************************************/
*                IF PARMLVL > 1                                    0437
*                  THEN                                            0437
         LH    @15,PARMLVL                                         0437
         CH    @15,@CH00172                                        0437
         BNH   @RF00437                                            0437
*                    DO;                                           0438
*                    DARGSMOD=RISTID;                              0439
         L     @15,DDSTRU                                          0439
         MVC   DARGSMOD(3,@15),RISTID                              0439
*                    DARGSENT=TOOFEW;                              0440
*                                                                  0440
         MVI   DARGSENT(@15),X'23'                                 0440
*                    CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);         0441
*                                                                  0441
         L     @15,GDTPTR                                          0441
         ST    @15,@AL00001                                        0441
         LA    @14,@CF00102                                        0441
         ST    @14,@AL00001+4                                      0441
         LA    @14,DDSTRU                                          0441
         ST    @14,@AL00001+8                                      0441
         MVI   @AL00001+8,X'80'                                    0441
         L     @15,GDTPRT(,@15)                                    0441
         LA    @01,@AL00001                                        0441
         BALR  @14,@15                                             0441
*                    END;                                          0442
*                                                                  0442
*                DO WHILE(PARMLVL>0);                              0443
@RF00437 B     @DE00443                                            0443
@DL00443 DS    0H                                                  0444
*                  PARMID=SUPERID(PARMLVL);                        0444
         LH    @15,PARMLVL                                         0444
         ALR   @15,@15                                             0444
         LH    @15,SUPERID-2(@15)                                  0444
         STH   @15,PARMID                                          0444
*                  IF PARMID=0                                     0445
*                    THEN                                          0445
         LTR   @15,@15                                             0445
         BNZ   @RF00445                                            0445
*                      DO;                                         0446
*                                                                  0446
*                      CALL DEFAULTS;                              0447
         BAL   @14,DEFAULTS                                        0447
*                      CALL NEEDNOTS;                              0448
*                                                                  0448
         BAL   @14,NEEDNOTS                                        0448
*                      END;                                        0449
*                    ELSE                                          0450
*                      IF REPEATED=YES                             0450
*                        THEN                                      0450
         B     @RC00445                                            0450
@RF00445 LH    @15,PARMID                                          0450
         MH    @15,@CH00038                                        0450
         L     @01,WORKPTR                                         0450
         AL    @01,@CF01317                                        0450
         L     @01,PARMPTR(@15,@01)                                0450
         TM    REPEATED(@01),B'00100000'                           0450
         BNO   @RF00450                                            0450
*                          DO;                                     0451
*                                                                  0451
*                          CALL DEFAULTS;                          0452
         BAL   @14,DEFAULTS                                        0452
*                          CALL NEEDNOTS;                          0453
*                                                                  0453
         BAL   @14,NEEDNOTS                                        0453
*                          REPDEPTH=REPDEPTH-1;                    0454
         LH    @15,REPDEPTH                                        0454
         BCTR  @15,0                                               0454
         STH   @15,REPDEPTH                                        0454
*                          END;                                    0455
*                  PARMLVL=PARMLVL-1;                              0456
@RF00450 DS    0H                                                  0456
@RC00445 LH    @15,PARMLVL                                         0456
         BCTR  @15,0                                               0456
         STH   @15,PARMLVL                                         0456
*                END;                                              0457
*                                                                  0457
@DE00443 SLR   @15,@15                                             0457
         CH    @15,PARMLVL                                         0457
         BL    @DL00443                                            0457
*                /****************************************************/
*                /*                                                  */
*                /* IF FDT BUILDING HAS COMPLETED OKAY, THEN CHECK   */
*                /* FOR PARAMETERS WITHIN THE FIRST LEVEL OF REPEATED*/
*                /* SUBLIST NESTING.  THE POINTERS WHICH POINT TO THE*/
*                /* SCALAR DATA OF THESE PARAMETERS ARE CURRENTLY IN */
*                /* THE FORM OF LISTS OF POINTER VECTOR BLOCKS.      */
*                /* REASSEMBLE EACH LIST INTO A SINGLE VECTOR OF PTRS*/
*                /*                                                  */
*                /****************************************************/
*                IF RISTATUS=0 & SCANONLY=NO                       0458
*                  THEN                                            0458
         CH    @15,RISTATUS                                        0458
         BNE   @RF00458                                            0458
         TM    SCANONLY,B'00010000'                                0458
         BNZ   @RF00458                                            0458
*DOLOOP7:            DO PARMID=1 TO MAXID WHILE(RISTATUS=0);       0459
DOLOOP7  LA    @15,1                                               0459
         B     @DE00459                                            0459
@DL00459 SLR   @14,@14                                             0459
         CH    @14,RISTATUS                                        0459
         BNE   @DC00459                                            0459
*                      IF PARMPTR(PARMID)^=NULLPTR & OCCURNUM > 1  0460
*                        THEN                                      0460
*                                                                  0460
         MH    @15,@CH00038                                        0460
         L     @01,WORKPTR                                         0460
         AL    @01,@CF01317                                        0460
         L     @15,PARMPTR(@15,@01)                                0460
         CR    @15,@14                                             0460
         BE    @RF00460                                            0460
         CLC   OCCURNUM(3,@15),@CF00172+1                          0460
         BNH   @RF00460                                            0460
*                          /******************************************/
*                          /*                                        */
*                          /* CHECK ALL PARAMETERS WITHIN REPEATED   */
*                          /* SUBLISTS TO SEE IF THEY ARE AT THE 1ST */
*                          /* LEVEL OF REPEAT NESTING.               */
*                          /*                                        */
*                          /******************************************/
*DOGRP6:                   DO;                                     0461
DOGRP6   DS    0H                                                  0462
*                          REPNEST=0;                              0462
         SLR   @15,@15                                             0462
         STH   @15,REPNEST                                         0462
*                          VLISTID=PARMID;                         0463
         LH    @15,PARMID                                          0463
         STH   @15,VLISTID                                         0463
*                          PARMID=SUPRPARM(PARMID);                0464
         MH    @15,@CH00038                                        0464
         L     @01,WORKPTR                                         0464
         AL    @01,@CF01318                                        0464
         LH    @15,SUPRPARM-8(@15,@01)                             0464
         STH   @15,PARMID                                          0464
*                          DO WHILE(PARMID^=0);                    0465
         B     @DE00465                                            0465
@DL00465 DS    0H                                                  0466
*                            IF REPEATED=YES                       0466
*                              THEN                                0466
         LH    @15,PARMID                                          0466
         MH    @15,@CH00038                                        0466
         L     @01,WORKPTR                                         0466
         AL    @01,@CF01317                                        0466
         L     @01,PARMPTR(@15,@01)                                0466
         TM    REPEATED(@01),B'00100000'                           0466
         BNO   @RF00466                                            0466
*                                REPNEST=REPNEST+1;                0467
         LH    @01,REPNEST                                         0467
         LA    @01,1(,@01)                                         0467
         STH   @01,REPNEST                                         0467
*                            PARMID=SUPRPARM(PARMID);              0468
@RF00466 LH    @15,PARMID                                          0468
         MH    @15,@CH00038                                        0468
         L     @01,WORKPTR                                         0468
         AL    @01,@CF01318                                        0468
         LH    @15,SUPRPARM-8(@15,@01)                             0468
         STH   @15,PARMID                                          0468
*                          END;                                    0469
@DE00465 LH    @15,PARMID                                          0469
         LTR   @15,@15                                             0469
         BNZ   @DL00465                                            0469
*                          PARMID=VLISTID;                         0470
         MVC   PARMID(2),VLISTID                                   0470
*                          IF REPNEST=1                            0471
*                            THEN                                  0471
*                                                                  0471
         CLC   REPNEST(2),@CH00172                                 0471
         BNE   @RF00471                                            0471
*                              /**************************************/
*                              /*                                    */
*                              /* FOR PARAMETERS HAVING THE LISTS OF */
*                              /* POINTER BLOCKS, ALLOCATE ENOUGH    */
*                              /* SPACE FOR A SINGLE PTR BLOCK AND   */
*                              /* MOVE THE POINTERS FROM THE LIST    */
*                              /* INTO THE SINGLE VECTOR OF POINTERS.*/
*                              /* THEN FREE UP THE 'LIST' SPACE.     */
*                              /*                                    */
*                              /**************************************/
*DOGRP7:                       DO;                                 0472
DOGRP7   DS    0H                                                  0473
*                              VECTRNUM=1;                         0473
         MVC   VECTRNUM(2),@CH00172                                0473
*                              ARRYPTR=FDTPTR(PARMID);             0474
         LH    @15,PARMID                                          0474
         SLA   @15,2                                               0474
         L     @01,FDTADDR                                         0474
         L     @15,FDTPTR-4(@15,@01)                               0474
         ST    @15,ARRYPTR                                         0474
*                              DO WHILE(VECTRPTR^=0);              0475
         B     @DE00475                                            0475
@DL00475 DS    0H                                                  0476
*                                VECTRNUM=VECTRNUM+1;              0476
         LH    @01,VECTRNUM                                        0476
         LA    @01,1(,@01)                                         0476
         STH   @01,VECTRNUM                                        0476
*                                ARRYPTR=VECTRPTR;                 0477
         LH    @15,VECTRLEN                                        0477
         AL    @15,ARRYPTR                                         0477
         L     @15,VECTRPTR(,@15)                                  0477
         ST    @15,ARRYPTR                                         0477
*                              END;                                0478
@DE00475 LH    @15,VECTRLEN                                        0478
         L     @14,ARRYPTR                                         0478
         ALR   @14,@15                                             0478
         L     @14,VECTRPTR(,@14)                                  0478
         LTR   @14,@14                                             0478
         BNZ   @DL00475                                            0478
*                              AMTTOGET=VECTRNUM*VECTRLEN;         0479
         MH    @15,VECTRNUM                                        0479
         ST    @15,AMTTOGET                                        0479
*                              WORKPTR2=FDTPTR(PARMID);            0480
*                                                                  0480
         L     @15,FDTADDR                                         0480
         LH    @14,PARMID                                          0480
         SLA   @14,2                                               0480
         L     @05,FDTPTR-4(@14,@15)                               0480
         ST    @05,WORKPTR2                                        0480
*                              CALL ICKSAGP0(GDTTBL,AMTTOGET,FDTPTR(PAR
*ID),                                                              0481
*                                     POOLID,SETZERO);             0481
         L     @05,GDTPTR                                          0481
         ST    @05,@AL00001                                        0481
         LA    @04,AMTTOGET                                        0481
         ST    @04,@AL00001+4                                      0481
         LA    @04,FDTPTR-4(@14,@15)                               0481
         ST    @04,@AL00001+8                                      0481
         LA    @04,POOLID                                          0481
         ST    @04,@AL00001+12                                     0481
         LA    @04,@CC00153                                        0481
         ST    @04,@AL00001+16                                     0481
         MVI   @AL00001+16,X'80'                                   0481
         L     @15,GDTGPL(,@05)                                    0481
         LA    @01,@AL00001                                        0481
         BALR  @14,@15                                             0481
*                              RESPECIFY RTNREG RSTD;              0482
*                              TESTRC = RTNREG;                    0483
         STH   RTNREG,TESTRC                                       0483
*                              RESPECIFY RTNREG UNRSTD;            0484
*                                                                  0484
*                              WORKPTR3=FDTPTR(PARMID);            0485
         LH    @15,PARMID                                          0485
         SLA   @15,2                                               0485
         L     @01,FDTADDR                                         0485
         L     @15,FDTPTR-4(@15,@01)                               0485
         ST    @15,WORKPTR3                                        0485
*                              IF TESTRC=0                         0486
*                                THEN                              0486
         LH    @15,TESTRC                                          0486
         LTR   @15,@15                                             0486
         BNZ   @RF00486                                            0486
*                                  DO INDEX=1 TO VECTRNUM;         0487
         LA    @15,1                                               0487
         B     @DE00487                                            0487
@DL00487 DS    0H                                                  0488
*                                    WORKPTR3->DATABLK(1:VECTRLEN)=
*                                      WORKPTR2->DATABLK(1:VECTRLEN);
         L     @14,WORKPTR3                                        0488
         LH    @05,VECTRLEN                                        0488
         LR    @04,@05                                             0488
         BCTR  @04,0                                               0488
         L     @03,WORKPTR2                                        0488
         EX    @04,@SM01319                                        0488
*                                    WORKPTR3=WORKPTR3+VECTRLEN;   0489
         ALR   @14,@05                                             0489
         ST    @14,WORKPTR3                                        0489
*                                    WORKPTR2=                     0490
*                                      (WORKPTR2+VECTRLEN)->VECTRPTR;
         ALR   @03,@05                                             0490
         L     @14,VECTRPTR(,@03)                                  0490
         ST    @14,WORKPTR2                                        0490
*                                  END;                            0491
         AL    @15,@CF00172                                        0491
@DE00487 STH   @15,INDEX                                           0491
         CH    @15,VECTRNUM                                        0491
         BNH   @DL00487                                            0491
*                                ELSE                              0492
*                                                                  0492
*                                  CALL ERROR1(NOSPACE);           0492
*                                                                  0492
         B     @RC00486                                            0492
@RF00486 LA    @01,@AL00492                                        0492
         BAL   @14,ERROR1                                          0492
*                              CALL ICKSAFP0(GDTTBL,RIPOOLID);     0493
*                                                                  0493
@RC00486 L     @15,GDTPTR                                          0493
         ST    @15,@AL00001                                        0493
         LA    @14,RIPOOLID                                        0493
         ST    @14,@AL00001+4                                      0493
         MVI   @AL00001+4,X'80'                                    0493
         L     @15,GDTFPL(,@15)                                    0493
         LA    @01,@AL00001                                        0493
         BALR  @14,@15                                             0493
*                              END DOGRP7;                         0494
*                          END DOGRP6;                             0495
@RF00471 DS    0H                                                  0496
*                    END DOLOOP7;                                  0496
*                                                                  0496
@RF00460 LA    @15,1                                               0496
         AH    @15,PARMID                                          0496
@DE00459 STH   @15,PARMID                                          0496
         L     @14,DESCPTR                                         0496
         CH    @15,MAXID(,@14)                                     0496
         BNH   @DL00459                                            0496
@DC00459 DS    0H                                                  0497
*                /****************************************************/
*                /*                                                  */
*                /* IN PREPARATION FOR PICKING UP THE NEXT COMMAND,  */
*                /* BYPASS ALL CHARACTERS ASSOCIATED WITH THE CURRENT*/
*                /* COMMAND.                                         */
*                /*                                                  */
*                /****************************************************/
*                DO WHILE(MORTOCOM=YES & RISTATUS=0);              0497
*                                                                  0497
@RF00458 B     @DE00497                                            0497
@DL00497 DS    0H                                                  0498
*                  CALL NEXTCHAR;                                  0498
         BAL   @14,NEXTCHAR                                        0498
*                  CALL SKIPCMD;                                   0499
*                                                                  0499
         BAL   @14,SKIPCMD                                         0499
*                END;                                              0500
@DE00497 TM    MORTOCOM,B'00010000'                                0500
         BNO   @DC00497                                            0500
         LH    @15,RISTATUS                                        0500
         LTR   @15,@15                                             0500
         BZ    @DL00497                                            0500
@DC00497 DS    0H                                                  0501
*              END DOGRP5;                                         0501
*                                                                  0501
*            /********************************************************/
*            /*                                                      */
*            /* THE END OF THE CURRENT COMMAND HAS NOT BEEN REACHED  */
*            /*                                                      */
*            /********************************************************/
*            ELSE                                                  0502
*              IF SUPERID(PARMLVL)=0                               0502
*                  THEN                                            0502
*                                                                  0502
         B     @RC00434                                            0502
@RF00434 LH    @15,PARMLVL                                         0502
         ALR   @15,@15                                             0502
         LH    @15,SUPERID-2(@15)                                  0502
         LTR   @15,@15                                             0502
         BNZ   @RF00502                                            0502
*                    /************************************************/
*                    /*                                              */
*                    /* IF FIRST-LEVEL PARAMETERS ARE BEING SCANNED  */
*                    /* AND THE SCAN CURRENTLY POINTS TO A CLOSING   */
*                    /* PARENTHESIS, THEN TOO MANY PARENTHESES HAVE  */
*                    /* BEEN CODED AND WILL THEREFORE BE IGNORED.    */
*                    /* A WARNING MESSAGE IS ISSUED.                 */
*                    /*                                              */
*                    /************************************************/
*DOGRP10:            DO;                                           0503
DOGRP10  DS    0H                                                  0504
*                    OLDERID2 = NEWERID2;                          0504
         L     @01,GDTPTR                                          0504
         L     @15,GDTTR2(,@01)                                    0504
         MVC   @TS00001(95),NEWERID2(@15)                          0504
         MVC   OLDERID2(95,@15),@TS00001                           0504
*                    NEWID2='RI02';                                0505
         MVC   NEWID2(4,@15),@CC00836                              0505
*                    IF CHAR1 = CLOSING                            0506
*                      THEN                                        0506
         CLI   CHAR1,C')'                                          0506
         BNE   @RF00506                                            0506
*                        DO WHILE(RISTATUS=0 & CHAR1=CLOSING);     0507
         B     @DE00507                                            0507
@DL00507 DS    0H                                                  0508
*                          DARGSMOD=RISTID;                        0508
         L     @15,DDSTRU                                          0508
         MVC   DARGSMOD(3,@15),RISTID                              0508
*                          DARGSENT=TOOMANY;                       0509
*                                                                  0509
         MVI   DARGSENT(@15),X'22'                                 0509
*                          CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);   0510
*                                                                  0510
         L     @15,GDTPTR                                          0510
         ST    @15,@AL00001                                        0510
         LA    @14,@CF00102                                        0510
         ST    @14,@AL00001+4                                      0510
         LA    @14,DDSTRU                                          0510
         ST    @14,@AL00001+8                                      0510
         MVI   @AL00001+8,X'80'                                    0510
         L     @15,GDTPRT(,@15)                                    0510
         LA    @01,@AL00001                                        0510
         BALR  @14,@15                                             0510
*                          CALL NEXTCHAR;                          0511
         BAL   @14,NEXTCHAR                                        0511
*                          CALL SCANSEP(YES);                      0512
*                                                                  0512
         LA    @01,@AL00512                                        0512
         BAL   @14,SCANSEP                                         0512
*                        END;                                      0513
*                                                                  0513
@DE00507 LH    @15,RISTATUS                                        0513
         LTR   @15,@15                                             0513
         BNZ   @DC00507                                            0513
         CLI   CHAR1,C')'                                          0513
         BE    @DL00507                                            0513
@DC00507 DS    0H                                                  0514
*                    /**********************************************/
*                    /*                                            */
*                    /* IF COMMAND END HAS NOT BEEN FOUND, THEN    */
*                    /* EXTRACT A FIRST-LEVEL PARAMETER, AFTER     */
*                    /* CHECKING THE DESCRIPTOR LIST TO SEE IF IT  */
*                    /* IS TO BE A POSITIONAL OR KEYWORD PARAMETER.*/
*                    /*                                            */
*                    /**********************************************/
*                    IF RISTATUS^=0  CHAR1=ENDDELIM               0514
*                      THEN;                                       0514
@RF00506 LH    @15,RISTATUS                                        0514
         LTR   @15,@15                                             0514
         BNZ   @RT00514                                            0514
         CLI   CHAR1,C';'                                          0514
         BE    @RT00514                                            0514
*                      ELSE                                        0516
*                                                                  0516
*                        /******************************************/
*                        /*                                        */
*                        /* IF NO LIST OF POSITIONAL PARAMETERS IS */
*                        /* SPECIFIED IN THE DESCRIPTOR, THEN ALL  */
*                        /* FIRST-LEVEL PARM'S ARE KEYWORD PARM'S. */
*                        /* ALSO, IF ALL FIRST-LEVEL POSITIONALS   */
*                        /* HAVE BEEN EXTRACTED, EXPECT A KEYWORD. */
*                        /* IF NEITHER OF THE ABOVE, EXPECT A      */
*                        /* POSITIONAL PARAMETER.                  */
*                        /*                                        */
*                        /******************************************/
*                        IF POSDSPL=0                             0516
*                           PPARMCNT(PARMLVL) > VPOSCNT            0516
*                          THEN                                    0516
*                                                                  0516
         L     @15,DESCPTR                                         0516
         CLI   POSDSPL(@15),0                                      0516
         BE    @RT00516                                            0516
         LH    @14,PARMLVL                                         0516
         ALR   @14,@14                                             0516
         SLR   @05,@05                                             0516
         IC    @05,POSDSPL(,@15)                                   0516
         ALR   @05,@05                                             0516
         ALR   @15,@05                                             0516
         LH    @14,PPARMCNT-2(@14)                                 0516
         CH    @14,VPOSCNT(,@15)                                   0516
         BNH   @RF00516                                            0516
@RT00516 DS    0H                                                  0517
*                            CALL KWDPARM;                         0517
*                                                                  0517
         BAL   @14,KWDPARM                                         0517
*                          ELSE                                    0518
*                            DO;                                   0518
         B     @RC00516                                            0518
@RF00516 DS    0H                                                  0519
*                            PARMID=                               0519
*                                VPOSID(PPARMCNT(PARMLVL));        0519
*                                                                  0519
         LH    @15,PARMLVL                                         0519
         ALR   @15,@15                                             0519
         LH    @15,PPARMCNT-2(@15)                                 0519
         ALR   @15,@15                                             0519
         L     @14,DESCPTR                                         0519
         SLR   @05,@05                                             0519
         IC    @05,POSDSPL(,@14)                                   0519
         ALR   @05,@05                                             0519
         ALR   @14,@05                                             0519
         LH    @15,VPOSID-2(@15,@14)                               0519
         STH   @15,PARMID                                          0519
*                            CALL POSPARM;                         0520
*                                                                  0520
         BAL   @14,POSPARM                                         0520
*                            END;                                  0521
*                    END DOGRP10;                                  0522
*                  ELSE                                            0523
*                                                                  0523
*                    /************************************************/
*                    /*                                              */
*                    /* IF A SUBPARAMETER LIST IS BEING SCANNED AND  */
*                    /* THE SCAN CURRENTLY POINTS TO A CLOSING       */
*                    /* PARENTHESIS, THEN THE CURRENT SUBPARAMETER   */
*                    /* LIST SCAN IS FINISHED.  MAKE SURE THAT SOME  */
*                    /* SUBPARAMETERS WERE FOUND.                    */
*                    /*                                              */
*                    /************************************************/
*                    IF CHAR1=CLOSING                              0523
*                      THEN                                        0523
         B     @RC00502                                            0523
@RF00502 CLI   CHAR1,C')'                                          0523
         BNE   @RF00523                                            0523
*                        IF SUBSYET=NO                             0524
*                          THEN                                    0524
*                                                                  0524
         TM    SUBSYET,B'00010000'                                 0524
         BNZ   @RF00524                                            0524
*                            CALL ERROR2(BADELIM1,LENGTH(CHAR1),   0525
*                                        ADDR(CHAR1));             0525
*                                                                  0525
         MVC   @AL00001(8),@AL00525                                0525
         LA    @15,CHAR1                                           0525
         ST    @15,@AFTEMPS+12                                     0525
         LA    @15,@AFTEMPS+12                                     0525
         ST    @15,@AL00001+8                                      0525
         LA    @01,@AL00001                                        0525
         BAL   @14,ERROR2                                          0525
*                          ELSE                                    0526
*                            DO;                                   0526
         B     @RC00524                                            0526
@RF00524 DS    0H                                                  0527
*                              PARMID=SUPERID(PARMLVL);            0527
*                                                                  0527
         LH    @15,PARMLVL                                         0527
         ALR   @15,@15                                             0527
         LH    @15,SUPERID-2(@15)                                  0527
         STH   @15,PARMID                                          0527
*                              CALL NEXTCHAR;                      0528
*                                                                  0528
         BAL   @14,NEXTCHAR                                        0528
*                              IF RISTATUS=0                       0529
*                                THEN                              0529
         LH    @15,RISTATUS                                        0529
         LTR   @15,@15                                             0529
         BNZ   @RF00529                                            0529
*                                  IF REPEATED=NO                  0530
*                                    THEN                          0530
         LH    @15,PARMID                                          0530
         MH    @15,@CH00038                                        0530
         L     @01,WORKPTR                                         0530
         AL    @01,@CF01317                                        0530
         L     @01,PARMPTR(@15,@01)                                0530
         TM    REPEATED(@01),B'00100000'                           0530
         BNZ   @RF00530                                            0530
*                                      DO;                         0531
*                                                                  0531
*                                      CALL SCANSEP(YES);          0532
*                                                                  0532
         LA    @01,@AL00532                                        0532
         BAL   @14,SCANSEP                                         0532
*                                      PARMLVL=PARMLVL-1;          0533
         LH    @15,PARMLVL                                         0533
         BCTR  @15,0                                               0533
         STH   @15,PARMLVL                                         0533
*                                      END;                        0534
*                                                                  0534
*                                    /********************************/
*                                    /*                              */
*                                    /* WHEN CURRENTLY SCANNING      */
*                                    /* WITHIN A REPEATED SUBPARM.   */
*                                    /* LIST, TREAT EACH SUBLIST     */
*                                    /* SEPARATELY, APPLYING DEFAULTS*/
*                                    /* AND PERFORMING SEMANTIC      */
*                                    /* CHECKING.                    */
*                                    /*                              */
*                                    /********************************/
*                                    ELSE                          0535
*                                                                  0535
*                                      CALL INREPEAT;              0535
*                                                                  0535
         B     @RC00530                                            0535
@RF00530 BAL   @14,INREPEAT                                        0535
*                            END;                                  0536
*                                                                  0536
*                      /**********************************************/
*                      /*                                            */
*                      /* A SUBPARAMETER LIST HAS ADDITIONAL         */
*                      /* SUBPARAMETERS TO BE SCANNED.               */
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        0537
*                                                                  0537
*                        /********************************************/
*                        /*                                          */
*                        /* EXAMINE THE DESCRIPTOR SUBPARM LIST FOR  */
*                        /* THIS PARAMETER TO SEE IF A POSITIONAL    */
*                        /* PARM. REMAINS TO BE EXTRACTED OR IF A    */
*                        /* KEYWORD PARAMETER SHOULD BE PICKED UP.   */
*                        /*                                          */
*                        /********************************************/
*DOGRP15:                DO;                                       0537
         B     @RC00523                                            0537
@RF00523 DS    0H                                                  0537
DOGRP15  DS    0H                                                  0538
*                          SUBSYET=YES;                            0538
         OI    SUBSYET,B'00010000'                                 0538
*                          PARMID=SUPERID(PARMLVL);                0539
         LH    @15,PARMLVL                                         0539
         ALR   @15,@15                                             0539
         LH    @14,SUPERID-2(@15)                                  0539
         STH   @14,PARMID                                          0539
*                          IF PPARMCNT(PARMLVL) <= SUBCOUNT        0540
*                            THEN                                  0540
         LH    @15,PPARMCNT-2(@15)                                 0540
         LA    @05,12                                              0540
         LR    @01,@14                                             0540
         MR    @00,@05                                             0540
         L     @14,WORKPTR                                         0540
         AL    @14,@CF01317                                        0540
         L     @14,PARMPTR(@01,@14)                                0540
         ALR   @05,@14                                             0540
         SLR   @04,@04                                             0540
         IC    @04,SUBDSPL(,@05)                                   0540
         ALR   @04,@04                                             0540
         ALR   @14,@04                                             0540
         CH    @15,SUBCOUNT(,@14)                                  0540
         BH    @RF00540                                            0540
*                              DO;                                 0541
*                              OLDERID2 = NEWERID2;                0542
         L     @01,GDTPTR                                          0542
         L     @05,GDTTR2(,@01)                                    0542
         MVC   @TS00001(95),NEWERID2(@05)                          0542
         MVC   OLDERID2(95,@05),@TS00001                           0542
*                              NEWID2='RI03';                      0543
         MVC   NEWID2(4,@05),@CC00842                              0543
*                              IF PARMTYPE(PPARMCNT(PARMLVL)) = 'K'
*                                THEN                              0544
*                                                                  0544
         SLA   @15,2                                               0544
         ALR   @14,@15                                             0544
         BCTR  @14,0                                               0544
         BCTR  @14,0                                               0544
         CLI   PARMTYPE-2(@14),C'K'                                0544
         BNE   @RF00544                                            0544
*                                  CALL KWDPARM;                   0545
*                                                                  0545
         BAL   @14,KWDPARM                                         0545
*                                ELSE                              0546
*                                  DO;                             0546
         B     @RC00544                                            0546
@RF00544 DS    0H                                                  0547
*                                  PARMID=SUBID(PPARMCNT(PARMLVL));
*                                                                  0547
         LH    @15,PARMLVL                                         0547
         ALR   @15,@15                                             0547
         LH    @15,PPARMCNT-2(@15)                                 0547
         SLA   @15,2                                               0547
         LA    @14,12                                              0547
         LR    @05,@14                                             0547
         MH    @05,PARMID                                          0547
         L     @01,WORKPTR                                         0547
         AL    @01,@CF01317                                        0547
         L     @05,PARMPTR(@05,@01)                                0547
         ALR   @14,@05                                             0547
         SLR   @04,@04                                             0547
         IC    @04,SUBDSPL(,@14)                                   0547
         ALR   @04,@04                                             0547
         ALR   @05,@04                                             0547
         LH    @15,SUBID-4(@15,@05)                                0547
         STH   @15,PARMID                                          0547
*                                  CALL POSPARM;                   0548
*                                                                  0548
         BAL   @14,POSPARM                                         0548
*                                  END;                            0549
*                              END;                                0550
*                                                                  0550
*                            /****************************************/
*                            /*                                      */
*                            /* IF NO SUBPARAMETERS OF THE CURRENT   */
*                            /* SUPERPARAMETER REMAIN TO BE EXTRACTED*/
*                            /* A SYNTAX ERROR HAS BEEN FOUND.       */
*                            /*                                      */
*                            /****************************************/
*                            ELSE                                  0551
*                                                                  0551
*                              CALL ERROR2(BADPOS,LENGTH(ERRFIELD),
*                                          ADDR(ERRFIELD));        0551
*                                                                  0551
         B     @RC00540                                            0551
@RF00540 MVC   @AL00001(8),@AL00551                                0551
         LA    @15,ERRFIELD                                        0551
         ST    @15,@AFTEMPS+12                                     0551
         LA    @15,@AFTEMPS+12                                     0551
         ST    @15,@AL00001+8                                      0551
         LA    @01,@AL00001                                        0551
         BAL   @14,ERROR2                                          0551
*                        END DOGRP15;                              0552
@RC00540 DS    0H                                                  0553
*        END DOLOOP5;                                              0553
@RC00523 DS    0H                                                  0553
@RC00502 DS    0H                                                  0553
@RC00434 DS    0H                                                  0553
@DE00431 TM    STMTEND,B'10000000'                                 0553
         BNZ   @DC00431                                            0553
         LH    @15,RISTATUS                                        0553
         LTR   @15,@15                                             0553
         BZ    @DL00431                                            0553
@DC00431 DS    0H                                                  0554
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETNEXT                                        */
*/*                                                                  */
*/*  FUNCTION - THIS PROCEDURE OBTAINS THE VERB NAME AND POINTER TO  */
*/*             THE PARAMETER SET OF THE NEXT FUNCTION COMMAND.      */
*/*             MODAL COMMANDS ARE INTERPRETED TO DETERMINE OF THE   */
*/*             NEXT FUNCTION COMMAND FOUND IS TO BE RETURNED IN     */
*/*             ENCODED FORM TO THE DMS EXECUTIVE FOR EXECUTION.     */
*/*             FUNCTION COMMANDS WHICH ARE NOT TO BE ENCODED OR     */
*/*             RETURNED WILL SIMPLY BE EXAMINED FOR CORRECT SYNTAX  */
*/*             AND THEN BYPASSED.  WHEN REQUIRED, A NEW INPUT RECORD*/
*/*             IS READ IN ORDER TO OBTAIN THE NEXT FUNCTION OR MODAL*/
*/*             COMMAND SYNTACTIC UNIT.                              */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          SCANONLY - FLAG INDICATING WHETHER OR NOT THE CURRENT   */
*/*                     COMMAND IS TO BE ENCODED INTO AN FDT OR JUST */
*/*                     SCANNED FOR SYNTAX CHECKING.                 */
*/*          RISTATUS - INTERNAL R/I CODE SET TO NON-ZERO CODE WHEN  */
*/*                     AN ERROR HAS BEEN FOUND DURING R/I SCANNING. */
*/*          LASTCC -   LAST SYSTEM CONDITION CODE                   */
*/*          MAXCC -    MAXIMUM SYSTEM CONDITION CODE SO FAR         */
*/*          SYNUNIT -  MOST RECENTLY EXTRACTED SYNTACTIC UNIT       */
*/*          NESTLVL -  CURRENT 'IF' COMMAND NESTING LEVEL           */
*/*          SINGLCMD - FLAG INDICATING THAT A SINGLE COMMAND (NOT A */
*/*                     DO-GROUP) FOLLOWS AN 'IF' OR 'ELSE' COMMAND  */
*/*          IFNEXT -   FLAG INDICATING THAT AN 'IF' COMMAND FOLLOWS */
*/*                     AN 'IF' OR 'ELSE' COMMAND                    */
*/*          NULLDO -   NUMBER OF NULL 'DO' COMMANDS FOUND AT CURRENT*/
*/*                     'IF' NESTING LEVEL (A NULLDO COUNT EXISTS FOR*/
*/*                     EACH LEVEL OF 'IF' NESTING)                  */
*/*          DOFLAG -   INDICATES WHETHER OR NOT A DO-GROUP IS BEING */
*/*                     SCANNED AT CURRENT 'IF' NESTING LEVEL        */
*/*          THENFLAG - INDICATES WHETHER OR NOT THE 'THEN' PATH     */
*/*                     COMMANDS ARE CURRENTLY BEING SCANNED AT      */
*/*                     CURRENT LEVEL OF 'IF' NESTING.               */
*/*          ELSEFLAG - FLAG INDICATING WHETHER OR NOT THE 'ELSE'    */
*/*                     PATH COMMANDS ARE CURRENTLY BEING SCANNED    */
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */
*/*          SKIPFLAG - INDICATES WHETHER OR NOT COMMANDS AT CURRENT */
*/*                     LEVEL OF 'IF' NESTING ARE TO BE EXECUTED.    */
*/*          UNITINDX - LENGTH OF MOST RECENTLY EXTRACTED SYNTACTIC  */
*/*                     UNIT.                                        */
*/*          GETVERB -  FLAG INDICATING WHETHER OR NOT THE NEXT      */
*/*                     INPUT COMMAND VERB HAS BEEN EXTRACTED.       */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          VERBNAME - NAME OF FUNCTION COMMAND VERB WHOSE PARAMETER*/
*/*                     PARAMETER SET WILL NEXT BE SCANNED.          */
*/*          SCANONLY - FLAG NOTING WHETHER OR NOT NEXT FUNCTION     */
*/*                     COMMAND IS TO BE EXECUTED.                   */
*/*          IFNEXT -   FLAG SET 'ON' WHEN COMMAND FOLLOWING A 'THEN'*/
*/*                     OR 'ELSE' IS AN 'IF' MODAL COMMAND.          */
*/*          SINGLCMD - FLAG SET 'ON' WHEN A SINGLE COMMAND (NOT A   */
*/*                     DO-GROUP) FOLLOWS THE 'THEN' OR 'ELSE' JUST  */
*/*                     SCANNED.                                     */
*/*          MAXCC -    MAX. SYSTEM CONDITION CODE; RESET BASED UPON */
*/*                     EVALUATION OF 'IF' MODAL COMMANDS            */
*/*          LASTCC -   LAST SYSTEM CONDITION CODE; SET BASED UPON   */
*/*                     EVALUATION OF 'IF' COMMANDS AND UPON MODAL   */
*/*                     COMMAND ERRORS FOUND.                        */
*/*          EOFOK -    FLAG SET 'ON' WHEN SCANNING BETWEEN COMMANDS */
*/*                     TO SIGNAL THAT EOF MAY BE PROPERLY FOUND.    */
*/*          GETVERB -  FLAG SET 'ON' WHEN THE NEXT COMMAND VERB HAS */
*/*                     ALREADY BEEN EXTRACTED FOLLOWING A 'THEN' OR */
*/*                     'ELSE'.                                      */
*/*          RISTATUS - R/I INTERNAL STATUS CODE; SET TO A NON-ZERO  */
*/*                     CODE WHEN ANY ERROR IS FOUND.                */
*/*          NESTLVL -  LEVEL OF 'IF' NESTING AT WHICH SCANNING IS   */
*/*                     CURRENTLY TAKING PLACE.                      */
*/*          NULLDO -   NULL DO COMMANDS ENCOUNTERED WHILE SCANNING  */
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */
*/*          DOFLAG -   FLAG SET 'ON' WHEN SCANNING WITHIN A DO-GROUP*/
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */
*/*                                                                  */
*/********************************************************************/
*GETNEXT:PROCEDURE;                                                0554
         B     @PB00004                                            0554
GETNEXT  STM   @14,@12,@SA00004                                    0554
*        /************************************************************/
*        /*                                                          */
*        /* DATA DEFINITIONS FOR OBTAINING NEXT FUNCTION COMMAND     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0555
*        DCL RELATION CHAR(32);        /*FIELD TO CONTAIN EXTRACTED
*                                        'IF' COMMAND RELATIONAL   0555
*                                        EXPRESSION OR 'SET' COMMAND
*                                        ASSIGNMENT EXPRESSION.      */
*        DCL RELSIZE  FIXED(15);       /*NUMBER OF EXTRACTED CHAR'S IN
*                                        ABOVE EXPRESSION.           */
*        DCL PART1LEN FIXED(15);       /*LENGTH OF EITHER 'MAXCC' OR
*                                        'LASTCC' CONSTANT           */
*                                                                  0557
*        DCL EQSIGN1  CHAR(1)          /*EQUAL SIGN                  */
*                     CONSTANT('=');                               0558
*        DCL EQSIGN2  CHAR(2)          /*EQUAL SIGN                  */
*                     CONSTANT('EQ');                              0559
*                                                                  0559
*        /*STATIC ERROR MESSAGE CODES                                */
*        DCL BADELSE  FIXED(15)        /*IMPROPER 'ELSE' COMMAND     */
*                     CONSTANT(28);                                0560
*        DCL BADDOEND FIXED(15)        /*IMPROPER 'DO' OR 'END'      */
*                     CONSTANT(29);                                0561
*        DCL BADEXPR1 FIXED(15)        /*BAD EXPRESSION IN 'IF' CMD. */
*                     CONSTANT(30);                                0562
*        DCL BADEXPR2 FIXED(15)        /*BAD EXPRESSION IN 'SET' CMD.*/
*                     CONSTANT(31);                                0563
*        DCL NOTHEN   FIXED(15)        /*MISSING 'THEN' KEYWORD      */
*                     CONSTANT(33);                                0564
*        DCL BADIFNST FIXED(15)        /*TOO MUCH 'IF' NESTING       */
*                     CONSTANT(38);                                0565
*                                                                  0565
*        DCL 1 *,                                                  0566
*              2 NONMODAL BIT(1),      /*SIGNALS THAT A NON-MODAL  0566
*                                        COMMAND VERB HAS BEEN FOUND */
*              2 REDOLVL0 BIT(1),      /*'IF' NESTING HAS RETURNED TO
*                                        A LEVEL OF ZERO FOLLOWING AN
*                                        'IF-THEN' MODAL COMMAND     */
*              2 EXPREND  BIT(1),      /*SIGNALS THAT ALL OF THE   0566
*                                        RELATIONAL EXPRESSION HAS 0566
*                                        BEEN EXTRACTED.             */
*              2 SINGLCMD BIT(1),      /*SIGNALS THAT A SINGLE COMMAND
*                                        (A NON-MODAL OR A 'SET' MODAL
*                                        COMMAND) FOLLOWS THE 'THEN'
*                                        OR 'ELSE' JUST SCANNED.     */
*              2 IFNEXT   BIT(1),      /*AN 'IF' COMMAND FOLLOWS THE
*                                        THE CURRENT 'THEN' OR 'ELSE'*/
*              2 GETVERB  BIT(1);      /*EXTRACT THE NEXT COMMAND VERB
*                                        BEFORE RESUMING SEARCH FOR
*                                        FUNCTION COMMAND.           */
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETNEXT ** GET NEXT FUNCTION COMMAND                 */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0567
*          THEN;                                                   0567
         L     @01,GDTPTR                                          0567
         L     @15,GDTDBG(,@01)                                    0567
         LTR   @15,@15                                             0567
         BZ    @RT00567                                            0567
*          ELSE                                                    0569
*            CALL ICKDB010(GDTTBL,'RIGN');                         0569
*                                                                  0569
         L     @15,GDTPTR                                          0569
         ST    @15,@AL00001                                        0569
         LA    @14,@CC00868                                        0569
         ST    @14,@AL00001+4                                      0569
         MVI   @AL00001+4,X'80'                                    0569
         L     @15,GDTDBG(,@15)                                    0569
         LA    @01,@AL00001                                        0569
         BALR  @14,@15                                             0569
*        /************************************************************/
*        /*                                                          */
*        /* PICK UP THE FIRST COMMAND VERB ENCOUNTERED, BYPASSING    */
*        /* DELIMITING SEPARATOR CHARACTERS WHICH SURROUND IT.       */
*        /*                                                          */
*        /************************************************************/
*        NULLCMD=NO;                                               0570
@RT00567 NI    NULLCMD,B'10111111'                                 0570
*        COMMENT=NO;                                               0571
*        FIRSTCHR=YES;                                             0572
         OI    FIRSTCHR,B'00000100'                                0572
         NI    COMMENT,B'10111111'                                 0572
*        CHAR1=BLANK;                                              0573
*                                                                  0573
         MVI   CHAR1,C' '                                          0573
*        CALL SCANSEP(NO);                                         0574
         LA    @01,@AL00574                                        0574
         BAL   @14,SCANSEP                                         0574
*        CALL NXTFIELD(VERBFLD);                                   0575
         LA    @01,@AL00575                                        0575
         BAL   @14,NXTFIELD                                        0575
*        CALL SCANSEP(NO);                                         0576
*                                                                  0576
         LA    @01,@AL00576                                        0576
         BAL   @14,SCANSEP                                         0576
*        /************************************************************/
*        /*                                                          */
*        /* SCAN AND INTERPRET INPUT COMMANDS UNTIL A NON-MODAL      */
*        /* (FUNCTION) COMMAND IS FOUND.  EACH PASS OF THE FOLLOWING */
*        /* SECTION OF CODE BEGINS BY COMPUTING THE CURRENT MAXIMUM  */
*        /* SYSTEM CONDITION CODE AND EXAMINING A VERB NAME JUST     */
*        /* EXTRACTED.  APPROPRIATE FLAGS ARE SET BASED UPON THE     */
*        /* MODAL STATEMENTS ENCOUNTERED.                            */
*        /*                                                          */
*        /************************************************************/
*        NONMODAL=NO;                                              0577
*        IFNEXT=NO;                                                0578
*        SINGLCMD=NO;                                              0579
         NI    NONMODAL,B'01100111'                                0579
*DOLOOP10:DO WHILE(NONMODAL=NO & RISTATUS=0);                      0580
DOLOOP10 B     @DE00580                                            0580
@DL00580 DS    0H                                                  0581
*          EOFOK=NO;                                               0581
         NI    EOFOK,B'10111111'                                   0581
*          GETVERB=YES;                                            0582
*          REDOLVL0=NO;                                            0583
*                                                                  0583
         OI    GETVERB,B'00000100'                                 0583
         NI    REDOLVL0,B'10111111'                                0583
*          /**********************************************************/
*          /*                                                        */
*          /* IF CURRENTLY NO 'IF' MODAL COMMAND NESTING, CHECK      */
*          /* THE EXTRACTED VERB NAME TO SEE IF IT IS A MODAL COMMAND*/
*          /* VERB.  IF SO, INTERPRET THAT MODAL COMMAND, SETTING    */
*          /* CONTROL FLAGS; IF NOT A MODAL, 'GETNEXT' IS FINISHED.  */
*          /*                                                        */
*          /**********************************************************/
*          IF NESTLVL=0                                            0584
*            THEN                                                  0584
         L     @01,GDTPTR                                          0584
         L     @15,GDTRIH(,@01)                                    0584
         CLI   NESTLVL(@15),0                                      0584
         BNE   @RF00584                                            0584
*              IF SYNUNIT=IFSYM                                    0585
*                THEN                                              0585
*                                                                  0585
         L     @01,KWTBLPTR(,@15)                                  0585
         CLC   SYNUNIT(9),IFSYM(@01)                               0585
         BNE   @RF00585                                            0585
*                  CALL MODALIF;                                   0586
*                                                                  0586
         BAL   @14,MODALIF                                         0586
*                ELSE                                              0587
*                  IF SYNUNIT=SETSYM                               0587
*                    THEN                                          0587
*                                                                  0587
         B     @RC00585                                            0587
@RF00585 L     @01,GDTPTR                                          0587
         L     @01,GDTRIH(,@01)                                    0587
         L     @01,KWTBLPTR(,@01)                                  0587
         CLC   SYNUNIT(9),SETSYM(@01)                              0587
         BNE   @RF00587                                            0587
*                      CALL MODALSET;                              0588
*                                                                  0588
         BAL   @14,MODALSET                                        0588
*                    ELSE                                          0589
*                      IF SYNUNIT=DOSYM  SYNUNIT=ENDSYM           0589
*                        THEN                                      0589
*                                                                  0589
         B     @RC00587                                            0589
@RF00587 L     @01,GDTPTR                                          0589
         L     @01,GDTRIH(,@01)                                    0589
         L     @15,KWTBLPTR(,@01)                                  0589
         CLC   SYNUNIT(9),DOSYM(@15)                               0589
         BE    @RT00589                                            0589
         CLC   SYNUNIT(9),ENDSYM(@15)                              0589
         BNE   @RF00589                                            0589
@RT00589 DS    0H                                                  0590
*                          /******************************************/
*                          /*                                        */
*                          /* 'DO' AND 'END' COMMANDS ARE SIMPLY     */
*                          /* IGNORED AT THIS LEVEL.                 */
*                          /*                                        */
*                          /******************************************/
*                                                                  0590
*                          CALL BYPASTRM;                          0590
*                                                                  0590
         BAL   @14,BYPASTRM                                        0590
*                        ELSE                                      0591
*                          IF SYNUNIT=ELSESYM                      0591
*                            THEN                                  0591
*                                                                  0591
         B     @RC00589                                            0591
@RF00589 L     @01,GDTPTR                                          0591
         L     @01,GDTRIH(,@01)                                    0591
         L     @01,KWTBLPTR(,@01)                                  0591
         CLC   SYNUNIT(9),ELSESYM(@01)                             0591
         BNE   @RF00591                                            0591
*                              /**************************************/
*                              /*                                    */
*                              /* AN 'ELSE' STATEMENT IS IN ERROR IF */
*                              /* IT APPEARS AT THIS LEVEL.          */
*                              /*                                    */
*                              /**************************************/
*                              DO;                                 0592
*                              LASTCC=TERMERR;                     0593
         MVC   LASTCC(2),@CH00274                                  0593
*                              RISTATUS=BADELSE;                   0594
         MVC   RISTATUS(2),@CH00298                                0594
*                              END;                                0595
*                            ELSE                                  0596
*                              NONMODAL=YES;                       0596
*                                                                  0596
         B     @RC00591                                            0596
@RF00591 OI    NONMODAL,B'10000000'                                0596
*          /********************************************************/
*          /*                                                      */
*          /* WHEN WITHIN SOME LEVEL OF 'IF' COMMAND NESTING,      */
*          /* MODAL COMMANDS ARE CHECKED TO BE SURE THAT THEY OCCUR*/
*          /* PROPERLY IN THE MODAL COMMAND STRUCTURE.  IF OKAY,   */
*          /* THE COMMAND IS INTERPRETED AND CONTROL FLAGS ARE SET.*/
*          /* IF NOT A MODAL COMMAND, 'GETNEXT' IS FINISHED.       */
*          /*                                                      */
*          /********************************************************/
*          ELSE                                                    0597
*                                                                  0597
*            /******************************************************/
*            /*                                                    */
*            /* AN 'ELSE' COMMAND MUST HAVE A MATCHING 'IF-THEN'   */
*            /* MODAL COMMAND OR IT IS AN ERROR.                   */
*            /*                                                    */
*            /******************************************************/
*            IF SYNUNIT=ELSESYM                                    0597
*              THEN                                                0597
         B     @RC00584                                            0597
@RF00584 L     @01,GDTPTR                                          0597
         L     @15,GDTRIH(,@01)                                    0597
         L     @01,KWTBLPTR(,@15)                                  0597
         CLC   SYNUNIT(9),ELSESYM(@01)                             0597
         BNE   @RF00597                                            0597
*                IF THENFLAG(NESTLVL)=ON & DOFLAG(NESTLVL)=OFF     0598
*                  THEN                                            0598
*                                                                  0598
         SLR   @14,@14                                             0598
         IC    @14,NESTLVL(,@15)                                   0598
         ALR   @14,@14                                             0598
         ALR   @15,@14                                             0598
         TM    THENFLAG-2(@15),B'01000000'                         0598
         BNO   @RF00598                                            0598
         TM    DOFLAG-2(@15),B'10000000'                           0598
         BNZ   @RF00598                                            0598
*                    CALL MODLELSE;                                0599
*                                                                  0599
         BAL   @14,MODLELSE                                        0599
*                  ELSE                                            0600
*                    DO;                                           0600
         B     @RC00598                                            0600
@RF00598 DS    0H                                                  0601
*                    LASTCC=TERMERR;                               0601
         MVC   LASTCC(2),@CH00274                                  0601
*                    RISTATUS=BADELSE;                             0602
         MVC   RISTATUS(2),@CH00298                                0602
*                    END;                                          0603
*              ELSE                                                0604
*DOGRP20:        DO;                                               0604
         B     @RC00597                                            0604
@RF00597 DS    0H                                                  0604
DOGRP20  DS    0H                                                  0605
*                OLDERID2 = NEWERID2;                              0605
         L     @01,GDTPTR                                          0605
         L     @15,GDTTR2(,@01)                                    0605
         MVC   @TS00001(95),NEWERID2(@15)                          0605
         MVC   OLDERID2(95,@15),@TS00001                           0605
*                NEWID2='RI04';                                    0606
*                                                                  0606
         MVC   NEWID2(4,@15),@CC00878                              0606
*                /****************************************************/
*                /*                                                  */
*                /* IF THERE IS NO MATCHING 'ELSE' FOR ONE OR MORE   */
*                /* 'THEN' KEYWORDS, THEN ADJUST THE 'IF' NESTING    */
*                /* LEVEL ONE LESS DEEP FOR EACH NONMATCH            */
*                /*                                                  */
*                /****************************************************/
*                DO WHILE(NESTLVL>0 & SINGLCMD=NO & IFNEXT=NO &    0607
*                         DOFLAG(NESTLVL)=OFF);                    0607
         B     @DE00607                                            0607
@DL00607 DS    0H                                                  0608
*                  NESTLVL=NESTLVL-1;                              0608
         L     @01,GDTPTR                                          0608
         L     @15,GDTRIH(,@01)                                    0608
         SLR   @14,@14                                             0608
         IC    @14,NESTLVL(,@15)                                   0608
         BCTR  @14,0                                               0608
         STC   @14,NESTLVL(,@15)                                   0608
*                END;                                              0609
@DE00607 L     @01,GDTPTR                                          0609
         L     @15,GDTRIH(,@01)                                    0609
         CLI   NESTLVL(@15),0                                      0609
         BNH   @DC00607                                            0609
         TM    SINGLCMD,B'00011000'                                0609
         BNZ   @DC00607                                            0609
         SLR   @14,@14                                             0609
         IC    @14,NESTLVL(,@15)                                   0609
         ALR   @14,@14                                             0609
         ALR   @15,@14                                             0609
         TM    DOFLAG-2(@15),B'10000000'                           0609
         BZ    @DL00607                                            0609
@DC00607 DS    0H                                                  0610
*                IF NESTLVL=0                                      0610
*                  THEN                                            0610
         L     @01,GDTPTR                                          0610
         L     @01,GDTRIH(,@01)                                    0610
         CLI   NESTLVL(@01),0                                      0610
         BNE   @RF00610                                            0610
*                    REDOLVL0=YES;                                 0611
         OI    REDOLVL0,B'01000000'                                0611
*                  ELSE                                            0612
*                    IF SYNUNIT=IFSYM                              0612
*                      THEN                                        0612
*                                                                  0612
         B     @RC00610                                            0612
@RF00610 L     @01,GDTPTR                                          0612
         L     @01,GDTRIH(,@01)                                    0612
         L     @01,KWTBLPTR(,@01)                                  0612
         CLC   SYNUNIT(9),IFSYM(@01)                               0612
         BNE   @RF00612                                            0612
*                        CALL MODALIF;                             0613
*                                                                  0613
         BAL   @14,MODALIF                                         0613
*                      ELSE                                        0614
*                                                                  0614
*                        /********************************************/
*                        /*                                          */
*                        /* AN 'END' COMMAND NULLIFIES A MATCHING    */
*                        /* 'DO' COMMAND. HOWEVER, IT IS AN ERROR IF */
*                        /* NO MATCHING 'DO' EXISTS.  IF ALL IS OKAY,*/
*                        /* THE 'END' IS BYPASSED & SCANNING RESUMES */
*                        /*                                          */
*                        /********************************************/
*                        IF SYNUNIT=ENDSYM                         0614
*                          THEN                                    0614
         B     @RC00612                                            0614
@RF00612 L     @01,GDTPTR                                          0614
         L     @15,GDTRIH(,@01)                                    0614
         L     @01,KWTBLPTR(,@15)                                  0614
         CLC   SYNUNIT(9),ENDSYM(@01)                              0614
         BNE   @RF00614                                            0614
*                            DO;                                   0615
*                            IF NULLDO(NESTLVL)=0                  0616
*                              THEN                                0616
         SLR   @14,@14                                             0616
         IC    @14,NESTLVL(,@15)                                   0616
         LR    @05,@14                                             0616
         ALR   @05,@05                                             0616
         SLR   @04,@04                                             0616
         IC    @04,NULLDO-2(@05,@15)                               0616
         CH    @04,@CH00102                                        0616
         BNE   @RF00616                                            0616
*                                IF DOFLAG(NESTLVL)=ON             0617
*                                  THEN                            0617
         ST    @05,@TF00001                                        0617
         ALR   @05,@15                                             0617
         TM    DOFLAG-2(@05),B'10000000'                           0617
         BNO   @RF00617                                            0617
*                                    DO;                           0618
*                                    DOFLAG(NESTLVL)=OFF;          0619
         LR    @01,@15                                             0619
         AL    @01,@TF00001                                        0619
         NI    DOFLAG-2(@01),B'01111111'                           0619
*                                    IF ELSEFLAG(NESTLVL)=ON       0620
*                                      THEN                        0620
         LR    @01,@15                                             0620
         AL    @01,@TF00001                                        0620
         TM    ELSEFLAG-2(@01),B'00100000'                         0620
         BNO   @RF00620                                            0620
*                                        NESTLVL=NESTLVL-1;        0621
         BCTR  @14,0                                               0621
         STC   @14,NESTLVL(,@15)                                   0621
*                                    END;                          0622
*                                  ELSE                            0623
*                                    DO;                           0623
         B     @RC00617                                            0623
@RF00617 DS    0H                                                  0624
*                                    LASTCC=TERMERR;               0624
         MVC   LASTCC(2),@CH00274                                  0624
*                                    RISTATUS=BADDOEND;            0625
         MVC   RISTATUS(2),@CH00300                                0625
*                                    END;                          0626
*                              ELSE                                0627
*                                NULLDO(NESTLVL)=NULLDO(NESTLVL)-1;
         B     @RC00616                                            0627
@RF00616 L     @01,GDTPTR                                          0627
         L     @15,GDTRIH(,@01)                                    0627
         SLR   @14,@14                                             0627
         IC    @14,NESTLVL(,@15)                                   0627
         ALR   @14,@14                                             0627
         SLR   @05,@05                                             0627
         IC    @05,NULLDO-2(@14,@15)                               0627
         BCTR  @05,0                                               0627
         STC   @05,NULLDO-2(@14,@15)                               0627
*                            IF SINGLCMD=YES                       0628
*                              THEN                                0628
@RC00616 TM    SINGLCMD,B'00010000'                                0628
         BNO   @RF00628                                            0628
*                                DO;                               0629
*                                LASTCC=TERMERR;                   0630
         MVC   LASTCC(2),@CH00274                                  0630
*                                RISTATUS=BADDOEND;                0631
         MVC   RISTATUS(2),@CH00300                                0631
*                                END;                              0632
*                              ELSE                                0633
*                                                                  0633
*                                CALL BYPASTRM;                    0633
*                                                                  0633
         B     @RC00628                                            0633
@RF00628 BAL   @14,BYPASTRM                                        0633
*                            END;                                  0634
*                          ELSE                                    0635
*                            IF SYNUNIT=SETSYM                     0635
*                              THEN                                0635
*                                                                  0635
         B     @RC00614                                            0635
@RF00614 L     @01,GDTPTR                                          0635
         L     @01,GDTRIH(,@01)                                    0635
         L     @01,KWTBLPTR(,@01)                                  0635
         CLC   SYNUNIT(9),SETSYM(@01)                              0635
         BNE   @RF00635                                            0635
*                                CALL MODALSET;                    0636
*                                                                  0636
         BAL   @14,MODALSET                                        0636
*                              ELSE                                0637
*                                                                  0637
*                                /************************************/
*                                /*                                  */
*                                /* A 'DO' COMMAND NOT FOLLOWING AN  */
*                                /* 'IF' OR AN 'ELSE' COMMAND IS JUST*/
*                                /* BYPASSED AFTER NOTING THAT THE   */
*                                /* 'END' WILL BE BYPASSED TOO       */
*                                /*                                  */
*                                /************************************/
*                                IF SYNUNIT=DOSYM                  0637
*                                  THEN                            0637
         B     @RC00635                                            0637
@RF00635 L     @01,GDTPTR                                          0637
         L     @15,GDTRIH(,@01)                                    0637
         L     @01,KWTBLPTR(,@15)                                  0637
         CLC   SYNUNIT(9),DOSYM(@01)                               0637
         BNE   @RF00637                                            0637
*                                    DO;                           0638
*                                    NULLDO(NESTLVL)=NULLDO(NESTLVL)+1;
*                                                                  0639
         SLR   @14,@14                                             0639
         IC    @14,NESTLVL(,@15)                                   0639
         ALR   @14,@14                                             0639
         LA    @05,1                                               0639
         ST    @14,@TF00001                                        0639
         ALR   @14,@15                                             0639
         MVC   @ZT00003+3(1),NULLDO-2(@14)                         0639
         AL    @05,@ZT00003                                        0639
         L     @14,@TF00001                                        0639
         STC   @05,NULLDO-2(@14,@15)                               0639
*                                    CALL BYPASTRM;                0640
*                                                                  0640
         BAL   @14,BYPASTRM                                        0640
*                                    END;                          0641
*                                  ELSE                            0642
*                                                                  0642
*                                    /********************************/
*                                    /*                              */
*                                    /* IF NOT A MODAL COMMAND, CHECK*/
*                                    /* WHETHER THE CURRENT GROUP OF */
*                                    /* FUNCTION COMMANDS ARE JUST   */
*                                    /* BEING SCANNED OR NOT. ALSO,  */
*                                    /* MOVE ONE 'IF' NESTING LEVEL  */
*                                    /* LESS DEEP IF THIS NON-MODAL  */
*                                    /* IS A SINGLE COMMAND FOLLOWING*/
*                                    /* AN 'ELSE' COMMAND.           */
*                                    /*                              */
*                                    /********************************/
*                                    DO;                           0642
         B     @RC00637                                            0642
@RF00637 DS    0H                                                  0643
*                                    IF SKIPFLAG(NESTLVL)=ON       0643
*                                      THEN                        0643
         L     @01,GDTPTR                                          0643
         L     @15,GDTRIH(,@01)                                    0643
         SLR   @14,@14                                             0643
         IC    @14,NESTLVL(,@15)                                   0643
         ALR   @14,@14                                             0643
         ALR   @15,@14                                             0643
         TM    SKIPFLAG-2(@15),B'00010000'                         0643
         BNO   @RF00643                                            0643
*                                        SCANONLY=YES;             0644
         OI    SCANONLY,B'00010000'                                0644
*                                    NONMODAL=YES;                 0645
@RF00643 OI    NONMODAL,B'10000000'                                0645
*                                    IF SINGLCMD=YES               0646
*                                      THEN                        0646
         TM    SINGLCMD,B'00010000'                                0646
         BNO   @RF00646                                            0646
*                                        DO;                       0647
*                                        SINGLCMD=NO;              0648
         NI    SINGLCMD,B'11101111'                                0648
*                                        IF ELSEFLAG(NESTLVL)=ON   0649
*                                          THEN                    0649
         L     @01,GDTPTR                                          0649
         L     @15,GDTRIH(,@01)                                    0649
         SLR   @14,@14                                             0649
         IC    @14,NESTLVL(,@15)                                   0649
         LR    @05,@14                                             0649
         ALR   @05,@05                                             0649
         ALR   @05,@15                                             0649
         TM    ELSEFLAG-2(@05),B'00100000'                         0649
         BNO   @RF00649                                            0649
*                                            NESTLVL=NESTLVL-1;    0650
         BCTR  @14,0                                               0650
         STC   @14,NESTLVL(,@15)                                   0650
*                                        END;                      0651
@RF00649 DS    0H                                                  0652
*                                    END;                          0652
@RF00646 DS    0H                                                  0653
*                END DOGRP20;                                      0653
*                                                                  0653
@RC00637 DS    0H                                                  0653
@RC00635 DS    0H                                                  0653
@RC00614 DS    0H                                                  0653
@RC00612 DS    0H                                                  0653
@RC00610 DS    0H                                                  0654
*          IF RISTATUS=0 & REDOLVL0=NO                             0654
*            THEN                                                  0654
@RC00597 DS    0H                                                  0654
@RC00584 LH    @15,RISTATUS                                        0654
         LTR   @15,@15                                             0654
         BNZ   @RF00654                                            0654
         TM    REDOLVL0,B'01000000'                                0654
         BNZ   @RF00654                                            0654
*DOGRP25:      DO;                                                 0655
DOGRP25  DS    0H                                                  0656
*              OLDERID2 = NEWERID2;                                0656
         L     @01,GDTPTR                                          0656
         L     @15,GDTTR2(,@01)                                    0656
         MVC   @TS00001(95),NEWERID2(@15)                          0656
         MVC   OLDERID2(95,@15),@TS00001                           0656
*              NEWID2='RI05';                                      0657
*                                                                  0657
         MVC   NEWID2(4,@15),@CC00881                              0657
*              /******************************************************/
*              /*                                                    */
*              /* IF THE LENGTH OF THE EXTRACTED COMMAND VERB NAME IS*/
*              /* ZERO, THEN IT IS A NULL COMMAND.  IT IS THEN SIMPLY*/
*              /* BYPASSED AND SCANNING RESUMES IN SEARCH OF THE     */
*              /* NEXT FUNCTION COMMAND TO BE SCANNED.               */
*              /*                                                    */
*              /******************************************************/
*              IF UNITINDX=0 & NONMODAL=YES                        0658
*                THEN                                              0658
         LH    @15,UNITINDX                                        0658
         LTR   @15,@15                                             0658
         BNZ   @RF00658                                            0658
         TM    NONMODAL,B'10000000'                                0658
         BNO   @RF00658                                            0658
*                  DO;                                             0659
*                  NULLCMD=YES;                                    0660
         OI    NULLCMD,B'01000000'                                 0660
*                  NONMODAL=NO;                                    0661
*                                                                  0661
         NI    NONMODAL,B'01111111'                                0661
*                  CALL BYPASTRM;                                  0662
*                                                                  0662
         BAL   @14,BYPASTRM                                        0662
*                  SCANONLY=NO;                                    0663
         NI    SCANONLY,B'11101111'                                0663
*                  END;                                            0664
*                                                                  0664
*              /******************************************************/
*              /*                                                    */
*              /* IF A GOOD FUNCTION COMMAND HAS NOT BEEN FOUND YET, */
*              /* GET THE NEXT COMMAND VERB AND RESUME THE SCAN LOOP.*/
*              /*                                                    */
*              /******************************************************/
*              IF NONMODAL=NO  & GETVERB=YES                       0665
*                THEN                                              0665
@RF00658 TM    GETVERB,B'00000100'                                 0665
         BNO   @RF00665                                            0665
         TM    NONMODAL,B'10000000'                                0665
         BNZ   @RF00665                                            0665
*                  DO;                                             0666
*                                                                  0666
*                  CALL SCANSEP(YES);                              0667
         LA    @01,@AL00667                                        0667
         BAL   @14,SCANSEP                                         0667
*                  CALL NXTFIELD(VERBFLD);                         0668
         LA    @01,@AL00668                                        0668
         BAL   @14,NXTFIELD                                        0668
*                  CALL SCANSEP(NO);                               0669
*                                                                  0669
         LA    @01,@AL00669                                        0669
         BAL   @14,SCANSEP                                         0669
*                  END;                                            0670
*                ELSE                                              0671
*                                                                  0671
*                  /**************************************************/
*                  /*                                                */
*                  /* IF A NON-MODAL, NON-NULL COMMAND HAS BEEN FOUND*/
*                  /* THEN PICK IT UP AS THE FUNCTION COMMAND VERB   */
*                  /* NAME IF IT DOESN'T EXCEED MAX. VERB NAME LENGTH*/
*                  /*                                                */
*                  /**************************************************/
*                  IF UNITINDX <= VERBMAX                          0671
*                    THEN                                          0671
         B     @RC00665                                            0671
@RF00665 LH    @15,UNITINDX                                        0671
         CH    @15,@CH00042                                        0671
         BH    @RF00671                                            0671
*                      VERBNAME=SYNUNIT;                           0672
         MVC   VERBNAME(8),SYNUNIT                                 0672
*                    ELSE                                          0673
*                                                                  0673
*                      CALL ERROR2(BADVERB2,LENGTH(ERRFIELD),      0673
*                                  ADDR(ERRFIELD));                0673
*                                                                  0673
*                                                                  0673
         B     @RC00671                                            0673
@RF00671 MVC   @AL00001(8),@AL00673                                0673
         LA    @15,ERRFIELD                                        0673
         ST    @15,@AFTEMPS                                        0673
         LA    @15,@AFTEMPS                                        0673
         ST    @15,@AL00001+8                                      0673
         LA    @01,@AL00001                                        0673
         BAL   @14,ERROR2                                          0673
*              END DOGRP25;                                        0674
@RC00671 DS    0H                                                  0674
@RC00665 DS    0H                                                  0675
*        END DOLOOP10;                                             0675
@RF00654 DS    0H                                                  0675
@DE00580 TM    NONMODAL,B'10000000'                                0675
         BNZ   @DC00580                                            0675
         LH    @15,RISTATUS                                        0675
         LTR   @15,@15                                             0675
         BZ    @DL00580                                            0675
@DC00580 DS    0H                                                  0676
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - MODALSET                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS AND INTERPRETS THE PART OF THE    */
*/*             MODAL 'SET' COMMAND WHICH FOLLOWS THE VERB NAME      */
*/*             'SET'.  IF THE SYNTAX IS OKAY, THE PROVIDED NUMBER   */
*/*             IS ASSIGNED AS THE VALUE OF THE CONDITION CODE.      */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING IS    */
*/*                    CURRENTLY TAKING PLACE                        */
*/*          ELSEFLAG- FLAG SET 'ON' WHILE SCANNING ELSE-PATH        */
*/*                    COMMANDS AT CURRENT 'IF' NESTING LEVEL        */
*/*          SKIPFLAG- FLAG SET 'ON' WHILE SCANNING COMMAND(S) WHICH */
*/*                    IS NOT TO BE ENCODED INTO AN FDT & EXECUTED.  */
*/*          RISTATUS- STATUS CODE SET TO A NON-ZERO CODE WHEN ANY   */
*/*                    ERROR IS ENCOUNTERED.                         */
*/*          LASTCC -  LAST SYSTEM COND. CODE; MAY BE RESET BY 'SET' */
*/*                    COMMAND OR BY OCCURRENCE OF AN ERROR.         */
*/*          MAXCC -   MAXIMUM SYSTEM COND. CODE; MAY BE RESET BY    */
*/*                    'SET' COMMAND.                                */
*/*          SYNUNIT - ALL OR PART OF 'SET' COMMAND ASSIGNMENT       */
*/*                    EXPRESSION.                                   */
*/*          UNITINDX- LENGTH OF ABOVE SEGMENT OF ASSIGNMENT EXPR.   */
*/*          CNVRTWRD- CONVERTED DECIMAL NUMBER IN BINARY FORM FROM  */
*/*                    'SET' COMMAND ASSIGNMENT EXPRESSION.          */
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND FOLLOWS A */
*/*                    'THEN' OR 'ELSE'                              */
*/*          CHAR1 -   INPUT CHARACTER MOST RECENTLY EXTRACTED.      */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          SINGLCMD- SEE 'INPUT'                                   */
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING WILL  */
*/*                    BE DONE FOLLOWING THIS 'SET' COMMAND.         */
*/*          RISTATUS- SEE 'INPUT'                                   */
*/*          SYNUNIT - DECIMAL NUMBER FROM 'SET' COMMAND TO BE       */
*/*                    CONVERTED AND ASSIGNED AS THE COND. CODE VALUE*/
*/*          UNITINDX- LENGTH OF DECIMAL NUMBER (EBCDIC FORM)        */
*/*          LASTCC -  SEE 'INPUT'                                   */
*/*          MAXCC -   SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*MODALSET:PROCEDURE;                                               0676
         B     @PB00005                                            0676
MODALSET STM   @14,@12,@SA00005                                    0676
*        /************************************************************/
*        /*                                                          */
*        /*  ** MODALSET **  INTERPRET MODAL 'SET' COMMAND           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0677
*          THEN;                                                   0677
         L     @01,GDTPTR                                          0677
         L     @15,GDTDBG(,@01)                                    0677
         LTR   @15,@15                                             0677
         BZ    @RT00677                                            0677
*          ELSE                                                    0679
*            CALL ICKDB010(GDTTBL,'RIMS');                         0679
*                                                                  0679
         L     @15,GDTPTR                                          0679
         ST    @15,@AL00001                                        0679
         LA    @14,@CC00885                                        0679
         ST    @14,@AL00001+4                                      0679
         MVI   @AL00001+4,X'80'                                    0679
         L     @15,GDTDBG(,@15)                                    0679
         LA    @01,@AL00001                                        0679
         BALR  @14,@15                                             0679
*        /************************************************************/
*        /*                                                          */
*        /* EXTRACT THE ELEMENTS OF THE ASSIGNMENT EXPRESSION (THERE */
*        /* MAY OR MAY NOT BE DELIMITERS TO BE IGNORED SURROUNDING   */
*        /* THE EQUAL SIGN), CHECKING TO BE SURE THAT THE MAXIMUM    */
*        /* POSSIBLE LENGTH FOR SUCH AN EXPRESSION IS NOT EXCEEDED.  */
*        /*                                                          */
*        /************************************************************/
*        RELATION=BLANK;                                           0680
@RT00677 MVI   RELATION+1,C' '                                     0680
         MVC   RELATION+2(30),RELATION+1                           0680
         MVI   RELATION,C' '                                       0680
*        RELSIZE=0;                                                0681
         SLR   @15,@15                                             0681
         STH   @15,RELSIZE                                         0681
*        EXPREND=NO;                                               0682
         NI    EXPREND,B'11011111'                                 0682
*        DO WHILE(EXPREND=NO);                                     0683
*                                                                  0683
         B     @DE00683                                            0683
@DL00683 DS    0H                                                  0684
*          CALL NXTFIELD(VERBFLD);                                 0684
         LA    @01,@AL00684                                        0684
         BAL   @14,NXTFIELD                                        0684
*          CALL SCANSEP(NO);                                       0685
*                                                                  0685
         LA    @01,@AL00685                                        0685
         BAL   @14,SCANSEP                                         0685
*          IF RELSIZE+UNITINDX = 0                                0686
*             RELSIZE+UNITINDX > MAX(MAXCCLN,LSTCCLN)+2+LENGTH(MXDECNUM
*            THEN                                                  0686
         LH    @15,RELSIZE                                         0686
         AH    @15,UNITINDX                                        0686
         LTR   @15,@15                                             0686
         BZ    @RT00686                                            0686
         L     @01,GDTPTR                                          0686
         L     @01,GDTRIH(,@01)                                    0686
         L     @14,KWTBLPTR(,@01)                                  0686
         SLR   @05,@05                                             0686
         IC    @05,MAXCCLN(,@14)                                   0686
         SLR   @04,@04                                             0686
         IC    @04,LSTCCLN(,@14)                                   0686
         CR    @05,@04                                             0686
         BNL   *+6
         LR    @05,@04                                             0686
         AH    @05,@CH00038                                        0686
         CR    @15,@05                                             0686
         BNH   @RF00686                                            0686
@RT00686 DS    0H                                                  0687
*              RISTATUS=BADEXPR2;                                  0687
         MVC   RISTATUS(2),@CH00054                                0687
*            ELSE                                                  0688
*              DO;                                                 0688
         B     @RC00686                                            0688
@RF00686 DS    0H                                                  0689
*              RELATION(RELSIZE+1:RELSIZE+UNITINDX)=SYNUNIT;       0689
         LH    @15,RELSIZE                                         0689
         LA    @14,RELATION(@15)                                   0689
         LH    @05,UNITINDX                                        0689
         LR    @04,@05                                             0689
         BCTR  @04,0                                               0689
         EX    @04,@SM01324                                        0689
*              RELSIZE=RELSIZE+UNITINDX;                           0690
         ALR   @15,@05                                             0690
         STH   @15,RELSIZE                                         0690
*              END;                                                0691
*          IF RISTATUS^=0  CHAR1=ENDDELIM                         0692
*            THEN                                                  0692
@RC00686 LH    @15,RISTATUS                                        0692
         LTR   @15,@15                                             0692
         BNZ   @RT00692                                            0692
         CLI   CHAR1,C';'                                          0692
         BNE   @RF00692                                            0692
@RT00692 DS    0H                                                  0693
*              EXPREND=YES;                                        0693
         OI    EXPREND,B'00100000'                                 0693
*        END;                                                      0694
*                                                                  0694
@RF00692 DS    0H                                                  0694
@DE00683 TM    EXPREND,B'00100000'                                 0694
         BZ    @DL00683                                            0694
*        IF RISTATUS=0                                             0695
*          THEN                                                    0695
*                                                                  0695
         LH    @15,RISTATUS                                        0695
         LTR   @15,@15                                             0695
         BNZ   @RF00695                                            0695
*            /********************************************************/
*            /*                                                      */
*            /* INTERPRET THE ASSIGNMENT EXPRESSION AND ASSIGN THE   */
*            /* PROVIDED NUMBER AS THE VALUE OF THE LAST OR MAXIMUM  */
*            /* SYSTEM CONDITION CODE (WHICHEVER IS SPECIFIED IN THE */
*            /* ASSIGNMENT EXPRESSION.                               */
*            /*                                                      */
*            /********************************************************/
*DOGRP27:    DO;                                                   0696
DOGRP27  DS    0H                                                  0697
*            IF RELATION(1:MAXCCLN)=MAXCCSYM                       0697
*              THEN                                                0697
         L     @01,GDTPTR                                          0697
         L     @01,GDTRIH(,@01)                                    0697
         L     @15,KWTBLPTR(,@01)                                  0697
         SLR   @14,@14                                             0697
         IC    @14,MAXCCLN(,@15)                                   0697
         LR    @05,@14                                             0697
         BCTR  @05,0                                               0697
         EX    @05,@SC01326                                        0697
         BNE   @RF00697                                            0697
*                PART1LEN=MAXCCLN;                                 0698
         STH   @14,PART1LEN                                        0698
*              ELSE                                                0699
*                IF RELATION(1:LSTCCLN)=LSTCCSYM                   0699
*                  THEN                                            0699
         B     @RC00697                                            0699
@RF00697 L     @01,GDTPTR                                          0699
         L     @01,GDTRIH(,@01)                                    0699
         L     @15,KWTBLPTR(,@01)                                  0699
         SLR   @14,@14                                             0699
         IC    @14,LSTCCLN(,@15)                                   0699
         LR    @05,@14                                             0699
         BCTR  @05,0                                               0699
         EX    @05,@SC01328                                        0699
         BNE   @RF00699                                            0699
*                    PART1LEN=LSTCCLN;                             0700
         STH   @14,PART1LEN                                        0700
*                  ELSE                                            0701
*                    RISTATUS=BADEXPR2;                            0701
         B     @RC00699                                            0701
@RF00699 MVC   RISTATUS(2),@CH00054                                0701
*            IF RELATION(PART1LEN+1)=EQSIGN1                       0702
*              THEN                                                0702
@RC00699 DS    0H                                                  0702
@RC00697 LH    @15,PART1LEN                                        0702
         LA    @14,RELATION(@15)                                   0702
         CLI   0(@14),C'='                                         0702
         BNE   @RF00702                                            0702
*                PART1LEN=PART1LEN+1;                              0703
         LA    @15,1(,@15)                                         0703
         STH   @15,PART1LEN                                        0703
*              ELSE                                                0704
*                IF RELATION(PART1LEN+1:PART1LEN+2)=EQSIGN2        0704
*                  THEN                                            0704
         B     @RC00702                                            0704
@RF00702 LH    @15,PART1LEN                                        0704
         LA    @14,RELATION(@15)                                   0704
         CLC   0(2,@14),@CC00853                                   0704
         BNE   @RF00704                                            0704
*                    PART1LEN=PART1LEN+2;                          0705
         LA    @15,2(,@15)                                         0705
         STH   @15,PART1LEN                                        0705
*                  ELSE                                            0706
*                    RISTATUS=BADEXPR2;                            0706
         B     @RC00704                                            0706
@RF00704 MVC   RISTATUS(2),@CH00054                                0706
*            IF RISTATUS=0                                         0707
*              THEN                                                0707
*                                                                  0707
@RC00704 DS    0H                                                  0707
@RC00702 LH    @15,RISTATUS                                        0707
         LTR   @15,@15                                             0707
         BNZ   @RF00707                                            0707
*                /****************************************************/
*                /*                                                  */
*                /* IF A NUMBER HAS BEEN PROPERLY CODED, THEN        */
*                /* PLACE THE NUMBER INTO SYNUNIT IN PREPARATION FOR */
*                /* CONVERSION AND CONVERT THE NUMBER.               */
*                /*                                                  */
*                /****************************************************/
*                IF PART1LEN < RELSIZE                             0708
*                  THEN                                            0708
         LH    @15,PART1LEN                                        0708
         LH    @14,RELSIZE                                         0708
         CR    @15,@14                                             0708
         BNL   @RF00708                                            0708
*                    DO;                                           0709
*                    UNITINDX=RELSIZE-PART1LEN;                    0710
         SLR   @14,@15                                             0710
         STH   @14,UNITINDX                                        0710
*                    SYNUNIT=RELATION(PART1LEN+1:RELSIZE);         0711
*                                                                  0711
         MVI   SYNUNIT+1,C' '                                      0711
         MVC   SYNUNIT+2(253),SYNUNIT+1                            0711
         BCTR  @14,0                                               0711
         LA    @01,RELATION(@15)                                   0711
         EX    @14,@SM01330                                        0711
*                    CALL PACKCVB;                                 0712
*                                                                  0712
         BAL   @14,PACKCVB                                         0712
*                    IF RISTATUS^=0                                0713
*                      THEN                                        0713
         LH    @15,RISTATUS                                        0713
         LTR   @15,@15                                             0713
         BZ    @RF00713                                            0713
*                        RISTATUS=SKIPREST;                        0714
         MVC   RISTATUS(2),@CH00042                                0714
*                    END;                                          0715
*                  ELSE                                            0716
*                    RISTATUS=BADEXPR2;                            0716
         B     @RC00708                                            0716
@RF00708 MVC   RISTATUS(2),@CH00054                                0716
*            END DOGRP27;                                          0717
*                                                                  0717
@RC00708 DS    0H                                                  0717
@RF00707 DS    0H                                                  0718
*        /************************************************************/
*        /*                                                          */
*        /* IF NO ERROR HAS OCCURRED, ASSIGN THE PROVIDED VALUE AS   */
*        /* THE NEW VALUE OF THE SPECIFIED CONDITION CODE.           */
*        /* (HOWEVER, NEVER ASSIGN A VALUE HIGHER THAN 16).  IF THE  */
*        /* 'SET' COMMAND HAS UPDATED 'LASTCC', THEN 'MAXCC' MAY     */
*        /* ALSO HAVE TO BE UPDATED.                                 */
*        /*                                                          */
*        /************************************************************/
*        IF RISTATUS ^= 0                                          0718
*          THEN                                                    0718
@RF00695 LH    @15,RISTATUS                                        0718
         LTR   @15,@15                                             0718
         BZ    @RF00718                                            0718
*            LASTCC=TERMERR;                                       0719
         MVC   LASTCC(2),@CH00274                                  0719
*          ELSE                                                    0720
*            DO;                                                   0720
         B     @RC00718                                            0720
@RF00718 DS    0H                                                  0721
*            IF SKIPFLAG(NESTLVL)=OFF                              0721
*              THEN                                                0721
         L     @01,GDTPTR                                          0721
         L     @15,GDTRIH(,@01)                                    0721
         SLR   @14,@14                                             0721
         IC    @14,NESTLVL(,@15)                                   0721
         ALR   @14,@14                                             0721
         ALR   @14,@15                                             0721
         TM    SKIPFLAG-2(@14),B'00010000'                         0721
         BNZ   @RF00721                                            0721
*                IF RELATION(1:MAXCCLN)=MAXCCSYM                   0722
*                  THEN                                            0722
         L     @15,KWTBLPTR(,@15)                                  0722
         SLR   @14,@14                                             0722
         IC    @14,MAXCCLN(,@15)                                   0722
         BCTR  @14,0                                               0722
         EX    @14,@SC01326                                        0722
         BNE   @RF00722                                            0722
*                    MAXCC=MIN(TERMERR,CNVRTWRD);                  0723
         L     @15,CNVRTWRD                                        0723
         LA    @14,16                                              0723
         CR    @15,@14                                             0723
         BNH   *+6
         LR    @15,@14                                             0723
         STH   @15,MAXCC                                           0723
*                  ELSE                                            0724
*                    DO;                                           0724
         B     @RC00722                                            0724
@RF00722 DS    0H                                                  0725
*                    LASTCC=MIN(TERMERR,CNVRTWRD);                 0725
         L     @15,CNVRTWRD                                        0725
         LA    @14,16                                              0725
         CR    @15,@14                                             0725
         BNH   *+6
         LR    @15,@14                                             0725
         STH   @15,LASTCC                                          0725
*                    MAXCC=MAX(MAXCC,LASTCC);                      0726
         LH    @14,MAXCC                                           0726
         CR    @14,@15                                             0726
         BNL   *+6
         LR    @14,@15                                             0726
         STH   @14,MAXCC                                           0726
*                    END;                                          0727
*            IF MAXCC >= TERMERR                                   0728
*              THEN                                                0728
@RC00722 DS    0H                                                  0728
@RF00721 LH    @15,MAXCC                                           0728
         CH    @15,@CH00274                                        0728
         BL    @RF00728                                            0728
*                RISTATUS=SKIPREST;                                0729
         MVC   RISTATUS(2),@CH00042                                0729
*              ELSE                                                0730
*                                                                  0730
*                CALL BYPASTRM;                                    0730
*                                                                  0730
         B     @RC00728                                            0730
@RF00728 BAL   @14,BYPASTRM                                        0730
*            END;                                                  0731
*                                                                  0731
@RC00728 DS    0H                                                  0732
*        /************************************************************/
*        /*                                                          */
*        /* IF THIS 'SET' COMMAND IS A SINGLE COMMAND FOLLOWING AN   */
*        /* 'ELSE' COMMAND, THEN ADJUST THE 'IF' NESTING LEVEL ONE   */
*        /* LEVEL LESS DEEP.                                         */
*        /*                                                          */
*        /************************************************************/
*        IF SINGLCMD=YES                                           0732
*          THEN                                                    0732
@RC00718 TM    SINGLCMD,B'00010000'                                0732
         BNO   @RF00732                                            0732
*            DO;                                                   0733
*            SINGLCMD=NO;                                          0734
         NI    SINGLCMD,B'11101111'                                0734
*            IF ELSEFLAG(NESTLVL)=ON                               0735
*              THEN                                                0735
         L     @01,GDTPTR                                          0735
         L     @15,GDTRIH(,@01)                                    0735
         SLR   @14,@14                                             0735
         IC    @14,NESTLVL(,@15)                                   0735
         LR    @05,@14                                             0735
         ALR   @05,@05                                             0735
         ALR   @05,@15                                             0735
         TM    ELSEFLAG-2(@05),B'00100000'                         0735
         BNO   @RF00735                                            0735
*                NESTLVL=NESTLVL-1;                                0736
         BCTR  @14,0                                               0736
         STC   @14,NESTLVL(,@15)                                   0736
*            END;                                                  0737
*                                                                  0737
*        END MODALSET;                                             0738
@EL00005 DS    0H                                                  0738
@EF00005 DS    0H                                                  0738
@ER00005 LM    @14,@12,@SA00005                                    0738
         BR    @14                                                 0738
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - MODALIF                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS AND INTERPRETS THE PART OF THE    */
*/*             MODAL 'IF' COMMAND WHICH FOLLOWS THE VERB NAME 'IF'. */
*/*             IF THE SYNTAX OF THE RELATIONAL EXPRESSION TO BE     */
*/*             EVALUATED IS OKAY, THEN THE EVALUATION IS DONE TO    */
*/*             DETERMINE IF THE EXPRESSION IS TRUE OR FALSE. FLAGS  */
*/*             TO CONTROL SELECTION OF FUNCTION COMMANDS TO BE      */
*/*             EXECUTED ARE SET BASED UPON THE RESULT.  A CHECK IS  */
*/*             ALSO MADE TO SEE IF A DO-GROUP OR A NESTING 'IF'     */
*/*             COMMAND FOLLOWS THE 'THEN' KEYWORD.                  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING HAS   */
*/*                    TAKING PLACE PREVIOUS TO THIS 'IF' COMMAND    */
*/*          SKIPFLAG- FLAG SET 'ON' IF COMMANDS AT CURRENT LEVEL    */
*/*                    OF 'IF' NESTING ARE JUST BEING SCANNED FOR    */
*/*                    SYNTAX CHECKING.                              */
*/*          RISTATUS- INTERNAL STATUS CODE; SET TO NON-ZERO CODE    */
*/*                    WHEN ANY ERROR IS FOUND.                      */
*/*          SYNUNIT - ALL OR PART OF 'IF' COMMAND EXPRESSION.       */
*/*          UNITINDX- LENGTH OF ABOVE 'IF' COMMAND SEGMENT.         */
*/*          LASTCC -  CURRENT VALUE OF LAST SYSTEM COND. CODE       */
*/*          MAXCC -   CURRENT VALUE OF MAXIMUM SYSTEM COND. CODE    */
*/*          CNVRTWRD- VALUE (CONVERTED TO BINARY FORM) TAKEN FROM   */
*/*                    'IF' COMMAND RELATIONAL EXPRESSION TO BE      */
*/*                    COMPARTED TO THE CONDITION CODE VALUE         */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED FROM COMMAND.  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING IS    */
*/*                    TAKING PLACE AFTER THIS 'IF' COMMAND.         */
*/*          RISTATUS- SEE 'INPUT'                                   */
*/*          LASTCC -  SEE 'INPUT'                                   */
*/*          DOFLAG -  SET 'ON' WHEN SCANNING WITHIN A DO-GROUP AT   */
*/*                    THE CURRENT 'IF' NESTING LEVEL                */
*/*          THENFLAG- SET 'ON' WHEN 'THEN-PATH' COMMANDS ARE BEING  */
*/*                    SCANNED AT CURRENT 'IF' NESTING LEVEL         */
*/*          SKIPFLAG- SET 'ON' WHEN 'THEN-PATH' COMMANDS ARE ONLY TO*/
*/*                    BE SCANNED FOR CORRECT SYNTAX.                */
*/*          IFNEXT -  FLAG SET 'ON' WHEN AN 'IF' COMMAND FOLLOWS    */
*/*                    THE 'THEN' KEYWORD OF THE CURRENT 'IF' COMMAND*/
*/*          SYNUNIT - ALL OR PART OF 'IF' COMMAND RELATIONAL EXPR.  */
*/*          UNITINDX- LENGTH OF RELATIONAL EXPRESSION SEGMENT       */
*/*          GETVERB - FLAG SET 'ON' WHEN THE NEXT COMMAND VERB IS   */
*/*                    YET TO BE EXTRACTED.                          */
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND RATHER    */
*/*                    THAN A DO-GROUP FOLLOWS THE 'THEN' KEYWORD.   */
*/*                                                                  */
*/********************************************************************/
*MODALIF:PROCEDURE;                                                0739
MODALIF  STM   @14,@12,@SA00006                                    0739
*        /************************************************************/
*        /*                                                          */
*        /* DATA DEFINITIONS FOR INTERPRETING MODAL 'IF' COMMAND     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0740
*        DCL CCVALUE  FIXED(15);       /*SYSTEM CONDITION CODE VALUE */
*        DCL DIGITPOS FIXED(15);       /*POSITION WITHIN RELATIONAL
*                                        EXPRESSION WHERE NUMBER TO BE
*                                        COMPARED WITH THE CC APPEARS*/
*        DCL RELOPER  CHAR(2);         /*EXTRACTED RELATIONAL      0742
*                                        OPERATOR                    */
*                                                                  0742
*        DCL GTSIGN1  CHAR(1)          /*GREATER-THAN SIGN           */
*                     CONSTANT('>');                               0743
*        DCL GTSIGN2  CHAR(2)          /*GREATER-THAN SIGN           */
*                     CONSTANT('GT');                              0744
*        DCL LTSIGN1  CHAR(1)          /*LESS-THAN SIGN              */
*                     CONSTANT('<');                               0745
*        DCL LTSIGN2  CHAR(2)          /*LESS-THAN SIGN              */
*                     CONSTANT('LT');                              0746
*        DCL NESIGN1  CHAR(2)          /*NOT-EQUAL SIGN              */
*                     CONSTANT('^=');                              0747
*        DCL NESIGN2  CHAR(2)          /*NOT-EQUAL SIGN              */
*                     CONSTANT('NE');                              0748
*        DCL GESIGN1  CHAR(2)          /*GREATER-THAN-OR-EQUAL SIGN  */
*                     CONSTANT('>=');                              0749
*        DCL GESIGN2  CHAR(2)          /*GREATER-THAN-OR-EQUAL SIGN  */
*                     CONSTANT('GE');                              0750
*        DCL LESIGN1  CHAR(2)          /*LESS-THAN-OR-EQUAL SIGN     */
*                     CONSTANT('<=');                              0751
*        DCL LESIGN2  CHAR(2)          /*LESS-THAN-OR-EQUAL SIGN     */
*                     CONSTANT('LE');                              0752
*        /************************************************************/
*        /*                                                          */
*        /*  ** MODALIF **  INTERPRET THE MODAL 'IF' COMMAND         */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0753
*          THEN;                                                   0753
         L     @01,GDTPTR                                          0753
         L     @15,GDTDBG(,@01)                                    0753
         LTR   @15,@15                                             0753
         BZ    @RT00753                                            0753
*          ELSE                                                    0755
*            CALL ICKDB010(GDTTBL,'RIMI');                         0755
*                                                                  0755
         L     @15,GDTPTR                                          0755
         ST    @15,@AL00001                                        0755
         LA    @14,@CC00917                                        0755
         ST    @14,@AL00001+4                                      0755
         MVI   @AL00001+4,X'80'                                    0755
         L     @15,GDTDBG(,@15)                                    0755
         LA    @01,@AL00001                                        0755
         BALR  @14,@15                                             0755
*        /************************************************************/
*        /*                                                          */
*        /* NOTE THAT THIS 'IF' COMMAND MEANS ONE LEVEL DEEPER OF    */
*        /* 'IF' NESTING.                                            */
*        /*                                                          */
*        /************************************************************/
*        NESTLVL=NESTLVL+1;                                        0756
@RT00753 L     @01,GDTPTR                                          0756
         L     @15,GDTRIH(,@01)                                    0756
         LA    @14,1                                               0756
         MVC   @ZT00003+3(1),NESTLVL(@15)                          0756
         AL    @14,@ZT00003                                        0756
         STC   @14,NESTLVL(,@15)                                   0756
*        IF NESTLVL > IFNSTMX                                      0757
*          THEN                                                    0757
         CLI   NESTLVL(@15),10                                     0757
         BNH   @RF00757                                            0757
*            DO;                                                   0758
*            RISTATUS=BADIFNST;                                    0759
         MVC   RISTATUS(2),@CH00860                                0759
*            LASTCC=TERMERR;                                       0760
         MVC   LASTCC(2),@CH00274                                  0760
*            RETURN;                                               0761
@EL00006 DS    0H                                                  0761
@EF00006 DS    0H                                                  0761
@ER00006 LM    @14,@12,@SA00006                                    0761
         BR    @14                                                 0761
*            END;                                                  0762
*        MODLFLGS(NESTLVL)=''B;                                    0763
@RF00757 L     @01,GDTPTR                                          0763
         L     @15,GDTRIH(,@01)                                    0763
         SLR   @14,@14                                             0763
         IC    @14,NESTLVL(,@15)                                   0763
         ALR   @14,@14                                             0763
         ST    @14,@TF00001                                        0763
         ALR   @14,@15                                             0763
         XC    MODLFLGS-2(2,@14),MODLFLGS-2(@14)                   0763
*        THENFLAG(NESTLVL)=ON;                                     0764
         AL    @15,@TF00001                                        0764
         OI    THENFLAG-2(@15),B'01000000'                         0764
*        IFNEXT=NO;                                                0765
*                                                                  0765
         NI    IFNEXT,B'11110111'                                  0765
*        /************************************************************/
*        /*                                                          */
*        /* EXTRACT THE ELEMENTS OF THE RELATIONAL EXPRESSION THAT   */
*        /* FOLLOWS THE 'IF' VERB (THERE MAY OR MAY NOT BE DELIMITERS*/
*        /* SURROUNDING THE COMPARISON SIGN), CHECKING TO BE SURE    */
*        /* THAT THE MAXIMUM POSSIBLE LENGTH FOR SUCH AN EXPRESSION  */
*        /* IS NOT EXCEEDED.                                         */
*        /*                                                          */
*        /************************************************************/
*        RELATION=BLANK;                                           0766
         MVI   RELATION+1,C' '                                     0766
         MVC   RELATION+2(30),RELATION+1                           0766
         MVI   RELATION,C' '                                       0766
*        RELSIZE=0;                                                0767
         SLR   @15,@15                                             0767
         STH   @15,RELSIZE                                         0767
*        EXPREND=NO;                                               0768
         NI    EXPREND,B'11011111'                                 0768
*        DO WHILE(EXPREND=NO & RISTATUS=0);                        0769
*                                                                  0769
         B     @DE00769                                            0769
@DL00769 DS    0H                                                  0770
*          CALL NXTFIELD(VERBFLD);                                 0770
         LA    @01,@AL00770                                        0770
         BAL   @14,NXTFIELD                                        0770
*          CALL SCANSEP(NO);                                       0771
*                                                                  0771
         LA    @01,@AL00771                                        0771
         BAL   @14,SCANSEP                                         0771
*          IF RELSIZE+UNITINDX = 0                                0772
*             RELSIZE+UNITINDX > MAX(MAXCCLN,LSTCCLN)+2+LENGTH(MXDECNUM
*            THEN                                                  0772
         LH    @15,RELSIZE                                         0772
         AH    @15,UNITINDX                                        0772
         LTR   @15,@15                                             0772
         BZ    @RT00772                                            0772
         L     @01,GDTPTR                                          0772
         L     @01,GDTRIH(,@01)                                    0772
         L     @14,KWTBLPTR(,@01)                                  0772
         SLR   @05,@05                                             0772
         IC    @05,MAXCCLN(,@14)                                   0772
         SLR   @04,@04                                             0772
         IC    @04,LSTCCLN(,@14)                                   0772
         CR    @05,@04                                             0772
         BNL   *+6
         LR    @05,@04                                             0772
         AH    @05,@CH00038                                        0772
         CR    @15,@05                                             0772
         BNH   @RF00772                                            0772
@RT00772 DS    0H                                                  0773
*              RISTATUS=BADEXPR1;                                  0773
         MVC   RISTATUS(2),@CH00302                                0773
*            ELSE                                                  0774
*              DO;                                                 0774
         B     @RC00772                                            0774
@RF00772 DS    0H                                                  0775
*              RELATION(RELSIZE+1:RELSIZE+UNITINDX)=SYNUNIT;       0775
         LH    @15,RELSIZE                                         0775
         LA    @14,RELATION(@15)                                   0775
         LH    @05,UNITINDX                                        0775
         LR    @04,@05                                             0775
         BCTR  @04,0                                               0775
         EX    @04,@SM01324                                        0775
*              RELSIZE=RELSIZE+UNITINDX;                           0776
*                                                                  0776
         ALR   @15,@05                                             0776
         STH   @15,RELSIZE                                         0776
*              /******************************************************/
*              /*                                                    */
*              /* THE FINAL CHARACTER IN THE LAST EXPRESSION ELEMENT */
*              /* SHOULD ALWAYS BE A DECIMAL DIGIT; OTHERWISE, THE   */
*              /* RELATIONAL EXPRESSION IS IN ERROR.                 */
*              /*                                                    */
*              /******************************************************/
*              IF SYNUNIT(UNITINDX) >= '0' & SYNUNIT(UNITINDX) <= '9' 
*                 CHAR1=ENDDELIM                                   0777
*                THEN                                              0777
         LA    @04,SYNUNIT-1(@05)                                  0777
         CLI   0(@04),C'0'                                         0777
         BL    @GL00020                                            0777
         LA    @04,SYNUNIT-1(@05)                                  0777
         CLI   0(@04),C'9'                                         0777
         BNH   @RT00777                                            0777
@GL00020 CLI   CHAR1,C';'                                          0777
         BNE   @RF00777                                            0777
@RT00777 DS    0H                                                  0778
*                  EXPREND=YES;                                    0778
         OI    EXPREND,B'00100000'                                 0778
*              END;                                                0779
@RF00777 DS    0H                                                  0780
*        END;                                                      0780
@RC00772 DS    0H                                                  0780
@DE00769 TM    EXPREND,B'00100000'                                 0780
         BNZ   @DC00769                                            0780
         LH    @15,RISTATUS                                        0780
         LTR   @15,@15                                             0780
         BZ    @DL00769                                            0780
@DC00769 DS    0H                                                  0781
*        IF RISTATUS=0                                             0781
*          THEN                                                    0781
*                                                                  0781
         LH    @15,RISTATUS                                        0781
         LTR   @15,@15                                             0781
         BNZ   @RF00781                                            0781
*            /********************************************************/
*            /*                                                      */
*            /* DEPENDING UPON WHETHER THE EXPRESSION INVOLVES MAXCC */
*            /* OR LASTCC, OBTAIN THE CURRENT CONDITION CODE TO BE   */
*            /* USED IN THE COMPARISON.                              */
*            /*                                                      */
*            /********************************************************/
*            IF RELATION(1:MAXCCLN)=MAXCCSYM                       0782
*              THEN                                                0782
         L     @01,GDTPTR                                          0782
         L     @01,GDTRIH(,@01)                                    0782
         L     @15,KWTBLPTR(,@01)                                  0782
         SLR   @14,@14                                             0782
         IC    @14,MAXCCLN(,@15)                                   0782
         LR    @05,@14                                             0782
         BCTR  @05,0                                               0782
         EX    @05,@SC01326                                        0782
         BNE   @RF00782                                            0782
*                DO;                                               0783
*                CCVALUE=MAXCC;                                    0784
         MVC   CCVALUE(2),MAXCC                                    0784
*                PART1LEN=MAXCCLN;                                 0785
         STH   @14,PART1LEN                                        0785
*                END;                                              0786
*              ELSE                                                0787
*                IF RELATION(1:LSTCCLN)=LSTCCSYM                   0787
*                  THEN                                            0787
         B     @RC00782                                            0787
@RF00782 L     @01,GDTPTR                                          0787
         L     @01,GDTRIH(,@01)                                    0787
         L     @15,KWTBLPTR(,@01)                                  0787
         SLR   @14,@14                                             0787
         IC    @14,LSTCCLN(,@15)                                   0787
         LR    @05,@14                                             0787
         BCTR  @05,0                                               0787
         EX    @05,@SC01328                                        0787
         BNE   @RF00787                                            0787
*                    DO;                                           0788
*                    CCVALUE=LASTCC;                               0789
         MVC   CCVALUE(2),LASTCC                                   0789
*                    PART1LEN=LSTCCLN;                             0790
         STH   @14,PART1LEN                                        0790
*                    END;                                          0791
*                  ELSE                                            0792
*                    RISTATUS=BADEXPR1;                            0792
         B     @RC00787                                            0792
@RF00787 MVC   RISTATUS(2),@CH00302                                0792
*        IF RISTATUS=0                                             0793
*          THEN                                                    0793
@RC00787 DS    0H                                                  0793
@RC00782 DS    0H                                                  0793
@RF00781 LH    @15,RISTATUS                                        0793
         LTR   @15,@15                                             0793
         BNZ   @RF00793                                            0793
*DOGRP30:    DO;                                                   0794
*                                                                  0794
DOGRP30  DS    0H                                                  0795
*            /********************************************************/
*            /*                                                      */
*            /* SKIP PAST THE OPERATOR OF THE RELATIONAL EXPRESSION  */
*            /* AND CONVERT THE NUMBER TO WHICH THE CONDITION CODE   */
*            /* VALUE IS TO BE COMPARED.                             */
*            /*                                                      */
*            /********************************************************/
*            IF RELATION(PART1LEN+2) >= '0' &                      0795
*               RELATION(PART1LEN+2) <= '9'                        0795
*              THEN                                                0795
         LH    @15,PART1LEN                                        0795
         LA    @14,RELATION+1(@15)                                 0795
         CLI   0(@14),C'0'                                         0795
         BL    @RF00795                                            0795
         LA    @14,RELATION+1(@15)                                 0795
         CLI   0(@14),C'9'                                         0795
         BH    @RF00795                                            0795
*                DIGITPOS=PART1LEN+2;                              0796
         LA    @15,2(,@15)                                         0796
         STH   @15,DIGITPOS                                        0796
*              ELSE                                                0797
*                DIGITPOS=PART1LEN+3;                              0797
         B     @RC00795                                            0797
@RF00795 LH    @01,PART1LEN                                        0797
         LA    @01,3(,@01)                                         0797
         STH   @01,DIGITPOS                                        0797
*            IF DIGITPOS <= RELSIZE                                0798
*              THEN                                                0798
@RC00795 LH    @15,DIGITPOS                                        0798
         LH    @14,RELSIZE                                         0798
         CR    @15,@14                                             0798
         BH    @RF00798                                            0798
*                DO;                                               0799
*                UNITINDX=RELSIZE-DIGITPOS+1;                      0800
         SLR   @14,@15                                             0800
         LA    @01,1(,@14)                                         0800
         STH   @01,UNITINDX                                        0800
*                SYNUNIT=RELATION(DIGITPOS:RELSIZE);               0801
*                                                                  0801
         MVI   SYNUNIT+1,C' '                                      0801
         MVC   SYNUNIT+2(253),SYNUNIT+1                            0801
         LA    @01,RELATION-1(@15)                                 0801
         EX    @14,@SM01330                                        0801
*                CALL PACKCVB;                                     0802
*                                                                  0802
         BAL   @14,PACKCVB                                         0802
*                IF RISTATUS^=0                                    0803
*                  THEN                                            0803
         LH    @15,RISTATUS                                        0803
         LTR   @15,@15                                             0803
         BZ    @RF00803                                            0803
*                    RISTATUS=SKIPREST;                            0804
         MVC   RISTATUS(2),@CH00042                                0804
*                END;                                              0805
*              ELSE                                                0806
*                RISTATUS=BADEXPR1;                                0806
*                                                                  0806
         B     @RC00798                                            0806
@RF00798 MVC   RISTATUS(2),@CH00302                                0806
*            /********************************************************/
*            /*                                                      */
*            /* MATCH THE EXPRESSION'S OPERATOR WITH ONE OF THE      */
*            /* OPERATORS ALLOWED; THEN PERFORM THE INDICATED        */
*            /* COMPARISON BETWEEN THE CONDITION CODE & THE PROVIDED */
*            /* VALUE.  IF A MATCHING OPERATOR IS NOT FOUND, IT IS   */
*            /* AN ERROR.  IF THE COMPARISON IS FALSE, A FLAG IS SET */
*            /* TO SIGNAL THAT COMMANDS ASSOCIATED WITH THE 'THEN    */
*            /* PATH' ARE SIMPLY TO BE SCANNED FOR CORRECT SYNTAX.   */
*            /*                                                      */
*            /********************************************************/
*            RELOPER=RELATION(PART1LEN+1:DIGITPOS-1);              0807
@RC00798 MVI   RELOPER+1,C' '                                      0807
         LH    @15,PART1LEN                                        0807
         LH    @14,DIGITPOS                                        0807
         SLR   @14,@15                                             0807
         BCTR  @14,0                                               0807
         BCTR  @14,0                                               0807
         LA    @01,RELATION(@15)                                   0807
         EX    @14,@SM01332                                        0807
*            IF RELOPER=GESIGN1  RELOPER=GESIGN2                  0808
*              THEN                                                0808
         CLC   RELOPER(2),@CC00910                                 0808
         BE    @RT00808                                            0808
         CLC   RELOPER(2),@CC00912                                 0808
         BNE   @RF00808                                            0808
@RT00808 DS    0H                                                  0809
*                IF CCVALUE < CNVRTWRD                             0809
*                  THEN                                            0809
         LH    @15,CCVALUE                                         0809
         C     @15,CNVRTWRD                                        0809
         BNL   @RF00809                                            0809
*                    SKIPFLAG(NESTLVL)=ON;                         0810
         L     @01,GDTPTR                                          0810
         L     @15,GDTRIH(,@01)                                    0810
         SLR   @14,@14                                             0810
         IC    @14,NESTLVL(,@15)                                   0810
         ALR   @14,@14                                             0810
         ALR   @15,@14                                             0810
         OI    SKIPFLAG-2(@15),B'00010000'                         0810
*                  ELSE;                                           0811
@RF00809 DS    0H                                                  0812
*              ELSE                                                0812
*                IF RELOPER=LESIGN1  RELOPER=LESIGN2              0812
*                  THEN                                            0812
         B     @RC00808                                            0812
@RF00808 CLC   RELOPER(2),@CC00914                                 0812
         BE    @RT00812                                            0812
         CLC   RELOPER(2),@CC00916                                 0812
         BNE   @RF00812                                            0812
@RT00812 DS    0H                                                  0813
*                    IF CCVALUE > CNVRTWRD                         0813
*                      THEN                                        0813
         LH    @15,CCVALUE                                         0813
         C     @15,CNVRTWRD                                        0813
         BNH   @RF00813                                            0813
*                        SKIPFLAG(NESTLVL)=ON;                     0814
         L     @01,GDTPTR                                          0814
         L     @15,GDTRIH(,@01)                                    0814
         SLR   @14,@14                                             0814
         IC    @14,NESTLVL(,@15)                                   0814
         ALR   @14,@14                                             0814
         ALR   @15,@14                                             0814
         OI    SKIPFLAG-2(@15),B'00010000'                         0814
*                      ELSE;                                       0815
@RF00813 DS    0H                                                  0816
*                  ELSE                                            0816
*                    IF RELOPER=NESIGN1  RELOPER=NESIGN2          0816
*                      THEN                                        0816
         B     @RC00812                                            0816
@RF00812 CLC   RELOPER(2),@CC00906                                 0816
         BE    @RT00816                                            0816
         CLC   RELOPER(2),@CC00908                                 0816
         BNE   @RF00816                                            0816
@RT00816 DS    0H                                                  0817
*                        IF CCVALUE=CNVRTWRD                       0817
*                          THEN                                    0817
         LH    @15,CCVALUE                                         0817
         C     @15,CNVRTWRD                                        0817
         BNE   @RF00817                                            0817
*                            SKIPFLAG(NESTLVL)=ON;                 0818
         L     @01,GDTPTR                                          0818
         L     @15,GDTRIH(,@01)                                    0818
         SLR   @14,@14                                             0818
         IC    @14,NESTLVL(,@15)                                   0818
         ALR   @14,@14                                             0818
         ALR   @15,@14                                             0818
         OI    SKIPFLAG-2(@15),B'00010000'                         0818
*                          ELSE;                                   0819
@RF00817 DS    0H                                                  0820
*                      ELSE                                        0820
*                        IF RELOPER=GTSIGN1  RELOPER=GTSIGN2      0820
*                          THEN                                    0820
         B     @RC00816                                            0820
@RF00816 CLI   RELOPER,C'>'                                        0820
         BE    @RT00820                                            0820
         CLC   RELOPER(2),@CC00900                                 0820
         BNE   @RF00820                                            0820
@RT00820 DS    0H                                                  0821
*                            IF CCVALUE <= CNVRTWRD                0821
*                              THEN                                0821
         LH    @15,CCVALUE                                         0821
         C     @15,CNVRTWRD                                        0821
         BH    @RF00821                                            0821
*                                SKIPFLAG(NESTLVL)=ON;             0822
         L     @01,GDTPTR                                          0822
         L     @15,GDTRIH(,@01)                                    0822
         SLR   @14,@14                                             0822
         IC    @14,NESTLVL(,@15)                                   0822
         ALR   @14,@14                                             0822
         ALR   @15,@14                                             0822
         OI    SKIPFLAG-2(@15),B'00010000'                         0822
*                              ELSE;                               0823
@RF00821 DS    0H                                                  0824
*                          ELSE                                    0824
*                            IF RELOPER=LTSIGN1  RELOPER=LTSIGN2  0824
*                              THEN                                0824
         B     @RC00820                                            0824
@RF00820 CLI   RELOPER,C'<'                                        0824
         BE    @RT00824                                            0824
         CLC   RELOPER(2),@CC00904                                 0824
         BNE   @RF00824                                            0824
@RT00824 DS    0H                                                  0825
*                                IF CCVALUE >= CNVRTWRD            0825
*                                  THEN                            0825
         LH    @15,CCVALUE                                         0825
         C     @15,CNVRTWRD                                        0825
         BL    @RF00825                                            0825
*                                    SKIPFLAG(NESTLVL)=ON;         0826
         L     @01,GDTPTR                                          0826
         L     @15,GDTRIH(,@01)                                    0826
         SLR   @14,@14                                             0826
         IC    @14,NESTLVL(,@15)                                   0826
         ALR   @14,@14                                             0826
         ALR   @15,@14                                             0826
         OI    SKIPFLAG-2(@15),B'00010000'                         0826
*                                  ELSE;                           0827
@RF00825 DS    0H                                                  0828
*                              ELSE                                0828
*                                IF RELOPER=EQSIGN1  RELOPER=EQSIGN2
*                                  THEN                            0828
         B     @RC00824                                            0828
@RF00824 CLI   RELOPER,C'='                                        0828
         BE    @RT00828                                            0828
         CLC   RELOPER(2),@CC00853                                 0828
         BNE   @RF00828                                            0828
@RT00828 DS    0H                                                  0829
*                                    IF CCVALUE ^= CNVRTWRD        0829
*                                      THEN                        0829
         LH    @15,CCVALUE                                         0829
         C     @15,CNVRTWRD                                        0829
         BE    @RF00829                                            0829
*                                        SKIPFLAG(NESTLVL)=ON;     0830
         L     @01,GDTPTR                                          0830
         L     @15,GDTRIH(,@01)                                    0830
         SLR   @14,@14                                             0830
         IC    @14,NESTLVL(,@15)                                   0830
         ALR   @14,@14                                             0830
         ALR   @15,@14                                             0830
         OI    SKIPFLAG-2(@15),B'00010000'                         0830
*                                      ELSE;                       0831
@RF00829 DS    0H                                                  0832
*                                  ELSE                            0832
*                                    RISTATUS=BADEXPR1;            0832
*                                                                  0832
         B     @RC00828                                            0832
@RF00828 MVC   RISTATUS(2),@CH00302                                0832
*            /********************************************************/
*            /*                                                      */
*            /* IF THIS 'IF' COMMAND IS JUST BEING SCANNED FOR SYNTAX*/
*            /* CHECKING, THEN OVERRIDE THE RESULT OF THE RELATIONAL */
*            /* EXPRESSION EVALUATION AND NOTE THAT ALL COMMANDS AT  */
*            /* THIS DEEPER LEVEL ARE ALSO JUST TO BE SCANNED.       */
*            /*                                                      */
*            /********************************************************/
*            IF NESTLVL>1 & SKIPFLAG(NESTLVL-1)=ON                 0833
*              THEN                                                0833
@RC00828 DS    0H                                                  0833
@RC00824 DS    0H                                                  0833
@RC00820 DS    0H                                                  0833
@RC00816 DS    0H                                                  0833
@RC00812 DS    0H                                                  0833
@RC00808 L     @01,GDTPTR                                          0833
         L     @15,GDTRIH(,@01)                                    0833
         CLI   NESTLVL(@15),1                                      0833
         BNH   @RF00833                                            0833
         SLR   @14,@14                                             0833
         IC    @14,NESTLVL(,@15)                                   0833
         ALR   @14,@14                                             0833
         ST    @14,@TF00001                                        0833
         ALR   @14,@15                                             0833
         TM    SKIPFLAG-4(@14),B'00010000'                         0833
         BNO   @RF00833                                            0833
*                SKIPFLAG(NESTLVL)=ON;                             0834
*                                                                  0834
         AL    @15,@TF00001                                        0834
         OI    SKIPFLAG-2(@15),B'00010000'                         0834
*            END DOGRP30;                                          0835
@RF00833 DS    0H                                                  0836
*        IF RISTATUS=0                                             0836
*          THEN                                                    0836
@RF00793 LH    @15,RISTATUS                                        0836
         LTR   @15,@15                                             0836
         BNZ   @RF00836                                            0836
*DOGRP35:    DO;                                                   0837
*                                                                  0837
DOGRP35  DS    0H                                                  0838
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT THE FIELD WHICH FOLLOWS THE RELATIONAL       */
*            /* EXPRESSION AND MAKE SURE IT IS THE 'THEN' KEYWORD;   */
*            /* OTHERWISE, A SYNTAX ERROR HAS BEEN FOUND.            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0838
*            CALL NXTFIELD(VERBFLD);                               0838
         LA    @01,@AL00838                                        0838
         BAL   @14,NXTFIELD                                        0838
*            CALL SCANSEP(NO);                                     0839
*                                                                  0839
         LA    @01,@AL00839                                        0839
         BAL   @14,SCANSEP                                         0839
*            IF RISTATUS=0 & SYNUNIT=THENSYM                       0840
*              THEN                                                0840
*                                                                  0840
         LH    @15,RISTATUS                                        0840
         LTR   @15,@15                                             0840
         BNZ   @RF00840                                            0840
         L     @01,GDTPTR                                          0840
         L     @01,GDTRIH(,@01)                                    0840
         L     @01,KWTBLPTR(,@01)                                  0840
         CLC   SYNUNIT(9),THENSYM(@01)                             0840
         BNE   @RF00840                                            0840
*                /****************************************************/
*                /*                                                  */
*                /* IF THE COMMAND-END DELIMITER IMMEDIATELY FOLLOWS */
*                /* THE 'THEN' KEYWORD, THE 'THEN PATH' JUST CONSISTS*/
*                /* OF A NULL COMMAND.  THE DELIMITER IS SIMPLY      */
*                /* BYPASSED AND SCANNING CONTINUES.                 */
*                /*                                                  */
*                /****************************************************/
*                IF CHAR1=ENDDELIM                                 0841
*                  THEN                                            0841
*                                                                  0841
         CLI   CHAR1,C';'                                          0841
         BNE   @RF00841                                            0841
*                    CALL BYPASTRM;                                0842
*                                                                  0842
         BAL   @14,BYPASTRM                                        0842
*                  ELSE                                            0843
*                                                                  0843
*                    /************************************************/
*                    /*                                              */
*                    /* EXTRACT THE VERB NAME OF THE COMMAND WHICH   */
*                    /* FOLLOWS THE 'THEN' KEYWORD. IF IT IS A 'DO'  */
*                    /* COMMAND, SET THE FLAG THAT INDICATES THAT A  */
*                    /* 'DO GROUP' FOLLOWS AND SCAN UP TO THE NEXT   */
*                    /* COMMAND VERB NAME.  IF NOT A 'DO', NOTE THAT */
*                    /* THE NEXT COMMAND VERB NAME HAS ALREADY BEEN  */
*                    /* EXTRACTED.  IF THAT VERB NAME IS NOT 'IF',   */
*                    /* THEN A SINGLE COMMAND FOLLOWS THE 'THEN' AT  */
*                    /* THIS NESTING LEVEL.                          */
*                    /*                                              */
*                    /************************************************/
*                    DO;                                           0843
*                                                                  0843
         B     @RC00841                                            0843
@RF00841 DS    0H                                                  0844
*                    CALL NXTFIELD(VERBFLD);                       0844
         LA    @01,@AL00844                                        0844
         BAL   @14,NXTFIELD                                        0844
*                    CALL SCANSEP(NO);                             0845
*                                                                  0845
         LA    @01,@AL00845                                        0845
         BAL   @14,SCANSEP                                         0845
*                    IF RISTATUS=0 & SYNUNIT=DOSYM                 0846
*                      THEN                                        0846
         LH    @15,RISTATUS                                        0846
         LTR   @15,@15                                             0846
         BNZ   @RF00846                                            0846
         L     @01,GDTPTR                                          0846
         L     @01,GDTRIH(,@01)                                    0846
         L     @01,KWTBLPTR(,@01)                                  0846
         CLC   SYNUNIT(9),DOSYM(@01)                               0846
         BNE   @RF00846                                            0846
*                        DO;                                       0847
*                                                                  0847
*                        CALL BYPASTRM;                            0848
*                                                                  0848
         BAL   @14,BYPASTRM                                        0848
*                        DOFLAG(NESTLVL)=ON;                       0849
         L     @01,GDTPTR                                          0849
         L     @15,GDTRIH(,@01)                                    0849
         SLR   @14,@14                                             0849
         IC    @14,NESTLVL(,@15)                                   0849
         ALR   @14,@14                                             0849
         ALR   @15,@14                                             0849
         OI    DOFLAG-2(@15),B'10000000'                           0849
*                        END;                                      0850
*                      ELSE                                        0851
*                        DO;                                       0851
         B     @RC00846                                            0851
@RF00846 DS    0H                                                  0852
*                        GETVERB=NO;                               0852
         NI    GETVERB,B'11111011'                                 0852
*                        IF SYNUNIT ^= IFSYM                       0853
*                          THEN                                    0853
         L     @01,GDTPTR                                          0853
         L     @01,GDTRIH(,@01)                                    0853
         L     @01,KWTBLPTR(,@01)                                  0853
         CLC   SYNUNIT(9),IFSYM(@01)                               0853
         BE    @RF00853                                            0853
*                            SINGLCMD=YES;                         0854
         OI    SINGLCMD,B'00010000'                                0854
*                          ELSE                                    0855
*                            IFNEXT=YES;                           0855
         B     @RC00853                                            0855
@RF00853 OI    IFNEXT,B'00001000'                                  0855
*                        END;                                      0856
*                    END;                                          0857
*                                                                  0857
*              /******************************************************/
*              /*                                                    */
*              /* THE KEYWORD 'THEN' IS MISSING FROM 'IF' COMMAND    */
*              /* OR SOME OTHER ERROR HAS ALREADY OCCURRED.          */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                0858
*                IF RISTATUS=0                                     0858
*                  THEN                                            0858
         B     @RC00840                                            0858
@RF00840 LH    @15,RISTATUS                                        0858
         LTR   @15,@15                                             0858
         BNZ   @RF00858                                            0858
*                    DO;                                           0859
*                    LASTCC=TERMERR;                               0860
         MVC   LASTCC(2),@CH00274                                  0860
*                    RISTATUS=NOTHEN;                              0861
         MVC   RISTATUS(2),@CH00306                                0861
*                    END;                                          0862
*            END DOGRP35;                                          0863
@RF00858 DS    0H                                                  0863
@RC00840 DS    0H                                                  0864
*        IF RISTATUS ^= 0                                          0864
*          THEN                                                    0864
@RF00836 LH    @15,RISTATUS                                        0864
         LTR   @15,@15                                             0864
         BZ    @RF00864                                            0864
*            IF RISTATUS=EOFILE & EOFOK=YES                        0865
*              THEN;                                               0865
         CH    @15,@CH00118                                        0865
         BNE   @RF00865                                            0865
         TM    EOFOK,B'01000000'                                   0865
         BO    @RT00865                                            0865
*              ELSE                                                0867
*                LASTCC=TERMERR;                                   0867
*                                                                  0867
@RF00865 MVC   LASTCC(2),@CH00274                                  0867
*        END MODALIF;                                              0868
         B     @EL00006                                            0868
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - MODLELSE                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SETS UP TO SCAN AND INTERPRET WHAT      */
*/*             FOLLOWS THE 'ELSE' COMMAND.  APPROPRIATE CONTROL     */
*/*             FLAGS ARE SET AND A CHECK IS MADE TO SEE IF AN 'IF'  */
*/*             COMMAND OR A DO-GROUP FOLLOWS THE 'ELSE' COMMAND.    */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          SKIPFLAG- FLAG SET 'ON' WHEN COMMANDS ARE (HAVE BEEN)   */
*/*                    GETTING SCANNED FOR SYNTAX CHECKING ONLY.     */
*/*          NESTLVL - LEVEL OF 'IF' COMMAND NESTING AT WHICH        */
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */
*/*          CHAR1 -   CHARACTER MOST RECENTLY EXTRACTED.            */
*/*          SYNUNIT - SYNTACTIC UNIT MOST RECENTLY EXTRACTED.       */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          DOFLAG -  SET 'ON' WHEN SCANNING WITHIN A DO-GROUP AT   */
*/*                    CURRENT 'IF' NESTING LEVEL                    */
*/*          THENFLAG- SET 'ON' WHEN SCANNING 'THEN-PATH' COMMANDS   */
*/*                    AT CURRENT 'IF' NESTING LEVEL                 */
*/*          ELSEFLAG- SET 'ON' WHEN SCANNING 'ELSE-PATH' COMMANDS   */
*/*                    AT CURRENT 'IF' NESTING LEVEL                 */
*/*          SKIPFLAG- SEE 'INPUT'                                   */
*/*          NESTLVL - CURRENT LEVEL OF 'IF' COMMAND NESTING         */
*/*          IFNEXT -  FLAG SET 'ON' WHEN AN 'IF' COMMANDS FOLLOWS   */
*/*                    THE 'ELSE' COMMAND VERB                       */
*/*          GETVERB - FLAG SET 'ON' WHEN THE NEXT COMMAND VERB IS   */
*/*                    YET TO BE EXTRACTED AFTER THE 'ELSE' COMMAND. */
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND AS OPPOSED*/
*/*                    TO A DO-GROUP FOLLOWS THE 'ELSE' COMMAND.     */
*/*          LASTCC -  VALUE OF LAST SYSTEM CONDITION CODE; MAY BE   */
*/*                    RESET IF SYNTAX ERROR IS FOUND IN 'ELSE' CMD. */
*/*                                                                  */
*/********************************************************************/
*MODLELSE:PROCEDURE;                                               0869
MODLELSE STM   @14,@12,@SA00007                                    0869
*        /************************************************************/
*        /*                                                          */
*        /*  ** MODLELSE **  INTERPRET THE MODAL 'ELSE' COMMAND      */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0870
*          THEN;                                                   0870
         L     @01,GDTPTR                                          0870
         L     @15,GDTDBG(,@01)                                    0870
         LTR   @15,@15                                             0870
         BZ    @RT00870                                            0870
*          ELSE                                                    0872
*            CALL ICKDB010(GDTTBL,'RIME');                         0872
*                                                                  0872
         L     @15,GDTPTR                                          0872
         ST    @15,@AL00001                                        0872
         LA    @14,@CC00927                                        0872
         ST    @14,@AL00001+4                                      0872
         MVI   @AL00001+4,X'80'                                    0872
         L     @15,GDTDBG(,@15)                                    0872
         LA    @01,@AL00001                                        0872
         BALR  @14,@15                                             0872
*        THENFLAG(NESTLVL)=OFF;                                    0873
@RT00870 DS    0H                                                  0874
*        ELSEFLAG(NESTLVL)=ON;                                     0874
*                                                                  0874
         L     @01,GDTPTR                                          0874
         L     @15,GDTRIH(,@01)                                    0874
         SLR   @14,@14                                             0874
         IC    @14,NESTLVL(,@15)                                   0874
         ALR   @14,@14                                             0874
         ST    @14,@TF00001                                        0874
         ALR   @14,@15                                             0874
         OI    ELSEFLAG-2(@14),B'00100000'                         0874
         NI    THENFLAG-2(@14),B'10111111'                         0874
*        /************************************************************/
*        /*                                                          */
*        /* IF WHAT FOLLOWED THE MATCHING 'THEN' FOR THIS 'ELSE' WAS */
*        /* SCANNED ONLY (BECAUSE OF THE RESULT OF AN 'IF'           */
*        /* EXPRESSION), THEN SET THE FLAG TO INDICATE THAT A        */
*        /* FUNCTION COMMAND ASSOCIATED WITH THIS 'ELSE' MAY BE      */
*        /* ACCEPTED FOR EXECUTION.                                  */
*        /*                                                          */
*        /************************************************************/
*        IF SKIPFLAG(NESTLVL)=OFF                                  0875
*          THEN                                                    0875
         LR    @14,@15                                             0875
         AL    @14,@TF00001                                        0875
         TM    SKIPFLAG-2(@14),B'00010000'                         0875
         BNZ   @RF00875                                            0875
*            SKIPFLAG(NESTLVL)=ON;                                 0876
         AL    @15,@TF00001                                        0876
         OI    SKIPFLAG-2(@15),B'00010000'                         0876
*          ELSE                                                    0877
*            IF NESTLVL<=1  SKIPFLAG(NESTLVL-1)=OFF               0877
*              THEN                                                0877
         B     @RC00875                                            0877
@RF00875 L     @01,GDTPTR                                          0877
         L     @15,GDTRIH(,@01)                                    0877
         CLI   NESTLVL(@15),1                                      0877
         BNH   @RT00877                                            0877
         SLR   @14,@14                                             0877
         IC    @14,NESTLVL(,@15)                                   0877
         ALR   @14,@14                                             0877
         ALR   @15,@14                                             0877
         TM    SKIPFLAG-4(@15),B'00010000'                         0877
         BNZ   @RF00877                                            0877
@RT00877 DS    0H                                                  0878
*                SKIPFLAG(NESTLVL)=OFF;                            0878
*                                                                  0878
         L     @01,GDTPTR                                          0878
         L     @15,GDTRIH(,@01)                                    0878
         SLR   @14,@14                                             0878
         IC    @14,NESTLVL(,@15)                                   0878
         ALR   @14,@14                                             0878
         ALR   @15,@14                                             0878
         NI    SKIPFLAG-2(@15),B'11101111'                         0878
*        /************************************************************/
*        /*                                                          */
*        /* IF THE COMMAND-END DELIMITER IMMEDIATELY FOLLOWS THE     */
*        /* 'ELSE' KEYWORD, THE 'ELSE PATH' CONSISTS ONLY OF A NULL  */
*        /* COMMAND.  THE COMMAND-END DELIMITER IS THEN BYPASSED AND */
*        /* SCANNING CONTINUES.                                      */
*        /*                                                          */
*        /************************************************************/
*        IF CHAR1=ENDDELIM                                         0879
*          THEN                                                    0879
@RF00877 DS    0H                                                  0879
@RC00875 CLI   CHAR1,C';'                                          0879
         BNE   @RF00879                                            0879
*            DO;                                                   0880
*            NESTLVL=NESTLVL-1;                                    0881
*                                                                  0881
         L     @01,GDTPTR                                          0881
         L     @15,GDTRIH(,@01)                                    0881
         SLR   @14,@14                                             0881
         IC    @14,NESTLVL(,@15)                                   0881
         BCTR  @14,0                                               0881
         STC   @14,NESTLVL(,@15)                                   0881
*            CALL BYPASTRM;                                        0882
*                                                                  0882
         BAL   @14,BYPASTRM                                        0882
*            END;                                                  0883
*          ELSE                                                    0884
*                                                                  0884
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT THE VERB NAME OF THE COMMAND WHICH FOLLOWS   */
*            /* THE 'ELSE'.  IF IT IS A 'DO' COMMAND, SET THE FLAG   */
*            /* THAT INDICATES THAT A 'DO GROUP' FOLLOWS AND SCAN UP */
*            /* TO THE NEXT COMMAND VERB NAME.  IF NOT A 'DO', NOTE  */
*            /* THAT THE NEXT COMMAND VERB NAME HAS ALREADY BEEN     */
*            /* EXTRACTED.                                           */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0884
*                                                                  0884
         B     @RC00879                                            0884
@RF00879 DS    0H                                                  0885
*            CALL NXTFIELD(VERBFLD);                               0885
         LA    @01,@AL00885                                        0885
         BAL   @14,NXTFIELD                                        0885
*            CALL SCANSEP(NO);                                     0886
*                                                                  0886
         LA    @01,@AL00886                                        0886
         BAL   @14,SCANSEP                                         0886
*            IF SYNUNIT=DOSYM                                      0887
*              THEN                                                0887
         L     @01,GDTPTR                                          0887
         L     @01,GDTRIH(,@01)                                    0887
         L     @01,KWTBLPTR(,@01)                                  0887
         CLC   SYNUNIT(9),DOSYM(@01)                               0887
         BNE   @RF00887                                            0887
*                DO;                                               0888
*                                                                  0888
*                CALL BYPASTRM;                                    0889
*                                                                  0889
         BAL   @14,BYPASTRM                                        0889
*                DOFLAG(NESTLVL)=ON;                               0890
         L     @01,GDTPTR                                          0890
         L     @15,GDTRIH(,@01)                                    0890
         SLR   @14,@14                                             0890
         IC    @14,NESTLVL(,@15)                                   0890
         ALR   @14,@14                                             0890
         ALR   @15,@14                                             0890
         OI    DOFLAG-2(@15),B'10000000'                           0890
*                END;                                              0891
*              ELSE                                                0892
*                DO;                                               0892
         B     @RC00887                                            0892
@RF00887 DS    0H                                                  0893
*                GETVERB=NO;                                       0893
         NI    GETVERB,B'11111011'                                 0893
*                IF SYNUNIT^=IFSYM                                 0894
*                  THEN                                            0894
         L     @01,GDTPTR                                          0894
         L     @01,GDTRIH(,@01)                                    0894
         L     @01,KWTBLPTR(,@01)                                  0894
         CLC   SYNUNIT(9),IFSYM(@01)                               0894
         BE    @RF00894                                            0894
*                    SINGLCMD=YES;                                 0895
         OI    SINGLCMD,B'00010000'                                0895
*                  ELSE                                            0896
*                    IFNEXT=YES;                                   0896
         B     @RC00894                                            0896
@RF00894 OI    IFNEXT,B'00001000'                                  0896
*                END;                                              0897
@RC00894 DS    0H                                                  0898
*            END;                                                  0898
*                                                                  0898
@RC00887 DS    0H                                                  0899
*        IF RISTATUS ^= 0                                          0899
*          THEN                                                    0899
@RC00879 LH    @15,RISTATUS                                        0899
         LTR   @15,@15                                             0899
         BZ    @RF00899                                            0899
*            IF RISTATUS=EOFILE & EOFOK=YES                        0900
*              THEN;                                               0900
         CH    @15,@CH00118                                        0900
         BNE   @RF00900                                            0900
         TM    EOFOK,B'01000000'                                   0900
         BO    @RT00900                                            0900
*              ELSE                                                0902
*                LASTCC=TERMERR;                                   0902
*                                                                  0902
@RF00900 MVC   LASTCC(2),@CH00274                                  0902
*        END MODLELSE;                                             0903
@EL00007 DS    0H                                                  0903
@EF00007 DS    0H                                                  0903
@ER00007 LM    @14,@12,@SA00007                                    0903
         BR    @14                                                 0903
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - BYPASTRM                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE BYPASSES THE COMMAND-END DELIMITER THAT */
*/*             FOLLOWS A MODAL COMMAND OR INDICATES A NULL COMMAND  */
*/*             AND ALSO SCANS PAST RECORDS WHICH FOLLOW THIS RECORD */
*/*             IF CONTINUATION DELIMITERS ARE FOUND.  UPON EXIT FROM*/
*/*             BYPASTRM, THE SCAN POINTS TO THE FIRST CHARACTER OF  */
*/*             THE NEXT COMMAND VERB NAME.                          */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER FROM THE    */
*/*                    INPUT STREAM (SHOULD BE A SEMICOLON)          */
*/*          MORTOCOM- FLAG SET 'ON' WHEN THE CURRENT RECORD IS      */
*/*                    CONTINUED ON TO THE NEXT RECORD.              */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          EOFOK -   FLAG SET 'ON' WHEN END-OF-FILE MAY CORRECTLY  */
*/*                    ENCOUNTERED ON THE COMMAND INPUT STREAM.      */
*/*          FIRSTCHR- FLAG SET 'ON' WHEN THE FIRST CHARACTER OF A   */
*/*                    NEW RECORD IS TO BE OBTAINED NEXT.            */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE IF END-OF-FILE IS FOUND WHILE SCANNING   */
*/*                    UP TO THE NEXT COMMAND'S VERB NAME.           */
*/*                                                                  */
*/********************************************************************/
*BYPASTRM:PROCEDURE;                                               0904
BYPASTRM STM   @14,@12,@SA00008                                    0904
*        /************************************************************/
*        /*                                                          */
*        /*  ** BYPASTRM **  BYPASS COMMAND-ENDING DELIMITER         */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0905
*          THEN;                                                   0905
         L     @01,GDTPTR                                          0905
         L     @15,GDTDBG(,@01)                                    0905
         LTR   @15,@15                                             0905
         BZ    @RT00905                                            0905
*          ELSE                                                    0907
*            CALL ICKDB010(GDTTBL,'RIBT');                         0907
*                                                                  0907
         L     @15,GDTPTR                                          0907
         ST    @15,@AL00001                                        0907
         LA    @14,@CC00931                                        0907
         ST    @14,@AL00001+4                                      0907
         MVI   @AL00001+4,X'80'                                    0907
         L     @15,GDTDBG(,@15)                                    0907
         LA    @01,@AL00001                                        0907
         BALR  @14,@15                                             0907
*        DO WHILE(MORTOCOM=YES & RISTATUS=0);                      0908
*                                                                  0908
@RT00905 B     @DE00908                                            0908
@DL00908 DS    0H                                                  0909
*          CALL NEXTCHAR;                                          0909
         BAL   @14,NEXTCHAR                                        0909
*          CALL SKIPCMD;                                           0910
*                                                                  0910
         BAL   @14,SKIPCMD                                         0910
*        END;                                                      0911
@DE00908 TM    MORTOCOM,B'00010000'                                0911
         BNO   @DC00908                                            0911
         LH    @15,RISTATUS                                        0911
         LTR   @15,@15                                             0911
         BZ    @DL00908                                            0911
@DC00908 DS    0H                                                  0912
*        IF RISTATUS=0                                             0912
*          THEN                                                    0912
         LH    @15,RISTATUS                                        0912
         LTR   @15,@15                                             0912
         BNZ   @RF00912                                            0912
*            DO;                                                   0913
*            EOFOK=YES;                                            0914
         OI    EOFOK,B'01000000'                                   0914
*            FIRSTCHR=YES;                                         0915
         OI    FIRSTCHR,B'00000100'                                0915
*            CHAR1=BLANK;                                          0916
*                                                                  0916
         MVI   CHAR1,C' '                                          0916
*            CALL SCANSEP(NO);                                     0917
*                                                                  0917
         LA    @01,@AL00917                                        0917
         BAL   @14,SCANSEP                                         0917
*            END;                                                  0918
*        END BYPASTRM;                                             0919
*                                                                  0919
*                                                                  0919
@EL00008 DS    0H                                                  0919
@EF00008 DS    0H                                                  0919
@ER00008 LM    @14,@12,@SA00008                                    0919
         BR    @14                                                 0919
*        END GETNEXT;                                              0920
@EL00004 DS    0H                                                  0920
@EF00004 DS    0H                                                  0920
@ER00004 LM    @14,@12,@SA00004                                    0920
         BR    @14                                                 0920
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - KWDPARM                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS A KEYWORD AND THEN SEARCHES THE*/
*/*             COMMAND DESCRIPTOR FOR A MATCH.  THEN, USING THE     */
*/*             PARAMETER DESCRIPTION, THE ROUTINE SETS UP TO EXTRACT*/
*/*             THIS PARAMETER'S SUBPARAMETERS OR DATA IF EITHER     */
*/*             EXISTS.                                              */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR FUNCTION COMMAND BEING SCANNED.  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR HAS OCCURRED.             */
*/*          SUPERID - PARAMETER ID# OF PARAMETER WHOSE SUBPARAMETER */
*/*                    LIST IS CURRENTLY BEING SCANNED (ID#=0 IF     */
*/*                    FIRST-LEVEL PARM'S. ARE NOW BEING SCANNED).   */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*          SYNUNIT - CONTAINS THE KEYWORD JUST EXTRACTED           */
*/*          UNITINDX- LENGTH OF KEYWORD JUST EXTRACTED.             */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER             */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARAMETER LIST NESTING   */
*/*                    AT WHICH SCANNING IS CURRENTLY TAKING PLACE.  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          JUSTONE - FLAG SET 'ON' WHEN A SINGLE SCALAR LIST ITEM  */
*/*                    HAS BEEN CODED FOR A PARAMETER                */
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING HANDLED.     */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING WILL TAKE PLACE AFTER THIS KEYWORD.  */
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */
*/*                    CURRENT SUBPARAMETER LIST.                    */
*/*          SUPERID - SEE 'INPUT'                                   */
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST ONE SUBPARAMETER  */
*/*                    HAS BEEN FOUND IN THE CURRENT SUBLIST.        */
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */
*/*                    WHICH SCANNING WILL TAKE PLACE FOLLOWING THIS */
*/*                    KEYWORD.                                      */
*/*          REPCOUNT- NUMBER OF REPEATED SUBLISTS FOUND AT CURRENT  */
*/*                    REPEATED SUBLIST LEVEL.                       */
*/*          REPLIMIT- MAXIMUM NUMBER OF REPEATED SUBLISTS ALLOWED   */
*/*                    AT CURRENT LEVEL.                             */
*/*          ARRYPTR - POINTER TO INTERMEDIATE POINTER VECTOR WHICH  */
*/*                    CONTAINS PTRS TO DATA STRUCTURES FOR CURRENT  */
*/*                    KEYWORD PARAMETER                             */
*/*                                                                  */
*/********************************************************************/
*KWDPARM:PROCEDURE;                                                0921
KWDPARM  STM   @14,@12,@SA00009                                    0921
*        /************************************************************/
*        /*                                                          */
*        /* KWDPARM PROCEDURE DATA DECLARATIONS                      */
*        /*                                                          */
*        /************************************************************/
*        DCL SUBTOTAL FIXED(15);       /*COUNT OF SUBPARAMETERS OF 0922
*                                        CURRENT PARAMETER           */
*        DCL WORKVAR1 FIXED(15);       /*VARIABLE TO CONTAIN         */
*                                      /*A TEMPORARY VALUE           */
*        DCL KWDMATCH BIT(1);          /*SIGNALS THAT A MATCHING   0924
*                                        KEYWORD HAS BEEN FOUND      */
*                                                                  0924
*        /*STATIC ERROR MESSAGE CODES                                */
*        DCL BADELIM2 FIXED(31)        /*LEFT PARENTHESIS MISSING    */
*                     CONSTANT(9);                                 0925
*        /************************************************************/
*        /*                                                          */
*        /*  ** KWDPARM **  EXTRACT A KEYWORD PARAMETER              */
*        /*                                                          */
*        /************************************************************/
*        KWDMATCH=NO;                                              0926
         NI    KWDMATCH,B'01111111'                                0926
*        JUSTONE=NO;                                               0927
         NI    JUSTONE,B'11111110'                                 0927
*        ENDPAREN=YES;                                             0928
*                                                                  0928
         OI    ENDPAREN,B'10000000'                                0928
*        /************************************************************/
*        /*                                                          */
*        /* EXTRACT THE KEYWORD, CHECKING THAT IT DOESN'T EXCEED     */
*        /* KEYWORD LENGTH LIMIT.                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0929
*        CALL NXTFIELD(KEYWORD);                                   0929
*                                                                  0929
         LA    @01,@AL00929                                        0929
         BAL   @14,NXTFIELD                                        0929
*        IF RISTATUS=0                                             0930
*          THEN                                                    0930
*                                                                  0930
         LH    @15,RISTATUS                                        0930
         LTR   @15,@15                                             0930
         BNZ   @RF00930                                            0930
*            /********************************************************/
*            /*                                                      */
*            /* SCAN KEYWORD DESCRIPTIONS IN THE COMMAND DESCRIPTOR, */
*            /* SEARCHING FOR A MATCH WITH THE EXTRACTED KEYWORD     */
*            /*                                                      */
*            /********************************************************/
*DOGRP40:    DO;                                                   0931
DOGRP40  DS    0H                                                  0932
*            IF SUPERID(PARMLVL)=0                                 0932
*              THEN                                                0932
*                                                                  0932
         LH    @15,PARMLVL                                         0932
         ALR   @15,@15                                             0932
         LH    @15,SUPERID-2(@15)                                  0932
         LTR   @15,@15                                             0932
         BNZ   @RF00932                                            0932
*                /****************************************************/
*                /*                                                  */
*                /* WHEN CURRENTLY SCANNING FIRST-LEVEL PARAMETERS,  */
*                /* CHECK DESCRIPTION OF EVERY FIRST-LEVEL PARAMETER */
*                /* FOR A KEYWORD NAME MATCH.                        */
*                /*                                                  */
*                /****************************************************/
*                DO INDEX=1 TO MAXID WHILE(KWDMATCH=NO);           0933
         LA    @15,1                                               0933
         B     @DE00933                                            0933
@DL00933 TM    KWDMATCH,B'10000000'                                0933
         BNZ   @DC00933                                            0933
*                  IF PARMPTR(INDEX)^=0                            0934
*                    THEN                                          0934
         L     @14,WORKPTR                                         0934
         LA    @05,12                                              0934
         LR    @01,@15                                             0934
         MR    @00,@05                                             0934
         AL    @01,@CF01317                                        0934
         L     @04,PARMPTR(@01,@14)                                0934
         LTR   @04,@04                                             0934
         BZ    @RF00934                                            0934
*                      DO;                                         0935
*                      PARMID=INDEX;                               0936
         STH   @15,PARMID                                          0936
*                      IF LEVEL1=YES & KWDDSPL^=0                  0937
*                        THEN                                      0937
         ST    @14,@TF00001                                        0937
         MR    @14,@05                                             0937
         L     @01,@TF00001                                        0937
         AL    @01,@CF01317                                        0937
         L     @15,PARMPTR(@15,@01)                                0937
         TM    LEVEL1(@15),B'01000000'                             0937
         BNO   @RF00937                                            0937
         CLI   KWDDSPL(@15),0                                      0937
         BE    @RF00937                                            0937
*                          DO;                                     0938
*                            KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);
         LA    @14,1                                               0939
         SLR   @05,@05                                             0939
         IC    @05,KWDDSPL(,@15)                                   0939
         ALR   @05,@05                                             0939
         ALR   @15,@05                                             0939
         ALR   @15,@14                                             0939
         ST    @15,KWDPTR                                          0939
*                            DO LISTINDX=1 TO KWDCOUNT             0940
*                                      WHILE(KWDMATCH=NO);         0940
         B     @DE00940                                            0940
@DL00940 TM    KWDMATCH,B'10000000'                                0940
         BNZ   @DC00940                                            0940
*                              IF UNITINDX=KWDLEN &                0941
*                                 KWDITEM(1:KWDLEN) = SYNUNIT(1:KWDLEN)
*                                THEN                              0941
         L     @15,KWDPTR                                          0941
         SLR   @14,@14                                             0941
         IC    @14,KWDLEN(,@15)                                    0941
         CH    @14,UNITINDX                                        0941
         BNE   @RF00941                                            0941
         BCTR  @14,0                                               0941
         EX    @14,@SC01338                                        0941
         BNE   @RF00941                                            0941
*                                  KWDMATCH=YES;                   0942
         OI    KWDMATCH,B'10000000'                                0942
*                                ELSE                              0943
*                                  KWDPTR=KWDPTR+KWDLEN+LENGTH(KWDLEN);
         B     @RC00941                                            0943
@RF00941 L     @15,KWDPTR                                          0943
         SLR   @14,@14                                             0943
         IC    @14,KWDLEN(,@15)                                    0943
         ALR   @14,@15                                             0943
         AL    @14,@CF00172                                        0943
         ST    @14,KWDPTR                                          0943
*                            END;                                  0944
@RC00941 LA    @14,1                                               0944
         AH    @14,LISTINDX                                        0944
@DE00940 STH   @14,LISTINDX                                        0944
         LH    @15,PARMID                                          0944
         MH    @15,@CH00038                                        0944
         LH    @05,PARMID                                          0944
         MH    @05,@CH00038                                        0944
         L     @01,WORKPTR                                         0944
         AL    @01,@CF01317                                        0944
         L     @01,PARMPTR(@05,@01)                                0944
         SLR   @05,@05                                             0944
         IC    @05,KWDDSPL(,@01)                                   0944
         ALR   @05,@05                                             0944
         L     @04,WORKPTR                                         0944
         AL    @04,@CF01317                                        0944
         AL    @05,PARMPTR(@15,@04)                                0944
         MVC   @ZT00003+3(1),KWDCOUNT(@05)                         0944
         C     @14,@ZT00003                                        0944
         BNH   @DL00940                                            0944
@DC00940 DS    0H                                                  0945
*                          END;                                    0945
*                      END;                                        0946
@RF00937 DS    0H                                                  0947
*                END;                                              0947
@RF00934 LA    @15,1                                               0947
         AH    @15,INDEX                                           0947
@DE00933 STH   @15,INDEX                                           0947
         L     @14,DESCPTR                                         0947
         CH    @15,MAXID(,@14)                                     0947
         BNH   @DL00933                                            0947
@DC00933 DS    0H                                                  0948
*              ELSE                                                0948
*                                                                  0948
*                /****************************************************/
*                /*                                                  */
*                /*  WHEN SCANNING A SUBPARAMETER LIST, CHECK FOR A  */
*                /*  KEYWORD MATCH AMONG THE POSSIBLE SUBPARAMETERS  */
*                /*  OF THE CURRENT SUPERPARAMETER.                  */
*                /*                                                  */
*                /****************************************************/
*                DO;                                               0948
         B     @RC00932                                            0948
@RF00932 DS    0H                                                  0949
*                  OLDERID2 = NEWERID2;                            0949
         L     @01,GDTPTR                                          0949
         L     @15,GDTTR2(,@01)                                    0949
         MVC   @TS00001(95),NEWERID2(@15)                          0949
         MVC   OLDERID2(95,@15),@TS00001                           0949
*                  NEWID2='RI09';                                  0950
         MVC   NEWID2(4,@15),@CC00941                              0950
*                  SUBTOTAL=SUBCOUNT;                              0951
         LA    @15,12                                              0951
         LR    @14,@15                                             0951
         MH    @14,PARMID                                          0951
         L     @01,WORKPTR                                         0951
         AL    @01,@CF01317                                        0951
         L     @14,PARMPTR(@14,@01)                                0951
         ALR   @15,@14                                             0951
         SLR   @05,@05                                             0951
         IC    @05,SUBDSPL(,@15)                                   0951
         ALR   @05,@05                                             0951
         ALR   @14,@05                                             0951
         MVC   SUBTOTAL(2),SUBCOUNT(@14)                           0951
*                  DO INDEX=1 TO SUBTOTAL WHILE(KWDMATCH=NO);      0952
         LA    @15,1                                               0952
         B     @DE00952                                            0952
@DL00952 TM    KWDMATCH,B'10000000'                                0952
         BNZ   @DC00952                                            0952
*                    PARMID=SUBID(INDEX);                          0953
         SLA   @15,2                                               0953
         L     @14,WORKPTR                                         0953
         LA    @05,12                                              0953
         LR    @04,@05                                             0953
         MH    @04,PARMID                                          0953
         AL    @04,@CF01317                                        0953
         L     @04,PARMPTR(@04,@14)                                0953
         LR    @03,@04                                             0953
         ALR   @03,@05                                             0953
         SLR   @02,@02                                             0953
         IC    @02,SUBDSPL(,@03)                                   0953
         ALR   @02,@02                                             0953
         ALR   @04,@02                                             0953
         LH    @15,SUBID-4(@15,@04)                                0953
         STH   @15,PARMID                                          0953
*                    IF KWDDSPL ^= 0                               0954
*                      THEN                                        0954
         ST    @14,@TF00001                                        0954
         MR    @14,@05                                             0954
         L     @01,@TF00001                                        0954
         AL    @01,@CF01317                                        0954
         L     @15,PARMPTR(@15,@01)                                0954
         CLI   KWDDSPL(@15),0                                      0954
         BE    @RF00954                                            0954
*                        DO;                                       0955
*                          KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT); 0956
         LA    @14,1                                               0956
         SLR   @05,@05                                             0956
         IC    @05,KWDDSPL(,@15)                                   0956
         ALR   @05,@05                                             0956
         ALR   @15,@05                                             0956
         LR    @05,@15                                             0956
         ALR   @05,@14                                             0956
         ST    @05,KWDPTR                                          0956
*                          WORKVAR1=KWDCOUNT;                      0957
         SLR   @05,@05                                             0957
         IC    @05,KWDCOUNT(,@15)                                  0957
         STH   @05,WORKVAR1                                        0957
*                          DO LISTINDX=1 TO WORKVAR1               0958
*                                      WHILE(KWDMATCH=NO);         0958
         B     @DE00958                                            0958
@DL00958 TM    KWDMATCH,B'10000000'                                0958
         BNZ   @DC00958                                            0958
*                            IF UNITINDX=KWDLEN &                  0959
*                               KWDITEM(1:KWDLEN)=SYNUNIT(1:KWDLEN)
*                              THEN                                0959
         L     @15,KWDPTR                                          0959
         SLR   @14,@14                                             0959
         IC    @14,KWDLEN(,@15)                                    0959
         CH    @14,UNITINDX                                        0959
         BNE   @RF00959                                            0959
         BCTR  @14,0                                               0959
         EX    @14,@SC01338                                        0959
         BNE   @RF00959                                            0959
*                                KWDMATCH=YES;                     0960
         OI    KWDMATCH,B'10000000'                                0960
*                              ELSE                                0961
*                                KWDPTR=KWDPTR+KWDLEN+LENGTH(KWDLEN);
         B     @RC00959                                            0961
@RF00959 L     @15,KWDPTR                                          0961
         SLR   @14,@14                                             0961
         IC    @14,KWDLEN(,@15)                                    0961
         ALR   @14,@15                                             0961
         AL    @14,@CF00172                                        0961
         ST    @14,KWDPTR                                          0961
*                          END;                                    0962
@RC00959 LA    @14,1                                               0962
         AH    @14,LISTINDX                                        0962
@DE00958 STH   @14,LISTINDX                                        0962
         CH    @14,WORKVAR1                                        0962
         BNH   @DL00958                                            0962
@DC00958 DS    0H                                                  0963
*                        END;                                      0963
*                    IF KWDMATCH=NO                                0964
*                      THEN                                        0964
@RF00954 TM    KWDMATCH,B'10000000'                                0964
         BNZ   @RF00964                                            0964
*                        PARMID=SUPERID(PARMLVL);                  0965
         LH    @15,PARMLVL                                         0965
         ALR   @15,@15                                             0965
         LH    @15,SUPERID-2(@15)                                  0965
         STH   @15,PARMID                                          0965
*                  END;                                            0966
@RF00964 LA    @15,1                                               0966
         AH    @15,INDEX                                           0966
@DE00952 STH   @15,INDEX                                           0966
         CH    @15,SUBTOTAL                                        0966
         BNH   @DL00952                                            0966
@DC00952 DS    0H                                                  0967
*                END;                                              0967
*                                                                  0967
*            /********************************************************/
*            /*                                                      */
*            /* IF A MATCHING KEYWORD WAS FOUND, SET A FLAG NOTING   */
*            /* THIS KEYWORD PARAMETER ID#, AND THEN USE THE KEYWORD */
*            /* DESCRIPTOR DATA TO CONTROL SCANNING OF THE REMAINDER */
*            /* OF THE PARAMETER                                     */
*            /*                                                      */
*            /********************************************************/
*            IF KWDMATCH=YES                                       0968
*              THEN                                                0968
@RC00932 TM    KWDMATCH,B'10000000'                                0968
         BNO   @RF00968                                            0968
*DOGRP45:        DO;                                               0969
*                                                                  0969
DOGRP45  DS    0H                                                  0970
*                CALL SETFLAG;                                     0970
*                                                                  0970
         BAL   @14,SETFLAG                                         0970
*                IF RISTATUS ^= 0                                  0971
*                  THEN                                            0971
         LH    @15,RISTATUS                                        0971
         LTR   @15,@15                                             0971
         BNZ   @RT00971                                            0971
*                    RETURN;                                       0972
*                                                                  0972
*                /****************************************************/
*                /*                                                  */
*                /* SCAN PAST THE OPENING PARENTHESIS FOLLOWING THE  */
*                /* KEYWORD, UNLESS IT IS A 'VALUE' KEYWORD          */
*                /*                                                  */
*                /****************************************************/
*                IF SUBLIST=YES  SCLRDATA=YES                     0973
*                  THEN                                            0973
         LH    @15,PARMID                                          0973
         MH    @15,@CH00038                                        0973
         L     @01,WORKPTR                                         0973
         AL    @01,@CF01317                                        0973
         L     @01,PARMPTR(@15,@01)                                0973
         TM    SUBLIST(@01),B'10000010'                            0973
         BZ    @RF00973                                            0973
*DOGRP47:            DO;                                           0974
*                                                                  0974
DOGRP47  DS    0H                                                  0975
*                    CALL SCANSEP(NO);                             0975
*                                                                  0975
         LA    @01,@AL00975                                        0975
         BAL   @14,SCANSEP                                         0975
*                    IF CHAR1 ^= OPENING                           0976
*                      THEN                                        0976
*                                                                  0976
         CLI   CHAR1,C'('                                          0976
         BE    @RF00976                                            0976
*                        CALL ERROR2(BADELIM2,LENGTH(ERRFIELD),    0977
*                                    ADDR(ERRFIELD));              0977
*                                                                  0977
         MVC   @AL00001(8),@AL00977                                0977
         LA    @15,ERRFIELD                                        0977
         ST    @15,@AFTEMPS+4                                      0977
         LA    @15,@AFTEMPS+4                                      0977
         ST    @15,@AL00001+8                                      0977
         LA    @01,@AL00001                                        0977
         BAL   @14,ERROR2                                          0977
*                      ELSE                                        0978
*DOGRP50:                DO;                                       0978
*                                                                  0978
         B     @RC00976                                            0978
@RF00976 DS    0H                                                  0978
DOGRP50  DS    0H                                                  0979
*                        CALL NEXTCHAR;                            0979
         BAL   @14,NEXTCHAR                                        0979
*                        CALL SCANSEP(NO);                         0980
*                                                                  0980
         LA    @01,@AL00980                                        0980
         BAL   @14,SCANSEP                                         0980
*                        IF RISTATUS=0                             0981
*                          THEN                                    0981
*                                                                  0981
         LH    @15,RISTATUS                                        0981
         LTR   @15,@15                                             0981
         BNZ   @RF00981                                            0981
*                            /****************************************/
*                            /*                                      */
*                            /* IF SCALAR DATA IS TO BE EXTRACTED    */
*                            /* FOLLOWING THE KEYWORD, THEN EXTRACT  */
*                            /* DATA.  IF SUBPARAMETERS FOLLOW THE   */
*                            /* KEYWORD, SET UP TO SCAN THEM         */
*                            /*                                      */
*                            /****************************************/
*                            IF SCLRDATA=YES                       0982
*                              THEN                                0982
         LH    @15,PARMID                                          0982
         MH    @15,@CH00038                                        0982
         L     @01,WORKPTR                                         0982
         AL    @01,@CF01317                                        0982
         L     @01,PARMPTR(@15,@01)                                0982
         TM    SCLRDATA(@01),B'10000000'                           0982
         BNO   @RF00982                                            0982
*                                DO;                               0983
*                                                                  0983
*                                CALL GETDATA;                     0984
*                                                                  0984
         BAL   @14,GETDATA                                         0984
*                                IF RISTATUS=0                     0985
*                                  THEN                            0985
*                                                                  0985
         LH    @15,RISTATUS                                        0985
         LTR   @15,@15                                             0985
         BNZ   @RF00985                                            0985
*                                    /********************************/
*                                    /*                              */
*                                    /* IF IT EXISTS, BYPASS THE     */
*                                    /* CLOSING PAREN FOLLOWING THE  */
*                                    /* DATA.  THE PAREN IS REQUIRED */
*                                    /* EXCEPT AT COMMAND END.       */
*                                    /*                              */
*                                    /********************************/
*                                    IF CHAR1 ^= CLOSING           0986
*                                      THEN                        0986
         CLI   CHAR1,C')'                                          0986
         BE    @RF00986                                            0986
*                                        IF CHAR1=ENDDELIM         0987
*                                          THEN                    0987
         CLI   CHAR1,C';'                                          0987
         BNE   @RF00987                                            0987
*                                            ENDPAREN=NO;          0988
         NI    ENDPAREN,B'01111111'                                0988
*                                          ELSE                    0989
*                                                                  0989
*                                            CALL ERROR2(BADELIM3, 0989
*                                                    LENGTH(ERRFIELD),
*                                                    ADDR(ERRFIELD));
*                                                                  0989
         B     @RC00987                                            0989
@RF00987 MVC   @AL00001(8),@AL00989                                0989
         LA    @15,ERRFIELD                                        0989
         ST    @15,@AFTEMPS+4                                      0989
         LA    @15,@AFTEMPS+4                                      0989
         ST    @15,@AL00001+8                                      0989
         LA    @01,@AL00001                                        0989
         BAL   @14,ERROR2                                          0989
*                                      ELSE                        0990
*                                        DO;                       0990
*                                                                  0990
         B     @RC00986                                            0990
@RF00986 DS    0H                                                  0991
*                                        CALL NEXTCHAR;            0991
         BAL   @14,NEXTCHAR                                        0991
*                                        CALL SCANSEP(YES);        0992
*                                                                  0992
         LA    @01,@AL00992                                        0992
         BAL   @14,SCANSEP                                         0992
*                                        END;                      0993
*                                END;                              0994
*                                                                  0994
*                              /**************************************/
*                              /*                                    */
*                              /* THE 'VALUE' OF THIS PARAMETER IS A */
*                              /* SUBPARAMETER LIST RATHER THAN A    */
*                              /* SCALAR OR LIST OF SCALARS.         */
*                              /*                                    */
*                              /**************************************/
*                              ELSE                                0995
*DOGRP55:                        DO;                               0995
         B     @RC00982                                            0995
@RF00982 DS    0H                                                  0995
DOGRP55  DS    0H                                                  0996
*                                PARMLVL=PARMLVL+1;                0996
         LA    @15,1                                               0996
         LH    @14,PARMLVL                                         0996
         ALR   @14,@15                                             0996
         STH   @14,PARMLVL                                         0996
*                                PPARMCNT(PARMLVL)=1;              0997
         ALR   @14,@14                                             0997
         STH   @15,PPARMCNT-2(@14)                                 0997
*                                SUPERID(PARMLVL)=PARMID;          0998
         LH    @05,PARMID                                          0998
         STH   @05,SUPERID-2(@14)                                  0998
*                                SUBSYET=NO;                       0999
*                                                                  0999
         NI    SUBSYET,B'11101111'                                 0999
*                                /**********************************/
*                                /*                                */
*                                /* IF THE SUBPARAMETER LIST MAY BE*/
*                                /* REPEATED, BYPASS DELIMITER(S)  */
*                                /* AND SET INDEXES AND COUNTS TO  */
*                                /* NOTE START OF REPEATED LISTS.  */
*                                /*                                */
*                                /**********************************/
*                                IF REPEATED=YES                   1000
*                                  THEN                            1000
         MH    @05,@CH00038                                        1000
         L     @01,WORKPTR                                         1000
         AL    @01,@CF01317                                        1000
         L     @01,PARMPTR(@05,@01)                                1000
         TM    REPEATED(@01),B'00100000'                           1000
         BNO   @RF01000                                            1000
*                                    DO;                           1001
*                                    REPDEPTH=REPDEPTH+1;          1002
         AH    @15,REPDEPTH                                        1002
         STH   @15,REPDEPTH                                        1002
*                                    IF CHAR1=OPENING              1003
*                                      THEN                        1003
         CLI   CHAR1,C'('                                          1003
         BNE   @RF01003                                            1003
*                                        DO;                       1004
*                                                                  1004
*                                        CALL NEXTCHAR;            1005
         BAL   @14,NEXTCHAR                                        1005
*                                        CALL SCANSEP(NO);         1006
*                                                                  1006
         LA    @01,@AL01006                                        1006
         BAL   @14,SCANSEP                                         1006
*                                        ONEREP(REPDEPTH)=NO;      1007
         LH    @01,REPDEPTH                                        1007
         LA    @15,ONEREP-1(@01)                                   1007
         NI    0(@15),B'01111111'                                  1007
*                                        END;                      1008
*                                      ELSE                        1009
*                                        ONEREP(REPDEPTH)=YES;     1009
         B     @RC01003                                            1009
@RF01003 LH    @01,REPDEPTH                                        1009
         LA    @15,ONEREP-1(@01)                                   1009
         OI    0(@15),B'10000000'                                  1009
*                                    REPCOUNT(REPDEPTH)=1;         1010
@RC01003 LH    @15,REPDEPTH                                        1010
         LR    @14,@15                                             1010
         ALR   @14,@14                                             1010
         LA    @05,1                                               1010
         STH   @05,REPCOUNT-2(@14)                                 1010
*                                    REPLIMIT(REPDEPTH)=REPMAX;    1011
         LA    @05,12                                              1011
         LR    @04,@05                                             1011
         MH    @04,PARMID                                          1011
         L     @01,WORKPTR                                         1011
         AL    @01,@CF01317                                        1011
         AL    @05,PARMPTR(@04,@01)                                1011
         SLR   @04,@04                                             1011
         IC    @04,REPMAX(,@05)                                    1011
         STH   @04,REPLIMIT-2(@14)                                 1011
*                                    ARRYPTR=                      1012
*                                        FDTPTR(SUPERID(PARMLVL)); 1012
         LH    @14,PARMLVL                                         1012
         ALR   @14,@14                                             1012
         LH    @14,SUPERID-2(@14)                                  1012
         SLA   @14,2                                               1012
         L     @01,FDTADDR                                         1012
         L     @14,FDTPTR-4(@14,@01)                               1012
         ST    @14,ARRYPTR                                         1012
*                                    HWORDARG=REPDEPTH-1;          1013
*                                                                  1013
         BCTR  @15,0                                               1013
         STH   @15,HWORDARG                                        1013
*                                    CALL DSPLCALC(HWORDARG);      1014
*                                                                  1014
         LA    @15,HWORDARG                                        1014
         ST    @15,@AL00001                                        1014
         LA    @01,@AL00001                                        1014
         BAL   @14,DSPLCALC                                        1014
*                                    REPTOTAL=1;                   1015
         LH    @15,ARRYDSPL                                        1015
         AL    @15,ARRYPTR                                         1015
         MVC   REPTOTAL(4,@15),@CF00172                            1015
*                                    END;                          1016
*                                                                  1016
*                                END DOGRP55;                      1017
*                        END DOGRP50;                              1018
*                    END DOGRP47;                                  1019
*                                                                  1019
*                  /**************************************************/
*                  /*                                                */
*                  /* WHEN A VALUE KEYWORD IS EXTRACTED, SCAN TO     */
*                  /* THE NEXT SYNTACTIC UNIT                        */
*                  /*                                                */
*                  /**************************************************/
*                  ELSE                                            1020
*                                                                  1020
*                    CALL SCANSEP(YES);                            1020
*                                                                  1020
         B     @RC00973                                            1020
@RF00973 LA    @01,@AL01020                                        1020
         BAL   @14,SCANSEP                                         1020
*                END DOGRP45;                                      1021
*                                                                  1021
*              /******************************************************/
*              /*                                                    */
*              /* IF NO MATCHING KEYWORD WAS FOUND, IT IS AN ERROR   */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1022
*                                                                  1022
*                CALL ERROR2(BADKWD2,LENGTH(ERRFIELD),ADDR(ERRFIELD));
*                                                                  1022
         B     @RC00968                                            1022
@RF00968 MVC   @AL00001(8),@AL01022                                1022
         LA    @15,ERRFIELD                                        1022
         ST    @15,@AFTEMPS+4                                      1022
         LA    @15,@AFTEMPS+4                                      1022
         ST    @15,@AL00001+8                                      1022
         LA    @01,@AL00001                                        1022
         BAL   @14,ERROR2                                          1022
*            END DOGRP40;                                          1023
*                                                                  1023
*        END KWDPARM;                                              1024
@EL00009 DS    0H                                                  1024
@EF00009 DS    0H                                                  1024
@ER00009 LM    @14,@12,@SA00009                                    1024
         BR    @14                                                 1024
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - POSPARM                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SETS UP TO EXTRACT SCALAR DATA          */
*/*             ASSOCIATED WITH THE POSITIONAL PARAMETER OR PREPARES */
*/*             TO SCAN A POSITIONAL PARAMETER'S SUBPARAMETER LIST.  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND SO FAR  */
*/*                    IN CURRENT SUBPARAMETER LIST.                 */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */
*/*          RISTATUS- R/I STATUS CODE; SET TO NON-ZERO VALUE WHEN   */
*/*                    AN ERROR IS FOUND.                            */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */
*/*                    WHICH SCANNING IS CURRENTLY TAKING PLACE.     */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          JUSTONE - FLAG SET 'ON' WHEN A SINGLE SCALAR LIST ITEM  */
*/*                    HAS BEEN CODED FOR A PARAMETER                */
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING HANDLED.     */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING WILL TAKE PLACE AFTER THIS PARAMETER */
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */
*/*                    CURRENT SUBPARAMETER LIST.                    */
*/*          SUPERID - ID# OF PARAMETER WHOSE SUBPARAMETER LIST IS   */
*/*                    CURRENTLY BEING SCANNED                       */
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST ONE SUBPARAMETER  */
*/*                    HAS BEEN FOUND IN THE CURRENT SUBLIST.        */
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */
*/*                    WHICH SCANNING WILL TAKE PLACE FOLLOWING THIS */
*/*                    POSITIONAL PARAMETER                          */
*/*          REPCOUNT- NUMBER OF REPEATED SUBLISTS FOUND AT CURRENT  */
*/*                    REPEATED SUBLIST LEVEL.                       */
*/*          REPLIMIT- MAXIMUM NUMBER OF REPEATED SUBLISTS ALLOWED   */
*/*                    AT CURRENT LEVEL.                             */
*/*          ARRYPTR - POINTER TO INTERMEDIATE POINTER VECTOR WHICH  */
*/*                    CONTAINS PTRS TO DATA STRUCTURES FOR CURRENT  */
*/*                    POSITIONAL PARAMETER                          */
*/*                                                                  */
*/********************************************************************/
*POSPARM:PROCEDURE;                                                1025
POSPARM  STM   @14,@12,@SA00010                                    1025
*        /************************************************************/
*        /*                                                          */
*        /*  ** POSPARM **  GET POSITIONAL PARAMETER VALUE           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1026
*          THEN;                                                   1026
         L     @01,GDTPTR                                          1026
         L     @15,GDTDBG(,@01)                                    1026
         LTR   @15,@15                                             1026
         BZ    @RT01026                                            1026
*          ELSE                                                    1028
*            CALL ICKDB010(GDTTBL,'RIPP');                         1028
*                                                                  1028
         L     @15,GDTPTR                                          1028
         ST    @15,@AL00001                                        1028
         LA    @14,@CC00956                                        1028
         ST    @14,@AL00001+4                                      1028
         MVI   @AL00001+4,X'80'                                    1028
         L     @15,GDTDBG(,@15)                                    1028
         LA    @01,@AL00001                                        1028
         BALR  @14,@15                                             1028
*        JUSTONE=NO;                                               1029
*                                                                  1029
@RT01026 NI    JUSTONE,B'11111110'                                 1029
*        /************************************************************/
*        /*                                                          */
*        /* SET A FLAG NOTING THAT THIS PARAMETER HAS BEEN FOUND     */
*        /* AND INCREMENT COUNT OF POSITIONAL PARAMETERS.            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1030
*        CALL SETFLAG;                                             1030
*                                                                  1030
         BAL   @14,SETFLAG                                         1030
*        PPARMCNT(PARMLVL)=PPARMCNT(PARMLVL)+1;                    1031
*                                                                  1031
         LH    @15,PARMLVL                                         1031
         ALR   @15,@15                                             1031
         LA    @14,1                                               1031
         AH    @14,PPARMCNT-2(@15)                                 1031
         STH   @14,PPARMCNT-2(@15)                                 1031
*        /************************************************************/
*        /*                                                          */
*        /* IF THE VALUE OF THE POSITIONAL PARAMETER IS A LIST, THEN */
*        /* EITHER EXTRACT A LIST OF SCALARS OR SET UP TO SCAN A     */
*        /* LIST OF SUBPARAMETERS.                                   */
*        /*                                                          */
*        /************************************************************/
*        IF CHAR1 = OPENING                                        1032
*          THEN                                                    1032
         CLI   CHAR1,C'('                                          1032
         BNE   @RF01032                                            1032
*DOGRP60:    DO;                                                   1033
*                                                                  1033
DOGRP60  DS    0H                                                  1034
*              CALL NEXTCHAR;                                      1034
         BAL   @14,NEXTCHAR                                        1034
*              CALL SCANSEP(NO);                                   1035
*                                                                  1035
         LA    @01,@AL01035                                        1035
         BAL   @14,SCANSEP                                         1035
*              IF RISTATUS^=0                                      1036
*                THEN                                              1036
         LH    @15,RISTATUS                                        1036
         LTR   @15,@15                                             1036
         BNZ   @RT01036                                            1036
*                  RETURN;                                         1037
*                                                                  1037
*              /******************************************************/
*              /*                                                    */
*              /* EXTRACT THE LIST OF SCALAR DATA ITEMS AND          */
*              /* CHECK FOR PROPER PARENTHESES IF THE POSITIONAL     */
*              /* PARAMETER IS A SCALAR LIST.                        */
*              /*                                                    */
*              /******************************************************/
*              IF LIST=YES                                         1038
*                THEN                                              1038
         LH    @15,PARMID                                          1038
         MH    @15,@CH00038                                        1038
         L     @01,WORKPTR                                         1038
         AL    @01,@CF01317                                        1038
         L     @01,PARMPTR(@15,@01)                                1038
         TM    LIST(@01),B'00001000'                               1038
         BNO   @RF01038                                            1038
*                  DO;                                             1039
*                                                                  1039
*                  CALL GETDATA;                                   1040
*                                                                  1040
         BAL   @14,GETDATA                                         1040
*                  IF RISTATUS=0                                   1041
*                    THEN                                          1041
*                                                                  1041
         LH    @15,RISTATUS                                        1041
         LTR   @15,@15                                             1041
         BNZ   @RF01041                                            1041
*                      /**********************************************/
*                      /*                                            */
*                      /* IF IT EXISTS, BYPASS THE CLOSING PAREN     */
*                      /* FOLLOWING THE DATA.  EXCEPT AT COMMAND     */
*                      /* END, THE CLOSING PAREN IN REQUIRED.        */
*                      /*                                            */
*                      /**********************************************/
*                      IF CHAR1^=CLOSING                           1042
*                        THEN                                      1042
         CLI   CHAR1,C')'                                          1042
         BE    @RF01042                                            1042
*                          IF CHAR1=ENDDELIM                       1043
*                            THEN                                  1043
         CLI   CHAR1,C';'                                          1043
         BNE   @RF01043                                            1043
*                              ENDPAREN=NO;                        1044
         NI    ENDPAREN,B'01111111'                                1044
*                            ELSE                                  1045
*                                                                  1045
*                              CALL ERROR2(BADELIM3,LENGTH(ERRFIELD),
*                                          ADDR(ERRFIELD));        1045
*                                                                  1045
         B     @RC01043                                            1045
@RF01043 MVC   @AL00001(8),@AL01045                                1045
         LA    @15,ERRFIELD                                        1045
         ST    @15,@AFTEMPS+8                                      1045
         LA    @15,@AFTEMPS+8                                      1045
         ST    @15,@AL00001+8                                      1045
         LA    @01,@AL00001                                        1045
         BAL   @14,ERROR2                                          1045
*                        ELSE                                      1046
*                          DO;                                     1046
*                                                                  1046
         B     @RC01042                                            1046
@RF01042 DS    0H                                                  1047
*                          CALL NEXTCHAR;                          1047
         BAL   @14,NEXTCHAR                                        1047
*                          CALL SCANSEP(YES);                      1048
*                                                                  1048
         LA    @01,@AL01048                                        1048
         BAL   @14,SCANSEP                                         1048
*                          END;                                    1049
*                  END;                                            1050
*                ELSE                                              1051
*                                                                  1051
*                  CALL ERROR2(BADELIM5,LENGTH(ERRFIELD),          1051
*                              ADDR(ERRFIELD));                    1051
*                                                                  1051
         B     @RC01038                                            1051
@RF01038 MVC   @AL00001(8),@AL01051                                1051
         LA    @15,ERRFIELD                                        1051
         ST    @15,@AFTEMPS+8                                      1051
         LA    @15,@AFTEMPS+8                                      1051
         ST    @15,@AL00001+8                                      1051
         LA    @01,@AL00001                                        1051
         BAL   @14,ERROR2                                          1051
*            END DOGRP60;                                          1052
*          ELSE                                                    1053
*                                                                  1053
*            /********************************************************/
*            /*                                                      */
*            /* IF THERE IS NO LEFT PARENTHESIS TO DELIMIT A SCALAR  */
*            /* LIST, THEN THE LIST MUST BE JUST ONE SCALAR LONG.    */
*            /* AN EXCEPTION IS WHEN A LIST OF LISTS IS INVOLVED, IN */
*            /* WHICH CASE THE PARENTHESES FOR THE REPEATED LISTS    */
*            /* MAY SERVE TO DELIMIT THE SCALAR LISTS.               */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1053
         B     @RC01032                                            1053
@RF01032 DS    0H                                                  1054
*            IF LIST=YES                                           1054
*              THEN                                                1054
         L     @15,WORKPTR                                         1054
         LH    @14,PARMID                                          1054
         LA    @05,12                                              1054
         LR    @01,@14                                             1054
         MR    @00,@05                                             1054
         LA    @04,0(@01,@15)                                      1054
         AL    @04,@CF01317                                        1054
         L     @04,PARMPTR(,@04)                                   1054
         TM    LIST(@04),B'00001000'                               1054
         BNO   @RF01054                                            1054
*                DO;                                               1055
*                TESTID=PARMID;                                    1056
         STH   @14,TESTID                                          1056
*                PARMID=SUPRPARM(PARMID);                          1057
         AL    @01,@CF01318                                        1057
         LH    @14,SUPRPARM-8(@01,@15)                             1057
         STH   @14,PARMID                                          1057
*                IF PARMID^=0 & REPEATED=YES & SUBCOUNT=1          1058
*                  THEN;                                           1058
         LTR   @14,@14                                             1058
         BZ    @RF01058                                            1058
         LR    @01,@14                                             1058
         MR    @00,@05                                             1058
         AL    @15,@CF01317                                        1058
         L     @04,PARMPTR(@01,@15)                                1058
         TM    REPEATED(@04),B'00100000'                           1058
         BNO   @RF01058                                            1058
         ALR   @05,@04                                             1058
         SLR   @15,@15                                             1058
         IC    @15,SUBDSPL(,@05)                                   1058
         ALR   @15,@15                                             1058
         ALR   @04,@15                                             1058
         CLC   SUBCOUNT(2,@04),@CH00172                            1058
         BE    @RT01058                                            1058
*                  ELSE                                            1060
*                    JUSTONE=YES;                                  1060
@RF01058 OI    JUSTONE,B'00000001'                                 1060
*                PARMID=TESTID;                                    1061
@RT01058 MVC   PARMID(2),TESTID                                    1061
*                END;                                              1062
*                                                                  1062
*            CALL GETDATA;                                         1063
*                                                                  1063
@RF01054 BAL   @14,GETDATA                                         1063
*            END;                                                  1064
*                                                                  1064
*        END POSPARM;                                              1065
*                                                                  1065
*                                                                  1065
@EL00010 DS    0H                                                  1065
@EF00010 DS    0H                                                  1065
@ER00010 LM    @14,@12,@SA00010                                    1065
         BR    @14                                                 1065
*        END SCANCMD;                                              1066
@EL00003 DS    0H                                                  1066
@EF00003 DS    0H                                                  1066
@ER00003 LM    @14,@12,@SA00003                                    1066
         BR    @14                                                 1066
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETDATA                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SETS UP TO EXTRACT THE SCALAR VALUE OR  */
*/*             VALUES ASSOCIATED WITH A PARAMETER.                  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */
*/*          CHAR2 -   CHARACTER WHICH IS TO BE EXTRACTED NEXT       */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */
*/*          PWORD -   SWITCH SET TO INDICATE WHETHER A PASSWORD     */
*/*                    SCALAR IS CURRENTLY BEING EXTRACTED, IS NOT   */
*/*                    BEING EXTRACTED, OR WILL BE EXTRACTED NEXT.   */
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT COMMAND IS BEING   */
*/*                    SCANNED FOR SYNTAX CHECKING ONLY.             */
*/*          JUSTONE - FLAG SET 'ON' WHEN NO PARENTHESES HAVE BEEN   */
*/*                    CODED TO DELIMIT A SCALAR LIST SINCE ONLY ONE */
*/*                    LIST ELEMENT EXISTS.                          */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE DATA ENTRIES                        */
*/*          SCLRCNT - COUNT OF SCALARS FOUND IN A SCALAR LIST       */
*/*          PWORD -   SEE 'INPUT'                                   */
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD ITEM MAY FOLLOW */
*/*                    THE PRIMARY SCALAR VALUE                      */
*/*          ORGSIGN - CONTAINS A CHARACTER CODE INDICATING THE FORM */
*/*                    IN WHICH A CONSTANT WAS SPECIFIED             */
*/*                                                                  */
*/********************************************************************/
*GETDATA:PROCEDURE;                                                1067
GETDATA  STM   @14,@12,@SA00011                                    1067
*        /************************************************************/
*        /*                                                          */
*        /* GETDATA PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*        DCL ENDVALUE BIT(1);          /*SIGNALS THAT ALL THE SCALAR
*                                        DATA HAS BEEN EXTRACTED     */
*                                                                  1068
*        /*STATIC ERROR MESSAGE CODES                                */
*        DCL BADNUM   FIXED(31)        /*IMPROPER NUMERICAL VALUE    */
*                     CONSTANT(15);                                1069
*        DCL BADPWD   FIXED(31)        /*PASSWORD APPEARS IMPROPERLY */
*                     CONSTANT(18);                                1070
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETDATA **  EXTRACT SCALAR VALUE OR VALUES           */
*        /*                                                          */
*        /************************************************************/
*        SCLRCNT=0;                                                1071
         SLR   @15,@15                                             1071
         STH   @15,SCLRCNT                                         1071
*        PWORD=NONE;                                               1072
         STH   @15,PWORD                                           1072
*        ENDVALUE=NO;                                              1073
         NI    ENDVALUE,B'01111111'                                1073
*        PWORDSW=OFF;                                              1074
         NI    PWORDSW,B'01111111'                                 1074
*        OLDERID2 = NEWERID2;                                      1075
         L     @01,GDTPTR                                          1075
         L     @15,GDTTR2(,@01)                                    1075
         MVC   @TS00001(95),NEWERID2(@15)                          1075
         MVC   OLDERID2(95,@15),@TS00001                           1075
*        NEWID2='RI11';                                            1076
*                                                                  1076
         MVC   NEWID2(4,@15),@CC00965                              1076
*        /************************************************************/
*        /*                                                          */
*        /*  EXTRACT DATA UNTIL THE ENTIRE SCALAR OR LIST OF         */
*        /*  SCALARS HAS BEEN PICKED UP                              */
*        /*                                                          */
*        /************************************************************/
*        DO WHILE(ENDVALUE=NO );                                   1077
*                                                                  1077
         B     @DE01077                                            1077
@DL01077 DS    0H                                                  1078
*          /**********************************************************/
*          /*                                                        */
*          /* NOTE WHETHER OR NOT A PASSWORD IS ALLOWED WITH         */
*          /* THE CURRENT PARAMETER.  THEN USE THE PARAMETER         */
*          /* DATA FORMAT TO EXTRACT THE CONSTANT.                   */
*          /*                                                        */
*          /**********************************************************/
*          IF PWORDOPT=YES & PWORD=NONE                            1078
*            THEN                                                  1078
         LA    @15,12                                              1078
         LR    @14,@15                                             1078
         MH    @14,PARMID                                          1078
         L     @01,WORKPTR                                         1078
         AL    @01,@CF01317                                        1078
         AL    @15,PARMPTR(@14,@01)                                1078
         TM    PWORDOPT(@15),B'00000010'                           1078
         BNO   @RF01078                                            1078
         LH    @15,PWORD                                           1078
         LTR   @15,@15                                             1078
         BNZ   @RF01078                                            1078
*              PWORDSW=ON;                                         1079
         OI    PWORDSW,B'10000000'                                 1079
*            ELSE                                                  1080
*              PWORDSW=OFF;                                        1080
*                                                                  1080
         B     @RC01078                                            1080
@RF01078 NI    PWORDSW,B'01111111'                                 1080
*          ORGSIGN=BLANK;                                          1081
@RC01078 MVI   ORGSIGN,C' '                                        1081
*          IF NUMBER=YES                                          1082
*             (ANYSTRNG=YES & (CHAR1=HEXSIGN  CHAR1=BINSIGN) &    1082
*              CHAR2=QUOTE & PWORD^=NEXT)                          1082
*                                                                  1082
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT A NUMBER IN DECIMAL FORM OR EXTRACT A NUMBER */
*            /* OR STRING WHICH IS SPECIFIED IN BINARY OR HEX FORM.  */
*            /*                                                      */
*            /********************************************************/
*            THEN                                                  1082
         LA    @15,12                                              1082
         LR    @14,@15                                             1082
         MH    @14,PARMID                                          1082
         L     @01,WORKPTR                                         1082
         AL    @01,@CF01317                                        1082
         AL    @15,PARMPTR(@14,@01)                                1082
         TM    NUMBER(@15),B'10000000'                             1082
         BO    @RT01082                                            1082
         TM    ANYSTRNG(@15),B'01000000'                           1082
         BNO   @RF01082                                            1082
         CLI   CHAR1,C'X'                                          1082
         BE    @GL00045                                            1082
         CLI   CHAR1,C'B'                                          1082
         BNE   @RF01082                                            1082
@GL00045 CLI   CHAR2,C''''                                         1082
         BNE   @RF01082                                            1082
         CLC   PWORD(2),@CH00172                                   1082
         BE    @RF01082                                            1082
@RT01082 DS    0H                                                  1083
*              IF CHAR1=HEXSIGN  CHAR1=BINSIGN                    1083
*                THEN                                              1083
         CLI   CHAR1,C'X'                                          1083
         BE    @RT01083                                            1083
         CLI   CHAR1,C'B'                                          1083
         BNE   @RF01083                                            1083
@RT01083 DS    0H                                                  1084
*                  DO;                                             1084
*                  ORGSIGN=CHAR1;                                  1085
*                                                                  1085
         MVC   ORGSIGN(1),CHAR1                                    1085
*                  CALL NEXTCHAR;                                  1086
*                                                                  1086
         BAL   @14,NEXTCHAR                                        1086
*                  IF RISTATUS=0                                   1087
*                    THEN                                          1087
         LH    @15,RISTATUS                                        1087
         LTR   @15,@15                                             1087
         BNZ   @RF01087                                            1087
*                      IF CHAR1=QUOTE                              1088
*                        THEN                                      1088
*                                                                  1088
         CLI   CHAR1,C''''                                         1088
         BNE   @RF01088                                            1088
*                          CALL GETQUOTD;                          1089
*                                                                  1089
         BAL   @14,GETQUOTD                                        1089
*                        ELSE                                      1090
*                                                                  1090
*                          CALL ERROR1(BADNUM);                    1090
*                                                                  1090
         B     @RC01088                                            1090
@RF01088 LA    @01,@AL01090                                        1090
         BAL   @14,ERROR1                                          1090
*                  END;                                            1091
*                ELSE                                              1092
*                                                                  1092
*                  CALL GETSIMPL;                                  1092
*                                                                  1092
         B     @RC01083                                            1092
@RF01083 BAL   @14,GETSIMPL                                        1092
*            /********************************************************/
*            /*                                                      */
*            /*  WHEN THE CONSTANT IS NOT A NUMBER, A HEX            */
*            /*  STRING, OR A BIT STRING, EXTRACT IT AS A            */
*            /*  CHARACTER STRING, CHECKING TO SEE IF IT IS WITHIN   */
*            /*  APOSTROPHES.  ALSO CHECK TO SEE IF THE SCALAR IS    */
*            /*  A PASSWORD.                                         */
*            /*                                                      */
*            /********************************************************/
*            ELSE                                                  1093
*              DO;                                                 1093
         B     @RC01082                                            1093
@RF01082 DS    0H                                                  1094
*              OLDERID2 = NEWERID2;                                1094
         L     @01,GDTPTR                                          1094
         L     @15,GDTTR2(,@01)                                    1094
         MVC   @TS00001(95),NEWERID2(@15)                          1094
         MVC   OLDERID2(95,@15),@TS00001                           1094
*              NEWID2='RI12';                                      1095
         MVC   NEWID2(4,@15),@CC00968                              1095
*              IF PWORD=NEXT                                       1096
*                THEN                                              1096
         CLC   PWORD(2),@CH00172                                   1096
         BNE   @RF01096                                            1096
*                  PWORD=NOW;                                      1097
         MVC   PWORD(2),@CH00144                                   1097
*              IF CHAR1=QUOTE                                      1098
*                THEN                                              1098
*                                                                  1098
@RF01096 CLI   CHAR1,C''''                                         1098
         BNE   @RF01098                                            1098
*                  CALL GETQUOTD;                                  1099
*                                                                  1099
         BAL   @14,GETQUOTD                                        1099
*                ELSE                                              1100
*                                                                  1100
*                  CALL GETSIMPL;                                  1100
*                                                                  1100
         B     @RC01098                                            1100
@RF01098 BAL   @14,GETSIMPL                                        1100
*              END;                                                1101
*                                                                  1101
@RC01098 DS    0H                                                  1102
*          /**********************************************************/
*          /*                                                        */
*          /*  ADD THE EXTRACTED SCALAR TO THE FDT AND CHECK TO SEE  */
*          /*  IF THE SCALAR VALUE OR VALUES HAVE BEEN COMPLETELY    */
*          /*  EXTRACTED.                                            */
*          /*                                                        */
*          /**********************************************************/
*          IF RISTATUS=0 & SCANONLY=NO                             1102
*            THEN                                                  1102
*                                                                  1102
@RC01082 LH    @15,RISTATUS                                        1102
         LTR   @15,@15                                             1102
         BNZ   @RF01102                                            1102
         TM    SCANONLY,B'00010000'                                1102
         BNZ   @RF01102                                            1102
*              CALL BUILDFDT;                                      1103
         BAL   @14,BUILDFDT                                        1103
*            ELSE                                                  1104
*              IF PWORD=NOW                                        1104
*                THEN                                              1104
         B     @RC01102                                            1104
@RF01102 CLC   PWORD(2),@CH00144                                   1104
         BNE   @RF01104                                            1104
*                  PWORD=NONE;                                     1105
*                                                                  1105
         SLR   @15,@15                                             1105
         STH   @15,PWORD                                           1105
*          IF (SCALAR=YES & PWORD=NONE)  (JUSTONE=YES & PWORD=NONE) 
*             CHAR1=CLOSING  CHAR1=ENDDELIM  RISTATUS ^= 0       1106
*            THEN                                                  1106
@RF01104 DS    0H                                                  1106
@RC01102 LH    @15,PARMID                                          1106
         MH    @15,@CH00038                                        1106
         L     @01,WORKPTR                                         1106
         AL    @01,@CF01317                                        1106
         L     @01,PARMPTR(@15,@01)                                1106
         TM    SCALAR(@01),B'00010000'                             1106
         BNO   @GL00053                                            1106
         LH    @15,PWORD                                           1106
         LTR   @15,@15                                             1106
         BZ    @RT01106                                            1106
@GL00053 TM    JUSTONE,B'00000001'                                 1106
         BNO   @GL00052                                            1106
         LH    @15,PWORD                                           1106
         LTR   @15,@15                                             1106
         BZ    @RT01106                                            1106
@GL00052 CLI   CHAR1,C')'                                          1106
         BE    @RT01106                                            1106
         CLI   CHAR1,C';'                                          1106
         BE    @RT01106                                            1106
         LH    @15,RISTATUS                                        1106
         LTR   @15,@15                                             1106
         BZ    @RF01106                                            1106
@RT01106 DS    0H                                                  1107
*              ENDVALUE=YES;                                       1107
         OI    ENDVALUE,B'10000000'                                1107
*        END;                                                      1108
@RF01106 DS    0H                                                  1108
@DE01077 TM    ENDVALUE,B'10000000'                                1108
         BZ    @DL01077                                            1108
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME -  GETSIMPL                                      */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS A SCALAR NOT ENCLOSED WITHIN   */
*/*             APOSTROPHES AND CHECKS TO SEE IF A PASSWORD ITEM     */
*/*             FOLLOWS THE PRIMARY SCALAR.                          */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */
*/*          PWORD -   SWITCH INDICATING WHETHER A PASSWORD IS TO BE */
*/*                    EXTRACTED NEXT, NOW, OR NOT AT ALL            */
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD MAY APPEAR      */
*/*                    LEGITIMATELY                                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          EXTRACTED SCALAR ITEM.                                  */
*/*          PWORD -   SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*GETSIMPL:PROCEDURE;                                               1109
         B     @PB00012                                            1109
GETSIMPL STM   @14,@12,@SA00012                                    1109
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETSIMPL **  EXTRACT AN UNQUOTED SCALAR              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1110
*        /************************************************************/
*        /*                                                          */
*        /* PICK UP THE UNQUOTED SCALAR                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1110
*        CALL NXTFIELD(SIMPSCLR);                                  1110
         LA    @01,@AL01110                                        1110
         BAL   @14,NXTFIELD                                        1110
*        CALL SCANSEP(YES);                                        1111
*                                                                  1111
         LA    @01,@AL01111                                        1111
         BAL   @14,SCANSEP                                         1111
*        IF RISTATUS=0                                             1112
*          THEN                                                    1112
         LH    @15,RISTATUS                                        1112
         LTR   @15,@15                                             1112
         BNZ   @RF01112                                            1112
*            IF CHAR1=PWDDELIM                                     1113
*                                                                  1113
*              /******************************************************/
*              /*                                                    */
*              /*  WHEN THE ENDING DELIMITER OF THE SCALAR IS THE    */
*              /*  DELIMITER INDICATING A FOLLOWING PASSWORD, NOTE   */
*              /*  THAT THE PASSWORD IS TO BE EXTRACTED LATER.  ALSO */
*              /*  CHECK TO SEE IF THE OCCURRENCE OR LACK OF         */
*              /*  OCCURRENCE OF A PASSWORD DELIMITER IS AN ERROR.   */
*              /*                                                    */
*              /******************************************************/
*              THEN                                                1113
         CLI   CHAR1,C'/'                                          1113
         BNE   @RF01113                                            1113
*                IF PWORDSW=ON                                     1114
*                  THEN                                            1114
         TM    PWORDSW,B'10000000'                                 1114
         BNO   @RF01114                                            1114
*                    DO;                                           1115
*                                                                  1115
*                    CALL NEXTCHAR;                                1116
         BAL   @14,NEXTCHAR                                        1116
*                    CALL SCANSEP(YES);                            1117
*                                                                  1117
         LA    @01,@AL01117                                        1117
         BAL   @14,SCANSEP                                         1117
*                    PWORD=NEXT;                                   1118
         MVC   PWORD(2),@CH00172                                   1118
*                    END;                                          1119
*                  ELSE                                            1120
*                                                                  1120
*                    CALL ERROR2(BADPWD,LENGTH(ERRFIELD),          1120
*                                ADDR(ERRFIELD));                  1120
*                                                                  1120
         B     @RC01114                                            1120
@RF01114 MVC   @AL00001(8),@AL01120                                1120
         LA    @15,ERRFIELD                                        1120
         ST    @15,@AFTEMPS+16                                     1120
         LA    @15,@AFTEMPS+16                                     1120
         ST    @15,@AL00001+8                                      1120
         LA    @01,@AL00001                                        1120
         BAL   @14,ERROR2                                          1120
*        END GETSIMPL;                                             1121
@EL00012 DS    0H                                                  1121
@EF00012 DS    0H                                                  1121
@ER00012 LM    @14,@12,@SA00012                                    1121
         BR    @14                                                 1121
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETQUOTD                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS A SCALAR THAT IS WITHIN        */
*/*             APOSTROPHES AND CHECKS FOR A FOLLOWING PASSWORD.     */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD MAY APPEAR      */
*/*                    LEGITIMATELY                                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          EXTRACTED SCALAR ITEM.                                  */
*/*          PWORD -   SWITCH INDICATING WHEN A PASSWORD IS TO BE    */
*/*                    EXTRACTED NEXT                                */
*/*                                                                  */
*/********************************************************************/
*GETQUOTD:PROCEDURE;                                               1122
GETQUOTD STM   @14,@12,@SA00013                                    1122
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETQUOTD **  EXTRACT SCALAR WITHIN APOSTROPHES       */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1123
*          THEN;                                                   1123
         L     @01,GDTPTR                                          1123
         L     @15,GDTDBG(,@01)                                    1123
         LTR   @15,@15                                             1123
         BZ    @RT01123                                            1123
*          ELSE                                                    1125
*            CALL ICKDB010(GDTTBL,'RIGQ');                         1125
*                                                                  1125
         L     @15,GDTPTR                                          1125
         ST    @15,@AL00001                                        1125
         LA    @14,@CC00976                                        1125
         ST    @14,@AL00001+4                                      1125
         MVI   @AL00001+4,X'80'                                    1125
         L     @15,GDTDBG(,@15)                                    1125
         LA    @01,@AL00001                                        1125
         BALR  @14,@15                                             1125
*        /************************************************************/
*        /*                                                          */
*        /* BYPASS THE LEADING APOSTROPHE AND EXTRACT THE SCALAR     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1126
*        CALL NEXTCHAR;                                            1126
@RT01123 BAL   @14,NEXTCHAR                                        1126
*        CALL NXTFIELD(QUOTSCLR);                                  1127
         LA    @01,@AL01127                                        1127
         BAL   @14,NXTFIELD                                        1127
*        CALL SCANSEP(YES);                                        1128
*                                                                  1128
         LA    @01,@AL01128                                        1128
         BAL   @14,SCANSEP                                         1128
*        IF RISTATUS=0                                             1129
*          THEN                                                    1129
*                                                                  1129
         LH    @15,RISTATUS                                        1129
         LTR   @15,@15                                             1129
         BNZ   @RF01129                                            1129
*            /********************************************************/
*            /*                                                      */
*            /* WHEN A DELIMITER INDICATING A FOLLOWING PASSWORD IS  */
*            /* FOUND, NOTE THAT THE PASSWORD IS TO BE EXTRACTED     */
*            /* LATER.  ALSO CHECK WHETHER THE OCCURRENCE OR LACK OF */
*            /* OCCURRENCE OF A PASSWORD DELIMITER IS AN ERROR.      */
*            /*                                                      */
*            /********************************************************/
*            IF CHAR1=PWDDELIM                                     1130
*              THEN                                                1130
         CLI   CHAR1,C'/'                                          1130
         BNE   @RF01130                                            1130
*                IF PWORDSW=ON                                     1131
*                  THEN                                            1131
         TM    PWORDSW,B'10000000'                                 1131
         BNO   @RF01131                                            1131
*                    DO;                                           1132
*                                                                  1132
*                    CALL NEXTCHAR;                                1133
         BAL   @14,NEXTCHAR                                        1133
*                    CALL SCANSEP(YES);                            1134
*                                                                  1134
         LA    @01,@AL01134                                        1134
         BAL   @14,SCANSEP                                         1134
*                    PWORD=NEXT;                                   1135
         MVC   PWORD(2),@CH00172                                   1135
*                    END;                                          1136
*                  ELSE                                            1137
*                                                                  1137
*                    CALL ERROR2(BADPWD,LENGTH(ERRFIELD),          1137
*                                ADDR(ERRFIELD));                  1137
*                                                                  1137
         B     @RC01131                                            1137
@RF01131 MVC   @AL00001(8),@AL01137                                1137
         LA    @15,ERRFIELD                                        1137
         ST    @15,@AFTEMPS+20                                     1137
         LA    @15,@AFTEMPS+20                                     1137
         ST    @15,@AL00001+8                                      1137
         LA    @01,@AL00001                                        1137
         BAL   @14,ERROR2                                          1137
*        END GETQUOTD;                                             1138
*                                                                  1138
*                                                                  1138
@EL00013 DS    0H                                                  1138
@EF00013 DS    0H                                                  1138
@ER00013 LM    @14,@12,@SA00013                                    1138
         BR    @14                                                 1138
*        END GETDATA;                                              1139
@EL00011 DS    0H                                                  1139
@EF00011 DS    0H                                                  1139
@ER00011 LM    @14,@12,@SA00011                                    1139
         BR    @14                                                 1139
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - BUILDFDT                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE PLACES EXTRACTED SCALARS INTO THE       */
*/*             FUNCTION DATA TABLE (FDT), AFTER CONVERTING THEM IF  */
*/*             NECESSARY.  THE ROUTINE IS PERFORMED ONCE FOR EACH   */
*/*             SCALAR.  SPACE IS OBTAINED AS NECESSARY IN ORDER TO  */
*/*             STORE THE SCALARS.  SEMANTIC CHECKING IS PERFORMED   */
*/*             ON THE SCALAR ITEMS USING THE COMMAND DESCRIPTOR.    */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          PWORD -   SWITCH INDICATING WHETHER A PASSWORD IS NOW   */
*/*                    BEING PLACED INTO THE FDT.                    */
*/*          SYNUNIT - CONTAINS SCALAR ITEM TO BE PLACED INTO THE FDT*/
*/*          UNITINDX- LENGTH OF SCALAR TO BE PLACED INTO THE FDT    */
*/*          ORGSIGN - CONTAINS CODE INDICATING FORM IN WHICH THE    */
*/*                    SCALAR WAS INPUT (HEX OR BINARY CONSTANT OR   */
*/*                    NEITHER)                                      */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR IS DETECTED               */
*/*          SCLRCNT - NUMBER OF SCALAR LIST ITEMS EXTRACTED UP UNTIL*/
*/*                    NOW                                           */
*/*          DATAPTR - POINTER TO SCALAR DATA STRUCTURE FOR CURRENT  */
*/*                    PARAMETER                                     */
*/*          SPACELFT- SPACE REMAINING FROM THAT ALLOCATED FOR A     */
*/*                    SCALAR LIST DATA STRUCTURE                    */
*/*          SPACEAMT- AMOUNT OF SPACE REQUIRED FOR EACH SCALAR ITEM */
*/*                    IN THE SCALAR LIST DATA STRUCTURE             */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE (FDT) DATA ENTRIES                  */
*/*          PWORD -   SEE 'INPUT'                                   */
*/*          SCLRCNT - NUMBER OF SCALAR LIST ITEMS EXTRACTED         */
*/*          SPACELFT- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*BUILDFDT:PROCEDURE;                                               1140
BUILDFDT STM   @14,@12,@SA00014                                    1140
*        /************************************************************/
*        /*                                                          */
*        /* BUILDFDT PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1141
*        /*FULLWORD BINARY CONSTANT DATA FORM                        */
*                                                                  1141
*        DCL FULLWORD FIXED(31) BASED(DATAPTR);                    1141
*                                                                  1141
*        /*STRING CONSTANT DATA FORM                                 */
*                                                                  1142
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1142
*              2 STRINGLN FIXED(8),    /*LENGTH OF STRING            */
*              2 STRING   CHAR(*);     /*THE STRING ITEM ITSELF      */
*                                                                  1142
*        /*CHARACTER STRING (W/ PASSWORD) CONSTANT DATA FORM         */
*                                                                  1143
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1143
*              2 PASSWDLN FIXED(8),    /*LENGTH OF PASSWORD          */
*              2 PASSWORD CHAR(8),     /*THE PASSWORD ITSELF         */
*              2 CHARLN   FIXED(8),    /*CHAR. STRING LENGTH         */
*              2 CHARS    CHAR(*);     /*THE CHARACTER STRING ITSELF */
*                                                                  1143
*        /*DATA SET NAME CONSTANT DATA FORM                          */
*                                                                  1144
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1144
*              2 DSPWDLN  FIXED(8),    /*LENGTH OF PASSWORD          */
*              2 DSPWORD  CHAR(8),     /*PASSWORD                    */
*              2 STARPOS  FIXED(8),    /*ASTERISK POSITION           */
*                                      /* IN GENERIC DSNAME          */
*              2 UNQTFLG  BIT(1),      /*SET 'ON' IF DSNAME          */
*                                      /* WAS INPUT WITHIN           */
*                                      /* QUOTES IN THE TSO          */
*                                      /* ENVIRONMENT                */
*              2 MEMNAMLN FIXED(8),    /*MEMBER NAME LENGTH          */
*              2 MEMNAME  CHAR(8),     /*MEMBER NAME                 */
*              2 DSNAMELN FIXED(8),    /*LENGTH OF MAIN PART         */
*                                      /* OF THE DSNAME              */
*              2 DSNAME   CHAR(44);    /*MAIN PART OF DATA SET NAME  */
*                                                                  1144
*        /*BINARY FULLWORD CONSTANT LIST DATA FORM                   */
*                                                                  1145
*        DCL 1 * BASED(DATAPTR) BDY(WORD),                         1145
*              2 FULLWDCT FIXED(31),   /*NO. OF FULLWORDS IN THE LIST*/
*              2 LFULLWD(*) FIXED(31); /*LIST OF FULLWORDS           */
*                                                                  1145
*        /*STRING CONSTANT LIST DATA FORM                            */
*                                                                  1146
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1146
*              2 STRINGCT FIXED(15),   /*# OF STRINGS LISTED         */
*              2 LSTRINGL FIXED(8),    /*LENGTH OF STRING            */
*              2 LSTRING  CHAR(*);     /*SCALAR ITEM                 */
*                                                                  1146
*        /*STRING (W/ PASSWORD) CONSTANT LIST DATA FORM              */
*                                                                  1147
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1147
*              2 CHARCT   FIXED(15),   /*# OF STRING SCALARS IN LIST */
*              2 LCHRPWDL FIXED(8),    /*LENGTH OF PASSWORD          */
*              2 LCHRPWD  CHAR(8),     /*PASSWORD AT END OF STRING   */
*              2 LCHARLN  FIXED(8),    /*LENGTH OF STRING            */
*              2 LCHAR    CHAR(*);     /*CHARACTER STRING ITEM       */
*                                                                  1147
*        /*DATA SET NAME CONSTANT LIST DATA FORM                     */
*                                                                  1148
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1148
*              2 DSNAMECT FIXED(15),   /*# OF DSNAMES IN LIST        */
*              2 * (*) BDY(HWORD),     /*ARRAY (LIST) OF DATA        */
*                3 LDSNPWDL FIXED(8),  /*PASSWORD LENGTH             */
*                3 LDSNPWD  CHAR(8),   /*PASSWORD AT END OF STRING   */
*                3 LSTARPOS FIXED(8),  /*ASTERISK POSITION           */
*                                      /* IN GENERIC DSNAME          */
*                3 LUNQTFLG BIT(1),    /*SET 'ON' IF DSNAME          */
*                                      /* WAS INPUT WITHIN           */
*                                      /* QUOTES IN THE TSO          */
*                                      /* ENVIRONMENT                */
*                3 LMEMNAML FIXED(8),  /*MEMBER NAME LENGTH          */
*                3 LMEMNAME CHAR(8),   /*MEMBER NAME (IF ANY)        */
*                3 LDSNAMEL FIXED(8),  /*LENGTH OF DSNAME            */
*                3 LDSNAME  CHAR(44);  /*MAIN PART OF DATA SET NAME  */
*                                                                  1148
*        /*STATIC ERROR MESSAGE CODES                                */
*                                                                  1149
*        DCL BADLIST  FIXED(31)        /*TOO MANY SCALARS IN LIST    */
*                     CONSTANT(24);                                1149
*                                                                  1149
*        /*OTHER VARIABLES                                           */
*                                                                  1150
*        DCL ELTPTR   PTR(31);         /*PTR TO FDT STORAGE AREA FOR
*                                        SCALAR LIST ELEMENT         */
*        DCL DATALEN  FIXED(15);       /*AMOUNT OF EXTRACTED DATA TO
*                                        MOVE INTO AN FDT SLOT       */
*        DCL CHSTRING BIT(1);          /*SET 'ON' IF INPUT           */
*                                      /* CONSTANT IS NOT A          */
*                                      /* DECIMAL, HEX, OR           */
*                                      /* BINARY CONSTANT            */
*        /************************************************************/
*        /*                                                          */
*        /*  ** BUILDFDT **  PLACE SCALAR INTO FUNCTION DATA TABLE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1153
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE THE BASIC FORMAT OF THE CONSTANT.              */
*        /* CONSTANTS ALLOWING PASSWORDS CANNOT BE CODED             */
*        /* IN HEXADECIMAL FORMAT.                                   */
*        /*                                                          */
*        /************************************************************/
*        IF ANYSTRNG=YES                                           1153
*          THEN                                                    1153
         LA    @15,12                                              1153
         LR    @14,@15                                             1153
         MH    @14,PARMID                                          1153
         L     @01,WORKPTR                                         1153
         AL    @01,@CF01317                                        1153
         AL    @15,PARMPTR(@14,@01)                                1153
         TM    ANYSTRNG(@15),B'01000000'                           1153
         BNO   @RF01153                                            1153
*            IF ORGSIGN=BLANK                                      1154
*              THEN                                                1154
         CLI   ORGSIGN,C' '                                        1154
         BNE   @RF01154                                            1154
*                CHSTRING=YES;                                     1155
         OI    CHSTRING,B'10000000'                                1155
*              ELSE                                                1156
*                IF PWORDOPT=YES                                   1156
*                  THEN                                            1156
         B     @RC01154                                            1156
@RF01154 LA    @15,12                                              1156
         LR    @14,@15                                             1156
         MH    @14,PARMID                                          1156
         L     @01,WORKPTR                                         1156
         AL    @01,@CF01317                                        1156
         AL    @15,PARMPTR(@14,@01)                                1156
         TM    PWORDOPT(@15),B'00000010'                           1156
         BNO   @RF01156                                            1156
*                    DO;                                           1157
*                                                                  1157
*                    CALL ERROR2(BADITEM,LENGTH(ERRFIELD),         1158
*                                ADDR(ERRFIELD));                  1158
*                                                                  1158
         MVC   @AL00001(8),@AL01158                                1158
         LA    @15,ERRFIELD                                        1158
         ST    @15,@AFTEMPS+32                                     1158
         LA    @15,@AFTEMPS+32                                     1158
         ST    @15,@AL00001+8                                      1158
         LA    @01,@AL00001                                        1158
         BAL   @14,ERROR2                                          1158
*                    RETURN;                                       1159
@EL00014 DS    0H                                                  1159
@EF00014 DS    0H                                                  1159
@ER00014 LM    @14,@12,@SA00014                                    1159
         BR    @14                                                 1159
*                    END;                                          1160
*                  ELSE                                            1161
*                    CHSTRING=NO;                                  1161
@RF01156 NI    CHSTRING,B'01111111'                                1161
*          ELSE                                                    1162
*            CHSTRING=NO;                                          1162
*                                                                  1162
         B     @RC01153                                            1162
@RF01153 NI    CHSTRING,B'01111111'                                1162
*        IF SCALAR=YES                                             1163
*                                                                  1163
*          /**********************************************************/
*          /*                                                        */
*          /* WHEN A SINGLE SCALAR (AS OPPOSED TO A SCALAR LIST)     */
*          /* IS BEING PROCESSED, GET NECESSARY SPACE, CHECK TO SEE  */
*          /* WHAT KIND OF SCALAR IT IS, AND STORE THE SCALAR AND    */
*          /* ASSOCIATED DATA.                                       */
*          /*                                                        */
*          /**********************************************************/
*          THEN                                                    1163
@RC01153 LH    @15,PARMID                                          1163
         MH    @15,@CH00038                                        1163
         L     @01,WORKPTR                                         1163
         AL    @01,@CF01317                                        1163
         L     @01,PARMPTR(@15,@01)                                1163
         TM    SCALAR(@01),B'00010000'                             1163
         BNO   @RF01163                                            1163
*            IF PWORD=NOW                                          1164
*                                                                  1164
*              /******************************************************/
*              /*                                                    */
*              /*  WHEN THE SCALAR IS A PASSWORD, STORE IT IN THE    */
*              /*  ALREADY EXISTING DATA STRUCTURE (EITHER A CHAR.   */
*              /*  STRING OR DATA SET NAME DATA STRUCTURE), FIRST    */
*              /*  CHECKING THAT IT DOESN'T EXCEED THE LENGTH LIMIT. */
*              /*  ALSO STORE THE LENGTH OF THE PASSWORD.            */
*              /*                                                    */
*              /******************************************************/
*              THEN                                                1164
         CLC   PWORD(2),@CH00144                                   1164
         BNE   @RF01164                                            1164
*                IF UNITINDX > LENGTH(PASSWORD)                    1165
*                  THEN                                            1165
*                                                                  1165
         LH    @15,UNITINDX                                        1165
         CH    @15,@CH00042                                        1165
         BNH   @RF01165                                            1165
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1166
*                                ADDR(ERRFIELD));                  1166
*                                                                  1166
         MVC   @AL00001(8),@AL01166                                1166
         LA    @15,ERRFIELD                                        1166
         ST    @15,@AFTEMPS+32                                     1166
         LA    @15,@AFTEMPS+32                                     1166
         ST    @15,@AL00001+8                                      1166
         LA    @01,@AL00001                                        1166
         BAL   @14,ERROR2                                          1166
*                  ELSE                                            1167
*                    IF ANYSTRNG=YES                               1167
*                      THEN                                        1167
         B     @RC01165                                            1167
@RF01165 LA    @15,12                                              1167
         LR    @14,@15                                             1167
         MH    @14,PARMID                                          1167
         L     @01,WORKPTR                                         1167
         AL    @01,@CF01317                                        1167
         AL    @15,PARMPTR(@14,@01)                                1167
         TM    ANYSTRNG(@15),B'01000000'                           1167
         BNO   @RF01167                                            1167
*                        DO;                                       1168
*                        PWORD=NONE;                               1169
         SLR   @15,@15                                             1169
         STH   @15,PWORD                                           1169
*                        PASSWDLN=UNITINDX;                        1170
         L     @15,DATAPTR                                         1170
         MVC   PASSWDLN(1,@15),UNITINDX+1                          1170
*                        PASSWORD=SYNUNIT;                         1171
         MVC   PASSWORD(8,@15),SYNUNIT                             1171
*                        END;                                      1172
*                      ELSE                                        1173
*                        DO;                                       1173
         B     @RC01167                                            1173
@RF01167 DS    0H                                                  1174
*                        PWORD=NONE;                               1174
         SLR   @15,@15                                             1174
         STH   @15,PWORD                                           1174
*                        DSPWDLN=UNITINDX;                         1175
         L     @15,DATAPTR                                         1175
         MVC   DSPWDLN(1,@15),UNITINDX+1                           1175
*                        DSPWORD=SYNUNIT;                          1176
         MVC   DSPWORD(8,@15),SYNUNIT                              1176
*                        END;                                      1177
*                                                                  1177
*              /******************************************************/
*              /*                                                    */
*              /*  IF NOT A PASSWORD, ALLOCATE SPACE FOR THE SCALAR  */
*              /*  AND ITS ASSOCIATED DATA.  THEN STORE THE SCALAR   */
*              /*  AND ITS LENGTH INTO THIS DATA AREA BASED UPON     */
*              /*  THE TYPE OF SCALAR THAT IT IS, CHECKING THAT THE  */
*              /*  SCALAR LENGTH LIMIT IS NOT EXCEEDED.              */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1178
*DOGRP70:        DO;                                               1178
*                                                                  1178
         B     @RC01164                                            1178
@RF01164 DS    0H                                                  1178
DOGRP70  DS    0H                                                  1179
*                CALL GETSPACE;                                    1179
*                                                                  1179
         BAL   @14,GETSPACE                                        1179
*                IF CHSTRING=YES & UNITINDX > MAXLNGTH             1180
*                  THEN                                            1180
*                                                                  1180
         TM    CHSTRING,B'10000000'                                1180
         BNO   @RF01180                                            1180
         LA    @15,12                                              1180
         LR    @14,@15                                             1180
         MH    @14,PARMID                                          1180
         L     @01,WORKPTR                                         1180
         AL    @01,@CF01317                                        1180
         AL    @15,PARMPTR(@14,@01)                                1180
         LH    @14,UNITINDX                                        1180
         MVC   @ZT00003+3(1),MAXLNGTH(@15)                         1180
         C     @14,@ZT00003                                        1180
         BNH   @RF01180                                            1180
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1181
*                               ADDR(ERRFIELD));                   1181
*                                                                  1181
         MVC   @AL00001(8),@AL01181                                1181
         LA    @15,ERRFIELD                                        1181
         ST    @15,@AFTEMPS+32                                     1181
         LA    @15,@AFTEMPS+32                                     1181
         ST    @15,@AL00001+8                                      1181
         LA    @01,@AL00001                                        1181
         BAL   @14,ERROR2                                          1181
*                IF RISTATUS=0                                     1182
*                  THEN                                            1182
@RF01180 LH    @15,RISTATUS                                        1182
         LTR   @15,@15                                             1182
         BNZ   @RF01182                                            1182
*DOGRP75:            DO;                                           1183
DOGRP75  DS    0H                                                  1184
*                    IF CHSTRING=YES                               1184
*                                                                  1184
*                      /**********************************************/
*                      /*                                            */
*                      /*  WHEN THE SCALAR IS A CHARACTER STRING,    */
*                      /*  STORE IT INTO THE FDT IN THE FORM OF A    */
*                      /*  STRING OR A CHAR. STRING WITH PASSWORD    */
*                      /*                                            */
*                      /**********************************************/
*                      THEN                                        1184
         TM    CHSTRING,B'10000000'                                1184
         BNO   @RF01184                                            1184
*                        DO;                                       1185
*                        IF PWORDOPT=YES                           1186
*                          THEN                                    1186
         LA    @15,12                                              1186
         LR    @14,@15                                             1186
         MH    @14,PARMID                                          1186
         L     @01,WORKPTR                                         1186
         AL    @01,@CF01317                                        1186
         AL    @15,PARMPTR(@14,@01)                                1186
         TM    PWORDOPT(@15),B'00000010'                           1186
         BNO   @RF01186                                            1186
*                            DO;                                   1187
*                            CHARLN=UNITINDX;                      1188
         L     @14,DATAPTR                                         1188
         MVC   CHARLN(1,@14),UNITINDX+1                            1188
*                            CHARS(1:MAXLNGTH)=SYNUNIT;            1189
         SLR   @05,@05                                             1189
         IC    @05,MAXLNGTH(,@15)                                  1189
         BCTR  @05,0                                               1189
         EX    @05,@SM01341                                        1189
*                            END;                                  1190
*                          ELSE                                    1191
*                            DO;                                   1191
         B     @RC01186                                            1191
@RF01186 DS    0H                                                  1192
*                            STRINGLN=UNITINDX;                    1192
         L     @15,DATAPTR                                         1192
         MVC   STRINGLN(1,@15),UNITINDX+1                          1192
*                            STRING(1:MAXLNGTH)=SYNUNIT;           1193
         LA    @14,12                                              1193
         LR    @05,@14                                             1193
         MH    @05,PARMID                                          1193
         L     @01,WORKPTR                                         1193
         AL    @01,@CF01317                                        1193
         AL    @14,PARMPTR(@05,@01)                                1193
         SLR   @05,@05                                             1193
         IC    @05,MAXLNGTH(,@14)                                  1193
         BCTR  @05,0                                               1193
         EX    @05,@SM01343                                        1193
*                            END;                                  1194
*                        END;                                      1195
*                                                                  1195
*                      /**********************************************/
*                      /*                                            */
*                      /*  WHEN THE CONSTANT IS HEX, BINARY,         */
*                      /*  OR DECIMAL, THEN PERFORM                  */
*                      /*  NECESSARY CONVERSION BEFORE STORING IT    */
*                      /*  INTO THE FDT.                             */
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        1196
*                        IF NUMBER=YES  ANYSTRNG=YES              1196
*                          THEN                                    1196
*                                                                  1196
         B     @RC01184                                            1196
@RF01184 LA    @15,12                                              1196
         LR    @14,@15                                             1196
         MH    @14,PARMID                                          1196
         L     @01,WORKPTR                                         1196
         AL    @01,@CF01317                                        1196
         AL    @15,PARMPTR(@14,@01)                                1196
         TM    NUMBER(@15),B'11000000'                             1196
         BZ    @RF01196                                            1196
*                            CALL CONVERT;                         1197
*                                                                  1197
         BAL   @14,CONVERT                                         1197
*                          /******************************************/
*                          /*                                        */
*                          /* WHEN NONE OF THE ABOVE DATA TYPES, THE */
*                          /* SCALAR MUST BE A DATA SET IDENTIFIER.  */
*                          /* IT IS STORED IN DSNAME FORM AFTER      */
*                          /* CHECKING DSNAME RESTRICTIONS.          */
*                          /*                                        */
*                          /******************************************/
*                          ELSE                                    1198
*                                                                  1198
*                            CALL DSICKHK;                         1198
*                                                                  1198
         B     @RC01196                                            1198
@RF01196 BAL   @14,DSICKHK                                         1198
*                    END DOGRP75;                                  1199
*                END DOGRP70;                                      1200
*                                                                  1200
*          /**********************************************************/
*          /*                                                        */
*          /* WHEN THE SCALAR BEING HANDLED IS PART OF A SCALAR LIST,*/
*          /* CHECK THAT THE LIST ELEMENT LIMIT IS NOT EXCEEDED,     */
*          /* ALLOCATE SPACE FOR THE LIST DATA (IF NOT ALREADY DONE),*/
*          /* CHECK TO SEE WHAT KIND OF SCALAR DATA IT IS, AND STORE */
*          /* THE DATA INTO THE APPROPRIATE NEW OR EXISTING FDT AREA */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    1201
*            IF PWORD^=NOW                                         1201
*              THEN                                                1201
*                                                                  1201
         B     @RC01163                                            1201
@RF01163 CLC   PWORD(2),@CH00144                                   1201
         BE    @RF01201                                            1201
*                /****************************************************/
*                /*                                                  */
*                /*  THE SCALAR IS NOT A PASSWORD.  IF THIS IS       */
*                /*  FIRST SCALAR ENCOUNTERED IN THE LIST, OBTAIN    */
*                /*  INITIAL FDT SPACE FOR STORING THE SCALARS AND   */
*                /*  THEIR ASSOCIATED DATA.  IF NOT THE FIRST SCALAR,*/
*                /*  ADDITIONAL SPACE MAY HAVE TO BE ALLOCATED.      */
*                /*  ALSO, CHECK THAT THE SCALAR DOES NOT EXCEED ITS */
*                /*  LENGTH LIMIT AND THAT TOO MANY SCALARS HAVE     */
*                /*  BEEN CODED IN THIS CURRENT LIST.                */
*                /*                                                  */
*                /****************************************************/
*DOGRP80:        DO;                                               1202
DOGRP80  DS    0H                                                  1203
*                SCLRCNT=SCLRCNT+1;                                1203
         LA    @15,1                                               1203
         AH    @15,SCLRCNT                                         1203
         STH   @15,SCLRCNT                                         1203
*                IF SCLRCNT > LISTMAX                              1204
*                  THEN                                            1204
*                                                                  1204
         LA    @14,12                                              1204
         LR    @05,@14                                             1204
         MH    @05,PARMID                                          1204
         L     @01,WORKPTR                                         1204
         AL    @01,@CF01317                                        1204
         AL    @14,PARMPTR(@05,@01)                                1204
         MVC   @ZT00003+3(1),LISTMAX(@14)                          1204
         C     @15,@ZT00003                                        1204
         BNH   @RF01204                                            1204
*                    CALL ERROR2(BADLIST,LENGTH(ERRFIELD),         1205
*                                ADDR(ERRFIELD));                  1205
*                                                                  1205
         MVC   @AL00001(8),@AL01205                                1205
         LA    @15,ERRFIELD                                        1205
         ST    @15,@AFTEMPS+32                                     1205
         LA    @15,@AFTEMPS+32                                     1205
         ST    @15,@AL00001+8                                      1205
         LA    @01,@AL00001                                        1205
         BAL   @14,ERROR2                                          1205
*                  ELSE                                            1206
*                    IF SCLRCNT=1                                  1206
*                      THEN                                        1206
         B     @RC01204                                            1206
@RF01204 CLC   SCLRCNT(2),@CH00172                                 1206
         BNE   @RF01206                                            1206
*                        DO;                                       1207
*                                                                  1207
*                        CALL GETSPACE;                            1208
*                                                                  1208
         BAL   @14,GETSPACE                                        1208
*                        ELTPTR=DATAPTR;                           1209
         MVC   ELTPTR(4),DATAPTR                                   1209
*                        END;                                      1210
*                      ELSE                                        1211
*                        DO;                                       1211
         B     @RC01206                                            1211
@RF01206 DS    0H                                                  1212
*                        SPACELFT=SPACELFT-SPACEAMT;               1212
         LH    @15,SPACELFT                                        1212
         SH    @15,SPACEAMT                                        1212
         STH   @15,SPACELFT                                        1212
*                        IF SPACELFT < 0                           1213
*                          THEN                                    1213
         LTR   @15,@15                                             1213
         BNM   @RF01213                                            1213
*                            DO;                                   1214
*                            ELTPTR=ELTPTR-DATAPTR;                1215
*                                                                  1215
         L     @15,ELTPTR                                          1215
         SL    @15,DATAPTR                                         1215
         ST    @15,ELTPTR                                          1215
*                            CALL MORSPACE;                        1216
*                                                                  1216
         BAL   @14,MORSPACE                                        1216
*                            ELTPTR=ELTPTR+DATAPTR;                1217
         L     @15,ELTPTR                                          1217
         AL    @15,DATAPTR                                         1217
         ST    @15,ELTPTR                                          1217
*                            END;                                  1218
*                        END;                                      1219
@RF01213 DS    0H                                                  1220
*                IF CHSTRING=YES & UNITINDX > MAXLNGTH             1220
*                  THEN                                            1220
*                                                                  1220
@RC01206 DS    0H                                                  1220
@RC01204 TM    CHSTRING,B'10000000'                                1220
         BNO   @RF01220                                            1220
         LA    @15,12                                              1220
         LR    @14,@15                                             1220
         MH    @14,PARMID                                          1220
         L     @01,WORKPTR                                         1220
         AL    @01,@CF01317                                        1220
         AL    @15,PARMPTR(@14,@01)                                1220
         LH    @14,UNITINDX                                        1220
         MVC   @ZT00003+3(1),MAXLNGTH(@15)                         1220
         C     @14,@ZT00003                                        1220
         BNH   @RF01220                                            1220
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1221
*                                ADDR(ERRFIELD));                  1221
*                                                                  1221
         MVC   @AL00001(8),@AL01221                                1221
         LA    @15,ERRFIELD                                        1221
         ST    @15,@AFTEMPS+32                                     1221
         LA    @15,@AFTEMPS+32                                     1221
         ST    @15,@AL00001+8                                      1221
         LA    @01,@AL00001                                        1221
         BAL   @14,ERROR2                                          1221
*                IF RISTATUS=0                                     1222
*                                                                  1222
*                  /**************************************************/
*                  /*                                                */
*                  /* STORE THE SCALAR INTO THE PROPER DATA STRUCTURE*/
*                  /* TOGETHER WITH THE OTHER SCALARS OF THE LIST.   */
*                  /*                                                */
*                  /**************************************************/
*                  THEN                                            1222
@RF01220 LH    @15,RISTATUS                                        1222
         LTR   @15,@15                                             1222
         BNZ   @RF01222                                            1222
*                    IF CHSTRING=YES                               1223
*                                                                  1223
*                      /**********************************************/
*                      /*                                            */
*                      /* WHEN THE SCALAR IS IN CHARACTER STRING FORM*/
*                      /*  STORE IT INTO THE FDT IN THE FORM OF A    */
*                      /*  STRING OR A CHAR. STRING WITH PASSWORD    */
*                      /*                                            */
*                      /**********************************************/
*                      THEN                                        1223
         TM    CHSTRING,B'10000000'                                1223
         BNO   @RF01223                                            1223
*DOGRP85:                DO;                                       1224
DOGRP85  DS    0H                                                  1225
*                        IF PWORDOPT=YES                           1225
*                          THEN                                    1225
         LA    @15,12                                              1225
         LR    @14,@15                                             1225
         MH    @14,PARMID                                          1225
         L     @01,WORKPTR                                         1225
         AL    @01,@CF01317                                        1225
         AL    @15,PARMPTR(@14,@01)                                1225
         TM    PWORDOPT(@15),B'00000010'                           1225
         BNO   @RF01225                                            1225
*                            DO;                                   1226
*                            CHARCT=SCLRCNT;                       1227
         L     @01,DATAPTR                                         1227
         MVC   CHARCT(2,@01),SCLRCNT                               1227
*                            ELTPTR->LCHARLN=UNITINDX;             1228
         L     @14,ELTPTR                                          1228
         MVC   LCHARLN(1,@14),UNITINDX+1                           1228
*                            ELTPTR->LCHAR(1:MAXLNGTH)=            1229
*                                                 SYNUNIT;         1229
         SLR   @05,@05                                             1229
         IC    @05,MAXLNGTH(,@15)                                  1229
         BCTR  @05,0                                               1229
         EX    @05,@SM01345                                        1229
*                            END;                                  1230
*                          ELSE                                    1231
*                            DO;                                   1231
         B     @RC01225                                            1231
@RF01225 DS    0H                                                  1232
*                            STRINGCT=SCLRCNT;                     1232
         L     @01,DATAPTR                                         1232
         MVC   STRINGCT(2,@01),SCLRCNT                             1232
*                            ELTPTR->LSTRINGL=UNITINDX;            1233
         L     @15,ELTPTR                                          1233
         MVC   LSTRINGL(1,@15),UNITINDX+1                          1233
*                            ELTPTR->LSTRING(1:MAXLNGTH)=          1234
*                                                 SYNUNIT;         1234
         LA    @14,12                                              1234
         LR    @05,@14                                             1234
         MH    @05,PARMID                                          1234
         L     @01,WORKPTR                                         1234
         AL    @01,@CF01317                                        1234
         AL    @14,PARMPTR(@05,@01)                                1234
         SLR   @05,@05                                             1234
         IC    @05,MAXLNGTH(,@14)                                  1234
         BCTR  @05,0                                               1234
         EX    @05,@SM01347                                        1234
*                            END;                                  1235
*                        /********************************************/
*                        /*                                          */
*                        /* IF NO PASSWORD FOLLOWS THIS SCALAR, THEN */
*                        /* POINT TO WHERE THE NEXT SCALAR LIST      */
*                        /* ELEMENT WILL BE PLACED IN THE FDT.       */
*                        /*                                          */
*                        /********************************************/
*                        IF PWORD ^= NEXT                          1236
*                          THEN                                    1236
@RC01225 CLC   PWORD(2),@CH00172                                   1236
         BE    @RF01236                                            1236
*                            ELTPTR=ELTPTR+SPACEAMT;               1237
         LH    @15,SPACEAMT                                        1237
         AL    @15,ELTPTR                                          1237
         ST    @15,ELTPTR                                          1237
*                        END DOGRP85;                              1238
*                                                                  1238
*                      /**********************************************/
*                      /*                                            */
*                      /*  IF THE SCALAR IS A DECIMAL, HEXADECIMAL,  */
*                      /*  OR BINARY CONSTANT, THEN PERFORM THE      */
*                      /*  NECESSARY CONVERSION BEFORE STORING IT    */
*                      /*  INTO THE FDT.                             */
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        1239
*                        IF NUMBER=YES  ANYSTRNG=YES              1239
*                          THEN                                    1239
*                                                                  1239
         B     @RC01223                                            1239
@RF01223 LA    @15,12                                              1239
         LR    @14,@15                                             1239
         MH    @14,PARMID                                          1239
         L     @01,WORKPTR                                         1239
         AL    @01,@CF01317                                        1239
         AL    @15,PARMPTR(@14,@01)                                1239
         TM    NUMBER(@15),B'11000000'                             1239
         BZ    @RF01239                                            1239
*                            CALL CONVERT;                         1240
*                                                                  1240
         BAL   @14,CONVERT                                         1240
*                          /******************************************/
*                          /*                                        */
*                          /*  WHEN NONE OF THE ABOVE, THE SCALAR IS */
*                          /*  A DATA SET NAME AND IS STORED IN      */
*                          /*  DSID FORM IN THE FDT.  THE NAME MUST  */
*                          /*  CONFORM TO DSNAME RESTRICTIONS.       */
*                          /*                                        */
*                          /******************************************/
*                          ELSE                                    1241
*                                                                  1241
*                            CALL DSICKHK;                         1241
*                                                                  1241
         B     @RC01239                                            1241
@RF01239 BAL   @14,DSICKHK                                         1241
*                END DOGRP80;                                      1242
*                                                                  1242
*              /******************************************************/
*              /*                                                    */
*              /*  WHEN THE EXTRACTED SCALAR IS A PASSWORD ATTACHED  */
*              /*  TO A SCALAR LIST ELEMENT, STORE IT IN THE DATA    */
*              /*  AREA OF THE APPROPRIATE CHAR. STRING OR DSNAME    */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1243
*                DO;                                               1243
         B     @RC01201                                            1243
@RF01201 DS    0H                                                  1244
*                PWORD=NONE;                                       1244
         SLR   @15,@15                                             1244
         STH   @15,PWORD                                           1244
*                IF UNITINDX > LENGTH(PASSWORD)                    1245
*                  THEN                                            1245
*                                                                  1245
         LH    @15,UNITINDX                                        1245
         CH    @15,@CH00042                                        1245
         BNH   @RF01245                                            1245
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1246
*                                ADDR(ERRFIELD));                  1246
*                                                                  1246
         MVC   @AL00001(8),@AL01246                                1246
         LA    @15,ERRFIELD                                        1246
         ST    @15,@AFTEMPS+32                                     1246
         LA    @15,@AFTEMPS+32                                     1246
         ST    @15,@AL00001+8                                      1246
         LA    @01,@AL00001                                        1246
         BAL   @14,ERROR2                                          1246
*                  ELSE                                            1247
*                    IF ANYSTRNG=YES                               1247
*                      THEN                                        1247
         B     @RC01245                                            1247
@RF01245 LA    @15,12                                              1247
         LR    @14,@15                                             1247
         MH    @14,PARMID                                          1247
         L     @01,WORKPTR                                         1247
         AL    @01,@CF01317                                        1247
         AL    @15,PARMPTR(@14,@01)                                1247
         TM    ANYSTRNG(@15),B'01000000'                           1247
         BNO   @RF01247                                            1247
*                        DO;                                       1248
*                        ELTPTR->LCHRPWDL=UNITINDX;                1249
         L     @15,ELTPTR                                          1249
         MVC   LCHRPWDL(1,@15),UNITINDX+1                          1249
*                        ELTPTR->LCHRPWD=SYNUNIT;                  1250
         MVC   LCHRPWD(8,@15),SYNUNIT                              1250
*                        ELTPTR=ELTPTR+SPACEAMT;                   1251
         AH    @15,SPACEAMT                                        1251
         ST    @15,ELTPTR                                          1251
*                        END;                                      1252
*                      ELSE                                        1253
*                        DO;                                       1253
         B     @RC01247                                            1253
@RF01247 DS    0H                                                  1254
*                        LDSNPWDL(SCLRCNT)=UNITINDX;               1254
         L     @15,DATAPTR                                         1254
         LH    @14,SCLRCNT                                         1254
         MH    @14,@CH01296                                        1254
         LH    @05,UNITINDX                                        1254
         LA    @04,0(@14,@15)                                      1254
         AL    @04,@CF01349                                        1254
         STC   @05,LDSNPWDL-2(,@04)                                1254
*                        LDSNPWD(SCLRCNT)=SYNUNIT;                 1255
         ALR   @15,@14                                             1255
         AL    @15,@CF01350                                        1255
         MVC   LDSNPWD-3(8,@15),SYNUNIT                            1255
*                        END;                                      1256
*                END;                                              1257
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - CONVERT                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CONVERTS DECIMAL, BINARY, OR HEXADECIMAL*/
*/*             CONSTANTS FROM EBCDIC FORM INTO THE PROPER INTERNAL  */
*/*             FORM (FULLWORD BINARY OR HEXIDECIMAL DIGIT STRING,   */
*/*             BASED UPON THE COMMAND DESCRIPTOR SPECIFICATION).    */
*/*             THE CONSTANTS ARE CHECKED TO INSURE THAT THEY ARE    */
*/*             SYNTACTICALLY AND SEMANTICALLY CORRECT AND ARE THEN  */
*/*             PLACED INTO THE FDT IN CONVERTED FORM.               */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          SYNUNIT - CONTAINS THE CONSTANT IN EBCDIC FORM WHICH IS */
*/*                    TO BE CONVERTED.                              */
*/*          UNITINDX- LENGTH OF EBCDIC CONSTANT                     */
*/*          ORGSIGN - CONTAINS CODE INDICATING FORM IN WHICH THE    */
*/*                    SCALAR WAS INPUT (AS A HEX, BINARY OR DECIMAL */
*/*                    CONSTANT).                                    */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR HAS BEEN DETECTED         */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE DATA ENTRIES.                       */
*/*          SYNUNIT - CONSTANT IN CONVERTED FORM                    */
*/*          CNVRTFLD- CONSTANT IN BINARY FULLWORD CONVERTED FORM    */
*/*                                                                  */
*/********************************************************************/
*CONVERT:PROCEDURE;                                                1258
         B     @PB00015                                            1258
CONVERT  STM   @14,@12,@SA00015                                    1258
*        /************************************************************/
*        /*                                                          */
*        /* DATA DEFINITIONS FOR CONVERT ROUTINE                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1259
*        DCL HEXTABLE(16) CHAR(1)      /*HEX DIGITS IN EBCDIC FORM   */
*                         INIT('0','1','2','3','4','5','6','7',    1259
*                              '8','9','A','B','C','D','E','F');   1259
*        DCL WORKVAL  FIXED(31);       /*FULLWORD WORK AREA USED   1260
*                                        DURING CONVERSION           */
*        DCL TWOPOWER FIXED(15);       /*COMPUTED POWER OF 2         */
*        DCL CNVRTVAL FIXED(8);        /*1-BYTE WORK AREA USED     1262
*                                        DURING CONVERSION           */
*        DCL DIGTINDX FIXED(15);       /*INDEX INDICATING CURRENT  1263
*                                        LENGTH OF CONVERTED PORTION
*                                        OF CONSTANT BEING CONVERTED */
*                                                                  1263
*        DCL ZEROHALF BIT(8)           /*BIT MASK USED TO SET UPPER  */
*                CONSTANT('00001111'B);/* HALF OF A BYTE TO ZEROES   */
*        /************************************************************/
*        /*                                                          */
*        /*  ** CONVERT **  CONVERT DIGIT STRINGS TO INTERNAL FORM   */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1265
*          THEN;                                                   1265
         L     @01,GDTPTR                                          1265
         L     @15,GDTDBG(,@01)                                    1265
         LTR   @15,@15                                             1265
         BZ    @RT01265                                            1265
*          ELSE                                                    1267
*            CALL ICKDB010(GDTTBL,'RICV');                         1267
*                                                                  1267
         L     @15,GDTPTR                                          1267
         ST    @15,@AL00001                                        1267
         LA    @14,@CC01062                                        1267
         ST    @14,@AL00001+4                                      1267
         MVI   @AL00001+4,X'80'                                    1267
         L     @15,GDTDBG(,@15)                                    1267
         LA    @01,@AL00001                                        1267
         BALR  @14,@15                                             1267
*        /************************************************************/
*        /*                                                          */
*        /* IF THE INPUT DIGIT STRING IS A DECIMAL NUMBER, CONVERT   */
*        /* IT TO A BINARY FULLWORD.                                 */
*        /*                                                          */
*        /************************************************************/
*        IF ORGSIGN=BLANK                                          1268
*          THEN                                                    1268
*                                                                  1268
@RT01265 CLI   ORGSIGN,C' '                                        1268
         BNE   @RF01268                                            1268
*            CALL PACKCVB;                                         1269
*                                                                  1269
         BAL   @14,PACKCVB                                         1269
*          ELSE                                                    1270
*DOGRP90:    DO;                                                   1270
*                                                                  1270
         B     @RC01268                                            1270
@RF01268 DS    0H                                                  1270
DOGRP90  DS    0H                                                  1271
*            /********************************************************/
*            /*                                                      */
*            /* IF THE DIGIT STRING IS A BINARY CONSTANT, CONVERT IT */
*            /* INTO A STRING OF HEXADECIMAL DIGITS (NO LONGER IN    */
*            /* EBCDIC FORM).  BEFORE CONVERSION, CHECK ALL THE      */
*            /* DIGITS IN THE CONSTANT TO BE SURE THEY ARE BINARY    */
*            /* DIGITS, AND IF THE STRING IS A BINARY NUMBER, THEN   */
*            /* CHECK THAT IT DOESN'T EXCEED THE BINARY FULLWORD     */
*            /* SIZE LIMIT.                                          */
*            /*                                                      */
*            /********************************************************/
*            IF ORGSIGN=BINSIGN                                    1271
*              THEN                                                1271
         CLI   ORGSIGN,C'B'                                        1271
         BNE   @RF01271                                            1271
*                IF NUMBER=YES & UNITINDX > 32                     1272
*                  THEN                                            1272
*                                                                  1272
         LA    @15,12                                              1272
         LR    @14,@15                                             1272
         MH    @14,PARMID                                          1272
         L     @01,WORKPTR                                         1272
         AL    @01,@CF01317                                        1272
         AL    @15,PARMPTR(@14,@01)                                1272
         TM    NUMBER(@15),B'10000000'                             1272
         BNO   @RF01272                                            1272
         LH    @15,UNITINDX                                        1272
         CH    @15,@CH00218                                        1272
         BNH   @RF01272                                            1272
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1273
*                                ADDR(ERRFIELD));                  1273
*                                                                  1273
         MVC   @AL00001(8),@AL01273                                1273
         LA    @15,ERRFIELD                                        1273
         ST    @15,@AFTEMPS+24                                     1273
         LA    @15,@AFTEMPS+24                                     1273
         ST    @15,@AL00001+8                                      1273
         LA    @01,@AL00001                                        1273
         BAL   @14,ERROR2                                          1273
*                  ELSE                                            1274
*DOGRP95:            DO;                                           1274
         B     @RC01272                                            1274
@RF01272 DS    0H                                                  1274
DOGRP95  DS    0H                                                  1275
*                      OLDERID2 = NEWERID2;                        1275
         L     @01,GDTPTR                                          1275
         L     @15,GDTTR2(,@01)                                    1275
         MVC   @TS00001(95),NEWERID2(@15)                          1275
         MVC   OLDERID2(95,@15),@TS00001                           1275
*                      NEWID2='RI24';                              1276
*                                                                  1276
         MVC   NEWID2(4,@15),@CC01067                              1276
*                      /**********************************************/
*                      /*                                            */
*                      /* CHECK THE DIGITS ONE AT A TIME; IF A DIGIT */
*                      /* IS A 1 OR 0 (X'F1' OR X'F0' IN EBCDIC) THEN*/
*                      /* SET THE HIGHER ORDER 4 BITS TO ZEROES.     */
*                      /*                                            */
*                      /**********************************************/
*                      DO INDEX=1 TO UNITINDX WHILE(RISTATUS=0);   1277
         LA    @15,1                                               1277
         B     @DE01277                                            1277
@DL01277 LH    @14,RISTATUS                                        1277
         LTR   @14,@14                                             1277
         BNZ   @DC01277                                            1277
*                        IF SYNUNIT(INDEX) ^= '1'  &               1278
*                           SYNUNIT(INDEX) ^= '0'                  1278
*                          THEN                                    1278
*                                                                  1278
         LA    @14,SYNUNIT-1(@15)                                  1278
         CLI   0(@14),C'1'                                         1278
         BE    @RF01278                                            1278
         LA    @14,SYNUNIT-1(@15)                                  1278
         CLI   0(@14),C'0'                                         1278
         BE    @RF01278                                            1278
*                            CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),
*                                        ADDR(ERRFIELD));          1279
*                                                                  1279
         MVC   @AL00001(8),@AL01279                                1279
         LA    @15,ERRFIELD                                        1279
         ST    @15,@AFTEMPS+24                                     1279
         LA    @15,@AFTEMPS+24                                     1279
         ST    @15,@AL00001+8                                      1279
         LA    @01,@AL00001                                        1279
         BAL   @14,ERROR2                                          1279
*                          ELSE                                    1280
*                            SYNUNIT(INDEX)=SYNUNIT(INDEX) & ZEROHALF;
         B     @RC01278                                            1280
@RF01278 LH    @01,INDEX                                           1280
         LA    @15,SYNUNIT-1(@01)                                  1280
         NI    0(@15),B'00001111'                                  1280
*                      END;                                        1281
@RC01278 LA    @15,1                                               1281
         AH    @15,INDEX                                           1281
@DE01277 STH   @15,INDEX                                           1281
         CH    @15,UNITINDX                                        1281
         BNH   @DL01277                                            1281
@DC01277 DS    0H                                                  1282
*                    IF RISTATUS=0                                 1282
*                      THEN                                        1282
*                                                                  1282
         LH    @15,RISTATUS                                        1282
         LTR   @15,@15                                             1282
         BNZ   @RF01282                                            1282
*                        /********************************************/
*                        /*                                          */
*                        /* CONVERT THE MODIFIED STRING INTO A HEX   */
*                        /* DIGIT STRING INTERNALLY BY CONVERTING A  */
*                        /* EACH BYTE'S WORTH OF BINARY DIGITS INTO A*/
*                        /* VALUE BETWEEN 0 AND 255 (MULTIPLY THE    */
*                        /* BINARY DIGITS BY POWERS OF 2 INCREASING  */
*                        /* LOW ORDER TO HIGH ORDER).  STORE THE     */
*                        /* STRING OF 1-BYTE VALUES BACK INTO THE    */
*                        /* SAME WORK AREA THAT CONTAINS THE MODIFIED*/
*                        /* DIGIT STRING.                            */
*                        /*                                          */
*                        /********************************************/
*DOGRP100:               DO;                                       1283
DOGRP100 DS    0H                                                  1284
*                        WORKVAL=UNITINDX//8;                      1284
         LH    @00,UNITINDX                                        1284
         SRDA  @00,32                                              1284
         D     @00,@CF00042                                        1284
         ST    @00,WORKVAL                                         1284
*                        DIGTINDX=0;                               1285
*                                                                  1285
         SLR   @01,@01                                             1285
         STH   @01,DIGTINDX                                        1285
*                        /********************************************/
*                        /*                                          */
*                        /* IF THE NUMBER OF DIGITS IN THE STRING IS */
*                        /* NOT A MULTIPLE OF 8, FIRST CONVERT JUST  */
*                        /* THE ODD NUMBER OF DIGITS INTO A VALUE    */
*                        /* BETWEEN 0 AND 255.                       */
*                        /*                                          */
*                        /********************************************/
*                        IF WORKVAL ^= 0                           1286
*                          THEN                                    1286
         CR    @00,@01                                             1286
         BE    @RF01286                                            1286
*                            DO;                                   1287
*                              CNVRTVAL=0;                         1288
         MVI   CNVRTVAL,X'00'                                      1288
*                              TWOPOWER=1;                         1289
         MVC   TWOPOWER(2),@CH00172                                1289
*                              DO INDEX2=WORKVAL TO 1 BY -1;       1290
         STH   @00,INDEX2                                          1290
         B     @DE01290                                            1290
@DL01290 DS    0H                                                  1291
*                                CNVRTVAL=CNVRTVAL+                1291
*                                         DIGITVAL(INDEX2)*TWOPOWER;
         LH    @01,TWOPOWER                                        1291
         LR    @15,@00                                             1291
         SLR   @03,@03                                             1291
         IC    @03,DIGITVAL-1(@15)                                 1291
         MR    @02,@01                                             1291
         MVC   @ZT00003+3(1),CNVRTVAL                              1291
         AL    @03,@ZT00003                                        1291
         STC   @03,CNVRTVAL                                        1291
*                                TWOPOWER=TWOPOWER*2;              1292
         ALR   @01,@01                                             1292
         STH   @01,TWOPOWER                                        1292
*                              END;                                1293
         BCTR  @00,0                                               1293
         STH   @00,INDEX2                                          1293
@DE01290 LTR   @00,@00                                             1293
         BP    @DL01290                                            1293
*                              DIGITVAL(1)=CNVRTVAL;               1294
         MVC   DIGITVAL(1),CNVRTVAL                                1294
*                              DIGTINDX=1;                         1295
         MVC   DIGTINDX(2),@CH00172                                1295
*                            END;                                  1296
*                                                                  1296
*                        /********************************************/
*                        /*                                          */
*                        /* CONVERT EACH GROUP OF 8 BINARY DIGITS    */
*                        /* INTO A ONE-BYTE VALUE, CREATING A STRING */
*                        /* OF THESE VALUES.                         */
*                        /*                                          */
*                        /********************************************/
*                        DO INDEX=WORKVAL+1 TO UNITINDX BY 8;      1297
@RF01286 LA    @15,1                                               1297
         AL    @15,WORKVAL                                         1297
         STH   @15,INDEX                                           1297
         B     @DE01297                                            1297
@DL01297 DS    0H                                                  1298
*                          CNVRTVAL=0;                             1298
         MVI   CNVRTVAL,X'00'                                      1298
*                          TWOPOWER=1;                             1299
         MVC   TWOPOWER(2),@CH00172                                1299
*                          DO INDEX2=INDEX+7 TO INDEX BY -1;       1300
         AH    @15,@CH00043                                        1300
         STH   @15,INDEX2                                          1300
         B     @DE01300                                            1300
@DL01300 DS    0H                                                  1301
*                            CNVRTVAL=CNVRTVAL+                    1301
*                                     DIGITVAL(INDEX2)*TWOPOWER;   1301
         LH    @14,TWOPOWER                                        1301
         SLR   @01,@01                                             1301
         IC    @01,DIGITVAL-1(@15)                                 1301
         MR    @00,@14                                             1301
         MVC   @ZT00003+3(1),CNVRTVAL                              1301
         AL    @01,@ZT00003                                        1301
         STC   @01,CNVRTVAL                                        1301
*                            TWOPOWER=TWOPOWER*2;                  1302
         ALR   @14,@14                                             1302
         STH   @14,TWOPOWER                                        1302
*                          END;                                    1303
         BCTR  @15,0                                               1303
         STH   @15,INDEX2                                          1303
@DE01300 CH    @15,INDEX                                           1303
         BNL   @DL01300                                            1303
*                          DIGTINDX=DIGTINDX+1;                    1304
         LA    @15,1                                               1304
         AH    @15,DIGTINDX                                        1304
         STH   @15,DIGTINDX                                        1304
*                          DIGITVAL(DIGTINDX)=CNVRTVAL;            1305
         SLR   @14,@14                                             1305
         IC    @14,CNVRTVAL                                        1305
         STC   @14,DIGITVAL-1(@15)                                 1305
*                        END;                                      1306
         LA    @15,8                                               1306
         AH    @15,INDEX                                           1306
         STH   @15,INDEX                                           1306
@DE01297 CH    @15,UNITINDX                                        1306
         BNH   @DL01297                                            1306
*                        END DOGRP100;                             1307
*                    END DOGRP95;                                  1308
*                                                                  1308
*                /****************************************************/
*                /*                                                  */
*                /* IF THE INPUT IS NOT A DECIMAL OR BINARY CONSTANT */
*                /* THEN IT MUST BE A HEXADECIMAL CONSTANT.          */
*                /*                                                  */
*                /****************************************************/
*                ELSE                                              1309
*                                                                  1309
*                  /**************************************************/
*                  /*                                                */
*                  /* IF THE HEXADECIMAL CONSTANT IS A HEXADECIMAL   */
*                  /* NUMBER, AND IT EXCEEDS THE SIZE THAT WOULD     */
*                  /* FIT INTO A BINARY FULLWORD AFTER CONVERSION,   */
*                  /* THEN IT IS AN ERROR.  OTHERWISE, TAKE THE HEX  */
*                  /* DIGITS (IN EBCDIC FORM) TWO AT A TIME AND      */
*                  /* CONVERT EACH INTO A ONE-BYTE VALUE BETWEEN 0   */
*                  /* AND 255 USING A CONVERSION TABLE.  CREATE A    */
*                  /* STRING OF THESE 1-BYTE VALUES, WHICH WILL THEN */
*                  /* BE A REPRESENTATION OF THE INPUT VALUE, STORING*/
*                  /* THIS STRING BACK WHERE THE EBCDIC DIGITS WERE. */
*                  /*                                                */
*                  /**************************************************/
*                  IF NUMBER=YES & UNITINDX > 8                    1309
*                    THEN                                          1309
*                                                                  1309
         B     @RC01271                                            1309
@RF01271 LA    @15,12                                              1309
         LR    @14,@15                                             1309
         MH    @14,PARMID                                          1309
         L     @01,WORKPTR                                         1309
         AL    @01,@CF01317                                        1309
         AL    @15,PARMPTR(@14,@01)                                1309
         TM    NUMBER(@15),B'10000000'                             1309
         BNO   @RF01309                                            1309
         LH    @15,UNITINDX                                        1309
         CH    @15,@CH00042                                        1309
         BNH   @RF01309                                            1309
*                      CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),      1310
*                                  ADDR(ERRFIELD));                1310
*                                                                  1310
         MVC   @AL00001(8),@AL01310                                1310
         LA    @15,ERRFIELD                                        1310
         ST    @15,@AFTEMPS+24                                     1310
         LA    @15,@AFTEMPS+24                                     1310
         ST    @15,@AL00001+8                                      1310
         LA    @01,@AL00001                                        1310
         BAL   @14,ERROR2                                          1310
*                    ELSE                                          1311
*DOGRP105:             DO;                                         1311
         B     @RC01309                                            1311
@RF01309 DS    0H                                                  1311
DOGRP105 DS    0H                                                  1312
*                        OLDERID2 = NEWERID2;                      1312
         L     @01,GDTPTR                                          1312
         L     @15,GDTTR2(,@01)                                    1312
         MVC   @TS00001(95),NEWERID2(@15)                          1312
         MVC   OLDERID2(95,@15),@TS00001                           1312
*                        NEWID2='RI27';                            1313
         MVC   NEWID2(4,@15),@CC01073                              1313
*                        DIGTINDX=0;                               1314
*                                                                  1314
         SLR   @15,@15                                             1314
         STH   @15,DIGTINDX                                        1314
*                        /********************************************/
*                        /*                                          */
*                        /* IF THERE ARE AN ODD NUMBER OF HEX DIGITS */
*                        /* IN THE HEX CONSTANT, FIRST CONVERT JUST  */
*                        /* THE SINGLE, HIGH-ORDER DIGIT INTO A ONE- */
*                        /* BYTE VALUE.                              */
*                        /*                                          */
*                        /********************************************/
*                        IF UNITINDX//2 ^= 0                       1315
*                          THEN                                    1315
         LH    @00,UNITINDX                                        1315
         SRDA  @00,32                                              1315
         D     @00,@CF00124                                        1315
         CR    @00,@15                                             1315
         BE    @RF01315                                            1315
*                            DO;                                   1316
*                              FOUND=NO;                           1317
*                                                                  1317
         NI    FOUND,B'11011111'                                   1317
*                              /**************************************/
*                              /*                                    */
*                              /* MATCH THE HEX DIGIT AGAINST THE    */
*                              /* CONVERSION TABLE TO OBTAIN THE     */
*                              /* VALUE OF THE DIGIT.  IF NO MATCH   */
*                              /* IS FOUND, AN INVALID HEX DIGIT HAS */
*                              /* BEEN FOUND.                        */
*                              /*                                    */
*                              /**************************************/
*                              DO LISTINDX=1 TO 16 WHILE(FOUND=NO);
         LA    @15,1                                               1318
         STH   @15,LISTINDX                                        1318
@DL01318 TM    FOUND,B'00100000'                                   1318
         BNZ   @DC01318                                            1318
*                                IF SYNUNIT(1)=HEXTABLE(LISTINDX)  1319
*                                  THEN                            1319
         LA    @14,HEXTABLE-1(@15)                                 1319
         CLC   SYNUNIT(1),0(@14)                                   1319
         BNE   @RF01319                                            1319
*                                    DO;                           1320
*                                    FOUND=YES;                    1321
         OI    FOUND,B'00100000'                                   1321
*                                    DIGTINDX=1;                   1322
         MVC   DIGTINDX(2),@CH00172                                1322
*                                    DIGITVAL(1)=LISTINDX-1;       1323
         BCTR  @15,0                                               1323
         STC   @15,DIGITVAL                                        1323
*                                    END;                          1324
*                              END;                                1325
@RF01319 LA    @15,1                                               1325
         AH    @15,LISTINDX                                        1325
         STH   @15,LISTINDX                                        1325
         CH    @15,@CH00274                                        1325
         BNH   @DL01318                                            1325
@DC01318 DS    0H                                                  1326
*                              IF FOUND=NO                         1326
*                                THEN                              1326
*                                                                  1326
         TM    FOUND,B'00100000'                                   1326
         BNZ   @RF01326                                            1326
*                                  CALL ERROR2(BADDIGIT,           1327
*                                              LENGTH(ERRFIELD),   1327
*                                              ADDR(ERRFIELD));    1327
*                                                                  1327
         MVC   @AL00001(8),@AL01327                                1327
         LA    @15,ERRFIELD                                        1327
         ST    @15,@AFTEMPS+24                                     1327
         LA    @15,@AFTEMPS+24                                     1327
         ST    @15,@AL00001+8                                      1327
         LA    @01,@AL00001                                        1327
         BAL   @14,ERROR2                                          1327
*                            END;                                  1328
*                                                                  1328
@RF01326 DS    0H                                                  1329
*                        /********************************************/
*                        /*                                          */
*                        /* TAKE THE REMAINING STRING OF HEX DIGITS  */
*                        /* TWO AT A TIME, MATCHING EACH DIGIT OF A  */
*                        /* PAIR AGAINST THE CONVERSION TABLE TO GET */
*                        /* THE VALUE OF THE HEX DIGIT.  MULTIPLY THE*/
*                        /* VALUE OF THE HIGHER ORDER DIGIT OF EACH  */
*                        /* PAIR BY 16 AND ADD THIS TO THE VALUE OF  */
*                        /* THE LOWER ORDER DIGIT TO OBTAIN THE ONE- */
*                        /* BYTE VALUE BETWEEN 0 AND 255.            */
*                        /*                                          */
*                        /********************************************/
*DOLOOP15:               DO INDEX=DIGTINDX+1 TO UNITINDX BY 2      1329
*                           WHILE(RISTATUS=0);                     1329
@RF01315 DS    0H                                                  1329
DOLOOP15 LA    @15,1                                               1329
         AH    @15,DIGTINDX                                        1329
         STH   @15,INDEX                                           1329
         B     @DE01329                                            1329
@DL01329 LH    @15,RISTATUS                                        1329
         LTR   @15,@15                                             1329
         BNZ   @DC01329                                            1329
*                          FOUND=NO;                               1330
         NI    FOUND,B'11011111'                                   1330
*                          DO LISTINDX=1 TO 16 WHILE(FOUND=NO);    1331
         LA    @15,1                                               1331
         STH   @15,LISTINDX                                        1331
@DL01331 TM    FOUND,B'00100000'                                   1331
         BNZ   @DC01331                                            1331
*                            IF SYNUNIT(INDEX)=HEXTABLE(LISTINDX)  1332
*                              THEN                                1332
         LH    @01,INDEX                                           1332
         LA    @14,SYNUNIT-1(@01)                                  1332
         LA    @01,HEXTABLE-1(@15)                                 1332
         CLC   0(1,@14),0(@01)                                     1332
         BNE   @RF01332                                            1332
*                                DO;                               1333
*                                FOUND=YES;                        1334
         OI    FOUND,B'00100000'                                   1334
*                                CNVRTVAL=16*(LISTINDX-1);         1335
         BCTR  @15,0                                               1335
         SLA   @15,4                                               1335
         STC   @15,CNVRTVAL                                        1335
*                                END;                              1336
*                          END;                                    1337
@RF01332 LA    @15,1                                               1337
         AH    @15,LISTINDX                                        1337
         STH   @15,LISTINDX                                        1337
         CH    @15,@CH00274                                        1337
         BNH   @DL01331                                            1337
@DC01331 DS    0H                                                  1338
*                          IF FOUND=NO                             1338
*                            THEN                                  1338
*                                                                  1338
         TM    FOUND,B'00100000'                                   1338
         BNZ   @RF01338                                            1338
*                              CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),
*                                          ADDR(ERRFIELD));        1339
*                                                                  1339
         MVC   @AL00001(8),@AL01339                                1339
         LA    @15,ERRFIELD                                        1339
         ST    @15,@AFTEMPS+24                                     1339
         LA    @15,@AFTEMPS+24                                     1339
         ST    @15,@AL00001+8                                      1339
         LA    @01,@AL00001                                        1339
         BAL   @14,ERROR2                                          1339
*                            ELSE                                  1340
*                                                                  1340
*                              /**************************************/
*                              /*                                    */
*                              /* IF THE HIGHER ORDER DIGIT OF THE   */
*                              /* PAIR WAS CONVERTED OKAY, THEN      */
*                              /* CONVERT THE LOWER ORDER DIGIT AND  */
*                              /* COMBINE THE TWO INTO A VALUE.      */
*                              /*                                    */
*                              /**************************************/
*                              DO;                                 1340
         B     @RC01338                                            1340
@RF01338 DS    0H                                                  1341
*                                FOUND=NO;                         1341
         NI    FOUND,B'11011111'                                   1341
*                                DO LISTINDX=1 TO 16 WHILE(FOUND=NO);
         LA    @15,1                                               1342
         STH   @15,LISTINDX                                        1342
@DL01342 TM    FOUND,B'00100000'                                   1342
         BNZ   @DC01342                                            1342
*                                  IF SYNUNIT(INDEX+1)=            1343
*                                      HEXTABLE(LISTINDX)          1343
*                                    THEN                          1343
         LH    @01,INDEX                                           1343
         LA    @14,SYNUNIT(@01)                                    1343
         LA    @01,HEXTABLE-1(@15)                                 1343
         CLC   0(1,@14),0(@01)                                     1343
         BNE   @RF01343                                            1343
*                                      DO;                         1344
*                                      FOUND=YES;                  1345
         OI    FOUND,B'00100000'                                   1345
*                                      DIGTINDX=DIGTINDX+1;        1346
         LA    @14,1                                               1346
         AH    @14,DIGTINDX                                        1346
         STH   @14,DIGTINDX                                        1346
*                                      DIGITVAL(DIGTINDX)=         1347
*                                        CNVRTVAL+LISTINDX-1;      1347
         MVC   @ZT00003+3(1),CNVRTVAL                              1347
         AL    @15,@ZT00003                                        1347
         BCTR  @15,0                                               1347
         STC   @15,DIGITVAL-1(@14)                                 1347
*                                      END;                        1348
*                                END;                              1349
@RF01343 LA    @15,1                                               1349
         AH    @15,LISTINDX                                        1349
         STH   @15,LISTINDX                                        1349
         CH    @15,@CH00274                                        1349
         BNH   @DL01342                                            1349
@DC01342 DS    0H                                                  1350
*                                IF FOUND=NO                       1350
*                                  THEN                            1350
*                                                                  1350
         TM    FOUND,B'00100000'                                   1350
         BNZ   @RF01350                                            1350
*                                    CALL ERROR2(BADDIGIT,         1351
*                                                LENGTH(ERRFIELD), 1351
*                                                ADDR(ERRFIELD));  1351
*                                                                  1351
         MVC   @AL00001(8),@AL01351                                1351
         LA    @15,ERRFIELD                                        1351
         ST    @15,@AFTEMPS+24                                     1351
         LA    @15,@AFTEMPS+24                                     1351
         ST    @15,@AL00001+8                                      1351
         LA    @01,@AL00001                                        1351
         BAL   @14,ERROR2                                          1351
*                              END;                                1352
@RF01350 DS    0H                                                  1353
*                        END DOLOOP15;                             1353
@RC01338 LA    @15,2                                               1353
         AH    @15,INDEX                                           1353
         STH   @15,INDEX                                           1353
@DE01329 CH    @15,UNITINDX                                        1353
         BNH   @DL01329                                            1353
@DC01329 DS    0H                                                  1354
*                      END DOGRP105;                               1354
*              IF RISTATUS=0                                       1355
*                THEN                                              1355
*                                                                  1355
@RC01309 DS    0H                                                  1355
@RC01271 LH    @15,RISTATUS                                        1355
         LTR   @15,@15                                             1355
         BNZ   @RF01355                                            1355
*                  /**************************************************/
*                  /*                                                */
*                  /* IF THE BINARY OR HEX CONSTANT JUST CONVERTED   */
*                  /* IS A NUMBER, MOVE THE CONVERTED NUMBER (STRING */
*                  /* OF 1-BYTE VALUES) INTO A BINARY FULLWORD.      */
*                  /*                                                */
*                  /**************************************************/
*                  IF NUMBER=YES                                   1356
*                    THEN                                          1356
         LA    @15,12                                              1356
         LR    @14,@15                                             1356
         MH    @14,PARMID                                          1356
         L     @01,WORKPTR                                         1356
         AL    @01,@CF01317                                        1356
         AL    @15,PARMPTR(@14,@01)                                1356
         TM    NUMBER(@15),B'10000000'                             1356
         BNO   @RF01356                                            1356
*                      DO;                                         1357
*                      OLDERID2 = NEWERID2;                        1358
         L     @01,GDTPTR                                          1358
         L     @15,GDTTR2(,@01)                                    1358
         MVC   @TS00001(95),NEWERID2(@15)                          1358
         MVC   OLDERID2(95,@15),@TS00001                           1358
*                      NEWID2='RI30';                              1359
         MVC   NEWID2(4,@15),@CC01076                              1359
*                      CNVRTFLD=SYNUNIT(1:DIGTINDX);               1360
         MVI   CNVRTFLD+1,C' '                                     1360
         MVC   CNVRTFLD+2(8),CNVRTFLD+1                            1360
         LH    @15,DIGTINDX                                        1360
         LR    @14,@15                                             1360
         BCTR  @14,0                                               1360
         EX    @14,@SM01351                                        1360
*                      CNVRTWRD=''B;                               1361
         SLR   @14,@14                                             1361
         ST    @14,CNVRTWRD                                        1361
*                      SYNUNIT(LENGTH(CNVRTWRD)+1-DIGTINDX:        1362
*                              LENGTH(CNVRTWRD))=CNVRTFLD;         1362
         LCR   @15,@15                                             1362
         AH    @15,@CH00260                                        1362
         LA    @14,SYNUNIT-1(@15)                                  1362
         LCR   @15,@15                                             1362
         AL    @15,@CF00052                                        1362
         EX    @15,@SM01353                                        1362
*                      END;                                        1363
*            END DOGRP90;                                          1364
*                                                                  1364
@RF01356 DS    0H                                                  1364
@RF01355 DS    0H                                                  1365
*        /************************************************************/
*        /*                                                          */
*        /* IF CONVERSION HAS PROCEEDED OKAY TO THIS POINT, THEN     */
*        /* PERFORM FINAL SEMANTIC CHECKING OF THE VALUES AND MOVE   */
*        /* THEM INTO THE FUNCTION DATA TABLE.                       */
*        /*                                                          */
*        /************************************************************/
*        IF RISTATUS=0                                             1365
*          THEN                                                    1365
*                                                                  1365
@RC01268 LH    @15,RISTATUS                                        1365
         LTR   @15,@15                                             1365
         BNZ   @RF01365                                            1365
*            /********************************************************/
*            /*                                                      */
*            /* CHECK THAT THE CONVERTED NUMBER DOES NOT EXCEED THE  */
*            /* DESIGNATED VALUE LIMITS FOR THIS PARAMETER.          */
*            /*                                                      */
*            /********************************************************/
*            IF NUMBER=YES                                         1366
*              THEN                                                1366
         LA    @15,12                                              1366
         LR    @14,@15                                             1366
         MH    @14,PARMID                                          1366
         L     @01,WORKPTR                                         1366
         AL    @01,@CF01317                                        1366
         AL    @15,PARMPTR(@14,@01)                                1366
         TM    NUMBER(@15),B'10000000'                             1366
         BNO   @RF01366                                            1366
*                IF CNVRTWRD > HIVALUE    CNVRTWRD < LOWVALUE     1367
*                  THEN                                            1367
*                                                                  1367
         L     @14,CNVRTWRD                                        1367
         C     @14,HIVALUE(,@15)                                   1367
         BH    @RT01367                                            1367
         C     @14,LOWVALUE(,@15)                                  1367
         BNL   @RF01367                                            1367
@RT01367 DS    0H                                                  1368
*                    CALL ERROR2(BADNUMSZ,LENGTH(ERRFIELD),        1368
*                                ADDR(ERRFIELD));                  1368
*                                                                  1368
         MVC   @AL00001(8),@AL01368                                1368
         LA    @15,ERRFIELD                                        1368
         ST    @15,@AFTEMPS+24                                     1368
         LA    @15,@AFTEMPS+24                                     1368
         ST    @15,@AL00001+8                                      1368
         LA    @01,@AL00001                                        1368
         BAL   @14,ERROR2                                          1368
*                  ELSE                                            1369
*                    IF SCALAR=YES                                 1369
*                      THEN                                        1369
         B     @RC01367                                            1369
@RF01367 LH    @15,PARMID                                          1369
         MH    @15,@CH00038                                        1369
         L     @01,WORKPTR                                         1369
         AL    @01,@CF01317                                        1369
         L     @01,PARMPTR(@15,@01)                                1369
         TM    SCALAR(@01),B'00010000'                             1369
         BNO   @RF01369                                            1369
*                        FULLWORD=CNVRTWRD;                        1370
         L     @01,DATAPTR                                         1370
         MVC   FULLWORD(4,@01),CNVRTWRD                            1370
*                      ELSE                                        1371
*                        DO;                                       1371
         B     @RC01369                                            1371
@RF01369 DS    0H                                                  1372
*                        FULLWDCT=SCLRCNT;                         1372
         LH    @15,SCLRCNT                                         1372
         L     @14,DATAPTR                                         1372
         ST    @15,FULLWDCT(,@14)                                  1372
*                        LFULLWD(SCLRCNT)=CNVRTWRD;                1373
         SLA   @15,2                                               1373
         L     @05,CNVRTWRD                                        1373
         ST    @05,LFULLWD-4(@15,@14)                              1373
*                        END;                                      1374
*                                                                  1374
*              /******************************************************/
*              /*                                                    */
*              /* IF THE CONSTANT CONVERTED WAS A BIT STRING OR HEX  */
*              /* STRING, CHECK THAT THE CONVERTED HEXADECIMAL DIGIT */
*              /* STRING DOES NOT EXCEED THE MAXIMUM SCALAR LENGTH   */
*              /* ALLOWED FOR THIS PARAMETER.  THEN PLACE THE STRING */
*              /* INTO THE FDT.                                      */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1375
*                IF DIGTINDX > MAXLNGTH                            1375
*                  THEN                                            1375
*                                                                  1375
         B     @RC01366                                            1375
@RF01366 LA    @15,12                                              1375
         LR    @14,@15                                             1375
         MH    @14,PARMID                                          1375
         L     @01,WORKPTR                                         1375
         AL    @01,@CF01317                                        1375
         AL    @15,PARMPTR(@14,@01)                                1375
         LH    @14,DIGTINDX                                        1375
         MVC   @ZT00003+3(1),MAXLNGTH(@15)                         1375
         C     @14,@ZT00003                                        1375
         BNH   @RF01375                                            1375
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1376
*                                ADDR(ERRFIELD));                  1376
*                                                                  1376
         MVC   @AL00001(8),@AL01376                                1376
         LA    @15,ERRFIELD                                        1376
         ST    @15,@AFTEMPS+24                                     1376
         LA    @15,@AFTEMPS+24                                     1376
         ST    @15,@AL00001+8                                      1376
         LA    @01,@AL00001                                        1376
         BAL   @14,ERROR2                                          1376
*                  ELSE                                            1377
*                    IF SCALAR=YES                                 1377
*                      THEN                                        1377
         B     @RC01375                                            1377
@RF01375 LA    @15,12                                              1377
         LR    @14,@15                                             1377
         MH    @14,PARMID                                          1377
         L     @01,WORKPTR                                         1377
         AL    @01,@CF01317                                        1377
         L     @14,PARMPTR(@14,@01)                                1377
         TM    SCALAR(@14),B'00010000'                             1377
         BNO   @RF01377                                            1377
*                        DO;                                       1378
*                        STRINGLN=DIGTINDX;                        1379
         L     @05,DATAPTR                                         1379
         MVC   STRINGLN(1,@05),DIGTINDX+1                          1379
*                        WORKPTR3=ADDR(STRING);                    1380
         LA    @04,STRING(,@05)                                    1380
         ST    @04,WORKPTR3                                        1380
*                        RFY(DATABLK) BASED(WORKPTR3);             1381
*                        STRING(1)=BLANK;                          1382
         MVI   STRING(@05),C' '                                    1382
*                        IF MAXLNGTH > 1                           1383
*                          THEN                                    1383
         ALR   @14,@15                                             1383
         CLI   MAXLNGTH(@14),1                                     1383
         BNH   @RF01383                                            1383
*                            STRING(2:MAXLNGTH)=                   1384
*                               DATABLK(1:MAXLNGTH-1);             1384
         SLR   @15,@15                                             1384
         IC    @15,MAXLNGTH(,@14)                                  1384
         BCTR  @15,0                                               1384
         BCTR  @15,0                                               1384
         EX    @15,@SM01355                                        1384
*                        STRING(1:DIGTINDX)=                       1385
*                                SYNUNIT(1:DIGTINDX);              1385
@RF01383 L     @01,DATAPTR                                         1385
         LH    @15,DIGTINDX                                        1385
         BCTR  @15,0                                               1385
         EX    @15,@SM01357                                        1385
*                        END;                                      1386
*                      ELSE                                        1387
*                        DO;                                       1387
         B     @RC01377                                            1387
@RF01377 DS    0H                                                  1388
*                        STRINGCT=SCLRCNT;                         1388
         L     @01,DATAPTR                                         1388
         MVC   STRINGCT(2,@01),SCLRCNT                             1388
*                        WORKPTR3=ADDR(ELTPTR->LSTRING);           1389
         L     @15,ELTPTR                                          1389
         LA    @14,LSTRING(,@15)                                   1389
         ST    @14,WORKPTR3                                        1389
*                        ELTPTR->LSTRINGL=DIGTINDX;                1390
         MVC   LSTRINGL(1,@15),DIGTINDX+1                          1390
*                        ELTPTR->LSTRING(1)=BLANK;                 1391
         MVI   LSTRING(@15),C' '                                   1391
*                        IF MAXLNGTH > 1                           1392
*                          THEN                                    1392
         LA    @05,12                                              1392
         LR    @04,@05                                             1392
         MH    @04,PARMID                                          1392
         L     @01,WORKPTR                                         1392
         AL    @01,@CF01317                                        1392
         AL    @05,PARMPTR(@04,@01)                                1392
         CLI   MAXLNGTH(@05),1                                     1392
         BNH   @RF01392                                            1392
*                            ELTPTR->LSTRING(2:MAXLNGTH)=          1393
*                              WORKPTR3->DATABLK(1:MAXLNGTH-1);    1393
         SLR   @04,@04                                             1393
         IC    @04,MAXLNGTH(,@05)                                  1393
         BCTR  @04,0                                               1393
         BCTR  @04,0                                               1393
         EX    @04,@SM01359                                        1393
*                        ELTPTR->LSTRING(1:DIGTINDX)=              1394
*                              SYNUNIT(1:DIGTINDX);                1394
@RF01392 L     @15,ELTPTR                                          1394
         LH    @14,DIGTINDX                                        1394
         BCTR  @14,0                                               1394
         EX    @14,@SM01347                                        1394
*                        ELTPTR=ELTPTR+SPACEAMT;                   1395
         AH    @15,SPACEAMT                                        1395
         ST    @15,ELTPTR                                          1395
*                        END;                                      1396
*                                                                  1396
*        END CONVERT;                                              1397
@EL00015 DS    0H                                                  1397
@EF00015 DS    0H                                                  1397
@ER00015 LM    @14,@12,@SA00015                                    1397
         BR    @14                                                 1397
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - DSICKHK                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CHECKS DSNAME SYNTAX RESTRICTIONS ON    */
*/*             AN EXTRACTED DSNAME ITEM, PARSES OUT THE             */
*/*             MEMBER NAME (IF PRESENT), AND STORES THE             */
*/*             NAME(S) INTO THE FDT.                                */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR IS DETECTED               */
*/*          SYNUNIT - CONTAINS THE DSNAME TO BE EXAMINED AND STORED */
*/*                    INTO THE FDT.                                 */
*/*          UNITINDX- LENGTH OF THE DSNAME TO BE CHECKED            */
*/*          SCLRCNT - COUNT OF ITEMS FOUND SO FAR IN A SCALAR LIST  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE ENTRY.                              */
*/*          RISTATUS- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*DSICKHK:PROCEDURE;                                                1398
DSICKHK  STM   @14,@12,@SA00016                                    1398
*        /************************************************************/
*        /*                                                          */
*        /* DSICKHK DATA DEFINITIONS                                 */
*        /*                                                          */
*        /************************************************************/
*        DCL NATCHAR1 CHAR(1)          /*NATIONAL CHARACTER          */
*                     CONSTANT('@');                               1399
*        DCL NATCHAR2 CHAR(1)          /*NATIONAL CHARACTER          */
*                     CONSTANT('#');                               1400
*        DCL NATCHAR3 CHAR(1)          /*NATIONAL CHARACTER          */
*                     CONSTANT('$');                               1401
*        DCL HYPHEN   CHAR(1)          /*HYPHEN CHARACTER            */
*                     CONSTANT('-');                               1402
*        DCL 1 TWLVZERO CHAR(1) STATIC,/*12-0 PUNCH CODE             */
*              2 * FIXED(8) INIT('C0'X);                           1403
*        DCL PERIOD   CHAR(1)          /*PERIOD CHARACTER            */
*                     CONSTANT('.');                               1404
*        DCL STAR     CHAR(1)          /*ASTERISK CHARACTER          */
*                     CONSTANT('*');                               1405
*                                                                  1405
*        DCL SEGSTART FIXED(15);       /*STARTING POSITION OF A DATA
*                                        SET NAME SEGMENT            */
*        DCL SEGEND   FIXED(15);       /*ENDING POSITION OF A DATA 1407
*                                        SET NAME SEGMENT            */
*        DCL SEGLEN   FIXED(15);       /*LENGTH OF DSNAME            */
*                                      /* SEGMENT                    */
*        DCL STARLOC  FIXED(8);        /*ASTERISK LOCATION           */
*                                      /* IN GENERIC DSNAME          */
*        DCL MEMBIT   BIT(1);          /*SET 'ON' WHEN A             */
*                                      /* MEMBER NAME IS             */
*                                      /* BEING CHECKED              */
*        DCL ONESTAR  BIT(1);          /*SET 'ON' WHEN AN            */
*                                      /* ASTERISK HAS BEEN          */
*                                      /* FOUND IN A DSNAME          */
*        DCL WITHMEM  BIT(1);          /*SET 'ON' WHEN               */
*                                      /*CHECKING ANY PART           */
*                                      /*OF A DSNAME THAT            */
*                                      /*HAS A MEMBER NAME           */
*        /************************************************************/
*        /*                                                          */
*        /*  ** DSICKHK **  CHECK DSNAME SYNTAX RESTRICTIONS         */
*        /*                                                          */
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1413
         L     @01,GDTPTR                                          1413
         L     @15,GDTTR2(,@01)                                    1413
         MVC   @TS00001(95),NEWERID2(@15)                          1413
         MVC   OLDERID2(95,@15),@TS00001                           1413
*        NEWID2='RIID';                                            1414
*                                                                  1414
         MVC   NEWID2(4,@15),@CC01102                              1414
*        /************************************************************/
*        /*                                                          */
*        /* IF AN INPUT DSNAME HAS A MEMBER NAME IN PARENS,          */
*        /* FIRST EXTRACT THE MEMBER NAME, CHECK FOR CORRECT         */
*        /* SYNTAX, AND STORE IT IN THE FDT.                         */
*        /*                                                          */
*        /************************************************************/
*        WITHMEM=NO;                                               1415
         NI    WITHMEM,B'01111111'                                 1415
*        MEMBIT=NO;                                                1416
         NI    MEMBIT,B'01111111'                                  1416
*        IF UNITINDX > 3  &  SYNUNIT(UNITINDX) = CLOSING           1417
*          THEN                                                    1417
         LH    @15,UNITINDX                                        1417
         CH    @15,@CH00144                                        1417
         BNH   @RF01417                                            1417
         LA    @14,SYNUNIT-1(@15)                                  1417
         CLI   0(@14),C')'                                         1417
         BNE   @RF01417                                            1417
*            DO INDEX2=1 TO UNITINDX WHILE(MEMBIT=NO);             1418
*                                                                  1418
         LA    @15,1                                               1418
         B     @DE01418                                            1418
@DL01418 TM    MEMBIT,B'10000000'                                  1418
         BNZ   @DC01418                                            1418
*              IF SYNUNIT(INDEX2)=OPENING                          1419
*                THEN                                              1419
*                                                                  1419
         LA    @14,SYNUNIT-1(@15)                                  1419
         CLI   0(@14),C'('                                         1419
         BNE   @RF01419                                            1419
*                  /**************************************************/
*                  /*                                                */
*                  /* UPON FINDING THE OPENING PARENTHESIS           */
*                  /* DELIMITING THE MEMBER NAME, THE NAME           */
*                  /* IS EXTRACTED.                                  */
*                  /*                                                */
*                  /**************************************************/
*DOGRP106:         DO;                                             1420
DOGRP106 DS    0H                                                  1421
*                  SEGSTART=INDEX2+1;                              1421
         LA    @15,1                                               1421
         LH    @14,INDEX2                                          1421
         ALR   @14,@15                                             1421
         STH   @14,SEGSTART                                        1421
*                  SEGEND=UNITINDX-1;                              1422
         LH    @05,UNITINDX                                        1422
         BCTR  @05,0                                               1422
         STH   @05,SEGEND                                          1422
*                  SEGLEN=SEGEND-SEGSTART+1;                       1423
         SLR   @05,@14                                             1423
         ALR   @05,@15                                             1423
         STH   @05,SEGLEN                                          1423
*                  MEMBIT=YES;                                     1424
         OI    MEMBIT,B'10000000'                                  1424
*                  WITHMEM=YES;                                    1425
*                                                                  1425
         OI    WITHMEM,B'10000000'                                 1425
*                  CALL NAMESCAN;                                  1426
*                                                                  1426
         BAL   @14,NAMESCAN                                        1426
*                  /**************************************************/
*                  /*                                                */
*                  /* IF THE MEMBER NAME HAS NO SYNTAX               */
*                  /* ERROR, STORE IT IN THE FDT.                    */
*                  /*                                                */
*                  /**************************************************/
*                  IF RISTATUS=0                                   1427
*                    THEN                                          1427
         LH    @15,RISTATUS                                        1427
         LTR   @15,@15                                             1427
         BNZ   @RF01427                                            1427
*                      IF LIST=YES                                 1428
*                        THEN                                      1428
         LH    @15,PARMID                                          1428
         MH    @15,@CH00038                                        1428
         L     @01,WORKPTR                                         1428
         AL    @01,@CF01317                                        1428
         L     @01,PARMPTR(@15,@01)                                1428
         TM    LIST(@01),B'00001000'                               1428
         BNO   @RF01428                                            1428
*                          DO;                                     1429
*                          DSNAMECT=SCLRCNT;                       1430
         LH    @15,SCLRCNT                                         1430
         L     @14,DATAPTR                                         1430
         STH   @15,DSNAMECT(,@14)                                  1430
*                          LMEMNAML(SCLRCNT)=SEGLEN;               1431
         MH    @15,@CH01296                                        1431
         LH    @05,SEGLEN                                          1431
         LA    @04,0(@15,@14)                                      1431
         AL    @04,@CF01361                                        1431
         STC   @05,LMEMNAML-13(,@04)                               1431
*                          LMEMNAME(SCLRCNT)=                      1432
*                                SYNUNIT(SEGSTART:SEGEND);         1432
         ALR   @14,@15                                             1432
         AL    @14,@CF01362                                        1432
         MVI   LMEMNAME-13(@14),C' '                               1432
         MVC   LMEMNAME-12(6,@14),LMEMNAME-13(@14)                 1432
         LH    @15,SEGSTART                                        1432
         LH    @05,SEGEND                                          1432
         SLR   @05,@15                                             1432
         LA    @01,SYNUNIT-1(@15)                                  1432
         EX    @05,@SM01363                                        1432
*                          END;                                    1433
*                        ELSE                                      1434
*                          DO;                                     1434
         B     @RC01428                                            1434
@RF01428 DS    0H                                                  1435
*                          MEMNAMLN=SEGLEN;                        1435
         L     @15,DATAPTR                                         1435
         MVC   MEMNAMLN(1,@15),SEGLEN+1                            1435
*                          MEMNAME=                                1436
*                               SYNUNIT(SEGSTART:SEGEND);          1436
         MVI   MEMNAME+1(@15),C' '                                 1436
         MVC   MEMNAME+2(6,@15),MEMNAME+1(@15)                     1436
         LH    @14,SEGSTART                                        1436
         LH    @05,SEGEND                                          1436
         SLR   @05,@14                                             1436
         LA    @01,SYNUNIT-1(@14)                                  1436
         EX    @05,@SM01365                                        1436
*                          END;                                    1437
*                  UNITINDX=SEGSTART-2;                            1438
@RC01428 DS    0H                                                  1438
@RF01427 LH    @15,SEGSTART                                        1438
         BCTR  @15,0                                               1438
         BCTR  @15,0                                               1438
         STH   @15,UNITINDX                                        1438
*                  END DOGRP106;                                   1439
*            END;                                                  1440
*                                                                  1440
@RF01419 LA    @15,1                                               1440
         AH    @15,INDEX2                                          1440
@DE01418 STH   @15,INDEX2                                          1440
         CH    @15,UNITINDX                                        1440
         BNH   @DL01418                                            1440
@DC01418 DS    0H                                                  1441
*        /************************************************************/
*        /*                                                          */
*        /* THE DSNAME, EXCLUDING THE MEMBER NAME, MUST              */
*        /* ADHERE TO DSNAME LENGTH LIMITATIONS.                     */
*        /*                                                          */
*        /************************************************************/
*        IF UNITINDX > MAXLNGTH    UNITINDX < 1                   1441
*          THEN                                                    1441
@RF01417 LH    @15,UNITINDX                                        1441
         LA    @14,12                                              1441
         LR    @05,@14                                             1441
         MH    @05,PARMID                                          1441
         L     @01,WORKPTR                                         1441
         AL    @01,@CF01317                                        1441
         AL    @14,PARMPTR(@05,@01)                                1441
         MVC   @ZT00003+3(1),MAXLNGTH(@14)                         1441
         C     @15,@ZT00003                                        1441
         BH    @RT01441                                            1441
         LTR   @15,@15                                             1441
         BP    @RF01441                                            1441
@RT01441 DS    0H                                                  1442
*            RISTATUS=BADITEM;                                     1442
*                                                                  1442
         MVC   RISTATUS(2),@CH00052                                1442
*        /************************************************************/
*        /*                                                          */
*        /* A DSNAME MAY CONSIST OF 1 TO 8-CHAR SEGMENTS,            */
*        /* SEPARATED BY PERIODS.  EACH SEGMENT IS CHECKED           */
*        /* FOR SYNTAX ERRORS AFTER THE PERIODS HAVE BEEN            */
*        /* FOUND WHICH DELIMIT THE SEGMENT.                         */
*        /*                                                          */
*        /************************************************************/
*        STARLOC=0;                                                1443
@RF01441 MVI   STARLOC,X'00'                                       1443
*        ONESTAR=NO;                                               1444
         NI    ONESTAR,B'01111111'                                 1444
*        SEGEND=-1;                                                1445
         MVC   SEGEND(2),@CH01070                                  1445
*        MEMBIT=NO;                                                1446
*                                                                  1446
         NI    MEMBIT,B'01111111'                                  1446
*DOLOOP16:DO WHILE(RISTATUS=0 & SEGEND<UNITINDX);                  1447
DOLOOP16 B     @DE01447                                            1447
@DL01447 DS    0H                                                  1448
*          SEGSTART=SEGEND+2;                                      1448
         LA    @15,2                                               1448
         AH    @15,SEGEND                                          1448
         STH   @15,SEGSTART                                        1448
*          DO SEGEND=SEGSTART TO UNITINDX                          1449
*                               WHILE(SYNUNIT(SEGEND)^=PERIOD);    1449
         B     @DE01449                                            1449
@DL01449 LA    @14,SYNUNIT-1(@15)                                  1449
         CLI   0(@14),C'.'                                         1449
         BE    @DC01449                                            1449
*          END;                                                    1450
         AL    @15,@CF00172                                        1450
@DE01449 STH   @15,SEGEND                                          1450
         CH    @15,UNITINDX                                        1450
         BNH   @DL01449                                            1450
@DC01449 DS    0H                                                  1451
*          SEGEND=SEGEND-1;                                        1451
         LH    @15,SEGEND                                          1451
         BCTR  @15,0                                               1451
         STH   @15,SEGEND                                          1451
*          SEGLEN=SEGEND-SEGSTART+1;                               1452
*                                                                  1452
         LA    @14,1                                               1452
         LH    @05,SEGSTART                                        1452
         SLR   @15,@05                                             1452
         ALR   @15,@14                                             1452
         STH   @15,SEGLEN                                          1452
*          /**********************************************************/
*          /*                                                        */
*          /* IF THIS MAY BE A GENERIC DSNAME, CHECK FOR AN          */
*          /* ASTERISK, BUT ALLOW JUST ONE OF THEM, IN PLACE         */
*          /* OF A SINGLE DSNAME LEVEL.                              */
*          /*                                                        */
*          /**********************************************************/
*          IF SYNUNIT(SEGSTART)=STAR                               1453
*            THEN                                                  1453
         LA    @04,SYNUNIT-1(@05)                                  1453
         CLI   0(@04),C'*'                                         1453
         BNE   @RF01453                                            1453
*              IF ONESTAR=NO & GENERIC=YES & SEGLEN=1 & SEGSTART^=1
*                THEN                                              1454
         TM    ONESTAR,B'10000000'                                 1454
         BNZ   @RF01454                                            1454
         LA    @04,12                                              1454
         LR    @03,@04                                             1454
         MH    @03,PARMID                                          1454
         L     @01,WORKPTR                                         1454
         AL    @01,@CF01317                                        1454
         AL    @04,PARMPTR(@03,@01)                                1454
         TM    GENERIC(@04),B'00010000'                            1454
         BNO   @RF01454                                            1454
         CR    @15,@14                                             1454
         BNE   @RF01454                                            1454
         CR    @05,@14                                             1454
         BE    @RF01454                                            1454
*                  DO;                                             1455
*                  ONESTAR=YES;                                    1456
         OI    ONESTAR,B'10000000'                                 1456
*                  STARLOC=SEGSTART;                               1457
         STC   @05,STARLOC                                         1457
*                  END;                                            1458
*                ELSE                                              1459
*                  RISTATUS=BADITEM;                               1459
         B     @RC01454                                            1459
@RF01454 MVC   RISTATUS(2),@CH00052                                1459
*            ELSE                                                  1460
*                                                                  1460
*              CALL NAMESCAN;                                      1460
*                                                                  1460
         B     @RC01453                                            1460
@RF01453 BAL   @14,NAMESCAN                                        1460
*        END DOLOOP16;                                             1461
*                                                                  1461
@RC01453 DS    0H                                                  1461
@DE01447 LH    @15,RISTATUS                                        1461
         LTR   @15,@15                                             1461
         BNZ   @DC01447                                            1461
         LH    @15,SEGEND                                          1461
         CH    @15,UNITINDX                                        1461
         BL    @DL01447                                            1461
@DC01447 DS    0H                                                  1462
*        /************************************************************/
*        /*                                                          */
*        /* IF THE DSNAME IS SYNTACTICALLY PROPER, STORE IT IN THE   */
*        /* FDT--OTHERWISE, PRINT AN ERROR MESSAGE.                  */
*        /*                                                          */
*        /************************************************************/
*        IF RISTATUS=0                                             1462
*          THEN                                                    1462
         LH    @15,RISTATUS                                        1462
         LTR   @15,@15                                             1462
         BNZ   @RF01462                                            1462
*            IF LIST=YES                                           1463
*              THEN                                                1463
         LH    @15,PARMID                                          1463
         MH    @15,@CH00038                                        1463
         L     @01,WORKPTR                                         1463
         AL    @01,@CF01317                                        1463
         L     @01,PARMPTR(@15,@01)                                1463
         TM    LIST(@01),B'00001000'                               1463
         BNO   @RF01463                                            1463
*                DO;                                               1464
*                DSNAMECT=SCLRCNT;                                 1465
         LH    @15,SCLRCNT                                         1465
         L     @14,DATAPTR                                         1465
         STH   @15,DSNAMECT(,@14)                                  1465
*                LSTARPOS(SCLRCNT)=STARLOC;                        1466
         MH    @15,@CH01296                                        1466
         SLR   @05,@05                                             1466
         IC    @05,STARLOC                                         1466
         LA    @04,0(@15,@14)                                      1466
         AL    @04,@CF01367                                        1466
         STC   @05,LSTARPOS-11(,@04)                               1466
*                LDSNAMEL(SCLRCNT)=UNITINDX;                       1467
         LH    @05,UNITINDX                                        1467
         LA    @04,0(@15,@14)                                      1467
         AL    @04,@CF01368                                        1467
         STC   @05,LDSNAMEL-22(,@04)                               1467
*                LDSNAME(SCLRCNT)=SYNUNIT(1:UNITINDX);             1468
         ALR   @14,@15                                             1468
         AL    @14,@CF01369                                        1468
         MVI   LDSNAME-22(@14),C' '                                1468
         MVC   LDSNAME-21(42,@14),LDSNAME-22(@14)                  1468
         BCTR  @05,0                                               1468
         EX    @05,@SM01370                                        1468
*                END;                                              1469
*              ELSE                                                1470
*                DO;                                               1470
         B     @RC01463                                            1470
@RF01463 DS    0H                                                  1471
*                DSNAMELN=UNITINDX;                                1471
         LH    @15,UNITINDX                                        1471
         L     @14,DATAPTR                                         1471
         STC   @15,DSNAMELN(,@14)                                  1471
*                STARPOS=STARLOC;                                  1472
         MVC   STARPOS(1,@14),STARLOC                              1472
*                DSNAME=SYNUNIT(1:UNITINDX);                       1473
         MVI   DSNAME+1(@14),C' '                                  1473
         MVC   DSNAME+2(42,@14),DSNAME+1(@14)                      1473
         BCTR  @15,0                                               1473
         EX    @15,@SM01372                                        1473
*                END;                                              1474
*          ELSE                                                    1475
*                                                                  1475
*            CALL ERROR2(BADITEM,LENGTH(ERRFIELD),                 1475
*                                    ADDR(ERRFIELD));              1475
         B     @RC01462                                            1475
@RF01462 MVC   @AL00001(8),@AL01475                                1475
         LA    @15,ERRFIELD                                        1475
         ST    @15,@AFTEMPS+28                                     1475
         LA    @15,@AFTEMPS+28                                     1475
         ST    @15,@AL00001+8                                      1475
         LA    @01,@AL00001                                        1475
         BAL   @14,ERROR2                                          1475
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - NAMESCAN                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CHECKS THAT DSNAME SEGMENTS AND         */
*/*             MEMBER NAMES ADHERE TO RESTRICTIONS UPON             */
*/*             LENGTH AND VALID CHARACTERS.                         */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          SYNUNIT  - CONTAINS THE SEGMENT OF CHARACTERS           */
*/*                     TO BE CHECKED FOR VALIDITY                   */
*/*          SEGSTART - THE POSITION OF THE 1ST SEGMENT CHAR         */
*/*          SEGEND -   THE POSITION OF THE 2ND SEGMENT CHAR         */
*/*          SEGLEN -   LENGTH OF SEGMENT TO BE CHECKED              */
*/*          MEMBIT -   SET 'ON' IF A MEMBER NAME IS BEING           */
*/*                     CHECKED.                                     */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          RISTATUS - SET TO A NON-ZERO ERROR ID IF NAME           */
*/*                     DOES NOT MEET SYNTAX REQUIREMENTS            */
*/*                                                                  */
*/********************************************************************/
*NAMESCAN:PROCEDURE;                                               1476
         B     @PB00017                                            1476
NAMESCAN STM   @14,@12,@SA00017                                    1476
*        /************************************************************/
*        /*                                                          */
*        /*  ** NAMESCAN **  CHECK NAME SEGMENT SYNTAX               */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1477
*          THEN;                                                   1477
         L     @01,GDTPTR                                          1477
         L     @15,GDTDBG(,@01)                                    1477
         LTR   @15,@15                                             1477
         BZ    @RT01477                                            1477
*          ELSE                                                    1479
*            CALL ICKDB010(GDTTBL,'RINS');                         1479
*                                                                  1479
         L     @15,GDTPTR                                          1479
         ST    @15,@AL00001                                        1479
         LA    @14,@CC01111                                        1479
         ST    @14,@AL00001+4                                      1479
         MVI   @AL00001+4,X'80'                                    1479
         L     @15,GDTDBG(,@15)                                    1479
         LA    @01,@AL00001                                        1479
         BALR  @14,@15                                             1479
*        /************************************************************/
*        /*                                                          */
*        /* IF THE SETMENT IS LESS THAN 1 OR GREATER THAN            */
*        /* 8 CHARACTERS LONG OR IF THE BEGINNING CHARACTER          */
*        /* OR THE SEGMENT IS NOT AN ALPHABETIC OR NATIONAL          */
*        /* CHARACTER (OR NOT A DECIMAL DIGIT IF THIS 'NAME'         */
*        /* MAY ACTUALLY BE A VOLUME SERIAL NUMBER), THEN            */
*        /* THE DSNAME IS IN ERROR.                                  */
*        /*                                                          */
*        /************************************************************/
*        IF SEGLEN >= 1  &  SEGLEN <= 8  &                         1480
*           (SYNUNIT(SEGSTART)>='A' & SYNUNIT(SEGSTART)<='Z'      1480
*            SYNUNIT(SEGSTART)=NATCHAR1                           1480
*            SYNUNIT(SEGSTART)=NATCHAR2                           1480
*            SYNUNIT(SEGSTART)=NATCHAR3)                           1480
*          THEN                                                    1480
*                                                                  1480
@RT01477 LH    @15,SEGLEN                                          1480
         CH    @15,@CH00172                                        1480
         BL    @RF01480                                            1480
         CH    @15,@CH00042                                        1480
         BH    @RF01480                                            1480
         LH    @15,SEGSTART                                        1480
         LA    @14,SYNUNIT-1(@15)                                  1480
         CLI   0(@14),C'A'                                         1480
         BL    @GL00072                                            1480
         LA    @14,SYNUNIT-1(@15)                                  1480
         CLI   0(@14),C'Z'                                         1480
         BNH   @RT01480                                            1480
@GL00072 LH    @15,SEGSTART                                        1480
         LA    @14,SYNUNIT-1(@15)                                  1480
         CLI   0(@14),C'@'                                         1480
         BE    @RT01480                                            1480
         LA    @14,SYNUNIT-1(@15)                                  1480
         CLI   0(@14),C'#'                                         1480
         BE    @RT01480                                            1480
         LA    @14,SYNUNIT-1(@15)                                  1480
         CLI   0(@14),C'$'                                         1480
         BNE   @RF01480                                            1480
@RT01480 DS    0H                                                  1481
*            /********************************************************/
*            /*                                                      */
*            /* CHECK THAT THE REMAINING CHARACTERS IN THE           */
*            /* SEGMENT ARE ALPHABETIC OR NATIONAL CHAR'S            */
*            /* (OR HYPHEN OR TWELVE-ZERO CODE IF THE                */
*            /* SEGMENT IS NOT A MEMBER NAME).                       */
*            /*                                                      */
*            /********************************************************/
*            DO INDEX2=SEGSTART+1 TO SEGEND;                       1481
         LA    @15,1                                               1481
         AH    @15,SEGSTART                                        1481
         B     @DE01481                                            1481
@DL01481 DS    0H                                                  1482
*              IF SYNUNIT(INDEX2) >= 'A'  &  SYNUNIT(INDEX2) <= 'Z'  
*                 SYNUNIT(INDEX2) >= '0'  &  SYNUNIT(INDEX2) <= '9'  
*                 SYNUNIT(INDEX2)=NATCHAR1                        1482
*                 SYNUNIT(INDEX2)=NATCHAR2                        1482
*                 SYNUNIT(INDEX2)=NATCHAR3                        1482
*                 MEMBIT=NO & (SYNUNIT(INDEX2)=HYPHEN             1482
*                              SYNUNIT(INDEX2)=TWLVZERO)           1482
*                THEN;                                             1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLI   0(@14),C'A'                                         1482
         BL    @GL00078                                            1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLI   0(@14),C'Z'                                         1482
         BNH   @RT01482                                            1482
@GL00078 LH    @15,INDEX2                                          1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLI   0(@14),C'0'                                         1482
         BL    @GL00077                                            1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLI   0(@14),C'9'                                         1482
         BNH   @RT01482                                            1482
@GL00077 LH    @15,INDEX2                                          1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLI   0(@14),C'@'                                         1482
         BE    @RT01482                                            1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLI   0(@14),C'#'                                         1482
         BE    @RT01482                                            1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLI   0(@14),C'$'                                         1482
         BE    @RT01482                                            1482
         TM    MEMBIT,B'10000000'                                  1482
         BNZ   @RF01482                                            1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLI   0(@14),C'-'                                         1482
         BE    @RT01482                                            1482
         LA    @14,SYNUNIT-1(@15)                                  1482
         CLC   0(1,@14),TWLVZERO                                   1482
         BE    @RT01482                                            1482
*                ELSE                                              1484
*                  RISTATUS=BADITEM;                               1484
@RF01482 MVC   RISTATUS(2),@CH00052                                1484
*            END;                                                  1485
@RT01482 LA    @15,1                                               1485
         AH    @15,INDEX2                                          1485
@DE01481 STH   @15,INDEX2                                          1485
         CH    @15,SEGEND                                          1485
         BNH   @DL01481                                            1485
*          ELSE                                                    1486
*            RISTATUS=BADITEM;                                     1486
*                                                                  1486
         B     @RC01480                                            1486
@RF01480 MVC   RISTATUS(2),@CH00052                                1486
*        /************************************************************/
*        /*                                                          */
*        /* IF THE NAME MAY BE A VOLUME SERIAL NUMBER, THEN          */
*        /* ALLOW ANY CHARACTERS IN THE NAME.                        */
*        /*                                                          */
*        /************************************************************/
*        IF VOLID=YES  &  UNITINDX <= 6  &  WITHMEM=NO             1487
*          THEN                                                    1487
@RC01480 LA    @15,12                                              1487
         LR    @14,@15                                             1487
         MH    @14,PARMID                                          1487
         L     @01,WORKPTR                                         1487
         AL    @01,@CF01317                                        1487
         AL    @15,PARMPTR(@14,@01)                                1487
         TM    VOLID(@15),B'00001000'                              1487
         BNO   @RF01487                                            1487
         LH    @15,UNITINDX                                        1487
         CH    @15,@CH00127                                        1487
         BH    @RF01487                                            1487
         TM    WITHMEM,B'10000000'                                 1487
         BNZ   @RF01487                                            1487
*            RISTATUS=0;                                           1488
*                                                                  1488
         SLR   @15,@15                                             1488
         STH   @15,RISTATUS                                        1488
*        END NAMESCAN;                                             1489
*                                                                  1489
*                                                                  1489
@EL00017 DS    0H                                                  1489
@EF00017 DS    0H                                                  1489
@ER00017 LM    @14,@12,@SA00017                                    1489
         BR    @14                                                 1489
*        END DSICKHK;                                              1490
@EL00016 DS    0H                                                  1490
@EF00016 DS    0H                                                  1490
@ER00016 LM    @14,@12,@SA00016                                    1490
         BR    @14                                                 1490
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETSPACE                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE ALLOCATES SPACE FOR FUNCTION DATA       */
*/*             TABLE (FDT) SCALAR DATA STRUCTURES, BASED UPON THE   */
*/*             DATA TYPE AND DATA LIMITS SPECIFIED FOR THE PARAMETER*/
*/*             BEING HANDLED.  THESE VALUES ARE TAKEN FROM THE      */
*/*             COMMAND DESCRIPTOR.                                  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          PARMID -  PARAMETER ID# OF CURRENT PARAMETER            */
*/*          BLKLEFT - AMOUNT OF SPACE REMAINING IN LARGE BLOCK OF   */
*/*                    STORAGE FROM WHICH SPACE FOR SCALAR DATA      */
*/*                    STRUCTURES ARE ALLOCATED.                     */
*/*          BLKPTR -  POINTER TO NEXT UNUSED AREA WHICH MAY BE      */
*/*                    ALLOCATED FROM LARGE STORAGE AREA.            */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */
*/*          SPACEAMT- AMOUNT OF STORAGE SPACE REQUIRED FOR STORAGE  */
*/*                    OF A SINGLE SCALAR ITEM (AND ASSOCIATED ITEMS */
*/*                    LIKE PASSWORD, LENGTH FIELDS, ETC)            */
*/*          AMTTOGET- AMOUNT OF SPACE TO ALLOCATE FOR THE ENTIRE    */
*/*                    SCALAR DATA STRUCTURE                         */
*/*          BLKLEFT - SEE 'INPUT'                                   */
*/*          DATAPTR - POINTER TO CURRENT SCALAR DATA STRUCTURE      */
*/*          BLKPTR -  SEE 'INPUT'                                   */
*/*          FDTPTR -  POINTER IN FDT USED FOR INDEXING TO THE SCALAR*/
*/*                    DATA IN THE STRUCTURES BEING BUILT.           */
*/*          ARRYPTR - POINTER TO INTERMEDIATE PTR VECTOR WHICH THEN */
*/*                    POINTS TO THE SCALAR DATA STRUCTURE           */
*/*          PTRLOC -  LOCATION OF FDT POINTER WHICH POINTS TO THE   */
*/*                    SCALAR DATA STRUCTURE FOR A SCALAR LIST       */
*/*                                                                  */
*/********************************************************************/
*GETSPACE:PROCEDURE;                                               1491
GETSPACE STM   @14,@12,@SA00018                                    1491
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETSPACE **  ALLOCATE SPACE FOR FDT DATA ELEMENTS    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1492
*        /************************************************************/
*        /*                                                          */
*        /* COMPUTE THE SPACE REQUIRED FOR EACH SCALAR AND ITS       */
*        /* ASSOCIATED DATA ITEMS (COUNT, LENGTH, ETC.)              */
*        /*                                                          */
*        /************************************************************/
*        IF NUMBER=YES                                             1492
*          THEN                                                    1492
         LA    @15,12                                              1492
         LR    @14,@15                                             1492
         MH    @14,PARMID                                          1492
         L     @01,WORKPTR                                         1492
         AL    @01,@CF01317                                        1492
         AL    @15,PARMPTR(@14,@01)                                1492
         TM    NUMBER(@15),B'10000000'                             1492
         BNO   @RF01492                                            1492
*            SPACEAMT=0;                                           1493
         SLR   @15,@15                                             1493
         STH   @15,SPACEAMT                                        1493
*          ELSE                                                    1494
*            IF DSNAM=YES                                          1494
*              THEN                                                1494
         B     @RC01492                                            1494
@RF01492 LA    @15,12                                              1494
         LR    @14,@15                                             1494
         MH    @14,PARMID                                          1494
         L     @01,WORKPTR                                         1494
         AL    @01,@CF01317                                        1494
         AL    @15,PARMPTR(@14,@01)                                1494
         TM    DSNAM(@15),B'00100000'                              1494
         BNO   @RF01494                                            1494
*                SPACEAMT=LENGTH(PASSWORD)+LENGTH(MEMNAME)+        1495
*                         5*LENGTH(DSNAMELN);                      1495
         MVC   SPACEAMT(2),@CH00284                                1495
*              ELSE                                                1496
*                DO;                                               1496
         B     @RC01494                                            1496
@RF01494 DS    0H                                                  1497
*                SPACEAMT=LENGTH(CHARLN);                          1497
         LA    @15,1                                               1497
         STH   @15,SPACEAMT                                        1497
*                IF PWORDOPT=YES                                   1498
*                  THEN                                            1498
         LA    @14,12                                              1498
         LR    @05,@14                                             1498
         MH    @05,PARMID                                          1498
         L     @01,WORKPTR                                         1498
         AL    @01,@CF01317                                        1498
         AL    @14,PARMPTR(@05,@01)                                1498
         TM    PWORDOPT(@14),B'00000010'                           1498
         BNO   @RF01498                                            1498
*                    SPACEAMT=SPACEAMT+LENGTH(PASSWORD)+LENGTH(CHARLN);
         LA    @15,9(,@15)                                         1499
         STH   @15,SPACEAMT                                        1499
*                END;                                              1500
@RF01498 DS    0H                                                  1501
*        SPACEAMT=SPACEAMT+MAXLNGTH;                               1501
@RC01494 DS    0H                                                  1501
@RC01492 LA    @15,12                                              1501
         LR    @14,@15                                             1501
         MH    @14,PARMID                                          1501
         L     @01,WORKPTR                                         1501
         AL    @01,@CF01317                                        1501
         L     @14,PARMPTR(@14,@01)                                1501
         ALR   @15,@14                                             1501
         SLR   @05,@05                                             1501
         IC    @05,MAXLNGTH(,@15)                                  1501
         AH    @05,SPACEAMT                                        1501
         STH   @05,SPACEAMT                                        1501
*        IF LIST=YES                                               1502
*          THEN                                                    1502
         TM    LIST(@14),B'00001000'                               1502
         BNO   @RF01502                                            1502
*            DO;                                                   1503
*            IF SPACEAMT//2 ^= 0                                   1504
*              THEN                                                1504
         LR    @00,@05                                             1504
         SRDA  @00,32                                              1504
         D     @00,@CF00124                                        1504
         LTR   @00,@00                                             1504
         BZ    @RF01504                                            1504
*                SPACEAMT=SPACEAMT+1;                              1505
         LA    @05,1(,@05)                                         1505
         STH   @05,SPACEAMT                                        1505
*            AMTTOGET=SPACEAMT*MIN(4,LISTMAX)+FULLNGTH;            1506
*                                                                  1506
@RF01504 LA    @15,4                                               1506
         LA    @14,12                                              1506
         LR    @05,@14                                             1506
         MH    @05,PARMID                                          1506
         L     @01,WORKPTR                                         1506
         AL    @01,@CF01317                                        1506
         AL    @14,PARMPTR(@05,@01)                                1506
         SLR   @01,@01                                             1506
         IC    @01,LISTMAX(,@14)                                   1506
         CR    @01,@15                                             1506
         BNH   *+6
         LR    @01,@15                                             1506
         MH    @01,SPACEAMT                                        1506
         ALR   @01,@15                                             1506
         ST    @01,AMTTOGET                                        1506
*            /********************************************************/
*            /*                                                      */
*            /* REQUEST SPACE FOR THE SCALAR LIST DATA STRUCTURE.    */
*            /* SPACE IS OBTAINED EACH TIME A SCALAR LIST IS THE     */
*            /* VALUE OF THE PARAMETER BEING SCANNED.                */
*            /*                                                      */
*            /********************************************************/
*            CALL ICKSAGP0(GDTTBL,AMTTOGET,DATAPTR,POOLID,SETZERO);
         L     @15,GDTPTR                                          1507
         ST    @15,@AL00001                                        1507
         LA    @14,AMTTOGET                                        1507
         ST    @14,@AL00001+4                                      1507
         LA    @14,DATAPTR                                         1507
         ST    @14,@AL00001+8                                      1507
         LA    @14,POOLID                                          1507
         ST    @14,@AL00001+12                                     1507
         LA    @14,@CC00153                                        1507
         ST    @14,@AL00001+16                                     1507
         MVI   @AL00001+16,X'80'                                   1507
         L     @15,GDTGPL(,@15)                                    1507
         LA    @01,@AL00001                                        1507
         BALR  @14,@15                                             1507
*            RESPECIFY RTNREG RSTD;                                1508
*            TESTRC = RTNREG;                                      1509
         STH   RTNREG,TESTRC                                       1509
*            RESPECIFY RTNREG UNRSTD;                              1510
*                                                                  1510
*            END;                                                  1511
*                                                                  1511
*          /**********************************************************/
*          /*                                                        */
*          /* SPACE FOR SCALAR (NOT SCALAR LIST) DATA STRUCTURES IS  */
*          /* ALLOCATED FROM A LARGE BLOCK OF SPACE ALREADY OBTAINED,*/
*          /* RATHER THAN ISSUING A 'GET SPACE' REQUEST FOR EACH     */
*          /* STRUCTURE.  IF SPACE IN THE BLOCK HAS ALL BEEN USED,   */
*          /* ANOTHER LARGE BLOCK IS OBTAINED.                       */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    1512
*            DO;                                                   1512
         B     @RC01502                                            1512
@RF01502 DS    0H                                                  1513
*            IF BLKLEFT-SPACEAMT < 0                               1513
*              THEN                                                1513
         L     @15,BLKLEFT                                         1513
         SH    @15,SPACEAMT                                        1513
         LTR   @15,@15                                             1513
         BNM   @RF01513                                            1513
*                DO;                                               1514
*                BLKLEFT='400'X;                                   1515
*                                                                  1515
         LA    @15,1024                                            1515
         ST    @15,BLKLEFT                                         1515
*                CALL ICKSAGP0(GDTTBL,BLKLEFT,BLKPTR,POOLID,SETZERO);
         L     @15,GDTPTR                                          1516
         ST    @15,@AL00001                                        1516
         LA    @14,BLKLEFT                                         1516
         ST    @14,@AL00001+4                                      1516
         LA    @14,BLKPTR                                          1516
         ST    @14,@AL00001+8                                      1516
         LA    @14,POOLID                                          1516
         ST    @14,@AL00001+12                                     1516
         LA    @14,@CC00153                                        1516
         ST    @14,@AL00001+16                                     1516
         MVI   @AL00001+16,X'80'                                   1516
         L     @15,GDTGPL(,@15)                                    1516
         LA    @01,@AL00001                                        1516
         BALR  @14,@15                                             1516
*                RESPECIFY RTNREG RSTD;                            1517
*                TESTRC = RTNREG;                                  1518
         STH   RTNREG,TESTRC                                       1518
*                RESPECIFY RTNREG UNRSTD;                          1519
*                                                                  1519
*                END;                                              1520
*              ELSE                                                1521
*                TESTRC=0;                                         1521
         B     @RC01513                                            1521
@RF01513 SLR   @15,@15                                             1521
         STH   @15,TESTRC                                          1521
*            DATAPTR=BLKPTR;                                       1522
@RC01513 L     @15,BLKPTR                                          1522
         ST    @15,DATAPTR                                         1522
*            BLKPTR=BLKPTR+SPACEAMT+(FULLNGTH-SPACEAMT//FULLNGTH); 1523
         LH    @14,SPACEAMT                                        1523
         LR    @05,@15                                             1523
         ALR   @05,@14                                             1523
         SRDA  @14,32                                              1523
         D     @14,@CF00052                                        1523
         LCR   @14,@14                                             1523
         AL    @14,@CF00052                                        1523
         ALR   @05,@14                                             1523
         ST    @05,BLKPTR                                          1523
*            BLKLEFT=BLKLEFT-(BLKPTR-DATAPTR);                     1524
         L     @04,DATAPTR                                         1524
         SLR   @04,@05                                             1524
         AL    @04,BLKLEFT                                         1524
         ST    @04,BLKLEFT                                         1524
*            END;                                                  1525
*                                                                  1525
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THAT THE SPACE WAS ALLOCATED PROPERLY, THEN STORE  */
*        /* THE AREA PTR IN THE FDT.  IF THE SCALAR IS ASSOCIATED    */
*        /* WITH A PARAMETER IN A REPEATED LIST, CALCULATE THE FDT   */
*        /* LOCATION OF THE POINTER WHERE THE SPACE ADDRESS IS TO BE */
*        /* STORED.                                                  */
*        /*                                                          */
*        /************************************************************/
*        IF TESTRC ^= 0                                            1526
*          THEN                                                    1526
*                                                                  1526
@RC01502 LH    @15,TESTRC                                          1526
         LTR   @15,@15                                             1526
         BZ    @RF01526                                            1526
*            CALL ERROR1(NOSPACE);                                 1527
*                                                                  1527
         LA    @01,@AL01527                                        1527
         BAL   @14,ERROR1                                          1527
*          ELSE                                                    1528
*            IF OCCURNUM < 2                                       1528
*              THEN                                                1528
         B     @RC01526                                            1528
@RF01526 LH    @15,PARMID                                          1528
         LR    @14,@15                                             1528
         MH    @14,@CH00038                                        1528
         L     @01,WORKPTR                                         1528
         AL    @01,@CF01317                                        1528
         L     @01,PARMPTR(@14,@01)                                1528
         CLC   OCCURNUM(3,@01),@CF00124+1                          1528
         BNL   @RF01528                                            1528
*                FDTPTR(PARMID)=DATAPTR;                           1529
         SLA   @15,2                                               1529
         L     @14,DATAPTR                                         1529
         L     @01,FDTADDR                                         1529
         ST    @14,FDTPTR-4(@15,@01)                               1529
*              ELSE                                                1530
*                DO;                                               1530
         B     @RC01528                                            1530
@RF01528 DS    0H                                                  1531
*                ARRYPTR=FDTPTR(PARMID);                           1531
*                                                                  1531
         LH    @15,PARMID                                          1531
         SLA   @15,2                                               1531
         L     @01,FDTADDR                                         1531
         L     @15,FDTPTR-4(@15,@01)                               1531
         ST    @15,ARRYPTR                                         1531
*                CALL DSPLCALC(REPDEPTH);                          1532
*                                                                  1532
         LA    @15,REPDEPTH                                        1532
         ST    @15,@AL00001                                        1532
         LA    @01,@AL00001                                        1532
         BAL   @14,DSPLCALC                                        1532
*                REPPTR=DATAPTR;                                   1533
         LH    @15,ARRYDSPL                                        1533
         AL    @15,ARRYPTR                                         1533
         MVC   REPPTR(4,@15),DATAPTR                               1533
*                IF LIST=YES                                       1534
*                  THEN                                            1534
         LH    @14,PARMID                                          1534
         MH    @14,@CH00038                                        1534
         L     @01,WORKPTR                                         1534
         AL    @01,@CF01317                                        1534
         L     @01,PARMPTR(@14,@01)                                1534
         TM    LIST(@01),B'00001000'                               1534
         BNO   @RF01534                                            1534
*                    PTRLOC=ADDR(REPPTR);                          1535
         ST    @15,PTRLOC                                          1535
*                END;                                              1536
@RF01534 DS    0H                                                  1537
*        SPACELFT=AMTTOGET-FULLNGTH-SPACEAMT;                      1537
*                                                                  1537
@RC01528 DS    0H                                                  1537
@RC01526 L     @15,AMTTOGET                                        1537
         SL    @15,@CF00052                                        1537
         SH    @15,SPACEAMT                                        1537
         STH   @15,SPACELFT                                        1537
*        END GETSPACE;                                             1538
@EL00018 DS    0H                                                  1538
@EF00018 DS    0H                                                  1538
@ER00018 LM    @14,@12,@SA00018                                    1538
         BR    @14                                                 1538
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - MORSPACE                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE ALLOCATES ADDITIONAL SPACE FOR AN FDT   */
*/*             SCALAR LIST DATA STRUCTURE.                          */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          AMTTOGET- AMOUNT OF SPACE LAST ALLOCATED FOR THIS       */
*/*                    SCALAR LIST DATA STRUCTURE                    */
*/*          SPACELFT- UNUSED SPACE REMAINING FROM LAST ALLOCATION   */
*/*          SPACEAMT- AMOUNT OF SPACE REQUIRED FOR EACH LIST ELEMENT*/
*/*                    IN THE DATA STRUCTURE                         */
*/*          DATAPTR - POINTER TO CURRENT DATA STRUCTURE LOCATION    */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */
*/*          AMTTOGET- NEW AMOUNT OF SPACE TO BE ALLOCATED, WHICH    */
*/*                    ALLOWS FOR LARGER SCALAR LIST DATA STRUCTURE  */
*/*          LISTADDR- LOCATION OF NEW BLOCK OF SPACE                */
*/*          SPACELFT- AMOUNT OF SPACE REMAINING IN NEW STORAGE BLOCK*/
*/*                                                                  */
*/********************************************************************/
*MORSPACE:PROCEDURE;                                               1539
MORSPACE STM   @14,@12,@SA00019                                    1539
*        /************************************************************/
*        /*                                                          */
*        /* 'MORSPACE' ROUTINE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1540
*        DCL OLDPTR   PTR(31);         /*PTR TO DATA TO BE MOVED FROM
*                                        DATA BLK THAT WAS TOO SMALL */
*        DCL FREEPTR  PTR(31);         /*PTR TO OLD BLOCK OF SPACE 1541
*                                        TO BE FREED UP AFTER ITS  1541
*                                        DATA HAS BEEN COPIED.       */
*        DCL NEWPTR   PTR(31);         /*PTR TO NEWLY ALLOCATED,   1542
*                                        LARGER DATA BLOCK           */
*        DCL MOVELEN  FIXED(15);       /*AMOUNT OF DATA TO BE MOVED
*                                        IN A SINGLE DATA MOVE       */
*        DCL AMTUSED  FIXED(15);       /*AMOUNT OF OLD DATA BLOCK THAT
*                                        WAS 'STORED INTO' BEFORE  1544
*                                        SPACE RAN OUT.              */
*        /************************************************************/
*        /*                                                          */
*        /*  ** MORSPACE **  ALLOCATE MORE SPACE FOR FDT DATA        */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1545
*          THEN;                                                   1545
         L     @01,GDTPTR                                          1545
         L     @15,GDTDBG(,@01)                                    1545
         LTR   @15,@15                                             1545
         BZ    @RT01545                                            1545
*          ELSE                                                    1547
*            CALL ICKDB010(GDTTBL,'RIMC');                         1547
*                                                                  1547
         L     @15,GDTPTR                                          1547
         ST    @15,@AL00001                                        1547
         LA    @14,@CC01125                                        1547
         ST    @14,@AL00001+4                                      1547
         MVI   @AL00001+4,X'80'                                    1547
         L     @15,GDTDBG(,@15)                                    1547
         LA    @01,@AL00001                                        1547
         BALR  @14,@15                                             1547
*        /************************************************************/
*        /*                                                          */
*        /* COMPUTE AMOUNT OF SPACE USED IN OLD DATA BLOCK AND SIZE  */
*        /* OF THE NEW, LARGER BLOCK TO BE OBTAINED.                 */
*        /*                                                          */
*        /************************************************************/
*        AMTUSED=AMTTOGET-SPACELFT-SPACEAMT;                       1548
@RT01545 LH    @15,SPACEAMT                                        1548
         L     @14,AMTTOGET                                        1548
         LR    @05,@14                                             1548
         SH    @05,SPACELFT                                        1548
         SLR   @05,@15                                             1548
         STH   @05,AMTUSED                                         1548
*        OLDPTR=DATAPTR;                                           1549
         L     @05,DATAPTR                                         1549
         ST    @05,OLDPTR                                          1549
*        FREEPTR=DATAPTR;                                          1550
         ST    @05,FREEPTR                                         1550
*        AMTTOGET=AMTTOGET+SPACEAMT*2;                             1551
*                                                                  1551
         ALR   @15,@15                                             1551
         ALR   @14,@15                                             1551
         ST    @14,AMTTOGET                                        1551
*        /************************************************************/
*        /*                                                          */
*        /* REQUEST THE DESIRED SPACE.  IF OBTAINED OKAY, SET UP     */
*        /* POINTER TO THE AREA.                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1552
*        CALL ICKSAGP0(GDTTBL,AMTTOGET,DATAPTR,POOLID,SETZERO);    1552
         L     @15,GDTPTR                                          1552
         ST    @15,@AL00001                                        1552
         LA    @14,AMTTOGET                                        1552
         ST    @14,@AL00001+4                                      1552
         LA    @14,DATAPTR                                         1552
         ST    @14,@AL00001+8                                      1552
         LA    @14,POOLID                                          1552
         ST    @14,@AL00001+12                                     1552
         LA    @14,@CC00153                                        1552
         ST    @14,@AL00001+16                                     1552
         MVI   @AL00001+16,X'80'                                   1552
         L     @15,GDTGPL(,@15)                                    1552
         LA    @01,@AL00001                                        1552
         BALR  @14,@15                                             1552
*        RESPECIFY RTNREG RSTD;                                    1553
*        TESTRC = RTNREG;                                          1554
         STH   RTNREG,TESTRC                                       1554
*        RESPECIFY RTNREG UNRSTD;                                  1555
*                                                                  1555
*        IF TESTRC ^= 0                                            1556
*          THEN                                                    1556
*                                                                  1556
         LH    @15,TESTRC                                          1556
         LTR   @15,@15                                             1556
         BZ    @RF01556                                            1556
*            CALL ERROR1(NOSPACE);                                 1557
*                                                                  1557
         LA    @01,@AL01557                                        1557
         BAL   @14,ERROR1                                          1557
*          ELSE                                                    1558
*DOGRP107:   DO;                                                   1558
         B     @RC01556                                            1558
@RF01556 DS    0H                                                  1558
DOGRP107 DS    0H                                                  1559
*            IF OCCURNUM < 2                                       1559
*              THEN                                                1559
         LH    @15,PARMID                                          1559
         LR    @14,@15                                             1559
         MH    @14,@CH00038                                        1559
         L     @01,WORKPTR                                         1559
         AL    @01,@CF01317                                        1559
         L     @01,PARMPTR(@14,@01)                                1559
         CLC   OCCURNUM(3,@01),@CF00124+1                          1559
         BNL   @RF01559                                            1559
*                FDTPTR(PARMID)=DATAPTR;                           1560
         SLA   @15,2                                               1560
         L     @14,DATAPTR                                         1560
         L     @01,FDTADDR                                         1560
         ST    @14,FDTPTR-4(@15,@01)                               1560
*              ELSE                                                1561
*                LISTADDR=DATAPTR;                                 1561
         B     @RC01559                                            1561
@RF01559 L     @01,PTRLOC                                          1561
         MVC   LISTADDR(4,@01),DATAPTR                             1561
*            SPACELFT=AMTTOGET-AMTUSED-SPACEAMT;                   1562
*                                                                  1562
@RC01559 L     @15,AMTTOGET                                        1562
         SH    @15,AMTUSED                                         1562
         SH    @15,SPACEAMT                                        1562
         STH   @15,SPACELFT                                        1562
*            /********************************************************/
*            /*                                                      */
*            /* MOVE DATA FROM THE OLD, SMALLER DATA BLOCK INTO THE  */
*            /* NEW DATA BLOCK.  THEN FREE THE OLD DATA BLOCK.       */
*            /*                                                      */
*            /********************************************************/
*            NEWPTR=DATAPTR;                                       1563
         MVC   NEWPTR(4),DATAPTR                                   1563
*            DO WHILE(AMTUSED > 0);                                1564
         B     @DE01564                                            1564
@DL01564 DS    0H                                                  1565
*              MOVELEN=MIN(256,AMTUSED);                           1565
         LH    @15,AMTUSED                                         1565
         LA    @14,256                                             1565
         CR    @14,@15                                             1565
         BNH   *+6
         LR    @14,@15                                             1565
         STH   @14,MOVELEN                                         1565
*              NEWPTR->DATABLK(1:MOVELEN)=                         1566
*                OLDPTR->DATABLK(1:MOVELEN);                       1566
         L     @05,NEWPTR                                          1566
         LR    @04,@14                                             1566
         BCTR  @04,0                                               1566
         L     @03,OLDPTR                                          1566
         EX    @04,@SM01374                                        1566
*              NEWPTR=NEWPTR+MOVELEN;                              1567
         ALR   @05,@14                                             1567
         ST    @05,NEWPTR                                          1567
*              OLDPTR=OLDPTR+MOVELEN;                              1568
         ALR   @03,@14                                             1568
         ST    @03,OLDPTR                                          1568
*              AMTUSED=AMTUSED-MOVELEN;                            1569
         SLR   @15,@14                                             1569
         STH   @15,AMTUSED                                         1569
*            END;                                                  1570
*                                                                  1570
@DE01564 LH    @15,AMTUSED                                         1570
         LTR   @15,@15                                             1570
         BP    @DL01564                                            1570
*            CALL ICKSAFS0(GDTTBL,FREEPTR);                        1571
*                                                                  1571
         L     @15,GDTPTR                                          1571
         ST    @15,@AL00001                                        1571
         LA    @14,FREEPTR                                         1571
         ST    @14,@AL00001+4                                      1571
         L     @15,GDTFSP(,@15)                                    1571
         LA    @01,@AL00001                                        1571
         BALR  @14,@15                                             1571
*            END DOGRP107;                                         1572
*                                                                  1572
*        END MORSPACE;                                             1573
*                                                                  1573
*                                                                  1573
@EL00019 DS    0H                                                  1573
@EF00019 DS    0H                                                  1573
@ER00019 LM    @14,@12,@SA00019                                    1573
         BR    @14                                                 1573
*        END BUILDFDT;                                             1574
         B     @EL00014                                            1574
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - INREPEAT                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE IS INVOKED WHEN THE END OF ONE OF THE   */
*/*             SUBLISTS OF A REPEATED SUBPARAMETER LIST HAS BEEN    */
*/*             REACHED.  DEFAULTS ARE APPLIED TO THE SUBLIST JUST   */
*/*             COMPLETED, AND SEMANTIC CHECKING IS PERFORMED ON IT. */
*/*             CHECKING IS THEN DONE TO SEE WHETHER ANOTHER SUBLIST */
*/*             FOLLOWS OR WHETHER THIS WAS THE LAST OF THE SUBLISTS */
*/*             AT THIS LEVEL OF REPEATED SUBLIST NESTING.  COUNTS   */
*/*             INDICATING CURRENT SCAN POSITION AND THE SUBLIST     */
*/*             OCCURRENCE TOTAL ARE ALSO UPDATED AT THIS TIME.      */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          SUPERID - PARAMETER ID# OF THE PARAMETER WHOSE REPEATED */
*/*                    SUBLISTS ARE BEING SCANNED                    */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS FOUND.                  */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */
*/*          REPCOUNT- NUMBER OF REPETITIONS OF THIS PARAMETER'S     */
*/*                    SUBLIST FOUND THUS FAR                        */
*/*          REPLIMIT- MAXIMUM REPETITIONS ALLOWED OF THIS PARM'S    */
*/*                    SUBPARAMETER LIST                             */
*/*          REPDEPTH- LEVEL OF REPEATED SUBLIST NESTING AT WHICH    */
*/*                    SCANNING IS CURRENTLY TAKING PLACE            */
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */
*/*                    SCANNING IS CURRENTLY TAKING PLACE            */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PARMID -  PARAMETER ID# OF PARAMETER WHOSE REPEATED     */
*/*                    SUBLISTS ARE BEING SCANNED.                   */
*/*          PARMFLAG- FLAGS IN 'PARMINFO'; PARMFLAG(N) IS           */
*/*                    SET 'ON' WHEN THE PARM WHOSE ID#=N            */
*/*                    IS INPUT.                                     */
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST 1 SUBPARAMETER    */
*/*                    HAS BEEN FOUND IN CURRENT SUBPARM. LIST       */
*/*          REPCOUNT- SEE 'INPUT'                                   */
*/*          ARRYPTR - POINTER TO FDT POINTER VECTOR                 */
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */
*/*                    CURRENT SUBPARAMETER LIST.                    */
*/*          PARMLVL - SEE 'INPUT'                                   */
*/*          FUNCTION DATA TABLE DATA ENTRY                          */
*/*                                                                  */
*/********************************************************************/
*INREPEAT:PROCEDURE;                                               1575
INREPEAT STM   @14,@12,@SA00020                                    1575
*        /************************************************************/
*        /*                                                          */
*        /* INREPEAT PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1576
*        /* STATIC ERROR MESSAGE CODES                               */
*        DCL REPERR   FIXED(31)        /*TOO MANY REPEATED SUBLISTS  */
*                     CONSTANT(19);                                1576
*                                                                  1576
*        DCL SUBOCCUR FIXED(31);       /*NUMBER OF TIMES A PARAMETER
*                                        IN A REPEATED SUBLIST MAY 1577
*                                        APPEAR.                     */
*          /**********************************************************/
*          /*                                                        */
*          /*  ** INREPEAT **  HANDLE REPEATED SUBLIST END           */
*          /*                                                        */
*          /**********************************************************/
*          IF GDTDBG = NULLPTR                                     1578
*            THEN;                                                 1578
         L     @01,GDTPTR                                          1578
         L     @15,GDTDBG(,@01)                                    1578
         LTR   @15,@15                                             1578
         BZ    @RT01578                                            1578
*            ELSE                                                  1580
*              CALL ICKDB010(GDTTBL,'RIIR');                       1580
*                                                                  1580
         L     @15,GDTPTR                                          1580
         ST    @15,@AL00001                                        1580
         LA    @14,@CC01133                                        1580
         ST    @14,@AL00001+4                                      1580
         MVI   @AL00001+4,X'80'                                    1580
         L     @15,GDTDBG(,@15)                                    1580
         LA    @01,@AL00001                                        1580
         BALR  @14,@15                                             1580
*          /**********************************************************/
*          /*                                                        */
*          /* APPLY DEFAULTS AND PERFORM SEMANTIC CHECKING ON THE    */
*          /* REPEATED SUBLIST JUST FINISHED.                        */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1581
*          CALL DEFAULTS;                                          1581
@RT01578 BAL   @14,DEFAULTS                                        1581
*          CALL NEEDNOTS;                                          1582
         BAL   @14,NEEDNOTS                                        1582
*          CALL SCANSEP(YES);                                      1583
*                                                                  1583
         LA    @01,@AL01583                                        1583
         BAL   @14,SCANSEP                                         1583
*          IF RISTATUS^=0  ONEREP(REPDEPTH)=YES                   1584
*            THEN                                                  1584
         LH    @15,RISTATUS                                        1584
         LTR   @15,@15                                             1584
         BNZ   @RT01584                                            1584
         LH    @01,REPDEPTH                                        1584
         LA    @15,ONEREP-1(@01)                                   1584
         TM    0(@15),B'10000000'                                  1584
         BNO   @RF01584                                            1584
@RT01584 DS    0H                                                  1585
*              DO;                                                 1585
*              REPDEPTH=REPDEPTH-1;                                1586
         LH    @15,REPDEPTH                                        1586
         BCTR  @15,0                                               1586
         STH   @15,REPDEPTH                                        1586
*              PARMLVL=PARMLVL-1;                                  1587
         LH    @15,PARMLVL                                         1587
         BCTR  @15,0                                               1587
         STH   @15,PARMLVL                                         1587
*              RETURN;                                             1588
@EL00020 DS    0H                                                  1588
@EF00020 DS    0H                                                  1588
@ER00020 LM    @14,@12,@SA00020                                    1588
         BR    @14                                                 1588
*              END;                                                1589
*                                                                  1589
*          PARMID=SUPERID(PARMLVL);                                1590
*                                                                  1590
@RF01584 LH    @15,PARMLVL                                         1590
         ALR   @15,@15                                             1590
         LH    @15,SUPERID-2(@15)                                  1590
         STH   @15,PARMID                                          1590
*          /**********************************************************/
*          /*                                                        */
*          /* RESET PARAMETER OCCURRENCE FLAGS FOR PARAMETERS IN THE */
*          /* SUBLIST JUST COMPLETED.                                */
*          /*                                                        */
*          /**********************************************************/
*          DO LISTINDX=1 TO MAXID;                                 1591
         LA    @15,1                                               1591
         B     @DE01591                                            1591
@DL01591 DS    0H                                                  1592
*            IF PARMPTR(LISTINDX) ^= NULLPTR                       1592
*              THEN                                                1592
         LR    @14,@15                                             1592
         MH    @14,@CH00038                                        1592
         L     @01,WORKPTR                                         1592
         AL    @01,@CF01317                                        1592
         L     @14,PARMPTR(@14,@01)                                1592
         LTR   @14,@14                                             1592
         BZ    @RF01592                                            1592
*                DO;                                               1593
*                  OLDERID2 = NEWERID2;                            1594
         L     @01,GDTPTR                                          1594
         L     @14,GDTTR2(,@01)                                    1594
         MVC   @TS00001(95),NEWERID2(@14)                          1594
         MVC   OLDERID2(95,@14),@TS00001                           1594
*                  NEWID2='RI35';                                  1595
         MVC   NEWID2(4,@14),@CC01134                              1595
*                  TESTID=LISTINDX;                                1596
         STH   @15,TESTID                                          1596
*                  DO WHILE(TESTID^=0);                            1597
         B     @DE01597                                            1597
@DL01597 DS    0H                                                  1598
*                    IF SUPRPARM(TESTID)=PARMID                    1598
*                      THEN                                        1598
         L     @15,WORKPTR                                         1598
         LA    @14,12                                              1598
         LR    @05,@14                                             1598
         MH    @05,TESTID                                          1598
         AL    @05,@CF01318                                        1598
         LH    @05,SUPRPARM-8(@05,@15)                             1598
         CH    @05,PARMID                                          1598
         BNE   @RF01598                                            1598
*                        PARMFLAG(LISTINDX)=0;                     1599
         MH    @14,LISTINDX                                        1599
         SLR   @05,@05                                             1599
         BCTR  @15,0                                               1599
         BCTR  @15,0                                               1599
         STC   @05,PARMFLAG-10(@14,@15)                            1599
*                    TESTID=SUPRPARM(TESTID);                      1600
@RF01598 LH    @15,TESTID                                          1600
         MH    @15,@CH00038                                        1600
         L     @01,WORKPTR                                         1600
         AL    @01,@CF01318                                        1600
         LH    @15,SUPRPARM-8(@15,@01)                             1600
         STH   @15,TESTID                                          1600
*                  END;                                            1601
@DE01597 LH    @15,TESTID                                          1601
         LTR   @15,@15                                             1601
         BNZ   @DL01597                                            1601
*                END;                                              1602
*          END;                                                    1603
*                                                                  1603
@RF01592 LA    @15,1                                               1603
         AH    @15,LISTINDX                                        1603
@DE01591 STH   @15,LISTINDX                                        1603
         L     @14,DESCPTR                                         1603
         CH    @15,MAXID(,@14)                                     1603
         BNH   @DL01591                                            1603
*          /**********************************************************/
*          /*                                                        */
*          /* IF ANOTHER SUBLIST FOLLOWS, BYPASS DELIMITERS PREPARING*/
*          /* TO SCAN NEW SUBLIST AND UPDATE LIST OCCURRENCE COUNTS. */
*          /* ALSO CHECK TO BE SURE THAT TOO MANY SUBLISTS HAVE NOT  */
*          /* BEEN INPUT.                                            */
*          /*                                                        */
*          /**********************************************************/
*          IF CHAR1=OPENING                                        1604
*            THEN                                                  1604
         CLI   CHAR1,C'('                                          1604
         BNE   @RF01604                                            1604
*DOGRP108:     DO;                                                 1605
*                                                                  1605
DOGRP108 DS    0H                                                  1606
*                CALL NEXTCHAR;                                    1606
         BAL   @14,NEXTCHAR                                        1606
*                CALL SCANSEP(NO);                                 1607
*                                                                  1607
         LA    @01,@AL01607                                        1607
         BAL   @14,SCANSEP                                         1607
*                SUBSYET=NO;                                       1608
         NI    SUBSYET,B'11101111'                                 1608
*                REPCOUNT(REPDEPTH)=REPCOUNT(REPDEPTH)+1;          1609
         LH    @15,REPDEPTH                                        1609
         ALR   @15,@15                                             1609
         LA    @14,1                                               1609
         AH    @14,REPCOUNT-2(@15)                                 1609
         STH   @14,REPCOUNT-2(@15)                                 1609
*                IF REPCOUNT(REPDEPTH) > REPLIMIT(REPDEPTH)        1610
*                  THEN                                            1610
*                                                                  1610
         CH    @14,REPLIMIT-2(@15)                                 1610
         BNH   @RF01610                                            1610
*                    CALL ERROR1(REPERR);                          1611
*                                                                  1611
         LA    @01,@AL01611                                        1611
         BAL   @14,ERROR1                                          1611
*                  ELSE                                            1612
*DOGRP109:           DO;                                           1612
*                                                                  1612
         B     @RC01610                                            1612
@RF01610 DS    0H                                                  1612
DOGRP109 DS    0H                                                  1613
*                    /************************************************/
*                    /*                                              */
*                    /* IF THE CURRENT REPEATED LIST IS NOT NESTED   */
*                    /* WITHIN ANY OTHER REPEATED SUBLIST, THEN A    */
*                    /* LIST OF POINTER BLOCKS IS BEING MAINTAINED   */
*                    /* TO POINT TO SCALAR DATA OF PARAMETERS WITHIN */
*                    /* THIS REPEATED SUBLIST.  ALLOCATE ANOTHER     */
*                    /* BLOCK OF POINTERS FOR EACH SUBPARM IN THE    */
*                    /* SUBLIST IF ENOUGH REPETITIONS OF THE SUBLIST */
*                    /* HAVE OCCURRED TO REQUIRE THIS.               */
*                    /*                                              */
*                    /************************************************/
*                    SUBOCCUR=REPMAX;                              1613
         LA    @15,12                                              1613
         LR    @14,@15                                             1613
         MH    @14,PARMID                                          1613
         L     @01,WORKPTR                                         1613
         AL    @01,@CF01317                                        1613
         AL    @15,PARMPTR(@14,@01)                                1613
         SLR   @14,@14                                             1613
         IC    @14,REPMAX(,@15)                                    1613
         ST    @14,SUBOCCUR                                        1613
*                    IF REPDEPTH=1 &                               1614
*                       REPCOUNT(REPDEPTH)//(VECTRSIZ-1)=1         1614
*                      THEN                                        1614
         LH    @15,REPDEPTH                                        1614
         LA    @14,1                                               1614
         CR    @15,@14                                             1614
         BNE   @RF01614                                            1614
         ALR   @15,@15                                             1614
         LH    @00,REPCOUNT-2(@15)                                 1614
         SRDA  @00,32                                              1614
         D     @00,@CF00042                                        1614
         CR    @00,@14                                             1614
         BNE   @RF01614                                            1614
*DOLOOP17:               DO VLISTID=1 TO MAXID WHILE(RISTATUS=0);  1615
DOLOOP17 LA    @15,1                                               1615
         B     @DE01615                                            1615
@DL01615 SLR   @14,@14                                             1615
         CH    @14,RISTATUS                                        1615
         BNE   @DC01615                                            1615
*                          IF PARMPTR(VLISTID) ^= NULLPTR &        1616
*                             PARMPTR(VLISTID)->OCCURNUM = SUBOCCUR
*                            THEN                                  1616
         MH    @15,@CH00038                                        1616
         L     @01,WORKPTR                                         1616
         AL    @01,@CF01317                                        1616
         L     @15,PARMPTR(@15,@01)                                1616
         CR    @15,@14                                             1616
         BE    @RF01616                                            1616
         L     @15,OCCURNUM-1(,@15)                                1616
         LA    @15,0(,@15)                                         1616
         C     @15,SUBOCCUR                                        1616
         BNE   @RF01616                                            1616
*DOGRP111:                     DO;                                 1617
DOGRP111 DS    0H                                                  1618
*                                TESTID=VLISTID;                   1618
*                                                                  1618
         MVC   TESTID(2),VLISTID                                   1618
*                                /************************************/
*                                /*                                  */
*                                /* DETERMINE WHETHER THIS PARAMETER */
*                                /* IS ONE OF THE PARM'S NEEDING MORE*/
*                                /* DATA POINTERS & IF SO ADD ANOTHER*/
*                                /* BLOCK OF POINTERS TO THE LIST.   */
*                                /*                                  */
*                                /************************************/
*DOLOOP18:                       DO WHILE(TESTID^=0 & RISTATUS=0); 1619
DOLOOP18 B     @DE01619                                            1619
@DL01619 DS    0H                                                  1620
*                                  IF SUPRPARM(TESTID) = PARMID    1620
*                                    THEN                          1620
         LH    @15,TESTID                                          1620
         MH    @15,@CH00038                                        1620
         L     @01,WORKPTR                                         1620
         AL    @01,@CF01318                                        1620
         LH    @15,SUPRPARM-8(@15,@01)                             1620
         CH    @15,PARMID                                          1620
         BNE   @RF01620                                            1620
*                                      DO;                         1621
*                                        ARRYPTR=FDTPTR(VLISTID);  1622
         LH    @15,VLISTID                                         1622
         SLA   @15,2                                               1622
         L     @01,FDTADDR                                         1622
         L     @15,FDTPTR-4(@15,@01)                               1622
         ST    @15,ARRYPTR                                         1622
*                                        DO WHILE(VECTRPTR ^= 0);  1623
         B     @DE01623                                            1623
@DL01623 DS    0H                                                  1624
*                                          ARRYPTR=VECTRPTR;       1624
         LH    @15,VECTRLEN                                        1624
         AL    @15,ARRYPTR                                         1624
         L     @15,VECTRPTR(,@15)                                  1624
         ST    @15,ARRYPTR                                         1624
*                                        END;                      1625
@DE01623 LH    @15,VECTRLEN                                        1625
         AL    @15,ARRYPTR                                         1625
         L     @14,VECTRPTR(,@15)                                  1625
         LTR   @14,@14                                             1625
         BNZ   @DL01623                                            1625
*                                        AMTTOGET=VECTRSIZ*PTRLNGTH;
*                                                                  1626
         MVC   AMTTOGET(4),@CF01297                                1626
*                                        CALL ICKSAGP0(GDTTBL,AMTTOGET,
*                                               VECTRPTR,RIPOOLID, 1627
*                                               SETZERO);          1627
         L     @14,GDTPTR                                          1627
         ST    @14,@AL00001                                        1627
         LA    @05,AMTTOGET                                        1627
         ST    @05,@AL00001+4                                      1627
         ST    @15,@AL00001+8                                      1627
         LA    @15,RIPOOLID                                        1627
         ST    @15,@AL00001+12                                     1627
         LA    @15,@CC00153                                        1627
         ST    @15,@AL00001+16                                     1627
         MVI   @AL00001+16,X'80'                                   1627
         L     @15,GDTGPL(,@14)                                    1627
         LA    @01,@AL00001                                        1627
         BALR  @14,@15                                             1627
*                                        RESPECIFY RTNREG RSTD;    1628
*                                        TESTRC = RTNREG;          1629
         STH   RTNREG,TESTRC                                       1629
*                                        RESPECIFY RTNREG UNRSTD;  1630
*                                                                  1630
*                                        IF TESTRC^=0              1631
*                                          THEN                    1631
*                                                                  1631
         LH    @15,TESTRC                                          1631
         LTR   @15,@15                                             1631
         BZ    @RF01631                                            1631
*                                            CALL ERROR1(NOSPACE); 1632
*                                                                  1632
         LA    @01,@AL01632                                        1632
         BAL   @14,ERROR1                                          1632
*                                          ELSE                    1633
*                                            TESTID=0;             1633
         B     @RC01631                                            1633
@RF01631 SLR   @15,@15                                             1633
         STH   @15,TESTID                                          1633
*                                      END;                        1634
*                                    ELSE                          1635
*                                      TESTID=SUPRPARM(TESTID);    1635
         B     @RC01620                                            1635
@RF01620 LH    @15,TESTID                                          1635
         MH    @15,@CH00038                                        1635
         L     @01,WORKPTR                                         1635
         AL    @01,@CF01318                                        1635
         LH    @15,SUPRPARM-8(@15,@01)                             1635
         STH   @15,TESTID                                          1635
*                                END DOLOOP18;                     1636
@RC01620 DS    0H                                                  1636
@DE01619 SLR   @15,@15                                             1636
         CH    @15,TESTID                                          1636
         BE    @DC01619                                            1636
         CH    @15,RISTATUS                                        1636
         BE    @DL01619                                            1636
@DC01619 DS    0H                                                  1637
*                              END DOGRP111;                       1637
*                        END DOLOOP17;                             1638
*                                                                  1638
@RF01616 LA    @15,1                                               1638
         AH    @15,VLISTID                                         1638
@DE01615 STH   @15,VLISTID                                         1638
         L     @14,DESCPTR                                         1638
         CH    @15,MAXID(,@14)                                     1638
         BNH   @DL01615                                            1638
@DC01615 DS    0H                                                  1639
*                    /************************************************/
*                    /*                                              */
*                    /* INCREMENT THE COUNTER VALUE IN THE FDT THAT  */
*                    /* PERTAINS TO THE NUMBER OF REPEATED SUBLIST   */
*                    /* REPETITIONS.                                 */
*                    /*                                              */
*                    /************************************************/
*                    ARRYPTR=FDTPTR(SUPERID(PARMLVL));             1639
@RF01614 LH    @15,PARMLVL                                         1639
         ALR   @15,@15                                             1639
         LH    @15,SUPERID-2(@15)                                  1639
         SLA   @15,2                                               1639
         L     @01,FDTADDR                                         1639
         L     @15,FDTPTR-4(@15,@01)                               1639
         ST    @15,ARRYPTR                                         1639
*                    HWORDARG=REPDEPTH-1;                          1640
*                                                                  1640
         LH    @15,REPDEPTH                                        1640
         BCTR  @15,0                                               1640
         STH   @15,HWORDARG                                        1640
*                    CALL DSPLCALC(HWORDARG);                      1641
*                                                                  1641
         LA    @15,HWORDARG                                        1641
         ST    @15,@AL00001                                        1641
         LA    @01,@AL00001                                        1641
         BAL   @14,DSPLCALC                                        1641
*                    REPTOTAL=REPTOTAL+1;                          1642
         LH    @15,ARRYDSPL                                        1642
         AL    @15,ARRYPTR                                         1642
         LA    @14,1                                               1642
         L     @05,REPTOTAL(,@15)                                  1642
         ALR   @05,@14                                             1642
         ST    @05,REPTOTAL(,@15)                                  1642
*                    PPARMCNT(PARMLVL)=1;                          1643
         LH    @15,PARMLVL                                         1643
         ALR   @15,@15                                             1643
         STH   @14,PPARMCNT-2(@15)                                 1643
*                  END DOGRP109;                                   1644
*              END DOGRP108;                                       1645
*            ELSE                                                  1646
*                                                                  1646
*              /******************************************************/
*              /*                                                    */
*              /* IF THE CURRENT SUBLIST IS THE LAST REPEATED LIST   */
*              /* AT THIS LEVEL, RESET INDEXES AND COUNTS TO CONTINUE*/
*              /* SCANNING PARAMETERS AT NEXT HIGHER LEVEL.          */
*              /*                                                    */
*              /******************************************************/
*              IF CHAR1=CLOSING                                    1646
*                THEN                                              1646
         B     @RC01604                                            1646
@RF01604 CLI   CHAR1,C')'                                          1646
         BNE   @RF01646                                            1646
*                  DO;                                             1647
*                    OLDERID2 = NEWERID2;                          1648
         L     @01,GDTPTR                                          1648
         L     @15,GDTTR2(,@01)                                    1648
         MVC   @TS00001(95),NEWERID2(@15)                          1648
         MVC   OLDERID2(95,@15),@TS00001                           1648
*                    NEWID2='RI36';                                1649
         MVC   NEWID2(4,@15),@CC01145                              1649
*                    REPDEPTH=REPDEPTH-1;                          1650
*                                                                  1650
         LH    @15,REPDEPTH                                        1650
         BCTR  @15,0                                               1650
         STH   @15,REPDEPTH                                        1650
*                    CALL NEXTCHAR;                                1651
         BAL   @14,NEXTCHAR                                        1651
*                    CALL SCANSEP(YES);                            1652
*                                                                  1652
         LA    @01,@AL01652                                        1652
         BAL   @14,SCANSEP                                         1652
*                    PARMLVL=PARMLVL-1;                            1653
         LH    @15,PARMLVL                                         1653
         BCTR  @15,0                                               1653
         STH   @15,PARMLVL                                         1653
*                  END;                                            1654
*                ELSE                                              1655
*                                                                  1655
*                  /**************************************************/
*                  /*                                                */
*                  /* IF STATEMENT END HAS BEEN REACHED (EVEN THOUGH */
*                  /* SOME CLOSING PARENTHESES ARE MISSING), APPLY   */
*                  /* DEFAULTS FOR EACH LEVEL NOT EXPLICITLY CLOSED. */
*                  /* ISSUE A WARNING MESSAGE ABOUT THE PARENTHESES. */
*                  /*                                                */
*                  /**************************************************/
*                  IF CHAR1=ENDDELIM                               1655
*                    THEN                                          1655
         B     @RC01646                                            1655
@RF01646 CLI   CHAR1,C';'                                          1655
         BNE   @RF01655                                            1655
*                      DO;                                         1656
*                      PARMLVL=PARMLVL-1;                          1657
         LH    @15,PARMLVL                                         1657
         BCTR  @15,0                                               1657
         STH   @15,PARMLVL                                         1657
*                      REPDEPTH=REPDEPTH-1;                        1658
         LH    @14,REPDEPTH                                        1658
         BCTR  @14,0                                               1658
         STH   @14,REPDEPTH                                        1658
*                      IF PARMLVL=1                                1659
*                        THEN                                      1659
         CH    @15,@CH00172                                        1659
         BNE   @RF01659                                            1659
*                          DO;                                     1660
*                          DARGSMOD=RISTID;                        1661
         L     @15,DDSTRU                                          1661
         MVC   DARGSMOD(3,@15),RISTID                              1661
*                          DARGSENT=TOOFEW;                        1662
*                                                                  1662
         MVI   DARGSENT(@15),X'23'                                 1662
*                          CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);   1663
*                                                                  1663
         L     @15,GDTPTR                                          1663
         ST    @15,@AL00001                                        1663
         LA    @14,@CF00102                                        1663
         ST    @14,@AL00001+4                                      1663
         LA    @14,DDSTRU                                          1663
         ST    @14,@AL00001+8                                      1663
         MVI   @AL00001+8,X'80'                                    1663
         L     @15,GDTPRT(,@15)                                    1663
         LA    @01,@AL00001                                        1663
         BALR  @14,@15                                             1663
*                          END;                                    1664
*                      END;                                        1665
*                    ELSE                                          1666
*                                                                  1666
*                      CALL ERROR1(BADELIM4);                      1666
*                                                                  1666
         B     @RC01655                                            1666
@RF01655 LA    @01,@AL01666                                        1666
         BAL   @14,ERROR1                                          1666
*        END INREPEAT;                                             1667
         B     @EL00020                                            1667
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - DEFAULTS                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE DETERMINES DEFAULT PARMS IN             */
*/*             ADDITION TO THE PARAMETERS WHICH HAVE ACTUALLY BEEN  */
*/*             CODED AS INPUT ON A COMMAND.  THE REQUIRED DEFAULT   */
*/*             INFORMATION FOR A COMMAND IS CONTAINED IN THE COMMAND*/
*/*             DESCRIPTOR.  A DEFAULT IS APPLIED AS LONG AS THERE   */
*/*             IS NO SEMANTIC REQUIREMENT PROHIBITING IT DUE TO A   */
*/*             PARAMETER WHICH HAS ALREADY BEEN INPUT.  DEFAULTS    */
*/*             ARE APPLIED AT COMMAND END AND AT THE END OF EACH    */
*/*             REPETITION OF A REPEATED SUBPARAMETER LIST (IN THE   */
*/*             LATTER CASE, ONLY DEFAULTS APPLYING TO THAT SUBLIST  */
*/*             ARE APPLIED).                                        */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */
*/*          SUPERID - SUPERPARAMETER ID# OF PARAMETER WHOSE SUBLIST */
*/*                    IS RECEIVING DEFAULTS (ID#=0 IF APPLYING      */
*/*                    DEFAULTS FOR ENTIRE COMMAND).                 */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS DETECTED.               */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PARAMETER ID# OF A PARAMETER TO BE DEFAULTED            */
*/*                                                                  */
*/********************************************************************/
*DEFAULTS:PROCEDURE;                                               1668
DEFAULTS STM   @14,@12,@SA00021                                    1668
*        /************************************************************/
*        /*                                                          */
*        /*  ** DEFAULTS **  APPLY DEFAULT PARAMETERS                */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1669
*          THEN;                                                   1669
         L     @01,GDTPTR                                          1669
         L     @15,GDTDBG(,@01)                                    1669
         LTR   @15,@15                                             1669
         BZ    @RT01669                                            1669
*          ELSE                                                    1671
*            CALL ICKDB010(GDTTBL,'RIDF');                         1671
*                                                                  1671
         L     @15,GDTPTR                                          1671
         ST    @15,@AL00001                                        1671
         LA    @14,@CC01149                                        1671
         ST    @14,@AL00001+4                                      1671
         MVI   @AL00001+4,X'80'                                    1671
         L     @15,GDTDBG(,@15)                                    1671
         LA    @01,@AL00001                                        1671
         BALR  @14,@15                                             1671
*        /************************************************************/
*        /*                                                          */
*        /* UPON ENTRY TO THIS ROUTINE, THE CURRENT SUPERPARAMETER   */
*        /* ID NUMBER WILL BE ZERO IF STATEMENT END HAS BEEN REACHED.*/
*        /* OTHERWISE, THE ID# WILL BE THAT OF THE PARAMETER WHICH   */
*        /* HAS THE REPEATED SUBPARAMETER LIST.                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1672
*        /************************************************************/
*        /*                                                          */
*        /* IF 'DEFAULT GROUPS' ARE SPECIFIED, FIND THE              */
*        /* GROUP(S) WHICH PERTAIN TO THE CURRENT SET OF             */
*        /* PARAMETERS, AND SELECT DEFAULTS IF APPLICABLE.           */
*        /*                                                          */
*        /************************************************************/
*        IF DGRPDSPL > 0                                           1672
*          THEN                                                    1672
@RT01669 L     @01,DESCPTR                                         1672
         CLI   DGRPDSPL(@01),0                                     1672
         BNH   @RF01672                                            1672
*DOGRP110:   DO;                                                   1673
DOGRP110 DS    0H                                                  1674
*              GRPPTR=ADDR(DGRPTOT)+LENGTH(DGRPTOT);               1674
*                                                                  1674
         L     @15,DESCPTR                                         1674
         SLR   @14,@14                                             1674
         IC    @14,DGRPDSPL(,@15)                                  1674
         ALR   @14,@14                                             1674
         ALR   @15,@14                                             1674
         AL    @15,@CF00124                                        1674
         ST    @15,GRPPTR                                          1674
*              /******************************************************/
*              /*                                                    */
*              /* EXAMINE EACH 'DEFAULT GROUP' SUBLIST,              */
*              /* CHECKING TO SEE IF THE PARAMETER ELIGIBLE          */
*              /* TO BE DEFAULTED IS PART OF THE SET OF              */
*              /* PARAMETERS NOW BEING HANDLED.                      */
*              /*                                                    */
*              /******************************************************/
*DOLOOP19:     DO LISTINDX=1 TO DGRPTOT;                           1675
DOLOOP19 LA    @15,1                                               1675
         B     @DE01675                                            1675
@DL01675 DS    0H                                                  1676
*                FOUND=NO;                                         1676
         NI    FOUND,B'11011111'                                   1676
*                TESTID=DGRPID(1);                                 1677
         L     @01,GRPPTR                                          1677
         MVC   TESTID(2),DGRPID(@01)                               1677
*                DO WHILE(TESTID^=0 & FOUND=NO);                   1678
         B     @DE01678                                            1678
@DL01678 DS    0H                                                  1679
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1679
*                    THEN                                          1679
         LH    @15,TESTID                                          1679
         MH    @15,@CH00038                                        1679
         LH    @14,PARMLVL                                         1679
         ALR   @14,@14                                             1679
         L     @01,WORKPTR                                         1679
         AL    @01,@CF01318                                        1679
         LH    @15,SUPRPARM-8(@15,@01)                             1679
         CH    @15,SUPERID-2(@14)                                  1679
         BNE   @RF01679                                            1679
*                      FOUND=YES;                                  1680
         OI    FOUND,B'00100000'                                   1680
*                    ELSE                                          1681
*                      DO;                                         1681
         B     @RC01679                                            1681
@RF01679 DS    0H                                                  1682
*                      TESTID=SUPRPARM(TESTID);                    1682
         L     @15,WORKPTR                                         1682
         LA    @14,12                                              1682
         LR    @05,@14                                             1682
         MH    @05,TESTID                                          1682
         AL    @05,@CF01318                                        1682
         LH    @05,SUPRPARM-8(@05,@15)                             1682
         STH   @05,TESTID                                          1682
*                      IF PARMPTR(TESTID)->REPEATED=YES            1683
*                        THEN                                      1683
         MR    @04,@14                                             1683
         AL    @15,@CF01317                                        1683
         L     @01,PARMPTR(@05,@15)                                1683
         TM    REPEATED(@01),B'00100000'                           1683
         BNO   @RF01683                                            1683
*                          TESTID=0;                               1684
         SLR   @15,@15                                             1684
         STH   @15,TESTID                                          1684
*                      END;                                        1685
@RF01683 DS    0H                                                  1686
*                END;                                              1686
*                                                                  1686
@RC01679 DS    0H                                                  1686
@DE01678 LH    @15,TESTID                                          1686
         LTR   @15,@15                                             1686
         BZ    @DC01678                                            1686
         TM    FOUND,B'00100000'                                   1686
         BZ    @DL01678                                            1686
@DC01678 DS    0H                                                  1687
*                /****************************************************/
*                /*                                                  */
*                /* IF THE ELIGIBLE PARAMETER IS PART OF THE         */
*                /* CURRENT PARAMETER SET, TEST TO SEE IF            */
*                /* ALL THE PARAMETERS IN THE GROUP WERE NOT         */
*                /* CODED.  IF NONE WERE INPUT, DEFAULT THE          */
*                /* FIRST PARAMETER IN THE SUBLIST.                  */
*                /*                                                  */
*                /****************************************************/
*                IF FOUND=YES                                      1687
*                  THEN                                            1687
         TM    FOUND,B'00100000'                                   1687
         BNO   @RF01687                                            1687
*DOGRP113:           DO;                                           1688
DOGRP113 DS    0H                                                  1689
*                      FOUND=NO;                                   1689
         NI    FOUND,B'11011111'                                   1689
*                      DO INDEX3=1 TO DGRPCNT;                     1690
         LA    @15,1                                               1690
         B     @DE01690                                            1690
@DL01690 DS    0H                                                  1691
*                        IF PARMFLAG(DGRPID(INDEX3))^=0            1691
*                          THEN                                    1691
         ALR   @15,@15                                             1691
         L     @01,GRPPTR                                          1691
         LH    @15,DGRPID-2(@15,@01)                               1691
         MH    @15,@CH00038                                        1691
         L     @01,WORKPTR                                         1691
         BCTR  @01,0                                               1691
         BCTR  @01,0                                               1691
         SLR   @14,@14                                             1691
         IC    @14,PARMFLAG-10(@15,@01)                            1691
         CH    @14,@CH00102                                        1691
         BE    @RF01691                                            1691
*                            FOUND=YES;                            1692
         OI    FOUND,B'00100000'                                   1692
*                      END;                                        1693
@RF01691 LA    @15,1                                               1693
         AH    @15,INDEX3                                          1693
@DE01690 STH   @15,INDEX3                                          1693
         L     @14,GRPPTR                                          1693
         CH    @15,DGRPCNT(,@14)                                   1693
         BNH   @DL01690                                            1693
*                      IF FOUND=NO                                 1694
*                        THEN                                      1694
*                                                                  1694
         TM    FOUND,B'00100000'                                   1694
         BNZ   @RF01694                                            1694
*                          CALL SETDFLT(DGRPID(1));                1695
*                                                                  1695
         L     @01,GRPPTR                                          1695
         LA    @15,DGRPID(,@01)                                    1695
         ST    @15,@AL00001                                        1695
         LA    @01,@AL00001                                        1695
         BAL   @14,SETDFLT                                         1695
*                    END DOGRP113;                                 1696
@RF01694 DS    0H                                                  1697
*                GRPPTR=GRPPTR+LENGTH(DGRPCNT)+                    1697
*                        DGRPCNT*LENGTH(DGRPID(1));                1697
@RF01687 L     @15,GRPPTR                                          1697
         LA    @14,2                                               1697
         ALR   @14,@15                                             1697
         LH    @15,DGRPCNT(,@15)                                   1697
         ALR   @15,@15                                             1697
         ALR   @14,@15                                             1697
         ST    @14,GRPPTR                                          1697
*              END DOLOOP19;                                       1698
         LA    @15,1                                               1698
         AH    @15,LISTINDX                                        1698
@DE01675 STH   @15,LISTINDX                                        1698
         L     @14,DESCPTR                                         1698
         SLR   @05,@05                                             1698
         IC    @05,DGRPDSPL(,@14)                                  1698
         ALR   @05,@05                                             1698
         AL    @05,DESCPTR                                         1698
         CH    @15,DGRPTOT(,@05)                                   1698
         BNH   @DL01675                                            1698
*            END DOGRP110;                                         1699
*                                                                  1699
*        /************************************************************/
*        /*                                                          */
*        /* EXAMINE EACH PARAMETER TO SEE IF A DEFAULT               */
*        /* CONSTANT IS PROVIDED FOR IT.  IF A DEFAULT IS            */
*        /* PRESENT AND THE PARAMETER IS NOT ALREADY INPUT,          */
*        /* THE PARM IS ELIGIBLE TO BE DEFAULTED.                    */
*        /*                                                          */
*        /************************************************************/
*DOLOOP20:DO INDEX3=1 TO MAXID;                                    1700
@RF01672 DS    0H                                                  1700
DOLOOP20 LA    @15,1                                               1700
         B     @DE01700                                            1700
@DL01700 DS    0H                                                  1701
*          IF PARMPTR(INDEX3)^=0 & PARMFLAG(INDEX3)=0 &            1701
*             PARMPTR(INDEX3)->DEFAULT=YES                         1701
*            THEN                                                  1701
         SLR   @14,@14                                             1701
         L     @05,WORKPTR                                         1701
         MH    @15,@CH00038                                        1701
         LA    @01,0(@15,@05)                                      1701
         AL    @01,@CF01317                                        1701
         L     @04,PARMPTR(,@01)                                   1701
         CR    @04,@14                                             1701
         BE    @RF01701                                            1701
         ALR   @05,@15                                             1701
         BCTR  @05,0                                               1701
         BCTR  @05,0                                               1701
         MVC   @ZT00003+3(1),PARMFLAG-10(@05)                      1701
         C     @14,@ZT00003                                        1701
         BNE   @RF01701                                            1701
         TM    DEFAULT(@04),B'00000100'                            1701
         BNO   @RF01701                                            1701
*DOGRP115:     DO;                                                 1702
DOGRP115 DS    0H                                                  1703
*                TESTID=INDEX3;                                    1703
*                                                                  1703
         MVC   TESTID(2),INDEX3                                    1703
*                /****************************************************/
*                /*                                                  */
*                /* BE SURE THAT THE PARAMETER TO BE DEFAULTED IS    */
*                /* PART OF THE SET OF PARAMETERS CURRENTLY BEING    */
*                /* HANDLED.  IF SO, THEN SET THE DEFAULT.           */
*                /*                                                  */
*                /****************************************************/
*DOLOOP22:       DO WHILE(TESTID^=0);                              1704
DOLOOP22 B     @DE01704                                            1704
@DL01704 DS    0H                                                  1705
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1705
*                    THEN                                          1705
         LH    @15,TESTID                                          1705
         MH    @15,@CH00038                                        1705
         LH    @14,PARMLVL                                         1705
         ALR   @14,@14                                             1705
         L     @01,WORKPTR                                         1705
         AL    @01,@CF01318                                        1705
         LH    @15,SUPRPARM-8(@15,@01)                             1705
         CH    @15,SUPERID-2(@14)                                  1705
         BNE   @RF01705                                            1705
*                      DO;                                         1706
*                      TESTID=0;                                   1707
*                                                                  1707
         SLR   @15,@15                                             1707
         STH   @15,TESTID                                          1707
*                      CALL SETDFLT(INDEX3);                       1708
*                                                                  1708
         LA    @15,INDEX3                                          1708
         ST    @15,@AL00001                                        1708
         LA    @01,@AL00001                                        1708
         BAL   @14,SETDFLT                                         1708
*                      END;                                        1709
*                    ELSE                                          1710
*                      DO;                                         1710
         B     @RC01705                                            1710
@RF01705 DS    0H                                                  1711
*                      TESTID=SUPRPARM(TESTID);                    1711
         L     @15,WORKPTR                                         1711
         LA    @14,12                                              1711
         LR    @05,@14                                             1711
         MH    @05,TESTID                                          1711
         AL    @05,@CF01318                                        1711
         LH    @05,SUPRPARM-8(@05,@15)                             1711
         STH   @05,TESTID                                          1711
*                      IF PARMPTR(TESTID)->REPEATED=YES            1712
*                        THEN                                      1712
         MR    @04,@14                                             1712
         AL    @15,@CF01317                                        1712
         L     @01,PARMPTR(@05,@15)                                1712
         TM    REPEATED(@01),B'00100000'                           1712
         BNO   @RF01712                                            1712
*                          TESTID=0;                               1713
         SLR   @15,@15                                             1713
         STH   @15,TESTID                                          1713
*                      END;                                        1714
@RF01712 DS    0H                                                  1715
*                END DOLOOP22;                                     1715
@RC01705 DS    0H                                                  1715
@DE01704 LH    @15,TESTID                                          1715
         LTR   @15,@15                                             1715
         BNZ   @DL01704                                            1715
*              END DOGRP115;                                       1716
*        END DOLOOP20;                                             1717
@RF01701 LA    @15,1                                               1717
         AH    @15,INDEX3                                          1717
@DE01700 STH   @15,INDEX3                                          1717
         L     @14,DESCPTR                                         1717
         CH    @15,MAXID(,@14)                                     1717
         BNH   @DL01700                                            1717
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SETDFLT                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CHECKS A PARM THAT IS ELIGIBLE          */
*/*             TO BE DEFAULTED TO SEE IF THE DEFAULT WILL           */
*/*             CAUSE ANY CONFLICT WITH AN EXISTING INPUT            */
*/*             PARAMETER.  IF NOT, THE DEFAULT PARAMETER            */
*/*             IS ADDED TO THE FDT.                                 */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*          DFLTPARM - THE ID# OF THE PARAMETER TO BE DEFAULTED     */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          ORGSIGN - FORM OF THE CONSTANT (HEX, BINARY             */
*/*                    OR NEITHER) TO BE DEFAULTED.                  */
*/*          PWORD -   SET 'OFF' TO SIGNAL THAT THE ITEM             */
*/*                    BEING DEFAULTED IS NOT A PASSWORD.            */
*/*          SYNUNIT - CONTAINS THE ITEM TO BE DEFAULTED.            */
*/*          UNITINDX- LENGTH OF THE ITEM TO BE DEFAULTED.           */
*/*                                                                  */
*/********************************************************************/
*SETDFLT:PROCEDURE(DFLTPARM);                                      1718
         B     @PB00022                                            1718
SETDFLT  STM   @14,@12,@SA00022                                    1718
         MVC   @PC00022(4),0(@01)                                  1718
*        /************************************************************/
*        /*                                                          */
*        /* DATA DEFINITIONS FOR SETDFLT ROUTINE                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1719
*        DCL DFLTPARM FIXED(15);       /*ID# OF PARM TO BE           */
*                                      /* DEFAULTED.                 */
*        DCL WORKVAR2 FIXED(15);       /*VARIABLE TO CONTAIN         */
*                                      /*A TEMPORARY VALUE           */
*        DCL DEFLTPTR PTR(31);         /*VARIABLE TO CONTAIN         */
*                                      /*PTR TO DEFAULT INFO         */
*                                      /*IN THE DESCRIPTOR.          */
*        DCL DFLTOK   BIT(1);          /*SIGNALS THAT PARM           */
*                                      /* IDENTIFIED IN THE          */
*                                      /* ABOVE LIST IS OK           */
*                                      /* TO BE DEFAULTED.           */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SETDFLT **  APPLY DEFAULT PARAMETERS                 */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1723
*          THEN;                                                   1723
         L     @01,GDTPTR                                          1723
         L     @15,GDTDBG(,@01)                                    1723
         LTR   @15,@15                                             1723
         BZ    @RT01723                                            1723
*          ELSE                                                    1725
*            CALL ICKDB010(GDTTBL,'RIST');                         1725
*                                                                  1725
         L     @15,GDTPTR                                          1725
         ST    @15,@AL00001                                        1725
         LA    @14,@CC01171                                        1725
         ST    @14,@AL00001+4                                      1725
         MVI   @AL00001+4,X'80'                                    1725
         L     @15,GDTDBG(,@15)                                    1725
         LA    @01,@AL00001                                        1725
         BALR  @14,@15                                             1725
*        /************************************************************/
*        /*                                                          */
*        /* THE PARAMETER TO BE DEFAULTED IS CHECKED TO              */
*        /* INSURE THAT ITS PRESENCE WILL NOT CREATE A               */
*        /* CONFLICT WITH AN EXISTING INPUT PARAMETER.               */
*        /* SINCE KEYWORD SUPERPARM(S) OF THE DEFAULT PARM           */
*        /* ARE TO BE DEFAULTED (AS NECESSARY) ALONG WITH            */
*        /* IT, THESE SUPERPARM(S) ARE ALSO CHECKED FOR              */
*        /* POTENTIAL CONFLICTS                                      */
*        /*                                                          */
*        /************************************************************/
*        PARMID=DFLTPARM;                                          1726
@RT01723 L     @15,@PC00022                                        1726
         MVC   PARMID(2),DFLTPARM(@15)                             1726
*        DFLTOK=YES;                                               1727
         OI    DFLTOK,B'10000000'                                  1727
*        DO WHILE(DFLTOK=YES &                                     1728
*                   PARMID^=0 & PARMFLAG(PARMID)=0);               1728
*                                                                  1728
         B     @DE01728                                            1728
@DL01728 DS    0H                                                  1729
*          /**********************************************************/
*          /*                                                        */
*          /* FIRST, CHECK FOR A LIST OF CONFLICTING PARMS           */
*          /* SPECIFICALLY ASSOCIATED WITH THE DEFAULT PARM,         */
*          /* AND BE SURE THAT NO CONFLICTS WOULD EXIST.             */
*          /*                                                        */
*          /**********************************************************/
*          IF NOTDSPL > 0                                          1729
*            THEN                                                  1729
         LH    @15,PARMID                                          1729
         MH    @15,@CH00038                                        1729
         L     @01,WORKPTR                                         1729
         AL    @01,@CF01317                                        1729
         L     @15,PARMPTR(@15,@01)                                1729
         CLI   NOTDSPL(@15),0                                      1729
         BNH   @RF01729                                            1729
*              DO;                                                 1730
*                WORKVAR2=NOTCOUNT;                                1731
         SLR   @14,@14                                             1731
         IC    @14,NOTDSPL(,@15)                                   1731
         ALR   @14,@14                                             1731
         ALR   @15,@14                                             1731
         MVC   WORKVAR2(2),NOTCOUNT(@15)                           1731
*                DO INDEX2=1 TO WORKVAR2;                          1732
         LA    @15,1                                               1732
         B     @DE01732                                            1732
@DL01732 DS    0H                                                  1733
*                  IF PARMFLAG(NOTID(INDEX2)) ^= 0                 1733
*                    THEN                                          1733
         L     @14,WORKPTR                                         1733
         LA    @05,12                                              1733
         ALR   @15,@15                                             1733
         LR    @04,@05                                             1733
         MH    @04,PARMID                                          1733
         AL    @04,@CF01317                                        1733
         L     @04,PARMPTR(@04,@14)                                1733
         SLR   @03,@03                                             1733
         IC    @03,NOTDSPL(,@04)                                   1733
         ALR   @03,@03                                             1733
         ALR   @04,@03                                             1733
         MH    @05,NOTID-2(@15,@04)                                1733
         BCTR  @14,0                                               1733
         BCTR  @14,0                                               1733
         SLR   @15,@15                                             1733
         IC    @15,PARMFLAG-10(@05,@14)                            1733
         CH    @15,@CH00102                                        1733
         BE    @RF01733                                            1733
*                      DFLTOK=NO;                                  1734
         NI    DFLTOK,B'01111111'                                  1734
*                END;                                              1735
@RF01733 LA    @15,1                                               1735
         AH    @15,INDEX2                                          1735
@DE01732 STH   @15,INDEX2                                          1735
         CH    @15,WORKVAR2                                        1735
         BNH   @DL01732                                            1735
*              END;                                                1736
*                                                                  1736
*          /**********************************************************/
*          /*                                                        */
*          /* THEN CHECK FOR THE OCCURRENCE OF THIS DEFAULT          */
*          /* PARAMETER IN A 'NOT GROUP' (A SET OF MUTUALLY          */
*          /* EXCLUSIVE PARMS), AND BE SURE THAT NO OTHER            */
*          /* PARAMETER IN THE GROUP IS INPUT                        */
*          /*                                                        */
*          /**********************************************************/
*          IF DFLTOK=YES & NTGRPPTR(PARMID)^=NULLPTR               1737
*            THEN                                                  1737
@RF01729 TM    DFLTOK,B'10000000'                                  1737
         BNO   @RF01737                                            1737
         LH    @15,PARMID                                          1737
         MH    @15,@CH00038                                        1737
         L     @01,WORKPTR                                         1737
         AL    @01,@CF01376                                        1737
         L     @15,NTGRPPTR-4(@15,@01)                             1737
         LTR   @15,@15                                             1737
         BZ    @RF01737                                            1737
*              DO;                                                 1738
*                WORKPTR2=GRPPTR;                                  1739
         MVC   WORKPTR2(4),GRPPTR                                  1739
*                GRPPTR=NTGRPPTR(PARMID);                          1740
         ST    @15,GRPPTR                                          1740
*                DO INDEX2=1 TO NTGRPCNT;                          1741
         LA    @15,1                                               1741
         B     @DE01741                                            1741
@DL01741 DS    0H                                                  1742
*                  IF PARMFLAG(NTGRPID(INDEX2))^=0 &               1742
*                     NTGRPID(INDEX2)^=PARMID                      1742
*                    THEN                                          1742
         ALR   @15,@15                                             1742
         L     @01,GRPPTR                                          1742
         LH    @15,NTGRPID-2(@15,@01)                              1742
         LR    @14,@15                                             1742
         MH    @14,@CH00038                                        1742
         L     @01,WORKPTR                                         1742
         BCTR  @01,0                                               1742
         BCTR  @01,0                                               1742
         SLR   @00,@00                                             1742
         IC    @00,PARMFLAG-10(@14,@01)                            1742
         CH    @00,@CH00102                                        1742
         BE    @RF01742                                            1742
         CH    @15,PARMID                                          1742
         BE    @RF01742                                            1742
*                      DFLTOK=NO;                                  1743
         NI    DFLTOK,B'01111111'                                  1743
*                END;                                              1744
@RF01742 LA    @15,1                                               1744
         AH    @15,INDEX2                                          1744
@DE01741 STH   @15,INDEX2                                          1744
         L     @14,GRPPTR                                          1744
         CH    @15,NTGRPCNT(,@14)                                  1744
         BNH   @DL01741                                            1744
*                GRPPTR=WORKPTR2;                                  1745
         MVC   GRPPTR(4),WORKPTR2                                  1745
*              END;                                                1746
*          PARMID=SUPRPARM(PARMID);                                1747
@RF01737 LH    @15,PARMID                                          1747
         MH    @15,@CH00038                                        1747
         L     @01,WORKPTR                                         1747
         AL    @01,@CF01318                                        1747
         LH    @15,SUPRPARM-8(@15,@01)                             1747
         STH   @15,PARMID                                          1747
*        END;                                                      1748
*                                                                  1748
@DE01728 TM    DFLTOK,B'10000000'                                  1748
         BNO   @DC01728                                            1748
         LH    @15,PARMID                                          1748
         SLR   @14,@14                                             1748
         CR    @15,@14                                             1748
         BE    @DC01728                                            1748
         MH    @15,@CH00038                                        1748
         L     @01,WORKPTR                                         1748
         ALR   @01,@15                                             1748
         BCTR  @01,0                                               1748
         BCTR  @01,0                                               1748
         MVC   @ZT00003+3(1),PARMFLAG-10(@01)                      1748
         C     @14,@ZT00003                                        1748
         BE    @DL01728                                            1748
@DC01728 DS    0H                                                  1749
*        /************************************************************/
*        /*                                                          */
*        /* IF NO CONFLICTS WILL OCCUR BY DEFAULTING THIS            */
*        /* PARAMETER, NOTE THE PARM'S (AND SUPERPARM'S)             */
*        /* OCCURRENCE IN THE PARMFLAG TABLE AND IN THE FDT.         */
*        /*                                                          */
*        /************************************************************/
*        IF DFLTOK=YES                                             1749
*          THEN                                                    1749
         TM    DFLTOK,B'10000000'                                  1749
         BNO   @RF01749                                            1749
*DOGRP145:   DO;                                                   1750
DOGRP145 DS    0H                                                  1751
*            OLDERID2 = NEWERID2;                                  1751
         L     @01,GDTPTR                                          1751
         L     @15,GDTTR2(,@01)                                    1751
         MVC   @TS00001(95),NEWERID2(@15)                          1751
         MVC   OLDERID2(95,@15),@TS00001                           1751
*            NEWID2='RI44';                                        1752
         MVC   NEWID2(4,@15),@CC01174                              1752
*            PARMID=DFLTPARM;                                      1753
         L     @15,@PC00022                                        1753
         MVC   PARMID(2),DFLTPARM(@15)                             1753
*            DO WHILE(PARMID^=0 & PARMFLAG(PARMID)=0);             1754
*                                                                  1754
         B     @DE01754                                            1754
@DL01754 DS    0H                                                  1755
*              CALL SETFLAG;                                       1755
*                                                                  1755
         BAL   @14,SETFLAG                                         1755
*              PARMID=SUPRPARM(PARMID);                            1756
         LH    @15,PARMID                                          1756
         MH    @15,@CH00038                                        1756
         L     @01,WORKPTR                                         1756
         AL    @01,@CF01318                                        1756
         LH    @15,SUPRPARM-8(@15,@01)                             1756
         STH   @15,PARMID                                          1756
*            END;                                                  1757
@DE01754 LH    @15,PARMID                                          1757
         SLR   @14,@14                                             1757
         CR    @15,@14                                             1757
         BE    @DC01754                                            1757
         MH    @15,@CH00038                                        1757
         L     @01,WORKPTR                                         1757
         ALR   @01,@15                                             1757
         BCTR  @01,0                                               1757
         BCTR  @01,0                                               1757
         MVC   @ZT00003+3(1),PARMFLAG-10(@01)                      1757
         C     @14,@ZT00003                                        1757
         BE    @DL01754                                            1757
@DC01754 DS    0H                                                  1758
*            PARMID=DFLTPARM;                                      1758
*                                                                  1758
         L     @15,@PC00022                                        1758
         LH    @15,DFLTPARM(,@15)                                  1758
         STH   @15,PARMID                                          1758
*            /********************************************************/
*            /*                                                      */
*            /* IF A DEFAULT CONSTANT IS PROVIDED, PERFORM           */
*            /* NECESSARY CONVERSION AND PLACE IT IN THE FDT         */
*            /*                                                      */
*            /********************************************************/
*            IF DEFAULT=YES & SCANONLY=NO                          1759
*              THEN                                                1759
         MH    @15,@CH00038                                        1759
         L     @01,WORKPTR                                         1759
         AL    @01,@CF01317                                        1759
         L     @01,PARMPTR(@15,@01)                                1759
         TM    DEFAULT(@01),B'00000100'                            1759
         BNO   @RF01759                                            1759
         TM    SCANONLY,B'00010000'                                1759
         BNZ   @RF01759                                            1759
*DOGRP150:       DO;                                               1760
DOGRP150 DS    0H                                                  1761
*                SCLRCNT=0;                                        1761
         SLR   @15,@15                                             1761
         STH   @15,SCLRCNT                                         1761
*                ORGSIGN=BLANK;                                    1762
         MVI   ORGSIGN,C' '                                        1762
*                PWORD=NONE;                                       1763
*                                                                  1763
         STH   @15,PWORD                                           1763
*                /****************************************************/
*                /*                                                  */
*                /* IF THE CONSTANT IS A HEX OR BINARY               */
*                /* CONSTANT, EXTRACT THE BINARY OR HEX              */
*                /* DESIGNATION CHAR. AND REMOVE DELIMITING          */
*                /* APOSTROPHES BEFORE PLACING THE VALUE IN          */
*                /* THE FDT.  OTHERWISE, PLACE THE CONSTANT          */
*                /* INTO THE FDT IN ITS PROVIDED FORM.               */
*                /*                                                  */
*                /****************************************************/
*                DEFLTPTR=PARMPTR(PARMID)+LENGTH(PARMDATA)+        1764
*                          LENGTH(DSCRPTR2);                       1764
         LA    @15,12                                              1764
         LR    @14,@15                                             1764
         MH    @14,PARMID                                          1764
         L     @01,WORKPTR                                         1764
         AL    @01,@CF01317                                        1764
         L     @14,PARMPTR(@14,@01)                                1764
         LA    @05,24                                              1764
         ALR   @05,@14                                             1764
         ST    @05,DEFLTPTR                                        1764
*                RESPECIFY(DEFLT) BASED(DEFLTPTR);                 1765
*                IF (NUMBER=YES  ANYSTRNG=YES) & DEFLTLEN > 3 &   1766
*                   (DEFLTVAL(1)=BINSIGN  DEFLTVAL(1)=HEXSIGN) &  1766
*                   DEFLTVAL(2)=QUOTE & DEFLTVAL(DEFLTLEN)=QUOTE   1766
*                  THEN                                            1766
         ALR   @14,@15                                             1766
         TM    NUMBER(@14),B'11000000'                             1766
         BZ    @RF01766                                            1766
         CLI   DEFLTLEN(@05),3                                     1766
         BNH   @RF01766                                            1766
         CLI   DEFLTVAL(@05),C'B'                                  1766
         BE    @GL00099                                            1766
         CLI   DEFLTVAL(@05),C'X'                                  1766
         BNE   @RF01766                                            1766
@GL00099 L     @15,DEFLTPTR                                        1766
         CLI   DEFLTVAL+1(@15),C''''                               1766
         BNE   @RF01766                                            1766
         SLR   @14,@14                                             1766
         IC    @14,DEFLTLEN(,@15)                                  1766
         ALR   @14,@15                                             1766
         CLI   DEFLTVAL-1(@14),C''''                               1766
         BNE   @RF01766                                            1766
*                    DO;                                           1767
*                    ORGSIGN=DEFLTVAL(1);                          1768
         MVC   ORGSIGN(1),DEFLTVAL(@15)                            1768
*                    SYNUNIT=DEFLTVAL(3:DEFLTLEN-1);               1769
         MVI   SYNUNIT+1,C' '                                      1769
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1769
         L     @01,DEFLTPTR                                        1769
         SLR   @14,@14                                             1769
         IC    @14,DEFLTLEN(,@01)                                  1769
         LR    @05,@14                                             1769
         SL    @05,@CF00052                                        1769
         EX    @05,@SM01377                                        1769
*                    UNITINDX=DEFLTLEN-3;                          1770
         SL    @14,@CF00144                                        1770
         STH   @14,UNITINDX                                        1770
*                    END;                                          1771
*                  ELSE                                            1772
*                    DO;                                           1772
         B     @RC01766                                            1772
@RF01766 DS    0H                                                  1773
*                    OLDERID2 = NEWERID2;                          1773
         L     @01,GDTPTR                                          1773
         L     @15,GDTTR2(,@01)                                    1773
         MVC   @TS00001(95),NEWERID2(@15)                          1773
         MVC   OLDERID2(95,@15),@TS00001                           1773
*                    NEWID2='RI45';                                1774
         MVC   NEWID2(4,@15),@CC01178                              1774
*                    SYNUNIT=DEFLTVAL(1:DEFLTLEN);                 1775
         MVI   SYNUNIT+1,C' '                                      1775
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1775
         L     @15,DEFLTPTR                                        1775
         SLR   @14,@14                                             1775
         IC    @14,DEFLTLEN(,@15)                                  1775
         LR    @05,@14                                             1775
         BCTR  @05,0                                               1775
         EX    @05,@SM01379                                        1775
*                    UNITINDX=DEFLTLEN;                            1776
         STH   @14,UNITINDX                                        1776
*                    END;                                          1777
*                                                                  1777
*                CALL BUILDFDT;                                    1778
*                                                                  1778
@RC01766 BAL   @14,BUILDFDT                                        1778
*                END DOGRP150;                                     1779
*            END DOGRP145;                                         1780
*                                                                  1780
*        END SETDFLT;                                              1781
*                                                                  1781
*                                                                  1781
@EL00022 DS    0H                                                  1781
@EF00022 DS    0H                                                  1781
@ER00022 LM    @14,@12,@SA00022                                    1781
         BR    @14                                                 1781
*        END DEFAULTS;                                             1782
@EL00021 DS    0H                                                  1782
@EF00021 DS    0H                                                  1782
@ER00021 LM    @14,@12,@SA00021                                    1782
         BR    @14                                                 1782
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - NEEDNOTS                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CHECKS PARAMETERS TO INSURE THAT CERTAIN*/
*/*             SEMANTIC REQUIREMENTS HAVE NOT BEEN VIOLATED.  EACH  */
*/*             INPUT PARAMETER IS EXAMINED, CHECKING THAT OTHER     */
*/*             PARAMETERS HAVE BEEN INPUT WHICH MUST BE PRESENT WHEN*/
*/*             THIS PARAMETER IS PRESENT, AND CHECKING THAT CERTAIN */
*/*             PARAMETERS ARE NOT INPUT WHICH MUST NOT BE PRESENT   */
*/*             WHEN THIS PARAMETER IS PRESENT.  THIS ROUTINE IS     */
*/*             CALLED WHEN SCANNING OF A REPEATED SUBPARAMETER LIST */
*/*             REPETITION HAS JUST BEEN COMPLETED (ONLY REQUIREMENTS*/
*/*             WITHIN THE SUBLIST ARE CHECKED) AND THE ROUTINE IS   */
*/*             CALLED AT COMMAND TERMINATION (AT WHICH TIME ALL THE */
*/*             PARAMETER RELATIONSHIPS ARE CHECKED EXCEPT THOSE     */
*/*             INVOLVING PARAMETERS WITHIN A REPEATED SUBLIST).     */
*/*             'NEED' AND 'NOT' RELATIONSHIPS ARE NOT ALLOWED       */
*/*             BETWEEN A PARAMETER WITHIN A REPEATED SUBLIST AND A  */
*/*             PARAMETER NOT WITHIN THAT SAME SUBLIST. THE SEMANTIC */
*/*             REQUIREMENTS ARE CHECKED AFTER DEFAULTS ARE APPLIED. */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */
*/*          SUPERID - ID# OF THE PARAMETER WHOSE SUBLIST IS BEING   */
*/*                    CHECKED FOR SEMANTIC CORRECTNESS; ID#=0 IF    */
*/*                    CHECKING THE COMMAND AS A WHOLE               */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*                                                                  */
*/*  OUTPUT -  NONE                                                  */
*/*                                                                  */
*/********************************************************************/
*NEEDNOTS:PROCEDURE;                                               1783
NEEDNOTS STM   @14,@12,@SA00023                                    1783
*        /************************************************************/
*        /*                                                          */
*        /* NEEDNOTS PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1784
*        /* STATIC ERROR MESSAGE CODES                               */
*        DCL MISSPARM FIXED(31)        /*REQUIRED PARM IS MISSING    */
*                     CONSTANT(26);                                1784
*        DCL BADPARM  FIXED(31)        /*PARAMETER IS PRESENT WHICH  */
*                     CONSTANT(27);    /* IS NOT ALLOWED             */
*                                                                  1785
*        DCL WORKVAR3 FIXED(15);       /*VARIABLE TO CONTAIN         */
*                                      /*A TEMPORARY VALUE           */
*        DCL FOUNDONE BIT(1);          /*FLAG SET TO AVOID PRINTING
*                                        THE SAME ERROR MSG TWICE    */
*        /************************************************************/
*        /*                                                          */
*        /*  ** NEEDNOTS **  CHECK 'NEED' AND 'NOT' REQUIREMENTS     */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1788
*          THEN;                                                   1788
         L     @01,GDTPTR                                          1788
         L     @15,GDTDBG(,@01)                                    1788
         LTR   @15,@15                                             1788
         BZ    @RT01788                                            1788
*          ELSE                                                    1790
*            CALL ICKDB010(GDTTBL,'RINN');                         1790
*                                                                  1790
         L     @15,GDTPTR                                          1790
         ST    @15,@AL00001                                        1790
         LA    @14,@CC01186                                        1790
         ST    @14,@AL00001+4                                      1790
         MVI   @AL00001+4,X'80'                                    1790
         L     @15,GDTDBG(,@15)                                    1790
         LA    @01,@AL00001                                        1790
         BALR  @14,@15                                             1790
*        /************************************************************/
*        /*                                                          */
*        /* IF AT COMMAND END, CHECK VERB LEVEL 'NEED                */
*        /* GROUPS'.  THAT IS, CHECK FOR GROUPS OF PARMS             */
*        /* (WHICH DON'T APPEAR WITHIN REPEATED SUBLISTS)            */
*        /* ONE OF WHICH MUST BE INPUT.                              */
*        /*                                                          */
*        /************************************************************/
*        IF SUPERID(PARMLVL)=0 & VNGRPDSP>0                        1791
*          THEN                                                    1791
@RT01788 LH    @15,PARMLVL                                         1791
         ALR   @15,@15                                             1791
         LH    @15,SUPERID-2(@15)                                  1791
         LTR   @15,@15                                             1791
         BNZ   @RF01791                                            1791
         L     @01,DESCPTR                                         1791
         CLI   VNGRPDSP(@01),0                                     1791
         BNH   @RF01791                                            1791
*DOGRP155:   DO;                                                   1792
DOGRP155 DS    0H                                                  1793
*              GRPPTR=ADDR(VNGRPTOT)+LENGTH(VNGRPTOT);             1793
         L     @15,DESCPTR                                         1793
         SLR   @14,@14                                             1793
         IC    @14,VNGRPDSP(,@15)                                  1793
         ALR   @14,@14                                             1793
         ALR   @15,@14                                             1793
         AL    @15,@CF00124                                        1793
         ST    @15,GRPPTR                                          1793
*DOLOOP35:     DO LISTINDX=1 TO VNGRPTOT;                          1794
DOLOOP35 LA    @15,1                                               1794
         B     @DE01794                                            1794
@DL01794 DS    0H                                                  1795
*                FOUNDONE=NO;                                      1795
*                                                                  1795
         NI    FOUNDONE,B'01111111'                                1795
*                /****************************************************/
*                /*                                                  */
*                /* CHECK EACH 'NEED GROUP' SUBLIST TO BE            */
*                /* SURE AT LEAST ONE OF THE PARAMETERS OF           */
*                /* IDENTIFIED IN THE SUBLIST IS INPUT.              */
*                /*                                                  */
*                /****************************************************/
*                DO INDEX2=1 TO VNGRPCNT;                          1796
         LA    @15,1                                               1796
         B     @DE01796                                            1796
@DL01796 DS    0H                                                  1797
*                  IF PARMFLAG(VNGRPID(INDEX2))^=0                 1797
*                    THEN                                          1797
         ALR   @15,@15                                             1797
         L     @01,GRPPTR                                          1797
         LH    @15,VNGRPID-2(@15,@01)                              1797
         MH    @15,@CH00038                                        1797
         L     @01,WORKPTR                                         1797
         BCTR  @01,0                                               1797
         BCTR  @01,0                                               1797
         SLR   @14,@14                                             1797
         IC    @14,PARMFLAG-10(@15,@01)                            1797
         CH    @14,@CH00102                                        1797
         BE    @RF01797                                            1797
*                      FOUNDONE=YES;                               1798
         OI    FOUNDONE,B'10000000'                                1798
*                END;                                              1799
@RF01797 LA    @15,1                                               1799
         AH    @15,INDEX2                                          1799
@DE01796 STH   @15,INDEX2                                          1799
         L     @14,GRPPTR                                          1799
         CH    @15,VNGRPCNT(,@14)                                  1799
         BNH   @DL01796                                            1799
*                IF FOUNDONE=NO                                    1800
*                  THEN                                            1800
*                                                                  1800
         TM    FOUNDONE,B'10000000'                                1800
         BNZ   @RF01800                                            1800
*                    CALL ERRSETUP(MISSPARM,VNGRPID(1));           1801
*                                                                  1801
         LA    @15,@CF00294                                        1801
         ST    @15,@AL00001                                        1801
         L     @01,GRPPTR                                          1801
         LA    @15,VNGRPID(,@01)                                   1801
         ST    @15,@AL00001+4                                      1801
         LA    @01,@AL00001                                        1801
         BAL   @14,ERRSETUP                                        1801
*                GRPPTR=GRPPTR+LENGTH(VNGRPCNT)+                   1802
*                            VNGRPCNT*LENGTH(VNGRPID(1));          1802
@RF01800 L     @15,GRPPTR                                          1802
         LA    @14,2                                               1802
         ALR   @14,@15                                             1802
         LH    @15,VNGRPCNT(,@15)                                  1802
         ALR   @15,@15                                             1802
         ALR   @14,@15                                             1802
         ST    @14,GRPPTR                                          1802
*              END DOLOOP35;                                       1803
         LA    @15,1                                               1803
         AH    @15,LISTINDX                                        1803
@DE01794 STH   @15,LISTINDX                                        1803
         L     @14,DESCPTR                                         1803
         SLR   @05,@05                                             1803
         IC    @05,VNGRPDSP(,@14)                                  1803
         ALR   @05,@05                                             1803
         AL    @05,DESCPTR                                         1803
         CH    @15,VNGRPTOT(,@05)                                  1803
         BNH   @DL01794                                            1803
*            END DOGRP155;                                         1804
*                                                                  1804
*        /************************************************************/
*        /*                                                          */
*        /* CHECK EACH PARAMETER TO SEE IF IT IS PART OF THE         */
*        /* SET OF PARAMETERS CURRENTLY BEING HANDLED.  IF           */
*        /* SO, CHECK THE LIST(S) OF REQUIRED PARAMETERS             */
*        /* AND CONFLICTING PARAMETERS ASSOCIATED WITH EACH          */
*        /* PARAMETER TO SEE IF ANY ERRORS EXIST.                    */
*        /*                                                          */
*        /************************************************************/
*DOLOOP40:DO PARMID=1 TO MAXID;                                    1805
@RF01791 DS    0H                                                  1805
DOLOOP40 LA    @15,1                                               1805
         B     @DE01805                                            1805
@DL01805 DS    0H                                                  1806
*          IF PARMFLAG(PARMID)^=0                                  1806
*            THEN                                                  1806
         MH    @15,@CH00038                                        1806
         L     @01,WORKPTR                                         1806
         BCTR  @01,0                                               1806
         BCTR  @01,0                                               1806
         SLR   @14,@14                                             1806
         IC    @14,PARMFLAG-10(@15,@01)                            1806
         CH    @14,@CH00102                                        1806
         BE    @RF01806                                            1806
*DOGRP170:     DO;                                                 1807
DOGRP170 DS    0H                                                  1808
*                FOUND=NO;                                         1808
         NI    FOUND,B'11011111'                                   1808
*                TESTID=PARMID;                                    1809
         MVC   TESTID(2),PARMID                                    1809
*                DO WHILE(TESTID^=0 & FOUND=NO);                   1810
         B     @DE01810                                            1810
@DL01810 DS    0H                                                  1811
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1811
*                    THEN                                          1811
         LH    @15,TESTID                                          1811
         MH    @15,@CH00038                                        1811
         LH    @14,PARMLVL                                         1811
         ALR   @14,@14                                             1811
         L     @01,WORKPTR                                         1811
         AL    @01,@CF01318                                        1811
         LH    @15,SUPRPARM-8(@15,@01)                             1811
         CH    @15,SUPERID-2(@14)                                  1811
         BNE   @RF01811                                            1811
*                      FOUND=YES;                                  1812
         OI    FOUND,B'00100000'                                   1812
*                    ELSE                                          1813
*                      DO;                                         1813
         B     @RC01811                                            1813
@RF01811 DS    0H                                                  1814
*                      TESTID=SUPRPARM(TESTID);                    1814
         L     @15,WORKPTR                                         1814
         LA    @14,12                                              1814
         LR    @05,@14                                             1814
         MH    @05,TESTID                                          1814
         AL    @05,@CF01318                                        1814
         LH    @05,SUPRPARM-8(@05,@15)                             1814
         STH   @05,TESTID                                          1814
*                      IF PARMPTR(TESTID)->REPEATED=YES            1815
*                        THEN                                      1815
         MR    @04,@14                                             1815
         AL    @15,@CF01317                                        1815
         L     @01,PARMPTR(@05,@15)                                1815
         TM    REPEATED(@01),B'00100000'                           1815
         BNO   @RF01815                                            1815
*                          TESTID=0;                               1816
         SLR   @15,@15                                             1816
         STH   @15,TESTID                                          1816
*                      END;                                        1817
@RF01815 DS    0H                                                  1818
*                END;                                              1818
*                                                                  1818
@RC01811 DS    0H                                                  1818
@DE01810 LH    @15,TESTID                                          1818
         LTR   @15,@15                                             1818
         BZ    @DC01810                                            1818
         TM    FOUND,B'00100000'                                   1818
         BZ    @DL01810                                            1818
@DC01810 DS    0H                                                  1819
*                IF FOUND=YES                                      1819
*                  THEN                                            1819
         TM    FOUND,B'00100000'                                   1819
         BNO   @RF01819                                            1819
*DOGRP160:           DO;                                           1820
*                                                                  1820
DOGRP160 DS    0H                                                  1821
*                    /************************************************/
*                    /*                                              */
*                    /* IF 'NEED GROUPS' EXIST FOR THIS              */
*                    /* PARAMETER, CHECK TO INSURE THAT AT           */
*                    /* LEAST ONE PARAMETER IN EACH GROUP            */
*                    /* IS INPUT (A 'GROUP' MAY BE JUST A            */
*                    /* SINGLE PARAMETER THAT IS ALWAYS              */
*                    /* REQUIRED).                                   */
*                    /*                                              */
*                    /************************************************/
*                    IF NGRPDSPL > 0                               1821
*                      THEN                                        1821
         LH    @15,PARMID                                          1821
         MH    @15,@CH00038                                        1821
         L     @01,WORKPTR                                         1821
         AL    @01,@CF01317                                        1821
         L     @01,PARMPTR(@15,@01)                                1821
         CLI   NGRPDSPL(@01),0                                     1821
         BNH   @RF01821                                            1821
*DOGRP165:               DO;                                       1822
DOGRP165 DS    0H                                                  1823
*                          GRPPTR=ADDR(NGRPTOT)+                   1823
*                                          LENGTH(NGRPTOT);        1823
         LH    @15,PARMID                                          1823
         MH    @15,@CH00038                                        1823
         L     @01,WORKPTR                                         1823
         AL    @01,@CF01317                                        1823
         L     @15,PARMPTR(@15,@01)                                1823
         SLR   @14,@14                                             1823
         IC    @14,NGRPDSPL(,@15)                                  1823
         ALR   @14,@14                                             1823
         ALR   @15,@14                                             1823
         LA    @14,2                                               1823
         ALR   @14,@15                                             1823
         ST    @14,GRPPTR                                          1823
*                          WORKVAR3=NGRPTOT;                       1824
         MVC   WORKVAR3(2),NGRPTOT(@15)                            1824
*DOLOOP42:                 DO LISTINDX=1 TO WORKVAR3;              1825
DOLOOP42 LA    @15,1                                               1825
         B     @DE01825                                            1825
@DL01825 DS    0H                                                  1826
*                            FOUNDONE=NO;                          1826
         NI    FOUNDONE,B'01111111'                                1826
*                            DO INDEX2=1 TO NGRPCNT;               1827
         LA    @15,1                                               1827
         B     @DE01827                                            1827
@DL01827 DS    0H                                                  1828
*                              IF PARMFLAG(NGRPID(INDEX2))^=0      1828
*                                THEN                              1828
         ALR   @15,@15                                             1828
         L     @01,GRPPTR                                          1828
         LH    @15,NGRPID-2(@15,@01)                               1828
         MH    @15,@CH00038                                        1828
         L     @01,WORKPTR                                         1828
         BCTR  @01,0                                               1828
         BCTR  @01,0                                               1828
         SLR   @14,@14                                             1828
         IC    @14,PARMFLAG-10(@15,@01)                            1828
         CH    @14,@CH00102                                        1828
         BE    @RF01828                                            1828
*                                  FOUNDONE=YES;                   1829
         OI    FOUNDONE,B'10000000'                                1829
*                            END;                                  1830
@RF01828 LA    @15,1                                               1830
         AH    @15,INDEX2                                          1830
@DE01827 STH   @15,INDEX2                                          1830
         L     @14,GRPPTR                                          1830
         CH    @15,NGRPCNT(,@14)                                   1830
         BNH   @DL01827                                            1830
*                            IF FOUNDONE=NO                        1831
*                              THEN                                1831
*                                                                  1831
         TM    FOUNDONE,B'10000000'                                1831
         BNZ   @RF01831                                            1831
*                                CALL ERRSETUP(MISSPARM,           1832
*                                              NGRPID(1));         1832
*                                                                  1832
         LA    @15,@CF00294                                        1832
         ST    @15,@AL00001                                        1832
         L     @01,GRPPTR                                          1832
         LA    @15,NGRPID(,@01)                                    1832
         ST    @15,@AL00001+4                                      1832
         LA    @01,@AL00001                                        1832
         BAL   @14,ERRSETUP                                        1832
*                            GRPPTR=GRPPTR+LENGTH(NGRPCNT)+        1833
*                               NGRPCNT*LENGTH(NGRPID(1));         1833
@RF01831 L     @15,GRPPTR                                          1833
         LA    @14,2                                               1833
         ALR   @14,@15                                             1833
         LH    @15,NGRPCNT(,@15)                                   1833
         ALR   @15,@15                                             1833
         ALR   @14,@15                                             1833
         ST    @14,GRPPTR                                          1833
*                          END DOLOOP42;                           1834
         LA    @15,1                                               1834
         AH    @15,LISTINDX                                        1834
@DE01825 STH   @15,LISTINDX                                        1834
         CH    @15,WORKVAR3                                        1834
         BNH   @DL01825                                            1834
*                        END DOGRP165;                             1835
*                                                                  1835
*                    /************************************************/
*                    /*                                              */
*                    /* IF A LIST OF PARAMETERS EXISTS               */
*                    /* NOTING PARAMETERS WHICH CONFLICT             */
*                    /* WITH THIS PARTICULAR PARAMETER,              */
*                    /* CHECK THAT NONE OF THEM WERE INPUT           */
*                    /*                                              */
*                    /************************************************/
*                    FOUNDONE=NO;                                  1836
@RF01821 NI    FOUNDONE,B'01111111'                                1836
*                    IF NOTDSPL > 0                                1837
*                      THEN                                        1837
         LH    @15,PARMID                                          1837
         MH    @15,@CH00038                                        1837
         L     @01,WORKPTR                                         1837
         AL    @01,@CF01317                                        1837
         L     @15,PARMPTR(@15,@01)                                1837
         CLI   NOTDSPL(@15),0                                      1837
         BNH   @RF01837                                            1837
*                        DO;                                       1838
*                          WORKVAR3=NOTCOUNT;                      1839
         SLR   @14,@14                                             1839
         IC    @14,NOTDSPL(,@15)                                   1839
         ALR   @14,@14                                             1839
         ALR   @15,@14                                             1839
         MVC   WORKVAR3(2),NOTCOUNT(@15)                           1839
*                          DO LISTINDX=1 TO WORKVAR3               1840
*                                      WHILE(FOUNDONE=NO);         1840
         LA    @15,1                                               1840
         B     @DE01840                                            1840
@DL01840 TM    FOUNDONE,B'10000000'                                1840
         BNZ   @DC01840                                            1840
*                            IF PARMFLAG(NOTID(LISTINDX)) ^= 0     1841
*                              THEN                                1841
*                                                                  1841
         L     @14,WORKPTR                                         1841
         LA    @05,12                                              1841
         ALR   @15,@15                                             1841
         LR    @04,@05                                             1841
         MH    @04,PARMID                                          1841
         AL    @04,@CF01317                                        1841
         L     @04,PARMPTR(@04,@14)                                1841
         SLR   @03,@03                                             1841
         IC    @03,NOTDSPL(,@04)                                   1841
         ALR   @03,@03                                             1841
         ALR   @04,@03                                             1841
         MH    @05,NOTID-2(@15,@04)                                1841
         BCTR  @14,0                                               1841
         BCTR  @14,0                                               1841
         SLR   @15,@15                                             1841
         IC    @15,PARMFLAG-10(@05,@14)                            1841
         CH    @15,@CH00102                                        1841
         BE    @RF01841                                            1841
*                                CALL ERRSETUP(BADPARM,            1842
*                                              PARMID);            1842
*                                                                  1842
         LA    @15,@CF00296                                        1842
         ST    @15,@AL00001                                        1842
         LA    @15,PARMID                                          1842
         ST    @15,@AL00001+4                                      1842
         LA    @01,@AL00001                                        1842
         BAL   @14,ERRSETUP                                        1842
*                          END;                                    1843
@RF01841 LA    @15,1                                               1843
         AH    @15,LISTINDX                                        1843
@DE01840 STH   @15,LISTINDX                                        1843
         CH    @15,WORKVAR3                                        1843
         BNH   @DL01840                                            1843
@DC01840 DS    0H                                                  1844
*                        END;                                      1844
*                                                                  1844
*                    /************************************************/
*                    /*                                              */
*                    /* IF THE CURRENT PARAMETER IS ONE OF           */
*                    /* THE PARMS IDENTIFIED IN A 'NOT               */
*                    /* GROUPS' SUBLIST (A SET OF MUTUALLY           */
*                    /* EXCLUSIVE PARAMETERS), THEN CHECK TO         */
*                    /* BE SURE NONE OF THE OTHER PARAMETERS         */
*                    /* IDENTIFIED IN THE SUBLIST WERE INPUT         */
*                    /*                                              */
*                    /************************************************/
*                    IF NTGRPPTR(PARMID) ^= 0                      1845
*                      THEN                                        1845
@RF01837 LH    @15,PARMID                                          1845
         MH    @15,@CH00038                                        1845
         L     @01,WORKPTR                                         1845
         AL    @01,@CF01376                                        1845
         L     @15,NTGRPPTR-4(@15,@01)                             1845
         LTR   @15,@15                                             1845
         BZ    @RF01845                                            1845
*                        DO;                                       1846
*                          GRPPTR=NTGRPPTR(PARMID);                1847
         ST    @15,GRPPTR                                          1847
*                          DO LISTINDX=1 TO NTGRPCNT               1848
*                                      WHILE(FOUNDONE=NO);         1848
         LA    @15,1                                               1848
         B     @DE01848                                            1848
@DL01848 TM    FOUNDONE,B'10000000'                                1848
         BNZ   @DC01848                                            1848
*                            IF PARMFLAG(NTGRPID(LISTINDX)) ^= 0  &
*                               NTGRPID(LISTINDX) ^= PARMID        1849
*                              THEN                                1849
*                                                                  1849
         ALR   @15,@15                                             1849
         L     @01,GRPPTR                                          1849
         LH    @15,NTGRPID-2(@15,@01)                              1849
         LR    @14,@15                                             1849
         MH    @14,@CH00038                                        1849
         L     @01,WORKPTR                                         1849
         BCTR  @01,0                                               1849
         BCTR  @01,0                                               1849
         SLR   @00,@00                                             1849
         IC    @00,PARMFLAG-10(@14,@01)                            1849
         CH    @00,@CH00102                                        1849
         BE    @RF01849                                            1849
         CH    @15,PARMID                                          1849
         BE    @RF01849                                            1849
*                                CALL ERRSETUP(BADPARM,            1850
*                                               PARMID);           1850
*                                                                  1850
         LA    @15,@CF00296                                        1850
         ST    @15,@AL00001                                        1850
         LA    @15,PARMID                                          1850
         ST    @15,@AL00001+4                                      1850
         LA    @01,@AL00001                                        1850
         BAL   @14,ERRSETUP                                        1850
*                          END;                                    1851
@RF01849 LA    @15,1                                               1851
         AH    @15,LISTINDX                                        1851
@DE01848 STH   @15,LISTINDX                                        1851
         L     @14,GRPPTR                                          1851
         CH    @15,NTGRPCNT(,@14)                                  1851
         BNH   @DL01848                                            1851
@DC01848 DS    0H                                                  1852
*                        END;                                      1852
*                    END DOGRP160;                                 1853
@RF01845 DS    0H                                                  1854
*              END DOGRP170;                                       1854
@RF01819 DS    0H                                                  1855
*        END DOLOOP40;                                             1855
@RF01806 LA    @15,1                                               1855
         AH    @15,PARMID                                          1855
@DE01805 STH   @15,PARMID                                          1855
         L     @14,DESCPTR                                         1855
         CH    @15,MAXID(,@14)                                     1855
         BNH   @DL01805                                            1855
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - ERRSETUP                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SEARCHES FOR A KEYWORD TO BE INSERTED   */
*/*             INTO AN ERROR MESSAGE CONCERNING REQUIRED PARAMETERS */
*/*             WHICH ARE MISSING OR INVALID COMBINATIONS OF PARM'S. */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */
*/*          ERRPRMID- PARAMETER ID# OF PARAMETER WHICH IS IN ERROR  */
*/*          ERRMSGID- MESSAGE ID# OF MESSAGE INTO WHICH THE KEYWORD */
*/*                    IS TO BE INSERTED                             */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          ERRMSGID- SEE 'INPUT'                                   */
*/*          ERRFIELD- CONTAINS THE KEYWORD TO BE INSERTED INTO THE  */
*/*                    ERROR MESSAGE                                 */
*/*                                                                  */
*/********************************************************************/
*ERRSETUP:PROCEDURE(ERRMSGID,          /*STATIC ERROR MESSAGE CODE   */
*                   ERRPRMID);         /*PARM ID# OF INVALID PARM.   */
         B     @PB00024                                            1856
ERRSETUP STM   @14,@12,@SA00024                                    1856
         MVC   @PC00024(8),0(@01)                                  1856
*        /************************************************************/
*        /*                                                          */
*        /* ERRSETUP ROUTINE DATA DEFINITIONS                        */
*        /*                                                          */
*        /************************************************************/
*        DCL ERRMSGID FIXED(31);       /*STATIC ERROR MESSAGE CODE   */
*        DCL ERRPRMID FIXED(15);       /*PARAMETER ID# OR MISSING OR
*                                        INCONSISTENT PARAMETER      */
*        /************************************************************/
*        /*                                                          */
*        /*  ** ERRSETUP **  SET UP KEYWORD NAME FOR ERROR MESSAGE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1859
*        FOUNDONE=YES;                                             1859
         OI    FOUNDONE,B'10000000'                                1859
*        TESTID=PARMID;                                            1860
         MVC   TESTID(2),PARMID                                    1860
*        PARMID=ERRPRMID;                                          1861
         L     @15,@PC00024+4                                      1861
         MVC   PARMID(2),ERRPRMID(@15)                             1861
*        DO WHILE(PARMID ^= 0);                                    1862
         B     @DE01862                                            1862
@DL01862 DS    0H                                                  1863
*          IF KWDDSPL ^= 0                                         1863
*            THEN                                                  1863
         LH    @15,PARMID                                          1863
         MH    @15,@CH00038                                        1863
         L     @01,WORKPTR                                         1863
         AL    @01,@CF01317                                        1863
         L     @15,PARMPTR(@15,@01)                                1863
         CLI   KWDDSPL(@15),0                                      1863
         BE    @RF01863                                            1863
*              DO;                                                 1864
*              KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);             1865
         SLR   @14,@14                                             1865
         IC    @14,KWDDSPL(,@15)                                   1865
         ALR   @14,@14                                             1865
         ALR   @15,@14                                             1865
         AL    @15,@CF00172                                        1865
         ST    @15,KWDPTR                                          1865
*              ERRFIELD=BLANK;                                     1866
         MVI   ERRFIELD+1,C' '                                     1866
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1866
         MVI   ERRFIELD,C' '                                       1866
*              ERRFIELD=KWDITEM(1:KWDLEN);                         1867
         MVI   ERRFIELD+1,C' '                                     1867
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1867
         SLR   @14,@14                                             1867
         IC    @14,KWDLEN(,@15)                                    1867
         BCTR  @14,0                                               1867
         EX    @14,@SM01381                                        1867
*              PARMID=0;                                           1868
         SLR   @15,@15                                             1868
         STH   @15,PARMID                                          1868
*              END;                                                1869
*            ELSE                                                  1870
*              PARMID=SUPRPARM(PARMID);                            1870
         B     @RC01863                                            1870
@RF01863 LH    @15,PARMID                                          1870
         MH    @15,@CH00038                                        1870
         L     @01,WORKPTR                                         1870
         AL    @01,@CF01318                                        1870
         LH    @15,SUPRPARM-8(@15,@01)                             1870
         STH   @15,PARMID                                          1870
*        END;                                                      1871
*                                                                  1871
@RC01863 DS    0H                                                  1871
@DE01862 LH    @15,PARMID                                          1871
         LTR   @15,@15                                             1871
         BNZ   @DL01862                                            1871
*        CALL ERROR2(ERRMSGID,LENGTH(ERRFIELD),ADDR(ERRFIELD));    1872
*                                                                  1872
         L     @15,@PC00024                                        1872
         ST    @15,@AL00001                                        1872
         LA    @15,@CF00282                                        1872
         ST    @15,@AL00001+4                                      1872
         LA    @15,ERRFIELD                                        1872
         ST    @15,@AFTEMPS+36                                     1872
         LA    @15,@AFTEMPS+36                                     1872
         ST    @15,@AL00001+8                                      1872
         LA    @01,@AL00001                                        1872
         BAL   @14,ERROR2                                          1872
*        PARMID=TESTID;                                            1873
*                                                                  1873
         MVC   PARMID(2),TESTID                                    1873
*        END ERRSETUP;                                             1874
*                                                                  1874
*                                                                  1874
@EL00024 DS    0H                                                  1874
@EF00024 DS    0H                                                  1874
@ER00024 LM    @14,@12,@SA00024                                    1874
         BR    @14                                                 1874
*        END NEEDNOTS;                                             1875
@EL00023 DS    0H                                                  1875
@EF00023 DS    0H                                                  1875
@ER00023 LM    @14,@12,@SA00023                                    1875
         BR    @14                                                 1875
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SKIPCMD                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE BYPASSES CHARACTERS UNTIL A COMMAND-END */
*/*             DELIMITER IS FOUND WHICH DOES NOT APPEAR WITHIN A    */
*/*             COMMENT.  IT IS INVOKED WHEN A SYNTAX OR SEMANTIC    */
*/*             ERROR HAS BEEN FOUND WHICH REQUIRES THAT THE CURRENT */
*/*             COMMAND BE BYPASSED.                                 */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS DETECTED.               */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED.               */
*/*          CHAR2 -   NEXT INPUT CHARACTER TO BE EXTRACTED.         */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT THE COMMAND HAS  */
*/*                    BEEN BYPASSED.                                */
*/*                                                                  */
*/********************************************************************/
*SKIPCMD:PROCEDURE;                                                1876
SKIPCMD  STM   @14,@12,@SA00025                                    1876
*        /************************************************************/
*        /*                                                          */
*        /* SKIPCMD PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*        DCL SKIPDONE BIT(1);          /*THE COMMAND HAS BEEN      1877
*                                        COMPLETELY BYPASSED.        */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SKIPCMD **  BYPASS CURRENT COMMAND                   */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1878
*          THEN;                                                   1878
         L     @01,GDTPTR                                          1878
         L     @15,GDTDBG(,@01)                                    1878
         LTR   @15,@15                                             1878
         BZ    @RT01878                                            1878
*          ELSE                                                    1880
*            CALL ICKDB010(GDTTBL,'RISK');                         1880
*                                                                  1880
         L     @15,GDTPTR                                          1880
         ST    @15,@AL00001                                        1880
         LA    @14,@CC01213                                        1880
         ST    @14,@AL00001+4                                      1880
         MVI   @AL00001+4,X'80'                                    1880
         L     @15,GDTDBG(,@15)                                    1880
         LA    @01,@AL00001                                        1880
         BALR  @14,@15                                             1880
*        COMMENT=NO;                                               1881
@RT01878 NI    COMMENT,B'10111111'                                 1881
*        SKIPDONE=NO;                                              1882
         NI    SKIPDONE,B'01111111'                                1882
*        SKIPPAST=YES;                                             1883
*                                                                  1883
         OI    SKIPPAST,B'00001000'                                1883
*        /************************************************************/
*        /*                                                          */
*        /* SCAN PAST CHARACTERS UNTIL THE COMMAND-END DELIMITER IS  */
*        /* FOUND.  THE DELIMITER WILL NEVER BE WITHIN A COMMENT.    */
*        /*                                                          */
*        /************************************************************/
*        DO WHILE(SKIPDONE=NO & RISTATUS^=EOFILE & RISTATUS^=SKIPREST);
         B     @DE01884                                            1884
@DL01884 DS    0H                                                  1885
*          IF COMMENT=NO                                           1885
*            THEN                                                  1885
         TM    COMMENT,B'01000000'                                 1885
         BNZ   @RF01885                                            1885
*              IF CHAR1=ENDDELIM                                   1886
*                THEN                                              1886
         CLI   CHAR1,C';'                                          1886
         BNE   @RF01886                                            1886
*                  SKIPDONE=YES;                                   1887
*                                                                  1887
         OI    SKIPDONE,B'10000000'                                1887
*                /****************************************************/
*                /*                                                  */
*                /* IF NOT COMMAND END, THEN CONTINUE SCANNING,      */
*                /* CHECKING TO SEE IF THE BEGINNING OF A COMMENT    */
*                /* HAS BEEN FOUND.                                  */
*                /*                                                  */
*                /****************************************************/
*                ELSE                                              1888
*                  IF CHAR1=COMSTART(1) & CHAR2=COMSTART(2)        1888
*                    THEN                                          1888
         B     @RC01886                                            1888
@RF01886 CLC   CHAR1(1),COMSTART                                   1888
         BNE   @RF01888                                            1888
         CLC   CHAR2(1),COMSTART+1                                 1888
         BNE   @RF01888                                            1888
*                      DO;                                         1889
*                                                                  1889
*                      CALL NEXTCHAR;                              1890
*                                                                  1890
         BAL   @14,NEXTCHAR                                        1890
*                      COMMENT=YES;                                1891
         OI    COMMENT,B'01000000'                                 1891
*                      END;                                        1892
*                    ELSE;                                         1893
@RF01888 DS    0H                                                  1894
*            ELSE                                                  1894
*                                                                  1894
*              /******************************************************/
*              /*                                                    */
*              /* IF CURRENTLY BYPASSING CHARACTERS WITHIN A COMMENT,*/
*              /* CHECK FOR THE COMMENT-END DELIMITER WHICH SIGNALS  */
*              /* END OF COMMENT.  IF AN R/I-GENERATED SEMICOLON IS  */
*              /* FOUND IN MID-COMMENT, CONSIDER THAT TO BE THE END  */
*              /* OF THE COMMAND.                                    */
*              /*                                                    */
*              /******************************************************/
*              IF CHAR1=COMEND(1) & CHAR2=COMEND(2)                1894
*                THEN                                              1894
         B     @RC01885                                            1894
@RF01885 CLC   CHAR1(1),COMEND                                     1894
         BNE   @RF01894                                            1894
         CLC   CHAR2(1),COMEND+1                                   1894
         BNE   @RF01894                                            1894
*                  DO;                                             1895
*                  COMMENT=NO;                                     1896
*                                                                  1896
         NI    COMMENT,B'10111111'                                 1896
*                  CALL NEXTCHAR;                                  1897
*                                                                  1897
         BAL   @14,NEXTCHAR                                        1897
*                  END;                                            1898
*                ELSE                                              1899
*                  IF CHAR1=ENDDELIM &                             1899
*                     (OPTSFLAG=ON  MORTOCOM=NO) &                1899
*                     SCANINDX >= SCNLIMIT                         1899
*                    THEN                                          1899
         B     @RC01894                                            1899
@RF01894 CLI   CHAR1,C';'                                          1899
         BNE   @RF01899                                            1899
         TM    OPTSFLAG,B'00100000'                                1899
         BO    @GL00108                                            1899
         TM    MORTOCOM,B'00010000'                                1899
         BNZ   @RF01899                                            1899
@GL00108 LH    @15,SCANINDX                                        1899
         CH    @15,SCNLIMIT                                        1899
         BL    @RF01899                                            1899
*                      SKIPDONE=YES;                               1900
*                                                                  1900
         OI    SKIPDONE,B'10000000'                                1900
*          /**********************************************************/
*          /*                                                        */
*          /* IF THE END OF THE COMMAND HAS NOT YET BEEN FOUND, GET  */
*          /* THE NEXT INPUT CHARACTER.                              */
*          /*                                                        */
*          /**********************************************************/
*          IF SKIPDONE=NO                                          1901
*            THEN                                                  1901
*                                                                  1901
@RF01899 DS    0H                                                  1901
@RC01894 DS    0H                                                  1901
@RC01885 TM    SKIPDONE,B'10000000'                                1901
         BNZ   @RF01901                                            1901
*              CALL NEXTCHAR;                                      1902
*                                                                  1902
         BAL   @14,NEXTCHAR                                        1902
*        END;                                                      1903
*                                                                  1903
@RF01901 DS    0H                                                  1903
@DE01884 TM    SKIPDONE,B'10000000'                                1903
         BNZ   @DC01884                                            1903
         LH    @15,RISTATUS                                        1903
         CH    @15,@CH00118                                        1903
         BE    @DC01884                                            1903
         CH    @15,@CH00042                                        1903
         BNE   @DL01884                                            1903
@DC01884 DS    0H                                                  1904
*        END SKIPCMD;                                              1904
@EL00025 DS    0H                                                  1904
@EF00025 DS    0H                                                  1904
@ER00025 LM    @14,@12,@SA00025                                    1904
         BR    @14                                                 1904
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SETFLAG                                        */
*/*                                                                  */
*/*  FUNCTION - THIS PROCEDURE SETS A FLAG IN AN ARRAY OF FLAGS TO   */
*/*             TO NOTE THAT A GIVEN PARAMETER HAS BEEN INPUT.  THE  */
*/*             NTH FLAG IS SET 'ON' WHEN THE PARAMETER WHOSE ID#=N  */
*/*             HAS BEEN FOUND AS INPUT (EITHER EXTRACTED FROM THE   */
*/*             INPUT RECORD OR INPUT BY DEFAULT).  ALSO, THE FDT    */
*/*             VECTOR POINTER FOR THE PARAMETER IS SET TO A NON-NULL*/
*/*             VALUE TO SIGNAL THE FSR THAT THE PARAMETER IS INPUT. */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */
*/*          PARMID -  ID# OF THE PARAMETER BEING ACKNOWLEDGED       */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */
*/*          ARRYPTR - POINTER TO FDT PTR VECTOR FOR THIS PARAMETER  */
*/*                                                                  */
*/********************************************************************/
*SETFLAG:PROCEDURE;                                                1905
SETFLAG  STM   @14,@12,@SA00026                                    1905
*        /************************************************************/
*        /*                                                          */
*        /*  ** SETFLAG **  SET PARAMETER OCCURRENCE FLAG            */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1906
*          THEN;                                                   1906
         L     @01,GDTPTR                                          1906
         L     @15,GDTDBG(,@01)                                    1906
         LTR   @15,@15                                             1906
         BZ    @RT01906                                            1906
*          ELSE                                                    1908
*            CALL ICKDB010(GDTTBL,'RISF');                         1908
*                                                                  1908
         L     @15,GDTPTR                                          1908
         ST    @15,@AL00001                                        1908
         LA    @14,@CC01217                                        1908
         ST    @14,@AL00001+4                                      1908
         MVI   @AL00001+4,X'80'                                    1908
         L     @15,GDTDBG(,@15)                                    1908
         LA    @01,@AL00001                                        1908
         BALR  @14,@15                                             1908
*        /************************************************************/
*        /*                                                          */
*        /* IF THE FLAG IS ALREADY SET, THE PARAMETER HAS ALREADY    */
*        /* BEEN INPUT AND AN ERROR HAS OCCURRED.                    */
*        /*                                                          */
*        /************************************************************/
*        IF PARMFLAG(PARMID)=1                                     1909
*          THEN                                                    1909
*                                                                  1909
@RT01906 LH    @15,PARMID                                          1909
         MH    @15,@CH00038                                        1909
         L     @01,WORKPTR                                         1909
         BCTR  @01,0                                               1909
         BCTR  @01,0                                               1909
         SLR   @14,@14                                             1909
         IC    @14,PARMFLAG-10(@15,@01)                            1909
         CH    @14,@CH00172                                        1909
         BNE   @RF01909                                            1909
*            CALL ERROR2(BADKWD3,LENGTH(ERRFIELD),ADDR(ERRFIELD)); 1910
*                                                                  1910
         MVC   @AL00001(8),@AL01910                                1910
         LA    @15,ERRFIELD                                        1910
         ST    @15,@AFTEMPS+40                                     1910
         LA    @15,@AFTEMPS+40                                     1910
         ST    @15,@AL00001+8                                      1910
         LA    @01,@AL00001                                        1910
         BAL   @14,ERROR2                                          1910
*          ELSE                                                    1911
*            PARMFLAG(PARMID)=1;                                   1911
*                                                                  1911
         B     @RC01909                                            1911
@RF01909 LH    @15,PARMID                                          1911
         MH    @15,@CH00038                                        1911
         LA    @14,1                                               1911
         L     @01,WORKPTR                                         1911
         BCTR  @01,0                                               1911
         BCTR  @01,0                                               1911
         STC   @14,PARMFLAG-10(@15,@01)                            1911
*        /************************************************************/
*        /*                                                          */
*        /* SET THE PARAMETER'S DATA POINTER TO A NON-ZERO VALUE TO  */
*        /* SIGNAL THE FSR THAT THE PARAMETER HAS BEEN INPUT.        */
*        /* CALCULATE THE POINTER LOCATION FOR PARAMETERS THAT ARE   */
*        /* PART OF A REPEATED SUBPARAMETER LIST.                    */
*        /*                                                          */
*        /************************************************************/
*        IF OCCURNUM > 1                                           1912
*          THEN                                                    1912
@RC01909 LH    @15,PARMID                                          1912
         LR    @14,@15                                             1912
         MH    @14,@CH00038                                        1912
         L     @01,WORKPTR                                         1912
         AL    @01,@CF01317                                        1912
         L     @01,PARMPTR(@14,@01)                                1912
         CLC   OCCURNUM(3,@01),@CF00172+1                          1912
         BNH   @RF01912                                            1912
*            DO;                                                   1913
*            ARRYPTR=FDTPTR(PARMID);                               1914
*                                                                  1914
         SLA   @15,2                                               1914
         L     @01,FDTADDR                                         1914
         L     @15,FDTPTR-4(@15,@01)                               1914
         ST    @15,ARRYPTR                                         1914
*            CALL DSPLCALC(REPDEPTH);                              1915
*                                                                  1915
         LA    @15,REPDEPTH                                        1915
         ST    @15,@AL00001                                        1915
         LA    @01,@AL00001                                        1915
         BAL   @14,DSPLCALC                                        1915
*            REPPTR=ADDR(REPPTR);                                  1916
         LH    @15,ARRYDSPL                                        1916
         AL    @15,ARRYPTR                                         1916
         ST    @15,REPPTR(,@15)                                    1916
*            END;                                                  1917
*          ELSE                                                    1918
*            IF REPEATED=NO                                        1918
*              THEN                                                1918
         B     @RC01912                                            1918
@RF01912 LH    @15,PARMID                                          1918
         LR    @14,@15                                             1918
         MH    @14,@CH00038                                        1918
         L     @01,WORKPTR                                         1918
         AL    @01,@CF01317                                        1918
         L     @01,PARMPTR(@14,@01)                                1918
         TM    REPEATED(@01),B'00100000'                           1918
         BNZ   @RF01918                                            1918
*                FDTPTR(PARMID)=ADDR(FDTPTR(PARMID));              1919
*                                                                  1919
         L     @14,FDTADDR                                         1919
         SLA   @15,2                                               1919
         LA    @05,FDTPTR-4(@15,@14)                               1919
         ST    @05,FDTPTR-4(@15,@14)                               1919
*        END SETFLAG;                                              1920
@EL00026 DS    0H                                                  1920
@EF00026 DS    0H                                                  1920
@ER00026 LM    @14,@12,@SA00026                                    1920
         BR    @14                                                 1920
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - PACKCVB                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CONVERTS DECIMAL DIGITS IN EBCDIC FORM  */
*/*             INTO FULLWORD BINARY FORM, AFTER CHECKING THAT THE   */
*/*             DECIMAL NUMBER IS SPECIFIED CORRECTLY.               */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          SYNUNIT - CONTAINS DECIMAL NUMBER IN EBCDIC FORM        */
*/*          UNITINDX- LENGTH OF DECIMAL NUMBER IN EBCDIC FORM       */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS FOUND.                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          CNVRTWRD- CONVERTED NUMBER IN FULLWORD BINARY FORM      */
*/*                                                                  */
*/********************************************************************/
*PACKCVB:PROCEDURE;                                                1921
PACKCVB  STM   @14,@12,@SA00027                                    1921
*        /************************************************************/
*        /*                                                          */
*        /* PACKCVB PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*        DCL CVBNUM FIXED(31) REG(8);  /*REGISTER TO CONTAIN CONVERTED
*                                        FULLWORD NUMBERS            */
*        /************************************************************/
*        /*                                                          */
*        /* ** PACKCVB **  CONVERT DECIMAL NUMBER TO BINARY FULLWORD */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1923
*          THEN;                                                   1923
         L     @01,GDTPTR                                          1923
         L     @15,GDTDBG(,@01)                                    1923
         LTR   @15,@15                                             1923
         BZ    @RT01923                                            1923
*          ELSE                                                    1925
*            CALL ICKDB010(GDTTBL,'RIPC');                         1925
*                                                                  1925
         L     @15,GDTPTR                                          1925
         ST    @15,@AL00001                                        1925
         LA    @14,@CC01222                                        1925
         ST    @14,@AL00001+4                                      1925
         MVI   @AL00001+4,X'80'                                    1925
         L     @15,GDTDBG(,@15)                                    1925
         LA    @01,@AL00001                                        1925
         BALR  @14,@15                                             1925
*        ERRFIELD=SYNUNIT(1:UNITINDX);                             1926
@RT01923 MVI   ERRFIELD+1,C' '                                     1926
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1926
         LH    @15,UNITINDX                                        1926
         LR    @14,@15                                             1926
         BCTR  @14,0                                               1926
         EX    @14,@SM01383                                        1926
*        /************************************************************/
*        /*                                                          */
*        /* RIGHT-JUSTIFY THE DECIMAL DIGITS IN 'CNVRTFLD'; THEN     */
*        /* CHECK THE DIGITS TO BE SURE THEY REPRESENT AN ACCEPTABLE */
*        /* DECIMAL NUMBER.                                          */
*        /*                                                          */
*        /************************************************************/
*        CNVRTFLD=BLANK;                                           1927
         MVI   CNVRTFLD+1,C' '                                     1927
         MVC   CNVRTFLD+2(8),CNVRTFLD+1                            1927
         MVI   CNVRTFLD,C' '                                       1927
*        IF UNITINDX <= LENGTH(MXDECNUM)                           1928
*          THEN                                                    1928
         LA    @14,10                                              1928
         CR    @15,@14                                             1928
         BH    @RF01928                                            1928
*            DO;                                                   1929
*            CNVRTFLD(LENGTH(MXDECNUM)-UNITINDX+1:LENGTH(MXDECNUM))=
*                  SYNUNIT(1:UNITINDX);                            1930
         LA    @05,10                                              1930
         SLR   @05,@15                                             1930
         LA    @04,CNVRTFLD(@05)                                   1930
         SLR   @14,@15                                             1930
         LA    @15,9                                               1930
         SLR   @15,@14                                             1930
         EX    @15,@SM01385                                        1930
*            IF CNVRTFLD <= MXDECNUM                               1931
*              THEN                                                1931
         CLC   CNVRTFLD(10),@CC00674                               1931
         BH    @RF01931                                            1931
*                DO INDEX=LENGTH(MXDECNUM)-UNITINDX+1 TO           1932
*                        LENGTH(MXDECNUM) WHILE(RISTATUS=0);       1932
         AL    @14,@CF00172                                        1932
         B     @DE01932                                            1932
@DL01932 LH    @15,RISTATUS                                        1932
         LTR   @15,@15                                             1932
         BNZ   @DC01932                                            1932
*                  IF CNVRTFLD(INDEX) < '0'                       1933
*                     CNVRTFLD(INDEX) > '9'                        1933
*                    THEN                                          1933
*                                                                  1933
         LA    @15,CNVRTFLD-1(@14)                                 1933
         CLI   0(@15),C'0'                                         1933
         BL    @RT01933                                            1933
         LA    @15,CNVRTFLD-1(@14)                                 1933
         CLI   0(@15),C'9'                                         1933
         BNH   @RF01933                                            1933
@RT01933 DS    0H                                                  1934
*                      CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),      1934
*                                  ADDR(ERRFIELD));                1934
*                                                                  1934
         MVC   @AL00001(8),@AL01934                                1934
         LA    @15,ERRFIELD                                        1934
         ST    @15,@AFTEMPS+44                                     1934
         LA    @15,@AFTEMPS+44                                     1934
         ST    @15,@AL00001+8                                      1934
         LA    @01,@AL00001                                        1934
         BAL   @14,ERROR2                                          1934
*                END;                                              1935
@RF01933 LA    @14,1                                               1935
         AH    @14,INDEX                                           1935
@DE01932 STH   @14,INDEX                                           1935
         CH    @14,@CH00040                                        1935
         BNH   @DL01932                                            1935
@DC01932 DS    0H                                                  1936
*              ELSE                                                1936
*                                                                  1936
*                CALL ERROR2(BADNUMSZ,LENGTH(ERRFIELD),ADDR(ERRFIELD));
*                                                                  1936
         B     @RC01931                                            1936
@RF01931 MVC   @AL00001(8),@AL01936                                1936
         LA    @15,ERRFIELD                                        1936
         ST    @15,@AFTEMPS+44                                     1936
         LA    @15,@AFTEMPS+44                                     1936
         ST    @15,@AL00001+8                                      1936
         LA    @01,@AL00001                                        1936
         BAL   @14,ERROR2                                          1936
*            END;                                                  1937
*          ELSE                                                    1938
*                                                                  1938
*            CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),ADDR(ERRFIELD));
*                                                                  1938
         B     @RC01928                                            1938
@RF01928 MVC   @AL00001(8),@AL01938                                1938
         LA    @15,ERRFIELD                                        1938
         ST    @15,@AFTEMPS+44                                     1938
         LA    @15,@AFTEMPS+44                                     1938
         ST    @15,@AL00001+8                                      1938
         LA    @01,@AL00001                                        1938
         BAL   @14,ERROR2                                          1938
*        IF RISTATUS=0                                             1939
*          THEN                                                    1939
*                                                                  1939
@RC01928 LH    @15,RISTATUS                                        1939
         LTR   @15,@15                                             1939
         BNZ   @RF01939                                            1939
*            /********************************************************/
*            /*                                                      */
*            /* PERFORM THE CONVERSION FROM EBCDIC TO BINARY FULLWORD*/
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1940
*            SYNUNIT=CNVRTFLD;                                     1941
         MVI   SYNUNIT+10,C' '                                     1941
         MVC   SYNUNIT+11(244),SYNUNIT+10                          1941
         MVC   SYNUNIT(10),CNVRTFLD                                1941
*            RESPECIFY(CVBNUM) RSTD;                               1942
*            GEN(PACK   CNVRTFLD(8),SYNUNIT(10));                  1943
         PACK   CNVRTFLD(8),SYNUNIT(10)
*            GEN(CVB    CVBNUM,CNVRTFLD);                          1944
         CVB    CVBNUM,CNVRTFLD
*            CNVRTWRD=CVBNUM;                                      1945
         ST    CVBNUM,CNVRTWRD                                     1945
*            RESPECIFY(CVBNUM) UNRSTD;                             1946
*            END;                                                  1947
*                                                                  1947
*        END PACKCVB;                                              1948
@EL00027 DS    0H                                                  1948
@EF00027 DS    0H                                                  1948
@ER00027 LM    @14,@12,@SA00027                                    1948
         BR    @14                                                 1948
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - NXTFIELD                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS THE NEXT FIELD (VERB, KEYWORD, */
*/*             OR SCALAR) FROM THE INPUT COMMAND.  CHECKS ARE MADE  */
*/*             TO INSURE THAT LENGTH LIMITS ARE NOT EXCEEDED.       */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          FLDTYPE - CONTAINS CODE INDICATING THE TYPE OF FIELD    */
*/*                    TO BE EXTRACTED                               */
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER             */
*/*          CHAR2 -   NEXT INPUT CHARACTER TO BE EXTRACTED.         */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS FOUND.                  */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          SYNUNIT - THE EXTRACTED SYNTACTIC UNIT (FIELD)          */
*/*          UNITINDX- LENGTH OF THE EXTRACTED FIELD                 */
*/*          EOFOK -   FLAG SET 'ON' WHEN INPUT END-OF-FILE MAY      */
*/*                    LEGITIMATELY BE ENCOUNTERED.                  */
*/*          ERRFIELD- FIRST 20 CHARACTERS OF EXTRACTED FIELD WHICH  */
*/*                    MAY BE USED IN AN ERROR MESSAGE LATER         */
*/*                                                                  */
*/********************************************************************/
*NXTFIELD:PROCEDURE(FLDTYPE);          /*PARAMETER INDICATES THE TYPE
*                                        OF FIELD TO BE EXTRACTED.   */
NXTFIELD STM   @14,@12,@SA00028                                    1949
         MVC   @PC00028(4),0(@01)                                  1949
*        /************************************************************/
*        /*                                                          */
*        /* NXTFIELD PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*        DCL FLDTYPE  FIXED(31);       /*TYPE OF DATA FIELD EXPECTED
*                                        TO BE EXTRACTED NEXT        */
*        DCL PARENCNT FIXED(15);       /*NO. OF UNMATCHED            */
*                                      /* LEFT PARENTHESES           */
*                                      /* FOUND IN DSNAME            */
*                                      /* NOW BEING SCANNED          */
*                                                                  1952
*        /* STATIC ERROR MESSAGE CODE                                */
*        DCL QUOTSEMI FIXED(31)        /*SEMICOLON APPEARS WITHIN A  */
*                     CONSTANT(23);    /* QUOTED STRING              */
*        /************************************************************/
*        /*                                                          */
*        /*  ** NXTFIELD **  EXTRACT NEXT FIELD FROM INPUT RECORD    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1953
*        DELIM=NO;                                                 1953
         NI    DELIM,B'11110111'                                   1953
*        UNITINDX=0;                                               1954
         SLR   @15,@15                                             1954
         STH   @15,UNITINDX                                        1954
*        SYNUNIT=BLANK;                                            1955
         MVI   SYNUNIT+1,C' '                                      1955
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1955
         MVI   SYNUNIT,C' '                                        1955
*        IF RISTATUS=0                                             1956
*          THEN                                                    1956
         CH    @15,RISTATUS                                        1956
         BNE   @RF01956                                            1956
*            EOFOK=NO;                                             1957
*                                                                  1957
         NI    EOFOK,B'10111111'                                   1957
*        /************************************************************/
*        /*                                                          */
*        /* IF A SIMPLE SCALAR FIELD IS TO BE EXTRACTED, THEN EXTRACT*/
*        /* CHARACTERS UNTIL THE FIELD IS DELIMITED BY END-OF-FILE   */
*        /* OR BY A DELIMITING CHARACTER                             */
*        /*                                                          */
*        /************************************************************/
*        IF FLDTYPE=SIMPSCLR                                       1958
*          THEN                                                    1958
@RF01956 L     @15,@PC00028                                        1958
         CLC   FLDTYPE(4,@15),@CF00144                             1958
         BNE   @RF01958                                            1958
*            DO;                                                   1959
*            OLDERID2 = NEWERID2;                                  1960
         L     @01,GDTPTR                                          1960
         L     @15,GDTTR2(,@01)                                    1960
         MVC   @TS00001(95),NEWERID2(@15)                          1960
         MVC   OLDERID2(95,@15),@TS00001                           1960
*            NEWID2='RI49';                                        1961
         MVC   NEWID2(4,@15),@CC01230                              1961
*            PARENCNT=0;                                           1962
         SLR   @15,@15                                             1962
         STH   @15,PARENCNT                                        1962
*            DO WHILE(DELIM=NO & RISTATUS=0);                      1963
         B     @DE01963                                            1963
@DL01963 DS    0H                                                  1964
*              IF CHAR1=BLANK                                     1964
*                 CHAR1=COMMA                                     1964
*                 CHAR1=OPENING & DSNAM=NO                        1964
*                 CHAR1=CLOSING & PARENCNT=0                      1964
*                 CHAR1=ENDDELIM                                  1964
*                 CHAR1=PWDDELIM                                  1964
*                 CHAR1=COMSTART(1) & CHAR2=COMSTART(2)            1964
*                THEN                                              1964
         CLI   CHAR1,C' '                                          1964
         BE    @RT01964                                            1964
         CLI   CHAR1,C','                                          1964
         BE    @RT01964                                            1964
         CLI   CHAR1,C'('                                          1964
         BNE   @GL00117                                            1964
         LA    @15,12                                              1964
         LR    @14,@15                                             1964
         MH    @14,PARMID                                          1964
         L     @01,WORKPTR                                         1964
         AL    @01,@CF01317                                        1964
         AL    @15,PARMPTR(@14,@01)                                1964
         TM    DSNAM(@15),B'00100000'                              1964
         BZ    @RT01964                                            1964
@GL00117 CLI   CHAR1,C')'                                          1964
         BNE   @GL00116                                            1964
         LH    @15,PARENCNT                                        1964
         LTR   @15,@15                                             1964
         BZ    @RT01964                                            1964
@GL00116 CLI   CHAR1,C';'                                          1964
         BE    @RT01964                                            1964
         CLI   CHAR1,C'/'                                          1964
         BE    @RT01964                                            1964
         CLC   CHAR1(1),COMSTART                                   1964
         BNE   @RF01964                                            1964
         CLC   CHAR2(1),COMSTART+1                                 1964
         BNE   @RF01964                                            1964
@RT01964 DS    0H                                                  1965
*                  DELIM=YES;                                      1965
         OI    DELIM,B'00001000'                                   1965
*                ELSE                                              1966
*                  DO;                                             1966
         B     @RC01964                                            1966
@RF01964 DS    0H                                                  1967
*                    UNITINDX=UNITINDX+1;                          1967
         LA    @15,1                                               1967
         AH    @15,UNITINDX                                        1967
         STH   @15,UNITINDX                                        1967
*                    IF UNITINDX > UNITMAX                         1968
*                      THEN                                        1968
*                                                                  1968
         CH    @15,@CH00681                                        1968
         BNH   @RF01968                                            1968
*                        CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),    1969
*                                    ADDR(SYNUNIT));               1969
*                                                                  1969
         MVC   @AL00001(8),@AL01969                                1969
         LA    @15,SYNUNIT                                         1969
         ST    @15,@AFTEMPS+48                                     1969
         LA    @15,@AFTEMPS+48                                     1969
         ST    @15,@AL00001+8                                      1969
         LA    @01,@AL00001                                        1969
         BAL   @14,ERROR2                                          1969
*                      ELSE                                        1970
*                                                                  1970
*                        /********************************************/
*                        /*                                          */
*                        /* SAVE THE CHARACTER AND NOTE IF           */
*                        /* IT IS A MEMBER NAME DELIMITER            */
*                        /* (A PARENTHESIS)                          */
*                        /*                                          */
*                        /********************************************/
*                        DO;                                       1970
         B     @RC01968                                            1970
@RF01968 DS    0H                                                  1971
*                        SYNUNIT(UNITINDX)=CHAR1;                  1971
         LH    @01,UNITINDX                                        1971
         LA    @15,SYNUNIT-1(@01)                                  1971
         MVC   0(1,@15),CHAR1                                      1971
*                        IF CHAR1=OPENING                          1972
*                          THEN                                    1972
         CLI   CHAR1,C'('                                          1972
         BNE   @RF01972                                            1972
*                            PARENCNT=PARENCNT+1;                  1973
         LH    @01,PARENCNT                                        1973
         LA    @01,1(,@01)                                         1973
         STH   @01,PARENCNT                                        1973
*                          ELSE                                    1974
*                            IF CHAR1=CLOSING                      1974
*                              THEN                                1974
         B     @RC01972                                            1974
@RF01972 CLI   CHAR1,C')'                                          1974
         BNE   @RF01974                                            1974
*                                PARENCNT=PARENCNT-1;              1975
*                                                                  1975
         LH    @15,PARENCNT                                        1975
         BCTR  @15,0                                               1975
         STH   @15,PARENCNT                                        1975
*                        CALL NEXTCHAR;                            1976
*                                                                  1976
@RF01974 DS    0H                                                  1976
@RC01972 BAL   @14,NEXTCHAR                                        1976
*                        END;                                      1977
*                  END;                                            1978
@RC01968 DS    0H                                                  1979
*            END;                                                  1979
@RC01964 DS    0H                                                  1979
@DE01963 TM    DELIM,B'00001000'                                   1979
         BNZ   @DC01963                                            1979
         LH    @15,RISTATUS                                        1979
         LTR   @15,@15                                             1979
         BZ    @DL01963                                            1979
@DC01963 DS    0H                                                  1980
*            END;                                                  1980
*                                                                  1980
*          /**********************************************************/
*          /*                                                        */
*          /* IF A KEYWORD FIELD IS TO BE EXTRACTED, THEN PICK UP    */
*          /* CHARACTERS UNTIL THE FIELD IS DELIMITED BY END-OF-FILE */
*          /* OR BY A DELIMITING CHARACTER.  CHECK THAT THE MAXIMUM  */
*          /* KEYWORD LENGTH IS NOT EXCEEDED.                        */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    1981
*            IF FLDTYPE=KEYWORD                                    1981
*              THEN                                                1981
         B     @RC01958                                            1981
@RF01958 L     @15,@PC00028                                        1981
         CLC   FLDTYPE(4,@15),@CF00124                             1981
         BNE   @RF01981                                            1981
*                DO;                                               1982
*                OLDERID2 = NEWERID2;                              1983
         L     @01,GDTPTR                                          1983
         L     @15,GDTTR2(,@01)                                    1983
         MVC   @TS00001(95),NEWERID2(@15)                          1983
         MVC   OLDERID2(95,@15),@TS00001                           1983
*                NEWID2='RI50';                                    1984
         MVC   NEWID2(4,@15),@CC01231                              1984
*                DO WHILE(DELIM=NO & RISTATUS=0);                  1985
         B     @DE01985                                            1985
@DL01985 DS    0H                                                  1986
*                  IF CHAR1=BLANK  CHAR1=COMMA                   1986
*                     CHAR1=OPENING  CHAR1=CLOSING               1986
*                     CHAR1=COMSTART(1) & CHAR2=COMSTART(2)       1986
*                     CHAR1=ENDDELIM                               1986
*                    THEN                                          1986
         CLI   CHAR1,C' '                                          1986
         BE    @RT01986                                            1986
         CLI   CHAR1,C','                                          1986
         BE    @RT01986                                            1986
         CLI   CHAR1,C'('                                          1986
         BE    @RT01986                                            1986
         CLI   CHAR1,C')'                                          1986
         BE    @RT01986                                            1986
         CLC   CHAR1(1),COMSTART                                   1986
         BNE   @GL00124                                            1986
         CLC   CHAR2(1),COMSTART+1                                 1986
         BE    @RT01986                                            1986
@GL00124 CLI   CHAR1,C';'                                          1986
         BNE   @RF01986                                            1986
@RT01986 DS    0H                                                  1987
*                      DELIM=YES;                                  1987
         OI    DELIM,B'00001000'                                   1987
*                    ELSE                                          1988
*                      DO;                                         1988
         B     @RC01986                                            1988
@RF01986 DS    0H                                                  1989
*                        UNITINDX=UNITINDX+1;                      1989
         LA    @15,1                                               1989
         AH    @15,UNITINDX                                        1989
         STH   @15,UNITINDX                                        1989
*                        IF UNITINDX > KWDMAX                      1990
*                          THEN                                    1990
*                                                                  1990
         CH    @15,@CH00282                                        1990
         BNH   @RF01990                                            1990
*                            CALL ERROR2(BADKWD2,LENGTH(ERRFIELD), 1991
*                                        ADDR(SYNUNIT));           1991
*                                                                  1991
         MVC   @AL00001(8),@AL01991                                1991
         LA    @15,SYNUNIT                                         1991
         ST    @15,@AFTEMPS+48                                     1991
         LA    @15,@AFTEMPS+48                                     1991
         ST    @15,@AL00001+8                                      1991
         LA    @01,@AL00001                                        1991
         BAL   @14,ERROR2                                          1991
*                          ELSE                                    1992
*                            DO;                                   1992
         B     @RC01990                                            1992
@RF01990 DS    0H                                                  1993
*                            SYNUNIT(UNITINDX)=CHAR1;              1993
*                                                                  1993
         LH    @01,UNITINDX                                        1993
         LA    @15,SYNUNIT-1(@01)                                  1993
         MVC   0(1,@15),CHAR1                                      1993
*                            CALL NEXTCHAR;                        1994
*                                                                  1994
         BAL   @14,NEXTCHAR                                        1994
*                            END;                                  1995
*                      END;                                        1996
@RC01990 DS    0H                                                  1997
*                END;                                              1997
@RC01986 DS    0H                                                  1997
@DE01985 TM    DELIM,B'00001000'                                   1997
         BNZ   @DC01985                                            1997
         LH    @15,RISTATUS                                        1997
         LTR   @15,@15                                             1997
         BZ    @DL01985                                            1997
@DC01985 DS    0H                                                  1998
*                END;                                              1998
*                                                                  1998
*              /******************************************************/
*              /*                                                    */
*              /* IF A SCALAR FIELD DELIMITED BY APOSTROPHES IS TO BE*/
*              /* EXTRACTED, THEN PICK UP CHARACTERS UNTIL THE FIELD */
*              /* IS DELIMITED BY END-OF-FILE OR BY A DELIMITING     */
*              /* INPUT CHARACTER.                                   */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1999
*                IF FLDTYPE=QUOTSCLR                               1999
*                  THEN                                            1999
         B     @RC01981                                            1999
@RF01981 L     @15,@PC00028                                        1999
         CLC   FLDTYPE(4,@15),@CF00052                             1999
         BNE   @RF01999                                            1999
*DOGRP182:           DO;                                           2000
DOGRP182 DS    0H                                                  2001
*                    OLDERID2 = NEWERID2;                          2001
         L     @01,GDTPTR                                          2001
         L     @15,GDTTR2(,@01)                                    2001
         MVC   @TS00001(95),NEWERID2(@15)                          2001
         MVC   OLDERID2(95,@15),@TS00001                           2001
*                    NEWID2='RI51';                                2002
         MVC   NEWID2(4,@15),@CC01234                              2002
*                    DO WHILE(DELIM=NO & RISTATUS=0);              2003
*                                                                  2003
         B     @DE02003                                            2003
@DL02003 DS    0H                                                  2004
*                      IF CHAR1=QUOTE & CHAR2^=QUOTE               2004
*                        THEN                                      2004
         CLI   CHAR1,C''''                                         2004
         BNE   @RF02004                                            2004
         CLI   CHAR2,C''''                                         2004
         BE    @RF02004                                            2004
*                          DELIM=YES;                              2005
         OI    DELIM,B'00001000'                                   2005
*                        ELSE                                      2006
*                                                                  2006
*                          /******************************************/
*                          /*                                        */
*                          /* ACCEPT THE CHARACTER AS PART OF THE    */
*                          /* SCALAR.  ISSUE AN ERROR MESSAGE IF THE */
*                          /* SCALAR HAS EXCEEDED THE LENGTH LIMIT.  */
*                          /* ISSUE A WARNING MESSAGE IF THE CHAR.   */
*                          /* IS A SEMICOLON.                        */
*                          /*                                        */
*                          /******************************************/
*                          DO;                                     2006
         B     @RC02004                                            2006
@RF02004 DS    0H                                                  2007
*                            IF CHAR1=ENDDELIM                     2007
*                              THEN                                2007
         CLI   CHAR1,C';'                                          2007
         BNE   @RF02007                                            2007
*                                DO;                               2008
*                                DARGSMOD=RISTID;                  2009
         L     @15,DDSTRU                                          2009
         MVC   DARGSMOD(3,@15),RISTID                              2009
*                                DARGSENT=QUOTSEMI;                2010
*                                                                  2010
         MVI   DARGSENT(@15),X'17'                                 2010
*                                CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);
*                                                                  2011
         L     @15,GDTPTR                                          2011
         ST    @15,@AL00001                                        2011
         LA    @14,@CF00102                                        2011
         ST    @14,@AL00001+4                                      2011
         LA    @14,DDSTRU                                          2011
         ST    @14,@AL00001+8                                      2011
         MVI   @AL00001+8,X'80'                                    2011
         L     @15,GDTPRT(,@15)                                    2011
         LA    @01,@AL00001                                        2011
         BALR  @14,@15                                             2011
*                                END;                              2012
*                            UNITINDX=UNITINDX+1;                  2013
@RF02007 LA    @15,1                                               2013
         AH    @15,UNITINDX                                        2013
         STH   @15,UNITINDX                                        2013
*                            IF UNITINDX > UNITMAX                 2014
*                              THEN                                2014
*                                                                  2014
         CH    @15,@CH00681                                        2014
         BNH   @RF02014                                            2014
*                                CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),
*                                            ADDR(SYNUNIT));       2015
*                                                                  2015
         MVC   @AL00001(8),@AL02015                                2015
         LA    @15,SYNUNIT                                         2015
         ST    @15,@AFTEMPS+48                                     2015
         LA    @15,@AFTEMPS+48                                     2015
         ST    @15,@AL00001+8                                      2015
         LA    @01,@AL00001                                        2015
         BAL   @14,ERROR2                                          2015
*                              ELSE                                2016
*                                SYNUNIT(UNITINDX)=CHAR1;          2016
         B     @RC02014                                            2016
@RF02014 LH    @01,UNITINDX                                        2016
         LA    @15,SYNUNIT-1(@01)                                  2016
         MVC   0(1,@15),CHAR1                                      2016
*                          END;                                    2017
*                                                                  2017
@RC02014 DS    0H                                                  2018
*                      /**********************************************/
*                      /*                                            */
*                      /* IF A DOUBLE APOSTROPHE IS FOUND, SKIP PAST */
*                      /* BOTH OF THEM AND THEN CONTINUE SCANNING.   */
*                      /*                                            */
*                      /**********************************************/
*                      IF CHAR1=QUOTE & CHAR2=QUOTE                2018
*                        THEN                                      2018
*                                                                  2018
@RC02004 CLI   CHAR1,C''''                                         2018
         BNE   @RF02018                                            2018
         CLI   CHAR2,C''''                                         2018
         BNE   @RF02018                                            2018
*                          CALL NEXTCHAR;                          2019
*                                                                  2019
         BAL   @14,NEXTCHAR                                        2019
*                      /**********************************************/
*                      /*                                            */
*                      /* BYPASS THE CHARACTER JUST EXTRACTED, UNLESS*/
*                      /* AN ERROR CONDITION HAS BEEN ENCOUNTERED OR */
*                      /* THE END OF THE CURRENT COMMAND HAS JUST    */
*                      /* BEEN REACHED.                              */
*                      /*                                            */
*                      /**********************************************/
*                      IF RISTATUS=0                               2020
*                        THEN                                      2020
@RF02018 LH    @15,RISTATUS                                        2020
         LTR   @15,@15                                             2020
         BNZ   @RF02020                                            2020
*                          IF CHAR1=ENDDELIM &                     2021
*                             (OPTSFLAG=ON  MORTOCOM=NO) &        2021
*                             SCANINDX >= SCNLIMIT                 2021
*                            THEN                                  2021
         CLI   CHAR1,C';'                                          2021
         BNE   @RF02021                                            2021
         TM    OPTSFLAG,B'00100000'                                2021
         BO    @GL00133                                            2021
         TM    MORTOCOM,B'00010000'                                2021
         BNZ   @RF02021                                            2021
@GL00133 LH    @15,SCANINDX                                        2021
         CH    @15,SCNLIMIT                                        2021
         BL    @RF02021                                            2021
*                              DELIM=YES;                          2022
         OI    DELIM,B'00001000'                                   2022
*                            ELSE                                  2023
*                                                                  2023
*                              CALL NEXTCHAR;                      2023
*                                                                  2023
         B     @RC02021                                            2023
@RF02021 BAL   @14,NEXTCHAR                                        2023
*                    END;                                          2024
@RC02021 DS    0H                                                  2024
@RF02020 DS    0H                                                  2024
@DE02003 TM    DELIM,B'00001000'                                   2024
         BNZ   @DC02003                                            2024
         LH    @15,RISTATUS                                        2024
         LTR   @15,@15                                             2024
         BZ    @DL02003                                            2024
@DC02003 DS    0H                                                  2025
*                    END DOGRP182;                                 2025
*                                                                  2025
*                  /**************************************************/
*                  /*                                                */
*                  /* WHEN A VERB FIELD IS TO BE EXTRACTED, PICK     */
*                  /* UP CHARACTERS UNTIL THE FIELD IS DELIMITED BY  */
*                  /* END-OF-FILE OR BY A DELIMITING CHARACTER.      */
*                  /* CHECK THAT THE MAXIMUM VERB LENGTH HAS NOT     */
*                  /* BEEN EXCEEDED.                                 */
*                  /*                                                */
*                  /**************************************************/
*                  ELSE                                            2026
*                    DO WHILE(DELIM=NO & RISTATUS=0);              2026
         B     @RC01999                                            2026
@RF01999 B     @DE02026                                            2026
@DL02026 DS    0H                                                  2027
*                      IF CHAR1=BLANK  CHAR1=COMMA               2027
*                         CHAR1=COMSTART(1) & CHAR2=COMSTART(2)   2027
*                         CHAR1=ENDDELIM                           2027
*                        THEN                                      2027
         CLI   CHAR1,C' '                                          2027
         BE    @RT02027                                            2027
         CLI   CHAR1,C','                                          2027
         BE    @RT02027                                            2027
         CLC   CHAR1(1),COMSTART                                   2027
         BNE   @GL00137                                            2027
         CLC   CHAR2(1),COMSTART+1                                 2027
         BE    @RT02027                                            2027
@GL00137 CLI   CHAR1,C';'                                          2027
         BNE   @RF02027                                            2027
@RT02027 DS    0H                                                  2028
*                          DELIM=YES;                              2028
         OI    DELIM,B'00001000'                                   2028
*                        ELSE                                      2029
*                          DO;                                     2029
         B     @RC02027                                            2029
@RF02027 DS    0H                                                  2030
*                            UNITINDX=UNITINDX+1;                  2030
         LA    @15,1                                               2030
         AH    @15,UNITINDX                                        2030
         STH   @15,UNITINDX                                        2030
*                            IF UNITINDX > UNITMAX                 2031
*                              THEN                                2031
*                                                                  2031
         CH    @15,@CH00681                                        2031
         BNH   @RF02031                                            2031
*                                CALL ERROR2(BADVERB2,LENGTH(ERRFIELD),
*                                            ADDR(SYNUNIT));       2032
*                                                                  2032
         MVC   @AL00001(8),@AL02032                                2032
         LA    @15,SYNUNIT                                         2032
         ST    @15,@AFTEMPS+48                                     2032
         LA    @15,@AFTEMPS+48                                     2032
         ST    @15,@AL00001+8                                      2032
         LA    @01,@AL00001                                        2032
         BAL   @14,ERROR2                                          2032
*                              ELSE                                2033
*                                DO;                               2033
         B     @RC02031                                            2033
@RF02031 DS    0H                                                  2034
*                                SYNUNIT(UNITINDX)=CHAR1;          2034
*                                                                  2034
         LH    @01,UNITINDX                                        2034
         LA    @15,SYNUNIT-1(@01)                                  2034
         MVC   0(1,@15),CHAR1                                      2034
*                                CALL NEXTCHAR;                    2035
*                                                                  2035
         BAL   @14,NEXTCHAR                                        2035
*                                END;                              2036
*                          END;                                    2037
@RC02031 DS    0H                                                  2038
*                    END;                                          2038
*                                                                  2038
@RC02027 DS    0H                                                  2038
@DE02026 TM    DELIM,B'00001000'                                   2038
         BNZ   @DC02026                                            2038
         LH    @15,RISTATUS                                        2038
         LTR   @15,@15                                             2038
         BZ    @DL02026                                            2038
@DC02026 DS    0H                                                  2039
*        /************************************************************/
*        /*                                                          */
*        /* AN ERROR HAS OCCURRED WHEN NO CHARACTERS OF THE          */
*        /* SYNTACTICAL UNIT WERE FOUND BEFORE HITTING A DELIMITER   */
*        /*                                                          */
*        /************************************************************/
*        IF UNITINDX=0 & RISTATUS=0                                2039
*          THEN                                                    2039
@RC01999 DS    0H                                                  2039
@RC01981 DS    0H                                                  2039
@RC01958 SLR   @15,@15                                             2039
         CH    @15,UNITINDX                                        2039
         BNE   @RF02039                                            2039
         CH    @15,RISTATUS                                        2039
         BNE   @RF02039                                            2039
*            IF FLDTYPE^=VERBFLD                                   2040
*              THEN                                                2040
*                                                                  2040
         L     @15,@PC00028                                        2040
         CLC   FLDTYPE(4,@15),@CF00172                             2040
         BE    @RF02040                                            2040
*                CALL ERROR2(BADELIM1,LENGTH(CHAR1),ADDR(CHAR1));  2041
*                                                                  2041
         MVC   @AL00001(8),@AL02041                                2041
         LA    @15,CHAR1                                           2041
         ST    @15,@AFTEMPS+48                                     2041
         LA    @15,@AFTEMPS+48                                     2041
         ST    @15,@AL00001+8                                      2041
         LA    @01,@AL00001                                        2041
         BAL   @14,ERROR2                                          2041
*              ELSE;                                               2042
*                                                                  2042
@RF02040 DS    0H                                                  2043
*          /**********************************************************/
*          /*                                                        */
*          /* IF CHARACTERS WERE EXTRACTED FOR THIS UNIT, SAVE UP TO */
*          /* THE FIRST 20 OF THEM FOR POSSIBLE LATER USE IN AN      */
*          /* ERROR MESSAGE.                                         */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    2043
*            ERRFIELD=SYNUNIT;                                     2043
*                                                                  2043
*                                                                  2043
         B     @RC02039                                            2043
@RF02039 MVC   ERRFIELD(20),SYNUNIT                                2043
*        END NXTFIELD;                                             2044
@EL00028 DS    0H                                                  2044
@EF00028 DS    0H                                                  2044
@ER00028 LM    @14,@12,@SA00028                                    2044
         BR    @14                                                 2044
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SCANSEP                                        */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS PAST THE COMMA(S) AND/OR BLANK(S) */
*/*             AND/OR COMMENT(S) WHICH OPTIONALLY SEPARATE COMMAND  */
*/*             SYNTACTIC UNITS.                                     */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          WITHCOM - FLAG SET 'OFF' WHEN A COMMA SHOULD NOT APPEAR */
*/*                    AS PART OF THE SEPARATOR                      */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE WHEN AN ERROR IS FOUND                   */
*/*          SCANONLY- FLAG SET 'ON' WHEN THE CURRENT COMMAND IS     */
*/*                    BEING SCANNED FOR SYNTAX CHECKING ONLY.       */
*/*                                                                  */
*/*  OUTPUT - NONE                                                   */
*/*                                                                  */
*/********************************************************************/
*SCANSEP:PROCEDURE(WITHCOM);           /*PARAMETER SIGNALS WHETHER 2045
*                                        A COMMA IS TO BE CONSIDERED
*                                        PART OF THE SEPARATOR OR NOT*/
SCANSEP  STM   @14,@12,@SA00029                                    2045
         MVC   @PC00029(4),0(@01)                                  2045
*        /************************************************************/
*        /*                                                          */
*        /* SCANSEP PROCEDURE DATA DEFINITIONS                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  2046
*        /* STATIC ERROR MESSAGE CODE                                */
*        DCL COMMAERR FIXED(31)        /*DOUBLE COMMA                */
*                     CONSTANT(7);                                 2046
*                                                                  2046
*        DCL COMMASW  BIT(1);          /*SIGNALS THAT A COMMA HAS BEEN
*                                        FOUND IN THIS SEPARATOR     */
*        DCL WITHCOM  BIT(1);          /*SIGNALS THAT A COMMA MAY  2048
*                                        APPEAR IN THIS SEPARATOR    */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SCANSEP **  SCAN PAST SEPARATOR CHARACTERS           */
*        /*                                                          */
*        /************************************************************/
*        IF WITHCOM=YES                                            2049
*          THEN                                                    2049
         L     @15,@PC00029                                        2049
         TM    WITHCOM(@15),B'10000000'                            2049
         BNO   @RF02049                                            2049
*            COMMASW=OFF;                                          2050
         NI    COMMASW,B'01111111'                                 2050
*          ELSE                                                    2051
*            COMMASW=ON;                                           2051
         B     @RC02049                                            2051
@RF02049 OI    COMMASW,B'10000000'                                 2051
*        DELIM=NO;                                                 2052
@RC02049 NI    DELIM,B'11110111'                                   2052
*        COMMENT=NO;                                               2053
         NI    COMMENT,B'10111111'                                 2053
*        DO WHILE(DELIM=NO & RISTATUS=0);                          2054
*                                                                  2054
         B     @DE02054                                            2054
@DL02054 DS    0H                                                  2055
*          /**********************************************************/
*          /*                                                        */
*          /* IF NOT CURRENTLY BYPASSING A COMMENT, LOOK FOR A CHAR. */
*          /* OTHER THAN A SEPARATOR CHARACTER OR THE BEGINNING OF A */
*          /* COMMENT TO SIGNAL THE BEGINNING OF THE NEXT SYNTACTIC  */
*          /* UNIT.  IF MORE THAN ONE COMMA HAS BEEN FOUND, ISSUE A  */
*          /* WARNING MESSAGE STATING THAT IT WILL BE IGNORED.       */
*          /*                                                        */
*          /**********************************************************/
*          IF COMMENT=NO                                           2055
*            THEN                                                  2055
         TM    COMMENT,B'01000000'                                 2055
         BNZ   @RF02055                                            2055
*              IF CHAR1 ^= BLANK                                   2056
*                THEN                                              2056
         CLI   CHAR1,C' '                                          2056
         BE    @RF02056                                            2056
*                  IF CHAR1=COMMA                                  2057
*                    THEN                                          2057
         CLI   CHAR1,C','                                          2057
         BNE   @RF02057                                            2057
*                      IF COMMASW=ON                               2058
*                        THEN                                      2058
         TM    COMMASW,B'10000000'                                 2058
         BNO   @RF02058                                            2058
*                          DO;                                     2059
*                          DARGSMOD=RISTID;                        2060
         L     @15,DDSTRU                                          2060
         MVC   DARGSMOD(3,@15),RISTID                              2060
*                          DARGSENT=COMMAERR;                      2061
*                                                                  2061
         MVI   DARGSENT(@15),X'07'                                 2061
*                          CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);   2062
*                                                                  2062
         L     @15,GDTPTR                                          2062
         ST    @15,@AL00001                                        2062
         LA    @14,@CF00102                                        2062
         ST    @14,@AL00001+4                                      2062
         LA    @14,DDSTRU                                          2062
         ST    @14,@AL00001+8                                      2062
         MVI   @AL00001+8,X'80'                                    2062
         L     @15,GDTPRT(,@15)                                    2062
         LA    @01,@AL00001                                        2062
         BALR  @14,@15                                             2062
*                          END;                                    2063
*                        ELSE                                      2064
*                          COMMASW=ON;                             2064
         B     @RC02058                                            2064
@RF02058 OI    COMMASW,B'10000000'                                 2064
*                    ELSE                                          2065
*                      IF CHAR1=COMSTART(1) & CHAR2=COMSTART(2)    2065
*                        THEN                                      2065
         B     @RC02057                                            2065
@RF02057 CLC   CHAR1(1),COMSTART                                   2065
         BNE   @RF02065                                            2065
         CLC   CHAR2(1),COMSTART+1                                 2065
         BNE   @RF02065                                            2065
*                          DO;                                     2066
*                          COMMENT=YES;                            2067
*                                                                  2067
         OI    COMMENT,B'01000000'                                 2067
*                          CALL NEXTCHAR;                          2068
*                                                                  2068
         BAL   @14,NEXTCHAR                                        2068
*                          END;                                    2069
*                        ELSE                                      2070
*                          DELIM=YES;                              2070
         B     @RC02065                                            2070
@RF02065 OI    DELIM,B'00001000'                                   2070
*                ELSE;                                             2071
*                                                                  2071
@RF02056 DS    0H                                                  2072
*            /********************************************************/
*            /*                                                      */
*            /* IF CURRENTLY BYPASSING A COMMENT, LOOK FOR THE ENDING*/
*            /* COMMENT DELIMITER.  ALSO TEST TO SEE IF THE END OF   */
*            /* THE CURRENT COMMAND HAS BEEN FOUND WHILE SCANNING    */
*            /* WITHIN THE COMMENT.                                  */
*            /*                                                      */
*            /********************************************************/
*            ELSE                                                  2072
*              IF CHAR1=COMEND(1) & CHAR2=COMEND(2)                2072
*                THEN                                              2072
         B     @RC02055                                            2072
@RF02055 CLC   CHAR1(1),COMEND                                     2072
         BNE   @RF02072                                            2072
         CLC   CHAR2(1),COMEND+1                                   2072
         BNE   @RF02072                                            2072
*                  DO;                                             2073
*                  COMMENT=NO;                                     2074
*                                                                  2074
         NI    COMMENT,B'10111111'                                 2074
*                  CALL NEXTCHAR;                                  2075
*                                                                  2075
         BAL   @14,NEXTCHAR                                        2075
*                  END;                                            2076
*                ELSE                                              2077
*                  IF CHAR1=ENDDELIM &                             2077
*                     (OPTSFLAG=ON  MORTOCOM=NO) &                2077
*                     SCANINDX >= SCNLIMIT                         2077
*                    THEN                                          2077
         B     @RC02072                                            2077
@RF02072 CLI   CHAR1,C';'                                          2077
         BNE   @RF02077                                            2077
         TM    OPTSFLAG,B'00100000'                                2077
         BO    @GL00145                                            2077
         TM    MORTOCOM,B'00010000'                                2077
         BNZ   @RF02077                                            2077
@GL00145 LH    @15,SCANINDX                                        2077
         CH    @15,SCNLIMIT                                        2077
         BL    @RF02077                                            2077
*                      DELIM=YES;                                  2078
*                                                                  2078
         OI    DELIM,B'00001000'                                   2078
*          /**********************************************************/
*          /*                                                        */
*          /* SCAN THE INPUT CHARACTERS ONE AT A TIME -- IF, AFTER   */
*          /* A CHARACTER HAS BEEN CHECKED, THE NEXT SYNTACTIC UNIT  */
*          /* HAS NOT BEEN REACHED, PICK UP THE NEXT CHARACTER.      */
*          /*                                                        */
*          /**********************************************************/
*          IF DELIM=NO                                             2079
*            THEN                                                  2079
*                                                                  2079
@RF02077 DS    0H                                                  2079
@RC02072 DS    0H                                                  2079
@RC02055 TM    DELIM,B'00001000'                                   2079
         BNZ   @RF02079                                            2079
*              CALL NEXTCHAR;                                      2080
*                                                                  2080
         BAL   @14,NEXTCHAR                                        2080
*        END;                                                      2081
*                                                                  2081
@RF02079 DS    0H                                                  2081
@DE02054 TM    DELIM,B'00001000'                                   2081
         BNZ   @DC02054                                            2081
         LH    @15,RISTATUS                                        2081
         LTR   @15,@15                                             2081
         BZ    @DL02054                                            2081
@DC02054 DS    0H                                                  2082
*        END SCANSEP;                                              2082
@EL00029 DS    0H                                                  2082
@EF00029 DS    0H                                                  2082
@ER00029 LM    @14,@12,@SA00029                                    2082
         BR    @14                                                 2082
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - NEXTCHAR                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE EXTRACTS THE NEXT CHARACTER (PRIMARY    */
*/*             CHARACTER) FROM THE INPUT STREAM AND MAKES THE       */
*/*             CHARACTER LOGICALLY FOLLOWING IT (SECONDARY CHAR.)   */
*/*             AVAILABLE FOR REFERENCE. (THE NEXT INVOCATION OF     */
*/*             'NEXTCHAR' WILL TREAT THIS SECONDARY CHARACTER AS THE*/
*/*             PRIMARY CHARACTER). A NEW RECORD IS OBTAINED, IF     */
*/*             NECESSARY, TO PICK UP THE SECONDARY CHAR., AND THIS  */
*/*             NEW RECORD IS PREPARED FOR SCANNING BEFORE PROCESSING*/
*/*             OF IT BEGINS.                                        */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          FINALCHR- FLAG SET 'ON' WHEN INPUT END-OF-FILE HAS BEEN */
*/*                    REACHED.                                      */
*/*          FIRSTCHR- FLAG SET 'ON' WHEN THE LOCATION AND LENGTH OF */
*/*                    THE INPUT CHARACTERS TO BE SCANNED ARE        */
*/*                    SPECIFIED IN THE R/I HISTORICAL DATA AREA.    */
*/*          INRECPTR- PTR IN R/I HDA POINTING TO INPUT CHARACTERS   */
*/*                    NOT COMPLETELY SCANNED BY PREVIOUS INVOCATION */
*/*                    OF THE READER/INTERPRETER.                    */
*/*          INRECLEN- LENGTH OF ABOVE UNSCANNED STRING.             */
*/*          SCANINDX- INDEX INDICATING THE OFFSET INTO THE CURRENT  */
*/*                    INPUT RECORD OF THE LAST CHARACTER EXTRACTED. */
*/*          SCNLIMIT- OFFSET INTO THE CURRENT INPUT RECORD OF THE   */
*/*                    FINAL CHARACTER IN THE RECORD TO BE EXTRACTED.*/
*/*          INREC -   CONTAINS THE CURRENT INPUT RECORD             */
*/*          OPTSFLAG- FLAG SET 'ON' WHEN CURRENTLY SCANNING WITHIN  */
*/*                    THE PARAMETER OPTIONS STRING                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    VALUE WHEN AN ERROR IS FOUND.                 */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED.               */
*/*          CHAR2 -   INPUT CHARACTER WHICH LOGICALLY FOLLOWS THE   */
*/*                    CHARACTER JUST EXTRACTED.                     */
*/*          FINALCHR- SEE 'INPUT'                                   */
*/*          RISTATUS- SEE 'INPUT'                                   */
*/*          FIRSTCHR- SEE 'INPUT'                                   */
*/*          RECRDPTR- POINTER TO CURRENT INPUT RECORD               */
*/*          SCNLIMIT- SEE 'INPUT'                                   */
*/*          SCANINDX- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*NEXTCHAR:PROCEDURE;                                               2083
NEXTCHAR STM   @14,@12,@SA00030                                    2083
*        /************************************************************/
*        /*                                                          */
*        /*  ** NEXTCHAR **  GET NEXT COMMAND CHARACTER              */
*        /*                                                          */
*        /************************************************************/
*                                                                  2084
*        /************************************************************/
*        /*                                                          */
*        /* NOTE WHETHER END-OF-FILE HAS BEEN REACHED OR NOT         */
*        /*                                                          */
*        /************************************************************/
*        IF FINALCHR=YES                                           2084
*          THEN                                                    2084
         TM    FINALCHR,B'00000010'                                2084
         BNO   @RF02084                                            2084
*            DO;                                                   2085
*            OLDERID2 = NEWERID2;                                  2086
         L     @01,GDTPTR                                          2086
         L     @15,GDTTR2(,@01)                                    2086
         MVC   @TS00001(95),NEWERID2(@15)                          2086
         MVC   OLDERID2(95,@15),@TS00001                           2086
*            NEWID2='RI56';                                        2087
         MVC   NEWID2(4,@15),@CC01245                              2087
*            RISTATUS=EOFILE;                                      2088
         MVC   RISTATUS(2),@CH00118                                2088
*            END;                                                  2089
*          ELSE                                                    2090
*DOGRP185:   DO;                                                   2090
*                                                                  2090
         B     @RC02084                                            2090
@RF02084 DS    0H                                                  2090
DOGRP185 DS    0H                                                  2091
*            /********************************************************/
*            /*                                                      */
*            /* IF THE FIRST CHARACTER OF A NEW COMMAND IS TO BE     */
*            /* EXTRACTED, THEN PREPARE TO OBTAIN THE NEXT INPUT     */
*            /* RECORD (PREPARATION INCLUDES WRITING A BLANK OUTPUT  */
*            /* RECORD, UNLESS A NULL COMMAND WAS JUST ENCOUNTERED). */
*            /* OTHERWISE, JUST POINT TO THE NEXT CHARACTER OF THE   */
*            /* CURRENT RECORD.                                      */
*            /*                                                      */
*            /********************************************************/
*            IF FIRSTCHR=YES                                       2091
*              THEN                                                2091
         TM    FIRSTCHR,B'00000100'                                2091
         BNO   @RF02091                                            2091
*                DO;                                               2092
*                OLDERID2 = NEWERID2;                              2093
         L     @15,GDTPTR                                          2093
         L     @14,GDTTR2(,@15)                                    2093
         MVC   @TS00001(95),NEWERID2(@14)                          2093
         MVC   OLDERID2(95,@14),@TS00001                           2093
*                NEWID2='RI57';                                    2094
         MVC   NEWID2(4,@14),@CC01248                              2094
*                FIRSTCHR=NO;                                      2095
         NI    FIRSTCHR,B'11111011'                                2095
*                SCNLIMIT=0;                                       2096
         SLR   @14,@14                                             2096
         STH   @14,SCNLIMIT                                        2096
*                SCANINDX=1;                                       2097
         MVC   SCANINDX(2),@CH00172                                2097
*                MORTOCOM=YES;                                     2098
*                                                                  2098
         OI    MORTOCOM,B'00010000'                                2098
*                IF NULLCMD=NO                                     2099
*                  THEN                                            2099
         TM    NULLCMD,B'01000000'                                 2099
         BNZ   @RF02099                                            2099
*                    DO;                                           2100
*                    DARGSMOD=RISTID;                              2101
         L     @14,DDSTRU                                          2101
         MVC   DARGSMOD(3,@14),RISTID                              2101
*                    DARGSENT=INRECID;                             2102
         MVI   DARGSENT(@14),X'27'                                 2102
*                    BLANKFLD=BLANK;                               2103
         MVI   BLANKFLD+1,C' '                                     2103
         MVC   BLANKFLD+2(8),BLANKFLD+1                            2103
         MVI   BLANKFLD,C' '                                       2103
*                    DARGDBP=ADDR(BLANKFLD);                       2104
         LA    @05,BLANKFLD                                        2104
         ST    @05,DARGDBP(,@14)                                   2104
*                    DARGILP=LENGTH(BLANKFLD);                     2105
*                                                                  2105
         MVC   DARGILP(2,@14),@CH00040                             2105
*                    CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);         2106
*                                                                  2106
         ST    @15,@AL00001                                        2106
         LA    @14,@CF00102                                        2106
         ST    @14,@AL00001+4                                      2106
         LA    @14,DDSTRU                                          2106
         ST    @14,@AL00001+8                                      2106
         MVI   @AL00001+8,X'80'                                    2106
         L     @15,GDTPRT(,@15)                                    2106
         LA    @01,@AL00001                                        2106
         BALR  @14,@15                                             2106
*                    END;                                          2107
*                  ELSE                                            2108
*                    NULLCMD=NO;                                   2108
         B     @RC02099                                            2108
@RF02099 NI    NULLCMD,B'10111111'                                 2108
*                END;                                              2109
*              ELSE                                                2110
*                SCANINDX=SCANINDX+1;                              2110
*                                                                  2110
         B     @RC02091                                            2110
@RF02091 LH    @01,SCANINDX                                        2110
         LA    @01,1(,@01)                                         2110
         STH   @01,SCANINDX                                        2110
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT THE NEXT INPUT CHARACTER & ALSO OBTAIN THE   */
*            /* INPUT CHARACTER WHICH LOGICALLY FOLLOWS THIS NEXT    */
*            /* CHARACTER (GET THE NEXT RECORD IF NECESSARY).        */
*            /*                                                      */
*            /********************************************************/
*            IF SCNLIMIT > 0                                       2111
*              THEN                                                2111
@RC02091 LH    @15,SCNLIMIT                                        2111
         LTR   @15,@15                                             2111
         BNP   @RF02111                                            2111
*                CHAR1=INREC(SCANINDX);                            2112
         LH    @01,SCANINDX                                        2112
         L     @15,RECRDPTR                                        2112
         ALR   @15,@01                                             2112
         BCTR  @15,0                                               2112
         MVC   CHAR1(1),INREC(@15)                                 2112
*            IF SCANINDX >= SCNLIMIT                               2113
*              THEN                                                2113
*                                                                  2113
@RF02111 LH    @15,SCANINDX                                        2113
         CH    @15,SCNLIMIT                                        2113
         BL    @RF02113                                            2113
*                /****************************************************/
*                /*                                                  */
*                /* OBTAIN THE NEXT INPUT RECORD IN ORDER TO PICK UP */
*                /* THE SECOND INPUT CHARACTER                       */
*                /*                                                  */
*                /****************************************************/
*DOGRP190:       DO;                                               2114
*                                                                  2114
DOGRP190 DS    0H                                                  2115
*                  /**************************************************/
*                  /*                                                */
*                  /* FABRICATE A COMMAND-END DELIMITER IF SCANNING  */
*                  /* HAS REACHED THE END OF A NON-CONTINUED COMMAND.*/
*                  /*                                                */
*                  /**************************************************/
*                  IF OPTSFLAG=ON  MORTOCOM=NO                    2115
*                    THEN                                          2115
         TM    OPTSFLAG,B'00100000'                                2115
         BO    @RT02115                                            2115
         TM    MORTOCOM,B'00010000'                                2115
         BNZ   @RF02115                                            2115
@RT02115 DS    0H                                                  2116
*                      DO;                                         2116
*                      CHAR1=ENDDELIM;                             2117
         MVI   CHAR1,C';'                                          2117
*                      CHAR2=BLANK;                                2118
         MVI   CHAR2,C' '                                          2118
*                      END;                                        2119
*                    ELSE                                          2120
*                      IF SCANINDX > SCNLIMIT                      2120
*                        THEN                                      2120
         B     @RC02115                                            2120
@RF02115 LH    @15,SCANINDX                                        2120
         CH    @15,SCNLIMIT                                        2120
         BNH   @RF02120                                            2120
*                          CHAR1=BLANK;                            2121
*                                                                  2121
         MVI   CHAR1,C' '                                          2121
*                  /**************************************************/
*                  /*                                                */
*                  /* READ IN RECORD(S), STRIPPING CHARACTERS NOT TO */
*                  /* BE SCANNED FROM BOTH ENDS OF THE NEW RECORD -- */
*                  /* READ IN RECORDS UNTIL ONE IS READ WHICH HAS    */
*                  /* CHARACTERS LEFT TO BE SCANNED AFTER STRIPPING. */
*                  /* READ NO MORE RECORDS IF A 'READ' CONDITION HAS */
*                  /* BEEN FOUND OR IF THE CURRENT COMMAND IS NOT    */
*                  /* CONTINUED ON TO THE NEXT INPUT RECORD.         */
*                  /*                                                */
*                  /**************************************************/
*                  INCOMM=NO;                                      2122
@RF02120 DS    0H                                                  2122
@RC02115 NI    INCOMM,B'11011111'                                  2122
*                  DO WHILE(SCNLIMIT-SCANINDX <= 0 &               2123
*                           OPTSFLAG=OFF & MORTOCOM=YES &          2123
*                           RISTATUS^=EOFILE & RISTATUS^=SKIPREST);
*                                                                  2123
         B     @DE02123                                            2123
@DL02123 DS    0H                                                  2124
*                    CALL GETRECRD;                                2124
*                                                                  2124
         BAL   @14,GETRECRD                                        2124
*                  END;                                            2125
*                                                                  2125
@DE02123 LH    @15,SCNLIMIT                                        2125
         SH    @15,SCANINDX                                        2125
         LTR   @15,@15                                             2125
         BP    @DC02123                                            2125
         TM    OPTSFLAG,B'00100000'                                2125
         BNZ   @DC02123                                            2125
         TM    MORTOCOM,B'00010000'                                2125
         BNO   @DC02123                                            2125
         LH    @15,RISTATUS                                        2125
         CH    @15,@CH00118                                        2125
         BE    @DC02123                                            2125
         CH    @15,@CH00042                                        2125
         BNE   @DL02123                                            2125
@DC02123 DS    0H                                                  2126
*                  /**************************************************/
*                  /*                                                */
*                  /* IF NO MORE INPUT RECORDS REMAIN, SET VALUES TO */
*                  /* INDICATE THIS CONDITION.                       */
*                  /*                                                */
*                  /**************************************************/
*                  IF RISTATUS = EOFILE                            2126
*                    THEN                                          2126
         CLC   RISTATUS(2),@CH00118                                2126
         BNE   @RF02126                                            2126
*                      DO;                                         2127
*                      OLDERID2 = NEWERID2;                        2128
         L     @01,GDTPTR                                          2128
         L     @15,GDTTR2(,@01)                                    2128
         MVC   @TS00001(95),NEWERID2(@15)                          2128
         MVC   OLDERID2(95,@15),@TS00001                           2128
*                      NEWID2='RI59';                              2129
         MVC   NEWID2(4,@15),@CC01252                              2129
*                      CHAR2=BLANK;                                2130
         MVI   CHAR2,C' '                                          2130
*                      FINALCHR=YES;                               2131
         OI    FINALCHR,B'00000010'                                2131
*                      RISTATUS=0;                                 2132
         SLR   @15,@15                                             2132
         STH   @15,RISTATUS                                        2132
*                      END;                                        2133
*                END DOGRP190;                                     2134
*                                                                  2134
@RF02126 DS    0H                                                  2135
*            /********************************************************/
*            /*                                                      */
*            /* EXTRACT THE 2ND INPUT CHARACTER FROM THE RECORD NOW  */
*            /* POINTED TO, UNLESS A NEW RECORD WAS NOT OBTAINED     */
*            /*                                                      */
*            /********************************************************/
*            IF FINALCHR=NO  &  SCANINDX < SCNLIMIT                2135
*              THEN                                                2135
@RF02113 TM    FINALCHR,B'00000010'                                2135
         BNZ   @RF02135                                            2135
         LH    @15,SCANINDX                                        2135
         CH    @15,SCNLIMIT                                        2135
         BNL   @RF02135                                            2135
*                CHAR2=INREC(SCANINDX+1);                          2136
         L     @01,RECRDPTR                                        2136
         ALR   @01,@15                                             2136
         MVC   CHAR2(1),INREC(@01)                                 2136
*            END DOGRP185;                                         2137
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - GETRECRD                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE OBTAINS THE NEXT INPUT RECORD, PRINTS   */
*/*             THE RECORD AND SETS UP REFERENCE TO IT TO ALLOW      */
*/*             SCANNING TO CONTINUE.  IF NO INPUT RECORDS REMAIN,   */
*/*             THE R/I INTERNAL STATUS CODE IS SET TO SIGNAL EOF.   */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          IOCDAD -  ADDRESS OF RECORD JUST READ                   */
*/*          IOCDLN -  LENGTH OF RECORD JUST READ                    */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          RECRDPTR- POINTER TO RECORD JUST READ                   */
*/*          SCNLIMIT- LENGTH OF RECORD JUST READ                    */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */
*/*                    CODE IF EOF OR AN I/O ERROR OCCURS.           */
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  2138
*GETRECRD:PROCEDURE;                                               2138
         B     @PB00031                                            2138
GETRECRD STM   @14,@12,@SA00031                                    2138
*        /************************************************************/
*        /*                                                          */
*        /*  ** GETRECRD **  GET NEXT INPUT RECORD                   */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2139
*          THEN;                                                   2139
         L     @01,GDTPTR                                          2139
         L     @15,GDTDBG(,@01)                                    2139
         LTR   @15,@15                                             2139
         BZ    @RT02139                                            2139
*          ELSE                                                    2141
*            CALL ICKDB010(GDTTBL,'RIGR');                         2141
*                                                                  2141
         L     @15,GDTPTR                                          2141
         ST    @15,@AL00001                                        2141
         LA    @14,@CC01256                                        2141
         ST    @14,@AL00001+4                                      2141
         MVI   @AL00001+4,X'80'                                    2141
         L     @15,GDTDBG(,@15)                                    2141
         LA    @01,@AL00001                                        2141
         BALR  @14,@15                                             2141
*        /************************************************************/
*        /*                                                          */
*        /*  REQUEST NEXT RECORD AND NOTE IF THE RECORD COULD NOT    */
*        /*  BE OBTAINED.  ANY ABNORMAL CONDITION OTHER THAN END-OF- */
*        /*  FILE IS TREATED AS AN I/O ERROR                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  2142
*        CALL ICKIOGT0(GDTTBL,ADDRIOCS);                           2142
@RT02139 L     @15,GDTPTR                                          2142
         ST    @15,@AL00001                                        2142
         L     @01,GDTRIH(,@15)                                    2142
         LA    @14,ADDRIOCS(,@01)                                  2142
         ST    @14,@AL00001+4                                      2142
         MVI   @AL00001+4,X'80'                                    2142
         L     @15,GDTGET(,@15)                                    2142
         LA    @01,@AL00001                                        2142
         BALR  @14,@15                                             2142
*        RESPECIFY RTNREG RSTD;                                    2143
*        TESTRC = RTNREG;                                          2144
         STH   RTNREG,TESTRC                                       2144
*        RESPECIFY RTNREG UNRSTD;                                  2145
*                                                                  2145
*        IF TESTRC^=0                                              2146
*          THEN                                                    2146
         LH    @15,TESTRC                                          2146
         LTR   @15,@15                                             2146
         BZ    @RF02146                                            2146
*            IF TESTRC=16                                          2147
*              THEN                                                2147
         CH    @15,@CH00274                                        2147
         BNE   @RF02147                                            2147
*                RISTATUS=EOFILE;                                  2148
         MVC   RISTATUS(2),@CH00118                                2148
*              ELSE                                                2149
*                DO;                                               2149
         B     @RC02147                                            2149
@RF02147 DS    0H                                                  2150
*                LASTCC=TERMERR;                                   2150
         MVC   LASTCC(2),@CH00274                                  2150
*                RISTATUS=SKIPREST;                                2151
         MVC   RISTATUS(2),@CH00042                                2151
*                END;                                              2152
*                                                                  2152
*          /**********************************************************/
*          /*                                                        */
*          /*  WHEN RECORD IS OBTAINED, PRINT IT AND SET IT UP FOR   */
*          /*  SCANNING                                              */
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    2153
*            DO;                                                   2153
         B     @RC02146                                            2153
@RF02146 DS    0H                                                  2154
*            RECRDPTR=ADDRIOCS->IOCDAD;                            2154
         L     @15,GDTPTR                                          2154
         L     @01,GDTRIH(,@15)                                    2154
         L     @14,ADDRIOCS(,@01)                                  2154
         L     @05,IOCDAD(,@14)                                    2154
         ST    @05,RECRDPTR                                        2154
*            SCNLIMIT=ADDRIOCS->IOCDLN;                            2155
*                                                                  2155
         L     @14,IOCDLN(,@14)                                    2155
         STH   @14,SCNLIMIT                                        2155
*            /********************************************************/
*            /*                                                      */
*            /* SET UP PRINT ROUTINE DATA STRUCTURES                 */
*            /*                                                      */
*            /********************************************************/
*            DARGDBP=RECRDPTR;                                     2156
         L     @04,DDSTRU                                          2156
         ST    @05,DARGDBP(,@04)                                   2156
*            DARGILP=SCNLIMIT;                                     2157
         STH   @14,DARGILP(,@04)                                   2157
*            DARGSMOD=RISTID;                                      2158
         MVC   DARGSMOD(3,@04),RISTID                              2158
*            DARGSENT=INRECID;                                     2159
*                                                                  2159
         MVI   DARGSENT(@04),X'27'                                 2159
*            CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);                 2160
*                                                                  2160
         ST    @15,@AL00001                                        2160
         LA    @14,@CF00102                                        2160
         ST    @14,@AL00001+4                                      2160
         LA    @14,DDSTRU                                          2160
         ST    @14,@AL00001+8                                      2160
         MVI   @AL00001+8,X'80'                                    2160
         L     @15,GDTPRT(,@15)                                    2160
         LA    @01,@AL00001                                        2160
         BALR  @14,@15                                             2160
*            CALL SCANENDS;                                        2161
*                                                                  2161
         BAL   @14,SCANENDS                                        2161
*            END;                                                  2162
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SCANENDS                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE SCANS BOTH ENDS OF A NEW INPUT RECORD,  */
*/*             CHECKING FOR CHARACTERS WHICH SHOULD NOT BE INCLUDED */
*/*             IN THE NORMAL COMMAND SCANNING.  ONLY THOSE CHAR'S   */
*/*             WITHIN THE SPECIFIED SOURCE MARGINS ARE ELIGIBLE FOR */
*/*             SCANNING.  ALSO, LEADING BLANKS AND COMMENTS ARE     */
*/*             IGNORED IF THE PREVIOUS RECORD ENDED WITH A FIELD    */
*/*             CONTINUATION CHARACTER (A PLUS SIGN); IF THE NEW     */
*/*             RECORD ENDS WITH A CONTINUATION CHARACTER, THEN ALL  */
*/*             CHARACTERS INCLUDING AND FOLLOWING IT ARE IGNORED.   */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          LEFTMGN - LEFT INPUT COMMAND SOURCE MARGIN              */
*/*          RIGHTMGN- RIGHT INPUT COMMAND SOURCE MARGIN             */
*/*          SCNLIMIT- LENGTH OF NEW INPUT RECORD                    */
*/*          CONTNEXT- FLAG SET 'ON' IF PREVIOUS RECORD ENDED WITH   */
*/*                    A FIELD CONTINUATION DELIMITER                */
*/*          INREC -   CONTAINS THE NEW INPUT RECORD                 */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          SCANINDX- OFFSET INTO NEW RECORD AT WHICH NORMAL        */
*/*                    SCANNING IS TO BEGIN                          */
*/*          SCNLIMIT- OFFSET INTO NEW RECORD AT WHICH NORMAL        */
*/*                    SCANNING IS TO END                            */
*/*          CONTNEXT- FLAG SET 'ON' IF NEW RECORD ENDS WITH THE     */
*/*                    FIELD CONTINUATION DELIMITER                  */
*/*          MORTOCOM- FLAG SET 'ON' WHEN THE NEW RECORD IS TO BE    */
*/*                    CONTINUED ON TO THE NEXT INPUT RECORD.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  2163
*SCANENDS:PROCEDURE;                                               2163
         B     @PB00032                                            2163
SCANENDS STM   @14,@12,@SA00032                                    2163
*        /************************************************************/
*        /*                                                          */
*        /* SCANENDS PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*        DCL ENDFOUND BIT(1);          /*SIGNALS THAT THE FINAL CHAR.
*                                        TO BE SCANNED IN THE NEW  2164
*                                        RECORD HAS BEEN DETERMINED. */
*        DCL SKIPLEAD BIT(1);          /*SIGNALS THAT LEADING BLANKS
*                                        ARE TO BE SKIPPED BEFORE  2165
*                                        SCANNING THE NEW RECORD.    */
*        /************************************************************/
*        /*                                                          */
*        /*  ** SCANENDS **  SCAN RECORD FOR CONTINUATION INDICATION */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2166
*          THEN;                                                   2166
         L     @01,GDTPTR                                          2166
         L     @15,GDTDBG(,@01)                                    2166
         LTR   @15,@15                                             2166
         BZ    @RT02166                                            2166
*          ELSE                                                    2168
*            CALL ICKDB010(GDTTBL,'RISE');                         2168
*                                                                  2168
         L     @15,GDTPTR                                          2168
         ST    @15,@AL00001                                        2168
         LA    @14,@CC01263                                        2168
         ST    @14,@AL00001+4                                      2168
         MVI   @AL00001+4,X'80'                                    2168
         L     @15,GDTDBG(,@15)                                    2168
         LA    @01,@AL00001                                        2168
         BALR  @14,@15                                             2168
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE LEFT AND RIGHT SCANNING LIMITS OF NEW RECORD. */
*        /* THEN SCAN BACKWARD FROM THE END OF THE NEW RECORD,       */
*        /* CHECKING FOR A CONTINUATION DELIMITER                    */
*        /*                                                          */
*        /************************************************************/
*        SCANINDX=LEFTMGN;                                         2169
@RT02166 L     @01,GDTPTR                                          2169
         L     @15,GDTRIH(,@01)                                    2169
         MVC   SCANINDX(2),LEFTMGN(@15)                            2169
*        SCNLIMIT=MIN(RIGHTMGN,SCNLIMIT);                          2170
         LH    @15,RIGHTMGN(,@15)                                  2170
         LH    @14,SCNLIMIT                                        2170
         CR    @15,@14                                             2170
         BNH   *+6
         LR    @15,@14                                             2170
         STH   @15,SCNLIMIT                                        2170
*        IF CONTNEXT=YES                                           2171
*          THEN                                                    2171
         TM    CONTNEXT,B'00001000'                                2171
         BNO   @RF02171                                            2171
*            DO;                                                   2172
*            SKIPLEAD=YES;                                         2173
         OI    SKIPLEAD,B'10000000'                                2173
*            CONTNEXT=NO;                                          2174
         NI    CONTNEXT,B'11110111'                                2174
*            END;                                                  2175
*          ELSE                                                    2176
*            SKIPLEAD=NO;                                          2176
         B     @RC02171                                            2176
@RF02171 NI    SKIPLEAD,B'01111111'                                2176
*        MORTOCOM=NO;                                              2177
@RC02171 NI    MORTOCOM,B'11101111'                                2177
*        ENDFOUND=NO;                                              2178
         NI    ENDFOUND,B'01111111'                                2178
*        DO INDEX=SCNLIMIT TO SCANINDX BY -1 WHILE(ENDFOUND=NO);   2179
*                                                                  2179
         LH    @15,SCNLIMIT                                        2179
         STH   @15,INDEX                                           2179
         B     @DE02179                                            2179
@DL02179 TM    ENDFOUND,B'10000000'                                2179
         BNZ   @DC02179                                            2179
*          /**********************************************************/
*          /*                                                        */
*          /* SEARCH FOR THE LAST NON-BLANK CHARACTER OF THE NEW     */
*          /* RECORD, WHICH MAY INDICATE FIELD AND/OR COMMAND        */
*          /* CONTINUATION OR SIMPLY THE SCANNING LIMIT OF THE RECORD*/
*          /*                                                        */
*          /**********************************************************/
*          IF INREC(INDEX) ^= BLANK                                2180
*            THEN                                                  2180
         L     @14,RECRDPTR                                        2180
         ALR   @15,@14                                             2180
         BCTR  @15,0                                               2180
         CLI   INREC(@15),C' '                                     2180
         BE    @RF02180                                            2180
*              IF INREC(INDEX) = CMDCONT    INREC(INDEX) = FLDCONT
*                                                                  2181
*                /****************************************************/
*                /*                                                  */
*                /* A CONTINUATION DELIMITER DENOTES THAT THIS       */
*                /* COMMAND CONTINUES ON TO THE NEXT RECORD.         */
*                /*                                                  */
*                /****************************************************/
*                THEN                                              2181
         LH    @15,INDEX                                           2181
         ALR   @15,@14                                             2181
         BCTR  @15,0                                               2181
         CLI   INREC(@15),C'-'                                     2181
         BE    @RT02181                                            2181
         LH    @15,INDEX                                           2181
         ALR   @14,@15                                             2181
         BCTR  @14,0                                               2181
         CLI   INREC(@14),C'+'                                     2181
         BNE   @RF02181                                            2181
@RT02181 DS    0H                                                  2182
*                  DO;                                             2182
*                                                                  2182
*                  /**************************************************/
*                  /*                                                */
*                  /* IF FIELD CONTINUATION IS INDICATED, NOTE THAT  */
*                  /* LEADING COMMENTS AND BLANKS ARE TO BE IGNORED  */
*                  /* IN THE NEXT RECORD(S) UNTIL A NON-BLANK OR     */
*                  /* COMMAND TERMINATION IS FOUND, UNLESS THE SCAN  */
*                  /* IS ALREADY IN MID-COMMENT.                     */
*                  /*                                                */
*                  /**************************************************/
*                  IF INREC(INDEX)=FLDCONT                         2183
*                    THEN                                          2183
         LH    @01,INDEX                                           2183
         L     @15,RECRDPTR                                        2183
         ALR   @15,@01                                             2183
         BCTR  @15,0                                               2183
         CLI   INREC(@15),C'+'                                     2183
         BNE   @RF02183                                            2183
*                      CONTNEXT=YES;                               2184
         OI    CONTNEXT,B'00001000'                                2184
*                  MORTOCOM=YES;                                   2185
@RF02183 OI    MORTOCOM,B'00010000'                                2185
*                  ENDFOUND=YES;                                   2186
         OI    ENDFOUND,B'10000000'                                2186
*                  SCNLIMIT=INDEX-1;                               2187
         LH    @15,INDEX                                           2187
         BCTR  @15,0                                               2187
         STH   @15,SCNLIMIT                                        2187
*                  END;                                            2188
*                                                                  2188
*                /****************************************************/
*                /*                                                  */
*                /* WHEN NOT ONE OF THE ABOVE DELIMITERS, THE SCAN   */
*                /* LIMIT HAS BEEN FOUND.                            */
*                /*                                                  */
*                /****************************************************/
*                ELSE                                              2189
*                  ENDFOUND=YES;                                   2189
         B     @RC02181                                            2189
@RF02181 OI    ENDFOUND,B'10000000'                                2189
*        END;                                                      2190
*                                                                  2190
@RC02181 DS    0H                                                  2190
@RF02180 SLR   @15,@15                                             2190
         BCTR  @15,0                                               2190
         AH    @15,INDEX                                           2190
         STH   @15,INDEX                                           2190
@DE02179 CH    @15,SCANINDX                                        2190
         BNL   @DL02179                                            2190
@DC02179 DS    0H                                                  2191
*        /************************************************************/
*        /*                                                          */
*        /* BYPASS LEADING BLANKS AND/OR COMMENTS IF A FIELD         */
*        /* CONTINUATION DELIMITER WAS FOUND ENDING THE PRECEDING    */
*        /* INPUT RECORD.                                            */
*        /*                                                          */
*        /************************************************************/
*        IF SKIPLEAD=YES & COMMENT=NO                              2191
*          THEN                                                    2191
         TM    SKIPLEAD,B'10000000'                                2191
         BNO   @RF02191                                            2191
         TM    COMMENT,B'01000000'                                 2191
         BNZ   @RF02191                                            2191
*DOGRP195:   DO;                                                   2192
DOGRP195 DS    0H                                                  2193
*              OLDERID2 = NEWERID2;                                2193
         L     @01,GDTPTR                                          2193
         L     @15,GDTTR2(,@01)                                    2193
         MVC   @TS00001(95),NEWERID2(@15)                          2193
         MVC   OLDERID2(95,@15),@TS00001                           2193
*              NEWID2='RI60';                                      2194
         MVC   NEWID2(4,@15),@CC01266                              2194
*DOLOOP45:     DO INDEX=SCANINDX TO SCNLIMIT WHILE(SKIPLEAD=YES);  2195
DOLOOP45 LH    @15,SCANINDX                                        2195
         B     @DE02195                                            2195
@DL02195 TM    SKIPLEAD,B'10000000'                                2195
         BNO   @DC02195                                            2195
*                IF INREC(INDEX) ^= BLANK                          2196
*                  THEN                                            2196
*                                                                  2196
         L     @14,RECRDPTR                                        2196
         ALR   @15,@14                                             2196
         BCTR  @15,0                                               2196
         CLI   INREC(@15),C' '                                     2196
         BE    @RF02196                                            2196
*                    /************************************************/
*                    /*                                              */
*                    /* IF BYPASSING A LEADING COMMENT, LOOK FOR THE */
*                    /* DELIMITER WHICH ENDS THE COMMENT.            */
*                    /*                                              */
*                    /************************************************/
*                    IF INCOMM=YES                                 2197
*                      THEN                                        2197
         TM    INCOMM,B'00100000'                                  2197
         BNO   @RF02197                                            2197
*                        IF INDEX < SCNLIMIT &                     2198
*                           INREC(INDEX:INDEX+1) = COMEND          2198
*                          THEN                                    2198
         LH    @15,INDEX                                           2198
         CH    @15,SCNLIMIT                                        2198
         BNL   @RF02198                                            2198
         ALR   @14,@15                                             2198
         BCTR  @14,0                                               2198
         CLC   INREC(2,@14),COMEND                                 2198
         BNE   @RF02198                                            2198
*                            DO;                                   2199
*                            OLDERID2 = NEWERID2;                  2200
         L     @01,GDTPTR                                          2200
         L     @14,GDTTR2(,@01)                                    2200
         MVC   @TS00001(95),NEWERID2(@14)                          2200
         MVC   OLDERID2(95,@14),@TS00001                           2200
*                            NEWID2='RI61';                        2201
         MVC   NEWID2(4,@14),@CC01269                              2201
*                            INDEX=INDEX+1;                        2202
         LA    @15,1(,@15)                                         2202
         STH   @15,INDEX                                           2202
*                            INCOMM=NO;                            2203
         NI    INCOMM,B'11011111'                                  2203
*                            END;                                  2204
*                          ELSE;                                   2205
*                                                                  2205
@RF02198 DS    0H                                                  2206
*                      /**********************************************/
*                      /*                                            */
*                      /* WHEN BYPASSING LEADING BLANKS, CHECK FOR   */
*                      /* LEADING COMMENTS AND FOR A NON-BLANK       */
*                      /* CHARACTER INDICATING STARTING SCAN POSITION*/
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        2206
*                        IF INDEX < SCNLIMIT &                     2206
*                           INREC(INDEX:INDEX+1) = COMSTART        2206
*                          THEN                                    2206
         B     @RC02197                                            2206
@RF02197 LH    @15,INDEX                                           2206
         CH    @15,SCNLIMIT                                        2206
         BNL   @RF02206                                            2206
         L     @01,RECRDPTR                                        2206
         ALR   @01,@15                                             2206
         BCTR  @01,0                                               2206
         CLC   INREC(2,@01),COMSTART                               2206
         BNE   @RF02206                                            2206
*                            DO;                                   2207
*                            OLDERID2 = NEWERID2;                  2208
         L     @01,GDTPTR                                          2208
         L     @14,GDTTR2(,@01)                                    2208
         MVC   @TS00001(95),NEWERID2(@14)                          2208
         MVC   OLDERID2(95,@14),@TS00001                           2208
*                            NEWID2='RI62';                        2209
         MVC   NEWID2(4,@14),@CC01270                              2209
*                            INCOMM=YES;                           2210
         OI    INCOMM,B'00100000'                                  2210
*                            INDEX=INDEX+1;                        2211
         LA    @15,1(,@15)                                         2211
         STH   @15,INDEX                                           2211
*                            END;                                  2212
*                          ELSE                                    2213
*                            DO;                                   2213
         B     @RC02206                                            2213
@RF02206 DS    0H                                                  2214
*                            SKIPLEAD=NO;                          2214
         NI    SKIPLEAD,B'01111111'                                2214
*                            SCANINDX=INDEX;                       2215
         MVC   SCANINDX(2),INDEX                                   2215
*                            END;                                  2216
*              END DOLOOP45;                                       2217
@RC02206 DS    0H                                                  2217
@RC02197 DS    0H                                                  2217
@RF02196 LA    @15,1                                               2217
         AH    @15,INDEX                                           2217
@DE02195 STH   @15,INDEX                                           2217
         CH    @15,SCNLIMIT                                        2217
         BNH   @DL02195                                            2217
@DC02195 DS    0H                                                  2218
*              /******************************************************/
*              /*                                                    */
*              /* IF ONLY BLANKS AND COMMENTS WERE FOUND IN THIS     */
*              /* RECORD FOLLOWING FIELD CONTINUATION, THEN CHECK TO */
*              /* SEE IF THE RECORD IS CONTINUED.  IF SO, NOTE THAT  */
*              /* IT SHOULD STILL BE CONSIDERED FIELD CONTINUATION.  */
*              /* IF NOT CONTINUED, SET 'CHAR2' TO BE BLANK UNTIL THE*/
*              /* NEXT CALL TO 'NEXTCHAR' CAN FABRICATE A SEMICOLON. */
*              /*                                                    */
*              /******************************************************/
*              IF SKIPLEAD=YES                                     2218
*                THEN                                              2218
         TM    SKIPLEAD,B'10000000'                                2218
         BNO   @RF02218                                            2218
*                  DO;                                             2219
*                  SCANINDX=INDEX+1;                               2220
         LH    @01,INDEX                                           2220
         LA    @01,1(,@01)                                         2220
         STH   @01,SCANINDX                                        2220
*                  IF MORTOCOM=YES                                 2221
*                    THEN                                          2221
         TM    MORTOCOM,B'00010000'                                2221
         BNO   @RF02221                                            2221
*                      CONTNEXT=YES;                               2222
         OI    CONTNEXT,B'00001000'                                2222
*                    ELSE                                          2223
*                      CHAR2=BLANK;                                2223
         B     @RC02221                                            2223
@RF02221 MVI   CHAR2,C' '                                          2223
*                  END;                                            2224
@RC02221 DS    0H                                                  2225
*            END DOGRP195;                                         2225
*                                                                  2225
@RF02218 DS    0H                                                  2226
*        /************************************************************/
*        /*                                                          */
*        /* ADJUST STARTING SCAN POSITION IN PREPARATION FOR         */
*        /* INCREMENTING OF THE SCAN POSITION POINTER.  ADJUST ENDING*/
*        /* SCAN LIMIT IF COMMAND CONTINUATION IS NOT INDICATED IN   */
*        /* PREPARATION FOR FABRICATING A COMMAND-ENDING DELIMITER.  */
*        /*                                                          */
*        /************************************************************/
*        SCANINDX=SCANINDX-1;                                      2226
@RF02191 LH    @15,SCANINDX                                        2226
         BCTR  @15,0                                               2226
         STH   @15,SCANINDX                                        2226
*        IF MORTOCOM=NO                                            2227
*          THEN                                                    2227
         TM    MORTOCOM,B'00010000'                                2227
         BNZ   @RF02227                                            2227
*            SCNLIMIT=SCNLIMIT+1;                                  2228
*                                                                  2228
         LH    @01,SCNLIMIT                                        2228
         LA    @01,1(,@01)                                         2228
         STH   @01,SCNLIMIT                                        2228
*        END SCANENDS;                                             2229
*                                                                  2229
*                                                                  2229
@EL00032 DS    0H                                                  2229
@EF00032 DS    0H                                                  2229
@ER00032 LM    @14,@12,@SA00032                                    2229
         BR    @14                                                 2229
*        END GETRECRD;                                             2230
*                                                                  2230
*                                                                  2230
@EL00031 DS    0H                                                  2230
@EF00031 DS    0H                                                  2230
@ER00031 LM    @14,@12,@SA00031                                    2230
         BR    @14                                                 2230
*        END NEXTCHAR;                                             2231
@EL00030 DS    0H                                                  2231
@EF00030 DS    0H                                                  2231
@ER00030 LM    @14,@12,@SA00030                                    2231
         BR    @14                                                 2231
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - DSPLCALC                                       */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE CALCULATES THE OFFSET INTO THE CURRENT  */
*/*             PARAMETER'S FDT POINTER VECTOR AT WHICH A VALUE IS   */
*/*             TO BE INSERTED.  THE VALUE IS ONE WHICH IS RELATED   */
*/*             THE FDT POINTER STRUCTURE USED FOR REPEATED SUBLISTS */
*/*             AND THE OFFSET IS BASED UPON THE CURRENT REPEATED    */
*/*             SUBLIST NESTING LEVEL AND THE MAXIMUM NUMBER OF      */
*/*             SUBLIST REPETITIONS ALLOWED.                         */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          DEPTH -   CURRENT LEVEL OF REPEATED SUBLIST NESTING     */
*/*          REPLIMIT- LIST CONTAINING THE MAXIMUM NUMBER OF SUBLIST */
*/*                    REPETITIONS ALLOWED AT EACH REPEATEDNESS LEVEL*/
*/*          ARRYPTR - POINTER IN MAIN FDT POINTER VECTOR WHICH      */
*/*                    POINTS TO CURRENT PARAMETER'S SECONDARY PTR   */
*/*                    VECTOR.                                       */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          ARRYPTR - POINTER TO SECONDARY POINTER VECTOR, THE      */
*/*                    DISPLACEMENT INTO WHICH A VALUE WILL BE       */
*/*                    INSERTED AFTER THE RETURN FROM 'DSPLCALC'     */
*/*          ARRYDSPL- THE CALCULATED DISPLACEMENT                   */
*/*                                                                  */
*/********************************************************************/
*DSPLCALC:PROCEDURE(DEPTH);                                        2232
DSPLCALC STM   @14,@12,@SA00033                                    2232
         MVC   @PC00033(4),0(@01)                                  2232
*        /************************************************************/
*        /*                                                          */
*        /* DSPLCALC PROCEDURE DATA DEFINITIONS                      */
*        /*                                                          */
*        /************************************************************/
*        DCL DEPTH FIXED(15);          /*DEPTH OF REPEATED LIST    2233
*                                        NESTING WITH WHICH THE COUNT
*                                        OR POINTER IS ASSOCIATED    */
*        DCL FACTOR   FIXED(15);       /*MULTIPLICATION FACTOR USED IN
*                                        CALCULATING ARRAY OFFSETS   */
*        /************************************************************/
*        /*                                                          */
*        /*  ** DSPLCALC ** CALCULATE DISPLACEMENT INTO PTR ARRAY    */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2235
*          THEN;                                                   2235
         L     @01,GDTPTR                                          2235
         L     @15,GDTDBG(,@01)                                    2235
         LTR   @15,@15                                             2235
         BZ    @RT02235                                            2235
*          ELSE                                                    2237
*            CALL ICKDB010(GDTTBL,'RICK');                         2237
*                                                                  2237
         L     @15,GDTPTR                                          2237
         ST    @15,@AL00001                                        2237
         LA    @14,@CC01277                                        2237
         ST    @14,@AL00001+4                                      2237
         MVI   @AL00001+4,X'80'                                    2237
         L     @15,GDTDBG(,@15)                                    2237
         LA    @01,@AL00001                                        2237
         BALR  @14,@15                                             2237
*        ARRYDSPL=0;                                               2238
@RT02235 SLR   @15,@15                                             2238
         STH   @15,ARRYDSPL                                        2238
*        IF DEPTH=0                                                2239
*          THEN                                                    2239
         L     @14,@PC00033                                        2239
         CH    @15,DEPTH(,@14)                                     2239
         BNE   @RF02239                                            2239
*            ARRYPTR=ADDR(FDTPTR(PARMID));                         2240
         LH    @15,PARMID                                          2240
         SLA   @15,2                                               2240
         L     @01,FDTADDR                                         2240
         LA    @15,FDTPTR-4(@15,@01)                               2240
         ST    @15,ARRYPTR                                         2240
*          ELSE                                                    2241
*            DO INDEX=1 TO DEPTH;                                  2241
         B     @RC02239                                            2241
@RF02239 LA    @15,1                                               2241
         B     @DE02241                                            2241
@DL02241 DS    0H                                                  2242
*              FACTOR=1;                                           2242
         LA    @14,1                                               2242
         STH   @14,FACTOR                                          2242
*              DO LISTINDX=(INDEX+1) TO DEPTH;                     2243
         ALR   @15,@14                                             2243
         B     @DE02243                                            2243
@DL02243 DS    0H                                                  2244
*                FACTOR=FACTOR*REPLIMIT(LISTINDX);                 2244
         LR    @14,@15                                             2244
         ALR   @14,@14                                             2244
         LH    @05,FACTOR                                          2244
         MH    @05,REPLIMIT-2(@14)                                 2244
         STH   @05,FACTOR                                          2244
*              END;                                                2245
         AL    @15,@CF00172                                        2245
@DE02243 STH   @15,LISTINDX                                        2245
         L     @14,@PC00033                                        2245
         CH    @15,DEPTH(,@14)                                     2245
         BNH   @DL02243                                            2245
*              ARRYDSPL=ARRYDSPL+FACTOR*PTRLNGTH*(REPCOUNT(INDEX)-1);
         LH    @01,FACTOR                                          2246
         SLA   @01,2                                               2246
         LH    @15,INDEX                                           2246
         LR    @14,@15                                             2246
         ALR   @14,@14                                             2246
         LH    @14,REPCOUNT-2(@14)                                 2246
         BCTR  @14,0                                               2246
         MR    @00,@14                                             2246
         AH    @01,ARRYDSPL                                        2246
         STH   @01,ARRYDSPL                                        2246
*            END;                                                  2247
*                                                                  2247
         AL    @15,@CF00172                                        2247
@DE02241 STH   @15,INDEX                                           2247
         L     @14,@PC00033                                        2247
         CH    @15,DEPTH(,@14)                                     2247
         BNH   @DL02241                                            2247
*        /************************************************************/
*        /*                                                          */
*        /* IF THE DATA POINTER IS FOR A PARAMETER IN A REPEATED     */
*        /* PARAMETER LIST (1ST LEVEL OF REPEATEDNESS), THEN THE     */
*        /* POINTER VECTOR IS BEING MAINTAINED AS A LIST OF VECTOR   */
*        /* BLOCKS.  SET UP TO POINT TO THE PROPER DATA POINTER IN   */
*        /* THE PROPER BLOCK IN THE LIST.                            */
*        /*                                                          */
*        /************************************************************/
*        IF DEPTH=1                                                2248
*          THEN                                                    2248
@RC02239 LA    @15,1                                               2248
         L     @14,@PC00033                                        2248
         CH    @15,DEPTH(,@14)                                     2248
         BNE   @RF02248                                            2248
*            DO;                                                   2249
*              OLDERID2 = NEWERID2;                                2250
         L     @01,GDTPTR                                          2250
         L     @14,GDTTR2(,@01)                                    2250
         MVC   @TS00001(95),NEWERID2(@14)                          2250
         MVC   OLDERID2(95,@14),@TS00001                           2250
*              NEWID2='RI66';                                      2251
         MVC   NEWID2(4,@14),@CC01278                              2251
*              VECTRNUM=ARRYDSPL/VECTRLEN+1;                       2252
         LH    @14,ARRYDSPL                                        2252
         LH    @05,VECTRLEN                                        2252
         LR    @00,@14                                             2252
         SRDA  @00,32                                              2252
         DR    @00,@05                                             2252
         ALR   @01,@15                                             2252
         STH   @01,VECTRNUM                                        2252
*              ARRYDSPL=ARRYDSPL//VECTRLEN;                        2253
         SRDA  @14,32                                              2253
         DR    @14,@05                                             2253
         STH   @14,ARRYDSPL                                        2253
*              DO INDEX2=1 TO VECTRNUM-1;                          2254
         LA    @15,1                                               2254
         B     @DE02254                                            2254
@DL02254 DS    0H                                                  2255
*                ARRYPTR=VECTRPTR;                                 2255
         LH    @14,VECTRLEN                                        2255
         AL    @14,ARRYPTR                                         2255
         L     @14,VECTRPTR(,@14)                                  2255
         ST    @14,ARRYPTR                                         2255
*              END;                                                2256
         AL    @15,@CF00172                                        2256
@DE02254 STH   @15,INDEX2                                          2256
         LH    @14,VECTRNUM                                        2256
         BCTR  @14,0                                               2256
         CR    @15,@14                                             2256
         BNH   @DL02254                                            2256
*            END;                                                  2257
*                                                                  2257
*        END DSPLCALC;                                             2258
@EL00033 DS    0H                                                  2258
@EF00033 DS    0H                                                  2258
@ER00033 LM    @14,@12,@SA00033                                    2258
         BR    @14                                                 2258
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - ERROR1                                         */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE HANDLES A SYNTAX OR SEMANTIC ERROR WHICH*/
*/*             REQUIRES SKIPPING OF THE CURRENT INPUT COMMAND. THIS */
*/*             TYPE OF ERROR WILL ALLOW SCANNING TO CONTINUE WITH   */
*/*             THE NEXT COMMAND.  THE ERROR MESSAGE CONSISTS        */
*/*             ENTIRELY OF STATIC TEXT.                             */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          ERRCODE1- ERROR CODE WHICH IDENTIFIES THE ERROR AND     */
*/*                    WILL BE USED AS PART OF THE MESSAGE ID        */
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT RECORD IS BEING    */
*/*                    SCANNED FOR SYNTAX CHECKING PURPOSES ONLY     */
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT CURRENT COMMAND  */
*/*                    HAS BEEN SKIPPED                              */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PRINTED ERROR MESSAGE.                                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO THE ERROR    */
*/*                    CODE VALUE                                    */
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */
*/*          SCANONLY- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*ERROR1: PROCEDURE(ERRCODE1);                                      2259
ERROR1   STM   @14,@12,@SA00034                                    2259
         MVC   @PC00034(4),0(@01)                                  2259
*        /************************************************************/
*        /*                                                          */
*        /* ERROR1 PROCEDURE DATA DEFINITIONS                        */
*        /*                                                          */
*        /************************************************************/
*        DCL ERRCODE1 FIXED(31);       /*STATIC ERROR MESSAGE CODE   */
*        /************************************************************/
*        /*                                                          */
*        /*  ** ERROR1 **  HANDLE SYNTAX OR SEMANTIC ERROR           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2261
*          THEN;                                                   2261
         L     @01,GDTPTR                                          2261
         L     @15,GDTDBG(,@01)                                    2261
         LTR   @15,@15                                             2261
         BZ    @RT02261                                            2261
*          ELSE                                                    2263
*            CALL ICKDB010(GDTTBL,'RIE1');                         2263
*                                                                  2263
         L     @15,GDTPTR                                          2263
         ST    @15,@AL00001                                        2263
         LA    @14,@CC01284                                        2263
         ST    @14,@AL00001+4                                      2263
         MVI   @AL00001+4,X'80'                                    2263
         L     @15,GDTDBG(,@15)                                    2263
         LA    @01,@AL00001                                        2263
         BALR  @14,@15                                             2263
*        IF SCANONLY=NO                                            2264
*          THEN                                                    2264
@RT02261 TM    SCANONLY,B'00010000'                                2264
         BNZ   @RF02264                                            2264
*            LASTCC=BADERROR;                                      2265
         MVC   LASTCC(2),@CH00038                                  2265
*        RISTATUS=ERRCODE1;                                        2266
@RF02264 L     @15,@PC00034                                        2266
         L     @15,ERRCODE1(,@15)                                  2266
         STH   @15,RISTATUS                                        2266
*        IF ERRCODE1^=NOSPACE                                      2267
*          THEN                                                    2267
         CH    @15,@CH00278                                        2267
         BE    @RF02267                                            2267
*            DO;                                                   2268
*            DARGSMOD=RISTID;                                      2269
         L     @14,DDSTRU                                          2269
         MVC   DARGSMOD(3,@14),RISTID                              2269
*            DARGSENT=ERRCODE1;                                    2270
         STC   @15,DARGSENT(,@14)                                  2270
*            END;                                                  2271
*          ELSE                                                    2272
*            DO;                                                   2272
         B     @RC02267                                            2272
@RF02267 DS    0H                                                  2273
*            DARGSMOD='UV0';                                       2273
         L     @15,DDSTRU                                          2273
         MVC   DARGSMOD(3,@15),@CC01285                            2273
*            DARGSENT=4;                                           2274
         MVI   DARGSENT(@15),X'04'                                 2274
*            END;                                                  2275
*                                                                  2275
*        CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);                     2276
*                                                                  2276
@RC02267 L     @15,GDTPTR                                          2276
         ST    @15,@AL00001                                        2276
         LA    @14,@CF00102                                        2276
         ST    @14,@AL00001+4                                      2276
         LA    @14,DDSTRU                                          2276
         ST    @14,@AL00001+8                                      2276
         MVI   @AL00001+8,X'80'                                    2276
         L     @15,GDTPRT(,@15)                                    2276
         LA    @01,@AL00001                                        2276
         BALR  @14,@15                                             2276
*        /************************************************************/
*        /*                                                          */
*        /* SCAN UP TO THE NEXT COMMAND FOLLOWING THE COMMAND THAT   */
*        /* CONTAINS THE ERROR, IF THIS HAS NOT ALREADY BEEN DONE.   */
*        /*                                                          */
*        /************************************************************/
*        IF SKIPPAST=NO                                            2277
*          THEN                                                    2277
         TM    SKIPPAST,B'00001000'                                2277
         BNZ   @RF02277                                            2277
*            DO;                                                   2278
*                                                                  2278
*              CALL SKIPCMD;                                       2279
*                                                                  2279
         BAL   @14,SKIPCMD                                         2279
*              DO WHILE(MORTOCOM=YES & RISTATUS^=EOFILE &          2280
*                       RISTATUS^=SKIPREST);                       2280
*                                                                  2280
         B     @DE02280                                            2280
@DL02280 DS    0H                                                  2281
*                CALL NEXTCHAR;                                    2281
         BAL   @14,NEXTCHAR                                        2281
*                CALL SKIPCMD;                                     2282
*                                                                  2282
         BAL   @14,SKIPCMD                                         2282
*              END;                                                2283
@DE02280 TM    MORTOCOM,B'00010000'                                2283
         BNO   @DC02280                                            2283
         LH    @15,RISTATUS                                        2283
         CH    @15,@CH00118                                        2283
         BE    @DC02280                                            2283
         CH    @15,@CH00042                                        2283
         BNE   @DL02280                                            2283
@DC02280 DS    0H                                                  2284
*            END;                                                  2284
*                                                                  2284
*        END ERROR1;                                               2285
@EL00034 DS    0H                                                  2285
@EF00034 DS    0H                                                  2285
@ER00034 LM    @14,@12,@SA00034                                    2285
         BR    @14                                                 2285
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - ERROR2                                         */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE HANDLES A SYNTAX OR SEMANTIC ERROR      */
*/*             WHICH REQUIRES SKIPPING OF THE CURRENT INPUT COMMAND.*/
*/*             THIS TYPE OF ERROR WILL ALLOW SCANNING TO CONTINUE   */
*/*             WITH THE NEXT COMMAND.  THE ERROR MESSAGE CONSISTS   */
*/*             OF STATIC TEXT WITH AN ITEM FROM THE COMMAND TO HELP */
*/*             IDENTIFY THE SOURCE OF THE ERROR.                    */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*          ERRCODE2- ERROR CODE WHICH IDENTIFIES THE ERROR AND     */
*/*                    WHICH IS USED AS PART OF THE MESSAGE ID.      */
*/*          INSRTLEN- LENGTH OF THE COMMAND ITEM TO BE INSERTED     */
*/*                    INTO THE MESSAGE                              */
*/*          INSRTPTR- POINTER TO THE COMMAND ITEM TO BE INSERTED    */
*/*                    INTO THE MESSAGE.                             */
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT RECORD IS BEING    */
*/*                    SCANNED FOR SYNTAX CHECKING PURPOSES ONLY.    */
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT CURRENT COMMAND  */
*/*                    HAS BEEN SKIPPED.                             */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*          PRINTED ERROR MESSAGE.                                  */
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO THE NON-ZERO */
*/*                    ERROR MESSAGE CODE VALUE                      */
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */
*/*          SCANONLY- SEE 'INPUT'                                   */
*/*                                                                  */
*/********************************************************************/
*ERROR2: PROCEDURE(ERRCODE2,           /*STATIC ERROR MESSAGE ID#    */
*                  INSRTLEN,           /*INSERT DATA ITEM LENGTH     */
*                  INSRTPTR);          /*INSERT DATA ITEM ADDRESS    */
ERROR2   STM   @14,@12,@SA00035                                    2286
         MVC   @PC00035(12),0(@01)                                 2286
*        /************************************************************/
*        /*                                                          */
*        /* ERROR2 PROCEDURE DATA DEFINITIONS                        */
*        /*                                                          */
*        /************************************************************/
*        DCL ERRCODE2 FIXED(31);       /*STATIC ERROR MESSAGE CODE   */
*        DCL INSRTLEN FIXED(31);       /*LENGTH OF DATA ITEM TO BE 2288
*                                        INSERTED INTO ERROR MESSAGE */
*        DCL INSRTPTR PTR(31);         /*PTR TO DATA ITEM TO BE    2289
*                                        INSERTED INTO ERROR MESSAGE */
*        /************************************************************/
*        /*                                                          */
*        /*  ** ERROR2 **  HANDLE SYNTAX OR SEMANTIC ERROR           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       2290
*          THEN;                                                   2290
         L     @01,GDTPTR                                          2290
         L     @15,GDTDBG(,@01)                                    2290
         LTR   @15,@15                                             2290
         BZ    @RT02290                                            2290
*          ELSE                                                    2292
*            CALL ICKDB010(GDTTBL,'RIE2');                         2292
*                                                                  2292
         L     @15,GDTPTR                                          2292
         ST    @15,@AL00001                                        2292
         LA    @14,@CC01295                                        2292
         ST    @14,@AL00001+4                                      2292
         MVI   @AL00001+4,X'80'                                    2292
         L     @15,GDTDBG(,@15)                                    2292
         LA    @01,@AL00001                                        2292
         BALR  @14,@15                                             2292
*        IF SCANONLY=NO                                            2293
*          THEN                                                    2293
@RT02290 TM    SCANONLY,B'00010000'                                2293
         BNZ   @RF02293                                            2293
*            LASTCC=BADERROR;                                      2294
         MVC   LASTCC(2),@CH00038                                  2294
*        RISTATUS=ERRCODE2;                                        2295
@RF02293 L     @15,@PC00035                                        2295
         L     @15,ERRCODE2(,@15)                                  2295
         STH   @15,RISTATUS                                        2295
*        DARGDBP=INSRTPTR;                                         2296
         L     @14,DDSTRU                                          2296
         L     @05,@PC00035+8                                      2296
         MVC   DARGDBP(4,@14),INSRTPTR(@05)                        2296
*        DARGILP=INSRTLEN;                                         2297
         L     @05,@PC00035+4                                      2297
         MVC   DARGILP(2,@14),INSRTLEN+2(@05)                      2297
*        DARGSMOD=RISTID;                                          2298
         MVC   DARGSMOD(3,@14),RISTID                              2298
*        DARGSENT=ERRCODE2;                                        2299
*                                                                  2299
         STC   @15,DARGSENT(,@14)                                  2299
*        CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);                     2300
*                                                                  2300
         L     @15,GDTPTR                                          2300
         ST    @15,@AL00001                                        2300
         LA    @14,@CF00102                                        2300
         ST    @14,@AL00001+4                                      2300
         LA    @14,DDSTRU                                          2300
         ST    @14,@AL00001+8                                      2300
         MVI   @AL00001+8,X'80'                                    2300
         L     @15,GDTPRT(,@15)                                    2300
         LA    @01,@AL00001                                        2300
         BALR  @14,@15                                             2300
*        /************************************************************/
*        /*                                                          */
*        /* SCAN UP TO THE NEXT COMMAND FOLLOWING THE COMMAND THAT   */
*        /* CONTAINS THE ERROR, IF THIS HAS NOT ALREADY BEEN DONE.   */
*        /*                                                          */
*        /************************************************************/
*        IF SKIPPAST=NO                                            2301
*          THEN                                                    2301
         TM    SKIPPAST,B'00001000'                                2301
         BNZ   @RF02301                                            2301
*            DO;                                                   2302
*                                                                  2302
*              CALL SKIPCMD;                                       2303
*                                                                  2303
         BAL   @14,SKIPCMD                                         2303
*              DO WHILE(MORTOCOM=YES & RISTATUS^=EOFILE &          2304
*                       RISTATUS^=SKIPREST);                       2304
*                                                                  2304
         B     @DE02304                                            2304
@DL02304 DS    0H                                                  2305
*                CALL NEXTCHAR;                                    2305
         BAL   @14,NEXTCHAR                                        2305
*                CALL SKIPCMD;                                     2306
*                                                                  2306
         BAL   @14,SKIPCMD                                         2306
*              END;                                                2307
@DE02304 TM    MORTOCOM,B'00010000'                                2307
         BNO   @DC02304                                            2307
         LH    @15,RISTATUS                                        2307
         CH    @15,@CH00118                                        2307
         BE    @DC02304                                            2307
         CH    @15,@CH00042                                        2307
         BNE   @DL02304                                            2307
@DC02304 DS    0H                                                  2308
*            END;                                                  2308
*                                                                  2308
*        END ERROR2;                                               2309
*                                                                  2309
*                                                                  2309
@EL00035 DS    0H                                                  2309
@EF00035 DS    0H                                                  2309
@ER00035 LM    @14,@12,@SA00035                                    2309
         BR    @14                                                 2309
*        END ICKRI01                                               2310
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF05 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF06 )                                        *
*;                                                                 2310
@DATA    DS    0H
@CH00260 DC    H'5'
@CH00043 DC    H'7'
@CH00274 DC    H'16'
@CH00298 DC    H'28'
@CH00300 DC    H'29'
@CH00302 DC    H'30'
@CH00054 DC    H'31'
@CH00218 DC    H'32'
@CH00306 DC    H'33'
@CH00860 DC    H'38'
@CH01296 DC    H'66'
@CH00800 DC    H'72'
@CH00118 DC    H'100'
@CH00681 DC    H'255'
@CH01070 DC    H'-1'
@SM01319 MVC   DATABLK(0,@14),DATABLK(@03)
@SM01324 MVC   0(0,@14),SYNUNIT
@SC01326 CLC   RELATION(0),MAXCCSYM(@15)
@SC01328 CLC   RELATION(0),LSTCCSYM(@15)
@SM01330 MVC   SYNUNIT(0),0(@01)
@SM01332 MVC   RELOPER(0),0(@01)
@SC01338 CLC   KWDITEM(0,@15),SYNUNIT
@SM01341 MVC   CHARS(0,@14),SYNUNIT
@SM01343 MVC   STRING(0,@15),SYNUNIT
@SM01345 MVC   LCHAR(0,@14),SYNUNIT
@SM01347 MVC   LSTRING(0,@15),SYNUNIT
@SM01351 MVC   CNVRTFLD(0),SYNUNIT
@SM01353 MVC   0(0,@14),CNVRTFLD
@SM01355 MVC   STRING+1(0,@05),DATABLK(@04)
@SM01357 MVC   STRING(0,@01),SYNUNIT
@SM01359 MVC   LSTRING+1(0,@15),DATABLK(@14)
@SM01363 MVC   LMEMNAME-14(0,@14),0(@01)
@SM01365 MVC   MEMNAME(0,@15),0(@01)
@SM01370 MVC   LDSNAME-23(0,@14),SYNUNIT
@SM01372 MVC   DSNAME(0,@14),SYNUNIT
@SM01374 MVC   DATABLK(0,@05),DATABLK(@03)
@SM01377 MVC   SYNUNIT(0),DEFLTVAL+2(@15)
@SM01379 MVC   SYNUNIT(0),DEFLTVAL(@15)
@SM01381 MVC   ERRFIELD(0),KWDITEM(@15)
@SM01383 MVC   ERRFIELD(0),SYNUNIT
@SM01385 MVC   0(0,@04),SYNUNIT
         DS    0F
@AL00419 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00574 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00576 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00669 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00685 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00771 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00839 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00845 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00886 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00917 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00975 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00980 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01006 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01035 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01607 DC    A(@CB00475)             LIST WITH   1 ARGUMENT(S)
@AL00512 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00532 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00667 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00992 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01020 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01048 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01111 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01117 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01128 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01134 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01583 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01652 DC    A(@CB00473)             LIST WITH   1 ARGUMENT(S)
@AL00525 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL02041 DC    A(@CF00127)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00172)
@AL00551 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00575 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00668 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00684 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00770 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00838 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00844 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00885 DC    A(@CF00172)             LIST WITH   1 ARGUMENT(S)
@AL00673 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL02032 DC    A(@CF00282)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@AL00977 DC    A(@CF00041)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@AL00989 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01045 DC    A(@CF00040)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@AL01022 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01991 DC    A(@CF00038)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@AL01051 DC    A(@CF00269)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@AL01090 DC    A(@CF00174)             LIST WITH   1 ARGUMENT(S)
@AL01110 DC    A(@CF00144)             LIST WITH   1 ARGUMENT(S)
@AL01120 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01137 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00492 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01527 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01557 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01632 DC    A(@CF00278)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00282)
@AL01158 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01475 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01127 DC    A(@CF00052)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00282)
@AL01166 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01181 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01221 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01246 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01273 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01310 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01376 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01938 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01969 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL02015 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00929 DC    A(@CF00124)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00282)
@AL01205 DC    A(@CF00290)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@AL01279 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01327 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01339 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01351 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01934 DC    A(@CF00284)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@AL01368 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01936 DC    A(@CF00286)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@AL01611 DC    A(@CF00280)             LIST WITH   1 ARGUMENT(S)
@AL01666 DC    A(@CF00039)             LIST WITH   1 ARGUMENT(S)
@AL01910 DC    A(@CF00271)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00282)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    6F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00029 DS    15F
@PC00029 DS    1F
@SA00034 DS    15F
@PC00034 DS    1F
@SA00035 DS    15F
@PC00035 DS    3F
@SA00021 DS    15F
@SA00023 DS    15F
@SA00030 DS    15F
@SA00025 DS    15F
@SA00009 DS    15F
@SA00010 DS    15F
@SA00020 DS    15F
@SA00028 DS    15F
@PC00028 DS    1F
@SA00006 DS    15F
@SA00005 DS    15F
@SA00008 DS    15F
@SA00007 DS    15F
@SA00027 DS    15F
@SA00026 DS    15F
@SA00011 DS    15F
@SA00033 DS    15F
@PC00033 DS    1F
@SA00013 DS    15F
@SA00012 DS    15F
@SA00014 DS    15F
@SA00018 DS    15F
@SA00015 DS    15F
@SA00016 DS    15F
@SA00019 DS    15F
@SA00017 DS    15F
@SA00022 DS    15F
@PC00022 DS    1F
@SA00024 DS    15F
@PC00024 DS    2F
@SA00031 DS    15F
@SA00032 DS    15F
@AL00001 DS    5A
@TF00001 DS    F
@AFTEMPS DS    13F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICKRI01  CSECT
         DS    0F
@CF00102 DC    F'0'
@CH00102 EQU   @CF00102+2
@CF00172 DC    F'1'
@CH00172 EQU   @CF00172+2
@CF00124 DC    F'2'
@CH00124 EQU   @CF00124+2
@CF00144 DC    F'3'
@CH00144 EQU   @CF00144+2
@CF00052 DC    F'4'
@CH00052 EQU   @CF00052+2
@CF00127 DC    F'6'
@CH00127 EQU   @CF00127+2
@CF00042 DC    F'8'
@CH00042 EQU   @CF00042+2
@CF00041 DC    F'9'
@CF00040 DC    F'10'
@CH00040 EQU   @CF00040+2
@CF00039 DC    F'11'
@CF00038 DC    F'12'
@CH00038 EQU   @CF00038+2
@CF00269 DC    F'13'
@CF00271 DC    F'14'
@CF00174 DC    F'15'
@CF00278 DC    F'18'
@CH00278 EQU   @CF00278+2
@CF00280 DC    F'19'
@CF00282 DC    F'20'
@CH00282 EQU   @CF00282+2
@CF00284 DC    F'21'
@CH00284 EQU   @CF00284+2
@CF00286 DC    F'22'
@CF00290 DC    F'24'
@CF00294 DC    F'26'
@CF00296 DC    F'27'
@CF01297 DC    F'36'
@CF00685 DC    F'48'
@CF01349 DC    F'-64'
@CF01350 DC    F'-63'
@CF01367 DC    F'-55'
@CF01361 DC    F'-53'
@CF01362 DC    F'-52'
@CF01368 DC    F'-44'
@CF01369 DC    F'-43'
@CF01317 DC    F'-12'
@CF01376 DC    F'-8'
@CF01318 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
GRPPTR   DS    A
KWDPTR   DS    A
DATAPTR  DS    A
PTRLOC   DS    A
ARRYPTR  DS    A
AMTTOGET DS    F
BLKLEFT  DS    F
BLKPTR   DS    A
GDTPTR   DS    A
WORKPTR2 DS    A
WORKPTR3 DS    A
SETUPERR DS    F
ELTPTR   DS    A
WORKVAL  DS    F
OLDPTR   DS    A
FREEPTR  DS    A
NEWPTR   DS    A
SUBOCCUR DS    F
DEFLTPTR DS    A
LISTPTR  DS    A
TESTRC   DS    H
PARMID   DS    H
TESTID   DS    H
ARRYDSPL DS    H
REPNEST  DS    H
VECTRNUM DS    H
UNITINDX DS    H
SCLRCNT  DS    H
PWORD    DS    H
PARMLVL  DS    H
REPDEPTH DS    H
SPACELFT DS    H
SPACEAMT DS    H
INDEX    DS    H
INDEX2   DS    H
INDEX3   DS    H
LISTINDX DS    H
HWORDARG DS    H
RELSIZE  DS    H
PART1LEN DS    H
CCVALUE  DS    H
DIGITPOS DS    H
SUBTOTAL DS    H
WORKVAR1 DS    H
TWOPOWER DS    H
DIGTINDX DS    H
SEGSTART DS    H
SEGEND   DS    H
SEGLEN   DS    H
MOVELEN  DS    H
AMTUSED  DS    H
WORKVAR2 DS    H
WORKVAR3 DS    H
PARENCNT DS    H
FACTOR   DS    H
DATALEN  DS    H
SETRC    DS    H
CNVRTVAL DS    FL1
STARLOC  DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
COMMAREA DS    CL55
         ORG   COMMAREA
RECRDPTR DS    AL4
FDTADDR  DS    AL4
DESCPTR  DS    AL4
WORKPTR  DS    AL4
RISTATUS DS    FL2
SCANINDX DS    FL2
SCNLIMIT DS    FL2
LASTCC   DS    FL2
MAXCC    DS    FL2
FSRLNAME DS    CL8
POOLID   DS    CL4
VERBNAME DS    CL8
DESCNAME DS    CL8
GOODCMD  DS    BL1
EOFOK    EQU   COMMAREA+54
OPTSFLAG EQU   COMMAREA+54
SCANONLY EQU   COMMAREA+54
SKIPPAST EQU   COMMAREA+54
@NM00018 EQU   COMMAREA+54
         ORG   COMMAREA+55
         DS    CL1
RIPOOLID DS    CL4
         ORG   RIPOOLID
VLISTID1 DS    CL2
VLISTID  DS    FL2
         ORG   RIPOOLID+4
ORGSIGN  DS    CL1
         DS    CL3
SYNUNIT  DS    CL255
BLANKFLD DS    CL10
ERRFIELD DS    CL20
CHAR1    DS    CL1
CHAR2    DS    CL1
         DS    CL5
CNVRTFLD DS    CL10
SCANSWS  DS    CL2
         ORG   SCANSWS
PWORDSW  DS    BL1
COMMENT  EQU   SCANSWS+0
INCOMM   EQU   SCANSWS+0
MORTOCOM EQU   SCANSWS+0
CONTNEXT EQU   SCANSWS+0
FIRSTCHR EQU   SCANSWS+0
FINALCHR EQU   SCANSWS+0
JUSTONE  EQU   SCANSWS+0
ENDPAREN DS    BL1
NULLCMD  EQU   SCANSWS+1
FOUND    EQU   SCANSWS+1
SUBSYET  EQU   SCANSWS+1
DELIM    EQU   SCANSWS+1
         ORG   SCANSWS+2
OPENAREA DS    BL32
PRNTAREA DS    BL20
STMTEND  DS    BL1
RELATION DS    CL32
@NM00046 DS    CL1
         ORG   @NM00046
NONMODAL DS    BL1
REDOLVL0 EQU   @NM00046+0
EXPREND  EQU   @NM00046+0
SINGLCMD EQU   @NM00046+0
IFNEXT   EQU   @NM00046+0
GETVERB  EQU   @NM00046+0
         ORG   @NM00046+1
RELOPER  DS    CL2
KWDMATCH DS    BL1
ENDVALUE DS    BL1
CHSTRING DS    BL1
MEMBIT   DS    BL1
ONESTAR  DS    BL1
WITHMEM  DS    BL1
DFLTOK   DS    BL1
FOUNDONE DS    BL1
SKIPDONE DS    BL1
COMMASW  DS    BL1
ENDFOUND DS    BL1
SKIPLEAD DS    BL1
PRMFOUND DS    BL1
         DS    CL1
SUPERID  DS    10H
PPARMCNT DS    10H
REPCOUNT DS    3H
REPLIMIT DS    3H
ONEREP   DS    3BL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKRI01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00513 DC    V(ICKRI02)
@CV00514 DC    V(ICKRI03)
         DS    0D
VECTRLEN DC    AL2(4*9-4)
@CC00674 DC    C'2147483647'
@CC00153 DC    C'ZERO'
@CC00706 DC    C'RI01'
@CC00787 DC    C'RIEX'
@CC00815 DC    C'RISC'
@CC00836 DC    C'RI02'
@CC00842 DC    C'RI03'
@CC00868 DC    C'RIGN'
@CC00878 DC    C'RI04'
@CC00881 DC    C'RI05'
@CC00885 DC    C'RIMS'
@CC00917 DC    C'RIMI'
@CC00927 DC    C'RIME'
@CC00931 DC    C'RIBT'
@CC00941 DC    C'RI09'
@CC00956 DC    C'RIPP'
@CC00965 DC    C'RI11'
@CC00968 DC    C'RI12'
@CC00976 DC    C'RIGQ'
@CC01062 DC    C'RICV'
@CC01067 DC    C'RI24'
@CC01073 DC    C'RI27'
@CC01076 DC    C'RI30'
@CC01102 DC    C'RIID'
@CC01111 DC    C'RINS'
@CC01125 DC    C'RIMC'
@CC01133 DC    C'RIIR'
@CC01134 DC    C'RI35'
@CC01145 DC    C'RI36'
@CC01149 DC    C'RIDF'
@CC01171 DC    C'RIST'
@CC01174 DC    C'RI44'
@CC01178 DC    C'RI45'
@CC01186 DC    C'RINN'
@CC01213 DC    C'RISK'
@CC01217 DC    C'RISF'
@CC01222 DC    C'RIPC'
@CC01230 DC    C'RI49'
@CC01231 DC    C'RI50'
@CC01234 DC    C'RI51'
@CC01245 DC    C'RI56'
@CC01248 DC    C'RI57'
@CC01252 DC    C'RI59'
@CC01256 DC    C'RIGR'
@CC01263 DC    C'RISE'
@CC01266 DC    C'RI60'
@CC01269 DC    C'RI61'
@CC01270 DC    C'RI62'
@CC01277 DC    C'RICK'
@CC01278 DC    C'RI66'
@CC01284 DC    C'RIE1'
@CC01295 DC    C'RIE2'
@CC01285 DC    C'UV0'
@CC00788 EQU   @CC00706
@CC00853 DC    C'EQ'
@CC00900 DC    C'GT'
@CC00904 DC    C'LT'
@CC00906 DC    C'^='
@CC00908 DC    C'NE'
@CC00910 DC    C'>='
@CC00912 DC    C'GE'
@CC00914 DC    C'<='
@CC00916 DC    C'LE'
@CB00473 DC    B'10000000'
@CB00475 DC    B'00000000'
COMSTART DC    CL2'/*'
COMEND   DC    CL2'*/'
MODID    DC    CL4'RI01'
FIXAREA  DS    CL1024
         ORG   FIXAREA
@NM00038 DS    CL256
         ORG   @NM00038
@NM00039 DC    256X'00'
         ORG   FIXAREA+256
@NM00040 DS    CL256
         ORG   @NM00040
@NM00041 DC    256X'00'
         ORG   FIXAREA+512
@NM00042 DS    CL256
         ORG   @NM00042
@NM00043 DC    256X'00'
         ORG   FIXAREA+768
@NM00044 DS    CL256
         ORG   @NM00044
@NM00045 DC    256X'00'
         ORG   FIXAREA+1024
LTBLNAME DC    CL8'ICKRILT '
KTBLNAME DC    CL8'ICKRIKT '
TWLVZERO DS    CL1
         ORG   TWLVZERO
@NM00055 DC    XL1'C0'
         ORG   TWLVZERO+1
HEXTABLE DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
CVBNUM   EQU   @08
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
GDTTBL   EQU   0
GDTPRM   EQU   GDTTBL+4
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTRIH   EQU   GDTTBL+24
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
ICKSALD0 EQU   0
ICKSAEP0 EQU   0
ICKSAGS0 EQU   0
ICKSAFS0 EQU   0
ICKSAGP0 EQU   0
ICKSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
ICKIOOP0 EQU   0
ICKIOGT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNTYPSI EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNIOC   EQU   OPNAGL+4
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
ICKTPPR0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
HDAREA   EQU   0
LEFTMGN  EQU   HDAREA
RIGHTMGN EQU   HDAREA+2
LOADTPTR EQU   HDAREA+4
KWTBLPTR EQU   HDAREA+8
ADDRIOCS EQU   HDAREA+12
NESTLVL  EQU   HDAREA+16
MODLFLGS EQU   HDAREA+18
NULLDO   EQU   MODLFLGS
DOFLAG   EQU   MODLFLGS+1
THENFLAG EQU   MODLFLGS+1
ELSEFLAG EQU   MODLFLGS+1
SKIPFLAG EQU   MODLFLGS+1
VERBDATA EQU   0
MAXID    EQU   VERBDATA+10
POSDSPL  EQU   VERBDATA+20
DGRPDSPL EQU   VERBDATA+21
VNGRPDSP EQU   VERBDATA+22
NTGRPDSP EQU   VERBDATA+23
@NM00020 EQU   0
VPOSCNT  EQU   @NM00020
VPOSID   EQU   @NM00020+2
DGRPTOT  EQU   0
@NM00021 EQU   0
DGRPCNT  EQU   @NM00021
DGRPID   EQU   @NM00021+2
VNGRPTOT EQU   0
@NM00022 EQU   0
VNGRPCNT EQU   @NM00022
VNGRPID  EQU   @NM00022+2
@NM00023 EQU   0
NTGRPCNT EQU   @NM00023
NTGRPID  EQU   @NM00023+2
PARMDATA EQU   0
OCCURNUM EQU   PARMDATA+1
IDDSPL   EQU   PARMDATA+4
KWDDSPL  EQU   PARMDATA+5
NOTDSPL  EQU   PARMDATA+6
NGRPDSPL EQU   PARMDATA+7
PDEDSPL  EQU   PARMDATA+8
SCLRDATA EQU   PARMDATA+11
LEVEL1   EQU   PARMDATA+11
REPEATED EQU   PARMDATA+11
SCALAR   EQU   PARMDATA+11
LIST     EQU   PARMDATA+11
DEFAULT  EQU   PARMDATA+11
SUBLIST  EQU   PARMDATA+11
DSCRPTR1 EQU   0
SUBDSPL  EQU   DSCRPTR1+2
REPMAX   EQU   DSCRPTR1+3
DSCRPTR2 EQU   0
HIVALUE  EQU   DSCRPTR2
LOWVALUE EQU   DSCRPTR2+4
MAXLNGTH EQU   DSCRPTR2+8
LISTMAX  EQU   DSCRPTR2+9
NUMBER   EQU   DSCRPTR2+11
ANYSTRNG EQU   DSCRPTR2+11
DSNAM    EQU   DSCRPTR2+11
GENERIC  EQU   DSCRPTR2+11
VOLID    EQU   DSCRPTR2+11
PWORDOPT EQU   DSCRPTR2+11
DEFLT    EQU   0
DEFLTLEN EQU   DEFLT
DEFLTVAL EQU   DEFLT+1
@NM00028 EQU   0
@NM00029 EQU   @NM00028+2
KWDCOUNT EQU   0
@NM00030 EQU   0
KWDLEN   EQU   @NM00030
KWDITEM  EQU   @NM00030+1
@NM00031 EQU   0
SUBCOUNT EQU   @NM00031
@NM00032 EQU   @NM00031+2
PARMTYPE EQU   @NM00032
SUBID    EQU   @NM00032+2
NGRPTOT  EQU   0
@NM00033 EQU   0
NGRPCNT  EQU   @NM00033
NGRPID   EQU   @NM00033+2
@NM00034 EQU   0
NOTCOUNT EQU   @NM00034
NOTID    EQU   @NM00034+2
@NM00035 EQU   0
@NM00036 EQU   @NM00035+2
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
PARMINFO EQU   0
PARMPTR  EQU   PARMINFO
NTGRPPTR EQU   PARMINFO+4
SUPRPARM EQU   PARMINFO+8
PARMFLAG EQU   PARMINFO+10
LISTADDR EQU   0
REPTOTAL EQU   0
REPPTR   EQU   0
VECTRPTR EQU   0
KWDTABLE EQU   0
PARMSYM  EQU   KWDTABLE+1
SETSYM   EQU   KWDTABLE+11
IFSYM    EQU   KWDTABLE+21
THENSYM  EQU   KWDTABLE+31
ELSESYM  EQU   KWDTABLE+41
DOSYM    EQU   KWDTABLE+51
ENDSYM   EQU   KWDTABLE+61
LSTCCLN  EQU   KWDTABLE+70
LSTCCSYM EQU   KWDTABLE+71
MAXCCLN  EQU   KWDTABLE+80
MAXCCSYM EQU   KWDTABLE+81
DATABLK  EQU   0
INREC    EQU   0
OPTSPTR  EQU   0
PARMOPTS EQU   0
OPTSLEN  EQU   PARMOPTS
FULLWORD EQU   0
@NM00047 EQU   0
STRINGLN EQU   @NM00047
STRING   EQU   @NM00047+1
@NM00048 EQU   0
PASSWDLN EQU   @NM00048
PASSWORD EQU   @NM00048+1
CHARLN   EQU   @NM00048+9
CHARS    EQU   @NM00048+10
@NM00049 EQU   0
DSPWDLN  EQU   @NM00049
DSPWORD  EQU   @NM00049+1
STARPOS  EQU   @NM00049+9
MEMNAMLN EQU   @NM00049+11
MEMNAME  EQU   @NM00049+12
DSNAMELN EQU   @NM00049+20
DSNAME   EQU   @NM00049+21
@NM00050 EQU   0
FULLWDCT EQU   @NM00050
LFULLWD  EQU   @NM00050+4
@NM00051 EQU   0
STRINGCT EQU   @NM00051
LSTRINGL EQU   @NM00051+2
LSTRING  EQU   @NM00051+3
@NM00052 EQU   0
CHARCT   EQU   @NM00052
LCHRPWDL EQU   @NM00052+2
LCHRPWD  EQU   @NM00052+3
LCHARLN  EQU   @NM00052+11
LCHAR    EQU   @NM00052+12
@NM00053 EQU   0
DSNAMECT EQU   @NM00053
@NM00054 EQU   @NM00053+2
LDSNPWDL EQU   @NM00054
LDSNPWD  EQU   @NM00054+1
LSTARPOS EQU   @NM00054+9
LMEMNAML EQU   @NM00054+11
LMEMNAME EQU   @NM00054+12
LDSNAMEL EQU   @NM00054+20
LDSNAME  EQU   @NM00054+21
DMPTRM   EQU   0
ICKDVCL0 EQU   0
ICKDVIN0 EQU   0
ICKDVON0 EQU   0
ICKDVOP0 EQU   0
ICKIOCL0 EQU   0
ICKIOIT0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSACL0 EQU   0
ICKSADE0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NTGRPTOT EQU   0
GDTTBLX  EQU   0
FDTLOC   EQU   0
SPACEID  EQU   0
DMSMAX   EQU   0
DMSLAST  EQU   0
FUNCNAME EQU   0
DFLTPARM EQU   0
ERRMSGID EQU   0
ERRPRMID EQU   0
FLDTYPE  EQU   0
WITHCOM  EQU   0
DEPTH    EQU   0
ERRCODE1 EQU   0
ERRCODE2 EQU   0
INSRTLEN EQU   0
INSRTPTR EQU   0
RISTID   EQU   MODID
DIGITVAL EQU   SYNUNIT
CNVRTWRD EQU   SYNUNIT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
LUNQTFLG EQU   @NM00054+10
UNQTFLG  EQU   @NM00049+10
ENDSMLN  EQU   KWDTABLE+60
DOSMLN   EQU   KWDTABLE+50
ELSESMLN EQU   KWDTABLE+40
THENSMLN EQU   KWDTABLE+30
IFSMLN   EQU   KWDTABLE+20
SETSMLN  EQU   KWDTABLE+10
PARMSMLN EQU   KWDTABLE
@NM00037 EQU   PARMINFO+11
FDTVERB  EQU   FDTTBL
PDEOFST2 EQU   @NM00036+4
PDEPCLID EQU   @NM00036+2
PDEPRMID EQU   @NM00036
PDECNT   EQU   @NM00035
PDEOFST1 EQU   @NM00029+2
IDNUM    EQU   @NM00029
ICKOUNT  EQU   @NM00028
@NM00027 EQU   DSCRPTR2+11
USERID   EQU   DSCRPTR2+11
@NM00026 EQU   DSCRPTR2+10
PCLDSPL2 EQU   DSCRPTR1
@NM00025 EQU   PARMDATA+11
@NM00024 EQU   PARMDATA+10
KWDGRPID EQU   PARMDATA+9
PDEFLEN  EQU   PARMDATA
LOADNAME EQU   VERBDATA+12
PARMCNT  EQU   VERBDATA+8
VDATALEN EQU   VERBDATA+6
PCLDSPL1 EQU   VERBDATA+4
DESCID   EQU   VERBDATA
@NM00019 EQU   MODLFLGS+1
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00354 EQU   @EL00002
@RF00377 EQU   @EL00002
@RC00372 EQU   @EL00002
@RC00516 EQU   @RC00502
@RT00514 EQU   @RC00502
@RC00524 EQU   @RC00523
@RC00530 EQU   @RC00523
@RF00529 EQU   @RC00523
@RC00544 EQU   @RC00540
@RC00591 EQU   @RC00584
@RC00589 EQU   @RC00584
@RC00587 EQU   @RC00584
@RC00585 EQU   @RC00584
@RC00598 EQU   @RC00597
@RC00617 EQU   @RC00616
@RC00628 EQU   @RC00614
@RF00713 EQU   @RC00708
@RF00732 EQU   @EL00005
@RF00735 EQU   @EL00005
@RF00803 EQU   @RC00798
@RC00841 EQU   @RC00840
@RC00846 EQU   @RC00840
@RC00853 EQU   @RC00840
@RT00865 EQU   @EL00006
@RF00864 EQU   @EL00006
@RT00900 EQU   @EL00007
@RF00899 EQU   @EL00007
@RF00912 EQU   @EL00008
@PB00008 EQU   @EL00004
@RT00971 EQU   @EL00009
@RF00930 EQU   @EL00009
@RC00968 EQU   @EL00009
@RT01036 EQU   @EL00010
@RC01032 EQU   @EL00010
@PB00010 EQU   @EL00003
@RC01083 EQU   @RC01082
@RC01114 EQU   @EL00012
@RF01113 EQU   @EL00012
@RF01112 EQU   @EL00012
@RC01131 EQU   @EL00013
@RF01130 EQU   @EL00013
@RF01129 EQU   @EL00013
@PB00013 EQU   @EL00011
@RC01154 EQU   @RC01153
@RC01272 EQU   @RC01271
@RF01282 EQU   @RC01271
@RC01377 EQU   @EL00015
@RC01375 EQU   @EL00015
@RC01366 EQU   @EL00015
@RF01365 EQU   @EL00015
@RC01454 EQU   @RC01453
@RF01487 EQU   @EL00017
@PB00017 EQU   @EL00016
@RC01556 EQU   @EL00019
@PB00019 EQU   @EL00014
@RC01631 EQU   @RC01620
@RC01655 EQU   @EL00020
@RC01646 EQU   @EL00020
@RC01604 EQU   @EL00020
@RF01749 EQU   @EL00022
@RF01759 EQU   @EL00022
@PB00022 EQU   @EL00021
@PB00024 EQU   @EL00023
@RC01886 EQU   @RC01885
@RF01918 EQU   @EL00026
@RC01912 EQU   @EL00026
@RC01931 EQU   @RC01928
@RF01939 EQU   @EL00027
@RC02039 EQU   @EL00028
@RC02056 EQU   @RC02055
@RC02099 EQU   @RC02091
@RF02227 EQU   @EL00032
@PB00032 EQU   @EL00031
@PB00031 EQU   @EL00030
@RF02248 EQU   @EL00033
@RF02277 EQU   @EL00034
@RF02301 EQU   @EL00035
@PB00035 EQU   @EL00001
@RF00620 EQU   @RC00617
@PB00007 EQU   @PB00008
@RC00973 EQU   @RC00968
@PB00009 EQU   @PB00010
@RC01038 EQU   @RC01032
@RC01088 EQU   @RC01083
@RF01087 EQU   @RC01083
@PB00012 EQU   @PB00013
@RC01369 EQU   @RC01366
@RC01367 EQU   @RC01366
@RC01462 EQU   @PB00017
@PB00018 EQU   @PB00019
@RC01610 EQU   @RC01604
@RF01659 EQU   @RC01655
@RC02065 EQU   @RC02056
@RC02057 EQU   @RC02056
@RC02084 EQU   @PB00031
@RF02135 EQU   @PB00031
@RC02146 EQU   @PB00032
@PB00034 EQU   @PB00035
@PB00006 EQU   @PB00007
@PB00004 EQU   @PB00009
@RC00976 EQU   @RC00973
@RC00982 EQU   @RC00973
@RF00981 EQU   @RC00973
@RF01000 EQU   @RC00973
@RC01042 EQU   @RC01038
@RF01041 EQU   @RC01038
@RC01463 EQU   @RC01462
@PB00016 EQU   @PB00018
@RC02058 EQU   @RC02057
@RC02147 EQU   @RC02146
@PB00033 EQU   @PB00034
@PB00005 EQU   @PB00006
@RC00986 EQU   @RC00982
@RF00985 EQU   @RC00982
@RC01043 EQU   @RC01042
@PB00015 EQU   @PB00016
@PB00030 EQU   @PB00033
@RC00987 EQU   @RC00986
@RC01201 EQU   @PB00015
@RC01163 EQU   @PB00015
@RC01247 EQU   @PB00015
@RC01245 EQU   @PB00015
@PB00029 EQU   @PB00030
@RC01164 EQU   @RC01163
@RF01182 EQU   @RC01163
@RC01196 EQU   @RC01163
@RC01184 EQU   @RC01163
@RC01239 EQU   @RC01201
@RC01223 EQU   @RC01201
@RF01222 EQU   @RC01201
@PB00028 EQU   @PB00029
@RC01167 EQU   @RC01164
@RC01165 EQU   @RC01164
@RC01186 EQU   @RC01184
@RF01236 EQU   @RC01223
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00023 EQU   @PB00025
@PB00021 EQU   @PB00023
@PB00020 EQU   @PB00021
@PB00014 EQU   @PB00020
@PB00011 EQU   @PB00014
@PB00003 EQU   @PB00011
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   ICKRI01,(C'PLS1726',0701,78192)

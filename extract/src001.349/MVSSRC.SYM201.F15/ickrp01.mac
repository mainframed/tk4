         TITLE '**********  ICKRP01:  RECLAIM PRIMARY TRACK  ***********
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
ICKRP01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'ICKRP01   78.192'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(28),0(@01)                                 0002
*                                                                  0176
         EJECT
*/*****  B E G I N    E X E C U T I O N  *****************************/
*                                                                  0177
*    IF GDTDBG = NULLPTR                                           0177
*      THEN;                                                       0177
         L     @10,@PC00001                                        0177
         L     @10,GDTDBG(,@10)                                    0177
         LTR   @10,@10                                             0177
         BZ    @RT00177                                            0177
*      ELSE                                                        0179
*        CALL ICKDB010 (GDTTBL                                     0179
*          ,'RP00');                                               0179
*                                                                  0179
*                                                                  0179
         L     @10,@PC00001                                        0179
         ST    @10,@AL00001                                        0179
         LA    @15,@CC00519                                        0179
         ST    @15,@AL00001+4                                      0179
         MVI   @AL00001+4,X'80'                                    0179
         L     @15,GDTDBG(,@10)                                    0179
         LA    @01,@AL00001                                        0179
         BALR  @14,@15                                             0179
*/*  OBTAIN ADDRESSES OF THE FIRST AND LAST ALT. TRACK               */
*/*   AND ALSO THE NUMBER OF TRACKS PER CYLINDER (UDEVINFO)          */
*    DO I = 1 TO INFOSET;                                          0180
*                                                                  0180
@RT00177 LA    I,1                                                 0180
@DL00180 DS    0H                                                  0181
*      CALL ICKDVIN0 (GDTTBL                                       0181
*               ,VOLIB                                             0181
*               ,INFOVECT (I)                                      0181
*               ,POOLID                                            0181
*               ,INFOPTR (I)                                       0181
*               ,INFOLEN (I)                                       0181
*               ,CCODE (I));                                       0181
         L     @10,@PC00001                                        0181
         ST    @10,@AL00001                                        0181
         L     @03,@PC00001+4                                      0181
         ST    @03,@AL00001+4                                      0181
         LR    @03,I                                               0181
         SLA   @03,2                                               0181
         LA    @15,INFOVECT-4(@03)                                 0181
         ST    @15,@AL00001+8                                      0181
         LA    @15,POOLID                                          0181
         ST    @15,@AL00001+12                                     0181
         LA    @15,INFOPTR-4(@03)                                  0181
         ST    @15,@AL00001+16                                     0181
         LA    @15,INFOLEN-4(@03)                                  0181
         ST    @15,@AL00001+20                                     0181
         LA    @03,CCODE-4(@03)                                    0181
         ST    @03,@AL00001+24                                     0181
         L     @15,GDTDIN(,@10)                                    0181
         LA    @01,@AL00001                                        0181
         BALR  @14,@15                                             0181
*    END;                                                          0182
         AH    I,@CH00169                                          0182
         CH    I,@CH00140                                          0182
         BNH   @DL00180                                            0182
*/*  SET CONDITION CODE TO INDICATE SUCCESSFUL COMPLETION INITIALLY  */
*    CONDCODE = SUCCEEDS;                                          0183
         L     @10,@PC00001+24                                     0183
         SLR   @15,@15                                             0183
         ST    @15,CONDCODE(,@10)                                  0183
*/*  READ STANDARD-LENGTH RECORD-ZERO (TO OBTAIN ASSOCIATION         */
*/*   IF ANY) (UDEVOP)                                               */
*    CALL ICKDVOP0 (GDTTBL                                         0184
*           ,VOLIB                                                 0184
*           ,ACTRDRZ                                               0184
*           ,PRCCHH                                                0184
*           ,RECNUM                                                0184
*           ,POOLID                                                0184
*           ,RZPTR                                                 0184
*           ,RZLEN                                                 0184
*           ,RETCODE);                                             0184
         L     @10,@PC00001                                        0184
         ST    @10,@AL00001                                        0184
         L     @15,@PC00001+4                                      0184
         ST    @15,@AL00001+4                                      0184
         LA    @15,@CF00120                                        0184
         ST    @15,@AL00001+8                                      0184
         L     @15,@PC00001+8                                      0184
         ST    @15,@AL00001+12                                     0184
         LA    @15,RECNUM                                          0184
         ST    @15,@AL00001+16                                     0184
         LA    @15,POOLID                                          0184
         ST    @15,@AL00001+20                                     0184
         LA    @15,RZPTR                                           0184
         ST    @15,@AL00001+24                                     0184
         LA    @15,RZLEN                                           0184
         ST    @15,@AL00001+28                                     0184
         LA    @15,RETCODE                                         0184
         ST    @15,@AL00001+32                                     0184
         L     @15,GDTDOP(,@10)                                    0184
         LA    @01,@AL00001                                        0184
         BALR  @14,@15                                             0184
*/*  IF READ OPERATION FAILS                                         */
*    IF RETCODE = CPFAILS                                          0185
*/*    THEN INDICATE RECLAMATION FAILS (CONDCODE = 3)                */
*      THEN DO;    CONDCODE = RECFAILU; END;                       0185
         CLC   RETCODE(4),@CF00048                                 0185
         BNE   @RF00185                                            0185
         L     @10,@PC00001+24                                     0187
         MVC   CONDCODE(4,@10),@CF00120                            0187
*/*    ELSE                                                          */
*      ELSE DO;                                                    0189
*                                                                  0189
         B     @RC00185                                            0189
@RF00185 DS    0H                                                  0190
*/*      IF THE DEFECT-FLAG IS SET DUE TO RECOVERY                   */
*        IF RETCODE = DFLAGONP                                     0190
*/*        THEN INDICATE RECLAMATION FAILS BUT TRACK RECOVERED       */
*          THEN DO;    CONDCODE = RECFAILS; END;                   0190
         CLC   RETCODE(4),@CF00120                                 0190
         BNE   @RF00190                                            0190
         L     @10,@PC00001+24                                     0192
         MVC   CONDCODE(4,@10),@CF00169                            0192
*/*      END-ELSE                                                    */
*        END;                                                      0194
@RF00190 DS    0H                                                  0195
*/*  IF NO ERRORS FOUND SO FAR                                       */
*    IF CONDCODE = SUCCEEDS                                        0195
*/*    THEN                                                          */
*      THEN DO;                                                    0195
*                                                                  0195
@RC00185 L     @10,@PC00001+24                                     0195
         L     @10,CONDCODE(,@10)                                  0195
         LTR   @10,@10                                             0195
         BNZ   @RF00195                                            0195
*/*      WRITE PRIMARY HOME-ADDRESS WITH DEFECT FLAG OFF (UDEVOP)    */
*        CALL ICKDVOP0 (GDTTBL                                     0197
*               ,VOLIB                                             0197
*               ,ACTWPHA                                           0197
*               ,PRCCHH                                            0197
*               ,RECNUM                                            0197
*               ,POOLID                                            0197
*               ,DUMMYPTR                                          0197
*               ,DUMMYLEN                                          0197
*               ,RETCODE);                                         0197
         L     @10,@PC00001                                        0197
         ST    @10,@AL00001                                        0197
         L     @15,@PC00001+4                                      0197
         ST    @15,@AL00001+4                                      0197
         LA    @15,@CF00048                                        0197
         ST    @15,@AL00001+8                                      0197
         L     @15,@PC00001+8                                      0197
         ST    @15,@AL00001+12                                     0197
         LA    @15,RECNUM                                          0197
         ST    @15,@AL00001+16                                     0197
         LA    @15,POOLID                                          0197
         ST    @15,@AL00001+20                                     0197
         LA    @15,DUMMYPTR                                        0197
         ST    @15,@AL00001+24                                     0197
         LA    @15,DUMMYLEN                                        0197
         ST    @15,@AL00001+28                                     0197
         LA    @15,RETCODE                                         0197
         ST    @15,@AL00001+32                                     0197
         L     @15,GDTDOP(,@10)                                    0197
         LA    @01,@AL00001                                        0197
         BALR  @14,@15                                             0197
*/*      IF WRITE OPERATION FAILS                                    */
*        IF RETCODE = CPFAILS                                      0198
*/*        THEN INDICATE RECLAMATION FAILS (CONDCODE = 3)            */
*          THEN DO;    CONDCODE = RECFAILU; END;                   0198
         CLC   RETCODE(4),@CF00048                                 0198
         BNE   @RF00198                                            0198
         L     @10,@PC00001+24                                     0200
         MVC   CONDCODE(4,@10),@CF00120                            0200
*/*        ELSE                                                      */
*          ELSE DO;                                                0202
*                                                                  0202
         B     @RC00198                                            0202
@RF00198 DS    0H                                                  0203
*/*          IF THE DEFECT-FLAG IS SET DUE TO RECOVERY               */
*            IF RETCODE = DFLAGONP                                 0203
*/*            THEN INDICATE RECLAMATION FAILS BUT TRACK RECOVERED   */
*              THEN DO;    CONDCODE = RECFAILS; END;               0203
         CLC   RETCODE(4),@CF00120                                 0203
         BNE   @RF00203                                            0203
         L     @10,@PC00001+24                                     0205
         MVC   CONDCODE(4,@10),@CF00169                            0205
*/*          END-ELSE                                                */
*            END;                                                  0207
@RF00203 DS    0H                                                  0208
*/*      END-THEN                                                    */
*        END;                                                      0208
@RC00198 DS    0H                                                  0209
*/*  IF THERE ARE NO ERRORS INDICATED SO FAR (CONDCODE = 0)          */
*    IF CONDCODE = SUCCEEDS                                        0209
*/*    THEN                                                          */
*      THEN DO;                                                    0209
*                                                                  0209
@RF00195 L     @10,@PC00001+24                                     0209
         L     @10,CONDCODE(,@10)                                  0209
         LTR   @10,@10                                             0209
         BNZ   @RF00209                                            0209
*/*      WRITE STANDARD-LENGTH RECORD-ZERO (OF THE PRIMARY)          */
*/*       (UDEVOP)                                                   */
*        CALL ICKDVOP0 (GDTTBL                                     0211
*               ,VOLIB                                             0211
*               ,ACTWRZS                                           0211
*               ,PRCCHH                                            0211
*               ,RECNUM                                            0211
*               ,POOLID                                            0211
*               ,ADDR (PRCCHH)                                     0211
*               ,LENGTH (PRCCHH)                                   0211
*               ,RETCODE);                                         0211
         L     @10,@PC00001                                        0211
         ST    @10,@AL00001                                        0211
         L     @15,@PC00001+4                                      0211
         ST    @15,@AL00001+4                                      0211
         LA    @15,@CF00165                                        0211
         ST    @15,@AL00001+8                                      0211
         L     @15,@PC00001+8                                      0211
         ST    @15,@AL00001+12                                     0211
         LA    @14,RECNUM                                          0211
         ST    @14,@AL00001+16                                     0211
         LA    @14,POOLID                                          0211
         ST    @14,@AL00001+20                                     0211
         ST    @15,@AFTEMPS                                        0211
         LA    @15,@AFTEMPS                                        0211
         ST    @15,@AL00001+24                                     0211
         LA    @15,@CF00048                                        0211
         ST    @15,@AL00001+28                                     0211
         LA    @15,RETCODE                                         0211
         ST    @15,@AL00001+32                                     0211
         L     @15,GDTDOP(,@10)                                    0211
         LA    @01,@AL00001                                        0211
         BALR  @14,@15                                             0211
*/*      IF WRITE OPERATION FAILS                                    */
*        IF RETCODE = CPFAILS                                      0212
*/*        THEN                                                      */
*          THEN DO;                                                0212
*                                                                  0212
         CLC   RETCODE(4),@CF00048                                 0212
         BNE   @RF00212                                            0212
*/*          INDICATE RECLAMATION FAILS AND TRACK UNRECOVERABLE      */
*            CONDCODE = RECFAILU;                                  0214
         L     @10,@PC00001+24                                     0214
         MVC   CONDCODE(4,@10),@CF00120                            0214
*/*          WRITE PRIMARY HOME-ADDRESS WITH DEFECT-FLAG ON          */
*/*           (UDEVOP)                                               */
*            CALL ICKDVOP0 (GDTTBL                                 0215
*                   ,VOLIB                                         0215
*                   ,ACTWPHAD                                      0215
*                   ,PRCCHH                                        0215
*                   ,RECNUM                                        0215
*                   ,POOLID                                        0215
*                   ,DUMMYPTR                                      0215
*                   ,DUMMYLEN                                      0215
*                   ,RETCODE);                                     0215
         L     @10,@PC00001                                        0215
         ST    @10,@AL00001                                        0215
         L     @15,@PC00001+4                                      0215
         ST    @15,@AL00001+4                                      0215
         LA    @15,@CF00140                                        0215
         ST    @15,@AL00001+8                                      0215
         L     @15,@PC00001+8                                      0215
         ST    @15,@AL00001+12                                     0215
         LA    @15,RECNUM                                          0215
         ST    @15,@AL00001+16                                     0215
         LA    @15,POOLID                                          0215
         ST    @15,@AL00001+20                                     0215
         LA    @15,DUMMYPTR                                        0215
         ST    @15,@AL00001+24                                     0215
         LA    @15,DUMMYLEN                                        0215
         ST    @15,@AL00001+28                                     0215
         LA    @15,RETCODE                                         0215
         ST    @15,@AL00001+32                                     0215
         L     @15,GDTDOP(,@10)                                    0215
         LA    @01,@AL00001                                        0215
         BALR  @14,@15                                             0215
*/*          END-THEN                                                */
*            END;                                                  0216
*/*        ELSE                                                      */
*          ELSE DO;                                                0217
*                                                                  0217
         B     @RC00212                                            0217
@RF00212 DS    0H                                                  0218
*/*          IF THE DEFECT-FLAG IS SET DUE TO RECOVERY               */
*            IF RETCODE = DFLAGONP                                 0218
*/*            THEN INDICATE RECLAMATION FAILS BUT TRACK             */
*/*             RECOVERED                                            */
*              THEN DO;    CONDCODE = RECFAILS; END;               0218
         CLC   RETCODE(4),@CF00120                                 0218
         BNE   @RF00218                                            0218
         L     @10,@PC00001+24                                     0220
         MVC   CONDCODE(4,@10),@CF00169                            0220
*/*          END-ELSE                                                */
*            END;                                                  0222
@RF00218 DS    0H                                                  0223
*/*      END-THEN                                                    */
*        END;                                                      0223
@RC00212 DS    0H                                                  0224
*/*  IF THERE ARE NO ERRORS INDICATED SO FAR (CONDCODE = 0)          */
*    IF CONDCODE = SUCCEEDS                                        0224
*/*    THEN                                                          */
*      THEN DO;                                                    0224
*                                                                  0224
@RF00209 L     @10,@PC00001+24                                     0224
         L     @10,CONDCODE(,@10)                                  0224
         LTR   @10,@10                                             0224
         BNZ   @RF00224                                            0224
*/*      IF THE PRIMARY TRACK IS ASSOCIATED WITH AN ALTERNATE        */
*        IF (ALCCHH >= FIRSTALT) & (ALCCHH <= LASTALT)             0226
*/*        THEN                                                      */
*          THEN DO;                                                0226
*                                                                  0226
         L     @10,@PC00001+12                                     0226
         L     @15,ALCCHH(,@10)                                    0226
         L     @14,INFOPTR                                         0226
         CL    @15,FIRSTALT(,@14)                                  0226
         BL    @RF00226                                            0226
         L     @01,INFOPTR+4                                       0226
         CL    @15,LASTALT(,@01)                                   0226
         BH    @RF00226                                            0226
*/*          READ HOME-ADDRESS (OF THE ALTERNATE TRACK TO OBTAIN     */
*/*           DEFECT-FLAG ) (UDEVOP)                                 */
*            CALL ICKDVOP0 (GDTTBL                                 0228
*                   ,VOLIB                                         0228
*                   ,ACTRDHA                                       0228
*                   ,ALCCHH                                        0228
*                   ,RECNUM                                        0228
*                   ,POOLID                                        0228
*                   ,DUMMYPTR                                      0228
*                   ,DUMMYLEN                                      0228
*                   ,RETCODE);                                     0228
         L     @15,@PC00001                                        0228
         ST    @15,@AL00001                                        0228
         L     @14,@PC00001+4                                      0228
         ST    @14,@AL00001+4                                      0228
         LA    @14,@CF00169                                        0228
         ST    @14,@AL00001+8                                      0228
         ST    @10,@AL00001+12                                     0228
         LA    @10,RECNUM                                          0228
         ST    @10,@AL00001+16                                     0228
         LA    @10,POOLID                                          0228
         ST    @10,@AL00001+20                                     0228
         LA    @10,DUMMYPTR                                        0228
         ST    @10,@AL00001+24                                     0228
         LA    @10,DUMMYLEN                                        0228
         ST    @10,@AL00001+28                                     0228
         LA    @10,RETCODE                                         0228
         ST    @10,@AL00001+32                                     0228
         L     @15,GDTDOP(,@15)                                    0228
         LA    @01,@AL00001                                        0228
         BALR  @14,@15                                             0228
*/*          IF THE DEFECT-FLAG IS FOUND NOT TO BE SET               */
*            IF RETCODE = DFLAGOFA                                 0229
*/*            THEN                                                  */
*              THEN DO;                                            0229
*                                                                  0229
         CLC   RETCODE(4),@CF00189                                 0229
         BNE   @RF00229                                            0229
*/*              READ STANDARD-LENGTH RECORD-ZERO (OF THE            */
*/*               ALT. TO ENSURE BACKWARD ASSOCIATION)               */
*                CALL ICKDVOP0 (GDTTBL                             0231
*                       ,VOLIB                                     0231
*                       ,ACTRDRZ                                   0231
*                       ,ALCCHH                                    0231
*                       ,RECNUM                                    0231
*                       ,POOLID                                    0231
*                       ,RZPTR                                     0231
*                       ,RZLEN                                     0231
*                       ,RETCODE);                                 0231
         L     @10,@PC00001                                        0231
         ST    @10,@AL00001                                        0231
         L     @15,@PC00001+4                                      0231
         ST    @15,@AL00001+4                                      0231
         LA    @15,@CF00120                                        0231
         ST    @15,@AL00001+8                                      0231
         L     @15,@PC00001+12                                     0231
         ST    @15,@AL00001+12                                     0231
         LA    @15,RECNUM                                          0231
         ST    @15,@AL00001+16                                     0231
         LA    @15,POOLID                                          0231
         ST    @15,@AL00001+20                                     0231
         LA    @15,RZPTR                                           0231
         ST    @15,@AL00001+24                                     0231
         LA    @15,RZLEN                                           0231
         ST    @15,@AL00001+28                                     0231
         LA    @15,RETCODE                                         0231
         ST    @15,@AL00001+32                                     0231
         L     @15,GDTDOP(,@10)                                    0231
         LA    @01,@AL00001                                        0231
         BALR  @14,@15                                             0231
*/*              IF READ OPERATION SUCCEEDS                          */
*                IF RETCODE = SUCCESS                              0232
*/*                THEN                                              */
*                  THEN DO;                                        0232
*                                                                  0232
         L     @10,RETCODE                                         0232
         LTR   @10,@10                                             0232
         BNZ   @RF00232                                            0232
*/*                  IF ALTERNATE IS ASSOCIATED WITH PRIMARY         */
*                    IF RZACCHH = PRCCHH                           0234
*/*                    THEN                                          */
*                      THEN DO;                                    0234
*                                                                  0234
         L     @10,@PC00001+8                                      0234
         L     @01,RZPTR                                           0234
         CLC   RZACCHH(4,@01),PRCCHH(@10)                          0234
         BNE   @RF00234                                            0234
*/*                      WRITE STANDARD-LENGTH RECORD-ZERO (OF       */
*/*                       THE ALTERNATE TRACK TO DISSOCIATE          */
*/*                       IT FROM THE PRIMARY ) (UDEVOP)             */
*                        CALL ICKDVOP0 (GDTTBL                     0236
*                               ,VOLIB                             0236
*                               ,ACTWRZS                           0236
*                               ,ALCCHH                            0236
*                               ,RECNUM                            0236
*                               ,POOLID                            0236
*                               ,ADDR (ALCCHH)                     0236
*                               ,LENGTH (ALCCHH)                   0236
*                               ,RETCODE);                         0236
         L     @10,@PC00001                                        0236
         ST    @10,@AL00001                                        0236
         L     @15,@PC00001+4                                      0236
         ST    @15,@AL00001+4                                      0236
         LA    @15,@CF00165                                        0236
         ST    @15,@AL00001+8                                      0236
         L     @15,@PC00001+12                                     0236
         ST    @15,@AL00001+12                                     0236
         LA    @14,RECNUM                                          0236
         ST    @14,@AL00001+16                                     0236
         LA    @14,POOLID                                          0236
         ST    @14,@AL00001+20                                     0236
         ST    @15,@AFTEMPS                                        0236
         LA    @15,@AFTEMPS                                        0236
         ST    @15,@AL00001+24                                     0236
         LA    @15,@CF00048                                        0236
         ST    @15,@AL00001+28                                     0236
         LA    @15,RETCODE                                         0236
         ST    @15,@AL00001+32                                     0236
         L     @15,GDTDOP(,@10)                                    0236
         LA    @01,@AL00001                                        0236
         BALR  @14,@15                                             0236
*/*                      IF WRITE OPERATION FAILS                    */
*                        IF RETCODE = CPFAILS                      0237
*/*                        THEN INDICATE DISSOCIATION FAILS          */
*/*                         AND TRACK IS UNRECOVERABLE               */
*                          THEN DO;                                0237
*                                                                  0237
         LA    @10,4                                               0237
         C     @10,RETCODE                                         0237
         BNE   @RF00237                                            0237
*                            CONDCODE = DISFAILU;                  0239
         L     @15,@PC00001+24                                     0239
         ST    @10,CONDCODE(,@15)                                  0239
*                            END;                                  0240
*/*                        ELSE                                      */
*                          ELSE DO;                                0241
*                                                                  0241
         B     @RC00237                                            0241
@RF00237 DS    0H                                                  0242
*/*                          IF THE DEFECT-FLAG IS                   */
*/*                           SET DUE TO RECOVERY                    */
*                            IF RETCODE = DFLAGONA                 0242
*/*                            THEN INDICATE DISSOCIATION FAILS      */
*/*                             BUT TRACK IS RECOVERED               */
*                              THEN DO;                            0242
*                                                                  0242
         CLC   RETCODE(4),@CF00123                                 0242
         BNE   @RF00242                                            0242
*                                CONDCODE = DISFAILS;              0244
         L     @10,@PC00001+24                                     0244
         MVC   CONDCODE(4,@10),@CF00140                            0244
*                                END;                              0245
*/*                          END-ELSE                                */
*                            END;                                  0246
@RF00242 DS    0H                                                  0247
*/*                      IF NO ERRORS INDICATED (CONDCODE = 0)       */
*                        IF CONDCODE = SUCCEEDS                    0247
*/*                        THEN                                      */
*                          THEN DO;                                0247
*                                                                  0247
@RC00237 L     @10,@PC00001+24                                     0247
         L     @10,CONDCODE(,@10)                                  0247
         LTR   @10,@10                                             0247
         BNZ   @RF00247                                            0247
*/*                          INCREMENT COUNT OF AVAILABLE ALT. TRKS  */
*                            ALTCOUNT = ALTCOUNT + 1;              0249
         L     @10,@PC00001+16                                     0249
         LA    @15,1                                               0249
         AL    @15,ALTCOUNT(,@10)                                  0249
         ST    @15,ALTCOUNT(,@10)                                  0249
*/*                          IF DISSOCIATED ALT TRACK IS BEFORE      */
*/*                           THE NEXT AVAILABLE ALTERNATE TRACK     */
*                            IF ALCCHH < ALTPTR                    0250
*/*                            THEN                                  */
*                              THEN DO;                            0250
*                                                                  0250
         L     @10,@PC00001+12                                     0250
         L     @10,ALCCHH(,@10)                                    0250
         L     @15,@PC00001+20                                     0250
         CL    @10,ALTPTR(,@15)                                    0250
         BNL   @RF00250                                            0250
*/*                              MAKE DISSOCIATED ALTERNATE TRACK    */
*/*                               THE NEXT AVAILABLE ALTERNATE TRK   */
*                                ALTPTR = ALCCHH;                  0252
         ST    @10,ALTPTR(,@15)                                    0252
*/*                              END-THEN                            */
*                                END;                              0253
*/*                          END-THEN (CONDCODE = 0)                 */
*                            END;                                  0254
*/*                      END-THEN (ALTERNATE ASSOC WITH PRIMARY)     */
*                        END;                                      0255
*/*                  END-THEN (READ OPERATION SUCCEEDS)              */
*                    END;                                          0256
*/*                ELSE (READ OPERATION FAILS)                       */
*                  ELSE DO;                                        0257
*                                                                  0257
         B     @RC00232                                            0257
@RF00232 DS    0H                                                  0258
*/*                  IF TRACK WAS UNRECOVERABLE                      */
*                    IF RETCODE = CPFAILS                          0258
*/*                    THEN INDICATE DISSOCIATION FAILS AND          */
*/*                     TRACK IS UNRECOVERABLE                       */
*                      THEN DO;                                    0258
*                                                                  0258
         LA    @10,4                                               0258
         C     @10,RETCODE                                         0258
         BNE   @RF00258                                            0258
*                        CONDCODE = DISFAILU;                      0260
         L     @15,@PC00001+24                                     0260
         ST    @10,CONDCODE(,@15)                                  0260
*                        END;                                      0261
*/*                    ELSE INDICATE DISSOCIATION FAILS              */
*/*                     BUT TRACK RECOVERED                          */
*                      ELSE DO;                                    0262
*                                                                  0262
         B     @RC00258                                            0262
@RF00258 DS    0H                                                  0263
*                        CONDCODE = DISFAILS;                      0263
         L     @10,@PC00001+24                                     0263
         MVC   CONDCODE(4,@10),@CF00140                            0263
*                        END;                                      0264
*/*                  END-ELSE (READ OPERATION FAILS)                 */
*                    END;                                          0265
*/*              END-THEN (DEFECT-FLAG FOUND NOT TO BE SET)          */
*                END;                                              0266
*/*            ELSE (READ OPERATION FAILS OR DEFECT FLAG SET)        */
*              ELSE DO;                                            0267
*                                                                  0267
         B     @RC00229                                            0267
@RF00229 DS    0H                                                  0268
*/*              IF READ OPERATION FAILS                             */
*                IF RETCODE = CPFAILS                              0268
*/*                THEN INDICATE DISSOCIATION FAILS                  */
*                  THEN DO;    CONDCODE = DISFAILU; END;           0268
         LA    @10,4                                               0268
         C     @10,RETCODE                                         0268
         BNE   @RF00268                                            0268
         L     @15,@PC00001+24                                     0270
         ST    @10,CONDCODE(,@15)                                  0270
*/*              END-ELSE                                            */
*                END;                                              0272
@RF00268 DS    0H                                                  0273
*/*          END-THEN (PRIMARY ASSOCIATED WITH ALTERNATE)            */
*            END;                                                  0273
@RC00229 DS    0H                                                  0274
*/*      END-THEN (NO ERRORS FOUND)                                  */
*        END;                                                      0274
@RF00226 DS    0H                                                  0275
*/*  END-PROCEDURE RECLAIM_PRIMARY_TRACK                             */
*    IF GDTDBG = NULLPTR                                           0275
*      THEN;                                                       0275
@RF00224 L     @10,@PC00001                                        0275
         L     @10,GDTDBG(,@10)                                    0275
         LTR   @10,@10                                             0275
         BZ    @RT00275                                            0275
*      ELSE                                                        0277
*        CALL ICKDB010 (GDTTBL                                     0277
*          ,'RP99');                                               0277
         L     @10,@PC00001                                        0277
         ST    @10,@AL00001                                        0277
         LA    @15,@CC00522                                        0277
         ST    @15,@AL00001+4                                      0277
         MVI   @AL00001+4,X'80'                                    0277
         L     @15,GDTDBG(,@10)                                    0277
         LA    @01,@AL00001                                        0277
         BALR  @14,@15                                             0277
*    CALL ICKSAFP0 (GDTTBL                                         0278
*           ,POOLID);                                              0278
@RT00275 L     @10,@PC00001                                        0278
         ST    @10,@AL00001                                        0278
         LA    @15,POOLID                                          0278
         ST    @15,@AL00001+4                                      0278
         MVI   @AL00001+4,X'80'                                    0278
         L     @15,GDTFPL(,@10)                                    0278
         LA    @01,@AL00001                                        0278
         BALR  @14,@15                                             0278
*    CALL ICKSAEP0(GDTTBL,MODID);                                  0279
*                                                                  0279
*                                                                  0279
         L     @10,@PC00001                                        0279
         ST    @10,@AL00001                                        0279
         LA    @15,MODID                                           0279
         ST    @15,@AL00001+4                                      0279
         MVI   @AL00001+4,X'80'                                    0279
         L     @15,GDTEPL(,@10)                                    0279
         LA    @01,@AL00001                                        0279
         BALR  @14,@15                                             0279
*    END ICKRP01                                                   0280
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        *
*;                                                                 0280
@DATA    DS    0H
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    7F
@AL00001 DS    9A
@AFTEMPS DS    1F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICKRP01  CSECT
         DS    0F
@CF00169 DC    F'1'
@CH00169 EQU   @CF00169+2
@CF00120 DC    F'2'
@CF00140 DC    F'3'
@CH00140 EQU   @CF00140+2
@CF00048 DC    F'4'
@CF00123 DC    F'6'
@CF00189 DC    F'7'
@CF00165 DC    F'8'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
RECNUM   DS    F
DUMMYPTR DS    A
DUMMYLEN DS    F
RZPTR    DS    A
RZLEN    DS    F
RETCODE  DS    F
LISTPTR  DS    A
SETRC    DS    H
TESTRC   DS    H
LISTLN   DS    FL1
         DS    CL3
CCODE    DS    3F
INFOPTR  DS    3A
INFOLEN  DS    3F
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICKRP01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00519 DC    C'RP00'
@CC00522 DC    C'RP99'
MODID    DC    CL4'RP01'
POOLID   DC    CL4'RP01'
PTCHRP01 DS    CL256
         ORG   PTCHRP01
@NM00018 DC    256X'00'
         ORG   PTCHRP01+256
INFOVECT DC    F'206'
         DC    F'207'
         DC    F'204'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
I        EQU   @02
REG12    EQU   @12
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
RTNREG   EQU   @15
ICKSAEP0 EQU   0
ICKSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
STAEPARM EQU   0
STAEPFX  EQU   STAEPARM
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+13
IOCRFM   EQU   IOCSTR+14
IOCMAC   EQU   IOCSTR+15
IOCMSG   EQU   IOCSTR+16
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
ICKDVIN0 EQU   0
ICKDVOP0 EQU   0
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ICKDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
RZACCHH  EQU   0
FIRSTALT EQU   0
LASTALT  EQU   0
DMPTRM   EQU   0
ICKDVCL0 EQU   0
ICKDVON0 EQU   0
ICKIOCL0 EQU   0
ICKIOGT0 EQU   0
ICKIOIT0 EQU   0
ICKIOOP0 EQU   0
ICKIOPT0 EQU   0
ICKIOTM0 EQU   0
ICKSACL0 EQU   0
ICKSADE0 EQU   0
ICKSAFS0 EQU   0
ICKSAGP0 EQU   0
ICKSAGS0 EQU   0
ICKSALD0 EQU   0
ICKSAPR0 EQU   0
ICKSASC0 EQU   0
ICKSASN0 EQU   0
ICKSAST0 EQU   0
ICKSATI0 EQU   0
ICKSAVC0 EQU   0
ICKSAWO0 EQU   0
ICKTPEA0 EQU   0
ICKTPES0 EQU   0
ICKTPPR0 EQU   0
ICKTPRE0 EQU   0
ICKTPRS0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NEWERID2 EQU   5
TRKSPCYL EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDIN   EQU   GDTTBL+44
GDTDOP   EQU   GDTTBL+48
GDTDBG   EQU   GDTTBL+52
GDTDVO   EQU   GDTTBL+56
GDTPRT   EQU   GDTTBL+60
GDTESS   EQU   GDTTBL+64
GDTESA   EQU   GDTTBL+68
GDTRST   EQU   GDTTBL+72
GDTRES   EQU   GDTTBL+76
GDTCAL   EQU   GDTTBL+80
GDTGSP   EQU   GDTTBL+84
GDTFSP   EQU   GDTTBL+88
GDTGPL   EQU   GDTTBL+92
GDTFPL   EQU   GDTTBL+96
GDTLOD   EQU   GDTTBL+100
GDTDEL   EQU   GDTTBL+104
GDTPRL   EQU   GDTTBL+108
GDTEPL   EQU   GDTTBL+112
GDTTIM   EQU   GDTTBL+116
GDTIIO   EQU   GDTTBL+120
GDTTIO   EQU   GDTTBL+124
GDTOPN   EQU   GDTTBL+136
GDTCLS   EQU   GDTTBL+140
GDTGET   EQU   GDTTBL+144
GDTPUT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+160
GDTWTO   EQU   GDTTBL+168
GDTSCR   EQU   GDTTBL+172
GDTVCK   EQU   GDTTBL+176
GDTDVC   EQU   GDTTBL+180
GDTSTE   EQU   GDTTBL+188
VOLIB    EQU   0
PRCCHH   EQU   0
ALCCHH   EQU   0
ALTCOUNT EQU   0
ALTPTR   EQU   0
CONDCODE EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ALTPTRT  EQU   ALTPTR+2
ALTPTRC  EQU   ALTPTR
ALCCHHT  EQU   ALCCHH+2
ALCCHHC  EQU   ALCCHH
GDTCVR   EQU   GDTTBL+184
GDTSPR   EQU   GDTTBL+164
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+132
GDTRIP   EQU   GDTTBL+128
GDTDVH   EQU   GDTTBL+40
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00017 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00016 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00015 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00014 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00013 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00012 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
OPNRSVD  EQU   OPNAGL+28
OPNVOL   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+20
OPNREC   EQU   OPNAGL+16
OPNDSN   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
@NM00011 EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
@NM00010 EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00009 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
@NM00008 EQU   OPNOPT
OPNOPTJM EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+36
IOCRRN   EQU   IOCSTR+32
@NM00007 EQU   IOCSTR+30
IOCPNM   EQU   IOCSTR+28
IOCCBP   EQU   IOCSTR+24
IOCDSN   EQU   IOCSTR+20
@NM00006 EQU   IOCSTR+17
@NM00005 EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCMACPA EQU   IOCMAC
@NM00004 EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00003 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00002 EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
STAEWORK EQU   STAEPARM+32
STARPTR  EQU   STAEPFX+28
STASPTR  EQU   STAEPFX+24
STALEN   EQU   STAEPFX+20
STAID    EQU   STAEPFX+16
STAEPA   EQU   STAEPFX+12
STAGDT   EQU   STAEPFX+8
STABPTR  EQU   STAEPFX+4
STAFPTR  EQU   STAEPFX
NEWID2   EQU   TRACE2+95
OLDERID2 EQU   TRACE2
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00001 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00232 EQU   @RC00229
@RC00258 EQU   @RC00229
@RF00234 EQU   @RC00232
@RF00247 EQU   @RC00232
@RF00250 EQU   @RC00232
@ENDDATA EQU   *
         END   ICKRP01,(C'PLS1733',0701,78192)

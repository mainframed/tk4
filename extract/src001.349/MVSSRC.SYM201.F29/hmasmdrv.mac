         TITLE 'HMASMDRV - SMP DRIVER ROUTINE'
HMASMDRV CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMDRV  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   DRVRTNCD=ZERO;                  /*                       @Z67SP00*/
         MVI   DRVRTNCD,X'00'                                      0254
*   IOPPTR=ADDR(DRVIOP);            /* PTR TO LOCAL IOP      @Z67SP00*/
         LA    IOPPTR,DRVIOP                                       0255
*   CCAPTR=ADDR(HMASMCCA);          /* SET ADDR OF CCA IN REG        */
         L     CCAPTR,@CA00042                                     0256
*   DO I=1 TO LENGTH(HMASMCCA);     /* ZERO CCA                      */
         LA    @08,1                                               0257
         ST    @08,I                                               0257
@DL00257 DS    0H                                                  0258
*     HMASMCCA(I)=ZERO;             /*                               */
         L     @06,@CA00042                                        0258
         SLR   @15,@15                                             0258
         BCTR  @06,0                                               0258
         STC   @15,HMASMCCA-HMASMCCA(@08,@06)                      0258
*   END;                            /*                               */
         AH    @08,@CH00091                                        0259
         ST    @08,I                                               0259
         CH    @08,@CH02556                                        0259
         BNH   @DL00257                                            0259
*   CCAIOPCS=ADDR(CDSSYS);          /* CDS SYSTEM IOP        @Z67SP00*/
         L     @08,@CA00042                                        0260
         LA    @06,CDSSYS                                          0260
         ST    @06,CCAIOPCS-HMASMCCA(,@08)                         0260
*   CCAIOPCS->IOPBUFAD=ADDR(BUFFRIOP);/* BUFFER AREA         @Z67SP00*/
         LA    @15,BUFFRIOP                                        0261
         ST    @15,IOPBUFAD(,@06)                                  0261
*   CCAIOPAS=ADDR(ACDSSYS);         /* ACDS YSSTEM IOP       @Z67SP00*/
         LA    @06,ACDSSYS                                         0262
         ST    @06,CCAIOPAS-HMASMCCA(,@08)                         0262
*   CCAIOPAS->IOPBUFAD=ADDR(BUFFRIOP);/* BUFFER AREA         @Z67SP00*/
         ST    @15,IOPBUFAD(,@06)                                  0263
*   CCAIOPTR=ADDR(DRVIOP);          /* TEMP IOP              @Z67SP00*/
         LA    @06,DRVIOP                                          0264
         ST    @06,CCAIOPTR-HMASMCCA(,@08)                         0264
*   CCAIOPTR->IOPBUFAD=ADDR(BUFFRIOP);/* BUFFER AREA         @Z67SP00*/
         ST    @15,IOPBUFAD(,@06)                                  0265
*   SMPRCS=''B;                     /* ZERO RC AREA          @Z67SP00*/
         XC    SMPRCS(11),SMPRCS                                   0266
*   HMASMMGP=''B;                   /* CLEAR MGP             @Z67SP00*/
         XC    HMASMMGP(24),HMASMMGP                               0267
*   MGPPRINT=ON;                    /* ALL MSG TO PRINTER    @OS64458*/
*   MGPHLDS=ON;                     /* AND TO LOG            @SA74333*/
         OI    MGPPRINT,B'10010000'                                0269
*   HMASMCRP=''B;                   /* ZERO CRD PARM         @Z67SP00*/
         XC    HMASMCRP(106),HMASMCRP                              0270
*   CRPINDS=IOPCONTR;               /* INPUT FROM SMPCNTL    @Z67SP00*/
         MVI   CRPINDS,X'09'                                       0271
*   CRPPRINT=ON;                    /* WRITE TO SMPOUT       @Z67SP00*/
         OI    CRPPRINT,B'00001000'                                0272
*   HMASMSCP=''B;                   /* ZERO SCP FIELDS       @Z67SP00*/
         XC    HMASMSCP(26),HMASMSCP                               0273
*   HMASMSET=''B;                   /* INIT SET ENTRY        @Z67SP00*/
         XC    HMASMSET(12),HMASMSET                               0274
*   NOJCLGTP=''B;                   /* ZERO NOJCLIN GTP      @Z67SP00*/
         XC    NOJCLGTP(28),NOJCLGTP                               0275
*   DRVFLGS1=ZERO;                  /* INIT SMP FLAGS        @ZD00003*/
         SLR   @08,@08                                             0276
         STH   @08,DRVFLGS1                                        0276
*   CALL HMASMDSU(DRVPARM);         /* DO SETUP PROCESSING   @Z67SP00*/
         L     @08,@PC00001                                        0277
         ST    @08,@AL00001                                        0277
         L     @15,@CV01805                                        0277
         LA    @01,@AL00001                                        0277
         BALR  @14,@15                                             0277
*   RFY                                                            0278
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   IF CCAIOPTR^=ZERO               /* IF NEW IOP OBTAINED   @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @14,@CA00042                                        0279
         L     @14,CCAIOPTR-HMASMCCA(,@14)                         0279
         LTR   @14,@14                                             0279
         BZ    @RF00279                                            0279
*     IOPPTR=CCAIOPTR;              /* USE IT                @Z67SP00*/
         LR    IOPPTR,@14                                          0280
*   ELSE                            /* IF NOT OBTAINED       @Z67SP00*/
*     IOPPTR=ADDR(DRVIOP);          /* USE FIXED IOP         @Z67SP00*/
         B     @RC00279                                            0281
@RF00279 LA    IOPPTR,DRVIOP                                       0281
*   RCSMP=MAX(RCSMP,RTNCODE);       /*                       @Z67SP00*/
@RC00279 SLR   @14,@14                                             0282
         IC    @14,RCSMP                                           0282
         CR    @14,RTNCODE                                         0282
         BNL   *+6
         LR    @14,RTNCODE                                         0282
         STC   @14,RCSMP                                           0282
*   IF RTNCODE>PTFWARN              /* IF NOT OK             @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CH    RTNCODE,@CH00044                                    0283
         BH    @RT00283                                            0283
*     GO TO FINAL;                  /*                       @Z67SP00*/
*   RFY                                                            0285
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*   CCATBLPA=ADDR(TBLPARM);         /* PUT TBL PARM ADDR     @Z67SP00*/
*                                                                  0286
         L     @08,@CA00042                                        0286
         LA    @06,TBLPARM                                         0286
         ST    @06,CCATBLPA-HMASMCCA(,@08)                         0286
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL HMASMSTA TO SETUP A STAE ENVIRONMENT             @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0287
*   CCARVEST=ON;                    /* ESTABLISH STAE        @Z67SP00*/
         OI    CCARVEST-HMASMCCA(@08),B'00001000'                  0287
*   CALL HMASMSTA;                  /*                       @Z67SP00*/
         L     @15,@CV01812                                        0288
         BALR  @14,@15                                             0288
*   RFY                                                            0289
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   CCARVEST=OFF;                   /* RESET SW              @Z67SP00*/
         L     @14,@CA00042                                        0290
         NI    CCARVEST-HMASMCCA(@14),B'11110111'                  0290
*   IF RTNCODE>STOPPTF              /* IF STA FAILED         @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CH    RTNCODE,@CH00116                                    0291
         BNH   @RF00291                                            0291
*     DO;                           /*                       @Z67SP00*/
*       RCSMP=RTNCODE;              /* SET SMP RC            @Z67SP00*/
         STC   RTNCODE,RCSMP                                       0293
*       GO TO FINAL;                /*                       @Z67SP00*/
         B     FINAL                                               0294
*     END;                          /*                       @Z67SP00*/
*   RFY                                                            0296
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
@RF00291 DS    0H                                                  0297
*                                                                  0297
*   /*****************************************************************/
*   /*                                                               */
*   /* READ AND SCAN CONTROL CARDS TO DETERMINE OPERATION SCAN       */
*   /* RETURNS AT SUBROUTINES TO INVOKE THE VARIOUS SMP VERB         */
*   /* PROCESSORS                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0297
*DRVSCAN:                                                          0297
*   SCPIORTN=ADDR(HMASMCRD);        /* SET PTR TO I/O ROUTINE        */
DRVSCAN  L     @08,@CV01802                                        0297
         ST    @08,SCPIORTN                                        0297
*   SCPIOPAD=ADDR(HMASMCRP);        /*                       @Z67SP00*/
         LA    @08,HMASMCRP                                        0298
         ST    @08,SCPIOPAD                                        0298
*   SCPINLN=LENGTH(CRPBFCTL);       /* SET INPUT RECORD LENGTH       */
         MVC   SCPINLN(2),@CH00836                                 0299
*   SCPEOR=ZERO;                    /* ZERO THE EOR FLAGS            */
         MVI   SCPEOR,X'00'                                        0300
*   SCPCOMNT=ON;                    /* INDICATE COMMENTS OCCUR       */
         OI    SCPCOMNT,B'00100000'                                0301
*   SCPSRCH=ADCTLSCN;               /* FIRST DSCAN           @Z40SP00*/
         MVC   SCPSRCH(4),ADCTLSCN                                 0302
*   CCAFUNCT=UNKWN;                 /* FUNCTION UNKNOWN YET  @Z67SP00*/
         L     @08,@CA00042                                        0303
         MVC   CCAFUNCT-HMASMCCA(8,@08),@CC01847                   0303
*   SAVECODE=ZERO;                  /* INIT FUNCTION RTN CD  @Z40SP00*/
         SLR   @08,@08                                             0304
         ST    @08,SAVECODE                                        0304
*   DRVFLGS2=OFF;                   /* INIT PROCESS FLAGS    @Z67SP00*/
         MVI   DRVFLGS2+1,X'00'                                    0305
         MVI   DRVFLGS2,B'00000000'                                0305
*   TBLPARM=''B;                    /* INIT PROCESSOR PARM   @Z67SP00*/
         XC    TBLPARM(16),TBLPARM                                 0306
*   TBLMASS=ON;                     /* DEFAULT MODE IS MASS  @Z67SP00*/
         OI    TBLMASS,B'00000001'                                 0307
*   LISTPARM=''B;                   /* INIT LIST PARM        @Z67SP00*/
         XC    LISTPARM(19),LISTPARM                               0308
*   CRPSCPAD=ADDR(HMASMSCP);        /* PTR TO SCP            @Z67SP00*/
         LA    @08,HMASMSCP                                        0309
         ST    @08,CRPSCPAD                                        0309
*   CRPLOG=ON;                      /* WRITE RCD TO LOG      @Z67SP00*/
         OI    CRPLOG,B'00010000'                                  0310
*   CRPLIST=OFF;                    /* NO WRITE TO SMPLIST   @Z67SP00*/
*   CRPRPT=OFF;                     /* NO WRITE TO SMPLIST   @Z67SP00*/
         NI    CRPLIST,B'11100111'                                 0312
*   CRPSCNCL=OFF;                   /* SET FOR CALL FROM DRV @Z67SP00*/
*   CRPLOGCK=ON;                    /* CHECK FOR LOG STMT    @Z67SP00*/
         OI    CRPLOGCK,B'01000000'                                0314
         NI    CRPSCNCL,B'11111110'                                0314
*   CALL HMASMCRD(HMASMCRP);        /* READ AND PRINT A STATEMENT    */
         L     @15,@CV01802                                        0315
         LA    @01,@AL00315                                        0315
         BALR  @14,@15                                             0315
*   CRPSCNCL=ON;                    /* SET FOR NOT FROM DRV  @Z67SP00*/
*   CRPLOGCK=OFF;                   /* DONT CHECK FOR LOG    @Z67SP00*/
         OI    CRPSCNCL,B'00000001'                                0317
         NI    CRPLOGCK,B'10111111'                                0317
*   IF CRPRETRN^=CRPGOOD            /* IF NEXT RCD NOT READ  @Z67SP00*/
*     THEN                          /* THEN                  @Z40SP00*/
         CLI   CRPRETRN,0                                          0318
         BE    @RF00318                                            0318
*     DO;                           /* CHECK TYPE RC         @Z67SP00*/
*       IF CRPRETRN=CRPEOF          /* IF END OF FILE        @Z67SP00*/
*         THEN                      /* THEN GO TO            @Z67SP00*/
         CLI   CRPRETRN,4                                          0320
         BE    @RT00320                                            0320
*         GO TO CLEANUP;            /* CLEANUP PROCESS       @Z67SP00*/
*       RCSMP=CRPRETRN;             /* MUST BE I/O OR DD MISSING ERR.
*                                      SET RC                @Z67SP00*/
         MVC   RCSMP(1),CRPRETRN                                   0322
*       GO TO FINAL;                /* TERMINATE SMP         @Z67SP00*/
         B     FINAL                                               0323
*     END;                          /*                       @YA07506*/
*   CALL HMASMSCN(HMASMSCP);        /* SCAN CONTROL STATEMENT        */
@RF00318 L     @15,@CV01817                                        0325
         LA    @01,@AL00325                                        0325
         BALR  @14,@15                                             0325
*   CRPSCNCL=OFF;                   /* SET FOR CALL FROM DRV. IN CASE
*                                      CHANGED IN ROUT       @Z67SP00*/
         NI    CRPSCNCL,B'11111110'                                0326
*                                                                  0327
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR INCOMPLETE CONTROL STATEMENT                @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0327
*   IF SCPRET=SCPGOOD               /* NOT SYNTAX BUT HIT END OF     */
*       &CRPEOFEN=ON                /* FILE BEFORE END OF STATEMENT  */
*     THEN                          /* OK TO CONTINUE                */
         CLI   SCPRET,0                                            0327
         BNE   @RF00327                                            0327
         TM    CRPEOFEN,B'10000000'                                0327
         BNO   @RF00327                                            0327
*     DO;                           /* ERROR - INCOMPLETE VERB       */
*       INCPLSW=ON;                 /* INCOMPLETE STMT       @Z40SP00*/
         OI    INCPLSW,B'01000000'                                 0329
*       MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MSG PARM         @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0330
*       MGPTYPE=MGPTERM;            /* SET SEVERITY          @ZD00001*/
         MVI   MGPTYPE,X'05'                                       0331
*       MGPMGNO1=HMA252I;           /* INDICATE INCOMPLETE STMT      */
         MVC   MGPMGNO1(2),@CH01774                                0332
*       CALL HMASMMSG(HMASMMGP);    /* WRITE MESSAGE                 */
         L     @15,@CV01809                                        0333
         LA    @01,@AL00333                                        0333
         BALR  @14,@15                                             0333
*       SAVECODE=STOPSMP;           /* INDICATE ERROR        @ZD00009*/
         MVC   SAVECODE(4),@CF00192                                0334
*       GO TO CLEANUP;              /* GO PUT OUT MSG FOR PROCESSING
*                                      COMPLETE AND STOP SMP @Z40SP00*/
         B     CLEANUP                                             0335
*     END;                                                         0336
*                                                                  0336
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR OUT OF STORAGE CONDITION                    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   IF M202SW=ON                    /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00327 TM    M202SW,B'00000010'                                  0337
         BNO   @RF00337                                            0337
*     DO;                           /*                       @Z67SP00*/
*       HMASMMGP=''B;               /* INIT PARM             @Z67SP00*/
         XC    HMASMMGP(24),HMASMMGP                               0339
*       MGPMGNO1=HMA202I;           /* UNABLE TO OBTAIN STORAGE FOR
*                                      WORK AREAS            @Z67SP00*/
         MVC   MGPMGNO1(2),@CH00239                                0340
*       MGPTYPE=MGPSEV;             /*                       @Z67SP00*/
         MVI   MGPTYPE,X'04'                                       0341
*       CALL HMASMMSG(HMASMMGP);    /*                       @Z67SP00*/
         L     @15,@CV01809                                        0342
         LA    @01,@AL00342                                        0342
         BALR  @14,@15                                             0342
*       SAVECODE=STOPFUNC;          /*                       @Z67SP00*/
         MVC   SAVECODE(4),@CF00033                                0343
*       GO TO CLEANUP;              /*                       @Z67SP00*/
         B     CLEANUP                                             0344
*     END;                          /*                       @Z67SP00*/
*                                                                  0346
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ERROR IN SCANNING CARDS OR INVALID OPTIONS SPECIFIED THEN  */
*   /* PUT OUT MSG IF NOT ALREADY DONE BY SCAN ROUT          @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0346
*   IF SCPRET^=SCPGOOD              /* IS THERE AN ERROR?    @Z40SP00*/
*     THEN                          /* YES - CHECK IT OUT            */
@RF00337 CLI   SCPRET,0                                            0346
         BE    @RF00346                                            0346
*     DO;                                                          0347
*                                                                  0347
*       /*************************************************************/
*       /*                                                           */
*       /* AN ERROR HAS OCCURRED. IT MAY BE SYNTAX ERROR OR I/O ERROR*/
*       /* IF RTNCODE HAS A VALUE, THEN THE CAUSE OF THE ERROR HAS   */
*       /* ALREADY BEEN DETERMINED, OTHERWISE IT IS A SYNTAX ERROR IN*/
*       /* A CONTROL STATEMENT.                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0348
*       IF RTNERR=ON                /* HAS ERROR OCCURRED IN ROUT?   */
*           ×SCPRET=STOPSMP         /* OR TERMINATE          @YA07506*/
*         THEN                      /* YES - NOT SYNTAX ERROR        */
         TM    RTNERR,B'10000000'                                  0348
         BO    @RT00348                                            0348
         CLI   SCPRET,16                                           0348
         BNE   @RF00348                                            0348
@RT00348 DS    0H                                                  0349
*         DO;                                                      0349
*           RTNERR=OFF;             /* RESET ROUTINE SWITCH          */
         NI    RTNERR,B'01111111'                                  0350
*           SAVECODE=MAX(STOPFUNC,SCPRET);/* SET RC FOR      @Z40SP00*/
         SLR   @08,@08                                             0351
         IC    @08,SCPRET                                          0351
         LA    @06,12                                              0351
         CR    @08,@06                                             0351
         BNL   *+6
         LR    @08,@06                                             0351
         ST    @08,SAVECODE                                        0351
*         END;                                                     0352
*       ELSE                        /*                       @Z67SP00*/
*         DO;                       /*                       @Z67SP00*/
         B     @RC00348                                            0353
@RF00348 DS    0H                                                  0354
*           ERRCOL=SCPCHAR-ADDR(CRPBUFFR)+1;/* CALC COLUMN FOR ERROR
*                                                            @Z67SP00*/
         LA    @08,CRPBUFFR                                        0354
         LCR   @08,@08                                             0354
         AL    @08,SCPCHAR                                         0354
         AH    @08,@CH00091                                        0354
         STH   @08,ERRCOL                                          0354
*           CVD(ERRCOL,DBLWRD);     /* MAKE DECIMAL                  */
         CVD   @08,DBLWRD                                          0355
*           UNPK(CHARCOL,DBLWRD);   /* MAKE EBCDIC                   */
         UNPK  CHARCOL(2),DBLWRD(8)                                0356
*           LASTDIG=LASTDIG×MAKEPRNT;/* MAKE PRINTABLE               */
         OI    LASTDIG,X'F0'                                       0357
*           MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MSG PARM     @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0358
*           MGPTYPE=MGPSEV;         /* SET SEVERITY          @ZD00001*/
         MVI   MGPTYPE,X'04'                                       0359
*           MGPMGNO1=HMA203I;       /* INDICATE SYNTAX ERROR         */
         MVC   MGPMGNO1(2),@CH00044                                0360
*           MGPMGNO2=PART021;       /* INDICATE DRIVER               */
         MVC   MGPMGNO2(2),@CH00456                                0361
*           MGPMGNO3=PART026;       /* ADD IN COLUMN PART            */
         MVC   MGPMGNO3(2),@CH00466                                0362
*           MGPVARPT(1)=ADDR(CHARCOL);/* POINT TO VARIABLE MESSAGE   */
         LA    @08,CHARCOL                                         0363
         ST    @08,MGPVARPT                                        0363
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */
         L     @15,@CV01809                                        0364
         LA    @01,@AL00364                                        0364
         BALR  @14,@15                                             0364
*           IF ERRAFTPR=OFF         /* IF SYNTAX ERR AFTER THE PERIOD
*                                      IN CNTL CARD THEN NO  @Z40SP00*/
*             THEN                  /* NEED TO SCAN FOR .    @Z40SP00*/
         TM    ERRAFTPR,B'00001000'                                0365
         BNZ   @RF00365                                            0365
*             DO;                   /* ASSUMED TO BE ON NEXT LINE  0366
*                                      ELSE SYNTAX ERR AGAIN @Z40SP00*/
*               SCPSRCH=ADSYNSCN;   /* PTR TO DSCAN TO SCAN FOR NEXT
*                                      PERIOD                @Z40SP00*/
         MVC   SCPSRCH(4),ADSYNSCN                                 0367
*               SCPCHAR=ADDR(CRPBUFFR);/* RESET PTR TO START OF    0368
*                                      STRING IN CASE SYNTAX AT END
*                                                            @Z67SP00*/
         LA    @08,CRPBUFFR                                        0368
         ST    @08,SCPCHAR                                         0368
*               CALL HMASMSCN(HMASMSCP);/* SCAN FOR PERIOD   @Z40SP00*/
         L     @15,@CV01817                                        0369
         LA    @01,@AL00369                                        0369
         BALR  @14,@15                                             0369
*               IF SCPRETRN=SCPGOOD /* IF SCAN OK            @XA22527*/
*                   &CRPEOFEN=ON    /* BUT EOF ENCOUNTERED   @XA22527*/
*                 THEN              /* OK TO CONTINUE        @XA22527*/
         CLI   SCPRETRN,0                                          0370
         BNE   @RF00370                                            0370
         TM    CRPEOFEN,B'10000000'                                0370
         BNO   @RF00370                                            0370
*                 DO;               /* ERROR - INCOMPLETE    @XA22527*/
*                   INCPLSW=ON;     /* INCOMPLETE STMT       @XA22527*/
         OI    INCPLSW,B'01000000'                                 0372
*                   MGPCLEAR=''B;   /* ZERO MSG PARM         @XA22527*/
         XC    MGPCLEAR(6),MGPCLEAR                                0373
*                   MGPTYPE=MGPTERM;/* SET SEVERITY          @XA22527*/
         MVI   MGPTYPE,X'05'                                       0374
*                   MGPMGNO1=HMA252I;/* INDICATE INCOMPLETE  @XA22527*/
         MVC   MGPMGNO1(2),@CH01774                                0375
*                   CALL HMASMMSG(HMASMMGP);/* WRITE MSG     @XA22527*/
         L     @15,@CV01809                                        0376
         LA    @01,@AL00376                                        0376
         BALR  @14,@15                                             0376
*                   SAVECODE=STOPSMP;/* INDICATE ERROR       @XA22527*/
         MVC   SAVECODE(4),@CF00192                                0377
*                 END;              /*                       @XA22527*/
*             END;                  /*                       @Z40SP00*/
@RF00370 DS    0H                                                  0380
*           SAVECODE=MAX(SAVECODE,STOPFUNC);/* SET RC        @Z67SP00*/
@RF00365 L     @08,SAVECODE                                        0380
         LA    @06,12                                              0380
         CR    @08,@06                                             0380
         BNL   *+6
         LR    @08,@06                                             0380
         ST    @08,SAVECODE                                        0380
*         END;                      /*                       @Z67SP00*/
*       IF CCAFLAG1=ZERO            /* IF FUNCTION NOT SET   @Z67SP00*/
*           ×(CCAUPDU=ON            /* OR UCLIN              @Z67SP00*/
*           &TBLFLG3=ZERO)          /* BUT DID NOT GET DS    @Z67SP00*/
*         THEN                      /* THEN SKIP REST        @Z67SP00*/
@RC00348 L     @08,@CA00042                                        0382
         ICM   @06,7,CCAFLAG1-HMASMCCA(@08)                        0382
         BZ    @RT00382                                            0382
         TM    CCAUPDU-HMASMCCA(@08),B'00000010'                   0382
         BNO   @RF00382                                            0382
         ICM   @08,3,TBLFLG3                                       0382
         BZ    @RT00382                                            0382
*         GO TO CLEANUP;            /* OF CHECKING           @Z67SP00*/
*     END;                                                         0384
*                                                                  0384
@RF00382 DS    0H                                                  0385
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET WRITE TO ALT DS IN CASE TURNED ON IN ROUT       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0385
*   CRPLIST=OFF;                    /* NO WRITE TO SMPLIST   @Z67SP00*/
@RF00346 DS    0H                                                  0386
*   CRPRPT=OFF;                     /* NO WRITE TO SMPLIST   @Z67SP00*/
*                                                                  0386
         NI    CRPLIST,B'11100111'                                 0386
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RESETRC VERB THEN RESET RC AREA AND RETURN         @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0387
*   IF CCARESET=ON                  /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @08,@CA00042                                        0387
         TM    CCARESET-HMASMCCA(@08),B'00100000'                  0387
         BNO   @RF00387                                            0387
*     DO;                           /*                       @Z67SP00*/
*       SMPRCS=''B;                 /* ZERO ALL SMP RTN CDS  @Z67SP00*/
         XC    SMPRCS(11),SMPRCS                                   0389
*       GO TO CLEANUP;              /*                       @Z67SP00*/
         B     CLEANUP                                             0390
*     END;                          /*                       @Z67SP00*/
*                                                                  0392
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ERR IN RC SPECIFIECATION OR RC NOT ENTERED AND      */
*   /* PREVIOUS ERR FORCES TERMINATION OF CURRENT COMMAND    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0392
*   IF RCERR=ON                     /* IF RC SPECIFICATION   @Z67SP00*/
*       ×                           /* ERR OR                @Z67SP00*/
*       (RCENTRD=OFF                /* RC NOT ENTERED        @Z67SP00*/
*       &CCALIST=OFF                /* AND NOT LIST FUNCT    @Z67SP00*/
*       &(RCSMP>=STOPFUNC           /* AND PREV FUNCT HAD    @Z67SP00*/
*       ×RCJCL>=STOPPTF             /* ERROR                 @Z67SP00*/
*       ×RCUCL>=STOPPTF)            /*                       @Z67SP00*/
*       )                           /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00387 TM    RCERR,B'10000000'                                   0392
         BO    @RT00392                                            0392
         TM    RCENTRD,B'00100000'                                 0392
         BNZ   @RF00392                                            0392
         L     @08,@CA00042                                        0392
         TM    CCALIST-HMASMCCA(@08),B'00000001'                   0392
         BNZ   @RF00392                                            0392
         CLI   RCSMP,12                                            0392
         BNL   @RT00392                                            0392
         CLI   RCJCL,8                                             0392
         BNL   @RT00392                                            0392
         CLI   RCUCL,8                                             0392
         BL    @RF00392                                            0392
@RT00392 DS    0H                                                  0393
*     DO;                           /*                               */
*       SAVECODE=MAX(SAVECODE,STOPFUNC);/* SAVE RC           @Z67SP00*/
         L     @08,SAVECODE                                        0394
         LA    @06,12                                              0394
         CR    @08,@06                                             0394
         BNL   *+6
         LR    @08,@06                                             0394
         ST    @08,SAVECODE                                        0394
*       PRCERR=ON;                  /* STMT FLUSHED DUE TO PREV ERR
*                                      IN CNTL STMT          @Z67SP00*/
         OI    PRCERR,B'01000000'                                  0395
*     END;                          /*                               */
*                                                                  0397
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF CDS/ACDS IS AT CORRECT CONVERSION LEVEL AND   */
*   /* INSURE CONVERSION IS NOT RUN MORE THAN ONCE           @ZD00004*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0397
*   MGPCLEAR=MGPCLEAR&&MGPCLEAR;    /* ZERO MSG PARM         @ZD00004*/
@RF00392 XC    MGPCLEAR(6),MGPCLEAR                                0397
*   IF CCACNV=ON                    /* IF CONVERT FUNCTION   @ZD00004*/
*       &((CNVCDS=ON                /* AND CONVERT CDS       @ZD00004*/
*       &CCACDSC=ON)                /* AND CDS CONVERTED     @ZD00004*/
*       ×(CNVACDS=ON                /* OR CONVERT ACDS       @ZD00004*/
*       &CCAACDSC=ON))              /* AND ACDS CONVERTED    @ZD00004*/
*     THEN                          /* THEN ERROR            @ZD00004*/
         L     @08,@CA00042                                        0398
         TM    CCACNV-HMASMCCA(@08),B'10000000'                    0398
         BNO   @RF00398                                            0398
         TM    CNVCDS,B'10000000'                                  0398
         BNO   @GL00012                                            0398
         TM    CCACDSC-HMASMCCA(@08),B'10000000'                   0398
         BO    @RT00398                                            0398
@GL00012 TM    CNVACDS,B'01000000'                                 0398
         BNO   @RF00398                                            0398
         L     @08,@CA00042                                        0398
         TM    CCAACDSC-HMASMCCA(@08),B'01000000'                  0398
         BNO   @RF00398                                            0398
@RT00398 DS    0H                                                  0399
*     DO;                           /*                       @ZD00004*/
*       MGPMGNO1=HMA308I;           /* CONVERT FUNCTION ALREADY    0400
*                                      PERFORMED ON XXXXXXXX @ZD00004*/
         MVC   MGPMGNO1(2),@CH01777                                0400
*       IF CNVCDS=ON                /* IF CDS CONVERSION     @ZD00004*/
*         THEN                      /*                       @ZD00004*/
         TM    CNVCDS,B'10000000'                                  0401
         BNO   @RF00401                                            0401
*         MGPVARPT(1)=ADDR(TXTCDS); /*                       @ZD00004*/
         LA    @08,@CC01791                                        0402
         ST    @08,MGPVARPT                                        0402
*       ELSE                        /*                       @ZD00004*/
*         MGPVARPT(1)=ADDR(TXTACDS);/*                       @ZD00004*/
         B     @RC00401                                            0403
@RF00401 LA    @08,@CC01793                                        0403
         ST    @08,MGPVARPT                                        0403
*       MGPTYPE=MGPSEV;             /* SEVERE ERROR          @ZD00004*/
@RC00401 MVI   MGPTYPE,X'04'                                       0404
*       CALL HMASMMSG(HMASMMGP);    /* WRITE MSG             @ZD00004*/
         L     @15,@CV01809                                        0405
         LA    @01,@AL00405                                        0405
         BALR  @14,@15                                             0405
*       SAVECODE=MAX(SAVECODE,STOPFUNC);/* STOP FUNCTION     @Z67SP00*/
         L     @08,SAVECODE                                        0406
         LA    @06,12                                              0406
         CR    @08,@06                                             0406
         BNL   *+6
         LR    @08,@06                                             0406
         ST    @08,SAVECODE                                        0406
*     END;                          /*                       @ZD00004*/
*                                                                  0407
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CDS OR ACDS HAS BEEN CONVERTED AND THIS FUNCTION IS REQUEST*/
*   /* TO LIST THAT DATA SET THEN LET THE LIST BE PROCESSED. IF LIST */
*   /* AGAINST UNCONVERTED DATA SET OR ANY OTHER FUNCTION BEFORE BOTH*/
*   /* THE CDS AND ACDS ARE CONVERTED THEN ISSUE ERROR MSG AND STOP  */
*   /* PROCESSING                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0408
*   IF(CCACDSC=ON                   /* IF CDS CONVERTED      @ZD00004*/
*       &CCALIST=ON                 /* AND THIS IS LIST      @ZD00004*/
*       &LISTCDS=ON)                /* OF CDS                @ZD00004*/
*       ×                           /* ..... OR .....        @ZD00004*/
*       (CCAACDSC=ON                /* OR ACDS CONVERTED     @ZD00004*/
*       &CCALIST=ON                 /* AND THIS IS LIST      @ZD00004*/
*       &LISTACDS=ON)               /* OF ACDS               @ZD00004*/
*     THEN                                                         0408
@RF00398 L     @08,@CA00042                                        0408
         TM    CCACDSC-HMASMCCA(@08),B'10000000'                   0408
         BNO   @GL00015                                            0408
         TM    CCALIST-HMASMCCA(@08),B'00000001'                   0408
         BNO   @GL00015                                            0408
         TM    LISTCDS,B'01000000'                                 0408
         BO    @RT00408                                            0408
@GL00015 L     @08,@CA00042                                        0408
         TM    CCAACDSC-HMASMCCA(@08),B'01000000'                  0408
         BNO   @RF00408                                            0408
         TM    CCALIST-HMASMCCA(@08),B'00000001'                   0408
         BNO   @RF00408                                            0408
         TM    LISTACDS,B'00100000'                                0408
         BO    @RT00408                                            0408
*     ;                             /* THEN ALLOW THE LIST TO BE DONE
*                                      WITHOUT ISSUEING ANY WARNING
*                                      MESSAGES IF THE OTHER DATA SET
*                                      HAS NOT BEEN CONVERTD @ZD00004*/
*   ELSE                            /* IF NOT LIST FOR       @ZD00004*/
*     DO;                           /* CONVERTED DATA SET    @ZD00004*/
@RF00408 DS    0H                                                  0411
*       IF(CCACNV=OFF               /* IF NOT CONVERT RUN    @ZD00004*/
*           &CCACDSC=OFF)           /* AND CDS NOT CONVERTED @ZD00004*/
*           ×                       /* OR                    @ZD00004*/
*           (CCACNV=ON              /* IF THIS IS CONVERT    @ZD00004*/
*           &CNVACDS=ON             /* REQUEST FOR ACDS BUT  @ZD00004*/
*           &CCACDSC=OFF)           /* CDS NOT CONVERTED YET @ZD00004*/
*         THEN                      /* THEN GIVE ERR MSG     @ZD00004*/
         L     @08,@CA00042                                        0411
         TM    CCACNV-HMASMCCA(@08),B'10000000'                    0411
         BNZ   @GL00020                                            0411
         TM    CCACDSC-HMASMCCA(@08),B'10000000'                   0411
         BZ    @RT00411                                            0411
@GL00020 L     @08,@CA00042                                        0411
         TM    CCACNV-HMASMCCA(@08),B'10000000'                    0411
         BNO   @RF00411                                            0411
         TM    CNVACDS,B'01000000'                                 0411
         BNO   @RF00411                                            0411
         TM    CCACDSC-HMASMCCA(@08),B'10000000'                   0411
         BNZ   @RF00411                                            0411
@RT00411 DS    0H                                                  0412
*         DO;                       /*                       @ZD00004*/
*           MGPMGNO1=HMA309I;       /* CONVERT MUST BE RUN AGAINST 0413
*                                      XXXXXXXX PRIOR TO ANY FURTHER
*                                      PROCESSING            @ZD00004*/
         MVC   MGPMGNO1(2),@CH01779                                0413
*           MGPVARPT(1)=ADDR(TXTCDS);/*                      @ZD00004*/
         LA    @08,@CC01791                                        0414
         ST    @08,MGPVARPT                                        0414
*           MGPTYPE=MGPSEV;         /* SEVERE ERROR          @ZD00004*/
         MVI   MGPTYPE,X'04'                                       0415
*           CALL HMASMMSG(HMASMMGP);/* WRITE MSG             @ZD00004*/
         L     @15,@CV01809                                        0416
         LA    @01,@AL00416                                        0416
         BALR  @14,@15                                             0416
*           SAVECODE=MAX(SAVECODE,STOPFUNC);/* STOP FUNCT    @Z67SP00*/
         L     @08,SAVECODE                                        0417
         LA    @06,12                                              0417
         CR    @08,@06                                             0417
         BNL   *+6
         LR    @08,@06                                             0417
         ST    @08,SAVECODE                                        0417
*         END;                      /*                       @ZD00004*/
*       IF CCAACDSC=OFF             /* IF ACDS NOT CONVERTED @ZD00004*/
*           &CCACNV=OFF             /* AND NOT CONVERT RUN   @ZD00004*/
*         THEN                      /* THEN GIVE ERR MSG     @ZD00004*/
@RF00411 L     @08,@CA00042                                        0419
         TM    CCAACDSC-HMASMCCA(@08),B'01000000'                  0419
         BNZ   @RF00419                                            0419
         TM    CCACNV-HMASMCCA(@08),B'10000000'                    0419
         BNZ   @RF00419                                            0419
*         DO;                       /*                       @ZD00004*/
*           MGPMGNO1=HMA309I;       /* CONVERT MUST BE RUN AGAINST 0421
*                                      XXXXXXXX PRIOR TO ANY FURTHER
*                                      PROCESSING            @ZD00004*/
         MVC   MGPMGNO1(2),@CH01779                                0421
*           MGPVARPT(1)=ADDR(TXTACDS);/*                     @ZD00004*/
         LA    @08,@CC01793                                        0422
         ST    @08,MGPVARPT                                        0422
*           MGPTYPE=MGPSEV;         /* SEVERE ERROR          @ZD00004*/
         MVI   MGPTYPE,X'04'                                       0423
*           CALL HMASMMSG(HMASMMGP);/* WRITE MSG             @ZD00004*/
         L     @15,@CV01809                                        0424
         LA    @01,@AL00424                                        0424
         BALR  @14,@15                                             0424
*           SAVECODE=MAX(SAVECODE,STOPFUNC);/* STOP FUNCT    @Z67SP00*/
         L     @08,SAVECODE                                        0425
         LA    @06,12                                              0425
         CR    @08,@06                                             0425
         BNL   *+6
         LR    @08,@06                                             0425
         ST    @08,SAVECODE                                        0425
*         END;                      /*                       @ZD00004*/
*     END;                          /* END NOT LIST OF CONVERTED DATA
*                                      SET OR OTHER FUNCTION PRIOR TO
*                                      CONVERSION OF BOTH    @ZD00004*/
@RF00419 DS    0H                                                  0428
*                                                                  0428
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL MODULE TO DETERMINE WHICH DATASETS SHOULD BE IN STORAGE  */
*   /* AND LOAD THEM                                         @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0428
*   IF CCAAPPLY=ON                  /* IF APPLY              @Z67SP00*/
*       ×CCARES=ON                  /* OR RESTORE            @Z67SP00*/
*       ×CCAACCPT=ON                /* OR ACCEPT             @Z67SP00*/
*     THEN                          /* (MAY HAVE CHECK)      @Z67SP00*/
@RT00408 L     @08,@CA00042                                        0428
         TM    CCAAPPLY-HMASMCCA(@08),B'01101000'                  0428
         BZ    @RF00428                                            0428
*     DO;                           /*                       @Z67SP00*/
*       IF TBLCHECK=OFF             /* IF CHECK NOT ENTERED  @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
         TM    TBLCHECK,B'01000000'                                0430
         BNZ   @RF00430                                            0430
*         CCACHECK=OFF;             /* NOT IN CHECK MODE     @Z67SP00*/
         NI    CCACHECK-HMASMCCA(@08),B'11101111'                  0431
*       ELSE                        /*                       @Z67SP00*/
*         CCACHECK=ON;              /* SET IN CHECK MODE     @Z67SP00*/
         B     @RC00430                                            0432
@RF00430 L     @08,@CA00042                                        0432
         OI    CCACHECK-HMASMCCA(@08),B'00010000'                  0432
*     END;                          /*                       @Z67SP00*/
*   ELSE                            /*                       @Z67SP00*/
*     IF CCAREC=ON                  /* IF ONE OF THE FUNCT   @Z67SP00*/
*         ×CCAREJ=ON                /* THAT CANNOT RUN WITH  @Z67SP00*/
*         ×CCAUPDU=ON               /* CHECK MODE            @Z67SP00*/
*         ×CCAUPDJ=ON               /*                       @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         B     @RC00428                                            0434
@RF00428 L     @08,@CA00042                                        0434
         TM    CCAREC-HMASMCCA(@08),B'10010110'                    0434
         BZ    @RF00434                                            0434
*       CCACHECK=OFF;               /* SET NO CHECK MODE     @Z67SP00*/
         NI    CCACHECK-HMASMCCA(@08),B'11101111'                  0435
*     ELSE                                                         0436
*       ;                           /* ELSE ITS ONE OF THOSE       0436
*                                      FUNCTIONS (LIST) THAT WILL RUN
*                                      WITH EITHER MODE      @Z67SP00*/
@RF00434 DS    0H                                                  0437
*   CALL HMASMDR1(TBLPARM,LISTPARM,SAVECODE);/* DS CHECKER   @Z67SP00*/
@RC00428 L     @15,@CV01803                                        0437
         LA    @01,@AL00437                                        0437
         BALR  @14,@15                                             0437
*   RFY                                                            0438
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   SAVECODE=MAX(SAVECODE,RTNCODE); /* SAVE RC               @Z67SP00*/
         L     @14,SAVECODE                                        0439
         CR    @14,RTNCODE                                         0439
         BNL   *+6
         LR    @14,RTNCODE                                         0439
         ST    @14,SAVECODE                                        0439
*   RFY                                                            0440
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*                                                                  0441
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ERROR OCCURED IN PROCESSING RC OPTIONS(I.E. ONE OF THE RC  */
*   /* CONDITIONS WAS NOT MET THEN PUT OUT MESSAGE NOW       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0441
*   IF RCERR=ON                     /* ONE RC COND NOT MET?  @Z40SP00*/
*     THEN                          /* IF SO THEN PUT OUT    @Z40SP00*/
         TM    RCERR,B'10000000'                                   0441
         BNO   @RF00441                                            0441
*     DO;                           /* MSG                   @Z40SP00*/
*       MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MSG NUMBERS      @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0443
*       MGPTYPE=MGPSEV;             /* SET SEVERITY          @ZD00001*/
         MVI   MGPTYPE,X'04'                                       0444
*       MGPMGNO1=HMA287I;           /* CONTROL STATEMENT NOT       0445
*                                      PROCESSED , A USER SPECIFIED
*                                      RETURN CODE HAS BEEN EXCEEDED
*                                                            @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00531                                0445
*       CALL HMASMMSG(HMASMMGP);    /* WRITE MSG             @Z40SP00*/
         L     @15,@CV01809                                        0446
         LA    @01,@AL00446                                        0446
         BALR  @14,@15                                             0446
*       TBLFLUSH=ON;                /*                       @Z67SP00*/
         OI    TBLFLUSH,B'00000010'                                0447
*       GO TO CLEANUP;              /*                       @Z67SP00*/
         B     CLEANUP                                             0448
*     END;                          /*                       @Z40SP00*/
*                                                                  0449
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RC OPTION WAS NOT ENTERED THEN DETERMINE IS THIS FUNCTION  */
*   /* SHOULD BE FLUSHED. FLUSH IF ANY PREVIOUS FUNCTION HAD RC OF 12*/
*   /* OR GREATER OR IF JCLIN OR UCLIN HAD RC OF 8 OR GREATER. IF RC */
*   /* WAS ENTERED THEN USER HAS COMPLETE CONTROL OVER FLUSH @Z40SP00*/
*   /* NOTE THAT ALL LIST FUNCTION WILL BE PROCESSED EVEN IF ERR IN  */
*   /* PREVIOUS FUNCTIONS                                    @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*   ELSE                            /*                       @Z67SP00*/
*     IF SAVECODE>=STOPFUNC         /* IF ERR IN CHECKING    @Z40SP00*/
*       THEN                        /* THEN FLUSH THIS       @Z40SP00*/
@RF00441 CLC   SAVECODE(4),@CF00033                                0450
         BL    @RF00450                                            0450
*       DO;                         /*                       @Z67SP00*/
*         IF PRCERR=ON              /* AND ERR IN PREV STMT  @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         TM    PRCERR,B'01000000'                                  0452
         BNO   @RF00452                                            0452
*           DO;                     /*                       @Z67SP00*/
*             MGPCLEAR=''B;         /*                       @Z67SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0454
*             MGPMGNO1=HMA229I;     /* CONTROL STATEMENT FLUSHED DUE
*                                      TO PREVIOUS ERROR     @Z67SP00*/
         MVC   MGPMGNO1(2),@CH00474                                0455
*             MGPTYPE=MGPSEV;       /*                       @Z67SP00*/
         MVI   MGPTYPE,X'04'                                       0456
*             CALL HMASMMSG(HMASMMGP);/*                     @Z67SP00*/
         L     @15,@CV01809                                        0457
         LA    @01,@AL00457                                        0457
         BALR  @14,@15                                             0457
*           END;                    /*                       @Z67SP00*/
*         TBLFLUSH=ON;              /*                       @Z67SP00*/
@RF00452 OI    TBLFLUSH,B'00000010'                                0459
*         IF CCAUPDU=OFF            /* IF NOT UCLIN          @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         L     @08,@CA00042                                        0460
         TM    CCAUPDU-HMASMCCA(@08),B'00000010'                   0460
         BZ    @RT00460                                            0460
*           GO TO CLEANUP;          /* SKIP PROCESSING       @Z67SP00*/
*       END;                        /*                       @Z67SP00*/
*                                                                  0463
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMSCN HAS COMPLETED SCANNING A CONTROL CARD. CHECK BITS IN */
*   /* THE HMASMCCA THAT WERE SET IN THE SCAN ROUT TO DETERMINE WHAT */
*   /* FUNCTION WAS REQUESTED.                               @Z40SP00*/
*   /* FUNCTION WAS LIST                                     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0463
*   IF CCALIST=ON                   /* IF LIST CDS/ACDS/SCDS @Z67SP00*/
*     THEN                          /* YES - PROCESS THE VERB        */
@RF00450 L     @08,@CA00042                                        0463
         TM    CCALIST-HMASMCCA(@08),B'00000001'                   0463
         BNO   @RF00463                                            0463
*     DO;                                                          0464
*       CALL HMASMLID(LISTPARM);    /* CALL LIST DRIVER      @Z67SP00*/
         L     @15,@CV01808                                        0465
         LA    @01,@AL00465                                        0465
         BALR  @14,@15                                             0465
*       RFY                                                        0466
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       SAVECODE=RTNCODE;           /* SAVE LOG RTN CODE     @Z40SP00*/
         ST    RTNCODE,SAVECODE                                    0467
*       RFY                                                        0468
*         RTNCODE UNRSTD;           /*                       @Z40SP00*/
*       GO TO CLEANUP;              /* RE-INIT ALL FIELDS    @Z40SP00*/
         B     CLEANUP                                             0469
*     END;                                                         0470
*                                                                  0471
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT A BLANK LINE TO SET THE VERB OFF FROM THE OUTPUT        */
*   /* PRODUCED BY THE HMASMP MODULE THAT WILL DO THE PROCESSING     */
*   /*                                                       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0471
*   IOPDSID=IOPPRINT;               /* INDICATE PRINTER              */
@RF00463 MVI   IOPDSID(IOPPTR),X'0B'                               0471
*   IOPFUNCT=IOPWRITE;              /* INDICATE WRITE OPERATION      */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0472
*   PRLHEAD=OFF;                    /* INDICATE NO HEADING           */
*   PRLHEADO=OFF;                   /* INDICATE NOT TO CLEAR HEAD    */
*   PRLBLANK=ON;                    /* INDICATE BLANK LINE           */
         L     @08,IOPBUFAD(,IOPPTR)                               0475
         OI    PRLBLANK(@08),B'00100000'                           0475
         NI    PRLHEAD(@08),B'00111111'                            0475
*   CALL HMASMIO(HMASMIOP);         /* PRINT BLANK LINE              */
         ST    IOPPTR,@AL00001                                     0476
         L     @15,@CV01807                                        0476
         LA    @01,@AL00001                                        0476
         BALR  @14,@15                                             0476
*   IF IOPRETRN^=IOPGOOD            /* ERROR RETURN?                 */
*     THEN                          /* YES - EXIT WITH ERROR         */
         CLI   IOPRETRN(IOPPTR),0                                  0477
         BE    @RF00477                                            0477
*     DO;                                                          0478
*       SAVECODE=STOPSMP;           /* SET TO STOP SMP       @Z40SP00*/
         MVC   SAVECODE(4),@CF00192                                0479
*       GO TO CLEANUP;              /* TERMINATE THE RUN             */
         B     CLEANUP                                             0480
*     END;                                                         0481
*                                                                  0482
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION WAS UCLIN                                    @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0482
*   IF CCAUPDU=ON                   /* IS IT UCLIN?                  */
*     THEN                          /* YES CALL PROCESSOR            */
@RF00477 L     @08,@CA00042                                        0482
         TM    CCAUPDU-HMASMCCA(@08),B'00000010'                   0482
         BNO   @RF00482                                            0482
*     DO;                                                          0483
*       CALL HMASMUCD(TBLPARM,HMASMCRP);/* CALL UCL MOD      @Z67SP00*/
         L     @15,@CV01815                                        0484
         LA    @01,@AL00484                                        0484
         BALR  @14,@15                                             0484
*       RFY                                                        0485
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       SAVECODE=MAX(SAVECODE,RTNCODE);/* SAVE RETURN CODE   @Z40SP00*/
         L     @14,SAVECODE                                        0486
         CR    @14,RTNCODE                                         0486
         BNL   *+6
         LR    @14,RTNCODE                                         0486
         ST    @14,SAVECODE                                        0486
*       RFY                                                        0487
*         RTNCODE UNRSTD;           /*                       @Z40SP00*/
*       IF CCAIOPTR=ZERO            /* WAS IOP FREED BY UCL? @Z40SP00*/
*         THEN                      /* BUT UNABLE TO GET NEW @Z40SP00*/
         L     @08,@CA00042                                        0488
         ICM   @06,15,CCAIOPTR-HMASMCCA(@08)                       0488
         BNZ   @RF00488                                            0488
*         IOPPTR=ADDR(DRVIOP);      /* ONE - YES RESET CCA   @Z40SP00*/
         LA    IOPPTR,DRVIOP                                       0489
*       ELSE                        /* WAS NOT CHANGED OR    @Z40SP00*/
*         IOPPTR=CCAIOPTR;          /* NEW ONE GOTTEN - RESET IN CASE
*                                      UPDATED BY UCL        @Z40SP00*/
         B     @RC00488                                            0490
@RF00488 L     @08,@CA00042                                        0490
         L     IOPPTR,CCAIOPTR-HMASMCCA(,@08)                      0490
*       IF TBLCDS=ON                /* IF UCL TO CDS OR ACDS @Z40SP00*/
*           ×TBLACDS=ON             /* THEN MUST CLOSE THAT  @Z40SP00*/
*         THEN                      /* DATA SET IN CASE      @Z40SP00*/
@RC00488 TM    TBLCDS,B'11000000'                                  0491
         BZ    @RF00491                                            0491
*         DO;                       /* EXTENDED BY OUTPUT    @Z40SP00*/
*           IOPFUNCT=IOPCLOSE;      /* SET TO CLOSE          @Z40SP00*/
         MVI   IOPFUNCT(IOPPTR),X'50'                              0493
*           IF TBLCDS=ON            /* IF CDS WAS CHANGED    @Z40SP00*/
*             THEN                  /* THEN SET TO CLOSE IT  @Z40SP00*/
         TM    TBLCDS,B'10000000'                                  0494
         BNO   @RF00494                                            0494
*             IOPDSID=IOPCDSM;      /* ELSE SET TO           @Z40SP00*/
         MVI   IOPDSID(IOPPTR),X'02'                               0495
*           ELSE                    /* CLOSE THE ACDS        @Z40SP00*/
*             IOPDSID=IOPCDSA;      /*                       @Z40SP00*/
         B     @RC00494                                            0496
@RF00494 MVI   IOPDSID(IOPPTR),X'0C'                               0496
*           CALL HMASMIO(HMASMIOP); /* DO CLOSE              @Z40SP00*/
@RC00494 ST    IOPPTR,@AL00001                                     0497
         L     @15,@CV01807                                        0497
         LA    @01,@AL00001                                        0497
         BALR  @14,@15                                             0497
*           SAVECODE=MAX(SAVECODE,IOPRETRN);/* UPDATE RC IF CLOSE  0498
*                                      FAILS                 @Z40SP00*/
         L     @08,SAVECODE                                        0498
         SLR   @06,@06                                             0498
         IC    @06,IOPRETRN(,IOPPTR)                               0498
         CR    @08,@06                                             0498
         BNL   *+6
         LR    @08,@06                                             0498
         ST    @08,SAVECODE                                        0498
*         END;                      /*                       @Z40SP00*/
*       GO TO CLEANUP;              /*                       @Z40SP00*/
         B     CLEANUP                                             0500
*     END;                          /* END UCLIN VERB        @Z40SP00*/
*                                                                  0502
*   /*****************************************************************/
*   /*                                                               */
*   /* FOLLOWING CODE IS TO HANDLE LOG VERB - WRITE MESSAGE          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0502
*   IF CCALOG=ON                    /* IS IT LOG VERB?       @Z67SP00*/
*     THEN                          /* YES - WRITE MESSAGE           */
@RF00482 L     @08,@CA00042                                        0502
         TM    CCALOG-HMASMCCA(@08),B'01000000'                    0502
         BNO   @RF00502                                            0502
*     DO;                                                          0503
*       IOPDSID=IOPHLDS;            /* INDICATE HISTORY LOG DS       */
         MVI   IOPDSID(IOPPTR),X'01'                               0504
*       IOPFUNCT=IOPWRITE;          /* INDICATE WRITE OPERATION      */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0505
*       PRLRLEN=LOGLNTH+LENGTH(HMASMPRL);/* SET RECORD LENGTH      0506
*                                                            @Z40SP00*/
         L     @08,IOPBUFAD(,IOPPTR)                               0506
         LH    @06,LOGLNTH                                         0506
         LA    @15,10                                              0506
         ALR   @15,@06                                             0506
         STH   @15,PRLRLEN(,@08)                                   0506
*       PRLDATA(1:LOGLNTH)=LOGMSG;  /* PUT MESSAGE IN PRL            */
         BCTR  @06,0                                               0507
         EX    @06,@SM02635                                        0507
*       CALL HMASMIO(HMASMIOP);     /* WRITE MESSAGE TO HLDS         */
         ST    IOPPTR,@AL00001                                     0508
         L     @15,@CV01807                                        0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*       IF IOPRETRN^=IOPGOOD        /* ERROR ON WRITE?               */
*         THEN                      /* YES - ERROR EXIT              */
         CLI   IOPRETRN(IOPPTR),0                                  0509
         BE    @RF00509                                            0509
*         SAVECODE=STOPSMP;         /* SET TO STOP SMP       @Z40SP00*/
         MVC   SAVECODE(4),@CF00192                                0510
*       ELSE                                                       0511
*         SAVECODE=IOPGOOD;         /* SET RETURN CODE       @Z40SP00*/
         B     @RC00509                                            0511
@RF00509 SLR   @08,@08                                             0511
         ST    @08,SAVECODE                                        0511
*       GO TO CLEANUP;              /* GO SCAN NEXT VERB     @Z40SP00*/
         B     CLEANUP                                             0512
*     END;                                                         0513
*                                                                  0514
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION WAS JCLIN                                    @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0514
*   IF CCAUPDJ=ON                   /* IS IT JCLIN?                  */
*     THEN                          /* YES - CALL PROCESSOR          */
@RF00502 L     @08,@CA00042                                        0514
         TM    CCAUPDJ-HMASMCCA(@08),B'00000100'                   0514
         BNO   @RF00514                                            0514
*     DO;                                                          0515
*       UPDDSID=IOPSGTAP;           /* INPUT FROM SMPJCLIN   @Z67SP00*/
         MVI   UPDDSID,X'07'                                       0516
*       UPDSYSMD=TXTJCLIN;          /*                       @Z67SP00*/
         MVC   UPDSYSMD(7),@CC01797                                0517
*       UPDTRACE=OFF;               /* NO TRACE OPTION       @Z67SP00*/
         NI    UPDTRACE,B'10111111'                                0518
*       CALL HMASMUPD(UPDPARM);     /* INVOKE JCL PROCESSOR  @SA73847*/
         L     @15,@CV01816                                        0519
         LA    @01,@AL00519                                        0519
         BALR  @14,@15                                             0519
*       RFY                                                        0520
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       SAVECODE=RTNCODE;           /* SAVE RC               @YA07506*/
         ST    RTNCODE,SAVECODE                                    0521
*       RFY                                                        0522
*         RTNCODE UNRSTD;           /*                       @Z40SP00*/
*       IOPFUNCT=IOPCLOSE;          /* SET TO CLOSE          @SA75309*/
         MVI   IOPFUNCT(IOPPTR),X'50'                              0523
*       IOPDSID=IOPCDSM;            /* CDS                   @SA75309*/
         MVI   IOPDSID(IOPPTR),X'02'                               0524
*       CALL HMASMIO(HMASMIOP);     /* CLOSE CDS             @SA75309*/
         ST    IOPPTR,@AL00001                                     0525
         L     @15,@CV01807                                        0525
         LA    @01,@AL00001                                        0525
         BALR  @14,@15                                             0525
*       SAVECODE=MAX(SAVECODE,IOPRETRN);/* UPDATE RC IF CLOSE, WRITE
*                                      OR CLOSE FAILED       @Z40SP00*/
         L     @08,SAVECODE                                        0526
         SLR   @06,@06                                             0526
         IC    @06,IOPRETRN(,IOPPTR)                               0526
         CR    @08,@06                                             0526
         BNL   *+6
         LR    @08,@06                                             0526
         ST    @08,SAVECODE                                        0526
*       GO TO CLEANUP;              /* GO REINIT VARIABLES   @Z40SP00*/
         B     CLEANUP                                             0527
*     END;                                                         0528
*                                                                  0529
*   /*****************************************************************/
*   /*                                                               */
*   /* RECEIVE FUNCTION REQUESTED                            @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0529
*   IF CCAREC=ON                    /* IS IT RECEIVE VERB?           */
*     THEN                          /* YES - INVOKE RECEIVE PROCESSOR*/
@RF00514 L     @08,@CA00042                                        0529
         TM    CCAREC-HMASMCCA(@08),B'10000000'                    0529
         BNO   @RF00529                                            0529
*     DO;                                                          0530
*       CALL HMASMREC(TBLPARM);     /* CALL RECEIVE          @Z67SP00*/
         L     @15,@CV01810                                        0531
         LA    @01,@AL00531                                        0531
         BALR  @14,@15                                             0531
*       RFY                                                        0532
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       SAVECODE=RTNCODE;           /* SAVE RETURN CODE      @SA70539*/
         ST    RTNCODE,SAVECODE                                    0533
*       RFY                                                        0534
*         RTNCODE UNRSTD;           /*                       @Z40SP00*/
*       IOPFUNCT=IOPCLOSE;          /* SET TO CLOSE          @SA70539*/
         MVI   IOPFUNCT(IOPPTR),X'50'                              0535
*       IOPDSID=IOPPTS;             /* SET TO CLOSE PTS      @SA70539*/
         MVI   IOPDSID(IOPPTR),X'06'                               0536
*       CALL HMASMIO(HMASMIOP);     /* CLOSE PTS             @SA75309*/
         ST    IOPPTR,@AL00001                                     0537
         L     @15,@CV01807                                        0537
         LA    @01,@AL00001                                        0537
         BALR  @14,@15                                             0537
*       SAVECODE=MAX(SAVECODE,IOPRETRN);/* UPDTE RC IF ERR   @Z40SP00*/
         L     @08,SAVECODE                                        0538
         SLR   @06,@06                                             0538
         IC    @06,IOPRETRN(,IOPPTR)                               0538
         CR    @08,@06                                             0538
         BNL   *+6
         LR    @08,@06                                             0538
         ST    @08,SAVECODE                                        0538
*       GO TO CLEANUP;              /* CLEANUP PROCESSING    @Z40SP00*/
         B     CLEANUP                                             0539
*     END;                                                         0540
*                                                                  0541
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PREVIOUS ERROR IN HMASMMSG, STOP NOW               @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0541
*   IF CCATERM=ON                   /* IF PREV ERR IN MSG    @Z40SP00*/
*     THEN                          /* THEN SKIP PROCESS     @Z40SP00*/
@RF00529 L     @08,@CA00042                                        0541
         TM    CCATERM-HMASMCCA(@08),B'00100000'                   0541
         BO    @RT00541                                            0541
*     GO TO CLEANUP;                /*                       @Z40SP00*/
*                                                                  0542
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS APPLY, RESTORE, AND ACCEPT FUNCTIONS          @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0543
*   IF(CCAAPPLY=ON                  /* APPLY?                @Z40SP00*/
*       ×CCAACCPT=ON                /* OR ACCEPT             @Z67SP00*/
*       ×CCARES=ON)                 /* OR RESTORE            @Z67SP00*/
*     THEN                          /* YES                   @Z40SP00*/
         TM    CCAAPPLY-HMASMCCA(@08),B'01101000'                  0543
         BZ    @RF00543                                            0543
*     DO;                           /*                       @Z67SP00*/
*       DIDCALL=ON;                 /*                       @ZD00005*/
         OI    DIDCALL,B'00000100'                                 0545
*       CALL HMASMTBL(TBLPARM);     /* BUILD INTERNAL CNTL. TABLE  0546
*                                                            @Z67SP00*/
         L     @15,@CV01814                                        0546
         LA    @01,@AL00546                                        0546
         BALR  @14,@15                                             0546
*       RFY                                                        0547
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       SAVECODE=MAX(SAVECODE,RTNCODE);/* SAVE RETURN CODE   @Z40SP00*/
         L     @14,SAVECODE                                        0548
         CR    @14,RTNCODE                                         0548
         BNL   *+6
         LR    @14,RTNCODE                                         0548
         ST    @14,SAVECODE                                        0548
*       RFY                                                        0549
*         RTNCODE UNRSTD;           /*                       @Z40SP00*/
*       IF SAVECODE>=STOPSMP        /* IF SEVERE ERROR?      @ZD00007*/
*           ×CCATERM=ON             /* OR I/O ERROR FOUND            */
*           ×CCAICTOK=OFF           /* OR TBLE INCOMPLETE    @Z67SP00*/
*         THEN                      /* NO - EXIT BADLY               */
         CH    @14,@CH00192                                        0550
         BNL   @RT00550                                            0550
         L     @08,@CA00042                                        0550
         TM    CCATERM-HMASMCCA(@08),B'00100000'                   0550
         BO    @RT00550                                            0550
         TM    CCAICTOK-HMASMCCA(@08),B'00000001'                  0550
         BNZ   @RF00550                                            0550
@RT00550 DS    0H                                                  0551
*         DO;                       /*                       @ZA26113*/
*           DIDCALL=OFF;            /* SET SW SO THAT ARL WILL NOT BE
*                                      CALLED. ABEND MAY OCCUR IF ARL
*                                      CALLED BUT ICT NOT SET UP   0552
*                                      COMPLETELY            @ZA26113*/
         NI    DIDCALL,B'11111011'                                 0552
*           GO TO CLEANUP;          /* INDICATE ERROR        @Z40SP00*/
         B     CLEANUP                                             0553
*         END;                      /*                       @ZA26113*/
*                                                                  0554
*       /*************************************************************/
*       /*                                                           */
*       /* ICT BUILT OK NOW CALL HMASMAAR TO PROCESS REQUEST @Z40SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0555
*       IF TBLCHECK=OFF             /* IF NOT CHECK RUN      @Z67SP00*/
*         THEN                      /* YES                   @Z40SP00*/
@RF00550 TM    TBLCHECK,B'01000000'                                0555
         BNZ   @RF00555                                            0555
*         DO;                       /*                       @Z67SP00*/
*           CALL HMASMAAR(TBLPARM); /* CALL APPLY PROCESSOR  @ZD00006*/
         L     @15,@CV01800                                        0557
         LA    @01,@AL00557                                        0557
         BALR  @14,@15                                             0557
*           RFY                                                    0558
*             RTNCODE RSTD;         /*                       @Z67SP00*/
*           SAVECODE=MAX(SAVECODE,RTNCODE);/* SAVE RC        @Z40SP00*/
         L     @14,SAVECODE                                        0559
         CR    @14,RTNCODE                                         0559
         BNL   *+6
         LR    @14,RTNCODE                                         0559
         ST    @14,SAVECODE                                        0559
*           RFY                                                    0560
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/
*         END;                      /*                       @Z67SP00*/
*                                                                  0561
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE CDS AND ACDS SO THAT EXTENTS WILL BE RECORDED       */
*       /*                                                   @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0562
*       IOPFUNCT=IOPCLOSE;          /* SET FUNCTION          @SA75309*/
@RF00555 MVI   IOPFUNCT(IOPPTR),X'50'                              0562
*       IF CCAACCPT=ON              /* WAS THIS ACCEPT?      @SA75309*/
*         THEN                      /* YES                   @SA75309*/
         L     @08,@CA00042                                        0563
         TM    CCAACCPT-HMASMCCA(@08),B'00100000'                  0563
         BNO   @RF00563                                            0563
*         DO;                       /* MUST CLOSE ACDS       @SA75309*/
*           IOPDSID=IOPCDSA;        /* ACDS DATA SET         @SA75309*/
         MVI   IOPDSID(IOPPTR),X'0C'                               0565
*           CALL HMASMIO(HMASMIOP); /* CLOSE IT              @SA75309*/
         ST    IOPPTR,@AL00001                                     0566
         L     @15,@CV01807                                        0566
         LA    @01,@AL00001                                        0566
         BALR  @14,@15                                             0566
*           SAVECODE=MAX(SAVECODE,IOPRETRN);/* UPD RC IF ERR @Z40SP00*/
         L     @08,SAVECODE                                        0567
         SLR   @06,@06                                             0567
         IC    @06,IOPRETRN(,IOPPTR)                               0567
         CR    @08,@06                                             0567
         BNL   *+6
         LR    @08,@06                                             0567
         ST    @08,SAVECODE                                        0567
*         END;                      /* END ACCEPT FUNCTION   @SA75309*/
*       IF CCAACCPT=ON              /* WAS FUNCTION ACCEPT?  @SA75309*/
*           ×CCAAPPLY=ON            /* OR APPLY?             @SA75309*/
*         THEN                      /* YES                   @SA75309*/
@RF00563 L     @08,@CA00042                                        0569
         TM    CCAACCPT-HMASMCCA(@08),B'01100000'                  0569
         BZ    @RF00569                                            0569
*         DO;                       /* MUST CLOSE CDS        @SA75309*/
*           IOPDSID=IOPCDSM;        /* CDS DATA SET          @SA75309*/
         MVI   IOPDSID(IOPPTR),X'02'                               0571
*           CALL HMASMIO(HMASMIOP); /* DO CLOSE              @SA75309*/
         ST    IOPPTR,@AL00001                                     0572
         L     @15,@CV01807                                        0572
         LA    @01,@AL00001                                        0572
         BALR  @14,@15                                             0572
*           SAVECODE=MAX(SAVECODE,IOPRETRN);/* UPD RC IF ERR @Z40SP00*/
         L     @08,SAVECODE                                        0573
         SLR   @06,@06                                             0573
         IC    @06,IOPRETRN(,IOPPTR)                               0573
         CR    @08,@06                                             0573
         BNL   *+6
         LR    @08,@06                                             0573
         ST    @08,SAVECODE                                        0573
*         END;                      /* END APPLY OR ACCEPT   @SA75309*/
*       GO TO CLEANUP;              /*                       @Z67SP00*/
         B     CLEANUP                                             0575
*     END;                          /* END APPLY,REST, ACC   @Z67SP00*/
*                                                                  0577
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION WAS REJECT                                   @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0577
*   IF CCAREJ=ON                    /* REJECT?               @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF00543 L     @08,@CA00042                                        0577
         TM    CCAREJ-HMASMCCA(@08),B'00010000'                    0577
         BNO   @RF00577                                            0577
*     DO;                           /*                       @Z67SP00*/
*       CALL HMASMREJ(TBLPARM);     /* CALL REJECT PROCESSOR @ZD00006*/
         L     @15,@CV01811                                        0579
         LA    @01,@AL00579                                        0579
         BALR  @14,@15                                             0579
*       RFY                                                        0580
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       SAVECODE=MAX(SAVECODE,RTNCODE);/* SAVE RC            @Z67SP00*/
         L     @14,SAVECODE                                        0581
         CR    @14,RTNCODE                                         0581
         BNL   *+6
         LR    @14,RTNCODE                                         0581
         ST    @14,SAVECODE                                        0581
*       RFY                                                        0582
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*       GO TO CLEANUP;              /*                       @Z67SP00*/
         B     CLEANUP                                             0583
*     END;                          /*                       @Z67SP00*/
         EJECT
*                                                                  0585
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEANUP PROCESSING FROM RECEIVE, APPLY, ACCEPT, REJECT, AND   */
*   /* RESTORE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0585
*CLEANUP:                                                          0585
*                                                                  0585
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET WRITE TO ALT DS IN CASE TURNED ON IN ROUT       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0585
*   CCAEOFNC=ON;                    /* END OF FUNCTION PROC. @Z67SP00*/
@RF00577 DS    0H                                                  0585
CLEANUP  L     @08,@CA00042                                        0585
         OI    CCAEOFNC-HMASMCCA(@08),B'00000010'                  0585
*   CRPLIST=OFF;                    /* NO WRITE TO SMPLIST   @Z67SP00*/
*   CRPRPT=OFF;                     /* NO WRITE TO SMPLIST   @Z67SP00*/
         NI    CRPLIST,B'11100111'                                 0587
*   RFY                                                            0588
*     SIZE RSTD;                    /* REMOVE REG FROM USE   @Z40SP00*/
*   IOPBUFAD=ADDR(BUFFRIOP);        /* RESET ADDR OF BUFFER AREA IN
*                                      IOP IN CASE CALLED MODULE   0589
*                                      CHANGED IT AND FORGOT TO RESET
*                                                            @Z67SP00*/
*                                                                  0589
         LA    @08,BUFFRIOP                                        0589
         ST    @08,IOPBUFAD(,IOPPTR)                               0589
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO FINISH PROCESSING ANY IN STORAGE DIRECTORIES  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0590
*   CALL HMASMDR2(TBLPARM,LISTPARM,SAVECODE);/*              @Z67SP00*/
         L     @15,@CV01804                                        0590
         LA    @01,@AL00590                                        0590
         BALR  @14,@15                                             0590
*   RFY                                                            0591
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   SAVECODE=MAX(SAVECODE,RTNCODE); /* SAVE RC               @Z67SP00*/
         L     @14,SAVECODE                                        0592
         CR    @14,RTNCODE                                         0592
         BNL   *+6
         LR    @14,RTNCODE                                         0592
         ST    @14,SAVECODE                                        0592
*   RFY                                                            0593
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*   IF CCATERM=ON                   /* TERMINATE SMP?        @YA07506*/
*     THEN                          /* YES                   @YA07506*/
         L     @08,@CA00042                                        0594
         TM    CCATERM-HMASMCCA(@08),B'00100000'                   0594
         BNO   @RF00594                                            0594
*     SAVECODE=MAX(SAVECODE,STOPSMP);/* SET RC TO MIN OF 16  @Z67SP00*/
         LA    @08,16                                              0595
         CR    @14,@08                                             0595
         BNL   *+6
         LR    @14,@08                                             0595
         ST    @14,SAVECODE                                        0595
*   IF CRPEOFEN=OFF                 /* IF NOT EOF THEN       @Z40SP00*/
*       ×(INCPLSW=ON&CRPEOFEN=ON)   /* OR INCOMPLETE STMT DUE TO EOF
*                                      FOUND BY DRV          @Z40SP00*/
*       ×(INCPLSW=OFF&CCAUPDU=ON)   /* OR IF UCLIN FOUND INCOMPLETE
*                                      STATEMENT             @Z67SP00*/
*     THEN                          /* MUST                  @Z40SP00*/
@RF00594 TM    CRPEOFEN,B'10000000'                                0596
         BZ    @RT00596                                            0596
         TM    INCPLSW,B'01000000'                                 0596
         BNO   @GL00027                                            0596
         TM    CRPEOFEN,B'10000000'                                0596
         BO    @RT00596                                            0596
@GL00027 TM    INCPLSW,B'01000000'                                 0596
         BNZ   @RF00596                                            0596
         L     @08,@CA00042                                        0596
         TM    CCAUPDU-HMASMCCA(@08),B'00000010'                   0596
         BNO   @RF00596                                            0596
@RT00596 DS    0H                                                  0597
*     CALL FUNCTMSG;                /* WRITE RC MSG          @Z40SP00*/
*                                                                  0597
         BAL   @14,FUNCTMSG                                        0597
*   /*****************************************************************/
*   /*                                                               */
*   /* IF APPLY, RESTORE, OR ACCEPT CALL HMASMARL TO PRODUCE SUMMARY */
*   /* REPORT OR IF REQUEST WAS FOR CHECK CALL HMASMARL TO PRODUCE   */
*   /* FULL REPORTS                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0598
*   IF(CCAAPPLY=ON                  /* IF APPLY              @ZD00009*/
*       ×CCARES=ON                  /* RESTORE               @ZD00005*/
*       ×CCAACCPT=ON)               /* OR ACCEPT             @ZD00005*/
*       &DIDCALL=ON                 /* AND TBL CALLED        @ZD00005*/
*       &SAVECODE<STOPSMP           /* AND NOT SEVERE ERROR  @Z67SP00*/
*     THEN                          /*                       @ZD00009*/
@RF00596 L     @08,@CA00042                                        0598
         TM    CCAAPPLY-HMASMCCA(@08),B'01101000'                  0598
         BZ    @RF00598                                            0598
         TM    DIDCALL,B'00000100'                                 0598
         BNO   @RF00598                                            0598
         CLC   SAVECODE(4),@CF00192                                0598
         BNL   @RF00598                                            0598
*     DO;                           /*                       @ZD00009*/
*       CALL HMASMARL(TBLPARM);     /* CALL REGRESSION CHCK  @ZD00009*/
         L     @15,@CV01801                                        0600
         LA    @01,@AL00600                                        0600
         BALR  @14,@15                                             0600
*       RFY                                                        0601
*         RTNCODE RSTD;             /*                       @ZD00009*/
*       RCSMP=MAX(RCSMP,RTNCODE);   /* SET CODE TO MAX OF EXISTING 0602
*                                      CODE AND RETURN AS CODE MAY 0602
*                                      HAVE BEEN SET BY TBL OF     0602
*                                      PROCESSOR MOD PRIOR TO THIS 0602
*                                                            @ZD00009*/
         SLR   @14,@14                                             0602
         IC    @14,RCSMP                                           0602
         CR    @14,RTNCODE                                         0602
         BNL   *+6
         LR    @14,RTNCODE                                         0602
         STC   @14,RCSMP                                           0602
*       RFY                                                        0603
*         RTNCODE UNRSTD;           /*                       @ZD00009*/
*     END;                          /*                       @ZD00009*/
*   CCAFLAG1=ZERO;                  /* RESET FUNCTION FLAGS          */
@RF00598 SLR   @08,@08                                             0605
         L     @06,@CA00042                                        0605
         STCM  @08,7,CCAFLAG1-HMASMCCA(@06)                        0605
*   CCANCPTF=OFF;                   /* RESET NUC HIT BIT     @Z40SP00*/
*   CCASVCLB=OFF;                   /* RESET SVCLIB HIT      @Z40SP00*/
         NI    CCANCPTF-HMASMCCA(@06),B'00111111'                  0607
*   CCAFLAG3=ZERO;                  /* RESET CCA BITS        @Z40SP00*/
*                                                                  0608
         STH   @08,CCAFLAG3-HMASMCCA(,@06)                         0608
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE SET IF ONE SET UP                                @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0609
*   IF SESELECT=ON                  /*                       @Z67SP00*/
*       ×SEEXCLUD=ON                /*                       @Z67SP00*/
*       ×SEGROUP=ON                 /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    SESELECT,B'11100000'                                0609
         BZ    @RF00609                                            0609
*     DO;                           /*                       @Z67SP00*/
*       GTPPTR=CCASETAD;            /* FREE SET              @Z67SP00*/
         L     @08,CCASETAD-HMASMCCA(,@06)                         0611
         ST    @08,GTPPTR                                          0611
*       RFY                                                        0612
*         HMASMGTP BASED(GTPPTR);   /*                       @Z67SP00*/
*       GTPFUNCT=GTPFREE;           /*                       @Z67SP00*/
         MVI   GTPFUNCT(@08),X'0A'                                 0613
*       CALL HMASMGTA(HMASMGTP);    /*                       @Z67SP00*/
         ST    @08,@AL00001                                        0614
         L     @15,@CV01806                                        0614
         LA    @01,@AL00001                                        0614
         BALR  @14,@15                                             0614
*       RCSMP=MAX(RCSMP,GTPRETRN);  /*                       @Z67SP00*/
         L     @08,GTPPTR                                          0615
         SLR   @06,@06                                             0615
         IC    @06,RCSMP                                           0615
         SLR   @03,@03                                             0615
         IC    @03,GTPRETRN(,@08)                                  0615
         CR    @06,@03                                             0615
         BNL   *+6
         LR    @06,@03                                             0615
         STC   @06,RCSMP                                           0615
*       HMASMSET=''B;               /*                       @Z67SP00*/
         XC    HMASMSET(12),HMASMSET                               0616
*       GTPRCDLN=LENGTH(HMASMSET);  /*                       @Z67SP00*/
         LA    @06,12                                              0617
         STH   @06,GTPRCDLN(,@08)                                  0617
*       GTPKEYLN=LENGTH(HMASMSET);  /*                       @Z67SP00*/
         STH   @06,GTPKEYLN(,@08)                                  0618
*     END;                          /*                       @Z67SP00*/
*                                                                  0619
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE NOJCLIN GTP IF ONE SET UP                        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0620
*   IF TBLJCLGT^=ZERO               /* IF GTP FILE BUILT     @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00609 L     @08,TBLJCLGT                                        0620
         LTR   @08,@08                                             0620
         BZ    @RF00620                                            0620
*     DO;                           /*                       @Z67SP00*/
*       GTPPTR=TBLJCLGT;            /* PICK UP GTP ADDR      @Z67SP00*/
         ST    @08,GTPPTR                                          0622
*       RFY                                                        0623
*         HMASMGTP BASED(GTPPTR);   /*                       @Z67SP00*/
*       GTPFUNCT=GTPFREE;           /*                       @Z67SP00*/
         MVI   GTPFUNCT(@08),X'0A'                                 0624
*       CALL HMASMGTA(HMASMGTP);    /*                       @Z67SP00*/
         ST    @08,@AL00001                                        0625
         L     @15,@CV01806                                        0625
         LA    @01,@AL00001                                        0625
         BALR  @14,@15                                             0625
*       RCSMP=MAX(RCSMP,GTPRETRN);  /*                       @Z67SP00*/
         SLR   @08,@08                                             0626
         IC    @08,RCSMP                                           0626
         L     @06,GTPPTR                                          0626
         SLR   @03,@03                                             0626
         IC    @03,GTPRETRN(,@06)                                  0626
         CR    @08,@03                                             0626
         BNL   *+6
         LR    @08,@03                                             0626
         STC   @08,RCSMP                                           0626
*     END;                          /*                       @Z67SP00*/
*                                                                  0627
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE ICT IF ONE WAS OBTAINED                          @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0628
*   IF CCAICT^=ZERO                 /* IF ICT GETMAINED      @Z67SP00*/
*     THEN                          /* THEN FREE IT          @Z67SP00*/
@RF00620 L     @08,@CA00042                                        0628
         ICM   @06,15,CCAICT-HMASMCCA(@08)                         0628
         BZ    @RF00628                                            0628
*     DO;                           /*                       @Z67SP00*/
*       DO I=DIM(ICTGMSPL) TO 1 BY-1;/* FREE ALL PARTS OF ICT.MUST 0630
*                                      END WITH PTF SINCE THIS     0630
*                                      SECTION LEN INCLUDES LEN OF 0630
*                                      OTHER TWO SECTIONS    @Z67SP00*/
         LA    @08,3                                               0630
         ST    @08,I                                               0630
@DL00630 DS    0H                                                  0631
*         IF ICTGMSPL(I)^=ZERO      /* IF PART GETMAINED     @Z67SP00*/
*           THEN                    /*                       @Z67SP00*/
         LR    @06,@08                                             0631
         SLA   @06,2                                               0631
         L     @03,@CA00042                                        0631
         L     @03,CCAICT-HMASMCCA(,@03)                           0631
         AL    @06,@CF02640                                        0631
         L     @06,ICTGMSPL(@06,@03)                               0631
         LTR   @06,@06                                             0631
         BZ    @RF00631                                            0631
*           DO;                     /*                       @Z67SP00*/
*             SIZE=ICTGMSPL(I);     /* GET STORAGE SIZE      @Z67SP00*/
         LR    SIZE,@06                                            0633
*             IF I=1                /* IF SYSMODS            @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
         CH    @08,@CH00091                                        0634
         BNE   @RF00634                                            0634
*               FMADDR=CCAICT;      /*                       @Z67SP00*/
         ST    @03,FMADDR                                          0635
*             IF I=2                /*                       @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
@RF00634 CLC   I(4),@CF00187                                       0636
         BNE   @RF00636                                            0636
*               FMADDR=CCAICMOD;    /*                       @Z67SP00*/
         L     @08,@CA00042                                        0637
         MVC   FMADDR(4),CCAICMOD-HMASMCCA(@08)                    0637
*             IF I=3                /*                       @Z67SP00*/
*               THEN                /*                       @Z67SP00*/
@RF00636 CLC   I(4),@CF00239                                       0638
         BNE   @RF00638                                            0638
*               FMADDR=CCAICLMD;    /*                       @Z67SP00*/
         L     @08,@CA00042                                        0639
         MVC   FMADDR(4),CCAICLMD-HMASMCCA(@08)                    0639
*             GEN(FREEMAIN E,LV=(SIZE),A=FMADDR)                   0640
*             REFS(SIZE);           /* FREE ICT              @Z67SP00*/
@RF00638 DS    0H                                                  0640
         FREEMAIN E,LV=(SIZE),A=FMADDR
*           END;                    /* END NEED FREEMAIN     @Z67SP00*/
*       END;                        /* END FREE ICT LOOP     @Z67SP00*/
@RF00631 SLR   @08,@08                                             0642
         BCTR  @08,0                                               0642
         AL    @08,I                                               0642
         ST    @08,I                                               0642
         LTR   @08,@08                                             0642
         BP    @DL00630                                            0642
*       CCAICT=ZERO;                /* ZERO ICT PTRS         @Z67SP00*/
         SLR   @08,@08                                             0643
         L     @06,@CA00042                                        0643
         ST    @08,CCAICT-HMASMCCA(,@06)                           0643
*       CCAICPTF=ZERO;              /*                       @Z67SP00*/
         ST    @08,CCAICPTF-HMASMCCA(,@06)                         0644
*       CCAICMOD=ZERO;              /*                       @Z67SP00*/
         ST    @08,CCAICMOD-HMASMCCA(,@06)                         0645
*       CCAICLMD=ZERO;              /*                       @Z67SP00*/
         ST    @08,CCAICLMD-HMASMCCA(,@06)                         0646
*     END;                          /* END ICT OBTAINED GRP  @Z67SP00*/
*                                                                  0647
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE COMPRESS LIST IF ONE BUILT                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0648
*   IF CCACLST^=ZERO                /* COMPRESS LIST GOTTEN  @Z30XX9J*/
*     THEN                          /*                       @Z30XX9J*/
@RF00628 L     @08,@CA00042                                        0648
         ICM   @06,15,CCACLST-HMASMCCA(@08)                        0648
         BZ    @RF00648                                            0648
*     DO;                           /* FREE IT               @Z30XX9J*/
*       SIZE=CMPRSMAX*LENGTH(CMPRSLST);/* SIZE TO FREE       @Z30XX9J*/
         L     SIZE,CMPRSMAX                                       0650
         MH    SIZE,@CH00035                                       0650
*       GEN(FREEMAIN E,LV=(SIZE),A=CCACLST)/* FREE IT        @X30XX9J*/
*       REFS(SIZE,CCACLST);         /*                       @Z30XX9J*/
         FREEMAIN E,LV=(SIZE),A=CCACLST
*       CMPRSCTR=ONE;               /* RE-INITIALIZE DD CNTR @Z30XX9J*/
         MVC   CMPRSCTR(4),@CF00091                                0652
*       CMPRSMAX=CMPRSINC;          /* INITIALIZE LIST SIZE  @Z30XX9J*/
         MVC   CMPRSMAX(4),@CF00358                                0653
*       CCACLST=ZERO;               /* CCA PTR               @Z30XX9J*/
         L     @08,@CA00042                                        0654
         SLR   @06,@06                                             0654
         ST    @06,CCACLST-HMASMCCA(,@08)                          0654
*     END;                          /* END COMPRESS CLEANUP  @Z30XX9J*/
*   IF OLDNUCID^=BLANK              /* WAS NUCLEUS SAVED?            */
*     THEN                          /* YES - RESTORE IT              */
@RF00648 CLI   OLDNUCID,C' '                                       0656
         BE    @RF00656                                            0656
*     DO;                                                          0657
*       CCANUCID=OLDNUCID;          /* RESTORE NUCID TO CCA          */
         L     @08,@CA00042                                        0658
         MVC   CCANUCID-HMASMCCA(1,@08),OLDNUCID                   0658
*       OLDNUCID=BLANK;             /* RESET SAVED ID TO BLANK       */
         MVI   OLDNUCID,C' '                                       0659
*     END;                                                         0660
*   RFY                             /*                       @Z40SP00*/
*     SIZE UNRSTD;                  /* RETURN REG TO USE     @Z40SP00*/
*                                                                  0661
@RF00656 DS    0H                                                  0662
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW CALL USER EXIT INTERFACE ROUTINE TO DELETE ANY EXITS      */
*   /* LOADED FOR THIS FUNCTION                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0662
*   CALL HMASMUXC(0,0);             /* DUMMY PARMS           @Z67SP00*/
         L     @15,@CV01818                                        0662
         LA    @01,@AL00662                                        0662
         BALR  @14,@15                                             0662
*   RFY                             /*                       @Z67SP00*/
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   RCSMP=MAX(RCSMP,RTNCODE);       /* UPDATE RETURN CODE    @Z67SP00*/
         SLR   @14,@14                                             0664
         IC    @14,RCSMP                                           0664
         CR    @14,RTNCODE                                         0664
         BNL   *+6
         LR    @14,RTNCODE                                         0664
         STC   @14,RCSMP                                           0664
*   RFY                             /*                       @Z67SP00*/
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*   CCAEOFNC=OFF;                   /* NO LONGER IN FUNCTION       0666
*                                      TERMINATION           @Z67SP00*/
         L     @08,@CA00042                                        0666
         NI    CCAEOFNC-HMASMCCA(@08),B'11111101'                  0666
*                                                                  0667
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT A COUPLE BLANK LINES FOLLOWING VERB TO SET IT OFF       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0667
*   IF RCSMP<STOPSMP                /* IF RTN CODE IS OK     @Z40SP00*/
*       &CRPEOFEN=OFF               /* AND NOT END OF FILE   @Z40SP00*/
*       &CCATERM=OFF                /* AND NOT ERR IN MSG    @Z40SP00*/
*     THEN                          /* THEN PRINT COUPLE     @Z40SP00*/
         CLI   RCSMP,16                                            0667
         BNL   @RF00667                                            0667
         TM    CRPEOFEN,B'10000000'                                0667
         BNZ   @RF00667                                            0667
         TM    CCATERM-HMASMCCA(@08),B'00100000'                   0667
         BNZ   @RF00667                                            0667
*     DO;                           /* OF BLANK LINES        @Z40SP00*/
*       PRLHEADO=OFF;               /* CLEAR ALL PRIOR HEADINGS      */
*       PRLHEAD=OFF;                /* INDICATE NO NEW HEADING       */
*       PRLBLANK=ON;                /* INDICATE BLANK LINE           */
         L     @08,IOPBUFAD(,IOPPTR)                               0671
         OI    PRLBLANK(@08),B'00100000'                           0671
         NI    PRLHEADO(@08),B'00111111'                           0671
*       IOPFUNCT=IOPWRITE;          /* INDICATE WRITE OPERATION      */
         MVI   IOPFUNCT(IOPPTR),X'51'                              0672
*       IOPDSID=IOPPRINT;           /* INDICATE PRINTER              */
         MVI   IOPDSID(IOPPTR),X'0B'                               0673
*       CALL HMASMIO(HMASMIOP);     /* WRITE A BLANK LINE            */
         ST    IOPPTR,@AL00001                                     0674
         L     @15,@CV01807                                        0674
         LA    @01,@AL00001                                        0674
         BALR  @14,@15                                             0674
*       IF IOPRETRN=IOPGOOD         /* WRITE OK?             @Z40SP00*/
*         THEN                      /* YES - WRITE ANOTHER   @Z40SP00*/
         CLI   IOPRETRN(IOPPTR),0                                  0675
         BNE   @RF00675                                            0675
*         DO;                                                      0676
*           CALL HMASMIO(HMASMIOP); /* WRITE SECOND BLANK    @Z40SP00*/
         ST    IOPPTR,@AL00001                                     0677
         L     @15,@CV01807                                        0677
         LA    @01,@AL00001                                        0677
         BALR  @14,@15                                             0677
*           IF IOPRETRN=IOPGOOD     /* WRITE OK?             @Z40SP00*/
*             THEN                  /* YES                   @Z40SP00*/
         CLI   IOPRETRN(IOPPTR),0                                  0678
         BE    @RT00678                                            0678
*             GO TO DRVSCAN;        /* CONTINUE SCANNING OF NEXT CARD
*                                                            @Z40SP00*/
*         END;                      /* END WRITE OK          @Z40SP00*/
*       RCSMP=STOPSMP;              /* ONE OF WRITE FAILED - SET RTN
*                                      TO STOP SMP           @Z40SP00*/
@RF00675 MVI   RCSMP,X'10'                                         0681
*     END;                          /* END PRINT BLANKS      @Z40SP00*/
         EJECT
*                                                                  0683
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED AT THE END OF THE RUN TO PRINT THE    */
*   /* RETURN CODE, FREE ALL THE GETMAINED BUFFERS, AND RETURN       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0683
*FINAL:                                                            0683
*   DRVRTNCD=MAX(DRVRTNCD,RCSMP);   /* SAVE RC               @Z67SP00*/
@RF00667 DS    0H                                                  0683
FINAL    SLR   @08,@08                                             0683
         IC    @08,DRVRTNCD                                        0683
         SLR   @06,@06                                             0683
         IC    @06,RCSMP                                           0683
         CR    @08,@06                                             0683
         BNL   *+6
         LR    @08,@06                                             0683
         STC   @08,DRVRTNCD                                        0683
*   CCAEOSMP=ON;                    /* NOW IN SMP TERMINATION      0684
*                                      PROCESSING            @Z67SP00*/
         L     @08,@CA00042                                        0684
         OI    CCAEOSMP-HMASMCCA(@08),B'00000001'                  0684
*   RFY                                                            0685
*     SIZE RSTD;                    /* REMOVE REG FROM USE   @Z40SP00*/
*   IF CCAPBFIA^=ZERO               /* THERE A PTS/MTS/STS BUFR      */
*     THEN                          /* YES - FREE IT                 */
         ICM   @06,15,CCAPBFIA-HMASMCCA(@08)                       0686
         BZ    @RF00686                                            0686
*     DO;                                                          0687
*       SIZE=CCAPBFSZ;              /* GET BLOCK BUFF SIZE TO REG    */
         L     SIZE,CCAPBFSZ-HMASMCCA(,@08)                        0688
*       GEN(FREEMAIN E,LV=(SIZE),A=CCAPBFIA)                       0689
*       REFS(SIZE,CCAPBFIA);        /* FREE BUFFERS          @Z40SP00*/
         FREEMAIN E,LV=(SIZE),A=CCAPBFIA
*     END;                                                         0690
*   IF CCACBFIA^=ZERO               /* CDS/ACDS BUFR GETMAIN?      0691
*                                                            @SA74317*/
*     THEN                          /* YES                           */
@RF00686 L     @08,@CA00042                                        0691
         ICM   @06,15,CCACBFIA-HMASMCCA(@08)                       0691
         BZ    @RF00691                                            0691
*     DO;                           /* FREE IT               @SA74317*/
*       SIZE=CCACBFSZ;              /* CALC STORAGE SIZE     @Z40SP00*/
         L     SIZE,CCACBFSZ-HMASMCCA(,@08)                        0693
*       GEN(FREEMAIN E,LV=(SIZE),A=CCACBFIA)                       0694
*       REFS(SIZE,CCACBFIA);        /* FREE BUFFERS          @Z40SP00*/
         FREEMAIN E,LV=(SIZE),A=CCACBFIA
*     END;                          /* FOR CDS/ACDS          @SA74317*/
*   IF CCAVBFIA^=ZERO               /* SCDS BUFR GETMAIN?    @Z67SP00*/
*     THEN                          /* YES                   @Z67SP00*/
@RF00691 L     @08,@CA00042                                        0696
         ICM   @06,15,CCAVBFIA-HMASMCCA(@08)                       0696
         BZ    @RF00696                                            0696
*     DO;                           /* FREE IT               @Z67SP00*/
*       SIZE=CCAVBFSZ;              /* CALC STORAGE SIZE     @Z67SP00*/
         L     SIZE,CCAVBFSZ-HMASMCCA(,@08)                        0698
*       GEN(FREEMAIN E,LV=(SIZE),A=CCAVBFIA)                       0699
*       REFS(SIZE,CCAVBFIA);        /* FREE BUFFERS          @Z67SP00*/
         FREEMAIN E,LV=(SIZE),A=CCAVBFIA
*     END;                          /* FOR CDS/ACDS          @Z67SP00*/
*   IF CCATBFIA^=ZERO               /* TEXT LIB BUFFER       @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF00696 L     @08,@CA00042                                        0701
         ICM   @06,15,CCATBFIA-HMASMCCA(@08)                       0701
         BZ    @RF00701                                            0701
*     DO;                           /* MUST FREE IT          @Z40SP00*/
*       SIZE=CCATBFSZ;              /* GET SIZE              @Z40SP00*/
         L     SIZE,CCATBFSZ-HMASMCCA(,@08)                        0703
*       GEN(FREEMAIN E,LV=(SIZE),A=CCATBFIA)                       0704
*       REFS(SIZE,CCATBFIA);        /* FREE IT               @Z40SP00*/
         FREEMAIN E,LV=(SIZE),A=CCATBFIA
*     END;                          /* END TEXT LIB FREE     @Z40SP00*/
*   IF CCAWBFIA^=ZERO               /* WRKX BUFR GETMAIN?    @Z67SP00*/
*     THEN                          /* YES                   @Z67SP00*/
@RF00701 L     @08,@CA00042                                        0706
         ICM   @06,15,CCAWBFIA-HMASMCCA(@08)                       0706
         BZ    @RF00706                                            0706
*     DO;                           /* FREE IT               @Z67SP00*/
*       SIZE=CCAWBFSZ;              /* CALC STORAGE SIZE     @Z67SP00*/
         L     SIZE,CCAWBFSZ-HMASMCCA(,@08)                        0708
*       GEN(FREEMAIN E,LV=(SIZE),A=CCAWBFIA)                       0709
*       REFS(SIZE,CCAWBFIA);        /* FREE BUFFERS          @Z67SP00*/
         FREEMAIN E,LV=(SIZE),A=CCAWBFIA
*     END;                          /* FOR CDS/ACDS          @Z67SP00*/
*   IF CCA4BFIA^=ZERO               /* WRKX BUFR GETMAIN?    @Z67SP00*/
*     THEN                          /* YES                   @Z67SP00*/
@RF00706 L     @08,@CA00042                                        0711
         ICM   @06,15,CCA4BFIA-HMASMCCA(@08)                       0711
         BZ    @RF00711                                            0711
*     DO;                           /* FREE IT               @Z67SP00*/
*       SIZE=CCA4BFSZ;              /* CALC STORAGE SIZE     @Z67SP00*/
         L     SIZE,CCA4BFSZ-HMASMCCA(,@08)                        0713
*       GEN(FREEMAIN E,LV=(SIZE),A=CCA4BFIA)                       0714
*       REFS(SIZE,CCA4BFIA);        /* FREE BUFFERS          @Z67SP00*/
         FREEMAIN E,LV=(SIZE),A=CCA4BFIA
*     END;                          /* FOR CDS/ACDS          @Z67SP00*/
*   IF CCAQBFIA^=ZERO               /* CRQ/ACRQ BUFR GETMAIN?      0716
*                                                            @Z67SP00*/
*     THEN                          /* YES                   @Z67SP00*/
@RF00711 L     @08,@CA00042                                        0716
         ICM   @06,15,CCAQBFIA-HMASMCCA(@08)                       0716
         BZ    @RF00716                                            0716
*     DO;                           /* FREE IT               @Z67SP00*/
*       SIZE=CCAQBFSZ;              /* CALC STORAGE SIZE     @Z67SP00*/
         L     SIZE,CCAQBFSZ-HMASMCCA(,@08)                        0718
*       GEN(FREEMAIN E,LV=(SIZE),A=CCAQBFIA)                       0719
*       REFS(SIZE,CCAQBFIA);        /* FREE BUFFERS          @Z67SP00*/
         FREEMAIN E,LV=(SIZE),A=CCAQBFIA
*     END;                          /* FOR CDS/ACDS          @Z67SP00*/
*                                                                  0721
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE LINKLIB DCB IF OPEN                             @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0721
*   IF CCASPDCB^=ZERO               /* IF LINKLIB DCB OPENED @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00716 L     @08,@CA00042                                        0721
         L     @08,CCASPDCB-HMASMCCA(,@08)                         0721
         LTR   @08,@08                                             0721
         BZ    @RF00721                                            0721
*     DO;                           /*                       @Z67SP00*/
*       RFY                                                        0723
*         DCBPTR RSTD;              /*                       @Z67SP00*/
*       DCBPTR=CCASPDCB;            /*                       @Z67SP00*/
         LR    DCBPTR,@08                                          0724
*       IF DCBOFOPN=ON              /* WAS LINKLIB DCB OPENED?       */
*         THEN                      /* YES - CLOSE IT                */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0725
         BNO   @RF00725                                            0725
*         DO;                       /*                       @Z40SP00*/
*           GEN(CLOSE ((DCBPTR)));  /* CLOSE LINKLIB DCB     @Z67SP00*/
         CLOSE ((DCBPTR))
*           IF DCBOFOPN=ON          /* IF CLOSE FAILS        @Z40SP00*/
*             THEN                  /* PUT OUT ERR MSG       @Z40SP00*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0728
         BNO   @RF00728                                            0728
*             DO;                   /*                       @Z40SP00*/
*               MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MSG PARM @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0730
*               MGPTYPE=MGPSEV;     /* SET SEVERITY          @ZD00001*/
         MVI   MGPTYPE,X'04'                                       0731
*               MGPMGNO1=HMA201I;   /* XXXXX FAILED FOR LIBRARYE   0732
*                                      SPECIFIED BY XXXXXXXX @Z40SP00*/
         MVC   MGPMGNO1(2),@CH00187                                0732
*               MGPVARPT(1)=ADDR(TXTCLOSE);/*                @Z40SP00*/
         LA    @08,@CC01795                                        0733
         ST    @08,MGPVARPT                                        0733
*               MGPVARPT(2)=ADDR(LINKLIB);/*                 @Z40SP00*/
         LA    @08,@CC01767                                        0734
         ST    @08,MGPVARPT+4                                      0734
*               CALL HMASMMSG(HMASMMGP);/*                   @Z40SP00*/
         L     @15,@CV01809                                        0735
         LA    @01,@AL00735                                        0735
         BALR  @14,@15                                             0735
*               DRVRTNCD=MAX(DRVRTNCD,IOPNTOPN);/* SET RC    @Z67SP00*/
         SLR   @08,@08                                             0736
         IC    @08,DRVRTNCD                                        0736
         LA    @06,12                                              0736
         CR    @08,@06                                             0736
         BNL   *+6
         LR    @08,@06                                             0736
         STC   @08,DRVRTNCD                                        0736
*             END;                  /* END CLOSE FAILED      @Z40SP00*/
*         END;                      /* END LINKLIB WAS OPEN  @Z40SP00*/
@RF00728 DS    0H                                                  0739
*       RFY                                                        0739
*         DCBPTR UNRSTD;            /*                       @Z67SP00*/
@RF00725 DS    0H                                                  0740
*     END;                          /*                       @Z67SP00*/
*                                                                  0741
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE IN STORAGE DIRECTORIES                           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0741
*   CALL HMASMDR1(TBLPARM,LISTPARM);/* CALL DR1 TO FREE ALL        0741
*                                      DIRECTORIES IN STORAGE. DR1 0741
*                                      KNOWS THIS BECAUSE ALL CCA  0741
*                                      FUNCTION FLAGS ARE ZERO     0741
*                                                            @Z67SP00*/
@RF00721 L     @15,@CV01803                                        0741
         LA    @01,@AL00741                                        0741
         BALR  @14,@15                                             0741
*   RFY                                                            0742
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   DRVRTNCD=MAX(DRVRTNCD,RTNCODE); /* SAVE RC               @Z67SP00*/
         SLR   @14,@14                                             0743
         IC    @14,DRVRTNCD                                        0743
         CR    @14,RTNCODE                                         0743
         BNL   *+6
         LR    @14,RTNCODE                                         0743
         STC   @14,DRVRTNCD                                        0743
*   RFY                                                            0744
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*                                                                  0744
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW CALL USER EXIT INTERFACE ROUTINE TO DELETE ANY EXITS      */
*   /* LOADED FOR THIS FUNCTION                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0745
*   CALL HMASMUXC(0,0);             /* DUMMY PARMS           @Z67SP00*/
         L     @15,@CV01818                                        0745
         LA    @01,@AL00745                                        0745
         BALR  @14,@15                                             0745
*   RFY                             /*                       @Z67SP00*/
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   DRVRTNCD=MAX(DRVRTNCD,RTNCODE); /* UPDATE RETURN CODE    @Z67SP00*/
         SLR   @14,@14                                             0747
         IC    @14,DRVRTNCD                                        0747
         CR    @14,RTNCODE                                         0747
         BNL   *+6
         LR    @14,RTNCODE                                         0747
         STC   @14,DRVRTNCD                                        0747
*   RFY                             /*                       @Z67SP00*/
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*                                                                  0748
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE SMP COMLETED MESSAGE                            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0749
*   CVD(DRVRTNCD,DBLWRD);           /* CONVERT RC            @Z67SP00*/
         CVD   @14,DBLWRD                                          0749
*   UNPK(CHARCOL,DBLWRD);           /* MAKE EBCDIC                   */
         UNPK  CHARCOL(2),DBLWRD(8)                                0750
*   LASTDIG=LASTDIG×MAKEPRNT;       /* MAKE PRINTABLE                */
         OI    LASTDIG,X'F0'                                       0751
*   MGPCLEAR=MGPCLEAR&&MGPCLEAR;    /* ZERO MSG PARM         @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0752
*   MGPTYPE=MGPINFO;                /* SET SEVERITY          @ZD00001*/
         MVI   MGPTYPE,X'01'                                       0753
*   MGPMGNO1=HMA205I;               /* INDICATE END MESSAGE          */
         MVC   MGPMGNO1(2),@CH00204                                0754
*   MGPVARPT(1)=ADDR(TXTSMP);       /* SET PTR TO VARIABLE SECTION   */
         LA    @08,@CC01839                                        0755
         ST    @08,MGPVARPT                                        0755
*   MGPVARPT(2)=ADDR(CHARCOL);      /* SET PTR TO VARIABLE SECTION   */
         LA    @08,CHARCOL                                         0756
         ST    @08,MGPVARPT+4                                      0756
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE TO PRINTER      */
         L     @15,@CV01809                                        0757
         LA    @01,@AL00757                                        0757
         BALR  @14,@15                                             0757
*                                                                  0758
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL HMASMSTA TO CANCEL STAE ENVIRONMENT              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0758
*   CCARVCAN=ON;                    /* CANCEL STAE           @Z67SP00*/
         L     @08,@CA00042                                        0758
         OI    CCARVCAN-HMASMCCA(@08),B'00000100'                  0758
*   CALL HMASMSTA;                  /*                       @Z67SP00*/
         L     @15,@CV01812                                        0759
         BALR  @14,@15                                             0759
*   RFY                                                            0760
*     RTNCODE RSTD;                 /*                       @Z67SP00*/
*   IF RTNCODE>STOPPTF              /* IF STA FAILED         @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         CH    RTNCODE,@CH00116                                    0761
         BNH   @RF00761                                            0761
*     DRVRTNCD=MAX(DRVRTNCD,RTNCODE);/* SET RC               @Z67SP00*/
         SLR   @14,@14                                             0762
         IC    @14,DRVRTNCD                                        0762
         CR    @14,RTNCODE                                         0762
         BNL   *+6
         LR    @14,RTNCODE                                         0762
         STC   @14,DRVRTNCD                                        0762
*   RFY                                                            0763
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/
*                                                                  0763
@RF00761 DS    0H                                                  0764
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE ALL OPEN DCBS                                   @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0764
*   IOPFUNCT=IOPCLOSA;              /* INDICATE CLOSE ALL FILES      */
         MVI   IOPFUNCT(IOPPTR),X'57'                              0764
*   CALL HMASMIO(HMASMIOP);         /* CLOSE ALL OPEN FILES          */
         ST    IOPPTR,@AL00001                                     0765
         L     @15,@CV01807                                        0765
         LA    @01,@AL00001                                        0765
         BALR  @14,@15                                             0765
*   DRVRTNCD=MAX(DRVRTNCD,IOPRETRN);/*                       @Z67SP00*/
*                                                                  0766
         SLR   @08,@08                                             0766
         IC    @08,DRVRTNCD                                        0766
         SLR   @06,@06                                             0766
         IC    @06,IOPRETRN(,IOPPTR)                               0766
         CR    @08,@06                                             0766
         BNL   *+6
         LR    @08,@06                                             0766
         STC   @08,DRVRTNCD                                        0766
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE IOP                                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0767
*   IF CCAIOPTR^=ADDR(DRVIOP)       /* IF IOP GETMAINED      @Z67SP00*/
*     THEN                          /* THEN                  @Z67SP00*/
         L     @08,@CA00042                                        0767
         L     @08,CCAIOPTR-HMASMCCA(,@08)                         0767
         LA    @06,DRVIOP                                          0767
         CR    @08,@06                                             0767
         BE    @RF00767                                            0767
*     DO;                           /* FREE IT               @Z67SP00*/
*       SPLFUNCT=SPLFMIOP;          /*                       @Z67SP00*/
         MVI   SPLFUNCT,X'04'                                      0769
*       SPLPMAD=CCAIOPTR;           /*                       @Z67SP00*/
         ST    @08,SPLPMAD                                         0770
*       CALL HMASMSUB(HMASMSPL);    /* FREE IOP              @Z67SP00*/
         L     @15,@CV01813                                        0771
         LA    @01,@AL00771                                        0771
         BALR  @14,@15                                             0771
*       RFY                                                        0772
*         RTNCODE RSTD;             /*                       @Z67SP00*/
*       DRVRTNCD=MAX(DRVRTNCD,RTNCODE);/* SAVE RC            @Z67SP00*/
         SLR   @14,@14                                             0773
         IC    @14,DRVRTNCD                                        0773
         CR    @14,RTNCODE                                         0773
         BNL   *+6
         LR    @14,RTNCODE                                         0773
         STC   @14,DRVRTNCD                                        0773
*       RFY                                                        0774
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*   IF CCATERM=ON                   /* ERR IN MSG RTN?       @YA07506*/
*     THEN                          /*                       @YA07506*/
@RF00767 L     @08,@CA00042                                        0776
         TM    CCATERM-HMASMCCA(@08),B'00100000'                   0776
         BNO   @RF00776                                            0776
*     DRVRTNCD=MAX(DRVRTNCD,STOPSMP);/* SET RC TO MIN OF 16  @Z67SP00*/
*                                                                  0777
         SLR   @08,@08                                             0777
         IC    @08,DRVRTNCD                                        0777
         LA    @06,16                                              0777
         CR    @08,@06                                             0777
         BNL   *+6
         LR    @08,@06                                             0777
         STC   @08,DRVRTNCD                                        0777
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0778
*   RETURN CODE(DRVRTNCD);          /* EXIT - END OF RUN             */
@RF00776 SLR   @15,@15                                             0778
         IC    @15,DRVRTNCD                                        0778
         L     @13,4(,@13)                                         0778
         L     @14,12(,@13)                                        0778
         LM    @00,@12,20(@13)                                     0778
         BR    @14                                                 0778
*   RFY                                                            0779
*     SIZE UNRSTD;                  /* RETURN REG FOR USE    @Z40SP00*/
*                                                                  0780
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED AFTER EACH FUNCTION REQUEST IS         */
*   /* COMPLETED. IT PUTS OUT MSG HMA205I INDICATING THAT THE        */
*   /* FUNCTION HAS COMPLETED AND INDICATING THE RETURN CODE FROM THE*/
*   /* FUNCTION                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0780
*FUNCTMSG:                          /*                       @YA07506*/
*   PROCEDURE;                      /*                               */
@EL00001 L     @13,4(,@13)                                         0780
@EF00001 DS    0H                                                  0780
@ER00001 LM    @14,@12,12(@13)                                     0780
         BR    @14                                                 0780
FUNCTMSG STM   @14,@12,@SA00002                                    0780
*   IF CCAREC=ON                    /* RECEIVE FUNCTION?     @YA07506*/
*     THEN                          /* YES                   @YA07506*/
         L     @08,@CA00042                                        0781
         TM    CCAREC-HMASMCCA(@08),B'10000000'                    0781
         BNO   @RF00781                                            0781
*     RCREC=MAX(RCREC,SAVECODE);    /* SAVE HIGHEST RC       @YA07506*/
         SLR   @08,@08                                             0782
         IC    @08,RCREC                                           0782
         L     @06,SAVECODE                                        0782
         CR    @08,@06                                             0782
         BNL   *+6
         LR    @08,@06                                             0782
         STC   @08,RCREC                                           0782
*   IF CCAREJ=ON                    /* REJECT FUNCTION?      @YA07506*/
*     THEN                          /* YES                   @YA07506*/
@RF00781 L     @08,@CA00042                                        0783
         TM    CCAREJ-HMASMCCA(@08),B'00010000'                    0783
         BNO   @RF00783                                            0783
*     RCREJ=MAX(RCREJ,SAVECODE);    /* SAVE HIGHEST RC       @Z40SP00*/
         SLR   @08,@08                                             0784
         IC    @08,RCREJ                                           0784
         L     @06,SAVECODE                                        0784
         CR    @08,@06                                             0784
         BNL   *+6
         LR    @08,@06                                             0784
         STC   @08,RCREJ                                           0784
*   IF CCAAPPLY=ON                  /* APPLY FUNCTION?       @YA07506*/
*     THEN                          /* YES                   @YA07506*/
@RF00783 L     @08,@CA00042                                        0785
         TM    CCAAPPLY-HMASMCCA(@08),B'01000000'                  0785
         BNO   @RF00785                                            0785
*     RCAPP=MAX(RCAPP,SAVECODE);    /* SAVE HIGHEST RC       @Z40SP00*/
         SLR   @08,@08                                             0786
         IC    @08,RCAPP                                           0786
         L     @06,SAVECODE                                        0786
         CR    @08,@06                                             0786
         BNL   *+6
         LR    @08,@06                                             0786
         STC   @08,RCAPP                                           0786
*   IF CCARES=ON                    /* RESTORE FUNCTION?     @YA07506*/
*     THEN                          /* YES                   @YA07506*/
@RF00785 L     @08,@CA00042                                        0787
         TM    CCARES-HMASMCCA(@08),B'00001000'                    0787
         BNO   @RF00787                                            0787
*     RCRST=MAX(RCRST,SAVECODE);    /* SAVE HIGHEST RC       @Z40SP00*/
         SLR   @08,@08                                             0788
         IC    @08,RCRST                                           0788
         L     @06,SAVECODE                                        0788
         CR    @08,@06                                             0788
         BNL   *+6
         LR    @08,@06                                             0788
         STC   @08,RCRST                                           0788
*   IF CCAACCPT=ON                  /* ACCEPT FUNCTION?      @YA07506*/
*     THEN                          /* YES                   @Z40SP00*/
@RF00787 L     @08,@CA00042                                        0789
         TM    CCAACCPT-HMASMCCA(@08),B'00100000'                  0789
         BNO   @RF00789                                            0789
*     RCACC=MAX(RCACC,SAVECODE);    /* SAVE HIGHEST RC       @Z40SP00*/
         SLR   @08,@08                                             0790
         IC    @08,RCACC                                           0790
         L     @06,SAVECODE                                        0790
         CR    @08,@06                                             0790
         BNL   *+6
         LR    @08,@06                                             0790
         STC   @08,RCACC                                           0790
*   IF CCALIST=ON                   /* IF LIST CDS/ACDS REQ  @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
@RF00789 L     @08,@CA00042                                        0791
         TM    CCALIST-HMASMCCA(@08),B'00000001'                   0791
         BNO   @RF00791                                            0791
*     RCLIST=MAX(RCLIST,SAVECODE);  /* SAVE HIGHEST RC       @Z40SP00*/
         SLR   @08,@08                                             0792
         IC    @08,RCLIST                                          0792
         L     @06,SAVECODE                                        0792
         CR    @08,@06                                             0792
         BNL   *+6
         LR    @08,@06                                             0792
         STC   @08,RCLIST                                          0792
*   IF CCALOG=ON                    /* LOG FUNCTION?         @Z67SP00*/
*     THEN                          /* YES                   @YA07506*/
@RF00791 L     @08,@CA00042                                        0793
         TM    CCALOG-HMASMCCA(@08),B'01000000'                    0793
         BNO   @RF00793                                            0793
*     RCLOG=MAX(RCLOG,SAVECODE);    /* SAVE HIGHEST RC       @Z40SP00*/
         SLR   @08,@08                                             0794
         IC    @08,RCLOG                                           0794
         L     @06,SAVECODE                                        0794
         CR    @08,@06                                             0794
         BNL   *+6
         LR    @08,@06                                             0794
         STC   @08,RCLOG                                           0794
*   IF CCAUPDU=ON                   /* UCLIN FUNCTION?       @YA07506*/
*     THEN                          /* YES                   @YA07506*/
@RF00793 L     @08,@CA00042                                        0795
         TM    CCAUPDU-HMASMCCA(@08),B'00000010'                   0795
         BNO   @RF00795                                            0795
*     RCUCL=MAX(RCUCL,SAVECODE);    /* SAVE HIGHEST RC       @Z40SP00*/
         SLR   @08,@08                                             0796
         IC    @08,RCUCL                                           0796
         L     @06,SAVECODE                                        0796
         CR    @08,@06                                             0796
         BNL   *+6
         LR    @08,@06                                             0796
         STC   @08,RCUCL                                           0796
*   IF CCAUPDJ=ON                   /* JCLIN FUNCTION?       @YA07506*/
*     THEN                          /* YES                   @YA07506*/
@RF00795 L     @08,@CA00042                                        0797
         TM    CCAUPDJ-HMASMCCA(@08),B'00000100'                   0797
         BNO   @RF00797                                            0797
*     RCJCL=MAX(RCJCL,SAVECODE);    /* SAVE HIGHEST RC       @Z40SP00*/
         SLR   @08,@08                                             0798
         IC    @08,RCJCL                                           0798
         L     @06,SAVECODE                                        0798
         CR    @08,@06                                             0798
         BNL   *+6
         LR    @08,@06                                             0798
         STC   @08,RCJCL                                           0798
*   IF CCACNV=ON                    /* CONVERT FUNCTION?     @ZD00004*/
*     THEN                          /*                       @ZD00004*/
@RF00797 L     @08,@CA00042                                        0799
         TM    CCACNV-HMASMCCA(@08),B'10000000'                    0799
         BNO   @RF00799                                            0799
*     RCCNV=MAX(RCCNV,SAVECODE);    /*                       @ZD00004*/
         SLR   @08,@08                                             0800
         IC    @08,RCCNV                                           0800
         L     @06,SAVECODE                                        0800
         CR    @08,@06                                             0800
         BNL   *+6
         LR    @08,@06                                             0800
         STC   @08,RCCNV                                           0800
*   RCSMP=MAX(RCSMP,SAVECODE);      /* SET TEMP SMP RC       @YA07506*/
@RF00799 L     @08,SAVECODE                                        0801
         SLR   @06,@06                                             0801
         IC    @06,RCSMP                                           0801
         CR    @06,@08                                             0801
         BNL   *+6
         LR    @06,@08                                             0801
         STC   @06,RCSMP                                           0801
*   DRVRTNCD=MAX(DRVRTNCD,SAVECODE);/* SET FINAL SMP RC      @Z40SP00*/
         SLR   @06,@06                                             0802
         IC    @06,DRVRTNCD                                        0802
         CR    @06,@08                                             0802
         BNL   *+6
         LR    @06,@08                                             0802
         STC   @06,DRVRTNCD                                        0802
*   CVD(SAVECODE,DBLWRD);           /* CONVERT FOR PRINT     @Z40SP00*/
         CVD   @08,DBLWRD                                          0803
*   UNPK(CHARCOL,DBLWRD);           /* MAKE EBCDIC           @YA07506*/
         UNPK  CHARCOL(2),DBLWRD(8)                                0804
*   LASTDIG=LASTDIG×MAKEPRNT;       /* MAKE PRINTABLE        @YA07506*/
         OI    LASTDIG,X'F0'                                       0805
*   MGPCLEAR=MGPCLEAR&&MGPCLEAR;    /* ZERO MSG PARM         @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0806
*   MGPTYPE=MGPINFO;                /* SET SEVERITY          @ZD00001*/
         MVI   MGPTYPE,X'01'                                       0807
*   MGPMGNO1=HMA205I;               /* XXXXXXXX PROCESSING COMPLETED
*                                      HIGHEST RETURN CODE IS XX     */
         MVC   MGPMGNO1(2),@CH00204                                0808
*   MGPVARPT(1)=ADDR(CCAFUNCT);     /* PTR TO FUNCTION ID    @Z67SP00*/
         L     @08,@CA00042                                        0809
         LA    @08,CCAFUNCT-HMASMCCA(,@08)                         0809
         ST    @08,MGPVARPT                                        0809
*   MGPVARPT(2)=ADDR(CHARCOL);      /* POINT TO RETURN CODE  @YA07506*/
         LA    @08,CHARCOL                                         0810
         ST    @08,MGPVARPT+4                                      0810
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MSG             @YA07506*/
         L     @15,@CV01809                                        0811
         LA    @01,@AL00811                                        0811
         BALR  @14,@15                                             0811
*   END FUNCTMSG;                   /*                       @YA07506*/
@EL00002 DS    0H                                                  0812
@EF00002 DS    0H                                                  0812
@ER00002 LM    @14,@12,@SA00002                                    0812
         BR    @14                                                 0812
*                                                                  0813
*   /*****************************************************************/
*   /*                                                               */
*   /* THE REST OF THE HMASMDRV MODULE CONSISTS OF DSCAN ROUTS. THESE*/
*   /* ROUTS WILL BE CALLED FROM HMASMSCN WHENEVER THE KEY IS FOUND  */
*   /* AND THE ROUT IS SPECIFIED. REGISTER ONE WILL BE RESTRICTED    */
*   /* SINCE HMASMSCN DEPENDS UPON REGISTER ONE NOT BEING CHANGED. IT*/
*   /* KEEPS THE ADDRESS OF ITS SAVE AREA IN AN AREA IN THE HMASMSCP */
*   /* AND REGISTER ONE POINTS TO THE HMASMSCP               @Z40SP00*/
*   /* THE RETURN REG(REG14) IS ALSO RESTRICTED SO THAT SAVE AREAS   */
*   /* WILL NOT BE NEEDED FOR EACH PROC                      @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0813
*   RFY                                                            0813
*     R1 RSTD;                      /*                       @Z40SP00*/
*   RFY                                                            0814
*     RTNREG RSTD;                  /*                       @Z40SP00*/
*                                                                  0815
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINES ARE INVOKED WHEN SCAN ENCOUNTERS THE   */
*   /* ASSOCIATED CONTROL VERB IN THE INPUT STREAM.                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0815
*VERBSETS:                                                         0815
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
VERBSETS DS    0H                                                  0816
*   DECLARE                         /*                       @Z67SP00*/
*     SAVCHAR PTR(31);              /* SAVE FOR SCPCHAR      @Z67SP00*/
*                                                                  0816
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR RECEIVE OPERATIONS                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0817
*RECSAV:                                                           0817
*   ENTRY;                                                         0817
         B     @EC00817                                            0817
RECSAV   DS    0H                                                  0817
@EC00817 DS    0H                                                  0818
*   CCAREC=ON;                      /* INDICATE RECEIVE VERB         */
         L     @15,@CA00042                                        0818
         OI    CCAREC-HMASMCCA(@15),B'10000000'                    0818
*   CCAFUNCT=TXTREC;                /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01833                   0819
*   GO TO VERBEXIT;                 /* RETURN                        */
*                                                                  0820
         B     VERBEXIT                                            0820
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE APPLY VERB                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0821
*APPSAV:                                                           0821
*   ENTRY;                                                         0821
APPSAV   DS    0H                                                  0822
*   CCAAPPLY=ON;                    /* INDICATE APPLY VERB           */
         L     @15,@CA00042                                        0822
         OI    CCAAPPLY-HMASMCCA(@15),B'01000000'                  0822
*   CCAFUNCT=TXTAPP;                /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01824                   0823
*   GO TO VERBEXIT;                 /* RETURN                        */
*                                                                  0824
         B     VERBEXIT                                            0824
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE ACCEPT VERB                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0825
*ACCSAV:                                                           0825
*   ENTRY;                                                         0825
ACCSAV   DS    0H                                                  0826
*   CCAACCPT=ON;                    /* INDICATE ACCEPT VERB          */
         L     @15,@CA00042                                        0826
         OI    CCAACCPT-HMASMCCA(@15),B'00100000'                  0826
*   CCAFUNCT=TXTACC;                /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01822                   0827
*   GO TO VERBEXIT;                 /* RETURN                        */
         B     VERBEXIT                                            0828
*                                                                  0829
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE REJECT VERB                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0829
*REJSAV:                                                           0829
*   ENTRY;                                                         0829
REJSAV   DS    0H                                                  0830
*   CCAREJ=ON;                      /* INDICATE REJECT VERB          */
         L     @15,@CA00042                                        0830
         OI    CCAREJ-HMASMCCA(@15),B'00010000'                    0830
*   CCAFUNCT=TXTREJ;                /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01835                   0831
*   GO TO VERBEXIT;                 /* RETURN                        */
*                                                                  0832
         B     VERBEXIT                                            0832
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE RESTORE VERB                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0833
*RESSAV:                                                           0833
*   ENTRY;                                                         0833
RESSAV   DS    0H                                                  0834
*   CCARES=ON;                      /* INDICATE RESTORE VERB         */
         L     @15,@CA00042                                        0834
         OI    CCARES-HMASMCCA(@15),B'00001000'                    0834
*   CCAFUNCT=TXTRST;                /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01837                   0835
*   GO TO VERBEXIT;                 /* RETURN                        */
*                                                                  0836
         B     VERBEXIT                                            0836
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE UCLIN VERB                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0837
*UCLSAV:                                                           0837
*   ENTRY;                                                         0837
UCLSAV   DS    0H                                                  0838
*   CCAUPDU=ON;                     /* INDICATE UCL VERB             */
         L     @15,@CA00042                                        0838
         OI    CCAUPDU-HMASMCCA(@15),B'00000010'                   0838
*   CCAFUNCT=TXTUCL;                /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01841                   0839
*   GO TO VERBEXIT;                 /* RETURN                        */
*                                                                  0840
         B     VERBEXIT                                            0840
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUT FOR UCLIN ACDS OPTION                            @SA73849*/
*   /* THIS ROUTINE IS INVOKED FOR ALL OF THE LIST VERBS     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0841
*LSTSAV:                            /*                       @Z40SP00*/
*   ENTRY;                          /*                       @Z40SP00*/
LSTSAV   DS    0H                                                  0842
*   CCALIST=ON;                     /* DEFAULT IS LCD CALL   @Z40SP00*/
         L     @15,@CA00042                                        0842
         OI    CCALIST-HMASMCCA(@15),B'00000001'                   0842
*   CCAFUNCT=TXTLIST;               /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01828                   0843
*   LISTCNT=ZERO;                   /* COUNTERS              @Z40SP00*/
         SLR   @15,@15                                             0844
         STH   @15,LISTCNT                                         0844
*   SELSTFLG=''B;                   /* ZERO SET TYPE FLAG    @Z67SP00*/
         XC    SELSTFLG(2),SELSTFLG                                0845
*   GO TO VERBEXIT;                 /*                       @Z40SP00*/
*                                                                  0846
         B     VERBEXIT                                            0846
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE JCLIN VERB                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0847
*JCLSAV:                                                           0847
*   ENTRY;                                                         0847
JCLSAV   DS    0H                                                  0848
*   UPDPARM=UPDPARM&&UPDPARM;       /* RESET UPD OPTION BITS @Z40SP00*/
         XC    UPDPARM(121),UPDPARM                                0848
*   CCAUPDJ=ON;                     /* INDICATE JCLIN VERB           */
         L     @15,@CA00042                                        0849
         OI    CCAUPDJ-HMASMCCA(@15),B'00000100'                   0849
*   CCAFUNCT=TXTJCL;                /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01797                   0850
*   GO TO VERBEXIT;                 /* RETURN                @Z40SP00*/
*                                                                  0851
         B     VERBEXIT                                            0851
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE LOG VERB              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0852
*LOGSV:                                                            0852
*   ENTRY;                          /*                       @Z67SP00*/
LOGSV    DS    0H                                                  0853
*   CCALOG=ON;                      /* INDICATE LOG VERB     @Z67SP00*/
         L     @15,@CA00042                                        0853
         OI    CCALOG-HMASMCCA(@15),B'01000000'                    0853
*   CCAFUNCT=TXTLOG;                /* PUT FUNCTION ID IN    @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01830                   0854
*   CRPLOG=OFF;                     /* DO NOT WRITE LOG STMTS TO LOG
*                                                            @Z67SP00*/
         NI    CRPLOG,B'11101111'                                  0855
*   GO TO VERBEXIT;                 /* RETURN                @Z40SP00*/
*                                                                  0856
         B     VERBEXIT                                            0856
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDEL RESETRC FUNCTION                    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0857
*RESETSAV:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
RESETSAV DS    0H                                                  0858
*   CCARESET=ON;                    /*                       @Z67SP00*/
         L     @15,@CA00042                                        0858
         OI    CCARESET-HMASMCCA(@15),B'00100000'                  0858
*   CCAFUNCT=TXTRESET;              /*                       @Z67SP00*/
         MVC   CCAFUNCT-HMASMCCA(8,@15),@CC01843                   0859
*   GO TO VERBEXIT;                 /*                       @Z67SP00*/
*                                                                  0860
         B     VERBEXIT                                            0860
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON RETURN TO HMASMSCN FROM VERB ROUTS             @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0861
*VERBEXIT:                                                         0861
*                                                                  0861
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR FUNCTIONS THAT REQUIRE THE CONTROL CARD TO BE       */
*   /* PRINTED ON THE SMPLIST OR SMPRPT DATASET AND CALL HMASMCRD TO */
*   /* DO WRITE                                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0861
*   IF(CCAAPPLY=ON                  /* IF FUNCTION THAT HAS  @Z67SP00*/
*       ×CCAACCPT=ON                /* POSSIBLE OUTPUT TO    @Z67SP00*/
*       ×CCARES=ON                  /* SMPRPT AND RPT IS     @Z67SP00*/
*       ×CCAREC=ON)                 /*                       @Z67SP00*/
*       &CCARPTDS=IOPRPT            /* TO BE USED            @Z67SP00*/
*     THEN                          /* THEN SET BIT TO WRITE @Z67SP00*/
VERBEXIT L     @15,@CA00042                                        0861
         TM    CCAAPPLY-HMASMCCA(@15),B'11101000'                  0861
         BZ    @RF00861                                            0861
         CLI   CCARPTDS-HMASMCCA(@15),41                           0861
         BNE   @RF00861                                            0861
*     CRPRPT=ON;                    /* TO SMPRPT             @Z67SP00*/
         OI    CRPRPT,B'00001000'                                  0862
*   IF CCALIST=ON                   /* IF FUNCTION THAT HAS  @Z67SP00
*                                      POSSIBLE OUTPUT TO SMPLIST AND
*                                      SMPLIST               @Z67SP00*/
*       &CCALSTDS=IOPLIST           /* TO BE USED            @Z67SP00*/
*     THEN                          /* THEN SET BIT TO WRITE @Z67SP00*/
@RF00861 L     @15,@CA00042                                        0863
         TM    CCALIST-HMASMCCA(@15),B'00000001'                   0863
         BNO   @RF00863                                            0863
         CLI   CCALSTDS-HMASMCCA(@15),42                           0863
         BNE   @RF00863                                            0863
*     CRPLIST=ON;                   /* TO SMPLIST            @Z67SP00*/
         OI    CRPLIST,B'00010000'                                 0864
*   IF(CRPLIST=ON×CRPRPT=ON)        /* IF OUTPUT TO EITHER   @Z67SP00*/
*     THEN                          /* THEN CALL CRP TO      @Z67SP00*/
@RF00863 TM    CRPLIST,B'00011000'                                 0865
         BZ    @RF00865                                            0865
*     DO;                           /* WRITE CURRENT CARD    @Z67SP00*/
*       SAVR1=R1;                   /* SAVE R1 AN R14 ACROSS @Z67SP00*/
         ST    R1,SAVR1                                            0867
*       SAVRTN=RTNREG;              /* CALL                  @Z67SP00*/
         ST    RTNREG,SAVRTN                                       0868
*       RFY                                                        0869
*        (R1,                                                      0869
*         RTNREG) UNRSTD;           /*                       @Z67SP00*/
*       CRPBFPRM=ON;                /* BUFFER PRIMED NO READ @Z67SP00*/
*       CRPPRINT=OFF;               /* NOT TO SMPOUT         @Z67SP00*/
*       CRPLOG=OFF;                 /* NOT TO SMPOUT         @Z67SP00*/
         OI    CRPBFPRM,B'10000000'                                0872
         NI    CRPPRINT,B'11100111'                                0872
*       SAVCHAR=SCPCHAR;            /* SAVE CURRENT SCAN POS @Z67SP00*/
         MVC   SAVCHAR(4),SCPCHAR                                  0873
*       CALL HMASMCRD(HMASMCRP);    /* NEEDED B4 WRITE       @Z67SP00*/
         L     @15,@CV01802                                        0874
         LA    @01,@AL00874                                        0874
         BALR  @14,@15                                             0874
*       RFY                                                        0875
*        (R1,                                                      0875
*         RTNREG) RSTD;             /*                       @Z67SP00*/
*       CRPBFPRM=OFF;               /* RESET PRIMED          @Z67SP00*/
*       CRPPRINT=ON;                /* NOW TO SMPLOG AGAIN   @Z67SP00*/
*       CRPLOG=ON;                  /* NOW TO SMPLOG AGAIN   @Z67SP00*/
         OI    CRPPRINT,B'00011000'                                0878
         NI    CRPBFPRM,B'01111111'                                0878
*       SCPCHAR=SAVCHAR;            /* RESET SCAN POSITION   @Z67SP00*/
         MVC   SCPCHAR(4),SAVCHAR                                  0879
*       R1=SAVR1;                   /* RESTORE REGS          @Z67SP00*/
         L     R1,SAVR1                                            0880
*       RTNREG=SAVRTN;              /*                       @Z67SP00*/
         L     RTNREG,SAVRTN                                       0881
*     END;                          /*                       @Z67SP00*/
*   END VERBSETS;                                                  0883
@EL00003 DS    0H                                                  0883
@EF00003 DS    0H                                                  0883
@ER00003 BR    @14                                                 0883
*                                                                  0884
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINES FOR DATASET OPTION FOR UCLIN                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0884
*UCLDSSET:                          /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
*                                                                  0884
UCLDSSET DS    0H                                                  0885
*   /*****************************************************************/
*   /*                                                               */
*   /* UCLIN CDS OPTION                                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0885
*UCLCDSV:                                                          0885
*   ENTRY;                          /*                       @SA73849*/
         B     @EC00885                                            0885
UCLCDSV  DS    0H                                                  0885
@EC00885 DS    0H                                                  0886
*   IF TBLFLG3=ZERO                 /* IF NO OTHER DS SPEC.  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         ICM   @15,3,TBLFLG3                                       0886
         BNZ   @RF00886                                            0886
*     TBLCDS=ON;                    /* SET TO USE CDS        @Z67SP00*/
         OI    TBLCDS,B'10000000'                                  0887
*   ELSE                            /*                       @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00886                                            0888
@RF00886 MVI   SCPRETRN,X'08'                                      0888
*   RETURN;                         /* RETURN                @Z67SP00*/
*                                                                  0889
@EL00004 DS    0H                                                  0889
@EF00004 DS    0H                                                  0889
@ER00004 BR    @14                                                 0889
*   /*****************************************************************/
*   /*                                                               */
*   /* UCLIN ACDS OPTION                                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0890
*UCLACDSV:                                                         0890
*   ENTRY;                          /*                       @SA73849*/
UCLACDSV DS    0H                                                  0891
*   IF TBLFLG3=ZERO                 /* IF NO OTHER DS SPEC.  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         ICM   @15,3,TBLFLG3                                       0891
         BNZ   @RF00891                                            0891
*     TBLACDS=ON;                   /* SET TO USE ACDS       @Z67SP00*/
         OI    TBLACDS,B'01000000'                                 0892
*   ELSE                            /*                       @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00891                                            0893
@RF00891 MVI   SCPRETRN,X'08'                                      0893
*   RETURN;                         /* RETURN                @Z67SP00*/
*                                                                  0894
         B     @EL00004                                            0894
*   /*****************************************************************/
*   /*                                                               */
*   /* UCLIN SCDS OPTION                                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0895
*UCLSCDSV:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
UCLSCDSV DS    0H                                                  0896
*   IF TBLFLG3=ZERO                 /* IF NO OTHER DS SPEC.  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         ICM   @15,3,TBLFLG3                                       0896
         BNZ   @RF00896                                            0896
*     TBLSCDS=ON;                   /*                       @Z67SP00*/
         OI    TBLSCDS,B'00100000'                                 0897
*   ELSE                            /*                       @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00896                                            0898
@RF00896 MVI   SCPRETRN,X'08'                                      0898
*   RETURN;                         /* RETURN                @Z67SP00*/
*                                                                  0899
         B     @EL00004                                            0899
*   /*****************************************************************/
*   /*                                                               */
*   /* UCLIN PTS OPTION                                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0900
*UCLPTSSV:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
UCLPTSSV DS    0H                                                  0901
*   IF TBLFLG3=ZERO                 /* IF NO OTHER DS SPEC.  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         ICM   @15,3,TBLFLG3                                       0901
         BNZ   @RF00901                                            0901
*     TBLPTS=ON;                    /*                       @Z67SP00*/
         OI    TBLPTS,B'00000100'                                  0902
*   ELSE                            /*                       @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00901                                            0903
@RF00901 MVI   SCPRETRN,X'08'                                      0903
*   RETURN;                         /* RETURN                @Z67SP00*/
*                                                                  0904
         B     @EL00004                                            0904
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS ENTERED FOR THE UCLIN/LISTPDS MTS     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0905
*UCLMTSSV:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
UCLMTSSV DS    0H                                                  0906
*   IF TBLFLG3=ZERO                 /* IF NO OTHER DS SPEC.  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         ICM   @15,3,TBLFLG3                                       0906
         BNZ   @RF00906                                            0906
*     TBLMTS=ON;                    /* SET PDS DATA SET SW   @Z67SP00*/
         OI    TBLMTS,B'00000010'                                  0907
*   ELSE                            /*                       @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00906                                            0908
@RF00906 MVI   SCPRETRN,X'08'                                      0908
*   RETURN;                         /* RETURN                @Z67SP00*/
*                                                                  0909
         B     @EL00004                                            0909
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS ENTERED FOR THE UCLIN/LISTPDS STS     @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0910
*UCLSTSSV:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
UCLSTSSV DS    0H                                                  0911
*   IF TBLFLG3=ZERO                 /* IF NO OTHER DS SPEC.  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         ICM   @15,3,TBLFLG3                                       0911
         BNZ   @RF00911                                            0911
*     TBLSTS=ON;                    /* SET PDS DATA SET SW   @Z67SP00*/
         OI    TBLSTS,B'00000001'                                  0912
*   ELSE                            /*                       @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00911                                            0913
@RF00911 MVI   SCPRETRN,X'08'                                      0913
*   RETURN;                         /* RETURN                @Z67SP00*/
*                                                                  0914
         B     @EL00004                                            0914
*   /*****************************************************************/
*   /*                                                               */
*   /* UCLIN CRQ OPTION                                      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0915
*UCLCRQSV:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
UCLCRQSV DS    0H                                                  0916
*   IF TBLFLG3=ZERO                 /* IF NO OTHER DS SPEC.  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         ICM   @15,3,TBLFLG3                                       0916
         BNZ   @RF00916                                            0916
*     TBLCRQ=ON;                    /*                       @Z67SP00*/
         OI    TBLCRQ,B'00010000'                                  0917
*   ELSE                            /*                       @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00916                                            0918
@RF00916 MVI   SCPRETRN,X'08'                                      0918
*   RETURN;                         /* RETURN                @Z67SP00*/
*                                                                  0919
         B     @EL00004                                            0919
*   /*****************************************************************/
*   /*                                                               */
*   /* UCLIN ACRQ OPTION                                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0920
*UCLACQSV:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
UCLACQSV DS    0H                                                  0921
*   IF TBLFLG3=ZERO                 /* IF NO OTHER DS SPEC.  @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         ICM   @15,3,TBLFLG3                                       0921
         BNZ   @RF00921                                            0921
*     TBLACRQ=ON;                   /*                       @Z67SP00*/
         OI    TBLACRQ,B'00001000'                                 0922
*   ELSE                            /*                       @Z67SP00*/
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         B     @RC00921                                            0923
@RF00921 MVI   SCPRETRN,X'08'                                      0923
*   RETURN;                         /* RETURN                @Z67SP00*/
         B     @EL00004                                            0924
*   END UCLDSSET;                   /*                       @Z67SP00*/
         B     @EL00004                                            0925
*                                                                  0926
*   /*****************************************************************/
*   /*                                                               */
*   /* AT PERIOD CHECK FOR FUNCTIONS THAT MUST HAVE OPTIONS SPECIFIED*/
*   /* OR KEYWORD THAT MUST HAVE SUB-OPTIONS. IF NOT PRESENT THEN    */
*   /* GIVE SYNTAX ERROR AT PERIOD                           @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0926
*PERCHCK:                           /*                       @Z40SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
PERCHCK  DS    0H                                                  0927
*   IF CCAUPDU=ON                   /* IF UCLIN FUNCTION     @Z67SP00*/
*       &TBLFLG3=ZERO               /* WITH NO DATASET ENTRD @Z67SP00*/
*       &CCAFMID(1)^=BLANK          /* BUT FMID EXEC PARM    @Z67SP00*/
*     THEN                          /* WAS ENTERED THEN THE  @Z67SP00*/
         L     @15,@CA00042                                        0927
         TM    CCAUPDU-HMASMCCA(@15),B'00000010'                   0927
         BNO   @RF00927                                            0927
         ICM   @08,3,TBLFLG3                                       0927
         BNZ   @RF00927                                            0927
         CLI   CCAFMID-HMASMCCA(@15),C' '                          0927
         BE    @RF00927                                            0927
*     TBLCDS=ON;                    /* DEFAULT DATASET IS SET TO THE
*                                      CDS (AS IN SMP R3)    @Z67SP00*/
         OI    TBLCDS,B'10000000'                                  0928
*   ELSE                            /*                               */
*     IF(TBLSEL=OFF&TBLGROUP=OFF&CCARES=ON)/* RESTORE WITH OUT SEL OR
*                                      GROUP                 @Z67SP00*/
*         ×(CCAUPDU=ON&TBLFLG3=ZERO)/* UCLIN WITHOUT DATASET @Z67SP00*/
*       THEN                        /* ID                    @Z40SP00*/
         B     @RC00927                                            0929
@RF00927 TM    TBLSEL,B'10100000'                                  0929
         BNZ   @GL00039                                            0929
         L     @15,@CA00042                                        0929
         TM    CCARES-HMASMCCA(@15),B'00001000'                    0929
         BO    @RT00929                                            0929
@GL00039 L     @15,@CA00042                                        0929
         TM    CCAUPDU-HMASMCCA(@15),B'00000010'                   0929
         BNO   @RF00929                                            0929
         ICM   @15,3,TBLFLG3                                       0929
         BNZ   @RF00929                                            0929
@RT00929 DS    0H                                                  0930
*       SCPRET=SCPSTOP;             /* ERR                   @Z40SP00*/
         MVI   SCPRET,X'08'                                        0930
*   IF TBLCHECK=ON                  /* IF CHECK SPECIFIED    @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
@RF00929 DS    0H                                                  0931
@RC00927 TM    TBLCHECK,B'01000000'                                0931
         BNO   @RF00931                                            0931
*     DO;                           /* IGNORE DIS OPTION IF  @Z67SP00*/
*       TBLDISW=OFF;                /* SPECIFIED             @Z67SP00*/
*       TBLDISR=OFF;                /*                       @Z67SP00*/
*       TBLDISN=OFF;                /*                       @Z67SP00*/
         NI    TBLDISW,B'00011111'                                 0935
*     END;                          /*                       @Z67SP00*/
*   END PERCHCK;                    /*                       @Z40SP00*/
*                                                                  0937
@EL00005 DS    0H                                                  0937
@EF00005 DS    0H                                                  0937
@ER00005 BR    @14                                                 0937
*   /*****************************************************************/
*   /*                                                               */
*   /* AFTER PERIOD IS FOUND ON CNTL CARD SCAN IS CALLED AGAIN TO SEE*/
*   /* IF ANYTHING ELSE OTHER THAN COMMENT WAS CODED. IF SO THEN THIS*/
*   /* ROUT IS ENTERED TO SET RETURN CODE TO GIVE SYNTAX ERROR AND   */
*   /* STOP SCAN                                             @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0938
*XTRADATA:                          /*                       @Z40SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
XTRADATA DS    0H                                                  0939
*   ERRAFTPR=ON;                    /* ERR FOUND AFTER .     @Z40SP00*/
         OI    ERRAFTPR,B'00001000'                                0939
*   SCPRET=SCPSTOP;                 /*                       @Z40SP00*/
         MVI   SCPRET,X'08'                                        0940
*   END XTRADATA;                   /*                       @Z40SP00*/
@EL00006 DS    0H                                                  0941
@EF00006 DS    0H                                                  0941
@ER00006 BR    @14                                                 0941
*                                                                  0942
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUTS FOR JCLIN VERB OPTIONS                    @SA73847*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0942
*JCLINEX:                                                          0942
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @SA73847*/
*                                                                  0942
JCLINEX  DS    0H                                                  0943
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT FOR JCLIN ASM KEYWORD                      @SA73847*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0943
*JCASMEX:                                                          0943
*   ENTRY;                          /*                       @SA73847*/
         B     @EC00943                                            0943
JCASMEX  DS    0H                                                  0943
@EC00943 DS    0H                                                  0944
*   UPDINDX=UPDASM;                 /* SET INDEX FOR ASM ENT @SA73847*/
         MVC   UPDINDX(2),@CH00091                                 0944
*   GO TO JCLINCHK;                 /* GO TO EXIT            @Z40SP00*/
*                                                                  0945
         B     JCLINCHK                                            0945
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT FOR JCLIN LKED KEYWORD                     @SA73847*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0946
*JCLKDEX:                                                          0946
*   ENTRY;                          /*                       @SA73847*/
JCLKDEX  DS    0H                                                  0947
*   UPDINDX=UPDLKD;                 /* SET INDEX FOR LKD ENT @SA73847*/
         MVC   UPDINDX(2),@CH00187                                 0947
*   GO TO JCLINCHK;                 /* GO TO EXIT            @Z40SP00*/
*                                                                  0948
         B     JCLINCHK                                            0948
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT FOR JCLIN UPDAT KEYWORD                    @SA73847*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0949
*JCUPDEX:                                                          0949
*   ENTRY;                          /*                       @SA73847*/
JCUPDEX  DS    0H                                                  0950
*   UPDINDX=UPDUPD;                 /* SET INDEX FOR UPD ENT @SA73847*/
         MVC   UPDINDX(2),@CH00239                                 0950
*   GO TO JCLINCHK;                 /* GO TO EXIT            @Z40SP00*/
*                                                                  0951
         B     JCLINCHK                                            0951
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT FOR JCLIN COPY KEYWORD                     @SA73847*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0952
*JCCOPYEX:                                                         0952
*   ENTRY;                          /*                       @SA73847*/
JCCOPYEX DS    0H                                                  0953
*   UPDINDX=UPDCPY;                 /* SET INDEX FOR CPY ENT @SA73847*/
         MVC   UPDINDX(2),@CH00044                                 0953
*   GO TO JCLINCHK;                 /* GO TO EXIT            @Z40SP00*/
*                                                                  0954
         B     JCLINCHK                                            0954
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUT TO CHECK IF OPTION HAS BEEN ENTERED MORE THAN ONCE       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0955
*JCLINCHK:                          /*                       @Z40SP00*/
*   IF UPDPGMLN(UPDINDX)^=ZERO      /* IF PGMLEN NOT ZERO    @Z67SP00*/
*     THEN                          /* THEN OPTION WAS       @Z40SP00*/
JCLINCHK LH    @15,UPDINDX                                         0955
         MH    @15,@CH00443                                        0955
         SLR   @08,@08                                             0955
         IC    @08,UPDPGMLN-13(@15)                                0955
         CH    @08,@CH00040                                        0955
         BE    @RF00955                                            0955
*     SCPRET=SCPSTOP;               /* ENTERED BEFORE        @Z40SP00*/
         MVI   SCPRET,X'08'                                        0956
*   GO TO JCLINEXT;                 /*                       @Z40SP00*/
*                                                                  0957
         B     JCLINEXT                                            0957
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT TO SAVE PGM= FOR ABOVE                     @SA73847*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0958
*JCPGMEX:                                                          0958
*   ENTRY;                          /*                       @SA73847*/
JCPGMEX  DS    0H                                                  0959
*   UPDPGMLN(UPDINDX)=SCPPMLN;      /* UPDATE LENGTH         @Z67SP00*/
         LH    @15,SCPPMLN                                         0959
         LH    @08,UPDINDX                                         0959
         MH    @08,@CH00443                                        0959
         STC   @15,UPDPGMLN-13(@08)                                0959
*   UPDPGMNM(UPDINDX,1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE STRING 0960
*                                      ENTERED               @Z67SP00*/
         LA    @06,UPDPGMNM-13(@08)                                0960
         BCTR  @15,0                                               0960
         L     @08,SCPCHAR                                         0960
         EX    @15,@SM02643                                        0960
*   GO TO JCLINEXT;                 /* GO TO EXIT            @SA73847*/
*                                                                  0961
         B     JCLINEXT                                            0961
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN ROUT TO SAVE PGM NAME OR PROC ENTERED           @SA73847*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0962
*JCKEYEX:                                                          0962
*   ENTRY;                          /*                       @Z40SP00*/
JCKEYEX  DS    0H                                                  0963
*   UPDPGMNM(UPDINDX,(UPDPGMLN(UPDINDX)+1):((UPDPGMLN(UPDINDX)+SCPPMLN)
*       ))=SCPSTRNG(1:SCPPMLN);     /* SAVE PROGRAM NAME OR PROCEDURE
*                                      PROGRAM NAME OR PROCEDURE IN
*                                      THE CORRECT ENTRY AND LOCATION
*                                      WITHIN ENTRY          @SA73847*/
         LH    @15,UPDINDX                                         0963
         MH    @15,@CH00443                                        0963
         SLR   @08,@08                                             0963
         IC    @08,UPDPGMLN-13(@15)                                0963
         ALR   @08,@15                                             0963
         LA    @06,UPDPGMNM-13(@08)                                0963
         LH    @08,SCPPMLN                                         0963
         LR    @05,@08                                             0963
         BCTR  @05,0                                               0963
         L     @04,SCPCHAR                                         0963
         EX    @05,@SM02645                                        0963
*   UPDPGMLN(UPDINDX)=UPDPGMLN(UPDINDX)+SCPPMLN;/* UPD LN    @Z67SP00*/
         SLR   @06,@06                                             0964
         IC    @06,UPDPGMLN-13(@15)                                0964
         ALR   @08,@06                                             0964
         STC   @08,UPDPGMLN-13(@15)                                0964
*   GO TO JCLINEXT;                 /* RETURN                @Z40SP00*/
*                                                                  0965
         B     JCLINEXT                                            0965
*   /*****************************************************************/
*   /*                                                               */
*   /* DSCAN RETURN                                          @SA73847*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0966
*JCLINEXT:                          /* EXIT CODE             @SA73847*/
*   END JCLINEX;                    /* END JCLIN ROUTS       @SA73847*/
@EL00007 DS    0H                                                  0966
@EF00007 DS    0H                                                  0966
@ER00007 BR    @14                                                 0966
*                                                                  0967
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO HANDLE THE RC PARAMETER ON FUNTION         @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0967
*OTHRRCRT:                                                         0967
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
OTHRRCRT DS    0H                                                  0968
*   DECLARE                         /*                       @Z40SP00*/
*     RCPTR PTR(31);                /* PTR TO CURRENT RC FOR       0968
*                                      SPECIFIED FUNCTION    @Z40SP00*/
*   DECLARE                         /*                       @Z40SP00*/
*     RCFUNCT FIXED(8) BASED(RCPTR);/* LAST RC FOR FUNCTION  @Z40SP00*/
*   DECLARE                         /*                       @Z40SP00*/
*     RCENT FIXED(8);               /* RC ENTERED CONVERTED TO BINARY
*                                                            @Z40SP00*/
*   DECLARE                         /*                       @Z40SP00*/
*     1 RCXXXSW BIT(16),            /* RC VALUES ENTERED SW  @Z40SP00*/
*       3 RCAPLSW BIT(1),           /* RC FOR APPLY          @Z40SP00*/
*       3 RCACPSW BIT(1),           /* RC FOR ACCEPT         @Z40SP00*/
*       3 RCJCLSW BIT(1),           /* RC FOR JCLIN          @Z40SP00*/
*       3 RCLOGSW BIT(1),           /* RC FOR LOG            @Z40SP00*/
*       3 RCLSTSW BIT(1),           /* RC FOR LIST           @Z40SP00*/
*       3 RCRECSW BIT(1),           /* RC FOR REC            @Z40SP00*/
*       3 RCREJSW BIT(1),           /* RC FOR REJECT         @Z40SP00*/
*       3 RCRSTSW BIT(1),           /* RC FOR RESTORE        @Z40SP00*/
*       3 RCUCLSW BIT(1),           /* RC FOR UCLIN          @Z40SP00*/
*       3 * BIT(4);                 /* UNUSED                @ZD00004*/
*RCINIT:                            /*                       @Z40SP00*/
*   ENTRY;                          /*                       @Z40SP00*/
         B     @EC00972                                            0972
RCINIT   DS    0H                                                  0972
@EC00972 DS    0H                                                  0973
*   RCXXXSW=RCXXXSW&&RCXXXSW;       /* INIT ENTERED SW       @Z40SP00*/
         XC    RCXXXSW(2),RCXXXSW                                  0973
*   GO TO ENDRCRT;                  /*                       @Z40SP00*/
         B     ENDRCRT                                             0974
*RCRECRT:                                                          0975
*   ENTRY;                          /* RECEIVE PARM RTN      @YA07506*/
RCRECRT  DS    0H                                                  0976
*   IF RCRECSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCRECSW,B'00000100'                                 0976
         BO    @RT00976                                            0976
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCRECSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCRECSW,B'00000100'                                 0978
*   RCPTR=ADDR(RCREC);              /* POINT TO RC FOR REC   @YA07506*/
         LA    @15,RCREC                                           0979
         ST    @15,RCPTR                                           0979
*   GO TO ENDRCRT;                  /*                       @YA07506*/
         B     ENDRCRT                                             0980
*RCAPLRT:                                                          0981
*   ENTRY;                          /*                       @YA07506*/
RCAPLRT  DS    0H                                                  0982
*   IF RCAPLSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCAPLSW,B'10000000'                                 0982
         BO    @RT00982                                            0982
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCAPLSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCAPLSW,B'10000000'                                 0984
*   RCPTR=ADDR(RCAPP);              /* POINT TO RC FOR APPLY @YA07506*/
         LA    @15,RCAPP                                           0985
         ST    @15,RCPTR                                           0985
*   GO TO ENDRCRT;                  /*                       @YA07506*/
         B     ENDRCRT                                             0986
*RCACPRT:                                                          0987
*   ENTRY;                          /*                       @YA07506*/
RCACPRT  DS    0H                                                  0988
*   IF RCACPSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCACPSW,B'01000000'                                 0988
         BO    @RT00988                                            0988
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCACPSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCACPSW,B'01000000'                                 0990
*   RCPTR=ADDR(RCACC);              /* POINT TO RC FOR ACCEPT      0991
*                                                            @YA07506*/
         LA    @15,RCACC                                           0991
         ST    @15,RCPTR                                           0991
*   GO TO ENDRCRT;                  /*                       @YA07506*/
         B     ENDRCRT                                             0992
*RCRSTRT:                                                          0993
*   ENTRY;                          /*                       @YA07506*/
RCRSTRT  DS    0H                                                  0994
*   IF RCRSTSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCRSTSW,B'00000001'                                 0994
         BO    @RT00994                                            0994
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCRSTSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCRSTSW,B'00000001'                                 0996
*   RCPTR=ADDR(RCRST);              /* POINT TO RC FOR RES   @YA07506*/
         LA    @15,RCRST                                           0997
         ST    @15,RCPTR                                           0997
*   GO TO ENDRCRT;                  /*                       @YA07506*/
         B     ENDRCRT                                             0998
*RCREJRT:                                                          0999
*   ENTRY;                          /*                       @YA07506*/
RCREJRT  DS    0H                                                  1000
*   IF RCREJSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCREJSW,B'00000010'                                 1000
         BO    @RT01000                                            1000
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCREJSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCREJSW,B'00000010'                                 1002
*   RCPTR=ADDR(RCREJ);              /* POINT TO RC FOR REJ   @YA07506*/
         LA    @15,RCREJ                                           1003
         ST    @15,RCPTR                                           1003
*   GO TO ENDRCRT;                  /*                       @YA07506*/
         B     ENDRCRT                                             1004
*RCJCLRT:                                                          1005
*   ENTRY;                          /*                       @YA07506*/
RCJCLRT  DS    0H                                                  1006
*   IF RCJCLSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCJCLSW,B'00100000'                                 1006
         BO    @RT01006                                            1006
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCJCLSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCJCLSW,B'00100000'                                 1008
*   RCPTR=ADDR(RCJCL);              /* POINT TO RC FOR JCLIN @YA07506*/
         LA    @15,RCJCL                                           1009
         ST    @15,RCPTR                                           1009
*   GO TO ENDRCRT;                  /*                       @YA07506*/
         B     ENDRCRT                                             1010
*RCUCLRT:                                                          1011
*   ENTRY;                          /*                       @YA07506*/
RCUCLRT  DS    0H                                                  1012
*   IF RCUCLSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCUCLSW,B'10000000'                                 1012
         BO    @RT01012                                            1012
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCUCLSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCUCLSW,B'10000000'                                 1014
*   RCPTR=ADDR(RCUCL);              /* POINT TO RC FOR UCLIN @YA07506*/
         LA    @15,RCUCL                                           1015
         ST    @15,RCPTR                                           1015
*   GO TO ENDRCRT;                  /*                       @YA07506*/
         B     ENDRCRT                                             1016
*RCLSTRT:                                                          1017
*   ENTRY;                          /*                       @YA07506*/
RCLSTRT  DS    0H                                                  1018
*   IF RCLSTSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCLSTSW,B'00001000'                                 1018
         BO    @RT01018                                            1018
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCLSTSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCLSTSW,B'00001000'                                 1020
*   RCPTR=ADDR(RCLIST);             /* POINT TO RC FOR LIST  @YA07506*/
         LA    @15,RCLIST                                          1021
         ST    @15,RCPTR                                           1021
*   GO TO ENDRCRT;                  /*                       @YA07506*/
         B     ENDRCRT                                             1022
*RCLOGRT:                                                          1023
*   ENTRY;                          /*                       @YA07506*/
RCLOGRT  DS    0H                                                  1024
*   IF RCLOGSW=ON                   /* IF ENTERED BEFORE     @Z40SP00*/
*     THEN                          /* THEN ERROR            @Z40SP00*/
         TM    RCLOGSW,B'00010000'                                 1024
         BO    @RT01024                                            1024
*     GO TO BADRCRT;                /* RETURN WITH SYNTAX    @Z40SP00*/
*   RCLOGSW=ON;                     /* SET ENTERED SW        @Z40SP00*/
         OI    RCLOGSW,B'00010000'                                 1026
*   RCPTR=ADDR(RCLOG);              /* POINT TO RC FOR LOG   @YA07506*/
         LA    @15,RCLOG                                           1027
         ST    @15,RCPTR                                           1027
*   GO TO ENDRCRT;                  /* GO TO PROC EXIT       @Z40SP00*/
         B     ENDRCRT                                             1028
*MAINRCRT:                          /*                       @YA07506*/
*   ENTRY;                          /*                       @Z40SP00*/
MAINRCRT DS    0H                                                  1030
*   RCENTRD=ON;                     /* SET SW TO INDICATE THAT RC  1030
*                                      PARM WAS ENTERED AND THAT USER
*                                      NOW COMPLETE CONTROL OVER   1030
*                                      RETURN CODE CHECKING TO     1030
*                                      DETERMINE FLUSH CONDITIONS  1030
*                                                            @Z40SP00*/
         OI    RCENTRD,B'00100000'                                 1030
*   IF SCPPMLN=1                    /* IF ONLY ONE CHAR      @Z40SP00*/
*     THEN                          /* ENTERED FOR RC VALUE  @Z40SP00*/
         CLC   SCPPMLN(2),@CH00091                                 1031
         BNE   @RF01031                                            1031
*     DO;                           /* INIT CONVERSION AREA  @Z40SP00*/
*       CNVRCCD=TWOCHAR0;           /* AND THEN MOVE IN 1    @Z40SP00*/
         MVC   CNVRCCD(2),@CC01765                                 1033
*       CNVRCCD(2)=SCPSTRNG(1);     /* CHAR ENTERED          @Z40SP00*/
         L     @15,SCPCHAR                                         1034
         MVC   CNVRCCD+1(1),SCPSTRNG(@15)                          1034
*     END;                          /*                       @Z40SP00*/
*   ELSE                            /* ELSE MUST BE TWO CHAR @Z40SP00*/
*     CNVRCCD(1:2)=SCPSTRNG(1:2);   /* SO MOVE BOTH          @Z40SP00*/
         B     @RC01031                                            1036
@RF01031 L     @15,SCPCHAR                                         1036
         MVC   CNVRCCD(2),SCPSTRNG(@15)                            1036
*   PACK(RCVL,CNVRCCD);             /* PACK VALUE SET UP     @Z40SP00*/
@RC01031 PACK  RCVL(2),CNVRCCD(2)                                  1037
*   CVB(RCENT,RCVL);                /* CONVERT TO BINARY     @Z40SP00*/
         XC    @TS00001(8),@TS00001                                1038
         MVC   @TS00001+6(2),RCVL                                  1038
         CVB   @15,@TS00001                                        1038
         STC   @15,RCENT                                           1038
*   IF RCENT>=STOPSMP               /* VALUE SPECIFIED GREATER OR  1039
*                                      EQUAL 16 THEN SYNTAX ERR    1039
*                                                            @Z67SP00*/
*     THEN                          /* SO STOP SCAN          @YA07506*/
         CLI   RCENT,16                                            1039
         BL    @RF01039                                            1039
*BADRCRT:                           /*                       @Z40SP00*/
*     SCPRET=SCPSTOP;               /* STOP SCAN             @Z40SP00*/
BADRCRT  MVI   SCPRET,X'08'                                        1040
*   ELSE                            /* IF NOT GREATR THAN 16 @Z40SP00*/
*     DO;                           /*                       @Z40SP00*/
         B     @RC01039                                            1041
@RF01039 DS    0H                                                  1042
*       IF RCFUNCT>RCENT            /* THEN CHECK TO SEE IF GREATER
*                                      THAN RC FROM SPECIED FUNCTION */
*         THEN                      /* IF SO THEN SET BIT TO @YA07506*/
         L     @15,RCPTR                                           1042
         CLC   RCFUNCT(1,@15),RCENT                                1042
         BNH   @RF01042                                            1042
*         RCERR=ON;                 /* CAUSE STATEMENT TO BE FLUSHED
*                                      IN MAIN ROUTINE       @Z40SP00*/
         OI    RCERR,B'10000000'                                   1043
*     END;                          /*                       @Z40SP00*/
*ENDRCRT:                           /*                       @Z40SP00*/
*   END OTHRRCRT;                   /* END PROC              @YA07506*/
@EL00008 DS    0H                                                  1045
@EF00008 DS    0H                                                  1045
@ER00008 BR    @14                                                 1045
*                                                                  1046
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO INDICATE SELECT FOUND              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1046
*SELSAV:                                                           1046
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
SELSAV   DS    0H                                                  1047
*   IF TBLEXC=OFF                   /* NO EXCLUDE?                   */
*       &TBLSEL=OFF                 /* AND NOT ALREADY SELECT        */
*       &TBLGROUP=OFF               /*                       @Z67SP00*/
*     THEN                          /* YES - THEN OK FOR SELECT      */
         TM    TBLEXC,B'11100000'                                  1047
         BNZ   @RF01047                                            1047
*     DO;                                                          1048
*       SESELECT=ON;                /* INDICATE SELECT               */
         OI    SESELECT,B'01000000'                                1049
*       TBLSEL=ON;                  /*                       @Z67SP00*/
*       TBLMASS=OFF;                /* NOT MASS MODE         @Z67SP00*/
         OI    TBLSEL,B'10000000'                                  1051
         NI    TBLMASS,B'11111110'                                 1051
*     END;                                                         1052
*   ELSE                            /* ELSE                  @Z67SP00*/
*     SCPRET=SCPSTOP;               /* ERROR                 @Z67SP00*/
         B     @RC01047                                            1053
@RF01047 MVI   SCPRET,X'08'                                        1053
*   END SELSAV;                                                    1054
*                                                                  1054
@EL00009 DS    0H                                                  1054
@EF00009 DS    0H                                                  1054
@ER00009 BR    @14                                                 1054
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO INDICATE EXCLUDE FOUND             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1055
*EXCSAV:                                                           1055
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
EXCSAV   DS    0H                                                  1056
*   IF TBLSEL=OFF                   /* IF NO SELECT                  */
*       &TBLEXC=OFF                 /* AND NOT ALREADY EXCLUDE       */
*       &TBLGROUP=OFF               /*                       @Z67SP00*/
*       &CCARES=OFF                 /* CANT EXCLUD FOR REST  @Z40SP00*/
*     THEN                          /* THEN EXCLUDE OK, AS LONG AS   */
         TM    TBLSEL,B'11100000'                                  1056
         BNZ   @RF01056                                            1056
         L     @15,@CA00042                                        1056
         TM    CCARES-HMASMCCA(@15),B'00001000'                    1056
         BNZ   @RF01056                                            1056
*     DO;                                                          1057
*       SEEXCLUD=ON;                /* INDICATE EXCLUDE              */
         OI    SEEXCLUD,B'00100000'                                1058
*       TBLEXC=ON;                  /*                       @Z67SP00*/
*       TBLMASS=OFF;                /* NOT MASS MODE         @Z67SP00*/
         OI    TBLEXC,B'01000000'                                  1060
         NI    TBLMASS,B'11111110'                                 1060
*     END;                                                         1061
*   ELSE                            /* ELSE                  @Z67SP00*/
*     SCPRET=SCPSTOP;               /* ERROR                 @Z67SP00*/
         B     @RC01056                                            1062
@RF01056 MVI   SCPRET,X'08'                                        1062
*   END EXCSAV;                                                    1063
*                                                                  1063
@EL00010 DS    0H                                                  1063
@EF00010 DS    0H                                                  1063
@ER00010 BR    @14                                                 1063
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO INDICATE GROUP FOUND               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1064
*GRPSAV:                                                           1064
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
GRPSAV   DS    0H                                                  1065
*   IF TBLSEL=OFF                   /* IF NO SELECT                  */
*       &TBLEXC=OFF                 /* AND NOT ALREADY EXCLUDE       */
*       &TBLGROUP=OFF               /*                       @Z67SP00*/
*       &CCAREC=OFF                 /* AND NOT RECEIVE       @Z67SP00*/
*       &CCAREJ=OFF                 /* AND NOT REJECT        @Z67SP00*/
*     THEN                          /* THEN EXCLUDE OK, AS LONG AS   */
         TM    TBLSEL,B'11100000'                                  1065
         BNZ   @RF01065                                            1065
         L     @15,@CA00042                                        1065
         TM    CCAREC-HMASMCCA(@15),B'10010000'                    1065
         BNZ   @RF01065                                            1065
*     DO;                                                          1066
*       SEGROUP=ON;                 /* INDICATE EXCLUDE              */
         OI    SEGROUP,B'10000000'                                 1067
*       TBLGROUP=ON;                /*                       @Z67SP00*/
*       TBLMASS=OFF;                /* NOT MASS MODE         @Z67SP00*/
         OI    TBLGROUP,B'00100000'                                1069
         NI    TBLMASS,B'11111110'                                 1069
*     END;                                                         1070
*   ELSE                            /* ELSE                  @Z67SP00*/
*     SCPRET=SCPSTOP;               /* ERROR                 @Z67SP00*/
         B     @RC01065                                            1071
@RF01065 MVI   SCPRET,X'08'                                        1071
*   END GRPSAV;                                                    1072
@EL00011 DS    0H                                                  1072
@EF00011 DS    0H                                                  1072
@ER00011 BR    @14                                                 1072
*                                                                  1073
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE IN INVOKED TO SAVE THE PTF NUMBER FOR THE      */
*   /* SELECT/EXCLUDE KEYWORD AND TO CALL THE ROUTINE TO ADD THE PTF */
*   /* NUMBER TO THE HMASMSET                                @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1073
*PTFSAV17:                          /*                       @Z40SP00*/
*   PROCEDURE;                      /*                       @Z40SP00*/
PTFSAV17 STM   @14,@12,@SA00012                                    1073
*   SENAME=SCPSTRNG(1:SCPPMLN);     /* SAVE SYSMOD NUMBER    @Z67SP00*/
         MVI   SENAME+1,C' '                                       1074
         MVC   SENAME+2(6),SENAME+1                                1074
         LH    @15,SCPPMLN                                         1074
         BCTR  @15,0                                               1074
         L     @08,SCPCHAR                                         1074
         EX    @15,@SM02647                                        1074
*   SESMD=ON;                       /* SET SYSMOD TYPE       @Z67SP00*/
         OI    SESMD,B'00000001'                                   1075
*   GTPPTR=CCASETAD;                /*                       @Z67SP00*/
         L     @15,@CA00042                                        1076
         L     @15,CCASETAD-HMASMCCA(,@15)                         1076
         ST    @15,GTPPTR                                          1076
*   RFY                                                            1077
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/
*   GTPFUNCT=GTPADD;                /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'04'                                 1078
*   GTPBUFAD=ADDR(HMASMSET);        /*                       @Z67SP00*/
         LA    @08,HMASMSET                                        1079
         ST    @08,GTPBUFAD(,@15)                                  1079
*   GTPRCDLN=LENGTH(HMASMSET);      /*                       @Z67SP00*/
         MVC   GTPRCDLN(2,@15),@CH00033                            1080
*   GTPKEYLN=LENGTH(SELSTENT);      /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@15),@CH00034                            1081
*   GTPPSIZE=GTP512B;               /* PAGE SIZE IS 512      @Z67SP00*/
         NI    GTPPSIZE(@15),B'11111001'                           1082
         OI    GTPPSIZE(@15),B'00000001'                           1082
*   RFY                                                            1083
*     R1 UNRSTD;                    /* FREE R1 ACROSS PROC   @Z40SP00*/
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/
         ST    @15,@AL00001                                        1084
         L     @15,@CV01806                                        1084
         LA    @01,@AL00001                                        1084
         BALR  @14,@15                                             1084
*   RFY                                                            1085
*     R1 RSTD;                      /*                       @Z40SP00*/
*   IF GTPRETRN^=GTPGOOD            /* NOT ENOUGH ROOM?              */
*     THEN                          /* NO - ISSUE MESSAGE            */
         L     @15,GTPPTR                                          1086
         CLI   GTPRETRN(@15),0                                     1086
         BE    @RF01086                                            1086
*     SCPRET=SCPSTOP;               /* INDICATE SCAN ERROR           */
         MVI   SCPRET,X'08'                                        1087
*   END PTFSAV17;                                                  1088
@EL00012 DS    0H                                                  1088
@EF00012 DS    0H                                                  1088
@ER00012 LM    @14,@12,@SA00012                                    1088
         BR    @14                                                 1088
*                                                                  1089
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTS FOR BYPASS OPTIONS                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1089
*BYPROUT:                           /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
BYPROUT  DS    0H                                                  1090
*SBYPFMID:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
         B     @EC01090                                            1090
SBYPFMID DS    0H                                                  1090
@EC01090 DS    0H                                                  1091
*   IF CCAREC=ON                    /* ONLY FOR RECEIVE      @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1091
         TM    CCAREC-HMASMCCA(@15),B'10000000'                    1091
         BNO   @RF01091                                            1091
*     TBLBPFM=ON;                   /*                       @Z67SP00*/
         OI    TBLBPFM,B'00000100'                                 1092
*   ELSE                            /*                       @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01091                                            1093
@RF01091 MVI   SCPRET,X'08'                                        1093
*   GO TO BYPEND;                   /*                       @Z67SP00*/
         B     BYPEND                                              1094
*SBYPPRE:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
SBYPPRE  DS    0H                                                  1096
*   IF CCAAPPLY=ON                  /*                       @Z67SP00*/
*       ×CCAACCPT=ON                /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1096
         TM    CCAAPPLY-HMASMCCA(@15),B'01100000'                  1096
         BZ    @RF01096                                            1096
*     TBLBPPRE=ON;                  /*                       @Z67SP00*/
         OI    TBLBPPRE,B'01000000'                                1097
*   ELSE                            /*                       @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01096                                            1098
@RF01096 MVI   SCPRET,X'08'                                        1098
*   GO TO BYPEND;                   /*                       @Z67SP00*/
         B     BYPEND                                              1099
*SBYPREQ:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
SBYPREQ  DS    0H                                                  1101
*   IF CCAAPPLY=ON                  /*                       @Z67SP00*/
*       ×CCAACCPT=ON                /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1101
         TM    CCAAPPLY-HMASMCCA(@15),B'01100000'                  1101
         BZ    @RF01101                                            1101
*     TBLBPREQ=ON;                  /*                       @Z67SP00*/
         OI    TBLBPREQ,B'00100000'                                1102
*   ELSE                            /*                       @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01101                                            1103
@RF01101 MVI   SCPRET,X'08'                                        1103
*   GO TO BYPEND;                   /*                       @Z67SP00*/
         B     BYPEND                                              1104
*SBYPIRQ:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
SBYPIRQ  DS    0H                                                  1106
*   IF CCAAPPLY=ON                  /*                       @Z67SP00*/
*       ×CCAACCPT=ON                /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1106
         TM    CCAAPPLY-HMASMCCA(@15),B'01100000'                  1106
         BZ    @RF01106                                            1106
*     TBLBPIRQ=ON;                  /*                       @Z67SP00*/
         OI    TBLBPIRQ,B'00010000'                                1107
*   ELSE                            /*                       @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01106                                            1108
@RF01106 MVI   SCPRET,X'08'                                        1108
*   GO TO BYPEND;                   /*                       @Z67SP00*/
         B     BYPEND                                              1109
*SBYPID:                            /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
SBYPID   DS    0H                                                  1111
*   IF CCAAPPLY=ON                  /*                       @Z67SP00*/
*       ×CCAACCPT=ON                /*                       @Z67SP00*/
*       ×CCARES=ON                  /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1111
         TM    CCAAPPLY-HMASMCCA(@15),B'01101000'                  1111
         BZ    @RF01111                                            1111
*     TBLBPID=ON;                   /*                       @Z67SP00*/
         OI    TBLBPID,B'10000000'                                 1112
*   ELSE                            /*                       @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01111                                            1113
@RF01111 MVI   SCPRET,X'08'                                        1113
*   GO TO BYPEND;                   /*                       @Z67SP00*/
         B     BYPEND                                              1114
*BYPEND:                            /*                       @Z67SP00*/
*   END BYPROUT;                    /*                       @Z67SP00*/
@EL00013 DS    0H                                                  1115
@EF00013 DS    0H                                                  1115
@ER00013 BR    @14                                                 1115
*                                                                  1116
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED TO SAVE THE NUCID                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1116
*NUCSAV:                                                           1116
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
NUCSAV   DS    0H                                                  1117
*   IF CCAAPPLY=ON                  /* MUST BE APPLY FOR NUCID       */
*       &OLDNUCID=BLANK             /* HAS NUC BEEN SAVED YET?       */
*     THEN                          /* NO - GO AHEAD AND SAVE IT     */
         L     @15,@CA00042                                        1117
         TM    CCAAPPLY-HMASMCCA(@15),B'01000000'                  1117
         BNO   @RF01117                                            1117
         CLI   OLDNUCID,C' '                                       1117
         BNE   @RF01117                                            1117
*     DO;                                                          1118
*       OLDNUCID=CCANUCID;          /* SAVE NUCID FROM THE CCA       */
         MVC   OLDNUCID(1),CCANUCID-HMASMCCA(@15)                  1119
*       CCANUCID=SCPSTRNG(1);       /* SET NEW NUCID                 */
         L     @08,SCPCHAR                                         1120
         MVC   CCANUCID-HMASMCCA(1,@15),SCPSTRNG(@08)              1120
*       TBLNUCID=CCANUCID;          /*                       @Z67SP00*/
         MVC   TBLNUCID(1),CCANUCID-HMASMCCA(@15)                  1121
*     END;                                                         1122
*   ELSE                            /* OTHERWISE - SYNTAX ERROR      */
*     SCPRET=SCPSTOP;               /* INDICATE ERROR                */
         B     @RC01117                                            1123
@RF01117 MVI   SCPRET,X'08'                                        1123
*   END NUCSAV;                                                    1124
*                                                                  1124
@EL00014 DS    0H                                                  1124
@EF00014 DS    0H                                                  1124
@ER00014 BR    @14                                                 1124
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE NOAPPLY KEYWORD       @ZD00009*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1125
*NOAPPSAV:                          /*                       @ZD00009*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @ZD00009*/
NOAPPSAV DS    0H                                                  1126
*   IF CCAACCPT=ON                  /* IF ACCEPT             @ZD00009*/
*     THEN                          /*                       @ZD00009*/
         L     @15,@CA00042                                        1126
         TM    CCAACCPT-HMASMCCA(@15),B'00100000'                  1126
         BNO   @RF01126                                            1126
*     TBLNOAPP=ON;                  /* SET PARM TO TBL/ACC   @ZD00009*/
         OI    TBLNOAPP,B'10000000'                                1127
*   ELSE                            /* SYNTAX ERR IF NOT ACC @ZD00009*/
*     SCPRET=SCPSTOP;               /*                       @ZD00009*/
         B     @RC01126                                            1128
@RF01126 MVI   SCPRET,X'08'                                        1128
*   END NOAPPSAV;                   /*                       @ZD00009*/
@EL00015 DS    0H                                                  1129
@EF00015 DS    0H                                                  1129
@ER00015 BR    @14                                                 1129
*                                                                  1130
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE CHECK KEYWORD         @ZD00007*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1130
*CHECKSAV:                          /*                       @ZD00007*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @ZD00007*/
CHECKSAV DS    0H                                                  1131
*   IF CCAAPPLY=ON                  /* IF VALID CHECK        @Z67SP00*/
*       ×CCAACCPT=ON                /* FUNCTION              @Z67SP00*/
*       ×CCARES=ON                  /*                       @Z67SP00*/
*     THEN                          /*                       @ZD00007*/
         L     @15,@CA00042                                        1131
         TM    CCAAPPLY-HMASMCCA(@15),B'01101000'                  1131
         BZ    @RF01131                                            1131
*     TBLCHECK=ON;                  /* SET PARM TO TBL       @ZD00007*/
         OI    TBLCHECK,B'01000000'                                1132
*   ELSE                            /* SYNTAX ERR IF REC     @ZD00007*/
*     SCPRET=SCPSTOP;               /*                       @ZD00007*/
         B     @RC01131                                            1133
@RF01131 MVI   SCPRET,X'08'                                        1133
*   END CHECKSAV;                   /*                       @ZD00007*/
*                                                                  1134
@EL00016 DS    0H                                                  1134
@EF00016 DS    0H                                                  1134
@ER00016 BR    @14                                                 1134
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE ASSEM KEYWORD         @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1135
*ASSEMSV:                           /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
ASSEMSV  DS    0H                                                  1136
*   IF CCAAPPLY=ON                  /* IF VALID CHECK        @Z67SP00*/
*       ×CCAACCPT=ON                /* FUNCTION              @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1136
         TM    CCAAPPLY-HMASMCCA(@15),B'01100000'                  1136
         BZ    @RF01136                                            1136
*     TBLASSEM=ON;                  /* SET PARM TO TBL       @Z67SP00*/
         OI    TBLASSEM,B'00100000'                                1137
*   ELSE                            /* SYNTAX ERR IF REC     @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01136                                            1138
@RF01136 MVI   SCPRET,X'08'                                        1138
*   END ASSEMSV;                    /*                       @Z67SP00*/
@EL00017 DS    0H                                                  1139
@EF00017 DS    0H                                                  1139
@ER00017 BR    @14                                                 1139
*                                                                  1140
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE APARS KEYWORD         @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1140
*APARSAV:                           /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
APARSAV  DS    0H                                                  1141
*   IF CCAACCPT=ON                  /* IF ACCEPT             @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1141
         TM    CCAACCPT-HMASMCCA(@15),B'00100000'                  1141
         BNO   @RF01141                                            1141
*     TBLAPAR=ON;                   /* SET PARM TO TBL       @Z67SP00*/
         OI    TBLAPAR,B'00001000'                                 1142
*   ELSE                            /* SYNTAX ERR IF REC     @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01141                                            1143
@RF01141 MVI   SCPRET,X'08'                                        1143
*   END APARSAV;                    /*                       @Z67SP00*/
*                                                                  1144
@EL00018 DS    0H                                                  1144
@EF00018 DS    0H                                                  1144
@ER00018 BR    @14                                                 1144
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS INVOKED FOR THE USERMOD KEYWORD       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1145
*USERSAV:                           /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
USERSAV  DS    0H                                                  1146
*   IF CCAACCPT=ON                  /* IF ACCEPT             @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1146
         TM    CCAACCPT-HMASMCCA(@15),B'00100000'                  1146
         BNO   @RF01146                                            1146
*     TBLUSER=ON;                   /* SET PARM TO TBL       @Z67SP00*/
         OI    TBLUSER,B'00000100'                                 1147
*   ELSE                            /* SYNTAX ERR IF REC     @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01146                                            1148
@RF01146 MVI   SCPRET,X'08'                                        1148
*   END USERSAV;                    /*                       @Z67SP00*/
@EL00019 DS    0H                                                  1149
@EF00019 DS    0H                                                  1149
@ER00019 BR    @14                                                 1149
*                                                                  1150
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO SAVE THE DIS KEYWORD AND OPTIONS    @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1150
*RDIS:                              /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
RDIS     DS    0H                                                  1151
*   IF(CCAAPPLY=OFF                 /* DIS VALID ONLY FOR AP @Z67SP00*/
*       &CCARES=OFF                 /* RESTORE               @Z67SP00*/
*       &CCAACCPT=OFF               /* ACCEPT                @Z67SP00*/
*       &CCAUPDJ=OFF                /* JCLIN                 @Z67SP00*/
*       &CCAUPDU=OFF)               /* OR UCLIN              @Z67SP00*/
*       ×                           /* OR                            */
*       (TBLDISN=ON                 /* DOS OPTION ALREADY    @Z67SP00*/
*       ×TBLDISR=ON                 /* ENTERED               @Z67SP00*/
*       ×TBLDISW=ON)                /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1151
         TM    CCAAPPLY-HMASMCCA(@15),B'01101110'                  1151
         BZ    @RT01151                                            1151
         TM    TBLDISN,B'11100000'                                 1151
         BZ    @RF01151                                            1151
@RT01151 DS    0H                                                  1152
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         MVI   SCPRET,X'08'                                        1152
*   END RDIS;                       /*                       @Z67SP00*/
@EL00020 DS    0H                                                  1153
@EF00020 DS    0H                                                  1153
@ER00020 BR    @14                                                 1153
*RDISN:                             /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
RDISN    DS    0H                                                  1155
*   TBLDISN=ON;                     /*                       @Z67SP00*/
         OI    TBLDISN,B'10000000'                                 1155
*   END RDISN;                      /*                       @Z67SP00*/
@EL00021 DS    0H                                                  1156
@EF00021 DS    0H                                                  1156
@ER00021 BR    @14                                                 1156
*RDISR:                             /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
RDISR    DS    0H                                                  1158
*   TBLDISR=ON;                     /*                       @Z67SP00*/
         OI    TBLDISR,B'01000000'                                 1158
*   END RDISR;                      /*                       @Z67SP00*/
@EL00022 DS    0H                                                  1159
@EF00022 DS    0H                                                  1159
@ER00022 BR    @14                                                 1159
*RDISW:                             /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
RDISW    DS    0H                                                  1161
*   TBLDISW=ON;                     /*                       @Z67SP00*/
         OI    TBLDISW,B'00100000'                                 1161
*   END RDISW;                      /*                       @Z67SP00*/
@EL00023 DS    0H                                                  1162
@EF00023 DS    0H                                                  1162
@ER00023 BR    @14                                                 1162
*                                                                  1163
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED FOR THE NOJCLIN OPTION                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1163
*RNOJCL:                            /*                       @Z67SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z67SP00*/
RNOJCL   DS    0H                                                  1164
*   IF CCAAPPLY=ON                  /* ONLY GOOD FOR APPLY   @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,@CA00042                                        1164
         TM    CCAAPPLY-HMASMCCA(@15),B'01000000'                  1164
         BNO   @RF01164                                            1164
*     TBLNOJCL=ON;                  /*                       @Z67SP00*/
         OI    TBLNOJCL,B'00000001'                                1165
*   ELSE                            /*                       @Z67SP00*/
*     SCPRET=SCPSTOP;               /*                       @Z67SP00*/
         B     @RC01164                                            1166
@RF01164 MVI   SCPRET,X'08'                                        1166
*   END RNOJCL;                     /*                       @Z67SP00*/
*                                                                  1167
@EL00024 DS    0H                                                  1167
@EF00024 DS    0H                                                  1167
@ER00024 BR    @14                                                 1167
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO SAVE SELECTED SYSMOD NUMBER FOR NOJCLIN     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1168
*   RFY                                                            1168
*     R1 UNRSTD;                    /*                       @Z67SP00*/
*RNOJCLV:                           /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
RNOJCLV  STM   @14,@12,@SA00025                                    1169
*   GTPPTR=ADDR(NOJCLGTP);          /* GTP ADDR              @Z67SP00*/
         LA    @15,NOJCLGTP                                        1170
         ST    @15,GTPPTR                                          1170
*   RFY                                                            1171
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/
*   TBLJCLGT=GTPPTR;                /* SET PTR IN PARM       @Z67SP00*/
         ST    @15,TBLJCLGT                                        1172
*   HMASMSET=''B;                   /*                       @Z67SP00*/
         XC    HMASMSET(12),HMASMSET                               1173
*   SENAME=SCPSTRNG(1:SCPPMLN);     /* SYSMOD NUMBER         @Z67SP00*/
         MVI   SENAME+1,C' '                                       1174
         MVC   SENAME+2(6),SENAME+1                                1174
         LH    @08,SCPPMLN                                         1174
         BCTR  @08,0                                               1174
         L     @06,SCPCHAR                                         1174
         EX    @08,@SM02650                                        1174
*   SESMD=ON;                       /* SYSMOD TYPE ENTRY     @Z67SP00*/
         OI    SESMD,B'00000001'                                   1175
*   SENOJCL=ON;                     /* NOJCLIN ENTRY         @Z67SP00*/
         OI    SENOJCL,B'00010000'                                 1176
*   GTPFUNCT=GTPADD;                /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'04'                                 1177
*   GTPBUFAD=ADDR(HMASMSET);        /*                       @Z67SP00*/
         LA    @08,HMASMSET                                        1178
         ST    @08,GTPBUFAD(,@15)                                  1178
*   GTPRCDLN=LENGTH(HMASMSET);      /*                       @Z67SP00*/
         MVC   GTPRCDLN(2,@15),@CH00033                            1179
*   GTPKEYLN=LENGTH(SELSTENT);      /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@15),@CH00034                            1180
*   GTPPSIZE=GTP512B;               /* PAGE SIZE IS 512      @Z67SP00*/
         NI    GTPPSIZE(@15),B'11111001'                           1181
         OI    GTPPSIZE(@15),B'00000001'                           1181
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/
         ST    @15,@AL00001                                        1182
         L     @15,@CV01806                                        1182
         LA    @01,@AL00001                                        1182
         BALR  @14,@15                                             1182
*   IF GTPRETRN^=GTPGOOD            /*                       @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,GTPPTR                                          1183
         CLI   GTPRETRN(@15),0                                     1183
         BE    @RF01183                                            1183
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/
         MVI   SCPRETRN,X'08'                                      1184
*   END RNOJCLV;                    /*                       @Z67SP00*/
@EL00025 DS    0H                                                  1185
@EF00025 DS    0H                                                  1185
@ER00025 LM    @14,@12,@SA00025                                    1185
         BR    @14                                                 1185
*   RFY                                                            1186
*     R1 RSTD;                      /*                       @Z67SP00*/
*                                                                  1187
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE IS INVOKED TO INDICATE LIST LOG VERB    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1187
*LLOGALL:                                                          1187
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
LLOGALL  DS    0H                                                  1188
*   LISTALL2=ON;                    /* SET LIST LOG ALL BIT  @Z67SP00*/
         OI    LISTALL2,B'10000000'                                1188
*LLOGPART:                                                         1189
*   ENTRY;                                                         1189
         B     @EC01189                                            1189
LLOGPART DS    0H                                                  1189
@EC01189 DS    0H                                                  1190
*   LISTLOG=ON;                     /*                       @Z67SP00*/
         OI    LISTLOG,B'01000000'                                 1190
*   END LLOGALL;                    /* RETURN TO SCAN                */
*                                                                  1191
@EL00026 DS    0H                                                  1191
@EF00026 DS    0H                                                  1191
@ER00026 BR    @14                                                 1191
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE SAVES THE DATE RANGE FOR LIST LOG       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1192
*LOGSAV:                                                           1192
*   PROCEDURE;                                                     1192
LOGSAV   STM   @14,@12,12(@13)                                     1192
*BMONSAV:                                                          1193
*   ENTRY;                                                         1193
         B     @EC01193                                            1193
BMONSAV  STM   @14,@12,12(@13)                                     1193
@EC01193 DS    0H                                                  1194
*   LISTALL2=OFF;                   /* NOT LIST ALL          @Z67SP00*/
         NI    LISTALL2,B'01111111'                                1194
*   IF SCPPMLN=1                    /*                       @Z40SP00*/
*     THEN                          /*                       @Z40SP00*/
         CLC   SCPPMLN(2),@CH00091                                 1195
         BNE   @RF01195                                            1195
*     LISTBMM(2)=SCPSTRNG(1);       /*                       @Z40SP00*/
         L     @15,SCPCHAR                                         1196
         MVC   LISTBMM+1(1),SCPSTRNG(@15)                          1196
*   ELSE                            /*                       @Z40SP00*/
*     LISTBMM(1:2)=SCPSTRNG(1:2);   /* SAVE BEGINNING MONTH          */
         B     @RC01195                                            1197
@RF01195 L     @15,SCPCHAR                                         1197
         MVC   LISTBMM(2),SCPSTRNG(@15)                            1197
*   GO TO LOGEXIT;                  /* RETURN                        */
         B     LOGEXIT                                             1198
*BDAYSAV:                                                          1199
*   ENTRY;                                                         1199
BDAYSAV  STM   @14,@12,12(@13)                                     1199
*   IF SCPPMLN=1                    /*                       @Z40SP00*/
*     THEN                          /*                       @Z40SP00*/
         CLC   SCPPMLN(2),@CH00091                                 1200
         BNE   @RF01200                                            1200
*     LISTBDD(2)=SCPSTRNG(1);       /*                       @Z40SP00*/
         L     @15,SCPCHAR                                         1201
         MVC   LISTBDD+1(1),SCPSTRNG(@15)                          1201
*   ELSE                            /*                       @Z40SP00*/
*     LISTBDD(1:2)=SCPSTRNG(1:2);   /* SAVE BEGINNING DAY            */
         B     @RC01200                                            1202
@RF01200 L     @15,SCPCHAR                                         1202
         MVC   LISTBDD(2),SCPSTRNG(@15)                            1202
*   GO TO LOGEXIT;                  /* RETURN                        */
         B     LOGEXIT                                             1203
*BYEARSAV:                                                         1204
*   ENTRY;                                                         1204
BYEARSAV STM   @14,@12,12(@13)                                     1204
*   LISTBYY(1:2)=SCPSTRNG(1:2);     /* SAVE BEGINNING YEAR           */
         L     @15,SCPCHAR                                         1205
         MVC   LISTBYY(2),SCPSTRNG(@15)                            1205
*   GO TO LOGEXIT;                  /* RETURN                        */
         B     LOGEXIT                                             1206
*EMONSAV:                                                          1207
*   ENTRY;                                                         1207
EMONSAV  STM   @14,@12,12(@13)                                     1207
*   IF SCPPMLN=1                    /*                       @Z40SP00*/
*     THEN                          /*                       @Z40SP00*/
         CLC   SCPPMLN(2),@CH00091                                 1208
         BNE   @RF01208                                            1208
*     LISTEMM(2)=SCPSTRNG(1);       /*                       @Z40SP00*/
         L     @15,SCPCHAR                                         1209
         MVC   LISTEMM+1(1),SCPSTRNG(@15)                          1209
*   ELSE                            /*                       @Z40SP00*/
*     LISTEMM(1:2)=SCPSTRNG(1:2);   /* SAVE ENDING MONTH             */
         B     @RC01208                                            1210
@RF01208 L     @15,SCPCHAR                                         1210
         MVC   LISTEMM(2),SCPSTRNG(@15)                            1210
*   GO TO LOGEXIT;                  /* RETURN                        */
         B     LOGEXIT                                             1211
*EDAYSAV:                                                          1212
*   ENTRY;                                                         1212
EDAYSAV  STM   @14,@12,12(@13)                                     1212
*   IF SCPPMLN=1                    /*                       @Z40SP00*/
*     THEN                          /*                       @Z40SP00*/
         CLC   SCPPMLN(2),@CH00091                                 1213
         BNE   @RF01213                                            1213
*     LISTEDD(2)=SCPSTRNG(1);       /*                       @Z40SP00*/
         L     @15,SCPCHAR                                         1214
         MVC   LISTEDD+1(1),SCPSTRNG(@15)                          1214
*   ELSE                            /*                       @Z40SP00*/
*     LISTEDD(1:2)=SCPSTRNG(1:2);   /* SAVE ENDING DAYTH             */
         B     @RC01213                                            1215
@RF01213 L     @15,SCPCHAR                                         1215
         MVC   LISTEDD(2),SCPSTRNG(@15)                            1215
*   GO TO LOGEXIT;                  /* RETURN                        */
         B     LOGEXIT                                             1216
*EYEARSAV:                                                         1217
*   ENTRY;                                                         1217
EYEARSAV STM   @14,@12,12(@13)                                     1217
*   LISTEYY(1:2)=SCPSTRNG(1:2);     /* SAVE ENDING YEAR              */
         L     @15,SCPCHAR                                         1218
         MVC   LISTEYY(2),SCPSTRNG(@15)                            1218
*   GO TO LOGEXIT;                  /*                       @Z40SP00*/
         B     LOGEXIT                                             1219
*LOGEXIT:                                                          1220
*   END LOGSAV;                     /* RETURN TO SCAN                */
@EL00027 DS    0H                                                  1220
@EF00027 DS    0H                                                  1220
@ER00027 LM    @14,@12,12(@13)                                     1220
         BR    @14                                                 1220
*                                                                  1221
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINES INDICATE PARAMETERS FROM THE LIST VERB.*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1221
*LISTSAV:                                                          1221
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
*                                                                  1221
LISTSAV  DS    0H                                                  1222
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR CDS                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1222
*CDSSAV:                                                           1222
*   ENTRY;                          /*                       @Z40SP00*/
         B     @EC01222                                            1222
CDSSAV   DS    0H                                                  1222
@EC01222 DS    0H                                                  1223
*   IF(LISTCDS=OFF&LISTPRM1^=ZERO)  /* NO OTHER DS ENTERED   @Z67SP00*/
*     THEN                          /* YES                   @SA99995*/
         TM    LISTCDS,B'01000000'                                 1223
         BNZ   @RF01223                                            1223
         ICM   @15,3,LISTPRM1                                      1223
         BNZ   @RT01223                                            1223
*     GO TO LISTBAD;                /* SYNTAX ERROR          @SA99995*/
*   LISTCDS=ON;                     /* SET TO USE CDS        @SA73849*/
@RF01223 OI    LISTCDS,B'01000000'                                 1225
*   GO TO LISTGOOD;                 /* RETURN                @SA99995*/
*                                                                  1226
         B     LISTGOOD                                            1226
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR ACDS LIST OPTION                          @SA73849*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1227
*ACDSSAV:                                                          1227
*   ENTRY;                          /*                       @SA73849*/
ACDSSAV  DS    0H                                                  1228
*   IF(LISTACDS=OFF&LISTPRM1^=ZERO) /* IF OTHR DS CODED      @Z67SP00*/
*     THEN                          /* YES - THEN ERR        @SA73855*/
         TM    LISTACDS,B'00100000'                                1228
         BNZ   @RF01228                                            1228
         ICM   @15,3,LISTPRM1                                      1228
         BNZ   @RT01228                                            1228
*     GO TO LISTBAD;                /* BR TO ERR RTN         @SA73855*/
*   LISTACDS=ON;                    /* SET TO USE ACDS       @SA73849*/
@RF01228 OI    LISTACDS,B'00100000'                                1230
*   GO TO LISTGOOD;                 /* RETURN                @SA73849*/
         B     LISTGOOD                                            1231
*SCDSSAV:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
SCDSSAV  DS    0H                                                  1233
*   IF(LISTSCDS=OFF&LISTPRM1^=ZERO) /* IF OTHER DS ENTERED   @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    LISTSCDS,B'00010000'                                1233
         BNZ   @RF01233                                            1233
         ICM   @15,3,LISTPRM1                                      1233
         BNZ   @RT01233                                            1233
*     GO TO LISTBAD;                /*                       @Z67SP00*/
*   LISTSCDS=ON;                    /*                       @Z67SP00*/
@RF01233 OI    LISTSCDS,B'00010000'                                1235
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
         B     LISTGOOD                                            1236
*PTSSAV:                            /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
PTSSAV   DS    0H                                                  1238
*   IF(LISTPTF=OFF&LISTPRM1^=ZERO)  /* IF OTHER DS ENTERED   @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    LISTPTF,B'00000100'                                 1238
         BNZ   @RF01238                                            1238
         ICM   @15,3,LISTPRM1                                      1238
         BNZ   @RT01238                                            1238
*     GO TO LISTBAD;                /*                       @Z67SP00*/
*   LISTPTS=ON;                     /*                       @Z67SP00*/
@RF01238 OI    LISTPTS,B'00000010'                                 1240
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
         B     LISTGOOD                                            1241
*CRQSAV:                            /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
CRQSAV   DS    0H                                                  1243
*   IF(LISTCRQ=OFF&LISTPRM1^=ZERO)  /* IF OTHER DS ENTERED   @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    LISTCRQ,B'00001000'                                 1243
         BNZ   @RF01243                                            1243
         ICM   @15,3,LISTPRM1                                      1243
         BNZ   @RT01243                                            1243
*     GO TO LISTBAD;                /*                       @Z67SP00*/
*   LISTCRQ=ON;                     /*                       @Z67SP00*/
@RF01243 OI    LISTCRQ,B'00001000'                                 1245
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
         B     LISTGOOD                                            1246
*ACRQSAV:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
ACRQSAV  DS    0H                                                  1248
*   IF(LISTACRQ=OFF&LISTPRM1^=ZERO) /* IF OTHER DS ENTERED   @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    LISTACRQ,B'00000100'                                1248
         BNZ   @RF01248                                            1248
         ICM   @15,3,LISTPRM1                                      1248
         BNZ   @RT01248                                            1248
*     GO TO LISTBAD;                /*                       @Z67SP00*/
*   LISTACRQ=ON;                    /*                       @Z67SP00*/
@RF01248 OI    LISTACRQ,B'00000100'                                1250
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
*                                                                  1251
         B     LISTGOOD                                            1251
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR PTF                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1252
*SYSMSAV:                                                          1252
*   ENTRY;                          /*                       @Z40SP00
*                                                            @Z67SP00*/
SYSMSAV  DS    0H                                                  1253
*   SESMD=ON;                       /* SET OTHER DS SYSMOD   @Z67SP00*/
         OI    SESMD,B'00000001'                                   1253
*   LISTSMD=ON;                     /* INDICATE PTFS TO BE LISTED    */
         OI    LISTSMD,B'10000000'                                 1254
*   GO TO LISTCHCK;                 /* RETURN                @Z40SP00*/
*                                                                  1255
         B     LISTCHCK                                            1255
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR MOD                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1256
*MODSAV:                                                           1256
*   ENTRY;                          /*                       @Z40SP00*/
MODSAV   DS    0H                                                  1257
*   SEMOD=ON;                       /* SET MOD BIT           @Z67SP00*/
         OI    SEMOD,B'00100000'                                   1257
*   LISTMOD=ON;                     /* INDICATE MODULES TO BE LISTED */
         OI    LISTMOD,B'00001000'                                 1258
*   GO TO LISTCHCK;                 /* RETURN                @ZD00006*/
*                                                                  1259
         B     LISTCHCK                                            1259
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR MACS                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1260
*MACSAV:                                                           1260
*   ENTRY;                          /*                       @Z40SP00*/
MACSAV   DS    0H                                                  1261
*   SEMAC=ON;                       /* SET MAC BIT           @Z67SP00*/
         OI    SEMAC,B'00010000'                                   1261
*   LISTMAC=ON;                     /* INDICATE MACROS TO BE LISTED  */
         OI    LISTMAC,B'00010000'                                 1262
*   GO TO LISTCHCK;                 /* RETURN                @ZD00006*/
*                                                                  1263
         B     LISTCHCK                                            1263
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LMODS                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1264
*LMODSAV:                                                          1264
*   ENTRY;                          /*                       @Z40SP00*/
LMODSAV  DS    0H                                                  1265
*   SELMD=ON;                       /* SET LMOD BIT          @Z67SP00*/
         OI    SELMD,B'00001000'                                   1265
*   LISTLMD=ON;                     /* INDICATE LMODS TO BE LISTED   */
         OI    LISTLMD,B'00100000'                                 1266
*   GO TO LISTCHCK;                 /* RETURN                @Z67SP00*/
*                                                                  1267
         B     LISTCHCK                                            1267
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR ASSEMS                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1268
*ASSEMSAV:                                                         1268
*   ENTRY;                          /*                       @Z40SP00*/
ASSEMSAV DS    0H                                                  1269
*   SEASM=ON;                       /* SET ASM BIT           @Z67SP00*/
         OI    SEASM,B'00000100'                                   1269
*   LISTASM=ON;                     /* INDICATE ASSEMBLIES           */
         OI    LISTASM,B'01000000'                                 1270
*   GO TO LISTCHCK;                 /* RETURN                @Z67SP00*/
*                                                                  1271
         B     LISTCHCK                                            1271
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR DLIBS                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1272
*DLIBSAV:                                                          1272
*   ENTRY;                          /*                       @Z40SP00*/
DLIBSAV  DS    0H                                                  1273
*   SEDLB=ON;                       /* SET DLIB BIT          @Z67SP00*/
         OI    SEDLB,B'01000000'                                   1273
*   LISTDLB=ON;                     /* INDICATE DLIBS TO BE LISTED   */
         OI    LISTDLB,B'00000010'                                 1274
*   GO TO LISTCHCK;                 /* RETURN                @Z67SP00*/
*                                                                  1275
         B     LISTCHCK                                            1275
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR SOURCE                                    @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1276
*SRCSAV:                                                           1276
*   ENTRY;                          /*                       @Z40SP00*/
SRCSAV   DS    0H                                                  1277
*   SESRC=ON;                       /* SET SOURCE BIT        @Z67SP00*/
         OI    SESRC,B'10000000'                                   1277
*   LISTSRC=ON;                     /* INDICATE SRC LIST     @Z40SP00*/
         OI    LISTSRC,B'00000100'                                 1278
*   GO TO LISTCHCK;                 /* RETURN                @ZD00006*/
*                                                                  1279
         B     LISTCHCK                                            1279
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR ENV                                       @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1280
*FMIDSAV:                                                          1280
*   ENTRY;                          /*                       @Z67SP00*/
FMIDSAV  DS    0H                                                  1281
*   SEFMD=ON;                       /* SET ENV BIT           @Z67SP00*/
         OI    SEFMD,B'00000010'                                   1281
*   LISTFMD=ON;                     /* INDICATE ENV LIST     @Z67SP00*/
         OI    LISTFMD,B'01000000'                                 1282
*   GO TO LISTCHCK;                 /* RETURN                @Z67SP00*/
*                                                                  1283
         B     LISTCHCK                                            1283
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR MCS KEYWORD                               @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1284
*MCSSAV:                                                           1284
*   ENTRY;                          /*                       @Z67SP00*/
MCSSAV   DS    0H                                                  1285
*   SEMCS=ON;                       /* SET CNTL BIT          @Z67SP00*/
         OI    SEMCS,B'00000010'                                   1285
*   LISTMCS=ON;                     /* INDICATE CNTL LIST    @Z67SP00*/
         OI    LISTMCS,B'00100000'                                 1286
*   GO TO LISTCHCK;                 /* RETURN                @Z67SP00*/
*                                                                  1287
         B     LISTCHCK                                            1287
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST SELECT KEYWORD                       @SA99995*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1288
*LSELSAV:                                                          1288
*   ENTRY;                          /*                       @SA99995*/
LSELSAV  DS    0H                                                  1289
*   IF LISTCNT^=ONE                 /* WAS PREVIOUS LIST     @SA99995*/
*     THEN                          /* OPTION A NON-SELECT   @SA99995*/
         CLC   LISTCNT(2),@CH00091                                 1289
         BNE   @RT01289                                            1289
*     GO TO LISTBAD;                /* IF SO - ERR           @SA99995*/
*   SESELECT=ON;                    /* SET SELECT BIT        @Z67SP00*/
         OI    SESELECT,B'01000000'                                1291
*   LISTSEL=ON;                     /* SET SELECT IN LIST PRM      1292
*                                                            @Z67SP00*/
         OI    LISTSEL,B'10000000'                                 1292
*   GO TO LISTGOOD;                 /* RETURN                @SA99995*/
*                                                                  1293
         B     LISTGOOD                                            1293
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE ENTERED WHEN CLOSING PAREN FOUND ON SELECT LIST       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1294
*LSELEND:                                                          1294
*   ENTRY;                          /*                       @SA99995*/
LSELEND  DS    0H                                                  1295
*   SELSTFLG=''B;                   /* RESET SELECT BITS     @Z67SP00*/
         XC    SELSTFLG(2),SELSTFLG                                1295
*   LISTCNT=LISTCNT-ONE;            /* RESET OPTION COUNT    @SA99995*/
         LH    @15,LISTCNT                                         1296
         BCTR  @15,0                                               1296
         STH   @15,LISTCNT                                         1296
*   GO TO LISTGOOD;                 /*                       @SA99995*/
*                                                                  1297
         B     LISTGOOD                                            1297
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR SYSTEM ENTRY ROUTINE FOR SYSTEM ENTRY             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1298
*SYSSAV:                                                           1298
*   ENTRY;                          /*                       @Z40SP00*/
SYSSAV   DS    0H                                                  1299
*   LISTSYS=ON;                     /* INDICATE LIST SYSTEM ENTRY    */
         OI    LISTSYS,B'00000001'                                 1299
*   GO TO LISTGOOD;                 /*                       @SA73855*/
*                                                                  1300
         B     LISTGOOD                                            1300
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST BYPASS KEYWORD                       @SA99995*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1301
*LBYPSAV:                                                          1301
*   ENTRY;                          /*                       @SA99995*/
LBYPSAV  DS    0H                                                  1302
*   LISTBYP=ON;                     /* SET FORCE BIT         @SA99995*/
         OI    LISTBYP,B'00010000'                                 1302
*   GO TO LISTGOOD;                 /* GO TO EXIT            @SA99995*/
*                                                                  1303
         B     LISTGOOD                                            1303
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST APPLY OPTION KEYWORD                 @SA99995*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1304
*LNAPPSAV:                                                         1304
*   ENTRY;                          /*                       @Z67SP00*/
LNAPPSAV DS    0H                                                  1305
*   LISTNOAP=ON;                    /* SET APPLY LIST BIT    @Z67SP00*/
         OI    LISTNOAP,B'01000000'                                1305
*   GO TO LISTGOOD;                 /* GO TO GOOD RETURN     @SA99995*/
*                                                                  1306
         B     LISTGOOD                                            1306
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST RESTORE OPTION KEYWORD               @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1307
*LRESSAV:                                                          1307
*   ENTRY;                          /*                       @Z40SP00*/
LRESSAV  DS    0H                                                  1308
*   LISTRES=ON;                     /* SET REST LIST BIT     @Z40SP00*/
         OI    LISTRES,B'00010000'                                 1308
*   GO TO LISTGOOD;                 /* GO TO GOOD RETURN     @Z40SP00*/
*                                                                  1309
         B     LISTGOOD                                            1309
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST ACCEPT OPTION KEYWORD                @SA99995*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1310
*LNACCSAV:                                                         1310
*   ENTRY;                          /*                       @Z67SP00*/
LNACCSAV DS    0H                                                  1311
*   LISTNOAC=ON;                    /* SET ACCEPT LIST BIT   @Z67SP00*/
         OI    LISTNOAC,B'00100000'                                1311
*   GO TO LISTGOOD;                 /* GO TO GOOD RETURN     @SA99995*/
*                                                                  1312
         B     LISTGOOD                                            1312
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST ERROR OPTION KEYWORD                 @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1313
*LERRSAV:                                                          1313
*   ENTRY;                          /*                       @Z40SP00*/
LERRSAV  DS    0H                                                  1314
*   LISTERR=ON;                     /* SET ERR LIST BIT      @Z40SP00*/
         OI    LISTERR,B'00001000'                                 1314
*   GO TO LISTGOOD;                 /* RETURN                @Z40SP00*/
*                                                                  1315
         B     LISTGOOD                                            1315
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST SUP OPTION KEYWORD                   @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1316
*LSUPSAV:                           /*                       @Z40SP00*/
*   ENTRY;                          /*                       @Z40SP00*/
LSUPSAV  DS    0H                                                  1317
*   LISTSUP=ON;                     /* SET SUP LIST BIT      @Z40SP00*/
         OI    LISTSUP,B'10000000'                                 1317
*   GO TO LISTGOOD;                 /*                       @Z40SP00*/
*                                                                  1318
         B     LISTGOOD                                            1318
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST NOSUP OPTION KEYWORD                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1319
*LNSUPSAV:                          /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
LNSUPSAV DS    0H                                                  1320
*   LISTNSUP=ON;                    /* SET SUP LIST BIT      @Z67SP00*/
         OI    LISTNSUP,B'01000000'                                1320
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
*                                                                  1321
         B     LISTGOOD                                            1321
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST DELETE OPTION KEYWORD                @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1322
*LDELSAV:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
LDELSAV  DS    0H                                                  1323
*   LISTDEL=ON;                     /*                       @Z67SP00*/
         OI    LISTDEL,B'00100000'                                 1323
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
*                                                                  1324
         B     LISTGOOD                                            1324
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE FOR LIST PTFBY OPTION KEYWORD                 @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1325
*LXRFSAV:                           /*                       @ZD00009*/
*   ENTRY;                          /*                       @ZD00009*/
LXRFSAV  DS    0H                                                  1326
*   LISTXREF=ON;                    /* SET SUP LIST BIT      @ZD00009*/
         OI    LISTXREF,B'01000000'                                1326
*   GO TO LISTGOOD;                 /*                       @ZD00009*/
*                                                                  1327
         B     LISTGOOD                                            1327
*   /*****************************************************************/
*   /*                                                               */
*   /* LIST FUNCTION OPTION SAVE                             @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1328
*LFNCSAV:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
LFNCSAV  DS    0H                                                  1329
*   LISTFUNC=ON;                    /*                       @Z67SP00*/
         OI    LISTFUNC,B'00001000'                                1329
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
*                                                                  1330
         B     LISTGOOD                                            1330
*   /*****************************************************************/
*   /*                                                               */
*   /* LIST PTF OPTION SAVE                                  @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1331
*LPTFSAV:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
LPTFSAV  DS    0H                                                  1332
*   LISTPTF=ON;                     /*                       @Z67SP00*/
         OI    LISTPTF,B'00000100'                                 1332
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
*                                                                  1333
         B     LISTGOOD                                            1333
*   /*****************************************************************/
*   /*                                                               */
*   /* LIST APAR OPTION SAVE                                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1334
*LAPRSAV:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
LAPRSAV  DS    0H                                                  1335
*   LISTAPAR=ON;                    /*                       @Z67SP00*/
         OI    LISTAPAR,B'00000010'                                1335
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
*                                                                  1336
         B     LISTGOOD                                            1336
*   /*****************************************************************/
*   /*                                                               */
*   /* LIST USER OPTION SAVE                                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1337
*LUSRSAV:                           /*                       @Z67SP00*/
*   ENTRY;                          /*                       @Z67SP00*/
LUSRSAV  DS    0H                                                  1338
*   LISTUSER=ON;                    /*                       @Z67SP00*/
         OI    LISTUSER,B'00000001'                                1338
*   GO TO LISTGOOD;                 /*                       @Z67SP00*/
         B     LISTGOOD                                            1339
*                                                                  1340
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE ENTERED WHEN PERIOD FOUND ON LIST VERB. IT CHECKS TO  */
*   /* INSURE THAT ENOUGH OPTION WERE ENTERED AND FILLS IN THE LIST  */
*   /* ALL OPTION OR LIST SYS AND PTF OPTIONS IF ONLY THE CDS OR ACDS*/
*   /* KEYWORD WAS CODED.                                    @SA73855*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1340
*LISTPER:                           /*                       @SA73855*/
*   ENTRY;                          /*                       @SA73855*/
LISTPER  DS    0H                                                  1341
*   DECLARE                         /*                       @Z67SP00*/
*     SAVSCPCH PTR(31);             /*                       @Z67SP00*/
*   DECLARE                         /*                       @Z67SP00*/
*     SYSENT CHAR(8) CONSTANT('SYSTEM  ');/*                 @Z67SP00*/
*                                                                  1342
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR MUTUALLY EXCLUSIVE KEYWORDS                 @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1343
*   IF LISTSUP=ON&LISTNSUP=ON       /* SUP AND NOSUP         @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         TM    LISTSUP,B'11000000'                                 1343
         BNO   @RF01343                                            1343
*     DO;                           /*                       @Z67SP00*/
*       RTNERR=ON;                  /* MSG PRODUCED IN ROUT  @Z67SP00*/
         OI    RTNERR,B'10000000'                                  1345
*       MGPCLEAR=''B;               /*                       @Z67SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                1346
*       MGPMGNO1=HMA341I;           /* KEYWORDS XXXXXXX AND XXXXXXXX
*                                      ARE MUTUALLY EXCLUSIVE      1347
*                                                            @Z67SP00*/
         MVC   MGPMGNO1(2),@CH01781                                1347
*       MGPVARPT(1)=ADDR(TXTSUP);   /*                       @Z67SP00*/
         LA    @15,@CC01787                                        1348
         ST    @15,MGPVARPT                                        1348
*       MGPVARPT(2)=ADDR(TXTNOSUP); /*                       @Z67SP00*/
         LA    @15,@CC01789                                        1349
         ST    @15,MGPVARPT+4                                      1349
*       MGPTYPE=MGPSEV;             /*                       @Z67SP00*/
         MVI   MGPTYPE,X'04'                                       1350
*       SAVR1=R1;                   /* SAVE REG1 ACROSS CALL @Z67SP00*/
         ST    R1,SAVR1                                            1351
*       SAVRTN=RTNREG;              /* SAVE RETURN ADDR      @Z67SP00*/
         ST    RTNREG,SAVRTN                                       1352
*       RFY                                                        1353
*         R1 UNRSTD;                /* UNRST IT FOR PARM     @Z67SP00*/
*       CALL HMASMMSG(HMASMMGP);    /* WRITE MSG             @Z67SP00*/
         L     @15,@CV01809                                        1354
         LA    @01,@AL01354                                        1354
         BALR  @14,@15                                             1354
*       RFY                                                        1355
*         R1 RSTD;                  /* RESTRICT R1 AGAIN     @Z67SP00*/
*       R1=SAVR1;                   /* RESTORE TO ORIGINAL   @Z67SP00*/
         L     R1,SAVR1                                            1356
*       RTNREG=SAVRTN;              /*                       @Z67SP00*/
         L     RTNREG,SAVRTN                                       1357
*       GO TO LISTBAD;              /*                       @Z67SP00*/
         B     LISTBAD                                             1358
*     END;                          /*                       @Z67SP00*/
*                                                                  1359
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SYSMOD KEYWORD REQUIRED                     @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1360
*   IF LISTSMD=OFF                  /* IF SYSMOD NOT SPECIFIEDZ67SP00*/
*       &                           /* AND                   @Z67SP00*/
*       (LISTFUNC=ON                /* ONE OF SYSMOD TYPE    @Z67SP00*/
*       ×LISTPTF=ON                 /* SPCIFIED THEN SET     @Z67SP00*/
*       ×LISTAPAR=ON                /* LIST SYSMOD           @Z67SP00*/
*       ×LISTUSER=ON                /*                       @Z67SP00*/
*       ×LISTNOAP=ON                /* APPLY OR              @Z67SP00*/
*       ×LISTNOAC=ON                /* ACCEPT OR             @Z67SP00*/
*       ×LISTRES=ON                 /* RESTORE OR            @SA99995*/
*       ×LISTBYP=ON                 /* BYPASS                @Z40SP00*/
*       ×LISTERR=ON                 /* OR ERROR              @Z40SP00*/
*       ×LISTDEL=ON                 /* OR DELETE             @Z67SP00*/
*       ×LISTNSUP=ON                /* OR NOSUP              @Z67SP00*/
*       ×LISTSUP=ON)                /* OR SUP                @Z40SP00*/
*     THEN                          /* ENTERED THEN          @SA99995*/
@RF01343 TM    LISTSMD,B'10000000'                                 1360
         BNZ   @RF01360                                            1360
         TM    LISTFUNC,B'01111111'                                1360
         BNZ   @RT01360                                            1360
         TM    LISTBYP,B'11111000'                                 1360
         BZ    @RF01360                                            1360
@RT01360 DS    0H                                                  1361
*     DO;                           /*                       @Z67SP00*/
*       RTNERR=ON;                  /* MSG PRODUCED IN ROUT  @Z67SP00*/
         OI    RTNERR,B'10000000'                                  1362
*       MGPCLEAR=''B;               /*                       @Z67SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                1363
*       MGPMGNO1=HMA425I;           /* X8X KEYWORD REQUIRED WHEN   1364
*                                      OTHER QUALIFYING KEYWORDS ARE
*                                      SPECIFIED             @Z67SP00*/
         MVC   MGPMGNO1(2),@CH01783                                1364
*       MGPVARPT(1)=ADDR(TXTSMD);   /*                       @Z67SP00*/
         LA    @15,@CC01845                                        1365
         ST    @15,MGPVARPT                                        1365
*       MGPTYPE=MGPSEV;             /*                       @Z67SP00*/
         MVI   MGPTYPE,X'04'                                       1366
*       SAVR1=R1;                   /* SAVE REG1 ACROSS CALL @Z67SP00*/
         ST    R1,SAVR1                                            1367
*       SAVRTN=RTNREG;              /* SAVE RETURN ADDR      @Z67SP00*/
         ST    RTNREG,SAVRTN                                       1368
*       RFY                                                        1369
*         R1 UNRSTD;                /* UNRST IT FOR PARM     @Z67SP00*/
*       CALL HMASMMSG(HMASMMGP);    /* WRITE MSG             @Z67SP00*/
         L     @15,@CV01809                                        1370
         LA    @01,@AL01370                                        1370
         BALR  @14,@15                                             1370
*       RFY                                                        1371
*         R1 RSTD;                  /* RESTRICT R1 AGAIN     @Z67SP00*/
*       R1=SAVR1;                   /* RESTORE TO ORIGINAL   @Z67SP00*/
         L     R1,SAVR1                                            1372
*       RTNREG=SAVRTN;              /*                       @Z67SP00*/
         L     RTNREG,SAVRTN                                       1373
*       GO TO LISTBAD;              /*                       @Z67SP00*/
         B     LISTBAD                                             1374
*     END;                          /*                       @Z67SP00*/
*   IF(SESELECT=ON                  /* SELECTIVE RUN?        @Z67SP00*/
*       &LISTCNT^=ZERO)             /* AND LAST OPTION WAS NOT SELECT
*                                                            @Z40SP00*/
*       ×LISTPRM1=ZERO              /* NO DATASET SPECIFIED  @Z67SP00*/
*     THEN                          /* THEN ERROR            @SA73855*/
@RF01360 TM    SESELECT,B'01000000'                                1376
         BNO   @GL00054                                            1376
         ICM   @15,3,LISTCNT                                       1376
         BNZ   @RT01376                                            1376
@GL00054 ICM   @15,3,LISTPRM1                                      1376
         BZ    @RT01376                                            1376
*     GO TO LISTBAD;                /* GO TO BAD RTN         @SA99995*/
*   IF LISTPRM2=ZERO                /* IF NO OPTIONS ENTERED @ZA16665*/
*     THEN                          /*                       @SA73855*/
         ICM   @15,3,LISTPRM2                                      1378
         BNZ   @RF01378                                            1378
*     LISTALL2=ON;                  /* LIST ALL DEFAULT      @Z67SP00*/
         OI    LISTALL2,B'10000000'                                1379
*   IF LISTSYS=ON                   /* IF SYSTEM REQUESTED   @Z67SP00*/
*       &(                          /*                       @Z67SP00*/
*       SESELECT=ON                 /* AND SELECTIVE RUN     @Z67SP00*/
*       ×                           /* OR MASS REQUEST       @Z67SP00*/
*       (LISTASM=OFF                /* BUT ONLY SYSTEM       @Z67SP00*/
*       &LISTLMD=OFF                /* DELECTED              @Z67SP00*/
*       &LISTMAC=OFF                /*                       @Z67SP00*/
*       &LISTMOD=OFF                /* THEN MAKE IT LOOK     @Z67SP00*/
*       &LISTSRC=OFF                /* LOOK LIKE SELECTIVE   @Z67SP00*/
*       &LISTDLB=OFF                /* RUN                   @Z67SP00*/
*       &LISTSMD=OFF                /* TO IMPROVE            @Z67SP00*/
*       &LISTFMD=OFF                /* PERFORMANCE           @Z67SP00*/
*       &LISTMCS=OFF)               /*                       @Z67SP00*/
*       )                           /*                       @Z67SP00*/
*     THEN                          /* YES                   @SA99995*/
@RF01378 TM    LISTSYS,B'00000001'                                 1380
         BNO   @RF01380                                            1380
         TM    SESELECT,B'01000000'                                1380
         BO    @RT01380                                            1380
         TM    LISTASM,B'01111110'                                 1380
         BNZ   @RF01380                                            1380
         TM    LISTSMD,B'11100000'                                 1380
         BNZ   @RF01380                                            1380
@RT01380 DS    0H                                                  1381
*     DO;                           /* ADD SYS ENT TO SELIST @SA99995*/
*       LISTSEL=ON;                 /* IN SELECT MODE        @Z67SP00*/
         OI    LISTSEL,B'10000000'                                 1382
*       SELSTFLG=''B;               /* ZERO SET TYPE FLAG    @Z67SP00*/
         XC    SELSTFLG(2),SELSTFLG                                1383
*       SESELECT=ON;                /* IN SELECT MODE        @Z67SP00*/
         OI    SESELECT,B'01000000'                                1384
*       SESYS=ON;                   /* SET TO SYSTEM TYPE OPTION   1385
*                                                            @Z67SP00*/
         OI    SESYS,B'00000001'                                   1385
*       SAVSCPCH=SCPCHAR;           /* SAVE CURRECT PTR      @SA99995*/
         MVC   SAVSCPCH(4),SCPCHAR                                 1386
*       SCPCHAR=ADDR(SYSENT);       /* PTR TO SYSTEM ID      @SA99995*/
         LA    @15,@CC02524                                        1387
         ST    @15,SCPCHAR                                         1387
*       SCPPMLN=LENGTH(SYSENT);     /* LENGTH OF ENTRY       @SA99995*/
         MVC   SCPPMLN(2),@CH00116                                 1388
*       SAVRTN=RTNREG;              /* SAV RTN ADDR          @Z40SP00*/
         ST    RTNREG,SAVRTN                                       1389
*       CALL SESAV;                 /* BUILD SET ENTRY       @Z67SP00*/
         BAL   @14,SESAV                                           1390
*       RTNREG=SAVRTN;              /*                       @Z67SP00*/
         L     RTNREG,SAVRTN                                       1391
*       SCPCHAR=SAVSCPCH;           /*                       @Z67SP00*/
         MVC   SCPCHAR(4),SAVSCPCH                                 1392
*       SCPPMLN=1;                  /*                       @Z67SP00*/
         MVC   SCPPMLN(2),@CH00091                                 1393
*     END;                          /*                       @Z67SP00*/
*   GO TO LISTCHCK;                 /*                       @SA73855*/
         B     LISTCHCK                                            1395
*                                                                  1396
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON CHECKING ROUTINE AND GOOD AND BAD EXITS FOR LIST OPTION*/
*   /* ROUTINES                                              @SA99995*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1396
*LISTCHCK:                          /*                       @SA99995*/
*   LISTCNT=LISTCNT+1;              /* INCR OPTION COUNT     @SA99995*/
LISTCHCK LA    @15,1                                               1396
         LH    @08,LISTCNT                                         1396
         ALR   @08,@15                                             1396
         STH   @08,LISTCNT                                         1396
*   IF SESELECT=ON                  /* SELECTIVE RUN?        @Z67SP00*/
*       &LISTCNT^=ONE               /* AND LAST OPTION WAS NOT     1397
*                                      SELECTIVE             @SA99995*/
*     THEN                          /* IF SO ERR             @SA99995*/
         TM    SESELECT,B'01000000'                                1397
         BNO   @RF01397                                            1397
         CR    @08,@15                                             1397
         BE    @RF01397                                            1397
*     SCPRET=SCPSTOP;               /* SET SCAN SYNTAX ERR   @SA99995*/
         MVI   SCPRET,X'08'                                        1398
*   ELSE                            /* OPTIONS OK            @SA99995*/
*     DO;                           /* RETURN WITH GOOD CODE @SA99995*/
         B     @RC01397                                            1399
@RF01397 DS    0H                                                  1400
*LISTGOOD:                                                         1400
*                                                                  1400
*       /*************************************************************/
*       /*                                                           */
*       /* NEED DATASET/ENTRY TYPE CHECKING HERE             @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1400
*       IF LISTCDS=ON               /* IF CDS LIST           @Z67SP00*/
*           &                       /* AND                   @Z67SP00*/
*           (LISTFMD=ON             /* ENV OF CNTL REQUESTED @Z67SP00*/
*           ×LISTMCS=ON             /* OR MCS                @Z67SP00*/
*           ×LISTNOAP=ON)           /* OR NOAPPLY            @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
LISTGOOD TM    LISTCDS,B'01000000'                                 1400
         BNO   @RF01400                                            1400
         TM    LISTFMD,B'01100000'                                 1400
         BNZ   @RT01400                                            1400
         TM    LISTNOAP,B'01000000'                                1400
         BO    @RT01400                                            1400
*         GO TO LISTBAD;            /*                       @Z67SP00*/
*       IF LISTACDS=ON              /*                       @Z67SP00*/
*           &                       /* AND REQUEST FOR       @Z67SP00*/
*           (LISTASM=ON             /* ASSEM                 @Z67SP00*/
*           ×LISTLMD=ON             /* OR LMOD               @Z67SP00*/
*           ×LISTDLB=ON             /* OR DLIB               @Z67SP00*/
*           ×LISTFMD=ON             /* OR FMID               @Z67SP00*/
*           ×LISTMCS=ON             /* OR MCS                @Z67SP00*/
*           ×LISTNOAC=ON            /* OR NOACCEPT           @Z67SP00*/
*           ×LISTRES=ON)            /* OR RESTORE            @Z67SP00*/
*         THEN                      /* THEN                  @Z67SP00*/
@RF01400 TM    LISTACDS,B'00100000'                                1402
         BNO   @RF01402                                            1402
         TM    LISTASM,B'01100010'                                 1402
         BNZ   @RT01402                                            1402
         TM    LISTFMD,B'01100000'                                 1402
         BNZ   @RT01402                                            1402
         TM    LISTNOAC,B'00110000'                                1402
         BNZ   @RT01402                                            1402
*         GO TO LISTBAD;            /* ERROR                 @Z67SP00*/
*       IF(LISTCRQ=ON               /* IF CRQ OR ACRQ        @Z67SP00*/
*           ×LISTACRQ=ON)           /*                       @Z67SP00*/
*           &                       /* AND REQUEST FOR       @Z67SP00*/
*           (LISTASM=ON             /* ASSEM                 @Z67SP00*/
*           ×LISTLMD=ON             /* LMOD                  @Z67SP00*/
*           ×LISTMAC=ON             /* MAC                   @Z67SP00*/
*           ×LISTMOD=ON             /* MOD                   @Z67SP00*/
*           ×LISTSRC=ON             /* SRC                   @Z67SP00*/
*           ×LISTDLB=ON             /* DLIB                  @Z67SP00*/
*           ×LISTMCS=ON             /* MCS                   @Z67SP00*/
*           ×LISTSYS=ON             /* OR SYS                @Z67SP00*/
*           ×LISTFUNC=ON            /* OR FUNCTION           @Z67SP00*/
*           ×LISTPTF=ON             /* OR PTF                @Z67SP00*/
*           ×LISTAPAR=ON            /* OR APAR               @Z67SP00*/
*           ×LISTUSER=ON            /* OR USERMOD            @Z67SP00*/
*           ×LISTERR=ON             /* OR ERROR              @Z67SP00*/
*           ×LISTDEL=ON             /* OR DEL                @Z67SP00*/
*           ×LISTNOAP=ON            /* NOAPPLY               @Z67SP00*/
*           ×LISTNOAC=ON            /* NOACCEPT              @Z67SP00*/
*           ×LISTSUP=ON             /* SUP                   @Z67SP00*/
*           ×LISTNSUP=ON            /* NOSUP                 @Z67SP00*/
*           ×LISTRES=ON             /* RESTORE               @Z67SP00*/
*           ×LISTBYP=ON             /* OR BYPASS             @Z67SP00*/
*           ×LISTXREF=ON)           /* OR XREF               @Z67SP00*/
*         THEN                      /* THEN                  @Z67SP00*/
@RF01402 TM    LISTCRQ,B'00001100'                                 1404
         BZ    @RF01404                                            1404
         TM    LISTASM,B'01111110'                                 1404
         BNZ   @RT01404                                            1404
         TM    LISTMCS,B'00100000'                                 1404
         BO    @RT01404                                            1404
         TM    LISTSYS,B'00000001'                                 1404
         BO    @RT01404                                            1404
         TM    LISTFUNC,B'00001111'                                1404
         BNZ   @RT01404                                            1404
         TM    LISTERR,B'00101000'                                 1404
         BNZ   @RT01404                                            1404
         TM    LISTNOAP,B'01100000'                                1404
         BNZ   @RT01404                                            1404
         TM    LISTSUP,B'11000000'                                 1404
         BNZ   @RT01404                                            1404
         TM    LISTRES,B'00010000'                                 1404
         BO    @RT01404                                            1404
         TM    LISTBYP,B'00010000'                                 1404
         BO    @RT01404                                            1404
         TM    LISTXREF,B'01000000'                                1404
         BO    @RT01404                                            1404
*         GO TO LISTBAD;            /* ERROR                 @Z67SP00*/
*       IF LISTSCDS=ON              /*                       @Z67SP00*/
*           &                       /*                       @Z67SP00*/
*           (LISTASM=ON             /*                       @Z67SP00*/
*           ×LISTLMD=ON             /*                       @Z67SP00*/
*           ×LISTMAC=ON             /*                       @Z67SP00*/
*           ×LISTMOD=ON             /*                       @Z67SP00*/
*           ×LISTSRC=ON             /*                       @Z67SP00*/
*           ×LISTDLB=ON             /*                       @Z67SP00*/
*           ×LISTSYS=ON             /*                       @Z67SP00*/
*           ×LISTMCS=ON             /*                       @Z67SP00*/
*           ×LISTFMD=ON             /*                       @Z67SP00*/
*           ×LISTNOAP=ON            /*                       @Z67SP00*/
*           ×LISTNOAC=ON            /*                       @Z67SP00*/
*           ×LISTRES=ON             /*                       @Z67SP00*/
*           ×LISTDEL=ON             /*                       @Z67SP00*/
*           ×LISTNSUP=ON            /*                       @Z67SP00*/
*           ×LISTSUP=ON             /*                       @Z67SP00*/
*           ×LISTBYP=ON             /*                       @Z67SP00*/
*           ×LISTERR=ON             /*                       @Z67SP00*/
*           ×LISTXREF=ON)           /*                       @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
@RF01404 TM    LISTSCDS,B'00010000'                                1406
         BNO   @RF01406                                            1406
         TM    LISTASM,B'01111111'                                 1406
         BNZ   @RT01406                                            1406
         TM    LISTMCS,B'01100000'                                 1406
         BNZ   @RT01406                                            1406
         TM    LISTNOAP,B'01110000'                                1406
         BNZ   @RT01406                                            1406
         TM    LISTDEL,B'11111000'                                 1406
         BNZ   @RT01406                                            1406
         TM    LISTXREF,B'01000000'                                1406
         BO    @RT01406                                            1406
*         GO TO LISTBAD;            /*                       @Z67SP00*/
*       IF LISTPTS=ON               /*                       @Z67SP00*/
*           &                       /*                       @Z67SP00*/
*           (LISTASM=ON             /*                       @Z67SP00*/
*           ×LISTLMD=ON             /*                       @Z67SP00*/
*           ×LISTMAC=ON             /*                       @Z67SP00*/
*           ×LISTMOD=ON             /*                       @Z67SP00*/
*           ×LISTSRC=ON             /*                       @Z67SP00*/
*           ×LISTDLB=ON             /*                       @Z67SP00*/
*           ×LISTFMD=ON             /*                       @Z67SP00*/
*           ×LISTDEL=ON             /*                       @Z67SP00*/
*           ×LISTNSUP=ON            /*                       @Z67SP00*/
*           ×LISTSUP=ON             /*                       @Z67SP00*/
*           ×LISTRES=ON             /*                       @Z67SP00*/
*           ×LISTBYP=ON             /*                       @Z67SP00*/
*           ×LISTXREF=ON)           /*                       @Z67SP00*/
*         THEN                      /*                       @Z67SP00*/
@RF01406 TM    LISTPTS,B'00000010'                                 1408
         BNO   @RF01408                                            1408
         TM    LISTASM,B'01111110'                                 1408
         BNZ   @RT01408                                            1408
         TM    LISTFMD,B'01000000'                                 1408
         BO    @RT01408                                            1408
         TM    LISTDEL,B'11100000'                                 1408
         BNZ   @RT01408                                            1408
         TM    LISTRES,B'00010000'                                 1408
         BO    @RT01408                                            1408
         TM    LISTBYP,B'00010000'                                 1408
         BO    @RT01408                                            1408
         TM    LISTXREF,B'01000000'                                1408
         BNO   @RF01408                                            1408
@RT01408 DS    0H                                                  1409
*LISTBAD:                           /*                       @Z67SP00*/
*         SCPRET=SCPSTOP;           /*                       @ZD00009*/
LISTBAD  MVI   SCPRET,X'08'                                        1409
*     END;                          /* END OPTIONS OK GROUP  @SA99995*/
*   END LISTSAV;                    /* RETURN TO SCAN        @Z40SP00*/
@EL00028 DS    0H                                                  1411
@EF00028 DS    0H                                                  1411
@ER00028 BR    @14                                                 1411
*                                                                  1412
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO SAVE ENTRIES IN SET FOR LIST        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1412
*   RFY                                                            1412
*     R1 UNRSTD;                    /*                       @Z67SP00*/
*SESAV:                             /*                       @Z67SP00*/
*   PROCEDURE;                      /*                       @Z67SP00*/
SESAV    STM   @14,@12,@SA00029                                    1413
*   IF SESMD=ON                     /* PTF TYPE ENTRIES?     @Z67SP00*/
*       &SCPPMLN^=LENGTH(SEPTFNO)   /* NOT VALID LENGTH      @SA99995*/
*     THEN                          /* ERR                   @SA99995*/
         TM    SESMD,B'00000001'                                   1414
         BNO   @RF01414                                            1414
         CLC   SCPPMLN(2),@CH00244                                 1414
         BE    @RF01414                                            1414
*     SCPRET=SCPSTOP;               /* SYNTAX ERR            @SA99995*/
*                                                                  1415
         MVI   SCPRET,X'08'                                        1415
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL HMASMGTA TO ADD SET RECORD TO SET GTA FILE       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1416
*   ELSE                            /* IF NOT LIST OR LEN OK @Z40SP00*/
*     DO;                           /*                       @Z40SP00*/
         B     @RC01414                                            1416
@RF01414 DS    0H                                                  1417
*       SENAME=SCPSTRNG(1:SCPPMLN); /* MOVE IN MEMBER        @Z67SP00*/
         MVI   SENAME+1,C' '                                       1417
         MVC   SENAME+2(6),SENAME+1                                1417
         LH    @15,SCPPMLN                                         1417
         BCTR  @15,0                                               1417
         L     @08,SCPCHAR                                         1417
         EX    @15,@SM02647                                        1417
*       GTPPTR=CCASETAD;            /*                       @Z67SP00*/
         L     @15,@CA00042                                        1418
         L     @15,CCASETAD-HMASMCCA(,@15)                         1418
         ST    @15,GTPPTR                                          1418
*       RFY                                                        1419
*         HMASMGTP BASED(GTPPTR);   /*                       @Z67SP00*/
*       GTPFUNCT=GTPADD;            /*                       @Z67SP00*/
         MVI   GTPFUNCT(@15),X'04'                                 1420
*       GTPBUFAD=ADDR(HMASMSET);    /*                       @Z67SP00*/
         LA    @08,HMASMSET                                        1421
         ST    @08,GTPBUFAD(,@15)                                  1421
*       GTPRCDLN=LENGTH(HMASMSET);  /*                       @Z67SP00*/
         MVC   GTPRCDLN(2,@15),@CH00033                            1422
*       GTPKEYLN=LENGTH(SELSTENT);  /*                       @Z67SP00*/
         MVC   GTPKEYLN(2,@15),@CH00034                            1423
*       GTPPSIZE=GTP512B;           /* PAGE SIZE IS 512      @Z67SP00*/
         NI    GTPPSIZE(@15),B'11111001'                           1424
         OI    GTPPSIZE(@15),B'00000001'                           1424
*       CALL HMASMGTA(HMASMGTP);    /*                       @Z67SP00*/
         ST    @15,@AL00001                                        1425
         L     @15,@CV01806                                        1425
         LA    @01,@AL00001                                        1425
         BALR  @14,@15                                             1425
*       IF GTPRETRN^=GTPGOOD        /* NOT ENOUGH ROOM?              */
*         THEN                      /* NO - ISSUE MESSAGE            */
         L     @15,GTPPTR                                          1426
         CLI   GTPRETRN(@15),0                                     1426
         BE    @RF01426                                            1426
*         SCPRET=SCPSTOP;           /* INDICATE SCAN ERROR           */
         MVI   SCPRET,X'08'                                        1427
*     END;                                                         1428
*   END SESAV;                      /*                       @SA99995*/
@EL00029 DS    0H                                                  1429
@EF00029 DS    0H                                                  1429
@ER00029 LM    @14,@12,@SA00029                                    1429
         BR    @14                                                 1429
*   RFY                                                            1430
*     R1 RSTD;                      /*                       @Z67SP00*/
*                                                                  1431
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINES HANDLE WRITING TO THE HISTORY LOG      */
*   /* THROUGH THE LOG VERB.                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1431
*LOGSTART:                          /*                       @Z40SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
*                                                                  1431
LOGSTART DS    0H                                                  1432
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET FIELDS FOR LOG MESSAGE                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1432
*   LOGLNTH=ZERO;                   /* SET LENGTH TO ZERO            */
         SLR   @15,@15                                             1432
         STH   @15,LOGLNTH                                         1432
*   LPRNCNT=ONE;                    /* FIRST LPREN FND       @Z67SP00*/
         MVC   LPRNCNT(4),@CF00091                                 1433
*   RPRNCNT=ZERO;                   /*                       @Z67SP00*/
         ST    @15,RPRNCNT                                         1434
*   END LOGSTART;                                                  1435
*                                                                  1435
@EL00030 DS    0H                                                  1435
@EF00030 DS    0H                                                  1435
@ER00030 BR    @14                                                 1435
*   /*****************************************************************/
*   /*                                                               */
*   /* BUMP THE LOG MESSAGE LENGTH AND SAVE THIS PORTION             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1436
*LOGBUMP:                           /*                       @Z40SP00*/
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
LOGBUMP  DS    0H                                                  1437
*   DECLARE                         /*                       @DR00001*/
*     LOGMVLEN FIXED(8);            /*                       @DR00001*/
*   IF SCPPMLN=ZERO                 /* ZERO LENGTH ON PARM?          */
*     THEN                          /* YES - MAKE IT ONE             */
         ICM   @15,3,SCPPMLN                                       1438
         BNZ   @RF01438                                            1438
*     SCPPMLN=ONE;                  /* TO SKIP BY SPECIAL CHARACTER  */
*                                                                  1439
         MVC   SCPPMLN(2),@CH00091                                 1439
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR START AND END OF LOG BY CHECKING FOR MATCHING COUNT */
*   /* OF OPEN CLOSE PRENTHESIS                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1440
*   SCPNOSUC=ON;                    /* DO NOT GO TO SUCC DSCAN AT RTN
*                                      TO SCAN, GO TO ALT    @Z67SP00*/
@RF01438 OI    SCPNOSUC,B'00001000'                                1440
*   IF SCPSTRNG(1)=')'              /* IF CLOSING PAREN      @Z67SP00*/
*     THEN                          /*                       @Z67SP00*/
         L     @15,SCPCHAR                                         1441
         CLI   SCPSTRNG(@15),C')'                                  1441
         BNE   @RF01441                                            1441
*     RPRNCNT=RPRNCNT+1;            /* UPDATE ) COUNT        @Z67SP00*/
         LA    @15,1                                               1442
         AL    @15,RPRNCNT                                         1442
         ST    @15,RPRNCNT                                         1442
*   ELSE                            /*                       @Z67SP00*/
*     IF SCPSTRNG(1)='('            /* IF OPENING PAREN      @Z67SP00*/
*       THEN                        /*                       @Z67SP00*/
         B     @RC01441                                            1443
@RF01441 L     @15,SCPCHAR                                         1443
         CLI   SCPSTRNG(@15),C'('                                  1443
         BNE   @RF01443                                            1443
*       LPRNCNT=LPRNCNT+1;          /* INCR ( COUNT          @Z67SP00*/
         LA    @15,1                                               1444
         AL    @15,LPRNCNT                                         1444
         ST    @15,LPRNCNT                                         1444
*   IF LPRNCNT=RPRNCNT              /* IF ( MATCH )          @Z67SP00*/
*     THEN                          /* THEN SET TO           @Z67SP00*/
@RF01443 DS    0H                                                  1445
@RC01441 CLC   LPRNCNT(4),RPRNCNT                                  1445
         BNE   @RF01445                                            1445
*     SCPNOSUC=OFF;                 /* GO TO SUCC DSCAN      @Z67SP00*/
*                                                                  1446
         NI    SCPNOSUC,B'11110111'                                1446
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT END OF LOG STMT THEN MOVE DATA TO BUFFER       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1447
*   ELSE                            /* IF NOT MATCH          @Z67SP00*/
*     DO;                           /* THEN MOVE DATA        @Z67SP00*/
         B     @RC01445                                            1447
@RF01445 DS    0H                                                  1448
*       IF LOGLNTH+SCPPMLN>LENGTH(LOGMSG)/* EXCEEDED LOG RCD SIZE  1448
*                                                            @Z40SP00*/
*         THEN                      /* YES - TRUNCATE                */
         LA    @15,250                                             1448
         LH    @08,LOGLNTH                                         1448
         LH    @06,SCPPMLN                                         1448
         ALR   @06,@08                                             1448
         CR    @06,@15                                             1448
         BNH   @RF01448                                            1448
*         LOGMVLEN=LENGTH(LOGMSG)-LOGLNTH;/* SET MAX MOVE SZE      1449
*                                                            @DR00001*/
         SLR   @15,@08                                             1449
         STC   @15,LOGMVLEN                                        1449
*       ELSE                        /* NOT EXCEEDED          @DR00001*/
*         LOGMVLEN=SCPPMLN;         /* SET LEN OF STRING     @DR00001*/
         B     @RC01448                                            1450
@RF01448 MVC   LOGMVLEN(1),SCPPMLN+1                               1450
*       IF LOGMVLEN>ZERO            /* DATA TO MOVE?         @DR00001*/
*         THEN                      /* YES                   @DR00001*/
@RC01448 CLI   LOGMVLEN,0                                          1451
         BNH   @RF01451                                            1451
*         DO;                       /*                       @DR00001*/
*           LOGMSG(LOGLNTH+ONE:LOGLNTH+SCPPMLN)=SCPSTRNG(1:SCPPMLN);
         LH    @15,LOGLNTH                                         1453
         LA    @08,LOGMSG(@15)                                     1453
         LH    @06,SCPPMLN                                         1453
         LR    @05,@06                                             1453
         BCTR  @05,0                                               1453
         L     @04,SCPCHAR                                         1453
         EX    @05,@SM02652                                        1453
*           LOGLNTH=LOGLNTH+SCPPMLN;/* BUMP MESSAGE LENGTH           */
         ALR   @15,@06                                             1454
         STH   @15,LOGLNTH                                         1454
*         END;                      /*                       @DR00001*/
*     END;                          /* END NOT ( MATCH )     @Z67SP00*/
*   END LOGBUMP;                    /* RETURN TO SCAN                */
@EL00031 DS    0H                                                  1457
@EF00031 DS    0H                                                  1457
@ER00031 BR    @14                                                 1457
*                                                                  1458
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS ENTERED WHEN DRV HAS FOUND A SYNTAX ERROR IN A*/
*   /* CARD AND IS CONTINUING SCAN OF CARD LOOKING FOR THE COLSING   */
*   /* PERIOD. IF A SPECIAL CHAR IS FOUND ON THE CARD THEN SCAN WILL */
*   /* RETURN A LENGTH OF 0. THE ROUT THEN BUMPS THE LENGTH TO 1 IN  */
*   /* ORDER TO SCAN PAST THE SPECIAL CHARACTER              @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1458
*XTRAINFO:                                                         1458
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Z40SP00*/
XTRAINFO DS    0H                                                  1459
*   IF SCPPMLN=ZERO                 /* IF SCAN STOPPED DUE   @Z40SP00*/
*     THEN                          /* TO NON ALPA-NUMERIC CHAR THEN
*                                      RESET LEN TO 1 TO BUMP PAST IT
*                                      ON THE WAY TO THE .   @Z40SP00*/
         ICM   @15,3,SCPPMLN                                       1459
         BNZ   @RF01459                                            1459
*     SCPPMLN=1;                    /*                       @Z40SP00*/
         MVC   SCPPMLN(2),@CH00091                                 1460
*   END XTRAINFO;                   /* RETURN TO SCAN                */
@EL00032 DS    0H                                                  1461
@EF00032 DS    0H                                                  1461
@ER00032 BR    @14                                                 1461
*                                                                  1462
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPRESS INDICATED, LIST AREA GOTTEN IF NEEDED        @Z30XX9J*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1462
*   RFY                                                            1462
*     R1 UNRSTD;                    /*                       @Z40SP00*/
*   RFY                                                            1463
*     SIZE RSTD;                    /* REMOVE REG FROM USE   @Z40SP00*/
*CMPRSET:                           /*                       @Z30XX9J*/
*   PROC;                           /*                       @Z30XX9J*/
CMPRSET  STM   @14,@12,@SA00033                                    1464
*   IF CCACMPRS=OFF&CCAREC=OFF      /* NOT RECEIVE           @Z30XX9J*/
*     THEN                          /* AND NOT ALREADY SPEC. @Z30XX9J*/
         L     @15,@CA00042                                        1465
         TM    CCACMPRS-HMASMCCA(@15),B'00000100'                  1465
         BNZ   @RF01465                                            1465
         TM    CCAREC-HMASMCCA(@15),B'10000000'                    1465
         BNZ   @RF01465                                            1465
*     DO;                           /*                       @Z30XX9J*/
*       CCACMPRS=ON;                /* SET CMPRS INDICATOR   @Z30XX9J*/
         OI    CCACMPRS-HMASMCCA(@15),B'00000100'                  1467
*       SIZE=CMPRSINC*LENGTH(CMPRSLST);/* SIZE OF LIST       @Z30XX9J*/
         LA    SIZE,180                                            1468
*       GEN(GETMAIN EC,LV=(SIZE),A=CCACLST)/* GET LIST       @Z30XX9J*/
*       REFS(SIZE,CCACLST);         /*                       @Z30XX9J*/
         GETMAIN EC,LV=(SIZE),A=CCACLST
*       RFY                                                        1470
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       IF RTNCODE^=ZERO            /* IF GETMAIN FAILED     @Z40SP00*/
*         THEN                      /* WRITE MSG AND QUIT    @Z30XX9J*/
         LTR   RTNCODE,RTNCODE                                     1471
         BZ    @RF01471                                            1471
*         DO;                       /*                       @Z30XX9J*/
*           RFY                                                    1473
*             RTNCODE UNRSTD;       /*                       @Z40SP00*/
*           SCPRET=STOPFUNC;        /* SET RC TO KILL A FUNCTION   1474
*                                                            @YA07506*/
         MVI   SCPRET,X'0C'                                        1474
*           M202SW=ON;              /* GM ERROR MSG          @Z67SP00*/
         OI    M202SW,B'00000010'                                  1475
*         END;                      /* ERROR PROCESS         @Z30XX9J*/
*     END;                          /* END GOOD SCAN         @Z30XX9J*/
*   ELSE                            /*                       @Z30XX9J*/
*     SCPRET=SCPSTOP;               /* ERROR IN SCAN         @Z40SP00*/
         B     @RC01465                                            1478
@RF01465 MVI   SCPRET,X'08'                                        1478
*   END CMPRSET;                    /*                       @Z30XX9J*/
@EL00033 DS    0H                                                  1479
@EF00033 DS    0H                                                  1479
@ER00033 LM    @14,@12,@SA00033                                    1479
         BR    @14                                                 1479
*   RFY                                                            1480
*     SIZE UNRSTD;                  /* RETURN REG TO USE     @Z40SP00*/
*   RFY                                                            1481
*     R1 RSTD;                      /*                       @Z40SP00*/
*                                                                  1482
*   /*****************************************************************/
*   /*                                                               */
*   /* DDNAMES FOR COMPRESS ARE SAVED IN A LIST              @Z30XX9J*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1482
*   RFY                                                            1482
*     R1 UNRSTD;                    /* FREE R1 ACROSS CALL   @Z40SP00*/
*   RFY                                                            1483
*     SIZE RSTD;                    /* REMOVE REG FROM USE   @Z40SP00*/
*DDNSAV:                            /*                       @Z30XX9J*/
*   PROC;                           /*                       @Z30XX9J*/
DDNSAV   STM   @14,@12,@SA00034                                    1484
*   CMPRSCTR=CMPRSCTR+1;            /* BUMP DD NAME COUNT    @Z30XX9J*/
         LA    @15,1                                               1485
         AL    @15,CMPRSCTR                                        1485
         ST    @15,CMPRSCTR                                        1485
*   IF CMPRSCTR>CMPRSMAX            /* LIST EXCEEDED         @Z30XX9J*/
*     THEN                          /* YES                   @Z30XX9J*/
         L     @08,CMPRSMAX                                        1486
         CR    @15,@08                                             1486
         BNH   @RF01486                                            1486
*     DO;                           /* SET UP TO GET ANOTHER @Z30XX9J*/
*       CMPRSMAX=CMPRSMAX+CMPRSINC; /* NEW NUMBER FOR LIST   @Z30XX9J*/
         AL    @08,@CF00358                                        1488
         ST    @08,CMPRSMAX                                        1488
*       SIZE=CMPRSMAX*LENGTH(CMPRSLST);/* SIZE TO GET        @Z30XX9J*/
         MH    @08,@CH00035                                        1489
         LR    SIZE,@08                                            1489
*       GEN(GETMAIN EC,LV=(SIZE),A=NCMPRLST)/* GET IT        @Z30XX9J*/
*       REFS(SIZE,NCMPRLST);        /*                       @Z30XX9J*/
         GETMAIN EC,LV=(SIZE),A=NCMPRLST
*       RFY                                                        1491
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       IF RTNCODE^=ZERO            /* BAD GETMAIN           @Z40SP00*/
*         THEN                      /* WRITE MSG AND QUIT    @Z30XX9J*/
         LTR   RTNCODE,RTNCODE                                     1492
         BZ    @RF01492                                            1492
*         DO;                       /*                       @Z30XX9J*/
*           SCPRET=STOPFUNC;        /* BAD SCAN RTN CDE      @YA07506*/
         MVI   SCPRET,X'0C'                                        1494
*           M202SW=ON;              /* INDICATE SCAN ERR     @Z67SP00*/
         OI    M202SW,B'00000010'                                  1495
*         END;                      /*                       @Z30XX9J*/
*       ELSE                        /* GETMAIN OK            @Z40SP00*/
*         DO;                       /*                       @Z40SP00*/
         B     @RC01492                                            1497
@RF01492 DS    0H                                                  1498
*           DO I=1 TO(CMPRSCTR-1);  /* LOOP THRU LIST        @Z30XX9J*/
         LA    @08,1                                               1498
         B     @DE01498                                            1498
@DL01498 DS    0H                                                  1499
*             NCMPRLST->CMPRSLST(I)=CMPRSLST(I);/* COPYING   @Z30XX9J*/
         LR    @06,@08                                             1499
         MH    @06,@CH00035                                        1499
         L     @03,NCMPRLST                                        1499
         ALR   @03,@06                                             1499
         AL    @03,@CF02654                                        1499
         L     @05,@CA00042                                        1499
         L     @01,CCACLST-HMASMCCA(,@05)                          1499
         ALR   @01,@06                                             1499
         AL    @01,@CF02654                                        1499
         MVC   CMPRSLST(9,@03),CMPRSLST(@01)                       1499
*           END;                    /*                       @Z30XX9J*/
         AL    @08,@CF00091                                        1500
@DE01498 ST    @08,I                                               1500
         L     @06,CMPRSCTR                                        1500
         BCTR  @06,0                                               1500
         CR    @08,@06                                             1500
         BNH   @DL01498                                            1500
*           SIZE=(CMPRSMAX-CMPRSINC)*LENGTH(CMPRSLST);/*     @Z30XX9J*/
         L     SIZE,CMPRSMAX                                       1501
         SL    SIZE,@CF00358                                       1501
         MH    SIZE,@CH00035                                       1501
*           GEN(FREEMAIN E,LV=(SIZE),A=CCACLST);/* FREE IT   @Z30XX9J*/
         FREEMAIN E,LV=(SIZE),A=CCACLST
*           CCACLST=NCMPRLST;       /* UPDATE PTR            @Z30XX9J*/
         L     @08,@CA00042                                        1503
         MVC   CCACLST-HMASMCCA(4,@08),NCMPRLST                    1503
*         END;                      /* END GETMAIN OK        @Z40SP00*/
*     END;                          /* EXCEED SIZE DO        @Z30XX9J*/
@RC01492 DS    0H                                                  1506
*   IF SCPRET=SCPGOOD               /* IF ALL OK             @Z40SP00*/
*     THEN                          /*                       @Z40SP00*/
@RF01486 CLI   SCPRET,0                                            1506
         BNE   @RF01506                                            1506
*     DO;                           /*                       @Z40SP00*/
*       CMPRSELM(CMPRSCTR-1)=SCPSTRNG(1:SCPPMLN);/* ADD      @Z30XX9J*/
         L     @08,CMPRSCTR                                        1508
         MH    @08,@CH00035                                        1508
         L     @06,@CA00042                                        1508
         L     @06,CCACLST-HMASMCCA(,@06)                          1508
         ST    @08,@TF00001                                        1508
         ALR   @08,@06                                             1508
         AL    @08,@CF02655                                        1508
         MVI   CMPRSELM+1(@08),C' '                                1508
         MVC   CMPRSELM+2(6,@08),CMPRSELM+1(@08)                   1508
         LH    @03,SCPPMLN                                         1508
         BCTR  @03,0                                               1508
         L     @01,SCPCHAR                                         1508
         EX    @03,@SM02656                                        1508
*       CMPRSFLG(CMPRSCTR-1)=ZERO;  /* CLEAR FLAG            @Z30XX9J*/
         SLR   @08,@08                                             1509
         L     @03,@TF00001                                        1509
         AL    @03,@CF02658                                        1509
         STC   @08,CMPRSFLG-8(@03,@06)                             1509
*       CMPRSELM(CMPRSCTR,1:LENGTH(ICTENDCH))=ICTENDCH;/*    @Z67SP00*/
         AL    @06,@TF00001                                        1510
         AL    @06,@CF02654                                        1510
         MVC   CMPRSELM(4,@06),ICTENDCH                            1510
*     END;                          /*                       @Z40SP00*/
*   END DDNSAV;                     /*                       @Z30XX9J*/
@EL00034 DS    0H                                                  1512
@EF00034 DS    0H                                                  1512
@ER00034 LM    @14,@12,@SA00034                                    1512
         BR    @14                                                 1512
*   RFY                                                            1513
*     R1 RSTD;                      /*                       @Z40SP00*/
*   RFY                                                            1514
*     SIZE UNRSTD;                  /* RETURN REG TO USE     @Z40SP00*/
*                                                                  1515
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF ALL HMASMSCN DSCAN ROUTS. REGISTER ONE MAY NOW BE      */
*   /* UNRSTRICTED                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1515
*   RFY                                                            1515
*     R1 UNRSTD;                    /*                       @Z40SP00*/
*   RFY                                                            1516
*     RTNREG UNRSTD;                /* FREE RETURN REG       @Z40SP00*/
*   END HMASMDRV                                                   1517
*                                                                  1517
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*                                                                  1517
*       ;                                                          1517
@DATA    DS    0H
@CH00044 DC    H'4'
@CH00204 DC    H'6'
@CH00244 DC    H'7'
@CH00116 DC    H'8'
@CH00035 DC    H'9'
@CH00034 DC    H'10'
@CH00443 DC    H'13'
@CH00456 DC    H'21'
@CH00466 DC    H'26'
@CH00474 DC    H'30'
@CH01774 DC    H'53'
@CH00836 DC    H'72'
@CH00531 DC    H'88'
@CH01777 DC    H'109'
@CH01779 DC    H'110'
@CH01781 DC    H'142'
@CH01783 DC    H'226'
@CH02556 DC    H'371'
@SM02635 MVC   PRLDATA(0,@08),LOGMSG
@SM02643 MVC   0(0,@06),SCPSTRNG(@08)
@SM02645 MVC   0(0,@06),SCPSTRNG(@04)
@SM02647 MVC   SENAME(0),SCPSTRNG(@08)
@SM02650 MVC   SENAME(0),SCPSTRNG(@06)
@SM02652 MVC   0(0,@08),SCPSTRNG(@04)
@SM02656 MVC   CMPRSELM(0,@08),SCPSTRNG(@01)
         DS    0F
@AL00325 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00369 DC    A(HMASMSCP)             LIST WITH   1 ARGUMENT(S)
@AL00333 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00342 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00364 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00376 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00405 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00416 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00424 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00446 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00457 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00735 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00757 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00811 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01354 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01370 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
@AL00437 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00590 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00741 DC    A(TBLPARM)              LIST WITH   2 ARGUMENT(S)
@AL00465 DC    A(LISTPARM)             LIST WITH   1 ARGUMENT(S)
         DC    A(SAVECODE)
@AL00484 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00531 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00546 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00557 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00579 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00600 DC    A(TBLPARM)              LIST WITH   1 ARGUMENT(S)
@AL00315 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00874 DC    A(HMASMCRP)             LIST WITH   1 ARGUMENT(S)
@AL00519 DC    A(UPDPARM)              LIST WITH   1 ARGUMENT(S)
@AL00662 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00745 DC    A(@CF00040)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00040)
@AL00771 DC    A(HMASMSPL)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00033 DS    15F
@SA00034 DS    15F
@SA00029 DS    0F
@SA00025 DS    0F
@SA00012 DS    0F
@SA00002 DS    0F
         DS    15F
@AL00001 DS    1A
@TF00001 DS    F
         DS    0F
@CF00040 DC    F'0'
@CH00040 EQU   @CF00040+2
@CF00091 DC    F'1'
@CH00091 EQU   @CF00091+2
@CF00187 DC    F'2'
@CH00187 EQU   @CF00187+2
@CF00239 DC    F'3'
@CH00239 EQU   @CF00239+2
@CF00033 DC    F'12'
@CH00033 EQU   @CF00033+2
@CF00192 DC    F'16'
@CH00192 EQU   @CF00192+2
@CF00358 DC    F'20'
@CF02655 DC    F'-18'
@CF02658 DC    F'-10'
@CF02654 DC    F'-9'
@CF02640 DC    F'-4'
@CA00042 DC    A(HMASMCCA)
@CV01800 DC    V(HMASMAAR)
@CV01801 DC    V(HMASMARL)
@CV01802 DC    V(HMASMCRD)
@CV01803 DC    V(HMASMDR1)
@CV01804 DC    V(HMASMDR2)
@CV01805 DC    V(HMASMDSU)
@CV01806 DC    V(HMASMGTA)
@CV01807 DC    V(HMASMIO)
@CV01808 DC    V(HMASMLID)
@CV01809 DC    V(HMASMMSG)
@CV01810 DC    V(HMASMREC)
@CV01811 DC    V(HMASMREJ)
@CV01812 DC    V(HMASMSTA)
@CV01813 DC    V(HMASMSUB)
@CV01814 DC    V(HMASMTBL)
@CV01815 DC    V(HMASMUCD)
@CV01816 DC    V(HMASMUPD)
@CV01817 DC    V(HMASMSCN)
@CV01818 DC    V(HMASMUXC)
         DS    0D
CMPRSCTR DC    F'1'
CMPRSMAX DC    F'20'
NCMPRLST DC    A(0)
GTPPTR   DS    A
SAVECODE DS    A
SAVR1    DS    F
SAVRTN   DS    F
I        DS    F
FMADDR   DC    A(0)
ADSYNSCN DC    AL4(SYNTERR)
ADCTLSCN DC    AL4(RECK)
LPRNCNT  DC    F'0'
RPRNCNT  DC    F'0'
SAVCHAR  DS    A
RCPTR    DS    A
SAVSCPCH DS    A
ERRCOL   DS    H
LISTCNT  DS    H
LOGLNTH  DS    H
UPDINDX  DC    H'0'
DRVRTNCD DS    FL1
RCENT    DS    FL1
LOGMVLEN DS    FL1
         DS    0D
@TS00001 DS    CL8
@CC01767 DC    C'LINKLIB '
@CC01787 DC    C'SUP     '
@CC01789 DC    C'NOSUP   '
@CC01791 DC    C'SMPCDS  '
@CC01793 DC    C'SMPACDS '
@CC01795 DC    C'CLOSE   '
@CC01797 DC    C'JCLIN   '
@CC01822 DC    C'ACCEPT  '
@CC01824 DC    C'APPLY   '
@CC01828 DC    C'LIST    '
@CC01830 DC    C'LOG     '
@CC01833 DC    C'RECEIVE '
@CC01835 DC    C'REJECT  '
@CC01837 DC    C'RESTORE '
@CC01839 DC    C'HMASMP  '
@CC01841 DC    C'UCLIN   '
@CC01843 DC    C'RESETRC '
@CC01845 DC    C'SYSMOD  '
@CC01847 DC    C'UNKNOWN '
@CC02524 DC    C'SYSTEM  '
@CC01765 DC    C'00'
         DS    CL2
ICTENDCH DC    X'FFFFFFFF'
HMASMSET DS    CL12
         ORG   HMASMSET
SELSTENT DS    CL10
         ORG   SELSTENT
SELSTFLG DS    BL2
         ORG   SELSTFLG
@NM00171 DS    BL1
SEMCS    EQU   SELSTFLG+0
SESMD    EQU   SELSTFLG+0
SESRC    DS    BL1
SEDLB    EQU   SELSTFLG+1
SEMOD    EQU   SELSTFLG+1
SEMAC    EQU   SELSTFLG+1
SELMD    EQU   SELSTFLG+1
SEASM    EQU   SELSTFLG+1
SEFMD    EQU   SELSTFLG+1
SESYS    EQU   SELSTFLG+1
         ORG   SELSTENT+2
SENAME   DS    CL8
         ORG   SENAME
SESMDNO  DS    CL7
         ORG   SESMDNO
SEPTFNO  DS    CL7
         ORG   SENAME+7
@NM00172 DS    CL1
         ORG   HMASMSET+10
SEFLAGS  DS    BL1
         ORG   SEFLAGS
SEGROUP  DS    BL1
SESELECT EQU   SEFLAGS+0
SEEXCLUD EQU   SEFLAGS+0
SENOJCL  EQU   SEFLAGS+0
SEFMID   EQU   SEFLAGS+0
@NM00173 EQU   SEFLAGS+0
SEFOUND  EQU   SEFLAGS+0
         ORG   HMASMSET+11
SEFLAG2  DS    BL1
         ORG   SEFLAG2
SEFLAG2A DS    BL1
SEFLAG2B EQU   SEFLAG2+0
SEFLAG2C EQU   SEFLAG2+0
SEFLAG2D EQU   SEFLAG2+0
SEFLAG2E EQU   SEFLAG2+0
SEFLAG2F EQU   SEFLAG2+0
SEFLAG2G EQU   SEFLAG2+0
SEFLAG2H EQU   SEFLAG2+0
         ORG   HMASMSET+12
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00174 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00175 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
HMASMSCP DS    CL26
         ORG   HMASMSCP
SCPCHAR  DS    AL4
SCPSRCH  DS    AL4
SCPWKAR  DS    AL4
SCPIORTN DS    AL4
SCPIOPAD DS    AL4
SCPINLN  DS    FL2
SCPPMLN  DS    FL2
SCPEOR   DS    BL1
         ORG   SCPEOR
SCPCONT  DS    BL1
SCPNOCT  EQU   SCPEOR+0
SCPCOMNT EQU   SCPEOR+0
SCPRTERR EQU   SCPEOR+0
SCPNOSUC EQU   SCPEOR+0
SCPNORT  EQU   SCPEOR+0
@NM00178 EQU   SCPEOR+0
         ORG   HMASMSCP+25
SCPRETRN DS    FL1
         ORG   SCPRETRN
SCPRET   DS    FL1
         ORG   HMASMSCP+26
         DS    CL2
HMASMCRP DS    CL106
         ORG   HMASMCRP
CRPUXNUM DS    FL1
@NM00182 DS    CL3
CRPSCPAD DS    AL4
CRPINDS  DS    FL1
CRPOUTDS DS    FL1
CRPRETRN DS    FL1
@NM00183 DS    CL3
CRPFLG1  DS    BL2
         ORG   CRPFLG1
CRPBFPRM DS    BL1
CRPLOGCK EQU   CRPFLG1+0
CRPPTS   EQU   CRPFLG1+0
CRPLOG   EQU   CRPFLG1+0
CRPPRINT EQU   CRPFLG1+0
CRPOTHER EQU   CRPFLG1+0
CRPOFFST EQU   CRPFLG1+0
CRPSCNCL EQU   CRPFLG1+0
CRPEOFEN DS    BL1
CRPTRMEX EQU   CRPFLG1+1
CRPNOWPP EQU   CRPFLG1+1
CRPLIST  EQU   CRPFLG1+1
CRPRPT   EQU   CRPFLG1+1
@NM00184 EQU   CRPFLG1+1
         ORG   HMASMCRP+16
CRPFLG2  DS    BL2
         ORG   CRPFLG2
CRPINSW0 DS    BL1
         ORG   CRPINSW0
CRPEOFSW DS    BL1
         ORG   CRPFLG2+0
CRPINSW1 EQU   CRPFLG2+0
         ORG   CRPINSW1
CRPEXADD EQU   CRPINSW1+0
         ORG   CRPFLG2+0
CRPINSW2 EQU   CRPFLG2+0
         ORG   CRPINSW2
CRPWRTLG EQU   CRPINSW2+0
         ORG   CRPFLG2+0
CRPINSW3 EQU   CRPFLG2+0
         ORG   CRPINSW3
CRPEOF1  EQU   CRPINSW3+0
         ORG   CRPFLG2+0
CRPINSW4 EQU   CRPFLG2+0
CRPINSW5 EQU   CRPFLG2+0
CRPINSW6 EQU   CRPFLG2+0
CRPINSW7 EQU   CRPFLG2+0
         DS    CL1
CRPINSW8 DS    BL1
CRPINSW9 EQU   CRPFLG2+1
CRPINSWA EQU   CRPFLG2+1
CRPINSWB EQU   CRPFLG2+1
CRPINSWC EQU   CRPFLG2+1
CRPINSWD EQU   CRPFLG2+1
CRPINSWE EQU   CRPFLG2+1
CRPINSWF EQU   CRPFLG2+1
         ORG   HMASMCRP+18
CRPBUFFR DS    CL80
         ORG   CRPBUFFR
CRPBFCTL DS    CL72
         ORG   CRPBFCTL
CRPBFDTA DS    CL71
CRPBFCNT DS    CL1
         ORG   CRPBUFFR+72
CRPBFSEQ DS    CL8
         ORG   HMASMCRP+98
CRPDDNAM DS    CL8
         ORG   HMASMCRP+106
         DS    CL2
HMASMSPL DS    CL5
         ORG   HMASMSPL
SPLPMAD  DS    AL4
SPLFUNCT DS    FL1
         ORG   HMASMSPL+5
RCVL     DS    CL2
CNVRCCD  DC    CL2'00'
SMPRCS   DS    CL11
         ORG   SMPRCS
RCACC    DS    FL1
RCAPP    DS    FL1
RCCNV    DS    FL1
RCJCL    DS    FL1
RCLIST   DS    FL1
RCLOG    DS    FL1
RCREC    DS    FL1
RCREJ    DS    FL1
RCRST    DS    FL1
RCSMP    DS    FL1
RCUCL    DS    FL1
         ORG   SMPRCS+11
DBLWRD   DS    CL8
CHARCOL  DS    CL2
         ORG   CHARCOL
@NM00211 DS    CL1
LASTDIG  DS    CL1
         ORG   CHARCOL+2
         DS    CL2
DRVIOP   DS    CL130
         DS    CL2
CDSSYS   DS    CL92
ACDSSYS  DS    CL92
BUFFRIOP DS    CL264
LOGMSG   DS    CL250
         DS    CL2
NOJCLGTP DS    CL28
OLDNUCID DC    CL1' '
         DS    CL1
PATCHDRV DS    CL80
         ORG   PATCHDRV
@NM00212 DC    80X'FF'
         ORG   PATCHDRV+80
DRVFLGS1 DC    AL2(0)
         ORG   DRVFLGS1
RTNERR   DS    BL1
INCPLSW  EQU   DRVFLGS1+0
LVLERRSW EQU   DRVFLGS1+0
@NM00213 EQU   DRVFLGS1+0
         ORG   DRVFLGS1+2
DRVFLGS2 DS    BL2
         ORG   DRVFLGS2
RCERR    DS    BL1
PRCERR   EQU   DRVFLGS2+0
RCENTRD  EQU   DRVFLGS2+0
FLUSHSW  EQU   DRVFLGS2+0
ERRAFTPR EQU   DRVFLGS2+0
DIDCALL  EQU   DRVFLGS2+0
M202SW   EQU   DRVFLGS2+0
@NM00214 EQU   DRVFLGS2+0
         ORG   DRVFLGS2+2
CNVPARM  DC    AL1(0)
         ORG   CNVPARM
CNVCDS   DS    BL1
CNVACDS  EQU   CNVPARM+0
@NM00215 EQU   CNVPARM+0
         ORG   CNVPARM+1
         DS    CL1
TBLPARM  DS    CL16
         ORG   TBLPARM
TBLJCLGT DS    AL4
TBLNUCID DS    CL1
@NM00216 DS    CL3
TBLFLAGS DS    CL8
         ORG   TBLFLAGS
TBLFLG1  DS    BL2
         ORG   TBLFLG1
TBLNOAPP DS    BL1
TBLCHECK EQU   TBLFLG1+0
TBLASSEM EQU   TBLFLG1+0
TBLCOMP  EQU   TBLFLG1+0
TBLAPAR  EQU   TBLFLG1+0
TBLUSER  EQU   TBLFLG1+0
TBLFLUSH EQU   TBLFLG1+0
TBLNOJCL EQU   TBLFLG1+0
TBLDISN  DS    BL1
TBLDISR  EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
@NM00217 EQU   TBLFLG1+1
         ORG   TBLFLAGS+2
TBLFLG2  DS    BL1
         ORG   TBLFLG2
TBLSEL   DS    BL1
TBLEXC   EQU   TBLFLG2+0
TBLGROUP EQU   TBLFLG2+0
TBLFMID  EQU   TBLFLG2+0
@NM00218 EQU   TBLFLG2+0
TBLMASS  EQU   TBLFLG2+0
         ORG   TBLFLAGS+3
TBLFLG3  DS    BL2
         ORG   TBLFLG3
TBLCDS   DS    BL1
TBLACDS  EQU   TBLFLG3+0
TBLSCDS  EQU   TBLFLG3+0
TBLCRQ   EQU   TBLFLG3+0
TBLACRQ  EQU   TBLFLG3+0
TBLPTS   EQU   TBLFLG3+0
TBLMTS   EQU   TBLFLG3+0
TBLSTS   EQU   TBLFLG3+0
@NM00219 DS    BL1
         ORG   TBLFLAGS+5
TBLFLG4  DS    BL2
         ORG   TBLFLG4
TBLBPID  DS    BL1
TBLBPPRE EQU   TBLFLG4+0
TBLBPREQ EQU   TBLFLG4+0
TBLBPIRQ EQU   TBLFLG4+0
@NM00220 EQU   TBLFLG4+0
TBLBPFM  EQU   TBLFLG4+0
@NM00221 EQU   TBLFLG4+0
         ORG   TBLFLAGS+7
TBLFLG5  DS    BL1
         ORG   TBLFLG5
TBLICTOK DS    BL1
@NM00222 EQU   TBLFLG5+0
         ORG   TBLPARM+16
LISTPARM DS    CL19
         ORG   LISTPARM
LISTPRM1 DS    BL2
         ORG   LISTPRM1
LISTALL1 DS    BL1
LISTCDS  EQU   LISTPRM1+0
LISTACDS EQU   LISTPRM1+0
LISTSCDS EQU   LISTPRM1+0
LISTCRQ  EQU   LISTPRM1+0
LISTACRQ EQU   LISTPRM1+0
LISTPTS  EQU   LISTPRM1+0
@NM00223 EQU   LISTPRM1+0
LISTLOG  EQU   LISTPRM1+1
@NM00224 EQU   LISTPRM1+1
         ORG   LISTPARM+2
LISTPRM2 DS    BL2
         ORG   LISTPRM2
LISTALL2 DS    BL1
LISTASM  EQU   LISTPRM2+0
LISTLMD  EQU   LISTPRM2+0
LISTMAC  EQU   LISTPRM2+0
LISTMOD  EQU   LISTPRM2+0
LISTSRC  EQU   LISTPRM2+0
LISTDLB  EQU   LISTPRM2+0
LISTSYS  EQU   LISTPRM2+0
LISTSMD  DS    BL1
LISTFMD  EQU   LISTPRM2+1
LISTMCS  EQU   LISTPRM2+1
@NM00225 EQU   LISTPRM2+1
         ORG   LISTPARM+4
LISTPRM3 DS    BL2
         ORG   LISTPRM3
LISTALL3 DS    BL1
LISTNOAP EQU   LISTPRM3+0
LISTNOAC EQU   LISTPRM3+0
LISTRES  EQU   LISTPRM3+0
LISTFUNC EQU   LISTPRM3+0
LISTPTF  EQU   LISTPRM3+0
LISTAPAR EQU   LISTPRM3+0
LISTUSER EQU   LISTPRM3+0
LISTSUP  DS    BL1
LISTNSUP EQU   LISTPRM3+1
LISTDEL  EQU   LISTPRM3+1
LISTBYP  EQU   LISTPRM3+1
LISTERR  EQU   LISTPRM3+1
@NM00226 EQU   LISTPRM3+1
         ORG   LISTPARM+6
LISTPRM4 DS    BL1
         ORG   LISTPRM4
LISTSEL  DS    BL1
LISTXREF EQU   LISTPRM4+0
@NM00227 EQU   LISTPRM4+0
         ORG   LISTPARM+7
LISTDATE DS    CL12
         ORG   LISTDATE
LISTBDAT DS    CL6
         ORG   LISTBDAT
LISTBMM  DS    CL2
LISTBDD  DS    CL2
LISTBYY  DS    CL2
         ORG   LISTDATE+6
LISTEDAT DS    CL6
         ORG   LISTEDAT
LISTEMM  DS    CL2
LISTEDD  DS    CL2
LISTEYY  DS    CL2
         ORG   LISTPARM+19
         DS    CL1
UPDPARM  DS    CL121
         ORG   UPDPARM
UPDPGMS  DS    CL13
         ORG   UPDPGMS+0
UPDPGMLN DS    FL1
UPDPGMNM DS    CL12
         ORG   UPDPARM+52
UPDSYSMD DS    CL7
UPDSTYPE DS    FL1
UPDDSID  DS    FL1
@NM00228 DS    CL3
UPDDDNAM DS    CL8
UPDDSNAM DS    CL44
UPDGTPAD DS    AL4
UPDFLAGS DS    CL1
         ORG   UPDFLAGS
UPDFLG1  DS    BL1
         ORG   UPDFLG1
UPDCHECK DS    BL1
         ORG   UPDFLAGS+0
UPDFLG2  EQU   UPDFLAGS+0
         ORG   UPDFLG2
UPDTRACE EQU   UPDFLG2+0
         ORG   UPDFLAGS+0
UPDFLG3  EQU   UPDFLAGS+0
         ORG   UPDFLG3
UPDREDO  EQU   UPDFLG3+0
         ORG   UPDFLAGS+0
UPDFLG4  EQU   UPDFLAGS+0
UPDFLG5  EQU   UPDFLAGS+0
UPDFLG6  EQU   UPDFLAGS+0
UPDFLG7  EQU   UPDFLAGS+0
UPDFLG8  EQU   UPDFLAGS+0
         ORG   UPDPARM+121
RCXXXSW  DS    BL2
         ORG   RCXXXSW
RCAPLSW  DS    BL1
RCACPSW  EQU   RCXXXSW+0
RCJCLSW  EQU   RCXXXSW+0
RCLOGSW  EQU   RCXXXSW+0
RCLSTSW  EQU   RCXXXSW+0
RCRECSW  EQU   RCXXXSW+0
RCREJSW  EQU   RCXXXSW+0
RCRSTSW  EQU   RCXXXSW+0
RCUCLSW  DS    BL1
@NM00229 EQU   RCXXXSW+1
         ORG   RCXXXSW+2
HMASMDRV CSECT
**********
*****
*****    DSCANS FOR MAIN SMP FUNCTIONS
*****
**********
RECK     DSCAN KEY='RECEIVE',ALT=APPK,SUCC=SELK,ROUT=RECSAV
APPK     DSCAN KEY='APPLY',ALT=ACCK,SUCC=SELK,ROUT=APPSAV
ACCK     DSCAN KEY='ACCEPT',ALT=REJK,SUCC=SELK,ROUT=ACCSAV
REJK     DSCAN KEY='REJECT',ALT=RESK,SUCC=SELK,ROUT=REJSAV
RESK     DSCAN KEY='RESTORE',ALT=UCLINK,SUCC=SELK,ROUT=RESSAV
UCLINK   DSCAN KEY='UCLIN',ALT=JCLINK,SUCC=DSCDS,ROUT=UCLSAV
JCLINK   DSCAN KEY='JCLIN',ALT=LOGK,SUCC=JCASM,ROUT=JCLSAV   @Z67SP00
LOGK     DSCAN KEY='LOG',SUCC=LPAREN2,ALT=RESETK,ROUT=LOGSV  @Z67SP00
RESETK   DSCAN KEY='RESETRC',ALT=LISTK,SUCC=PERIOD,                    X
               ROUT=RESETSAV                                 @Z67SP00
LISTK    DSCAN KEY='LIST',SUCC=LOGPK,ROUT=LSTSAV             @Z67SP00
HMASMDRV CSECT
**********
*****
*****    DSCANS FOR RECEIVE,REJECT,APPLY,RESTORE AND ACCEPT OPTIONS
*****
**********
**********
*****
*****    DSCANS FOR SELECT OR EXCLUDE OPTION
*****    NOTE THAT DSCAN FOR S, G AND E ARE LAST OF DSCANS SO THAT
*****       THEY WILL CAUSE NO PROBLEM IF OTHER KEYWORDS STARTING
*****       WITH S, G, OR E ARE ADDED
*****
**********
SELK     DSCAN KEY='SELECT',ALT=EXCLK,SUCC=LPAREN3,ROUT=SELSAV
EXCLK    DSCAN KEY='EXCLUDE',ALT=GRPK,SUCC=LPAREN3,ROUT=EXCSAV
GRPK     DSCAN KEY='GROUP',ALT=CMPRSK,SUCC=LPAREN3,ROUT=GRPSAV
LPAREN3  DSCAN KEY='(',SUCC=SAVPTF17                         @Z67SP00
SAVPTF17 DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=RPAREN3,                 X
               ROUT=PTFSAV17                                 @Z67SP00
RPAREN3  DSCAN KEY=')',ALT=SAVPTF17,SUCC=SELK,COMMA=NO       @Z67SP00
**********
*****
*****    DSCANS FOR COMPRESS OPTION
*****    NOTE THAT DSCAN FOR C IS LAST OF DSCANS SO THAT
*****       IT WILL CAUSE NO PROBLEM IF OTHER KEYWORDS STARTING
*****       WITH C ARE ADDED
*****
**********
CMPRSK   DSCAN KEY='COMPRESS',ALT=BYPASSK,SUCC=LPAREN7,                X
               ROUT=CMPRSET                                  @Z67SP00
LPAREN7  DSCAN KEY='(',SUCC=DDNAME
DDNAME   DSCAN MINLEN=1,MAXLEN=8,ROUT=DDNSAV,SUCC=RPAREN7,             X
               COMMA=NO                                      @Z40SP00
RPAREN7  DSCAN KEY=')',ALT=DDNAME,SUCC=SELK,COMMA=NO         @Z40SP00
**********
*****
*****    DSCAN FOR BYPASS KEYWORD
*****
**********
BYPASSK  DSCAN KEY='BYPASS',ALT=NUCIDK,SUCC=BYPLP            @Z67SP00
BYPLP    DSCAN KEY='(',SUCC=BYPFMID                          @Z67SP00
BYPFMID  DSCAN KEY='FMID',ALT=BYPPRE,SUCC=BYPFMID,COMMA=NO,            X
               ROUT=SBYPFMID                                 @Z67SP00
BYPPRE   DSCAN KEY='PRE',ALT=BYPREQ,SUCC=BYPFMID,COMMA=NO,             X
               ROUT=SBYPPRE                                  @Z67SP00
BYPREQ   DSCAN KEY='REQ',ALT=BYPIRQ,SUCC=BYPFMID,COMMA=NO,             X
               ROUT=SBYPREQ                                  @Z67SP00
BYPIRQ   DSCAN KEY='IFREQ',ALT=BYPID,SUCC=BYPFMID,COMMA=NO,            X
               ROUT=SBYPIRQ                                  @Z67SP00
BYPID    DSCAN KEY='ID',ALT=BYPRP,SUCC=BYPFMID,COMMA=NO,               X
               ROUT=SBYPID                                   @Z67SP00
BYPRP    DSCAN KEY=')',SUCC=SELK,COMMA=NO                    @Z67SP00
**********
*****
*****    DSCAN FOR NUCID(N) OPTION
*****
**********
NUCIDK   DSCAN KEY='NUCID',ALT=NOAPPLK,SUCC=LPAREN4          @Z67SP00
LPAREN4  DSCAN KEY='(',SUCC=NUCVAL
NUCVAL   DSCAN MINLEN=1,MAXLEN=1,ROUT=NUCSAV,SUCC=RPAREN4
RPAREN4  DSCAN KEY=')',SUCC=SELK
**********                                                   @ZD00009
*****                                                        @ZD00009
*****    DSCAN FOR NOAPPLY KEYWORD                           @ZD00009
*****                                                        @ZD00009
**********                                                   @ZD00009
NOAPPLK  DSCAN KEY='NOAPPLY',SUCC=SELK,ALT=CHECKK,                     X
               ROUT=NOAPPSAV                                 @Z67SP00
**********                                                   @ZD00007
*****                                                        @ZD00007
*****    DSCAN FOR CHECK KEYWORD                             @ZD00007
*****                                                        @ZD00007
**********                                                   @ZD00007
CHECKK   DSCAN KEY='CHECK',SUCC=SELK,ALT=ASSEMC,                       X
               ROUT=CHECKSAV                                 @Z67SP00
**********                                                   @Z67SP00
*****                                                        @Z67SP00
*****    DSCAN FOR APARS KEYWORD                             @Z67SP00
*****                                                        @Z67SP00
**********                                                   @Z67SP00
ASSEMC   DSCAN KEY='ASSEM',SUCC=SELK,ALT=APARSC,                       X
               ROUT=ASSEMSV                                  @Z67SP00
**********                                                   @Z67SP00
*****                                                        @Z67SP00
*****    DSCAN FOR APARS KEYWORD                             @Z67SP00
*****                                                        @Z67SP00
**********                                                   @Z67SP00
APARSC   DSCAN KEY='APARS',SUCC=SELK,ALT=USERMODC,                     X
               ROUT=APARSAV                                  @Z67SP00
**********                                                   @Z67SP00
*****                                                        @Z67SP00
*****    DSCAN FOR USERMODS KEYWORD                          @Z67SP00
*****                                                        @Z67SP00
**********                                                   @Z67SP00
USERMODC DSCAN KEY='USERMODS',SUCC=SELK,ALT=KDIS,                      X
               ROUT=USERSAV                                  @Z67SP00
**********                                                   @Z67SP00
*****                                                        @Z67SP00
*****    DSCAN FOR DIS KEYWORD AND OPTIONS                   @Z67SP00
*****                                                        @Z67SP00
**********                                                   @Z67SP00
KDIS     DSCAN KEY='DIS',ALT=KNOJCL,SUCC=KDISLP,ROUT=RDIS    @Z67SP00
KDISLP   DSCAN KEY='(',SUCC=KDISN                            @Z67SP00
KDISN    DSCAN KEY='NO',ALT=KDISW,SUCC=KDISRP,ROUT=RDISN     @Z67SP00
KDISW    DSCAN KEY='WRITE',ALT=KDISR,SUCC=KDISRP,ROUT=RDISW  @Z67SP00
KDISR    DSCAN KEY='READ',SUCC=KDISRP,ROUT=RDISR             @Z67SP00
KDISRP   DSCAN KEY=')',SUCC=SELK                             @Z67SP00
**********                                                   @Z67SP00
*****                                                        @Z67SP00
*****    DSCAN FOR NOJCLIN OPTION                            @Z67SP00
*****                                                        @Z67SP00
**********                                                   @Z67SP00
KNOJCL   DSCAN KEY='NOJCLIN',ALT=SK,SUCC=KNOJCLLP,                     X
               ROUT=RNOJCL                                   @Z67SP00
KNOJCLLP DSCAN KEY='(',ALT=SELK,SUCC=KNOJCLV                 @Z67SP00
KNOJCLV  DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,SUCC=KNOJCLRP,                X
               ROUT=RNOJCLV                                  @Z67SP00
KNOJCLRP DSCAN KEY=')',ALT=KNOJCLV,SUCC=SELK,COMMA=NO        @Z67SP00
**********                                                   @ZD00007
*****                                                        @ZD00007
*****    DSCANS FOR ALL ONE CHARACTER KEYWORDS AT END SO THAT
*****    THERE IS LESS CHANCE OF ERRORS IF FUTURE KEYWORDS ARE
*****    ADDED THAT START WITH ONE OF THESE LETTERS          @ZD00007
*****                                                        @ZD00007
**********                                                   @ZD00007
**********                                                   @ZD00007
*****                                                        @ZD00007
*****    ABBREVIATION FOR SELECT KEYWORD                     @ZD00007
*****                                                        @ZD00007
**********                                                   @ZD00007
SK       DSCAN KEY='S',ALT=GK,SUCC=LPAREN3,ROUT=SELSAV       @Z67SP00
**********                                                   @Z67SP00
*****                                                        @Z67SP00
*****    ABBREVIATION FOR GROUP KEYWORD                      @Z67SP00
*****                                                        @Z67SP00
**********                                                   @Z67SP00
GK       DSCAN KEY='G',ALT=EK,SUCC=LPAREN3,ROUT=GRPSAV       @Z67SP00
**********                                                   @ZD00007
*****                                                        @ZD00007
*****    ABBREVIATION FOR EXCLUDE KEYWORD                    @ZD00007
*****                                                        @ZD00007
**********                                                   @ZD00007
EK       DSCAN KEY='E',ALT=CK,SUCC=LPAREN3,ROUT=EXCSAV
**********                                                   @ZD00007
*****                                                        @ZD00007
*****    ABBREVIATION FOR COMPRESS KEYWORD                   @ZD00007
*****                                                        @ZD00007
**********                                                   @ZD00007
CK       DSCAN KEY='C',ALT=RC1,SUCC=LPAREN7,ROUT=CMPRSET
HMASMDRV CSECT
**********
*****
*****    DSCAN FOR UCLIN DATASET OPTIONS
*****
**********
DSCDS    DSCAN KEY='CDS',ALT=DSACDS,SUCC=DSCDS,ROUT=UCLCDSV  @Z67SP00
DSACDS   DSCAN KEY='ACDS',ALT=DSSCDS,SUCC=DSCDS,                       X
               ROUT=UCLACDSV                                 @Z67SP00
DSSCDS   DSCAN KEY='SCDS',ALT=DSPTS,SUCC=DSCDS,ROUT=UCLSCDSV @Z67SP00
DSPTS    DSCAN KEY='PTS',ALT=DSMTS,SUCC=DSCDS,ROUT=UCLPTSSV  @Z67SP00
DSMTS    DSCAN KEY='MTS',ALT=DSSTS,SUCC=DSCDS,ROUT=UCLMTSSV  @Z67SP00
DSSTS    DSCAN KEY='STS',ALT=DSCRQ,SUCC=DSCDS,ROUT=UCLSTSSV  @Z67SP00
DSCRQ    DSCAN KEY='CRQ',ALT=DSACRQ,SUCC=DSCDS,ROUT=UCLCRQSV @Z67SP00
DSACRQ   DSCAN KEY='ACRQ',ALT=KUDIS,SUCC=DSCDS,                        X
               ROUT=UCLACQSV                                 @Z67SP00
KUDIS    DSCAN KEY='DIS',ALT=RC1,SUCC=KUDISLP,ROUT=RDIS      @Z67SP00
KUDISLP  DSCAN KEY='(',SUCC=KUDISN                           @Z67SP00
KUDISN   DSCAN KEY='NO',ALT=KUDISW,SUCC=KUDISRP,ROUT=RDISN   @Z67SP00
KUDISW   DSCAN KEY='WRITE',ALT=KUDISR,SUCC=KUDISRP,                    X
               ROUT=RDISW                                    @Z67SP00
KUDISR   DSCAN KEY='READ',SUCC=KUDISRP,ROUT=RDISR            @Z67SP00
KUDISRP  DSCAN KEY=')',SUCC=DSCDS                            @Z67SP00
**********
*****
*****    DSCANS FOR JCLIN OPTIONS
*****
**********
JCASM    DSCAN KEY='ASM',SUCC=JCLP,ALT=JCLKED,ROUT=JCASMEX   @SA73847
JCLKED   DSCAN KEY='LKED',SUCC=JCLP,ALT=JCUPDTE,ROUT=JCLKDEX @SA73847
JCUPDTE  DSCAN KEY='UPDATE',SUCC=JCLP,ALT=JCCOPY,ROUT=JCUPDEX @SA73847
JCCOPY   DSCAN KEY='COPY',ALT=KJDIS,SUCC=JCLP,ROUT=JCCOPYEX   @YA07506
JCLP     DSCAN KEY='(',SUCC=JCPGM                            @SA73847
JCPGM    DSCAN KEY='PGM=',SUCC=JCKEY,ALT=JCKEY,ROUT=JCPGMEX  @SA73847
JCKEY    DSCAN MINLEN=1,MAXLEN=8,SUCC=JCRP,ROUT=JCKEYEX      @SA73847
JCRP     DSCAN KEY=')',SUCC=JCASM                            @SA73847
KJDIS    DSCAN KEY='DIS',ALT=RC1,SUCC=KJDISLP,ROUT=RDIS      @Z67SP00
KJDISLP  DSCAN KEY='(',SUCC=KJDISN                           @Z67SP00
KJDISN   DSCAN KEY='NO',ALT=KJDISW,SUCC=KJDISRP,ROUT=RDISN   @Z67SP00
KJDISW   DSCAN KEY='WRITE',ALT=KJDISR,SUCC=KJDISRP,                    X
               ROUT=RDISW                                    @Z67SP00
KJDISR   DSCAN KEY='READ',SUCC=KJDISRP,ROUT=RDISR            @Z67SP00
KJDISRP  DSCAN KEY=')',SUCC=JCASM                            @Z67SP00
HMASMDRV CSECT
**********
*****
*****    DSCANS FOR LOG FUNCTION
*****
**********
LPAREN2  DSCAN KEY='(',SUCC=LOGDATA,ROUT=LOGSTART            @Z67SP00
LOGDATA  DSCAN MINLEN=0,MAXLEN=255,ALT=LOGDATA,SUCC=RC1,               X
               ROUT=LOGBUMP,BLANKS=ON                        @Z67SP00
HMASMDRV CSECT
**********
*****
*****    DSCANS FOR LIST LOG FUNCTION
*****
**********
LOGPK    DSCAN KEY='LOG',ALT=CDSK,SUCC=LPAREN6               @SA73855
LPAREN6  DSCAN KEY='(',ALT=PERIOD4,SUCC=BEGMON,ROUT=LLOGPART
BEGMON   DSCAN MINLEN=1,MAXLEN=2,ROUT=BMONSAV,TYPE=N,SUCC=BEGDAY
BEGDAY   DSCAN MINLEN=1,MAXLEN=2,ROUT=BDAYSAV,TYPE=N,SUCC=BEGYEAR,     X
               COMMA=NO                                      @Z40SP00
BEGYEAR  DSCAN MINLEN=2,MAXLEN=2,ROUT=BYEARSAV,TYPE=N,SUCC=ENDMON,     X
               COMMA=NO                                      @Z40SP00
ENDMON   DSCAN MINLEN=1,MAXLEN=2,ROUT=EMONSAV,TYPE=N,SUCC=ENDDAY,      X
               COMMA=NO                                      @Z40SP00
ENDDAY   DSCAN MINLEN=1,MAXLEN=2,ROUT=EDAYSAV,TYPE=N,SUCC=ENDYEAR,     X
               COMMA=NO                                      @Z40SP00
ENDYEAR  DSCAN MINLEN=2,MAXLEN=2,ROUT=EYEARSAV,TYPE=N,SUCC=RPAREN6,    X
               COMMA=NO                                      @Z40SP00
RPAREN6  DSCAN KEY=')',SUCC=PERIOD                           @Z40SP00
PERIOD4  DSCAN KEY='.',SUCC=EOCARD,ROUT=LLOGALL              @Z40SP00
HMASMDRV CSECT
**********
*****
*****    DSCANS FOR LIST FUNCTION OTHER THAN LOG
*****
**********
*****    DSCANS FOR DATASET IDS                              @Z67SP00
**********                                                   @Z67SP00
CDSK     DSCAN KEY='CDS',ALT=ACDSK,SUCC=CDSK,ROUT=CDSSAV     @SA73855
ACDSK    DSCAN KEY='ACDS',ALT=SCDSK,SUCC=CDSK,ROUT=ACDSSAV   @Z67SP00
SCDSK    DSCAN KEY='SCDS',ALT=PTSK,SUCC=CDSK,ROUT=SCDSSAV    @Z67SP00
PTSK     DSCAN KEY='PTS',ALT=CRQK,SUCC=CDSK,ROUT=PTSSAV      @Z67SP00
CRQK     DSCAN KEY='CRQ',ALT=ACRQK,SUCC=CDSK,ROUT=CRQSAV     @Z67SP00
ACRQK    DSCAN KEY='ACRQ',ALT=SMDK,SUCC=CDSK,ROUT=ACRQSAV    @Z67SP00
**********
*****    DSCANS FOR ELEMENT TYPES WITHIN DATASET             @Z67SP00
**********                                                   @Z67SP00
SMDK     DSCAN KEY='SYSMOD',ALT=SYSK,SUCC=LSELK,                       X
               ROUT=SYSMSAV                                  @Z67SP00
SYSK     DSCAN KEY='SYS',ALT=MODK,SUCC=CDSK,ROUT=SYSSAV      @SA99995
MODK     DSCAN KEY='MOD',ALT=MACK,SUCC=LSELK,ROUT=MODSAV     @SA99995
MACK     DSCAN KEY='MAC',ALT=LMODK,SUCC=LSELK,ROUT=MACSAV    @SA99995
LMODK    DSCAN KEY='LMOD',ALT=ASSEMK,SUCC=LSELK,ROUT=LMODSAV @SA99995
ASSEMK   DSCAN KEY='ASSEM',ALT=DLIBK,SUCC=LSELK,                       X
               ROUT=ASSEMSAV                                 @Z67SP00
DLIBK    DSCAN KEY='DLIB',ALT=SRCK,SUCC=LSELK,ROUT=DLIBSAV   @Z40SP00
SRCK     DSCAN KEY='SRC',ALT=FMIDK,SUCC=LSELK,ROUT=SRCSAV    @Z67SP00
FMIDK    DSCAN KEY='FMID',ALT=MCSK1,SUCC=LSELK,ROUT=FMIDSAV  @Z67SP00
MCSK1    DSCAN KEY='MCS',ALT=LNAPPK1,SUCC=LSELK,ROUT=MCSSAV  @Z67SP00
**********
*****    DSCANS FOR STATUS TYPE KEYWORDS FOR SYSMODS         @Z67SP00
**********                                                   @Z67SP00
LNAPPK1  DSCAN KEY='NOAPPLY',ALT=LNAPPK2,SUCC=CDSK,                    X
               ROUT=LNAPPSAV                                 @Z67SP00
LNAPPK2  DSCAN KEY='NOAPP',ALT=LRESK1,SUCC=CDSK,                       X
               ROUT=LNAPPSAV                                 @Z67SP00
LRESK1   DSCAN KEY='RESTORE',ALT=LRESK2,SUCC=CDSK,                     X
               ROUT=LRESSAV                                  @ZD00002
LRESK2   DSCAN KEY='RES',ALT=LNACCK1,SUCC=CDSK,ROUT=LRESSAV  @ZD00002
LNACCK1  DSCAN KEY='NOACCEPT',ALT=LNACCK2,SUCC=CDSK,                   X
               ROUT=LNACCSAV                                 @Z67SP00
LNACCK2  DSCAN KEY='NOACC',ALT=LBYPK1,SUCC=CDSK,                       X
               ROUT=LNACCSAV                                 @Z67SP00
LBYPK1   DSCAN KEY='BYPASS',ALT=LBYPK2,SUCC=CDSK,                      X
               ROUT=LBYPSAV                                  @Z67SP00
LBYPK2   DSCAN KEY='BYP',ALT=LERRK1,SUCC=CDSK,ROUT=LBYPSAV   @Z67SP00
LERRK1   DSCAN KEY='ERROR',ALT=LERRK2,SUCC=CDSK,ROUT=LERRSAV @ZD00002
LERRK2   DSCAN KEY='ERR',ALT=LSUPK,SUCC=CDSK,ROUT=LERRSAV    @ZD00002
LSUPK    DSCAN KEY='SUP',ALT=LNSUPK,SUCC=CDSK,ROUT=LSUPSAV   @Z67SP00
LNSUPK   DSCAN KEY='NOSUP',ALT=LDELK1,SUCC=CDSK,                       X
               ROUT=LNSUPSAV                                 @Z67SP00
LDELK1   DSCAN KEY='DELETE',ALT=LDELK2,SUCC=CDSK,                      X
               ROUT=LDELSAV                                  @Z67SP00
LDELK2   DSCAN KEY='DEL',ALT=LFNC1,SUCC=CDSK,ROUT=LDELSAV    @Z67SP00
**********
*****    DSCANS FOR SYSMOD TYPES                             @Z67SP00
**********                                                   @Z67SP00
LFNC1    DSCAN KEY='FUNCTION',ALT=LFNC2,SUCC=CDSK,                     X
               ROUT=LFNCSAV                                  @Z67SP00
LFNC2    DSCAN KEY='FUNC',ALT=LPTF1,SUCC=CDSK,                         X
               ROUT=LFNCSAV                                  @Z67SP00
LPTF1    DSCAN KEY='PTF',ALT=LAPR1,SUCC=CDSK,                          X
               ROUT=LPTFSAV                                  @Z67SP00
LAPR1    DSCAN KEY='APAR',ALT=LUSR1,SUCC=CDSK,                         X
               ROUT=LAPRSAV                                  @Z67SP00
LUSR1    DSCAN KEY='USERMOD',ALT=LUSR2,SUCC=CDSK,                      X
               ROUT=LUSRSAV                                  @Z67SP00
LUSR2    DSCAN KEY='USER',ALT=LXRFK,SUCC=CDSK,                         X
               ROUT=LUSRSAV                                  @Z67SP00
**********                                                   @Z67SP00
*****    DSCANS FOR OTHER OPTIONS                            @Z67SP00
**********                                                   @Z67SP00
LXRFK    DSCAN KEY='XREF',ALT=PREPER,SUCC=CDSK,ROUT=LXRFSAV  @Z67SP00
**********                                                   @Z67SP00
*****    DSCANS FOR SELECT OPTIONS                           @Z67SP00
**********                                                   @Z67SP00
LSELK    DSCAN KEY='(',ALT=CDSK,SUCC=LMEM,ROUT=LSELSAV       @SA99995
LMEM     DSCAN MAXLEN=8,SUCC=RPAREN8,ROUT=SESAV,COMMA=NO     @Z40SP00
RPAREN8  DSCAN KEY=')',ALT=LMEM,SUCC=CDSK,ROUT=LSELEND,                X
               COMMA=NO                                      @Z40SP00
**********                                                   @Z67SP00
*****    DSCANS FOR PERIOD ON LIST STATEMENT                 @Z67SP00
**********                                                   @Z67SP00
PREPER   DSCAN KEY='.',SUCC=EOCARD,ROUT=LISTPER              @Z40SP00
HMASMDRV CSECT
**********
*****
*****    DSCANS FOR RC PARMAMETER ON STATEMENTS
*****
**********
RC1      DSCAN KEY='RC',ALT=PERIOD,SUCC=RC22,ROUT=RCINIT     @Z40SP00
RC22     DSCAN KEY='(',SUCC=RC3                              @YA07506
RC3      DSCAN KEY='RECEIVE',ALT=RC4,SUCC=RC15,ROUT=RCRECRT,           X
               COMMA=NO                                      @Z40SP00
RC4      DSCAN KEY='APPLY',ALT=RC6,SUCC=RC15,ROUT=RCAPLRT    @YA07506
RC6      DSCAN KEY='ACCEPT',ALT=RC7,SUCC=RC15,ROUT=RCACPRT   @YA07506
RC7      DSCAN KEY='RESTORE',ALT=RC8,SUCC=RC15,ROUT=RCRSTRT  @YA07506
RC8      DSCAN KEY='REJECT',ALT=RC9,SUCC=RC15,ROUT=RCREJRT   @YA07506
RC9      DSCAN KEY='JCLIN',ALT=RC10,SUCC=RC15,ROUT=RCJCLRT   @YA07506
RC10     DSCAN KEY='UCLIN',ALT=RC11,SUCC=RC15,ROUT=RCUCLRT   @YA07506
RC11     DSCAN KEY='LIST',ALT=RC12,SUCC=RC15,ROUT=RCLSTRT    @YA07506
RC12     DSCAN KEY='LOG',SUCC=RC15,ROUT=RCLOGRT              @Z67SP00
RC15     DSCAN KEY='=',SUCC=RC5                              @YA07506
RC5      DSCAN MINLEN=1,MAXLEN=2,TYPE=N,ROUT=MAINRCRT,                 X
               SUCC=RC14                                     @Z67SP00
RC14     DSCAN KEY=')',SUCC=PERIOD,ALT=RC3,COMMA=NO          @Z67SP00
HMASMDRV CSECT
**********                                                   @Z40SP00
*****                                                        @Z40SP00
*****    DSCANS TO CHECK FOR ENDING PERIOD WHEN ALL OTHER    @Z40SP00
*****    OPTIONS ARENT FOUND ON A STATEMENT                  @Z40SP00
*****                                                        @Z40SP00
**********                                                   @Z40SP00
PERIOD   DSCAN KEY='.',SUCC=EOCARD,ROUT=PERCHCK              @Z40SP00
EOCARD   DSCAN MINLEN=0,IO=NO,ROUT=XTRADATA                  @Z40SP00
**********                                                   @Z40SP00
*****                                                        @Z40SP00
*****    DSCANS TO CONTINUE SCAN OF STATEMENT LOOKING FOR    @Z40SP00
*****    THE ENDING PERIOD AFTER A SYNTAX ERROR IS FOUND     @Z40SP00
*****                                                        @Z40SP00
**********                                                   @Z40SP00
SYNTERR  DSCAN KEY='.',SUCC=EOCARD,ALT=MOREDATA              @Z40SP00
MOREDATA DSCAN MINLEN=0,SUCC=SYNTERR,ROUT=XTRAINFO           @Z40SP00
HMASMDRV CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
IOPPTR   EQU   @07
DCBPTR   EQU   @02
CCAPTR   EQU   @11
RTNREG   EQU   @14
RTNCODE  EQU   @15
R1       EQU   @01
SIZE     EQU   @02
         EXTRN HMASMCCA
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDRC EQU   @NM00027+20
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00039+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPNAME  EQU   HMASMIOP+4
@NM00043 EQU   HMASMIOP+12
@NM00044 EQU   @NM00043
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00154 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
HMASMPRL EQU   0
PRLRLEN  EQU   HMASMPRL
PRLSPAN  EQU   HMASMPRL+2
PRLFLGS  EQU   PRLSPAN
PRLHEAD  EQU   PRLFLGS
PRLHEADO EQU   PRLFLGS
PRLBLANK EQU   PRLFLGS
PRLDATE  EQU   HMASMPRL+4
PRLTIME  EQU   HMASMPRL+7
PRLEND   EQU   HMASMPRL+10
SCPSTRNG EQU   0
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPRCDLN EQU   HMASMGTP+4
GTPKEYLN EQU   HMASMGTP+6
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
GTPPSIZE EQU   GTPFLGS1
SPLPPACK EQU   0
SPLPUNPK EQU   0
SPLPDSN  EQU   0
SPLODSN  EQU   SPLPDSN
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBCICB  EQU   IHADCS36+20
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00206 EQU   IHADCS40+12
DCBEROPT EQU   @NM00206
CMPRSLST EQU   0
CMPRSELM EQU   CMPRSLST
CMPRSFLG EQU   CMPRSLST+8
RCFUNCT  EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
SCANRTN  EQU   0
SCPIOPRM EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCACBFIA EQU   CCAFBUFR
CCAVBFIA EQU   CCAFBUFR+8
CCAPBFIA EQU   CCAFBUFR+16
CCAQBFIA EQU   CCAFBUFR+24
CCAWBFIA EQU   CCAFBUFR+32
CCATBFIA EQU   CCAFBUFR+40
CCA4BFIA EQU   CCAFBUFR+44
CCACBFSZ EQU   CCAFBUFR+56
CCAVBFSZ EQU   CCAFBUFR+60
CCAPBFSZ EQU   CCAFBUFR+64
CCAQBFSZ EQU   CCAFBUFR+68
CCAWBFSZ EQU   CCAFBUFR+72
CCATBFSZ EQU   CCAFBUFR+76
CCA4BFSZ EQU   CCAFBUFR+80
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCAIOPCS EQU   CCAFSYS
CCAIOPAS EQU   CCAFSYS+4
CCASREL  EQU   CCAFSYS+12
CCANUCID EQU   CCAFSYS+20
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCASPDCB EQU   CCAFPGM+8
CCACLST  EQU   CCAFPGM+12
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
CCASETAD EQU   CCASEGTP
@NM00009 EQU   HMASMCCA+244
CCATBLPA EQU   @NM00009+12
CCAFFUNC EQU   HMASMCCA+264
CCAFUNCT EQU   CCAFFUNC
CCAFLAG1 EQU   CCAFFUNC+8
CCAREC   EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCALIST  EQU   CCAFLAG1
CCACNV   EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCAFLAG2 EQU   CCAFFUNC+11
CCANCPTF EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
CCAEOSMP EQU   CCAFLAG2
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCACMPRS EQU   CCAFLAG3
CCAICTOK EQU   CCAFLAG3
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCACDSC  EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCARVEST EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARPTDS EQU   CCAFCTL+7
CCALSTDS EQU   CCAFCTL+8
CCAFMID  EQU   HMASMCCA+291
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
DRVPARM  EQU   0
DRVPEND  EQU   DRVPARM+2
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00050 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPDIRMX EQU   IOPNTMAX+12
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00061 EQU   IOPUDATA
@NM00062 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00071 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00082 EQU   IOPSRCDR+1
@NM00084 EQU   @NM00082+7
@NM00088 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00092 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00098 EQU   IOPMODDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00108 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00119 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00126 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00135 EQU   IOPPTFFX
@NM00136 EQU   @NM00135
IOPPDTES EQU   IOPPTFFX+41
@NM00139 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00164 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00164
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00168 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00168
IOPBFTB1 EQU   IOPBFTB0
PRLDATA  EQU   PRLEND
DRVPDATA EQU   DRVPEND
ICTENDIX EQU   ICTENDCH
ICTENDNT EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00170 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00169 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00166 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00165 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00163 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00162 EQU   IOPPTSFX+35
@NM00161 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00160 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00159 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00158 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00157 EQU   IOPQFMDR
@NM00153 EQU   IOPQSMDR
@NM00152 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00151 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00150 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00149 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00148 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00147 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00146 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00145 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00144 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00143 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00142 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00141 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00140 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00139+3
IOPRECD  EQU   @NM00139
@NM00138 EQU   IOPPTFFX+8
@NM00137 EQU   @NM00135+7
IOPPRELN EQU   @NM00136
@NM00134 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00133 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00132 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00131 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00130 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00129 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00128 EQU   @NM00126+7
@NM00127 EQU   @NM00126
@NM00125 EQU   IOPSYSDR+5
@NM00124 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00123 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00122 EQU   IOPDLBFX+8
@NM00121 EQU   @NM00119+7
@NM00120 EQU   @NM00119
@NM00118 EQU   IOPDLBDR+1
@NM00117 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00116 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00115 EQU   IOPMODFX+12
@NM00114 EQU   IOPMODF4
@NM00113 EQU   IOPMODF3
@NM00112 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00111 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPMODDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00096 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00095 EQU   IOPSRCFX+8
@NM00094 EQU   @NM00092+7
@NM00093 EQU   @NM00092
@NM00091 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00084
@NM00086 EQU   @NM00084
@NM00085 EQU   @NM00084
@NM00083 EQU   @NM00082
@NM00081 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00080 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00079 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00078 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00077 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00076 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00075 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00073 EQU   @NM00071+7
@NM00072 EQU   @NM00071
@NM00070 EQU   IOPLMDDR+6
@NM00069 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00068 EQU   IOPLMDF4
@NM00067 EQU   IOPLMDF3
@NM00066 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00065 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00064 EQU   IOPLMDDR
@NM00063 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00062+4
IOPUSED  EQU   @NM00062
IOPTPSEQ EQU   @NM00061+8
IOPVLSER EQU   @NM00061+2
IOPBLKSI EQU   @NM00061
IOPCQMAX EQU   IOPCQMAP+12
@NM00060 EQU   IOPCQMAP+11
@NM00059 EQU   IOPCQMAP+8
@NM00058 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00057 EQU   IOPSCMAP+11
@NM00056 EQU   IOPSCMAP+8
@NM00055 EQU   IOPSCMAP
@NM00054 EQU   IOPNTMAX+11
@NM00053 EQU   IOPNTMAX+8
@NM00052 EQU   IOPNTMAX
@NM00051 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00050+5
IOPIPTF3 EQU   @NM00050
DRVPLEN  EQU   DRVPARM
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00023 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00022 EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCADELP  EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
@NM00016 EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAPESIZ EQU   CCAFIOP+4
@NM00007 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
@NM00001 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCAWBFOA EQU   CCAFBUFR+36
CCAQBFOA EQU   CCAFBUFR+28
CCAPBFOA EQU   CCAFBUFR+20
CCAVBFOA EQU   CCAFBUFR+12
CCACBFOA EQU   CCAFBUFR+4
CCAID    EQU   HMASMCCA
@NM00210 EQU   CMPRSFLG
CMPRSDEL EQU   CMPRSFLG
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00209 EQU   IHADCS40+16
@NM00208 EQU   @NM00206+1
@NM00207 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00205 EQU   IHADCS40+10
@NM00204 EQU   IHADCS40+9
@NM00203 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00202 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
DCBLRECL EQU   IHADCS38+10
@NM00201 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00200 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00199 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00198 EQU   DCBCICB
DCBIOBA  EQU   IHADCS36+16
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBBLKSI EQU   IHADCS36+10
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00197 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00196 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00195 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUT   EQU   DCBGET
DCBREAD  EQU   DCBWRITE
DCBDEBA  EQU   DCBDEBAD+1
@NM00194 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00193 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00192 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00191 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00190 EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00189 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00188 EQU   IHADCS01+5
@NM00187 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00186 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00185 EQU   IHADCB
SPLIFIL  EQU   SPLODSN+33
SPLISMD  EQU   SPLODSN+26
SPLIPFX  EQU   SPLODSN
SPLIUNPK EQU   SPLPUNPK+8
SPLOUNPK EQU   SPLPUNPK
SPLOPACK EQU   SPLPPACK+8
SPLIPACK EQU   SPLPPACK
@NM00181 EQU   HMASMGTP+27
@NM00180 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
@NM00179 EQU   HMASMGTP+2
PRLCONC  EQU   PRLTIME+2
@NM00177 EQU   PRLTIME
PRLHDADR EQU   PRLDATE
@NM00176 EQU   PRLFLGS
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00156 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00155 EQU   @NM00154+7
IOPQSMFM EQU   @NM00154
@NM00074 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00049 EQU   IOPUSERL
@NM00048 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00047 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00046 EQU   @NM00043+10
IOPSEQNO EQU   @NM00043+8
@NM00045 EQU   @NM00044+7
IOPPTFNM EQU   @NM00044
IOPNAM17 EQU   IOPNAME
IOPTYPE  EQU   HMASMIOP+3
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
CCAUPDPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00039+12
CCAUPDTE EQU   @NM00039+8
CCAUPDNM EQU   @NM00039
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
CCACPYPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00031+12
CCACOPY  EQU   @NM00031+8
CCACPYNM EQU   @NM00031
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
CCALKDPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00027+12
CCALKED  EQU   @NM00027+8
CCALKDNM EQU   @NM00027
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00283 EQU   FINAL
@RT00320 EQU   CLEANUP
@RT00382 EQU   CLEANUP
@RC00430 EQU   @RC00428
@RT00460 EQU   CLEANUP
@RF00491 EQU   CLEANUP
@RC00509 EQU   CLEANUP
@RT00541 EQU   CLEANUP
@RF00569 EQU   CLEANUP
@RT00678 EQU   DRVSCAN
@RF00865 EQU   @EL00003
@RC00886 EQU   @EL00004
@RC00891 EQU   @EL00004
@RC00896 EQU   @EL00004
@RC00901 EQU   @EL00004
@RC00906 EQU   @EL00004
@RC00911 EQU   @EL00004
@RC00916 EQU   @EL00004
@RC00921 EQU   @EL00004
@RF00931 EQU   @EL00005
JCLINEXT EQU   @EL00007
@RT00976 EQU   BADRCRT
@RT00982 EQU   BADRCRT
@RT00988 EQU   BADRCRT
@RT00994 EQU   BADRCRT
@RT01000 EQU   BADRCRT
@RT01006 EQU   BADRCRT
@RT01012 EQU   BADRCRT
@RT01018 EQU   BADRCRT
@RT01024 EQU   BADRCRT
@RC01039 EQU   @EL00008
ENDRCRT  EQU   @EL00008
@RF01042 EQU   @EL00008
@RC01047 EQU   @EL00009
@RC01056 EQU   @EL00010
@RC01065 EQU   @EL00011
@RF01086 EQU   @EL00012
BYPEND   EQU   @EL00013
@RC01117 EQU   @EL00014
@RC01126 EQU   @EL00015
@RC01131 EQU   @EL00016
@RC01136 EQU   @EL00017
@RC01141 EQU   @EL00018
@RC01146 EQU   @EL00019
@RF01151 EQU   @EL00020
@RC01164 EQU   @EL00024
@RF01183 EQU   @EL00025
LOGEXIT  EQU   @EL00027
@RT01223 EQU   LISTBAD
@RT01228 EQU   LISTBAD
@RT01233 EQU   LISTBAD
@RT01238 EQU   LISTBAD
@RT01243 EQU   LISTBAD
@RT01248 EQU   LISTBAD
@RT01289 EQU   LISTBAD
@RT01376 EQU   LISTBAD
@RF01380 EQU   LISTCHCK
@RT01400 EQU   LISTBAD
@RT01402 EQU   LISTBAD
@RT01404 EQU   LISTBAD
@RT01406 EQU   LISTBAD
@RC01397 EQU   @EL00028
@RF01408 EQU   @EL00028
@RC01414 EQU   @EL00029
@RF01426 EQU   @EL00029
@RC01445 EQU   @EL00031
@RF01451 EQU   @EL00031
@RF01459 EQU   @EL00032
@RC01465 EQU   @EL00033
@RF01506 EQU   @EL00034
@RF00955 EQU   JCLINEXT
@RC01091 EQU   BYPEND
@RC01096 EQU   BYPEND
@RC01101 EQU   BYPEND
@RC01106 EQU   BYPEND
@RC01111 EQU   BYPEND
@RC01195 EQU   LOGEXIT
@RC01200 EQU   LOGEXIT
@RC01208 EQU   LOGEXIT
@RC01213 EQU   LOGEXIT
@RF01471 EQU   @RC01465
@ENDDATA EQU   *
         END   HMASMDRV,(C'PLS2012',0802,78334)

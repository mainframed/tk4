         TITLE 'HMASMBUR - RESTORE CDS FROM SCDS ROUTINE'
HMASMBUR CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMBUR  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   BURRTNCD=ZERO;                  /* INIT RC                       */
         SLR   BURRTNCD,BURRTNCD                                   0164
*   IOPPTR=CCAIOPTR;                /* PTR TO COMMON IOP             */
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0165
*   GTPPTR=BUPGTPAD;                /* PTR TO PASSED GTP             */
         L     @15,@PC00001                                        0166
         L     GTPPTR,BUPGTPAD(,@15)                               0166
*   HMASMMGP=''B;                   /*                               */
         XC    HMASMMGP(28),HMASMMGP                               0167
*   MGPHLDS=ON;                     /* ALL MSG TO LOG AND OUT        */
*   MGPPRINT=ON;                    /*                               */
         OI    MGPHLDS,B'10010000'                                 0169
*   RFY                                                            0170
*     RTNCODE RSTD;                 /*                               */
*                                                                  0170
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO SET UP FOR PROCESSING                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0171
*   CALL BURSETUP;                  /*                               */
         BAL   @14,BURSETUP                                        0171
*   BURRTNCD=MAX(BURRTNCD,RTNCODE); /*                               */
*                                                                  0172
         CR    BURRTNCD,RTNCODE                                    0172
         BNL   *+6
         LR    BURRTNCD,RTNCODE                                    0172
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PREVIOUS FUNCTION WAS OK THEN LOCATE THE SYSMOD TO BE      */
*   /* PROCESSED ON THE SMPSCDS DATASET. SAVE RETURN CODE IN CASE    */
*   /* ERROR                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0173
*   IF BURRTNCD=ZERO                /* IF NO PREV ERRORS             */
*     THEN                          /*                               */
         CH    BURRTNCD,@CH00271                                   0173
         BNE   @RF00173                                            0173
*     DO;                           /*                               */
*       IOPFUNCT=IOPLOC;            /* LOCATE                        */
         MVI   IOPFUNCT(IOPPTR),X'03'                              0175
*       IOPTYPE=IOPSMD;             /* SYSMOD                        */
         MVI   IOPTYPE(IOPPTR),X'0B'                               0176
*       IOPNAME=BUPSYSMD;           /* TO BE PROCESSED               */
         MVI   IOPNAME+7(IOPPTR),C' '                              0177
         L     @14,@PC00001                                        0177
         MVC   IOPNAME(7,IOPPTR),BUPSYSMD(@14)                     0177
*       IOPPTFNM=BUPSYSMD;          /*                               */
         MVC   IOPPTFNM(7,IOPPTR),BUPSYSMD(@14)                    0178
*       IOPDSID=IOPSCDS;            /* ON THE SCDS                   */
         MVI   IOPDSID(IOPPTR),X'21'                               0179
*       CALL HMASMIO(HMASMIOP);     /*                               */
         ST    IOPPTR,@AL00001                                     0180
         L     @15,@CV01324                                        0180
         LA    @01,@AL00001                                        0180
         BALR  @14,@15                                             0180
*       BURRTNCD=MAX(BURRTNCD,IOPRETRN);/* SAVE RC                   */
         SLR   @14,@14                                             0181
         IC    @14,IOPRETRN(,IOPPTR)                               0181
         CR    BURRTNCD,@14                                        0181
         BNL   *+6
         LR    BURRTNCD,@14                                        0181
*       IF IOPRETRN=IOPNTFND        /* IF NOT FOUND                  */
*         THEN                      /*                               */
         CLI   IOPRETRN(IOPPTR),4                                  0182
         BNE   @RF00182                                            0182
*         DO;                       /*                               */
*           MGPCLEAR=''B;           /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0184
*           MGPMGNO1=HMA246I;       /* XXXXXXXX XXXXXXXX NOT FOUND ON
*                                      XXXXXXXX LIBRARY              */
         MVC   MGPMGNO1(2),@CH01329                                0185
*           MGPVARPT(1)=ADDR(CCATYPEA(IOPSMD));/* SYSMOD             */
         L     @14,CCATPAD(,CCAPTR)                                0186
         LA    @14,CCATYPEA+80(,@14)                               0186
         ST    @14,MGPVARPT                                        0186
*           MGPVARPT(2)=ADDR(IOPNAME);/* SYSMOD NUMBER               */
         LA    @14,IOPNAME(,IOPPTR)                                0187
         ST    @14,MGPVARPT+4                                      0187
*           MGPVARPT(3)=ADDR(CCADSIDA(IOPSCDS));/* SMPSCDS           */
         L     @14,CCADSAD(,CCAPTR)                                0188
         LA    @14,CCADSIDA+256(,@14)                              0188
         ST    @14,MGPVARPT+8                                      0188
*           MGPTYPE=MGPWARN;        /*                               */
         MVI   MGPTYPE,X'02'                                       0189
*           CALL HMASMMSG(HMASMMGP);/*                               */
         L     @15,@CV01325                                        0190
         LA    @01,@AL00190                                        0190
         BALR  @14,@15                                             0190
*         END;                      /*                               */
*     END;                          /*                               */
*                                                                  0192
@RF00182 DS    0H                                                  0193
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PREVIOUS FUNCTIONS OK THEN PROCESS REQUEST                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0193
*   IF BURRTNCD=ZERO                /*                               */
*     THEN                          /*                               */
@RF00173 CH    BURRTNCD,@CH00271                                   0193
         BNE   @RF00193                                            0193
*     DO;                           /*                               */
*                                                                  0194
*       /*************************************************************/
*       /*                                                           */
*       /* IF REQUEST WAS TO RESTORE BACKUP ENTRIES FROM SCDS TO CDS */
*       /* OR REQUEST TO DELETE ADDED CDS ENTRIES THEN PROCESS       */
*       /* REQUEST                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0195
*       IF BUPFUNCT=BUPREST         /*                               */
*         THEN                      /*                               */
         L     @14,@PC00001                                        0195
         CLI   BUPFUNCT(@14),4                                     0195
         BNE   @RF00195                                            0195
*         DO;                       /*                               */
*           CALL BURREST;           /*                               */
         BAL   @14,BURREST                                         0197
*           BURRTNCD=RTNCODE;       /*                               */
         LR    BURRTNCD,RTNCODE                                    0198
*         END;                      /*                               */
*                                                                  0199
*       /*************************************************************/
*       /*                                                           */
*       /* IF REQUEST WAS TO DELETE SCDS ENTRIES THEN DELETE THEM    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0200
*       ELSE                        /*                               */
*         IF BUPFUNCT=BUPSTOWD      /*                               */
*           THEN                    /*                               */
         B     @RC00195                                            0200
@RF00195 L     @14,@PC00001                                        0200
         CLI   BUPFUNCT(@14),5                                     0200
         BNE   @RF00200                                            0200
*           DO;                     /*                               */
*             CALL BURSTOWD;        /*                               */
         BAL   @14,BURSTOWD                                        0202
*             BURRTNCD=RTNCODE;     /*                               */
         LR    BURRTNCD,RTNCODE                                    0203
*           END;                    /*                               */
*                                                                  0204
*       /*************************************************************/
*       /*                                                           */
*       /* IF REQUEST WAS TO DELETE ADDED CDS ENTRIES THEN DEL EM    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0205
*         ELSE                      /*                               */
*           IF BUPFUNCT=BUPCDSDL    /*                               */
*             THEN                  /*                               */
         B     @RC00200                                            0205
@RF00200 L     @14,@PC00001                                        0205
         CLI   BUPFUNCT(@14),6                                     0205
         BNE   @RF00205                                            0205
*             DO;                   /*                               */
*               CALL BURCDSDL;      /* DELETE CDS ENTRIES            */
         BAL   @14,BURCDSDL                                        0207
*               BURRTNCD=RTNCODE;   /*                               */
         LR    BURRTNCD,RTNCODE                                    0208
*             END;                  /*                               */
*                                                                  0209
*       /*************************************************************/
*       /*                                                           */
*       /* IF REQUEST WAS NOT RESTORE OR DELETE THEN ERROR           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0210
*           ELSE                    /*                               */
*             BURRTNCD=IOPIOERR;    /*                               */
         B     @RC00205                                            0210
@RF00205 LA    BURRTNCD,16                                         0210
*     END;                          /* END PREV FUNCTION OK          */
*                                                                  0211
@RC00205 DS    0H                                                  0211
@RC00200 DS    0H                                                  0211
@RC00195 DS    0H                                                  0212
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO DO ANY TERMINATION PROCESSING                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0212
*   CALL BURTERM;                   /*                               */
@RF00193 BAL   @14,BURTERM                                         0212
*   BURRTNCD=MAX(BURRTNCD,RTNCODE); /*                               */
*                                                                  0213
         CR    BURRTNCD,RTNCODE                                    0213
         BNL   *+6
         LR    BURRTNCD,RTNCODE                                    0213
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER WITH CODE SET UP                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0214
*   RETURN CODE(BURRTNCD);          /*                               */
         LR    @15,BURRTNCD                                        0214
         L     @13,4(,@13)                                         0214
         L     @14,12(,@13)                                        0214
         LM    @00,@12,20(@13)                                     0214
         BR    @14                                                 0214
*   RFY                                                            0215
*     RTNCODE UNRSTD;               /*                               */
         EJECT
*                                                                  0216
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO DO INITIAL SET FOR BUR PROCESS              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0216
*BURSETUP:                          /*                               */
*   PROCEDURE;                      /*                               */
BURSETUP STM   @14,@03,@SA00002                                    0216
         STM   @06,@12,@SA00002+24                                 0216
*   DECLARE                         /*                               */
*     SETUPRC FIXED(8);             /*                               */
*   SETUPRC=ZERO;                   /*                               */
         SLR   SETUPRC,SETUPRC                                     0218
*   ASCDSIOP=ZERO;                  /*                               */
         SLR   ASCDSIOP,ASCDSIOP                                   0219
*   ACDSIOP=ZERO;                   /*                               */
         SLR   ACDSIOP,ACDSIOP                                     0220
*   HMASMSPL=''B;                   /*                               */
         XC    HMASMSPL(5),HMASMSPL                                0221
*   SPLFUNCT=SPLGMIOP;              /*                               */
         MVI   SPLFUNCT,X'03'                                      0222
*   IF BUPFUNCT=BUPREST             /* IF RESTORE                    */
*       ×BUPFUNCT=BUPCDSDL          /* OR DEL CDS ADDED ENTRY REQUEST*/
*     THEN                          /*                               */
         L     @07,@PC00001                                        0223
         CLI   BUPFUNCT(@07),4                                     0223
         BE    @RT00223                                            0223
         CLI   BUPFUNCT(@07),6                                     0223
         BNE   @RF00223                                            0223
@RT00223 DS    0H                                                  0224
*     DO;                           /*                               */
*       CALL HMASMSUB(HMASMSPL);    /* GETMAIN IOP FOR CDS LOCATES   */
         L     @15,@CV01327                                        0225
         LA    @01,@AL00225                                        0225
         BALR  @14,@15                                             0225
*       RFY                                                        0226
*         RTNCODE RSTD;             /*                               */
*       IF RTNCODE=ZERO             /*                               */
*         THEN                      /*                               */
         LTR   RTNCODE,RTNCODE                                     0227
         BNZ   @RF00227                                            0227
*         ASCDSIOP=SPLPMAD;         /*                               */
         L     ASCDSIOP,SPLPMAD                                    0228
*       ELSE                        /*                               */
*         SETUPRC=MAX(SETUPRC,RTNCODE);/* SAVE RC                    */
         B     @RC00227                                            0229
@RF00227 CR    SETUPRC,RTNCODE                                     0229
         BNL   *+6
         LR    SETUPRC,RTNCODE                                     0229
*       RFY                                                        0230
*         RTNCODE UNRSTD;           /*                               */
@RC00227 DS    0H                                                  0231
*     END;                          /*                               */
*   IF SETUPRC=ZERO                 /* GETMAIN IOP FOR CDS LOCATES   */
*     THEN                          /*                               */
@RF00223 CH    SETUPRC,@CH00271                                    0232
         BNE   @RF00232                                            0232
*     DO;                           /*                               */
*       CALL HMASMSUB(HMASMSPL);    /* GETMAIN IOP FOR CDS LOC       */
         L     @15,@CV01327                                        0234
         LA    @01,@AL00234                                        0234
         BALR  @14,@15                                             0234
*       RFY                                                        0235
*         RTNCODE RSTD;             /*                               */
*       IF RTNCODE=ZERO             /*                               */
*         THEN                      /*                               */
         LTR   RTNCODE,RTNCODE                                     0236
         BNZ   @RF00236                                            0236
*         ACDSIOP=SPLPMAD;          /*                               */
         L     ACDSIOP,SPLPMAD                                     0237
*       ELSE                        /*                               */
*         SETUPRC=MAX(SETUPRC,RTNCODE);/* SAVE RC                    */
         B     @RC00236                                            0238
@RF00236 CR    SETUPRC,RTNCODE                                     0238
         BNL   *+6
         LR    SETUPRC,RTNCODE                                     0238
*       RFY                                                        0239
*         RTNCODE UNRSTD;           /*                               */
@RC00236 DS    0H                                                  0240
*     END;                          /*                               */
*                                                                  0240
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ADDRESS OF A GTP WAS PASSED THEN INITIALIZE GTP         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0241
*   IF BUPGTPAD^=ZERO               /*                               */
*     THEN                          /*                               */
@RF00232 L     @07,@PC00001                                        0241
         ICM   @03,15,BUPGTPAD(@07)                                0241
         BZ    @RF00241                                            0241
*     DO;                           /*                               */
*       GTPKEYLN=LENGTH(RSJMAP);    /*                               */
         LA    @07,24                                              0243
         STH   @07,GTPKEYLN(,GTPPTR)                               0243
*       GTPRCDLN=LENGTH(RSJMAP);    /*                               */
         STH   @07,GTPRCDLN(,GTPPTR)                               0244
*       GTPBUFAD=ADDR(RSJMAP);      /*                               */
         LA    @07,RSJMAP                                          0245
         ST    @07,GTPBUFAD(,GTPPTR)                               0245
*       GTPFUNCT=GTPADD;            /*                               */
         MVI   GTPFUNCT(GTPPTR),X'04'                              0246
*     END;                          /*                               */
*   RETURN CODE(SETUPRC);           /*                               */
@RF00241 LR    @15,SETUPRC                                         0248
         L     @14,@SA00002                                        0248
         LM    @00,@03,@SA00002+8                                  0248
         LM    @06,@12,@SA00002+24                                 0248
         BR    @14                                                 0248
*   END BURSETUP;                   /*                               */
         EJECT
*                                                                  0250
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO RESTORE CDS ENTRIES FROM SCDS ENTRIES       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0250
*BURREST:                           /*                               */
*   PROCEDURE;                      /*                               */
BURREST  STM   @14,@12,@SA00003                                    0250
*   DECLARE                         /*                               */
*     RSTX FIXED(31);               /* LOOP THRU SCDS SYSMOD         */
*   DECLARE                         /*                               */
*     RESTRC FIXED(8);              /* PROC RETURN CODE              */
*   RFY                                                            0253
*     HMASMIOP BASED(IOPPTR);       /* IOP WITH SCDS SYSMOD          */
*                                                                  0253
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU SCDS SYSMOD SUBENTRIES AND FOR EACH SUBENTRY DO     */
*   /* PROCESSING NECESSARY TO GET SCDS BACK TO CDS                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0254
*   RESTRC=ZERO;                    /* INIT RC                       */
         SLR   RESTRC,RESTRC                                       0254
*   DO RSTX=1 BY 1 WHILE(           /* LOOP THRU SCDS SYSMOD         */
*         IOPPTFND(RSTX)^=IOPEOLST  /* TILL END                      */
*         &RESTRC<STOPPTF);         /* AND NO SERIOUS ERRORS         */
         LA    @15,1                                               0255
         ST    @15,RSTX                                            0255
         B     @DE00255                                            0255
@DL00255 DS    0H                                                  0256
*     RESTADD=OFF;                  /* NOT DELETED TYPE ENTRY        */
*                                                                  0256
         NI    RESTADD,B'11110111'                                 0256
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK SUBENTRY TYPE TO SET TYPE CODE FOR CDS ENTRY THEN TO  */
*     /* SEE IF ENTRY WAS DELETED/UPDATED OR ADDED                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0257
*     IF IOPPIND(RSTX)=IOPSAASM     /* IF UPDATED OR                 */
*         ×IOPPIND(RSTX)=IOPSUASM   /* OR DELETED ASSEM              */
*         ×IOPPIND(RSTX)=IOPSDASM   /* OR DELETED ASSEM              */
*       THEN                        /*                               */
         L     @15,RSTX                                            0257
         MH    @15,@CH00453                                        0257
         SLR   @14,@14                                             0257
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0257
         CH    @14,@CH01027                                        0257
         BE    @RT00257                                            0257
         CH    @14,@CH01047                                        0257
         BE    @RT00257                                            0257
         CH    @14,@CH00825                                        0257
         BNE   @RF00257                                            0257
@RT00257 DS    0H                                                  0258
*       SAVTYPE=IOPASM;             /* MUST DELETE                   */
         MVI   SAVTYPE,X'01'                                       0258
*     ELSE                          /*                               */
*       IF IOPPIND(RSTX)=IOPSALMD   /*                               */
*           ×IOPPIND(RSTX)=IOPSULMD /*                               */
*           ×IOPPIND(RSTX)=IOPSDLMD /*                               */
*         THEN                      /*                               */
         B     @RC00257                                            0259
@RF00257 L     @15,RSTX                                            0259
         MH    @15,@CH00453                                        0259
         SLR   @14,@14                                             0259
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0259
         CH    @14,@CH01029                                        0259
         BE    @RT00259                                            0259
         CH    @14,@CH01049                                        0259
         BE    @RT00259                                            0259
         CH    @14,@CH01039                                        0259
         BNE   @RF00259                                            0259
@RT00259 DS    0H                                                  0260
*         SAVTYPE=IOPLMD;           /*                               */
         MVI   SAVTYPE,X'02'                                       0260
*       ELSE                        /*                               */
*         IF IOPPIND(RSTX)=IOPSAMAC /*                               */
*             ×IOPPIND(RSTX)=IOPSUMAC/*                              */
*             ×IOPPIND(RSTX)=IOPSDMAC/*                              */
*           THEN                    /*                               */
         B     @RC00259                                            0261
@RF00259 L     @15,RSTX                                            0261
         MH    @15,@CH00453                                        0261
         SLR   @14,@14                                             0261
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0261
         CH    @14,@CH00725                                        0261
         BE    @RT00261                                            0261
         CH    @14,@CH01051                                        0261
         BE    @RT00261                                            0261
         CH    @14,@CH00269                                        0261
         BNE   @RF00261                                            0261
@RT00261 DS    0H                                                  0262
*           SAVTYPE=IOPMAC;         /*                               */
         MVI   SAVTYPE,X'03'                                       0262
*         ELSE                      /*                               */
*           IF IOPPIND(RSTX)=IOPSAMOD/*                              */
*               ×IOPPIND(RSTX)=IOPSUMOD/*                            */
*               ×IOPPIND(RSTX)=IOPSDMOD/*                            */
*             THEN                  /*                               */
         B     @RC00261                                            0263
@RF00261 L     @15,RSTX                                            0263
         MH    @15,@CH00453                                        0263
         SLR   @14,@14                                             0263
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0263
         CH    @14,@CH01032                                        0263
         BE    @RT00263                                            0263
         CH    @14,@CH01053                                        0263
         BE    @RT00263                                            0263
         CH    @14,@CH00701                                        0263
         BNE   @RF00263                                            0263
@RT00263 DS    0H                                                  0264
*             SAVTYPE=IOPMOD;       /*                               */
         MVI   SAVTYPE,X'05'                                       0264
*           ELSE                    /*                               */
*             IF IOPPIND(RSTX)=IOPSASRC/*                            */
*                 ×IOPPIND(RSTX)=IOPSUSRC/*                          */
*                 ×IOPPIND(RSTX)=IOPSDSRC/*                          */
*               THEN                /*                               */
         B     @RC00263                                            0265
@RF00263 L     @15,RSTX                                            0265
         MH    @15,@CH00453                                        0265
         SLR   @14,@14                                             0265
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0265
         CH    @14,@CH01034                                        0265
         BE    @RT00265                                            0265
         CH    @14,@CH01055                                        0265
         BE    @RT00265                                            0265
         CH    @14,@CH01043                                        0265
         BNE   @RF00265                                            0265
@RT00265 DS    0H                                                  0266
*               SAVTYPE=IOPSRC;     /*                               */
         MVI   SAVTYPE,X'08'                                       0266
*             ELSE                  /*                               */
*               IF IOPPIND(RSTX)=IOPSADLB/*                          */
*                   ×IOPPIND(RSTX)=IOPSUDLB/*                        */
*                   ×IOPPIND(RSTX)=IOPSDDLB/*                        */
*                 THEN              /*                               */
         B     @RC00265                                            0267
@RF00265 L     @15,RSTX                                            0267
         MH    @15,@CH00453                                        0267
         SLR   @14,@14                                             0267
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0267
         CH    @14,@CH01036                                        0267
         BE    @RT00267                                            0267
         CH    @14,@CH01057                                        0267
         BE    @RT00267                                            0267
         CH    @14,@CH01045                                        0267
         BNE   @RF00267                                            0267
@RT00267 DS    0H                                                  0268
*                 SAVTYPE=IOPDLB;   /*                               */
         MVI   SAVTYPE,X'06'                                       0268
*               ELSE                /*                               */
*                 SAVTYPE=IOPEOLST; /*                               */
         B     @RC00267                                            0269
@RF00267 MVI   SAVTYPE,X'FF'                                       0269
*     IF IOPPIND(RSTX)=IOPSAASM     /* IF ADDED TYPE ENTRY THEN      */
*         ×IOPPIND(RSTX)=IOPSALMD   /* SET SW TO CAUSE DELETION      */
*         ×IOPPIND(RSTX)=IOPSAMAC   /* OF CDS ELEMENT                */
*         ×IOPPIND(RSTX)=IOPSAMOD   /*                               */
*         ×IOPPIND(RSTX)=IOPSASRC   /*                               */
*         ×IOPPIND(RSTX)=IOPSADLB   /*                               */
*       THEN                        /*                               */
@RC00267 DS    0H                                                  0270
@RC00265 DS    0H                                                  0270
@RC00263 DS    0H                                                  0270
@RC00261 DS    0H                                                  0270
@RC00259 DS    0H                                                  0270
@RC00257 L     @15,RSTX                                            0270
         MH    @15,@CH00453                                        0270
         SLR   @14,@14                                             0270
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0270
         CH    @14,@CH01027                                        0270
         BE    @RT00270                                            0270
         CH    @14,@CH01029                                        0270
         BE    @RT00270                                            0270
         CH    @14,@CH00725                                        0270
         BE    @RT00270                                            0270
         CH    @14,@CH01032                                        0270
         BE    @RT00270                                            0270
         CH    @14,@CH01034                                        0270
         BE    @RT00270                                            0270
         CH    @14,@CH01036                                        0270
         BNE   @RF00270                                            0270
@RT00270 DS    0H                                                  0271
*       RESTADD=ON;                 /*                               */
         OI    RESTADD,B'00001000'                                 0271
*     ELSE                          /*                               */
*       IF IOPPIND(RSTX)=IOPSDASM   /* IF DELTD TYPE ENTRY THEN      */
*           ×IOPPIND(RSTX)=IOPSDLMD /* SET SW                        */
*           ×IOPPIND(RSTX)=IOPSDMAC /*                               */
*           ×IOPPIND(RSTX)=IOPSDMOD /*                               */
*           ×IOPPIND(RSTX)=IOPSDSRC /*                               */
*           ×IOPPIND(RSTX)=IOPSDDLB /*                               */
*         THEN                      /*                               */
         B     @RC00270                                            0272
@RF00270 L     @15,RSTX                                            0272
         MH    @15,@CH00453                                        0272
         SLR   @14,@14                                             0272
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0272
         CH    @14,@CH00825                                        0272
         BE    @RT00272                                            0272
         CH    @14,@CH01039                                        0272
         BE    @RT00272                                            0272
         CH    @14,@CH00269                                        0272
         BE    @RT00272                                            0272
         CH    @14,@CH00701                                        0272
         BE    @RT00272                                            0272
         CH    @14,@CH01043                                        0272
         BE    @RT00272                                            0272
         CH    @14,@CH01045                                        0272
         BNE   @RF00272                                            0272
@RT00272 DS    0H                                                  0273
*         RESTDEL=ON;               /*                               */
*                                                                  0273
         OI    RESTDEL,B'00000100'                                 0273
*     /***************************************************************/
*     /*                                                             */
*     /* IF REQUEST WAS TO RESTORE CDS FROM SCDS THEN IF UPDATED OR  */
*     /* DELETED ELEMENT THEN MUST ATTEMPT RESTORE                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0274
*     IF SAVTYPE^=IOPEOLST          /* IF ENT MUST BE RESTORED       */
*       THEN                        /*                               */
@RF00272 DS    0H                                                  0274
@RC00270 CLI   SAVTYPE,255                                         0274
         BE    @RF00274                                            0274
*       DO;                         /*                               */
*         SCDSFND=OFF;              /*                               */
*         CDSFND=OFF;               /*                               */
*         SCDSSTOW=OFF;             /*                               */
         NI    SCDSFND,B'00011111'                                 0278
*         RFY                                                      0279
*           RTNCODE RSTD;           /*                               */
*                                                                  0279
*         /***********************************************************/
*         /*                                                         */
*         /* LOCATE ELEMENT ENTRY ON SCDS IF NOT ADDED TYPE          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0280
*         IF RESTADD=OFF            /* IF NOT ADDED TYPE             */
*           THEN                    /*                               */
         TM    RESTADD,B'00001000'                                 0280
         BNZ   @RF00280                                            0280
*           DO;                     /*                               */
*             CALL BURSCDSL(RSTX,IOPPMODS(RSTX),SAVTYPE);/*          */
         MVC   @AL00001(12),@AL00282                               0282
         L     @14,RSTX                                            0282
         MH    @14,@CH00453                                        0282
         LA    @14,IOPPMODS-9(@14,IOPPTR)                          0282
         ST    @14,@AL00001+4                                      0282
         LA    @01,@AL00001                                        0282
         BAL   @14,BURSCDSL                                        0282
*             IF RTNCODE=ZERO       /* IF ENTRY FOUND                */
*               THEN                /*                               */
         LTR   RTNCODE,RTNCODE                                     0283
         BNZ   @RF00283                                            0283
*               SCDSFND=ON;         /*                               */
         OI    SCDSFND,B'10000000'                                 0284
*             ELSE                  /*                               */
*               RESTRC=MAX(RESTRC,RTNCODE);/* SAVE RC                */
         B     @RC00283                                            0285
@RF00283 CR    RESTRC,RTNCODE                                      0285
         BNL   *+6
         LR    RESTRC,RTNCODE                                      0285
*           END;                    /*                               */
*                                                                  0286
@RC00283 DS    0H                                                  0287
*         /***********************************************************/
*         /*                                                         */
*         /* LOCATE ELEMENT ENTRY ON CDS IF SCDS LOCATE OK           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0287
*         IF RESTRC<STOPPTF         /*                               */
*           THEN                    /*                               */
@RF00280 CH    RESTRC,@CH00037                                     0287
         BNL   @RF00287                                            0287
*           DO;                     /*                               */
*             CALL BURCDSL(RSTX,IOPPMODS(RSTX),SAVTYPE);/*           */
         MVC   @AL00001(12),@AL00289                               0289
         L     @14,RSTX                                            0289
         MH    @14,@CH00453                                        0289
         LA    @14,IOPPMODS-9(@14,IOPPTR)                          0289
         ST    @14,@AL00001+4                                      0289
         LA    @01,@AL00001                                        0289
         BAL   @14,BURCDSL                                         0289
*             IF RTNCODE=ZERO       /* IF ENTRY FOUND                */
*               THEN                /*                               */
         LTR   RTNCODE,RTNCODE                                     0290
         BNZ   @RF00290                                            0290
*               CDSFND=ON;          /*                               */
         OI    CDSFND,B'01000000'                                  0291
*             ELSE                  /*                               */
*               IF RTNCODE=IOPNOTFD /* ENTRY NOT FOUND               */
*                   &RESTADD=OFF    /* ... ENTRY NOT TO BE DELETED   */
*                   &RESTDEL=OFF    /* SHOULD NOT FIND DELETED ENTRY */
*                 THEN                                             0292
         B     @RC00290                                            0292
@RF00290 LA    @14,4                                               0292
         CR    RTNCODE,@14                                         0292
         BNE   @RF00292                                            0292
         TM    RESTADD,B'00001100'                                 0292
         BNZ   @RF00292                                            0292
*                 RESTRC=MAX(RESTRC,PTFWARN);/* WARNING CONDTION     */
         CR    RESTRC,@14                                          0293
         BNL   *+6
         LR    RESTRC,@14                                          0293
*               ELSE                                               0294
*                 IF RTNCODE>IOPNOTFD/* TERMINATING ERROR            */
*                   THEN                                           0294
         B     @RC00292                                            0294
@RF00292 CH    RTNCODE,@CH00056                                    0294
         BNH   @RF00294                                            0294
*                   RESTRC=MAX(RESTRC,RTNCODE);/* SAVE RC            */
         CR    RESTRC,RTNCODE                                      0295
         BNL   *+6
         LR    RESTRC,RTNCODE                                      0295
*           END;                    /*                               */
*                                                                  0296
@RF00294 DS    0H                                                  0296
@RC00292 DS    0H                                                  0296
@RC00290 DS    0H                                                  0297
*         /***********************************************************/
*         /*                                                         */
*         /* IF SCDS AND CDS ENTRY LOCATED OK THEN CHECK TO SEE IF   */
*         /* CDS HAS BEEN UPDATED SINCE SCDS ENTRY SAVED AND THEN    */
*         /* PROCESS BASED ON WHEN LAST SAVED OCCURRED               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0297
*         IF RESTRC<STOPPTF         /* IF NO ERRORS IN LOCATES       */
*           THEN                    /*                               */
@RF00287 CH    RESTRC,@CH00037                                     0297
         BNL   @RF00297                                            0297
*           DO;                     /*                               */
*             IF RESTDEL=ON&SCDSFND=ON/* IF DELETED TYPE AND SCDS    */
*               THEN                /* FOUND THEN                    */
         TM    RESTDEL,B'10000100'                                 0299
         BNO   @RF00299                                            0299
*               IF CDSFND=ON        /* IF CDS ENTRY FOUND            */
*                 THEN              /* THEN ERROR- MUST HAVE BEEN    */
         TM    CDSFND,B'01000000'                                  0300
         BNO   @RF00300                                            0300
*                 DO;               /*                               */
*                   CALL BURSCDNG;  /* HIT BY SUBSEQUENT SYSMOD      */
         BAL   @14,BURSCDNG                                        0302
*                   RESTRC=MAX(RESTRC,RTNCODE);/*                    */
         CR    RESTRC,RTNCODE                                      0303
         BNL   *+6
         LR    RESTRC,RTNCODE                                      0303
*                 END;              /*                               */
*               ELSE                /* IF NOT FOUND THEN OK TO       */
*                 SCDSSTOW=ON;      /* COPY SCDS ENTRY BACK          */
         B     @RC00300                                            0305
@RF00300 OI    SCDSSTOW,B'00100000'                                0305
*             ELSE                  /*                               */
*               IF(SCDSFND=ON×RESTADD=ON)/* EITHER SCDS FND OR ADD   */
*                   &CDSFND=ON      /* AND CDS FOUND                 */
*                 THEN              /*                               */
         B     @RC00299                                            0306
@RF00299 TM    SCDSFND,B'10001000'                                 0306
         BZ    @RF00306                                            0306
         TM    CDSFND,B'01000000'                                  0306
         BNO   @RF00306                                            0306
*                 DO;               /*                               */
*                   IF(ACDSIOP->IOPTYPE=IOPASM/* IF ASSEMBLY         */
*                       &ACDSIOP->IOPABUPT=IOPNAM17)/* AND CDS ASM 0308
*                                      WAS LAST SAVED BY SYSMOD IN 0308
*                                      PROCESS                       */
*                       ×           /*                               */
*                       (ACDSIOP->IOPTYPE^=IOPASM/* IF NOT ASSEMBLY  */
*                       &ACDSIOP->IOPBUSMD=IOPNAM17)/* AND CDS ENT 0308
*                                      WAS LAST SAVED BY SYSMOD IN 0308
*                                      PROCESS                       */
*                       ×           /*                               */
*                       (SCDSFND=OFF&RESTADD=ON)/* OR SCDS NOT FOUND
*                                      BUT ENTRY WAS ADDED TYPE      */
*                     THEN          /*                               */
         CLI   IOPTYPE(ACDSIOP),1                                  0308
         BNE   @GL00027                                            0308
         CLC   IOPABUPT(7,ACDSIOP),IOPNAM17(IOPPTR)                0308
         BE    @RT00308                                            0308
@GL00027 CLI   IOPTYPE(ACDSIOP),1                                  0308
         BE    @GL00026                                            0308
         CLC   IOPBUSMD(7,ACDSIOP),IOPNAM17(IOPPTR)                0308
         BE    @RT00308                                            0308
@GL00026 TM    RESTADD,B'00001000'                                 0308
         BNO   @RF00308                                            0308
         TM    SCDSFND,B'10000000'                                 0308
         BNZ   @RF00308                                            0308
@RT00308 DS    0H                                                  0309
*                     DO;           /*                               */
*                       IF SCDSFND=ON/* IF SCDS FOUND                */
*                         THEN      /*                               */
         TM    SCDSFND,B'10000000'                                 0310
         BNO   @RF00310                                            0310
*                         SCDSSTOW=ON;/* THEN COPY ENTRY TO CDS      */
         OI    SCDSSTOW,B'00100000'                                0311
*                       CALL BURSCDOK;/* PROCESS IF MATCH FOUND      */
@RF00310 BAL   @14,BURSCDOK                                        0312
*                     END;          /*                               */
*                   ELSE            /*                               */
*                     CALL BURSCDNG;/* PROCESS IF NOT MATCH          */
         B     @RC00308                                            0314
@RF00308 BAL   @14,BURSCDNG                                        0314
*                   RESTRC=MAX(RESTRC,RTNCODE);/* SAVE RC            */
@RC00308 CR    RESTRC,RTNCODE                                      0315
         BNL   *+6
         LR    RESTRC,RTNCODE                                      0315
*                 END;              /*                               */
*           END;                    /*                               */
*                                                                  0317
@RF00306 DS    0H                                                  0317
@RC00299 DS    0H                                                  0318
*         /***********************************************************/
*         /*                                                         */
*         /* NOW DO STOW TO UPDATE CDS ENTRY                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0318
*         IF RESTRC<STOPPTF         /* IF NO SERIOUS ERRORS          */
*             &SCDSFND=ON           /* AND SCDS ENTRY FOUND          */
*             &SCDSSTOW=ON          /* AND SCDS TO BE COPIED         */
*           THEN                    /*                               */
@RF00297 CH    RESTRC,@CH00037                                     0318
         BNL   @RF00318                                            0318
         TM    SCDSFND,B'10100000'                                 0318
         BNO   @RF00318                                            0318
*           DO;                     /*                               */
*             CALL BURCOPY(IOPPMODS(RSTX),SAVTYPE);/*                */
         L     @14,RSTX                                            0320
         MH    @14,@CH00453                                        0320
         LA    @14,IOPPMODS-9(@14,IOPPTR)                          0320
         ST    @14,@AL00001                                        0320
         LA    @14,SAVTYPE                                         0320
         ST    @14,@AL00001+4                                      0320
         LA    @01,@AL00001                                        0320
         BAL   @14,BURCOPY                                         0320
*             RESTRC=MAX(RESTRC,RTNCODE);/* SAVE RC                  */
         CR    RESTRC,RTNCODE                                      0321
         BNL   *+6
         LR    RESTRC,RTNCODE                                      0321
*           END;                    /*                               */
*         RFY                                                      0323
*           RTNCODE UNRSTD;         /*                               */
@RF00318 DS    0H                                                  0324
*       END;                        /* END MUST RESTORE              */
*   END;                            /* END SYSMOD SUBENTRY LOOP      */
@RF00274 LA    @15,1                                               0325
         AL    @15,RSTX                                            0325
         ST    @15,RSTX                                            0325
@DE00255 L     @15,RSTX                                            0325
         MH    @15,@CH00453                                        0325
         SLR   @14,@14                                             0325
         IC    @14,IOPPTFND-9(@15,IOPPTR)                          0325
         CH    @14,@CH00642                                        0325
         BE    @DC00255                                            0325
         CH    RESTRC,@CH00037                                     0325
         BL    @DL00255                                            0325
@DC00255 DS    0H                                                  0326
*   RETURN CODE(RESTRC);            /*                               */
         LR    @15,RESTRC                                          0326
         L     @14,@SA00003                                        0326
         LM    @00,@12,@SA00003+8                                  0326
         BR    @14                                                 0326
*   END BURREST;                    /*                               */
         EJECT
*                                                                  0328
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO LOCATE SCDS ELEMENT ENTRY                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0328
*BURSCDSL:                          /*                               */
*   PROCEDURE(SCDLOCX,SCDLOCNM,SCDLOCTP);/*                          */
BURSCDSL STM   @14,@12,@SA00004                                    0328
         MVC   @PC00004(12),0(@01)                                 0328
*   DECLARE                         /*                               */
*     SCDLOCX FIXED(31),            /* OFFSET INTO PTF LIST          */
*     SCDLOCNM CHAR(8),             /* ELEMENT NAME                  */
*     SCDLOCTP FIXED(8);            /* ELEMENT TYPE CODE             */
*   DECLARE                         /*                               */
*     SCDLOCRC FIXED(8);            /*                               */
*                                                                  0330
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE ENTRY ON SCDS                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*   RFY                                                            0331
*     HMASMIOP BASED(ASCDSIOP);     /* IOP FOR SCDS ELEMENT LOCATE   */
*   SCDLOCRC=ZERO;                  /*                               */
         SLR   SCDLOCRC,SCDLOCRC                                   0332
*   IOPNAME=SCDLOCNM;               /*                               */
         L     @04,@PC00004+4                                      0333
         MVC   IOPNAME(8,ASCDSIOP),SCDLOCNM(@04)                   0333
*   IOPPTFNM=BUPSYSMD;              /*                               */
         L     @04,@PC00001                                        0334
         MVC   IOPPTFNM(7,ASCDSIOP),BUPSYSMD(@04)                  0334
*   IOPSEQNO=SCDLOCX;               /*                               */
         L     @04,@PC00004                                        0335
         MVC   IOPSEQNO(2,ASCDSIOP),SCDLOCX+2(@04)                 0335
*   IOPTYPE=SCDLOCTP;               /*                               */
         L     @04,@PC00004+8                                      0336
         MVC   IOPTYPE(1,ASCDSIOP),SCDLOCTP(@04)                   0336
*   IOPDSID=IOPSCDS;                /*                               */
         MVI   IOPDSID(ASCDSIOP),X'21'                             0337
*   IOPFUNCT=IOPLOC;                /*                               */
         MVI   IOPFUNCT(ASCDSIOP),X'03'                            0338
*   CALL HMASMIO(HMASMIOP);         /*                               */
         ST    ASCDSIOP,@AL00001                                   0339
         L     @15,@CV01324                                        0339
         LA    @01,@AL00001                                        0339
         BALR  @14,@15                                             0339
*   SCDLOCRC=MAX(SCDLOCRC,IOPRETRN);/*                               */
         SLR   @04,@04                                             0340
         IC    @04,IOPRETRN(,ASCDSIOP)                             0340
         CR    SCDLOCRC,@04                                        0340
         BNL   *+6
         LR    SCDLOCRC,@04                                        0340
*   IF IOPRETRN=IOPNTFND            /* IF NOT FOUND                  */
*     THEN                          /*                               */
         CLI   IOPRETRN(ASCDSIOP),4                                0341
         BNE   @RF00341                                            0341
*     DO;                           /*                               */
*       MGPCLEAR=''B;               /* CLEAR MSG PARM                */
         XC    MGPCLEAR(6),MGPCLEAR                                0343
*       MGPMGNO1=HMA404I;           /* XXXXXXXX XXXXXXXX TO BE     0344
*                                      RESTORED TO SMPCDS FROM     0344
*                                      SMPSCDS FOR SYSMOD XXXXXXX NOT
*                                      FOUND ON XXXXXXXX             */
         MVC   MGPMGNO1(2),@CH01331                                0344
*       MGPTYPE=MGPWARN;            /*                               */
         MVI   MGPTYPE,X'02'                                       0345
*       MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* ENTRY TYPE            */
         SLR   @04,@04                                             0346
         IC    @04,IOPTYPE(,ASCDSIOP)                              0346
         SLA   @04,3                                               0346
         L     @03,CCATPAD(,CCAPTR)                                0346
         AL    @03,@CF01461                                        0346
         LA    @04,CCATYPEA(@04,@03)                               0346
         ST    @04,MGPVARPT                                        0346
*       MGPVARPT(2)=ADDR(SCDLOCNM); /* NAME                          */
         L     @04,@PC00004+4                                      0347
         ST    @04,MGPVARPT+4                                      0347
*       MGPVARPT(3)=ADDR(BUPSYSMD); /* SYSMOD NUMBER                 */
         L     @04,@PC00001                                        0348
         LA    @04,BUPSYSMD(,@04)                                  0348
         ST    @04,MGPVARPT+8                                      0348
*       MGPVARPT(4)=ADDR(CCADSIDA(IOPSCDS));/* DATASET               */
         L     @04,CCADSAD(,CCAPTR)                                0349
         LA    @04,CCADSIDA+256(,@04)                              0349
         ST    @04,MGPVARPT+12                                     0349
*       CALL HMASMMSG(HMASMMGP);    /*                               */
         L     @15,@CV01325                                        0350
         LA    @01,@AL00350                                        0350
         BALR  @14,@15                                             0350
*     END;                          /*                               */
*   RETURN CODE(SCDLOCRC);          /*                               */
@RF00341 LR    @15,SCDLOCRC                                        0352
         L     @14,@SA00004                                        0352
         LM    @00,@12,@SA00004+8                                  0352
         BR    @14                                                 0352
*   END BURSCDSL;                   /*                               */
         EJECT
*                                                                  0354
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO LOCATE CDS ENTRY                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0354
*BURCDSL:                           /*                               */
*   PROCEDURE(CDSLOCX,CDSLOCNM,CDSLOCTP);/*                          */
BURCDSL  STM   @14,@12,@SA00005                                    0354
         MVC   @PC00005(12),0(@01)                                 0354
*   DECLARE                         /*                               */
*     CDSLOCX FIXED(31),            /* OFFSET INTO PTF LIST          */
*     CDSLOCNM CHAR(8),             /* ELEMENT NAME                  */
*     CDSLOCTP FIXED(8);            /* ELEMENT TYPE                  */
*   DECLARE                         /*                               */
*     CDSLOCRC FIXED(8);            /*                               */
*                                                                  0356
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE ENTRY ON CDS                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0357
*   RFY                                                            0357
*     HMASMIOP BASED(ACDSIOP);      /* IOP FOR CDS ELEMENT LOCATE    */
*   CDSLOCRC=ZERO;                  /*                               */
         SLR   CDSLOCRC,CDSLOCRC                                   0358
*   IOPNAME=CDSLOCNM;               /* ELEMENT NAME                  */
         L     @05,@PC00005+4                                      0359
         MVC   IOPNAME(8,ACDSIOP),CDSLOCNM(@05)                    0359
*   IOPTYPE=CDSLOCTP;               /*                               */
         L     @05,@PC00005+8                                      0360
         MVC   IOPTYPE(1,ACDSIOP),CDSLOCTP(@05)                    0360
*   IOPDSID=IOPCDS;                 /*                               */
         MVI   IOPDSID(ACDSIOP),X'02'                              0361
*   IOPFUNCT=IOPLOC;                /*                               */
         MVI   IOPFUNCT(ACDSIOP),X'03'                             0362
*   CALL HMASMIO(HMASMIOP);         /*                               */
         ST    ACDSIOP,@AL00001                                    0363
         L     @15,@CV01324                                        0363
         LA    @01,@AL00001                                        0363
         BALR  @14,@15                                             0363
*   CDSLOCRC=MAX(CDSLOCRC,IOPRETRN);/*                               */
         SLR   @05,@05                                             0364
         IC    @05,IOPRETRN(,ACDSIOP)                              0364
         CR    CDSLOCRC,@05                                        0364
         BNL   *+6
         LR    CDSLOCRC,@05                                        0364
*   IF IOPRETRN=IOPNTFND            /* IF NOT FOUND                  */
*       &RESTADD=OFF                /* AND NOT TO BE DELETED         */
*       &RESTDEL=OFF                /* AND NOT DELETED               */
*     THEN                          /*                               */
         CLI   IOPRETRN(ACDSIOP),4                                 0365
         BNE   @RF00365                                            0365
         TM    RESTADD,B'00001100'                                 0365
         BNZ   @RF00365                                            0365
*     DO;                           /* ISSUE WARNING MESSAGE         */
*       MGPCLEAR=''B;               /* CLEAR MSG PARM                */
         XC    MGPCLEAR(6),MGPCLEAR                                0367
*       MGPMGNO1=HMA404I;           /* XXXXXXXX XXXXXXXX TO BE     0368
*                                      RESTORED TO SMPCDS FROM     0368
*                                      SMPSCDS NOT FOUND ON XXXXXXXX */
         MVC   MGPMGNO1(2),@CH01331                                0368
*       MGPTYPE=MGPWARN;            /*                               */
         MVI   MGPTYPE,X'02'                                       0369
*       MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* ENTRY TYPE            */
         SLR   @05,@05                                             0370
         IC    @05,IOPTYPE(,ACDSIOP)                               0370
         SLA   @05,3                                               0370
         L     @03,CCATPAD(,CCAPTR)                                0370
         AL    @03,@CF01461                                        0370
         LA    @05,CCATYPEA(@05,@03)                               0370
         ST    @05,MGPVARPT                                        0370
*       MGPVARPT(2)=ADDR(CDSLOCNM); /* ENTRY NAME                    */
         L     @05,@PC00005+4                                      0371
         ST    @05,MGPVARPT+4                                      0371
*       MGPVARPT(3)=ADDR(BUPSYSMD); /* SYSMOD NUMBER                 */
         L     @05,@PC00001                                        0372
         LA    @05,BUPSYSMD(,@05)                                  0372
         ST    @05,MGPVARPT+8                                      0372
*       MGPVARPT(4)=ADDR(CCADSIDA(IOPCDS));/* DATASET                */
         L     @05,CCADSAD(,CCAPTR)                                0373
         LA    @05,CCADSIDA+8(,@05)                                0373
         ST    @05,MGPVARPT+12                                     0373
*       CALL HMASMMSG(HMASMMGP);    /*                               */
         L     @15,@CV01325                                        0374
         LA    @01,@AL00374                                        0374
         BALR  @14,@15                                             0374
*     END;                          /*                               */
*   RETURN CODE(CDSLOCRC);          /*                               */
@RF00365 LR    @15,CDSLOCRC                                        0376
         L     @14,@SA00005                                        0376
         LM    @00,@12,@SA00005+8                                  0376
         BR    @14                                                 0376
*   END BURCDSL;                    /*                               */
         EJECT
*                                                                  0378
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO BUILD GTA FILE IF BOTH CDS AND SCDS ELEMENTS ARE   */
*   /* FOUND AND SYSMOD IN BOTH MATCH                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0378
*BURSCDOK:                          /*                               */
*   PROCEDURE;                      /*                               */
BURSCDOK STM   @14,@12,@SA00006                                    0378
*   DECLARE                         /*                               */
*     OKSCDSX FIXED(31),            /* INDEX THRU SCDS               */
*     OKCDSX FIXED(31);             /* INDEX THRU CDS                */
*   RFY                                                            0380
*     HMASMIOP BASED(ACDSIOP);      /* IOP WITH CDS ENTRY            */
*   RFY                                                            0381
*     HMASMGTP BASED(BUPGTPAD);     /*                               */
*                                                                  0381
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MACRO TYPE ENTRY THEN BUID GTA FILE WITH ASSEMBLIES IN THE */
*   /* EXISTING CDS ENTRY BUT NOT IN THE SCDS ENTRY                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0382
*   GTPRETRN=GTPGOOD;               /*                               */
         L     @15,@PC00001                                        0382
         L     @01,BUPGTPAD(,@15)                                  0382
         MVI   GTPRETRN(@01),X'00'                                 0382
*   IF IOPTYPE=IOPMAC               /* IF MACRO                      */
*     THEN                          /*                               */
         CLI   IOPTYPE(ACDSIOP),3                                  0383
         BNE   @RF00383                                            0383
*     DO;                           /*                               */
*       RSJTYPE=RSJASM;             /*                               */
         MVI   RSJTYPE,X'01'                                       0385
*       RSJSNAME=IOPNAME;           /* MACRO NAME                    */
         MVC   RSJSNAME(8),IOPNAME(ACDSIOP)                        0386
*       RSJSMD=BUPSYSMD;            /* SYSMOD NUMBER                 */
         MVC   RSJSMD(7),BUPSYSMD(@15)                             0387
*       IF SCDSFND=OFF              /* IF CDS ENTRY ADDED THEN NO    */
*         THEN                      /* SCDS ENTRY CREATED SO SET     */
         TM    SCDSFND,B'10000000'                                 0388
         BNZ   @RF00388                                            0388
*         ASCDSIOP->IOPMACND(1)=IOPEOLST;/* SCDS END LIST NOW        */
*                                                                  0389
         MVI   IOPMACND(ASCDSIOP),X'FF'                            0389
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK ALL ASSEM ENTRIES IN CDS MAC ENTRY                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0390
*       DO OKCDSX=1 BY 1 WHILE(     /* LOOP THRU CDS MAC ENTRY       */
*             IOPMACND(OKCDSX)^=IOPEOLST/* TILL END                  */
*             &GTPRETRN=GTPGOOD);   /* OR ERR ADDING OT FILE         */
@RF00388 LA    OKCDSX,1                                            0390
         B     @DE00390                                            0390
@DL00390 DS    0H                                                  0391
*         IF IOPMCIND(OKCDSX)=IOPMASMS/* IF ASSEMBLY SUBENTRY        */
*           THEN                    /*                               */
         LA    @03,1                                               0391
         LR    @15,OKCDSX                                          0391
         MH    @15,@CH00453                                        0391
         SLR   @14,@14                                             0391
         IC    @14,IOPMCIND-9(@15,ACDSIOP)                         0391
         CR    @03,@14                                             0391
         BNE   @RF00391                                            0391
*           DO;                     /*                               */
*                                                                  0392
*             /*******************************************************/
*             /*                                                     */
*             /* IF ASSEM NOT IN SCDS MAC ENTRY ADD MAC/ASSEM RCD TO */
*             /* GTA FILE                                            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0393
*             DO OKSCDSX=1 BY 1 WHILE(/* LOOP THRU SCDS MAC ENTRY    */
*                   ASCDSIOP->IOPMACND(OKSCDSX)^=IOPEOLST/* TILL END */
*                   &ASCDSIOP->IOPMCENT(OKSCDSX)^=IOPMCENT(OKCDSX));
         LA    @15,1                                               0393
         LR    OKSCDSX,@15                                         0393
         B     @DE00393                                            0393
@DL00393 DS    0H                                                  0394
*             END;                  /* OR MATCH FOUND                */
         AH    OKSCDSX,@CH00042                                    0394
@DE00393 LA    @15,9                                               0394
         LR    @01,OKSCDSX                                         0394
         MR    @00,@15                                             0394
         SLR   @00,@00                                             0394
         IC    @00,IOPMACND-9(@01,ASCDSIOP)                        0394
         CH    @00,@CH00642                                        0394
         BE    @DC00393                                            0394
         MR    @14,OKCDSX                                          0394
         ALR   @01,ASCDSIOP                                        0394
         ALR   @15,ACDSIOP                                         0394
         CLC   IOPMCENT-9(9,@01),IOPMCENT-9(@15)                   0394
         BNE   @DL00393                                            0394
@DC00393 DS    0H                                                  0395
*             IF ASCDSIOP->IOPMACND(OKSCDSX)=IOPEOLST/* IF ASM NOT   */
*               THEN                /* FOUND                         */
         LA    @15,9                                               0395
         LR    @01,OKSCDSX                                         0395
         MR    @00,@15                                             0395
         SLR   @00,@00                                             0395
         IC    @00,IOPMACND-9(@01,ASCDSIOP)                        0395
         CH    @00,@CH00642                                        0395
         BNE   @RF00395                                            0395
*               DO;                 /*                               */
*                 RSJPNAME=IOPMCASM(OKCDSX);/* ASSEM NAME            */
         MR    @14,OKCDSX                                          0397
         ALR   @15,ACDSIOP                                         0397
         MVC   RSJPNAME(8),IOPMCASM-9(@15)                         0397
*                 CALL HMASMGTA(HMASMGTP);/* ADD RCD TO FILE         */
         L     @03,@PC00001                                        0398
         L     @03,BUPGTPAD(,@03)                                  0398
         ST    @03,@AL00001                                        0398
         L     @15,@CV01326                                        0398
         LA    @01,@AL00001                                        0398
         BALR  @14,@15                                             0398
*               END;                /*                               */
*           END;                    /* END ASSEMBLY SUBENTRY         */
@RF00395 DS    0H                                                  0401
*       END;                        /* END LOOP THRU MAC ENTRY       */
@RF00391 AH    OKCDSX,@CH00042                                     0401
@DE00390 LR    @03,OKCDSX                                          0401
         MH    @03,@CH00453                                        0401
         SLR   @15,@15                                             0401
         IC    @15,IOPMACND-9(@03,ACDSIOP)                         0401
         CH    @15,@CH00642                                        0401
         BE    @DC00390                                            0401
         L     @03,@PC00001                                        0401
         L     @03,BUPGTPAD(,@03)                                  0401
         CLI   GTPRETRN(@03),0                                     0401
         BE    @DL00390                                            0401
@DC00390 DS    0H                                                  0402
*     END;                          /* END MAC TYPE ENTRY            */
*                                                                  0403
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MOD TYPE ENTRY THEN BUID GTA FILE WITH LMODS IN THE        */
*   /* EXISTING CDS ENTRY BUT NOT IN THE SCDS ENTRY                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*   IF IOPTYPE=IOPMOD               /* IF MOD                        */
*     THEN                          /*                               */
@RF00383 CLI   IOPTYPE(ACDSIOP),5                                  0403
         BNE   @RF00403                                            0403
*     DO;                           /*                               */
*       RSJTYPE=RSJLMD;             /*                               */
         MVI   RSJTYPE,X'02'                                       0405
*       RSJSNAME=IOPNAME;           /* MODULE NAME                   */
         MVC   RSJSNAME(8),IOPNAME(ACDSIOP)                        0406
*       RSJSMD=BUPSYSMD;            /* SYSMOD NUMBER                 */
         L     @15,@PC00001                                        0407
         MVC   RSJSMD(7),BUPSYSMD(@15)                             0407
*       IF SCDSFND=OFF              /* IF CDS ENTRY ADDED THEN NO    */
*         THEN                      /* SCDS ENTRY CREATED SO SET     */
         TM    SCDSFND,B'10000000'                                 0408
         BNZ   @RF00408                                            0408
*         ASCDSIOP->IOPMODND(1)=IOPEOLST;/* SCDS END LIST NOW        */
*                                                                  0409
         MVI   IOPMODND(ASCDSIOP),X'FF'                            0409
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK ALL LMOD ENTRIES IN CDS MOD ENTRY                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0410
*       DO OKCDSX=1 BY 1 WHILE(     /* LOOP THRU CDS MOD ENTRY       */
*             IOPMODND(OKCDSX)^=IOPEOLST/* TILL END                  */
*             &GTPRETRN=GTPGOOD);   /* OR ERR ADDING TO FILE         */
@RF00408 LA    OKCDSX,1                                            0410
         B     @DE00410                                            0410
@DL00410 DS    0H                                                  0411
*         IF IOPMDIND(OKCDSX)=IOPMDLMD/* IF LMOD SUBENTRY            */
*           THEN                    /*                               */
         LA    @03,1                                               0411
         LR    @15,OKCDSX                                          0411
         MH    @15,@CH00453                                        0411
         SLR   @14,@14                                             0411
         IC    @14,IOPMDIND-9(@15,ACDSIOP)                         0411
         CR    @03,@14                                             0411
         BNE   @RF00411                                            0411
*           DO;                     /*                               */
*                                                                  0412
*             /*******************************************************/
*             /*                                                     */
*             /* IF LMOD NOT IN SCDS MOD ENTRY ADD LMOD/MOD RCD TO   */
*             /* GTA FILE                                            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0413
*             DO OKSCDSX=1 BY 1 WHILE(/* LOOP THRU SCDS MOD ENTRY    */
*                   ASCDSIOP->IOPMODND(OKSCDSX)^=IOPEOLST/* TILL END */
*                   &ASCDSIOP->IOPMNTRY(OKSCDSX)^=IOPMNTRY(OKCDSX));
         LA    @15,1                                               0413
         LR    OKSCDSX,@15                                         0413
         B     @DE00413                                            0413
@DL00413 DS    0H                                                  0414
*             END;                  /* OR MATCH FOUND                */
         AH    OKSCDSX,@CH00042                                    0414
@DE00413 LA    @15,9                                               0414
         LR    @01,OKSCDSX                                         0414
         MR    @00,@15                                             0414
         SLR   @00,@00                                             0414
         IC    @00,IOPMODND-9(@01,ASCDSIOP)                        0414
         CH    @00,@CH00642                                        0414
         BE    @DC00413                                            0414
         MR    @14,OKCDSX                                          0414
         ALR   @01,ASCDSIOP                                        0414
         ALR   @15,ACDSIOP                                         0414
         CLC   IOPMNTRY-9(9,@01),IOPMNTRY-9(@15)                   0414
         BNE   @DL00413                                            0414
@DC00413 DS    0H                                                  0415
*             IF ASCDSIOP->IOPMODND(OKSCDSX)=IOPEOLST/* IF LMOD NOT  */
*               THEN                /* FOUND                         */
         LA    @15,9                                               0415
         LR    @01,OKSCDSX                                         0415
         MR    @00,@15                                             0415
         SLR   @00,@00                                             0415
         IC    @00,IOPMODND-9(@01,ASCDSIOP)                        0415
         CH    @00,@CH00642                                        0415
         BNE   @RF00415                                            0415
*               DO;                 /*                               */
*                 RSJPNAME=IOPLMODS(OKCDSX);/* LMOD NAME             */
         MR    @14,OKCDSX                                          0417
         ALR   @15,ACDSIOP                                         0417
         MVC   RSJPNAME(8),IOPLMODS-9(@15)                         0417
*                 CALL HMASMGTA(HMASMGTP);/* ADD RCD TO FILE         */
         L     @03,@PC00001                                        0418
         L     @03,BUPGTPAD(,@03)                                  0418
         ST    @03,@AL00001                                        0418
         L     @15,@CV01326                                        0418
         LA    @01,@AL00001                                        0418
         BALR  @14,@15                                             0418
*               END;                /*                               */
*           END;                    /* END LMOD SUBENTRY             */
@RF00415 DS    0H                                                  0421
*       END;                        /* END LOOP THRU MOD ENTRY       */
@RF00411 AH    OKCDSX,@CH00042                                     0421
@DE00410 LR    @03,OKCDSX                                          0421
         MH    @03,@CH00453                                        0421
         SLR   @15,@15                                             0421
         IC    @15,IOPMODND-9(@03,ACDSIOP)                         0421
         CH    @15,@CH00642                                        0421
         BE    @DC00410                                            0421
         L     @03,@PC00001                                        0421
         L     @03,BUPGTPAD(,@03)                                  0421
         CLI   GTPRETRN(@03),0                                     0421
         BE    @DL00410                                            0421
@DC00410 DS    0H                                                  0422
*     END;                          /* END MOD TYPE ENTRY            */
*   RETURN CODE(GTPRETRN);          /*                               */
@RF00403 L     @14,@PC00001                                        0423
         L     @01,BUPGTPAD(,@14)                                  0423
         SLR   @15,@15                                             0423
         IC    @15,GTPRETRN(,@01)                                  0423
         L     @14,@SA00006                                        0423
         LM    @00,@12,@SA00006+8                                  0423
         BR    @14                                                 0423
*   END BURSCDOK;                   /*                               */
         EJECT
*                                                                  0425
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO BUILD GTA FILE IF BOTH CDS AND SCDS ELEMENTS ARE   */
*   /* FOUND BUT SYSMOD IN BOTH DO NOT MATCH                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0425
*BURSCDNG:                          /*                               */
*   PROCEDURE;                      /*                               */
BURSCDNG STM   @14,@12,@SA00007                                    0425
*   DECLARE                         /*                               */
*     NGSCDSX FIXED(31),            /*                               */
*     NGCDSX FIXED(31);             /*                               */
*   DECLARE                         /*                               */
*     SCDNGRC FIXED(8);             /*                               */
*   RFY                                                            0428
*     HMASMIOP BASED(ACDSIOP);      /* IOP WITH CDS ENTRY            */
*   RFY                                                            0429
*     HMASMGTP BASED(BUPGTPAD);     /*                               */
*   SCDNGRC=ZERO;                   /*                               */
*                                                                  0430
         SLR   SCDNGRC,SCDNGRC                                     0430
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE WARNING MESSAGE INDICATING ENTRY FOUND ON CDS BUT       */
*   /* MODIFIED BY SUBSEQUENT SYSMOD                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0431
*   MGPCLEAR=''B;                   /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0431
*   MGPMGNO1=HMA411I;               /* XXXXXXXX XXXXXXXX TO BE     0432
*                                      RESTORED FOR SYSMOD XXXXXXX 0432
*                                      HAS BEEN MODIFIED BY        0432
*                                      SUBSEQUENT SYSMOD XXXXXXX     */
         MVC   MGPMGNO1(2),@CH01333                                0432
*   MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE                      */
         SLR   @07,@07                                             0433
         IC    @07,IOPTYPE(,ACDSIOP)                               0433
         SLA   @07,3                                               0433
         L     @01,CCATPAD(,CCAPTR)                                0433
         AL    @01,@CF01461                                        0433
         LA    @07,CCATYPEA(@07,@01)                               0433
         ST    @07,MGPVARPT                                        0433
*   MGPVARPT(2)=ADDR(IOPNAME);      /*                               */
         LA    @07,IOPNAME(,ACDSIOP)                               0434
         ST    @07,MGPVARPT+4                                      0434
*   MGPVARPT(3)=ADDR(BUPSYSMD);     /* SYSMOD                        */
         L     @07,@PC00001                                        0435
         LA    @07,BUPSYSMD(,@07)                                  0435
         ST    @07,MGPVARPT+8                                      0435
*   IF IOPTYPE=IOPASM               /*                               */
*     THEN                          /*                               */
         CLI   IOPTYPE(ACDSIOP),1                                  0436
         BNE   @RF00436                                            0436
*     MGPVARPT(4)=ADDR(ACDSIOP->IOPABUPT);/*                         */
         LA    @07,IOPABUPT(,ACDSIOP)                              0437
         ST    @07,MGPVARPT+12                                     0437
*   ELSE                            /*                               */
*     MGPVARPT(4)=ADDR(ACDSIOP->IOPBUSMD);/*                         */
         B     @RC00436                                            0438
@RF00436 LA    @07,IOPBUSMD(,ACDSIOP)                              0438
         ST    @07,MGPVARPT+12                                     0438
*   MGPTYPE=MGPWARN;                /*                               */
@RC00436 MVI   MGPTYPE,X'02'                                       0439
*   CALL HMASMMSG(HMASMMGP);        /*                               */
         L     @15,@CV01325                                        0440
         LA    @01,@AL00440                                        0440
         BALR  @14,@15                                             0440
*                                                                  0441
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD GTA RECORD FOR EACH ASSEMBLY IN MACRO ENTRY ON THE      */
*   /* SMPSCDS BUT NOT IN THE SMPCDS                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0441
*   IF IOPTYPE=IOPMAC               /*                               */
*     THEN                          /*                               */
         CLI   IOPTYPE(ACDSIOP),3                                  0441
         BNE   @RF00441                                            0441
*     DO;                           /*                               */
*       RSJTYPE=RSJASM;             /*                               */
         MVI   RSJTYPE,X'01'                                       0443
*       RSJSNAME=IOPNAME;           /* MACRO NAME                    */
         MVC   RSJSNAME(8),IOPNAME(ACDSIOP)                        0444
*       RSJSMD=BUPSYSMD;            /* SYSMOD NUMBER                 */
         L     @07,@PC00001                                        0445
         MVC   RSJSMD(7),BUPSYSMD(@07)                             0445
*       IF SCDSFND=OFF              /* IF SCDS NOT FOUND             */
*         THEN                      /*                               */
         TM    SCDSFND,B'10000000'                                 0446
         BNZ   @RF00446                                            0446
*         ASCDSIOP->IOPMACND(1)=IOPEOLST;/* SET END OF LIST          */
         MVI   IOPMACND(ASCDSIOP),X'FF'                            0447
*       DO NGSCDSX=1 BY 1 WHILE(    /* LOOP THRU SCDS ENTRY          */
*             ASCDSIOP->IOPMACND(NGSCDSX)^=IOPEOLST/* TILL END       */
*             &SCDNGRC=ZERO);       /* AND GTP FILE OK               */
@RF00446 LA    NGSCDSX,1                                           0448
         B     @DE00448                                            0448
@DL00448 DS    0H                                                  0449
*         IF ASCDSIOP->IOPMCIND(NGSCDSX)=IOPMASMS/* IF ASSEMBLY      */
*           THEN                    /*                               */
         LA    @07,1                                               0449
         LR    @03,NGSCDSX                                         0449
         MH    @03,@CH00453                                        0449
         SLR   @15,@15                                             0449
         IC    @15,IOPMCIND-9(@03,ASCDSIOP)                        0449
         CR    @07,@15                                             0449
         BNE   @RF00449                                            0449
*           DO;                     /*                               */
*                                                                  0450
*             /*******************************************************/
*             /*                                                     */
*             /* IF ASSEMBLY NOT IN CDS THEN ADD RCD TO GTA FILE     */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0451
*             DO NGCDSX=1 BY 1 WHILE(/*                              */
*                   IOPMACND(NGCDSX)^=IOPEOLST/* TILL END            */
*                   &IOPMCENT(NGCDSX)^=ASCDSIOP->IOPMCENT(NGSCDSX));
         LR    NGCDSX,@07                                          0451
         B     @DE00451                                            0451
@DL00451 DS    0H                                                  0452
*             END;                  /*                               */
         AH    NGCDSX,@CH00042                                     0452
@DE00451 LA    @07,9                                               0452
         LR    @01,NGCDSX                                          0452
         MR    @00,@07                                             0452
         SLR   @00,@00                                             0452
         IC    @00,IOPMACND-9(@01,ACDSIOP)                         0452
         CH    @00,@CH00642                                        0452
         BE    @DC00451                                            0452
         LR    @09,@07                                             0452
         MR    @08,NGSCDSX                                         0452
         ALR   @01,ACDSIOP                                         0452
         ALR   @09,ASCDSIOP                                        0452
         CLC   IOPMCENT-9(9,@01),IOPMCENT-9(@09)                   0452
         BNE   @DL00451                                            0452
@DC00451 DS    0H                                                  0453
*             IF IOPMACND(NGCDSX)=IOPEOLST/* IF NO MATCH             */
*               THEN                /*                               */
         LA    @07,9                                               0453
         LR    @01,NGCDSX                                          0453
         MR    @00,@07                                             0453
         SLR   @00,@00                                             0453
         IC    @00,IOPMACND-9(@01,ACDSIOP)                         0453
         CH    @00,@CH00642                                        0453
         BNE   @RF00453                                            0453
*               DO;                 /*                               */
*                 RSJPNAME=IOPMCASM(NGSCDSX);/*                      */
         LR    @01,@07                                             0455
         MR    @00,NGSCDSX                                         0455
         ALR   @01,ACDSIOP                                         0455
         MVC   RSJPNAME(8),IOPMCASM-9(@01)                         0455
*                 CALL HMASMGTA(HMASMGTP);/*                         */
         L     @07,@PC00001                                        0456
         L     @07,BUPGTPAD(,@07)                                  0456
         ST    @07,@AL00001                                        0456
         L     @15,@CV01326                                        0456
         LA    @01,@AL00001                                        0456
         BALR  @14,@15                                             0456
*                 SCDNGRC=MAX(SCDNGRC,GTPRETRN);/*                   */
         L     @07,@PC00001                                        0457
         L     @07,BUPGTPAD(,@07)                                  0457
         SLR   @03,@03                                             0457
         IC    @03,GTPRETRN(,@07)                                  0457
         CR    SCDNGRC,@03                                         0457
         BNL   *+6
         LR    SCDNGRC,@03                                         0457
*               END;                /* END NO MATCH FOUND            */
*           END;                    /* END ASM TYPE SUBENTRY         */
@RF00453 DS    0H                                                  0460
*       END;                        /* END LOOP THRU SCDS            */
@RF00449 AH    NGSCDSX,@CH00042                                    0460
@DE00448 LR    @07,NGSCDSX                                         0460
         MH    @07,@CH00453                                        0460
         SLR   @03,@03                                             0460
         IC    @03,IOPMACND-9(@07,ASCDSIOP)                        0460
         CH    @03,@CH00642                                        0460
         BE    @DC00448                                            0460
         CH    SCDNGRC,@CH00271                                    0460
         BE    @DL00448                                            0460
@DC00448 DS    0H                                                  0461
*     END;                          /* END MAC TYPE ENTRY            */
*                                                                  0462
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD GTA RECORD FOR EACH LMOD IN MODRO ENTRY ON THE SMPSCDS  */
*   /* BUT NOT IN THE SMPCDS                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0462
*   IF IOPTYPE=IOPMOD               /*                               */
*     THEN                          /*                               */
@RF00441 CLI   IOPTYPE(ACDSIOP),5                                  0462
         BNE   @RF00462                                            0462
*     DO;                           /*                               */
*       RSJTYPE=RSJLMD;             /*                               */
         MVI   RSJTYPE,X'02'                                       0464
*       RSJSNAME=IOPNAME;           /* MOD NAME                      */
         MVC   RSJSNAME(8),IOPNAME(ACDSIOP)                        0465
*       RSJSMD=BUPSYSMD;            /* SYSMOD NUMBER                 */
         L     @07,@PC00001                                        0466
         MVC   RSJSMD(7),BUPSYSMD(@07)                             0466
*       IF SCDSFND=OFF              /* IF SCDS NOT FOUND             */
*         THEN                      /*                               */
         TM    SCDSFND,B'10000000'                                 0467
         BNZ   @RF00467                                            0467
*         ASCDSIOP->IOPMODND(1)=IOPEOLST;/* SET END OF LIST          */
         MVI   IOPMODND(ASCDSIOP),X'FF'                            0468
*       DO NGSCDSX=1 BY 1 WHILE(    /* LOOP THRU SCDS ENTRY          */
*             ASCDSIOP->IOPMODND(NGSCDSX)^=IOPEOLST/* TILL END       */
*             &SCDNGRC=ZERO);       /* AND GTP FILE OK               */
@RF00467 LA    NGSCDSX,1                                           0469
         B     @DE00469                                            0469
@DL00469 DS    0H                                                  0470
*         IF ASCDSIOP->IOPMDIND(NGSCDSX)=IOPMDLMD/* IF LMOD          */
*           THEN                    /*                               */
         LA    @07,1                                               0470
         LR    @03,NGSCDSX                                         0470
         MH    @03,@CH00453                                        0470
         SLR   @15,@15                                             0470
         IC    @15,IOPMDIND-9(@03,ASCDSIOP)                        0470
         CR    @07,@15                                             0470
         BNE   @RF00470                                            0470
*           DO;                     /*                               */
*                                                                  0471
*             /*******************************************************/
*             /*                                                     */
*             /* IF LMOD NOT IN CDS THEN ADD RCD TO GTA FILE         */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0472
*             DO NGCDSX=1 BY 1 WHILE(/*                              */
*                   IOPMODND(NGCDSX)^=IOPEOLST/* TILL END            */
*                   &IOPMNTRY(NGCDSX)^=ASCDSIOP->IOPMNTRY(NGSCDSX));
         LR    NGCDSX,@07                                          0472
         B     @DE00472                                            0472
@DL00472 DS    0H                                                  0473
*             END;                  /*                               */
         AH    NGCDSX,@CH00042                                     0473
@DE00472 LA    @07,9                                               0473
         LR    @01,NGCDSX                                          0473
         MR    @00,@07                                             0473
         SLR   @00,@00                                             0473
         IC    @00,IOPMODND-9(@01,ACDSIOP)                         0473
         CH    @00,@CH00642                                        0473
         BE    @DC00472                                            0473
         LR    @09,@07                                             0473
         MR    @08,NGSCDSX                                         0473
         ALR   @01,ACDSIOP                                         0473
         ALR   @09,ASCDSIOP                                        0473
         CLC   IOPMNTRY-9(9,@01),IOPMNTRY-9(@09)                   0473
         BNE   @DL00472                                            0473
@DC00472 DS    0H                                                  0474
*             IF IOPMODND(NGCDSX)=IOPEOLST/* IF NO MATCH             */
*               THEN                /*                               */
         LA    @07,9                                               0474
         LR    @01,NGCDSX                                          0474
         MR    @00,@07                                             0474
         SLR   @00,@00                                             0474
         IC    @00,IOPMODND-9(@01,ACDSIOP)                         0474
         CH    @00,@CH00642                                        0474
         BNE   @RF00474                                            0474
*               DO;                 /*                               */
*                 RSJPNAME=IOPLMODS(NGSCDSX);/*                      */
         LR    @01,@07                                             0476
         MR    @00,NGSCDSX                                         0476
         ALR   @01,ACDSIOP                                         0476
         MVC   RSJPNAME(8),IOPLMODS-9(@01)                         0476
*                 CALL HMASMGTA(HMASMGTP);/*                         */
         L     @07,@PC00001                                        0477
         L     @07,BUPGTPAD(,@07)                                  0477
         ST    @07,@AL00001                                        0477
         L     @15,@CV01326                                        0477
         LA    @01,@AL00001                                        0477
         BALR  @14,@15                                             0477
*                 SCDNGRC=MAX(SCDNGRC,GTPRETRN);/*                   */
         L     @07,@PC00001                                        0478
         L     @07,BUPGTPAD(,@07)                                  0478
         SLR   @03,@03                                             0478
         IC    @03,GTPRETRN(,@07)                                  0478
         CR    SCDNGRC,@03                                         0478
         BNL   *+6
         LR    SCDNGRC,@03                                         0478
*               END;                /* END NO MATCH FOUND            */
*           END;                    /* END LMD TYPE SUBENTRY         */
@RF00474 DS    0H                                                  0481
*       END;                        /* END LOOP THRU SCDS            */
@RF00470 AH    NGSCDSX,@CH00042                                    0481
@DE00469 LR    @07,NGSCDSX                                         0481
         MH    @07,@CH00453                                        0481
         SLR   @03,@03                                             0481
         IC    @03,IOPMODND-9(@07,ASCDSIOP)                        0481
         CH    @03,@CH00642                                        0481
         BE    @DC00469                                            0481
         CH    SCDNGRC,@CH00271                                    0481
         BE    @DL00469                                            0481
@DC00469 DS    0H                                                  0482
*     END;                          /* END MOD TYPE ENTRY            */
*   RETURN CODE(MAX(PTFWARN,SCDNGRC));/*                             */
@RF00462 LA    @15,4                                               0483
         CR    @15,SCDNGRC                                         0483
         BNL   *+6
         LR    @15,SCDNGRC                                         0483
         L     @14,@SA00007                                        0483
         LM    @00,@12,@SA00007+8                                  0483
         BR    @14                                                 0483
*   END BURSCDNG;                   /*                               */
         EJECT
*                                                                  0485
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO COPY SCDS ENTRY TO CDS                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0485
*BURCOPY:                           /*                               */
*   PROCEDURE(CPYLOCNM,CPYLOCTP);   /*                               */
BURCOPY  STM   @14,@12,@SA00008                                    0485
         MVC   @PC00008(8),0(@01)                                  0485
*   DECLARE                         /*                               */
*     CPYLOCNM CHAR(8),             /* ELEMENT NAME                  */
*     CPYLOCTP FIXED(8);            /* ELEMENT TYPE                  */
*   DECLARE                         /*                               */
*     COPYRC FIXED(8);              /*                               */
*   RFY                                                            0488
*     HMASMIOP BASED(ASCDSIOP);     /* IOP WITH SCDS ENTRY           */
*   COPYRC=ZERO;                    /*                               */
         SLR   COPYRC,COPYRC                                       0489
*   IOPNAME=CPYLOCNM;               /*                               */
         L     @04,@PC00008                                        0490
         MVC   IOPNAME(8,ASCDSIOP),CPYLOCNM(@04)                   0490
*   IOPTYPE=CPYLOCTP;               /*                               */
*                                                                  0491
         L     @04,@PC00008+4                                      0491
         MVC   IOPTYPE(1,ASCDSIOP),CPYLOCTP(@04)                   0491
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ENTRY TYPE BEING RESTORED IS LMOD OR ASSEM THEN MUST FIRST */
*   /* COPY DATA CARDS FROM SCDS TO CDS                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0492
*   IF(IOPTYPE=IOPLMD×IOPTYPE=IOPASM)/* IF LMOD OR ASSEM             */
*     THEN                          /*                               */
         CLI   IOPTYPE(ASCDSIOP),2                                 0492
         BE    @RT00492                                            0492
         CLI   IOPTYPE(ASCDSIOP),1                                 0492
         BNE   @RF00492                                            0492
@RT00492 DS    0H                                                  0493
*     DO;                           /*                               */
*       IOPFUNCT=IOPPOSI;           /*                               */
         MVI   IOPFUNCT(ASCDSIOP),X'02'                            0494
*       CALL HMASMIO(HMASMIOP);     /* POINT TO DATA RECORDS         */
         ST    ASCDSIOP,@AL00001                                   0495
         L     @15,@CV01324                                        0495
         LA    @01,@AL00001                                        0495
         BALR  @14,@15                                             0495
*       IOPBUFAD=IOPPTR->IOPBUFAD;  /*                               */
         MVC   IOPBUFAD(4,ASCDSIOP),IOPBUFAD(IOPPTR)               0496
*       DO WHILE(IOPRETRN=IOPGOOD); /*                               */
         B     @DE00497                                            0497
@DL00497 DS    0H                                                  0498
*         IOPFUNCT=IOPREAD;         /*                               */
         MVI   IOPFUNCT(ASCDSIOP),X'01'                            0498
*         IOPDSID=IOPSCDS;          /*                               */
         MVI   IOPDSID(ASCDSIOP),X'21'                             0499
*         CALL HMASMIO(HMASMIOP);   /* READ SCDS RECORD              */
         ST    ASCDSIOP,@AL00001                                   0500
         L     @15,@CV01324                                        0500
         LA    @01,@AL00001                                        0500
         BALR  @14,@15                                             0500
*         IF IOPRETRN=IOPGOOD       /* IF RECORD READ OK             */
*           THEN                    /*                               */
         CLI   IOPRETRN(ASCDSIOP),0                                0501
         BNE   @RF00501                                            0501
*           DO;                     /*                               */
*             IOPFUNCT=IOPWRITE;    /*                               */
         MVI   IOPFUNCT(ASCDSIOP),X'51'                            0503
*             IOPDSID=IOPCDS;       /*                               */
         MVI   IOPDSID(ASCDSIOP),X'02'                             0504
*             CALL HMASMIO(HMASMIOP);/* WRITE RCD TO CDS             */
         ST    ASCDSIOP,@AL00001                                   0505
         L     @15,@CV01324                                        0505
         LA    @01,@AL00001                                        0505
         BALR  @14,@15                                             0505
*           END;                    /* END READ OK                   */
*       END;                        /* END READ/WRITE LOOP           */
@RF00501 DS    0H                                                  0507
@DE00497 CLI   IOPRETRN(ASCDSIOP),0                                0507
         BE    @DL00497                                            0507
*       IF IOPRETRN>IOPEOF          /* IF ERROR STOPPED LOOP         */
*         THEN                      /*                               */
         CLI   IOPRETRN(ASCDSIOP),4                                0508
         BNH   @RF00508                                            0508
*         COPYRC=MAX(COPYRC,IOPRETRN);/* SAVE RC                     */
         SLR   @04,@04                                             0509
         IC    @04,IOPRETRN(,ASCDSIOP)                             0509
         CR    COPYRC,@04                                          0509
         BNL   *+6
         LR    COPYRC,@04                                          0509
*     END;                          /* END LMOD/ASM GROUP            */
*                                                                  0510
@RF00508 DS    0H                                                  0511
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PREV FUNCTIONS OK THEN STOW SCDS ENTRY BACK ON CDS         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0511
*   IF COPYRC<STOPPTF               /*                               */
*     THEN                          /*                               */
@RF00492 CH    COPYRC,@CH00037                                     0511
         BNL   @RF00511                                            0511
*     DO;                           /*                               */
*       IOPDSID=IOPCDS;             /*                               */
         MVI   IOPDSID(ASCDSIOP),X'02'                             0513
*       IOPFUNCT=IOPSTOWR;          /*                               */
         MVI   IOPFUNCT(ASCDSIOP),X'54'                            0514
*       CALL HMASMIO(HMASMIOP);     /*                               */
         ST    ASCDSIOP,@AL00001                                   0515
         L     @15,@CV01324                                        0515
         LA    @01,@AL00001                                        0515
         BALR  @14,@15                                             0515
*       COPYRC=MAX(COPYRC,IOPRETRN);/*                               */
         SLR   @04,@04                                             0516
         IC    @04,IOPRETRN(,ASCDSIOP)                             0516
         CR    COPYRC,@04                                          0516
         BNL   *+6
         LR    COPYRC,@04                                          0516
*     END;                          /*                               */
*   RETURN CODE(COPYRC);            /*                               */
@RF00511 LR    @15,COPYRC                                          0518
         L     @14,@SA00008                                        0518
         LM    @00,@12,@SA00008+8                                  0518
         BR    @14                                                 0518
*   END BURCOPY;                    /*                               */
         EJECT
*                                                                  0520
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO DELETE ALL ENTRIES FOR A SPECIFIED SYSMOD FROM THE */
*   /* SCDS                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0520
*BURSTOWD:                          /*                               */
*   PROCEDURE;                      /*                               */
BURSTOWD STM   @14,@12,@SA00009                                    0520
*   DECLARE                         /*                               */
*     DELRC FIXED(8);               /* PROC RETURN CODE              */
*   DECLARE                         /*                               */
*     DELX FIXED(31);               /*                               */
*   DECLARE                         /*                               */
*     IOPPTR4 PTR(31);              /*                               */
*   DECLARE                         /*                               */
*     IOP4 CHAR(LENGTH(HMASMIOP));  /* IOP FOR DELETES               */
*   RFY                                                            0525
*     HMASMIOP BASED(IOPPTR);       /* IOP WITH SYSMOD               */
*   DELRC=ZERO;                     /*                               */
         SLR   DELRC,DELRC                                         0526
*   IOPPTR4=ADDR(IOP4);             /*                               */
         LA    IOPPTR4,IOP4                                        0527
*   IF CCACHECK=OFF                 /*                               */
*     THEN                          /*                               */
         TM    CCACHECK(CCAPTR),B'00010000'                        0528
         BNZ   @RF00528                                            0528
*     DO;                           /*                               */
*       DO DELX=1 BY 1 WHILE(       /* LOOP THRU SYSMOD SUBENTRY     */
*             IOPPTFND(DELX)^=IOPEOLST);/* TILL END                  */
         LA    DELX,1                                              0530
         B     @DE00530                                            0530
@DL00530 DS    0H                                                  0531
*         IF IOPPIND(DELX)=IOPSUASM /* IF UPDATED OR                 */
*             ×IOPPIND(DELX)=IOPSDASM/* OR DELETED ASSEM             */
*           THEN                    /*                               */
         LR    @15,DELX                                            0531
         MH    @15,@CH00453                                        0531
         SLR   @14,@14                                             0531
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0531
         CH    @14,@CH01047                                        0531
         BE    @RT00531                                            0531
         CH    @14,@CH00825                                        0531
         BNE   @RF00531                                            0531
@RT00531 DS    0H                                                  0532
*           SAVTYPE=IOPASM;         /* MUST DELETE                   */
         MVI   SAVTYPE,X'01'                                       0532
*         ELSE                      /*                               */
*           IF IOPPIND(DELX)=IOPSULMD/*                              */
*               ×IOPPIND(DELX)=IOPSDLMD/*                            */
*             THEN                  /*                               */
         B     @RC00531                                            0533
@RF00531 LR    @15,DELX                                            0533
         MH    @15,@CH00453                                        0533
         SLR   @14,@14                                             0533
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0533
         CH    @14,@CH01049                                        0533
         BE    @RT00533                                            0533
         CH    @14,@CH01039                                        0533
         BNE   @RF00533                                            0533
@RT00533 DS    0H                                                  0534
*             SAVTYPE=IOPLMD;       /*                               */
         MVI   SAVTYPE,X'02'                                       0534
*           ELSE                    /*                               */
*             IF IOPPIND(DELX)=IOPSUMAC/*                            */
*                 ×IOPPIND(DELX)=IOPSDMAC/*                          */
*               THEN                /*                               */
         B     @RC00533                                            0535
@RF00533 LR    @15,DELX                                            0535
         MH    @15,@CH00453                                        0535
         SLR   @14,@14                                             0535
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0535
         CH    @14,@CH01051                                        0535
         BE    @RT00535                                            0535
         CH    @14,@CH00269                                        0535
         BNE   @RF00535                                            0535
@RT00535 DS    0H                                                  0536
*               SAVTYPE=IOPMAC;     /*                               */
         MVI   SAVTYPE,X'03'                                       0536
*             ELSE                  /*                               */
*               IF IOPPIND(DELX)=IOPSUMOD/*                          */
*                   ×IOPPIND(DELX)=IOPSDMOD/*                        */
*                 THEN              /*                               */
         B     @RC00535                                            0537
@RF00535 LR    @15,DELX                                            0537
         MH    @15,@CH00453                                        0537
         SLR   @14,@14                                             0537
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0537
         CH    @14,@CH01053                                        0537
         BE    @RT00537                                            0537
         CH    @14,@CH00701                                        0537
         BNE   @RF00537                                            0537
@RT00537 DS    0H                                                  0538
*                 SAVTYPE=IOPMOD;   /*                               */
         MVI   SAVTYPE,X'05'                                       0538
*               ELSE                /*                               */
*                 IF IOPPIND(DELX)=IOPSUSRC/*                        */
*                     ×IOPPIND(DELX)=IOPSDSRC/*                      */
*                   THEN            /*                               */
         B     @RC00537                                            0539
@RF00537 LR    @15,DELX                                            0539
         MH    @15,@CH00453                                        0539
         SLR   @14,@14                                             0539
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0539
         CH    @14,@CH01055                                        0539
         BE    @RT00539                                            0539
         CH    @14,@CH01043                                        0539
         BNE   @RF00539                                            0539
@RT00539 DS    0H                                                  0540
*                   SAVTYPE=IOPSRC; /*                               */
         MVI   SAVTYPE,X'08'                                       0540
*                 ELSE              /*                               */
*                   IF IOPPIND(DELX)=IOPSUDLB/*                      */
*                       ×IOPPIND(DELX)=IOPSDDLB/*                    */
*                     THEN          /*                               */
         B     @RC00539                                            0541
@RF00539 LR    @15,DELX                                            0541
         MH    @15,@CH00453                                        0541
         SLR   @14,@14                                             0541
         IC    @14,IOPPIND-9(@15,IOPPTR)                           0541
         CH    @14,@CH01057                                        0541
         BE    @RT00541                                            0541
         CH    @14,@CH01045                                        0541
         BNE   @RF00541                                            0541
@RT00541 DS    0H                                                  0542
*                     SAVTYPE=IOPDLB;/*                              */
         MVI   SAVTYPE,X'06'                                       0542
*                   ELSE            /*                               */
*                     SAVTYPE=IOPEOLST;/*                            */
         B     @RC00541                                            0543
@RF00541 MVI   SAVTYPE,X'FF'                                       0543
*         IF SAVTYPE^=IOPEOLST      /* IF ENT MUST BE DELETED        */
*           THEN                    /*                               */
@RC00541 DS    0H                                                  0544
@RC00539 DS    0H                                                  0544
@RC00537 DS    0H                                                  0544
@RC00535 DS    0H                                                  0544
@RC00533 DS    0H                                                  0544
@RC00531 CLI   SAVTYPE,255                                         0544
         BE    @RF00544                                            0544
*           DO;                     /*                               */
*             IOPPTR4->IOPFUNCT=IOPSTOWD;/*                          */
         MVI   IOPFUNCT(IOPPTR4),X'53'                             0546
*             IOPPTR4->IOPDSID=IOPSCDS;/*                            */
         MVI   IOPDSID(IOPPTR4),X'21'                              0547
*             IOPPTR4->IOPTYPE=SAVTYPE;/*                            */
         MVC   IOPTYPE(1,IOPPTR4),SAVTYPE                          0548
*             IOPPTR4->IOPNAME=IOPPMODS(DELX);/* ENTRY NAME FOR MSG  */
         LR    @15,DELX                                            0549
         MH    @15,@CH00453                                        0549
         ALR   @15,IOPPTR                                          0549
         MVC   IOPNAME(8,IOPPTR4),IOPPMODS-9(@15)                  0549
*             IOPPTR4->IOPPTFNM=BUPSYSMD;/* PTF NUMBER AND SEQ NUM   */
         L     @15,@PC00001                                        0550
         MVC   IOPPTFNM(7,IOPPTR4),BUPSYSMD(@15)                   0550
*             IOPPTR4->IOPSEQNO=DELX;/* FOR ENCODED NAME             */
         STH   DELX,IOPSEQNO(,IOPPTR4)                             0551
*             CALL HMASMIO(IOPPTR4->HMASMIOP);/*                     */
         ST    IOPPTR4,@AL00001                                    0552
         L     @15,@CV01324                                        0552
         LA    @01,@AL00001                                        0552
         BALR  @14,@15                                             0552
*             DELRC=MAX(DELRC,IOPPTR4->IOPRETRN);/*                  */
         SLR   @15,@15                                             0553
         IC    @15,IOPRETRN(,IOPPTR4)                              0553
         CR    DELRC,@15                                           0553
         BNL   *+6
         LR    DELRC,@15                                           0553
*           END;                    /* END MUST DELETE               */
*       END;                        /* END SYSMOD LOOP               */
@RF00544 AH    DELX,@CH00042                                       0555
@DE00530 LR    @15,DELX                                            0555
         MH    @15,@CH00453                                        0555
         SLR   @14,@14                                             0555
         IC    @14,IOPPTFND-9(@15,IOPPTR)                          0555
         CH    @14,@CH00642                                        0555
         BNE   @DL00530                                            0555
*     END;                          /*                               */
*                                                                  0556
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW DELETE SYSMOD ENTRY FROM SMPSCDS                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0557
*   IF DELRC=ZERO                   /*                               */
*     THEN                          /*                               */
@RF00528 CH    DELRC,@CH00271                                      0557
         BNE   @RF00557                                            0557
*     DO;                           /*                               */
*       IOPFUNCT=IOPSTOWD;          /* DEL SYSMOD. NAME AND TYPE     */
         MVI   IOPFUNCT(IOPPTR),X'53'                              0559
*       CALL HMASMIO(HMASMIOP);     /* SET UP FROM LOCATE            */
         ST    IOPPTR,@AL00001                                     0560
         L     @15,@CV01324                                        0560
         LA    @01,@AL00001                                        0560
         BALR  @14,@15                                             0560
*       DELRC=IOPRETRN;             /* SAVE RC                       */
         SLR   DELRC,DELRC                                         0561
         IC    DELRC,IOPRETRN(,IOPPTR)                             0561
*     END;                          /*                               */
*   RETURN CODE(DELRC);             /* RETURN TO CALLER              */
@RF00557 LR    @15,DELRC                                           0563
         L     @14,@SA00009                                        0563
         LM    @00,@12,@SA00009+8                                  0563
         BR    @14                                                 0563
*   END BURSTOWD;                   /*                               */
         EJECT
*                                                                  0565
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO DO DELETES FROM CDS FOR ADDED ELEMENTS             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0565
*BURCDSDL:                          /*                               */
*   PROCEDURE;                      /*                               */
BURCDSDL STM   @14,@12,@SA00010                                    0565
*   DECLARE                         /*                               */
*     CDDLRC FIXED(8);              /*                               */
*   DECLARE                         /*                               */
*     CDDLX FIXED(31);              /*                               */
*   RFY                             /*                               */
*     HMASMIOP BASED(IOPPTR);       /* IOP WITH SCDS SYSMOD ENTRY    */
*   CDDLRC=ZERO;                    /*                               */
*                                                                  0569
         SLR   CDDLRC,CDDLRC                                       0569
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU SCDS SYSMOD SUBENTRIES AND FOR EACH SUBENTRY DO     */
*   /* DETERMINE TYPE AND WHETHER ADDED OR NOT                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0570
*   DO CDDLX=1 BY 1 WHILE(          /* LOOP THRU SCDS SYSMOD         */
*         IOPPTFND(CDDLX)^=IOPEOLST /* TILL END                      */
*         &CDDLRC<STOPPTF);         /* AND NO SERIOUS ERRORS         */
*                                                                  0570
         LA    @05,1                                               0570
         ST    @05,CDDLX                                           0570
         B     @DE00570                                            0570
@DL00570 DS    0H                                                  0571
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK SUBENTRY TYPE TO SET TYPE CODE FOR CDS ENTRY THEN TO  */
*     /* SEE IF ENTRY WAS DELETED/UPDATED OR ADDED                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0571
*     IF IOPPIND(CDDLX)=IOPSAASM    /* IF ADDED ASSEM                */
*       THEN                        /*                               */
         L     @05,CDDLX                                           0571
         MH    @05,@CH00453                                        0571
         SLR   @15,@15                                             0571
         IC    @15,IOPPIND-9(@05,IOPPTR)                           0571
         CH    @15,@CH01027                                        0571
         BNE   @RF00571                                            0571
*       SAVTYPE=IOPASM;             /* MUST DELETE                   */
         MVI   SAVTYPE,X'01'                                       0572
*     ELSE                          /*                               */
*       IF IOPPIND(CDDLX)=IOPSALMD  /*                               */
*         THEN                      /*                               */
         B     @RC00571                                            0573
@RF00571 L     @05,CDDLX                                           0573
         MH    @05,@CH00453                                        0573
         SLR   @15,@15                                             0573
         IC    @15,IOPPIND-9(@05,IOPPTR)                           0573
         CH    @15,@CH01029                                        0573
         BNE   @RF00573                                            0573
*         SAVTYPE=IOPLMD;           /*                               */
         MVI   SAVTYPE,X'02'                                       0574
*       ELSE                        /*                               */
*         IF IOPPIND(CDDLX)=IOPSAMAC/*                               */
*           THEN                    /*                               */
         B     @RC00573                                            0575
@RF00573 L     @05,CDDLX                                           0575
         MH    @05,@CH00453                                        0575
         SLR   @15,@15                                             0575
         IC    @15,IOPPIND-9(@05,IOPPTR)                           0575
         CH    @15,@CH00725                                        0575
         BNE   @RF00575                                            0575
*           SAVTYPE=IOPMAC;         /*                               */
         MVI   SAVTYPE,X'03'                                       0576
*         ELSE                      /*                               */
*           IF IOPPIND(CDDLX)=IOPSAMOD/*                             */
*             THEN                  /*                               */
         B     @RC00575                                            0577
@RF00575 L     @05,CDDLX                                           0577
         MH    @05,@CH00453                                        0577
         SLR   @15,@15                                             0577
         IC    @15,IOPPIND-9(@05,IOPPTR)                           0577
         CH    @15,@CH01032                                        0577
         BNE   @RF00577                                            0577
*             SAVTYPE=IOPMOD;       /*                               */
         MVI   SAVTYPE,X'05'                                       0578
*           ELSE                    /*                               */
*             IF IOPPIND(CDDLX)=IOPSASRC/*                           */
*               THEN                /*                               */
         B     @RC00577                                            0579
@RF00577 L     @05,CDDLX                                           0579
         MH    @05,@CH00453                                        0579
         SLR   @15,@15                                             0579
         IC    @15,IOPPIND-9(@05,IOPPTR)                           0579
         CH    @15,@CH01034                                        0579
         BNE   @RF00579                                            0579
*               SAVTYPE=IOPSRC;     /*                               */
         MVI   SAVTYPE,X'08'                                       0580
*             ELSE                  /*                               */
*               IF IOPPIND(CDDLX)=IOPSADLB/*                         */
*                 THEN              /*                               */
         B     @RC00579                                            0581
@RF00579 L     @05,CDDLX                                           0581
         MH    @05,@CH00453                                        0581
         SLR   @15,@15                                             0581
         IC    @15,IOPPIND-9(@05,IOPPTR)                           0581
         CH    @15,@CH01036                                        0581
         BNE   @RF00581                                            0581
*                 SAVTYPE=IOPDLB;   /*                               */
         MVI   SAVTYPE,X'06'                                       0582
*               ELSE                /*                               */
*                 SAVTYPE=IOPEOLST; /* IF NOT ADDED TYPE             */
*                                                                  0583
         B     @RC00581                                            0583
@RF00581 MVI   SAVTYPE,X'FF'                                       0583
*     /***************************************************************/
*     /*                                                             */
*     /* IF REQUEST WAS TO RESTORE CDS FROM SCDS THEN IF UPDATED OR  */
*     /* DELETED ELEMENT THEN MUST ATTEMPT RESTORE                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0584
*     IF SAVTYPE^=IOPEOLST          /* IF ADDED TYPE ENTRY           */
*       THEN                        /*                               */
@RC00581 DS    0H                                                  0584
@RC00579 DS    0H                                                  0584
@RC00577 DS    0H                                                  0584
@RC00575 DS    0H                                                  0584
@RC00573 DS    0H                                                  0584
@RC00571 CLI   SAVTYPE,255                                         0584
         BE    @RF00584                                            0584
*       DO;                         /*                               */
*         CALL BURCDSL(CDDLX,IOPPMODS(CDDLX),SAVTYPE);/*             */
         MVC   @AL00001(12),@AL00586                               0586
         L     @05,CDDLX                                           0586
         MH    @05,@CH00453                                        0586
         LA    @05,IOPPMODS-9(@05,IOPPTR)                          0586
         ST    @05,@AL00001+4                                      0586
         LA    @01,@AL00001                                        0586
         BAL   @14,BURCDSL                                         0586
*         RFY                       /*                               */
*           RTNCODE RSTD;           /*                               */
*         IF RTNCODE=ZERO           /*                               */
*           THEN                    /*                               */
         LTR   RTNCODE,RTNCODE                                     0588
         BNZ   @RF00588                                            0588
*           CDSFND=ON;              /*                               */
         OI    CDSFND,B'01000000'                                  0589
*         ELSE                      /*                               */
*           DO;                     /*                               */
         B     @RC00588                                            0590
@RF00588 DS    0H                                                  0591
*             CDSFND=OFF;           /*                               */
         NI    CDSFND,B'10111111'                                  0591
*             CDDLRC=MAX(CDDLRC,RTNCODE);/*                          */
         CR    CDDLRC,RTNCODE                                      0592
         BNL   *+6
         LR    CDDLRC,RTNCODE                                      0592
*           END;                    /*                               */
*         RFY                       /*                               */
*           RTNCODE UNRSTD;         /*                               */
*                                                                  0594
@RC00588 DS    0H                                                  0595
*         /***********************************************************/
*         /*                                                         */
*         /* IF CDS ENTRY FOUND THEN CHECK TO INSURE THAT THIS SYSMOD*/
*         /* WAS LAST TO UPDATE ENTRY. ISSUE WARNING MSG IF NOT      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0595
*         IF CDSFND=ON              /* IF CDS ENTRY FOUND            */
*           THEN                    /*                               */
         TM    CDSFND,B'01000000'                                  0595
         BNO   @RF00595                                            0595
*           DO;                     /* CHECK FOR MATCH LUPD AND SMD  */
*             IF(SAVTYPE=IOPASM     /* IF ASSEM ENTRY                */
*                 &ACDSIOP->IOPABUPT=BUPSYSMD)/* AND THIS PTF WAS  0597
*                                      LAST TO UPDATE IT             */
*                 ×(SAVTYPE^=IOPASM /* OR OTHER THAN ASSEM           */
*                 &ACDSIOP->IOPBUSMD=BUPSYSMD)/* AND MATCH           */
*               THEN                /*                               */
         CLI   SAVTYPE,1                                           0597
         BNE   @GL00048                                            0597
         L     @05,@PC00001                                        0597
         CLC   IOPABUPT(7,ACDSIOP),BUPSYSMD(@05)                   0597
         BE    @RT00597                                            0597
@GL00048 CLI   SAVTYPE,1                                           0597
         BE    @RF00597                                            0597
         L     @05,@PC00001                                        0597
         CLC   IOPBUSMD(7,ACDSIOP),BUPSYSMD(@05)                   0597
         BNE   @RF00597                                            0597
@RT00597 DS    0H                                                  0598
*               CDSSTOW=ON;         /* DELETE CDS ENTRY              */
         OI    CDSSTOW,B'00010000'                                 0598
*             ELSE                  /*                               */
*               DO;                 /*                               */
         B     @RC00597                                            0599
@RF00597 DS    0H                                                  0600
*                 CDSSTOW=OFF;      /* DONT DELET ENTRY              */
         NI    CDSSTOW,B'11101111'                                 0600
*                 MGPCLEAR=''B;     /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0601
*                 MGPMGNO1=HMA411I; /* XXXXXXXX XXXXXXXX TO BE     0602
*                                      RETORED FOR SYSMOD XXXXXXX HAS
*                                      BEEN MODIFIED BY SUBSEQUENT 0602
*                                      SYSMOD XXXXXXX                */
         MVC   MGPMGNO1(2),@CH01333                                0602
*                 MGPVARPT(1)=ADDR(CCATYPEA(SAVTYPE));/*             */
         SLR   @05,@05                                             0603
         IC    @05,SAVTYPE                                         0603
         SLA   @05,3                                               0603
         L     @01,CCATPAD(,CCAPTR)                                0603
         AL    @01,@CF01461                                        0603
         LA    @05,CCATYPEA(@05,@01)                               0603
         ST    @05,MGPVARPT                                        0603
*                 MGPVARPT(2)=ADDR(ACDSIOP->IOPNAME);/*              */
         LA    @05,IOPNAME(,ACDSIOP)                               0604
         ST    @05,MGPVARPT+4                                      0604
*                 IF SAVTYPE=IOPASM /*                               */
*                   THEN            /*                               */
         CLI   SAVTYPE,1                                           0605
         BNE   @RF00605                                            0605
*                   MGPVARPT(3)=ADDR(ACDSIOP->IOPABUPT);/*           */
         LA    @05,IOPABUPT(,ACDSIOP)                              0606
         ST    @05,MGPVARPT+8                                      0606
*                 ELSE              /*                               */
*                   MGPVARPT(3)=ADDR(ACDSIOP->IOPBUSMD);/*           */
         B     @RC00605                                            0607
@RF00605 LA    @05,IOPBUSMD(,ACDSIOP)                              0607
         ST    @05,MGPVARPT+8                                      0607
*                 MGPTYPE=MGPWARN;  /*                               */
@RC00605 MVI   MGPTYPE,X'02'                                       0608
*                 CALL HMASMMSG(HMASMMGP);/*                         */
         L     @15,@CV01325                                        0609
         LA    @01,@AL00609                                        0609
         BALR  @14,@15                                             0609
*                 CDDLRC=MAX(CDDLRC,PTFWARN);/*                      */
         LA    @05,4                                               0610
         CR    CDDLRC,@05                                          0610
         BNL   *+6
         LR    CDDLRC,@05                                          0610
*               END;                /*                               */
*           END;                    /*                               */
*                                                                  0612
@RC00597 DS    0H                                                  0613
*         /***********************************************************/
*         /*                                                         */
*         /* IF CDS ENTRY FOUND AND WAS LAST TO UPDATE ENTRY THEN    */
*         /* DELETE ENTRY FROM CDS                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0613
*         IF CDSFND=ON&CDSSTOW=ON   /*                               */
*           THEN                    /*                               */
@RF00595 TM    CDSFND,B'01010000'                                  0613
         BNO   @RF00613                                            0613
*           DO;                     /*                               */
*             RFY                   /*                               */
*               HMASMIOP BASED(ACDSIOP);/* IOP WITH CDS ENTRY        */
*             IOPFUNCT=IOPSTOWD;    /*                               */
         MVI   IOPFUNCT(ACDSIOP),X'53'                             0616
*             CALL HMASMIO(HMASMIOP);/*                              */
         ST    ACDSIOP,@AL00001                                    0617
         L     @15,@CV01324                                        0617
         LA    @01,@AL00001                                        0617
         BALR  @14,@15                                             0617
*             CDDLRC=MAX(CDDLRC,IOPRETRN);/*                         */
         SLR   @05,@05                                             0618
         IC    @05,IOPRETRN(,ACDSIOP)                              0618
         CR    CDDLRC,@05                                          0618
         BNL   *+6
         LR    CDDLRC,@05                                          0618
*             RFY                   /*                               */
*               HMASMIOP BASED(IOPPTR);/* IOP WITH SCDS SYSMOD       */
*           END;                    /*                               */
*       END;                        /*                               */
@RF00613 DS    0H                                                  0622
*   END;                            /* END LOOP THRU SCDS SYSMOD     */
@RF00584 LA    @05,1                                               0622
         AL    @05,CDDLX                                           0622
         ST    @05,CDDLX                                           0622
@DE00570 L     @05,CDDLX                                           0622
         MH    @05,@CH00453                                        0622
         SLR   @15,@15                                             0622
         IC    @15,IOPPTFND-9(@05,IOPPTR)                          0622
         CH    @15,@CH00642                                        0622
         BE    @DC00570                                            0622
         CH    CDDLRC,@CH00037                                     0622
         BL    @DL00570                                            0622
@DC00570 DS    0H                                                  0623
*   RETURN CODE(CDDLRC);            /*                               */
         LR    @15,CDDLRC                                          0623
         L     @14,@SA00010                                        0623
         LM    @00,@12,@SA00010+8                                  0623
         BR    @14                                                 0623
*   END BURCDSDL;                   /*                               */
         EJECT
*                                                                  0625
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO DO CLEANUP PROCESSING                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0625
*BURTERM:                           /*                               */
*   PROCEDURE;                      /*                               */
BURTERM  STM   @14,@12,@SA00011                                    0625
*   HMASMSPL=''B;                   /*                               */
         XC    HMASMSPL(5),HMASMSPL                                0626
*   SPLFUNCT=SPLFMIOP;              /*                               */
         MVI   SPLFUNCT,X'04'                                      0627
*   IF ASCDSIOP^=ZERO               /*                               */
*     THEN                          /*                               */
         LTR   ASCDSIOP,ASCDSIOP                                   0628
         BZ    @RF00628                                            0628
*     DO;                           /*                               */
*       SPLPMAD=ASCDSIOP;           /*                               */
         ST    ASCDSIOP,SPLPMAD                                    0630
*       CALL HMASMSUB(HMASMSPL);    /*                               */
         L     @15,@CV01327                                        0631
         LA    @01,@AL00631                                        0631
         BALR  @14,@15                                             0631
*     END;                          /*                               */
*   IF ACDSIOP^=ZERO                /*                               */
*     THEN                          /*                               */
@RF00628 LTR   ACDSIOP,ACDSIOP                                     0633
         BZ    @RF00633                                            0633
*     DO;                           /*                               */
*       SPLPMAD=ACDSIOP;            /*                               */
         ST    ACDSIOP,SPLPMAD                                     0635
*       CALL HMASMSUB(HMASMSPL);    /*                               */
         L     @15,@CV01327                                        0636
         LA    @01,@AL00636                                        0636
         BALR  @14,@15                                             0636
*     END;                          /*                               */
*                                                                  0637
*   /*****************************************************************/
*   /*                                                               */
*   /* NEED MESSAGE HER TO INDICATE SCDS ENTRIES COPIED BACK TO CDS  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0638
*   RETURN CODE(ZERO);              /*                               */
@RF00633 SLR   @15,@15                                             0638
         L     @14,@SA00011                                        0638
         LM    @00,@12,@SA00011+8                                  0638
         BR    @14                                                 0638
*   END BURTERM;                    /*                               */
*   END HMASMBUR                    /*                               */
*                                                                  0640
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */
*                                                                  0640
*       ;                                                          0640
@DATA    DS    0H
@CH00271 DC    H'0'
@CH00042 DC    H'1'
@CH00056 DC    H'4'
@CH00037 DC    H'8'
@CH00453 DC    H'9'
@CH01329 DC    H'47'
@CH01027 DC    H'54'
@CH01029 DC    H'55'
@CH00725 DC    H'56'
@CH01032 DC    H'57'
@CH01034 DC    H'58'
@CH01036 DC    H'59'
@CH00825 DC    H'60'
@CH01039 DC    H'61'
@CH00269 DC    H'62'
@CH00701 DC    H'63'
@CH01043 DC    H'64'
@CH01045 DC    H'65'
@CH01047 DC    H'66'
@CH01049 DC    H'67'
@CH01051 DC    H'68'
@CH01053 DC    H'69'
@CH01055 DC    H'70'
@CH01057 DC    H'71'
@CH01331 DC    H'205'
@CH01333 DC    H'212'
@CH00642 DC    H'255'
         DS    0F
@AL00282 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00289 DC    A(RSTX)                 LIST WITH   3 ARGUMENT(S)
@AL00190 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00350 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00374 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00440 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00609 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DC    A(SAVTYPE)
@AL00586 DC    A(CDDLX)                LIST WITH   3 ARGUMENT(S)
@AL00225 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00234 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00631 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00636 DC    A(HMASMSPL)             LIST WITH   1 ARGUMENT(S)
         DC    A(SAVTYPE)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    15F
@SA00010 DS    15F
@SA00008 DS    0F
@PC00008 EQU   @SA00008+60
@SA00006 DS    0F
@SA00007 DS    0F
@SA00005 DS    0F
@PC00005 EQU   @SA00005+60
@SA00004 DS    0F
@PC00004 EQU   @SA00004+60
@SA00011 DS    0F
@SA00009 DS    0F
@SA00002 DS    0F
         DS    18F
@AL00001 DS    3A
         DS    0F
@CF01461 DC    F'-8'
@CV01324 DC    V(HMASMIO)
@CV01325 DC    V(HMASMMSG)
@CV01326 DC    V(HMASMGTA)
@CV01327 DC    V(HMASMSUB)
         DS    0D
RSTX     DS    F
CDDLX    DS    F
SAVTYPE  DS    FL1
         DS    CL3
HMASMMGP DS    CL28
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00173 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00174 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL16
         ORG   MGPVAR
MGPVARPT DS    4A
         ORG   HMASMMGP+28
HMASMSPL DS    CL5
         ORG   HMASMSPL
SPLPMAD  DS    AL4
SPLFUNCT DS    FL1
         ORG   HMASMSPL+5
RSJMAP   DS    CL24
         ORG   RSJMAP
RSJTYPE  DS    FL1
RSJPNAME DS    CL8
RSJSNAME DS    CL8
RSJSMD   DS    CL7
         ORG   RSJMAP+24
BURSW    DS    BL1
         ORG   BURSW
SCDSFND  DS    BL1
CDSFND   EQU   BURSW+0
SCDSSTOW EQU   BURSW+0
CDSSTOW  EQU   BURSW+0
RESTADD  EQU   BURSW+0
RESTDEL  EQU   BURSW+0
@NM00178 EQU   BURSW+0
         ORG   BURSW+1
IOP4     DS    CL68
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CDDLRC   EQU   @03
IOPPTR4  EQU   @04
DELX     EQU   @03
DELRC    EQU   @05
COPYRC   EQU   @03
SCDNGRC  EQU   @06
NGCDSX   EQU   @03
NGSCDSX  EQU   @02
OKCDSX   EQU   @02
OKSCDSX  EQU   @03
CDSLOCRC EQU   @02
SCDLOCRC EQU   @02
RESTRC   EQU   @03
SETUPRC  EQU   @02
GTPPTR   EQU   @06
ACDSIOP  EQU   @04
ASCDSIOP EQU   @05
BURRTNCD EQU   @03
IOPPTR   EQU   @02
CCAPTR   EQU   @11
RTNCODE  EQU   @15
RTNREG   EQU   @14
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00011 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCACHECK EQU   CCAFLAG2
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCADSIDA EQU   0
CCATYPEA EQU   0
CCABLDLA EQU   0
@NM00027 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00029 EQU   CCABLDLL
CCALKDRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00039+20
@NM00041 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00041+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00045 EQU   HMASMIOP+12
@NM00046 EQU   @NM00045
IOPPTFNM EQU   @NM00046
IOPSEQNO EQU   @NM00045+8
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00156 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPRCDLN EQU   HMASMGTP+4
GTPKEYLN EQU   HMASMGTP+6
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
SPLPPACK EQU   0
SPLPUNPK EQU   0
SPLPDSN  EQU   0
SPLODSN  EQU   SPLPDSN
IOPBS01  EQU   0
IOPBS03  EQU   0
BUPPARM  EQU   0
BUPFUNCT EQU   BUPPARM
BUPFLAGS EQU   BUPPARM+3
BUPSYSMD EQU   BUPPARM+4
BUPGTPAD EQU   BUPPARM+16
SCDLOCX  EQU   0
SCDLOCNM EQU   0
SCDLOCTP EQU   0
CDSLOCX  EQU   0
CDSLOCNM EQU   0
CDSLOCTP EQU   0
CPYLOCNM EQU   0
CPYLOCTP EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00052 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00063 EQU   IOPUDATA
@NM00064 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPABUPT EQU   IOPABUNT
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00073 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPBUSMD EQU   IOPBUNT
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACND EQU   IOPMACID
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00084 EQU   IOPSRCDR+1
@NM00086 EQU   @NM00084+7
@NM00090 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00094 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00100 EQU   IOPMODDR+1
@NM00102 EQU   @NM00100+7
@NM00106 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00110 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODND EQU   IOPMODID
IOPMODST EQU   IOPLMODS+7
IOPMDIND EQU   IOPMNTRY+8
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00121 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00128 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00137 EQU   IOPPTFFX
@NM00138 EQU   @NM00137
IOPPDTES EQU   IOPPTFFX+41
@NM00141 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPPIND  EQU   IOPPNTRY+8
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00166 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00166
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00170 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00170
IOPBFTB1 EQU   IOPBFTB0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00172 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00171 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00169 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00168 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00167 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00165 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00164 EQU   IOPPTSFX+35
@NM00163 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00162 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00161 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00160 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00159 EQU   IOPQFMDR
@NM00155 EQU   IOPQSMDR
@NM00154 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00153 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00152 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00151 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00150 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00149 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00148 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00147 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00146 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00145 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00144 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00143 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPFMID EQU   IOPPTFFX+73
@NM00142 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00141+3
IOPRECD  EQU   @NM00141
@NM00140 EQU   IOPPTFFX+8
@NM00139 EQU   @NM00137+7
IOPPRELN EQU   @NM00138
@NM00136 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00135 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00134 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00133 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00132 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00131 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00130 EQU   @NM00128+7
@NM00129 EQU   @NM00128
@NM00127 EQU   IOPSYSDR+5
@NM00126 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00125 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00124 EQU   IOPDLBFX+8
@NM00123 EQU   @NM00121+7
@NM00122 EQU   @NM00121
@NM00120 EQU   IOPDLBDR+1
@NM00119 EQU   IOPDLBDR
@NM00118 EQU   IOPMODST
IOPDLIB  EQU   IOPMODFX+72
@NM00117 EQU   IOPMODFX+12
@NM00116 EQU   IOPMODF4
@NM00115 EQU   IOPMODF3
@NM00114 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00113 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00112 EQU   @NM00110+7
@NM00111 EQU   @NM00110
@NM00109 EQU   IOPMODDR+17
@NM00108 EQU   @NM00106+7
@NM00107 EQU   @NM00106
@NM00105 EQU   @NM00102
@NM00104 EQU   @NM00102
@NM00103 EQU   @NM00102
@NM00101 EQU   @NM00100
@NM00099 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00098 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00097 EQU   IOPSRCFX+8
@NM00096 EQU   @NM00094+7
@NM00095 EQU   @NM00094
@NM00093 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00092 EQU   @NM00090+7
@NM00091 EQU   @NM00090
@NM00089 EQU   @NM00086
@NM00088 EQU   @NM00086
@NM00087 EQU   @NM00086
@NM00085 EQU   @NM00084
@NM00083 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00082 EQU   IOPMACST
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00081 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
@NM00080 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00079 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00078 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00077 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00075 EQU   @NM00073+7
@NM00074 EQU   @NM00073
@NM00072 EQU   IOPLMDDR+6
@NM00071 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00070 EQU   IOPLMDF4
@NM00069 EQU   IOPLMDF3
@NM00068 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00067 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00066 EQU   IOPLMDDR
@NM00065 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00064+4
IOPUSED  EQU   @NM00064
IOPTPSEQ EQU   @NM00063+8
IOPVLSER EQU   @NM00063+2
IOPBLKSI EQU   @NM00063
IOPCQMAX EQU   IOPCQMAP+12
@NM00062 EQU   IOPCQMAP+11
@NM00061 EQU   IOPCQMAP+8
@NM00060 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00059 EQU   IOPSCMAP+11
@NM00058 EQU   IOPSCMAP+8
@NM00057 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00056 EQU   IOPNTMAX+11
@NM00055 EQU   IOPNTMAX+8
@NM00054 EQU   IOPNTMAX
@NM00053 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00052+5
IOPIPTF3 EQU   @NM00052
BUPIOPAD EQU   BUPPARM+12
@NM00002 EQU   BUPPARM+11
@NM00001 EQU   BUPFLAGS
BUPREDO  EQU   BUPFLAGS
BUPSTYPE EQU   BUPPARM+2
BUPTYPE  EQU   BUPPARM+1
SPLIFIL  EQU   SPLODSN+33
SPLISMD  EQU   SPLODSN+26
SPLIPFX  EQU   SPLODSN
SPLIUNPK EQU   SPLPUNPK+8
SPLOUNPK EQU   SPLPUNPK
SPLOPACK EQU   SPLPPACK+8
SPLIPACK EQU   SPLPPACK
@NM00177 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00176 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
@NM00175 EQU   HMASMGTP+2
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00158 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00157 EQU   @NM00156+7
IOPQSMFM EQU   @NM00156
@NM00076 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00051 EQU   IOPUSERL
@NM00050 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00049 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00048 EQU   @NM00045+10
@NM00047 EQU   @NM00046+7
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00044 EQU   CCABLDLM+2
@NM00043 EQU   CCABLDLM
CCAUPDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00041+12
CCAUPDTE EQU   @NM00041+8
CCAUPDNM EQU   @NM00041
CCASUPPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00039+12
CCAIOSUP EQU   @NM00039+8
CCASUPNM EQU   @NM00039
CCAZAPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00037+12
CCASPZAP EQU   @NM00037+8
CCAZAPNM EQU   @NM00037
CCACOMPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00035+12
CCACOMRS EQU   @NM00035+8
CCACOMNM EQU   @NM00035
CCACPYPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00033+12
CCACOPY  EQU   @NM00033+8
CCACPYNM EQU   @NM00033
CCAASMPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00031+12
CCAASM   EQU   @NM00031+8
CCAASMNM EQU   @NM00031
CCALKDPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00029+12
CCALKED  EQU   @NM00029+8
CCALKDNM EQU   @NM00029
CCAPGMPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCABPGRC EQU   @NM00027+20
CCABPGSP EQU   @NM00027+12
CCABPGAD EQU   @NM00027+8
CCABPGNM EQU   @NM00027
CCAEND   EQU   HMASMCCA+371
@NM00026 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00025 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00024 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00023 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00022 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00021 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00020 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00019 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00018 EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00017 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00016 EQU   @NM00011+18
@NM00015 EQU   @NM00011+16
CCATBLPA EQU   @NM00011+12
@NM00014 EQU   @NM00011+8
@NM00013 EQU   @NM00011+4
@NM00012 EQU   @NM00011
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00010 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00009 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00008 EQU   CCAFBUFR+122
@NM00007 EQU   CCAFBUFR+120
@NM00006 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00005 EQU   CCAFBUFR+88
@NM00004 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00003 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00300 EQU   @RC00299
@ENDDATA EQU   *
         END   HMASMBUR,(C'PLS1928',0802,78334)

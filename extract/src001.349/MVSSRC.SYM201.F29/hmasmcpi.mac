         TITLE 'HMASMCPI - SMP COPY ROUTINE INTERFACE'
HMASMCPI CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMCPI  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         EJECT
*                                                                  0229
*   /*****************************************************************/
*   /*                                                               */
*   /* PROGRAM INITIALIZATION                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0229
*   FLAGS=RESET;                    /* INITIALIZE COMPRESS FLAGS   0229
*                                                             @30XX9J*/
         MVI   FLAGS,X'00'                                         0229
*   CPIRTNCD=ZERO;                  /* INITIALIZE THE RC AREA      0230
*                                                            @YA07506*/
         SLR   CPIRTNCD,CPIRTNCD                                   0230
*   HMASMMGP=''B;                   /* CLEAR FLAGS           @ZA17732*/
         XC    HMASMMGP(40),HMASMMGP                               0231
*   MGPPRINT=ON;                    /* ALL MESSAGES TO PRINT @Z40SP00*/
*   MGPHLDS=ON;                     /* AND LOG               @Z40SP00*/
         OI    MGPPRINT,B'10010000'                                0233
*   IOPPTR=CCAIOPTR;                /* ADDRESSIBILITY FOR IOP        */
         MVC   IOPPTR(4),CCAIOPTR(CCAPTR)                          0234
*   SPLPMAD=ADDR(SUBDSN);           /* FOR SUB USE           @Z67SP00*/
         LA    @04,SUBDSN                                          0235
         ST    @04,SPLPMAD                                         0235
*   CPIDSN=BLANK;                   /* RELF DSN SAVE AREA    @Z67SP00*/
         MVI   CPIDSN+1,C' '                                       0236
         MVC   CPIDSN+2(42),CPIDSN+1                               0236
         MVI   CPIDSN,C' '                                         0236
*   RFY                                                            0237
*    (ICTLMOD) BASED(CCAICLMD);                                    0237
*   RFY                                                            0238
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0238
*   RFY                                                            0239
*    (ICTMOD) BASED(ICTIXL(J));                                    0239
*   RFY                                                            0240
*    (ICTPTF) BASED(ICTPPTR(1));                                   0240
*   RFY                                                            0241
*     RVAPARM BASED(CCARVAD);       /* FOR STAE              @Z67SP00*/
         EJECT
*                                                                  0242
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP PROCESSING LMODS AND INVOKING IEBCOPY UNTIL INDICATED TO */
*   /* STOP (CALLCOPY IS OFF).                               @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0242
*   CALLCOPY=ON;                    /*                       @Z67SP00*/
         OI    CALLCOPY,B'00100000'                                0242
*   DO WHILE CALLCOPY=ON            /*                       @Z67SP00*/
*         &CPIRTNCD<STOPFUNC;       /*                       @Z67SP00*/
*                                                                  0243
         B     @DE00243                                            0243
@DL00243 DS    0H                                                  0244
*     /***************************************************************/
*     /*                                                             */
*     /* THIS IS THE MAIN LOOP THRU THE ICT FROM THE LOAD MODULE TO  */
*     /* THE SYSMOD. PURPOSE IS TO SELECT THE LOAD MODULE TO PROCESS */
*     /* WITH THE ASSOCIATED MODULES. IT CHECKS TO SEE IS A NEW COPY */
*     /* STATEMENT IS NEEDED AND CREATES ONE IF SO. AFTER ALL THE    */
*     /* LOAD MODULES TO BE COPIED HAVE BEEN PROCESSED IEBCOPY IS    */
*     /* INVOKED. FINALLY THE RETURN CODE TO BE PASSED TO THE CALLING*/
*     /* ROUTINE AND CONTROL IS RETURNED.                            */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0244
*     INPUTDD='';                   /* INIT INDD AND OUTDD   @Z67SP00*/
         MVI   INPUTDD,C' '                                        0244
         MVC   INPUTDD+1(7),INPUTDD                                0244
*     OUTPUTDD='';                  /* AREA IN CASE REENTRY  @Z67SP00*/
         MVI   OUTPUTDD,C' '                                       0245
         MVC   OUTPUTDD+1(7),OUTPUTDD                              0245
*     COPYERR=OFF;                  /* RESET ERR SW          @Z67SP00*/
*     CALLCOPY=OFF;                 /*                       @Z67SP00*/
*     NEEDALLC=ON;                  /* NEED RELF ALLOCATION  @Z67SP00*/
         OI    NEEDALLC,B'00001000'                                0248
         NI    COPYERR,B'01011111'                                 0248
*     DO I=1 BY 1 WHILE ICTLEND(I)^=ICTENDNT/* LOOP THRU LOAD MODS   */
*           &CPIRTNCD<STOPFUNC;     /*                       @Z67SP00*/
         LA    I,1                                                 0249
         B     @DE00249                                            0249
@DL00249 DS    0H                                                  0250
*       IF ICTLCPY(I)=ON&ICTLCPL(I)=OFF/* COPY FUNCT AND NOT COMPLETE*/
*         THEN                                                     0250
         LR    @15,I                                               0250
         MH    @15,@CH01006                                        0250
         L     @14,CCAICLMD(,CCAPTR)                               0250
         ST    @15,@TF00001                                        0250
         ALR   @15,@14                                             0250
         AL    @15,@CF01914                                        0250
         TM    ICTLCPY-14(@15),B'00010000'                         0250
         BNO   @RF00250                                            0250
         AL    @14,@TF00001                                        0250
         AL    @14,@CF01915                                        0250
         TM    ICTLCPL-8(@14),B'00100000'                          0250
         BNZ   @RF00250                                            0250
*         DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX/* LOOP THRU MODS     */
*               &CPIRTNCD<STOPFUNC; /*                       @Z67SP00*/
*                                                                  0251
         LA    J,1                                                 0251
         B     @DE00251                                            0251
@DL00251 DS    0H                                                  0252
*           /*********************************************************/
*           /*                                                       */
*           /* IF ELEMENT IS SELECTED THEN CALL ROUTINE TO SETUP     */
*           /* IEBCOPY CONTROL CARDS IF THE ELEMENT IS BEING         */
*           /* PROCESSED IN THIS PASS TO IEBCOPY.            @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0252
*           IF ICTMMOD(1)=ON        /* MOD REPLACEMENT AND   @Z67SP00*/
*               &ICTMPROC(1)=OFF    /* NOT PROCESSED         @Z67SP00*/
*               &ICTMCPL(1)=OFF     /* NOT COMPLETED         @Z67SP00*/
*               &ICTMISEL(1)=ON THEN/* MOD SELECTED          @Z67SP00*/
         LR    @02,J                                               0252
         SLA   @02,2                                               0252
         LR    @15,I                                               0252
         MH    @15,@CH01006                                        0252
         L     @01,CCAICLMD(,CCAPTR)                               0252
         AL    @01,@CF01916                                        0252
         L     @01,ICTLCHN-34(@15,@01)                             0252
         AL    @01,@CF01917                                        0252
         L     @02,ICTIXL(@02,@01)                                 0252
         TM    ICTMMOD(@02),B'10000000'                            0252
         BNO   @RF00252                                            0252
         TM    ICTMPROC(@02),B'10100000'                           0252
         BNZ   @RF00252                                            0252
         TM    ICTMISEL(@02),B'10000000'                           0252
         BNO   @RF00252                                            0252
*             CALL LMDSETUP;        /*                       @Z67SP00*/
         BAL   @14,LMDSETUP                                        0253
*         END;                                                     0254
@RF00252 AH    J,@CH00085                                          0254
@DE00251 LR    @02,J                                               0254
         SLA   @02,2                                               0254
         LR    @15,I                                               0254
         MH    @15,@CH01006                                        0254
         L     @01,CCAICLMD(,CCAPTR)                               0254
         AL    @01,@CF01916                                        0254
         L     @01,ICTLCHN-34(@15,@01)                             0254
         AL    @01,@CF01917                                        0254
         L     @02,ICTIXL(@02,@01)                                 0254
         CL    @02,ICTENDIX                                        0254
         BE    @DC00251                                            0254
         CH    CPIRTNCD,@CH00032                                   0254
         BL    @DL00251                                            0254
@DC00251 DS    0H                                                  0255
*     END;                                                         0255
*                                                                  0255
@RF00250 AH    I,@CH00085                                          0255
@DE00249 LR    @15,I                                               0255
         MH    @15,@CH01006                                        0255
         L     @01,CCAICLMD(,CCAPTR)                               0255
         AL    @01,@CF01918                                        0255
         L     @15,ICTLEND(@15,@01)                                0255
         CL    @15,ICTENDNT                                        0255
         BE    @DC00249                                            0255
         CH    CPIRTNCD,@CH00032                                   0255
         BL    @DL00249                                            0255
@DC00249 DS    0H                                                  0256
*     /***************************************************************/
*     /*                                                             */
*     /* ALL ICT LMODS HAVE BEEN CHECKED AND CONTROL CARDS HAVE BEEN */
*     /* WRITTEN TO SYSUT1 FOR ALL PROCESSING TO BE DONE IN THIS     */
*     /* INVOCATION OF IEBCOPY. SET UP PARAMETERS AND LINK TO IEBCOPY*/
*     /* THEN PASS THRU ICT LMODS AGAIN TO SET UP FOR THE NEXT LINK. */
*     /*                                                     @Z67SP00*/
*     /* CLOSE SYSUT1 (CONTROL CARDS)                        @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0256
*     CALL CLOSE;                   /* CALL CLOSE ROUTINE            */
         BAL   @14,CLOSE                                           0256
*     IF CALLCOPY=ON                /* OK FOR IEBCOPY LINK   @Z40SP00*/
*         &CPIRTNCD<STOPFUNC THEN   /* AND NO ERRORS ABOVE   @Z40SP00*/
         TM    CALLCOPY,B'00100000'                                0257
         BNO   @RF00257                                            0257
         CH    CPIRTNCD,@CH00032                                   0257
         BNL   @RF00257                                            0257
*       DO;                         /* THEN LINK CAN BE DONE @Z40SP00*/
*                                                                  0258
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP IEBCOPY PARMS AND INVOKE IT.             @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0259
*         CALL CPILINK;             /*                       @Z67SP00*/
*                                                                  0259
         BAL   @14,CPILINK                                         0259
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MESSAGES FOR LMODS COPIED                 @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0260
*         CALL LMODMSG;             /*                       @Z67SP00*/
         BAL   @14,LMODMSG                                         0260
*       END;                        /* END OF IEBCOPY LINK DO      0261
*                                                            @Z40SP00*/
*                                                                  0261
*     /***************************************************************/
*     /*                                                             */
*     /* CALL ROUTINE TO FREE THE RELFILE IF ALLOCATED SO THAT IF CPL*/
*     /* HAS TO DO ANY DELETING OF RELFILES IT WILL BE ABLE TO DO IT */
*     /* SUCCESSFULLY                                        @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0262
*     CALL RELFDALC;                /*                       @Z67SP00*/
*                                                                  0262
@RF00257 BAL   @14,RELFDALC                                        0262
*     /***************************************************************/
*     /*                                                             */
*     /* DO SYSMOD COMPLETION PROCESSING.                    @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0263
*     IF CALLCPL=ON THEN            /* HMASMCPL NEEDED       @Z67SP00*/
         TM    CALLCPL,B'00000100'                                 0263
         BNO   @RF00263                                            0263
*       DO;                         /*                       @Z67SP00*/
*         IF COPYERR=OFF THEN       /*                       @Z67SP00*/
         TM    COPYERR,B'10000000'                                 0265
         BNZ   @RF00265                                            0265
*           STATUS=GOOD;            /* NORMAL CPL PROCESS    @Z67SP00*/
         MVI   STATUS,C'G'                                         0266
*         ELSE                      /*                       @Z67SP00*/
*           STATUS=BAD;             /* ERROR PARM            @Z67SP00*/
         B     @RC00265                                            0267
@RF00265 MVI   STATUS,C'B'                                         0267
*         CALL HMASMCPL(STATUS);    /*                       @Z67SP00*/
@RC00265 L     @15,@CV01657                                        0268
         LA    @01,@AL00268                                        0268
         BALR  @14,@15                                             0268
*         RFY                                                      0269
*           RTNCODE RSTD;           /*                       @Z67SP00*/
*         CPIRTNCD=MAX(CPIRTNCD,RTNCODE);/*                  @Z67SP00*/
         CR    CPIRTNCD,RTNCODE                                    0270
         BNL   *+6
         LR    CPIRTNCD,RTNCODE                                    0270
*         RFY                                                      0271
*           RTNCODE UNRSTD;         /*                       @Z67SP00*/
*         CALLCPL=OFF;              /* RESET INDICATOR       @Z67SP00*/
         NI    CALLCPL,B'11111011'                                 0272
*       END;                        /*                       @Z67SP00*/
*   END;                            /* MAJOR LOOP            @Z67SP00*/
@RF00263 DS    0H                                                  0274
@DE00243 TM    CALLCOPY,B'00100000'                                0274
         BNO   @DC00243                                            0274
         CH    CPIRTNCD,@CH00032                                   0274
         BL    @DL00243                                            0274
@DC00243 DS    0H                                                  0275
*                                                                  0275
*   /*****************************************************************/
*   /*                                                               */
*   /* MACRO AND SOURCE MODULES ARE NOW COPIED               @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0275
*   RFY                                                            0275
*     ICTMOD BASED(CCAICMOD);       /*                       @Z67SP00*/
*   CALLCOPY=ON;                    /*                       @Z67SP00*/
*                                                                  0276
         OI    CALLCOPY,B'00100000'                                0276
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCESSING WILL BE REPEATED UNTILL ALL INPUT FROM RELFILE*/
*   /* DATASETS HAVE BEEN PROCESSED.                         @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0277
*   DO WHILE CALLCOPY=ON&CPIRTNCD<STOPFUNC;/*                @Z67SP00*/
         B     @DE00277                                            0277
@DL00277 DS    0H                                                  0278
*     INPUTDD='';                   /* INIT INDD AND OUTDD   @Z67SP00*/
         MVI   INPUTDD,C' '                                        0278
         MVC   INPUTDD+1(7),INPUTDD                                0278
*     OUTPUTDD='';                  /* AREA IN CASE REENTRY  @Z67SP00*/
         MVI   OUTPUTDD,C' '                                       0279
         MVC   OUTPUTDD+1(7),OUTPUTDD                              0279
*     CALLCOPY=OFF;                 /* RESET IEBCOPY SWITCH  @Z67SP00*/
*     COPYERR=OFF;                  /* ERROR SW              @Z67SP00*/
*     NEEDALLC=ON;                  /* NEED RELF ALLOCTION   @Z67SP00*/
         OI    NEEDALLC,B'00001000'                                0282
         NI    CALLCOPY,B'01011111'                                0282
*     DO J=1 BY 1 WHILE ICTMEND(J)^=ICTENDNT/*               @Z67SP00*/
*           &CPIRTNCD<STOPFUNC;     /*                       @Z67SP00*/
         LA    J,1                                                 0283
         B     @DE00283                                            0283
@DL00283 DS    0H                                                  0284
*       IF(ICTMMACR(J)=ON×ICTMSRCR(J)=ON)/* MAC OR SRC       @Z67SP00*/
*           &ICTMISEL(J)=ON         /* SELECTED              @Z67SP00*/
*           &ICTMPROC(J)=OFF        /* NOT PROCESSED         @Z67SP00*/
*           &ICTMCPL(J)=OFF         /* NOT COMPLETED         @Z67SP00*/
*           &ICTMCOPY(J)=ON THEN    /* SHOULD BE COPIED      @Z67SP00*/
         LR    @04,J                                               0284
         MH    @04,@CH01900                                        0284
         L     @02,CCAICMOD(,CCAPTR)                               0284
         ST    @04,@TF00001                                        0284
         ALR   @04,@02                                             0284
         AL    @04,@CF01920                                        0284
         TM    ICTMMACR-9(@04),B'00001010'                         0284
         BZ    @RF00284                                            0284
         LR    @04,@02                                             0284
         AL    @04,@TF00001                                        0284
         AL    @04,@CF01921                                        0284
         TM    ICTMISEL-11(@04),B'10000000'                        0284
         BNO   @RF00284                                            0284
         LR    @04,@02                                             0284
         AL    @04,@TF00001                                        0284
         AL    @04,@CF01922                                        0284
         TM    ICTMPROC-8(@04),B'10100000'                         0284
         BNZ   @RF00284                                            0284
         AL    @02,@TF00001                                        0284
         AL    @02,@CF01923                                        0284
         TM    ICTMCOPY-12(@02),B'01000000'                        0284
         BNO   @RF00284                                            0284
*         DO;                       /*                       @Z67SP00*/
*                                                                  0285
*           /*********************************************************/
*           /*                                                       */
*           /* SELECT MACRO AND SOURCE MODULES FOR COPY IN THIS PASS */
*           /* TO IEBCOPY. IEBCOPY CONTROL STATEMENTS ARE BUILT ON   */
*           /* SYSUT1.                                       @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0286
*           CALL MACSETUP;          /*                       @Z67SP00*/
         BAL   @14,MACSETUP                                        0286
*         END;                      /*                       @Z67SP00*/
*     END;                          /* MOD ENTRY LOOP        @Z67SP00*/
@RF00284 AH    J,@CH00085                                          0288
@DE00283 LR    @04,J                                               0288
         MH    @04,@CH01900                                        0288
         L     @02,CCAICMOD(,CCAPTR)                               0288
         AL    @02,@CF01924                                        0288
         L     @04,ICTMEND(@04,@02)                                0288
         CL    @04,ICTENDNT                                        0288
         BE    @DC00283                                            0288
         CH    CPIRTNCD,@CH00032                                   0288
         BL    @DL00283                                            0288
@DC00283 DS    0H                                                  0289
*     CALL CLOSE;                   /*                       @Z67SP00*/
*                                                                  0289
         BAL   @14,CLOSE                                           0289
*     /***************************************************************/
*     /*                                                             */
*     /* IF NO ERRORS AND COPIES NEEDED SET UP FOR LINK      @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0290
*     IF CALLCOPY=ON                /*                       @Z67SP00*/
*         &CPIRTNCD<STOPFUNC THEN   /*                       @Z67SP00*/
         TM    CALLCOPY,B'00100000'                                0290
         BNO   @RF00290                                            0290
         CH    CPIRTNCD,@CH00032                                   0290
         BNL   @RF00290                                            0290
*       DO;                         /*                       @Z67SP00*/
*         CALL CPILINK;             /*                       @Z67SP00*/
*                                                                  0292
         BAL   @14,CPILINK                                         0292
*         /***********************************************************/
*         /*                                                         */
*         /* NOW ISSUE MESSAGE FOR COPIED MEMBERS            @Z67SP00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0293
*         CALL MACMSG;              /*                       @Z67SP00*/
         BAL   @14,MACMSG                                          0293
*       END;                        /*                       @Z67SP00*/
*                                                                  0294
*     /***************************************************************/
*     /*                                                             */
*     /* CALL ROUTINE TO FREE THE RELFILE IF ALLOCATED SO THAT IF CPL*/
*     /* HAS TO DO ANY DELETING OF RELFILES IT WILL BE ABLE TO DO IT */
*     /* SUCCESSFULLY                                        @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0295
*     CALL RELFDALC;                /*                       @Z67SP00*/
*                                                                  0295
@RF00290 BAL   @14,RELFDALC                                        0295
*     /***************************************************************/
*     /*                                                             */
*     /* DO SYSMOD COMPLETION PROCESSING.                    @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0296
*     IF CALLCPL=ON THEN            /* HMASMCPL NEEDED       @Z67SP00*/
         TM    CALLCPL,B'00000100'                                 0296
         BNO   @RF00296                                            0296
*       DO;                         /*                       @Z67SP00*/
*         IF COPYERR=OFF THEN       /*                       @Z67SP00*/
         TM    COPYERR,B'10000000'                                 0298
         BNZ   @RF00298                                            0298
*           STATUS=GOOD;            /* NORMAL CPL PROCESS    @Z67SP00*/
         MVI   STATUS,C'G'                                         0299
*         ELSE                      /*                       @Z67SP00*/
*           STATUS=BAD;             /* ERROR PARM            @Z67SP00*/
         B     @RC00298                                            0300
@RF00298 MVI   STATUS,C'B'                                         0300
*         CALL HMASMCPL(STATUS);    /*                       @Z67SP00*/
@RC00298 L     @15,@CV01657                                        0301
         LA    @01,@AL00301                                        0301
         BALR  @14,@15                                             0301
*         RFY                                                      0302
*           RTNCODE RSTD;           /*                       @Z67SP00*/
*         CPIRTNCD=MAX(CPIRTNCD,RTNCODE);/*                  @Z67SP00*/
         CR    CPIRTNCD,RTNCODE                                    0303
         BNL   *+6
         LR    CPIRTNCD,RTNCODE                                    0303
*         RFY                                                      0304
*           RTNCODE UNRSTD;         /*                       @Z67SP00*/
*         CALLCPL=OFF;              /* RESET INDICATOR       @Z67SP00*/
         NI    CALLCPL,B'11111011'                                 0305
*       END;                        /*                       @Z67SP00*/
*                                                                  0306
*     /***************************************************************/
*     /*                                                             */
*     /* END OF THIS PASS TO IEBCOPY. LOOP AGAIN FOR NEXT PASS IF    */
*     /* THERE ARE STILL ELEMENTS TO BE PROCESSED.           @Z67SP00*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0307
*   END;                            /* MAIN MAC/SRC COPY LOOP      0307
*                                                            @Z67SP00*/
*                                                                  0307
@RF00296 DS    0H                                                  0307
@DE00277 TM    CALLCOPY,B'00100000'                                0307
         BNO   @DC00277                                            0307
         CH    CPIRTNCD,@CH00032                                   0307
         BL    @DL00277                                            0307
@DC00277 DS    0H                                                  0308
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL IEBCOPY PROCESSING HAS FINISHED. RETURN WITH ERROR CODE.  */
*   /*                                                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0308
*   RETURN CODE(CPIRTNCD);          /*                       @YA07506*/
         LR    @15,CPIRTNCD                                        0308
         L     @13,4(,@13)                                         0308
         L     @14,12(,@13)                                        0308
         LM    @00,@12,20(@13)                                     0308
         BR    @14                                                 0308
*                                                                  0309
*   /*****************************************************************/
*   /*                                                               */
*   /* EACH ELEMENT IS CHECKED FOR PROCESSING IN THIS PASS TO        */
*   /* IEBCOPY.                                              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*   RFY                                                            0309
*    (ICTLMOD) BASED(CCAICLMD);                                    0309
*   RFY                                                            0310
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0310
*   RFY                                                            0311
*    (ICTMOD) BASED(ICTIXL(J));                                    0311
*   RFY                                                            0312
*    (ICTPTF) BASED(ICTPPTR(1));                                   0312
*LMDSETUP:                                                         0313
*   PROC;                           /*                       @Z67SP00*/
*                                                                  0313
@EL00001 L     @13,4(,@13)                                         0313
@EF00001 DS    0H                                                  0313
@ER00001 LM    @14,@12,12(@13)                                     0313
         BR    @14                                                 0313
LMDSETUP STM   @14,@04,@SA00002                                    0313
         STM   @06,@12,@SA00002+28                                 0313
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RELFILES AND IF THIS MOD IS ON RELFILE PROCESS IT IF*/
*   /* ITS FROM THE ONE BEING PROCESSED IN THIS PASS TO IEBCOPY.     */
*   /*                                                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0314
*   CALL TLIBCHK(ADDR(ICTMOD(1)));  /*                       @Z67SP00*/
         LR    @02,J                                               0314
         SLA   @02,2                                               0314
         LR    @15,I                                               0314
         MH    @15,@CH01006                                        0314
         L     @01,CCAICLMD(,CCAPTR)                               0314
         AL    @01,@CF01916                                        0314
         L     @01,ICTLCHN-34(@15,@01)                             0314
         AL    @01,@CF01917                                        0314
         L     @02,ICTIXL(@02,@01)                                 0314
         ST    @02,@AFTEMPS                                        0314
         LA    @01,@AL00314                                        0314
         BAL   @14,TLIBCHK                                         0314
*   IF TLIBOK=ON THEN               /* MOD CAN BE PROCESSED  @Z67SP00*/
         TM    TLIBOK,B'01000000'                                  0315
         BNO   @RF00315                                            0315
*     DO;                           /*                       @Z67SP00*/
*       ICTLPROC(I)=ON;             /* SET LM INPROCESS BIT ON       */
         LR    @02,I                                               0317
         MH    @02,@CH01006                                        0317
         L     @15,CCAICLMD(,CCAPTR)                               0317
         ST    @02,@TF00001                                        0317
         ALR   @02,@15                                             0317
         AL    @02,@CF01915                                        0317
         OI    ICTLPROC-8(@02),B'10000000'                         0317
*       ICTMPROC(1)=ON;             /* SET MOD INPROCESS BIT ON      */
         LR    @02,J                                               0318
         SLA   @02,2                                               0318
         L     @14,@TF00001                                        0318
         AL    @15,@CF01916                                        0318
         L     @01,ICTLCHN-34(@14,@15)                             0318
         AL    @01,@CF01917                                        0318
         L     @02,ICTIXL(@02,@01)                                 0318
         OI    ICTMPROC(@02),B'10000000'                           0318
*       CALLCOPY=ON;                /* OK FOR IEBCOPY LINK   @Z40SP00*/
*       CALLCPL=ON;                 /* HMASMCPL NEEDED       @Z67SP00*/
         OI    CALLCOPY,B'00100100'                                0320
*BLDCPY:                                                           0321
*       IF INPUTDD^=ICTFMLIB(1)×OUTPUTDD^=ICTTG1(I)/* SAME LIBS      */
*         THEN                                                     0321
BLDCPY   LR    @02,J                                               0321
         SLA   @02,2                                               0321
         LR    @15,I                                               0321
         MH    @15,@CH01006                                        0321
         L     @14,CCAICLMD(,CCAPTR)                               0321
         LA    @01,0(@15,@14)                                      0321
         AL    @01,@CF01916                                        0321
         L     @01,ICTLCHN-34(,@01)                                0321
         AL    @01,@CF01917                                        0321
         L     @02,ICTIXL(@02,@01)                                 0321
         CLC   INPUTDD(8),ICTFMLIB(@02)                            0321
         BNE   @RT00321                                            0321
         ALR   @14,@15                                             0321
         AL    @14,@CF01926                                        0321
         CLC   OUTPUTDD(8),ICTTG1-15(@14)                          0321
         BE    @RF00321                                            0321
@RT00321 DS    0H                                                  0322
*         DO;                                                      0322
*           INPUTDD=ICTFMLIB(1);    /* NO SET LIB FOR NEW CPY VERB   */
         LR    @02,J                                               0323
         SLA   @02,2                                               0323
         LR    @15,I                                               0323
         MH    @15,@CH01006                                        0323
         L     @14,CCAICLMD(,CCAPTR)                               0323
         LA    @01,0(@15,@14)                                      0323
         AL    @01,@CF01916                                        0323
         L     @01,ICTLCHN-34(,@01)                                0323
         AL    @01,@CF01917                                        0323
         L     @02,ICTIXL(@02,@01)                                 0323
         MVC   INPUTDD(8),ICTFMLIB(@02)                            0323
*           OUTPUTDD=ICTTG1(I);     /* SET LIB FOR NEW COPY VERB     */
         ALR   @14,@15                                             0324
         AL    @14,@CF01926                                        0324
         MVC   OUTPUTDD(8),ICTTG1-15(@14)                          0324
*           CALL WTRCOPY;           /* WRITE COPY VERB               */
         BAL   @14,WTRCOPY                                         0325
*         END;                                                     0326
*       IF ICTMNAME(1)=ICTLMNAM(I)  /* MOD AND LM NAMES SAME         */
*         THEN                                                     0327
@RF00321 LR    @02,J                                               0327
         SLA   @02,2                                               0327
         LR    @15,I                                               0327
         MH    @15,@CH01006                                        0327
         L     @14,CCAICLMD(,CCAPTR)                               0327
         LA    @01,0(@15,@14)                                      0327
         AL    @01,@CF01916                                        0327
         L     @01,ICTLCHN-34(,@01)                                0327
         AL    @01,@CF01917                                        0327
         L     @02,ICTIXL(@02,@01)                                 0327
         ST    @15,@TF00001                                        0327
         ALR   @15,@14                                             0327
         AL    @15,@CF01918                                        0327
         CLC   ICTMNAME(8,@02),ICTLMNAM(@15)                       0327
         BNE   @RF00327                                            0327
*         DO;                                                      0328
*           SELMOD=ICTLMNAM(I);     /* INDICATE MOD TO BE SELECTED   */
         AL    @14,@TF00001                                        0329
         AL    @14,@CF01918                                        0329
         MVC   SELMOD(8),ICTLMNAM(@14)                             0329
*           SYSMOD=ICTPTFS(1);      /* SYSMOD FOR COMMENT    @Z67SP00*/
         L     @02,ICTPPTR(,@02)                                   0330
         MVC   SYSMOD(7),ICTPTFS(@02)                              0330
*           CALL SELECT1;           /* YES, CALL SELECT ROUTINE 1    */
         BAL   @14,SELECT1                                         0331
*         END;                                                     0332
*       ELSE                                                       0333
*         DO;                                                      0333
         B     @RC00327                                            0333
@RF00327 DS    0H                                                  0334
*           SYSMOD=ICTPTFS(1);      /* SYSMOD FOR COMMENT    @Z67SP00*/
         LR    @02,J                                               0334
         SLA   @02,2                                               0334
         LR    @15,I                                               0334
         MH    @15,@CH01006                                        0334
         L     @14,CCAICLMD(,CCAPTR)                               0334
         LA    @01,0(@15,@14)                                      0334
         AL    @01,@CF01916                                        0334
         L     @01,ICTLCHN-34(,@01)                                0334
         AL    @01,@CF01917                                        0334
         L     @02,ICTIXL(@02,@01)                                 0334
         L     @01,ICTPPTR(,@02)                                   0334
         MVC   SYSMOD(7),ICTPTFS(@01)                              0334
*           SELMOD=ICTMNAME(1);     /* STORE MOD NAME        @Z67SP00*/
         MVC   SELMOD(8),ICTMNAME(@02)                             0335
*           LMODNM=ICTLMNAM(I);     /* LOAD MODULE NAME      @Z67SP00*/
         ALR   @14,@15                                             0336
         AL    @14,@CF01918                                        0336
         MVC   LMODNM(8),ICTLMNAM(@14)                             0336
*           CALL SELECT2;           /* CALL SELECT ROUTINE 2         */
         BAL   @14,SELECT2                                         0337
*         END;                                                     0338
*       IF ICTMALIS(1)=ON           /* MOD HAVE ALIAS ENTRIES        */
*         THEN                                                     0339
@RC00327 LR    @02,J                                               0339
         SLA   @02,2                                               0339
         LR    @15,I                                               0339
         MH    @15,@CH01006                                        0339
         L     @01,CCAICLMD(,CCAPTR)                               0339
         AL    @01,@CF01916                                        0339
         L     @01,ICTLCHN-34(@15,@01)                             0339
         AL    @01,@CF01917                                        0339
         L     @02,ICTIXL(@02,@01)                                 0339
         TM    ICTMALIS(@02),B'00000100'                           0339
         BNO   @RF00339                                            0339
*         CALL ALIAS(ICTMTCHN(1));  /* YES, CALL ALIAS               */
         LA    @02,ICTMTCHN(,@02)                                  0340
         ST    @02,@AL00001                                        0340
         LA    @01,@AL00001                                        0340
         BAL   @14,ALIAS                                           0340
*       IF ICTTG2(I)^=BLANKS        /* MULTIPLE TARGET LIBRARIES     */
*         THEN                                                     0341
@RF00339 LR    @02,I                                               0341
         MH    @02,@CH01006                                        0341
         L     @15,CCAICLMD(,CCAPTR)                               0341
         ST    @02,@TF00001                                        0341
         ALR   @02,@15                                             0341
         AL    @02,@CF01927                                        0341
         CLC   ICTTG2-23(8,@02),BLANKS                             0341
         BE    @RF00341                                            0341
*         DO;                                                      0342
*           ICTTG1(I)=ICTTG2(I);    /* SET TARGET TO FIRST           */
         LR    @02,@15                                             0343
         AL    @02,@TF00001                                        0343
         AL    @02,@CF01926                                        0343
         LR    @14,@15                                             0343
         AL    @14,@TF00001                                        0343
         AL    @14,@CF01927                                        0343
         MVC   ICTTG1-15(8,@02),ICTTG2-23(@14)                     0343
*           ICTTG2(I)=BLANKS;       /* SECOND TARGET IS BLANK        */
         AL    @15,@TF00001                                        0344
         AL    @15,@CF01927                                        0344
         MVC   ICTTG2-23(8,@15),BLANKS                             0344
*           GO TO BLDCPY;           /* COPY INTO NEXT LIBRARY        */
         B     BLDCPY                                              0345
*         END;                                                     0346
*                                                                  0346
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP CDS/ACDS SYSMOD ENTRY                      @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0347
*       IF CPIRTNCD<STOPFUNC THEN   /*                       @Z67SP00*/
@RF00341 CH    CPIRTNCD,@CH00032                                   0347
         BNL   @RF00347                                            0347
*         DO;                       /*                       @Z67SP00*/
*           CALL HMASMSEC(ICTPTFS(1),IOPPTR);/*              @Z67SP00*/
         LR    @02,J                                               0349
         SLA   @02,2                                               0349
         LR    @15,I                                               0349
         MH    @15,@CH01006                                        0349
         L     @01,CCAICLMD(,CCAPTR)                               0349
         AL    @01,@CF01916                                        0349
         L     @01,ICTLCHN-34(@15,@01)                             0349
         AL    @01,@CF01917                                        0349
         L     @02,ICTIXL(@02,@01)                                 0349
         L     @02,ICTPPTR(,@02)                                   0349
         ST    @02,@AL00001                                        0349
         LA    @02,IOPPTR                                          0349
         ST    @02,@AL00001+4                                      0349
         L     @15,@CV01659                                        0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*           RFY                                                    0350
*             RTNCODE RSTD;         /*                       @Z67SP00*/
*           CPIRTNCD=MAX(CPIRTNCD,RTNCODE);/*                @Z67SP00*/
         CR    CPIRTNCD,RTNCODE                                    0351
         BNL   *+6
         LR    CPIRTNCD,RTNCODE                                    0351
*           RFY                                                    0352
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/
*           ICTPROCS(1)=ON;         /* INPROCESS             @Z67SP00*/
         LR    @02,J                                               0353
         SLA   @02,2                                               0353
         LR    @15,I                                               0353
         MH    @15,@CH01006                                        0353
         L     @01,CCAICLMD(,CCAPTR)                               0353
         AL    @01,@CF01916                                        0353
         L     @01,ICTLCHN-34(@15,@01)                             0353
         AL    @01,@CF01917                                        0353
         L     @02,ICTIXL(@02,@01)                                 0353
         L     @02,ICTPPTR(,@02)                                   0353
         OI    ICTPROCS(@02),B'10000000'                           0353
*         END;                      /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*   END LMDSETUP;                   /*                       @Z67SP00*/
@EL00002 DS    0H                                                  0356
@EF00002 DS    0H                                                  0356
@ER00002 LM    @14,@04,@SA00002                                    0356
         LM    @06,@12,@SA00002+28                                 0356
         BR    @14                                                 0356
         EJECT
*                                                                  0357
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP CONTROL CARDS FOR A PASS TO IEBCOPY.           @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0357
*MACSETUP:                                                         0357
*   PROC;                           /*                       @Z67SP00*/
MACSETUP STM   @14,@04,@SA00003                                    0357
         STM   @06,@12,@SA00003+28                                 0357
*   RFY                                                            0358
*     ICTMOD BASED(CCAICMOD);       /*                       @Z67SP00*/
*   RFY                                                            0359
*     ICTPTF BASED(ICTPPTR(J));     /*                       @Z67SP00*/
*                                                                  0359
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RELFILES AND IF THIS MOD IS ON RELFILE PROCESS IT IF*/
*   /* ITS FROM THE ONE BEING PROCESSED IN THIS PASS TO IEBCOPY.     */
*   /*                                                       @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0360
*   CALL TLIBCHK(ADDR(ICTMOD(J)));  /*                       @Z67SP00*/
         LR    @04,J                                               0360
         MH    @04,@CH01900                                        0360
         L     @02,CCAICMOD(,CCAPTR)                               0360
         AL    @02,@CF01924                                        0360
         LA    @04,ICTMOD(@04,@02)                                 0360
         ST    @04,@AFTEMPS+4                                      0360
         LA    @01,@AL00360                                        0360
         BAL   @14,TLIBCHK                                         0360
*   IF TLIBOK=ON THEN               /* MOD CAN BE PROCESSED  @Z67SP00*/
         TM    TLIBOK,B'01000000'                                  0361
         BNO   @RF00361                                            0361
*     DO;                           /*                       @Z67SP00*/
*       ICTMPROC(J)=ON;             /* SET MOD INPROCESS BIT ON      */
         LR    @04,J                                               0363
         MH    @04,@CH01900                                        0363
         L     @02,CCAICMOD(,CCAPTR)                               0363
         ST    @04,@TF00001                                        0363
         ALR   @04,@02                                             0363
         AL    @04,@CF01922                                        0363
         OI    ICTMPROC-8(@04),B'10000000'                         0363
*       CALLCOPY=ON;                /* OK FOR IEBCOPY LINK   @Z40SP00*/
*       CALLCPL=ON;                 /* HMASMCPL NEEDED       @Z67SP00*/
         OI    CALLCOPY,B'00100100'                                0365
*       IF INPUTDD^=ICTFMLIB(J)×OUTPUTDD^=ICTTOLIB(J)/*      @Z67SP00*/
*         THEN                                                     0366
         LR    @04,@02                                             0366
         AL    @04,@TF00001                                        0366
         AL    @04,@CF01928                                        0366
         CLC   INPUTDD(8),ICTFMLIB-24(@04)                         0366
         BNE   @RT00366                                            0366
         AL    @02,@TF00001                                        0366
         AL    @02,@CF01929                                        0366
         CLC   OUTPUTDD(8),ICTTOLIB-32(@02)                        0366
         BE    @RF00366                                            0366
@RT00366 DS    0H                                                  0367
*         DO;                                                      0367
*           INPUTDD=ICTFMLIB(J);    /* NO SET LIB FOR NEW CPY VERB   */
         LR    @04,J                                               0368
         MH    @04,@CH01900                                        0368
         L     @02,CCAICMOD(,CCAPTR)                               0368
         ST    @04,@TF00001                                        0368
         ALR   @04,@02                                             0368
         AL    @04,@CF01928                                        0368
         MVC   INPUTDD(8),ICTFMLIB-24(@04)                         0368
*           OUTPUTDD=ICTTOLIB(J);   /* SET LIB FOR NEW COPY VERB     */
         AL    @02,@TF00001                                        0369
         AL    @02,@CF01929                                        0369
         MVC   OUTPUTDD(8),ICTTOLIB-32(@02)                        0369
*           CALL WTRCOPY;           /* WRITE COPY VERB               */
         BAL   @14,WTRCOPY                                         0370
*         END;                                                     0371
*       SELMOD=ICTMNAME(J);         /* INDICATE MOD TO BE SELECTED   */
@RF00366 LR    @04,J                                               0372
         MH    @04,@CH01900                                        0372
         L     @02,CCAICMOD(,CCAPTR)                               0372
         ST    @04,@TF00001                                        0372
         ALR   @04,@02                                             0372
         AL    @04,@CF01924                                        0372
         MVC   SELMOD(8),ICTMNAME(@04)                             0372
*       SYSMOD=ICTPTFS(1);          /* SYSMOD FOR COMMENT    @Z67SP00*/
         L     @04,@TF00001                                        0373
         AL    @02,@CF01930                                        0373
         L     @04,ICTPPTR-96(@04,@02)                             0373
         MVC   SYSMOD(7),ICTPTFS(@04)                              0373
*       CALL SELECT1;               /* YES, CALL SELECT ROUTINE 1    */
         BAL   @14,SELECT1                                         0374
*       IF ICTMALIS(J)=ON           /* MOD HAVE ALIAS ENTRIES        */
*         THEN                                                     0375
         LR    @04,J                                               0375
         MH    @04,@CH01900                                        0375
         L     @02,CCAICMOD(,CCAPTR)                               0375
         ST    @04,@TF00001                                        0375
         ALR   @04,@02                                             0375
         AL    @04,@CF01931                                        0375
         TM    ICTMALIS-10(@04),B'00000100'                        0375
         BNO   @RF00375                                            0375
*         CALL ALIAS(ICTMTCHN(J));  /* YES, CALL ALIAS       @Z67SP00*/
*                                                                  0376
         L     @04,@TF00001                                        0376
         AL    @02,@CF01932                                        0376
         LA    @04,ICTMTCHN-116(@04,@02)                           0376
         ST    @04,@AL00001                                        0376
         LA    @01,@AL00001                                        0376
         BAL   @14,ALIAS                                           0376
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP CDS/ACDS SYSMOD ENTRY                      @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0377
*       IF CPIRTNCD<STOPFUNC THEN   /*                       @Z67SP00*/
@RF00375 CH    CPIRTNCD,@CH00032                                   0377
         BNL   @RF00377                                            0377
*         DO;                       /*                       @Z67SP00*/
*           CALL HMASMSEC(ICTPTFS(1),IOPPTR);/*              @Z67SP00*/
         LR    @04,J                                               0379
         MH    @04,@CH01900                                        0379
         L     @02,CCAICMOD(,CCAPTR)                               0379
         AL    @02,@CF01930                                        0379
         L     @04,ICTPPTR-96(@04,@02)                             0379
         ST    @04,@AL00001                                        0379
         LA    @04,IOPPTR                                          0379
         ST    @04,@AL00001+4                                      0379
         L     @15,@CV01659                                        0379
         LA    @01,@AL00001                                        0379
         BALR  @14,@15                                             0379
*           RFY                                                    0380
*             RTNCODE RSTD;         /*                       @Z67SP00*/
*           CPIRTNCD=MAX(CPIRTNCD,RTNCODE);/*                @Z67SP00*/
         CR    CPIRTNCD,RTNCODE                                    0381
         BNL   *+6
         LR    CPIRTNCD,RTNCODE                                    0381
*           RFY                                                    0382
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/
*           ICTPROCS(1)=ON;         /* SYSMOD INPROCESS      @Z67SP00*/
         LR    @04,J                                               0383
         MH    @04,@CH01900                                        0383
         L     @02,CCAICMOD(,CCAPTR)                               0383
         AL    @02,@CF01930                                        0383
         L     @04,ICTPPTR-96(@04,@02)                             0383
         OI    ICTPROCS(@04),B'10000000'                           0383
*         END;                      /*                       @Z67SP00*/
*     END;                          /*                       @Z67SP00*/
*   END MACSETUP;                   /*                       @Z67SP00*/
@EL00003 DS    0H                                                  0386
@EF00003 DS    0H                                                  0386
@ER00003 LM    @14,@04,@SA00003                                    0386
         LM    @06,@12,@SA00003+28                                 0386
         BR    @14                                                 0386
*                                                                  0387
*   /*****************************************************************/
*   /*                                                               */
*   /* EACH MOD IS CHECK FOR A RELFILE FROMLIB. IF IT INDICATES      */
*   /* RELFILE AND THE RELFILE IS THE ONE BEING PROCESSED IN THIS    */
*   /* PASS TO IEBCOPY THEN THE MOD IS ELIGIBLE FOR PROCESSING       */
*   /* OTHERWISE THE MOD IS SKIPPED BY THE CALLER            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0387
*TLIBCHK:                                                          0387
*   PROC(MODADDR);                  /*                       @Z67SP00*/
TLIBCHK  STM   @14,@04,@SA00004                                    0387
         STM   @06,@12,@SA00004+28                                 0387
         MVC   @PC00004(4),0(@01)                                  0387
*   DCL                                                            0388
*     MODADDR PTR(31);              /* ICT ENTRY ADDR        @Z67SP00*/
*   RFY                                                            0389
*    (ICTMOD) BASED(MODADDR);       /*                       @Z67SP00*/
*   RFY                                                            0390
*    (ICTPTF) BASED(ICTPPTR(1));                                   0390
*                                                                  0390
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INDICATOR FOR TARGET LIB VALID, WILL BE TURNED OFF IF IT  */
*   /* IS ON RELFILE NOT ELIGIBLE IN THIS PASS.              @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0391
*   TLIBOK=ON;                      /*                       @Z67SP00*/
*                                                                  0391
         OI    TLIBOK,B'01000000'                                  0391
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARMS TO CONSTRUCT THE RELFILE DSN             @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0392
*   IF ICTMRELF(1)=ON THEN          /* ON A RELFILE?         @Z67SP00*/
         L     @04,@PC00004                                        0392
         L     @04,MODADDR(,@04)                                   0392
         TM    ICTMRELF(@04),B'00100000'                           0392
         BNO   @RF00392                                            0392
*     DO;                           /*                       @Z67SP00*/
*       SPLFUNCT=SPLBDDSN;          /* BUILD RELFILE DSN     @Z67SP00*/
         MVI   SPLFUNCT,X'05'                                      0394
*       SPLIPFX=ICTPTPFX(1);        /* PREFIX                @Z67SP00*/
         L     @15,SPLPMAD                                         0395
         L     @14,ICTPPTR(,@04)                                   0395
         MVC   SPLIPFX(26,@15),ICTPTPFX(@14)                       0395
*       SPLISMD=ICTPTFS(1);         /* SYSMOD NUMBER         @Z67SP00*/
         MVC   SPLISMD(7,@15),ICTPTFS(@14)                         0396
*       SPLIFIL=ICTMRELN(1);        /* FILE NUMBER           @Z67SP00*/
         MVC   SPLIFIL(2,@15),ICTMRELN(@04)                        0397
*       CALL HMASMSUB(HMASMSPL);    /*                       @Z67SP00*/
*                                                                  0398
         L     @15,@CV01658                                        0398
         LA    @01,@AL00398                                        0398
         BALR  @14,@15                                             0398
*       /*************************************************************/
*       /*                                                           */
*       /* RELFILE ALLOCATION IS NEEDED IF THIS IS THE FIRST PASSS   */
*       /* THRU FOR MEMEBERS FROM THIS PARTICULAR RELFILE DATA SET.  */
*       /*                                                   @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0399
*       IF NEEDALLC=ON THEN         /* NEED RELF ALLOCATION  @Z67SP00*/
         TM    NEEDALLC,B'00001000'                                0399
         BNO   @RF00399                                            0399
*         DO;                       /*                       @Z67SP00*/
*                                                                  0400
*           /*********************************************************/
*           /*                                                       */
*           /* FREE ANY PREVIOSLY ALLOCATED RELFILES         @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0401
*           CALL RELFDALC;          /* FREE RELFILE FIRST    @Z67SP00*/
         BAL   @14,RELFDALC                                        0401
*           CPIDSN=SPLODSN;         /* INIT COMPARE AREA     @Z67SP00*/
*                                                                  0402
         L     @04,SPLPMAD                                         0402
         MVC   CPIDSN(44),SPLODSN(@04)                             0402
*           /*********************************************************/
*           /*                                                       */
*           /* ALLOCATE DSN TO SMPLIB DD NAME.               @Z67SP00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0403
*           IOPFUNCT=IOPALC;        /*                       @Z67SP00*/
         L     @15,IOPPTR                                          0403
         MVI   IOPFUNCT(@15),X'0D'                                 0403
*           IOPDSID=IOPLRF;         /*                       @Z67SP00*/
         MVI   IOPDSID(@15),X'20'                                  0404
*           IOPDSN=SPLODSN;         /*                       @Z67SP00*/
         MVC   IOPDSN(44,@15),SPLODSN(@04)                         0405
*           IOPSPACE=''B;           /*                       @Z67SP00*/
         XC    IOPSPACE(6,@15),IOPSPACE(@15)                       0406
*           CALL HMASMIO(HMASMIOP); /*                       @Z67SP00*/
         ST    @15,@AL00001                                        0407
         L     @15,@CV01656                                        0407
         LA    @01,@AL00001                                        0407
         BALR  @14,@15                                             0407
*           CPIRTNCD=MAX(CPIRTNCD,IOPRETRN);/*               @Z67SP00*/
         L     @04,IOPPTR                                          0408
         SLR   @15,@15                                             0408
         IC    @15,IOPRETRN(,@04)                                  0408
         CR    CPIRTNCD,@15                                        0408
         BNL   *+6
         LR    CPIRTNCD,@15                                        0408
*           RELFALLC=ON;            /* RELFILE ALLOCED       @Z67SP00*/
*           NEEDALLC=OFF;           /* ANOTHER NOT NEEDED FOR THIS 0410
*                                      RELFILE DATASET       @Z67SP00*/
         OI    RELFALLC,B'00010000'                                0410
         NI    NEEDALLC,B'11110111'                                0410
*         END;                      /*                       @Z67SP00*/
*                                                                  0411
*       /*************************************************************/
*       /*                                                           */
*       /* NOT AN ELIGIBLE RELFILE FOR THIS PASS .           @Z67SP00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0412
*       IF CPIDSN^=SPLODSN THEN     /* THIS RELFILE OK       @Z67SP00*/
@RF00399 L     @04,SPLPMAD                                         0412
         CLC   CPIDSN(44),SPLODSN(@04)                             0412
         BE    @RF00412                                            0412
*         TLIBOK=OFF;               /*                       @Z67SP00*/
         NI    TLIBOK,B'10111111'                                  0413
*     END;                          /*                       @Z67SP00*/
*   END TLIBCHK;                    /*                       @Z67SP00*/
@EL00004 DS    0H                                                  0415
@EF00004 DS    0H                                                  0415
@ER00004 LM    @14,@04,@SA00004                                    0415
         LM    @06,@12,@SA00004+28                                 0415
         BR    @14                                                 0415
*                                                                  0416
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP INVOCATION PARMS AND LINK TO IEBCOPY. CHECK ERROR CODE */
*   /* UPON RETURN.                                          @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*   RFY                                                            0416
*    (ICTLMOD) BASED(CCAICLMD);                                    0416
*   RFY                                                            0417
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0417
*   RFY                                                            0418
*    (ICTMOD) BASED(ICTIXL(J));                                    0418
*   RFY                                                            0419
*    (ICTPTF) BASED(ICTPPTR(1));                                   0419
*CPILINK:                                                          0420
*   PROC;                           /*                       @Z67SP00*/
*                                                                  0420
CPILINK  STM   @14,@04,@SA00005                                    0420
         STM   @06,@12,@SA00005+28                                 0420
*   /*****************************************************************/
*   /*                                                               */
*   /* GET USER SUPPLIED PARMS                               @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0421
*   DO X=1 BY 1 WHILE CCACPYPM(X)^=BLANK;/* MOVE ANY         @Z67SP00*/
         LA    X,1                                                 0421
         B     @DE00421                                            0421
@DL00421 DS    0H                                                  0422
*     OPTVAR(X)=CCACPYPM(X);        /* PARMS                 @Z67SP00*/
         LA    @04,OPTVAR-1(X)                                     0422
         L     @02,CCABLDLP(,CCAPTR)                               0422
         ALR   @02,X                                               0422
         MVC   0(1,@04),CCACPYPM-1(@02)                            0422
*   END;                            /*                       @Z67SP00*/
         AH    X,@CH00085                                          0423
@DE00421 L     @04,CCABLDLP(,CCAPTR)                               0423
         LR    @02,@04                                             0423
         ALR   @02,X                                               0423
         CLI   CCACPYPM-1(@02),C' '                                0423
         BNE   @DL00421                                            0423
*   OPTLGTH=X-1;                    /* LENGTH OF FIELD       @Z67SP00*/
         LR    @02,X                                               0424
         BCTR  @02,0                                               0424
         STH   @02,OPTLGTH                                         0424
*   SYSPRINT=CCACPYSP;              /* SYSPRINT DD NAME      @Z67SP00*/
*                                                                  0425
         MVC   SYSPRINT(8),CCACPYSP(@04)                           0425
*   /*****************************************************************/
*   /*                                                               */
*   /* STAE INTERFACE                                        @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0426
*   SAVRVANM=RVAEPRNM;              /* SAVE RVA NMAE         @Z67SP00*/
         L     @15,CCARVAD(,CCAPTR)                                0426
         MVC   SAVRVANM(8),RVAEPRNM(@15)                           0426
*   RVAEPRNM=CCACPYNM;              /* COPY PROC NM          @Z67SP00*/
         MVC   RVAEPRNM(8,@15),CCACPYNM(@04)                       0427
*   RFY                                                            0428
*     LINKREG RSTD;                                                0428
*   LINKREG=CCACOPY;                /* ADDR OF BLDL ENTRY-IEBCOPY    */
         L     LINKREG,CCACOPY(,@04)                               0429
*   GENERATE;                                                      0430
         LINK DE=(LINKREG),PARAM=(OPTLST,DDNAMES),VL=1 EXEC IEBCOPY  */
*   RFY                                                            0431
*     RTNCODE RSTD;                 /*                       @SA77276*/
*   RFY                                                            0432
*     LINKREG UNRSTD;                                              0432
*                                                                  0432
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET RVA PROGRAM NAME                                @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0433
*   RVAEPRNM=SAVRVANM;              /*                       @Z67SP00*/
         L     @14,CCARVAD(,CCAPTR)                                0433
         MVC   RVAEPRNM(8,@14),SAVRVANM                            0433
*   CVD(RTNCODE,SAVE1);             /* TO DECIMAL                    */
         CVD   RTNCODE,SAVE1                                       0434
*   UNPK(SAVE2,SAVE1);              /* UNPACK                        */
         UNPK  SAVE2(8),SAVE1(8)                                   0435
*   SIGN=MASK;                      /* ELIMINATE SIGN                */
         OI    SIGN,B'11110000'                                    0436
*   IF RTNCODE>CCARCOPY             /* HAVE WE EXCEEDED THE MAXIMUM?
*                                                            @YA07506*/
*     THEN                                                         0437
         L     @14,CCABLDLP(,CCAPTR)                               0437
         SLR   @04,@04                                             0437
         IC    @04,CCARCOPY(,@14)                                  0437
         CR    RTNCODE,@04                                         0437
         BNH   @RF00437                                            0437
*     DO;                                                          0438
*       COPYERR=ON;                 /* INDICATE ERROR                */
         OI    COPYERR,B'10000000'                                 0439
*       IF CPIRTNCD<STOPPTF         /* CHANGE RC?            @YA07506*/
*         THEN                                                     0440
         LA    @14,8                                               0440
         CR    CPIRTNCD,@14                                        0440
         BNL   @RF00440                                            0440
*         CPIRTNCD=STOPPTF;         /* YES-DO IT             @YA07506*/
         LR    CPIRTNCD,@14                                        0441
*     END;                                                         0442
*   ELSE                                                           0443
*     DO;                                                          0443
         B     @RC00437                                            0443
@RF00437 DS    0H                                                  0444
*       IF RTNCODE^=ZERO            /* ERROR?                @YA07506*/
*         THEN                                                     0444
         LTR   RTNCODE,RTNCODE                                     0444
         BZ    @RF00444                                            0444
*         IF CPIRTNCD<WARNPTF       /* CHANGE RC?            @YA07506*/
*           THEN                                                   0445
         LA    @14,4                                               0445
         CR    CPIRTNCD,@14                                        0445
         BNL   @RF00445                                            0445
*           CPIRTNCD=WARNPTF;       /* YES- DO IT            @YA07506*/
         LR    CPIRTNCD,@14                                        0446
*       RFY                                                        0447
*         RTNCODE UNRSTD;           /*                       @SA77276*/
@RF00445 DS    0H                                                  0447
@RF00444 DS    0H                                                  0448
*     END;                                                         0448
*   END CPILINK;                    /*                       @Z67SP00*/
@EL00005 DS    0H                                                  0449
@EF00005 DS    0H                                                  0449
@ER00005 LM    @14,@04,@SA00005                                    0449
         LM    @06,@12,@SA00005+28                                 0449
         BR    @14                                                 0449
*                                                                  0450
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE IS INVOKED WHEN A COPY HAS BEEN SUCCESSFULLY   */
*   /* COMPLETED. MESSAGES ARE ISSUED FOR ALL LOAD MODS AND MODS THAT*/
*   /* WERE COPIED AND MARKS THE SYSMOD, MODULE, AND LOAD MOD        */
*   /* COMPLETE.                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*LMODMSG:                                                          0450
*   PROCEDURE OPTIONS(SAVEAREA);                                   0450
LMODMSG  STM   @14,@12,12(@13)                                     0450
         ST    @13,@SA00006+4                                      0450
         LA    @14,@SA00006                                        0450
         ST    @14,8(,@13)                                         0450
         LR    @13,@14                                             0450
*   RFY                                                            0451
*    (ICTLMOD) BASED(CCAICLMD);                                    0451
*   RFY                                                            0452
*    (ICTIXLF) BASED(ICTLCHN(K));                                  0452
*   RFY                                                            0453
*    (ICTMOD) BASED(ICTIXL(L));                                    0453
*   RFY                                                            0454
*    (ICTPTF) BASED(ICTPPTR(1));                                   0454
*   DCL                                                            0455
*     OUTCOME CHAR(10);             /* SUCC OR FAIL IN MSG   @Z67SP00*/
*   DO K=1 BY 1 WHILE ICTLEND(K)^=ICTENDNT;/* LOOP THRU LM           */
         LA    K,1                                                 0456
         B     @DE00456                                            0456
@DL00456 DS    0H                                                  0457
*     IF ICTLPROC(K)=ON&ICTLCPL(K)=OFF/* INPROCESS-NOT COMP          */
*       THEN                                                       0457
         LR    @05,K                                               0457
         MH    @05,@CH01006                                        0457
         L     @01,CCAICLMD(,CCAPTR)                               0457
         ALR   @01,@05                                             0457
         AL    @01,@CF01915                                        0457
         TM    ICTLPROC-8(@01),B'10000000'                         0457
         BNO   @RF00457                                            0457
         TM    ICTLCPL-8(@01),B'00100000'                          0457
         BNZ   @RF00457                                            0457
*       DO;                                                        0458
*         L=L1;                     /* ACCESS TO FIRST MOD           */
         LA    L,1                                                 0459
*         DO L=1 BY 1 WHILE ICTIXL(L)^=ICTENDIX;/* SEARCH MOD        */
         LA    L,1                                                 0460
         B     @DE00460                                            0460
@DL00460 DS    0H                                                  0461
*           IF ICTMCPL(1)=OFF       /* MOD NOT COMPLETE ...          */
*               &ICTMPROC(1)=ON     /* ... AND IN PROCESS            */
*             THEN                                                 0461
         LR    @05,L                                               0461
         SLA   @05,2                                               0461
         LR    @02,K                                               0461
         MH    @02,@CH01006                                        0461
         L     @01,CCAICLMD(,CCAPTR)                               0461
         AL    @01,@CF01916                                        0461
         L     @02,ICTLCHN-34(@02,@01)                             0461
         AL    @02,@CF01917                                        0461
         L     @05,ICTIXL(@05,@02)                                 0461
         TM    ICTMPROC(@05),B'10000000'                           0461
         BNO   @RF00461                                            0461
         TM    ICTMCPL(@05),B'00100000'                            0461
         BNZ   @RF00461                                            0461
*             DO;                                                  0462
*               IF COPYERR=OFF THEN /* GOOD COPY             @Z67SP00*/
         TM    COPYERR,B'10000000'                                 0463
         BNZ   @RF00463                                            0463
*                 OUTCOME=TXTSUCC;  /* INDICATE SUCCESS      @Z67SP00*/
         MVC   OUTCOME(10),@CC01667                                0464
*               ELSE                /* BAD COPY              @Z67SP00*/
*                 OUTCOME=TXTFAIL;  /* INDICATE FAILURE      @Z67SP00*/
         B     @RC00463                                            0465
@RF00463 MVC   OUTCOME(10),@CC01670                                0465
*               MGPCLEAR=''B;       /* CLEAR MESSAGES        @ZD00005*/
@RC00463 XC    MGPCLEAR(6),MGPCLEAR                                0466
*               MGPPRINT=ON;        /* INDICATE PRINTER              */
*               MGPHLDS=ON;         /* AND LOG               @Z40SP00*/
         OI    MGPPRINT,B'10010000'                                0468
*               MGPMGNO1=HMA238I;   /* COPY MESSAGE          @ZD00005*/
         MVC   MGPMGNO1(2),@CH00485                                0469
*               MGPVARPT(1)=ADDR(OUTCOME);/* SUCCESS OR FAIL @Z67SP00*/
         LA    @05,OUTCOME                                         0470
         ST    @05,MGPVARPT                                        0470
*               MGPVARPT(2)=ADDR(ICTMNAME(1));/* FOR MODULE  @ZD00005*/
         LR    @05,L                                               0471
         SLA   @05,2                                               0471
         LR    @02,K                                               0471
         MH    @02,@CH01006                                        0471
         L     @15,CCAICLMD(,CCAPTR)                               0471
         LA    @01,0(@02,@15)                                      0471
         AL    @01,@CF01916                                        0471
         L     @01,ICTLCHN-34(,@01)                                0471
         AL    @01,@CF01917                                        0471
         L     @05,ICTIXL(@05,@01)                                 0471
         ST    @05,MGPVARPT+4                                      0471
*               MGPVARPT(3)=ADDR(ICTLMNAM(K));/* LOAD MOD =  @ZD00005*/
         LA    @01,0(@02,@15)                                      0472
         AL    @01,@CF01918                                        0472
         ST    @01,MGPVARPT+8                                      0472
*               MGPVARPT(4)=ADDR(ICTTG1(K));/* LIBRARY NAME  @ZD00005*/
         AL    @15,@CF01926                                        0473
         LA    @02,ICTTG1-15(@02,@15)                              0473
         ST    @02,MGPVARPT+12                                     0473
*               MGPVARPT(5)=ADDR(ICTPTFS(1));/* SYSMOD       @Z67SP00*/
         L     @05,ICTPPTR(,@05)                                   0474
         ST    @05,MGPVARPT+16                                     0474
*               MGPVARPT(6)=ADDR(LINKRTN);/* RETURN CODE     @Z67SP00*/
         LA    @05,LINKRTN                                         0475
         ST    @05,MGPVARPT+20                                     0475
*               IF LINKRTN=OK THEN  /* MESSAGE SEVERITY      @ZD00005*/
         CLC   LINKRTN(2),@CC01742                                 0476
         BNE   @RF00476                                            0476
*                 MGPTYPE=MGPINFO;  /*                       @ZD00005*/
         MVI   MGPTYPE,X'01'                                       0477
*               ELSE                /*                       @ZD00005*/
*                 IF COPYERR=ON THEN/* TERMINATE SYSMOD      @ZD00005*/
         B     @RC00476                                            0478
@RF00476 TM    COPYERR,B'10000000'                                 0478
         BNO   @RF00478                                            0478
*                   MGPTYPE=MGPERR; /*                       @ZD00005*/
         MVI   MGPTYPE,X'03'                                       0479
*                 ELSE              /*                       @ZD00005*/
*                   MGPTYPE=MGPWARN;/* WARNING               @ZD00005*/
         B     @RC00478                                            0480
@RF00478 MVI   MGPTYPE,X'02'                                       0480
*               CALL HMASMMSG(HMASMMGP);/* CALL MSG ROUTINE          */
@RC00478 DS    0H                                                  0481
@RC00476 L     @15,@CV01660                                        0481
         LA    @01,@AL00481                                        0481
         BALR  @14,@15                                             0481
*             END;                                                 0482
*         END;                                                     0483
@RF00461 AH    L,@CH00085                                          0483
@DE00460 LR    @05,L                                               0483
         SLA   @05,2                                               0483
         LR    @02,K                                               0483
         MH    @02,@CH01006                                        0483
         L     @01,CCAICLMD(,CCAPTR)                               0483
         AL    @01,@CF01916                                        0483
         L     @02,ICTLCHN-34(@02,@01)                             0483
         AL    @02,@CF01917                                        0483
         L     @05,ICTIXL(@05,@02)                                 0483
         CL    @05,ICTENDIX                                        0483
         BNE   @DL00460                                            0483
*       END;                                                       0484
*   END;                                                           0485
@RF00457 AH    K,@CH00085                                          0485
@DE00456 LR    @05,K                                               0485
         MH    @05,@CH01006                                        0485
         L     @01,CCAICLMD(,CCAPTR)                               0485
         AL    @01,@CF01918                                        0485
         L     @05,ICTLEND(@05,@01)                                0485
         CL    @05,ICTENDNT                                        0485
         BNE   @DL00456                                            0485
*   END LMODMSG;                                                   0486
@EL00006 L     @13,4(,@13)                                         0486
@EF00006 DS    0H                                                  0486
@ER00006 LM    @14,@12,12(@13)                                     0486
         BR    @14                                                 0486
*MACMSG:                                                           0487
*   PROC;                           /*                       @Z67SP00*/
*                                                                  0487
MACMSG   STM   @14,@12,@SA00007                                    0487
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE COMPLETION MESSAGES FOR MACS AND SRC            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0488
*   RFY                                                            0488
*     ICTMOD BASED(CCAICMOD);       /* MOD ENTRY BASE        @Z67SP00*/
*   RFY                                                            0489
*     ICTPTF BASED(ICTPPTR(L));     /* PTF ENTRY BASE                */
*   HMASMMGP=''B;                   /* CLEAR MSG PARMS       @Z67SP00*/
*                                                                  0490
         XC    HMASMMGP(40),HMASMMGP                               0490
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH ICTMOD SECTON FOR MAC, SRC FINISHED            @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0491
*   DO L=1 BY 1 WHILE ICTMEND(L)^=ICTENDNT;/* MOD LOOP       @Z67SP00*/
         LA    L,1                                                 0491
         B     @DE00491                                            0491
@DL00491 DS    0H                                                  0492
*     IF ICTMCPL(L)=OFF             /* MSG NOT ALREADY OUT   @Z67SP00*/
*         &ICTMPROC(L)=ON           /* BEING PROCESSED       @Z67SP00*/
*       THEN                                                       0492
         LR    @02,L                                               0492
         MH    @02,@CH01900                                        0492
         L     @01,CCAICMOD(,CCAPTR)                               0492
         ALR   @01,@02                                             0492
         AL    @01,@CF01922                                        0492
         TM    ICTMPROC-8(@01),B'10000000'                         0492
         BNO   @RF00492                                            0492
         TM    ICTMCPL-8(@01),B'00100000'                          0492
         BNZ   @RF00492                                            0492
*       DO;                                                        0493
*         MGPCLEAR=''B;             /* CLEAR MESSAGES        @ZD00005*/
         XC    MGPCLEAR(6),MGPCLEAR                                0494
*         MGPPRINT=ON;              /* INDICATE PRINTER              */
*         MGPHLDS=ON;               /* AND LOG               @Z40SP00*/
         OI    MGPPRINT,B'10010000'                                0496
*         MGPMGNO1=HMA409I;         /* COPY MESSAGE          @Z67SP00*/
         MVC   MGPMGNO1(2),@CH01665                                0497
*         IF COPYERR=OFF THEN       /* GOOD COPY             @Z67SP00*/
         TM    COPYERR,B'10000000'                                 0498
         BNZ   @RF00498                                            0498
*           MGPVARPT(1)=ADDR(TXTSUCC);/* SUCCESS             @Z67SP00*/
         LA    @02,@CC01667                                        0499
         ST    @02,MGPVARPT                                        0499
*         ELSE                      /* BAD COPY              @Z67SP00*/
*           MGPVARPT(1)=ADDR(TXTFAIL);/* FAILURE             @Z67SP00*/
         B     @RC00498                                            0500
@RF00498 LA    @02,@CC01670                                        0500
         ST    @02,MGPVARPT                                        0500
*         IF ICTMMACR(L)=ON         /* MAC TYPE              @Z67SP00*/
*             ×ICTMMACU(L)=ON THEN  /*                       @Z67SP00*/
@RC00498 LR    @02,L                                               0501
         MH    @02,@CH01900                                        0501
         L     @01,CCAICMOD(,CCAPTR)                               0501
         ALR   @01,@02                                             0501
         AL    @01,@CF01920                                        0501
         TM    ICTMMACR-9(@01),B'00001100'                         0501
         BZ    @RF00501                                            0501
*           ELMTYPE='   MAC';       /* SETUP FOR MSG         @Z67SP00*/
         MVC   ELMTYPE(6),@CC01864                                 0502
*         ELSE                      /*                       @Z67SP00*/
*           ELMTYPE='   SRC';       /* SETUP FOR SRC         @Z67SP00*/
         B     @RC00501                                            0503
@RF00501 MVC   ELMTYPE(6),@CC01865                                 0503
*         MGPVARPT(2)=ADDR(ELMTYPE);/* MAC OR SRC            @Z67SP00*/
@RC00501 LA    @02,ELMTYPE                                         0504
         ST    @02,MGPVARPT+4                                      0504
*         MGPVARPT(3)=ADDR(ICTMNAME(L));/* FOR MODULE        @ZD00005*/
         LR    @02,L                                               0505
         MH    @02,@CH01900                                        0505
         L     @15,CCAICMOD(,CCAPTR)                               0505
         LA    @01,0(@02,@15)                                      0505
         AL    @01,@CF01924                                        0505
         ST    @01,MGPVARPT+8                                      0505
*         MGPVARPT(4)=ADDR(ICTTOLIB(L));/* LIBRARY           @ZD00005*/
         LA    @01,0(@02,@15)                                      0506
         AL    @01,@CF01929                                        0506
         ST    @01,MGPVARPT+12                                     0506
*         MGPVARPT(5)=ADDR(ICTPTFS(1));/* SYSMOD             @Z67SP00*/
         AL    @15,@CF01930                                        0507
         L     @02,ICTPPTR-96(@02,@15)                             0507
         ST    @02,MGPVARPT+16                                     0507
*         MGPVARPT(6)=ADDR(LINKRTN);/* RETURN CODE           @Z67SP00*/
         LA    @02,LINKRTN                                         0508
         ST    @02,MGPVARPT+20                                     0508
*         IF LINKRTN=OK THEN        /* MESSAGE SEVERITY      @ZD00005*/
         CLC   LINKRTN(2),@CC01742                                 0509
         BNE   @RF00509                                            0509
*           MGPTYPE=MGPINFO;        /*                       @ZD00005*/
         MVI   MGPTYPE,X'01'                                       0510
*         ELSE                      /*                       @ZD00005*/
*           IF COPYERR=ON THEN      /* TERMINATE SYSMOD      @ZD00005*/
         B     @RC00509                                            0511
@RF00509 TM    COPYERR,B'10000000'                                 0511
         BNO   @RF00511                                            0511
*             MGPTYPE=MGPERR;       /*                       @ZD00005*/
         MVI   MGPTYPE,X'03'                                       0512
*           ELSE                    /*                       @ZD00005*/
*             MGPTYPE=MGPWARN;      /* WARNING               @ZD00005*/
         B     @RC00511                                            0513
@RF00511 MVI   MGPTYPE,X'02'                                       0513
*         CALL HMASMMSG(HMASMMGP);  /* CALL MSG ROUTINE              */
@RC00511 DS    0H                                                  0514
@RC00509 L     @15,@CV01660                                        0514
         LA    @01,@AL00514                                        0514
         BALR  @14,@15                                             0514
*       END;                                                       0515
*   END;                                                           0516
@RF00492 AH    L,@CH00085                                          0516
@DE00491 LR    @02,L                                               0516
         MH    @02,@CH01900                                        0516
         L     @01,CCAICMOD(,CCAPTR)                               0516
         AL    @01,@CF01924                                        0516
         L     @02,ICTMEND(@02,@01)                                0516
         CL    @02,ICTENDNT                                        0516
         BNE   @DL00491                                            0516
*   END MACMSG;                     /*                       @Z67SP00*/
*                                                                  0517
@EL00007 DS    0H                                                  0517
@EF00007 DS    0H                                                  0517
@ER00007 LM    @14,@12,@SA00007                                    0517
         BR    @14                                                 0517
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE SETS UP THE SELECT MEMBER= STATEMENT FOR MODULE*/
*   /* AND LOAD MODULE WITH IDENTICAL NAMES.                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0518
*SELECT1:                                                          0518
*   PROC;                                                          0518
SELECT1  STM   @14,@04,@SA00008                                    0518
         STM   @06,@12,@SA00008+28                                 0518
*   BUFFER=BLANK;                   /* CLEAR BUFFER AREA             */
         L     @01,IOPPTR                                          0519
         L     @15,IOPBUFAD(,@01)                                  0519
         MVI   BUFFER+1(@15),C' '                                  0519
         MVC   BUFFER+2(78,@15),BUFFER+1(@15)                      0519
         MVI   BUFFER(@15),C' '                                    0519
*   BUFFER(L2:L17)=SELECT;          /* MOVE SELECT VERB              */
         MVC   BUFFER+1(16,@15),SELECT                             0520
*   LX=L8;                          /* SET LENGTH FIELD              */
         LA    LX,8                                                0521
*CHECK:                                                            0522
*   IF SELMOD(LX)=BLANK             /* LAST POSITION BLANK           */
*     THEN                                                         0522
CHECK    LA    @01,SELMOD-1(LX)                                    0522
         CLI   0(@01),C' '                                         0522
         BNE   @RF00522                                            0522
*     DO;                                                          0523
*       LX=LX-L1;                   /* CK NEXT POSITION              */
         BCTR  LX,0                                                0524
*       GOTO CHECK;                 /* BRANCH BACK TO TEST           */
         B     CHECK                                               0525
*     END;                                                         0526
*   LY=L17+LX;                      /* CALC DISP IN BUFFER           */
@RF00522 LA    LY,17                                               0527
         ALR   LY,LX                                               0527
*   BUFFER(L18:LY)=SELMOD;          /* MOVE LM NAME                  */
         L     @07,IOPPTR                                          0528
         L     @07,IOPBUFAD(,@07)                                  0528
         LR    @04,LY                                              0528
         SH    @04,@CH00447                                        0528
         EX    @04,@SM01936                                        0528
*   LZ=LY+L5;                       /* CALC PLACE TO MOVE FIELDS     */
         LA    LZ,5                                                0529
         ALR   LZ,LY                                               0529
*   LY=LY+L1;                       /* CALC PLACE TO MOVE FIELDS     */
         AH    LY,@CH01680                                         0530
*   BUFFER(LY:LZ)=REPLACE;          /* MOVE IN SELECT PARM FIELDS    */
         LR    @04,@07                                             0531
         ALR   @04,LY                                              0531
         BCTR  @04,0                                               0531
         LR    @02,LZ                                              0531
         SLR   @02,LY                                              0531
         EX    @02,@SM01938                                        0531
*   BUFFER(41:47)=SYSMOD;           /* SYSMOD INTO STMT      @Z67SP00*/
         MVC   BUFFER+40(7,@07),SYSMOD                             0532
*   CALL IORTN;                     /* CALL IOP ROUTINE              */
         BAL   @14,IORTN                                           0533
*   END SELECT1;                                                   0534
@EL00008 DS    0H                                                  0534
@EF00008 DS    0H                                                  0534
@ER00008 LM    @14,@04,@SA00008                                    0534
         LM    @06,@12,@SA00008+28                                 0534
         BR    @14                                                 0534
         EJECT
*                                                                  0535
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE SETS UP THE SELECT MEMBER= STATEMENT FOR MODULE*/
*   /* AND LOAD MODULE WITH DIFFERENT NAMES.                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0535
*SELECT2:                                                          0535
*   PROCEDURE OPTIONS(SAVEAREA);                                   0535
SELECT2  STM   @14,@04,12(@13)                                     0535
         STM   @06,@12,44(@13)                                     0535
         ST    @13,@SA00009+4                                      0535
         LA    @14,@SA00009                                        0535
         ST    @14,8(,@13)                                         0535
         LR    @13,@14                                             0535
*   BUFFER=BLANK;                   /* CLEAR BUFFER AREA             */
         L     @01,IOPPTR                                          0536
         L     @15,IOPBUFAD(,@01)                                  0536
         MVI   BUFFER+1(@15),C' '                                  0536
         MVC   BUFFER+2(78,@15),BUFFER+1(@15)                      0536
         MVI   BUFFER(@15),C' '                                    0536
*   BUFFER(L2:L17)=SELECT;          /* MOVE SELECT VERB              */
         MVC   BUFFER+1(16,@15),SELECT                             0537
*   LX=L8;                          /* SET LENGTH FIELD              */
         LA    LX,8                                                0538
*CHECK1:                                                           0539
*   IF SELMOD(LX)=BLANK             /* LAST CHAR BLANK       @Z67SP00*/
*     THEN                                                         0539
CHECK1   LA    @01,SELMOD-1(LX)                                    0539
         CLI   0(@01),C' '                                         0539
         BNE   @RF00539                                            0539
*     DO;                                                          0540
*       LX=LX-L1;                   /* CHECK NEXT POSITION           */
         BCTR  LX,0                                                0541
*       GOTO CHECK1;                /* BRANCH BACK TO TEST           */
         B     CHECK1                                              0542
*     END;                                                         0543
*   LY=L17+LX;                      /* CALC DISPLACEMENT             */
@RF00539 LA    LY,17                                               0544
         ALR   LY,LX                                               0544
*   BUFFER(L18:LY)=SELMOD;          /* MOVE IN MOD NAME      @Z67SP00*/
         L     @02,IOPPTR                                          0545
         L     @02,IOPBUFAD(,@02)                                  0545
         LR    @15,LY                                              0545
         SH    @15,@CH00447                                        0545
         EX    @15,@SM01940                                        0545
*   LY=LY+L1;                       /* CALC DISPLACEMENT             */
         AH    LY,@CH01680                                         0546
*   BUFFER(LY)=COMMA;               /* MOVE IN A COMMA               */
         ALR   @02,LY                                              0547
         BCTR  @02,0                                               0547
         MVC   BUFFER(1,@02),COMMA                                 0547
*   LX=L8;                          /* RESET LENGTH FIELD            */
         LA    LX,8                                                0548
*CHECK2:                                                           0549
*   IF LMODNM(LX)=BLANK             /* LAST CHARACTER BLANK  @Z67SP00*/
*     THEN                                                         0549
CHECK2   LA    @02,LMODNM-1(LX)                                    0549
         CLI   0(@02),C' '                                         0549
         BNE   @RF00549                                            0549
*     DO;                                                          0550
*       LX=LX-L1;                   /* CHECK NEXT CHARACTER          */
         BCTR  LX,0                                                0551
*       GOTO CHECK2;                /* BRANCH BACK TO TEST           */
         B     CHECK2                                              0552
*     END;                                                         0553
*   LZ=LY+LX;                       /* CALC DISPLACEMENT             */
@RF00549 LR    LZ,LY                                               0554
         ALR   LZ,LX                                               0554
*   LY=LY+L1;                       /* CALC DISPLACEMENT             */
         LA    @07,1                                               0555
         ALR   LY,@07                                              0555
*   BUFFER(LY:LZ)=LMODNM;           /* MOVE IN LMOD NAME     @Z67SP00*/
         L     @04,IOPPTR                                          0556
         L     @04,IOPBUFAD(,@04)                                  0556
         LR    @02,@04                                             0556
         ALR   @02,LY                                              0556
         BCTR  @02,0                                               0556
         LR    @15,LZ                                              0556
         SLR   @15,LY                                              0556
         EX    @15,@SM01942                                        0556
*   LY=LZ+L4;                       /* CALC DISPLACEMENT             */
         LA    LY,4                                                0557
         ALR   LY,LZ                                               0557
*   LZ=LZ+L1;                       /* CALC DISPLACEMENT             */
         ALR   LZ,@07                                              0558
*   BUFFER(LZ:LY)=REPL;             /* MOVE IN SELECT PARM FLDS      */
         LR    @07,@04                                             0559
         ALR   @07,LZ                                              0559
         BCTR  @07,0                                               0559
         LR    @02,LY                                              0559
         SLR   @02,LZ                                              0559
         EX    @02,@SM01944                                        0559
*   BUFFER(41:47)=SYSMOD;           /* SYSMOD INTO STMT COMMENT    0560
*                                                            @Z67SP00*/
         MVC   BUFFER+40(7,@04),SYSMOD                             0560
*   CALL IORTN;                     /* CALL IOP ROUTINE              */
         BAL   @14,IORTN                                           0561
*   END SELECT2;                                                   0562
@EL00009 L     @13,4(,@13)                                         0562
@EF00009 DS    0H                                                  0562
@ER00009 LM    @14,@04,12(@13)                                     0562
         LM    @06,@12,44(@13)                                     0562
         BR    @14                                                 0562
         EJECT
*                                                                  0563
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE ISSUES A WRITE REQUEST TO THE SCR1 SCRATCH DATA*/
*   /* SET.                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0563
*IORTN:                                                            0563
*   PROCEDURE OPTIONS(SAVEAREA);                                   0563
IORTN    STM   @14,@04,12(@13)                                     0563
         STM   @06,@12,44(@13)                                     0563
         ST    @13,@SA00010+4                                      0563
         LA    @14,@SA00010                                        0563
         ST    @14,8(,@13)                                         0563
         LR    @13,@14                                             0563
*   IOPDSID=IOPSCR1;                /* SET DATA SET ID               */
         L     @04,IOPPTR                                          0564
         MVI   IOPDSID(@04),X'03'                                  0564
*   IOPFUNCT=IOPWRITE;              /* SET I/O FUNCTION FOR WRITE    */
         MVI   IOPFUNCT(@04),X'51'                                 0565
*   CALL HMASMIO(HMASMIOP);         /* CALL I/O ROUTINE              */
         ST    @04,@AL00001                                        0566
         L     @15,@CV01656                                        0566
         LA    @01,@AL00001                                        0566
         BALR  @14,@15                                             0566
*   IF IOPRETRN^=IOPGOOD THEN       /* I/O BAD               @Z67SP00*/
         L     @04,IOPPTR                                          0567
         CLI   IOPRETRN(@04),0                                     0567
         BE    @RF00567                                            0567
*     DO;                                                          0568
*       CPIRTNCD=MAX(CPIRTNCD,IOPRETRN);/* ERROR CODE        @Z67SP00*/
         SLR   @15,@15                                             0569
         IC    @15,IOPRETRN(,@04)                                  0569
         CR    CPIRTNCD,@15                                        0569
         BNL   *+6
         LR    CPIRTNCD,@15                                        0569
*       COPYERR=ON;                 /* INDICATE ERROR                */
         OI    COPYERR,B'10000000'                                 0570
*       MGPMGNO3=ZERO;              /* INDICATE TERTIARY SECTION     */
         SLR   @04,@04                                             0571
         STH   @04,MGPMGNO3                                        0571
*     END;                                                         0572
*   END IORTN;                                                     0573
@EL00010 L     @13,4(,@13)                                         0573
@EF00010 DS    0H                                                  0573
@ER00010 LM    @14,@04,12(@13)                                     0573
         LM    @06,@12,44(@13)                                     0573
         BR    @14                                                 0573
*                                                                  0574
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE SETS UP THE COPY OUTDD=,INDD= STATEMENT.       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0574
*WTRCOPY:                                                          0574
*   PROC OPTIONS(SAVEAREA);                                        0574
WTRCOPY  STM   @14,@04,12(@13)                                     0574
         STM   @06,@12,44(@13)                                     0574
         ST    @13,@SA00011+4                                      0574
         LA    @14,@SA00011                                        0574
         ST    @14,8(,@13)                                         0574
         LR    @13,@14                                             0574
*   BUFFER=BLANK;                   /* CLEAR BUFFER AREA             */
         L     @01,IOPPTR                                          0575
         L     @15,IOPBUFAD(,@01)                                  0575
         MVI   BUFFER+1(@15),C' '                                  0575
         MVC   BUFFER+2(78,@15),BUFFER+1(@15)                      0575
         MVI   BUFFER(@15),C' '                                    0575
*   BUFFER(L2:L12)=COPY;            /* MOVE COPY AND OUTDD VERBS     */
         MVC   BUFFER+1(11,@15),COPY                               0576
*   LX=L8;                          /* SET LENGTH FIELD              */
         LA    LX,8                                                0577
*CHECK3:                                                           0578
*   IF OUTPUTDD(LX)=BLANK           /* LAST POSITION BLANK           */
*     THEN                                                         0578
CHECK3   LA    @01,OUTPUTDD-1(LX)                                  0578
         CLI   0(@01),C' '                                         0578
         BNE   @RF00578                                            0578
*     DO;                                                          0579
*       LX=LX-L1;                   /* CK NEXT POSITION              */
         BCTR  LX,0                                                0580
*       GOTO CHECK3;                /* BRANCH BACK TO TEST           */
         B     CHECK3                                              0581
*     END;                                                         0582
*   LY=L12+LX;                      /* CALC DISP IN BUFFER           */
@RF00578 LA    LY,12                                               0583
         ALR   LY,LX                                               0583
*   BUFFER(L13:LY)=OUTPUTDD;        /* MOVE OUTPUT DD NAME           */
         L     @07,IOPPTR                                          0584
         L     @07,IOPBUFAD(,@07)                                  0584
         LR    @04,LY                                              0584
         SH    @04,@CH00439                                        0584
         EX    @04,@SM01946                                        0584
*   LZ=LY+L6;                       /* CALC DISPLACEMENT             */
         LA    LZ,6                                                0585
         ALR   LZ,LY                                               0585
*   LY=LY+L1;                       /* CALC DISPLACEMENT             */
         LA    @04,1                                               0586
         ALR   LY,@04                                              0586
*   BUFFER(LY:LZ)=INPUT;            /* MOVE INDD VERB                */
         LR    @02,@07                                             0587
         ALR   @02,LY                                              0587
         BCTR  @02,0                                               0587
         LR    @15,LZ                                              0587
         SLR   @15,LY                                              0587
         EX    @15,@SM01948                                        0587
*   LY=LZ+L8;                       /* CALC DISPLACEMENT             */
         LA    LY,8                                                0588
         ALR   LY,LZ                                               0588
*   LZ=LZ+L1;                       /* CALC DISPLACEMENT             */
         ALR   LZ,@04                                              0589
*   BUFFER(LZ:LY)=INPUTDD;          /* MOVE INPUT DD NAME            */
         ALR   @07,LZ                                              0590
         BCTR  @07,0                                               0590
         LR    @04,LY                                              0590
         SLR   @04,LZ                                              0590
         EX    @04,@SM01950                                        0590
*   CALL IORTN;                     /* CALL IOP ROUTINE              */
         BAL   @14,IORTN                                           0591
*   END WTRCOPY;                                                   0592
@EL00011 L     @13,4(,@13)                                         0592
@EF00011 DS    0H                                                  0592
@ER00011 LM    @14,@04,12(@13)                                     0592
         LM    @06,@12,44(@13)                                     0592
         BR    @14                                                 0592
         EJECT
*                                                                  0593
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE ISSUES A CLOSE REQUEST FOR ALL DATA SETS NEEDED*/
*   /* TO BE CLOSED.                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0593
*CLOSE:                                                            0593
*   PROCEDURE;                      /*                       @SA77276*/
CLOSE    STM   @14,@04,@SA00012                                    0593
         STM   @06,@12,@SA00012+28                                 0593
*   IOPDSID=IOPSCR1;                /* INDICATE SCRATCH DS   @Z67SP00*/
         L     @04,IOPPTR                                          0594
         MVI   IOPDSID(@04),X'03'                                  0594
*   IOPFUNCT=IOPCLOSE;              /* SET TO DO CLOSE               */
         MVI   IOPFUNCT(@04),X'50'                                 0595
*   CALL HMASMIO(HMASMIOP);         /* CALL I/O ROUTINE              */
         ST    @04,@AL00001                                        0596
         L     @15,@CV01656                                        0596
         LA    @01,@AL00001                                        0596
         BALR  @14,@15                                             0596
*   IF IOPRETRN^=IOPGOOD            /* I/O SUCCESSFUL        @YA07506*/
*     THEN                                                         0597
         L     @04,IOPPTR                                          0597
         CLI   IOPRETRN(@04),0                                     0597
         BE    @RF00597                                            0597
*     DO;                                                          0598
*       CPIRTNCD=MAX(CPIRTNCD,IOPRETRN);/* CHANGE CPI RTN CODE IF IT
*                                      IS LESS THAN RTN FROM IO    0599
*                                                            @YA07506*/
         SLR   @15,@15                                             0599
         IC    @15,IOPRETRN(,@04)                                  0599
         CR    CPIRTNCD,@15                                        0599
         BNL   *+6
         LR    CPIRTNCD,@15                                        0599
*       COPYERR=ON;                 /* INDICATE ERROR                */
         OI    COPYERR,B'10000000'                                 0600
*     END;                          /* END CLOSE FAILED      @SA77276*/
*   END CLOSE;                                                     0602
@EL00012 DS    0H                                                  0602
@EF00012 DS    0H                                                  0602
@ER00012 LM    @14,@04,@SA00012                                    0602
         LM    @06,@12,@SA00012+28                                 0602
         BR    @14                                                 0602
         EJECT
*                                                                  0603
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE CHECKS FOR ALIAS ENTRIES AND SETS UP THE       */
*   /* APPROPRIATE COPY AND SELECT STATEMENTS TO PROCESS THE ALIAS.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0603
*ALIAS:                                                            0603
*   PROCEDURE(ALSADDR);             /*                       @Z67SP00*/
ALIAS    STM   @14,@04,@SA00013                                    0603
         STM   @06,@12,@SA00013+28                                 0603
         MVC   @PC00013(4),0(@01)                                  0603
*   DCL                                                            0604
*     ALSADDR PTR(31);              /* ALIAS LIST ADDR       @Z67SP00*/
*   RFY                                                            0605
*     ICTTALLS BASED(ALSADDR);      /* BASE THE LIST         @Z67SP00*/
*   DO A=1 BY 1 WHILE ICTTALND(A)^=ICTENDIX/*                @Z67SP00*/
*         &CPIRTNCD<STOPFUNC;       /*                       @Z67SP00*/
         LA    A,1                                                 0606
         B     @DE00606                                            0606
@DL00606 DS    0H                                                  0607
*     SELMOD=ICTTALNM(A);           /* ELEMENT               @Z67SP00*/
         LR    @04,A                                               0607
         SLA   @04,3                                               0607
         L     @02,@PC00013                                        0607
         L     @02,ALSADDR(,@02)                                   0607
         ALR   @02,@04                                             0607
         AL    @02,@CF01952                                        0607
         MVC   SELMOD(8),ICTTALNM(@02)                             0607
*     CALL SELECT1;                 /* BUILD A SELECT STATEMENT      */
         BAL   @14,SELECT1                                         0608
*   END;                                                           0609
         AH    A,@CH00085                                          0609
@DE00606 LR    @04,A                                               0609
         SLA   @04,3                                               0609
         L     @02,@PC00013                                        0609
         L     @02,ALSADDR(,@02)                                   0609
         AL    @02,@CF01952                                        0609
         L     @04,ICTTALND(@04,@02)                               0609
         CL    @04,ICTENDIX                                        0609
         BE    @DC00606                                            0609
         CH    CPIRTNCD,@CH00032                                   0609
         BL    @DL00606                                            0609
@DC00606 DS    0H                                                  0610
*   END ALIAS;                                                     0610
@EL00013 DS    0H                                                  0610
@EF00013 DS    0H                                                  0610
@ER00013 LM    @14,@04,@SA00013                                    0610
         LM    @06,@12,@SA00013+28                                 0610
         BR    @14                                                 0610
         EJECT
*                                                                  0611
*   /*****************************************************************/
*   /*                                                               */
*   /* DEALLOC RELFILE DATASET IF PREVIOUSLY ALLOCATED.      @Z67SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0611
*RELFDALC:                                                         0611
*   PROC;                           /*                       @Z67SP00*/
RELFDALC STM   @14,@04,@SA00014                                    0611
         STM   @06,@12,@SA00014+28                                 0611
*   IF RELFALLC=ON THEN             /*                       @Z67SP00*/
         TM    RELFALLC,B'00010000'                                0612
         BNO   @RF00612                                            0612
*     DO;                           /*                       @Z67SP00*/
*       IOPFUNCT=IOPDALC;           /*                       @Z67SP00*/
         L     @04,IOPPTR                                          0614
         MVI   IOPFUNCT(@04),X'0E'                                 0614
*       IOPDSID=IOPLRF;             /*                       @Z67SP00*/
         MVI   IOPDSID(@04),X'20'                                  0615
*       IOPDSN=CPIDSN;              /*                       @Z67SP00*/
         MVC   IOPDSN(44,@04),CPIDSN                               0616
*       CALL HMASMIO(HMASMIOP);     /*                       @Z67SP00*/
         ST    @04,@AL00001                                        0617
         L     @15,@CV01656                                        0617
         LA    @01,@AL00001                                        0617
         BALR  @14,@15                                             0617
*       CPIRTNCD=MAX(CPIRTNCD,IOPRETRN);/*                   @Z67SP00*/
         L     @04,IOPPTR                                          0618
         SLR   @15,@15                                             0618
         IC    @15,IOPRETRN(,@04)                                  0618
         CR    CPIRTNCD,@15                                        0618
         BNL   *+6
         LR    CPIRTNCD,@15                                        0618
*       RELFALLC=OFF;               /* RELFILE DELALLOCATED  @Z67SP00*/
         NI    RELFALLC,B'11101111'                                0619
*     END;                          /*                       @Z67SP00*/
*   END RELFDALC;                   /*                       @Z67SP00*/
@EL00014 DS    0H                                                  0621
@EF00014 DS    0H                                                  0621
@ER00014 LM    @14,@04,@SA00014                                    0621
         LM    @06,@12,@SA00014+28                                 0621
         BR    @14                                                 0621
*   END HMASMCPI                                                   0622
*                                                                  0622
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*                                                                  0622
*       ;                                                          0622
@DATA    DS    0H
@CH00085 DC    H'1'
@CH00032 DC    H'12'
@CH00439 DC    H'13'
@CH00447 DC    H'18'
@CH00485 DC    H'39'
@CH01006 DC    H'54'
@CH01900 DC    H'144'
@CH01665 DC    H'210'
@CH01680 DC    XL2'01'
@SM01936 MVC   BUFFER+17(0,@07),SELMOD
@SM01938 MVC   BUFFER(0,@04),REPLACE
@SM01940 MVC   BUFFER+17(0,@02),SELMOD
@SM01942 MVC   BUFFER(0,@02),LMODNM
@SM01944 MVC   BUFFER(0,@07),REPL
@SM01946 MVC   BUFFER+12(0,@07),OUTPUTDD
@SM01948 MVC   BUFFER(0,@02),INPUT
@SM01950 MVC   BUFFER(0,@07),INPUTDD
         DS    0F
@AL00268 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00301 DC    A(STATUS)               LIST WITH   1 ARGUMENT(S)
@AL00314 DC    A(@AFTEMPS)             LIST WITH   1 ARGUMENT(S)
@AL00360 DC    A(@AFTEMPS+4)           LIST WITH   1 ARGUMENT(S)
@AL00398 DC    A(HMASMSPL)             LIST WITH   1 ARGUMENT(S)
@AL00481 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00514 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    14F
@SA00005 DS    14F
@SA00006 DS    18F
@SA00003 DS    14F
@SA00004 DS    14F
@PC00004 DS    1F
@SA00011 DS    18F
@SA00008 DS    14F
@SA00009 DS    18F
@SA00013 DS    14F
@PC00013 DS    1F
@SA00010 DS    18F
@SA00007 DS    0F
@SA00014 DS    0F
@SA00012 DS    0F
         DS    15F
@AL00001 DS    2A
@TF00001 DS    F
@AFTEMPS DS    2F
         DS    0F
@CF01924 DC    F'-144'
@CF01922 DC    F'-136'
@CF01920 DC    F'-135'
@CF01931 DC    F'-134'
@CF01921 DC    F'-133'
@CF01923 DC    F'-132'
@CF01928 DC    F'-120'
@CF01929 DC    F'-112'
@CF01918 DC    F'-54'
@CF01930 DC    F'-48'
@CF01915 DC    F'-46'
@CF01914 DC    F'-40'
@CF01926 DC    F'-39'
@CF01927 DC    F'-31'
@CF01932 DC    F'-28'
@CF01916 DC    F'-20'
@CF01952 DC    F'-8'
@CF01917 DC    F'-4'
@CV01656 DC    V(HMASMIO)
@CV01657 DC    V(HMASMCPL)
@CV01658 DC    V(HMASMSUB)
@CV01659 DC    V(HMASMSEC)
@CV01660 DC    V(HMASMMSG)
         DS    0D
IOPPTR   DS    A
@CC01667 DC    C'SUCCESSFUL'
@CC01670 DC    C'FAILED    '
@CC01864 DC    C'   MAC'
@CC01865 DC    C'   SRC'
@CC01742 DC    C'00'
         DS    CL2
ICTENDCH DC    X'FFFFFFFF'
HMASMSPL DS    CL5
         ORG   HMASMSPL
SPLPMAD  DS    AL4
SPLFUNCT DS    FL1
         ORG   HMASMSPL+5
         DS    CL3
HMASMMGP DS    CL40
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00225 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00226 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL28
         ORG   MGPVAR
MGPVARPT DS    7A
         ORG   HMASMMGP+40
SAVRVANM DS    CL8
ELMTYPE  DS    CL6
SELECT   DC    CL16'SELECT MEMBER=(('
REPLACE  DC    CL5',,R))'
COMMA    DC    CL1','
REPL     DC    CL4',R))'
COPY     DC    CL11'COPY OUTDD='
INPUT    DC    CL6',INDD='
INPUTDD  DS    CL8
OUTPUTDD DS    CL8
         DS    CL1
DDNAMES  DS    CL90
         ORG   DDNAMES
DDCOUNT  DC    XL2'58'
DD1      DC    32X'00'
SYSIN    DC    CL8'SYSUT1  '
SYSPRINT DS    CL8
DD3      DC    24X'00'
SYSUT3   DC    CL8'SYSUT2  '
SYSUT4   DC    CL8'SYSUT3  '
         ORG   DDNAMES+90
OPTLST   DS    CL93
         ORG   OPTLST
OPTLGTH  DS    FL2
OPTVAR   DC    CL91' '
         ORG   OPTLST+93
         DS    CL3
WORKAREA DS    CL16
         ORG   WORKAREA
SAVE1    DS    CL8
SAVE2    DS    CL8
         ORG   SAVE2
@NM00230 DS    CL6
LINKRTN  DS    CL2
         ORG   LINKRTN
@NM00231 DS    CL1
@NM00232 DS    CL1
         ORG   @NM00232
SIGN     DS    BL1
         ORG   WORKAREA+16
STATUS   DS    CL1
FLAGS    DC    X'00'
         ORG   FLAGS
COPYERR  DS    BL1
TLIBOK   EQU   FLAGS+0
CALLCOPY EQU   FLAGS+0
RELFALLC EQU   FLAGS+0
NEEDALLC EQU   FLAGS+0
CALLCPL  EQU   FLAGS+0
@NM00233 EQU   FLAGS+0
         ORG   FLAGS+1
BLANKS   DC    CL8' '
SELMOD   DS    CL8
LMODNM   DS    CL8
SYSMOD   DS    CL7
ZEROS    DS    CL8
         ORG   ZEROS
@NM00234 DC    8X'00'
         ORG   ZEROS+8
CPIDSN   DS    CL44
SUBDSN   DS    CL44
         DS    CL1
PATCHCPI DS    CL80
         ORG   PATCHCPI
@NM00235 DC    80X'FF'
         ORG   PATCHCPI+80
OUTCOME  DS    CL10
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CPIRTNCD EQU   @05
LZ       EQU   @06
LY       EQU   @03
LX       EQU   @04
X        EQU   @03
L        EQU   @03
K        EQU   @04
J        EQU   @03
A        EQU   @03
I        EQU   @04
CCAPTR   EQU   @11
LINKREG  EQU   @02
RTNCODE  EQU   @15
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCARVAD  EQU   CCAFSTA
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00009 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDRC EQU   @NM00027+20
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYNM EQU   @NM00031
CCACOPY  EQU   @NM00031+8
CCACPYSP EQU   @NM00031+12
CCACPYRC EQU   @NM00031+20
CCARCOPY EQU   CCACPYRC
CCACPYPM EQU   @NM00031+24
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00039+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPNAME  EQU   HMASMIOP+4
@NM00043 EQU   HMASMIOP+12
@NM00044 EQU   @NM00043
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00154 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00181 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPTPFX EQU   ICTPTF+38
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMEND  EQU   ICTMNAME
ICTMFLG2 EQU   ICTMOD+8
ICTMPROC EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMMOD  EQU   ICTMMODR
ICTMMACR EQU   ICTMFLG1
ICTMMACU EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTMRELF EQU   ICTMFLG3
ICTMALIS EQU   ICTMFLG3
ICTMFLG4 EQU   ICTMOD+11
ICTMISEL EQU   ICTMFLG4
ICTMFLG5 EQU   ICTMOD+12
ICTMCOPY EQU   ICTMFLG5
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTMRELN EQU   ICTMOD+22
ICTFMLIB EQU   ICTMOD+24
ICTTOLIB EQU   ICTMOD+32
ICTPPTR  EQU   ICTMOD+96
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMODST EQU   ICTMID+7
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTTALND EQU   ICTTALNM
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLEND  EQU   ICTLNAME
ICTLFLG4 EQU   ICTLMOD+8
ICTLPROC EQU   ICTLFLG4
ICTLCPL  EQU   ICTLFLG4
ICTLFLG1 EQU   ICTLMOD+9
ICTLFLG5 EQU   ICTLMOD+10
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTLFLG3 EQU   ICTLMOD+14
ICTLCPY  EQU   ICTLFLG3
ICTTG1   EQU   ICTLMOD+15
ICTTG2   EQU   ICTLMOD+23
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
ICTIXL   EQU   ICTIXLF
SPLPPACK EQU   0
SPLPUNPK EQU   0
SPLPDSN  EQU   0
SPLODSN  EQU   SPLPDSN
SPLIPFX  EQU   SPLODSN
SPLISMD  EQU   SPLODSN+26
SPLIFIL  EQU   SPLODSN+33
RVAPARM  EQU   0
RVAINFO  EQU   RVAPARM
RVAPASS  EQU   RVAPARM+12
RVASTAE  EQU   RVAPARM+20
RVAEPRNM EQU   RVASTAE+4
@NM00227 EQU   RVASTAE+16
@NM00228 EQU   RVASTAE+20
RVAFLAGS EQU   RVASTAE+24
BUFFER   EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
MODADDR  EQU   0
ALSADDR  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00050 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPDSN   EQU   IOPDYNDT
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00061 EQU   IOPUDATA
@NM00062 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00071 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00082 EQU   IOPSRCDR+1
@NM00084 EQU   @NM00082+7
@NM00088 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00092 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00098 EQU   IOPMODDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00108 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00119 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00126 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00135 EQU   IOPPTFFX
@NM00136 EQU   @NM00135
IOPPDTES EQU   IOPPTFFX+41
@NM00139 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00164 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00164
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00168 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00168
IOPBFTB1 EQU   IOPBFTB0
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00170 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00169 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00166 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00165 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00163 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00162 EQU   IOPPTSFX+35
@NM00161 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00160 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00159 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00158 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00157 EQU   IOPQFMDR
@NM00153 EQU   IOPQSMDR
@NM00152 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00151 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00150 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00149 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00148 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00147 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00146 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00145 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00144 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00143 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00142 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00141 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00140 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00139+3
IOPRECD  EQU   @NM00139
@NM00138 EQU   IOPPTFFX+8
@NM00137 EQU   @NM00135+7
IOPPRELN EQU   @NM00136
@NM00134 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00133 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00132 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00131 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00130 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00129 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00128 EQU   @NM00126+7
@NM00127 EQU   @NM00126
@NM00125 EQU   IOPSYSDR+5
@NM00124 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00123 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00122 EQU   IOPDLBFX+8
@NM00121 EQU   @NM00119+7
@NM00120 EQU   @NM00119
@NM00118 EQU   IOPDLBDR+1
@NM00117 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00116 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00115 EQU   IOPMODFX+12
@NM00114 EQU   IOPMODF4
@NM00113 EQU   IOPMODF3
@NM00112 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00111 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPMODDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00096 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00095 EQU   IOPSRCFX+8
@NM00094 EQU   @NM00092+7
@NM00093 EQU   @NM00092
@NM00091 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00084
@NM00086 EQU   @NM00084
@NM00085 EQU   @NM00084
@NM00083 EQU   @NM00082
@NM00081 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00080 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00079 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00078 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00077 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00076 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00075 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00073 EQU   @NM00071+7
@NM00072 EQU   @NM00071
@NM00070 EQU   IOPLMDDR+6
@NM00069 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00068 EQU   IOPLMDF4
@NM00067 EQU   IOPLMDF3
@NM00066 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00065 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00064 EQU   IOPLMDDR
@NM00063 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00062+4
IOPUSED  EQU   @NM00062
IOPTPSEQ EQU   @NM00061+8
IOPVLSER EQU   @NM00061+2
IOPBLKSI EQU   @NM00061
IOPCQMAX EQU   IOPCQMAP+12
@NM00060 EQU   IOPCQMAP+11
@NM00059 EQU   IOPCQMAP+8
@NM00058 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00057 EQU   IOPSCMAP+11
@NM00056 EQU   IOPSCMAP+8
@NM00055 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00054 EQU   IOPNTMAX+11
@NM00053 EQU   IOPNTMAX+8
@NM00052 EQU   IOPNTMAX
@NM00051 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00050+5
IOPIPTF3 EQU   @NM00050
RVAEND   EQU   RVASTAE+25
@NM00229 EQU   RVAFLAGS
RVASDWFD EQU   RVAFLAGS
RVAVS1   EQU   RVAFLAGS
RVAMVS   EQU   RVAFLAGS
RVAUSRCH EQU   @NM00228+2
RVASYSCH EQU   @NM00228
RVAUSRCD EQU   @NM00227+2
RVASYSCD EQU   @NM00227
RVAABNDC EQU   RVASTAE+12
RVASDWAP EQU   RVASTAE
RVAREC   EQU   RVAPASS+4
RVATBL   EQU   RVAPASS
RVAMAJNM EQU   RVAINFO+8
RVACCAP  EQU   RVAINFO+4
RVAHDR   EQU   RVAINFO
SPLIUNPK EQU   SPLPUNPK+8
SPLOUNPK EQU   SPLPUNPK
SPLOPACK EQU   SPLPPACK+8
SPLIPACK EQU   SPLPPACK
@NM00224 EQU   ICTLMOD+38
ICTLTTR  EQU   ICTLMOD+31
@NM00223 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
ICTTIND1 EQU   ICTLFLG3
@NM00222 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00221 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
ICTCOPY  EQU   ICTLFLG2
@NM00220 EQU   ICTLFLG7
@NM00219 EQU   ICTLFLG6
@NM00218 EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLNE   EQU   ICTLFLG5
@NM00217 EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLAPF  EQU   ICTLFLG1
@NM00216 EQU   ICTLFLG4
ICTLPASS EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
@NM00215 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00214 EQU   ICTMVRNT+7
ICTMVRND EQU   ICTMVRNM
ICTASMND EQU   ICTASMAD
ICTMIDTY EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDRG EQU   ICTMODST
ICTMIDF1 EQU   ICTMODST
ICTMIDPL EQU   ICTMODST
ICTMIDPS EQU   ICTMODST
@NM00213 EQU   ICTMODST
ICTMIDND EQU   ICTMODID
ICTIXM   EQU   ICTIXMF
@NM00212 EQU   ICTMOD+128
ICTMICHA EQU   ICTMOD+108
@NM00211 EQU   ICTMOD+95
ICTMFMID EQU   ICTMOD+88
@NM00210 EQU   ICTMOD+87
ICTMRMID EQU   ICTMOD+80
ICTMSSI  EQU   ICTMOD+72
ICTMDOBJ EQU   ICTMOD+64
ICTMSYSL EQU   ICTMOD+56
ICTMDSTL EQU   ICTMOD+48
ICTMASLB EQU   ICTMOD+40
@NM00209 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00208 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00207 EQU   ICTMLEP4
@NM00206 EQU   ICTMLEP3
@NM00205 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00204 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00203 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMPASS EQU   ICTMFLG5
@NM00202 EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
ICTMIDEL EQU   ICTMFLG4
@NM00201 EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMWRK  EQU   ICTMFLG3
ICTMTRX  EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTLIBLK EQU   ICTMFLG3
ICTMSRCU EQU   ICTMFLG1
ICTMXPND EQU   ICTMFLG1
ICTMZAP  EQU   ICTMFLG1
ICTMASM  EQU   ICTMMODR
@NM00200 EQU   ICTMFLG2
@NM00199 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
ICTMNOGO EQU   ICTMFLG2
@NM00198 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00197 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00196 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00195 EQU   ICTCSRST
@NM00194 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00193 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00192 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00191 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00190 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00189 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00188 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00187 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00186 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00185 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00184 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
ICTIXP   EQU   ICTIXPF
@NM00183 EQU   ICTPTF+100
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPFMID EQU   ICTPTF+22
ICTPSUPN EQU   ICTPTF+20
ICTPONUM EQU   ICTPTF+18
ICTPTYPE EQU   ICTPTF+17
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00182 EQU   @NM00181
ICTPRQBY EQU   @NM00181
ICTPRQOK EQU   @NM00181
ICTPRQCK EQU   @NM00181
@NM00180 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00179 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00178 EQU   ICTPFLG4
@NM00177 EQU   ICTPFLG4
@NM00176 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00175 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00174 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00173 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00172 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00171 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTPEND  EQU   ICTPTFS
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00156 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00155 EQU   @NM00154+7
IOPQSMFM EQU   @NM00154
@NM00074 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00049 EQU   IOPUSERL
@NM00048 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00047 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00046 EQU   @NM00043+10
IOPSEQNO EQU   @NM00043+8
@NM00045 EQU   @NM00044+7
IOPPTFNM EQU   @NM00044
IOPNAM17 EQU   IOPNAME
IOPTYPE  EQU   HMASMIOP+3
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
CCAUPDPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00039+12
CCAUPDTE EQU   @NM00039+8
CCAUPDNM EQU   @NM00039
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
@NM00032 EQU   @NM00031+21
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
CCALKDPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00027+12
CCALKED  EQU   @NM00027+8
CCALKDNM EQU   @NM00027
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00023 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00022 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00016 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
CCATBLPA EQU   @NM00009+12
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00007 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00001 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00315 EQU   @EL00002
@RF00347 EQU   @EL00002
@RF00361 EQU   @EL00003
@RF00377 EQU   @EL00003
@RF00392 EQU   @EL00004
@RF00412 EQU   @EL00004
@RC00437 EQU   @EL00005
@RF00567 EQU   @EL00010
@RF00597 EQU   @EL00012
@RF00612 EQU   @EL00014
@RF00440 EQU   @RC00437
@ENDDATA EQU   *
         END   HMASMCPI,(C'PLS1958',0802,78334)

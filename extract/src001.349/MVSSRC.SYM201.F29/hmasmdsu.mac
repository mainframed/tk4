         TITLE 'HMASMDSU - SMP DRIVER SETUP ROUTINE'
HMASMDSU CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMDSU  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   DSURTNCD=ZERO;                  /*                               */
         MVI   DSURTNCD,X'00'                                      0192
*   DSUFLG1=''B;                    /*                               */
         MVI   DSUFLG1,X'00'                                       0193
*   IOPPTR=CCAIOPTR;                /* PTR TO FIOP                   */
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0194
*   SAVIOPTR=IOPPTR;                /* SAVE ADDR OF IOP              */
         ST    IOPPTR,SAVIOPTR                                     0195
*   SAVBUFAD=IOPBUFAD;              /* SAVE BUFFER ADDRESS           */
         MVC   SAVBUFAD(4),IOPBUFAD(IOPPTR)                        0196
*   CCAID=IDCCA;                    /* DUMP ID INTO THE CCA          */
         MVC   CCAID(4,CCAPTR),@CC01353                            0197
*   CALL HMASMDC2;                  /*                               */
         L     @15,@CV01325                                        0198
         BALR  @14,@15                                             0198
*   RFY                                                            0199
*     RTNCODE RSTD;                 /*                               */
*   DSURTNCD=MAX(DSURTNCD,RTNCODE); /*                               */
         SLR   @14,@14                                             0200
         IC    @14,DSURTNCD                                        0200
         CR    @14,RTNCODE                                         0200
         BNL   *+6
         LR    @14,RTNCODE                                         0200
         STC   @14,DSURTNCD                                        0200
*   RFY                                                            0201
*     RTNCODE UNRSTD;               /*                               */
*   GEN(TIME DEC);                  /* GET CURRENT DATE AND TIME     */
         TIME DEC
*   RFY                                                            0203
*    (R0,                                                          0203
*     R1) RSTD;                     /* RESTRICT DATE & TIME          */
*   CCADATE=R1;                     /* PUT DATE IN THE CCA           */
         STCM  R1,7,CCADATE(CCAPTR)                                0204
*   TIMETEMP=R0;                    /* SAVE TIME STAMP               */
         ST    R0,TIMETEMP                                         0205
*   RFY                                                            0206
*    (R0,                                                          0206
*     R1) UNRSTD;                   /* RELEASE REGS                  */
*   CCATIME=TIMETEMP(1:3);          /* SAVE TIME IN CCA              */
         MVC   CCATIME(3,CCAPTR),TIMETEMP                          0207
*   CCAFMID='';                     /* INIT FMID TO BLANK            */
         MVI   CCAFMID(CCAPTR),C' '                                0208
         MVC   CCAFMID+1(6,CCAPTR),CCAFMID(CCAPTR)                 0208
*   HMASMMGP=''B;                   /* ZERO MSG PARM                 */
         XC    HMASMMGP(24),HMASMMGP                               0209
*   MGPPRINT=ON;                    /* ALL MSG TO PRINTER            */
*   MGPHLDS=ON;                     /* ALL MSG TO LOG                */
         OI    MGPPRINT,B'10010000'                                0211
         EJECT
*                                                                  0212
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR SMPOUT ANS SMPLOG DD CARDS                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0212
*   DEVDDNAM=CCADSIDA(IOPPRINT);    /*                               */
         L     @10,CCADSAD(,CCAPTR)                                0212
         MVC   DEVDDNAM(8),CCADSIDA+80(@10)                        0212
*   GEN(DEVTYPE DEVDDNAM,DEVADDR)                                  0213
*   REFS(DEVDDNAM,DEVADDR);         /* SMPOUT PRESENT?               */
         DEVTYPE DEVDDNAM,DEVADDR
*   RFY                             /*                               */
*     RTNCODE RSTD;                 /*                               */
*   IF RTNCODE^=ZERO                /* PRESENT?                      */
*     THEN                          /* NO - ERROR STOP SMP           */
         LTR   RTNCODE,RTNCODE                                     0215
         BZ    @RF00215                                            0215
*     CCAOUTNG=ON;                  /*                               */
         OI    CCAOUTNG(CCAPTR),B'01000000'                        0216
*   ELSE                            /*                               */
*     CCAOUTP=ON;                   /*                               */
         B     @RC00215                                            0217
@RF00215 OI    CCAOUTP(CCAPTR),B'00000010'                         0217
*   RFY                             /*                               */
*     RTNCODE UNRSTD;               /*                               */
@RC00215 DS    0H                                                  0219
*   DEVDDNAM=CCADSIDA(IOPHLDS);     /*                               */
         L     @10,CCADSAD(,CCAPTR)                                0219
         MVC   DEVDDNAM(8),CCADSIDA(@10)                           0219
*   GEN(DEVTYPE DEVDDNAM,DEVADDR)                                  0220
*   REFS(DEVDDNAM,DEVADDR);         /* SMPLOG PRESENT?               */
         DEVTYPE DEVDDNAM,DEVADDR
*   RFY                             /*                               */
*     RTNCODE RSTD;                 /*                               */
*   IF RTNCODE^=ZERO                /* PRESENT?                      */
*     THEN                          /* NO - ERROR STOP SMP           */
         LTR   RTNCODE,RTNCODE                                     0222
         BZ    @RF00222                                            0222
*     CCALOGNG=ON;                  /*                               */
         OI    CCALOGNG(CCAPTR),B'10000000'                        0223
*   ELSE                            /*                               */
*     CCALOGP=ON;                   /*                               */
         B     @RC00222                                            0224
@RF00222 OI    CCALOGP(CCAPTR),B'00000001'                         0224
*   RFY                             /*                               */
*     RTNCODE UNRSTD;               /*                               */
*                                                                  0225
@RC00222 DS    0H                                                  0226
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SMPOUT DD CARD ISSUE MESSAGE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0226
*   IF CCAOUTNG=ON                  /* IF NO SMPOUT                  */
*     THEN                          /*                               */
         TM    CCAOUTNG(CCAPTR),B'01000000'                        0226
         BNO   @RF00226                                            0226
*     DO;                           /*                               */
*       MGPMGNO1=HMA283I;           /* X8X DDCARD MISSING            */
         MVC   MGPMGNO1(2),@CH00524                                0228
*       MGPVARPT(1)=ADDR(CCADSIDA(IOPPRINT));/*                      */
         L     @10,CCADSAD(,CCAPTR)                                0229
         LA    @10,CCADSIDA+80(,@10)                               0229
         ST    @10,MGPVARPT                                        0229
*       MGPTYPE=MGPTERM;            /*                               */
         MVI   MGPTYPE,X'05'                                       0230
*       CALL HMASMMSG(HMASMMGP);    /*                               */
         L     @15,@CV01328                                        0231
         LA    @01,@AL00231                                        0231
         BALR  @14,@15                                             0231
*       DSURTNCD=STOPSMP;           /*                               */
         MVI   DSURTNCD,X'10'                                      0232
*     END;                          /*                               */
*                                                                  0233
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO SMPLOG DD CARD ISSUE MESSAGE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0234
*   IF CCALOGNG=ON                  /* IF NO SMPLOG                  */
*     THEN                          /*                               */
@RF00226 TM    CCALOGNG(CCAPTR),B'10000000'                        0234
         BNO   @RF00234                                            0234
*     DO;                           /*                               */
*       MGPMGNO1=HMA283I;           /* X8X DDCARD MISSING            */
         MVC   MGPMGNO1(2),@CH00524                                0236
*       MGPVARPT(1)=ADDR(CCADSIDA(IOPHLDS));/*                       */
         L     @10,CCADSAD(,CCAPTR)                                0237
         ST    @10,MGPVARPT                                        0237
*       MGPTYPE=MGPTERM;            /*                               */
         MVI   MGPTYPE,X'05'                                       0238
*       CALL HMASMMSG(HMASMMGP);    /*                               */
         L     @15,@CV01328                                        0239
         LA    @01,@AL00239                                        0239
         BALR  @14,@15                                             0239
*       DSURTNCD=STOPSMP;           /*                               */
         MVI   DSURTNCD,X'10'                                      0240
*     END;                          /*                               */
         EJECT
*                                                                  0242
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO SCAN INPUT PARM LIST. IF NONE SPECIFIED, SKIP SCAN  */
*   /* ENTERS SUBROUTINES BELOW TO SAVE VALUES OBTAINED              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0242
*   IF DSUPLEN^=ZERO                /* ANY PARMS ON EXEC STMT?       */
*       &DSURTNCD=ZERO              /*                               */
*     THEN                          /* YES - SCAN FOR DATA           */
@RF00234 L     @10,@PC00001                                        0242
         LH    @06,DSUPLEN(,@10)                                   0242
         LTR   @06,@06                                             0242
         BZ    @RF00242                                            0242
         CLI   DSURTNCD,0                                          0242
         BNE   @RF00242                                            0242
*     DO;                           /* USING SCAN ROUTINE            */
*       PRMFLGS=OFF;                /* INIT PARM FLAGS       @Z40SP00*/
         MVI   PRMFLGS,B'00000000'                                 0244
*       EXECPARM='';                /*                               */
         MVI   EXECPARM,C' '                                       0245
         MVC   EXECPARM+1(101),EXECPARM                            0245
*       QUOTE1=QUOTE;               /*                               */
         MVI   QUOTE1,C''''                                        0246
*       PMLEN=MIN(DSUPLEN,100);     /*                               */
         LA    @15,100                                             0247
         CR    @06,@15                                             0247
         BNH   *+6
         LR    @06,@15                                             0247
         ST    @06,PMLEN                                           0247
*       EXECDATA(1:PMLEN)=DSUPDATA(1:PMLEN);/* MOVE PARM             */
         LR    @15,@06                                             0248
         BCTR  @15,0                                               0248
         EX    @15,@SM01450                                        0248
*       EXECDATA(PMLEN+1)=QUOTE;    /*                               */
         LA    @10,EXECDATA(@06)                                   0249
         MVI   0(@10),C''''                                        0249
*       MGPCLEAR=''B;               /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0250
*       MGPMGNO1=HMA424I;           /* HMASMP EXEC PARMS = X100X     */
         MVC   MGPMGNO1(2),@CH01340                                0251
*       MGPVARPT(1)=ADDR(EXECPARM); /*                               */
         LA    @10,EXECPARM                                        0252
         ST    @10,MGPVARPT                                        0252
*       MGPTYPE=MGPINFO;            /*                               */
         MVI   MGPTYPE,X'01'                                       0253
*       CALL HMASMMSG(HMASMMGP);    /*                               */
         L     @15,@CV01328                                        0254
         LA    @01,@AL00254                                        0254
         BALR  @14,@15                                             0254
*       HMASMSCP=''B;               /* ZERO SCP PARM                 */
         XC    HMASMSCP(26),HMASMSCP                               0255
*       SCPCHAR=ADDR(DSUPDATA);     /* POINT TO PARM LIST            */
         L     @10,@PC00001                                        0256
         LA    @06,DSUPDATA(,@10)                                  0256
         ST    @06,SCPCHAR                                         0256
*       SCPSRCH=ADPRMSCN;           /* SET START ADDR        @YA07510*/
         MVC   SCPSRCH(4),ADPRMSCN                                 0257
*       SCPINLN=DSUPLEN;            /* SET STRING LENGTH             */
         MVC   SCPINLN(2),DSUPLEN(@10)                             0258
*       CALL HMASMSCN(HMASMSCP);    /* SCAN PARM LIST                */
         L     @15,@CV01329                                        0259
         LA    @01,@AL00259                                        0259
         BALR  @14,@15                                             0259
*       IF SCPRET^=SCPGOOD          /* SYNTAX ERROR?                 */
*         THEN                      /* YES - INCORRECT PARM LIST     */
         CLI   SCPRET,0                                            0260
         BE    @RF00260                                            0260
*         DO;                       /* ISSUE ERROR MESSAGE           */
*           ERRCOL=SCPCHAR-ADDR(DSUPDATA)+1;/* SYNTAX ERR COL        */
         L     @10,@PC00001                                        0262
         LA    @10,DSUPDATA(,@10)                                  0262
         LCR   @10,@10                                             0262
         AL    @10,SCPCHAR                                         0262
         AH    @10,@CH00089                                        0262
         STH   @10,ERRCOL                                          0262
*           CVD(ERRCOL,DBLWRD);     /*                               */
         CVD   @10,DBLWRD                                          0263
*           UNPK(CHARCOL,DBLWRD);   /*                               */
         UNPK  CHARCOL(2),DBLWRD(8)                                0264
*           LASTDIG=LASTDIG×MAKEPRNT;/*                              */
         OI    LASTDIG,X'F0'                                       0265
*           MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MSG PARM     @Z40SP00*/
         XC    MGPCLEAR(6),MGPCLEAR                                0266
*           MGPTYPE=MGPTERM;        /* SET SEVERITY          @ZD00001*/
         MVI   MGPTYPE,X'05'                                       0267
*           MGPMGNO1=HMA203I;       /* SYNTAX ERROR IN               */
         MVC   MGPMGNO1(2),@CH00042                                0268
*           MGPMGNO2=PART020;       /* EXEC PARM                     */
         MVC   MGPMGNO2(2),@CH00358                                0269
*           MGPMGNO3=PART026;       /* AT COL XX                     */
         MVC   MGPMGNO3(2),@CH00467                                0270
*           MGPVARPT(1)=ADDR(CHARCOL);/*                             */
         LA    @10,CHARCOL                                         0271
         ST    @10,MGPVARPT                                        0271
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */
         L     @15,@CV01328                                        0272
         LA    @01,@AL00272                                        0272
         BALR  @14,@15                                             0272
*           DSURTNCD=STOPSMP;       /* SET RETURN CODE       @YA07506*/
         MVI   DSURTNCD,X'10'                                      0273
*         END;                                                     0274
*     END;                                                         0275
@RF00260 DS    0H                                                  0276
         EJECT
*                                                                  0276
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DATE NOT SPECIFIED ON EXEC THEN ASK OPERATOR FOR DATE TO   */
*   /* USE VIA CALL TO HMASMMSG(MSG WILL DO WTO FOR THIS SPECIAL MSG */
*   /* NUMBER). INSURE THAT DATE ENTERED ON PARM OR DATE RETURNED BY */
*   /* OPERATOR IS VALID. IF NOT ISSUE ANOTHER REQUEST TO OPERATOR.  */
*   /* CONTINUE TILL VALID REPLY ENTERED.                    @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0276
*   IF DSURTNCD=ZERO                /* IF PREV FUNCTIONS OK          */
*     THEN                          /*                               */
@RF00242 CLI   DSURTNCD,0                                          0276
         BNE   @RF00276                                            0276
*     DO;                           /*                               */
*       MGPMGNO1=HMA399D;           /* INDICATE WTOR MESSAGE         */
         MVC   MGPMGNO1(2),@CH01338                                0278
*       MGPVARPT(1)=ADDR(DATEOP);   /* POINT TO REPLY AREA           */
         LA    @10,DATEOP                                          0279
         ST    @10,MGPVARPT                                        0279
*       MGPVARPT(2)=LENGTH(DATEOP); /* REPLY LENGTH                  */
         MVC   MGPVARPT+4(4),@CF00132                              0280
*       MGPPRINT=OFF;               /* NOT TO PRINTER                */
*       MGPHLDS=OFF;                /* NOT TO LOG                    */
*       MGPWTOR=ON;                 /* BUT TO OPERATOR               */
         OI    MGPWTOR,B'00001000'                                 0283
         NI    MGPPRINT,B'01101111'                                0283
*       MGPTYPE=MGPDEC;             /*                       @Z67SP00*/
         MVI   MGPTYPE,X'06'                                       0284
*       GO TO TSTDAT;               /* BR AROUND MSG FIRST TINE THRU.
*                                      THERE SHOULD BE EITHER THE  0285
*                                      DATA ENTERED AS PARM OR BLANKS
*                                      IN DATEOP. BLANKS INDICATE NO
*                                      PARM DATE ENTERED AND WILL  0285
*                                      CAUSE ERR ON NUMERIC CHECK  0285
*                                      WHICH WILL CAUSE ISSUE OF DATE
*                                      REQUEST               @OS64458*/
         B     TSTDAT                                              0285
*DATEMSG:                                                          0286
*       CALL HMASMMSG(HMASMMGP);    /* ASK OPERATOR FOR THE DATE     */
DATEMSG  L     @15,@CV01328                                        0286
         LA    @01,@AL00286                                        0286
         BALR  @14,@15                                             0286
*       DATEOP(1)=DATEOP(1)×UPCASE; /* MAKE DATE UPPER CASE          */
         OI    DATEOP,X'40'                                        0287
*TSTDAT:                            /*                       @OS64458*/
*       IF DATEOP(1)^=USEIT         /* DID HE ENTER A NEW DATE?      */
*         THEN                      /* YES - UPDATE THE CCA          */
TSTDAT   CLI   DATEOP,C'U'                                         0288
         BE    @RF00288                                            0288
*         DO;                                                      0289
*           IF(DATEOP&CHAR0)^=CHAR0 /* DATE NUMERIC?         @OS64458*/
*             THEN                  /* NO - THEN ERR         @OS64458*/
         MVC   @TS00001(5),DATEOP                                  0290
         NC    @TS00001(5),@CC01355                                0290
         CLC   @TS00001(5),@CC01355                                0290
         BE    @RF00290                                            0290
*             DO;                   /*                       @OS64458*/
*               DATEOP='';          /* RE-INIT REPLY AREA TO BLANKS
*                                                            @OS64458*/
         MVI   DATEOP,C' '                                         0292
         MVC   DATEOP+1(4),DATEOP                                  0292
*               GO TO DATEMSG;      /* GO TO RE-ISSUE TOW MSG      0293
*                                                            @OS64458*/
         B     DATEMSG                                             0293
*             END;                  /* END DATE BAD GROUP    @OS64458*/
*           PACK(CCADATE,DATEOP);   /* PUT THE PROPER DATE IN CCA    */
@RF00290 PACK  CCADATE(3,CCAPTR),DATEOP(5)                         0295
*         END;                                                     0296
*       MGPPRINT=ON;                /* MSG TO PRINTER                */
@RF00288 DS    0H                                                  0298
*       MGPHLDS=ON;                 /* MSG TO LOG                    */
*       MGPWTOR=OFF;                /* BUT NOT TO OPERATOR           */
         OI    MGPPRINT,B'10010000'                                0299
         NI    MGPWTOR,B'11110111'                                 0299
*     END;                          /* END GET DATE CODE             */
         EJECT
*                                                                  0301
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO OPEN ALL DATA SET REQUIRING DATA TO BE SET UP */
*   /* IN THE CCA                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0301
*   IF DSURTNCD=ZERO                /*                               */
*     THEN                          /*                               */
@RF00276 CLI   DSURTNCD,0                                          0301
         BNE   @RF00301                                            0301
*     DO;                           /*                               */
*       CALL DSUOPEN;               /* DO OPENS                      */
         BAL   @14,DSUOPEN                                         0303
*       RFY                                                        0304
*         RTNCODE RSTD;             /*                               */
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */
         SLR   @14,@14                                             0305
         IC    @14,DSURTNCD                                        0305
         CR    @14,RTNCODE                                         0305
         BNL   *+6
         LR    @14,RTNCODE                                         0305
         STC   @14,DSURTNCD                                        0305
*       RFY                                                        0306
*         RTNCODE UNRSTD;           /*                               */
*     END;                          /*                               */
*                                                                  0307
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO GETMAIN I/O BUFFERS FOR ALL OPEN DATA SETS    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0308
*   IF DSURTNCD=ZERO                /*                               */
*     THEN                          /*                               */
@RF00301 CLI   DSURTNCD,0                                          0308
         BNE   @RF00308                                            0308
*     DO;                           /*                               */
*       CALL DSUGETMN;              /* DO OPENS                      */
         BAL   @14,DSUGETMN                                        0310
*       RFY                                                        0311
*         RTNCODE RSTD;             /*                               */
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */
         SLR   @14,@14                                             0312
         IC    @14,DSURTNCD                                        0312
         CR    @14,RTNCODE                                         0312
         BNL   *+6
         LR    @14,RTNCODE                                         0312
         STC   @14,DSURTNCD                                        0312
*       RFY                                                        0313
*         RTNCODE UNRSTD;           /*                               */
*     END;                          /*                               */
         EJECT
*                                                                  0315
*   /*****************************************************************/
*   /*                                                               */
*   /* BLDL THE SYSTEM ENTRY IN THE CDS. IF FOUND, THEN THE CCA IS   */
*   /* UPDATED WITH INFORMATION FROM THE CDS SYSTEM DIR.             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*   IF DSURTNCD=ZERO                /*                               */
*     THEN                          /*                               */
@RF00308 CLI   DSURTNCD,0                                          0315
         BNE   @RF00315                                            0315
*     DO;                           /*                               */
*       CCAIOPTR=ZERO;              /* SET IOPPTR TO ZERO SO THAT  0317
*                                      WHEN DS1 IS CALLED IT WILL NOT
*                                      ATTEMP TO FREE EXISTING IOP.
*                                      EXISTING ONE IF THE FIXED   0317
*                                      LENGTH ONE PASSED FROM      0317
*                                      HMASMDRV                      */
         SLR   @10,@10                                             0317
         ST    @10,CCAIOPTR(,CCAPTR)                               0317
*       IOPPTR=CCAIOPCS;            /* IOP FOR CDS SYSTEM            */
         L     IOPPTR,CCAIOPCS(,CCAPTR)                            0318
*       IOPDSID=IOPCDS;             /*                               */
         MVI   IOPDSID(IOPPTR),X'02'                               0319
*       IOPFUNCT=IOPBLDL;           /* BLDL FOR DIRECTORY DATA       */
         MVI   IOPFUNCT(IOPPTR),X'04'                              0320
*       IOPTYPE=IOPSYS;             /* SYSTEM ENTRY                  */
         MVI   IOPTYPE(IOPPTR),X'07'                               0321
*       IOPRETRN=IOPNTFND;          /* INIT RC SO IF BLDL NOT DONE 0322
*                                      DS1 WILL TREAT AS NOT FOUND   */
         MVI   IOPRETRN(IOPPTR),X'04'                              0322
*       IF CCACDSP=ON               /* IF CDS DD PRESENT             */
*         THEN                      /* THEN                          */
         TM    CCACDSP(CCAPTR),B'10000000'                         0323
         BNO   @RF00323                                            0323
*         DO;                       /* LOC SYSTEM ENTRY              */
*           CALL HMASMIO(HMASMIOP); /* BLDL SYSTEM ENTRY             */
         ST    IOPPTR,@AL00001                                     0325
         L     @15,@CV01327                                        0325
         LA    @01,@AL00001                                        0325
         BALR  @14,@15                                             0325
*           IF IOPRETRN>IOPNTFND    /* IF ERR IN BLDL                */
*             THEN                  /*                               */
         CLI   IOPRETRN(IOPPTR),4                                  0326
         BNH   @RF00326                                            0326
*             DSURTNCD=MAX(DSURTNCD,IOPRETRN);/* SAVE RC             */
         SLR   @10,@10                                             0327
         IC    @10,DSURTNCD                                        0327
         SLR   @06,@06                                             0327
         IC    @06,IOPRETRN(,IOPPTR)                               0327
         CR    @10,@06                                             0327
         BNL   *+6
         LR    @10,@06                                             0327
         STC   @10,DSURTNCD                                        0327
*         END;                      /*                               */
@RF00326 DS    0H                                                  0329
*       IF IOPRETRN<=IOPNTFND       /* IF NO SERIOS ERROR IN BLDL    */
*         THEN                      /*                               */
@RF00323 CLI   IOPRETRN(IOPPTR),4                                  0329
         BH    @RF00329                                            0329
*         DO;                       /*                               */
*           CALL HMASMDS1(HMASMIOP,'Y');/* PASS IOP FOR CDS WITH   0331
*                                      INDICATOR THAT IOP IS PRIMED  */
         ST    IOPPTR,@AL00001                                     0331
         LA    @10,@CC01406                                        0331
         ST    @10,@AL00001+4                                      0331
         L     @15,@CV01326                                        0331
         LA    @01,@AL00001                                        0331
         BALR  @14,@15                                             0331
*           RFY                                                    0332
*             RTNCODE RSTD;         /*                               */
*           DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                */
         SLR   @14,@14                                             0333
         IC    @14,DSURTNCD                                        0333
         CR    @14,RTNCODE                                         0333
         BNL   *+6
         LR    @14,RTNCODE                                         0333
         STC   @14,DSURTNCD                                        0333
*           RFY                                                    0334
*             RTNCODE UNRSTD;       /*                               */
*         END;                      /*                               */
*     END;                          /*                               */
*                                                                  0336
@RF00329 DS    0H                                                  0337
*   /*****************************************************************/
*   /*                                                               */
*   /* BLDL THE SYSTEM ENTRY IN THE ACDS. IF FOUND, THEN THE CCA IS  */
*   /* UPDATED WITH INFORMATION FROM THE ACDS SYSTEM DIR.            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   IF DSURTNCD=ZERO                /*                               */
*     THEN                          /*                               */
@RF00315 CLI   DSURTNCD,0                                          0337
         BNE   @RF00337                                            0337
*     DO;                           /*                               */
*       IOPPTR=CCAIOPAS;            /* IOP FOR ACDS SYSTEM           */
         L     IOPPTR,CCAIOPAS(,CCAPTR)                            0339
*       IOPDSID=IOPACDS;            /*                               */
         MVI   IOPDSID(IOPPTR),X'0C'                               0340
*       IOPFUNCT=IOPBLDL;           /* BLDL FOR DIRECTORY DATA       */
         MVI   IOPFUNCT(IOPPTR),X'04'                              0341
*       IOPTYPE=IOPSYS;             /* SYSTEM ENTRY                  */
         MVI   IOPTYPE(IOPPTR),X'07'                               0342
*       IOPRETRN=IOPNTFND;          /* INIT RC SO IF BLDL NOT DONE 0343
*                                      DS1 WILL TREAT AS NOT FOUND   */
         MVI   IOPRETRN(IOPPTR),X'04'                              0343
*       IF CCAACDSP=ON              /* IF ACDS DD PRESENT            */
*         THEN                      /* THEN                          */
         TM    CCAACDSP(CCAPTR),B'01000000'                        0344
         BNO   @RF00344                                            0344
*         DO;                       /* LOC SYSTEM ENTRY              */
*           IOPBUFAD=SAVBUFAD;      /* SET BUFFER ADDR               */
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0346
*           CALL HMASMIO(HMASMIOP); /* FLBL SYSTEM ENTRY             */
         ST    IOPPTR,@AL00001                                     0347
         L     @15,@CV01327                                        0347
         LA    @01,@AL00001                                        0347
         BALR  @14,@15                                             0347
*           IF IOPRETRN>IOPNTFND    /* IF ERR IN BLDL                */
*             THEN                  /*                               */
         CLI   IOPRETRN(IOPPTR),4                                  0348
         BNH   @RF00348                                            0348
*             DSURTNCD=MAX(DSURTNCD,IOPRETRN);/* SAVE RC             */
         SLR   @10,@10                                             0349
         IC    @10,DSURTNCD                                        0349
         SLR   @06,@06                                             0349
         IC    @06,IOPRETRN(,IOPPTR)                               0349
         CR    @10,@06                                             0349
         BNL   *+6
         LR    @10,@06                                             0349
         STC   @10,DSURTNCD                                        0349
*         END;                      /*                               */
@RF00348 DS    0H                                                  0351
*       IF IOPRETRN<=IOPNTFND       /* IF NO SERIOS ERROR IN BLDL    */
*         THEN                      /*                               */
@RF00344 CLI   IOPRETRN(IOPPTR),4                                  0351
         BH    @RF00351                                            0351
*         DO;                       /*                               */
*           CALL HMASMDS1(HMASMIOP,'Y');/* PASS IOP FOR ACDS WITH  0353
*                                      INDICATOR THAT IOP IS PRIMED  */
         ST    IOPPTR,@AL00001                                     0353
         LA    @10,@CC01406                                        0353
         ST    @10,@AL00001+4                                      0353
         L     @15,@CV01326                                        0353
         LA    @01,@AL00001                                        0353
         BALR  @14,@15                                             0353
*           RFY                                                    0354
*             RTNCODE RSTD;         /*                               */
*           DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                */
         SLR   @14,@14                                             0355
         IC    @14,DSURTNCD                                        0355
         CR    @14,RTNCODE                                         0355
         BNL   *+6
         LR    @14,RTNCODE                                         0355
         STC   @14,DSURTNCD                                        0355
*           RFY                                                    0356
*             RTNCODE UNRSTD;       /*                               */
*         END;                      /*                               */
*     END;                          /*                               */
*                                                                  0358
@RF00351 DS    0H                                                  0359
*   /*****************************************************************/
*   /*                                                               */
*   /* BLDL THE SYSTEM ENTRY IN THE PTS . IF FOUND, THEN THE CCA IS  */
*   /* UPDATED WITH INFORMATION FROM THE ACDS SYSTEM DIR.            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*   IF DSURTNCD=ZERO                /*                               */
*     THEN                          /*                               */
@RF00337 CLI   DSURTNCD,0                                          0359
         BNE   @RF00359                                            0359
*     DO;                           /*                               */
*       IF CCAIOPTR^=ZERO           /* IF IOP GETMAIN BY DS1 DUE     */
*         THEN                      /* TO CDS/ACDS PEMAX THEN        */
         L     @10,CCAIOPTR(,CCAPTR)                               0361
         LTR   @10,@10                                             0361
         BZ    @RF00361                                            0361
*         IOPPTR=CCAIOPTR;          /* USE IT                        */
         LR    IOPPTR,@10                                          0362
*       ELSE                        /* IF NONE OBTAINED YET USE THE  */
*         IOPPTR=SAVIOPTR;          /* ONE PASSED BY HMASMDRV        */
         B     @RC00361                                            0363
@RF00361 L     IOPPTR,SAVIOPTR                                     0363
*       IOPDSID=IOPPTS;             /*                               */
@RC00361 MVI   IOPDSID(IOPPTR),X'06'                               0364
*       IOPFUNCT=IOPBLDL;           /* BLDL FOR DIRECTORY DATA       */
         MVI   IOPFUNCT(IOPPTR),X'04'                              0365
*       IOPTYPE=IOPSYS;             /* SYSTEM ENTRY                  */
         MVI   IOPTYPE(IOPPTR),X'07'                               0366
*       IOPRETRN=IOPNTFND;          /* INIT RC SO IF BLDL NOT DONE 0367
*                                      DS1 WILL TREAT AS NOT FOUND   */
         MVI   IOPRETRN(IOPPTR),X'04'                              0367
*       IF CCAPTSP=ON               /* IF PTS DD PRESENT             */
*         THEN                      /* THEN                          */
         TM    CCAPTSP(CCAPTR),B'00010000'                         0368
         BNO   @RF00368                                            0368
*         DO;                       /* LOC SYSTEM ENTRY              */
*           IOPBUFAD=SAVBUFAD;      /* SET BUFFER ADDR               */
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0370
*           CALL HMASMIO(HMASMIOP); /* FLBL SYSTEM ENTRY             */
         ST    IOPPTR,@AL00001                                     0371
         L     @15,@CV01327                                        0371
         LA    @01,@AL00001                                        0371
         BALR  @14,@15                                             0371
*           IF IOPRETRN>IOPNTFND    /* IF ERR IN BLDL                */
*             THEN                  /*                               */
         CLI   IOPRETRN(IOPPTR),4                                  0372
         BNH   @RF00372                                            0372
*             DSURTNCD=MAX(DSURTNCD,IOPRETRN);/* SAVE RC             */
         SLR   @10,@10                                             0373
         IC    @10,DSURTNCD                                        0373
         SLR   @06,@06                                             0373
         IC    @06,IOPRETRN(,IOPPTR)                               0373
         CR    @10,@06                                             0373
         BNL   *+6
         LR    @10,@06                                             0373
         STC   @10,DSURTNCD                                        0373
*         END;                      /*                               */
@RF00372 DS    0H                                                  0375
*       IF IOPRETRN<=IOPNTFND       /* IF NO SERIOS ERROR IN BLDL    */
*         THEN                      /*                               */
@RF00368 CLI   IOPRETRN(IOPPTR),4                                  0375
         BH    @RF00375                                            0375
*         DO;                       /*                               */
*           CALL HMASMDS1(HMASMIOP,'Y');/* PASS IOP FOR PTS WITH   0377
*                                      INDICATOR THAT IOP IS PRIMED  */
         ST    IOPPTR,@AL00001                                     0377
         LA    @10,@CC01406                                        0377
         ST    @10,@AL00001+4                                      0377
         L     @15,@CV01326                                        0377
         LA    @01,@AL00001                                        0377
         BALR  @14,@15                                             0377
*           RFY                                                    0378
*             RTNCODE RSTD;         /*                               */
*           DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                */
         SLR   @14,@14                                             0379
         IC    @14,DSURTNCD                                        0379
         CR    @14,RTNCODE                                         0379
         BNL   *+6
         LR    @14,RTNCODE                                         0379
         STC   @14,DSURTNCD                                        0379
*           RFY                                                    0380
*             RTNCODE UNRSTD;       /*                               */
*         END;                      /*                               */
*     END;                          /*                               */
@RF00375 DS    0H                                                  0383
         EJECT
*                                                                  0383
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE THE SYSTEM ENTRY IN THE CDS. IF FOUND, THEN THE CCA IS */
*   /* UPDATED WITH INFORMATION FROM THE CDS.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0383
*   IF DSURTNCD=ZERO                /* IF PREV FUNCTIONS OK          */
*       &CCACSYSF=ON                /* AND SYSTEM ENTRY FOUND        */
*     THEN                          /*                               */
@RF00359 CLI   DSURTNCD,0                                          0383
         BNE   @RF00383                                            0383
         TM    CCACSYSF(CCAPTR),B'10000000'                        0383
         BNO   @RF00383                                            0383
*     DO;                           /*                               */
*       IOPPTR=CCAIOPTR;            /* FULL IOP FOR LOCATE           */
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0385
*       IOPBUFAD=SAVBUFAD;          /* SET BUFFER ADDR               */
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0386
*       IOPDSID=IOPCDS;             /*                               */
         MVI   IOPDSID(IOPPTR),X'02'                               0387
*       CALL HMASMDS1(HMASMIOP,'N');/* PASS IOP FOR CDS WITH       0388
*                                      INDICATOR THAT IT IS NOT    0388
*                                      PRIMED                        */
         ST    IOPPTR,@AL00001                                     0388
         LA    @10,@CC01407                                        0388
         ST    @10,@AL00001+4                                      0388
         L     @15,@CV01326                                        0388
         LA    @01,@AL00001                                        0388
         BALR  @14,@15                                             0388
*       RFY                                                        0389
*         RTNCODE RSTD;             /*                               */
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */
         SLR   @14,@14                                             0390
         IC    @14,DSURTNCD                                        0390
         CR    @14,RTNCODE                                         0390
         BNL   *+6
         LR    @14,RTNCODE                                         0390
         STC   @14,DSURTNCD                                        0390
*       RFY                                                        0391
*         RTNCODE UNRSTD;           /*                               */
*     END;                          /*                               */
*                                                                  0392
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE SYSTEM ENTRY ON ACDS AND IF FOUND SET PEMAX TO MAX OF  */
*   /* CDS AND ACDS SYSTEM ENTRY PEMAX                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0393
*   IF DSURTNCD=ZERO                /* IF PREV FUNCTIONS OK          */
*       &CCAASYSF=ON                /* AND SYSTEM ENTRY FOUND        */
*     THEN                          /*                               */
@RF00383 CLI   DSURTNCD,0                                          0393
         BNE   @RF00393                                            0393
         TM    CCAASYSF(CCAPTR),B'01000000'                        0393
         BNO   @RF00393                                            0393
*     DO;                           /*                               */
*       IOPPTR=CCAIOPTR;            /* FULL IOP FOR LOCATE           */
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0395
*       IOPBUFAD=SAVBUFAD;          /* SET BUFFER ADDR               */
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0396
*       IOPDSID=IOPACDS;            /*                               */
         MVI   IOPDSID(IOPPTR),X'0C'                               0397
*       CALL HMASMDS1(HMASMIOP,'N');/* PASS IOP FOR ACDS WITH      0398
*                                      INDICATOR THAT IT IS NOT    0398
*                                      PRIMED                        */
         ST    IOPPTR,@AL00001                                     0398
         LA    @10,@CC01407                                        0398
         ST    @10,@AL00001+4                                      0398
         L     @15,@CV01326                                        0398
         LA    @01,@AL00001                                        0398
         BALR  @14,@15                                             0398
*       RFY                                                        0399
*         RTNCODE RSTD;             /*                               */
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */
         SLR   @14,@14                                             0400
         IC    @14,DSURTNCD                                        0400
         CR    @14,RTNCODE                                         0400
         BNL   *+6
         LR    @14,RTNCODE                                         0400
         STC   @14,DSURTNCD                                        0400
*       RFY                                                        0401
*         RTNCODE UNRSTD;           /*                               */
*       IOPPTR=CCAIOPTR;            /* GENERAL IOP                   */
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0402
*     END;                          /*                               */
         EJECT
*                                                                  0404
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE SYSTEM ENTRY ON PTS AND IF FOUND SET ANY CCA FIELDS    */
*   /* APPLICABLE                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0404
*   IF DSURTNCD=ZERO                /*                               */
*       &CCAPSYSF=ON                /* PTS SYSTEM ENTRY FOUND?       */
*     THEN                          /*                               */
@RF00393 CLI   DSURTNCD,0                                          0404
         BNE   @RF00404                                            0404
         TM    CCAPSYSF(CCAPTR),B'00100000'                        0404
         BNO   @RF00404                                            0404
*     DO;                           /*                               */
*       IOPPTR=CCAIOPTR;            /* FULL IOP ADDR                 */
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0406
*       IOPBUFAD=SAVBUFAD;          /* SET BUFFER ADDR               */
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0407
*       IOPDSID=IOPPTS;             /*                               */
         MVI   IOPDSID(IOPPTR),X'06'                               0408
*       CALL HMASMDS1(HMASMIOP,'N');/* PASS IOP FOR PTS WITH       0409
*                                      INDICATOR THAT IT IS NOT    0409
*                                      PRIMED                        */
         ST    IOPPTR,@AL00001                                     0409
         LA    @10,@CC01407                                        0409
         ST    @10,@AL00001+4                                      0409
         L     @15,@CV01326                                        0409
         LA    @01,@AL00001                                        0409
         BALR  @14,@15                                             0409
*       RFY                                                        0410
*         RTNCODE RSTD;             /*                               */
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */
         SLR   @14,@14                                             0411
         IC    @14,DSURTNCD                                        0411
         CR    @14,RTNCODE                                         0411
         BNL   *+6
         LR    @14,RTNCODE                                         0411
         STC   @14,DSURTNCD                                        0411
*       RFY                                                        0412
*         RTNCODE UNRSTD;           /*                               */
*     END;                          /*                               */
*                                                                  0413
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NEW IOP PTR OBTAINED THEN INSURE THAT BUFAD IN IOP IS OK   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*   IF CCAIOPTR=ZERO                /*                               */
*     THEN                          /*                               */
@RF00404 ICM   @10,15,CCAIOPTR(CCAPTR)                             0414
         BNZ   @RF00414                                            0414
*     CCAIOPTR=SAVIOPTR;            /* RESET PTR TO PASSED IOP       */
         MVC   CCAIOPTR(4,CCAPTR),SAVIOPTR                         0415
*   IOPPTR=CCAIOPTR;                /*                               */
@RF00414 L     IOPPTR,CCAIOPTR(,CCAPTR)                            0416
*   IOPBUFAD=SAVBUFAD;              /*                               */
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0417
         EJECT
*                                                                  0418
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OUT OF STORAGE CONDITION OCCURRED THEN ISSUE MESSAGE       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0418
*   IF M202I=ON                     /* IF OUT OF STORAGE             */
*     THEN                          /*                               */
         TM    M202I,B'10000000'                                   0418
         BNO   @RF00418                                            0418
*     DO;                           /*                               */
*       MGPCLEAR=''B;               /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0420
*       MGPMGNO1=HMA202I;           /* UNABLE TO OBTAIN STORAGE FOR
*                                      WORK AREAS                    */
         MVC   MGPMGNO1(2),@CH00238                                0421
*       MGPTYPE=MGPTERM;            /*                               */
         MVI   MGPTYPE,X'05'                                       0422
*       CALL HMASMMSG(HMASMMGP);    /*                               */
         L     @15,@CV01328                                        0423
         LA    @01,@AL00423                                        0423
         BALR  @14,@15                                             0423
*       DSURTNCD=MAX(DSURTNCD,STOPSMP);/* SET RC TO 16               */
         SLR   @10,@10                                             0424
         IC    @10,DSURTNCD                                        0424
         LA    @06,16                                              0424
         CR    @10,@06                                             0424
         BNL   *+6
         LR    @10,@06                                             0424
         STC   @10,DSURTNCD                                        0424
*     END;                          /*                               */
*                                                                  0425
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING COMPLETED - NOW RETURN                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0426
*   RETURN CODE(DSURTNCD);          /*                               */
@RF00418 SLR   @15,@15                                             0426
         IC    @15,DSURTNCD                                        0426
         L     @13,4(,@13)                                         0426
         L     @14,12(,@13)                                        0426
         LM    @00,@12,20(@13)                                     0426
         BR    @14                                                 0426
         EJECT
*                                                                  0427
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO OPEN ALL SMP DATA SETS TO DETERMINE BLOCKING*/
*   /* FACTORS FOR LATER BUFFER GETMAINS. IF THE DATA SET IS ALREADY */
*   /* OPEN HMASMIO WILL STILL PASS BACK THE BLKSIZE FOR THAT DATA   */
*   /* SET.                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*DSUOPEN:                           /*                               */
*   PROCEDURE;                      /*                               */
@EL00001 L     @13,4(,@13)                                         0427
@EF00001 DS    0H                                                  0427
@ER00001 LM    @14,@12,12(@13)                                     0427
         BR    @14                                                 0427
DSUOPEN  STM   @14,@12,@SA00002                                    0427
*   DECLARE                         /*                               */
*     OPNRTNCD FIXED(8);            /*                               */
*   RFY                                                            0429
*     HMASMIOP BASED(IOPPTR);       /*                               */
*   OPNRTNCD=ZERO;                  /* INIT RC                       */
         MVI   OPNRTNCD,X'00'                                      0430
*   IOPFUNCT=IOPOPEN;               /* SET TO OPEN DATA SET          */
         MVI   IOPFUNCT(IOPPTR),X'00'                              0431
*   IOPDSID=IOPCDS;                 /* OPEN CDS DS           @SA74317*/
         MVI   IOPDSID(IOPPTR),X'02'                               0432
*   CALL HMASMIO(HMASMIOP);         /* DO OPEN TO GET BLKSIZ @SA74317*/
         ST    IOPPTR,@AL00001                                     0433
         L     @15,@CV01327                                        0433
         LA    @01,@AL00001                                        0433
         BALR  @14,@15                                             0433
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0434
         BNE   @RF00434                                            0434
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0435
*   IF IOPRETRN=IOPGOOD             /* OPEN OK?              @YA07506*/
*     THEN                          /* YES                   @SA74317*/
@RF00434 CLI   IOPRETRN(IOPPTR),0                                  0436
         BNE   @RF00436                                            0436
*     DO;                           /*                               */
*       CCACDSP=ON;                 /*                               */
         OI    CCACDSP(CCAPTR),B'10000000'                         0438
*       CCACBFMX=IOPBLKSI/LRECL;    /* CALC BLOCKING FCTR    @SA74317*/
         LH    @00,IOPBLKSI(,IOPPTR)                               0439
         SRDA  @00,32                                              0439
         D     @00,@CF00516                                        0439
         STH   @01,CCACBFMX(,CCAPTR)                               0439
*     END;                          /*                               */
*   IOPDSID=IOPACDS;                /* SET TO OPEN ACDS      @SA74317*/
@RF00436 MVI   IOPDSID(IOPPTR),X'0C'                               0441
*   CALL HMASMIO(HMASMIOP);         /* DO OPEN               @SA74317*/
         ST    IOPPTR,@AL00001                                     0442
         L     @15,@CV01327                                        0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0443
         BNE   @RF00443                                            0443
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0444
*   IF IOPRETRN=IOPGOOD             /* OPEN OK?              @YA07506*/
*     THEN                          /* YES                   @SA74317*/
@RF00443 CLI   IOPRETRN(IOPPTR),0                                  0445
         BNE   @RF00445                                            0445
*     DO;                           /*                               */
*       CCAACDSP=ON;                /*                               */
         OI    CCAACDSP(CCAPTR),B'01000000'                        0447
*       CCAABFMX=IOPBLKSI/LRECL;    /* SET ACDS BLKING FACTOR        */
         LH    @00,IOPBLKSI(,IOPPTR)                               0448
         SRDA  @00,32                                              0448
         D     @00,@CF00516                                        0448
         STH   @01,CCAABFMX(,CCAPTR)                               0448
*     END;                          /*                               */
*   IOPDSID=IOPSCDS;                /* INDICATE SMPSCDS      @Z40SP00*/
@RF00445 MVI   IOPDSID(IOPPTR),X'21'                               0450
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPSCDS          @Z40SP00*/
         ST    IOPPTR,@AL00001                                     0451
         L     @15,@CV01327                                        0451
         LA    @01,@AL00001                                        0451
         BALR  @14,@15                                             0451
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0452
         BNE   @RF00452                                            0452
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0453
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00452 CLI   IOPRETRN(IOPPTR),0                                  0454
         BNE   @RF00454                                            0454
*     DO;                           /*                               */
*       CCASCDSP=ON;                /* SCDS PRESENT                  */
         OI    CCASCDSP(CCAPTR),B'00100000'                        0456
*       CCAVBFMX=IOPBLKSI/LRECL;    /* SET SCDS BLOCK FACTOR         */
         LH    @00,IOPBLKSI(,IOPPTR)                               0457
         SRDA  @00,32                                              0457
         D     @00,@CF00516                                        0457
         STH   @01,CCAVBFMX(,CCAPTR)                               0457
*     END;                          /*                               */
*   IOPDSID=IOPPTS;                 /* INDICATE SMPPTS       @Z40SP00*/
@RF00454 MVI   IOPDSID(IOPPTR),X'06'                               0459
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPPTS           @Z40SP00*/
         ST    IOPPTR,@AL00001                                     0460
         L     @15,@CV01327                                        0460
         LA    @01,@AL00001                                        0460
         BALR  @14,@15                                             0460
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0461
         BNE   @RF00461                                            0461
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0462
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00461 CLI   IOPRETRN(IOPPTR),0                                  0463
         BNE   @RF00463                                            0463
*     DO;                           /*                               */
*       CCAPTSP=ON;                 /* PTS PRESENT                   */
         OI    CCAPTSP(CCAPTR),B'00010000'                         0465
*       CCAPBFMX=IOPBLKSI/LRECL;    /* SET PTS BLOCK FACTOR  @Z40SP00*/
         LH    @00,IOPBLKSI(,IOPPTR)                               0466
         SRDA  @00,32                                              0466
         D     @00,@CF00516                                        0466
         STH   @01,CCAPBFMX(,CCAPTR)                               0466
*     END;                          /*                               */
*   IOPDSID=IOPMTS;                 /* INDICATE SMPMTS               */
@RF00463 MVI   IOPDSID(IOPPTR),X'12'                               0468
*   CALL HMASMIO(HMASMIOP);         /* OPEN PTS                      */
         ST    IOPPTR,@AL00001                                     0469
         L     @15,@CV01327                                        0469
         LA    @01,@AL00001                                        0469
         BALR  @14,@15                                             0469
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0470
         BNE   @RF00470                                            0470
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0471
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00470 CLI   IOPRETRN(IOPPTR),0                                  0472
         BNE   @RF00472                                            0472
*     DO;                           /*                               */
*       CCAMTSP=ON;                 /* MTS PRESENT                   */
         OI    CCAMTSP(CCAPTR),B'00001000'                         0474
*       CCAMBFMX=IOPBLKSI/LRECL;    /* SET MTS BLOCK FACTOR  @Z40SP00*/
         LH    @00,IOPBLKSI(,IOPPTR)                               0475
         SRDA  @00,32                                              0475
         D     @00,@CF00516                                        0475
         STH   @01,CCAMBFMX(,CCAPTR)                               0475
*     END;                          /*                               */
*   IOPDSID=IOPSTS;                 /* INDICATE SMPSTS       @Z40SP00*/
@RF00472 MVI   IOPDSID(IOPPTR),X'1A'                               0477
*   CALL HMASMIO(HMASMIOP);         /* OPEN PTS              @Z40SP00*/
         ST    IOPPTR,@AL00001                                     0478
         L     @15,@CV01327                                        0478
         LA    @01,@AL00001                                        0478
         BALR  @14,@15                                             0478
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0479
         BNE   @RF00479                                            0479
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0480
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?    @Z40SP00*/
*     THEN                          /* YES - SAVE BLKSIZE    @Z40SP00*/
@RF00479 CLI   IOPRETRN(IOPPTR),0                                  0481
         BNE   @RF00481                                            0481
*     DO;                           /*                               */
*       CCASTSP=ON;                 /* STS PRESENT                   */
         OI    CCASTSP(CCAPTR),B'00000100'                         0483
*       CCASBFMX=IOPBLKSI/LRECL;    /* SET STS BLOCK FACTOR  @Z40SP00*/
         LH    @00,IOPBLKSI(,IOPPTR)                               0484
         SRDA  @00,32                                              0484
         D     @00,@CF00516                                        0484
         STH   @01,CCASBFMX(,CCAPTR)                               0484
*     END;                          /*                               */
*   IOPDSID=IOPCRQ;                 /* INDICATE SMPCRQ               */
@RF00481 MVI   IOPDSID(IOPPTR),X'1C'                               0486
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPCRQ                   */
         ST    IOPPTR,@AL00001                                     0487
         L     @15,@CV01327                                        0487
         LA    @01,@AL00001                                        0487
         BALR  @14,@15                                             0487
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0488
         BNE   @RF00488                                            0488
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0489
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00488 CLI   IOPRETRN(IOPPTR),0                                  0490
         BNE   @RF00490                                            0490
*     DO;                           /*                               */
*       CCACRQP=ON;                 /* CRQ PRESENT                   */
         OI    CCACRQP(CCAPTR),B'00000010'                         0492
*       CCAQBFMX=IOPBLKSI/LRECL;    /* SAVE CRQ BLOCKING FACTOR      */
         LH    @00,IOPBLKSI(,IOPPTR)                               0493
         SRDA  @00,32                                              0493
         D     @00,@CF00516                                        0493
         STH   @01,CCAQBFMX(,CCAPTR)                               0493
*     END;                          /*                               */
*   IOPDSID=IOPACRQ;                /* INDICATE SMPACRQ              */
@RF00490 MVI   IOPDSID(IOPPTR),X'1E'                               0495
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPACRQ                  */
         ST    IOPPTR,@AL00001                                     0496
         L     @15,@CV01327                                        0496
         LA    @01,@AL00001                                        0496
         BALR  @14,@15                                             0496
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0497
         BNE   @RF00497                                            0497
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0498
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00497 CLI   IOPRETRN(IOPPTR),0                                  0499
         BNE   @RF00499                                            0499
*     DO;                           /*                               */
*       CCAACRQP=ON;                /* ACRQ PRESENT                  */
         OI    CCAACRQP(CCAPTR),B'00000001'                        0501
*       CCAXBFMX=IOPBLKSI/LRECL;    /* SAVE ACRQ BLOCKING FACTOR     */
         LH    @00,IOPBLKSI(,IOPPTR)                               0502
         SRDA  @00,32                                              0502
         D     @00,@CF00516                                        0502
         STH   @01,CCAXBFMX(,CCAPTR)                               0502
*     END;                          /*                               */
*   IOPDSID=IOPWK1;                 /* INDICATE SMPWK1               */
@RF00499 MVI   IOPDSID(IOPPTR),X'23'                               0504
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPWK1                   */
         ST    IOPPTR,@AL00001                                     0505
         L     @15,@CV01327                                        0505
         LA    @01,@AL00001                                        0505
         BALR  @14,@15                                             0505
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0506
         BNE   @RF00506                                            0506
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0507
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00506 CLI   IOPRETRN(IOPPTR),0                                  0508
         BNE   @RF00508                                            0508
*     DO;                           /*                               */
*       CCAWK1P=ON;                 /* WK1 PRESENT                   */
         OI    CCAWK1P(CCAPTR),B'10000000'                         0510
*       CCA1BFMX=IOPBLKSI/LRECL;    /* SET WK1 BLOCK FACTOR          */
         LH    @00,IOPBLKSI(,IOPPTR)                               0511
         SRDA  @00,32                                              0511
         D     @00,@CF00516                                        0511
         STH   @01,CCA1BFMX(,CCAPTR)                               0511
*     END;                          /*                               */
*   IOPDSID=IOPWK2;                 /* INDICATE SMPWK2               */
@RF00508 MVI   IOPDSID(IOPPTR),X'24'                               0513
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPWK2                   */
         ST    IOPPTR,@AL00001                                     0514
         L     @15,@CV01327                                        0514
         LA    @01,@AL00001                                        0514
         BALR  @14,@15                                             0514
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0515
         BNE   @RF00515                                            0515
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0516
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00515 CLI   IOPRETRN(IOPPTR),0                                  0517
         BNE   @RF00517                                            0517
*     DO;                           /*                               */
*       CCAWK2P=ON;                 /* WK2 PRESENT                   */
         OI    CCAWK2P(CCAPTR),B'01000000'                         0519
*       CCA2BFMX=IOPBLKSI/LRECL;    /* SET WK2 BLOCK FACTOR          */
         LH    @00,IOPBLKSI(,IOPPTR)                               0520
         SRDA  @00,32                                              0520
         D     @00,@CF00516                                        0520
         STH   @01,CCA2BFMX(,CCAPTR)                               0520
*     END;                          /*                               */
*   IOPDSID=IOPWK3;                 /* INDICATE SMPWK3               */
@RF00517 MVI   IOPDSID(IOPPTR),X'25'                               0522
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPWK3                   */
         ST    IOPPTR,@AL00001                                     0523
         L     @15,@CV01327                                        0523
         LA    @01,@AL00001                                        0523
         BALR  @14,@15                                             0523
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0524
         BNE   @RF00524                                            0524
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0525
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00524 CLI   IOPRETRN(IOPPTR),0                                  0526
         BNE   @RF00526                                            0526
*     DO;                           /*                               */
*       CCAWK3P=ON;                 /* WK3 PRESENT                   */
         OI    CCAWK3P(CCAPTR),B'00100000'                         0528
*       CCA3BFMX=IOPBLKSI/LRECL;    /* SET WK3 BLOCK FACTOR          */
         LH    @00,IOPBLKSI(,IOPPTR)                               0529
         SRDA  @00,32                                              0529
         D     @00,@CF00516                                        0529
         STH   @01,CCA3BFMX(,CCAPTR)                               0529
*     END;                          /*                               */
*   IOPDSID=IOPWK4;                 /* INDICATE SMPWK4               */
@RF00526 MVI   IOPDSID(IOPPTR),X'26'                               0531
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPWK4                   */
         ST    IOPPTR,@AL00001                                     0532
         L     @15,@CV01327                                        0532
         LA    @01,@AL00001                                        0532
         BALR  @14,@15                                             0532
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */
*     THEN                          /* SAVE RC                       */
         CLI   IOPRETRN(IOPPTR),16                                 0533
         BNE   @RF00533                                            0533
*     OPNRTNCD=IOPIOERR;            /*                               */
         MVI   OPNRTNCD,X'10'                                      0534
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */
*     THEN                          /* YES - SAVE BLKSIZE            */
@RF00533 CLI   IOPRETRN(IOPPTR),0                                  0535
         BNE   @RF00535                                            0535
*     DO;                           /*                               */
*       CCAWK4P=ON;                 /* WK4 PRESENT                   */
         OI    CCAWK4P(CCAPTR),B'00010000'                         0537
*       CCA4BFMX=IOPBLKSI/LRECL;    /* SET WK4 BLOCK FACTOR          */
         LH    @00,IOPBLKSI(,IOPPTR)                               0538
         SRDA  @00,32                                              0538
         D     @00,@CF00516                                        0538
         STH   @01,CCA4BFMX(,CCAPTR)                               0538
*     END;                          /*                               */
*   DEVDDNAM=CCADSIDA(IOPWK5);      /*                               */
@RF00535 L     @10,CCADSAD(,CCAPTR)                                0540
         MVC   DEVDDNAM(8),CCADSIDA+304(@10)                       0540
*   GEN(DEVTYPE  DEVDDNAM,DEVADDR)                                 0541
*   REFS(DEVDDNAM,DEVADDR);         /*                               */
         DEVTYPE  DEVDDNAM,DEVADDR
*   RFY                                                            0542
*     RTNCODE RSTD;                 /*                               */
*   IF RTNCODE=ZERO                 /* SMPWRK5 PRESENT               */
*     THEN                          /*                               */
         LTR   RTNCODE,RTNCODE                                     0543
         BNZ   @RF00543                                            0543
*     CCAWK5P=ON;                   /*                               */
         OI    CCAWK5P(CCAPTR),B'00001000'                         0544
*   RFY                                                            0545
*     RTNCODE UNRSTD;               /*                               */
@RF00543 DS    0H                                                  0546
*   DEVDDNAM=CCADSIDA(IOPRPT);      /*                               */
         L     @10,CCADSAD(,CCAPTR)                                0546
         MVC   DEVDDNAM(8),CCADSIDA+320(@10)                       0546
*   GEN(DEVTYPE  DEVDDNAM,DEVADDR)                                 0547
*   REFS(DEVDDNAM,DEVADDR);         /*                               */
         DEVTYPE  DEVDDNAM,DEVADDR
*   RFY                                                            0548
*     RTNCODE RSTD;                 /*                               */
*   IF RTNCODE=ZERO                 /* SMPRPT PRESENT                */
*     THEN                          /*                               */
         LTR   RTNCODE,RTNCODE                                     0549
         BNZ   @RF00549                                            0549
*     DO;                           /*                               */
*       CCARPTP=ON;                 /*                               */
         OI    CCARPTP(CCAPTR),B'00001000'                         0551
*       CCARPTDS=IOPRPT;            /* SET TO USE FOR ALL REPORTS    */
         MVI   CCARPTDS(CCAPTR),X'29'                              0552
*     END;                          /*                               */
*   ELSE                            /*                               */
*     CCARPTDS=IOPPRINT;            /* ELSE USE SMPOUT               */
         B     @RC00549                                            0554
@RF00549 MVI   CCARPTDS(CCAPTR),X'0B'                              0554
*   RFY                                                            0555
*     RTNCODE UNRSTD;               /*                               */
@RC00549 DS    0H                                                  0556
*   DEVDDNAM=CCADSIDA(IOPLIST);     /*                               */
         L     @10,CCADSAD(,CCAPTR)                                0556
         MVC   DEVDDNAM(8),CCADSIDA+328(@10)                       0556
*   GEN(DEVTYPE  DEVDDNAM,DEVADDR)                                 0557
*   REFS(DEVDDNAM,DEVADDR);         /*                               */
         DEVTYPE  DEVDDNAM,DEVADDR
*   RFY                                                            0558
*     RTNCODE RSTD;                 /*                               */
*   IF RTNCODE=ZERO                 /* SMPLIST PRESENT               */
*     THEN                          /*                               */
         LTR   RTNCODE,RTNCODE                                     0559
         BNZ   @RF00559                                            0559
*     DO;                           /*                               */
*       CCALISTP=ON;                /*                               */
         OI    CCALISTP(CCAPTR),B'00010000'                        0561
*       CCALSTDS=IOPLIST;           /* SET TO USE FOR ALL LISTS      */
         MVI   CCALSTDS(CCAPTR),X'2A'                              0562
*     END;                          /*                               */
*   ELSE                            /*                               */
*     CCALSTDS=IOPPRINT;            /* ELSE USE SMPOUT               */
         B     @RC00559                                            0564
@RF00559 MVI   CCALSTDS(CCAPTR),X'0B'                              0564
*   RFY                                                            0565
*     RTNCODE UNRSTD;               /*                               */
@RC00559 DS    0H                                                  0566
*   RETURN CODE(OPNRTNCD);          /*                               */
         SLR   @15,@15                                             0566
         IC    @15,OPNRTNCD                                        0566
         L     @14,@SA00002                                        0566
         LM    @00,@12,@SA00002+8                                  0566
         BR    @14                                                 0566
*   END DSUOPEN;                    /*                               */
         EJECT
*                                                                  0568
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE CALLED TO GETMAIN INPUT AND OUTBUT BUFFER AREA FOR THE*/
*   /* VARIOUS SMP DATA SETS OPENED PREVIOUSLY. THE ADDRESSES OF THE */
*   /* BUFFER AREAS ARE PUT INTO APPROPRIATE FIELDS IN THE CCA       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0568
*DSUGETMN:                          /*                               */
*   PROCEDURE;                      /*                               */
DSUGETMN STM   @14,@12,@SA00003                                    0568
*   DECLARE                         /*                               */
*     GETRTNCD FIXED(8);            /*                               */
*   GETRTNCD=ZERO;                  /* INIT RC                       */
         MVI   GETRTNCD,X'00'                                      0570
*   RFY                                                            0571
*     SIZE RSTD;                                                   0571
*   RFY                                                            0572
*     GMADDR RSTD;                  /*                               */
*                                                                  0572
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BUFFERS FOR CDS/ACDS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0573
*   IF GETRTNCD=ZERO                /*                               */
*       &(CCACDSP=ON                /* AND EITHER CDS PRESENT        */
*       ×CCAACDSP=ON)               /* OR ACDS PRESENT               */
*     THEN                          /*                               */
         CLI   GETRTNCD,0                                          0573
         BNE   @RF00573                                            0573
         TM    CCACDSP(CCAPTR),B'11000000'                         0573
         BZ    @RF00573                                            0573
*     DO;                           /*                               */
*       SIZE=MAX(CCACBFMX,CCAABFMX)*(LRECL*2);/* CALC STORAGE        */
         LH    SIZE,CCACBFMX(,CCAPTR)                              0575
         LH    @10,CCAABFMX(,CCAPTR)                               0575
         CR    SIZE,@10                                            0575
         BNL   *+6
         LR    SIZE,@10                                            0575
         MH    SIZE,@CH00863                                       0575
*       GMADDR=ADDR(CCACBFIA);      /* RTN ADDR                      */
         LA    GMADDR,CCACBFIA(,CCAPTR)                            0576
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0577
*       REFS(SIZE,CCACBFIA);        /* GET INPUT/OUTPUT BFRS @Z40SP00*/
         GETMAIN EC,LV=(SIZE),A=(GMADDR)
*       RFY                                                        0578
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       IF RTNCODE^=IOPGOOD         /* GETMAIN OK??          @YA07506*/
*         THEN                      /* NO - ERR STOP         @SA74317*/
         LTR   RTNCODE,RTNCODE                                     0579
         BZ    @RF00579                                            0579
*         DO;                       /* ERR                   @SA74317*/
*           M202I=ON;               /*                               */
         OI    M202I,B'10000000'                                   0581
*           GETRTNCD=STOPSMP;       /*                               */
         MVI   GETRTNCD,X'10'                                      0582
*         END;                      /*                               */
*       ELSE                        /*                               */
*         DO;                       /*                               */
         B     @RC00579                                            0584
@RF00579 DS    0H                                                  0585
*           CCACBFOA=CCACBFIA+SIZE/2;/* CAL OUTPUT BUFFER ADDR       */
         LR    @00,SIZE                                            0585
         SRDA  @00,32                                              0585
         D     @00,@CF00186                                        0585
         AL    @01,CCACBFIA(,CCAPTR)                               0585
         ST    @01,CCACBFOA(,CCAPTR)                               0585
*           CCACBFSZ=SIZE;          /* SAVE GETMAIN SIZE     @Z40SP00*/
         ST    SIZE,CCACBFSZ(,CCAPTR)                              0586
*         END;                      /*                               */
*       RFY                                                        0588
*         RTNCODE UNRSTD;                                          0588
@RC00579 DS    0H                                                  0589
*     END;                          /*                               */
*                                                                  0590
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BUFFERS FOR SCDS                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0590
*   IF GETRTNCD=ZERO                /* PREV FUNCTIONS OK             */
*       &CCASCDSP=ON                /* AND SCDS PRESENT              */
*     THEN                          /*                               */
@RF00573 CLI   GETRTNCD,0                                          0590
         BNE   @RF00590                                            0590
         TM    CCASCDSP(CCAPTR),B'00100000'                        0590
         BNO   @RF00590                                            0590
*     DO;                           /*                               */
*       SIZE=CCAVBFMX*(LRECL*2);    /* CALC GETMAIN SIZE             */
         LH    SIZE,CCAVBFMX(,CCAPTR)                              0592
         MH    SIZE,@CH00863                                       0592
*       GMADDR=ADDR(CCAVBFIA);      /* RTN ADDR                      */
         LA    GMADDR,CCAVBFIA(,CCAPTR)                            0593
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0594
*       REFS(SIZE,CCAVBFIA);        /* GET BUFFERS                   */
         GETMAIN EC,LV=(SIZE),A=(GMADDR)
*       RFY                                                        0595
*         RTNCODE RSTD;             /*                               */
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */
         LTR   RTNCODE,RTNCODE                                     0596
         BZ    @RF00596                                            0596
*         DO;                                                      0597
*           M202I=ON;               /* SET SW TO ISSUE MSG           */
         OI    M202I,B'10000000'                                   0598
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE               */
         MVI   GETRTNCD,X'10'                                      0599
*         END;                      /* END GETMAIN FAILED            */
*       ELSE                        /*                               */
*         DO;                       /*                               */
         B     @RC00596                                            0601
@RF00596 DS    0H                                                  0602
*           CCAVBFOA=CCAVBFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */
         LR    @00,SIZE                                            0602
         SRDA  @00,32                                              0602
         D     @00,@CF00186                                        0602
         AL    @01,CCAVBFIA(,CCAPTR)                               0602
         ST    @01,CCAVBFOA(,CCAPTR)                               0602
*           CCAVBFSZ=SIZE;          /* SAVE GETMAIN SIZE             */
         ST    SIZE,CCAVBFSZ(,CCAPTR)                              0603
*         END;                      /*                               */
*       RFY                                                        0605
*         RTNCODE UNRSTD;           /*                               */
@RC00596 DS    0H                                                  0606
*     END;                          /*                               */
*                                                                  0607
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BUFFERS FOR PTS/MTS/STS                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0607
*   IF GETRTNCD=ZERO                /* PREV FUNCTIONS OK             */
*       &(CCAPTSP=ON                /* AND EITHER PTS PRESENT        */
*       ×CCAMTSP=ON                 /* OR MTS PRESENT                */
*       ×CCASTSP=ON)                /* OR STS PRESENT                */
*     THEN                          /*                               */
@RF00590 CLI   GETRTNCD,0                                          0607
         BNE   @RF00607                                            0607
         TM    CCAPTSP(CCAPTR),B'00011100'                         0607
         BZ    @RF00607                                            0607
*     DO;                           /*                               */
*       SIZE=MAX(CCAPBFMX,CCAMBFMX,CCASBFMX)*(LRECL*2);/* CALC     0609
*                                      GETMAIN SIZE          @Z40SP00*/
         LH    SIZE,CCAPBFMX(,CCAPTR)                              0609
         LH    @10,CCAMBFMX(,CCAPTR)                               0609
         CR    SIZE,@10                                            0609
         BNL   *+6
         LR    SIZE,@10                                            0609
         LH    @10,CCASBFMX(,CCAPTR)                               0609
         CR    SIZE,@10                                            0609
         BNL   *+6
         LR    SIZE,@10                                            0609
         MH    SIZE,@CH00863                                       0609
*       GMADDR=ADDR(CCAPBFIA);      /* RTN ADDR                      */
         LA    GMADDR,CCAPBFIA(,CCAPTR)                            0610
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0611
*       REFS(SIZE,CCAPBFIA);        /* GET BUFFERS           @Z40SP00*/
         GETMAIN EC,LV=(SIZE),A=(GMADDR)
*       RFY                                                        0612
*         RTNCODE RSTD;             /*                       @Z40SP00*/
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */
         LTR   RTNCODE,RTNCODE                                     0613
         BZ    @RF00613                                            0613
*         DO;                                                      0614
*           M202I=ON;               /* SET SW TO ISSUE MSG           */
         OI    M202I,B'10000000'                                   0615
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE       @YA07506*/
         MVI   GETRTNCD,X'10'                                      0616
*         END;                      /* END GETMAIN FAILED            */
*       ELSE                        /*                               */
*         DO;                       /*                               */
         B     @RC00613                                            0618
@RF00613 DS    0H                                                  0619
*           CCAPBFOA=CCAPBFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */
         LR    @00,SIZE                                            0619
         SRDA  @00,32                                              0619
         D     @00,@CF00186                                        0619
         AL    @01,CCAPBFIA(,CCAPTR)                               0619
         ST    @01,CCAPBFOA(,CCAPTR)                               0619
*           CCAPBFSZ=SIZE;          /* SAVE GETMAIN SIZE     @Z40SP00*/
         ST    SIZE,CCAPBFSZ(,CCAPTR)                              0620
*         END;                      /*                               */
*       RFY                                                        0622
*         RTNCODE UNRSTD;           /*                               */
@RC00613 DS    0H                                                  0623
*     END;                          /*                               */
*                                                                  0624
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BUFFERS FOR CRQ/ACRQ                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0624
*   IF GETRTNCD=ZERO                /* IF PREV FUNCTIONS OK          */
*       &(CCACRQP=ON                /* AND CRQ OR ACRQ DD PRESENT    */
*       ×CCAACRQP=ON)               /*                               */
*     THEN                          /*                               */
@RF00607 CLI   GETRTNCD,0                                          0624
         BNE   @RF00624                                            0624
         TM    CCACRQP(CCAPTR),B'00000011'                         0624
         BZ    @RF00624                                            0624
*     DO;                           /*                               */
*       SIZE=MAX(CCAQBFMX,CCAXBFMX)*(LRECL*2);/* CALC SIZE           */
         LH    SIZE,CCAQBFMX(,CCAPTR)                              0626
         LH    @10,CCAXBFMX(,CCAPTR)                               0626
         CR    SIZE,@10                                            0626
         BNL   *+6
         LR    SIZE,@10                                            0626
         MH    SIZE,@CH00863                                       0626
*       GMADDR=ADDR(CCAQBFIA);      /* RTN ADDR                      */
         LA    GMADDR,CCAQBFIA(,CCAPTR)                            0627
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0628
*       REFS(SIZE,CCAQBFIA);        /* GET BUFFERS                   */
         GETMAIN EC,LV=(SIZE),A=(GMADDR)
*       RFY                                                        0629
*         RTNCODE RSTD;             /*                               */
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */
         LTR   RTNCODE,RTNCODE                                     0630
         BZ    @RF00630                                            0630
*         DO;                                                      0631
*           M202I=ON;               /* SET SW TO ISSUE MSG           */
         OI    M202I,B'10000000'                                   0632
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE               */
         MVI   GETRTNCD,X'10'                                      0633
*         END;                      /* END GETMAIN FAILED            */
*       ELSE                        /*                               */
*         DO;                       /*                               */
         B     @RC00630                                            0635
@RF00630 DS    0H                                                  0636
*           CCAQBFOA=CCAQBFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */
         LR    @00,SIZE                                            0636
         SRDA  @00,32                                              0636
         D     @00,@CF00186                                        0636
         AL    @01,CCAQBFIA(,CCAPTR)                               0636
         ST    @01,CCAQBFOA(,CCAPTR)                               0636
*           CCAQBFSZ=SIZE;          /* SAVE GETMAIN SIZE             */
         ST    SIZE,CCAQBFSZ(,CCAPTR)                              0637
*         END;                      /*                               */
*       RFY                                                        0639
*         RTNCODE UNRSTD;           /*                               */
@RC00630 DS    0H                                                  0640
*     END;                          /*                               */
*                                                                  0641
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BUFFERS FOR WRK1/WRK2/WRK3                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0641
*   IF GETRTNCD=ZERO                /* ALL PREV FUNCTIONS OK         */
*       &(CCAWK1P=ON                /* AND EITHER WRK1 PRESENT       */
*       ×CCAWK2P=ON                 /* OR WK2 PRESENT                */
*       ×CCAWK3P=ON)                /* OR WK3 PRESENT                */
*     THEN                          /*                               */
@RF00624 CLI   GETRTNCD,0                                          0641
         BNE   @RF00641                                            0641
         TM    CCAWK1P(CCAPTR),B'11100000'                         0641
         BZ    @RF00641                                            0641
*     DO;                           /*                               */
*       SIZE=MAX(CCA1BFMX,CCA2BFMX,CCA3BFMX)*LRECL*2;/* SET MAX    0643
*                                      BUFFER SIZE                   */
         LH    SIZE,CCA1BFMX(,CCAPTR)                              0643
         LH    @10,CCA2BFMX(,CCAPTR)                               0643
         CR    SIZE,@10                                            0643
         BNL   *+6
         LR    SIZE,@10                                            0643
         LH    @10,CCA3BFMX(,CCAPTR)                               0643
         CR    SIZE,@10                                            0643
         BNL   *+6
         LR    SIZE,@10                                            0643
         MH    SIZE,@CH00863                                       0643
*       GMADDR=ADDR(CCAWBFIA);      /* RTN ADDR                      */
         LA    GMADDR,CCAWBFIA(,CCAPTR)                            0644
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0645
*       REFS(SIZE,CCAWBFIA);        /* GET BUFFERS                   */
         GETMAIN EC,LV=(SIZE),A=(GMADDR)
*       RFY                                                        0646
*         RTNCODE RSTD;             /*                               */
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */
         LTR   RTNCODE,RTNCODE                                     0647
         BZ    @RF00647                                            0647
*         DO;                                                      0648
*           M202I=ON;               /* SET SW TO ISSUE MSG           */
         OI    M202I,B'10000000'                                   0649
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE               */
         MVI   GETRTNCD,X'10'                                      0650
*         END;                      /* END GETMAIN FAILED            */
*       ELSE                        /*                               */
*         DO;                       /*                               */
         B     @RC00647                                            0652
@RF00647 DS    0H                                                  0653
*           CCAWBFOA=CCAWBFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */
         LR    @00,SIZE                                            0653
         SRDA  @00,32                                              0653
         D     @00,@CF00186                                        0653
         AL    @01,CCAWBFIA(,CCAPTR)                               0653
         ST    @01,CCAWBFOA(,CCAPTR)                               0653
*           CCAWBFSZ=SIZE;          /* SAVE GETMAIN SIZE             */
         ST    SIZE,CCAWBFSZ(,CCAPTR)                              0654
*         END;                      /*                               */
*       RFY                                                        0656
*         RTNCODE UNRSTD;           /*                               */
@RC00647 DS    0H                                                  0657
*     END;                          /*                               */
*                                                                  0658
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BUFFERS FOR WRK4                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0658
*   IF GETRTNCD=ZERO                /* ALL PREV FUNCTIONS OK         */
*       &CCAWK4P=ON                 /* AND WK4 DD PRESENT            */
*     THEN                          /*                               */
@RF00641 CLI   GETRTNCD,0                                          0658
         BNE   @RF00658                                            0658
         TM    CCAWK4P(CCAPTR),B'00010000'                         0658
         BNO   @RF00658                                            0658
*     DO;                           /*                               */
*       SIZE=CCA4BFMX*LRECL*2;      /* SET MAX BUFFER SIZE           */
         LH    SIZE,CCA4BFMX(,CCAPTR)                              0660
         MH    SIZE,@CH00863                                       0660
*       GMADDR=ADDR(CCA4BFIA);      /* RTN ADDR                      */
         LA    GMADDR,CCA4BFIA(,CCAPTR)                            0661
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0662
*       REFS(SIZE,CCA4BFIA);        /* GET BUFFERS                   */
         GETMAIN EC,LV=(SIZE),A=(GMADDR)
*       RFY                                                        0663
*         RTNCODE RSTD;             /*                               */
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */
         LTR   RTNCODE,RTNCODE                                     0664
         BZ    @RF00664                                            0664
*         DO;                                                      0665
*           M202I=ON;               /* SET SW TO ISSUE MSG           */
         OI    M202I,B'10000000'                                   0666
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE               */
         MVI   GETRTNCD,X'10'                                      0667
*         END;                      /* END GETMAIN FAILED            */
*       ELSE                        /*                               */
*         DO;                       /*                               */
         B     @RC00664                                            0669
@RF00664 DS    0H                                                  0670
*           CCA4BFOA=CCA4BFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */
         LR    @00,SIZE                                            0670
         SRDA  @00,32                                              0670
         D     @00,@CF00186                                        0670
         AL    @01,CCA4BFIA(,CCAPTR)                               0670
         ST    @01,CCA4BFOA(,CCAPTR)                               0670
*           CCA4BFSZ=SIZE;          /* SAVE GETMAIN SIZE             */
         ST    SIZE,CCA4BFSZ(,CCAPTR)                              0671
*         END;                      /*                               */
*       RFY                                                        0673
*         RTNCODE UNRSTD;           /*                               */
@RC00664 DS    0H                                                  0674
*     END;                          /*                               */
*   RFY                                                            0675
*     SIZE UNRSTD;                                                 0675
@RF00658 DS    0H                                                  0676
*   RFY                                                            0676
*     GMADDR UNRSTD;                /*                               */
*                                                                  0676
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN WITH CODE SET UP DURING PROCESSING                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0677
*   RETURN CODE(GETRTNCD);          /*                               */
         SLR   @15,@15                                             0677
         IC    @15,GETRTNCD                                        0677
         L     @14,@SA00003                                        0677
         LM    @00,@12,@SA00003+8                                  0677
         BR    @14                                                 0677
*   END DSUGETMN;                   /*                               */
         EJECT
*                                                                  0679
*   /*****************************************************************/
*   /*                                                               */
*   /* THE REST OF THE HMASMDSU MODULE CONSISTS OF DSCAN ROUTS. THESE*/
*   /* ROUTS WILL BE CALLED FROM HMASMSCN WHENEVER THE KEY IS FOUND  */
*   /* AND THE ROUT IS SPECIFIED. REGISTER ONE WILL BE RESTRICTED    */
*   /* SINCE HMASMSCN DEPENDS UPON REGISTER ONE NOT BEING CHANGED. IT*/
*   /* KEEPS THE ADDRESS OF ITS SAVE AREA IN AN AREA IN THE HMASMSCP */
*   /* AND REGISTER ONE POINTS TO THE HMASMSCP               @Z40SP00*/
*   /* THE RETURN REG(REG14) IS ALSO RESTRICTED SO THAT SAVE AREAS   */
*   /* WILL NOT BE NEEDED FOR EACH PROC                      @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0679
*   RFY                                                            0679
*     R1 RSTD;                      /*                       @Z40SP00*/
*   RFY                                                            0680
*     RTNREG RSTD;                  /*                       @Z40SP00*/
*                                                                  0681
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUT ENTERED WHEN DATE KEYWORD FOUND ON PARM          @Z40SP00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0681
*RDATE:                             /*                       @Z40SP00*/
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40SP00*/
RDATE    DS    0H                                                  0682
*   IF PRMDATE=ON                   /* DATE ENTERED ALREADY? @Z40SP00*/
*     THEN                          /* YES                   @Z40SP00*/
         TM    PRMDATE,B'10000000'                                 0682
         BNO   @RF00682                                            0682
*     SCPRET=SCPSTOP;               /* SYNTAX ERR            @Z40SP00*/
         MVI   SCPRET,X'08'                                        0683
*   ELSE                            /* NOT ENTERED ALREADY   @Z40SP00*/
*     DO;                           /*                       @Z40SP00*/
         B     @RC00682                                            0684
@RF00682 DS    0H                                                  0685
*       PRMDATE=ON;                 /*                       @Z40SP00*/
         OI    PRMDATE,B'10000000'                                 0685
*       SCPRET=SCPGOOD;             /*                       @Z40SP00*/
         MVI   SCPRET,X'00'                                        0686
*     END;                          /*                       @Z40SP00*/
*   END RDATE;                      /*                       @Z40SP00*/
*                                                                  0688
@EL00004 DS    0H                                                  0688
@EF00004 DS    0H                                                  0688
@ER00004 BR    @14                                                 0688
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUT ENTERED WHEN FMID KEYWORD FOUND ON PARM                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0689
*RFMID:                             /*                               */
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                               */
RFMID    DS    0H                                                  0690
*   IF PRMFMID=ON                   /* FMID ENTERED ALREADY?         */
*     THEN                          /* YES                           */
         TM    PRMFMID,B'01000000'                                 0690
         BNO   @RF00690                                            0690
*     SCPRET=SCPSTOP;               /* SYNTAX ERR                    */
         MVI   SCPRET,X'08'                                        0691
*   ELSE                            /* NOT ENTERED ALREADY           */
*     DO;                           /*                               */
         B     @RC00690                                            0692
@RF00690 DS    0H                                                  0693
*       PRMFMID=ON;                 /*                               */
         OI    PRMFMID,B'01000000'                                 0693
*       SCPRET=SCPGOOD;             /*                               */
         MVI   SCPRET,X'00'                                        0694
*     END;                          /*                               */
*   END RFMID;                      /*                               */
@EL00005 DS    0H                                                  0696
@EF00005 DS    0H                                                  0696
@ER00005 BR    @14                                                 0696
*                                                                  0697
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE CHECKS AND SAVES THE DATE ENTERED        @OS64458*/
*   /* ON THE EXEC STATEMENT PARAMETER LIST                  @OS64458*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0697
*RDATEV:                                                           0697
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @OS64458*/
RDATEV   DS    0H                                                  0698
*   SCPRET=SCPGOOD;                 /* SET SCAN RETURN CODE FOR GOOD
*                                      RETURN                @OS64458*/
         MVI   SCPRET,X'00'                                        0698
*   IF SCPSTRNG(1:3)^=IPL           /* SIPL DATE USE               0699
*                                      REQUESTED@OS64458             */
*       &SCPSTRNG(1)^=USEIT         /* OR U TYPE ENTRY       @OS64458*/
*     THEN                          /* NO                    @OS64458*/
         L     @15,SCPCHAR                                         0699
         CLC   SCPSTRNG(3,@15),@CC01346                            0699
         BE    @RF00699                                            0699
         CLI   SCPSTRNG(@15),C'U'                                  0699
         BE    @RF00699                                            0699
*     IF SCPSTRNG(1:5)^=REPLY       /* REPLY REQUEST FROM OP @OS64458*/
*       THEN                        /* NO - THEN DATE MUST HAVE BEEN
*                                      ENTERED               @OS64458*/
         CLC   SCPSTRNG(5,@15),@CC01348                            0700
         BE    @RF00700                                            0700
*       DO;                         /* CHECK FOR ALL NUMERICS      0701
*                                                            @OS64458*/
*         DATEOP=SCPSTRNG(1:SCPPMLN);/* SAVE DATE ENTERED    @OS64458*/
         MVI   DATEOP+1,C' '                                       0702
         MVC   DATEOP+2(3),DATEOP+1                                0702
         LH    @10,SCPPMLN                                         0702
         BCTR  @10,0                                               0702
         EX    @10,@SM01456                                        0702
*         IF(DATEOP&CHAR0)^=CHAR0   /* DATA NUMERIC?         @OS64458*/
*           THEN                    /* NO - ERR              @OS64458*/
         MVC   @TS00001(5),DATEOP                                  0703
         NC    @TS00001(5),@CC01355                                0703
         CLC   @TS00001(5),@CC01355                                0703
         BE    @RF00703                                            0703
*           SCPRET=SCPSTOP;         /* RETURN ERR CODE       @OS64458*/
         MVI   SCPRET,X'08'                                        0704
*       END;                        /* END DATE ENTERED GROUP      0705
*                                                            @OS64458*/
*     ELSE                                                         0706
*       ;                           /* REPLY FROM OP REQUESTED, LEAVE
*                                      DATEOP AS IS          @OS64458
*                                      WILL CAUSE REPLY MSG TO BE  0706
*                                      GENREATED             @OS64458*/
@RF00700 DS    0H                                                  0707
*   ELSE                                                           0707
*     DATEOP(1)=USEIT;              /* MOVE 'U' INTO REPLY AREA    0707
*                                                            @OS64458
*                                      CAUSING IPL DATE TO BE USED 0707
*                                                            @OS64458*/
         B     @RC00699                                            0707
@RF00699 MVI   DATEOP,C'U'                                         0707
*   END RDATEV;                     /* END CHECK AND SAVE PARM DATE
*                                      ROUTINE               @OS64458*/
@EL00006 DS    0H                                                  0708
@EF00006 DS    0H                                                  0708
@ER00006 BR    @14                                                 0708
*                                                                  0709
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE SAVES THE FMID VALUE FROM THE EXEC STATEMENT IN  */
*   /* THE CCA                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0709
*RFMIDV:                                                           0709
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                          */
RFMIDV   DS    0H                                                  0710
*   CCAFMID=SCPSTRNG(1:SCPPMLN);    /*                               */
         MVI   CCAFMID+1(CCAPTR),C' '                              0710
         MVC   CCAFMID+2(5,CCAPTR),CCAFMID+1(CCAPTR)               0710
         LH    @15,SCPPMLN                                         0710
         BCTR  @15,0                                               0710
         L     @10,SCPCHAR                                         0710
         EX    @15,@SM01458                                        0710
*   RETURN;                         /*                               */
@EL00007 DS    0H                                                  0711
@EF00007 DS    0H                                                  0711
@ER00007 BR    @14                                                 0711
*   END RFMIDV;                     /*                               */
*   END HMASMDSU                                                   0713
*                                                                  0713
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  0713
*       ;                                                          0713
@DATA    DS    0H
@CH00089 DC    H'1'
@CH00238 DC    H'3'
@CH00042 DC    H'4'
@CH00358 DC    H'20'
@CH00467 DC    H'26'
@CH00524 DC    H'84'
@CH00863 DC    H'160'
@CH01338 DC    H'200'
@CH01340 DC    H'225'
@SM01450 MVC   EXECDATA(0),DSUPDATA(@10)
@SM01456 MVC   DATEOP(0),SCPSTRNG(@15)
@SM01458 MVC   CCAFMID(0,CCAPTR),SCPSTRNG(@10)
         DS    0F
@AL00231 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00239 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00254 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00272 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00286 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00423 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
@AL00259 DC    A(HMASMSCP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    15F
@SA00003 DS    15F
@AL00001 DS    2A
         DS    0F
@CF00186 DC    F'2'
@CF00132 DC    F'5'
@CF00516 DC    F'80'
@CV01325 DC    V(HMASMDC2)
@CV01326 DC    V(HMASMDS1)
@CV01327 DC    V(HMASMIO)
@CV01328 DC    V(HMASMMSG)
@CV01329 DC    V(HMASMSCN)
         DS    0D
SAVBUFAD DS    A
SAVIOPTR DS    A
ADPRMSCN DC    AL4(KDATE)
PMLEN    DS    F
ERRCOL   DS    H
DSURTNCD DS    FL1
OPNRTNCD DS    FL1
GETRTNCD DS    FL1
@TS00001 DS    CL5
@CC01348 DC    C'REPLY'
@CC01355 DC    C'00000'
@CC01353 DC    C'CCA '
@CC01346 DC    C'IPL'
@CC01406 DC    C'Y'
@CC01407 DC    C'N'
         DS    CL3
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00171 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00172 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
HMASMSCP DS    CL26
         ORG   HMASMSCP
SCPCHAR  DS    AL4
SCPSRCH  DS    AL4
SCPWKAR  DS    AL4
SCPIORTN DS    AL4
SCPIOPAD DS    AL4
SCPINLN  DS    FL2
SCPPMLN  DS    FL2
SCPEOR   DS    BL1
         ORG   SCPEOR
SCPCONT  DS    BL1
SCPNOCT  EQU   SCPEOR+0
SCPCOMNT EQU   SCPEOR+0
SCPRTERR EQU   SCPEOR+0
SCPNOSUC EQU   SCPEOR+0
SCPNORT  EQU   SCPEOR+0
@NM00173 EQU   SCPEOR+0
         ORG   HMASMSCP+25
SCPRETRN DS    FL1
         ORG   SCPRETRN
SCPRET   DS    FL1
         ORG   HMASMSCP+26
DSUFLG1  DS    BL1
         ORG   DSUFLG1
M202I    DS    BL1
@NM00177 EQU   DSUFLG1+0
         ORG   DSUFLG1+1
DATEOP   DC    CL5'U    '
TIMETEMP DS    CL4
DEVDDNAM DS    CL8
DEVADDR  DS    CL8
PATCHDSU DS    CL80
         ORG   PATCHDSU
@NM00178 DC    80X'FF'
         ORG   PATCHDSU+80
PRMFLGS  DS    BL1
         ORG   PRMFLGS
PRMDATE  DS    BL1
PRMFMID  EQU   PRMFLGS+0
@NM00179 EQU   PRMFLGS+0
         ORG   PRMFLGS+1
EXECPARM DS    CL102
         ORG   EXECPARM
QUOTE1   DS    CL1
EXECDATA DS    CL100
QUOTE2   DS    CL1
         ORG   EXECPARM+102
         DS    CL5
DBLWRD   DS    CL8
CHARCOL  DS    CL2
         ORG   CHARCOL
@NM00180 DS    CL1
LASTDIG  DS    CL1
         ORG   CHARCOL+2
HMASMDSU CSECT
KDATE    DSCAN KEY='DATE',ALT=KFMID,SUCC=KDATEEQ,ROUT=RDATE
KDATEEQ  DSCAN KEY='=',SUCC=KDATEV
KDATEV   DSCAN MAXLEN=5,SUCC=KCOMMA1,ROUT=RDATEV
KFMID    DSCAN KEY='FMID',SUCC=KFMIDEQ,ROUT=RFMID
KFMIDEQ  DSCAN KEY='=',SUCC=KFMIDV
KFMIDV   DSCAN MINLEN=7,MAXLEN=7,SUCC=KCOMMA1,ROUT=RFMIDV
KCOMMA1  DSCAN KEY=',',IO=NO,SUCC=KDATE
HMASMDSU CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
IOPPTR   EQU   @07
RTNREG   EQU   @14
RTNCODE  EQU   @15
R0       EQU   @00
R1       EQU   @01
SIZE     EQU   @02
GMADDR   EQU   @03
HMASMCCA EQU   0
CCAID    EQU   HMASMCCA
CCAFBUFR EQU   HMASMCCA+4
CCACBFIA EQU   CCAFBUFR
CCACBFOA EQU   CCAFBUFR+4
CCAVBFIA EQU   CCAFBUFR+8
CCAVBFOA EQU   CCAFBUFR+12
CCAPBFIA EQU   CCAFBUFR+16
CCAPBFOA EQU   CCAFBUFR+20
CCAQBFIA EQU   CCAFBUFR+24
CCAQBFOA EQU   CCAFBUFR+28
CCAWBFIA EQU   CCAFBUFR+32
CCAWBFOA EQU   CCAFBUFR+36
CCA4BFIA EQU   CCAFBUFR+44
CCA4BFOA EQU   CCAFBUFR+48
CCACBFSZ EQU   CCAFBUFR+56
CCAVBFSZ EQU   CCAFBUFR+60
CCAPBFSZ EQU   CCAFBUFR+64
CCAQBFSZ EQU   CCAFBUFR+68
CCAWBFSZ EQU   CCAFBUFR+72
CCA4BFSZ EQU   CCAFBUFR+80
CCACBFMX EQU   CCAFBUFR+92
CCAABFMX EQU   CCAFBUFR+94
CCAVBFMX EQU   CCAFBUFR+96
CCAPBFMX EQU   CCAFBUFR+98
CCAMBFMX EQU   CCAFBUFR+100
CCASBFMX EQU   CCAFBUFR+102
CCAQBFMX EQU   CCAFBUFR+104
CCAXBFMX EQU   CCAFBUFR+106
CCA1BFMX EQU   CCAFBUFR+108
CCA2BFMX EQU   CCAFBUFR+110
CCA3BFMX EQU   CCAFBUFR+112
CCA4BFMX EQU   CCAFBUFR+114
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCACDSP  EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCAACRQP EQU   CCAFLAG7
CCAWK1P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCALISTP EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCALOGP  EQU   CCAFLAG7+2
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCAIOPCS EQU   CCAFSYS
CCAIOPAS EQU   CCAFSYS+4
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCACSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00009 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCADATE  EQU   CCAFCTL+1
CCATIME  EQU   CCAFCTL+4
CCARPTDS EQU   CCAFCTL+7
CCALSTDS EQU   CCAFCTL+8
CCAFMID  EQU   HMASMCCA+291
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCALOGNG EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCADSIDA EQU   0
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDRC EQU   @NM00027+20
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00039+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
@NM00043 EQU   HMASMIOP+12
@NM00044 EQU   @NM00043
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00154 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
SCPSTRNG EQU   0
HMASMGTP EQU   0
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
SCPIOPRM EQU   0
DSUPARM  EQU   0
DSUPLEN  EQU   DSUPARM
DSUPEND  EQU   DSUPARM+2
DSUPDATA EQU   DSUPEND
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00050 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00061 EQU   IOPUDATA
IOPBLKSI EQU   @NM00061
@NM00062 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00071 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00082 EQU   IOPSRCDR+1
@NM00084 EQU   @NM00082+7
@NM00088 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00092 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00098 EQU   IOPMODDR+1
@NM00100 EQU   @NM00098+7
@NM00104 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00108 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00119 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00126 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00135 EQU   IOPPTFFX
@NM00136 EQU   @NM00135
IOPPDTES EQU   IOPPTFFX+41
@NM00139 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00164 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00164
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00168 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00168
IOPBFTB1 EQU   IOPBFTB0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00170 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00169 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00167 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00166 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00165 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00163 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00162 EQU   IOPPTSFX+35
@NM00161 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00160 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00159 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00158 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00157 EQU   IOPQFMDR
@NM00153 EQU   IOPQSMDR
@NM00152 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00151 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00150 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00149 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00148 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00147 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00146 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00145 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00144 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00143 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00142 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00141 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00140 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00139+3
IOPRECD  EQU   @NM00139
@NM00138 EQU   IOPPTFFX+8
@NM00137 EQU   @NM00135+7
IOPPRELN EQU   @NM00136
@NM00134 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00133 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00132 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00131 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00130 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00129 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00128 EQU   @NM00126+7
@NM00127 EQU   @NM00126
@NM00125 EQU   IOPSYSDR+5
@NM00124 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00123 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00122 EQU   IOPDLBFX+8
@NM00121 EQU   @NM00119+7
@NM00120 EQU   @NM00119
@NM00118 EQU   IOPDLBDR+1
@NM00117 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00116 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00115 EQU   IOPMODFX+12
@NM00114 EQU   IOPMODF4
@NM00113 EQU   IOPMODF3
@NM00112 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00111 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00110 EQU   @NM00108+7
@NM00109 EQU   @NM00108
@NM00107 EQU   IOPMODDR+17
@NM00106 EQU   @NM00104+7
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00100
@NM00102 EQU   @NM00100
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00098
@NM00097 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00096 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00095 EQU   IOPSRCFX+8
@NM00094 EQU   @NM00092+7
@NM00093 EQU   @NM00092
@NM00091 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00090 EQU   @NM00088+7
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00084
@NM00086 EQU   @NM00084
@NM00085 EQU   @NM00084
@NM00083 EQU   @NM00082
@NM00081 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00080 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00079 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00078 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00077 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00076 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00075 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00073 EQU   @NM00071+7
@NM00072 EQU   @NM00071
@NM00070 EQU   IOPLMDDR+6
@NM00069 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00068 EQU   IOPLMDF4
@NM00067 EQU   IOPLMDF3
@NM00066 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00065 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00064 EQU   IOPLMDDR
@NM00063 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00062+4
IOPUSED  EQU   @NM00062
IOPTPSEQ EQU   @NM00061+8
IOPVLSER EQU   @NM00061+2
IOPCQMAX EQU   IOPCQMAP+12
@NM00060 EQU   IOPCQMAP+11
@NM00059 EQU   IOPCQMAP+8
@NM00058 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00057 EQU   IOPSCMAP+11
@NM00056 EQU   IOPSCMAP+8
@NM00055 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00054 EQU   IOPNTMAX+11
@NM00053 EQU   IOPNTMAX+8
@NM00052 EQU   IOPNTMAX
@NM00051 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00050+5
IOPIPTF3 EQU   @NM00050
@NM00176 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00175 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPBUFAD EQU   HMASMGTP+12
GTPWKAD  EQU   HMASMGTP+8
GTPKEYLN EQU   HMASMGTP+6
GTPRCDLN EQU   HMASMGTP+4
@NM00174 EQU   HMASMGTP+2
GTPRETRN EQU   HMASMGTP+1
GTPFUNCT EQU   HMASMGTP
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00156 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00155 EQU   @NM00154+7
IOPQSMFM EQU   @NM00154
@NM00074 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00049 EQU   IOPUSERL
@NM00048 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00047 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00046 EQU   @NM00043+10
IOPSEQNO EQU   @NM00043+8
@NM00045 EQU   @NM00044+7
IOPPTFNM EQU   @NM00044
IOPNAM17 EQU   IOPNAME
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
CCAUPDPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00039+12
CCAUPDTE EQU   @NM00039+8
CCAUPDNM EQU   @NM00039
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
CCACPYPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00031+12
CCACOPY  EQU   @NM00031+8
CCACPYNM EQU   @NM00031
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
CCALKDPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00027+12
CCALKED  EQU   @NM00027+8
CCALKDNM EQU   @NM00027
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00023 EQU   CCAFLAGB
@NM00022 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00016 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
CCATBLPA EQU   @NM00009+12
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAPESIZ EQU   CCAFIOP+4
@NM00007 EQU   CCAFLAG7+3
CCASLBP  EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
CCATBFSZ EQU   CCAFBUFR+76
@NM00001 EQU   CCAFBUFR+52
CCATBFIA EQU   CCAFBUFR+40
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00682 EQU   @EL00004
@RC00690 EQU   @EL00005
@RC00699 EQU   @EL00006
@RC00700 EQU   @RC00699
@RF00703 EQU   @RC00700
@ENDDATA EQU   *
         END   HMASMDSU,(C'PLS2013',0802,78334)

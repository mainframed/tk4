++USERMOD(ZP60007)           /* ADD CONFTXT SUPPORT TO TSO */  .
++VER(Z038) FMID(ETV0108) PRE(UZ28155,UZ28257,UZ33846)
 /*
   PROBLEM DESCRIPTION:
     TSO/VTAM 3270 DATA STREAMS CANNOT BE TRACED BY GTF.
       WHEN ATTEMPTING TO DIAGNOSE PROBLEMS WITH TSO APPLICATIONS
       IT IS A USEFUL TECHNIQUE TO TRACE THE VTAM DATA TRAFFIC
       TO AND FROM THE TSO TERMINAL.  HOWEVER, TSO/VTAM SPECIFIES
       PROC=CONFTXT IN THE VTAM NIB WHICH INSTRUCTS VTAM TO TREAT
       TERMINAL TRAFFIC AS CONFIDENTIAL TEXT WHICH SHOULD NOT BE
       REPORTED BY A TRACE.  IBM HAS ADDED THE CONFTXT PARMLIB
       PARAMETER TO LATER VERSIONS OF VTAM SO THAT AN INSTALLATION
       CAN CONTROL THIS SETTING, BUT THIS FEATURE IS NOT SUPPORTED
       BY THE FREELY AVAILABLE VERSION OF TSO/VTAM.

       THIS USERMOD ADDS SUPPORT TO CORRECTLY PROCESS THE CONFTXT
       PARAMETER IN THE PARMLIB FILE OF THE TSO STARTED TASK,
       WHICH IS USUALLY A TSOKEY__ MEMBER OF SYS1.PARMLIB.
       FURTHER, TSO APPLICATION NIB INITIALISATION WILL ALTER THE
       NIB CONTENTS ACCORDING TO THE PARAMETER SETTING.  THE
       TCAST CONTROL BLOCK DSECT MACRO IS UPDATED TO REFLECT WHERE
       THIS SETTING IS STORED.

   SPECIAL CONDITIONS:
     ACTION:
       A "CLPA" MUST BE PERFORMED AT IPL TIME FOR THIS SYSMOD TO
       BECOME ACTIVE.
     DOC:
       CONFTXT=YES OR CONFTXT=NO CAN NOW BE SPECIFIED IN THE
       TSOKEY__ MEMBER OF SYS1.PARMLIB.  CONFTXT=YES IS THE DEFAULT.
       CONFTXT=YES WILL PREVENT THE TRACING OF TERMINAL DATA STREAMS.
       CONFTXT=NO WILL ALLOW THE TRACING OF TERMINAL DATA STREAMS.

   COMMENTS:
     PRYCROFT SIX P/L PUBLIC DOMAIN USERMOD FOR MVS 3.8 NUMBER 7.

     THE FOLLOWING MODULES AND/OR MACROS ARE AFFECTED BY THIS USERMOD:
     MODULES:
       IKTCAS54
       IKTXINIT
     MACROS:
       IKTTCAST
 */.
++MOD(IKTCAS54) DISTLIB(AOST3).
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
RLD      
END 
  IDENTIFY IKTCAS54('ZP60007')
++ZAP(IKTXINIT) DISTLIB(AOST4).
 NAME IKTXINIT
 IDRDATA ZP60007
VER 001A 05C0                BALR  @12,0
VER 058E D23F,9000,CB54      MVC   ISTNIB(64,@09),DUMNIB
VER 0594 D207,900C,1068      MVC   NIBSYM(8,@09),TSBTRMID(@01)
VER 059A 58A0,A03C           L     @10,ASCBTSB(,@10)
VER 059E 50A0,9008           ST    @10,NIBUSER(,@09)
VER 05A2 9504,F048           CLI   TSBXTMTP(@15),4
VER 09FC 0000,0000  PATAREA  ***   PATCH AREA   ***
VER 0A00 0000,0000           ***   PATCH AREA   ***
VER 0A04 0000,0000           ***   PATCH AREA   ***
VER 0A08 0000,0000           ***   PATCH AREA   ***
VER 0A0C 0000,0000           ***   PATCH AREA   ***
VER 0A10 0000,0000           ***   PATCH AREA   ***
VER 0A14 0000,0000           ***   PATCH AREA   ***
VER 0B70 D000       DUMNIB   NIB
VER 0B94 0201                (CHECK CONFTXT IS ON)
REP 059E 47F0,C9E0           B     PATAREA
REP 09FC 50A0,9008           ST    @10,NIBUSER(,@09)
REP 0A00 58A0,0010           L     @10,CVTPTR
REP 0A04 58A0,A3F4           L     @10,CVTTCASP
REP 0A08 9101,A058           TM    TCASFLG1,TCASCONF
REP 0A0C 4710,C586           BO    **BACK-TO-INLINE-CODE**
REP 0A10 94FE,9025           NI    PROPROC2,255-PROCFTX
REP 0A14 47F0,C586           B     **BACK-TO-INLINE-CODE**
++MACUPD(IKTTCAST) DISTLIB(ATSOMAC).
./ CHANGE NAME=IKTTCAST
TCASCONF EQU   X'01'              RESTRICTED BUFFERS           ZP60007

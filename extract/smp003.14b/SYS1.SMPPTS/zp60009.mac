++USERMOD(ZP60009)          /* ADD TPUT/TPG NOEDIT SUPPORT */  .
++VER(Z038) FMID(ETV0108)
  PRE(UZ35180,UZ26905,UZ67122,UZ22286,UZ55134,UZ28255,
      UZ71054,UZ54020,UZ68882,UZ57385,UZ28016)
 /*
   PROBLEM DESCRIPTION:
     THE NOEDIT OPERAND OF TPUT AND TPG IS NOT HONOURED BY TSO/VTAM.
       THE TIOC COMMON SVC 93 ROUTINE IGC0009C CORRECTLY DETECTS THE
       REQUEST OF NOEDIT FOR TPUT AND TPG REQUESTS, BUT THIS IS NOT
       HANDLED PROPERLY BY TSO/VTAM.
     THE GTTERM MACRO FUNCTION IS NOT SUPPORTED BY TSO/VTAM.
       WHEN A TSO APPLICATION ISSUES THE GTTERM MACRO RC=4 RESULTS.
       AN APPLICATION CANNOT DETERMINE IF THE READ PARTITION (QUERY)
       FUNCTION IS SUPPORTED.  ALSO, THE ALTERNATE SCREEN SIZE CANNOT
       BE DETERMINED.
     3270 HOUSEKEEPING IS LIMITED TO MODEL-1 AND MODEL-2 SCREEN SIZES.
       TSO WILL ONLY PERFORM LINE MODE 3270 SCREEN HOUSEKEEPING FOR
       MODEL-1 (12 BY 40) AND MODEL-2 (24 BY 80) SCREEN SIZES.  THE
       ALTERNATE SCREEN SIZE OF A TERMINAL CANNOT BE PROPERLY EXPLOITED
       BY TSO LINE MODE, NOR BY TSO FULLSCREEN APPLICATIONS.
     THE NOEDIT OPERAND OF STFSMODE IS NOT SUPPORTED BY TSO/VTAM.
       NOEDIT INPUT MODE IS SET BY SPECIFYING NOEDIT=YES ON A
       'STFSMODE ON' MACRO.  THIS IS NOT SUPPORTED BY TSO.  WITHOUT
       THIS ABILITY ANY X'1E' IN INPUT DATA (INCLUDING A QUERY
       RESPONSE, OR AN SBA ORDER FROM A SCREEN WITH MORE THAN 4096
       LOCATIONS) WILL BE INTERPRETED AS A FIELD MARK CHARACTER AND
       CAUSE THE DATA FOLLOWING IT TO BE HELD OVER UNTIL THE NEXT TGET
       MACRO IS ISSUED.

       THIS USERMOD CHANGES SEVERAL TSO/VTAM MODULES.

       THE TSO/VTAM SVC 93 ROUTER IS CHANGED TO NOT REJECT REQUESTS
       WITH NOEDIT SPECIFIED.

       THE TSO/VTAM TPUT HANDLER IS CHANGED TO NOT TRUNCATE TRAILING
       BLANKS FROM NOEDIT REQUESTS.  A PREVIOUSLY RESERVED BIT IS
       USED TO FLAG NOEDIT REQUESTS, WHICH ARE ALSO FLAGGED AS
       FULLSCREEN REQUESTS BY THE TPUT AND TPG MACROS (AND NOW ALSO
       BY THIS MODULE).

       THE TSO/VTAM TGET HANDLER IS CHANGED TO BACK OUT THE FIX FOR
       APAR OZ60978 SHIPPED IN PTF UZ57385 TO REGRESS FUNCTIONALITY
       TO THE UZ55134 LEVEL SO THAT TPUT MACROS ISSUED AFTER TGET
       MACROS WITH THE NOWAIT OPERAND ARE NOT QUEUED UNTIL THERE IS
       SOME INPUT, BUT SENT TO THE SCREEN ASYNCHRONOUSLY.  THIS HAS
       THE EFFECT OF REINTRODUCING THE PROBLEM WHERE A TGET NOWAIT
       DOES NOT FORCE THE KEYBOARD TO BECOME UNLOCKED, BUT THIS CAN
       BE CIRCUMVENTED BY THE APPLICATION SETTING THE X'02' BIT IN
       THE WCC WHEN APPROPRIATE.

       THE TSO/VTAM TGET HANDLER IS ALSO CHANGED TO ADD THE TGET MACRO
       RETURN CODES 24 AND 28 WHICH MAY BE GIVEN WHEN NOEDIT INPUT
       MODE IS IN EFFECT, THEREBY IMPROVING COMPATIBILITY WITH TSO/E.

       THE TSO/VTAM INITIALIZATION ROUTINE FOR THE TSO INPUT MANAGER
       AND TSO OUTPUT MANAGER HAS BEEN CHANGED TO NOT REGARD TERMINALS
       WITH BUFFER SIZES LARGER THAN 1920 BYTES AS MODEL-1 TERMINALS.
       THIS WILL HELP AVOID LINE MODE SCREEN HANDLING ERRORS AFTER
       LOGON RECONNECT PROCESSING.

       THE TSO/VTAM LOGON RECONNECT ROUTINE HAS BEEN CHANGED TO
       INCLUDE THE PRIMARY AND ALTERNATE SCREEN DIMENSIONS IN THE
       DATA PERTAINING TO THE NEW TERMINAL PROPAGATED TO CONTROL
       BLOCKS WHEN A LOGON RECONNECT IS PERFORMED, THUS ALLOWING TSO
       APPLICATIONS TO DETECT DYNAMIC CHANGES TO THE SCREEN SIZE.

       THE TSO/VTAM 3270 TERMINAL SCREEN MANAGER IS ALTERED TO SKIP
       ANY DATA TRANSLATION FOR NOEDIT TPUTS.  FURTHER, IN KEEPING
       WITH 3270 ARCHITECTURE DATA INTEGRITY FOR DISPLAYABLE CODE
       POINTS (WHERE ALL CODE POINTS IN THE RANGE X'40' TO X'FE'
       ARE CONSIDERED "DISPLAYABLE", AND REGARDLESS OF THE TERMINAL'S
       ABILITY TO DISPLAY THE CHARACTER, WHEN SUCH A CODE POINT IS
       WRITTEN TO THE TERMINAL, IT CAN BE READ BACK UNALTERED) ALL
       TPUTS TO 3270 EBCDIC TERMINALS WILL NO LONGER ALTER ANY DATA
       CODE POINTS IN THE X'40' TO X'FE' RANGE.  (THE X'40' CODE POINT
       IS RESERVED FOR A BLANK IN ALL SINGLE-BYTE CHARACTER SETS.)

       THE TSO/VTAM 3270 TERMINAL SCREEN MANAGER IS ALSO ALTERED TO
       SUPPORT DIFFERENT PRIMARY AND ALTERNATE SCREEN SIZES OF ANY
       SIZE SUBJECT TO THE 3270 ARCHITECTURE LIMITATIONS, AND ALSO
       THAT THE ALTERNATE SCREEN SIZE NEVER HAS FEWER COLUMNS NOR
       FEWER LINES THAN THE PRIMARY SCREEN SIZE.  TSO/VTAM LINE MODE
       HOUSEKEEPING WILL NOW USE 14-BIT ADDRESSING FOR ALL BUFFER
       LOCATIONS GREATER THAN 4095, BUT WILL STILL USE 12-BIT
       ADDRESSING FOR LOCATIONS FROM 0 TO 4095 INCLUSIVE.  THIS
       CHANGE HAS THE EFFECT OF INCREASING THE MAXIMUM TSO/VTAM 3270
       SCREEN SIZE SUPPORTED FROM 4096 LOCATIONS TO 16384 LOCATIONS.

       THE TSO/VTAM 3270 TERMINAL SCREEN MANAGER NOW HANDLES TPUT
       FULLSCR DIFFERENTLY TO THE EXTENT THAT A STANDARD WRITE (X'F1')
       WITH A NO-OP WCC (X'40') WILL NOT FORCE THE INCLUSION OF AN
       INSERT CURSOR ORDER AS THE TPUT MAY BE SENDING AN ASYNCHRONOUS
       PARTIAL SCREEN UPDATE WHICH DOES NOT OVERWRITE AN ACTIVE INPUT
       AREA WHERE SOME TEXT MAY BE BEING TYPED IN.

       THE TSO/VTAM 3270 INPUT DATA HANDLER HAS BEEN ALTERED TO NOT
       PROCESS FIELD MARK CHARACTERS INPUT WHEN NOEDIT MODE IS IN
       EFFECT.  FURTHER, THE ACTUAL NUMBER OF COLUMNS AND LINES ON
       THE SCREEN IS USED IN LINE COUNT CALCULATIONS.

       THE TSO/VTAM SVC 94 ROUTER IS ALTERED TO PASS CONTROL TO A NEW
       CSECT FOR TSO TERMINAL CONTROL FUNCTION 17 (GTTERM).  A TSO
       APPLICATION CAN NOW ISSUE A GTTERM MACRO TO DETERMINE IF THE
       QUERY BIT IS ON, AND CAN GET THE DIMENSIONS OF THE PRIMARY AND
       ALTERNATE SCREEN SIZES.  NOEDIT TPUT/TPG MACROS CAN BE USED
       TO ISSUE WRITE STRUCTURED FIELD COMMANDS TO GAIN ACCESS TO
       VARIOUS 3270 EXTENSIONS INCLUDING GRAPHICS.  QUERY SUPPORT IS
       NOT NEEDED FOR A READ BUFFER COMMAND WHICH CAN NOW ALSO BE
       ISSUED VIA A NOEDIT TPUT/TPG MACRO.  GTTERM RETURN CODES AND
       OUTPUT IS COMPATIBLE WITH TSO/E, EXCEPT THAT THE TERMID OUTPUT
       AREA IS CURRENTLY LIMITED TO 8 BYTES.

       THE TERMINAL CONTROL MACRO ROUTINE FOR THE STFSMODE MACRO HAS
       BEEN CHANGED TO SUPPORT THE NOEDIT OPERAND, AND RESHOW KEY CODES
       CAN NOW BE IN THE RANGE OF FROM 1 TO 24 INCLUSIVE (REPRESENTING
       THE VALID PFK NUMBERS).

       THE TERMINAL CONTROL MACRO ROUTINE FOR THE STLINENO MACRO HAS
       BEEN CHANGED TO SUPPORT THE SPECIFICATION OF ANY VALID LINE
       NUMBER THAT EXISTS ON THE SCREEN.  IT HAS ALSO BEEN CHANGED TO
       SUPPORT NOEDIT INPUT MODE.

       THE TERMINAL CONTROL MACRO ROUTINE FOR THE STSIZE MACRO HAS
       BEEN CHANGED TO INDICATE THAT ANY REQUESTED SCREEN SIZE WHICH
       MATCHES EITHER THE PRIMARY OR ALTERNATE SIZE OF THE SCREEN IS
       CONSIDERED A STANDARD SIZE, EVEN IF IT IS NOT THE SIZE OF A
       MODEL-1 OR MODEL-2 SCREEN.  THIS IS DONE WITH A RETURN CODE
       OF ZERO INSTEAD OF A RETURN CODE OF 12 WHICH INDICATES A
       NON-STANDARD SCREEN SIZE.  (THE FLAGGING OF NON-STANDARD
       SCREEN SIZES IS INTENDED TO WARN OF THE POSSIBILITY OF
       SCREEN CONTROL ERRORS.)

       THE MAPPING MACRO FOR THE TSO/VTAM WORK AREA IKTTVWA IS
       UPDATED TO ADD BIT TVWAALTS WHICH IS SET WHEN THE TSO/VTAM
       SCREEN MANAGER SETS THE SCREEN TO ITS ALTERNATE SIZE.
       (THE MAPPING OF THIS BIT IS INCOMPATIBLE WITH TSO/E.)

       THE STFSMODE TERMINAL CONTROL MACRO FOR TSO FULLSCREEN
       APPLICATIONS HAS BEEN UPDATED TO ADD THE NOEDIT OPERAND,
       WHICH CAN BE ASSIGNED THE VALUE OF YES OR NO.  NO IS THE
       DEFAULT.  NOEDIT=YES IS USED TO ALLOW BYTES WITH A VALUE OF
       X'1E' TO BE RETURNED TO AN APPLICATION AS INPUT DATA
       FROM THE TERMINAL WITHOUT EACH SUCH BYTE BEING PROCESSED AS
       A FIELD MARK.

   SPECIAL CONDITIONS:
     ACTION:
       A "CLPA" MUST BE PERFORMED AT IPL TIME FOR THIS SYSMOD TO
       BECOME ACTIVE.

   COMMENTS:
     PRYCROFT SIX P/L PUBLIC DOMAIN USERMOD FOR MVS 3.8 NUMBER 9.

     REWORK HISTORY:
       2003-03-05: KBD (UN)LOCK ASYNC MSGS DURING NOEDIT TPUTS.
       2003-03-30: DO NOT FORCE IC IF WRT WITH NO-OP WCC.
       2005-08-14: DO NOT FORCE LINE-WRAP AFTER COLUMN 80.
       2009-06-01: USE SCREEN SIZES AND QUERY BIT FROM SNA BIND.
       2009-11-07: CHANGE IKTIIOM AND ADD IKTLOGR ZAPS FOR RECONNECT.
       2012-04-28: IMPROVE THE INTEROPERABILITY OF TPUT NOEDIT (WITH
                   "UNLOCK KEYBOARD" SET IN THE WCC) AND TGET NOWAIT
                   TO MATCH THAT OF TPUT FULLSCR AND TGET NOWAIT.

     TSO/VTAM IS A VTAM APPLICATION.  THIS SYSMOD DOES NOT IMPLY
     THAT VTAM CAN CORRECTLY PROCESS THE DATA THAT CAN NOW BE
     GENERATED BY TSO APPLICATIONS, EVEN IF THE DATA CONSISTS OF
     A PERFECTLY VALID 3270 DATA STREAM.

     EVT0108 LOCAL NON-SNA SUPPORT IS PROVIDED BY USERMOD ZP60008.

     USERMOD ZP60032 UPGRADES THE GTTERM MACRO TO BE ABLE TO EXPLOIT
     NEW FUNCTION DELIVERED IN THIS SYSMOD.

     THE FOLLOWING MODULES AND/OR MACROS ARE AFFECTED BY THIS USERMOD:
     MODULES:
       IKT0009C
       IKTVTPUT
       IKTVTGET
       IKTIIOM
       IKTLOGR
       IKT3270O
       IKT0009D
       IKTXLOG
       IKT3270I
       IKT09412
       IKT09413
       IKT0940A
     MACROS:
       IKTTVWA
       STFSMODE
 */.
++ZAP(IKT0009C) DISTLIB(AOST3).
 NAME IKT0009C
 IDRDATA ZP60009
VER 00C6 4870,5060           LH    R7,XSAPRMTJ
VER 00CA 1277                LTR   R7,R7
VER 00CC 4780,C0C6           BZ
VER 00E4 4870,5060           LH    R7,XSAPRMTJ
VER 00E8 1277                LTR   R7,R7
VER 00EA 4780,C1AE           BZ
REP 00CC 47D0                BNP
REP 00EA 47D0                BNP
++ZAP(IKTVTPUT) DISTLIB(AOST3).
 NAME IKTVTPUT
 IDRDATA ZP60009
VER 0016 05C0                BALR  R12,0
VER 0258 5010,D050           ST    R1,OPFLAGS
VER 02DA 5010,D050           ST    R1,OPFLAGS
VER 043E 50E0,506C  DATAEDIT ST    R14,XSASAVEA
VER 0442 9103,5064           TM    XSAOPTNS,XSAEDITO
VER 0446 4770,C472           BNZ   @RT00307
VER 044A 9640,5068  NEXTINST OI    XSAFLAG,XSADMOVE
VER 0508 0000,0000  *        PATCH AREA
VER 050C 0000,0000  *        PATCH AREA
VER 0510 0000,0000  *        PATCH AREA
VER 0514 0000,0000  *        PATCH AREA
VER 0518 0000,0000  *        PATCH AREA
VER 051C 0000,0000  *        PATCH AREA
VER 0520 0000       *        PATCH AREA
VER 0522 0000,0000  *        PATCH AREA
VER 0526 0000       *        PATCH AREA
REP 0258 45E0,C500           BAL   R14,PATCH2
REP 02DA 45E0,C500           BAL   R14,PATCH2
REP 0446 47F0,C4F0           B     PATCH1
REP 0508 4770,C472  PATCH1   BNZ   @RT00307
REP 050C 9180,5060           TM    XSAPRMTJ,XSANOED
REP 0510 4710,C472           BO    @RT00307
REP 0514 47F0,C432           B     NEXTINST
REP 0518 5010,D050  PATCH2   ST    R1,OPFLAGS
REP 051C 9180,5060           TM    XSAPRMTJ,XSANOED
REP 0520 07EE                BNOR  R14
REP 0522 9634,D051           OI    OPOPTNS,OPEDIT+OPNOED
REP 0526 07FE                BR    R14
++ZAP(IKTVTGET) DISTLIB(AOST3).
 NAME IKTVTGET
 IDRDATA ZP60009
VER 0016 05C0       @PROLOG  BALR  R12,0
VER 009A 9604,8090           OI    TVWAFLG1,TVWAULK
VER 0310 9200,5088           MVI   XSARC,0
VER 037A 920C,5088           MVI   XSARC,TOOSMALL
VER 08AC 0000,0000           DC    F'0'
VER 08B0 0000,0000           DC    F'0'
VER 08B4 0000,0000           DC    F'0'
VER 08B8 0000,0000           DC    F'0'
VER 08BC 0000,0000           DC    F'0'
VER 08C0 0000,0000           DC    F'0'
VER 08C4 0000,0000           DC    F'0'
VER 08C8 0000,0000           DC    F'0'
VER 08CC 0000,0000           DC    F'0'
VER 08D0 0000,0000           DC    F'0'
VER 08D4 0000,0000           DC    F'0'
VER 08D8 0000,0000           DC    F'0'
VER 08DC 0000,0000           DC    F'0'
VER 08E0 0000,0000           DC    F'0'
REP 009A 47F0,C894           B     PATCH1
REP 0310 47F0,C8A4           B     PATCH2
REP 037A 47F0,C8B8           B     PATCH3
REP 08AC 9110,5064  PATCH1   TM    100(R5),X'10'     NOWAIT? (EX GPR1)
REP 08B0 4770,C086           BNZ   PATCH1OK          YES
REP 08B4 9604,8090           OI    TVWAFLG1,TVWAULK  NO, REQUEST UNLOCK
REP 08B8 47F0,C086           B     PATCH1OK
REP 08BC 9200,5088  PATCH2   MVI   XSARC,0
REP 08C0 9104,9019           TM    TSBFLG5,TSBNEDIT
REP 08C4 47E0,C2FC           BNO   PATCH2OK
REP 08C8 9218,5088           MVI   XSARC,24          RC=00 => RC=18
REP 08CC 47F0,C2FC           B     PATCH2OK
REP 08D0 920C,5088  PATCH3   MVI   XSARC,TOOSMALL
REP 08D4 9104,9019           TM    TSBFLG5,TSBNEDIT
REP 08D8 47E0,C366           BNO   PATCH3OK
REP 08DC 921C,5088           MVI   XSARC,28          RC=0C => RC=1C
REP 08E0 47F0,C366           B     PATCH3OK
++ZAP(IKTIIOM) DISTLIB(AOST4).
 NAME IKTIIOM
 IDRDATA ZP60009
VER 03C4 D501,804A,64D4      CLC   TSBXTMBF,=H'1920'
VER 03CA 4770,63BE           BNE   MODEL1
VER 03CE 9250,C008           MVI   TSBLNSZ,80
VER 03D2 9218,C028           MVI   TSBLNNO,24
VER 03D6 47F0,63EA           B     SIZESET
REP 03CA 4740,63BE           BL    MODEL1
++ZAP(IKTLOGR) DISTLIB(AOST4).
 NAME IKTLOGR
 IDRDATA ZP60009
VER 0150 D207,B068,A068      MVC   TSBTRMID(8,TSBBASE),TSBTRMID(@10)
REP 0150 D20B,B064,A064      MVC   TSBPRMR(12,TSBBASE),TSBPRMR(@10)
++MOD(IKT3270O) DISTLIB(AOST3).
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
END 
  IDENTIFY IKT3270O('ZP60009')
++MOD(IKT0009D) DISTLIB(AOST3).
ESD      
ESD      
ESD      
ESD      
ESD      
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
RLD      
RLD      
END 
  IDENTIFY IKT0009D('ZP60009')
  IDENTIFY IKT09411('ZP60009')
++MOD(IKTXLOG) DISTLIB(AOST4).
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
END 
  IDENTIFY IKTXLOG('ZP60009')
++MOD(IKT3270I) DISTLIB(AOST3).
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
END 
  IDENTIFY IKT3270I('ZP60009')
++MOD(IKT09412) DISTLIB(AOST3).
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END 
  IDENTIFY IKT09412('ZP60009')
++MOD(IKT09413) DISTLIB(AOST3).
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END 
  IDENTIFY IKT09413('ZP60009')
++MOD(IKT0940A) DISTLIB(AOST3).
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
END 
  IDENTIFY IKT0940A('ZP60009')
++MACUPD(IKTTVWA) DISTLIB(ATSOMAC).
./ CHANGE NAME=IKTTVWA
*/*            ZP60009 - ADDING BIT TVWAALTS.                        */
TVWAALTS EQU   X'01'             ALTERNATE SCREEN SIZE IN USE   ZP60009
*     3 TVWAALTS     BIT(1),     /*ALT SCREEN SIZE IN USE     ZP60009*/
++MACUPD(STFSMODE) DISTLIB(ATSOMAC).
./ CHANGE NAME=STFSMODE
&NAME    STFSMODE &A,&INITIAL=NO,&RSHWKEY=64,&NOEDIT=NO         ZP60009
         LCLA  &SYSNEDT                                         ZP60009
&SYSNEDT SETA  0                                                ZP60009
         AIF   ('&NOEDIT' NE 'YES' AND '&NOEDIT' NE 'NO').ERROR5  ZP6-9
         AIF   ('&NOEDIT' EQ 'YES' AND '&A' EQ 'OFF').ERROR4    ZP60009
         AIF   (&RSHWKEY GT 0 AND &RSHWKEY LT 25).TESTFS        ZP60009
         AIF   ('&INITIAL' EQ 'NO').TESTNE                      ZP60009
.TESTNE  ANOP                                                   ZP60009
         AIF   ('&NOEDIT' EQ 'NO').TESTA                        ZP60009
&SYSNEDT SETA  32                                               ZP60009
.ERROR1  IHBERMAC 54,,INITIAL                                   ZP60009
.ERROR4  IHBERMAC 1020,NOEDIT,&A                                ZP60009
         MEXIT                                                  ZP60009
.ERROR5  IHBERMAC 54,,NOEDIT                                    ZP60009
         MEXIT                                                  ZP60009
&NAME    LA    1,&SYSFS+&SYSINIT+&SYSNEDT  MODE/INITIAL/NOEDIT  ZP60009

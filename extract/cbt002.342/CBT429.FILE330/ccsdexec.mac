./ ADD NAME=$$README 0100-2000023-2000023-1236-00041-00041-00000-FRALBER
     ----------------------- ISPF application --------------------------

     CCSD      This Application analyse the output from the
               CICS CSD extract program DFH$FORA
               For more information about the extract program,
               please see CICS customization guide chapter
               "User programs for the system definition utility"
               This application requires ISPF Version 4
               The application consist of 5 datasets.
               Rexx library
               Panel Library
               Message Library
               Skeleton Library
               Table Libary

               You have to change member $CICCSD in the Rexx library
               See section/label Ciccsd_Parms thru End_Ciccsd_Parms.
               Please change the following variables to your standards

               ACCOUNT
               CLASS
               MSGCLASS
               STEPLIB
               ISPFHLQ
               CCSDAPPL
               CCSDHLQ
               LLQCLIB
               LLQPLIB
               LLQMLIB
               LLQSLIB
               LLQTLIB
               LLQTABL

               After these changes you can execute procedure $CICCSD
               First you'll see a selection panel to display
               or create analyse tables.

               If you have any problems, comments or improvements
               please contact
               Alber(at)alber-edv.de

./ ADD NAME=$CICCSD  0100-2000023-2000023-1236-00070-00070-00000-FRALBER
/*---- REXX -- COPYRIGHT - 1999 -- CCSD ---- ISPF-DIALOG -----*/
/*                                                            */
/*     analyse CICS/ESA CSD                                   */
/*                                                            */
/*     Fritz Alber                                            */
/*     Albstr. 19                                             */
/*     D 72649 Wolfschlugen                                   */
/*     TEL. 0049-7022/959234                                  */
/*     FAX. 0049-7022/959236                                  */
/*                                                            */
/*     E-MAIL  : Alberµalber-edv.de                           */
/*     INTERNET: www.alber-edv.de                             */
/*                                                            */
/*     Please customize section Ciccsd_parms to your values   */
/*                                                            */
/*------------------------------------------------------------*/

Ciccsd_Parms:            /*  -------- Start CCSD Parms ------ */
                         /*  --------- JCL Parameters ------- */
ACCOUNT = 'T9SYSTEM'     /*  Account Info for JOB card        */
CLASS   = 'S'            /*  Job class                        */
MSGCLASS= 'Z'            /*  Job message class                */
ISPFHLQ = 'ISP'          /*  ISPFHLQ = HLQ for ISP system dsn */
                         /*  Steplib for DFHCSDUP program     */
STEPLIB = 'CICS410.SDFHLOAD' /* and extract program DFH$FORA  */
                         /*  ------- End JCL Parameters ----- */
                         /*  ----------- ISPF Parms --------- */
CCSDHLQ = 'DESTS03.CICCSD'/* CCSDHLQ = HLQ for CCSD ISPF appl */
                         /*  datasets                         */
CCSDAPPL = CCSD          /*  ISPF Application name for CCSD   */
                         /*  application                      */
LLQCLIB  = SISPEXEC      /*  LOW LEVEL QUALIFIER for EXEC and */
                         /*  CLISTS. Change to your value     */
LLQMLIB  = SISPMENU      /*  LOW LEVEL QUALIFIER for  MESSAGES*/
                         /*  Change to your value             */
LLQPLIB  = SISPPENU      /*  LOW LEVEL QUALIFIER for  PANELS  */
                         /*  Change to your value             */
LLQSLIB  = SISPSENU      /*  LOW LEVEL QUALIFIER for  SKELS   */
                         /*  Change to your value             */
LLQTLIB  = SISPTENU      /*  LOW LEVEL QUALIFIER for  TABLE   */
                         /*  INPUT. Change to your value      */
LLQTABL  = SISPTENU      /*  LOW LEVEL QUALIFIER for  TABLE   */
                         /*  OUTPUT. Change to your value     */
                         /*  ------- End of ISPF Parms ------ */
End_Ciccsd_Parms:        /*  ------ End of Ciccsd Parms ----- */

ADDRESS TSO
"ALTLIB ACTIVATE APPL(CLIST) DATASET('"CCSDHLQ"."LLQCLIB"')"

ADDRESS ISPEXEC
"LIBDEF ISPMLIB DATASET ID('"CCSDHLQ"."LLQMLIB"') STACK"
"LIBDEF ISPPLIB DATASET ID('"CCSDHLQ"."LLQPLIB"') STACK"
"LIBDEF ISPSLIB DATASET ID('"CCSDHLQ"."LLQSLIB"') STACK"
"LIBDEF ISPTLIB DATASET ID('"CCSDHLQ"."LLQTLIB"') STACK"
"LIBDEF ISPTABL DATASET ID('"CCSDHLQ"."LLQTABL"') STACK"

"SELECT CMD(CICCSD " STEPLIB CCSDAPPL CCSDHLQ ,
            LLQCLIB LLQMLIB LLQPLIB LLQSLIB LLQTLIB LLQTABL ,
            ACCOUNT CLASS MSGCLASS ISPFHLQ") ,
            PASSLIB NEWAPPL("CCSDAPPL")"

"LIBDEF ISPMLIB"
"LIBDEF ISPPLIB"
"LIBDEF ISPSLIB"
"LIBDEF ISPTLIB"
"LIBDEF ISPTABL"

ADDRESS TSO "ALTLIB DEACTIVATE APPL(CLIST)"

EXIT
./ ADD NAME=CICCMD00 0100-2000023-2000023-1236-00095-00095-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : create CSD report                          */
/*---------------------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

"ispexec vget steplib"

csdname= 'CICS90.DFHCSD.KSDS'
object = XXXXXXXX
Otype  = List
G      = 'O'

START:
"ISPEXEC ADDPOP ROW(03) COLUMN(04)"
"ISPEXEC DISPLAY PANEL(ciccmd00)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 ciccmd00 ciccmd00 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN DO
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

O = substr(otype,1,1)

SELECT
 WHEN O = 'G' then type = GROUP
 WHEN O = 'L' then type = LIST
 otherwise    signal start
end

cmd   = 'EXTRACT ' ×× type ×× '(' ×× object ×× ') OBJECTS'

T = E

START2:
"ISPEXEC ADDPOP ROW(03) COLUMN(04)"
"ISPEXEC DISPLAY PANEL(ciccmd01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 ciccmd00 ciccmd01 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN DO
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

if T ^= 'D' & T ^= 'E' then signal start2

CMD  = CMD ×× " USERPROGRAM(DFH$FORA)"

if g = 'B'
then do
  call ciccmd03 g t csdname object cmd
end
else do
  call ciccmd01 g t csdname object steplib cmd
end

cmd   = ' '

SIGNAL START

EXIT
./ ADD NAME=CICCMD01 0100-2000023-2000023-1236-00391-00391-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : display information for CICS CSD           */
/* aenderung  : Y2K erledigt                               */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg g t csdname object steplib CMD

if g = 'O'
then do
  "ALLOC DD(SYSIN) NEW LRECL(80) SPACE (1 1) TRACKS REUSE UNIT(SYSALLDA)
                   RECFM(F)  BLKSIZE(80)"
  QUEUE   CMD
  "execio 1 diskw sysin (finis"
end

"ALLOC DD(DFHCSD)   DSN('"csdname"') SHR REUSE"
"ALLOC DD(FOROUT)   NEW SP(10,10) CYL"
"ALLOC DD(SYSPRINT) NEW SP(1,1) TRACKS
                    RECFM(F B A) LRECL(121) BLKSIZE(1210)"

/*---------------------------------------------------------*/
/* Main loop to process DFHCSD                             */
/*---------------------------------------------------------*/

"CALL '"STEPLIB"(DFHCSDUP)'"

if rc     > 4
then do
  say 'Returncode = ' rc
  say 'Possible reason could be S806'
  say 'module DFHCSDUP not found'
end

crc = rc

if crc > 0
then do
  "execio * diskr sysprint(stem y. finis"
  do i = 1 to y.0
   if y.i ^= " " then say y.i
  end
end

"execio * diskr forout(stem x. finis"
"free f(forout)"
"free f(sysin)"
"free f(dfhcsd)"
"free f(sysprint)"

if crc > 4 then exit

if T = 'D'
then do
  "ISPEXEC TBERASE CICCMD00"
  "ISPEXEC TBCREATE CICCMD00 KEYS (CMD) NAMES(T G RDATE RTIME)"
  "ISPEXEC TBERASE CICTMAPS"
  "ISPEXEC TBCREATE CICTMAPS KEYS (MAPSET GROUP)
   NAMES(DESC LANG RES USAGE ULPA STATUS)"
  "ISPEXEC TBERASE CICTPROG"
  "ISPEXEC TBCREATE CICTPROG KEYS (PROGRAM GROUP)
   NAMES(DESC LANG REL RES USAGE ULPA STATUS CEDF DATLOC EKEY REMS
   REMOTEN TRANSID EXECUT AKZ ANZAP)"
  "ISPEXEC TBERASE CICTTRAN"
  "ISPEXEC TBCREATE CICTTRAN KEYS (TRAN GROUP)
   NAMES( DESC PROGRAM TWASZ PROFILE DLOC DKEY STO ISO DYN REMS REMN
   TRANCLAS AKZ ANZAT)"
  "ISPEXEC TBERASE CICTTERM"
  "ISPEXEC TBCREATE CICTTERM KEYS (TERM GROUP)
   NAMES( DESC AUTM AUTNAME TYPE NETNAME CONS USERID ATTACH USEDFLT)"
  "ISPEXEC TBERASE CICTTYPE"
  "ISPEXEC TBCREATE CICTTYPE KEYS (TYPE GROUP)
   NAMES( DESC DEVICE TER SHIP PAG DEFSC SENDS RECES USER IOAREA
   UCTRAN)"
  "ISPEXEC TBERASE CICTPROF"
  "ISPEXEC TBCREATE CICTPROF KEYS (PROF GROUP)
   NAMES( DESC SCRNSIZE UCTRAN INBFMH)"
  "ISPEXEC TBERASE CICTCONN"
  "ISPEXEC TBCREATE CICTCONN KEYS (CONN GROUP)
   NAMES( DESC NETNAME ACME SIN AUTO INS ATTSEC BIS DFU)"
  "ISPEXEC TBERASE CICTSESS"
  "ISPEXEC TBCREATE CICTSESS KEYS (SESS GROUP)
   NAMES( DESC CONN PROT RP RC SP SC SSZ RSZ OPP OPS USERID AUT INS UAL
   IOL)"
  "ISPEXEC TBERASE CICTLSRP"
  "ISPEXEC TBCREATE CICTLSRP KEYS (LSRP GROUP)
   NAMES( DESC LID MKL SHL STR D512 D1K D2K D4K D8K D12K D16K D32K I512
   I1K I2K I4K I8K HD4K HD8K HD16K HD32K HI4K HI8K)"
  "ISPEXEC TBERASE CICTFILE"
  "ISPEXEC TBCREATE CICTFILE KEYS (FILE GROUP)
   NAMES( DESC DSNA LSR STR REMS REMN RECSZ KEYL STATUS OPEN DISP DAB
   INB RF ABDRU JO JNL JNLU JNLA RECOV BATYP)"
  "ISPEXEC TBERASE CICTGRP"
  "ISPEXEC TBCREATE CICTGRP KEYS (GROUP OBJECT)
   NAMES(LIST)"
  "ISPEXEC TBERASE CICTOBJ"
  "ISPEXEC TBCREATE CICTOBJ KEYS(OBJ GROUP OBJNAME)
   NAMES(CSDNAME)"
  "ISPEXEC TBERASE CICTOBJ2"
  "ISPEXEC TBCREATE CICTOBJ2 KEYS(OBJ GROUP OBJNAME OBJECT)
   NAMES(CSDNAME)"
  "ISPEXEC TBERASE CICTLIST"
  "ISPEXEC TBCREATE CICTLIST KEYS (OBJECT) NAMES(CSDNAME)"
end
else do
  "ISPEXEC TBOPEN CICTLIST"
  "ISPEXEC TBOPEN CICTGRP "
  "ISPEXEC TBOPEN CICTOBJ"
  "ISPEXEC TBOPEN CICTOBJ2"
  "ISPEXEC TBOPEN CICCMD00"
  "ISPEXEC TBOPEN CICTMAPS"
  "ISPEXEC TBOPEN CICTPROG"
  "ISPEXEC TBOPEN CICTTRAN"
  "ISPEXEC TBOPEN CICTTERM"
  "ISPEXEC TBOPEN CICTTYPE"
  "ISPEXEC TBOPEN CICTPROF"
  "ISPEXEC TBOPEN CICTCONN"
  "ISPEXEC TBOPEN CICTSESS"
  "ISPEXEC TBOPEN CICTLSRP"
  "ISPEXEC TBOPEN CICTFILE"
end

rtime = time()
rdate = date()
akz   = 'N'
anzat = 0
anzap = 0

"ISPEXEC TBADD CICCMD00"
"ISPEXEC TBADD CICTLIST"

do i = 1 to x.0
  recordtype= substr(x.i,1,4)
  group     = substr(x.i,13,8)
  obj       = substr(x.i,5,8)
  objname   = "unknown"
  "ISPEXEC TBADD CICTGRP"
  select
    when recordtype= 'PROG'
    then do
      call prog_record
    end
    when recordtype= 'TRAN'
    then do
      call tran_record
    end
    when recordtype= 'TERM'
    then do
      call term_record
    end
    when recordtype= 'TYPE'
    then do
      call type_record
    end
    when recordtype= 'PROF'
    then do
      call prof_record
    end
    when recordtype= 'MAPS'
    then do
      call maps_record
    end
    when recordtype= 'CONN'
    then do
      call conn_record
    end
    when recordtype= 'SESS'
    then do
      call sess_record
    end
    when recordtype= 'LSRP'
    then do
      call lsrp_record
    end
    when recordtype= 'FILE'
    then do
      call file_record
    end
    otherwise
  end
  "ispexec tbadd cictobj"
  "ispexec tbadd cictobj2"
end

"ISPEXEC TBSORT  CICTPROG FIELDS(PROGRAM,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTPROG"
"ISPEXEC TBSORT  CICTMAPS FIELDS(MAPSET,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTMAPS"
"ISPEXEC TBSORT  CICTTRAN FIELDS(TRAN,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTTRAN"
"ISPEXEC TBSORT  CICTTERM FIELDS(TERM,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTTERM"
"ISPEXEC TBSORT  CICTTYPE FIELDS(TYPE,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTTYPE"
"ISPEXEC TBSORT  CICTPROF FIELDS(PROF,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTPROF"
"ISPEXEC TBSORT  CICTCONN FIELDS(CONN,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTCONN"
"ISPEXEC TBSORT  CICTSESS FIELDS(SESS,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTSESS"
"ISPEXEC TBSORT  CICTLSRP FIELDS(LSRP,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTLSRP"
"ISPEXEC TBSORT  CICTFILE FIELDS(FILE,C,A,GROUP)"
"ISPEXEC TBCLOSE CICTFILE"
"ISPEXEC TBSORT  CICTGRP FIELDS(GROUP,C,A,OBJECT)"
"ISPEXEC TBCLOSE CICTGRP"
"ISPEXEC TBSORT  CICTOBJ FIELDS(OBJ,C,A,GROUP,C,A,OBJNAME)"
"ISPEXEC TBCLOSE CICTOBJ"
"ISPEXEC TBSORT  CICTOBJ2 FIELDS(OBJ,C,A,GROUP,C,A,OBJNAME,C,A,OBJECT)"
"ISPEXEC TBCLOSE CICTOBJ2"
"ISPEXEC TBSORT  CICTLIST FIELDS(OBJECT,C,A)"
"ISPEXEC TBCLOSE CICTLIST"
"ISPEXEC TBCLOSE CICCMD00"

exit

prog_record:

objname    = 'Program'
program    = substr(x.i,5,8)
desc       = substr(x.i,21,58)
lang       = substr(x.i,79,08)
rel        = substr(x.i,88,03)
res        = substr(x.i,91,03)
usage      = substr(x.i,94,09)
ulpa       = substr(x.i,103,03)
status     = substr(x.i,106,08)
cedf       = substr(x.i,114,03)
datloc     = substr(x.i,117,05)
ekey       = substr(x.i,122,04)
rems       = substr(x.i,126,04)
remoten    = substr(x.i,130,08)
transid    = substr(x.i,138,04)
execut     = substr(x.i,142,08)

"ispexec tbmod cictprog"

return

maps_record:

objname    = 'Mapset'
mapset     = substr(x.i,5,8)
desc       = substr(x.i,21,58)
res        = substr(x.i,79,03)
usage      = substr(x.i,82,09)
ulpa       = substr(x.i,91,03)
status     = substr(x.i,94,08)

"ispexec tbmod cictmaps"

return

tran_record:

objname    = 'Transaction'
tran       = substr(x.i,5,4)
desc       = substr(x.i,21,58)
program    = substr(x.i,79,8)
twasz      = substr(x.i,87,05)
profile    = substr(x.i,92,08)
dloc       = substr(x.i,116,5)
dkey       = substr(x.i,121,04)
sto        = substr(x.i,125,03)
iso        = substr(x.i,143,03)  /* v330 na    */
dyn        = substr(x.i,146,03)  /* v330 na    */
rems       = substr(x.i,149,04)  /* v330 128,4 */
remn       = substr(x.i,153,04)  /* v330 132,4 */
tranclas   = substr(x.i,175,08)  /* v330 na    */

"ispexec tbmod cicttran"

return

term_record:

objname    = 'Terminal'
term       = substr(x.i,5,4)
desc       = substr(x.i,21,58)
autm       = substr(x.i,79,4)
autname    = substr(x.i,83,8)
type       = substr(x.i,91,08)
netname    = substr(x.i,99,08)
cons       = substr(x.i,107,3)
userid     = substr(x.i,169,08)
attach     = substr(x.i,196,10)
usedflt    = substr(x.i,209,03)

"ispexec tbmod cictterm"

return

type_record:

objname    = 'TypeTerm'
type       = substr(x.i,5,8)
desc       = substr(x.i,21,58)
device     = substr(x.i,79,8)
ter        = substr(x.i,87,1)
ship       = substr(x.i,104,3)
pag        = substr(x.i,107,7)
defsc      = substr(x.i,131,14)
sends      = substr(x.i,234,05)
reces      = substr(x.i,239,05)
user       = substr(x.i,327,03)
ioarea     = substr(x.i,330,11)
uctran     = substr(x.i,341,06)

"ispexec tbmod cicttype"

return

prof_record:

objname    = 'Profile'
prof       = substr(x.i,5,8)
desc       = substr(x.i,21,58)
Scrnsize   = substr(x.i,79,9)
uctran     = substr(x.i,88,3)
inbfmh     = substr(x.i,129,4)

"ispexec tbmod cictprof"

return

conn_record:

objname    = 'Connection'
conn       = substr(x.i,5,8)
desc       = substr(x.i,21,58)
netname    = substr(x.i,79,8)
acme       = substr(x.i,107,8)
sin        = substr(x.i,127,3)
auto       = substr(x.i,148,3)
ins        = substr(x.i,151,3)
attsec     = substr(x.i,162,10)
bis        = substr(x.i,172,03)
dfu        = substr(x.i,175,03)

"ispexec tbmod cictconn"

return

sess_record:

objname    = 'Session'
sess       = substr(x.i,5,8)
desc       = substr(x.i,21,58)
conn       = substr(x.i,79,4)
prot       = substr(x.i,103,4)
rp         = substr(x.i,114,1)
rc         = substr(x.i,115,3)
sp         = substr(x.i,119,1)
sc         = substr(x.i,120,3)
ssz        = substr(x.i,123,05)
rsz        = substr(x.i,128,05)
aut        = substr(x.i,145,03)
ins        = substr(x.i,148,03)
iol        = substr(x.i,153,11)

"ispexec tbmod cictsess"

return

lsrp_record:

objname    = "LSRpool"
lsrp       = substr(x.i,5,8)
desc       = substr(x.i,21,58)
lid        = substr(x.i,79,1)
mkl        = substr(x.i,080,3)

"ispexec tbmod cictlsrp"

return

file_record:

objname    = "File"
file       = substr(x.i,5,8)
desc       = substr(x.i,21,58)
dsna       = substr(x.i,79,44)
acme       = substr(x.i,107,8)
lsr        = substr(x.i,131,1)
str        = substr(x.i,142,3)

"ispexec tbmod cictfile"

return
./ ADD NAME=CICCMD02 0100-2000023-2000023-1236-00040-00040-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICCMD00 NOWRITE"

table = CICCMD00

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
"ISPEXEC TBDISPL " table " PANEL(CICCMD02)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICCMD02 CICCMD02 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC TBEND CICCMD00"
  exit
end

signal display

EXIT
./ ADD NAME=CICCMD03 0100-2000023-2000023-1236-00095-00095-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   trace ?r
*/

ARG g t csdname object cmd

JCLLIB  = USERID()××.ISPF.ISPPROF

USERHLQ = USERID()

"ALLOC DD(ISPFILE) DSN('"JCLLIB"') SHR REUSE"

"ISPEXEC VGET (STEPLIB CCSDAPPL)"
"ISPEXEC VGET (CCSDHLQ LLQCLIB LLQMLIB LLQPLIB LLQSLIB LLQTLIB LLQTABL)"
"ISPEXEC VGET (ACCOUNT CLASS MSGCLASS ISPFHLQ)"

"ISPEXEC FTCLOSE NAME(CICSJCL)"

"ISPEXEC FTOPEN"

if rc > 0
then do
  select
    when rc = 8
    then do
      MESS2 = "file tailoring already in progress"
    end
    when rc = 12
    then do
      MESS2 = "output file in use. ENQ failed"
    end
    when rc = 16
    then do
      MESS2 = "ISPFILE not allocated"
    end
    when rc = 20
    then do
      MESS2 = "severe error"
    end
    otherwise
  end
  MESS1 = "error FTOPEN"
  MESS3 = "returncode = " ×× rc
  MESS4 = "Procedur = CICSSUBP"
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC FTCLOSE"
  signal free_file
end

"ISPEXEC FTINCL CICSJCL"

if rc > 0
then do
  select
    when rc = 8
    then do
      MESS1 = "output skeleton not defined"
    end
    when rc = 12
    then do
      MESS1 = "output skeleton in use. ENQ failed"
    end
    when rc = 16
    then do
      MESS1 = "data truncation occured"
    end
    when rc = 20
    then do
      MESS1 = "severe error"
    end
    otherwise
  end
  MESS2 = "please contact system support"
  MESS3 = "skeleton = " ×× CICSJCL
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(COB0000)"
  "ISPEXEC FTCLOSE"
  "ISPEXEC REMPOP"
  signal ende
end

"ISPEXEC FTCLOSE NAME(CCSDJOB0)"

"ISPEXEC EDIT DATASET('"JCLLIB"(CCSDJOB0)')"

ende:
"ISPEXEC FTERASE CCSDJOB0"

free_file:
"FREE DD(ISPFILE)"

EXIT
./ ADD NAME=CICCON00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTCONN"
"ISPEXEC TBOPEN CICTCONN NOWRITE"

call ciccon01 AL cictconn "all connection entries"

"ISPEXEC TBEND CICTCONN"

exit
./ ADD NAME=CICCON01 0100-2000023-2000023-1236-00075-00075-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICCON01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 ciccon01 ciccon01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  CALL    CICCON02 KZ table CICCON01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICCON01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      term  = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(conn) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'S' then call cicses08 'CONN' conn group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICCON02 0100-2000023-2000023-1236-00173-00173-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD programm information       */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICCON02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 CICCON02 CICCON02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=VT
  when e = 2 THEN CSEL=IR
  when e = 3 THEN CSEL=XM
  when e = 4 THEN CSEL=SN
  when e = 5 THEN CSEL=SY
  when e = 6 THEN CSEL=AN
  when e = 7 THEN CSEL=AY
  when e = 8 THEN CSEL=IN
  when e = 9 THEN CSEL=IY
  when e = 10 THEN CSEL=LA
  when e = 11 THEN CSEL=IA
  when e = 12 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = VT
  then do
    fieldn  = "ACME"
    fieldv  = 'VTAM*'
  end
  WHEN CSEL = IR
  then do
    fieldn  = "ACME"
    fieldv  = 'IRC*'
  end
  WHEN CSEL = XM
  then do
    fieldn  = "ACME"
    fieldv  = 'XM*'
  end
  WHEN CSEL = SN
  then do
    fieldn  = "SIN"
    fieldv  = 'NO*'
  end
  WHEN CSEL = SY
  then do
    fieldn  = "SIN"
    fieldv  = 'YES'
  end
  WHEN CSEL = AN
  then do
    fieldn  = "AUTO"
    fieldv  = 'NO*'
  end
  WHEN CSEL = AY
  then do
    fieldn  = "AUTO"
    fieldv  = 'YES'
  end
  WHEN CSEL = IN
  then do
    fieldn  = "INS"
    fieldv  = 'NO*'
  end
  WHEN CSEL = IY
  then do
    fieldn  = "INS"
    fieldv  = 'YES'
  end
  WHEN CSEL = LA
  then do
    fieldn  = "ATTSEC"
    fieldv  = 'LOCAL*'
  end
  WHEN CSEL = IA
  then do
    fieldn  = "ATTSEC"
    fieldv  = 'IDENT*'
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = CICCON××csel

call value fieldn,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("fieldn",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(CONN GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN" table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "Connection " fieldn " = " fieldv

call CICCON01 kz tabname ausw

"ISPEXEC TBEND " tabname

csel = " "

signal start

EXIT
./ ADD NAME=CICCON08 0100-2000023-2000023-1236-00061-00061-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTCONN NOWRITE SHARE"

ORC = RC

"ISPEXEC TBTOP    CICTCONN"
"ISPEXEC TBVCLEAR CICTCONN"

call value fieldn,fieldv

tabname = ciccon08

"ISPEXEC TBQUERY CICTCONN NAMES(TNAMES)"
"ISPEXEC TBSARG CICTCONN NEXT NAMECOND("fieldn",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(CONN GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN CICTCONN"
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF ORC = 0 THEN "ISPEXEC TBEND CICTCONN"

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = fieldn
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBTOP " tabname

ausw = "Connections " fieldn " = " fieldv

call ciccon01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICCON09 0100-2000023-2000023-1236-00037-00037-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG CONN GROUP

"ISPEXEC CONTROL ERRORS RETURN"

tabname = ciccon09

"ISPEXEC TBOPEN CICTCONN NOWRITE SHARE"

ORC = RC

"ISPEXEC TBGET CICTCONN"

"ISPEXEC TBQUERY CICTCONN NAMES(TNAMES)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(CONN GROUP) NOWRITE NAMES"TNAMES

IF ORC = 0 THEN "ISPEXEC TBEND CICTCONN"

"ISPEXEC TBADD " tabname " MULT(1000)"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

ausw = "Connection " fieldn " = " fieldv

call ciccon01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICCSD   0100-2000023-2000023-1236-00070-00070-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : display CSD selection menu                 */
/*---------------------------------------------------------*/
/*
    trace ?r
*/

arg steplib  ,              /* steplib for DFCSDUP pgm       */
    ccsdappl ,              /* applname for ccsd application */
    ccsdhlq  ,              /* hlq for ccsd datasets         */
    llqclib  ,              /* llq for exec und clist        */
    llqmlib  ,              /* llq for mlib                  */
    llqplib  ,              /* llq for plib                  */
    llqslib  ,              /* llq for slib                  */
    llqtlib  ,              /* llq for tlib                  */
    llqtabl  ,              /* llq tabl                      */
    account  ,
    class    ,
    msgclass ,
    ispfhlq

"ISPEXEC VPUT (STEPLIB ccsdAPPL ccsdHLQ) profile"
"ISPEXEC VPUT (LLQCLIB LLQMLIB LLQPLIB LLQSLIB LLQTLIB LLQTABL) profile"
"ISPEXEC VPUT (ACCOUNT CLASS MSGCLASS ISPFHLQ) profile"

"ISPEXEC CONTROL ERRORS RETURN"

START:
"ISPEXEC DISPLAY PANEL(CICCSD)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 ciccsd cicsd RC
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  EXIT
end

select
  when zcmd = 1 THEN CALL CICCMD00
  WHEN zcmd = 2 THEN CALL CICCMD02
  when zcmd = 3 THEN CALL CICPRG00
  WHEN zcmd = 4 THEN CALL CICTRN00
  WHEN zcmd = 5 THEN CALL CICTRM00
  WHEN zcmd = 6 THEN CALL CICTYP00
  WHEN zcmd = 7 THEN CALL CICPRF00
  WHEN zcmd = 8 THEN CALL CICMAP00
  WHEN zcmd = 9 THEN CALL CICSES00
  WHEN zcmd =10 THEN CALL CICCON00
  WHEN zcmd =11 THEN CALL CICFIL00
  WHEN zcmd =12 THEN CALL CICLSR00
  WHEN zcmd =13 THEN CALL CICGRP00
  WHEN zcmd =14 THEN CALL CICOBJ00
  WHEN zcmd =15 THEN CALL CICOB200
  WHEN zcmd =16 THEN CALL CICLST00
  otherwise
end

SIGNAL START

EXIT
./ ADD NAME=CICFIL00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTFILE"
"ISPEXEC TBOPEN CICTFILE NOWRITE"

call CICFIL01 AL cictfile "all file entries"

"ISPEXEC TBEND CICTFILE"

exit
./ ADD NAME=CICFIL01 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICFIL01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICFIL01 CICFIL01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICFIL02 KZ table CICFIL01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICFIL01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      file = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(file) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'L' then call ciclsr09 'LID' lsr group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICFIL02 0100-2000023-2000023-1236-00320-00320-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD file information           */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICFIL02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 CICFIL02 CICFIL02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=FI
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=DS
  when e = 4 THEN CSEL=LS
  when e = 5 THEN CSEL=SO
  when e = 6 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = FI
  then do
    CALL file_selection
    fieldn  = "FILE"
    fieldv  = file
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = DS
  then do
    l       = "C"
    CALL dsn_selection
    fieldn  = "DSNA"
    fieldv  = dsname
  end
  WHEN CSEL = LS
  then do
    l       = "1"
    CALL lsr_selection
    fieldn  = "LSR"
    fieldv  = lsr
  end
  WHEN CSEL = RE
  then do
    fieldn  = "RES"
    fieldv  = "YES"
  end
  WHEN CSEL = SO
  then do
    CALL sort_selection
    if e    = 1 then fieldn = 'GROUP'
                else fieldn  = 'DSNA'
    "ISPEXEC TBSORT " table " FIELDS("fieldn",C,A,FILE)"
    ausw = 'Files sorted ' ×× fieldn
    call cicfil01 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(FILE)"
    signal start
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cicfil××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(FILE GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "files " fieldn " = " fieldv

call cicfil01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

file_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICFIL03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICFIL02 CICFIL03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',file) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal file_selection
end
IF POS('*',file) = 0
then do
  file = file ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICFIL04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICFIL02 cicfil04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

sort_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICFIL06)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICFIL02 cicfil06 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

return

dsn_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICfil05)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICFIL02 cicfil05 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',dsname) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal dsn_selection
end
IF POS('*',dsname) = 0
then do
  dsname = dsname ×× '*'
end

return

lsr_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICfil07)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICFIL02 cicfil07 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

lsr = l

return
./ ADD NAME=CICFIL09 0100-2000023-2000023-1236-00063-00063-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTFILE NOWRITE SHARE"

ORC = RC

"ISPEXEC TBTOP    CICTFILE"
"ISPEXEC TBVCLEAR CICTFILE"

group = gr

call value fieldn,fieldv

tabname = cicfills

"ISPEXEC TBQUERY CICTFILE NAMES(TNAMES)"
"ISPEXEC TBSARG CICTFILE NEXT NAMECOND("fieldn",EQ,GROUP,EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(FILE GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN CICTFILE"
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF ORC = 0 THEN "ISPEXEC TBEND CICTFILE"

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = fieldn
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBTOP " tabname

ausw = "FILE " fieldn " = " fieldv

call cicfil01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICGRP00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTGRP"
"ISPEXEC TBOPEN CICTGRP NOWRITE"

call CICGRP01 AL cictgrp "all group/list entries"

"ISPEXEC TBEND CICTGRP"

exit
./ ADD NAME=CICGRP01 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICGRP01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICGRP01 CICGRP01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICGRP02 KZ table CICGRP01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICGRP01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      group = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(group) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'G' then call cicobj08 'GROUP' group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICGRP02 0100-2000023-2000023-1236-00203-00203-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD group information          */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICGRP02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 CICGRP02 CICGRP02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=GR
  when e = 2 THEN CSEL=LI
  when e = 3 THEN CSEL=SL
  when e = 4 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = LI
  then do
    CALL list_selection
    fieldn  = "OBJECT"
    fieldv  = object
  end
  WHEN CSEL = SL
  then do
    "ISPEXEC TBSORT " table " FIELDS(OBJECT,C,A,GROUP)"
    ausw = 'sorted by list'
    call CICGRP01 csel table ausw
    "ISPEXEC TBSORT " table " FIELDS(GROUP,C,A,OBJECT)"
    signal start
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = CICGRP××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(GROUP OBJECT) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "group " fieldn " = " fieldv

call CICGRP01 csel tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICGRP04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICGRP02 CICGRP04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

list_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICGRP03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICGRP02 CICGRP03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',object) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal list_selection
end
IF POS('*',object) = 0
then do
  object = object ×× '*'
end

return
./ ADD NAME=CICGRP08 0100-2000023-2000023-1236-00061-00061-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTGRP NOWRITE SHARE"

ORC = RC

"ISPEXEC TBTOP    CICTGRP"
"ISPEXEC TBVCLEAR CICTGRP"

call value fieldn,fieldv

tabname = cicgrpgr

"ISPEXEC TBQUERY CICTGRP NAMES(TNAMES)"
"ISPEXEC TBSARG CICTGRP NEXT NAMECOND("fieldn",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(GROUP OBJECT) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN CICTGRP"
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF ORC = 0 THEN "ISPEXEC TBEND CICTGRP"

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = 'List'
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBTOP " tabname

ausw = "Programme " fieldn " = " fieldv

call cicgrp01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICLSR00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTLSRP"
"ISPEXEC TBOPEN CICTLSRP NOWRITE"

call CICLSR01 AL cictlsrp "all LSR pool entries"

"ISPEXEC TBEND CICTLSRP"

exit
./ ADD NAME=CICLSR01 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICLSR01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICLSR01 CICLSR01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICLSR02 KZ table CICLSR01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICLSR01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      lsrp = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(lsrp) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'F' then call cicfil09 'LSR' lid group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICLSR02 0100-2000023-2000023-1236-00232-00232-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD LSRp information           */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICLSR02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 CICLSR02 CICLSR02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=LS
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=ID
  when e = 4 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = LS
  then do
    CALL lsrp_selection
    fieldn  = "LSRP"
    fieldv  = lsrp
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = ID
  then do
    l       = "1"
    CALL lid_selection
    fieldn  = "LID"
    fieldv  = lid
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = CICLSR××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(LSRP GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "files " fieldn " = " fieldv

call CICLSR01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

lsrp_selection:
lsrp = ""
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICLSR03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICLSR02 CICLSR03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',lsrp) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal lsrp_selection
end
IF POS('*',lsrp) = 0
then do
  lsrp = lsrp ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICLSR04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICLSR02 CICLSR04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

lid_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICLSR05)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICLSR02 CICLSR05 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

lid = l

return
./ ADD NAME=CICLSR09 0100-2000023-2000023-1236-00071-00071-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTLSRP NOWRITE SHARE"
"ISPEXEC TBVCLEAR CICTLSRP"

group = gr

call value fieldn,fieldv

"ISPEXEC TBSARG CICTLSRP NEXT NAMECOND("fieldn",EQ,GROUP,EQ)"

rc = 0
recfound = n

"ISPEXEC TBSCAN CICTLSRP"

if rc > 0
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "LSRPool"
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND CICTLSRP"
  exit
end

"ISPEXEC TBEND CICTLSRP"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC ADDPOP"

display:
a = ' '
"ISPEXEC DISPLAY PANEL(CICLSR09)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 ciclsr09 ciclsr09 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC REMPOP"
  exit
end

signal display

EXIT
./ ADD NAME=CICLST00 0100-2000023-2000023-1236-00066-00066-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTLIST NOWRITE"

table = CICTLIST

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
"ISPEXEC TBDISPL " table " PANEL(CICLST00)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICLST00 CICLST00 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC TBEND CICTLIST"
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      object  = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(program) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'G' then call cicgrp08 'OBJECT' object
    if a = 'O' then call cicob208 'OBJECT' object
    a = ' '
    signal display
  end
  signal display
end

signal display

EXIT
./ ADD NAME=CICMAP00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTMAPS"
"ISPEXEC TBOPEN CICTMAPS NOWRITE"

call cicmap01 AL cictmaps "all mapset entries"

"ISPEXEC TBEND CICTMAPS"

exit
./ ADD NAME=CICMAP01 0100-2000023-2000023-1236-00071-00071-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(cicmap01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicmap01 cicmap01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    cicmap02 KZ table cicmap01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICMAP01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      mapset  = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(mapset) condlist(ge)"
      signal display
    END
  END
end

EXIT
./ ADD NAME=CICMAP02 0100-2000023-2000023-1236-00209-00209-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD programm information       */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICMAP02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 CICMAP02 CICMAP02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=MA
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=RE
  when e = 4 THEN CSEL=SO
  when e = 5 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = MA
  then do
    CALL maps_selection
    fieldn  = "MAPSET"
    fieldv  = maps
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = RE
  then do
    fieldn  = "RES"
    fieldv  = "YES"
  end
  WHEN CSEL = SO
  then do
    "ISPEXEC TBSORT " table " FIELDS(GROUP,C,A,MAPSET)"
    ausw = 'Mapset sorted ' ×× by group
    call cicmap01 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(MAPSET)"
    signal start
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cicmap××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(MAPSET GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "programm " fieldn " = " fieldv

call cicmap01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

maps_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICMAP03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICMAP02 cicmap03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',maps) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal maps_selection
end
IF POS('*',maps) = 0
then do
  maps = maps ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICMAP04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICMAP02 cicmap04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return
./ ADD NAME=CICMAP09 0100-2000023-2000023-1236-00046-00046-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG MAPSET GROUP

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTMAPS NOWRITE SHARE"

"ISPEXEC TBGET CICTMAPS"
"ISPEXEC TBEND CICTMAPS"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC ADDPOP"

display:
a = ' '
"ISPEXEC DISPLAY PANEL(CICMAP09)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicmap09 cicmap09 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC REMPOP"
  exit
end

signal display

EXIT
./ ADD NAME=CICOBJ00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTOBJ"
"ISPEXEC TBOPEN CICTOBJ NOWRITE"

call CICOBJ01 AL CICTOBJ "all CSD/group/list objects"

"ISPEXEC TBEND CICTOBJ"

exit
./ ADD NAME=CICOBJ01 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICOBJ01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICOBJ01 CICOBJ01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICOBJ02 KZ table CICOBJ01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICOBJ01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      obj   = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(obj) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'S' then call cicobj09 obj objname group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICOBJ02 0100-2000023-2000023-1236-00293-00293-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD object information         */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

DISPLAY:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICOBJ02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 cicobj02 cicobj02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=OB
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=TR
  when e = 4 THEN CSEL=PR
  when e = 5 THEN CSEL=TE
  when e = 6 THEN CSEL=MA
  when e = 7 THEN CSEL=CO
  when e = 8 THEN CSEL=SE
  when e = 9 THEN CSEL=TY
  when e = 10 THEN CSEL=PF
  when e = 11 THEN CSEL=FI
  when e = 12 THEN CSEL=LS
  when e = 13 THEN CSEL=SO
  when e = 14 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = OB
  then do
    CALL object_selection
    fieldn  = "OBJ"
    fieldv  = obj
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = TR
  then do
    CALL CICTRN00
    signal display
  end
  WHEN CSEL = PR
  then do
    CALL CICPRG00
    signal display
  end
  WHEN CSEL = TE
  then do
    CALL CICTRM00
    signal display
  end
  WHEN CSEL = MA
  then do
    CALL CICMAP00
    signal display
  end
  WHEN CSEL = CO
  then do
    CALL CICCON00
    signal display
  end
  WHEN CSEL = SE
  then do
    CALL CICSES00
    signal display
  end
  WHEN CSEL = TY
  then do
    CALL CICTYP00
    signal display
  end
  WHEN CSEL = PF
  then do
    CALL CICPRF00
    signal display
  end
  WHEN CSEL = FI
  then do
    CALL CICFIL00
    signal display
  end
  WHEN CSEL = LS
  then do
    CALL CICLSR00
    signal display
  end
  WHEN CSEL = SO
  then do
    CALL sort_selection
    if e    = 1 then fieldn = 'OBJNAME'
                else fieldn  = 'GROUP'
    "ISPEXEC TBSORT " table " FIELDS("fieldn",C,A,OBJ)"
    ausw = 'Object sorted ' ×× fieldn
    call cicobj01 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(OBJ,C,A,GROUP,C,A,OBJNAME)"
    signal display
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cicobj××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(OBJ OBJNAME GROUP) NOWRITE NAMES"TNAM

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal display
end

"ISPEXEC TBTOP " tabname

ausw = "Object " fieldn " = " fieldv

call cicobj01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal display

EXIT

object_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICOBJ03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicobj02 cicobj03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal display
end

"ISPEXEC REMPOP"

IF POS('*',obj) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal object_selection
end
IF POS('*',obj) = 0
then do
  obj = obj ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICPRG04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicobj02 cicprg04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal display
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

sort_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICOBJ04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicobj02 cicobj04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal display
end

"ISPEXEC REMPOP"

return
./ ADD NAME=CICOBJ08 0100-2000023-2000023-1236-00056-00056-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTOBJ NOWRITE SHARE"
"ISPEXEC TBVCLEAR CICTOBJ"

call value fieldn,fieldv

tabname = cicobjgr

"ISPEXEC TBQUERY CICTOBJ NAMES(TNAMES)"
"ISPEXEC TBSARG CICTOBJ NEXT NAMECOND("fieldn",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(OBJ GROUP OBJNAME) NOWRITE NAMES"TNAM

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN CICTOBJ"
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = 'Objects'
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBEND CICTOBJ"
"ISPEXEC TBTOP " tabname

ausw = "Objects " fieldn " = " fieldv

call cicobj01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICOBJ09 0100-2000023-2000023-1236-00045-00045-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG obj objname group

group = strip(group)
obj   = strip(obj)

"ISPEXEC CONTROL ERRORS RETURN"

select
  when objname = 'TRANSACTION'
  then do
    call cictrn09 obj group
  end
  when objname = 'TYPETERM'
  then do
    call cictyp09 obj group
  end
  when objname = 'PROFILE'
  then do
    call cicprf09 obj group
  end
  when objname = 'PROGRAM'
  then do
    call cicprg09 obj group
  end
  when objname = 'MAPSET'
  then do
    call cicmap09 obj group
  end
  when objname = 'SESSION'
  then do
    call cicses09 obj group
  end
  when objname = 'CONNECTION'
  then do
    call ciccon09 obj group
  end
  otherwise
end

EXIT
./ ADD NAME=CICOB200 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTOBJ2"
"ISPEXEC TBOPEN CICTOBJ2 NOWRITE"

call CICOB201 AL CICTOBJ2 "all CSD/group/list objects"

"ISPEXEC TBEND CICTOBJ2"

exit
./ ADD NAME=CICOB201 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICOB201)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICOB201 CICOB201 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICOB202 KZ table CICOB201 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICOB201 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      obj   = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(obj) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'S' then call cicobj09 obj objname group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICOB202 0100-2000023-2000023-1236-00324-00324-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD object information         */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

DISPLAY:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICOB202)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 cicob202 cicob202 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=OB
  when e = 2 THEN CSEL=OT
  when e = 3 THEN CSEL=GR
  when e = 4 THEN CSEL=LI
  when e = 5 THEN CSEL=SO
  when e = 6 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = OB
  then do
    CALL object_selection
    fieldn  = "OBJ"
    fieldv  = obj
  end
  WHEN CSEL = OT
  then do
    CALL object_type_selection
    fieldn  = "OBJNAME"
    fieldv  = objn
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = LI
  then do
    CALL list_selection
    fieldn  = 'OBJECT'
    fieldv  = object
  end
  WHEN CSEL = SO
  then do
    CALL sort_selection
    select
      when e = 1 then fieldn = 'OBJNAME'
      when e = 2 then fieldn = 'GROUP'
      otherwise       fieldn  = 'OBJECT'
    end
    "ISPEXEC TBSORT " table " FIELDS("fieldn",C,A,OBJ,C,A,GROUP,C,A,OBJN
    ausw = 'Object sorted ' ×× fieldn
    call cicob201 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(OBJ,C,A,GROUP,C,A,OBJNAME,OBJECT)"
    signal display
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cicob2××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(OBJ OBJNAME GROUP OBJECT) NOWRITE"

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal display
end

"ISPEXEC TBTOP " tabname

ausw = "Object " fieldn " = " fieldv

call cicob201 kz tabname ausw

"ISPEXEC TBEND " tabname

signal display

EXIT

object_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICOBJ03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicob202 cicobj03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal display
end

"ISPEXEC REMPOP"

IF POS('*',obj) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal object_selection
end
IF POS('*',obj) = 0
then do
  obj = obj ×× '*'
end

return

object_type_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICOB203)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicob202 cicob203 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal display
end

"ISPEXEC REMPOP"

select
  when zcmd = 1 THEN objn = "Transaction"
  when zcmd = 2 THEN objn = "Mapset"
  when zcmd = 3 THEN objn = "Program"
  when zcmd = 4 THEN objn = "Terminal"
  when zcmd = 5 THEN objn = "Profile"
  when zcmd = 6 THEN objn = "TypeTerm"
  otherwise
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICPRG04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicobj02 cicprg04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal display
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

sort_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICOB204)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicobj02 cicobj04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal display
end

"ISPEXEC REMPOP"

return

list_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICGRP03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 CICOB202 CICGRP03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',object) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal list_selection
end
IF POS('*',object) = 0
then do
  object = object ×× '*'
end

return
./ ADD NAME=CICOB208 0100-2000023-2000023-1236-00056-00056-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTOBJ2 NOWRITE SHARE"
"ISPEXEC TBVCLEAR CICTOBJ2"

call value fieldn,fieldv

tabname = cicobjli

"ISPEXEC TBQUERY CICTOBJ2 NAMES(TNAMES)"
"ISPEXEC TBSARG CICTOBJ2 NEXT NAMECOND("fieldn",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(OBJ OBJNAME GROUP OBJECT) NOWRITE"

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN CICTOBJ2"
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = 'Program'
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBEND CICTOBJ2"
"ISPEXEC TBTOP " tabname

ausw = "Programme " fieldn " = " fieldv

call cicob201 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICPRF00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTPROF"
"ISPEXEC TBOPEN CICTPROF NOWRITE"

call cicprf01 AL cictprof "all profile entries"

"ISPEXEC TBEND CICTPROF"

exit
./ ADD NAME=CICPRF01 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICPRF01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprf01 cicprf01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICPRF02 KZ table CICPRF01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICPRF01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      prof    = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(prof) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'T' then call cictrn08 'PROFILE' prof group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICPRF02 0100-2000023-2000023-1236-00230-00230-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD programm information       */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
OP   = EQ
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cicprf02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 cicprf02 cicprf02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=PR
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=SA
  when e = 4 THEN CSEL=SD
  when e = 5 THEN CSEL=UT
  when e = 6 THEN CSEL=UC
  when e = 7 THEN CSEL=NU
  when e = 8 THEN CSEL=SO
  when e = 9 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = PR
  then do
    CALL prf_selection
    fieldn  = "PROF"
    fieldv  = prf
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = SA
  then do
    fieldn  = "SCRNSIZE"
    fieldv  = ALTERNATE
  end
  WHEN CSEL = SD
  then do
    fieldn  = "SCRNSIZE"
    fieldv  = DEFAULT
  end
  WHEN CSEL = UC
  then do
    fieldn  = "UCTRAN"
    fieldv  = yes
  end
  WHEN CSEL = UT
  then do
    fieldn  = "UCTRAN"
    fieldv  = TRANID
  end
  WHEN CSEL = NU
  then do
    fieldn  = "UCTRAN"
    fieldv  = NO
  end
  WHEN CSEL = SO
  then do
    fieldn = GROUP
    "ISPEXEC TBSORT " table " FIELDS("fieldn",C,A,PROF)"
    ausw = 'Profile sorted ' ×× fieldn
    call cicprf01 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(PROF)"
    signal start
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cicprf××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field","op")"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(PROF GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "Profile"
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "Profile " fieldn " = " fieldv

call cicprf01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

prf_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cicprf03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprf02 cicprf03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',prf) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal prf_selection
end
IF POS('*',prf) = 0
then do
  prf  = prf  ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cicprg04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn02 cictrn04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return
./ ADD NAME=CICPRF09 0100-2000023-2000023-1236-00046-00046-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG PROF GROUP

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTPROF NOWRITE SHARE"

"ISPEXEC TBGET CICTPROF"
"ISPEXEC TBEND CICTPROF"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC ADDPOP"

display:
a = ' '
"ISPEXEC DISPLAY PANEL(CICPRF09)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprf09 cicprf09 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC REMPOP"
  exit
end

signal display

EXIT
./ ADD NAME=CICPRG00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTPROG"
"ISPEXEC TBOPEN CICTPROG NOWRITE"

call cicprg01 AL cictprog "all program entries"

"ISPEXEC TBEND CICTPROG"

exit
./ ADD NAME=CICPRG01 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICPRG01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprg01 cicprg01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICPRG02 KZ table CICPRG01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICPRG01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      program = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(program) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'T' then call cictrn08 'PROGRAM' program group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICPRG02 0100-2000023-2000023-1236-00287-00287-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD programm information       */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICPRG02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 cicprg02 cicprg02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=PR
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=LA
  when e = 4 THEN CSEL=RE
  when e = 5 THEN CSEL=EC
  when e = 6 THEN CSEL=SO
  when e = 7 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = PR
  then do
    CALL prog_selection
    fieldn  = "PROGRAM"
    fieldv  = prog
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = LA
  then do
    l       = "C"
    CALL lang_selection
    fieldn  = "LANG"
    fieldv  = lan
  end
  WHEN CSEL = EC
  then do
    fieldn  = "EKEY"
    fieldv  = "CICS"
  end
  WHEN CSEL = RE
  then do
    fieldn  = "RES"
    fieldv  = "YES"
  end
  WHEN CSEL = SO
  then do
    CALL sort_selection
    if e    = 1 then fieldn = 'GROUP'
                else fieldn  = 'LANG'
    "ISPEXEC TBSORT " table " FIELDS("fieldn",C,A,PROGRAM)"
    ausw 'Program sorted ' ×× fieldn
    call cicprg01 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(PROGRAM)"
    signal start
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cicprg××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(PROGRAM GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "programm " fieldn " = " fieldv

call cicprg01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

prog_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICPRG03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprg02 cicprg03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',prog) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal prog_selection
end
IF POS('*',prog) = 0
then do
  prog = prog ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICPRG04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprg02 cicprg04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

sort_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICPRG06)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprg02 cicprg06 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

return

lang_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICPRG05)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprg02 cicprg05 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

select
  when l = C THEN lan = COBOL
  when l = A THEN lan = ASSEMBLE
  when l = P THEN lan = PLI
  otherwise signal lang_selection
end

return
./ ADD NAME=CICPRG08 0100-2000023-2000023-1236-00056-00056-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTPROG NOWRITE SHARE"
"ISPEXEC TBVCLEAR CICTPROG"

call value fieldn,fieldv

tabname = cicprggr

"ISPEXEC TBQUERY CICTPROG NAMES(TNAMES)"
"ISPEXEC TBSARG CICTPROG NEXT NAMECOND("fieldn",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(PROGRAM GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN CICTPROG"
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = 'Program'
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBEND CICTPROG"
"ISPEXEC TBTOP " tabname

ausw = "Programme " fieldn " = " fieldv

call cicprg01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICPRG09 0100-2000023-2000023-1236-00050-00050-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG PROGRAM GROUP

group = strip(group)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTPROG NOWRITE SHARE"

orc = rc

"ISPEXEC TBGET CICTPROG"
IF ORC = 0 THEN "ISPEXEC TBEND CICTPROG"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC ADDPOP"

display:
a = ' '
"ISPEXEC DISPLAY PANEL(CICPRG09)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicprg09 cicprg09 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC REMPOP"
  exit
end

signal display

EXIT
./ ADD NAME=CICP000  0100-2000023-2000023-1236-00063-00063-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

arg panel table sel

"ISPEXEC CONTROL ERRORS RETURN"

select
 when panel = 'CICOBJ01' THEN ESTR1 = 'CSD Object summary'
 when panel = 'CICOB201' THEN ESTR1 = 'CSD Object summary'
 when panel = 'CICGRP01' THEN ESTR1 = 'CSD Group/list summary'
 when panel = 'CICCON01' THEN ESTR1 = 'CSD Connection summary'
 when panel = 'CICMAP01' THEN ESTR1 = 'CSD Mapset summary'
 when panel = 'CICPRG01' THEN ESTR1 = 'CSD Programm summary'
 when panel = 'CICSES01' THEN ESTR1 = 'CSD Session summary'
 when panel = 'CICTRN01' THEN ESTR1 = 'CSD Transaktion summary'
 when panel = 'CICTRM01' THEN ESTR1 = 'CSD Terminal summary'
 when panel = 'CICTYP01' THEN ESTR1 = 'CSD Typeterm summary'
 when panel = 'CICPRF01' THEN ESTR1 = 'CSD Profile summary'
 when panel = 'CICFIL01' THEN ESTR1 = 'CSD file summary'
 when panel = 'CICLSR01' THEN ESTR1 = 'CSD LSRpool summary'
 otherwise
end

/*------------------------------------------------------------*/
/*   VARIABLEN IN POOL Profile stellen.                       */
/*   Profile notwendig, damit im Batchjob Variablen           */
/*   zur Verfuegung stehen                                    */
/*------------------------------------------------------------*/

"ISPEXEC VPUT ESTR1"

"ISPEXEC ADDPOP ROW(10) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICP001)"

IF RC = 12 × RC = 20
THEN do
  CALL HSM0000 hsmp000 hsmp001 RC
  "ISPEXEC REMPOP"
  EXIT
end

if rc > 0
then do
  "ISPEXEC REMPOP"
  exit
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

"ISPEXEC REMPOP"

"ISPEXEC vput oclass"

call cicssubp cicp000 table CICP000 panel sel

EXIT
./ ADD NAME=CICSES00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTSESS"
"ISPEXEC TBOPEN CICTSESS NOWRITE"

call cicses01 AL cictsess "all sessions entries"

"ISPEXEC TBEND CICTSESS"

exit
./ ADD NAME=CICSES01 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICSES01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cicses01 cicses01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICSES02 KZ table CICSES01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICSES01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      term  = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(sess) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'C' then call ciccon08 'CONN' conn group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICSES02 0100-2000023-2000023-1236-00130-00130-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD programm information       */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICSES02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 CICSES02 CICSES02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=61
  when e = 2 THEN CSEL=AP
  when e = 3 THEN CSEL=EX
  when e = 4 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = 61
  then do
    fieldn  = "PROT"
    fieldv  = LU61
  end
  WHEN CSEL = AP
  then do
    fieldn  = "PROT"
    fieldv  = APPC
  end
  WHEN CSEL = EX
  then do
    fieldn  = "PROT"
    fieldv  = APPC
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = CICSES××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBTOP  " table
"ISPEXEC TBSKIP " table

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(SESS GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBGET" table
  if rc > 0 then leave
  if prot = fieldv
  then do
    "ISPEXEC TBADD " tabname " MULT(1000)"
    recfound = y
  end
  "ISPEXEC TBSKIP" table
  if rc > 0 then leave
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn ×× " = " ×× fieldv
  MESS3 = " "
  MESS4 = " "
  MESS5 = " "
  MESS6 = " "
  MESS7 = " "
  MESS8 = " "
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "session " fieldn " = " fieldv

call CICSES01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT
./ ADD NAME=CICSES08 0100-2000023-2000023-1236-00068-00068-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

fieldv = strip(fieldv)
gr     = strip(gr)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTSESS NOWRITE SHARE"

ORC = RC

"ISPEXEC TBTOP    CICTSESS"
"ISPEXEC TBVCLEAR CICTSESS"

group = gr

tabname = cicsesco

"ISPEXEC TBQUERY CICTSESS NAMES(TNAMES)"
"ISPEXEC TBTOP CICTSESS"
"ISPEXEC TBSKIP CICTSESS"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(SESS GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBGET  CICTSESS"
  if rc > 0 then leave
  if conn = fieldv
  then do
    "ISPEXEC TBADD " tabname " MULT(1000)"
    recfound = y
  end
  "ISPEXEC TBSKIP CICTSESS"
  if rc > 0 then leave
end

IF ORC = 0 THEN "ISPEXEC TBEND CICTSESS"

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = fieldn
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBTOP " tabname

ausw = "Sessions " fieldn " = " fieldv

call cicses01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICSES09 0100-2000023-2000023-1236-00037-00037-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG SESS GROUP

"ISPEXEC CONTROL ERRORS RETURN"

tabname = cicses09

"ISPEXEC TBOPEN CICTSESS NOWRITE SHARE"

ORC = RC

"ISPEXEC TBGET CICTSESS"

"ISPEXEC TBQUERY CICTSESS NAMES(TNAMES)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(SESS GROUP) NOWRITE NAMES"TNAMES

IF ORC = 0 THEN "ISPEXEC TBEND CICTSESS"

"ISPEXEC TBADD " tabname " MULT(1000)"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

ausw = "Sessions " fieldn " = " fieldv

call cicses01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICSSUBM 0100-2000023-2000023-1236-00012-00012-00000-FRALBER
PROC 2   DSN MBR
         ISREDIT MACRO
         CONTROL NOFLUSH
         SET &SUBDSN = &STR(&DSN.(&MBR))
         SET SYSOUTTRAP=1
         SUBMIT '&SUBDSN'
         SET &SUBRC EQ &STR(&LASTCC)
         SET SYSOUTTRAP=0
         SET &ZEDSMSG = &STR(CICS JOB(S) SUBMITTED)
         SET &ZEDLMSG = &STR(&SYSOUTLINE1)
         ISPEXEC SETMSG MSG(ISRZ000)
         EXIT CODE(0)
./ ADD NAME=CICSSUBP 0100-2000023-2000023-1236-00095-00095-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
*/
   trace ?r

"ISPEXEC CONTROL ERRORS RETURN"

JCLLIB  = USERID()××.ISPF.ISPPROF

USERHLQ = USERID()

"ALLOC DD(ISPFILE) DSN('"JCLLIB"') SHR REUSE"

"ISPEXEC VGET (STEPLIB CCSDAPPL)"
"ISPEXEC VGET (CCSDHLQ LLQCLIB LLQMLIB LLQPLIB LLQSLIB LLQTLIB LLQTABL)"
"ISPEXEC VGET (ACCOUNT CLASS MSGCLASS ISPFHLQ)"

"ISPEXEC FTCLOSE NAME(CICSJCL)"

"ISPEXEC FTOPEN"

if rc > 0
then do
  select
    when rc = 8
    then do
      MESS2 = "file tailoring already in progress"
    end
    when rc = 12
    then do
      MESS2 = "output file in use. ENQ failed"
    end
    when rc = 16
    then do
      MESS2 = "ISPFILE not allocated"
    end
    when rc = 20
    then do
      MESS2 = "severe error"
    end
    otherwise
  end
  MESS1 = "error FTOPEN"
  MESS3 = "returncode = " ×× rc
  MESS4 = "Procedur = CICSSUBP"
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC FTCLOSE"
  signal free_file
end

"ISPEXEC FTINCL CICSJCL"

if rc > 0
then do
  select
    when rc = 8
    then do
      MESS1 = "output skeleton not defined"
    end
    when rc = 12
    then do
      MESS1 = "output skeleton in use. ENQ failed"
    end
    when rc = 16
    then do
      MESS1 = "data truncation occured"
    end
    when rc = 20
    then do
      MESS1 = "severe error"
    end
    otherwise
  end
  MESS2 = "please contact system support"
  MESS3 = "skeleton = " ×× CICSJCL
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(COB0000)"
  "ISPEXEC FTCLOSE"
  "ISPEXEC REMPOP"
  signal ende
end

"ISPEXEC FTCLOSE NAME(CCSDJOB0)"

"ISPEXEC EDIT DATASET('"JCLLIB"(CCSDJOB0)')"

ende:
"ISPEXEC FTERASE CCSDJOB0"

free_file:
"FREE DD(ISPFILE)"

EXIT
./ ADD NAME=CICTRM00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTTERM"
"ISPEXEC TBOPEN CICTTERM NOWRITE"

call cictrm01 AL cictterm "all terminal entries"

"ISPEXEC TBEND CICTTERM"

exit
./ ADD NAME=CICTRM01 0100-2000023-2000023-1236-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICTRM01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrm01 cictrm01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICTRM02 KZ table CICTRM01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICTRM01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      term  = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(term) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'T' then call cictyp08 'TYPE' type group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICTRM02 0100-2000023-2000023-1236-00326-00326-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD programm information       */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
OP   = EQ
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictrm02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 cictrm02 cictrm02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=TE
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=TY
  when e = 4 THEN CSEL=NE
  when e = 5 THEN CSEL=CO
  when e = 6 THEN CSEL=AU
  when e = 7 THEN CSEL=SO
  when e = 8 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = TE
  then do
    CALL term_selection
    fieldn  = "TERM"
    fieldv  = trml
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = TY
  then do
    l       = "C"
    CALL type_selection
    fieldn  = "TYPE"
    fieldv  = typ
  end
  WHEN CSEL = NE
  then do
    CALL netn_selection
    fieldn  = "NETNAME"
    fieldv  = net
  end
  WHEN CSEL = CO
  then do
    fieldn  = "CONS"
    fieldv  = NO
    op      = 'NE'
  end
  WHEN CSEL = SO
  then do
    CALL sort_selection
    if e    = 1 then fieldn = 'GROUP'
    if e    = 2 then fieldn = 'TYPE'
    if e    = 3 then fieldn = 'NETNAME'
    "ISPEXEC TBSORT " table " FIELDS("fieldn",C,A,TERM)"
    ausw = 'Terminal sorted ' ×× fieldn
    call cictrm01 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(TERM)"
    signal start
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cictrn××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field","op")"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(TERM GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "terminal " fieldn " = " fieldv

call cictrm01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

term_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictrm03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrm02 cictrm03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',trml) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal term_selection
end
IF POS('*',trml) = 0
then do
  trml = trml ×× '*'
end

return

type_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictrm04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrm02 cictrm04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',typ) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal type_selection
end
IF POS('*',typ) = 0
then do
  typ  = typ  ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cicprg04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn02 cictrn04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

netn_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictrm05)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrm02 cictrm05 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',net) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal netn_selection
end
IF POS('*',net) = 0
then do
  net  = net ×× '*'
end

return

sort_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICTRM06)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrm02 cictrm06 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

return
./ ADD NAME=CICTRM09 0100-2000023-2000023-1236-00056-00056-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTTERM NOWRITE SHARE"
"ISPEXEC TBVCLEAR CICTTERM"

call value fieldn,fieldv

tabname = cictrmty

"ISPEXEC TBQUERY CICTTERM NAMES(TNAMES)"
"ISPEXEC TBSARG CICTTERM NEXT NAMECOND("fieldn",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(TERM GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN CICTTERM"
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = fieldn
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBEND CICTTERM"
"ISPEXEC TBTOP " tabname

ausw = "terminal " fieldn " = " fieldv

call cictrm01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICTRN00 0100-2000023-2000023-1236-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  cicttran"
"ISPEXEC TBOPEN cicttran NOWRITE"

call cictrn01 AL cicttran "all transaction entries"

"ISPEXEC TBEND cicttran"

exit
./ ADD NAME=CICTRN01 0100-2000023-2000023-1237-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(cictrn01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn01 cictrn01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    cictrn02 KZ table cictrn01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICTRN01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      tran = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(tran) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'P' then call cicprg09 program group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICTRN02 0100-2000023-2000023-1237-00321-00321-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD programm information       */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
OP   = EQ
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictrn02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 cictrn02 cictrn02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=TA
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=PR
  when e = 4 THEN CSEL=TW
  when e = 5 THEN CSEL=DB
  when e = 6 THEN CSEL=DA
  when e = 7 THEN CSEL=TU
  when e = 8 THEN CSEL=TC
  when e = 9 THEN CSEL=IS
  when e =10 THEN CSEL=ST
  when e =11 THEN CSEL=SO
  when e =12 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = TA
  then do
    CALL tran_selection
    fieldn  = "TRAN"
    fieldv  = tran
  end
  WHEN CSEL = PR
  then do
    CALL prog_selection
    fieldn  = "PROGRAM"
    fieldv  = prog
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = TW
  then do
    fieldn  = "TWASZ"
    fieldv  = 1
    op      = 'GE'
  end
  WHEN CSEL = DB
  then do
    fieldn  = "DLOC"
    fieldv  = BELOW
  end
  WHEN CSEL = DA
  then do
    fieldn  = "DLOC"
    fieldv  = ANY
  end
  WHEN CSEL = TU
  then do
    fieldn  = "DKEY"
    fieldv  = USER
  end
  WHEN CSEL = TC
  then do
    fieldn  = "DKEY"
    fieldv  = CICS
  end
  WHEN CSEL = IS
  then do
    fieldn  = "ISO"
    fieldv  = YES
  end
  WHEN CSEL = ST
  then do
    fieldn  = "STO"
    fieldv  = YES
  end
  WHEN CSEL = DY
  then do
    fieldn  = "DYN"
    fieldv  = YES
  end
  WHEN CSEL = SO
  then do
    CALL sort_selection
    if e    = 1 then fieldn = 'GROUP'
    if e    = 2 then fieldn = 'PROGRAM'
    if e    = 3 then fieldn = 'PROFILE'
    "ISPEXEC TBSORT " table " FIELDS("fieldn",C,A,TRAN)"
    ausw = 'transaction sorted ' ×× fieldn
    call cictrn01 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(TRAN)"
    signal start
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cictrn××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field","op")"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(TRAN GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "transaction " fieldn " = " fieldv

call cictrn01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

tran_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictrn04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn02 cictrn04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',tran) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal tran_selection
end
IF POS('*',tran) = 0
then do
  tran = tran ×× '*'
end

return

prog_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cicprg03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn02 cictrn03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',prog) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal prog_selection
end
IF POS('*',prog) = 0
then do
  prog = prog ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cicprg04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn02 cictrn04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

sort_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICTRN03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn02 cictrn03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

return
./ ADD NAME=CICTRN08 0100-2000023-2000023-1237-00056-00056-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

fieldv = strip(fieldv)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTTRAN NOWRITE SHARE"
"ISPEXEC TBVCLEAR CICTTRAN"

call value fieldn,fieldv

tabname = cictrnty

"ISPEXEC TBQUERY CICTTRAN NAMES(TNAMES)"
"ISPEXEC TBSARG CICTTRAN NEXT NAMECOND("fieldn",EQ)"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(TRAN GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN CICTTRAN"
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = 'Transaction'
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  exit
end

"ISPEXEC TBEND CICTTRAN"
"ISPEXEC TBTOP " tabname

ausw = "transaction " fieldn " = " fieldv

call cictrn01 kz tabname ausw

"ISPEXEC TBEND " tabname

exit
./ ADD NAME=CICTRN09 0100-2000023-2000023-1237-00046-00046-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG TRAN GROUP

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTTRAN NOWRITE SHARE"

"ISPEXEC TBGET CICTTRAN"
"ISPEXEC TBEND CICTTRAN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC ADDPOP"

display:
a = ' '
"ISPEXEC DISPLAY PANEL(CICTRN09)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn09 cictrn09 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC REMPOP"
  exit
end

signal display

EXIT
./ ADD NAME=CICTYP00 0100-2000023-2000023-1237-00019-00019-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
    trace ?r
*/

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC TBEND  CICTTYPE"
"ISPEXEC TBOPEN CICTTYPE NOWRITE"

call cictyp01 AL cicttype "all typeterm entries"

"ISPEXEC TBEND CICTTYPE"

exit
./ ADD NAME=CICTYP01 0100-2000023-2000023-1237-00076-00076-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table sel

"ISPEXEC CONTROL ERRORS RETURN"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

display:
a = ' '
"ISPEXEC TBDISPL " table " PANEL(CICTYP01)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictyp01 cictyp01 RC
  EXIT
end

IF ZCMD = SELECT
THEN DO
  zcmd  = ' '
  csel  = ' '
  CALL    CICTYP02 KZ table CICTYP01 sel
  "ISPEXEC VGET CSEL"
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

IF ZCMD = PL × CSEL = PL
THEN DO
  zcmd = ' '
  csel = ' '
  call cicp000 CICTYP01 table sel
  signal display
end

if rc > 0
then do
  exit
end

if rc = 0
then do
  IF SUBSTR(ZCMD,1,1) = 'F' × SUBSTR(ZCMD,1,1) = 'L'
  then do
    FI = LENGTH(ZCmd)
    IF FI < 3
    then DO
      "ISPEXEC SETMSG MSG(CICA001)"
      signal display
    END
    ELSE do
      type  = SUBSTR(ZCmd,3,FI-2)
      "ispexec tbtop " table
      "ispexec tbscan " table " arglist(type) condlist(ge)"
      signal display
    END
  END
  do while ztdsels > 0
    if a = 'T' then call cictrm09 'TYPE' type group
    signal display
  end
  signal display
end

EXIT
./ ADD NAME=CICTYP02 0100-2000023-2000023-1237-00305-00305-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : select cics CSD programm information       */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg kz table panel sel

"ISPEXEC CONTROL ERRORS RETURN"

CSEL = ""
"ISPEXEC VPUT CSEL"

START:
OP   = EQ
E     = '1'
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictyp02)"

IF RC = 12 × RC = 20
THEN do
  CALL cic0000 cictyp02 cictyp02 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  EXIT
end

"ISPEXEC REMPOP"

select
  when e = 1 THEN CSEL=TY
  when e = 2 THEN CSEL=GR
  when e = 3 THEN CSEL=DE
  when e = 4 THEN CSEL=SH
  when e = 5 THEN CSEL=US
  when e = 6 THEN CSEL=UT
  when e = 7 THEN CSEL=UC
  when e = 8 THEN CSEL=NU
  when e = 9 THEN CSEL=SO
  when e =10 THEN CSEL=PL
  otherwise
end

IF KZ = CSEL THEN EXIT

"ISPEXEC VPUT CSEL"

SELECT
  WHEN CSEL = "" THEN exit
  WHEN CSEL = PL THEN exit
  WHEN CSEL = TY
  then do
    CALL type_selection
    fieldn  = "TYPE"
    fieldv  = typ
  end
  WHEN CSEL = GR
  then do
    CALL group_selection
    fieldn  = "GROUP"
    fieldv  = group
  end
  WHEN CSEL = DE
  then do
    CALL dev_selection
    fieldn  = "DEVICE"
    fieldv  = dev
  end
  WHEN CSEL = SH
  then do
    fieldn  = "SHIP"
    fieldv  = YES
  end
  WHEN CSEL = US
  then do
    fieldn  = "USER"
    fieldv  = 1
    op      = 'GE'
  end
  WHEN CSEL = UC
  then do
    fieldn  = "UCTRAN"
    fieldv  = yes
  end
  WHEN CSEL = UT
  then do
    fieldn  = "UCTRAN"
    fieldv  = TRANID
  end
  WHEN CSEL = NU
  then do
    fieldn  = "UCTRAN"
    fieldv  = NO
  end
  WHEN CSEL = SO
  then do
    CALL sort_selection
    if e    = 1 then fieldn = 'GROUP'
    if e    = 2 then fieldn = 'DEVICE'
    if e    = 3 then fieldn = 'USER'
    "ISPEXEC TBSORT " table " FIELDS("fieldn",C,A,TYPE)"
    ausw = 'Typeterm sorted ' ×× fieldn
    call cictyp01 kz table ausw
    "ISPEXEC TBSORT " table " FIELDS(TYPE)"
    signal start
  end
  otherwise exit
END

"ISPEXEC TBVCLEAR " table

tabname = cictyp××csel
field   = fieldn

call value field,fieldv

"ISPEXEC TBQUERY" table " NAMES(TNAMES)"
"ISPEXEC TBSARG " table " NEXT NAMECOND("field","op")"

"ISPEXEC TBERASE " tabname
"ISPEXEC TBCREATE " TABNAME " KEYS(TYPE GROUP) NOWRITE NAMES"TNAMES

rc = 0
recfound = n

do while rc = 0
  "ISPEXEC TBSCAN " table
  if rc > 0 then leave
  "ISPEXEC TBADD " tabname " MULT(1000)"
  recfound = y
end

IF recfound = n
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "TYPETERM"
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND" tabname
  signal start
end

"ISPEXEC TBTOP " tabname

ausw = "Typeterm " fieldn " = " fieldv

call cictyp01 kz tabname ausw

"ISPEXEC TBEND " tabname

signal start

EXIT

type_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictrm04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictyp02 cictrm04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',typ) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal type_selection
end
IF POS('*',typ) = 0
then do
  typ  = typ  ×× '*'
end

return

group_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cicprg04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictrn02 cictrn04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',group) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal group_selection
end
IF POS('*',group) = 0
then do
  group = group ×× '*'
end

return

dev_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(cictyp03)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictyp02 cictyp03 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

IF POS('*',dev) = 1
then do
  "ispexec setmsg msg(cica001)"
  signal dev_selection
end
IF POS('*',dev) = 0
then do
  dev  = dev ×× '*'
end

return

sort_selection:
"ISPEXEC ADDPOP ROW(03) COLUMN(10)"
"ISPEXEC DISPLAY PANEL(CICTYP04)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictyp02 cictyp04 RC
  "ISPEXEC REMPOP"
  EXIT
end

IF ZCMD = TRACE
THEN DO
  zcmd = ' '
  trace ?r
end

IF RC = 8
THEN do
  "ISPEXEC REMPOP"
  signal start
end

"ISPEXEC REMPOP"

return
./ ADD NAME=CICTYP08 0100-2000023-2000023-1237-00071-00071-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG fieldn fieldv gr

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTTYPE NOWRITE SHARE"

ORC = RC

"ISPEXEC TBTOP CICTTYPE"
"ISPEXEC TBVCLEAR CICTTYPE"

call value fieldn,fieldv

"ISPEXEC TBSARG CICTTYPE NEXT NAMECOND("fieldn",EQ)"

rc = 0
recfound = n

"ISPEXEC TBSCAN CICTTYPE"

if rc > 0
THEN do
  MESS1 = "no rows with searchargument found"
  MESS2 = "TYPEterm"
  MESS3 = "searchargument " ×× fieldn " = " fieldv
  "ISPEXEC ADDPOP"
  "ISPEXEC DISPLAY PANEL(CIC0000)"
  "ISPEXEC REMPOP"
  "ISPEXEC TBEND CICTTYPE"
  exit
end

IF ORC = 0 THEN "ISPEXEC TBEND CICTTYPE"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC ADDPOP"

display:
a = ' '
"ISPEXEC DISPLAY PANEL(CICTYP09)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictyp09 cictyp09 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC REMPOP"
  exit
end

signal display

EXIT
./ ADD NAME=CICTYP09 0100-2000023-2000023-1237-00051-00051-00000-FRALBER
/*--- REXX -------------------------------------------*/
/*
   TRACE ?R
*/

ARG TYPE GROUP

type   = strip(type)
group  = strip(group)

"ISPEXEC CONTROL ERRORS RETURN"

"ISPEXEC TBOPEN CICTTYPE NOWRITE SHARE"

orc = rc

"ISPEXEC TBGET CICTTYPE"
IF ORC = 0 THEN "ISPEXEC TBEND CICTTYPE"

/*------------------------------------------------------------*/
/*   table information                                        */
/*------------------------------------------------------------*/

"ISPEXEC ADDPOP"

display:
a = ' '
"ISPEXEC DISPLAY PANEL(CICTYP09)"

IF RC = 12 × RC = 20
THEN do
  CALL CIC0000 cictyp09 cictyp09 RC
  EXIT
end

IF ZCMD = TRACE × CSEL = TR
THEN DO
  zcmd = ' '
  csel = ' '
  trace ?r
end

if rc > 0
then do
  "ISPEXEC REMPOP"
  exit
end

signal display

EXIT
./ ADD NAME=CIC0000  0100-2000023-2000023-1237-00024-00024-00000-FRALBER
/*-------- REXX -------------------------------------------*/
/* Function   : display information for panel error        */
/* callers    : hics/sis/cics application                  */
/*---------------------------------------------------------*/
/*
   TRACE ?R
*/

arg procname panel disrc

"ISPEXEC CONTROL ERRORS RETURN"

MESS1 = 'panel display/query error in procedur '
MESS2 = procname
MESS3 = 'panel name '
MESS4 = panel
MESS5 = 'returncode'
MESS6 = disrc

"ISPEXEC ADDPOP"
"ISPEXEC DISPLAY PANEL(CIC0000)"
"ISPEXEC REMPOP"

exit

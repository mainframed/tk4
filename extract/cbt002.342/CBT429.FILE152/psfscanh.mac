//HPZ$H   JOB ,ZBIEGIEN,MSGCLASS=W,CLASS=3
/*JOBPARM ROOM=3426
//* LOAD A CODE PAGE TO THE SAS FILE
//* THE DD NAME OF THE SAS FILE IS CHAR
//A EXEC SAS@
//CHAR DD DSN=HPZ.SAS.CHARSET,DISP=OLD
//TRANS DD DSN=SYS1.FONTLIB(T1D0BASE),DISP=SHR
 /* LOAD A CODE PAGE TO THE SAS FILE  SOME OF THE CODE IS NOT NEEDED
 /* THIS PROGRAM WAS CLONED FROM A MAP AND PRINT PROGRAM */;
OPTIONS GEN=0;
DATA CHAR.TRANSHDR(KEEP=CDPOINTS DEFAULTG
                        DVALID DPRINT DINCR VARBSPAC)
     CHAR.TRANSCHR(KEEP=CHARID CVALID CPRINT CINCR CDPOINT);
RETAIN CDPOINTS 0;
INFILE TRANS STOPOVER;
INPUT @4 ID $CHAR3. @ /* READ ID */;
IF ID ='D3A887'X OR ID= 'D3A987'X THEN RETURN; /* START AND END */;
IF ID='D3EEEE'X THEN RETURN ; /* NOOP RECORD */;
IF ID='D3A687'X THEN DO /* CODE PAGE DESCRIPTOR */;
 INPUT @46 CDPOINTS PIB2.;
END;
IF ID='D3A787'X THEN DO /* CODE PAGE CONTROL */;
 INPUT @10 DEFAULTG $CHAR8.
           FLG1 $CHAR1.
       @22 FLG2 $CHAR1.;
 IF FLG1 ='0... ....'B THEN DVALID='Y';
                       ELSE DVALID='N';
 IF FLG1 ='.0.. ....'B THEN DPRINT='Y';
                       ELSE DPRINT='N';
 IF FLG1 ='..0. ....'B THEN DINCR='Y';
                       ELSE DINCR='N';
 IF FLG2 ='.... 0...'B THEN VARBSPAC='Y';
                       ELSE VARBSPAC='N';
 OUTPUT CHAR.TRANSHDR;
END;
IF ID='D38C87'X THEN DO /* CODE PAGE INDEX */;
 X=0;
 DO I=0 TO (CDPOINTS-1);
  PT=10+(I*10);
  INPUT @PT        CHARID $CHAR8.
                   CFLAG $CHAR1.
                   CDPOINT $CHAR1. @;
  IF CFLAG='0... ....'B THEN CVALID='Y';
                        ELSE CVALID='N';
  IF CFLAG='.0.. ....'B THEN CINCR='Y';
                        ELSE CINCR='N';
  IF CFLAG='..0. ....'B THEN CPRINT='Y';
                        ELSE CPRINT='N';
  PT2=X*33+1;
  FORMAT CDPOINT $HEX2.;
  OUTPUT CHAR.TRANSCHR;
 END;
END;

PROC PRINT DATA=CHAR.TRANSHDR;
PROC PRINT DATA=CHAR.TRANSCHR;

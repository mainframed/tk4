         PUNCH ' MODE AMODE(ANY),RMODE(24)'
AGGETVLI START
* UPDATED 7/89 BY H. ZBIEGIEN TO MAKE 31 BIT COMPATIBLE
* CHANGED JANUARY, 1990 BY H. ZBIEGIEN
*   PUT PUNCH CARD IN TO DOCUMENT THE LOAD MODULE MODE
AGGETVLI  AMODE ANY
AGGETVLI  RMODE ANY
         USING *,15          SET BASE
         STM   2,3,SAVE      SAVE REGISTERS
         LM    2,3,0(1)      GET ADD OF REC, ADD OF RESULT
         S     2,=F'4'       GET TO VLI
         MVC   0(2,3),0(2)   MOVE VLI, 2 BYTES
         LM    2,3,SAVE      RESTORE REGISTERS
         SR    15,15         SET RETURN CODE TO ZERO
         BR    14            RETURN
         DC    C'AGGETVLI&SYSDATE&SYSTIME'
SAVE     DC    2F'0'         SAVE AREA
*
*     GET  THE VLI AND RETURN IT TO COBOL
*
*     SAMPLE COBOL CALL:
*
*          CALL 'AGGETVLI' USING VAR-REC, WS-RESULT.
*
*          WS-RESULT         PIC S9(4) COMP SYNC.
*
         END

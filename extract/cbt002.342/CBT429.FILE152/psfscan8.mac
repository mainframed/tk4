//HPZ$U2 JOB ,ZBIEGIEN,MSGCLASS=W,CLASS=3
/*JOBPARM ROOM=3426
//A EXEC PGM=AGCGENER
//SYSPRINT DD SYSOUT=W
//SYSUT2 DD DSN=&&TEMP,DISP=(,PASS,DELETE),UNIT=DISK,
// DCB=(LRECL=8205,RECFM=VBM,BLKSIZE=8209),
// SPACE=(CYL,(5,5))
//SYSUT1 DD DSN=SYS1.FONTLIB(C1D0GB10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GB12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GC15),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GI12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GP12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GR10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GT10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GT12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GT15),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GT18),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GT20),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0GT24),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0RT10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0SB12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0SI10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0SI12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0SO12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0ST10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0ST12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1D0ST15),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0DUMP),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0FM10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0FM12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0FM15),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0GU10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0GU12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0GU15),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0KATA),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L0TU10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L00AOA),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L00AON),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L00BOA),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L00BON),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L00GSC),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L00GUC),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L00OAB),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1L00T11),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0AE10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0AE20),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0BITR),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0BRTR),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0CE10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0CE12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0CH10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0CI10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0CO10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0CR10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0DOTR),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0EBTR),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0EITR),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0ELTR),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0EOTR),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0ESTR),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0LB12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0LR12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0OB10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0OR10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0PB12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0PI12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0PR10),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0PR12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0SR12),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0S192),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0S193),DISP=SHR
// DD DSN=SYS1.FONTLIB(C1S0S198),DISP=SHR
//B EXEC SAS@
//OUT DD SYSOUT=W
//CHARS DD DSN=&&TEMP,DISP=(OLD,DELETE,DELETE)
OPTIONS GEN=0;
 /* PRINT OUT INFO ABOUT THE CHARACTER SETS */;
DATA _NULL_;
RETAIN CODES 0;
FILE OUT PRINT;
IF _N_ =1 THEN DO;
PUT 'PNT=POINTS, ITA=ITALIC, UNS=UNDERSCORE, OVS=OVERSTRIKE, '
    'LCH=LOWER CASE HEIGHT, UCH=UPPERCASE HEIGHT, MXA=MAX ASCENDER';
PUT 'MXD=MAX DESCENDER, UIO=UNIFORM INLINE OFFSET, UBO=UNIFORM BASE'
    ', MCI=MACH CHAR INCR, VSI=VARIABLE SPACE INCREMENT, MXB=MAX BASE';
PUT 'EM=EM SPACE, FS=FIGURE SPACE, DFB=DEFAULT BASE, CHAR=# OF CHARACT'
    'ERS, INCR=UNIFORM SPACE, PATTSP=BYTES IN RASTER, KRN=KERNING' /;
PUT '    NAME   WEIGHT    WIDTH PNT ITA UNS OVS  LCH UCH MXA MXD'
    ' UIO UBO MCI VSI MBS  EM  FS DFB CHAR     INCR PATTSP KRN';
END;
INFILE CHARS STOPOVER;
INPUT @4 ID $CHAR3. @ /* READ ID */;
IF ID ='D3A889'X OR ID= 'D3A989'X THEN RETURN;
IF ID='D3EEEE'X THEN DO /* NOOP RECORD */;
 INPUT @2 LEN PIB2. @;
 LEN=LEN-8;
 INPUT @36 SETNAME $CHAR8.
       @10 COMMT $VARYING132. LEN;
 PUT SETNAME @;
 RETURN;
END;
IF ID='D3A689'X THEN DO /* FONT DESCRIPTOR */;
 INPUT @ 10 TYPEFACE $CHAR32.
            WEIGHT $CHAR1.
            WIDTH $CHAR1.
         +2 POINTS PIB2.1
        +10 DIRECTN $CHAR2.
        +4  ROTATN  $CHAR2.
        +8 FLG $CHAR1.
        +4 UWIDTH IB2.
           UPOS   IB2.;
 IF DIRECTN='0000'X THEN XDIR='ACROSS';
 ELSE IF DIRECTN='2D00'X THEN XDIR='DOWN  ';
                         ELSE XDIR='UP    ';
 IF      ROTATN='0000'X THEN XROT='  0';
 ELSE IF ROTATN='2D00'X THEN XROT=' 90';
 ELSE IF ROTATN='5A00'X THEN XROT='180';
 ELSE                        XROT='270';
 IF FLG='0... ....'B THEN ITALIC=' NO';
                     ELSE ITALIC='YES';
 IF FLG='.0.. ....'B THEN UNDERS=' NO';
                     ELSE UNDERS='YES';
 IF FLG='.... 0...'B THEN OVERS=' NO';
                     ELSE OVERS='YES';
 IF      WEIGHT='01'X THEN XWEIGHT='ULTRA-LIGHT';
 ELSE IF WEIGHT='02'X THEN XWEIGHT='EXTRA-LIGHT';
 ELSE IF WEIGHT='03'X THEN XWEIGHT='LIGHT      ';
 ELSE IF WEIGHT='04'X THEN XWEIGHT='SEMI-LIGHT ';
 ELSE IF WEIGHT='05'X THEN XWEIGHT='MEDIUM     ';
 ELSE IF WEIGHT='06'X THEN XWEIGHT='SEMI-BOLD  ';
 ELSE IF WEIGHT='07'X THEN XWEIGHT='BOLD       ';
 ELSE IF WEIGHT='08'X THEN XWEIGHT='EXTRA-BOLD ';
 ELSE IF WEIGHT='09'X THEN XWEIGHT='ULTRA-BOLD ';
 IF      WIDTH= '01'X THEN XWIDTH='ULTRA-CONDENSED';
 ELSE IF WIDTH= '02'X THEN XWIDTH='EXTRA-CONDENSED';
 ELSE IF WIDTH= '03'X THEN XWIDTH='CONDENSED      ';
 ELSE IF WIDTH= '04'X THEN XWIDTH='SEMI-CONDENSED ';
 ELSE IF WIDTH= '05'X THEN XWIDTH='MEDIUM         ';
 ELSE IF WIDTH= '06'X THEN XWIDTH='SEMI-EXPANDED  ';
 ELSE IF WIDTH= '07'X THEN XWIDTH='EXPANDED       ';
 ELSE IF WIDTH= '08'X THEN XWIDTH='EXTRA-EXPANDED ';
 ELSE IF WIDTH= '09'X THEN XWIDTH='ULTRA-EXPANDED ';
 PUT @10       XWEIGHT       @19  XWIDTH    @27         POINTS 4.1
     @33         ITALIC @37             UNDERS @41        OVERS @;
END;
IF ID='D3AC89'X THEN DO /* FONT CHARACTER POSITION */;
 INPUT @12 LCASEH IB2.
           UCASEH IB2.
           MASCEND   IB2.
           MDESCEND  IB2.;
 PUT @45                 LCASEH  3.    @49             UCASEH  3.
            @53            MASCEND    3. @57     MDESCEND 3. @;
END;
IF ID='D3A789'X THEN DO /* FONT CONTROL */;
 INPUT @12 CID $CHAR1.
           FLG $CHAR1.
        +6 MAXBOXW IB2.
           MAXBOXH IB2.
        +3 PATTRNC IB3.
           INLNOFF IB2.;
 IF FLG='.... .0..'B THEN KERNING='NOT ALLOWED';
                     ELSE KERNING='ALLOWED    ';
 IF FLG='.... ..0.'B THEN BOXSIZE='VARIABLE';
                     ELSE BOXSIZE='UNIFORM ';
 PUT @114       KERNING
                                 @107                  PATTRNC 6.
     @61                      INLNOFF 3. @;
END;
IF ID='D3AE89'X THEN DO /* FONT ORIENTATON */;
 INPUT @10 TEXTOR $CHAR4.
           UBASEOFF IB2.
           MAXCHARI IB2.
           VARINCR  IB2.
           MAXBASEE IB2.
           FLG      $CHAR1.
       +1  EMSPACE  IB2.
       +2  FIGSPACE IB2.
       +2  BASEINCR IB2.;
 IF FLG='.... ...0'B THEN XVAR='EACH   ';
                     ELSE XVAR='UNIFORM';
 IF      TEXTOR='00002D00'X THEN XTEXT='  0, 90';
 ELSE IF TEXTOR='2D005A00'X THEN XTEXT=' 90,180';
 ELSE                            XTEXT='270,  0';
 PUT                           @65                      UBASEOFF 3.
     @69                           MAXCHARI 3.
  @73
  VARINCR 3.  @77                 MAXBASEE 3. @98 XVAR @81
  EMSPACE 3. @85            FIGSPACE 3.        @89
     BASEINCR @;
END;
IF ID='D38C89'X THEN DO /* FONT INDEX */;
 INPUT @2 LEN IB2. @;
 CHARS= ((LEN-8)/24)   /* TAKE OFF 8 BYTE HEADER, EACH ENTRY 24 BYTES
                        */;
 PUT @93              CHARS 4.  ;
 PT3=0;
 ARRAY CADDS(X) ADDD1-ADDD256;
 RETAIN ADDD1-ADDD256;
 DO I=0 TO (CHARS-1);
  PT=10+(I*24);
  INPUT @PT        CHARID $CHAR8.
                   CINCR IB2.
                   CWIDTH IB2.
                   CHEIGTH IB2.
                   CADD   IB4.
                   ASPACE IB2.
                   BSPACE IB2.
                   CSPACE IB2. @;
  X=I+1; CADDS=CADD*8;
  PT2=PT3*33+1;
 END;
END;

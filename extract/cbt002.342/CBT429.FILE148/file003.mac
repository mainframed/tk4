./       ADD   NAME=GENABEND

AUTHOR.jGEOFFREY MCINTYRE.:0ð400 DATE-WRITTEN.éDECEMBER 1987.Æ:0j50
OMPILED.Ñ:0b600¤:0q700 ENVIRONMENT DIVISION.Ë:0r800 CONFIGURATION SEC
0‘900 SOURCE-COMPUTER. IBM-370.ô001000 OBJECT-COMPUTER. IBM-370.e00110
üm001200 DATA DIVISION.Ñ’001300 WORKING-STORAGE SECTION.Èe001400¤h001500
ND-REPORT-LINES.Ée001600¦a05¯ABEND-LINE-1pPIC X(49) VALUE ALL '*'.²e00
¯ABEND-LINE-2êPIC X(49) VALUEe001800©a'*b*'.e001900¦a05¯ABEND-LINE
X(48) VALUEe002000©a'*~YOU HAVE INVOKED AN ABEND ROUTINE.°b*'.e002100
END-LINE-4êPIC X(49) VALUEe002200©a'*~BELOW YOU WILL FIND THE FOLLOWI
e002300¦a05¯ABEND-LINE-5êPIC X(49) VALUEe002400©a'*w1) THE FUNCTION
AT TIME OF ABEND	b*'.e002500¦a05¯ABEND-LINE-6êPIC X(49) VALUEe002600
 THE RETURN CODE OF THE FUNCTION CALLEDb*'.e002700¦a05¯ABEND-LINE-7ê
) VALUEe002800©a'*y4) THE ABEND MESSAGE (A BRIEF DESCRIPTIONb*'.e002
¯ABEND-LINE-8êPIC X(49) VALUEe003000©a'*¦wOF WHAT WAS GOING ON AT THE
THEb*'.e003100¦a05¯ABEND-LINE-9êPIC X(49) VALUEe003200©a'*¦fABEND.)
03300¦a05èABEND-LINE-10§êPIC X(49) VALUEe003400©­'* CHECK YOUR ISPF-LO
RTHER DETAILS.	b*'.e003500¦a05èABEND-LINE-11§pPIC X(49) VALUE ALL '*'.
¦a05éABEND-LINE-12.e003700©a10eFILLER°êPIC X(20) VALUEe003800j'1) A
CTIONa'.
e003900©a10éABEND-FUNCTIONhPIC X(8).Áe004000¦a05éABEND-LINE
4100©a10eFILLER°õPIC X(14) VALUE '2) RETURN CODE'.e004200©a10eFILLER°
1) VALUE SPACES.
e004300©a10iABEND-CODE	hPIC X(4).Áe004400¦a05éABEND-L
e004500©a10eFILLER°êPIC X(20) VALUEe004600ð'4) ABEND MESSAGEa'.
e004
èABEND-MESSAGEiPIC X(50).e004800¦a05éABEND-LINE-15.e004900©a10eFILL
X(20) VALUEe005000é'5) MISC. INFO§a'.
e005100©a10iABEND-MISC	iPIC X(2
200 77¯ISPF-SERVICE·gPIC X(8)èVALUE SPACES.©h005300 77®ISPF-MSG-IDgP
èVALUE SPACES.©e005400¦dSKIP3üo005500 LINKAGE SECTION.Îe005600¤h005700 0
END-CALL-PARAMETERS.Æe005800¦a05ðGENABEND-FUNCTION±hPIC X(8).¸e005900¦a
BEND-CODEhPIC 9(4).¸e006000¦a05ìGENABEND-MESSAGEiPIC X(50).e006100¦a
BEND-MISCiPIC X(20).e006200¦dEJECTüq006300 PROCEDURE DIVISIONdUSINGq
-CALL-PARAMETERS.²e006400¦dSKIP2üf006500 :0h-PROCESS.Òe006600¤e006700¦y
ABEND-FUNCTION TO ABEND-FUNCTION.¸e006800¦jMOVE GENABEND-CODE°éTO ABEND-
06900¦wMOVE GENABEND-MESSAGE TO ABEND-MESSAGE.e007000¦jMOVE GENABEND-MI
BEND-MISC.e007100¤e007200¦mDISPLAY ABEND-LINE-1.e007300¦mDISPLAY ABEND
e007400¦mDISPLAY ABEND-LINE-3.e007500¦mDISPLAY ABEND-LINE-4.e007600¦m
ABEND-LINE-5.e007700¦mDISPLAY ABEND-LINE-6.e007800¦mDISPLAY ABEND-LINE
900¦mDISPLAY ABEND-LINE-8.e008000¦mDISPLAY ABEND-LINE-9.e008100¦nDISPL
-LINE-10.e008200¦nDISPLAY ABEND-LINE-11.e008300¦nDISPLAY ABEND-LINE-12
0¦nDISPLAY ABEND-LINE-13.e008500¦nDISPLAY ABEND-LINE-14.e008600¦nDISPL
-LINE-15.e008700¤e008800¦¯MOVE 'SETMSGj' TO ISPF-SERVICE.Âe008900¦’MOV
02 ' TO ISPF-MSG-ID.
e009000¦lCALL 'ISPLINK' USING¯ISPF-SERVICE¯ISPF-M
009100¤f009200*nIF RETURN-CODE NOT = 0f009300*’12 - MESSAGE COULD NOT
Df009400*ð20 - SEVERE ERRORf009500*éNEXT SENTENCE.e009600¤e009700¦h
G¦j' TO ISPF-SERVICE.Âe009800¦’MOVE 'ISRZ002 ' TO ISPF-MSG-ID.
e009900¦l
PLINK' USING¯ISPF-SERVICE¯ISPF-MSG-ID.²a01:0¤f010100*nIF RETURN-CODE
f010200*ð20 - SEVERE ERRORf010300*éNEXT SENTENCE.e010400¤f010500 :
-EXIT.Îe010600¦fGOBACK.ÿ
./       ADD   NAME=PANBSTBL

AUTHOR.jGEOFFREY MCINTYRE.:0c400*uComputer Operations Technical Supp
500*óFirst Security Service Company¸:0c600*ó260 N. Charles Lindbergh
0c700*jSalt Lake City, UTd84116½:0c800*é(801) 350-6519Æ:0ð900 DATE-
êAPRIL 26, 1989.Åm001000 DATE-COMPILED.Ñê001100*REMARKS. f001200*eINPU
RINT OUTPUT OF PAN#2 ++PRINT SUPERSET,SUBSETf001300*ŸPROCESS: EXTRACT
FIELDS OF EACH INPUT RECORD.f001400*fOUTPUT:öAN ISPF TABLE OF SUPERSE
BSET ENTRIES.e001500:„*	f001600*jMAINTENANCE NOTES:èC A U T I O Nb!
0*¦«× WHEN ADDING OR DELETING AN ISPF-VARIABLE, YOU MUST ALSO±f001800*¦ð
 4 LISTS:ðISPF-LENGTH-LIST,f001900*¦ç×jISPF-NAME-VDEFINE,»f002000*¦ç×
ARIABLE-LIST, ANDf002100*¦ç×ðISPF-FORMAT-LIST.f002200*¦ç×ƒf002300*¦ç×
LISTS ARE POSITIONAL, SO BE CAREFUL!f002400*¦ç×µTHE VARIABLES ARE LIST
PHABETICAL ORDER, SO YOU¦f002500*¦ç×ŸOUGHT TO KEEP IT THAT WAY TO MAKE
NCE EASIER.	f002600*¦ç×zSORRY, IF YOU DON'T LIKE IT, WRITE TO IBM.f002
f002800*¦¼× YOU MUST ALSO ADJUST THE ISPF-NAME-CNT FIELD TO REFLECT THE§
¦r× NEW NUMBER OF VARIABLES.§ç<:=
003300 ENVIRONMENT DIVISION.Ë‘003400 CONFIGURATION SECTION.ô003500 SOUR
TER. IBM-370.ô003600 OBJECT-COMPUTER. IBM-370.ò003700 INPUT-OUTPUT SEC
03800 FILE-CONTROL.Òe003900¦­SELECT SYSPRINT-IN ASSIGN TO UT-S-SYSPRINT.
 DATA DIVISION.Ñl004100 FILE SECTION.Òh004200 FD®SYSPRINT-INÐe004300¦pB
TAINS 0 RECORDSÇe004400¦ñLABEL RECORDS ARE STANDARD.Äh004500 01kPAN-DIR
NTRY®PIC X(121).
e004600¤e004700¦dEJECTü’004800 WORKING-STORAGE SECTION
0¤h005000 01eFILLERhPIC X(44)·e005100	ŸVALUE 'PROGRAM PANBSTBL WORKING
 BEGINS HERE'.e005200¤h005300 01qGENABEND-CALL-PARAMETERS.Æe005400¦a05
ND-FUNCTIONiPIC X(08).e005500¦a05èGENABEND-CODEiPIC 9(04).e005600¦a
BEND-MESSAGEiPIC X(50).e005700¦a05èGENABEND-MISCiPIC X(20).e005800¤
01éEND-OF-FILE-SW
lPIC X(01) VALUE 'N'.e006000¦a88®END-OF-FILE»iVALUE
06100¤h006200 01êSYSPRINT-IN-WS.e006300¦a05eFILLERnPIC X(01) VALUE S
06400¦a05iPANMEM-WS.Íe006500©a10hSUBSET-SWiPIC X(01).e006600a88eSU
LUE '.'.e006700©a10®SUBSET-NAMEoPIC X(10) VALUE SPACES.°e006800a88®
NESkVALUE 'IRST SECUR'.°e006900a88®END-OF-LISTkVALUE 'IBRARY TOT'.°e
05eFILLERoPIC X(02) VALUE SPACES.°e007100¦a05iPANMAIN-WS
oPIC X(08) V
CES.°e007200¦a05eFILLERoPIC X(01) VALUE SPACES.°e007300¦a05iPANSIZE-W
(06) VALUE SPACES.°e007400¦a05eFILLERoPIC X(92) VALUE SPACES.°e007500¤
 DEFINE DIALOG SERVICE TYPES FOR CALLS TO ISPF.h007700 01gCONTROLEñPI
VALUE 'CONTROL '.h007800 01eERRORSoPIC X(08) VALUE 'ERRORSa'.h00790
TURNEoPIC X(08) VALUE 'RETURNa'.h008000 01dTBADD²nPIC X(08) VALUE 'T
h008100 01gTBCREATEñPIC X(08) VALUE 'TBCREATE'.h008200 01fVDEFINEñ
) VALUE 'VDEFINE '.h008300 01fVDELETEñPIC X(08) VALUE 'VDELETE '.h00
eVRESEToPIC X(08) VALUE 'VRESETa'.e008500¤µ008600* WORKING-STORAGE FI
 ISPF SERVICE CALLS.h008700 01éISPF-KEY-LIST.Íe008800¦a05éISPF-KEY-CO
 9(06) COMP VALUE ZEROES.e008900¦a05eFILLERòPIC 9(06) COMP VALUE ZERO
000¦a05gISPF-KEY©qOCCURS 2 TIMES PIC X(08).h009100 01¯ISPF-OPTION1oP
 VALUE SPACES.h009200 01¯ISPF-OPTION2oPIC X(08) VALUE SPACES.h009300
F-ORDERoPIC X(08) VALUE SPACES.h009400 01êISPF-ROWS-ADDEDqPIC 9(06)
UE 150.h009500 01êISPF-TABLE-NAMEoPIC X(08) VALUE SPACES.h009600 01
EFINE-OPTIONqPIC X(06) VALUE '(LIST)'.e009700¤D009800* ISPF-LENGTH-LIS
S THE CONTENT LENGTH OF EACH VARIABLE.±h009900 01ðISPF-LENGTH-LIST.Ëa01
eFILLERõPIC 9(06) COMP VALUE 08. PANMAIN e010100¦a05eFILLER’PIC 9(06)
LUE 10. PANMEMe010200¦a05eFILLERõPIC 9(06) COMP VALUE 06. PANSIZE e01
eFILLER’PIC 9(06) COMP VALUE 10. PANSUBe010400¤e010500: *©f010600*³I
-LIST IS USED BY MANY VARIABLE AND TABLE SERVICES *©f010700*zTO SPECIFY
E(S) OF VARIABLES: THESEç*©f010800*uMAY BE DIALOG VARIABLES, NON-KEY N
010900*xVARIABLES FOR TABLES, OR EXTENSION TABLE¦ç*©f011000*iVARIABLES
1100: *©h011200 01êISPF-NAME-LIST.e011300¦a05êISPF-NAME-COUNT§òPIC 9(
 VALUE ZEROES.e011400¦a05eFILLERòPIC 9(06) COMP VALUE ZEROES.e011500
PF-NAME	êOCCURS 20 TIMESiPIC X(08).e011600¤e011700: *©F011800* ISPF-NA
NE IS A LIST OF VARIABLES TO BE DEFINED IN THE *©f011900*mCOMMON AREA (
ç*©e012000: *©h012100 01jISPF-NAME-VDEFINE.e012200¦a05èISPF-NAME-CNT
06) COMP VALUE 4.°e012300¦a05eFILLERòPIC 9(06) COMP VALUE ZEROES.e012
eFILLERñPIC X(08) VALUE 'PANMAIN '.e012500¦a05eFILLERoPIC X(08) VALU
Ma'.e012600¦a05eFILLERñPIC X(08) VALUE 'PANSIZE '.e012700¦a05eFILL
X(08) VALUE 'PANSUBa'.e012800¤e012900: *©f013000*žISPF-VARIABLE-LIST
BY THE VDEFINE SERVICE TO§ç*©f013100*
zIDENTIFY THE VARIABLE(S) WHOSE ST
*©f013200*
zTO BE USED. EACH VARIABLE HERE CORRESPONDS©f013300*
vBY POSI
AN ISPF VARIABLE IN THEç*©f013400*
sNAME LIST, SO THERE MUST BE AS MANY
500*
wVARIABLE NAMES AS THERE ARE ISPF NAMES.ç*©e013600: *©h013700 01k
IABLE-LIST.Ée013800¦a05fPANMAINoPIC X(08) VALUE SPACES.°e013900¦a05eP
IC X(10) VALUE SPACES.°e014000¦a05fPANSIZEnPIC X(06) VALUE SPACE.±e014
ePANSUBoPIC X(10) VALUE SPACES.°e014200¤e014300: *©H014400* ISPF-FORMAT
S AS MANY FILLERS AS THERE ARE VARIABLES BEING§f014500*gDEFINED.f01460
00* NOTE: WHEN THE VARIABLE NEEDS TO BE NUMERIC, USE 'FIXED'f014800*§yT
THE FIELD TO BE RIGHT JUSTIFIED.éOTHERWISE, THE©f014900*§³FIELD WILL BE
 AS A CHARACTER FIELD (LEFT JUSTIFIED).	f015000*§zTHE FIELD MUST NOT BE
HAN 4 BYTES.eA ZEROf015100*§mIS REPRESENTED AS X'8:§0~'. DEFINE THE FI
(08) COMP.f015200*§h(BINARY).Îe015300: *©h015400 01ðISPF-FORMAT-LIST.Ë
a05eFILLERoPIC X(08) VALUE 'CHAR'.gPANMAIN e015600¦a05eFILLERoPIC X
UE 'CHAR'.ePANMEMe015700¦a05eFILLERoPIC X(08) VALUE 'CHAR'.gPANSIZE
¦a05eFILLERoPIC X(08) VALUE 'CHAR'.ePANSUBe015900¤h016000 01eFILLER
42)·e016100	VALUE 'PROGRAM PANBSTBL WORKING-STORAGE ENDS HERE'.e016200
 PROCEDURE DIVISION.e016400¤f016500 :0i-MAINLINE.Ñe016600¤e016700¦öCAL
NK' USING CONTROLE ERRORS RETURNE.·e016800¤e016900¦lPERFORM 0005-VDEFINE
005-EXIT.e017000¤e017100¦qPERFORM 0010-DEFINE-TABLEêTHRU 0010-EXIT.e0
17300¦oOPEN INPUT SYSPRINT-IN.e017400¤e017500¦pPERFORM 0100-BUILD-TABLE
100-EXITe017600jUNTIL END-OF-FILE.Åe017700¤e017800¦jCLOSE SYSPRINT-IN.
¤e018000¦cMOVEç1©kTO ISPF-NAME-COUNT.Àe018100¦fMOVE '*§j' TO ISPF-NAME(
200¦lCALL 'ISPLINK' USINGfVDELETE§êISPF-NAME-LIST.f018300*nIF RETURN-
 = 0f018400*±s8 - AT LEAST ONE VARIABLE NOT FOUNDf018500*°ð20 - SEVERE
018600*éNEXT SENTENCE.e018700¤e018800¦òCALL 'ISPLINK' USING VRESET.Ãe0
19000¦hSTOP RUN.Òe019100¤f019200 :0e-EXIT.Óe019300¦dEXIT.üe019400¦dEJEC
0¤l019600 0005-VDEFINE.Òe019700¤f019800*«CALL VDEFINE TO DEFINE DIALOG
 VARIABLES TO ISPF.e019900¤a02:0¦òCALL 'ISPLINK' USING VDEFINEðISPF-N
INEe020100jISPF-VARIABLE-LISTìISPF-FORMAT-LISTe020200ìISPF-LENGTH-L
F-VDEFINE-OPTION.e020300¤e020400¦jIF RETURN-CODE > 8f020500*±n8 - VARI
 FOUNDf020600*°‘16 - DATA TRUNCATION OCCURREDÀf020700*°ð20 - SEVERE ERR
00©ìMOVE RETURN-CODEìTO GENABEND-CODE»e020900©éMOVE 'VDEFINE'lTO GENAB
TIONe021000©÷MOVE 'UNABLE TO DEFINE (A) VARIABLE(S) TO ISPF'e021100kT
ND-MESSAGE¸e021200©tMOVE '0005-VDEFINE' TO GENABEND-MISCºe021300©gPERFOR
SPF-ABENDdTHRU :9e-EXIT.e021400¤ð021500 0005-EXIT.Óe021600	dEXIT.Óe02
ECTüe021800¤q021900 0010-DEFINE-TABLE.Íe022000¤õ022100* HERE WE DEFINE T
.e022200¤e022300¦¯MOVE 'PANSUBm' TO ISPF-TABLE-NAME.Àe022400¦fMOVE 02©
-KEY-COUNT.e022500¦¯MOVE 'PANMEMð' TO ISPF-KEY(1).
e022600¦¯MOVE 'PANS
 ISPF-KEY(2).
e022700¦fMOVE 02©kTO ISPF-NAME-COUNT.Àe022800¦ôMOVE 'PANMA
ISPF-NAME(1).Âe022900¦ôMOVE 'PANSIZE ' TO ISPF-NAME(2).Âe023000¦ôMOVE 'N
 TO ISPF-OPTION1.Âe023100¦ôMOVE 'REPLACE ' TO ISPF-OPTION2.Âe023200¦lCAL
NK' USINGgTBCREATE	êISPF-TABLE-NAMEe023300òISPF-KEY-LIST ISPF-NAME-LI
00¯ISPF-OPTION1èISPF-OPTION2.e023500¤e023600¦ôIF RETURN-CODE IS GREAT
4Âf023700*±œ4 - DUPLICATE TABLE EXISTS BUT "REPLACE" SPECIFIEDf023800*±
LE ALREADY EXISTS; "REPLACE" NOT SPECIFIEDf023900*°‘12 - TABLE IN USE;
EDÀf024000*°ž16 - WRITE MODE SPECIFIED AND TABLE INPUT LIBRARY IS±f02410
ALLOCATEDÇf024200*°ð20 - SEVERE ERRORe024300©ìMOVE RETURN-CODEìTO GENA
E»e024400©êMOVE 'TBCREATE'lTO GENABEND-FUNCTIONe024500©‘MOVE 'UNABLE T
 TABLE'Áe024600kTO GENABEND-MESSAGE¸e024700©ìMOVE '0010-INIT'ìTO GENAB
»e024800©gPERFORM :9®-ISPF-ABENDdTHRU :9e-EXIT.e024900¤ð025000 0010-
25100	dEXIT.Óe025200¦dEJECTüe025300¤p025400 0100-BUILD-TABLE.e025500¤e0
ERFORM 9000-READ-SYSPRINTêTHRU 9000-EXIT.e025700¦éIF END-OF-FILEÍe0258
O 0100-EXIT.Ée025900¦éIF TITLE-LINESÍe026000rPERFORM 9000-READ-SYSPRINT
000-EXITe026100g4 TIMES.Ée026200¦éIF END-OF-FILEÍe026300ìGO TO 0100-E
6400¤e026500¦èIF NOT SUBSETe026600éMOVE PANMEM-WShTO PANMEMe026700ì
00-EXIT.Ée026800¤e026900¦êMOVE PANMAIN-WS®TO PANMAIN.e027000¦êMOVE PAN
®TO PANSIZE.e027100¦ìMOVE SUBSET-NAMEiTO PANSUB.Ãe027200¤e027300¦‘PERF
-ADD-ROW-TO-TABLE°êTHRU 0110-EXIT.e027400¤ð027500 0100-EXIT.Óe027600¦dE
7700¦dEJECTüe027800¤‘027900 0110-ADD-ROW-TO-TABLE.e028000¤e028100¦¯MOVE
m' TO ISPF-TABLE-NAME.Àe028200¦fMOVE 00©kTO ISPF-NAME-COUNT.Àe028300¦eM
 TO ISPF-NAME(1).Âe028400¦lCALL 'ISPLINK' USINGdTBADD©êISPF-TABLE-NAME
éISPF-NAME-LISTiISPF-ORDERe028600¸ìISPF-ROWS-ADDED.e028700¤e028800¦ôI
-CODE IS GREATER THAN 4Âf028900*±ž4 - NUMBER OF ROWS PARAMETER WAS SPECI
T ONLY°f029000*uSTORAGE FOR A SINGLE ROW WAS OBTAINED²f029100*±z8 - A R
THE SAME KEY ALREADY EXISTSf029200*°n12 - TABLE IS NOT OPENÃf029300*°r1
RIC CONVERT ERRORÂf029400*°ð20 - SEVERE ERRORe029500©ìMOVE RETURN-CODE
BEND-CODE»e029600©®MOVE 'TBADDç'lTO GENABEND-FUNCTIONe029700©õMOVE 'U
 ADD ROW TO TABLE'e029800kTO GENABEND-MESSAGE¸e029900©¨MOVE '0110-ADD-
ABL' TO GENABEND-MISC²a03:0©gPERFORM :9®-ISPF-ABENDdTHRU :9e-EXIT.e
030200 0110-EXIT.Óe030300¦dEXIT.üe030400¦dEJECTüe030500¤r030600 9000-REA
NT.e030700¤e030800¦tREAD SYSPRINT-IN INTO SYSPRINT-IN-WS½e030900°eAT EN
0rMOVE 'Y' TO END-OF-FILE-SWe031100ìGO TO 9000-EXIT.Çe031200¤e031300¦
OF-LISTÍe031400rMOVE 'Y' TO END-OF-FILE-SWe031500ìGO TO 9000-EXIT.Ée0
31700 9000-EXIT.Óe031800¦dEXIT.üe031900¦dEJECTüe032000¤f032100 :9¯-ISPF
e032200¤e032300¦÷CALL 'GENABEND' USING GENABEND-CALL-PARAMETERS.
e032400
¦jCLOSE SYSPRINT-IN.e032600¤e032700¦hSTOP RUN.Òe032800¤f032900 :9e-EXI
00¦dEXIT.üÿ
./       ADD   NAME=PANBTBL

UTHOR.jGEOFFREY MCINTYRE.:0c400*uComputer Operations Technical Suppo
00*óFirst Security Service Company¸:0c600*ó260 N. Charles Lindbergh D
c700*jSalt Lake City, UTd84116½:0c800*é(801) 350-6519Æ:0ð900 DATE-W
êAPRIL 14, 1989.Åm001000 DATE-COMPILED.Ñê001100*REMARKS. f001200*eINPUT
NCH OUTPUT OF PAN#2 ++PRINT 0-UP COMMAND.f001300*ŸPROCESS: EXTRACT CER
LDS OF EACH INPUT RECORD.f001400*fOUTPUT:éAN ISPF TABLE.e001500:„*	f
jMAINTENANCE NOTES:èC A U T I O Nb! !f001700*¦«× WHEN ADDING OR DELET
SPF-VARIABLE, YOU MUST ALSO±f001800*¦ð× UPDATE 4 LISTS:ðISPF-LENGTH-LIS
00*¦ç×jISPF-NAME-VDEFINE,»f002000*¦ç×oISPF-VARIABLE-LIST, ANDf002100*
F-FORMAT-LIST.f002200*¦ç×ƒf002300*¦ç×zTHESE LISTS ARE POSITIONAL, SO B
L!f002400*¦ç×µTHE VARIABLES ARE LISTED IN ALPHABETICAL ORDER, SO YOU¦f
ç×ŸOUGHT TO KEEP IT THAT WAY TO MAKE MAINTENANCE EASIER.	f002600*¦ç×zS
 YOU DON'T LIKE IT, WRITE TO IBM.f002700*¦ç×ƒf002800*¦¼× YOU MUST ALSO
HE ISPF-NAME-CNT FIELD TO REFLECT THE§f002900*¦r× NEW NUMBER OF VARIABLE

00 CONFIGURATION SECTION.ô003500 SOURCE-COMPUTER. IBM-370.ô003600 OBJE
TER. IBM-370.ò003700 INPUT-OUTPUT SECTION.Ël003800 FILE-CONTROL.Òe00390
T SYSPUNCH-IN ASSIGN TO UT-S-SYSPUNCH.m004000 DATA DIVISION.Ñl004100 FI
ON.Òh004200 FD®SYSPUNCH-INÐe004300¦pBLOCK CONTAINS 0 RECORDSÇe004400¦ñL
ORDS ARE STANDARD.Äh004500 01kPAN-DIRECTORY-ENTRYiPIC X(80).e004600¤e
EJECTü’004800 WORKING-STORAGE SECTION.Èe004900¤h005000 01eFILLERhPIC X
5100	žVALUE 'PROGRAM PANBTBL WORKING-STORAGE BEGINS HERE'.e005200¤h0053
ENABEND-CALL-PARAMETERS.Æe005400¦a05ðGENABEND-FUNCTIONiPIC X(08).e005
èGENABEND-CODEiPIC 9(04).e005600¦a05ìGENABEND-MESSAGEiPIC X(50).e00
èGENABEND-MISCiPIC X(20).e005800¤h005900 01éEND-OF-FILE-SW
lPIC X(01
'N'.e006000¦a88®END-OF-FILE»iVALUE 'Y'.e006100¤h006200 01êSYSPUNCH-I
06300¦a05hPANMEM-WSoPIC X(10) VALUE SPACES.°e006400¦a05hPANLVL-WSoPI
VALUE SPACES.°e006500¦a05iPANUSER-WS
oPIC X(04) VALUE SPACES.°e006600¦a
ERoPIC X(01) VALUE SPACES.°e006700¦a05iPANTYPE-WS
oPIC X(05) VALUE SPA
6800¦a05®PANSTAT-WS.e006900©a10¯PANSTAT-PRODnPIC X(01) VALUE SPACE.±
a10éPANSTAT-ACTIVEnPIC X(01) VALUE SPACE.±e007100©a10êPANSTAT-ENABLED
01) VALUE SPACE.±e007200a88fENABLEDiVALUE 'E'.e007300a88gDISABLED
D'.e007400¦a05iPANMAIN-WS
oPIC X(08) VALUE SPACES.°e007500¦a05®PANACC
IC X(08) VALUE SPACES.°e007600¦a05eFILLERoPIC X(07) VALUE SPACES.°e007
iPANSIZE-WS
oPIC X(06) VALUE SPACES.°e007800¦a05eFILLERoPIC X(06) VALU
.°e007900¦a05iPANSUBS-WS
oPIC 9(04) VALUE ZEROES.°e008000©a88gSUPERSET
1 THRU :9ç.±e008100¦a05eFILLERoPIC X(11) VALUE SPACES.°e008200¦a05®P
WS²oPIC X(01) VALUE SPACES.°e008300¦a05eFILLERoPIC X(03) VALUE SPACES.
¤µ008500* DEFINE DIALOG SERVICE TYPES FOR CALLS TO ISPF.h008600 01gCON
IC X(08) VALUE 'CONTROL '.h008700 01eERRORSoPIC X(08) VALUE 'ERRORSa
00 01fRETURNEoPIC X(08) VALUE 'RETURNa'.h008900 01dTBADD²nPIC X(08)
TBADDa'.h009000 01gTBCREATEñPIC X(08) VALUE 'TBCREATE'.h009100 01f
ñPIC X(08) VALUE 'VDEFINE '.h009200 01fVDELETEñPIC X(08) VALUE 'VDELE
09300 01eVRESEToPIC X(08) VALUE 'VRESETa'.e009400¤µ009500* WORKING-S
IELDS FOR ISPF SERVICE CALLS.h009600 01éISPF-KEY-LIST.Íe009700¦a05éIS
OUNT©òPIC 9(06) COMP VALUE ZEROES.e009800¦a05eFILLERòPIC 9(06) COMP V
OES.e009900¦a05gISPF-KEY©qOCCURS 2 TIMES PIC X(08).a01:0
PIC X(08) VALUE SPACES.h010100 01¯ISPF-OPTION2oPIC X(08) VALUE SPACES
0 01iISPF-ORDERoPIC X(08) VALUE SPACES.h010300 01êISPF-ROWS-ADDEDrP
 COMP VALUE 1000.h010400 01êISPF-TABLE-NAMEoPIC X(08) VALUE SPACES.h
1kISPF-VDEFINE-OPTIONqPIC X(06) VALUE '(LIST)'.e010600¤D010700* ISPF-
IST DEFINES THE CONTENT LENGTH OF EACH VARIABLE.±h010800 01ðISPF-LENGTH
010900¦a05eFILLERõPIC 9(06) COMP VALUE 08. PANACCESe011000¦a05eFILLER
06) COMP VALUE 01. PANFORMTe011100¦a05eFILLER’PIC 9(06) COMP VALUE 03.
e011200¦a05eFILLERõPIC 9(06) COMP VALUE 08. PANMAIN e011300¦a05eFILLE
(06) COMP VALUE 10. PANMEMe011400¦a05eFILLERõPIC 9(06) COMP VALUE 10.
 e011500¦a05eFILLERõPIC 9(06) COMP VALUE 06. PANSIZE e011600¦a05eFILL
9(06) COMP VALUE 03. PANSTAT e011700¦a05eFILLERõPIC 9(06) COMP VALUE 0
BS e011800¦a05eFILLERõPIC 9(06) COMP VALUE 05. PANTYPE e011900¦a05eFI
C 9(06) COMP VALUE 04. PANUSER e012000¦a05eFILLERõPIC 9(06) COMP VALUE
LECT e012100¤e012200: *©f012300*³ISPF-NAME-LIST IS USED BY MANY VARIABL
BLE SERVICES *©f012400*zTO SPECIFY THE NAME(S) OF VARIABLES: THESEç*©f
uMAY BE DIALOG VARIABLES, NON-KEY NAMEç*©f012600*xVARIABLES FOR TABLES
ENSION TABLE¦ç*©f012700*iVARIABLES.ç*©e012800: *©h012900 01êISPF-NAME
013000¦a05êISPF-NAME-COUNT§òPIC 9(06) COMP VALUE ZEROES.e013100¦a05eF
IC 9(06) COMP VALUE ZEROES.e013200¦a05hISPF-NAME	êOCCURS 20 TIMESiPIC
e013300¤e013400: *©F013500* ISPF-NAME-VDEFINE IS A LIST OF VARIABLES TO
ED IN THE *©f013600*mCOMMON AREA (V-POOL).ç*©e013700: *©h013800 01jIS
VDEFINE.e013900¦a05èISPF-NAME-CNTpPIC 9(06) COMP VALUE 12.©e014000¦a0
RòPIC 9(06) COMP VALUE ZEROES.e014100¦a05eFILLERñPIC X(08) VALUE 'PA
e014200¦a05eFILLERñPIC X(08) VALUE 'PANFORMT'.e014300¦a05eFILLERoP
 VALUE 'PANLVLa'.e014400¦a05eFILLERñPIC X(08) VALUE 'PANMAIN '.e014
eFILLERoPIC X(08) VALUE 'PANMEMa'.e014600¦a05eFILLERñPIC X(08) VALU
EM '.e014700¦a05eFILLERñPIC X(08) VALUE 'PANSIZE '.e014800¦a05eFILL
X(08) VALUE 'PANSTAT '.e014900¦a05eFILLERñPIC X(08) VALUE 'PANSUBS '.
¦a05eFILLERñPIC X(08) VALUE 'PANTYPE '.e015100¦a05eFILLERñPIC X(08)
PANUSER '.e015200¦a05eFILLERñPIC X(08) VALUE 'TSELECT '.e015300¤e015
015500*žISPF-VARIABLE-LIST IS USED BY THE VDEFINE SERVICE TO§ç*©f015600
IFY THE VARIABLE(S) WHOSE STORAGE IS*©f015700*
zTO BE USED. EACH VARIABL
ORRESPONDS©f015800*
vBY POSITION TO AN ISPF VARIABLE IN THEç*©f015900*

ST, SO THERE MUST BE AS MANY	ç*©f016000*
wVARIABLE NAMES AS THERE ARE IS
.ç*©e016100: *©h016200 01kISPF-VARIABLE-LIST.Ée016300¦a05gPANACCES·oP
 VALUE SPACES.°e016400¦a05gPANFORMT·nPIC X(01) VALUE SPACE.±e016500¦a05
oPIC X(03) VALUE SPACES.°e016600¦a05fPANMAINoPIC X(08) VALUE SPACES.°
a05ePANMEMoPIC X(10) VALUE SPACES.°e016800¦a05fPANRMEMoPIC X(10) VAL
S.°e016900¦a05fPANSIZEoPIC X(06) VALUE SPACES.°e017000¦a05fPANSTAToP
 VALUE SPACES.°e017100¦a05fPANSUBSoPIC Z(04) VALUE ZEROES.°e017200¦a05
EoPIC X(05) VALUE SPACES.°e017300¦a05fPANUSERoPIC X(04) VALUE SPACES.
¦a05fTSELECTnPIC X(01) VALUE SPACE.±e017500¤e017600: *©H017700* ISPF-F
ST HAS AS MANY FILLERS AS THERE ARE VARIABLES BEING§f017800*gDEFINED.f
¿018000* NOTE: WHEN THE VARIABLE NEEDS TO BE NUMERIC, USE 'FIXED'f01810
AUSE THE FIELD TO BE RIGHT JUSTIFIED.éOTHERWISE, THE©f018200*§³FIELD WI
EATED AS A CHARACTER FIELD (LEFT JUSTIFIED).	f018300*§zTHE FIELD MUST NO
GER THAN 4 BYTES.eA ZEROf018400*§mIS REPRESENTED AS X'8:§0~'. DEFINE T
 AS 9(08) COMP.f018500*§h(BINARY).Îe018600: *©h018700 01ðISPF-FORMAT-L
8800¦a05eFILLERoPIC X(08) VALUE 'CHAR'.gPANACCESe018900¦a05eFILLERo
) VALUE 'CHAR'.gPANFORMTe019000¦a05eFILLERoPIC X(08) VALUE 'CHAR'.eP
19100¦a05eFILLERoPIC X(08) VALUE 'CHAR'.gPANMAIN e019200¦a05eFILLER
8) VALUE 'CHAR'.ePANMEMe019300¦a05eFILLERoPIC X(08) VALUE 'CHAR'.gP
019400¦a05eFILLERoPIC X(08) VALUE 'CHAR'.gPANSIZE e019500¦a05eFILLER
08) VALUE 'CHAR'.gPANSTAT e019600¦a05eFILLERoPIC X(08) VALUE 'CHAR'.
 e019700¦a05eFILLERoPIC X(08) VALUE 'CHAR'.gPANTYPE e019800¦a05eFILL
X(08) VALUE 'CHAR'.gPANUSER e019900¦a05eFILLERoPIC X(08) VALUE 'CHAR'
CT a02:0¤h020100 01eFILLERhPIC X(41)·e020200	œVALUE 'PROGRAM PANBTBL
STORAGE ENDS HERE'.e020300¤r020400 PROCEDURE DIVISION.e020500¤f020600
NLINE.Ñe020700¤e020800¦öCALL 'ISPLINK' USING CONTROLE ERRORS RETURNE.·e0
21000¦lPERFORM 0005-VDEFINEêTHRU 0005-EXIT.e021100¤e021200¦qPERFORM 00
E-TABLEêTHRU 0010-EXIT.e021300¤e021400¦oOPEN INPUT SYSPUNCH-IN.e02150
0¦pPERFORM 0100-BUILD-TABLEéTHRU 0100-EXITe021700jUNTIL END-OF-FILE.Å
e021900¦jCLOSE SYSPUNCH-IN.e022000¤e022100¦cMOVEç1©kTO ISPF-NAME-COUNT
0¦fMOVE '*§j' TO ISPF-NAME(1).Âe022300¦lCALL 'ISPLINK' USINGfVDELETE§êI
-LIST.f022400*nIF RETURN-CODE NOT = 0f022500*±s8 - AT LEAST ONE VARIA
FOUNDf022600*°ð20 - SEVERE ERRORf022700*éNEXT SENTENCE.e022800¤e0229
 'ISPLINK' USING VRESET.Ãe023000¤e023100¦hSTOP RUN.Òe023200¤f023300 :0e
023400¦dEXIT.üe023500¦dEJECTüe023600¤l023700 0005-VDEFINE.Òe023800¤f0239
L VDEFINE TO DEFINE DIALOG FUNCTION VARIABLES TO ISPF.e024000¤e024100¦ò
PLINK' USING VDEFINEðISPF-NAME-VDEFINEe024200jISPF-VARIABLE-LISTìISP
-LISTe024300ìISPF-LENGTH-LIST¦lISPF-VDEFINE-OPTION.e024400¤e024500¦jI
-CODE > 8f024600*±n8 - VARIABLE NOT FOUNDf024700*°‘16 - DATA TRUNCATIO
EDÀf024800*°ð20 - SEVERE ERRORe024900©ìMOVE RETURN-CODEìTO GENABEND-CO
00©éMOVE 'VDEFINE'lTO GENABEND-FUNCTIONe025100©÷MOVE 'UNABLE TO DEFINE
IABLE(S) TO ISPF'e025200kTO GENABEND-MESSAGE¸e025300©tMOVE '0005-VDEFI
ENABEND-MISCºe025400©gPERFORM :9®-ISPF-ABENDdTHRU :9e-EXIT.e025500¤ð
005-EXIT.Óe025700	dEXIT.Óe025800¦dEJECTüe025900¤q026000 0010-DEFINE-TABL
00¤õ026200* HERE WE DEFINE THE TABLE.e026300¤e026400¦sMOVE 'PANUTIL ' T
ABLE-NAME.Àe026500¦fMOVE 01©jTO ISPF-KEY-COUNT.e026600¦¯MOVE 'PANMEMð'
-KEY(1).
e026700¦fMOVE 11©kTO ISPF-NAME-COUNT.Àe026800¦ôMOVE 'PANACCES'
NAME(1).Âe026900¦ôMOVE 'PANFORMT' TO ISPF-NAME(2).Âe027000¦¯MOVE 'PANLVL
SPF-NAME(3).Âe027100¦ôMOVE 'PANMAIN ' TO ISPF-NAME(4).Âe027200¦ôMOVE 'PA
TO ISPF-NAME(5).Âe027300¦ôMOVE 'PANSIZE ' TO ISPF-NAME(6).Âe027400¦ôMOVE
T ' TO ISPF-NAME(7).Âe027500¦ôMOVE 'PANSUBS ' TO ISPF-NAME(8).Âe027600¦ô
NTYPE ' TO ISPF-NAME(9).Âe027700¦õMOVE 'PANUSER ' TO ISPF-NAME(10).Áe027
E 'TSELECT ' TO ISPF-NAME(11).Áe027900¦ôMOVE 'NOWRITE ' TO ISPF-OPTION1.
¦ôMOVE 'REPLACE ' TO ISPF-OPTION2.Âe028100¦lCALL 'ISPLINK' USINGgTBCREA
-TABLE-NAMEe028200òISPF-KEY-LIST ISPF-NAME-LISTe028300¯ISPF-OPTION1
TION2.e028400¤e028500¦ôIF RETURN-CODE IS GREATER THAN 4Âf028600*±œ4 - D
 TABLE EXISTS BUT "REPLACE" SPECIFIEDf028700*±›8 - TABLE ALREADY EXISTS
CE" NOT SPECIFIEDf028800*°‘12 - TABLE IN USE; ENQ FAILEDÀf028900*°ž16 -
ODE SPECIFIED AND TABLE INPUT LIBRARY IS±f029000*èNOT ALLOCATEDÇf029100
SEVERE ERRORe029200©ìMOVE RETURN-CODEìTO GENABEND-CODE»e029300©êMOVE '
'lTO GENABEND-FUNCTIONe029400©‘MOVE 'UNABLE TO CREATE TABLE'Áe029500k
END-MESSAGE¸e029600©ìMOVE '0010-INIT'ìTO GENABEND-MISC»e029700©gPERFORM
PF-ABENDdTHRU :9e-EXIT.e029800¤e029900¤a03:0
200¦dEJECTüe030300¤p030400 0100-BUILD-TABLE.e030500¤e030600¦rPERFORM 90
SYSPUNCHêTHRU 9000-EXIT.e030700¦éIF END-OF-FILEÍe030800ìGO TO 0100-EX
900¤e031000¦éMOVE PANMEM-WSiTO PANMEM.Ãe031100¦®MOVE SPACES§®TO PANRMEM
0¦êMOVE PANMAIN-WS®TO PANMAIN.e031300¦ìMOVE PANACCES-WS¯TO PANACCES.
êMOVE PANSIZE-WS®TO PANSIZE.e031500¦éMOVE PANLVL-WSiTO PANLVL.Ãe03160
PANUSER-WS®TO PANUSER.e031700¦êMOVE PANSTAT-WS®TO PANSTAT.e031800¦êM
UBS-WS®TO PANSUBS.e031900¦ìMOVE PANFORMT-WS¯TO PANFORMT.e032000¦êMOV
E-WS®TO PANTYPE.e032100¤e032200¦®IF DISABLEDÐe032300‘MOVE '*DISABLED
RMEM.Âe032400¤e032500¦®IF SUPERSETÐe032600‘MOVE '*SUPERSET ' TO PANRMEM
0¤e032800¦‘PERFORM 0110-ADD-ROW-TO-TABLE°êTHRU 0110-EXIT.e032900¤ð03300
XIT.Óe033100¦dEXIT.üe033200¦dEJECTüe033300¤‘033400 0110-ADD-ROW-TO-TABLE
0¤e033600¦sMOVE 'PANUTIL ' TO ISPF-TABLE-NAME.Àe033700¦fMOVE 00©kTO ISPF
UNT.Àe033800¦eMOVE 'j' TO ISPF-NAME(1).Âe033900¦lCALL 'ISPLINK' USINGd
SPF-TABLE-NAMEe034000¸éISPF-NAME-LISTiISPF-ORDERe034100¸ìISPF-ROWS-AD
4200¤e034300¦ôIF RETURN-CODE IS GREATER THAN 4Âf034400*±ž4 - NUMBER OF R
METER WAS SPECIFIED, BUT ONLY°f034500*uSTORAGE FOR A SINGLE ROW WAS OBT
34600*±z8 - A ROW WITH THE SAME KEY ALREADY EXISTSf034700*°n12 - TABLE
PENÃf034800*°r16 - NUMERIC CONVERT ERRORÂf034900*°ð20 - SEVERE ERRORe03
VE RETURN-CODEìTO GENABEND-CODE»e035100©®MOVE 'TBADDç'lTO GENABEND-FU
035200©õMOVE 'UNABLE TO ADD ROW TO TABLE'e035300kTO GENABEND-MESSAGE¸e
MOVE '0110-ADD-ROW-TO-TABL' TO GENABEND-MISC²e035500©gPERFORM :9®-ISPF-
HRU :9e-EXIT.e035600¤ð035700 0110-EXIT.Óe035800¦dEXIT.üe035900¦dEJECTü
r036100 9000-READ-SYSPUNCH.e036200¤e036300¦tREAD SYSPUNCH-IN INTO SYSPU
S½e036400°eAT ENDÐe036500rMOVE 'Y' TO END-OF-FILE-SWe036600ìGO TO 900
e036700¤ð036800 9000-EXIT.Óe036900¦dEXIT.üe037000¦dEJECTüe037100¤f037200
PF-ABEND.Îe037300¤e037400¦÷CALL 'GENABEND' USING GENABEND-CALL-PARAMETER
00¤e037600¦jCLOSE SYSPUNCH-IN.e037700¤e037800¦hSTOP RUN.Òe037900¤f03800
XIT.Óe038100¦dEXIT.üÿ

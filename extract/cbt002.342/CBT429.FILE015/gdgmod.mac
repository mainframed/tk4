//XKZS0015  JOB (SD,A,SPM000,DZK),WB00015,
// NOTIFY=XKZS,CLASS=M,MSGCLASS=T,COND=(1,LT)
/*JOBPARM R=1318,K=60
//*--->>> MODIFIED FOR XA AND SMPE . THIS IS THE GDG MOD.
//SMPE    EXEC PGM=GIMSMP,REGION=4096K,
//             COND=(0,NE)
//STEPCAT  DD  DSN=ICF.VSMPE81.UCAT,DISP=SHR
//SMPCSI   DD  DISP=SHR,DSN=SMPE.WBIPO.GLOBAL.CSI
//SMPPTS   DD  DISP=SHR,DSN=SMPE.WBIPO.SMPPTS,UNIT=D,VOL=SER=IPOCAT
//SMPOUT   DD  SYSOUT=*
//SMPRPT   DD  SYSOUT=*
//SMPLOG   DD  DUMMY
//SMPLOGA  DD  DUMMY
//SMPLIST  DD  SYSOUT=*
//SYSPRINT DD  SYSOUT=*
//SMPCNTL  DD *
 SET BDY(GLOBAL) .
   REJECT  S(LC00015) BYPASS(APPCHK) .
   RESETRC .
   RECEIVE S(LC00015) SYSMODS .
 SET BDY(IPOTEST) .
   APPLY S(LC00015) REDO BYPASS(HOLDUSER) .
//SMPPTFIN DD *
++USERMOD(LC00015)
  /* THE PURPOSE OF THIS MODIFICATION IS TO ALLOW RESTART OF JOBS
     THAT USE GDG AND REFER TO THEM AS +1 IN LATER STEPS.
     WITHOUT THIS MOD JOBS RESTARTED WOULD HAVE TO HAVE ALL
     REFERENCRES TO +1 CHANGED TO 0.  THIS IS AN ERROR PRONE AND
     TIME CONSUMING TASK.  THEREFORE THE FOLLOWING MODIFICATION.....

     FUNCTION:
     IF THE GDG IS NOT FOUND IN THE GDGNT (GDG NAME TABLE)
        THEN IT HAS NOT BEEN PROCESSED IN THE 'JOB' BEFORE AND WE
        NEED TO CHECK DISP.
     IF DISP IS NEW
        THEN DO NOTHING.
     IF DISP IS NOT NEW
        THEN CHECK RGN FOR +.
     IF RGN IS NOT +
        THEN DO NOTHING.
     IF RGN IS +
        THEN CHECK FOR EXACTLY +1.
     IF NOT +1
        THEN DO NOTHING.
     IF +1
        THEN SUBTRACT ONE FROM BASE LEVEL AND CONTINUE PROCESSING */.
++VER(Z038) FMID(JBB2110) PRE(UZ66555) .
++ZAP(IEFAB461) .
 EXPAND IEFAB461(128)
NAME IEFAB461
VER 0608 50A0,1040         ST    @01,HWGDGBSP(,@01)
VER 089D 0000,D0                 DC    AL3(((@ENDDATD-@DATD+7)/8)*8)
*
REP 0608 47F0,C896               B     PATCH
REP 089D 0000,D4                 DC    AL3(((@ENDDATD-@DATD+7+4)/8)*8)
*
REP 08B8 50A0,1040      PATCH    ST    @10,HWGDGBSP(,@01)
REP 08BC 58A0,B054               L     @10,@PC00001+12
REP 08C0 58A0,A000               L     @10,SIOTPTR(,@10)
REP 08C4 9104,A03A               TM    SCTSNEW(@10),X'04'
REP 08C8 4710,C5EA               BO    @RF00159
REP 08CC 58A0,B058               L     @10,@PC00001+16
REP 08D0 5860,A000               L     @06,0(,@10)
REP 08D4 954E,602C               CLI   44(@06),C'+'
REP 08D8 4770,C5EA               BNE   @RF00159
REP 08DC 4160,6001      L1       LA    @06,1(,@06)
REP 08E0 95F0,602C               CLI   44(@06),C'0'
REP 08E4 4780,C8BA               BE    L1
REP 08E8 95F1,602C               CLI   44(@06),C'1'
REP 08EC 4770,C5EA               BNE   @RF00159
REP 08F0 9540,602D               CLI   45(@06),C' '
REP 08F4 4770,C5EA               BNE   @RF00159
REP 08F8 58A0,1040               L     @10,HWGDGBSP(,@01)
REP 08FC F223,B0D0,A000          PACK  @DATD+208(3),0(4,@10)
REP 0902 FB20,B0D0,C8F4          SP    @DATD+208(3),PACKONE
REP 0908 F332,A000,B0D0          UNPK  0(4,@10),@DATD+220(3)
REP 090E 96F0,A003               OI    3(@10),X'F0'
REP 0912 47F0,C5EA               B     @RF00159
REP 0916 1C00           PACKONE  DC    PL1'1'
IDRDATA LC00015

*          DATA SET ACF2INQV1  AT LEVEL 002 AS OF 11/05/87
         TITLE 'ACF2CALL    V4.1    FOR CICS   1.6.1          '
         REGEQU
*
*   COMM AREA PASSED BY CALLING PORGRAM
*
COMMAREA DSECT
COMM     DS  0CL703
LONONID  DS  CL8
SOURCE   DS  CL8
NAME     DS  CL20
UID      DS  CL24
OPER     DS  CL3
MESSAGE  DS  CL128
FILLER   DS  CL512       FILLER
*
*      ACF2 CONTROL BLOCK AND DATA AREAS
*
DFHEISTG DSECT
         ACFAEUCP
UCPSCDLN EQU *-ACFAEUCP
*
*      REFORMAT COMM AREA INTO ACF2 CONTROL BLOCK
*
ACF2CALL DFHEIENT CODEREG=(9,10),DATAREG=(11),EIBREG=12
         B     START
*
         DC    CL44'ACF2INQ   PROGRAM VER 4.1 '
*
START    DS    0H
*
         EXEC CICS HANDLE CONDITION ERROR(LINKERR)
*
         L     R8,DFHEICAP          COMMAREA
         USING COMMAREA,R8
         MVI   UCPTYP,UCPTYPP
         MVI   UCPREQB,UCPINQ
*
         EXEC CICS LINK PROGRAM('ACFAEUCC') COMMAREA(ACFAEUCP)         X
               LENGTH(=AL2(UCPSCDLN))
*
*        CLC   UCPSTAT,UCPSTATE
*        BE    ERROR
*
         MVC   LONONID,UCPLID
         MVC   SOURCE,UCPSRCE
         MVC   NAME,UCPNAME
         MVC   UID,UCPUID
         MVC   OPER,UCPOPID
         B     RETURN
*
LINKERR  DS    0H
         MVC   MESSAGE,=C'ACF2CALL-1 ACFAEUCC NOT AVAILABLE'
         B     RETURN
*
ERROR    DS    0H
         MVC   MESSAGE,=C'ACF2CALL-2 ERROR OCURRED DURRING VALIDATION '
         B     RETURN
*
RETURN   DS    0H
         EXEC CICS RETURN
         LTORG
         END

++ USERMOD(AJSW208) /*

    RESTRICTED CLASS VERIFICATION USERMOD

    THIS MODIFICATION CONTAINS THE FOLLOWING:
     1. CVER    - RESTRICTED CLASS VERIFICATION TABLE PROCESSOR DSP
     2. CVERDATA- CVER DSP DATA CSECT
     3. CVERDATA- MACRO MAPPING CVER DATA CSECT
     4. CVERTAB - MACRO MAPPING RESTRICTED CLASS VERIFICATION TABLE
                                      */.
++ VER(Z038) FMID(HJS2215) PRE(AJSW003,AJSW013,AJSW008).
++ JCLIN .
//GEN11 JOB WC07Z0044,'531-1  CR SINGER'
/*
//SG21 EXEC LINKS,
// PARM='NCAL,LIST,XREF,LET,RENT,REUS',
//    UNIT='3350',SER=IPLYYY,N=GEN1,NAME=JES3LIB,P1=' ',
//    MOD=,P2=' ',OBJ=OBJPDS01,CLASS=T
//INCLUDE DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=MVS3.INCLUDE
//SYSLIN DD *
    INCLUDE INCLUDE(CVER)
 NAME CVER(R)
/*
//SG23 EXEC LINKS,
// PARM='NCAL,LIST,XREF,LET',
//    UNIT='3350',SER=IPLYYY,N=GEN1,NAME=JES3LIB,P1=' ',
//    MOD=,P2=' ',OBJ=OBJPDS01,CLASS=T
//INCLUDE DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=MVS3.INCLUDE
//SYSLIN DD *
    INCLUDE INCLUDE(CVERDATA)
 NAME CVERDATA(R)
/*
++ SRC(CVER) DISTLIB(ASRCLIB) .
CVER     TITLE 'JOB CLASS RESTRICTION DSP'                      AJSW208
CVER     CSECT                                                  AJSW208
CVER     AMODE 31                                               AJSW208
CVER     RMODE ANY                                              AJSW208
         IATYASM                                                AJSW208
***********************************************************************
*                                                                     *
* MODULE NAME:                                                        *
*              CVER                                                   *
*                                                                     *
* NON-COPYRIGHT:                                                      *
*              GENERAL DYNAMICS (DSD) - MODIFICATION CODE 'AJSW208'   *
*                                                                     *
* LEVEL:                                                              *
*              JES3 RELEASE 2.1.5                                     *
*                                                                     *
* PATCH LABEL:                                                        *
*              PTCHP                                                  *
*                                                                     *
* FUNCTION:                                                           *
*              THIS ROUTINE LOADS THE TABLE OF RESTRICTED JOB         *
*              CLASSES AND USERID PERMITTED TO USE THEM.              *
*                                                                     *
* OPERATION:                                                          *
*              CVER DSP IS INVOKED BY AN OPERATOR CALL COMMAND.       *
*              VALID CALLING SEQUENCES ARE:                           *
*                                                                     *
*                    *X,CVER,T,TABLENAME   -> LOAD CLASS TABLE        *
*                    *X,CVER,R,TABLENAME   -> REPLACE CLASS TABLE     *
*                    *X,CVER,Q             -> QUERY IF ACTIVE         *
*                    *X,CVER,C             -> CANCEL CLASS CHECKING   *
*                    *X,CVER,L,U=UID       -> LIST CLASSES VALID FOR  *
*                                             A UID                   *
*                             ,C=CLASS     -> LIST UIDS FOR CLASS     *
*                             ,L           -> LIST RESTRICTED CLASSES *
*                                                                     *
*              THE DEFAULT TABLE, 'CVERGEN', IS LOADED WHEN THE       *
*              FIRST JOB COMES THROUGH THE SYSTEM. IATUX04 WILL       *
*              ISSUE A CALL TO CVER TO LOAD THE TABLE. THE SOURCE     *
*              FOR THE DEFAULT TABLE WILL BE KEPT IN SYS1.SYSINLIB.   *
*              THE JCL TO ASSEMBLE AND LINK THE TABLE WILL BE IN      *
*              SYS1.JOBLIB. THE LINKEDITED MODULE WILL BE RESIDE IN   *
*              SYS1.SYS2LINK.                                         *
*                                                                     *
*                                                                     *
* DEPENDENCIES:                                                       *
*              NONE                                                   *
*                                                                     *
* RESTRICTIONS:                                                       *
*              NONE                                                   *
*                                                                     *
* PROCESSOR:                                                          *
*              VS ASSEMBLER                                           *
*                                                                     *
* ATTRIBUTES:                                                         *
*              REENTERABLE                                            *
*                                                                     *
* ENTRY POINTS:                                                       *
*              CVER                                                   *
*                                                                     *
* ENTRY PURPOSE:                                                      *
*              SEE FUNCTION.                                          *
*                                                                     *
* ENTRY LINKAGE:                                                      *
*              IATGRJR (JSSDRIVER) LOADS AND CALLS CVER               *
*                                                                     *
* REGISTER CONVENTIONS:                                               *
*              R05->RESTRICTED CLASS TABLE HEADER                     *
*              R06->RESTRICTED CLASS TABLE CLASS ENTRY                *
*              R07->RESTRICTED CLASS TABLE USER ENTRY                 *
*              R10->BASE REGISTER                                     *
*              R11->FCT                                               *
*              R12->TVT                                               *
*              R13->CVERDATA 'CVER DATA CSECT'                        *
*              R14->JSSRTN                                            *
*              R15->CVER                                              *
*                                                                     *
* INPUT:                                                              *
*              CVER COMMAND WITH PARAMETERS (SEE OPERATION)           *
*                                                                     *
* EXIT-NORMAL:                                                        *
*              ARETURN RC=0                                           *
*                                                                     *
* EXIT-ERROR:                                                         *
*              NONE                                                   *
*                                                                     *
* EXIT-USER:                                                          *
*              NONE                                                   *
*                                                                     *
* OUTPUT:                                                             *
*                                                                     *
*              FOR A LOAD OR REPLACE, THE ADDRESS OF THE TABLE IS     *
*              STOWED IN TVTUVER                                      *
*                                                                     *
*              FOR A DELETE, THE POINTER IN TVTUVER IS CLEARED AFTER  *
*              THE TABLE STORAGE IS RELEASED.                         *
*                                                                     *
*              FOR A DISPLAY, DATA DEPENDING ON THE DISPLAY IS OUTPUT *
*              TO THE REQUESTING TABLE.                               *
*                                                                     *
* EXTERNAL ROUTINES:                                                  *
*              CVERDATA - DATA CSECT                                  *
*                                                                     *
* CONTROL BLOCKS:                                                     *
*              CVERDATA  (DSD)                                        *
*              CVERTAB   (DSD)     R/O                                *
*              IATYTVT   (JES3)    R/O                                *
*              IATYFCT   (JES3)    R/O                                *
*              IATYCNS   (JES3)    R/O                                *
*                                                                     *
* EXECUTABLE MACROS:                                                  *
*              AGETMAIN                                               *
*              ADELETE                                                *
*              ALOAD                                                  *
*              APUTMAIN                                               *
*              ARELEASE                                               *
*              AWAIT                                                  *
*              IATXCNS                                                *
*              IATXCSF                                                *
*              IATXSCN1                                               *
*              IATYMOD                                                *
*              MESSAGE                                                *
*                                                                     *
* ENQUEUE RESOURCES:                                                  *
*              NONE                                                   *
*                                                                     *
* MP LOCKS USED:                                                      *
*              NONE                                                   *
*                                                                     *
* MESSAGES:                                                           *
*              IATWC001                                               *
*              IATWC002                                               *
*              IATWC003                                               *
*              IATWC004                                               *
*              IATWC005                                               *
*              IATWC006                                               *
*              IATWC007                                               *
*              IATWC008                                               *
*              IATWC009                                               *
*              IATWC010                                               *
*              IATWC011                                               *
*              IATWC012                                               *
*              IATWC014                                               *
*                                                                     *
* ABEND CODES:                                                        *
*              NONE                                                   *
*                                                                     *
***********************************************************************
CVER     CSECT                                                  AJSW208
         IATYEQU  ,                                             AJSW208
         IATYREG  ,                                             AJSW208
         IATYTVT  TYPE=DSECT                                    AJSW208
         IATYFCT  ,                                             AJSW208
         IATYCNS  TYPE=INPUT,CODES=YES                          AJSW208
         EJECT                                                  AJSW208
         CVERTAB  ,                                             AJSW208
         EJECT                                                  AJSW208
         CVERDATA TYPE=DSECT                                    AJSW208
         TITLE 'JOB CLASS RESTRICTION DSP'                      AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*                    INITIALIZATION                             AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
CVER     CSECT                                                  AJSW208
         USING CVER,R15                                         AJSW208
*                                                               AJSW208
         IATYMOD BR=YES           IDENTIFY MODULE               AJSW208
*                                                               AJSW208
         STM   R14,R1,JSSRET      SAVE RETURN ADDRESS           AJSW208
         LR    R10,R15             SET CSECT BASE REGISTER      AJSW208
         DROP  R15                                              AJSW208
         USING CVER,R10            SET CSECT ADDRESSABILITY     AJSW208
*                                                               AJSW208
         USING CVERDATA,R13        DATA CSECT ADDRBLTY          AJSW208
         USING CVERTABH,R5         CLASS TABLE HDR ADDRBLTY     AJSW208
         USING CVERCTAB,R6        CLASS TABLE ENTRY ADDRBLTY    AJSW208
         USING CVERUTAB,R7        USER ENTRY ADDRESSABILITY     AJSW208
*                                                               AJSW208
         MVC   TABLSAVE,TVTUVER   COPY TABLE ADDRESS            AJSW208
         NI    TABLSAVE,TURNOFF-BUSYBIT ENSURE BUSY BIT IS OFF  AJSW208
*                                                               AJSW208
         IATXCNS TYPE=GET         EXTRACT INPUT BUFFER          AJSW208
*                                                               AJSW208
         LR    R9,R1              SAVE ADDR OF IATYCNS          AJSW208
         ST    R9,CONSADDR        SAVE -> IATYCONS              AJSW208
         USING CONSMESS,R9        CONSOLE MESSAGE PROCESSING    AJSW208
         LH    R8,CONSNUM         CALLING CONSOLE ID            AJSW208
         STH   R8,XCONS           SAVE CALLING CONSOLE ID       AJSW208
         DROP  R9                                               AJSW208
*                                                               AJSW208
         IATXSCN1 PFX=(R9),EOD=PARMERR,ERROR=PARMERR            AJSW208
*                                                               AJSW208
         LTR   R1,R1              IS THIS A KEYWORD PARM?       AJSW208
         BC    NZERO,PARMERR      YES, PARAMETERS IN ERROR      AJSW208
         LTR   R0,R0              WAS THERE ANY PARAMETERS      AJSW208
         BC    ZERO,PARMERR       NO,ISSUE ERROR MESSAGE        AJSW208
         BCTR  R2,0               DECREMENT LENGTH BY 1         AJSW208
         LTR   R2,R2              NOW SHOULD BE 0 - OTHERWISE   AJSW208
         BC    NZERO,PARMERR      IT'S AN ERROR IF NOT          AJSW208
         LR    R1,R0              -> TO DATA IN USABLE REG.     AJSW208
         LA    R2,CMDPRIM         -> TO PRIMARY PARAMETER TABLE AJSW208
*                                                               AJSW208
CVER0100 DS    0H                                               AJSW208
         CLC   0(1,R1),0(R2)      PRIMARY PARAMETER MATCH       AJSW208
         BC    NE,CVER0110        NO, GET NEXT TABLE ENTRY      AJSW208
         ICM   R15,B'1111',1(R2)  YES, GET ADDR OF PROC RTN     AJSW208
         BR    R15                  AND PROCESS THE COMMAND     AJSW208
*                                                               AJSW208
CVER0110 DS    0H                                               AJSW208
         LA    R2,CMDPRIM#(,R2)   GET NEXT ENTRY IN THE TABLE   AJSW208
         CLI   0(R2),X'FF'        END OF TABLE                  AJSW208
         BC    NE,CVER0100        NO, LOOP BACK FOR CHECK       AJSW208
         B     PARMERR            YES, INVALID PARAMETER        AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*               LOAD A RESTRICTED CLASS TABLE                   AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
CMDT     DS    0H                                               AJSW208
         OC    TABLSAVE,TABLSAVE  DOES A TABLE CURRENTLY EXIST  AJSW208
         BC    ZERO,CMDT0100      NO,CONTINUE PROCESSING        AJSW208
         LA    R1,IATWC005        -> TO ERROR MESSAGE           AJSW208
         ST    R1,EXITMSG                                       AJSW208
         B     CVEREXIT           RETURN TO JSS                 AJSW208
*                                                               AJSW208
CMDT0100 DS    0H                                               AJSW208
         IATXSCN1 PFX=(R9),EOD=PARMERR,ERROR=PARMERR            AJSW208
*                                                               AJSW208
         LTR   R1,R1              IS THIS A KEYWORD PARM?       AJSW208
         BC    NZERO,PARMERRT     YES, PARAMETERS IN ERROR      AJSW208
         LTR   R0,R0              WAS THERE ANY PARAMETERS      AJSW208
         BC    ZERO,PARMERRT      NO,ISSUE ERROR MESSAGE        AJSW208
         CH    R2,=H'8'           SIZE LARGER THAN MAX          AJSW208
         BC    GT,PARMERRT        YEP, ERROR.                   AJSW208
*                                                               AJSW208
         BCTR  R2,R0              DECREMENT LENGTH FOR MVC      AJSW208
         LR    R1,R0              COPY -> TO TABLE NAME         AJSW208
         EX    R2,MVCNAME         SAVE TABLE NAME               AJSW208
         BAL   R14,GETTAB         GO GET THE CLASS TABLE        AJSW208
*                                                               AJSW208
         LTR   R1,R1              DID WE GET THE TABLE          AJSW208
         BC    ZERO,CMDT9999      NO, EXIT WITH ERROR           AJSW208
*                                                               AJSW208
CMDT0200 DS    0H                                               AJSW208
         ST    R1,TVTUVER         SAVE -> TO CLASS TABLE        AJSW208
         MVC   WORKREC(WC007#),IATWC007                         AJSW208
         MVC   WORKREC+WC007I1(L'WC007I1),TABLNAM               AJSW208
         LA    R1,WORKREC         -> TO EXIT MESSAGE            AJSW208
         ST    R1,EXITMSG         SAVE FOR EXIT ROUTINE         AJSW208
*                                                               AJSW208
CMDT9999 DS    0H                                               AJSW208
         OI    TVTUFLG2,TVTUCVLD  INDICATE TABLE LOADED         AJSW208
         B     CVEREXIT           WE'RE DONE, EXIT              AJSW208
*                                                               AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*              REPLACE RESTRICTED CLASS TABLE                   AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
CMDR     DS    0H                                               AJSW208
         OC    TABLSAVE,TABLSAVE  DOES A TABLE CURRENTLY EXIST  AJSW208
         BC    NZERO,CMDR0100     YES, REPLACE WITH NEW TABLE   AJSW208
         LA    R1,IATWC009        -> TO ERROR MESSAGE           AJSW208
         ST    R1,EXITMSG         SAVE FOR EXIT ROUTINE         AJSW208
         B     CVEREXIT           WE BE DONE                    AJSW208
*                                                               AJSW208
CMDR0100 DS    0H                                               AJSW208
         IATXSCN1 PFX=(R9),EOD=PARMERR,ERROR=PARMERR            AJSW208
*                                                               AJSW208
         LTR   R1,R1              IS THIS A KEYWORD PARM?       AJSW208
         BC    NZERO,PARMERR      YES, PARAMETERS IN ERROR      AJSW208
         LTR   R0,R0              WAS THERE ANY PARAMETERS      AJSW208
         BC    ZERO,PARMERR       NO,ISSUE ERROR MESSAGE        AJSW208
         CH    R2,=H'8'           SIZE LARGER THAN MAX          AJSW208
         BC    GT,PARMERR         YEP, ERROR.                   AJSW208
*                                                               AJSW208
         BCTR  R2,R0              DECREMENT LENGTH FOR MVC      AJSW208
         LR    R1,R0              COPY -> TO TABLE NAME         AJSW208
         EX    R2,MVCNAME         SAVE TABLE NAME               AJSW208
         BAL   R14,GETTAB         GO GET THE CLASS TABLE        AJSW208
*                                                               AJSW208
         LTR   R6,R1              DID WE GET THE TABLE          AJSW208
         BC    ZERO,CVEREXIT      NO,EXIT WITH ERROR            AJSW208
*                                                               AJSW208
CMDR0200 DS    0H                                               AJSW208
         BAL   R14,SERTAB         SERIALIZE THE TABLE           AJSW208
*                                                               AJSW208
         MVC   WORKREC(WC008#),IATWC008                         AJSW208
         L     R5,TVTUVER         -> RESTRICTED CLASS TABLE     AJSW208
         MVC   WORKREC+WC008I1(L'WC008I1),CVERTNAM              AJSW208
         MVC   WORKREC+WC008I2(L'WC008I2),CVERTNAM-CVERTABH(R6) AJSW208
         ST    R6,TVTUVER         SAVE -> TO CLASS TABLE        AJSW208
*                                                               AJSW208
         L     R0,CVERTSIZ        LENGTH OF OLD TABLE           AJSW208
         LR    R1,R5              SET APUTMAIN ADDRESS REG      AJSW208
         APUTMAIN SIZE=(R0),      RELEASE THE OLD CLASS TABLE   AJSW208$
               AREA=(R1)                                        AJSW208
*                                                               AJSW208
         LA    R1,WORKREC         -> TO EXIT MESSAGE            AJSW208
         ST    R1,EXITMSG         SAVE FOR EXIT ROUTINE         AJSW208
         B     CVEREXIT           DONE....RETURN TO JSS         AJSW208
*                                                               AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*         QUERY IF RESTRICED CLASS PROCESSING IS ACTIVE         AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
CMDQ     DS    0H                                               AJSW208
         OC    TABLSAVE,TABLSAVE  DOES A TABLE CURRENTLY EXIST  AJSW208
         BC    NZERO,CMDQ0100     YES,DISPLAY THE NAME          AJSW208
         LA    R1,IATWC002        -> TO NOT ACTIVE MESSAGE      AJSW208
         ST    R1,EXITMSG         SAVE FOR THE EXIT ROUTINE     AJSW208
         B     CVEREXIT           WE'RE FINISHED                AJSW208
*                                                               AJSW208
CMDQ0100 DS    0H                                               AJSW208
         MVC   WORKREC(WC002A#),WC002A COPY MSG SKEL TO WORK    AJSW208
         L     R5,TVTUVER         -> TO CLASS TABLE             AJSW208
         MVC   WORKREC+WC002AI1(L'WC002AI1),CVERTNAM TABLE NAME AJSW208
         MVC   WORKREC+WC002AI2(L'WC002AI2),CVERTDAT CREAT DATE AJSW208
         MVC   WORKREC+WC002AI3(L'WC002AI3),CVERTTIM CREAT TIME AJSW208
         LA    R1,WORKREC         -> TO MESSAGE                 AJSW208
         ST    R1,EXITMSG         SAVE FOR THE EXIT ROUTINE     AJSW208
         B     CVEREXIT           WE'RE FINISHED                AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*              CANCEL RESTRICTED CLASS PROCESSING               AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
CMDC     DS    0H                                               AJSW208
         OC    TABLSAVE,TABLSAVE  DOES A TABLE CURRENTLY EXIST  AJSW208
         BC    NZERO,CMDC0100     YES,SET UP FOR DELETE         AJSW208
         LA    R1,IATWC003        NO, -> POINTER TO ERROR MSG   AJSW208
         ST    R1,EXITMSG         SAVE FOR EXIT ROUTINE         AJSW208
         B     CVEREXIT           FINISHED, EXIT                AJSW208
*                                                               AJSW208
CMDC0100 DS    0H                                               AJSW208
         BAL   R14,SERTAB         SERIALIZE THE TABLE           AJSW208
         L     R5,TVTUVER         -> RESTRICTED CLASS TABLE     AJSW208
         L     R0,CVERTSIZ        GET THE TABLE SIZE            AJSW208
         LR    R1,R5              COPY -> TO TABLE              AJSW208
*                                                               AJSW208
         APUTMAIN SIZE=(R0),      RELEASE THE TABLE             AJSW208$
               AREA=(R1)                                        AJSW208
*                                                               AJSW208
         XC    TVTUVER,TVTUVER    INDICATE NO CLASS TABLE       AJSW208
         LA    R1,IATWC004        -> POINTER TO DISABLED MSG.   AJSW208
         ST    R1,EXITMSG         STOW FOR EXIT ROUTINE         AJSW208
         B     CVEREXIT           ALL DONE EXIT                 AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*              DISPLAY REQUESTED CLASS TABLE ENTRIES            AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
CMDL     DS    0H                                               AJSW208
         OC    TABLSAVE,TABLSAVE  DOES A TABLE CURRENTLY EXIST  AJSW208
         BC    NZERO,CMDL0100     YES,CONTINUE PROCESSING       AJSW208
         LA    R1,IATWC003        -> TO ERROR MESSAGE           AJSW208
         ST    R1,EXITMSG                                       AJSW208
         B     CVEREXIT           RETURN TO JSS                 AJSW208
*                                                               AJSW208
CMDL0100 DS    0H                                               AJSW208
         L     R5,TVTUVER         -> RESTRICTED CLASS TABLE     AJSW208
         LA    R6,CVERTCTB        -> TO FIRST CLASS TABLE       AJSW208
*                                                               AJSW208
         IATXSCN1 PFX=(R9),EOD=PARMERR,ERROR=PARMERR            AJSW208
*                                                               AJSW208
         LTR   R1,R1              IS THIS A KEYWORD PARM?       AJSW208
         BC    NZERO,CMDL0400     YES,CHECK KEYWORD TYPE        AJSW208
         LTR   R1,R0              WAS THERE ANY PARAMETERS      AJSW208
         BC    ZERO,PARMERR       NO, MUST HAVE A SECOND PARM   AJSW208
         CH    R2,=H'1'           LENGTH MUST BE 1              AJSW208
         BC    GT,PARMERR         IF NOT THEN PARM ERROR        AJSW208
         CLI   0(R1),C'L'         LIST CLASSES REQUEST          AJSW208
         BC    NE,PARMERR         NO,THEN INVALID PARAMETERS    AJSW208
*                                                               AJSW208
         MVI   WORKREC,C' '       INITIALIZE MESSAGE AREA       AJSW208
         MVC   WORKREC+1(L'WORKREC-1),WORKREC                   AJSW208
         MVI   WORKRECL,L'WORKREC-1 LENGTH OF MESSAGE LINE      AJSW208
         MVC   WORKRECM,=C'IATWC000I' SET MESSAGE PREFIX        AJSW208
         LA    R1,WORKRECD        -> DATA AREA                  AJSW208
         LA    R0,WORKREC#        NUMBER OF ENTRIES IN DISPLAY  AJSW208
*                                                               AJSW208
CMDL0200 DS    0H                                               AJSW208
         MVC   0(8,R1),CVERCNAM   COPY CLASS NAME               AJSW208
         LA    R1,9(,R1)          BUMP OUTPUT POINTER           AJSW208
         BCT   R0,CMDL0300        GET NEXT TABLE IF LINE ^ FULL AJSW208
*                                                               AJSW208
         LA    R2,WORKREC         -> TO DATA LINE               AJSW208
         LH    R0,XCONS           CONSOLE NUMBER                AJSW208
*                                                               AJSW208
         MESSAGE TEXT=0(,R2),     DISPLAY THE MESSAGE           AJSW208$
               CONS=(R0),                                       AJSW208$
               MF=(E,MSGXCONS)                                  AJSW208
*                                                               AJSW208
         MVI   WORKRECD,C' '      RE-INIT DATA AREA             AJSW208
         MVC   WORKRECD+1(L'WORKRECD-1),WORKRECD                AJSW208
         LA    R1,WORKRECD        -> DATA AREA                  AJSW208
         LA    R0,WORKREC#        NUMBER OF ENTRIES IN DISPLAY  AJSW208
*                                                               AJSW208
CMDL0300 DS    0H                                               AJSW208
         ICM   R2,B'1111',CVERCNXT OFFSET TO NEXT TABLE         AJSW208
         BC    ZERO,CMDL9900      EXIT IF NO MORE               AJSW208
         LA    R6,0(R2,R6)        -> TO NEXT TABLE              AJSW208
         B     CMDL0200           LOOP BACK FOR NEXT CLASS      AJSW208
         EJECT                                                  AJSW208
*******************                                             AJSW208
**                                                              AJSW208
**   LIST USER ID'S IN A SPECIFIC CLASS                         AJSW208
**                                                              AJSW208
*******************                                             AJSW208
*                                                               AJSW208
CMDL0400 DS    0H                                               AJSW208
         CLC   =C'C=',0(R1)       LIST USERS IN CLASS TABLE     AJSW208
         BC    NE,CMDL1100                                      AJSW208
         LR    R1,R0              -> CLASS NAME TO DISPLAY      AJSW208
         ICM   R2,B'1000',=X'00'  CLEAR HIGH ORDER BYTE         AJSW208
         CH    R2,=H'8'           LENGTH > MAX                  AJSW208
         BC    GT,PARMERR         IF SO, THEN PARM ERROR        AJSW208
         BCTR  R2,R0              DECREMNET LENGTH FOR MVC      AJSW208
         EX    R2,MVCNAME         SAVE CLASS NAME               AJSW208
*                                                               AJSW208
CMDL0500 CLC   TABLNAM,CVERCNAM   IT THIS THE TABLE WE WANT     AJSW208
         BC    EQ,CMDL0700        YES, DISPLAY USER ID'S        AJSW208
         ICM   R1,B'1111',CVERCNXT OFFSET TO NEXT TABLE         AJSW208
         BC    ZERO,CMDL0600      EXIT LOOP IF END.             AJSW208
         LA    R6,0(R1,R6)        -> TO NEXT CLASS TABLE        AJSW208
         B     CMDL0500           LOOP BACK FOR NEXT CHECK      AJSW208
*                                                               AJSW208
CMDL0600 DS    0H                                               AJSW208
         MVC   WORKREC(WC010#),IATWC010  MESSAGE TO WORK AREA   AJSW208
         MVC   WORKREC+WC010I1(L'WC010I1),TABLNAM CLASS NAME    AJSW208
         B     CMDL9910          WE'RE DONE                     AJSW208
*                                                               AJSW208
CMDL0700 DS    0H                                               AJSW208
         LA    R7,CVERCUSR        -> 1ST USER ENTRY             AJSW208
         SLR   R5,R5              CLEAR A WORK REGISTER         AJSW208
         ICM   R5,B'0011',CVERCEN# NUMBER OF USER ENTRIES       AJSW208
         BC    NZERO,CMDL0800     CONTINUE IF TABLE NOT EMPTY   AJSW208
         MVC   WORKREC(WC011#),IATWC011                         AJSW208
         MVC   WORKREC+WC011I1(L'WC011I1),TABLNAM CLASS NAME    AJSW208
         B     CMDL9910          WE'RE DONE                     AJSW208
*                                                               AJSW208
CMDL0800 DS    0H                                               AJSW208
         MVI   WORKREC,C' '       INITIALIZE MESSAGE AREA       AJSW208
         MVC   WORKREC+1(L'WORKREC-1),WORKREC                   AJSW208
         MVI   WORKRECL,L'WORKREC-1 LENGTH OF MESSAGE LINE      AJSW208
         MVC   WORKRECM,=C'IATWC000I' SET MESSAGE PREFIX        AJSW208
         LA    R1,WORKRECD        -> DATA AREA                  AJSW208
         LA    R0,WORKREC#        NUMBER OF ENTRIES IN DISPLAY  AJSW208
         SLR   R2,R2              CLEAR A WORK REGISTER         AJSW208
*                                                               AJSW208
CMDL0900 DS    0H                                               AJSW208
         IC    R2,CVERULNG        LENGTH -1 OF USER ENTRY       AJSW208
         EX    R2,MVCUSER         MOVE USER ID TO DISP. LINE    AJSW208
         LA    R1,9(,R1)          BUMP DISPLAY POINTER          AJSW208
         BCT   R0,CMDL1000        CONTINUE IF LINE NOT FULL     AJSW208
*                                                               AJSW208
         LA    R2,WORKREC         -> TO DATA LINE               AJSW208
         LH    R0,XCONS           CONSOLE NUMBER                AJSW208
*                                                               AJSW208
         MESSAGE TEXT=0(,R2),     DISPLAY THE MESSAGE           AJSW208$
               CONS=(R0),                                       AJSW208$
               MF=(E,MSGXCONS)                                  AJSW208
*                                                               AJSW208
         MVI   WORKRECD,C' '      RE-INIT DATA AREA             AJSW208
         MVC   WORKRECD+1(L'WORKRECD-1),WORKRECD                AJSW208
         LA    R1,WORKRECD        -> DATA AREA                  AJSW208
         LA    R0,WORKREC#        NUMBER OF ENTRIES IN DISPLAY  AJSW208
         SLR   R2,R2              CLEAR A WORK REGISTER         AJSW208
         IC    R2,CVERULNG        RESTORE LENGTH REGISTER       AJSW208
*                                                               AJSW208
CMDL1000 DS    0H                                               AJSW208
         LA    R7,2(R2,R7)        -> NEXT USER ENTRY            AJSW208
         BCT   R5,CMDL0900        LOOP BACK IF MORE ENTRIES     AJSW208
         B     CMDL9900           DONE WITH THIS REQUEST - EXIT AJSW208
         EJECT                                                  AJSW208
*******************                                             AJSW208
**                                                              AJSW208
**   LIST CLASS VALID FOR A USER ID                             AJSW208
**                                                              AJSW208
*******************                                             AJSW208
*                                                               AJSW208
CMDL1100 DS    0H                                               AJSW208
         CLC   =C'U=',0(R1)       LIST USERS                    AJSW208
         BNE   PARMERR            NO, THEN PARM ERROR           AJSW208
         LR    R1,R0              -> USER ID TO SEARCH FOR      AJSW208
         ICM   R2,B'1000',=X'00'  CLEAR HIGH ORDER BYTE         AJSW208
         CH    R2,=H'8'           LENGTH > MAX                  AJSW208
         BC    GT,PARMERR         IF SO, THEN PARM ERROR        AJSW208
         BCTR  R2,R0              DECREMNET LENGTH FOR MVC      AJSW208
         EX    R2,MVCNAME         SAVE USERID                   AJSW208
         STC   R2,BYTE            SAVE UID LENGTH               AJSW208
         MVI   FLAG1,0            INITIALIZE FLAG BYTE          AJSW208
         MVI   WORKREC,C' '       INITIALIZE MESSAGE AREA       AJSW208
         MVC   WORKREC+1(L'WORKREC-1),WORKREC                   AJSW208
         MVI   WORKRECL,L'WORKREC-1 LENGTH OF MESSAGE LINE      AJSW208
         MVC   WORKRECM,=C'IATWC000I' SET MESSAGE PREFIX        AJSW208
         LA    R1,WORKRECD        -> DATA AREA                  AJSW208
         LA    R0,WORKREC#        NUMBER OF ENTRIES IN DISPLAY  AJSW208
*                                                               AJSW208
CMDL1200 DS    0H                                               AJSW208
         SLR   R2,R2              CLEAR A WORK REGISTER         AJSW208
         SLR   R5,R5              CLEAR A WORK REGISTER         AJSW208
         ICM   R5,B'0011',CVERCEN# GET NUMBER OF UIDS           AJSW208
         BC    ZERO,CMDL1500       NEXT CLASS TABLE IF NONE     AJSW208
         LA    R7,CVERCUSR         -> TO FIRST UID              AJSW208
*                                                               AJSW208
CMDL1300 DS    0H                                               AJSW208
         CLC   CVERULNG,BYTE      TABLE LENGTH EXCEED INPUT     AJSW208
         BC    GT,CMDL1400        YES, THEN NO MATCH            AJSW208
         IC    R2,CVERULNG        GET LENGTH                    AJSW208
         EX    R2,CLCUSER         TABLE UID MATCH INPUT         AJSW208
         BC    NE,CMDL1400        NO, GET NEXT UID.             AJSW208
         MVC   0(8,R1),CVERCNAM   MOVE CLASS TO DISPLAY LINE    AJSW208
         OI    FLAG1,F1UID        REMEMBER WE FOUND THE UID     AJSW208
         LA    R1,9(,R1)          BUMP DISPLAY POINTER          AJSW208
         BCT   R0,CMDL1500        CONTINUE IF LINE NOT FULL     AJSW208
*                                                               AJSW208
         LA    R2,WORKREC         -> TO DATA LINE               AJSW208
         LH    R0,XCONS           CONSOLE NUMBER                AJSW208
*                                                               AJSW208
         MESSAGE TEXT=0(,R2),     DISPLAY THE MESSAGE           AJSW208$
               CONS=(R0),                                       AJSW208$
               MF=(E,MSGXCONS)                                  AJSW208
*                                                               AJSW208
         MVI   WORKRECD,C' '      RE-INIT DATA AREA             AJSW208
         MVC   WORKRECD+1(L'WORKRECD-1),WORKRECD                AJSW208
         LA    R1,WORKRECD        -> DATA AREA                  AJSW208
         LA    R0,WORKREC#        NUMBER OF ENTRIES IN DISPLAY  AJSW208
         B     CMDL1500           GET NEXT CLASS TABLE          AJSW208
*                                                               AJSW208
CMDL1400 DS    0H                                               AJSW208
         LA    R7,2(R2,R7)        -> NEXT UID                   AJSW208
         BCT   R5,CMDL1300        LOOP BACK FOR NEXT CHECK      AJSW208
*                                                               AJSW208
CMDL1500 DS    0H                                               AJSW208
         ICM   R2,B'1111',CVERCNXT OFFSET TO NEXT TABLE         AJSW208
         BC    ZERO,CMDL1600      SET UP FOR EXIT IF LAST TABLE AJSW208
         LA    R6,0(R2,R6)        -> NEXT TABLE                 AJSW208
         B     CMDL1200           GO CHECK THIS ONE             AJSW208
*                                                               AJSW208
CMDL1600 DS    0H                                               AJSW208
         TM    FLAG1,F1UID        UID FOUND                     AJSW208
         BC    ALLON,CMDL9900     YES,WE'RE DONE                AJSW208
         MVC   WORKREC(WC012#),IATWC012                         AJSW208
         MVC   WORKREC+WC012I1(L'WC012I1),TABLNAM               AJSW208
         B     CMDL9910           WHEW, FINALLY DONE            AJSW208
*                                                               AJSW208
CMDL9900 DS    0H                                               AJSW208
         C     R0,=A(WORKREC#)    PARTIAL DATA LINE             AJSW208
         BC    NE,CMDL9910        YES, SET EXIT MESSAGE ->      AJSW208
         SLR   R1,R1              NO,INDICATE NO MESSAGE        AJSW208
         B     CMDL9999           DONE                          AJSW208
*                                                               AJSW208
CMDL9910 DS    0H                                               AJSW208
         LA    R1,WORKREC         -> MESSAGE ON EXIT            AJSW208
*                                                               AJSW208
CMDL9999 DS    0H                                               AJSW208
         ST    R1,EXITMSG         DISP LAST LINE ON EXIT        AJSW208
         B     CVEREXIT           ALL DONE EXIT                 AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*                SERIALIZE THE RESTRICTED CLASS TABLE           AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
SERTAB   DS    0H                                               AJSW208
         SLR   R1,R1              CLEAR REG 1                   AJSW208
         L     R1,TVTUVER         -> TO CLASS TABLE             AJSW208
         LR    R15,R1             COPY ADDRESS TO UPDATE REG    AJSW208
         N     R1,CLEARBIT        SET VALUE TO TEST FOR         AJSW208
         O     R15,HIBIT          SET THE BUSY BIT FOR UPDATE   AJSW208
         CS    R1,R15,TVTUVER     ATTEMPT TO LOCK CLASS TABLE   AJSW208
         BNE   SERTAB1            DIDN'T DO IT, WAIT FOR UNLOCK AJSW208
         OI    FLAG1,F1LOCK       GOT IT....REMEMBER WE LOCKED  AJSW208
         BR    R14                RETURN TO CALLER              AJSW208
         ST    R14,SAV14          SAVE RETURN ADDRESS           AJSW208
*                                                               AJSW208
SERTAB1  DS    0H                                               AJSW208
         AWAIT TYPE=OFF,          WAIT FOR THE TABLE TO         AJSW208$
               ECFMASK=X'80',       TO BECOME AVAILABLE         AJSW208$
               ECFADD=TVTUVER                                   AJSW208
*                                                               AJSW208
         L     R14,SAV14          RESTORE RETURN ADDRESS        AJSW208
         B     SERTAB             TRY AGAIN TO GET THE TABLE    AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*            LOAD AND ALLOCATE THE CLASS RESTRICTION TABLE      AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
GETTAB   DS    0H                                               AJSW208
         ST    R14,SAV14          SAVE OUR RETURN ADDRESS       AJSW208
         XC    TABLSAVE,TABLSAVE  CLEAR TABLE ->                AJSW208
         ALOAD EPLOC=TABLNAM,     LOAD THE REQUESTED TABLE      AJSW208$
               CSECT=YES,                                       AJSW208$
               ERROR=GETT0400                                   AJSW208
*                                                               AJSW208
         LR    R1,R0              SAVE -> TO LOADED TABLE       AJSW208
         CLC   TABLNAM,CVERTNAM-CVERTABH(R1)                    AJSW208
         BC    NE,GETT0100        MOD NOT SAME AS IN PROLOG     AJSW208
         CLC   =C'CVER',CVERTVER-CVERTABH(R1)                   AJSW208
         BC    EQ,GETT0200        VALIDITY WORD IS OK           AJSW208
*                                                               AJSW208
GETT0100 DS    0H                                               AJSW208
         MVC   WORKREC(WC014#),IATWC014 MOVE MSG SKELETON       AJSW208
         MVC   WORKREC+WC014I1(L'WC014I1),TABLNAM               AJSW208
         LA    R1,WORKREC         GET MESSAGE -> AND            AJSW208
         ST    R1,EXITMSG            SAVE FOR EXIT              AJSW208
         B     GETT0300           DELETE MODULE BEFORE EXIT     AJSW208
*                                                               AJSW208
GETT0200 DS    0H                                               AJSW208
         ST    R1,FWORD           SAVE LOADMOD EPA              AJSW208
         L     R0,CVERTSIZ-CVERTABH(,R1) GET TABLE SIZE         AJSW208
*                                                               AJSW208
         AGETMAIN SIZE=(R0),      ALLOCATE THE TABLE            AJSW208$
               LOC=(ANY,ANY)                                    AJSW208
*                                                               AJSW208
         L     R14,FWORD          RESTORE -> LOADMOD            AJSW208
         LR    R0,R1              -> TABLE STORAGE              AJSW208
         ST    R0,TABLSAVE        SAVE TABLE ADDRESS            AJSW208
         L     R1,CVERTSIZ-CVERTABH(,R14) SET TGT LENGTH        AJSW208
         LR    R15,R1             SET SOURCE LENGTH             AJSW208
         MVCL  R0,R14             COPY LOADMOD TO THE TABLE     AJSW208
*                                                               AJSW208
GETT0300 DS    0H                                               AJSW208
         ADELETE EPLOC=TABLNAM                                  AJSW208
*                                                               AJSW208
         B     GETTEXIT           RETURN TO CALLER              AJSW208
*                                                               AJSW208
GETT0400 DS    0H                                               AJSW208
         MVC   WORKREC(WC006#),IATWC006                         AJSW208
         MVC   WORKREC+WC006I1(L'WC006I1),TABLNAM  TABLE NAME   AJSW208
*                                                               AJSW208
         ST    R0,FWORD           LOAD ABEND CODE               AJSW208
         UNPK  WORKREC+WC006I2(L'WC006I2),FWORD+2(3)            AJSW208
         TR    WORKREC+WC006I2(L'WC006I2-1),TRTAB-240           AJSW208
         MVI   WORKREC+WC006I2+L'WC006I2-1,C','                 AJSW208
*                                                               AJSW208
         ST    R1,FWORD           JES3 ABEND CODE               AJSW208
         UNPK  WORKREC+WC006I3(L'WC006I3),FWORD+2(3)            AJSW208
         TR    WORKREC+WC006I3(L'WC006I3-1),TRTAB-240           AJSW208
         MVI   WORKREC+WC006I3+L'WC006I3-1,C','                 AJSW208
*                                                               AJSW208
         ST    R15,FWORD          REASON CODE                   AJSW208
         UNPK  WORKREC+WC006I4(L'WC006I4),FWORD+2(3)            AJSW208
         TR    WORKREC+WC006I4(L'WC006I4-1),TRTAB-240           AJSW208
         MVI   WORKREC+WC006I4+L'WC006I4-1,C' '                 AJSW208
*                                                               AJSW208
         LA    R1,WORKREC                                       AJSW208
         ST    R1,EXITMSG         SAVE -> EXIT MESSAGE          AJSW208
*                                                               AJSW208
GETTEXIT DS    0H                                               AJSW208
         L     R1,TABLSAVE        SET RETURN -> TO TABLE        AJSW208
         L     R14,SAV14          GET RETURN ADDRESS            AJSW208
         BR    R14                   AND RETURN TO CALLER       AJSW208
*                                                               AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*                    ERROR ROUTINES                             AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
PARMERRT DS    0H                                               AJSW208
         OI    TVTUFLG2,TVTUCVLD  INDICATE TABLE LOADED         AJSW208
         B     CVEREXIT           WE'RE DONE, EXIT              AJSW208
*                                                               AJSW208
PARMERR  DS    0H                 INPUT PARAMETER ERROR         AJSW208
         LA    R1,IATWC001        GET -> TO ERROR MESSAGE       AJSW208
         ST    R1,EXITMSG            AND SAVE FOR EXIT ROUTINE  AJSW208
         B     CVEREXIT           ISSUE MESSAGE AND EXIT        AJSW208
*                                                               AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*            ISSUE EXIT MESSAGE AND RETURN TO JSS               AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
CVEREXIT DS    0H                                               AJSW208
         L     R9,CONSADDR        -> TO MESSAGE BUFFER          AJSW208
         IATXCNS TYPE=RELEASE,    RELEASE THE PARAMETER BUFFER  AJSW208$
               BUFFER=(R9)                                      AJSW208
*                                                               AJSW208
         ICM   R2,B'1111',EXITMSG -> TO EXIT MESSAGE            AJSW208
         BC    ZERO,CVERRET       JUST RETURN IF NO MESSAGE     AJSW208
         LH    R0,XCONS           ID OF CALLING CONSOLE         AJSW208
*                                                               AJSW208
         MESSAGE TEXT=0(,R2),     DISPLAY THE EXIT MESSAGE      AJSW208$
               CONS=(R0),           ON THE CALLING CONSOLE      AJSW208$
               MF=(E,MSGXCONS)                                  AJSW208
*                                                               AJSW208
CVERRET  DS    0H                                               AJSW208
         TM    FLAG1,F1LOCK       DID CVER LOCK THE CLASS TABLE AJSW208
         BZ    CVERRET1           NO, DON'T MESS WITH LOCK FLAG AJSW208
         NI    TVTUVER,TURNOFF-BUSYBIT YES, TURN OFF LOCK BIT   AJSW208
*                                                               AJSW208
CVERRET1 DS    0H                                               AJSW208
         LM    R14,R1,JSSRET      RELOAD JSS REGS               AJSW208
         SLR   R15,R15            INDICATE RETURN CODE ZERO     AJSW208
         BR    R14                RETURN TO JSS                 AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*                    CONSTANT DATA AREAS                        AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
CMDPRIM  DS    0H                 PRIMARY PARAMETER TABLE       AJSW208
         DC    C'T',AL4(CMDT)     LOAD CLASS TABLE              AJSW208
CMDPRIM# EQU   *-CMDPRIM          LENGTH OF 1 ENTRY             AJSW208
         DC    C'R',AL4(CMDR)     REPLACE CLASS TABLE           AJSW208
         DC    C'Q',AL4(CMDQ)     QUERY IF CLASS TABLE ACTIVE   AJSW208
         DC    C'L',AL4(CMDL)     LIST CLASS TABLE              AJSW208
         DC    C'C',AL4(CMDC)     CANCEL RESTRICED CLASS PROC.  AJSW208
         DC    X'FF'              END OF TABLE INDICATOR        AJSW208
*                                                               AJSW208
TRTAB    DC    C'0123456789ABCDEF' HEX->CHAR CONVERSIONTABLE    AJSW208
*                                                               AJSW208
MVCNAME  MVC   TABLNAM(0),0(R1)    **** OBJECT OF EXECUTE ****  AJSW208
MVCUSER  MVC   0(0,R1),CVERUNAM    **** OBJECT OF EXECUTE ****  AJSW208
CLCUSER  CLC   TABLNAM(0),CVERUNAM **** OBJECT OF EXECUTE ****  AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*                  LITERAL POOL                                 AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
         LTORG ,                                                AJSW208
         EJECT                                                  AJSW208
****************************************************************AJSW208
*                                                               AJSW208
*                       MESSAGES                                AJSW208
*                                                               AJSW208
****************************************************************AJSW208
*                                                               AJSW208
IATWC001 DS    0C                                               AJSW208
         DC    AL1(WC001#)        MESSAGE LENGTH                AJSW208
         DC    C'IATWC001E (CVER) INVALID PARAMETERS'           AJSW208
WC001#   EQU   *-IATWC001                                       AJSW208
*                                                               AJSW208
IATWC002 DS    0C                                               AJSW208
         DC    AL1(WC002#)                                      AJSW208
         DC    C'IATWC002I (CVER) '                             AJSW208
         DC    C'RESTRICTED CLASS CHECKING IS INACTIVE'         AJSW208
WC002#   EQU   *-IATWC002                                       AJSW208
*                                                               AJSW208
WC002A   DC    AL1(WC002A#)                                     AJSW208
         DC    C'IATWC002I (CVER) TABLE='                       AJSW208
WC002AI1 EQU   *-WC002A,8,C'C'    OFFSET TO INSERT              AJSW208
         DC    CL(L'WC002AI1)' '  NAME OF CLASS TABLE           AJSW208
         DC    C',CREATED='                                     AJSW208
WC002AI2 EQU   *-WC002A,8,C'C'    OFFSET TO INSERT              AJSW208
         DC    CL(L'WC002AI2)' '                                AJSW208
         DC    C' '                                             AJSW208
WC002AI3 EQU   *-WC002A,5,C'C'    OFFSET TO INSERT              AJSW208
         DC    CL(L'WC002AI3)' '                                AJSW208
WC002A#  EQU   *-WC002A                                         AJSW208
*                                                               AJSW208
IATWC003 DS    0C                                               AJSW208
         DC    AL1(WC003#)                                      AJSW208
         DC    C'IATWC003E (CVER) '                             AJSW208
         DC    C'RESTRICTED CLASS CHECKING IS NOT ACTIVE'       AJSW208
WC003#   EQU   *-IATWC003                                       AJSW208
*                                                               AJSW208
IATWC004 DS    0C                                               AJSW208
         DC    AL1(WC004#)                                      AJSW208
         DC    C'IATWC004I (CVER) '                             AJSW208
         DC    C'RESTRICTED CLASS CHECKING HAS BEEN DISABLED'   AJSW208
WC004#   EQU   *-IATWC004                                       AJSW208
*                                                               AJSW208
IATWC005 DS    0C                                               AJSW208
         DC    AL1(WC005#)                                      AJSW208
         DC    C'IATWC005E (CVER) '                             AJSW208
         DC    C'RESTRICTED CLASS TABLE CURRENTLY ACTIVE'       AJSW208
WC005#   EQU   *-IATWC005                                       AJSW208
*                                                               AJSW208
IATWC006 DS    0C                                               AJSW208
         DC    AL1(WC006#)                                      AJSW208
         DC    C'IATWC006E (CVER) '                             AJSW208
         DC    C'ERROR LOADING RESTRICTED CLASS TABLE '         AJSW208
WC006I1  EQU   *-IATWC006,8,C'C'                                AJSW208
         DC    CL8' '                                           AJSW208
         DC    C',R0='                                          AJSW208
WC006I2  EQU   *-IATWC006,3,C'C'                                AJSW208
         DC    CL5' '                                           AJSW208
         DC    C'R1='                                           AJSW208
WC006I3  EQU   *-IATWC006,5,C'C'                                AJSW208
         DC    CL5' '                                           AJSW208
         DC    C'R15='                                          AJSW208
WC006I4  EQU   *-IATWC006,3,C'C'                                AJSW208
         DC    CL5' '                                           AJSW208
WC006#   EQU   *-IATWC006                                       AJSW208
*                                                               AJSW208
IATWC007 DS    0C                                               AJSW208
         DC    AL1(WC007#)                                      AJSW208
         DC    C'IATWC007I (CVER) RESTRICTED CLASS TABLE '      AJSW208
WC007I1  EQU   *-IATWC007,8,C'C'                                AJSW208
         DC    CL(L'WC007I1)' '                                 AJSW208
         DC    C'SUCCESSFULLY LOADED'                           AJSW208
WC007#   EQU   *-IATWC007                                       AJSW208
*                                                               AJSW208
IATWC008 DS    0C                                               AJSW208
         DC    AL1(WC008#)                                      AJSW208
         DC    C'IATWC008I (CVER) RESTRICTED CLASS TABLE '      AJSW208
WC008I1  EQU   *-IATWC008,8,C'C'                                AJSW208
         DC    CL(L'WC008I1)' '                                 AJSW208
         DC    C' HAS BEEN REPLACED BY '                        AJSW208
WC008I2  EQU   *-IATWC008,8,C'C'                                AJSW208
         DC    CL(L'WC008I2)' '                                 AJSW208
WC008#   EQU   *-IATWC008                                       AJSW208
*                                                               AJSW208
IATWC009 DS    0C                                               AJSW208
         DC    AL1(WC009#)                                      AJSW208
         DC    C'IATWC009E (CVER) '                             AJSW208
         DC    C'THERE IS NO ACTIVE CLASS TABLE TO REPLACE'     AJSW208
WC009#   EQU   *-IATWC009                                       AJSW208
*                                                               AJSW208
IATWC010 DS    0C                                               AJSW208
         DC    AL1(WC010#)                                      AJSW208
         DC    C'IATWC010E (CVER) RESTRICTED CLASS TABLE FOR '  AJSW208
WC010I1  EQU   *-IATWC010,8,C'C'                                AJSW208
         DC    CL(L'WC010I1)' '                                 AJSW208
         DC    C' WAS NOT FOUND'                                AJSW208
WC010#   EQU   *-IATWC010                                       AJSW208
*                                                               AJSW208
IATWC011 DS    0C                                               AJSW208
         DC    AL1(WC011#)                                      AJSW208
         DC    C'IATWC011I (CVER)'                              AJSW208
         DC    C' THERE ARE NO ENTRIES IN RESTRICTED TABLE '    AJSW208
WC011I1  EQU   *-IATWC011,8,C'C'                                AJSW208
         DC    CL(L'WC011I1)' '                                 AJSW208
WC011#   EQU   *-IATWC011                                       AJSW208
*                                                               AJSW208
IATWC012 DS    0C                                               AJSW208
         DC    AL1(WC012#)                                      AJSW208
         DC    C'IATWC012I (CVER) NO MATCH FOUND FOR USER ID '  AJSW208
WC012I1  EQU   *-IATWC012,8,C'C'                                AJSW208
         DC    CL(L'WC012I1)' '                                 AJSW208
WC012#   EQU   *-IATWC012                                       AJSW208
*                                                               AJSW208
IATWC014 DS    0C                                               AJSW208
         DC    AL1(WC014#)                                      AJSW208
         DC    C'IATWC014E (CVER) '                             AJSW208
WC014I1  EQU   *-IATWC014,8,C'C'                                AJSW208
         DC    CL(L'WC014I1)' '                                 AJSW208
         DC    C' IS NOT A VALID RESTRICTED CLASS TABLE'        AJSW208
WC014#   EQU   *-IATWC014                                       AJSW208
*                                                               AJSW208
UMODNUM  DC    CL7'AJSW208'        USER NUMBER                  AJSW208
APARNUM  DC    CL5' '              APAR NUMBER                  AJSW208
PTFNUM   DC    CL5'SP215'          PTF NUMBER                   AJSW208
         END   CVER                                             AJSW208
++ SRC(CVERDATA) DISTLIB(ASRCLIB) .
CVERDATA TITLE '-- JOB CLASS RESTRICTION DATA CSECT'            AJSW208
CVERDATA AMODE 31                                               AJSW208
CVERDATA RMODE ANY                                              AJSW208
         CVERDATA TYPE=CSECT                                    AJSW208
         IATYEQU  ,                                             AJSW208
         IATYREG  ,                                             AJSW208
UMODNUM  DC    CL7'AJSW208'        USER NUMBER                  AJSW208
APARNUM  DC    CL5' '              APAR NUMBER                  AJSW208
PTFNUM   DC    CL5'SP215'          PTF  NUMBER                  AJSW208
         END   CVERDATA                                         AJSW208
++ MAC(CVERDATA) DISTLIB(AMACLIB) .
         MACRO                                                  AJSW208
         CVERDATA &TYPE=CSECT                                   AJSW208
         TITLE '''CVERDATA'' - DATA CSECT FOR ''CVER'' DSP.'    AJSW208
CVERDATA &TYPE                                                  AJSW208
         IATYASM                                                AJSW208
* USER MODS:                                                    AJSW208
*                                                               AJSW208
*      - REGISTER SAVE AREA FOR CVER DSP.                       AJSW208
*        *** THIS MODULE MUST BE LINKEDIT'D NOT RENT/REUS ***   AJSW208
*                                                               AJSW208
         USING CVERDATA,R13                                     AJSW208
         DC    9D'0'               STANDARD OS REG. SAVE AREA   AJSW208
         EJECT                                                  AJSW208
**                                                              AJSW208
*                                                               AJSW208
*        VARIABLE DATA AREAS                                    AJSW208
*                                                               AJSW208
**                                                              AJSW208
*                                                               AJSW208
JSSRET   DS    4A                  RETURN ADDRESS TO JSS        AJSW208
SAV14    DS    A                   MISC R14 SAVE                AJSW208
CONSADDR DS    A                   -> DSP CALLING CONSOLE BUF   AJSW208
EXITMSG  DC    A(0)                -> MESSAGE FOR EXIT          AJSW208
TABLSAVE DC   A(0)                 TABLE SAVE AREA              AJSW208
*                                                               AJSW208
FWORD    DC    F'0'                FULLWORD WORK AREA           AJSW208
         ORG   *-1                                              AJSW208
BYTE     DS    C                   1 BYTE WORK AREA             AJSW208
*                                                               AJSW208
XCONS    DC    H'0'                CALLING CONSOLE ID           AJSW208
WORKREC  DC    CL121' '            121 BYTE WORK AREA           AJSW208
         ORG   WORKREC                                          AJSW208
WORKRECL DS    AL1                 LENGTH OF MESSAGE            AJSW208
WORKRECM DS    CL9                 MESSAGE ID                   AJSW208
         DS    C                   ONE BYTE SEPERATOR           AJSW208
WORKRECD DS    CL(L'WORKREC-11)    DISPLAY LINE                 AJSW208
WORKREC# EQU   L'WORKRECD/9        NUMBER OF ENTRIES DSP LINE   AJSW208
TABLNAM  DC    CL8' '              NAME OF TABLE TO LOAD OR     AJSW208
*                                  NAME OF CLASS TO DISPLAY OR  AJSW208
*                                  NAME OF UID TO DISPLAY       AJSW208
*                                                               AJSW208
*******                                                         AJSW208
*                                                               AJSW208
*  MISC EQUATES                                                 AJSW208
*                                                               AJSW208
*******                                                         AJSW208
*                                                               AJSW208
BUSYBIT  EQU   X'80'               MASK TO INDICATE THE CLASS   AJSW208
*                                  TABLE IS IN USE              AJSW208
TURNOFF  EQU   X'FF'               MASK USED TO TURN OFF BITS   AJSW208
*                                                               AJSW208
HIBIT    DC    0F'0',X'80000000'   HIGH ORDER BIT MASK          AJSW208
CLEARBIT DC    0F'0',X'7FFFFFFF'   CLEAR HIGH ORDER MASK BIT    AJSW208
*                                                               AJSW208
FLAG1    DC    X'00'               MISC FLAGS BYTE              AJSW208
F1UID    EQU   X'80'               UID FOUND IN CLASS           AJSW208
F1LOCK   EQU   X'40'               CVER LOCKED CLASS TABLE      AJSW208
*                                                               AJSW208
         DC    0D'0'               ALIGN FOLLOWING              AJSW208
         SPACE 1                                                AJSW208
MSGXCONS MESSAGE MLG=YES,PRTY=7,   MESSAGE TO CALLING CONSOLE   AJSW208*
               CONS=XCONS,MF=L     BUILD CONTROL BLOCK ONLY     AJSW208
         MEND                                                   AJSW208
++ MAC(CVERTAB) DISTLIB(AMACLIB) .
         MACRO                                                  AJSW208
         CVERTAB ,                                              AJSW208
***********************************************************************
.*                                                                    *
.*       $MAC(CVERTAB)    PROD(JES3):                                 *
.*                                                                    *
.*       DESCRIPTIVE-NAME =                                           *
*                                                                     *
*              RESTRICTED CLASS CONTROL TABLE                         *
*                                                                     *
.*       USERMOD =  AJSW208                                           *
.*                  SUBSET OF AJSW208                                 *
.*                                                                    *
.*       STATUS = OS/VS2 HJS2215                                      *
.*                                                                    *
.*       FUNCTION = MAPS THE RESTRICTED CLASS TABLE AND USERID        *
.*                  MASKS ALLOWED TO USE THE RESTRICED CLASS.         *
.*                                                                    *
.*       CREATED BY = CVERTABLE (SEPERATELY ASSEMBLED MODULE)         *
.*                                                                    *
.*       POINTED TO BY = TVTUVER IN THE JES3 TVT                      *
.*                                                                    *
.*       SERIALIZATION =                                              *
.*                                                                    *
.*       LOCATION =                                                   *
.*                 MAIN STORAGE = SP 241                              *
.*                 AUXILIARY STORAGE = NONE                           *
.*                                                                    *
.*       RESTRICTIONS = NONE                                          *
.*                                                                    *
.*                                                                    *
.*       CHANGE ACTIVITY =                                            *
.*                                                                    *
*                                                                     *
*                                                                     *
***********************************************************************
*                                                               AJSW208
CVERTABH DSECT ,                  MAP OF TABLE HEADER           AJSW208
CVERTSIZ DS    A                  SIZE OF ENTIRE TABLE          AJSW208
CVERTNAM DS    CL8                NAME OF THIS TABLE            AJSW208
CVERTDAT DS    CL8                DATE TABLE CREATED            AJSW208
CVERTTIM DS    CL5                TIME TABLE CREATED            AJSW208
CVERTVER DC    CL4'CVER'          VERIFICATION WORD             AJSW208
         DS    XL3                                              AJSW208
CVERTCTB DS    0X                 START OF FIRST CLASS TABLE    AJSW208
*                                                               AJSW208
CVERCTAB DSECT ,                  MAP OF CLASS TABLE HEADER     AJSW208
CVERCNAM DS    CL8                NAME OF RESTRICTED CLASS      AJSW208
CVERCNXT DS    XL4                OFFSET TO NEXT CLASS TABLE    AJSW208
*                                 ZERO IF LAST CLASS TABLE      AJSW208
CVERCEN# DS    XL2                NUMBER OF USER ENTRIES IN     AJSW208
*                                 THIS CLASS TABLE              AJSW208
CVERCUSR DS    0X                 FIRST USER ENTRY FOR CLASS    AJSW208
*                                                               AJSW208
CVERUTAB DSECT ,                  MAP OF USER ENTRY             AJSW208
CVERULNG DS    X                  LENGTH OF USER NAME -1        AJSW208
CVERUNAM DS    X                  USER NAME                     AJSW208
*                                                               AJSW208
         MEND                                                   AJSW208

++USERMOD (A$$W005)   /*
      THIS USERMOD IS TO INSTALL THE
      DATA ENCRYPTION STANDARD SVC

      SVC = 209 - TYPE 4
                                                     07/26/88 BRM  */.
++VER (Z038) FMID(A$$SVCS) .
++JCLIN .
//A$$W005 JOB WC07N0323,'W1-5311  CR SINGER'
//LPASVC  EXEC LINKS,
// PARM='NCAL,LIST,XREF,LET,REUS,RENT',
//    UNIT='3380',SER=IPLXXX,N=SYS2,NAME=HSSLPA,P1=' ',
//    MOD=,P2=' ',OBJ=OBJPDS01,CLASS=T
//SYSLIN   DD  *
   INCLUDE SYSPUNCH(WCSVC209)
   NAME WCSVC209(R)
/*
++SRC (WCSVC209) DISTLIB(ASRCLIB)  .
         TITLE 'SVC 209 - DATA ENCRYPTION'
WCSVC209 CSECT
*
*  THIS SVC ENCRYPTS 8 BYTES OF DATA ACCORDING TO THE NATIONAL BUREAU
*  OF STANDARDS DATA ENCRYPTION STANDARD.
*
*  AT ENTRY, REG 1 MUST POINT TO A PARAMETER LIST CONTAINING:
*       WORD 1:  ADDRESS OF INPUT DATA (8 BYTES)
*       WORD 2:  ADDRESS OF KEY (8 BYTES) TO USE IN ENCRYPTION
*                (NOTE:  IF THIS KEY IS ZERO, A KEY WILL BE GENERATED
*                BY REVERSING THE INPUT ON A BIT-BY-BIT BASIS.)
*       WORD 3:  ADDRESS OF OUTPUT AREA (8 BYTES) - AT EXIT, THIS
*                FIELD WILL CONTAIN THE ENCRYPTED DATA
*
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         USING WCSVC209,R12
         USING WORK,R13       ADDRESSABILITY FOR WORK AREA
         USING PARMS,R10      ADDRESSABILITY FOR PARMLIST
         LR    R12,R6
         LR    R10,R1         R10 - SAVE PARM PTR
*
         LA    R0,WORKLEN
         GETMAIN R,LV=(0)     GET AREA FOR SAVE AND KEYS
         LR    R13,R1         R13 PTS TO SAVE AREA
*
         ST    R14,SAVE       SAVE RETURN ADDRESS
*
         CALL  KEYGEN         GENERATE KEYS
*
         L     R8,IN          GET ADDRESS OF INPUT DATA
         LM    R2,R3,0(R8)    LOAD INPUT DATA
         BAL   R14,IP         DO INITIAL PERMUTATION - RESULT IN R2,R3
*
         LA    R11,KEYS       GET ADDRESS OF KEYS
         LA    R9,16          COUNTER
MAINLOOP EQU   *
         CALL  MAINSUB        GENERATE NEXT L,R - RESULT IN R2,R3
         LA    R11,8(R11)     GET ADDR OF NEXT KEY
         BCT   R9,MAINLOOP
*
         BAL   R14,IPINV      DO INVERSE INITIAL PERMUTATION
         L     R8,OUT         LOAD ADDR FOR OUTPUT
         STM   R2,R3,0(R8)    STORE OUTPUT
*
         L     R14,SAVE       RESTORE R14
         LR    R1,R13
         LA    R0,WORKLEN
         FREEMAIN R,LV=(0),A=(R1)  FREE GETMAINED AREA
         LR    R1,R10         RESTORE R1
         BR    R14
*
*
IP       EQU   *
         XR    R6,R6
         XR    R7,R7
*** IP START
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,6
         SLDL  R4,63
*        SRDL  R4,0
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,14
         SLDL  R4,63
         SRDL  R4,1
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,22
         SLDL  R4,63
         SRDL  R4,2
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,30
         SLDL  R4,63
         SRDL  R4,3
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,38
         SLDL  R4,63
         SRDL  R4,4
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,46
         SLDL  R4,63
         SRDL  R4,5
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,54
         SLDL  R4,63
         SRDL  R4,6
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,62
         SLDL  R4,63
         SRDL  R4,7
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,4
         SLDL  R4,63
         SRDL  R4,8
         OR    R6,R4
*        OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,12
         SLDL  R4,63
         SRDL  R4,9
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,20
         SLDL  R4,63
         SRDL  R4,10
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,28
         SLDL  R4,63
         SRDL  R4,11
         OR    R6,R4
*        OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,36
         SLDL  R4,63
         SRDL  R4,12
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,44
         SLDL  R4,63
         SRDL  R4,13
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,52
         SLDL  R4,63
         SRDL  R4,14
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,60
         SLDL  R4,63
         SRDL  R4,15
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,2
         SLDL  R4,63
         SRDL  R4,16
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,10
         SLDL  R4,63
         SRDL  R4,17
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,18
         SLDL  R4,63
         SRDL  R4,18
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,26
         SLDL  R4,63
         SRDL  R4,19
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,34
         SLDL  R4,63
         SRDL  R4,20
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,42
         SLDL  R4,63
         SRDL  R4,21
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,50
         SLDL  R4,63
         SRDL  R4,22
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,58
         SLDL  R4,63
         SRDL  R4,23
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
*        SRDL  R4,0
         SLDL  R4,63
         SRDL  R4,24
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,8
         SLDL  R4,63
         SRDL  R4,25
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,16
         SLDL  R4,63
         SRDL  R4,26
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,24
         SLDL  R4,63
         SRDL  R4,27
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,32
         SLDL  R4,63
         SRDL  R4,28
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,40
         SLDL  R4,63
         SRDL  R4,29
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,48
         SLDL  R4,63
         SRDL  R4,30
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,56
         SLDL  R4,63
         SRDL  R4,31
         OR    R6,R4
*        OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,7
         SLDL  R4,63
         SRDL  R4,32
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,15
         SLDL  R4,63
         SRDL  R4,33
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,23
         SLDL  R4,63
         SRDL  R4,34
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,31
         SLDL  R4,63
         SRDL  R4,35
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,39
         SLDL  R4,63
         SRDL  R4,36
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,47
         SLDL  R4,63
         SRDL  R4,37
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,55
         SLDL  R4,63
         SRDL  R4,38
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,63
         SLDL  R4,63
         SRDL  R4,39
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,5
         SLDL  R4,63
         SRDL  R4,40
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,13
         SLDL  R4,63
         SRDL  R4,41
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,21
         SLDL  R4,63
         SRDL  R4,42
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,29
         SLDL  R4,63
         SRDL  R4,43
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,37
         SLDL  R4,63
         SRDL  R4,44
*        OR    R6,R4
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,45
         SLDL  R4,63
         SRDL  R4,45
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,53
         SLDL  R4,63
         SRDL  R4,46
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,61
         SLDL  R4,63
         SRDL  R4,47
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,3
         SLDL  R4,63
         SRDL  R4,48
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,11
         SLDL  R4,63
         SRDL  R4,49
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,19
         SLDL  R4,63
         SRDL  R4,50
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,27
         SLDL  R4,63
         SRDL  R4,51
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,35
         SLDL  R4,63
         SRDL  R4,52
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,43
         SLDL  R4,63
         SRDL  R4,53
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,51
         SLDL  R4,63
         SRDL  R4,54
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,59
         SLDL  R4,63
         SRDL  R4,55
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,1
         SLDL  R4,63
         SRDL  R4,56
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,9
         SLDL  R4,63
         SRDL  R4,57
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,17
         SLDL  R4,63
         SRDL  R4,58
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,25
         SLDL  R4,63
         SRDL  R4,59
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,33
         SLDL  R4,63
         SRDL  R4,60
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,41
         SLDL  R4,63
         SRDL  R4,61
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,49
         SLDL  R4,63
         SRDL  R4,62
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,57
         SLDL  R4,63
         SRDL  R4,63
         OR    R7,R5
*
***  IP END
         LR    R2,R6
         LR    R3,R7
         BR    R14
IPINV    EQU   *
         XR    R6,R6
         XR    R7,R7
*** IPINV START
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,24
         SLDL  R4,63
*        SRDL  R4,0
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,56
         SLDL  R4,63
         SRDL  R4,1
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,16
         SLDL  R4,63
         SRDL  R4,2
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,48
         SLDL  R4,63
         SRDL  R4,3
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,8
         SLDL  R4,63
         SRDL  R4,4
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,40
         SLDL  R4,63
         SRDL  R4,5
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
*        SRDL  R4,0
         SLDL  R4,63
         SRDL  R4,6
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,32
         SLDL  R4,63
         SRDL  R4,7
         OR    R6,R4
*        OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,25
         SLDL  R4,63
         SRDL  R4,8
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,57
         SLDL  R4,63
         SRDL  R4,9
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,17
         SLDL  R4,63
         SRDL  R4,10
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,49
         SLDL  R4,63
         SRDL  R4,11
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,9
         SLDL  R4,63
         SRDL  R4,12
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,41
         SLDL  R4,63
         SRDL  R4,13
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,1
         SLDL  R4,63
         SRDL  R4,14
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,33
         SLDL  R4,63
         SRDL  R4,15
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,26
         SLDL  R4,63
         SRDL  R4,16
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,58
         SLDL  R4,63
         SRDL  R4,17
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,18
         SLDL  R4,63
         SRDL  R4,18
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,50
         SLDL  R4,63
         SRDL  R4,19
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,10
         SLDL  R4,63
         SRDL  R4,20
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,42
         SLDL  R4,63
         SRDL  R4,21
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,2
         SLDL  R4,63
         SRDL  R4,22
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,34
         SLDL  R4,63
         SRDL  R4,23
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,27
         SLDL  R4,63
         SRDL  R4,24
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,59
         SLDL  R4,63
         SRDL  R4,25
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,19
         SLDL  R4,63
         SRDL  R4,26
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,51
         SLDL  R4,63
         SRDL  R4,27
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,11
         SLDL  R4,63
         SRDL  R4,28
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,43
         SLDL  R4,63
         SRDL  R4,29
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,3
         SLDL  R4,63
         SRDL  R4,30
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,35
         SLDL  R4,63
         SRDL  R4,31
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,28
         SLDL  R4,63
         SRDL  R4,32
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,60
         SLDL  R4,63
         SRDL  R4,33
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,20
         SLDL  R4,63
         SRDL  R4,34
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,52
         SLDL  R4,63
         SRDL  R4,35
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,12
         SLDL  R4,63
         SRDL  R4,36
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,44
         SLDL  R4,63
         SRDL  R4,37
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,4
         SLDL  R4,63
         SRDL  R4,38
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,36
         SLDL  R4,63
         SRDL  R4,39
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,29
         SLDL  R4,63
         SRDL  R4,40
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,61
         SLDL  R4,63
         SRDL  R4,41
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,21
         SLDL  R4,63
         SRDL  R4,42
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,53
         SLDL  R4,63
         SRDL  R4,43
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,13
         SLDL  R4,63
         SRDL  R4,44
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,45
         SLDL  R4,63
         SRDL  R4,45
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,5
         SLDL  R4,63
         SRDL  R4,46
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,37
         SLDL  R4,63
         SRDL  R4,47
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,30
         SLDL  R4,63
         SRDL  R4,48
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,62
         SLDL  R4,63
         SRDL  R4,49
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,22
         SLDL  R4,63
         SRDL  R4,50
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,54
         SLDL  R4,63
         SRDL  R4,51
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,14
         SLDL  R4,63
         SRDL  R4,52
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,46
         SLDL  R4,63
         SRDL  R4,53
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,6
         SLDL  R4,63
         SRDL  R4,54
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,38
         SLDL  R4,63
         SRDL  R4,55
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,31
         SLDL  R4,63
         SRDL  R4,56
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,63
         SLDL  R4,63
         SRDL  R4,57
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,23
         SLDL  R4,63
         SRDL  R4,58
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,55
         SLDL  R4,63
         SRDL  R4,59
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,15
         SLDL  R4,63
         SRDL  R4,60
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,47
         SLDL  R4,63
         SRDL  R4,61
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,7
         SLDL  R4,63
         SRDL  R4,62
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,39
         SLDL  R4,63
         SRDL  R4,63
         OR    R7,R5
*
***  IPINV END
         LR    R2,R6
         LR    R3,R7
         BR    R14
         EJECT
WORK     DSECT                MAPPING FOR GETMAINED WORK AREA
SAVE     DS    18F
KEYS     DS    32F            FOR 16 GENERATED KEYS
WORKLEN  EQU   *-WORK
*
PARMS    DSECT
IN       DS    F
KEY      DS    F
OUT      DS    F
         DROP  R12
         EJECT
KEYGEN   CSECT
         STM   R14,R12,12(R13)
         USING KEYGEN,R12
         USING PARMS,R10     ADDRESSABILITY OF WCSVC209 PARMS
         USING WORK,R13      ADDRESSABILITY OF WCSVC209 WORKAREA
         LR    R12,R15
         L     R9,KEY        GET ADDR OF INPUT KEY
         LM    R2,R3,0(R9)   GET INPUT KEY
         LTR   R2,R2
         BNZ   KBEGIN
         LTR   R3,R3
         BNZ   KBEGIN
         BAL   R14,KGEN      IF ZERO, GENERATE KEY FROM INPUT DATA
KBEGIN   EQU   *
         LA    R11,KEYS      GET ADDRESS OF AREA FOR KEYS
         XR    R6,R6
         XR    R7,R7
         BAL   R14,KPC1
         BAL   R14,KSHIFT1   KEY1
         BAL   R14,KSHIFT1   KEY2
         LA    R9,6
KLOOP1   BAL   R14,KSHIFT2   KEY3-KEY8
         BCT   R9,KLOOP1
         BAL   R14,KSHIFT1   KEY9
         LA    R9,6
KLOOP2   BAL   R14,KSHIFT2   KEY10-KEY15
         BCT   R9,KLOOP2
         BAL   R14,KSHIFT1   KEY16
*
         LM    R14,R12,12(R13)
         BR    R14
*
KGEN     EQU   *             GENERATE KEY BY FLIPPING INPUT DATA
         L     R11,IN        GET ADDR OF INPUT DATA
         L     R2,0(,R11)
         BAL   R8,KGLOOP1
         ST    R4,4(,R9)
         L     R2,4(,R11)
         BAL   R8,KGLOOP1
         ST    R4,0(,R9)     STORE RESULT IN INPUT KEY AREA
         LM    R2,R3,0(R9)      AND RELOAD R2,R3
         BR    R14
KGLOOP1  LA    R6,32
KGLOOP2  SRDL  R2,1
         SRL   R3,31
         SLL   R4,1
         OR    R4,R3
         BCT   R6,KGLOOP2
         BR    R8
KSHIFT1  EQU   *
         LR    R5,R2
         XR    R4,R4
         SLDL  R4,1  *
         SLL   R4,4
         OR    R5,R4
         LR    R2,R5
         LR    R5,R3
         XR    R4,R4
         SLDL  R4,1  *
         SLL   R4,4
         OR    R5,R4
         LR    R3,R5
         B     KPC2
KSHIFT2  EQU   *
         LR    R5,R2
         XR    R4,R4
         SLDL  R4,2  *
         SLL   R4,4
         OR    R5,R4
         LR    R2,R5
         LR    R5,R3
         XR    R4,R4
         SLDL  R4,2  *
         SLL   R4,4
         OR    R5,R4
         LR    R3,R5
         B     KPC2
*
KPC1     EQU   *
***   PC1 START
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,7
         SLDL  R4,63
*        SRDL  R4,0
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,15
         SLDL  R4,63
         SRDL  R4,1
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,23
         SLDL  R4,63
         SRDL  R4,2
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,31
         SLDL  R4,63
         SRDL  R4,3
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,39
         SLDL  R4,63
         SRDL  R4,4
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,47
         SLDL  R4,63
         SRDL  R4,5
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,55
         SLDL  R4,63
         SRDL  R4,6
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,63
         SLDL  R4,63
         SRDL  R4,7
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,6
         SLDL  R4,63
         SRDL  R4,8
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,14
         SLDL  R4,63
         SRDL  R4,9
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,22
         SLDL  R4,63
         SRDL  R4,10
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,30
         SLDL  R4,63
         SRDL  R4,11
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,38
         SLDL  R4,63
         SRDL  R4,12
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,46
         SLDL  R4,63
         SRDL  R4,13
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,54
         SLDL  R4,63
         SRDL  R4,14
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,62
         SLDL  R4,63
         SRDL  R4,15
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,5
         SLDL  R4,63
         SRDL  R4,16
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,13
         SLDL  R4,63
         SRDL  R4,17
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,21
         SLDL  R4,63
         SRDL  R4,18
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,29
         SLDL  R4,63
         SRDL  R4,19
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,37
         SLDL  R4,63
         SRDL  R4,20
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,45
         SLDL  R4,63
         SRDL  R4,21
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,53
         SLDL  R4,63
         SRDL  R4,22
         OR    R6,R4
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,61
         SLDL  R4,63
         SRDL  R4,23
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,4
         SLDL  R4,63
         SRDL  R4,24
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,12
         SLDL  R4,63
         SRDL  R4,25
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,20
         SLDL  R4,63
         SRDL  R4,26
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,28
         SLDL  R4,63
         SRDL  R4,27
         OR    R6,R4
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,1
         SLDL  R4,63
         SRDL  R4,32
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,9
         SLDL  R4,63
         SRDL  R4,33
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,17
         SLDL  R4,63
         SRDL  R4,34
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,25
         SLDL  R4,63
         SRDL  R4,35
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,33
         SLDL  R4,63
         SRDL  R4,36
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,41
         SLDL  R4,63
         SRDL  R4,37
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,49
         SLDL  R4,63
         SRDL  R4,38
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,57
         SLDL  R4,63
         SRDL  R4,39
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,2
         SLDL  R4,63
         SRDL  R4,40
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,10
         SLDL  R4,63
         SRDL  R4,41
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,18
         SLDL  R4,63
         SRDL  R4,42
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,26
         SLDL  R4,63
         SRDL  R4,43
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,34
         SLDL  R4,63
         SRDL  R4,44
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,42
         SLDL  R4,63
         SRDL  R4,45
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,50
         SLDL  R4,63
         SRDL  R4,46
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,58
         SLDL  R4,63
         SRDL  R4,47
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,3
         SLDL  R4,63
         SRDL  R4,48
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,11
         SLDL  R4,63
         SRDL  R4,49
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,19
         SLDL  R4,63
         SRDL  R4,50
         OR    R7,R5
*
*        LR    R4,R2
         LR    R5,R3
         SRDL  R4,27
         SLDL  R4,63
         SRDL  R4,51
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,35
         SLDL  R4,63
         SRDL  R4,52
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,43
         SLDL  R4,63
         SRDL  R4,53
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,51
         SLDL  R4,63
         SRDL  R4,54
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,59
         SLDL  R4,63
         SRDL  R4,55
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,36
         SLDL  R4,63
         SRDL  R4,56
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,44
         SLDL  R4,63
         SRDL  R4,57
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,52
         SLDL  R4,63
         SRDL  R4,58
         OR    R7,R5
*
         LR    R4,R2
*        LR    R5,R3
         SRDL  R4,60
         SLDL  R4,63
         SRDL  R4,59
         OR    R7,R5
***   PC1 END
         LR    R2,R6
         LR    R3,R7
         BR    R14
*
KPC2     EQU   *
         XR    R6,R6
         XR    R7,R7
***  PC2 START
         LR    R4,R2
         SRL   R4,18
         SLL   R4,31
*        SRL   R4,0
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,15
         SLL   R4,31
         SRL   R4,1
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,21
         SLL   R4,31
         SRL   R4,2
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,8
         SLL   R4,31
         SRL   R4,3
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,31
         SLL   R4,31
         SRL   R4,4
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,27
         SLL   R4,31
         SRL   R4,5
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,29
         SLL   R4,31
         SRL   R4,6
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,4
         SLL   R4,31
         SRL   R4,7
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,17
         SLL   R4,31
         SRL   R4,8
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,26
         SLL   R4,31
         SRL   R4,9
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,11
         SLL   R4,31
         SRL   R4,10
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,22
         SLL   R4,31
         SRL   R4,11
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,9
         SLL   R4,31
         SRL   R4,12
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,13
         SLL   R4,31
         SRL   R4,13
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,20
         SLL   R4,31
         SRL   R4,14
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,28
         SLL   R4,31
         SRL   R4,15
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,6
         SLL   R4,31
         SRL   R4,16
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,24
         SLL   R4,31
         SRL   R4,17
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,16
         SLL   R4,31
         SRL   R4,18
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,25
         SLL   R4,31
         SRL   R4,19
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,5
         SLL   R4,31
         SRL   R4,20
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,12
         SLL   R4,31
         SRL   R4,21
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,19
         SLL   R4,31
         SRL   R4,22
         OR    R6,R4
*
         LR    R4,R2
         SRL   R4,30
         SLL   R4,31
         SRL   R4,23
         OR    R6,R4
*
         LR    R5,R3
         SRL   R5,19
         SLL   R5,31
*        SRL   R5,0
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,8
         SLL   R5,31
         SRL   R5,1
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,29
         SLL   R5,31
         SRL   R5,2
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,23
         SLL   R5,31
         SRL   R5,3
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,13
         SLL   R5,31
         SRL   R5,4
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,5
         SLL   R5,31
         SRL   R5,5
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,30
         SLL   R5,31
         SRL   R5,6
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,20
         SLL   R5,31
         SRL   R5,7
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,9
         SLL   R5,31
         SRL   R5,8
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,15
         SLL   R5,31
         SRL   R5,9
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,27
         SLL   R5,31
         SRL   R5,10
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,12
         SLL   R5,31
         SRL   R5,11
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,16
         SLL   R5,31
         SRL   R5,12
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,11
         SLL   R5,31
         SRL   R5,13
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,21
         SLL   R5,31
         SRL   R5,14
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,4
         SLL   R5,31
         SRL   R5,15
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,26
         SLL   R5,31
         SRL   R5,16
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,7
         SLL   R5,31
         SRL   R5,17
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,14
         SLL   R5,31
         SRL   R5,18
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,18
         SLL   R5,31
         SRL   R5,19
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,10
         SLL   R5,31
         SRL   R5,20
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,24
         SLL   R5,31
         SRL   R5,21
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,31
         SLL   R5,31
         SRL   R5,22
         OR    R7,R5
*
         LR    R5,R3
         SRL   R5,28
         SLL   R5,31
         SRL   R5,23
         OR    R7,R5
*
***  PC2 END
         STM   R6,R7,0(R11)
         LA    R11,8(R11)
         BR    R14
         DROP  R12
         EJECT
MAINSUB  CSECT
         STM   R14,R12,12(R13)
         USING MAINSUB,R12
         LR    R12,R15
*
         XR    R6,R6
         XR    R7,R7
         LR    R4,R3
         LR    R5,R3
         SRDL  R4,1
*
         LA    R8,8
ERLOOP   EQU   *
         XR    R4,R4
         SLDL  R4,6
         OR    R7,R4
         SLDL  R6,6
         SRDL  R4,2
         BCT   R8,ERLOOP
*
         SLDL  R6,2
         SLL   R6,8
*
         LR    R4,R6
         SRL   R6,30
         SLL   R6,8
         OR    R7,R6
         LR    R5,R7
*                             R4,R5 = E(R)
         LM    R6,R7,0(R11)
         XR    R4,R6
         XR    R5,R7
*                             R4,R5 = E(R) (+) K
         LA    R11,STABLE
         XR    R10,R10
         LR    R7,R4
SBLOOP1  EQU   *
         LA    R1,4
*
SBLOOP2  EQU   *
         XR    R6,R6
         SLDL  R6,6
         LR    R8,R6
         SRDL  R6,1
         SRL   R6,4
         SLDL  R6,1
         SLL   R6,4
         SRDL  R8,5
         SRL   R9,28
         OR    R9,R6
         SLL   R10,4
         XR    R15,R15
         IC    R15,0(R9,R11)
         OR    R10,R15
         LA    R11,64(R11)
         BCT   R1,SBLOOP2
*
         LA    R15,STABEND
         CR    R11,R15
         BNL   SBEND
         LR    R7,R5
         B     SBLOOP1
*
SBEND    EQU   *
         LR    R4,R10         R4 = S(B1...B8)
         B     MSPERM
*
STABLE   DS    0F
S1       DC    XL16'0E040D01020F0B08030A060C05090007'
         DC    XL16'000F07040E020D010A060C0B09050308'
         DC    XL16'04010E080D06020B0F0C0907030A0500'
         DC    XL16'0F0C080204090107050B030E0A00060D'
S2       DC    XL16'0F01080E060B03040907020D0C00050A'
         DC    XL16'030D04070F02080E0C00010A06090B05'
         DC    XL16'000E070B0A040D0105080C060903020F'
         DC    XL16'0D080A01030F04020B06070C00050E09'
S3       DC    XL16'0A00090E06030F05010D0C070B040208'
         DC    XL16'0D0700090304060A0208050E0C0B0F01'
         DC    XL16'0D060409080F03000B01020C050A0E07'
         DC    XL16'010A0D0006090807040F0E030B05020C'
S4       DC    XL16'070D0E030006090A010208050B0C040F'
         DC    XL16'0D080B05060F00030407020C010A0E09'
         DC    XL16'0A0609000C0B070D0F01030E05020804'
         DC    XL16'030F00060A010D080904050B0C07020E'
S5       DC    XL16'020C0401070A0B060805030F0D000E09'
         DC    XL16'0E0B020C04070D0105000F0A03090806'
         DC    XL16'0402010B0A0D07080F090C050603000E'
         DC    XL16'0B080C07010E020D060F00090A040503'
S6       DC    XL16'0C010A0F09020608000D03040E07050B'
         DC    XL16'0A0F0402070C090506010D0E000B0308'
         DC    XL16'090E0F0502080C030700040A010D0B06'
         DC    XL16'0403020C09050F0A0B0E01070600080D'
S7       DC    XL16'040B020E0F00080D030C0907050A0601'
         DC    XL16'0D000B070409010A0E03050C020F0806'
         DC    XL16'01040B0D0C03070E0A0F060800050902'
         DC    XL16'060B0D0801040A070905000F0E02030C'
S8       DC    XL16'0D020804060F0B010A09030E05000C07'
         DC    XL16'010F0D080A0307040C05060B000E0902'
         DC    XL16'070B0401090C0E0200060A0D0F030508'
         DC    XL16'02010E07040A080D0F0C09000305060B'
STABEND  DS    F
*
MSPERM   EQU   *
         XR    R6,R6
***   PERM START
         LR    R5,R4
         SRL   R5,16
         SLL   R5,31
*        SRL   R5,0
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,25
         SLL   R5,31
         SRL   R5,1
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,12
         SLL   R5,31
         SRL   R5,2
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,11
         SLL   R5,31
         SRL   R5,3
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,3
         SLL   R5,31
         SRL   R5,4
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,10
         SLL   R5,31
         SRL   R5,5
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,4
         SLL   R5,31
         SRL   R5,6
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,15
         SLL   R5,31
         SRL   R5,7
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,31
         SLL   R5,31
         SRL   R5,8
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,17
         SLL   R5,31
         SRL   R5,9
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,11
         SLL   R5,31
         SRL   R5,10
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,6
         SLL   R5,31
         SRL   R5,11
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,27
         SLL   R5,31
         SRL   R5,12
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,14
         SLL   R5,31
         SRL   R5,13
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,1
         SLL   R5,31
         SRL   R5,14
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,22
         SLL   R5,31
         SRL   R5,15
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,30
         SLL   R5,31
         SRL   R5,16
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,24
         SLL   R5,31
         SRL   R5,17
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,8
         SLL   R5,31
         SRL   R5,18
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,18
         SLL   R5,31
         SRL   R5,19
         OR    R6,R5
*
         LR    R5,R4
*        SRL   R5,0
         SLL   R5,31
         SRL   R5,20
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,5
         SLL   R5,31
         SRL   R5,21
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,29
         SLL   R5,31
         SRL   R5,22
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,23
         SLL   R5,31
         SRL   R5,23
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,13
         SLL   R5,31
         SRL   R5,24
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,19
         SLL   R5,31
         SRL   R5,25
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,2
         SLL   R5,31
         SRL   R5,26
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,26
         SLL   R5,31
         SRL   R5,27
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,10
         SLL   R5,31
         SRL   R5,28
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,21
         SLL   R5,31
         SRL   R5,29
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,28
         SLL   R5,31
         SRL   R5,30
         OR    R6,R5
*
         LR    R5,R4
         SRL   R5,7
         SLL   R5,31
         SRL   R5,31
         OR    R6,R5
*
***  PERM END
         LR    R4,R6
*
         XR    R4,R2
         LR    R2,R3
         LR    R3,R4
         LM    R14,R1,12(R13)
         LM    R4,R12,36(R13)
         BR    R14
         END

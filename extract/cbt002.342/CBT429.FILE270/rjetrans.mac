STATEOFF
REPORT
FILE IN01 STATUS END01 INREC1     80
FILE IN02 STATUS END02 INREC2     80
FILE IN03 STATUS END03 INREC3     80
FILE IN04 STATUS END04 INREC4     80
FILE IN05 STATUS END05 INREC5     80
FILE IN06 STATUS END06 INREC6     80
FILE IN07 STATUS END07 INREC7     80
FILE DUMFILE DUMMY
FILE OUTFILE OUTPUT FROM OUTFILE FB #1 NULL
          OUTREC     #1
WORKAREA  INREC      80
WORKAREA  PARSEAREA  #2      VALUE ' '
          LOADREC    80 1
          WRITEREC   #1 1
WORKAREA  CHECKAREA  #1
          SINGLECHAR  1 1
WORKAREA  FIRSTINBLK  8   PD VALUE 0
          RECSKIPPED  8   PD VALUE 0
          TESTMAX     8   PD VALUE 0
          LASTCHAR    8   PD VALUE 0
          INRECCOUNT  8   PD VALUE 0
          FILENO      8   PD VALUE 1
          ENDSWITCH   1      VALUE ' '
          TAPENO      1      VALUE ' '
          INFILE      4      VALUE ' '
ON ONE
   MOVE DYLPARM TO TAPENO
   FIRSTINBLK = #2 / 80 + 1
   LASTCHAR = #1 - 1
ENDONE
PROCESS:
   INRECCOUNT = 1
   ENDSWITCH = ' '
   IF FILENO LE TAPENO
      PERFORM DOIT TO ENDIT
      FILENO = FILENO + 1
      GOTO PROCESS
   ELSE
      GOTO TERMINATE
      ENDIF
DOIT:
      PERFORM READFILE TO ENDFILES
      IF ENDSWITCH EQ 'E'
         LIST 'NO RECORDS IN' INFILE ( )
         MOVE 6 TO DYLRETURN
         GOTO ENDIT
      ELSE
         PERFORM LOAD TO TERMINATE
         ENDIF
ENDIT:
LOAD:
   IF INRECCOUNT EQ FIRSTINBLK
      GOTO WRITEIT
      ENDIF
   MOVE INREC TO LOADREC (INX)
   INX = INX + 80
   PERFORM READFILE TO ENDFILES
   IF ENDSWITCH EQ 'E'
      GOTO WRITEIT
      ENDIF
   INRECCOUNT = INRECCOUNT + 1
   GOTO LOAD
WRITEIT:
   MOVE WRITEREC (INY) TO CHECKAREA
RECHECK:
   IF SINGLECHAR (INZ) NE BLANK
      MOVE WRITEREC (INY) TO OUTREC
      WRITE OUTFILE
      INZ = 0
      GOTO CONTINUE
      ENDIF
   IF INZ LT LASTCHAR
      INZ = INZ + 1
      GOTO RECHECK
      ENDIF
   RECSKIPPED = RECSKIPPED + 1
   INZ = 0
CONTINUE:
   INY = INY + #1
   TESTMAX = INY + #1
   IF TESTMAX LE INX GOTO WRITEIT ENDIF
   INRECCOUNT = 1
   TESTMAX = 0
   INX = 0
   INY = 0
   PARSEAREA = BLANKS
   IF ENDSWITCH NE 'E' GOTO LOAD ENDIF
TERMINATE:
   LIST  '#1 BYTE RECORDS' 'AND/OR' 'BLOCKFILLER AREAS'
         'BYPASSED =' RECSKIPPED ( )
   STOP
READFILE:
   IF FILENO EQ 1
      PERFORM READ1 TO READ2
      ENDIF
   IF FILENO EQ 2
      PERFORM READ2 TO READ3
      ENDIF
   IF FILENO EQ 3
      PERFORM READ3 TO READ4
      ENDIF
   IF FILENO EQ 4
      PERFORM READ4 TO READ5
      ENDIF
   IF FILENO EQ 5
      PERFORM READ5 TO READ6
      ENDIF
   IF FILENO EQ 6
      PERFORM READ6 TO READ7
      ENDIF
   IF FILENO EQ 7
      PERFORM READ7 TO READ8
      ENDIF
ENDFILES:
READ1:
   READ IN01
   IF END01 EQ 'E'
      MOVE 'E' TO ENDSWITCH
   ELSE
      MOVE INREC1 TO INREC
      ENDIF
ON ONE
   MOVE 'IN01' TO INFILE
ENDONE
READ2:
   READ IN02
   IF END02 EQ 'E'
      MOVE 'E' TO ENDSWITCH
   ELSE
      MOVE INREC2 TO INREC
      ENDIF
ON ONE
   MOVE 'IN02' TO INFILE
ENDONE
READ3:
   READ IN03
   IF END03 EQ 'E'
      MOVE 'E' TO ENDSWITCH
   ELSE
      MOVE INREC3 TO INREC
      ENDIF
ON ONE
   MOVE 'IN03' TO INFILE
ENDONE
READ4:
   READ IN04
   IF END04 EQ 'E'
      MOVE 'E' TO ENDSWITCH
   ELSE
      MOVE INREC4 TO INREC
      ENDIF
ON ONE
   MOVE 'IN04' TO INFILE
ENDONE
READ5:
   READ IN05
   IF END05 EQ 'E'
      MOVE 'E' TO ENDSWITCH
   ELSE
      MOVE INREC5 TO INREC
      ENDIF
ON ONE
   MOVE 'IN05' TO INFILE
ENDONE
READ6:
   READ IN06
   IF END06 EQ 'E'
      MOVE 'E' TO ENDSWITCH
   ELSE
      MOVE INREC6 TO INREC
      ENDIF
ON ONE
   MOVE 'IN06' TO INFILE
ENDONE
READ7:
   READ IN07
   IF END07 EQ 'E'
      MOVE 'E' TO ENDSWITCH
   ELSE
      MOVE INREC7 TO INREC
      ENDIF
ON ONE
   MOVE 'IN07' TO INFILE
ENDONE
READ8:

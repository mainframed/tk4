000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.  GIMELMNQ.
000200*              PROGRAM CONVERTED BY
000200*              COBOL CONVERSION AID PO 5785-ABJ
000200*              CONVERSION DATE 03/21/95 16:46:54.
000300*AUTHOR.      SOLOMON JAEGER.
000400*REMARKS.
000500*    REVISED BY SAM GOLOB TO READ ELEMENT LISTINGS FROM SMP/E
000600*      RELEASE 5 REPORTS.  OUTPUT FILE CONTAINS THE NAME OF THE
000601*      ELEMENT, AND THE NAME OF THE DLIB IT IS SUPPOSED TO GO
000602*      IN TO. IT ALSO CONTAINS THE NAME OF THE LMOD AND ITS TARGET
000603*      LIBRARY'S NAME.  THE OUTPUT FILE IS A CARD-IMAGE FILE,
000604*      WHICH MAY BE EDITED TO CREATE AN IEBCOPY JOB THAT WILL
000605*      COPY THIS DLIB'S ELEMENTS INTO ANOTHER DLIB.
000606
000610*    REVISED VERSION 04/11/86 TO READ LRECL(121) LISTINGS
000620*      INSTEAD OF LRECL(133).
000700*    WRITTEN ON 03/24/85 FOR SMP4 APPLY CHECK PROCESSING.
000800*    PROGRAM TAKES AS INPUT AN APPLY (OR ACCEPT) CHECK LISTING,
000900*    AND PRODUCES AN 80-BYTE FILE LISTING ALL ELEMENTS
001000*    AFFECTED BY THE APPLY (OR ACCEPT) PROCESSING.  THIS
001100*    FILE CAN BE USED AS INPUT TO AN SMP LIST JOB.  IN ADDITION,
001200*    RELEVANT FACTS FROM THE SMP ELEMENT REPORT ARE INCLUDED
001300*    WITHIN COMMENTS NEXT TO THE ELEMENT NAME, SO THAT THE SMP
001400*    ACTION ON THAT ELEMENT CAN BE DETERMINED TO A CONSIDERABLE
001500*    DEGREE, EVEN THOUGH THE INFORMATION IN THE COMMENTS IS
001600*    SOMEWHAT ABBREVIATED.
001700*SKIP 3
001800 ENVIRONMENT DIVISION.
001900 CONFIGURATION SECTION.
002000 SOURCE-COMPUTER.  IBM-370.
002100 OBJECT-COMPUTER.  IBM-370.
002200 INPUT-OUTPUT SECTION.
002300 FILE-CONTROL.
002400     SELECT PRINTI-FILE ASSIGN TO   UT-3350-S-SYSUT1.
002500     SELECT PRINTO-FILE ASSIGN TO   UT-3350-S-SYSUT2.
002600 DATA DIVISION.
002700 FILE SECTION.
002800 FD  PRINTI-FILE
002900     RECORDING MODE IS F
003200     BLOCK CONTAINS 0 RECORDS.
003300 01  PRINTI-RECORD.
003400     05  PRINTI-CNTL        PIC X.
003500     05  PRINTI-DATA        PIC X(120).
003600 FD  PRINTO-FILE
003700     RECORDING MODE IS F
004000     BLOCK CONTAINS 0 RECORDS.
004100 01  PRINTO-RECORD          PIC X(80).
004200 WORKING-STORAGE SECTION.
004205 77  PAN-VALET PICTURE X(24) VALUE '003CBT1926   09/17/90'.
004300 77  IDENT-FIER     PIC X(17) VALUE 'GIMELMNQ 04/03/90'.
004400 01  REPT-FLAG          PIC X    VALUE SPACES.
004500 01  REPORT-NAME        PIC X(7) VALUE SPACES.
004600 01  FIRST-7-STOR       PIC X(7) VALUE SPACES.
004700 01  OUT-WORK.
004800     05  OUT-FILL           PIC X     VALUE SPACES.
004900     05  OUT-ELEM-NAME      PIC X(8)  VALUE SPACES.
005000     05  FILLER             PIC X     VALUE SPACES.
005100     05  OUT-SLSH-STR       PIC X(2)  VALUE '/*'.
005200     05  OUT-STT            PIC X(5)  VALUE SPACES.
005300     05  FILLER             PIC X     VALUE SPACES.
005400     05  OUT-ELEM-STAT      PIC X(8)  VALUE SPACES.
005500     05  FILLER             PIC X     VALUE SPACES.
005600     05  OUT-CUR-FMID       PIC X(7)  VALUE SPACES.
005700     05  FILLER             PIC X     VALUE SPACES.
005800     05  OUT-CUR-RMID       PIC X(7)  VALUE SPACES.
005900     05  FILLER             PIC X     VALUE SPACES.
006000     05  OUT-MAC-SRC        PIC X(8)  VALUE SPACES.
006100     05  FILLER             PIC X     VALUE SPACES.
006200     05  OUT-LOAD-MOD       PIC X(8)  VALUE SPACES.
006300     05  FILLER             PIC X     VALUE SPACES.
006400     05  OUT-LMOD-SYSLIB    PIC X(8)  VALUE SPACES.
006500     05  OUT-STR-SLSH       PIC X(2)  VALUE '*/'.
006600     05  FILLER             PIC X(9)  VALUE SPACES.
006700 01  IN-WORK.
006800     05  IN-INTERM.
006900         10  IN-CNTL        PIC X.
007000         10  IN-DATA.
007100             15  IN-REPTNAME.
007200                 20  IN-STT.
007300                     25  IN-STTX     PIC X.
007400                     25  IN-STTY     PIC X(4).
007500                 20  IN-RST          PIC X(2).
007600             15  IN-REPTNAME-X REDEFINES IN-REPTNAME.
007700                 20  IN-STT-X.
007800                     25  IN-DATE     PIC X(4).
007900                     25  IN-REST-D   PIC X(3).
008000             15  FILLER              PIC X(2).
008100             15  ELEM-NAME           PIC X(8).
008200             15  FILLER              PIC X(1).
008300             15  ELEM-STAT           PIC X(8).
008400             15  FILLER              PIC X(1).
008500             15  CUR-FMID            PIC X(7).
008600             15  FILLER              PIC X(1).
008700             15  CUR-RMID            PIC X(7).
008800             15  FILLER              PIC X(1).
008900             15  DISTLIB             PIC X(8).
009000             15  FILLER              PIC X(1).
009100             15  MAC-SRC             PIC X(8).
009200             15  FILLER              PIC X(10).
009300             15  LOAD-MOD            PIC X(8).
009400             15  FILLER              PIC X(1).
009500             15  LMOD-SYSLIB         PIC X(8).
009600             15  FILLER              PIC X(28).
009700     EJECT
009800 PROCEDURE DIVISION.
009900 PROCESS00.
010000     OPEN INPUT  PRINTI-FILE
010100          OUTPUT PRINTO-FILE.
010200     MOVE SPACES TO REPT-FLAG.
010300 PROCESS01.
010400     IF REPT-FLAG EQUAL 'E'
010500         GO TO PROCESS-END.
010600 PROCESS02.
010700     READ PRINTI-FILE INTO IN-WORK AT END GO TO PROCESS-END.
010800 PROCESS03.
010900     IF IN-REPTNAME EQUAL 'SYSMOD '
011000         MOVE SPACES TO REPT-FLAG.
011100     IF IN-REPTNAME EQUAL 'ELEMENT'
011200         MOVE IN-REPTNAME TO FIRST-7-STOR
011300         MOVE 'S' TO REPT-FLAG.
011400     IF IN-REPTNAME EQUAL 'DELETED' OR 'REGRESS'
011500         MOVE IN-REPTNAME TO FIRST-7-STOR
011600         MOVE 'E' TO REPT-FLAG.
011700     IF IN-REPTNAME EQUAL 'GIM2050'
011800         MOVE IN-REPTNAME TO FIRST-7-STOR
011900         MOVE SPACES TO REPT-FLAG.
012000     IF REPT-FLAG EQUAL SPACES
012100         GO TO PROCESS02.
012200     IF REPT-FLAG EQUAL 'E'
012300         GO TO PROCESS-END.
012400 PROCESS-SCAN-START.
012500     IF IN-STTX NOT EQUAL SPACES AND
012600        IN-REPTNAME NOT EQUAL 'ELEMENT' AND
012700        IN-REPTNAME NOT EQUAL 'ELEM   ' AND
012800        IN-DATE     NOT EQUAL 'DATE'    AND
012900        IN-REPTNAME NOT EQUAL 'TYPE   '
013000            PERFORM MOVE-INPUT-TO-OUTPUT THRU MOVE-END
013100            PERFORM WRITE-OUTPUT         THRU WRITE-END.
013200     GO TO PROCESS02.
013300 PROCESS-END.
013400     CLOSE PRINTI-FILE PRINTO-FILE.
013500     STOP RUN.
013600     EJECT
013700 MOVE-INPUT-TO-OUTPUT.
013800     MOVE ELEM-NAME TO OUT-ELEM-NAME.
013900     MOVE '/*'      TO OUT-SLSH-STR.
014000     MOVE IN-STT    TO OUT-STT.
014100     MOVE ELEM-STAT TO OUT-ELEM-STAT.
014200     MOVE CUR-FMID  TO OUT-CUR-FMID.
014300     MOVE CUR-RMID  TO OUT-CUR-RMID.
014400     MOVE DISTLIB   TO OUT-MAC-SRC.
014500     MOVE LOAD-MOD  TO OUT-LOAD-MOD.
014600     MOVE LMOD-SYSLIB TO OUT-LMOD-SYSLIB.
014700     MOVE '*/'      TO OUT-STR-SLSH.
014800 MOVE-END.
014900 WRITE-OUTPUT.
015000     WRITE PRINTO-RECORD FROM OUT-WORK.
015100     MOVE SPACES TO OUT-WORK.
015200 WRITE-END.

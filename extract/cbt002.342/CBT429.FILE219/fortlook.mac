/* REXX :     FORTLOOK                                               */
/* FUNCTION:  FINDS ALL OCCURRENCES OF THE SPECIFIED MODULE IN THE   */
/*            FORTRAN VS2 LIBRARIES                                  */
/*-------------------------------------------------------------------*/
CLEAR
ARG MODULE
DO FOREVER
  SELECT
    WHEN MODULE = '' THEN
      SAY 'ENTER THE NAME OF THE MODULE TO SEARCH FOR'
    WHEN LENGTH(MODULE) > 8 THEN
      SAY 'MODULE MAY NOT BE GREATER THAN 8 CHARACTERS, RE-ENTER'
    OTHERWISE LEAVE
  END
PULL MODULE
END
DSN.1 = 'SYS1.ILXCCM'
DSN.2 = 'SYS1.ILXCCS'
DSN.3 = 'SYS1.AFBLBM'
DSN.4 = 'SYS1.AFBLBS'
DSN.5 = 'SYS1.AFFMOD'
DSN.6 = 'SYS1.AFFSRC'
DSN.7 = 'SYS1.AFFPLIB'
DSN.8 = 'SYS1.AFFMLIB'
DSN.9 = 'SYS1.AFFCLIB'
DSN.10 = 'SYS1.VSF2COMP'
DSN.11 = 'SYS1.VSF2FORT'
DSN.12 = 'SYS1.VSF2LINK'
DSN.13 = 'SYS1.VSF2LOAD'
DSN.14 = 'SYS1.VSF2MATH'
DSN.15 = 'SYS1.VSF2TLIB'
DSN.16 = 'SYS1.VSF2PLIB'
DSN.17 = 'SYS1.VSF2MLIB'
DSN.18 = 'SYS1.VSF2CLIB'
DO N = 1 TO 18
  Y = SYSDSN("'"DSN.N"("MODULE")'")
  X = LEFT(DSN.N,30)
  IF Y = 'DATASET NOT FOUND' THEN Z = '      '
  ELSE DO
    WHATTHAT = OUTTRAP("LD.")
    "LISTD '"DSN.N"'"
    Z = SUBSTR(LD.5,3,6)
    OUT = OUTTRAP(OUT)
    END
  SAY X Z Y
END
EXIT

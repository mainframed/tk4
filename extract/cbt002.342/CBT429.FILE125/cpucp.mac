GOPTIONS NOTEXT82;
GOPTIONS DEVICE=GDDMPCGX;
GOPTIONS CBACK=CYAN ;
GOPTIONS COLORS=(WHITE CYAN PINK BLUE GREEN YELLOW RED);
*OPTIONS NOCHARACTERS;
*OPTIONS DEVADDR=(ADMPRINT,.,L02MCE) DEVICE=GDDM87 /*USE FOR ADMPRINT*/;
GOPTIONS HSIZE=8 VSIZE=7;
*
*    THIS SAS JOB TAKES THE FILE CREATED BY CPUTOT.
*       CALCULATES AVERAGE CPU UTILIZATION FOR EACH DAY FOR
*       ONE PHYSICAL PROCESSOR COMPLEX.
*       THE NUMBER OF DAYS DEPENDS ON THE INPUT.
*
*   ---------------------------------------------------------------
*
*    THIS SAS JOB TAKES THE FILE CREATED FROM RMF RECORD 70'S
*       PRODUCES A GRAPH
*
*     TO READ IN MORE THAN ONE MONTH'S WORTH OF DATA
*     CONCATENATE THE DATA AS FOLLOWS:
*          SET SASDB.UTM18810
*              SASDB.UTM18811
*              SASDB.UTM18812
*
*     AND THEN USE MULTIPLE %INCLUDES TO EXCLUDE CERTAIN
*     DATES. FOR EXAMPLE,
*           %INCLUDE DD1(EX8810)
*           %INCLUDE DD1(EX8811)
*           %INCLUDE DD1(EX8812)
*
*     YOU COULD, OF COURSE, COPY THE EXCLUDE INSTRUCTIONS
*     INTO THE SAS PROGRAM BY ISSUING THE
*     INCLUDE COMMAND ON THE COMMAND LINE AND THEN MOVING
*     THOSE LINES OF CODE TO THE APPROPRIATE LOCATION.
*
*
*    UPDATE INFORMATION:
*       WORKS FOR MVS/SP 2.2
*
;
*
;
  DATA TEST1;
  SET SASDB.UTM18904;
* -APR 1989 EXCLUSION DATES (ALL EXCEPT T/W/TH NON-HOLIDAYS) *;
%INCLUDE DD1(EX8904);
   IF S70IST LT 090000 THEN DELETE ;
   IF S70IST GT 155000 THEN DELETE ;
*  IF S70IST GE 120000 AND
      S70IST LT 130000 THEN DELETE;
   IF S70INT LT 0500000 THEN DELETE /*     THROW OUT SMALL INTERVAL  */;
   HHOLD  = FLOOR(S70IST/10000);
KEEP HHOLD  CPU_UT;
PROC SORT DATA=TEST1 OUT=TEST2;
 BY  HHOLD;
PROC PRINT DATA=TEST2;
PROC SUMMARY;
 VAR CPU_UT;
 BY HHOLD;
 OUTPUT OUT=SUMIT MEAN(CPU_UT)=CPUAVG
 MAX(CPU_UT)=CPUMAX
 MIN(CPU_UT)=CPUMIN;
 PROC PRINT DATA=SUMIT;
TITLE1 J=C H=1 F=XSWISSE C=WHITE 'CPU UTILIZATION BY HOUR ';
FOOTNOTE1 J=L H=1 F=SIMPLEX C=WHITE 'APRIL 1989 MON-FRI';
FOOTNOTE2 J=L H=1 F=SIMPLEX C=WHITE 'CPUCP: TECHNICAL SUPPORT';
FOOTNOTE2 J=L H=1 F=SIMPLEX C=RED '3090-400E' C=WHITE ' SOURCE RMF';
FOOTNOTE3 J=R H=1 F=SIMPLEX C=GREEN 'MINIMUM' C=CYAN ' AVGERAGE '
      C=RED 'MAXIMUM';
SYMBOL1 W=1 C=GREEN V=DIAMOND I=JOIN;
SYMBOL2 W=1 C=CYAN V=STAR I=JOIN;
SYMBOL3 W=1 C=RED V=SQUARE I=JOIN;
   PROC GPLOT DATA = SUMIT        /* GOUT=MYCAT.GRAPHS */;
 AXIS1 LABEL=(F=XSWISS H=1 'UTILIZATION')
       VALUE=(F=XSWISS H=1 C=GREEN)
       ORDER=0 TO 100 BY 20;
 AXIS2 LABEL=(F=XSWISS H=1 'HOUR')
       VALUE=(F=XSWISS H=1 C=GREEN);
        PLOT CPUMIN*HHOLD=1
             CPUAVG*HHOLD=2
             CPUMAX*HHOLD=3 / OVERLAY
             NAME='CPUCP' DES='3090   UTIL'
             FRAME VAXIS = AXIS1 HAXIS = AXIS2;
RUN;

 /********************* VPANEL   ISPF EDIT MACRO *********************/
 /* VPANEL IS AN ISPF  EDIT  MACRO  THAT  WILL  EXECUTE THE ISPF 7.2 */
 /* FUNCTION, THEN RETURN TO THE  CURRENT  EDIT SESSION.  IF YOU ARE */
 /* EDITING  A  PANEL   FROM   A   LIBRARY   THAT  IS  ISPF  ISPPLIB */
 /* CONCATENATION OR A CLIST  THAT  CALLS  A  PANEL, YOU CAN VIEW OR */
 /* PREVIEW THE PANEL AND RETURN  TO YOUR SESSION.  THE VIEWED PANEL */
 /* WILL THEN BE PICKED UP  BY  ISPF  AS  THE CURRENT VERSION OF THE */
 /* PANEL FOR ANY DIALOG CALLING  IT.  PANEL ISPYP1 MUST BE MODIFIED */
 /* FOR THIS MACRO TO WORK.                                          */
 /*                                                                  */
 /* SYNTAX: VPANEL                                                   */
 /*                                                                  */
 /********************************************************************/

 ISREDIT MACRO (ISPYPPN)
    IF &ISPYPPN = HELP  THEN DO
     ISREDIT MACPEEK VPANEL
    EXIT
    END
    IF &ISPYPPN = ?  THEN DO
     ISREDIT MACPEEK VPANEL
    EXIT
    END
 ISPEXEC VPUT ISPYPPN PROFILE
 ISPEXEC VGET (ZPF03 ZPF15) PROFILE
 SET &VPFK03 = &ZPF03
 SET &VPFK15 = &ZPF15
 SET &ZPF03 = &STR(END;END;END;VPRESET)
 SET &ZPF15 = &STR(END;END;END;VPRESET)
 ISPEXEC VPUT (VPFK03 VPFK15) PROFILE
 ISPEXEC VPUT (ZPF03 ZPF15) PROFILE
   SET ZEDSMSG = &STR(PF3/PF15 TO EXIT)
   SET ZEDLMSG = &STR(PRESS THE PF3 OR PF15 KEY TO RETURN TO EDIT SES+
  SION                  )
   ISPEXEC SETMSG MSG(ISRZ001)
          SET &ZTRAIL = 2
          ISPEXEC VPUT ZTRAIL SHARED
  IF &ISPYPPN = THEN GOTO BYPASS
          ISPEXEC CONTROL NONDISPL ENTER
  BYPASS: +
          ISPEXEC SELECT PGM(ISPYXDR) PARM(ISR)

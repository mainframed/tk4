  ISREDIT MACRO (START STOP) NOPROCESS
       IF &STR(&START) = HELP THEN +
           DO
           ISPEXEC DISPLAY PANEL(MOVFIEL#)
           EXIT
           END

       IF &STR(&START) = ? THEN +
           DO
           ISPEXEC DISPLAY PANEL(MOVFIELD)
           EXIT
           END

  ISPEXEC CONTROL ERRORS RETURN
  CONTROL ASIS
  ISREDIT PROCESS RANGE C
  SET LCC = &LASTCC
  ISREDIT (RC) = RANGE_CMD
  IF &LASTCC = 4 × &STR(&RC) ^= &STR(C) THEN DO
     SET &ZEDSMSG = NO RANGE SPECIFIED
     SET &ZEDLMSG = YOU MUST SPECIFY A RANGE OF LINES TO BE MANIPULAT+
        ED A "C<N>" OR "CC"
     ISPEXEC SETMSG MSG(ISRZ001)
     EXIT CODE(12)
  END
  ISREDIT F '~'
      IF &LASTCC = 0 THEN DO
     SET &ZEDSMSG = &STR(CHARACTER '~' FOUND)
     SET &ZEDLMSG = &STR(CHARACTER '~' IS USED IN THE MOVFIELD MACRO +
        AN WILL BE DESTROYED)
     ISPEXEC SETMSG MSG(ISRZ001)
     EXIT CODE(0)
    END
  ISREDIT C X'50'  'A1'X  ALL
  ISREDIT (FR) = LINENUM .ZFRANGE
  ISREDIT (LR) = LINENUM .ZLRANGE
  ISREDIT (LB,RB) = BOUNDS
  ISREDIT LABEL &FR = .A
  ISREDIT LABEL &LR = .B
  SET BL = &RB - &LB + 1
  SET I = &FR
  SET &NS = &LR + 1
  SET &NL = &LR
  DO WHILE( &I <= &LR )
     ISREDIT (LN) = LINE &I
     ISREDIT LINE_AFTER &NL = '&LN'
     SET &I = &I + 1
     SET &NL = &NL + 1
     END
  ISREDIT C X'A1'  '50'X  ALL
  ISREDIT LABEL &NS = .C
  ISREDIT LABEL &NL = .D
  ISREDIT C P'=' ' '  &START &STOP .A  .B ALL
  SET &RB1 = &START - 1
  SET &RB2 = &STOP + 1
  IF &START  > 1 THEN DO
  ISREDIT C P'=' ' '  &LB  &RB1 .C  .D ALL
  END
  IF &START = 2 THEN DO
  ISREDIT C P'=' ' '  1 1  .C  .D ALL
  END
  IF &STOP < &RB THEN DO
  ISREDIT C P'=' ' '  &RB2 &RB  .C  .D ALL
  END
EXIT CODE(0)

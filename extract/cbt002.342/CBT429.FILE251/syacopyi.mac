 /********************* SYACOPYI ISPF EDIT MACRO *********************/
 /* SYACOPYI IS CALLED BY SYAPDS OR SYAGENER                         */
 /*                                                                  */
 /* SYNTAX: SYACOPYI                                                 */
 /*                                                                  */
 /********************************************************************/

ISREDIT MACRO
ISPEXEC VGET (GDGDSN) PROFILE
ISREDIT (FIRST) = LINENUM .ZFIRST
ISREDIT (LAST) = LINENUM .ZLAST
SET &BK   = &STR(.BK)
SET &DDCTR = 1
ISREDIT (MEM) = MEMBER
SET &DI = &STR(OLD)
SET &BK   = &STR(.BK)
SET &DR = &STR(.DR)
SET &DDCTR = 1
SET &SP = &STR(      )
SET &NEWLINE5 = &NRSTR+
(//         UNIT=CART,VOL=(,RETAIN,REF=*.RESTHDR.SYSUT1),)
SET &NEWLINE6 = &NRSTR+
(//         LABEL=(&EVAL(&DDCTR + 1),SL))
SET &LASTX = &LAST
SET &LINEX3 = &NRSTR+
(//******************************************************************)
SET &LINEX5 = &NRSTR+
(//******************************************************************)
SET &LINEY5 = &NRSTR+
(//*                                                                *)
SET &LINEZ5 = &NRSTR+
(//*   BEFORE SUBMITTING CHANGE VVVVVV TO OUTPUT VOLUME             *)
SET &LINEX6 = &NRSTR+
(//*)
ISREDIT LINE_AFTER &LASTX = "&LINEX3"
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = "&LINEY5"
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = "&LINEZ5"
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = "&LINEY5"
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = "&LINEX5"
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = "&LINEX6"
SET &LASTX = &LASTX + 1
SET &LINEA = &NRSTR(//RESTHDR   EXEC PGM=IEBGENER)
ISREDIT LINE_AFTER &LASTX = '&LINEA'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*'
SET &LASTX = &LASTX + 1
SET &LINEB = &NRSTR+
   (//SYSPRINT DD  SYSOUT=*                                        )
ISREDIT LINE_AFTER &LASTX = '&LINEB'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*'
SET &LASTX = &LASTX + 1
SET &LINEC = &NRSTR+
   (//SYSUT2   DD  SYSOUT=*,DCB=(LRECL=80,RECFM=FB,BLKSIZE=6160)   )
ISREDIT LINE_AFTER &LASTX = '&LINEC'
SET &LASTX = &LASTX + 1
SET &LINEE = &NRSTR+
   (//*)
ISREDIT LINE_AFTER &LASTX = '&LINEE'
SET &LASTX = &LASTX + 1
SET &LINEF = &NRSTR+
(//SYSUT1 DD DISP=&DI,)
ISREDIT LINE_AFTER &LASTX = '&LINEF'
SET &LASTX = &LASTX + 1
SET &LINEN = &NRSTR+
(//         DSN=&STR(&GDGDSN(0),)
ISREDIT LINE_AFTER &LASTX = '&LINEN'
SET &LASTX = &LASTX + 1
SET &LINEG = &NRSTR+
   (//         DCB=(LRECL=80,RECFM=FB,BLKSIZE=6160),          )
ISREDIT LINE_AFTER &LASTX = '&LINEG'
SET &LASTX = &LASTX + 1
SET &LINEI = &NRSTR+
(//         UNIT=CART,VOL=(,RETAIN,,255),LABEL=(1,SL))
ISREDIT LINE_AFTER &LASTX = '&LINEI'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*'
SET &LASTX = &LASTX + 1
SET &LINEJ = &NRSTR+
   (//SYSIN    DD  DUMMY                                           )
ISREDIT LINE_AFTER &LASTX = '&LINEJ'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*   '
SET &LASTX = &LASTX + 1
SET &LINE1 = &NRSTR(//IEBCOPYS EXEC PGM=IEBCOPY,REGION=3000K)
ISREDIT LINE_AFTER &LASTX = '&LINE1'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*'
SET &LASTX = &LASTX + 1
SET &LINE2 = &NRSTR(//SYSPRINT DD SYSOUT=*)
ISREDIT LINE_AFTER &LASTX = '&LINE2'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*'
SET &LASTX = &LASTX + 1
SET &LINE3 = &NRSTR(//SYSUT3   DD DISP=(,DELETE),     )
ISREDIT LINE_AFTER &LASTX = '&LINE3'
SET &LASTX = &LASTX + 1
SET &LINE4 = &NRSTR(//         UNIT=SYSDA,            )
ISREDIT LINE_AFTER &LASTX = '&LINE4'
SET &LASTX = &LASTX + 1
SET &LINE5 = &NRSTR(//         SPACE=(CYL,(10,10))    )
ISREDIT LINE_AFTER &LASTX = '&LINE5'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*'
SET &LASTX = &LASTX + 1
SET &LINE6 = &NRSTR(//SYSUT4   DD DISP=(,DELETE),     )
ISREDIT LINE_AFTER &LASTX = '&LINE6'
SET &LASTX = &LASTX + 1
SET &LINE7 = &NRSTR(//         UNIT=SYSDA,            )
ISREDIT LINE_AFTER &LASTX = '&LINE7'
SET &LASTX = &LASTX + 1
SET &LINE8 = &NRSTR(//         SPACE=(CYL,(10,10))    )
ISREDIT LINE_AFTER &LASTX = '&LINE8'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*'
SET &LASTX = &LASTX + 1
SET &BLANK = &STR( )
SET &BLANK = &STR( )
LOOP: +
ISREDIT (WRKLINE) = LINE &FIRST
LX: +
IF &LENGTH(&STR(&DDCTR)) < 3 THEN DO
SET &DDCTR = &STR(&STR(&DDCTR) )
GOTO LX
END
SET &LC = &SYSINDEX(&BLANK,&WRKLINE)
SET &DSN = &SUBSTR(1:&EVAL(&LC -1),&STR(&WRKLINE))
LISTDSI '&DSN' DIRECTORY
SET &DSN = &STR(&STR(T00.)&DSN)
SET &VOL = &SYSVOLUME
SET &NEWLINE = +
&NRSTR(//INDD&DDCTR  DD DSN=&DSN&BK,DISP=OLD,)
SET &NEWLINE2 = &NRSTR+
(//         UNIT=CART,VOL=(,RETAIN,REF=*.RESTHDR.SYSUT1),)
SET &NEWLINE3 = &NRSTR+
(//         LABEL=(&EVAL(&DDCTR + 1),SL,EXPDT=98000)           )
SET &NEWLINE4 = &NRSTR(//OUTDD&STR(&DDCTR) DD DSN=&DSN&DR,)
SET &NEWLINE5 = &NRSTR(//         DISP=(NEW,CATLG,DELETE),)
SET &NEWLINE6 =&NRSTR(//         +
UNIT=3380,VOL=SER=VVVVVV,)
SET  &SXS1 =   &STR(&SYSDSNAME)
SET  &SXS2 =   &STR(&SYSVOLUME)
SET  &SXS3 =   &STR(&SYSUNIT)
SET  &SXS4 =   &STR(&SYSDSORG)
SET  &SXS5 =   &STR(&SYSRECFM)
SET  &SXS6 =   &STR(&SYSLRECL)
SET  &SXS7 =   &STR(&SYSBLKSIZE)
SET  &SXS8 =   &STR(&SYSALLOC)
SET  &SXS9 =   &STR(&SYSUSED)
SET  &SXS10 =  &STR(&SYSPRIMARY)
SET  &SXS11 =  &STR(&SYSSECONDS)
SET  &SXS12 =  &STR(&SYSUNITS)
SET  &SXS13 =  &STR(&SYSEXTENTS)
SET  &SXS14 =  &STR(&SYSCREATE)
SET  &SXS15 =  &STR(&SYSREFDATE)
SET  &SXS16 =  &STR(&SYSEXDATE)
SET  &SXS17 =  &STR(&SYSUPDATED)
SET  &SXS18 =  &STR(&SYSTRKSCYL)
SET  &SXS19 =  &STR(&SYSBLKSTRK)
SET  &SXS20 =  &STR(&SYSADIRBLK)
SET  &SXS21 =  &STR(&SYSUDIRBLK)
SET  &SXS22 =  &STR(&SYSMEMBERS)
SET  &SXS23 =  &STR(&SYSMSGLVL1)
SET  &SXS24 =  &STR(&SYSMSGLVL2)
SET &DSNIN =  &STR(DSN=&SXS1)
IF &SXS12 = TRACK THEN SET &SXS12R = TRK
IF &SXS12 = CYLINDER THEN SET &SXS12R = CYL
IF &SXS12 = BLOCK THEN SET &SXS12R = &SYSDVAL(&SXS7)
SET &DORG  =  &STR(DSORG=&SXS4)
SET &SPAC  =  &STR(SPACE=(&SXS12R
SET &RCFM  =  &STR(RECFM=&SXS5
SET &LREC  =  &STR(LRECL=&SXS6
SET &BLKSZ =  &STR(BLKSIZE=&SXS7
SET &SLS10 = &SYSDVAL(&SXS10)
SET &SLS11 = &SYSDVAL(&SXS11)
SET &SLS20 = &SYSDVAL(&SXS20)
ISPEXEC VPUT (DORG SPAC RCFM LREC BLKSZ) PROFILE
ISPEXEC VGET (DORG SPAC RCFM LREC BLKSZ) PROFILE
IF &SXS4 = PO THEN +
SET &CMA = &STR(,)
SET &SP1 = &STR(&SPAC&CMA(&SLS10,&SLS11,&SLS20))
SET &RGT = &STR())
SET &L5A = &STR(//         &SP1)&RGT&CMA
SET &L5B = &STR(//         DCB=(&DORG,&RCFM,&LREC,&BLKSZ),)
SET &NEWLINE7 = &NRSTR(&L5B)
SET &NEWLINE8 = &NRSTR(&L5A)
IF &ONE = YES THEN DO
SET &NEWLINE2 = &NRSTR+
(//         UNIT=CART,VOL=(,RETAIN,REF=*.RESTHDR.SYSUT1),)
SET &NEWLINE3 = &NRSTR+
(//         LABEL=(&EVAL(&DDCTR + 1),SL,EXPDT=98000))
END
ISREDIT LINE_AFTER &LASTX = '&NEWLINE'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '&NEWLINE2'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '&NEWLINE3'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '&NEWLINE4'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '&NEWLINE5'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '&NEWLINE6'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '&NEWLINE7'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '&NEWLINE8'
SET &LASTX = &LASTX + 1
ISREDIT LINE_AFTER &LASTX = '//*      '
SET &LASTX = &LASTX + 1
SET &FIRST = &FIRST +1
IF &FIRST > &LAST THEN GOTO FINISH
SET &DDCTR = &DDCTR + 1
SET &ONE = YES
GOTO LOOP
FINISH: +
ISREDIT LINE_AFTER &LASTX = '//SYSIN      DD *'
SET &LASTX = &LASTX + 1
SET &CC = 1
CLOOP: +
SET &LINEX = &NRSTR(   COPY INDD=INDD&CC,OUTDD=OUTDD&CC)
ISREDIT LINE_AFTER &LASTX = '&LINEX'
SET &LASTX = &LASTX + 1
SET &CC = &CC +1
IF &CC > &EVAL(&DDCTR) THEN GOTO QUIT
GOTO CLOOP
QUIT: +
ISREDIT LINE_AFTER &LASTX = '/*         '
ISREDIT DEL 1 &LAST ALL
ISREDIT REPLACE RESTORE .ZFIRST .ZLAST
ISREDIT SAVE
ISREDIT END

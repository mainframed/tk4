//TECH110Z JOB (530000000000),'TECH.JEFF.KAPLAN',REGION=6M,
// CLASS=S,MSGCLASS=G,MSGLEVEL=(1,1),NOTIFY=TECH110
//S EXEC ASMHCLG
//C.SYSLIB DD DSN=SYS1.MACLIB,DISP=SHR
//C.SYSIN DD *
STORESUM CSECT ,
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
RA       EQU   10
RB       EQU   11
RC       EQU   12
RD       EQU   13
RE       EQU   14
RF       EQU   15
         SAVE  (14,12),,STORESUM*&SYSDATE*&SYSTIME
         LR    RA,RF
         USING STORESUM,RA,RB,RC
         LA    RB,4095(,RA)
         LA    RB,1(,RB)
         LA    RC,4095(,RB)
         LA    RC,1(,RC)
         LR    RF,RD
         CNOP  0,4
         BAL   RD,*+76
         DC    18A(0)
         ST    RD,8(,RF)
         ST    RF,4(,RD)
         OPEN  (STORCNTR,,OUTPUT,(OUTPUT))
LOOP1    GET   RPL=RPL1
         MVC   OUTSDATE(6),INPUT+264 ACT OPEN DATE
         MVC   OUTCDATE(6),INPUT+270 CLOSE DATE
         PUT   OUTPUT,OUTREC
         B     LOOP1
*        CLC   =C'00',INPUT+10 REGION#
*        BE    LOOP1
*        CLI   INPUT+216,C'A' ACTIVE STORE
*        BE    LOOP1C
*        CLI   INPUT+216,C'N' NEW STORE LESS THAN 1 YEAR OLD
*        BNE   LOOP1
EODAD1   EQU   * *
         SLR   R9,R9
MAINEXIT CLOSE (STORCNTR,,OUTPUT)
         L     RD,4(,RD)
         LR    RF,R9
         RETURN (14,12),RC=(15)
WORK     DS    2D
EXLST1   EXLST AM=VSAM,EODAD=EODAD1
OUTREC   DC    0F'0',CL12' '
         ORG   OUTREC
OUTSDATE DC    CL6' '
OUTCDATE DC    CL6' '
OUTRCLEN EQU   *-OUTREC
         ORG
STORCNTR ACB   AM=VSAM,DDNAME=STORCNTR,BUFND=31,EXLST=EXLST1,          X
               MACRF=(KEY,SEQ,IN,NSR)
RPL1     RPL   AM=VSAM,ACB=STORCNTR,AREA=INPUT,AREALEN=32767,          X
               OPTCD=(KEY,SEQ,FWD,MVE)
OUTPUT   DCB   DDNAME=OUTPUT,DSORG=PS,LRECL=12,RECFM=FB,MACRF=(PM)
         LTORG
INPUT    DS    0D'0',32767C
         END
/*
//G.STORCNTR DD DSN=PGST.K.STORE.MASTER.FILE,DISP=SHR
//G.SYSUDUMP DD SYSOUT=*
//G.OUTPUT  DD DSN=TECH110.STORE.SUMMARY,DISP=(NEW,CATLG,DELETE),
// SPACE=(TRK,(1,1))

/* REXX */
NVOL="VSAM01 VSAM04 VSAM05 VSAM07 VSAM23";
"ALLOC F(CAT) DA('TECH110.LISTCAT') SHR";
"ALLOC F(OCAT) DA('TECH110.LISTCAT.FIX') OLD";
OCATPTR=1;
"EXECIO * DISKR CAT (FINIS STEM CAT.";
DO I = 1 TO CAT.0;
  CAT.I=TRANSLATE(CAT.I," ","-");
  PARSE VAR CAT.I W1 W2 W3 W4 W5 . ;
  IF W1="0CLUSTER" × W1="0AIX" THEN DO;
      SAVEC=W2;
      SAVED="";
      SAVEI="";
      END;
  IF W1="0DATA" THEN DO;
      SAVED=W2;
      END;
  IF W1="0INDEX" THEN DO;
      SAVEI=W2;
      END;
  IF W1="VOLSER" THEN DO;
     SAVEVOL=W2;
     END;
  IF W2="VOLSER" THEN DO;
     SAVEVOL=W3;
     END;
  IF W1="DEVTYPE" THEN DO;
     IF W2="X'3010200F'" THEN W2="3390";
       ELSE W2="3380";
     SAVEDEV=W2;
     END;
  IF W2="DEVTYPE" THEN DO;
     IF W3="X'3010200F'" THEN W3="3390";
       ELSE W3="3380";
     SAVEDEV=W3;
     END;
  IF W1="VOLFLAG" THEN DO;
     IF W2="CANDIDATE" & SAVEI="" & ,
        SAVEDEV="3380" & (WORDPOS(SAVEVOL,NVOL)^=0) THEN DO;
     OCAT.OCATPTR=" ALTER" SAVED "RVOL("SAVEVOL") FILE("SAVEVOL")";
     OCATPTR=OCATPTR+1;
     OCAT.OCATPTR=" ALTER" SAVED "AVOL(VSAM05) FILE(VSAM05)";
     OCATPTR=OCATPTR+1;
                END;
     IF W2="CANDIDATE" & SAVEI^="" & ,
        SAVEDEV="3380" & (WORDPOS(SAVEVOL,NVOL)^=0) THEN DO;
     OCAT.OCATPTR=" ALTER" SAVEI "RVOL("SAVEVOL") FILE("SAVEVOL")";
     OCATPTR=OCATPTR+1;
     OCAT.OCATPTR=" ALTER" SAVEI "AVOL(VSAM06) FILE(VSAM06)";
     OCATPTR=OCATPTR+1;
                END;
     END;
  IF W2="VOLFLAG" THEN DO;
     IF W3="CANDIDATE" & SAVEI="" & ,
        SAVEDEV="3380" & (WORDPOS(SAVEVOL,NVOL)^=0) THEN DO;
     OCAT.OCATPTR=" ALTER" SAVED "RVOL("SAVEVOL") FILE("SAVEVOL")";
     OCATPTR=OCATPTR+1;
     OCAT.OCATPTR=" ALTER" SAVED "AVOL(VSAM08) FILE(VSAM08)";
     OCATPTR=OCATPTR+1;
                END;
     IF W3="CANDIDATE" & SAVEI^="" & ,
        SAVEDEV="3380" & (WORDPOS(SAVEVOL,NVOL)^=0) THEN DO;
     OCAT.OCATPTR=" ALTER" SAVEI "RVOL("SAVEVOL") FILE("SAVEVOL")";
     OCATPTR=OCATPTR+1;
     OCAT.OCATPTR=" ALTER" SAVEI "AVOL(VSAM15) FILE(VSAM15)";
     OCATPTR=OCATPTR+1;
                END;
     END;
END;
"EXECIO * DISKW OCAT (FINIS STEM OCAT.";

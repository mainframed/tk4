/* REXX EXEC TO CONSTRUCT COMDISCO CART LIST */
"ALLOC F(INPUT) DA('TECH110.COMDISCO.CNTLLIB(STEP4)') SHR";
"ALLOC F(OUTPUT) DA('TECH110.COMDISCO.CNTLLIB(STEP4CRT)') SHR";
"EXECIO * DISKR INPUT (FINIS STEM INPUT.";
OUTPTR = 1;
DO INDEX = 1 TO INPUT.0;
     IF SUBSTR(INPUT.INDEX,1,8)^="//TAPE1 " & ,
        SUBSTR(INPUT.INDEX,1,11)^="// VOL=SER=" THEN DO;
          END;
      ELSE DO;
            IF SUBSTR(INPUT.INDEX,3,1)="T" THEN DO;
              PARSE VAR INPUT.INDEX . ".V" VOLSER ".G" . ;
              VOLSER=STRIP(VOLSER);
              SAY "PROCESSING VOLSER" VOLSER;
            END;
           ELSE DO;
              PARSE VAR INPUT.INDEX . "(" VOLLIST ")" . ;
              VOLLIST=TRANSLATE(VOLLIST," ",",");
              TCTR = WORDS(VOLLIST);
              DO TMP = 1 TO TCTR;
                  VOL = WORD(VOLLIST,TMP);
                  OUT.OUTPTR=VOL "CART" TMP"/"TCTR "FOR" VOLSER;
                  OUTPTR = OUTPTR+1;
              END;
              END;
          END;
END;
"EXECIO * DISKW OUTPUT (FINIS STEM OUT.";
EXIT 0;

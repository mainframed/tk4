)CM REF: D061001.SYSLOG(SLOGDW)
)CM DOC: SKELETON USED BY SYSLOG APPLICATION PANEL LOGDW001 AND ALSO
)CM      CLIST LOGDW TO BUILD JCL TO COPY WEEKLY ON-LINE SYSLOG DATA
)CM      TO QUARTERLY ARCHIVAL TAPE.
)CM
//D061001S JOB (00000000,06949,10),'DUMP WEEKLY SYSLOG',NOTIFY=D061001,
//     CLASS=A,TIME=1,MSGCLASS=A
//*
//* NEXT STEP WTO'S THE DATE RANGE OF THE ONLINE SYSLOG BEING DUMPED
//WEEKSCAN EXEC PGM=RANGE,REGION=300K,TIME=2
//STEPLIB DD DSN=D061001.LOAD,DISP=SHR
//SYSUT1 DD DSN=D061001.SYSLOGD,DISP=SHR
//SYSPRINT DD SYSOUT=*
//SYSUT2 DD SYSOUT=*
//SYSUDUMP  DD SYSOUT=*
//*
//* NEXT STEP DUMPS THE CURRENT WEEK'S SYSLOG TO QUARTERLY ARCHIVE TAPE
//LOGDUMP EXEC PGM=IEBGENER
//SYSPRINT DD SYSOUT=*
//SYSIN    DD DUMMY
//SYSUT1   DD DSN=D061001.SYSLOGD,DISP=SHR
//SYSUT2   DD DISP=MOD,UNIT=TAPES,
//         DSN=D061001.LOG&LOGQTR.&LOGYEAR,
//         LABEL=(,SL),VOL=(,RETAIN,,SER=LOG&LOGQTR.&LOGYEAR)
//*
//* NEXT STEP WTO'S THE DATE RANGE OF THE QUARTERLY SYSLOG TAPE
//QTRSCAN  EXEC PGM=RANGE,REGION=300K,TIME=2,COND=(4,LT,LOGDUMP)
//STEPLIB DD DSN=D061001.LOAD,DISP=SHR
//SYSUT1   DD DISP=SHR,UNIT=TAPES,
//         DSN=D061001.LOG&LOGQTR.&LOGYEAR,
//         LABEL=(,SL),VOL=SER=LOG&LOGQTR.&LOGYEAR
//SYSPRINT DD SYSOUT=*
//SYSUT2 DD SYSOUT=*
//SYSUDUMP  DD SYSOUT=*
//*
//* NEXT STEP GENERATES A WEEKLY SYSLOG EXCEPTION REPORT
//OPTIONE  EXEC PGM=OPTIONE,REGION=300K,TIME=2
//STEPLIB DD DSN=D061001.LOAD,DISP=SHR
//SYSPRINT DD SYSOUT=*
//SYSUT1   DD DISP=SHR,DSN=D061001.SYSLOGD
//SYSUT2   DD DISP=(,PASS),UNIT=SYSDA,DSN=&&SYSLOG,SPACE=(TRK,(15,5))
//SYSUDUMP  DD SYSOUT=*
//*
//*NEXT STEP SORTS BY JULIAN DATE WITHIN 'EVENT ID'
//*
//SORT EXEC PGM=SORT,REGION=1000K,COND=(0,NE,OPTIONE)
//SORTLIB DD DISP=SHR,DSN=SYS1.SORTLIB
//SORTWK01 DD UNIT=SYSDA,SPACE=(CYL,(2,1))
//SORTWK02 DD UNIT=SYSDA,SPACE=(CYL,(2,1))
//SORTWK03 DD UNIT=SYSDA,SPACE=(CYL,(2,1))
//SORTWK04 DD UNIT=SYSDA,SPACE=(CYL,(2,1))
//SORTIN DD UNIT=SYSDA,DSN=&&SYSLOG,DISP=(OLD,DELETE)
//SORTOUT DD DCB=(RECFM=FA,BLKSIZE=133),UNIT=SYSDA,DSN=&&SORTOUT,
//        SPACE=(TRK,(10,2)),DISP=(,PASS)
//SYSOUT  DD SYSOUT=*
//SYSIN   DD *
 SORT FIELDS=(1,5,CH,A,7,3,CH,A)
//*
//* NEXT STEP PREPARES REPORT FOR PRINTING (INSERT ASA PAGE BREAKS)
//*
//POSTPROC EXEC PGM=POSTPROC,REGION=300K,TIME=1
//STEPLIB  DD   DISP=SHR,DSN=D061001.LOAD
//SYSUT1   DD   DSN=&&SORTOUT,UNIT=SYSDA,DISP=(OLD,DELETE)
//SYSUT2   DD   SYSOUT=*,DCB=(RECFM=FA,BLKSIZE=133)
//SYSPRINT DD   SYSOUT=*
//SYSUDUMP DD   SYSOUT=*
//*
//* NEXT 2 STEPS PRIMES ONLINE DATASET FOR ANOTHER RECORDING WEEK
//*
//DELETE EXEC PGM=IEFBR14,COND=(4,LT,LOGDUMP)
//DD1 DD DISP=(OLD,DELETE),DSN=D061001.SYSLOGD
//*
//REALLOC EXEC PGM=IEFBR14,COND=(4,LT,DELETE)
//DD1 DD DISP=(,CATLG,DELETE),UNIT=DASD,VOL=SER=SP4DLB,
//    DCB=(RECFM=VBA,LRECL=133,BLKSIZE=7477),
//    SPACE=(CYL,(20,0)),DSN=D061001.SYSLOGD

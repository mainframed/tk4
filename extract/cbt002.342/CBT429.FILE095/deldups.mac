ISREDIT MACRO (SCOL1 SCOL2 DEBUG)
 IF &STR(&SCOL1) = ? THEN DO
HELP: +
 ISPEXEC DISPLAY PANEL(DELDUPS)
 EXIT
 END
    CONTROL MSG
    ISREDIT (LEFT,RIGHT) = BOUNDS
    IF &SCOL1 = THEN DO
    SET &SCOL1 = &LEFT
    SET &SCOL2 = &RIGHT
    SET &SORTOPTS = DELDUPS
    END
    ISPEXEC CONTROL ERRORS RETURN
   SET &RC = 0
PARSE: IF &SCOL1 = DEBUG OR &SCOL2 = DEBUG THEN CONTROL SYM CON LIST
    IF &DEBUG =  DEBUG THEN CONTROL SYM CON LIST
    IF &SCOL1 < 1 OR &SCOL1 < 1 +
    THEN GOTO PARMERR
    IF &SCOL2 < &SCOL1 THEN GOTO PARMERR
    GOTO PROCESS
PARMERR: +
    SET ZEDSMSG = &STR(PARAMETER ERROR)
    SET ZEDLMSG = &STR(SORT BEGIN AND END VALUE MUST BE NUMERIC, +
              &SCOL1 MUST BE LESS THAN &SCOL2)
    ISPEXEC SETMSG MSG(ISRZ000)
    END

PROCESS: SET &NODUPS = 0
    ISREDIT (BEGIN1) = LINENUM .ZFIRST
    ISREDIT (END1) = LINENUM .ZLAST
    SET &TOTRECS = &EVAL(&END1)
    ISREDIT RESET
    ISREDIT SORT NX A &SCOL1 &SCOL2

   ISREDIT CURSOR   1,0
    ISREDIT BOUNDS = &SCOL1 &SCOL2
   ISREDIT EXCLUDE ALL
    SET &LINE#1 = &EVAL(&BEGIN1)
    SET &LINE#2 = &LINE#1 + 1

LOOP: ISREDIT (REC1) =  LINE &LINE#1
    SET &FLD1 =  &SUBSTR(&SCOL1:&SCOL2,&NRSTR(&REC1))
LOOPON: ISREDIT (REC2) = LINE &LINE#2
    IF &NRSTR(&REC2) ^=  THEN +
    SET  &FLD2 =  &SUBSTR(&SCOL1:&SCOL2,&NRSTR(&REC2))
        IF &NRSTR(&FLD1) = &NRSTR(&FLD2) THEN DO
        ISREDIT DELETE &LINE#2 &LINE#2
        SET &LINE#2 = &LINE#2 - 1
        SET &RECSX = &RECSX + 1
        IF &RECSX = &TOTRECS THEN GOTO CLOSE
        IF &RECSX > &TOTRECS THEN GOTO CLOSE
    ISREDIT LOCATE &LINE#1
    ISREDIT LOCATE &LINE#2
    SET &LINE#2 = &LINE#2 + 1
    SET &NODUPS =  &NODUPS + 1
    END
   ELSE DO
    SET &FLD1 =  &NRSTR(&FLD2)
    SET &LINE#1 = &LINE#2
    SET &LINE#2 = &LINE#2 + 1
    END
   IF &LINE#2 < &EVAL(&END1) THEN GOTO LOOPON

CLOSE: IF &NODUPS =  0 THEN DO
    SET ZEDSMSG =  &STR(NO DUPLICATES)
    SET ZEDLMSG = &STR(NO DUPILCATES FOUND +
             IN COLUMNS &SCOL1 THRU &SCOL2)
    ISPEXEC SETMSG MSG(ISRZ000)
    ISREDIT RESET
    ISREDIT BOUNDS &LEFT &RIGHT
    GOTO SETSCR
    END
    ISREDIT RESET
    ISREDIT BOUNDS &LEFT &RIGHT
    ISREDIT (END2) = LINENUM .ZLAST
    SET &NODUPS = &EVAL(&TOTRECS -&END2)
    SET ZEDSMSG = &STR(&NODUPS DUP(S) DELETED)
    SET ZEDLMSG = &STR(&NODUPS DUPLICATE(S) DELETED +
             IN COLUMNS &SCOL1 THRU &SCOL2)
    ISPEXEC SETMSG MSG(ISRZ000)

SETSCR: ISREDIT BOUNDS = &LEFT,&RIGHT
   ISREDIT RESET
   ISREDIT UP MAX
   IF &RC  =   0 THEN SET &RC = 1

EXIT: EXIT CODE(&RC)

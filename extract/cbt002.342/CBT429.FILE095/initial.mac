 ISREDIT MACRO (OPTION)
 IF &STR(&OPTION) = ? THEN DO
 ISPEXEC DISPLAY PANEL(INITIAL)
 EXIT
 END
 SET &PRE = &SYSUID..PVTLIB
 ISPEXEC VGET VNAME PROFILE
 IF &VNAME = THEN DO
 WRITENR ENTER YOUR NAME AS YOU WANT IT TO APPEAR ON DOCUMENTS
 READ &XFIRST &XMID &XLAST
 IF &XFIRST = THEN DO
 WRITE ENTER YOUR NAME AS YOU WANT IT TO APPEAR ON DOCUMENTS
 WRITE IF NO ENTRY IS MADE THIS MACRO WILL TERMINATE
 READ &XFIRST &XMID &XLAST
 IF &XFIRST = THEN EXIT
 END
 SET &VNAME = &STR(&XFIRST &XMID &XLAST)
 ISPEXEC VPUT VNAME PROFILE
 END
ISREDIT (FIRST) = LINENUM .ZF
IF &FIRST ^= 0 THEN +
   DO
         IF &OPTION = &STR(FORCE) THEN
         ELSE EXIT CODE(0)
   END
ISREDIT (DATASET) = DATASET
IF &DATASET = &STR(&PRE..CLIST)    OR +
   &DATASET = &STR(&PRE..VCLIST)   OR +
   &DATASET = &STR(&PRE..EDIT.MACROS) THEN +
   DO
        ISREDIT NUM ON
        ISREDIT RECOVERY ON
        ISREDIT STATS ON
        ISREDIT (DATASET) = DATASET
        ISREDIT (MEMBER)  = MEMBER
        SET &DATASET = &STR(&DATASET.(&MEMBER) )
        SET &DATA1  = &STR( PROC 0)
SET &DATA2  = &STR( &NRSTR(/*)
SET &DATA3  = &STR( &NRSTR(/*)       DATASET:  &DATASET )
SET &DATA4  = &STR( &NRSTR(/*)        AUTHOR:  &VNAME )
SET &DATA5  = &STR( &NRSTR(/*)     DATE/TIME:  &SYSDATE     &SYSTIME
SET &DATA6  = &STR( &NRSTR(/*)   DESCRIPTION: )
SET &DATA7  = &STR( &NRSTR(/* CONTROL LIST CONLIST SYMLIST)
        ISREDIT LINE_AFTER 0  = (DATA1)
        ISREDIT LINE_AFTER 1  = (DATA2)
        ISREDIT LINE_AFTER 2  = (DATA3)
        ISREDIT LINE_AFTER 3  = (DATA4)
        ISREDIT LINE_AFTER 4  = (DATA5)
        ISREDIT LINE_AFTER 5  = (DATA2)
        ISREDIT LINE_AFTER 6  = (DATA6)
        ISREDIT LINE_AFTER 7  = (DATA2)
        ISREDIT LINE_AFTER 8  = (DATA2)
        ISREDIT LINE_AFTER 9  = (DATA7)
        ISREDIT LINE_AFTER 10 = (DATA2)
        ISREDIT INSERT .ZL 13
        ISREDIT CURSOR = 07 21
        EXIT CODE(0)
   END
IF &DATASET = &STR(&PRE..CNTL)  OR +
   &DATASET = &STR(&PRE..SOURCE) THEN   +
   DO
        ISREDIT NUM ON
        ISREDIT RECOVERY ON
        ISREDIT (DATASET) = DATASET
        ISREDIT (MEMBER)  = MEMBER
        SET &DATASET = &STR(&DATASET.(&MEMBER) )
        ISREDIT STATS ON
        ISREDIT COPY JOBCARD AFTER .ZL
SET &DATA1  = &STR(&NRSTR(//*)
SET &DATA2  = &STR(&NRSTR(//*)       DATASET:  &DATASET )
SET &DATA3  = &STR(&NRSTR(//*)        AUTHOR:  &VNAME )
SET &DATA4  = &STR(&NRSTR(//*)     DATE/TIME:  &SYSDATE     &SYSTIME
SET &DATA5  = &STR(&NRSTR(//*)
SET &DATA6  = &STR(&NRSTR(//*)   DESCRIPTION: )
SET &DATA7  = &STR(&NRSTR(//*)
        ISREDIT LINE_AFTER 2 = (DATA1)
        ISREDIT LINE_AFTER 3 = (DATA2)
        ISREDIT LINE_AFTER 4 = (DATA3)
        ISREDIT LINE_AFTER 5 = (DATA4)
        ISREDIT LINE_AFTER 6 = (DATA5)
        ISREDIT LINE_AFTER 7 = (DATA6)
        ISREDIT LINE_AFTER 8 = (DATA7)
        ISREDIT INSERT .ZL 14
        ISREDIT CURSOR = 01 23
        EXIT CODE(0)
   END
IF &DATASET = &STR(&PRE..TEXT) THEN +
   DO
        CONTROL ASIS
        ISREDIT RECOVERY ON
        ISREDIT NUMBER OFF
        ISREDIT CAPS OFF
        ISREDIT (DATASET) = DATASET
        ISREDIT (MEMBER)  = MEMBER
        SET &DATASET = &STR(&DATASET.(&MEMBER) )
        SET &MONTH01 = &STR(JANUARY)
        SET &MONTH02 = &STR(FEBRUARY)
        SET &MONTH03 = &STR(MARCH)
        SET &MONTH04 = &STR(APRIL)
        SET &MONTH05 = &STR(MAY)
        SET &MONTH06 = &STR(JUNE)
        SET &MONTH07 = &STR(JULY)
        SET &MONTH08 = &STR(AUGUST)
        SET &MONTH09 = &STR(SEPTEMBER)
        SET &MONTH10 = &STR(OCTOBER)
        SET &MONTH11 = &STR(NOVEMBER)
        SET &MONTH12 = &STR(DECEMBER)
        SET &MM      = &STR(&SUBSTR(1:2,&SYSDATE))
        SET &DD      = &STR(&SUBSTR(4:5,&SYSDATE))
        SET &YY      = &STR(&SUBSTR(7:8,&SYSDATE))
        SET &MONTH   = &&MONTH&MM
SET &DATE    = &STR(&MONTH &DD, 19&YY)
SET &DATA1  = &STR(&NRSTR(1   ENRON CORP                 )
SET &DATA2  = &STR(&NRSTR(    P.O. BOX 1188              )
SET &DATA3  = &STR(&NRSTR(    1400 SMITH                 )
SET &DATA4  = &STR(&NRSTR(    HOUSTON, TEXAS 77251-1188  )
SET &DATA5  = &STR(&NRSTR(    MEMORANDUM                 )
SET &DATA6  = &STR(&NRSTR(-          TO:                 )
SET &DATA7  = &STR(&NRSTR(0        FROM:  &VNAME         )
SET &DATA8  = &STR(&NRSTR(0        DATE:  &DATE          )
SET &DATA9  = &STR(&NRSTR(0     SUBJECT:                 )
SET &DATA10 = &STR(&NRSTR(-                              )
        ISREDIT LINE_AFTER 0 = (DATA1)
        ISREDIT LINE_AFTER 1 = (DATA2)
        ISREDIT LINE_AFTER 2 = (DATA3)
        ISREDIT LINE_AFTER 3 = (DATA4)
        ISREDIT LINE_AFTER 4 = (DATA5)
        ISREDIT LINE_AFTER 5 = (DATA6)
        ISREDIT LINE_AFTER 6 = (DATA7)
        ISREDIT LINE_AFTER 7 = (DATA8)
        ISREDIT LINE_AFTER 8 = (DATA9)
        ISREDIT LINE_AFTER 9 = (DATA10)
        ISREDIT BOUNDS 05 72
        ISREDIT CAPS OFF
        ISREDIT CURSOR = 06 17
        EXIT CODE(0)
   END
EXIT CODE(0)

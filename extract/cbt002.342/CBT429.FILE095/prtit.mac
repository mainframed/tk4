ISREDIT MACRO (KW1 KW2 KW3 KW4)
CONTROL NOMSG
ISREDIT (DSN) = DATASET
LISTDSI '&DSN'
  IF &STR(&KW1) = &STR(?) THEN +
    DO
       ISPEXEC DISPLAY PANEL(PRTIT)
     EXIT CODE(0)
    END

  CONTROL ASIS
FREE F(MSGS1)

   SET &Q = &SUBSTR(1:2,&SYSTIME)
   SET &Q1 = &SUBSTR(4:5,&SYSTIME)
   SET &Q2 = &SUBSTR(7:8,&SYSTIME)
   SET &MSGS = &STR(LS&Q&Q1&Q2)
   SET &NAME = &STR(&SYSPREF..&MSGS)
  FREE ATTRLIST(ISPMSGS)
    ATTRIB ISPMSGS DSORG(PS) RECFM( F B ) +
      LRECL( &SYSLRECL ) BLKSIZE( &SYSBLKSIZE )
       ALLOC DA('&NAME') SP (15,10) TRACKS USING (ISPMSGS) +
        F(MSGS1) NEW
 SET &INTVAR = &STR( )
 OPENFILE MSGS1 OUTPUT
 ISREDIT (FIRST) = LINENUM .ZFIRST
 ISREDIT (LAST) = LINENUM .ZLAST
 DO WHILE &FIRST <  &EVAL(&LAST + 1)
 ISREDIT (MSGS1) = LINE &FIRST
 PUTFILE MSGS1
 SET &FIRST = &FIRST + 1
 END
 CLOSFILE MSGS1

     VPSPRINT '&NAME' &KW1 &KW2 &KW3 &KW4
  SET &ZEDSMG = DATA AND VSPRINTED.
  SET &ZEDLMG = DATASET '&NAME' VPSPRINTED, &WK1
  ISPEXEC SETMSG MSG(ISRZ000)
  DELETE '&NAME'
EXIT

 ISREDIT MACRO (TARGET) NOPROCESS
      IF &TARGET = ? THEN DO
      ISPEXEC DISPLAY PANEL(CUTTO)
      EXIT
      END
 ISREDIT (LREC) = LRECL
 ISREDIT (DSN) = DATASET
 LISTDSI &TARGET
IF &LASTCC NE 0 THEN GOTO DSNERROR
 IF &SYSLRECL GT &LREC THEN GOTO SETUP
 IF &SYSLRECL LT &LREC THEN SET &TRUNC = YES
 SETUP:    ISREDIT (ROW,COL) = CURSOR
           ISREDIT PROCESS RANGE C M
           SET &RANGCC = &LASTCC
           IF &RANGCC GT 0 THEN DO
           SET ZEDSMSG = &STR(INVALID RANGE)
             SET ZEDLMSG = &STR(USE C OR M RANGE TO INDICATE RANGE OF+
                                LINES TO COPY)
           ISPEXEC SETMSG MSG(ISRZ001)
          EXIT
        END
           ISREDIT (FIRST) = LINENUM .ZFRANGE
           ISREDIT (LAST)  = LINENUM .ZLRANGE
           CONTROL NOMSG
 ALLOC F(CUTIT) DA(&TARGET) SHR
 IF &LASTCC NE 0 THEN DO
 DSNERROR: +
          SET ZEDSMSG = &STR(ALLOCATION PROBLEM)
           SET ZEDLMSG = &STR(CHECK &TARGET FOR PROPER DATASET/MEMBER +
                              NAME AND IF IT EXISTS)
           ISPEXEC SETMSG MSG(ISRZ001)
          EXIT CODE(8)
        END
 OPENFILE CUTIT OUTPUT
 LOOP: +
 ISREDIT (CUTIT) = LINE &FIRST
 IF &TRUNC = YES THEN DO
 SET &CUTIT = &SUBSTR(1:&LREC,&STR(&CUTIT))
 END
 PUTFILE CUTIT
 SET &FIRST = &FIRST + 1
 IF &FIRST GT &LAST THEN GOTO CLOSEOUT
 GOTO LOOP
 CLOSEOUT: +
 CLOSFILE CUTIT
 FREE F(CUTIT)
 IF &TRUNC = YES THEN DO
           SET ZEDSMSG = &STR(DATA TRUNCATED)
             SET ZEDLMSG = &STR(&TARGET LREL = &SYSLRECL DATA CUT TO +
                               &DSN LRECL &LREC)
           ISPEXEC SETMSG MSG(ISRZ001)
          EXIT
        END
         SET &FIRST = &FIRST -1
           SET ZEDSMSG = &STR(&FIRST RECORDS TRANSFERED)
             SET ZEDLMSG = &STR(&FIRST RECORDS FROM &DSN TRANFERED TO+
                                 &TARGET)
           ISPEXEC SETMSG MSG(ISRZ001)
          EXIT
        END
 EXIT

PROC 0 DEBUG
IF &DEBUG = DEBUG THEN DO
     CONTROL MSG LIST SYMLIST CONLIST
END
  SET &BRODSN = &STR(AD06P.BRODCAST)
  ISPEXEC VPUT BRODSN SHARED
  IF &SYSDSN('&BRODSN') ^= OK THEN DO
             SET ZEDSMSG = &NRSTR(DATASET NOT FOUND)
          SET ZEDLMSG = &NRSTR(DATASET '&BRODSN', NOT FOUND CORRECT +
        AND CONTINUE)
             ISPEXEC SETMSG MSG(ISRZ001)
             GOTO DISPLAY
             END
DISPLAY: +
SET &CH =
ISPEXEC DISPLAY PANEL(BRODPNL)
IF &KEY = PF03 THEN EXIT CODE(0)
IF &KEY = PF15 THEN EXIT CODE(0)
IF &KEY = PF01 THEN GOTO HELPRTN
IF &KEY = PF13 THEN GOTO HELPRTN
IF &CH ^= 1 AND &CH ^= 2 AND &CH ^=3 AND &CH ^= 4 AND &CH ^= 5 +
AND &CH ^= X THEN DO
             SET ZEDSMSG = &NRSTR(INVALID SELECTION)
          SET ZEDLMSG = &NRSTR(VALID SELECTIONS ARE 1, 2, 3, 4, 5, OR +
             X)
             ISPEXEC SETMSG MSG(ISRZ001)
             GOTO DISPLAY
             END
 IF &CH = X THEN EXIT CODE(4)
 IF &CH = 1 THEN GOTO DELRTN
 IF &CH = 2 THEN GOTO EDITRTN
 IF &CH = 3 THEN GOTO IMPORTIT
 IF &CH = 4 THEN GOTO VIEWRTN
 IF &CH = 5 THEN GOTO RESTRTN
 SET &CH =
 EDITRTN: +
 ISPEXEC EDIT DATASET('&BRODSN(CURRENT)') MACRO(BRODMAC)
             SET CC_EDIT = &LASTCC
             IF &CC_EDIT > 0 THEN DO
               IF &CC_EDIT = 4 THEN DO
 ISPEXEC VGET BCDISP SHARED
   IF &BCDISP = NONE THEN DO
                 SET ZEDSMSG = NO BRODCAST MESSAGES
                 SET ZEDLMSG = NO BRODCAST MESSAGES OR WERE NOT
                 SET ZEDLMSG = &ZEDLMSG CHANGED BY EDIT.
                 ISPEXEC SETMSG MSG(ISRZ000)
                 GOTO DISPLAY
                 END
               END
           END
 ISPEXEC VGET BCNUM SHARED
             OPER
             SET I = 1
             DO WHILE (&I <= &BCNUM)
               SEND &I,DELETE
               SET I = &I + 1
               END
             CONTROL END(XXX)
             END
             CONTROL END(END)
 ISPEXEC EDIT DATASET('&BRODSN(CURRENT)') MACRO(BRODMACU)
 GOTO DISPLAY
 DELRTN: +
 ISPEXEC EDIT DATASET('&BRODSN(BRODBKUP)') MACRO(BRODMACD)
 ISPEXEC VGET BCDEL SHARED
             OPER
             SET I = 1
             DO WHILE (&I <= &BCDEL)
               SEND &I,DELETE
               SET I = &I + 1
               END
             CONTROL END(XXX)
             END
             CONTROL END(END)
 GOTO DISPLAY
 VIEWRTN: +
 LISTBC
 GOTO DISPLAY
 IMPORTIT: +
 CLRSCRN
 WRITENR ENTER DATASET NAME TO BE IMPORTED ==>
 READ &TARGET
 IF &SYSDSN('&TARGET') ^= OK  THEN DO
             SET ZEDSMSG = &NRSTR(DATASET NOT FOUND)
             SET ZEDLMSG = &NRSTR(DATASET WAS NOT FOUND.  THE DATASET+
             MUST BE CATALOGED TO BE IMPORTED)
             ISPEXEC SETMSG MSG(ISRZ001)
             GOTO DISPLAY
             END
ISPEXEC VPUT TARGET SHARED
 ISPEXEC EDIT DATASET('&TARGET') MACRO(BRODMACI)
 WRITENR UPDATE BROADCAST WITH IMPORTED DATASET? (Y/N)
 SET &UPANS =
 READ &UPANS
 IF &SUBSTR(1:1,&UPANS) = Y THEN GOTO EDITRTN
 IF &SUBSTR(1:1,&UPANS) = X'A8' THEN GOTO EDITRTN
 IF &SUBSTR(1:1,&UPANS) = X'A8' THEN GOTO EDITRTN
 GOTO DISPLAY
 RESTRTN: +
 ISPEXEC EDIT DATASET('&BRODSN(CURRENT)') MACRO(BRODMACR)
 GOTO DISPLAY
 EXIT

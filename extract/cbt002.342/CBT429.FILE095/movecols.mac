   ISREDIT MACRO (START STOP TO) NOPROCESS
        IF &STR(&START) = HELP THEN +
            DO
            ISPEXEC SELECT PGM(ISPTUTOR) PARM(MOVECOLS)
            EXIT
            END

   ISPEXEC CONTROL ERRORS RETURN
   CONTROL ASIS
   ISREDIT PROCESS RANGE S
   SET LCC = &LASTCC
   ISREDIT (RC) = RANGE_CMD
   IF &LASTCC = 4 × &STR(&RC) ^= &STR(S) THEN DO
      SET &ZEDSMSG = NO RANGE SPECIFIED
      SET &ZEDLMSG = YOU MUST SPECIFY A RANGE OF LINES TO BE MANIPULAT+
         ED A "S<N>" OR "SS"
      ISPEXEC SETMSG MSG(ISRZ001)
      EXIT CODE(12)
   END
   IF &STOP =  × &START =  × &TO =  THEN DO
      SET &ZEDSMSG = INVALID MOVE DATA
      SET &ZEDLMSG = YOU MUST SPECIFY A START AND START COLOUMS AND DE+
         STINATION OF DATA TO BE MOVED
      ISPEXEC SETMSG MSG(ISRZ001)
      EXIT CODE(12)
   END
   ISREDIT (FR) = LINENUM .ZFRANGE
   ISREDIT (LR) = LINENUM .ZLRANGE
   ISREDIT (LB,RB) = BOUNDS
   SET BL = &RB - &LB + 1
   SET I = &FR
   DO WHILE( &I <= &LR )
      ISREDIT (LN) = LINE &I
      SET &HOLD = &NRSTR(&LN)
      SET SEGX = &STR(&SUBSTR(&START:&STOP,&NRSTR(&LN)))
      IF &START = 1 THEN DO
      SET &SEG1 =
      GOTO SEG2
      END
      SET SEG1 = &STR(&SUBSTR(&LB:&START-1,&NRSTR(&LN)))
SEG2: +
      SET SEG2 = &STR(&SUBSTR(&STOP+1:&RB,&NRSTR(&LN)))
   SET &LINE = &STR(&SEG1&SEG2)
   IF &TO = 1 THEN DO
   SET &SEGA =
   GOTO SEGB
   END
      SET SEGA = &STR(&SUBSTR(&LB:&TO-1,&NRSTR(&LINE)))
SEGB: +
  SET SEGB = &STR(&SUBSTR(&TO:&LENGTH(&NRSTR(&LINE)),&NRSTR(&LINE)))
   SET &LINE = &STR(&SEGA&SEGX&SEGB)
      ISREDIT LINE &I = (LINE)
      SET I = &I + 1
   END
EXIT CODE(0)

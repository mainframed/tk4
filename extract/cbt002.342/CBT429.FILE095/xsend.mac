ISREDIT MACRO (DEST NUM)
IF &DEST = ? THEN DO
ISPEXEC DISPLAY PANEL(XSEND)
EXIT
END
CONTROL NOMSG
SET L2 = &LENGTH(&DEST)
SET L3 = &LENGTH(&DEST)
DO WHILE &L3 > 1
IF &SUBSTR(&L3:&L3,&NRSTR(&DEST)) = &NRSTR(.) THEN DO
SET &DEST1 = &SUBSTR(1:&EVAL(&L3 -1),&DEST)
SET &DEST2 = &SUBSTR(&EVAL(&L3 +1):&L2,&DEST)
SET &DEST = &DEST1
SET &USER = &DEST2
GOTO GO_ON
END
SET &L3 = &L3 - 1
END
GO_ON: +
DELETE XSEND&NUM
ISREDIT (DSN) = DATASET
LISTDSI '&DSN'
  IF &STR(&KW1) = &STR(?) THEN +
    DO
       ISPEXEC DISPLAY PANEL(PRTIT)
     EXIT CODE(0)
    END

  CONTROL ASIS
FREE F(MSGS1)

   SET &NAME = &STR(&SYSPREF..XSEND&NUM)
  FREE ATTRLIST(ISPMSGS)
    ATTRIB ISPMSGS DSORG(PS) RECFM( F B ) +
      LRECL( &SYSLRECL ) BLKSIZE( &SYSBLKSIZE )
       ALLOC DA('&NAME') SP (15,10) TRACKS USING (ISPMSGS) +
        F(MSGS1) NEW
 SET &INTVAR = &STR( )
 OPENFILE MSGS1 OUTPUT
 ISREDIT (FIRST) = LINENUM .ZFIRST
 ISREDIT (LAST) = LINENUM .ZLAST
 DO WHILE &FIRST <  &EVAL(&LAST + 1)
 ISREDIT (MSGS1) = LINE &FIRST
 PUTFILE MSGS1
 SET &FIRST = &FIRST + 1
 END
 CLOSFILE MSGS1
   CONTROL MSG
     XMIT &DEST..&USER DA('&NAME')
   CONTROL NOMSG
  DELETE '&NAME'
EXIT

./ ADD NAME=$$DOC                                  12JUL91 11.08.10
THIS IS THE SYSEVENT ANALYSIS PACKAGE FROM STANDARD OIL OF INDIANA.  IT
WAS EXTRACTED FROM CBT TAPE LEVEL 196 FILES 208, 209 AND 210.  FILE 208
IT NOW THE MEMBER CALLED '$SODOC'. THE AMDPRSEG MODULE REQUIRED FOR TOD
CLOCK PROCESSING IS ALSO INCLUDED (DO NOT WORRY ABOUT THE UNRESOLVED
REFERENCE). THE PACKAGE IS IN IEBUPDTE FORMAT, OR USE 'PDSLOAD' FROM
THE CBT TAPE.

SPRECHER ENERGIE AG NEITHER EXPRESS NOR IMPLY ANY WARRANTY AS TO THE
FITNESS OF THESE COMPUTER PROGRAMS FOR ANY FUNCTION. THE USE OF THESE
PROGRAMS OR THE RESULTS THEREFROM IS ENTIRELY AT THE RISK OF THE USER.

THAT BEING SAID, WE ARE RE-DISTRIBUTING THIS PACKAGE IN ACCORDANCE WITH
THE AUTHORS' WISHES. WE HAVE NOT RETURNED OUR CHANGES TO THE AUTHORS AS
THE PACKAGE IS MANY YEARS OLD. MOST OF THE CHANGES IN THE 'DRIVER'
MODULE HAVE BEEN MARKED AS BEING BY SEAG. THEY ARE DESIGNED TO MAKE THE
TIME VALUES EQUAL TO MICROSECONDS (MILLIONTH). IN MODULE 'QUISCE' (SIC)
WE CHANGED ALL DECLARATIONS TO USE FLOATING POINT. IN THE END WE FOUND
IT WAS BETTER TO WRITE THE LIST OF ALL SYSEVENTS TO DISK AND
POST-PROCESS THAT LIST RATHER THAN TRY TO GET THE SYSEVENT ANALYSIS
SYSTEM TO DO ANYTHING FANCY. GOOD LUCK.                    *SEAG*
./ ADD NAME=$JCL                                   12JUL91 11.08.10
//*
//*             *RUN SYSEVENT ANALYSIS PACKAGE - CRITICAL SHORTAGES...*
//*
//GTF     EXEC PGM=TRACES,REGION=2M
//SYSUDUMP DD  SYSOUT=D
//PLIDUMP  DD  SYSOUT=D
//SYSLINE  DD  SYSOUT=*
//SYSPRINT DD  SYSOUT=*
//SYSLIST  DD  SYSOUT=*
//SYSLOG   DD  SYSOUT=*
//SYSOUT   DD  SYSOUT=*
//SYSIN    DD  DUMMY,DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
//SYSWORK  DD  UNIT=WORK,SPACE=(TRK,30),DSN=&&WORK,
//             DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
//SYSDATA  DD  DISP=SHR,DSN=GTF.TRACE
//NONPARM  DD  DUMMY,DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
//SYSPARM  DD  *
 INCLUDE='17 18 23 24 25 26'
/*
//NOTNOW   DD  *
 ASIDS='47 50'
 JOBNAME='''XCOM'' ''NETSPY'''
 INCLUDE='04 13 15 12 14 16 43 44'
/*
//*SYSLINE  DD  DSN=&&PRINT,
//*             DISP=(,PASS),
//*             DCB=(RECFM=VBA,LRECL=137,BLKSIZE=8087),
//*             UNIT=(WORK,1),
//*             SPACE=(TRK,(15,15),RLSE)
//*
./ ADD NAME=$SODOC                                 12JUL91 11.08.10
1                                     THE

                                  MVS SYSEVENT

                                ANALYSIS PACKAGE

0DISCLAIMER:
0THE DISTRIBUTION OF THIS PACKAGE, WITHOUT CHARGE, DOES NOT IMPLY
 WARRANTY OR ADMISSION OF LIABILITY ON THE PART OF STANDARD OIL COMPANY
 (INDIANA), ITS AFFILIATES, AND EMPLOYEES. THE RECIPIENT MUST MAKE FINAL
 DETERMINATION AS TO THE FITNESS OR APPLICABILITY OF THE PROGRAMS IN THI
 PACKAGE.
0TO THE USER:
0SINCE THIS PACKAGE IS BEING SUPPLIED TO YOU AT NO COST, WE, THE AUTHORS
 ASK THAT AS 'PAYMENT' FOR THIS PACKAGE YOU RETURN TO US ANY ADDITIONS O
 MODIFICATIONS THAT YOU MAKE. SHOULD THESE MODIFICATIONS BE OF GENERAL
 INTEREST, THEY WILL BE DISTRIBUTED WITH NEXT RELEASE OF THIS PACKAGE.
0IN ADDITION, WE ASK THAT YOU RE-DISTRIBUTE THIS PACKAGE TO ANY
 INSTALLATION YOU ARE IN CONTACT WITH THAT EXPRESSES INTEREST IN IT.
 WE WILL BE ESPECIALLY GRATEFUL TO THOSE OF YOU WHO TAKE THE TIME TO DO
 THIS, SINCE IT WILL REDUCE OUR 'OVERHEAD' CONSIDERABLY.
0            GOOD LUCK
             THE AUTHORS
0INSTALLATION:
0THIS PACKAGE IS SUPPLIED AS THREE FILES ON MAGNETIC TAPE. FILE 209
 CONTAINS PL/1 MACROS AND %INCLUDE GROUPS. FILE 210 CONTAINS SOURCE
 PROGRAMS AND SAMPLE JCL AND FILE 208 IS THE DOCUMENTATION (YOU ARE
 NOW READING IT).
0NOTE- THE PROGRAMS ENCLOSED WERE DEVELOPED USING THE IBM PROGRAM PRODUC
 PL/1 (OPTIMIZING) COMPILER, VERSION 1.2. THE USER IS CAUTIONED THESE
 PROGRAMS MAY NOT FUNCTION CORRECTLY WITH THE PL/1 (F) COMPILER.
0BOTH FILE ARE IN IEBUPDTE SYSIN STREAMS AND CAN BE READ DIRECTLY BY THA
 PROGRAM TO CREATE THE SOURCE AND MACRO LIBRARIES.
0OVERVIEW:
0THE DRIVER  PROGRAM USED AS THE BASE FOR THIS PACKAGE IS INCLUDED IN TH
 MACRO LIBRARY AS THE MEMBER 'DRIVER'. THE ANALYSIS ROUTINES SUPPLIED
 ARE ALL NON-MAIN PL/1 PROCEDURES DESIGNED TO BE INVOKED BY THIS DRIVER.
 THE DRIVER IS DESIGNED TO PROVIDE THE CLERICAL FACILITIES FOR SELECTION
 AND EXAMINATION OF GTF RECORDS AND THE EXPANSION AND DISPLAY OF FIELDS
 IN THE SRM (SYSEVENT) GTF RECORDS.
0THE DRIVER PROGRAM CONTAINS A DESCRIPTION OF THE FIELDS AUTOMATICALLY
 SUPPORTED.
0EACH ANALYSIS ROUTINE IS INVOKED BY THE DRIVER AT EACH SUCCESSFUL
 SELECTION OF A RECORD.
0RECORD SELECTION:
0THE DRIVER PROGRAM ALLOWS THE USER TO SELECT RECORDS FOR PROCESSING BY
 ADDRESS SPACE IDENTIFIER, BY JOBNAME, AND/OR BY SYSEVENT. THE INPUT
 FILE SYSPARM AND THE PARAMETER STRING FROM THE EXEC STATEMENT ARE COMBI
 AND THE RESULTING STRING OF PARAMETERS USED TO SET VARIABLES IN THE DRI
 PROGRAM. THE KEYWORDS JOBS, EVENTS, AND ASID ALLOW RECORD SELECTION ON
 BASIS OF THE SPECIFIED CRITERIA.
0THE MAXIMUM NUMBER OF JOBS, EVENTS, AND ASID'S SELECTABLE CAN BE SET BY
 THE VALUES MXJOB, MXEVNT, AND MXID SPECIFIED IN THE PARAMETER STRING.
1                              DRIVER LOGIC
0INITIALIZATION:
0THE PROGRAM COLLECTS THE CARD IMAGES FROM THE SYSPARM DATASET, USING
 COLUMNS TWO THROUGH SEVENTY-TWO (2-72) IN BUILDING A PARAMETER STRING.
 WHEN THIS STRING HAS BEEN BUILT, THE PARM FIELD FROM THE EXEC STATEMENT
 IS APPENDED TO THE STRING. THE STRING SO BUILT IS USED TO SET THE DRIVE
 VARIABLES, VIA 'GET STRING DATA' STATEMENTS.
0RECORD SELECTION:
0RECORD SELECTION LOGIC IS 'AND' LOGIC. ALL CONDITIONS SPECIFIED MUST BE
 MET IF THE RECORD IS TO BE 'SELECTED' FOR PROCESSING.
1
                                                                    *
   **FILE 208 IS IN IEBGENER FORMAT WHICH CONTAINS THE DOCUMENTATION*
             FOR THE MVS SYSEVENT ANALYSIS PACKAGE FROM STANDARD    *
             OIL, CONTAINED IN FILES 209 AND 210 ON THIS TAPE .     *
             THIS FILE IS RECFM=FBA                                 *
                                                                    *
   **FILE 209 IS IN IEBUPDTE FORMAT WHICH CONTAINS THE MACROS NEEDED*
             FOR THE MVS SYSEVENT ANALYSIS PACKAGE FROM STANDARD    *
             OIL                                                    *
                                                                    *
   **FILE 210 IS IN IEBUPDTE FORMAT WHICH CONTAINS THE SOURCE       *
             PROGRAMS AND SAMPLE JCL NEEDED FOR THE MVS SYSEVENT    *
             ANALYSIS PACKAGE FROM STANDARD OIL. THIS PACKAGE NEEDS *
             'TODCNVRT' WHICH IS AN ALIAS OF AMDPRSEG WHICH IS      *
             IN SYS1.AOS12 ON THE DLIB'S. AN OBJECT DECK OF         *
             AMDPRSEG ALSO RESIDES IN IEBUPDTE FORMAT IN FILE 173   *
             ON THIS TAPE                                           *
                                                                    *
./ ADD NAME=@HEX                                   12JUL91 11.08.10
 @HEX:         PROCEDURE (FULLWORD) OPTIONS(REENTRANT)
               RETURNS(CHAR(8));
      DECLARE FULLWORD FIXED BINARY(31,0);
      DECLARE LTRS(16) CHAR(1) INIT('0','1','2','3','4','5',
               '6','7','8','9','A','B','C','D','E','F');
      DECLARE BITWORK BIT(32) INIT((32)'0'B);
      DECLARE WORK FIXED BINARY(31,0);
      DECLARE HOLD BIT(32);
      DECLARE OUT CHAR(8) INIT('00000000');
      IF FULLWORD = 0 THEN
               RETURN(OUT);
      HOLD = UNSPEC(FULLWORD);
      DO I = 1 TO 8;
               K = (I * 4) - 3;
               BITWORK = (32)'0'B;
               SUBSTR(BITWORK,29,4) = SUBSTR(HOLD,K,4);
               UNSPEC(WORK) = BITWORK;
         WORK = WORK+1;
               SUBSTR(OUT,I,1) = LTRS(WORK);
      END;
      RETURN(OUT);
      END;
./ ADD NAME=@PRESS                                 12JUL91 11.08.10
 /*                                                                   */
 /*                                                                   */
 /*      B L A N K   C O M P R E S S I O N   S E R V I C E            */
 /*                                                                   */
 /*                                                                   */
 @PRESS:  PROCEDURE (INPUT_STRING)
                    OPTIONS(REENTRANT)
                    RETURNS(CHAR(1024) VARYING);
      DECLARE INPUT_STRING         CHAR(1024) VARYING;
      DECLARE OUTPUT_STRING        CHAR(1024) INIT((1024)' ');
      DECLARE OUTPUT               CHAR(1024) VARYING;
      DECLARE IN                   FIXED BINARY(31,0) INIT(0);
      DECLARE OUT                  FIXED BINARY(31,0) INIT(0);
      DO IN = 1 TO LENGTH(INPUT_STRING);
         IF  SUBSTR(INPUT_STRING,IN,1) ^= ' ' THEN DO;
             OUT = OUT + 1;
             SUBSTR(OUTPUT_STRING,OUT,1) = SUBSTR(INPUT_STRING,IN,1);
         END;
         IF  SUBSTR(INPUT_STRING,IN,1)  = ' ' THEN DO;
             IF  SUBSTR(INPUT_STRING,IN,2) ^= '  ' THEN DO;
             OUT = OUT + 1;
             SUBSTR(OUTPUT_STRING,OUT,1) = SUBSTR(INPUT_STRING,IN,1);
             END;
         END;
      END;
  OUTPUT = SUBSTR(OUTPUT_STRING,1,OUT);
  RETURN(OUTPUT);
  END;
./ ADD NAME=@TIME                                  12JUL91 11.08.10
@TOD     TITLE '@TOD - TIME OF DAY CLOCK CONVERSION ROUTINE'
         MACRO
         @ENTER   &NAME,&CS=YES,&LDATA=0
@&NAME  CSECT
         USING *,R15
         B     *+12           BYPASS NAME LOC
         DC    CL8'@&NAME'  NAME OF MODULE
         STM   R14,R11,12(R13)
         LTR   R1,R1 .             MAKE SURE WE HAVE THE POINTER
         BNZ   SAFE&SYSNDX
         ABEND 100,DUMP .          U0100 IF MISSING
SAFE&SYSNDX DS    0H
         LR    R2,R1 .        SAVE R1
         LA    R0,((107+&LDATA)/8)*8 .    LENGTH OF DSA
         L     R1,76(R13)          NEXT AVAIL DSA ADDR
         ALR   R0,R1               POINT TO MY END
         CL    R0,12(R12)          GREATER THAN REST OF ISA
         LA    R14,OK&SYSNDX       GET THE BASE
         BNH   OK&SYSNDX           NO: OK
         L     R15,116(R12)        ADDR OF NEW ISA CODE
         BALR  R14,R15             GET NEW ISA
         USING *,R15
OK&SYSNDX      DS                  0H
         LR    R15,R14             SET UP BASE
         ST    R0,76(R1)           NEXT AVAIL DSA
         ST    R13,4(R1)           POINT TO THIS DSA
         MVC   72(4,R1),72(R13)    POINT TO LIBRARY WORKSP
         LR    R13,R1              MY DSA
         MVI   86(R13),X'91'       SPIE
         MVI   87(R13),X'C0'        SUPPORT
         MVI   0(R13),X'80'        LABEL AS DSA
         LR    R1,R2               RESTORE PARM REG
         L     R1,4(R13)
         L     R1,24(R1) RESTORE R1
         BALR  R11,0
         DROP  R15
         USING *,R11
***********************************************************************
*                                                                     *
*        R11 -> BASE                                                  *
*        R12 -> PL/I TCA                                              *
*        R13 -> PL/I DSA (X'00'-X'48' IS SAVEAREA)                    *
*                                                                     *
***********************************************************************
         MEND
         MACRO
         @EXIT &OK=,&BAD=
&OK      SR    R15,R15 .           CLEAN RETURN
&BAD     DS    0H
         L     R13,4(R13)          GET RID OF DSA
         LM    R14,R11,12(R13)     RESTORE REGS
         BR    R14 .                RETURN
         MEND
         EJECT
         @ENTER TIME,LDATA=128
         USING PLIWORK,R13
         L     R3,0(R1)            GET POINTER TO DOPE VECTOR
         L     R5,0(R3)            GET POINTER TO ANSWER FIELD
         MVI   ANSWER,X'40'
         MVC   ANSWER+1(30),ANSWER     BLANK OUTPUT AREA
*
         STCK  CLOCK
*
         LA    R1,TIMEZONE
         ST    R1,PARMLIST
         LA    R1,CLOCK
         ST    R1,PARMLIST+4
         LA    R1,ANSWER
         ST    R1,PARMLIST+8
         LA    R1,PARMLIST
         LA    R2,1
         L     R10,=V(TODCNVRT)
         BALR  R14,R10
         MVC   0(22,R5),ANSWER
FINISHED EQU   *
         @EXIT OK=GOOD,BAD=BAD
         LTORG
PLIWORK  DSECT
SAVDSA   DS    108X
PARMLIST DC    A(TIMEZONE)
         DC    A(CLOCK)
         DC    A(ANSWER)
TIMEZONE DC    F'0'
         DC    2F'0'
CLOCK    DC    D'0'
         DC    2F'0'
ANSWER   DC    30X'00'
         DC    2F'0'
         EJECT
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         END
./ ADD NAME=@TOD                                   12JUL91 11.08.10
@TOD     TITLE '@TOD - TIME OF DAY CLOCK CONVERSION ROUTINE'
         MACRO
         @ENTER   &NAME,&CS=YES,&LDATA=0
@&NAME  CSECT
         USING *,R15
         B     *+12           BYPASS NAME LOC
         DC    CL8'@&NAME'  NAME OF MODULE
         STM   R14,R11,12(R13)
         LTR   R1,R1 .             MAKE SURE WE HAVE THE POINTER
         BNZ   SAFE&SYSNDX
         ABEND 100,DUMP .          U0100 IF MISSING
SAFE&SYSNDX DS    0H
         LR    R2,R1 .        SAVE R1
         LA    R0,((107+&LDATA)/8)*8 .    LENGTH OF DSA
         L     R1,76(R13)          NEXT AVAIL DSA ADDR
         ALR   R0,R1               POINT TO MY END
         CL    R0,12(R12)          GREATER THAN REST OF ISA
         LA    R14,OK&SYSNDX       GET THE BASE
         BNH   OK&SYSNDX           NO: OK
         L     R15,116(R12)        ADDR OF NEW ISA CODE
         BALR  R14,R15             GET NEW ISA
         USING *,R15
OK&SYSNDX      DS                  0H
         LR    R15,R14             SET UP BASE
         ST    R0,76(R1)           NEXT AVAIL DSA
         ST    R13,4(R1)           POINT TO THIS DSA
         MVC   72(4,R1),72(R13)    POINT TO LIBRARY WORKSP
         LR    R13,R1              MY DSA
         MVI   86(R13),X'91'       SPIE
         MVI   87(R13),X'C0'        SUPPORT
         MVI   0(R13),X'80'        LABEL AS DSA
         LR    R1,R2               RESTORE PARM REG
         L     R1,4(R13)
         L     R1,24(R1) RESTORE R1
         BALR  R11,0
         DROP  R15
         USING *,R11
***********************************************************************
*                                                                     *
*        R11 -> BASE                                                  *
*        R12 -> PL/I TCA                                              *
*        R13 -> PL/I DSA (X'00'-X'48' IS SAVEAREA)                    *
*                                                                     *
***********************************************************************
         MEND
         MACRO
         @EXIT &OK=,&BAD=
&OK      SR    R15,R15 .           CLEAN RETURN
&BAD     DS    0H
         L     R13,4(R13)          GET RID OF DSA
         LM    R14,R11,12(R13)     RESTORE REGS
         BR    R14 .                RETURN
         MEND
         EJECT
         @ENTER TOD,LDATA=128
         USING PLIWORK,R13
         LM    R3,R5,0(R1)         GET D.V. POINTERS
         L     R3,0(R3)            GET POINTER TO FIRST DATA
         L     R4,0(R4)            GET POINTER TO SECOND DATA
         L     R5,0(R5)            GET POINTER TO THIRD DATA
*
         MVC   CLOCK(8),0(R3)      MOVE IN TOD BITS
*
         LA    R1,TIMEZONE
         ST    R1,PARMLIST
         LA    R1,CLOCK
         ST    R1,PARMLIST+4
         LA    R1,ANSWER
         ST    R1,PARMLIST+8
         LA    R1,PARMLIST
         LA    R2,1
         L     R10,=V(TODCNVRT)
         BALR  R14,R10
         MVC   0(38,R4),ANSWER
FINISHED EQU   *
         @EXIT OK=GOOD,BAD=BAD
         LTORG
PLIWORK  DSECT
SAVDSA   DS    108X
PARMLIST DC    A(TIMEZONE)
         DC    A(CLOCK)
         DC    A(ANSWER)
TIMEZONE DC    F'0'
         DC    2F'0'
CLOCK    DC    D'0'
         DC    2F'0'
ANSWER   DC    30X'00'
         DC    2F'0'
         EJECT
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         END
./ ADD NAME=AMDPRSEG                               12JUL91 11.08.10
ESD      
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
TXT 
RLD      
END 
./ ADD NAME=CRITLOG                                12JUL91 11.08.10
 /* CRITICAL CONDITION SYSEVENT LOG     */
 CRITLOG:      %INCLUDE(DRIVER);
      DECLARE CRIT_CT FIXED BINARY(31,0) INIT(0) STATIC;
      DECLARE OK_CT FIXED BINARY(31,0) INIT(0) STATIC;
        ANAL: PROCEDURE OPTIONS(REENTRANT);
       IF QUIT_SWITCH = '1' THEN DO;
 PUT PAGE;
      PUT SKIP EDIT(CRIT_CT,' CRITICAL CONDITIONS ENCOUNTERED')
      (F(6),X(2),A);
      END;
      IF QUIT_SWITCH = '0' THEN DO;
      CURRENT_SWITCH = '1';
       IF (CURRENT = AVQOK) × (CURRENT = SQAOK) THEN
                OK_CT = OK_CT + 1;
       IF (CURRENT = AVQLOW) × (CURRENT = SQALOW) THEN
                CRIT_CT = CRIT_CT + 1;
                IF CURRENT =  SQALOW  THEN CURRENT_SWITCH = '0';  ;
       IF CURRENT =  SQAOK  THEN CURRENT_SWITCH = '0';  ;
                IF CURRENT =  AVQLOW  THEN CURRENT_SWITCH = '0';  ;
                     IF CURRENT =  AVQOK  THEN CURRENT_SWITCH = '0';  ;
      END;
      RETURN;
               END;
      END;
./ ADD NAME=DRIVER                                 12JUL91 11.08.10
 /*      PDSDOC *SYSEVENT ANALYSIS SYSTEM FROM STANDARD OIL VIA CBT..*/
-
-
-
-
 /********************************************************************/
 /*                                                                  */
 /*                  *                            *******            */
 /*                * *                           *     *             */
 /*              *   *                          *     *              */
 /*            *     ***************************     *               */
 /*          *                                      *                */
 /**/       PROCEDURE    (PRM) OPTIONS(MAIN);   /* *                 */
 /*          *                                      *                */
 /*            *     ***************************     *               */
 /*              *   *                          *     *              */
 /*                * *                           *     *             */
 /*                  *                            *******            */
 /*                                                                  */
 /*                                                                  */
 /********************************************************************/
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*           _______________        _______________                  */
+/*           S Y S E V E N T        A N A L Y S I S                  */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*           _____________          ___________                      */
+/*           P R O G R A M          D R I V E R                      */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*  FUNCTION:                                                        */
 /*                                                                   */
 /*                                                                   */
 /*  THE SYSEVENT PROGRAM SUPPLIED HERIN  IS DESIGNED TO SERVE AS     */
 /*                                                                   */
 /*  A BASE FOR DEVELOPMENT OF ANALYSIS ROUTINES FOR THE EXAMINATION  */
 /*                                                                   */
 /*  OF SYSEVENT TRACES PRODUCED BY MVS GTF.                          */
 /*                                                                   */
 /*  THE GTF RUN USED TO COLLECT DATA FOR THIS PROGRAM MUST           */
 /*                                                                   */
 /*  SPECIFY  " PARM="MODE=EXT,DEBUG=NO,TIME=YES"  "  ON THE          */
 /*                                                                   */
 /*  EXECUTE CARD OF THE GTF PROC                                     */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                  JOHN A. CHAPMAN  */
 /*                                                  JUNE,      1974  */
 /*                                                  CHICAGO  CENTER  */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   D R I V E R       P R O G R A M       S E R V I C E S           */
 /*                                                                   */
 /*   THIS DRIVER PROGRAM PROVIDES BASIC SERVICES TO THE USER         */
 /*   ANALYSIS ROUTINE :                                              */
 /*                                                                   */
 /*   RUN CONTROL.                                                    */
 /*                                                                   */
 /*   THE DRIVER SUPPORTS SPECIFICATION OF CONTROL INFORMATION        */
 /*   FOR THE RUN FROM THE "EXEC" CARD PARM FIELD AND FROM THE        */
 /*   --SYSPARM-- DD INPUT DATASET.  SYNTAX RULES FOR "PARM="         */
 /*   AND SYSPARM DD * ARE THE SAME:                                  */
 /*                                                                   */
 /*   SYNTAX:                                                         */
 /*                                                                   */
 /*   ONLY ALPHABETIC, NUMERIC, AND THE SPECIAL CHARACTERS            */
 /*        EQUALS = QUOTE '' COMMA , AND PARENTHESIS ()               */
 /*   ARE LEGAL IN THE PARMETER INPUT.                                */
 /*                                                                   */
 /*   ONLY COLUMNS 1 THRU 72 ARE INCLUDED FROM THE "SYSPARM"          */
 /*   INPUT STREAM.                                                   */
 /*                                                                   */
 /*   MORE THAN ONE CARD CAN BE USED TO SUPPLY "SYSPARM" INPUT.       */
 /*   COLUMNS 1 THROUGH 72 OF ALL CARDS IN THE INPUT STREAM           */
 /*   ARE CONCATENATED INTO A SINGLE CHARACTER STRING.  MULTIPLE      */
 /*   BLANKS ARE COMPRESSED TO A SINGLE BLANK.  THE RESULTING         */
 /*   STRING MUST COMPLY WITH THE RESTRICTIONS FOR THE USE OF         */
 /*   "GET STRING DATA" AND GET STRING LIST" AS DESCRIBED IN          */
 /*   THE PL/1 OPTIMIZING COMPILER MANUALS.                           */
 /*                                                                   */
 /*   OPERANDS:                                                       */
 /*                                                                   */
 /*   ALL PARAMETER (RUN CONTROL) OPERANDS ARE KEYWORD-WITH-DATA-     */
 /*   LIST:                                                           */
 /*                                                                   */
 /*        JOBNAME=                                                   */
 /*        ASIDS=                                                     */
 /*        INCLUDE=                                                   */
 /*        EXCLUDE=                                                   */
 /*        OPTIONS=                                                   */
 /*        DRIVER=                                                    */
 /*                                                                   */
 /*   IN ALL CASES, THE "DATA-LIST" MUST BE A QUOTED STRING.          */
 /*                                                                   */
 /*   OPERANDS MAY BE SPECIFIED IN ANY ORDER.                         */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   D R I V E R       P R O G R A M       S E R V I C E S           */
 /*                                                                   */
 /*   THIS DRIVER PROGRAM PROVIDES BASIC SERVICES TO THE USER         */
 /*   ANALYSIS ROUTINE :                                              */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   D R I V E R       P R O G R A M       S E R V I C E S           */
 /*                                                                   */
 /*   THIS DRIVER PROGRAM PROVIDES BASIC SERVICES TO THE USER         */
 /*   ANALYSIS ROUTINE :                                              */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   D R I V E R       P R O G R A M       S E R V I C E S           */
 /*                                                                   */
 /*   THIS DRIVER PROGRAM PROVIDES BASIC SERVICES TO THE USER         */
 /*   ANALYSIS ROUTINE :                                              */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   SUPPORTED VARIABLES:                                            */
 /*                                                                   */
 /*            THE VARIABLES  DESCRIBED BELOW ARE INITIALIZED         */
 /*            AND MAINTAINED BY THE PROGRAM.  THE USER SHOULD        */
 /*            CONSIDER THESE VARIABLES TO BE READ-ONLY,  OR          */
 /*            UNPREDICTABLE RESULTS MAY OCCUR.                       */
 /*                                                                   */
 /*                                                                   */
 /*   EVENT_NAME    - AN ARRAY OF EIGHT BYTE SYSEVENT NAMES           */
 /*                                                                   */
 /*   EVENT_COUNT   - AN ARRAY OF COUNTERS CONTAINING THE             */
 /*                 NUMBER OF SYSEVENTS ENCOUNTERED (INCLUDING THE    */
 /*                 CURRENT EVENT) BY SYSEVENT NUMBER.                */
 /*                                                                   */
 /*   EVENT_USE     - AN ARRAY OF 68 BYTE DESCRIPTORS ABOUT EACH      */
 /*                 ASSIGNED SYSEVENT.                                */
 /*                                                                   */
 /*   CURRENT_DEC   - CONTAINS THE PRINTABLE DECIMAL FORM             */
 /*                 OF THE CURRENT EVENT NUMBER.                      */
 /*                                                                   */
 /*   CURRENT_HEX   - CONTAINS THE PRINTABLE HEXIDECIMAL FORM         */
 /*                 OF THE CURRENT SYSEVENT NUMBER.                   */
 /*                                                                   */
 /*   CURRENT_ASID  - CONTAINS THE NUMBER OF THE ADDRESS SPACE        */
 /*                 REFERENCED BY THE CURRENT EVENT.                  */
 /*                                                                   */
 /*   CURRENT_EVENT - CONTAINS THE EIGHT-BYTE NAME OF THE             */
 /*                 CURRENT SYSEVENT.                                 */
 /*                                                                   */
 /*   EVENT_INDEX   - A FIXED BINARY FIELD CONTAINING A               */
 /*                 NUMBER ONE GREATER THEN THE CURRENT EVENT. TO     */
 /*                 BE USED AS AN INDEX IN SUBSCRIPTING.              */
 /*                                                                   */
 /*   CURRENT       - CONTAINS THE CURRENT SYSEVENT NUMBER IN         */
 /*                 FIXED BINARY.                                     */
 /*                                                                   */
 /*   CURRENT_ASCB  - AN EIGTH-BYTE PRINTABLE HEXIDECIMAL FIELD       */
 /*                 CONTAINING THE ASCB ADDRESS FOR THE CURRENT       */
 /*                 SYSEVENT.                                         */
 /*                                                                   */
 /*   EVENT_TOTAL   - A FIXED BINARY FIELD CONTAINING A COUNT OF      */
 /*                 THE TOTAL NUMBER OF SYSEVENT RECORDS PROCESSED    */
 /*                 TO THIS POINT IN THE RUN. INCLUDES THE CURRENT    */
 /*                 RECORD.                                           */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   SUPPORTED VARIABLES:                                            */
 /*                                                                   */
 /*            THE VARIABLES  DESCRIBED BELOW ARE INITIALIZED         */
 /*            AND MAINTAINED BY THE PROGRAM.  THE USER SHOULD        */
 /*            CONSIDER THESE VARIABLES TO BE READ-ONLY,  OR          */
 /*            UNPREDICTABLE RESULTS MAY OCCUR.                       */
 /*                                                                   */
 /*   CURRENT_TIME  - A FIXED BINARY FIELD CONTAINING THE CPU         */
 /*                 TOD CLOCK BIT POSITIONS 20 - 51. THIS ALLOWS      */
 /*                 ARITHMETIC TO BE PERFORMED IN MICROSECONDS.       */
 /*                                                                   */
 /*   HEX_R15       - HEXIDECIMAL (PRINTABLE) FORMAT OF THE           */
 /*                 CONTENTS OF REGISTER 15 AT THE TIME OF THE        */
 /*                 ISSUANCE OF THE SYSEVENT.                         */
 /*                                                                   */
 /*   HEX_R0        - HEXIDECIMAL (PRINTABLE) FORMAT OF THE           */
 /*                 CONTENTS OF REGISTER  0 AT THE TIME OF THE        */
 /*                 ISSUANCE OF THE SYSEVENT.                         */
 /*                                                                   */
 /*   HEX_R1        - HEXIDECIMAL (PRINTABLE) FORMAT OF THE           */
 /*                 CONTENTS OF REGISTER  1 AT THE TIME OF THE        */
 /*                 ISSUANCE OF THE SYSEVENT.                         */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   SUPPORTED VARIABLES:                                            */
 /*                                                                   */
 /*            THE VARIABLES  DESCRIBED BELOW ARE INITIALIZED         */
 /*            AND MAINTAINED BY THE PROGRAM.  THE USER SHOULD        */
 /*            CONSIDER THESE VARIABLES TO BE READ-ONLY,  OR          */
 /*            UNPREDICTABLE RESULTS MAY OCCUR.                       */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   SUPPORTED VARIABLES:                                            */
 /*                                                                   */
 /*            THE VARIABLES  DESCRIBED BELOW ARE INITIALIZED         */
 /*            AND MAINTAINED BY THE PROGRAM.  THE USER SHOULD        */
 /*            CONSIDER THESE VARIABLES TO BE READ-ONLY,  OR          */
 /*            UNPREDICTABLE RESULTS MAY OCCUR.                       */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/*********************************************************************/
 /*                                                                   */
 /*                                                                   */
 /*            P R O G R A M   F I L E   D E C L A R A T I O N S      */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*       SYSIN     USER CONTROL DATA CARDS               INPUT FILE  */
             DECLARE SYSIN  FILE RECORD INPUT;
 /*                                                                   */
 /*       SYSPARM   DRIVER PARAMETER CARDS                INPUT FILE  */
             DECLARE SYSPARM FILE RECORD INPUT;
 /*                                                                   */
 /*       SYSDATA    GTF FORMAT INPUT                      DATA FILE  */
             DECLARE SYSDATA FILE RECORD INPUT;
 /*                                                                   */
 /*       SYSPRINT  PROGRAM   LOG                         PRINT FILE  */
             DECLARE SYSPRINT FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSLOG    DRIVER  ACTION LOG                    PRINT FILE  */
             DECLARE SYSLOG FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSOUT    SECONDARY USER REPORT                 PRINT FILE  */
             DECLARE SYSOUT FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSLIST   PRIMARY  USER REPORT                  PRINT FILE  */
             DECLARE SYSLIST  FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSLINE   FORMATTED TRACE  DUMP                 PRINT FILE  */
             DECLARE SYSLINE  FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSWORK   WORK FILE OR TRANS FILE                           */
             DECLARE SYSWORK FILE RECORD SEQUENTIAL BUFFERED;
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*********************************************************************/
1
-
-
-/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*            D R I V E R                                            */
 /*                                                                   */
 /*            W O R K    A R E A S                                   */
 /*                                                                   */
 /*                      A N D                                        */
 /*                                                                   */
 /*            D A T A    T A B L E S                                 */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*              U S E R    A C C E S S A B L E                       */
 /*                                                                   */
 /*                                                                   */
 /*              D R I V E R    D A T A    F I E L D S                */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE EVENT_COUNT(72)     FIXED BINARY(31,0) INIT((72)0);
      DECLARE EVENT_TOTAL          FIXED BINARY (31,0) INIT(0);
      DECLARE EVENT_INDEX          FIXED BINARY(15,0);
      DECLARE CURRENT              FIXED BINARY (15,0);
      DECLARE CURRENT_EVENT        CHAR(8);
      DECLARE CURRENT_HEX          CHAR(2);
      DECLARE CURRENT_DEC          PICTURE'99';
      DECLARE CURRENT_ASID         PICTURE'9999';
      DECLARE CURRENT_SWITCH       CHAR(1) INIT('0');
      DECLARE QUIT_SWITCH          CHAR(1) INIT('0');
      DECLARE INIT_SWITCH          CHAR(1) INIT('1');
      DECLARE CURRENT_ASCB         CHAR(8);
      DECLARE CURRENT_TIME         FIXED BINARY (31,0);
      DECLARE TOD_FORMAT           CHAR(16);
      DECLARE CURRENT_TOD          CHAR(16);
      DECLARE TOD_CLOCK            BIT(64);
      DECLARE TRACE_DATE           CHAR(16) INIT((16)' ');
      DECLARE REPORT_DATE          CHAR(16) INIT((16)' ');
 /*   DECLARE DELTA                PICTURE'99999999';                 */
      DECLARE DELTA                PICTURE'999999999';          /*SEAG*/
      DECLARE HEX_R15              CHAR(8);
      DECLARE HEX_R0               CHAR(8);
      DECLARE HEX_R1               CHAR(8);
      DECLARE TIMER_SWITCH         FIXED BINARY (15,0) INIT(0);
      DECLARE COMMAND_NAME         CHAR(8) INIT('        ');
      DECLARE LAST_TIME            FIXED BINARY(31,0) INIT(0);
      DECLARE TIME_CHANGE          FIXED BINARY(31,0) INIT(0);
 /*   DECLARE REL_TIME             PICTURE'9999.99999';               */
      DECLARE REL_TIME             PICTURE'9999.999999';        /*SEAG*/
      DECLARE FIRST_TIME           FIXED BINARY(31,0) INIT(0);
      DECLARE TIME_STRING          CHAR(30) UNAL      INIT(' ');
      DECLARE 1 TOD_MAP            BASED(TODPTR) UNAL,
              2 YEAR12             CHAR(2),
              2 YEAR34             CHAR(2),
              2 TOD_DAY            CHAR(3),
              2 HMS                CHAR(8),
              2 MICRO              CHAR(7),
              2 TODSPACE           CHAR(8);
      /*****/ TODPTR = ADDR(TIME_STRING);  /********************/
1
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*              V O L A T I L E    W O R K    A R E A S              */
 /*                                                                   */
 /*              A N D                                                */
 /*                                                                   */
 /*              T R A C E   F A C I L I T Y    F I E L D S           */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE LOGPGN               FIXED BINARY (15,0) INIT(0);
      DECLARE LOGPAGE              PICTURE'9999';
      DECLARE TRCPGN               FIXED BINARY (15,0) INIT(0);
      DECLARE TRCPAGE              PICTURE'9999';
      DECLARE WORK1                FIXED BINARY (31,0) INIT(0);
      DECLARE WORK2                FIXED BINARY (15,0) INIT(0);
      DECLARE WORK3                BIT(16);
      DECLARE WORK4                BIT(32);
      DECLARE WORK5                CHAR(4);
      DECLARE WORK6                BIT(64);
      DECLARE WORK7                CHAR(18);
      DECLARE WORK8                CHAR(8);
      DECLARE WORK9                FIXED BINARY (15,0);
      DECLARE WORK10               FIXED BINARY (15,0);
      DECLARE WORK11               CHAR(8);
1
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*              P A R A M E T E R    V A R I A B L E S               */
 /*                                                                   */
 /*              A N D                                                */
 /*                                                                   */
 /*              I N P U T    P A R M    S T R I N G S                */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE E_WORK(26)           FIXED BINARY (15,0) INIT((26)0);
      DECLARE START                FIXED BINARY(31,0) INIT(0);
      DECLARE STOP                 FIXED BINARY(31,0) INIT(0);
      DECLARE EVENTS(72)           FIXED BINARY (15,0) INIT((72)16383);
      DECLARE ASID(8)              FIXED BINARY (15,0) INIT((8)0);
      DECLARE EVENT_INCLUDE        CHAR(1) INIT('0');
      DECLARE EVENT_EXCLUDE        CHAR(1) INIT('0');
      DECLARE COMMAND_LIST         CHAR(8) INIT('        ');
-
      DECLARE PARM_STRING          CHAR(4095) VARYING;
      DECLARE JOBS(8)              CHAR(8) VARYING INIT((8)'');
      DECLARE PRM                  CHAR(100) VARYING;
      DECLARE STRING_W_J           CHAR(100) VARYING INIT((8)' ''''');
      DECLARE STRING_W_A           CHAR(100) VARYING INIT((8)' 0');
      DECLARE STRING_W_E           CHAR(100) VARYING INIT((26)' 0');
      DECLARE ASIDS                CHAR(100) VARYING INIT('');
      DECLARE JOBNAME              CHAR(100) VARYING INIT('');
      DECLARE OPTIONS              CHAR(100) VARYING INIT('');
      DECLARE DRIVER               CHAR(100) VARYING INIT('');
      DECLARE INCLUDE              CHAR(100) VARYING INIT('');
      DECLARE EXCLUDE              CHAR(100) VARYING INIT('');
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*   S U B P R O G R A M    E N T R Y   D E C L A R A T I O N S      */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE @PRESS ENTRY(CHAR(1024) VARYING)
                     RETURNS(CHAR(1024) VARYING);
      DECLARE @HEX ENTRY (FIXED BINARY(31,0)) RETURNS(CHAR(8) );
      DECLARE @TIME ENTRY(CHAR(30));
      DECLARE @TOD  ENTRY;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*   R E P O R T   T I T L E S   A N D   M E S S A G E S             */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE TTL1  CHAR(100)         INIT(
 'REPORT DATE: ****************           S Y S E V E N T    A N A L Y S
  I S    S Y S T E M  ');
      DECLARE TTL2  CHAR(132) STATIC  INIT(
 '-SYSEVENT CODE-                            REGISTER CONTENTS  - - - -
 - - - -  T I M E  - - - - - - -  COMMAND ');
      DECLARE TTL3  CHAR(132) STATIC  INIT(
 'HEX DEX--NAME--  ASID  JOBNAME   --ASCB--  -REG 15- -REG  1-  -CHANGE-
 - -RELATIVE--  ---TOD  CLOCK---  --NAME-- ');
     DECLARE DASHS CHAR(132) STATIC  INIT((66)'- ');
0/*  DRIVER ERROR MESSAGES     (SYSLOG & SYSPRINT)                    */
     DECLARE ERRMSG1 CHAR(132) STATIC INIT(
 '****ERROR**** INCLUDE= AND EXCLUDE= ARE MUTUALLY EXCLUSIVE');
     DECLARE ERRMSG2 CHAR(132) STATIC INIT(
 '****ERROR**** SYSPARM INPUT STRING LENGTH EXCEEDED BEFORE EOF');
     DECLARE ERRMSG3 CHAR(132) STATIC INIT(
 '****ERROR**** SYSDATA DD STATEMENT MISSING');
     DECLARE ERRMSG4 CHAR(132) STATIC INIT(
 '****ERROR**** UNKNOWN CONDITION HAS CAUSED INTERRUPT');
     DECLARE ERRMSG5 CHAR(132) STATIC INIT(
 '****ERROR****  ANALYSIS RUN TERMINATED');
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*            S Y S E V E N T   R E C O R D   F O R M A T            */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
0                   /*  */
      DECLARE GTFAID               BIT(8) INIT((8)'1'B);
      DECLARE GTFFID               BIT(8) INIT('00000100'B);
      DECLARE GTFEID               BIT(16) INIT('0100000000000001'B);
      DECLARE XSER0                BIT(32);
      DECLARE XSER1                BIT(32);
      DECLARE XSERF                BIT(32);
0                   /*  */
      DECLARE GTFPTR               POINTER;
      DECLARE GTFREC               CHAR(1148) VARYING;
      DECLARE 1 GTFSE              BASED(GTFPTR) UNALIGNED ,
               2 SELGTH            FIXED BINARY(15,0),
               2 SEAID             BIT(8),
               2 SEFID             BIT(8),
               2 SETIME,
                 3 SETOD           BIT(32),
                 3 SEDAY           BIT(32),
               2 SEEID             BIT(16),
               2 SEASCB            BIT(32),
               2 SECPUID           FIXED BINARY(15,0),
               2 SEJOBNM           CHAR(8),
               2 SER15             BIT(32),
               2 SER0              BIT(32),
               2 SER1              BIT(32);
0
         DECLARE 1 REG_0      UNALIGNED BASED(R0PTR),
               2 R0_H1        FIXED BINARY (15,0),
               2 R0_B2        BIT(8),
               2 R0_B3        BIT(8);
0
         DECLARE 1 FULHAF     UNALIGNED BASED (FHPTR),
               2 HALF_1       FIXED BINARY(15,0),
               2 HALF_2       FIXED BINARY(15,0);
 /*                                                                   */
 /*        R E C O R D    F I E L D    A D D R E S S A B I L I T Y    */
               GTFPTR = ADDR(GTFREC);
               R0PTR  = ADDR(XSER0);
               FHPTR  = ADDR(XSERF);
 /*                                                                   */
 /*                                                                   */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*            S Y S E V E N T   N A M E   T A B L E S                */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-                                  /*  */
      DECLARE  EVENT_NAME(72) CHAR(8)
       INIT(   'TSEVENT ','TIMEREXP','TERMWAIT','NIOWAIT ',
               'USERRDY ','TIME    ','MEMCREAT','MEMDEL  ',
               'JOBSELCT','JOBTERM ','INITATT ','INITDET ',
               'QSCEST  ','QSCECMP ','TRANSWAP','SWOUTCMP',
               'SWINSTAT','SWINFL  ','QSCEFL  ','RSTORCMP',
               'ENQHOLD ','ENQRLSE ','RSMCNSTS','AVQLOW  ',
               'AVQOK   ','SQALOW  ','SQAOK   ','EASINIT ',
               'DEVALLOC','CONFIGCH','VERIFYPG','RESETPG ',
               'NEWIPS  ','ALTCPREC','TGETTPUT','SYQSCST ',
               'SYQSCCMP','SETDMN  ','REQSERVC','REQPGDAT',
               'COPDMDT*','DONTSWAP','OKSWAP  ','REQSWAP ',
               'BRINGIN ','WKLDINIT','WKLDCOLL','WKLDTERM',
               'SRM**SRM','REQSVDAT','*UNUSED*','*UNUSED*',
               'NEWOPT  ','*UNUSED*','*UNUSED*','*UNUSED*',
               '*UNUSED*','*UNUSED*','*UNUSED*','*UNUSED*');
-              /* END OF SYSEVENT NAME TABLE                          */
               /* NAMES TAKEN FROM GC28-0681                          */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*            P L / 1   S Y S E V E N T   N A M E S                  */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-/*                                                                   */
 /*            --NAME--                                    EVENT      */
 /*                                                                   */
      DECLARE  TSEVENT             FIXED BINARY (15,0)   INIT(00);
      DECLARE  TIMEREXP            FIXED BINARY (15,0)   INIT(01);
      DECLARE  TERMWAIT            FIXED BINARY (15,0)   INIT(02);
      DECLARE  NIOWAIT             FIXED BINARY (15,0)   INIT(03);
      DECLARE  USERRDY             FIXED BINARY (15,0)   INIT(04);
      DECLARE  TIME                FIXED BINARY (15,0)   INIT(05);
      DECLARE  MEMCREAT            FIXED BINARY (15,0)   INIT(06);
      DECLARE  MEMDEL              FIXED BINARY (15,0)   INIT(07);
      DECLARE  JOBSELCT            FIXED BINARY (15,0)   INIT(08);
      DECLARE  JOBTERM             FIXED BINARY (15,0)   INIT(09);
      DECLARE  INITATT             FIXED BINARY (15,0)   INIT(10);
      DECLARE  INITDET             FIXED BINARY (15,0)   INIT(11);
      DECLARE  QSCEST              FIXED BINARY (15,0)   INIT(12);
      DECLARE  QSCECMP             FIXED BINARY (15,0)   INIT(13);
      DECLARE  TRANSWAP            FIXED BINARY (15,0)   INIT(14);
      DECLARE  SWOUTCMP            FIXED BINARY (15,0)   INIT(15);
      DECLARE  SWINSTAT            FIXED BINARY (15,0)   INIT(16);
      DECLARE  SWINFL              FIXED BINARY (15,0)   INIT(17);
      DECLARE  QSCEFL              FIXED BINARY (15,0)   INIT(18);
      DECLARE  RSTORCMP            FIXED BINARY (15,0)   INIT(19);
      DECLARE  ENQHOLD             FIXED BINARY (15,0)   INIT(20);
      DECLARE  ENQRLSE             FIXED BINARY (15,0)   INIT(21);
      DECLARE  RSMCNSTS            FIXED BINARY (15,0)   INIT(22);
      DECLARE  AVQLOW              FIXED BINARY (15,0)   INIT(23);
      DECLARE  AVQOK               FIXED BINARY (15,0)   INIT(24);
      DECLARE  SQALOW              FIXED BINARY (15,0)   INIT(25);
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*            P L / 1   S Y S E V E N T   N A M E S                  */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-/*                                                                   */
 /*            --NAME--                                    EVENT      */
 /*                                                                   */
      DECLARE  SQAOK               FIXED BINARY (15,0)   INIT(26);
      DECLARE  ASMCNSTS            FIXED BINARY (15,0)   INIT(27);
      DECLARE  DEVALLOC            FIXED BINARY (15,0)   INIT(28);
      DECLARE  CONFIGCH            FIXED BINARY (15,0)   INIT(29);
      DECLARE  VERIFYPG            FIXED BINARY (15,0)   INIT(30);
      DECLARE  RESETPG             FIXED BINARY (15,0)   INIT(31);
      DECLARE  NEWIPS              FIXED BINARY (15,0)   INIT(32);
      DECLARE  ALTCPREC            FIXED BINARY (15,0)   INIT(33);
      DECLARE  TGETTPUT            FIXED BINARY (15,0)   INIT(34);
      DECLARE  SYQSCST             FIXED BINARY (15,0)   INIT(35);
      DECLARE  SYQSCCMP            FIXED BINARY (15,0)   INIT(36);
      DECLARE  SETDMN              FIXED BINARY (15,0)   INIT(37);
      DECLARE  REQSERVC            FIXED BINARY (15,0)   INIT(38);
      DECLARE  REQPGDAT            FIXED BINARY (15,0)   INIT(39);
      DECLARE  EVENT40             FIXED BINARY (15,0)   INIT(40);
      DECLARE  DONTSWAP            FIXED BINARY (15,0)   INIT(41);
      DECLARE  OKSWAP              FIXED BINARY (15,0)   INIT(42);
      DECLARE  REQSWAP             FIXED BINARY (15,0)   INIT(43);
      DECLARE  BRINGIN             FIXED BINARY (15,0)   INIT(44);
      DECLARE  WKLDINIT            FIXED BINARY (15,0)   INIT(45);
      DECLARE  WKLDCOLL            FIXED BINARY (15,0)   INIT(46);
      DECLARE  WKLDTERM            FIXED BINARY (15,0)   INIT(47);
      DECLARE  SRMSRM48            FIXED BINARY (15,0)   INIT(48);
      DECLARE  EVENT49             FIXED BINARY (15,0)   INIT(49);
      DECLARE  EVENT50             FIXED BINARY (15,0)   INIT(50);
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-                                  /*  */
      DECLARE EVENT_USE(72) CHAR(68);
      EVENT_USE(1)
   =  'PPMODE - EXECUTION OF TSO COMMAND OR SUBCOMMAND';
      EVENT_USE(2)
   =  'S R M TIMER EXPIRATION ';
      EVENT_USE(3)
   =  'TERMINAL USER IN WAIT CONDITION';
      EVENT_USE(4)
   =  'ADDRESS SPACE SUSPECTED OF BEING IN LONG WAIT';
      EVENT_USE(5)
   =  'AN ADDRESS SPACE (USER) IS READY ';
      EVENT_USE(6)
   =  'SRM TIME INTERVAL HAS EXPIRED';
      EVENT_USE(7)
   =  'ADDRESS SPACE CREATION';
      EVENT_USE(8)
   =  'ADDRESS SPACE DELETION';
      EVENT_USE(9)
   =  'JOB SELECTION ';
      EVENT_USE(10)
   =  'JOB TERMINATION';
      EVENT_USE(11)
   =  'ATTACH BY INITIATOR (IEFSD263)';
      EVENT_USE(12)
   =  'DETACH BY INITIATOR (IEFSD263)';
      EVENT_USE(13)
   =  'QUIESCE STARTED FOR AN ADDRESS SPACE';
      EVENT_USE(14)
   =  'QUIESCE COMPLETED FOR AN ADDRESS SPACE';
      EVENT_USE(15)
   =  'TRANSITION SWAP AN ADDRESS SPACE' ;
      EVENT_USE(16)
   =  'SWAP OUT PROCESSING COMPLETED';
      EVENT_USE(17)
   =  'SWAP-IN STATUS';
      EVENT_USE(18)
   =  'SWAP IN FAILED- OBTAIN/INIT LSQA FAILED FOR ASID';
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      EVENT_USE(19)
   =  'QUIESCE FAILED - ASID RESTORED AT THIS TIME';
      EVENT_USE(20)
   =  'RESTORE COMPLETED - CHECK FOR READY MADE HERE';
      EVENT_USE(21)
   =  'ENQ CONTENTION IS OCCURRING';
      EVENT_USE(22)
   =  'ENQ CONTENTION REDUCED';
      EVENT_USE(23)
   =  'REAL STORAGE MANAGER CONSTANTS TO SRM';
      EVENT_USE(24)
   =  'AVAILABLE FRAME QUEUE BELOW THRESHOLD';
      EVENT_USE(25)
   =  'AVAILABLE FRAME QUEUE RETURNED ABOVE LIMIT';
      EVENT_USE(26)
   =  'UNALLOCATED SQA BELOW THRESHOLD';
      EVENT_USE(27)
   =  'UNALLOCATED SQA RETURNED ABOVE LIMIT';
      EVENT_USE(28)
   =  'AUXILIARY STORAGE MANAGER CONSTANTS TO SRM';
      EVENT_USE(29)
   =  'DEVICE ALLOCATION DECISION REQUEST';
      EVENT_USE(30)
   =  'SYSTEM CONFIGURATION CHANGE';
      EVENT_USE(31)
   =  'VERIFY PERFORMANCE GROUP FOR ADDRESS SPACE';
      EVENT_USE(32)
   =  'RESET  PERFORMANCE GROUP FOR ADDRESS SPACE';
      EVENT_USE(33)
   =  'CHANGE IPS CURRENTLY USED BY SRM';
      EVENT_USE(34)
   =  'ALTERNATE CPU RECOVERY OCCURRING';
      EVENT_USE(35)
   =  'TSO TGET OR TPUT SATISFIED';
      EVENT_USE(36)
   =  'SYSTEM QUIESCE FUNCTION STARTED';
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      EVENT_USE(37)
   =  'SYSTEM QUIESCE FUNCTION COMPLETE';
      EVENT_USE(38)
   =  'SET NEW VALUES FOR A DOMAIN';
      EVENT_USE(39)
   =  'REQUEST FOR SERVICE DATA ON ADDRESS SPACE';
      EVENT_USE(40)
   =  'REQUEST FOR PAGING DATA ON ADDRESS SPACE';
      EVENT_USE(41)
   =  'SYSEVENT CODE 40 (28) IS UNUSED';
      EVENT_USE(42)
   =  'ADDRESS SPACE IS NOW NONSWAPPABLE';
      EVENT_USE(43)
   =  'ADDRESS SPACE IS NOW SWAPPABLE';
      EVENT_USE(44)
   =  'REQUEST TO SWAP OUT ADDRESS SPACE';
      EVENT_USE(45)
   =  'BRING ADDRESS SPACE INTO CORE - FOR CANCEL -';
      EVENT_USE(46)
   =  'WORKLOAD ACTIVITY MEASUREMENT INITIALIZED';
      EVENT_USE(47)
   =  'WORKLOAD ACTIVITY MEASUREMENT COLLECTION';
      EVENT_USE(48)
   =  'WORKLOAD ACTIVITY MEASUREMENT TERMINATION';
      EVENT_USE(49)
   =  'INTERNAL SRM CONTROL INVOKATION SYSEVENT';
      EVENT_USE(50)
   =  'ALL OTHER SYSEVENTS ARE UNUSED'   ;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*        F I L E    O P E N   S T A T E M E N T S                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-/*                                                                   */
      OPEN FILE(SYSOUT)  OUTPUT PRINT LINESIZE(137) PAGESIZE(58);
      OPEN FILE(SYSLOG)  OUTPUT PRINT LINESIZE(137) PAGESIZE(58);
      OPEN FILE(SYSLIST) OUTPUT PRINT LINESIZE(137) PAGESIZE(58);
      OPEN FILE(SYSPRINT) OUTPUT PRINT LINESIZE(137) PAGESIZE(59);
      OPEN FILE(SYSLINE ) OUTPUT PRINT LINESIZE(137) PAGESIZE(59);
      OPEN FILE(SYSPARM) INPUT RECORD SEQUENTIAL;
      OPEN FILE(SYSDATA) INPUT RECORD SEQUENTIAL;
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   O N   C O N D I T I O N S                                       */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
          ON UNDEFINEDFILE(SYSPARM) GOTO PARM_RD_END;
          ON ENDFILE(SYSPARM)       GOTO PARM_RD_END;
          ON ENDFILE(SYSDATA)       GOTO INPUT_ENDED;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   O N   C O N D I T I O N S                                       */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
 /*                                                                   */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T  (S Y S P R I N T)  */
 /*                                                                   */
 /*                                                                   */
      ON ENDPAGE (SYSPRINT) BEGIN;
               PUT      EDIT
               ('SYSEVENT CODES FOR VS/2 RELEASE 3.0 (MVS)')
               (COL(27),A);
               PUT SKIP(4) EDIT ('SYSEVENT','EVENT  NUMBER',
               'FUNCTION') (COL(3),A,COL(12),A,COL(27),A);
               PUT EDIT ('  NAME  ',' DEC     HEX ',
               '/PURPOSE') (COL(3),A,COL(12),A,COL(27),A);
               PUT SKIP(3);
               END;
      SIGNAL ENDPAGE(SYSPRINT);
      DO I = 1 TO 50;
               WORK1 = I - 1;
               CURRENT_DEC = WORK1;
               WORK8 = @HEX(WORK1);
               CURRENT_HEX = SUBSTR(WORK8,7,2);
               PUT EDIT (EVENT_NAME(I),CURRENT_DEC,
               CURRENT_HEX,EVENT_USE(I))
               (COL(3),A,COL(14),A,COL(21),A,COL(27),A);
      END;
      REVERT ENDPAGE(SYSPRINT);
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   O N   C O N D I T I O N S                                       */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
 /*                                                                   */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T   ( S Y S L I N E ) */
 /*                                                                   */
 /*                                                                   */
      ON ENDPAGE (SYSLINE ) BEGIN;
               PUT FILE(SYSLINE )      EDIT
               ('SYSEVENT CODES FOR VS/2 RELEASE 3.0 (MVS)')
               (COL(27),A);
               PUT FILE(SYSLINE ) SKIP(4) EDIT ('SYSEVENT',
               'EVENT NUMBER',
               'FUNCTION') (COL(3),A,COL(12),A,COL(27),A);
               PUT FILE(SYSLINE ) EDIT ('  NAME  ',' DEC     HEX ',
               '/PURPOSE') (COL(3),A,COL(12),A,COL(27),A);
               PUT FILE(SYSLINE ) SKIP(3);
               END;
      SIGNAL ENDPAGE(SYSLINE );
      DO I = 1 TO 50;
               WORK1 = I - 1;
               CURRENT_DEC = WORK1;
               WORK8 = @HEX(WORK1);
               CURRENT_HEX = SUBSTR(WORK8,7,2);
               PUT FILE(SYSLINE ) EDIT (EVENT_NAME(I),CURRENT_DEC,
               CURRENT_HEX,EVENT_USE(I))
               (COL(3),A,COL(14),A,COL(21),A,COL(27),A);
      END;
      REVERT ENDPAGE(SYSLINE );
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   O N   C O N D I T I O N S                                       */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
       ON ENDPAGE (SYSLINE )  BEGIN;
               TRCPGN = TRCPGN + 1;
               TRCPAGE = TRCPGN;
               PUT FILE(SYSLINE ) PAGE
                   EDIT (TTL1,'TRACE  DATE: ',TRACE_DATE)
                        (COL(1),A,COL(102),A,A);
               PUT FILE(SYSLINE) SKIP EDIT ('*','PAGE  ',TRCPAGE)
               (COL(1),A,COL(121),A,COL(127),A);
               PUT FILE(SYSLINE ) SKIP(2) EDIT (TTL2) (A);
               PUT FILE(SYSLINE ) EDIT (TTL3) (COL(1),A);
               PUT FILE(SYSLINE ) EDIT (DASHS)  (COL(1),A);
               PUT FILE(SYSLINE ) SKIP(2);
      END;     /* END OF ENDPAGE BEGIN BLOCK                          */
0
       ON ENDPAGE (SYSLOG )  BEGIN;
               LOGPGN = LOGPGN + 1;
               LOGPAGE = LOGPGN;
               PUT FILE(SYSLOG ) PAGE
                   EDIT (TTL1,'**ACTION LOG**',
               'PAGE  ',LOGPAGE)
               (COL(1),A,COL(102),A,COL(121),A,COL(127),A);
               PUT FILE(SYSLOG ) SKIP(2);
               PUT FILE(SYSLOG ) EDIT (DASHS)  (COL(1),A);
               PUT FILE(SYSLOG ) SKIP(1);
      END;     /* END OF ENDPAGE BEGIN BLOCK                          */
0
       ON ENDPAGE (SYSPRINT)  BEGIN;
               PUT FILE(SYSPRINT) PAGE EDIT
               (TTL1) (COL(1),A);
               PUT FILE(SYSPRINT) SKIP(1);
               PUT FILE(SYSPRINT) EDIT (DASHS)  (COL(1),A);
               PUT FILE(SYSPRINT) SKIP(1);
      END;     /* END OF ENDPAGE BEGIN BLOCK                          */
1/*                                                                   */
 INITIALIZE:
      CALL @TIME(TIME_STRING);
      REPORT_DATE = YEAR34××'.'××TOD_DAY××'  '××HMS;
      SUBSTR(TTL1,14,16) = REPORT_DATE;
      SIGNAL ENDPAGE(SYSPRINT);
      SIGNAL ENDPAGE(SYSLIST );
      SIGNAL ENDPAGE(SYSLOG  );
      SIGNAL ENDPAGE(SYSOUT  );
      WORK1 = 0;
      PARM_STRING = ' ';
        PUT FILE(SYSLOG) SKIP(2) EDIT
            ('*---------------------S Y S P A R M  ',
             ' I N P U T--------------------------*')
                      (COL(2),A,A);
        PUT FILE(SYSLOG) SKIP(2);
1/*                                                                   */
 PARM_LOOP:
      READ FILE(SYSPARM) INTO(GTFREC);
      PUT FILE(SYSLOG) EDIT ('<',SUBSTR(GTFREC,1,72),'>')
               (COL(1),A,A,A);
      IF SUBSTR(GTFREC,1,72) = (72)' ' THEN GOTO PARM_LOOP;
      IF SUBSTR(GTFREC,1,1) = '*'  THEN GOTO PARM_LOOP;
0/*  */
     OPTIONS = @PRESS(SUBSTR(GTFREC,1,72));
      PUT FILE(SYSLOG) SKIP EDIT('==>',OPTIONS,'<==') (COL(1),A,A,A);
      IF LENGTH(PARM_STRING) < 3923 THEN DO;
         PARM_STRING = PARM_STRING××' '××OPTIONS;
         END;
      IF LENGTH(PARM_STRING) < 3990 THEN GOTO PARM_LOOP;
 PARM_RD_END:
      IF LENGTH(PRM) ^= 0 THEN  DO;
               PARM_STRING = PARM_STRING××' '××PRM;      END;
      PARM_STRING = PARM_STRING××' ; ';
 /*   PARAMETER STRING BUILT AT THIS POINT                            */
1/*   PARAMETER STRING BUILT AT THIS POINT                            */
        GET STRING(PARM_STRING)
        DATA(OPTIONS,DRIVER,INCLUDE,EXCLUDE,JOBNAME,ASIDS);
        IF DRIVER ^= ''   THEN DO;
         DRIVER  = DRIVER  ×× ' ; ';
         PUT FILE(SYSLOG) SKIP(2) EDIT('DRIVER=',DRIVER)
             (COL(1),A,A);
           TIMER_SWITCH = INDEX(DRIVER,'$NOTIMERS');
           END;
 /*************NOTE HERE FOR INCLUDE/EXCLUDE MUTUALLY EXCLUSIVE       */
      IF (INCLUDE ^= '' & EXCLUDE ^= '') THEN DO;
         PUT FILE(SYSLOG) SKIP(2) EDIT(ERRMSG1) (COL(1),A);
         GOTO ABTERM_PROCESS;
      END;
-
      IF INCLUDE ^= '' THEN  DO;
         EVENT_INCLUDE = '1';
         PUT FILE(SYSLOG) SKIP(2) EDIT('INCLUDE=',INCLUDE)
             (COL(1),A,A);
         INCLUDE = INCLUDE××STRING_W_E××' ; ';
         GET STRING(INCLUDE) LIST((E_WORK(JJ) DO JJ = 1 TO 26));
         DO I = 1 TO 26 WHILE(E_WORK(I) ^= 0);
            CURRENT = E_WORK(I) + 1;
            EVENTS(CURRENT) = CURRENT;
         END;
         END;
-
      IF EXCLUDE ^= '' THEN  DO;
         EVENT_EXCLUDE = '1';
         PUT FILE(SYSLOG) SKIP(2) EDIT('EXCLUDE=',EXCLUDE)
             (COL(1),A,A);
         EXCLUDE = EXCLUDE××STRING_W_E××' ; ';
         GET STRING(EXCLUDE) LIST((E_WORK(JJ) DO JJ = 1 TO 26));
         DO I = 1 TO 26 WHILE(E_WORK(I) ^= 0);
            CURRENT = E_WORK(I) + 1;
            EVENTS(CURRENT) = 256;
         END;
         END;
-
      IF JOBNAME ^= '' THEN  DO;
         PUT FILE(SYSLOG) SKIP(2) EDIT('JOBNAME=',JOBNAME)
             (COL(1),A,A);
         JOBNAME = JOBNAME××STRING_W_J××' ; ';
         GET STRING(JOBNAME) LIST((JOBS(JJ) DO JJ = 1 TO 8));
         END;
-
      IF ASIDS ^= '' THEN    DO;
         PUT FILE(SYSLOG) SKIP(2) EDIT('ASIDS=',ASIDS)
             (COL(1),A,A);
          ASIDS = ASIDS××STRING_W_A××' ; ';
         GET STRING(ASIDS) LIST((ASID(JJ) DO JJ = 1 TO 8));
         END;
-
      IF OPTIONS ^= '' THEN    DO;
         OPTIONS = OPTIONS ×× ' ; ';
         PUT FILE(SYSLOG) SKIP(2) EDIT('OPTIONS=',OPTIONS)
             (COL(1),A,A);
         END;
1/*                                                                  */
      SIGNAL ENDPAGE(SYSLOG);
      IF (ASID(1) ^= 0 × JOBS(1) ^= '' × EVENTS(1) ^= 16383)
      THEN DO;
      PUT FILE(SYSLOG) PAGE
      EDIT('D R I V E R    O P T I O N S    S E L E C T E D')
               (COL(24),A);
      PUT FILE(SYSLOG) SKIP(3);
      PUT FILE(SYSLOG) EDIT('DRIVER SELECT OPTIONS WERE:') (COL(1),A);
      PUT FILE(SYSLOG) EDIT (DRIVER) (COL(1),A);
      PUT FILE(SYSLOG) SKIP(2);
      IF ASID(1) ^= 0 THEN DO;
      PUT FILE(SYSLOG) EDIT('A S I D S   SELECTED') (COL(12),A);
      PUT FILE(SYSLOG) SKIP;
               DO I = 1 TO 8;
      IF ASID(I) = 0 THEN GOTO ASID_NDN;
      PUT FILE(SYSLOG) EDIT ('  ',ASID(I),'  ') (A,F(3),A);
      END;
  ASID_NDN: ;
      END;
      IF JOBS(1) ^= '' THEN DO;
      PUT FILE(SYSLOG) SKIP(2) EDIT('J O B S   SELECTED ') (COL(12),A);
   PUT FILE(SYSLOG) SKIP;
      DO I = 1 TO 8;
               IF JOBS(I) = '' THEN GOTO JOBS_NDN;
               PUT FILE(SYSLOG) EDIT(JOBS(I),'   ') (A,A);
               END;
  JOBS_NDN:
      END;
 /*   END OF OPTION LIST LOGIC                                        */
      END;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   R E C O R D    P R O C E S S I N G    L O O P                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
 PROCESS_START:
      READ FILE(SYSDATA) INTO(GTFREC);
      IF ( SEAID ^= GTFAID × SEFID ^= GTFFID × SEEID ^= GTFEID )
               THEN GOTO PROCESS_START;
      IF TRACE_DATE = (16)' ' THEN DO;
         WORK6 = UNSPEC(SETOD) ×× UNSPEC(SEDAY);
         TOD_CLOCK = WORK6;
         CALL @TOD(TOD_CLOCK,TIME_STRING);
         TRACE_DATE = YEAR34××'.'××TOD_DAY××'  '××HMS;
      END;
      XSER0 = SER0;
      XSER1 = SER1;
      XSERF = SER15;
      R0PTR = ADDR(SER0);                /*      SEAG                 */
      SUBSTR(WORK3,1,8) = '00000000'B;   /*   D E T E R M I N E       */
      SUBSTR(WORK3,9,8) = R0_B3;         /*   C U R R E N T           */
      UNSPEC(CURRENT) = WORK3;           /*   S Y S E V E N T         */
      EVENT_INDEX = CURRENT + 1;         /*   N U M B E R             */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   E V E N T    S E L E C T I O N   L O G I C                      */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      IF TIMER_SWITCH ^= 0 THEN DO;
          IF CURRENT = TIMEREXP THEN GOTO PROCESS_START;
      END;
      IF ASID(1) ^= 0 THEN DO;
               DO I = 1 TO 8;
               IF ASID(I) = R0_H1 THEN GOTO ASID_SELECT;
               END;
               GOTO PROCESS_START;
      ASID_SELECT:
      END;
      IF JOBS(1) ^= '' THEN DO;
               DO I = 1 TO 8;
               IF JOBS(I) = SEJOBNM THEN GOTO JOB_SELECT;
               END;
               GOTO PROCESS_START;
      JOB_SELECT:
      END;
      IF EVENT_INCLUDE = '1' THEN DO;
               IF EVENTS(EVENT_INDEX) = 16383 THEN
               GOTO PROCESS_START;
      END;
      IF EVENT_EXCLUDE = '1' THEN DO;
               IF EVENTS(EVENT_INDEX) = 256  THEN
               GOTO PROCESS_START;
      END;
 /*            END OF RECORD SELECTION LOGIC                          */
 /*                                                                   */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   C U R R E N T   R E C O R D   F O R M A T T I N G               */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      IF INIT_SWITCH = '1' THEN DO;
         SIGNAL ENDPAGE(SYSLINE);
      END;
      EVENT_TOTAL = EVENT_TOTAL + 1;
      EVENT_COUNT(EVENT_INDEX) = EVENT_COUNT(EVENT_INDEX) + 1;
      CURRENT_EVENT = EVENT_NAME(EVENT_INDEX);
      CURRENT_DEC = CURRENT;
      WORK1 = CURRENT;
      WORK8 = @HEX(WORK1);
      CURRENT_HEX = SUBSTR(WORK8,7,2);
      UNSPEC(WORK2) = SUBSTR(UNSPEC(SER0),1,16);
      CURRENT_ASID = WORK2;
      UNSPEC(WORK1) = UNSPEC(SER15);
      HEX_R15 = @HEX(WORK1);
      UNSPEC(WORK1) = UNSPEC(SER0);
      HEX_R0 = @HEX(WORK1);
      UNSPEC(WORK1) = UNSPEC(SER1);
      HEX_R1 = @HEX(WORK1);
      UNSPEC(WORK1) =SEASCB;
      CURRENT_ASCB = @HEX(WORK1);
      UNSPEC(WORK1) = UNSPEC(SETOD);
      SUBSTR(CURRENT_TOD,1,8) = @HEX(WORK1);
      UNSPEC(WORK1) = UNSPEC(SEDAY);
      SUBSTR(CURRENT_TOD,9,8) = @HEX(WORK1);
      WORK6 = UNSPEC(SETOD) ×× UNSPEC(SEDAY);
      TOD_CLOCK = WORK6;
      CALL @TOD(TOD_CLOCK,TIME_STRING);
      TOD_FORMAT = '>'××HMS××MICRO;
  /*  SUBSTR(WORK4,2,31) = SUBSTR(WORK6,15,31);                  */
      SUBSTR(WORK4,2,31) = SUBSTR(WORK6,22,31);            /*SEAG*/
      UNSPEC(CURRENT_TIME) = WORK4;
      IF FIRST_TIME = 0 THEN FIRST_TIME = CURRENT_TIME;
      IF LAST_TIME = 0 THEN LAST_TIME = CURRENT_TIME;
      TIME_CHANGE = CURRENT_TIME - LAST_TIME;
      REL_TIME = CURRENT_TIME - FIRST_TIME;
      DELTA = TIME_CHANGE;
      LAST_TIME = CURRENT_TIME;
      COMMAND_NAME = '        ';
      IF CURRENT = TSEVENT THEN
        DO;
          WORK6 = SER1××SER15;
          UNSPEC(WORK11) = WORK6;
          COMMAND_NAME = WORK11;
        END;
1
-
-
-
-
 /********************************************************************/
 /*                                                                  */
 /*                  *                            *******            */
 /*                * *                           *     *             */
 /*              *   *                          *     *              */
 /*            *     ***************************     *               */
 /*          *                                      *                */
 /**/      CALL     ANAL;                     /*   *                 */
 /*          *                                      *                */
 /*            *     ***************************     *               */
 /*              *   *                          *     *              */
 /*                * *                           *     *             */
 /*                  *                            *******            */
 /*                                                                  */
 /*                                                                  */
 /********************************************************************/
1/*                                                                   */
-
      INIT_SWITCH = '0';
      IF CURRENT_SWITCH = '0' THEN DO;
               PUT FILE(SYSLINE ) EDIT (CURRENT_HEX,CURRENT_DEC,
               CURRENT_EVENT,CURRENT_ASID,SEJOBNM,CURRENT_ASCB,HEX_R15,
               HEX_R1,DELTA,REL_TIME,TOD_FORMAT,COMMAND_NAME)
   (COL(1),A,X(2),A,X(1),A,X(2),A,X(2),A,X(2),A,X(2),A,X(1),A,X(2),
              A,X(1),A,X(2),A,X(2),A);
      END;
      CURRENT_SWITCH = '0';
      GOTO PROCESS_START;
 INPUT_ENDED:
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   T E R M I N A T I O N   P R O C E S S I N G                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      QUIT_SWITCH = '1';
      CALL ANAL;
      PUT PAGE;
               PUT SKIP(8);
      PUT  SKIP EDIT('E V E N T           T O T A L S')
               (COL(28),A);
      PUT SKIP(5);
    L = 4;
    DO I = 1 TO 72;
     IF L = 4 THEN DO;
         L = 0;
      PUT SKIP EDIT('    ') (COL(1),A);
      END;
      IF EVENT_COUNT(I) ^= 0 THEN DO;
        PUT EDIT(EVENT_NAME(I),' = ',EVENT_COUNT(I))
            (X(3),A,A,F(6));
       L = L + 1;
     END;
      END;
      PUT SKIP(6) EDIT
      (EVENT_TOTAL,'SYSEVENT  RECORDS  PROCESSED.')
      (COL(4),F(8),COL(16),A);
      PUT PAGE;
      RETURN;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   A B T E R M             P R O C E S S I N G                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
 ABTERM_PROCESS: ;
      PUT FILE(SYSPRINT) SKIP
         EDIT(ERRMSG5) (COL(1),A);
      PUT FILE(SYSLOG)   SKIP
         EDIT(ERRMSG5) (COL(1),A);
      RETURN;
-/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*   E N D    O F    I N S E R T E D    D R I V E R                  */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*   S T A R T   O F   U S E R   A N A L Y S I S   R O U T I N E     */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-/*                                                                   */
./ ADD NAME=JOBHIST                                12JUL91 11.08.10
 /*   JOB INITIATION/TERMINATION HSITOGRAM GENERATOR                 */
  JOBTME:            %INCLUDE(DRIVER);
 DECLARE XJOBN(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE XJOB1(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
     DECLARE XNAME(50) CHAR(8) INIT((50)'        ');
 DECLARE XJOB2(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE XJOB3(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE (XX,T1,T2,T3) FIXED BINARY(31,0) INIT(0) STATIC;
 DECLARE (PT1,PT2,PT3) PICTURE'999.999999';
  DECLARE JOB_MATRIX_A(BASE) FIXED BINARY(31,0) CONTROLLED;
  DECLARE JOB_MATRIX_B(BASE) FIXED BINARY(31,0) CONTROLLED;
  DECLARE BASE               FIXED BINARY(31,0) INIT(200);
1
     ANAL:   PROCEDURE OPTIONS(REENTRANT);
      IF INIT_SWITCH = '1' THEN DO;
         ALLOCATE JOB_MATRIX_A;
         ALLOCATE JOB_MATRIX_B;
      END;
      IF QUIT_SWITCH ^= '1' THEN DO;
               IF CURRENT = JOBSELCT THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = 0 THEN DO;
               XJOBN(I) = CURRENT_ASID;
       XNAME(I) = SEJOBNM;
               XJOB1(I) = CURRENT_TIME;
               GOTO JSL_XIT;
               END;
          END;
      JSL_XIT: ;
      END;
      IF CURRENT = INITATT THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               XJOB2(I) = CURRENT_TIME;
               GOTO INA_XIT;
               END;
               END;
      INA_XIT: ;
      END;
      IF CURRENT = INITDET THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               XJOB3(I) = CURRENT_TIME;
               GOTO IND_XIT;
               END;
               END;
      IND_XIT: ;
      END;
      IF CURRENT = JOBTERM THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               T1 = CURRENT_TIME - XJOB1(I);
               T2 = XJOB3(I) - XJOB2(I);
               T3 = (XJOB2(I) -XJOB1(I)) +
                    (CURRENT_TIME - XJOB3(I));
               PT1 = T1;
               PT2 = T2;
               PT3 = T3;
      PUT SKIP EDIT (XNAME(I),'ASID = ',XJOBN(I),'TOTAL = ',PT1,
               'JOB = ',PT2,'INIT/TERM = ',PT3)
               (COL(1),A,X(3),A,A,X(3),A,A,X(3),A,A,X(3),A,A);
               XJOBN(I) = 0;
               XJOB1(I) = 0;
               XJOB2(I) = 0;
               XX = XX + 1;
               XJOB3(I) = 0;
               GOTO JTR_XIT;
               END;
               END;
         JTR_XIT: ;
         END;
         END;  /* MAINLINE DO GROUP ENDS HERE */
         IF QUIT_SWITCH = '1' THEN DO;
         PUT SKIP(3) EDIT(XX,' JOBS PROCESSED') (COL(4),F(6),A);
         END;
         RETURN;
         END;
         END;
./ ADD NAME=JOBTME                                 12JUL91 11.08.10
 /*            JOB TIMING ANALYSIS  PROGRAM                           */
  JOBTME:            %INCLUDE(DRIVER);
 DECLARE XJOBN(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE XJOB1(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
     DECLARE XNAME(50) CHAR(8) INIT((50)'        ');
 DECLARE XJOB2(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE XJOB3(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE (XX,T1,T2,T3) FIXED BINARY(31,0) INIT(0) STATIC;
 DECLARE (PT1,PT2,PT3) PICTURE'999.999999';
1
     ANAL:   PROCEDURE OPTIONS(REENTRANT);
      IF QUIT_SWITCH ^= '1' THEN DO;
               IF CURRENT = JOBSELCT THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = 0 THEN DO;
               XJOBN(I) = CURRENT_ASID;
       XNAME(I) = SEJOBNM;
               XJOB1(I) = CURRENT_TIME;
               GOTO JSL_XIT;
               END;
          END;
      JSL_XIT: ;
      END;
      IF CURRENT = INITATT THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               XJOB2(I) = CURRENT_TIME;
               GOTO INA_XIT;
               END;
               END;
      INA_XIT: ;
      END;
      IF CURRENT = INITDET THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               XJOB3(I) = CURRENT_TIME;
               GOTO IND_XIT;
               END;
               END;
      IND_XIT: ;
      END;
      IF CURRENT = JOBTERM THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               T1 = CURRENT_TIME - XJOB1(I);
               T2 = XJOB3(I) - XJOB2(I);
               T3 = (XJOB2(I) -XJOB1(I)) +
                    (CURRENT_TIME - XJOB3(I));
               PT1 = T1;
               PT2 = T2;
               PT3 = T3;
      PUT SKIP EDIT (XNAME(I),'ASID = ',XJOBN(I),'TOTAL = ',PT1,
               'JOB = ',PT2,'INIT/TERM = ',PT3)
               (COL(1),A,X(3),A,A,X(3),A,A,X(3),A,A,X(3),A,A);
               XJOBN(I) = 0;
               XJOB1(I) = 0;
               XJOB2(I) = 0;
               XX = XX + 1;
               XJOB3(I) = 0;
               GOTO JTR_XIT;
               END;
               END;
         JTR_XIT: ;
         END;
         END;  /* MAINLINE DO GROUP ENDS HERE */
         IF QUIT_SWITCH = '1' THEN DO;
         PUT SKIP(3) EDIT(XX,' JOBS PROCESSED') (COL(4),F(6),A);
         END;
         RETURN;
         END;
         END;
./ ADD NAME=QUISCE                                 12JUL91 11.08.10
 /*   ANAL: QUIESCE ANALYSIS       */
 QUISCE:       %INCLUDE(DRIVER);
      DECLARE XCT   FLOAT BINARY(51,0) INIT(0);
      DECLARE XMAX  FLOAT BINARY(51,0) INIT(16383000);
      DECLARE XMIN  FLOAT BINARY(51,0) INIT(0);
      DECLARE XWORK FLOAT BINARY(51,0) INIT(0);
      DECLARE XSQ   FLOAT BINARY(51,0) INIT(0);
      DECLARE XSM   FLOAT BINARY(51,0) INIT(0);
      DECLARE QQS(255) FIXED BINARY(31,0) INIT((64)0);
      DECLARE QQT(255) FIXED BINARY(31,0) INIT((64)0);
      DECLARE XAVG  FLOAT BINARY(51,0) INIT(0);
      ANAL:    PROCEDURE OPTIONS(REENTRANT);
        IF QUIT_SWITCH ^= '1' THEN DO;
               IF CURRENT = QSCEST THEN DO;
                    DO I = 1 TO 64;
                    IF QQS(I) = 0 THEN DO;
                    QQS(I) = CURRENT_ASID;
                    QQT(I) = CURRENT_TIME;
                    GOTO QST_XIT;
                    END;
               END;
      QST_XIT: ;
      END;
      IF CURRENT = QSCECMP THEN DO;
               DO I = 1 TO 64;
                    IF QQS(I) = CURRENT_ASID THEN DO;
                    XCT = XCT + 1;
                    WORK1 = CURRENT_TIME - QQT(I);
                    XSM = XSM + WORK1;
                    IF XMAX < WORK1 THEN XMAX = WORK1;
                    IF XMIN > WORK1 THEN XMIN = WORK1;
                    XWORK          = WORK1/10;
                    XWORK = XWORK * XWORK;
                    XSQ = XSQ + XWORK;
                    QQS(I) = 0;
                    QQT(I) = 0;
                    GOTO QSN_XIT;
                    END;
               END;
      QSN_XIT: ;
      END;
 END;          /* END OF MAINLINE  */
      IF QUIT_SWITCH = '1' THEN DO;
               XAVG = XSM/XCT;
               XWORK = XSM * XSM;
               XSQ = XSQ * 10;
               XWORK = SQRT((XWORK-XSQ)/XCT);
      PUT SKIP(3) EDIT('ADDRESS SPACE QUIESCE TIMES')
               (COL(10),A);
      PUT SKIP EDIT('COUNT: ',XCT,'AVG: ',XAVG,'MIN: ',
               XMIN,'MAX: ',XMAX,'STD. DEVIATION: ',XWORK)
               (COL(4),A,F(6),X(2),A,F(6),X(2),A,F(6),X(2),A,F(6),
               X(2),A,F(6));
               PUT SKIP(2);
      END;
      RETURN;
      END;
         END;
./ ADD NAME=TRACES                                 12JUL91 11.08.10
 /*   BASIC DRIVER PROGRAM FOR TRACE FORMATTING                      */
 TRACES:       %INCLUDE(DRIVER);
  ANAL: PROCEDURE OPTIONS(REENTRANT);
      DECLARE SWITCH FIXED BINARY STATIC INIT(0);
     IF SWITCH = 0 THEN DO;
    SWITCH = 1;
     PUT PAGE ;
   PUT SKIP(10) EDIT('**********     ',
     'BASIC TRACE FORMATTER -- NO ANALYSIS ROUTINE')
     (COL(4),A,A);
    PUT PAGE;
    END;
    RETURN;
   END;
  END;
./ ADD NAME=TSOUSE                                 12JUL91 11.08.10
 /*   FORMATTER FOR DUMP OF TSO USER ACTIVITY                        */
 TRACES:       %INCLUDE(DRIVER);
  ANAL: PROCEDURE OPTIONS(REENTRANT);
      DECLARE USERID CHAR(8) INIT('JAC01   ');
      DECLARE SWITCH FIXED BINARY STATIC INIT(0);
      DECLARE TSNAME CHAR(8) INIT((8)' ');
     IF SWITCH = 0 THEN DO;
    SWITCH = 1;
     PUT PAGE ;
    END;
1/*                                                      */
       CURRENT_SWITCH = '1';
       IF USERID = SEJOBNM THEN DO;
       CURRENT_SWITCH = 0;
       IF CURRENT_EVENT= TSEVENT THEN DO;
       UNSPEC(TSNAME) = SER1××SER15;
          END;
      PUT EDIT (SEJOBNM,CURRENT_ASID,CURRENT_EVENT,TSNAME,
                REL_TIME,DELTA)
               (COL(1),A,X(2),A,X(2),A,X(2),A,X(2),A,X(2),A);
      END;
    RETURN;
   END;
  END;

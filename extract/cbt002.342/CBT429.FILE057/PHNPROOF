00010000PROC 0 DEBUG
00023000/*                                                               */
00030000/*  PHNPROOF - PRINT PROOF FROM PHONE TABLE                      */
00040000/*                                                               */
00050000CONTROL NOLIST NOMSG NOFLUSH PROMPT
00060000IF &DEBUG NE &STR() THEN +
00070000  CONTROL LIST MSG NOFLUSH PROMPT CONLIST SYMLIST
00080000ISPEXEC CONTROL ERRORS RETURN
00090000ISPEXEC DISPLAY PANEL(PHNPROOF)
00100000IF &LASTCC = 8 THEN +
00110000  DO
00120000    ISPEXEC  SETMSG MSG(PHN009T)
00130000    GOTO DONE
00140000  END
00141011ERROR +
00141111  DO
00141211    ISPEXEC SETMSG MSG(PHN009Y)
00141312    EXIT
00142011  END
00150019ISPEXEC  VGET (PHONORD PHONCOPY) ASIS
00200100/*                                                               */
00200200/*  CREATE SEQUENTIAL C271 FILE FROM PHONE TABLE                 */
00200300/*                                                               */
00203000ALLOC F(SYSUDUMP) DUMMY
00210000ALLOC F(SYSOUT) DUMMY
00220000ALLOC F(O271C) DA(&SYSUID..T271C) NEW SPACE(65 10) BLKSIZE(6160) REUSE UNIT(SYSDA) RELEASE CATALOG LRECL(80) RECFM(F B)
00221013ERROR OFF
00229300ISPEXEC SELECT PGM(PHONDUMP) NEWAPPL(PHN)
00229413SET &RC = &LASTCC
00229613ERROR +
00229713  DO
00229813    ISPEXEC SETMSG MSG(PHN009Y)
00229913    EXIT
00230013  END
00240000FREE F(SYSUDUMP SYSOUT O271C)
00250200/*                                                               */
00250300/*  SORT C271 BASED ON SORT OPTION                               */
00250400/*                                                               */
00250500ALLOC F(SYSUDUMP) DUMMY
00250600ALLOC F(SYSOUT) DUMMY
00250806ALLOC F(SYSIN) NEW SPACE(1 1) BLOCK(6160) BLKSIZE(6160) REUSE UNIT(SYSDA) RELEASE DELETE LRECL(80) RECFM(F B)
00250914ALLOC F(SORTIN) DA(&SYSUID..T271C) SHR REUSE DELETE
00251004OPENFILE SYSIN OUTPUT
00251101IF (&PHONORD = N) THEN +
00251201  DO
00251301    SET &SYSIN EQ &STR( SORT FIELDS=(20,40,CH,A,8,4,CH,A))
00251401  END
00251501IF (&PHONORD = E) THEN +
00251601  DO
00251701    SET &SYSIN EQ &STR( SORT FIELDS=(8,4,CH,A,20,40,CH,A))
00252001  END
00252101PUTFILE SYSIN
00252201CLOSFILE SYSIN
00252500ALLOC F(SORTOUT) DA(&SYSUID..T271CS) NEW SPACE(65 10) BLOCK(80) BLKSIZE(6160) REUSE UNIT(SYSDA) RELEASE CATALOG LRECL(80) RECFM(F B)
00252600$ SORT
00253000FREE F(SYSUDUMP SYSOUT SYSIN SORTIN SORTOUT)
00259600/*                                                               */
00259713/*  IEBPTPCH - PRINT PROOF                                       */
00259800/*                                                               */
00259901ALLOC F(SYSUDUMP) DUMMY
00260017ALLOC F(SYSPRINT) DUMMY REUSE
00260114ALLOC F(SYSUT1) DA(&SYSUID..T271CS) SHR REUSE DELETE
00260413ALLOC F(SYSUT2) SYSOUT(A) COPIES(&PHONCOPY) SPACE(10 10) REUSE BLOCK(6118) BLKSIZE(6118) LRECL(133) RECFM(F B M)
00260606ALLOC F(SYSIN) NEW SPACE(1 1) BLOCK(6160) BLKSIZE(6160) REUSE UNIT(SYSDA) RELEASE DELETE LRECL(80) RECFM(F B)
00260704OPENFILE SYSIN OUTPUT
00260808SET &SYSIN EQ &STR( PRINT  TYPORG=PS,CNTRL=2,MAXLINE=60,MAXFLDS=8)
00260901PUTFILE SYSIN
00261008SET &SYSIN EQ &STR( TITLE  ITEM=('DELUXE PHONE LIST PROOF                 ',45),          X        )
00261508PUTFILE SYSIN
00261608SET &SYSIN EQ &STR(        ITEM=('&SYSDATE',124)                                                   )
00261701PUTFILE SYSIN
00261808SET &SYSIN EQ &STR( TITLE  ITEM=('LOCATION',1),                                           X        )
00262202PUTFILE SYSIN
00262308SET &SYSIN EQ &STR(        ITEM=('FIRST AID',13),                                         X        )
00262408PUTFILE SYSIN
00262509SET &SYSIN EQ &STR(        ITEM=('EXTENSION',26),                                         X        )
00262608PUTFILE SYSIN
00262710SET &SYSIN EQ &STR(        ITEM=('BUILDING',39),                                          X        )
00262808PUTFILE SYSIN
00262910SET &SYSIN EQ &STR(        ITEM=('NAME/ROOM',51),                                         X        )
00263008PUTFILE SYSIN
00263110SET &SYSIN EQ &STR(        ITEM=('EXCLUDE',95),                                           X        )
00263208PUTFILE SYSIN
00263310SET &SYSIN EQ &STR(        ITEM=('BUDGET DEPT',106),                                      X        )
00263408PUTFILE SYSIN
00263510SET &SYSIN EQ &STR(        ITEM=('SUPPRESS',121)                                                   )
00263802PUTFILE SYSIN
00263908SET &SYSIN EQ &STR( RECORD FIELD=(4,1,,3),                                                X        )
00264002PUTFILE SYSIN
00264108SET &SYSIN EQ &STR(        FIELD=(1,6,,17),                                               X        )
00264202PUTFILE SYSIN
00264310SET &SYSIN EQ &STR(        FIELD=(4,8,,29),                                               X        )
00264402PUTFILE SYSIN
00264508SET &SYSIN EQ &STR(        FIELD=(4,14,,41),                                              X        )
00264602PUTFILE SYSIN
00264710SET &SYSIN EQ &STR(        FIELD=(40,20,,51),                                             X        )
00264802PUTFILE SYSIN
00264910SET &SYSIN EQ &STR(        FIELD=(1,60,,98),                                              X        )
00265002PUTFILE SYSIN
00265110SET &SYSIN EQ &STR(        FIELD=(4,61,,109),                                             X        )
00265202PUTFILE SYSIN
00265310SET &SYSIN EQ &STR(        FIELD=(1,65,,124)                                                       )
00265402PUTFILE SYSIN
00265502CLOSFILE SYSIN
00265607$ IEBPTPCH
00265717FREE F(SYSUDUMP SYSPRINT SYSUT1 SYSUT2 SYSIN)
00265802ISPEXEC  SETMSG MSG(PHN009W)
00266002DONE: +
00270000  SET &PHONCOPY = &STR( )
00280000  ISPEXEC  VPUT (PHONCOPY) ASIS
00290000  EXIT
00300000END

00010000PROC 0
00020072  ISPEXEC VGET (SLSS DEBUG CIBSRTKY CIBNUMBR LIBADMIN CIBOWNER CHGFLG) SHARED
00030016  IF &DEBUG = &STR(DEBUG) THEN DO
00040016      CONTROL MSG NOFLUSH LIST CONLIST SYMLIST PROMPT
00050016  END DO
00060016  ELSE DO
00070016      CONTROL NOMSG NOFLUSH NOLIST NOCONLIST NOSYMLIST
00080016  END DO
00090000/*====================================================================*/
00100000/*  SITE:    BLUE CROSS BLUE SHIELD OF KANSAS                         */
00110000/*  REFER:   USER.CMDPROC(SLSS)                                       */
00120000/*  AUTHOR:  DAVE WEILERT                                             */
00130000/*  DOC:     SLSS UTILITY DRIVER                                      */
00140000/*                                                                    */
00150000/*====================================================================*/
00160000/*                                                                    */
00170000BEGIN: +
00180061  ISPEXEC CONTROL ERRORS RETURN
00190061  ISPEXEC DISPLAY PANEL(SLSSADMN)
00200010  SET RC = &LASTCC
00210016  IF &RC = 8 THEN DO
00220051    ISPEXEC VPUT (CHGFLG) SHARED
00230016    EXIT
00240016  END DO
00250042  SET SLSSSUBS = &STR(N)
00260075  IF &SLSSOPT = 7 THEN GOTO OPT7
00270075  IF &SLSSOPT = 8 THEN GOTO OPT8
00280075  IF &SLSSOPT = 9 THEN GOTO OPT9
00290088SHOWSLSS: +
00300033  SET SL = &STR( )
00310066  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
00320061  SET RC = &LASTCC
00330061  IF &RC ^= 0 THEN DO
00340061    SET SLSSERR1 = UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
00350061    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
00360061    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00370061    SET SLSSERR4 = REGARDING THIS ERROR.
00380061    SET SLSSERR5 =
00390061    SET SLSSERRX = PRESS ENTER TO CONTINUE
00400061    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00410061    ISPEXEC TBEND SLSSCNTL
00420061    ISPEXEC VPUT (CHGFLG) SHARED
00430061    EXIT
00440061  END DO
00450066  ISPEXEC TBTOP SLSSCNTL
00460066  ISPEXEC TBDISPL SLSSCNTL PANEL(SLSSMSTR)
00470033  SET RC = &LASTCC
00480061  IF &RC = 8 THEN DO
00490066    ISPEXEC TBEND SLSSCNTL
00500061    GOTO BEGIN
00510061  END DO
00520035  IF &RC ^= 0 THEN DO
00530061    SET SLSSERR1 = UNABLE TO DISPLAY THE LIBRARIES IN SLSS SYSTEM.
00540061    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBDISPL' WAS &RC..
00550061    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00560061    SET SLSSERR4 = REGARDING THIS ERROR.
00570061    SET SLSSERR5 =
00580061    SET SLSSERRX = PRESS ENTER TO CONTINUE
00590061    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00600066    ISPEXEC TBEND SLSSCNTL
00610061    GOTO BEGIN
00620061  END DO
00630066  ISPEXEC TBEND SLSSCNTL
00640087  IF &SUBSTR(1:1,&STR(&ZCMD    )) = &STR(A) AND &SLSSOPT = &STR(1) THEN DO
00650083    SET SLSS = &STR( )
00660083    GOTO OPT1
00670083  END DO
00680083  SET SLSS = &CIBN
00690035  ISPEXEC VPUT (SLSS) SHARED
00700035  IF &LASTCC = 0 THEN GOTO OPT1
00710088  GOTO SHOWSLSS
00720003OPT1: +
00730015  IF &SLSSOPT ^= 1 THEN GOTO OPT2
00740066  ISPEXEC TBEND SLSSCNTL
00750066  ISPEXEC TBOPEN SLSSCNTL LIBRARY(SLSSTLIB)
00760015  SET RC = &LASTCC
00770057  IF &RC = 12 THEN DO
00780057    SET SLSSERR1 = ENQ FAILED; SLSSCNTL IN USE BY ANOTHER USER.
00790015    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
00800015    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00810015    SET SLSSERR4 = REGARDING THIS ERROR.
00820015    SET SLSSERR5 =
00830015    SET SLSSERRX = PRESS ENTER TO CONTINUE
00840015    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00850066    ISPEXEC TBEND SLSSCNTL
00860088    GOTO SHOWSLSS
00870015  END DO
00880057  IF &RC ^= 0 THEN DO
00890057    SET SLSSERR1 = UNABLE TO OBTAIN ACCESS TO CONTROL FILE, SLSSCNTL.
00900057    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
00910057    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00920057    SET SLSSERR4 = REGARDING THIS ERROR.
00930057    SET SLSSERR5 =
00940057    SET SLSSERRX = PRESS ENTER TO CONTINUE
00950057    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00960066    ISPEXEC TBEND SLSSCNTL
00970088    GOTO SHOWSLSS
00980057  END DO
00990066  ISPEXEC TBVCLEAR SLSSCNTL
01000066  SET CIBN = &STR(&SLSS)
01010066  ISPEXEC TBSARG SLSSCNTL
01020066  ISPEXEC TBSCAN SLSSCNTL
01030015  SET RC = &LASTCC
01040015  IF &RC = 8 THEN GOTO NEWTABL
01050015  IF &RC ^= 0 THEN DO
01060057    SET SLSSERR1 = UNABLE TO SCAN CONTROL FILE, SLSSCNTL.
01070015    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBSCAN' WAS &RC..
01080015    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01090015    SET SLSSERR4 = REGARDING THIS ERROR.
01100015    SET SLSSERR5 =
01110015    SET SLSSERRX = PRESS ENTER TO CONTINUE
01120015    ISPEXEC DISPLAY PANEL(SLSS@ERR)
01130066    ISPEXEC TBEND SLSSCNTL
01140088    GOTO SHOWSLSS
01150015  END DO
01160015PROCEED: +
01170015  ISPEXEC DISPLAY PANEL(SLSSMODL)
01180015  SET RC = &LASTCC
01190063  IF &RC = 8 THEN DO
01200066    ISPEXEC TBEND SLSSCNTL
01210088    GOTO SHOWSLSS
01220063  END DO
01230015  IF &RC ^= 0 THEN DO
01240015    SET SLSSERR1 = UNABLE TO DISPLAY LIBRARY MODIFICATION PANEL.
01250015    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
01260015    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01270015    SET SLSSERR4 = REGARDING THIS ERROR.
01280015    SET SLSSERR5 =
01290015    SET SLSSERRX = PRESS ENTER TO CONTINUE
01300015    ISPEXEC DISPLAY PANEL(SLSS@ERR)
01310066    ISPEXEC TBEND SLSSCNTL
01320088    GOTO SHOWSLSS
01330015  END DO
01340043  IF &SLSSSUBS = &STR(Y) THEN DO
01350081    ISPEXEC TBOPEN MAINMEMS WRITE LIBRARY(SLSSTLIB)
01360081    SET RC = &LASTCC
01370081    IF &RC ^= 0 THEN DO
01380081      SET SLSSERR1 = UNABLE TO OPEN SUB LIB/MEMBER XREF, MAINMEMS.
01390081      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
01400081      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01410081      SET SLSSERR4 = REGARDING THIS ERROR.
01420081      SET SLSSERR5 =
01430081      SET SLSSERRX = PRESS ENTER TO CONTINUE
01440081      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01450081      ISPEXEC TBEND MAINMEMS
01460088      GOTO SHOWSLSS
01470081    END DO
01480043    SET CNT = 0
01490081    SET SUBLIB = &STR(&CIBN)
01500044    DO WHILE &CNT < 60
01510043      SET CNT = &CNT + 1
01520066      SET PF  = &STR(&&SLB&CNT)
01530066      SET SAVSLB&CNT = &STR(&PF)
01540081      SET MEMBER = &STR(&PF)
01550081      ISPEXEC TBDELETE MAINMEMS
01560043    END DO
01570043    ISPEXEC DISPLAY PANEL(SLSSSUB1)
01580043    SET RC = &LASTCC
01590043    IF &RC = 8 THEN GOTO SKIPSUB1
01600043    IF &RC ^= 0 THEN DO
01610065      SET SLSSERR1 = UNABLE TO DISPLAY SUB LIBRARY IDENTIFICATION PANEL.
01620043      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
01630043      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01640043      SET SLSSERR4 = REGARDING THIS ERROR.
01650043      SET SLSSERR5 =
01660043      SET SLSSERRX = PRESS ENTER TO CONTINUE
01670043      ISPEXEC DISPLAY PANEL(SLSS@ERR)
01680066      ISPEXEC TBEND SLSSCNTL
01690088      GOTO SHOWSLSS
01700043    END DO
01710079    SET CNT = 0
01720079    SET SUBLIB = &STR(&CIBN)
01730079    DO WHILE &CNT < 60
01740079      SET CNT = &CNT + 1
01750079      SET PF  = &STR(&&SLB&CNT)
01760079      SET MEMBER = &STR(&PF)
01770079      ISPEXEC TBADD MAINMEMS
01780079    END DO
01790078    IF &SLB60 ^= &STR( ) THEN DO
01800043      SET CNT = 61
01810081      SET SUBLIB = &STR(&CIBN)
01820044      DO WHILE &CNT < 120
01830043        SET CNT = &CNT + 1
01840066        SET PF  = &STR(&&SLB&CNT)
01850066        SET SAVSLB&CNT = &STR(&PF)
01860081        SET MEMBER = &STR(&PF)
01870081        ISPEXEC TBDELETE MAINMEMS
01880043      END DO
01890043      ISPEXEC DISPLAY PANEL(SLSSSUB2)
01900043      SET RC = &LASTCC
01910043      IF &RC = 8 THEN GOTO SKIPSUB2
01920043      IF &RC ^= 0 THEN DO
01930065        SET SLSSERR1 = UNABLE TO DISPLAY SUB LIBRARY IDENTIFICATION PANEL.
01940043        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
01950043        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01960043        SET SLSSERR4 = REGARDING THIS ERROR.
01970043        SET SLSSERR5 =
01980043        SET SLSSERRX = PRESS ENTER TO CONTINUE
01990043        ISPEXEC DISPLAY PANEL(SLSS@ERR)
02000066        ISPEXEC TBEND SLSSCNTL
02010080        ISPEXEC TBCLOSE MAINMEMS LIBRARY(SLSSTLIB)
02020088        GOTO SHOWSLSS
02030043      END DO
02040079      SET CNT = 61
02050079      SET SUBLIB = &STR(&CIBN)
02060079      DO WHILE &CNT < 120
02070079        SET CNT = &CNT + 1
02080079        SET PF  = &STR(&&SLB&CNT)
02090079        SET MEMBER = &STR(&PF)
02100079        ISPEXEC TBADD MAINMEMS
02110079      END DO
02120043    END DO
02130043  END DO
02140043  GOTO VGET
02150043SKIPSUB1:+
02160043  SET CNT = 0
02170081  SET SUBLIB = &STR(&CIBN)
02180044  DO WHILE &CNT < 60
02190043    SET CNT = &CNT + 1
02200066    SET PF  = &STR(&&SAVSLB&CNT)
02210066    SET SLB&CNT = &STR(&PF)
02220081    SET MEMBER = &STR(&PF)
02230081    ISPEXEC TBADD MAINMEMS
02240043  END DO
02250043  GOTO VGET
02260043SKIPSUB2:+
02270043  SET CNT = 61
02280081  SET SUBLIB = &STR(&CIBN)
02290044  DO WHILE &CNT < 120
02300043    SET CNT = &CNT + 1
02310066    SET PF  = &STR(&&SAVSLB&CNT)
02320066    SET SLB&CNT = &STR(&PF)
02330081    SET MEMBER = &STR(&PF)
02340081    ISPEXEC TBADD MAINMEMS
02350043  END DO
02360043  GOTO VGET
02370043VGET:+
02380081  ISPEXEC TBCLOSE MAINMEMS LIBRARY(SLSSTLIB)
02390036  ISPEXEC VGET (ZJDATE ZMONTH ZDAY ZYEAR)
02400066  SET CIBJDATE = &STR(&ZJDATE)
02410066  SET CIBTIME  = &STR(&SYSSTIME)
02420066  SET CIBMDATE = &STR(&ZMONTH/&ZDAY/&ZYEAR)
02430066  SET CIBUPDTE = &STR(Y)
02440066  ISPEXEC TBPUT SLSSCNTL
02450066  ISPEXEC TBCLOSE SLSSCNTL LIBRARY(SLSSTLIB)
02460016  SET CHGFLG = &STR(Y)
02470088  GOTO SHOWSLSS
02480003NEWTABL: +
02490015  ISPEXEC DISPLAY PANEL(SLSSNEWT)
02500015  IF &LASTCC = 8 THEN DO
02510066    ISPEXEC TBEND SLSSCNTL
02520088    GOTO SHOWSLSS
02530015  END DO
02540066  SET CIBN     = &STR(&SLSS)
02550066  SET CIBCDATE = &STR(&SYSDATE)
02560066  SET CIBMDATE = &STR(&SYSDATE)
02570066  SET CIBSTABL = &STR(N)
02580066  SET CIBSDATE = &STR( )
02590066  SET CIBSRTKY = &STR( )
02600066  SET CIBEXTRA = &STR( )
02610066  SET CIBUPDTE = &STR(Y)
02620015  ISPEXEC VGET (ZJDATE)
02630066  SET CIBJDATE = &STR(&ZJDATE)
02640066  SET CIBTIME  = &STR(&SYSSTIME)
02650043  IF &SLSSSUBS = &STR(Y) THEN DO
02660043    ISPEXEC DISPLAY PANEL(SLSSSUB1)
02670043    SET RC = &LASTCC
02680043    IF &RC = 8 THEN GOTO SKIPSUB3
02690043    IF &RC ^= 0 THEN DO
02700065      SET SLSSERR1 = UNABLE TO DISPLAY SUB LIBRARY IDENTIFICATION PANEL.
02710043      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
02720043      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
02730043      SET SLSSERR4 = REGARDING THIS ERROR.
02740043      SET SLSSERR5 =
02750043      SET SLSSERRX = PRESS ENTER TO CONTINUE
02760043      ISPEXEC DISPLAY PANEL(SLSS@ERR)
02770066      ISPEXEC TBEND SLSSCNTL
02780088      GOTO SHOWSLSS
02790043    END DO
02800066    IF &SLB60 ^= &STR( ) THEN DO
02810043      ISPEXEC DISPLAY PANEL(SLSSSUB2)
02820043      SET RC = &LASTCC
02830043      IF &RC = 8 THEN GOTO SKIPSUB4
02840043      IF &RC ^= 0 THEN DO
02850065        SET SLSSERR1 = UNABLE TO DISPLAY SUB LIBRARY IDENTIFICATION PANEL.
02860043        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
02870043        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
02880043        SET SLSSERR4 = REGARDING THIS ERROR.
02890043        SET SLSSERR5 =
02900043        SET SLSSERRX = PRESS ENTER TO CONTINUE
02910043        ISPEXEC DISPLAY PANEL(SLSS@ERR)
02920066        ISPEXEC TBEND SLSSCNTL
02930088        GOTO SHOWSLSS
02940043      END DO
02950043    END DO
02960043  END DO
02970043  GOTO TBBOTTOM
02980043SKIPSUB3:+
02990043  SET CNT = 0
03000044  DO WHILE &CNT < 60
03010043    SET CNT = &CNT + 1
03020066    SET SLB&CNT = &STR( )
03030043  END DO
03040043  GOTO TBBOTTOM
03050043SKIPSUB4:+
03060043  SET CNT = 61
03070044  DO WHILE &CNT < 120
03080043    SET CNT = &CNT + 1
03090066    SET SLB&CNT = &STR( )
03100043  END DO
03110043  GOTO TBBOTTOM
03120043TBBOTTOM:+
03130066  ISPEXEC TBBOTTOM SLSSCNTL NOREAD
03140066  ISPEXEC TBADD SLSSCNTL
03150066  ISPEXEC TBCLOSE SLSSCNTL LIBRARY(SLSSTLIB)
03160016  SET CHGFLG = &STR(Y)
03170088  GOTO SHOWSLSS
03180007OPT2: +
03190039  IF &SLSSOPT ^= 2 THEN GOTO OPT3
03200075  IF &SLSS = &STR(MAIN) THEN DO
03210075    SET SLSSERR1 = DELETE FAILED. THE COMPLETE SLSS LIBRARY,
03220075    SET SLSSERR2 = 'MAIN', MAY NOT BE DELETED AT ANY TIME.
03230075    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
03240075    SET SLSSERR4 = REGARDING THIS ERROR.
03250075    SET SLSSERR5 =
03260075    SET SLSSERRX = PRESS ENTER TO CONTINUE
03270075    ISPEXEC DISPLAY PANEL(SLSS@ERR)
03280075    ISPEXEC TBEND SLSSCNTL
03290088    GOTO SHOWSLSS
03300075  END DO
03310039  ISPEXEC VPUT (SLSS DEBUG CHGFLG LIBADMIN) SHARED
03320048  %SLSSENQ ENQON
03330047  SET RC = &LASTCC
03340088  IF &RC ^= 0 THEN GOTO SHOWSLSS
03350039  %SLSSDELT
03360069  ISPEXEC VGET (CHGFLG) SHARED
03370088  GOTO SHOWSLSS
03380073OPT3: +
03390073  IF &SLSSOPT ^= 3 THEN GOTO OPT4
03400073  ISPEXEC VPUT (SLSS DEBUG CHGFLG LIBADMIN) SHARED
03410073  %SLSSENQ ENQON
03420073  SET RC = &LASTCC
03430088  IF &RC ^= 0 THEN GOTO SHOWSLSS
03440073  %SLSSEDIT
03450073  ISPEXEC VGET (CHGFLG) SHARED
03460088  GOTO SHOWSLSS
03470073OPT4: +
03480073  IF &SLSSOPT ^= 4 THEN GOTO OPT5
03490066  SET CIBUPDTE = &STR(N)
03500039  %SLSSRCOV
03510071  ISPEXEC VGET (CHGFLG) SHARED
03520088  GOTO SHOWSLSS
03530073OPT5: +
03540073  IF &SLSSOPT ^= 5 THEN GOTO OPT6
03550074  ISPEXEC VPUT (SLSS DEBUG CHGFLG LIBADMIN) SHARED
03560039  ISPEXEC SELECT PGM(SLSSKEYW)
03570067  ISPEXEC TBEND SLSSCNTL
03580067  ISPEXEC TBOPEN SLSSCNTL LIBRARY(SLSSTLIB)
03590067  SET RC = &LASTCC
03600067  IF &RC = 12 THEN DO
03610067    SET SLSSERR1 = ENQ FAILED; SLSSCNTL IN USE BY ANOTHER USER.
03620067    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
03630067    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
03640067    SET SLSSERR4 = REGARDING THIS ERROR.
03650067    SET SLSSERR5 =
03660067    SET SLSSERRX = PRESS ENTER TO CONTINUE
03670067    ISPEXEC DISPLAY PANEL(SLSS@ERR)
03680067    ISPEXEC TBEND SLSSCNTL
03690088    GOTO SHOWSLSS
03700067  END DO
03710067  IF &RC ^= 0 THEN DO
03720067    SET SLSSERR1 = UNABLE TO OBTAIN ACCESS TO CONTROL FILE, SLSSCNTL.
03730067    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
03740067    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
03750067    SET SLSSERR4 = REGARDING THIS ERROR.
03760067    SET SLSSERR5 =
03770067    SET SLSSERRX = PRESS ENTER TO CONTINUE
03780067    ISPEXEC DISPLAY PANEL(SLSS@ERR)
03790067    ISPEXEC TBEND SLSSCNTL
03800088    GOTO SHOWSLSS
03810067  END DO
03820067  ISPEXEC TBVCLEAR SLSSCNTL
03830067  SET CIBN = &STR(&SLSS)
03840067  ISPEXEC TBSARG SLSSCNTL
03850067  ISPEXEC TBSCAN SLSSCNTL
03860067  SET RC = &LASTCC
03870067  IF &RC = 8 THEN DO
03880067    SET SLSSERR1 = LIBRARY &SLSS NOT FOUND IN CONTROL FILE, SLSSCNTL.
03890067    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBSCAN' WAS &RC..
03900067    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
03910067    SET SLSSERR4 = REGARDING THIS ERROR.
03920067    SET SLSSERR5 =
03930067    SET SLSSERRX = PRESS ENTER TO CONTINUE
03940067    ISPEXEC DISPLAY PANEL(SLSS@ERR)
03950067    ISPEXEC TBEND SLSSCNTL
03960088    GOTO SHOWSLSS
03970067  END DO
03980067  IF &RC ^= 0 THEN DO
03990067    SET SLSSERR1 = UNABLE TO SCAN CONTROL FILE, SLSSCNTL.
04000067    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBSCAN' WAS &RC..
04010067    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
04020067    SET SLSSERR4 = REGARDING THIS ERROR.
04030067    SET SLSSERR5 =
04040067    SET SLSSERRX = PRESS ENTER TO CONTINUE
04050067    ISPEXEC DISPLAY PANEL(SLSS@ERR)
04060067    ISPEXEC TBEND SLSSCNTL
04070088    GOTO SHOWSLSS
04080067  END DO
04090067  SET CIBSDATE = &STR(&SYSDATE)
04100067  SET CIBSTABL = &STR(Y)
04110067  SET CIBUPDTE = &STR(Y)
04120067  SET CHGFLG = &STR(Y)
04130067  ISPEXEC TBPUT SLSSCNTL
04140067  ISPEXEC TBCLOSE SLSSCNTL LIBRARY(SLSSTLIB)
04150088  GOTO SHOWSLSS
04160073OPT6: +
04170073  IF &SLSSOPT ^= 6 THEN GOTO OPT7
04180068  ISPEXEC VPUT (SLSS DEBUG CHGFLG CIBSRTKY) SHARED
04190048  %SLSSENQ ENQON
04200047  SET RC = &LASTCC
04210088  IF &RC ^= 0 THEN GOTO SHOWSLSS
04220066  SET CHKSRTKY = &CIBSRTKY
04230039  %SLSSSORT
04240040  ISPEXEC VGET (CHGFLG)
04250051  ISPEXEC VPUT (SLSS DEBUG) SHARED
04260048  %SLSSENQ ENQOFF
04270088  GOTO SHOWSLSS
04280073OPT7: +
04290073  IF &SLSSOPT ^= 7 THEN GOTO OPT8
04300068  ISPEXEC VPUT (SLSS DEBUG CHGFLG) SHARED
04310039  %SLSSSUBS
04320071  ISPEXEC VGET (CHGFLG) SHARED
04330088  GOTO BEGIN
04340073OPT8: +
04350073  IF &SLSSOPT ^= 8 THEN GOTO OPT9
04360073  %SLSSJOBC
04370073  GOTO BEGIN
04380073OPT9: +
04390073  IF &SLSSOPT = 9 THEN DO
04400032    ISPEXEC VPUT (SLSS DEBUG CHGFLG LIBADMIN) SHARED
04410077    %SLSSCMPR START
04420050    ISPEXEC VGET (CHGFLG)
04430066    SET CIBUPDTE = &STR(N)
04440032  END DO
04450051  ISPEXEC VPUT (CHGFLG) SHARED
04460019  EXIT

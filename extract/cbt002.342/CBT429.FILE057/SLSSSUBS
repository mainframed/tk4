00010008PROC 0
00020008  ISPEXEC VGET (SLSS DEBUG CHGFLG)
00030008  IF &DEBUG = DEBUG THEN DO
00040008      CONTROL MSG LIST CONLIST SYMLIST
00050008  END DO
00060008  ELSE DO
00070008      CONTROL NOMSG
00080008  END DO
00090008BEGIN: +
00100013  ISPEXEC DISPLAY PANEL(SLSSSUBS)
00110013  SET RC = &LASTCC
00120013  IF &RC = 8 THEN EXIT
00130013  IF &RC ^= 0 THEN DO
00140013    SET SLSSERR1 = UNABLE TO DISPLAY SLSS SUB LIBRARY CREATION PANEL.
00150013    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
00160013    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00170013    SET SLSSERR4 = REGARDING THIS ERROR.
00180013    SET SLSSERR5 =
00190013    SET SLSSERRX = PRESS ENTER TO CONTINUE
00200013    EXIT
00210013  END DO
00220013  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
00230013  SET RC = &LASTCC
00240013  IF &RC ^= 0 THEN DO
00250013    SET SLSSERR1 = UNABLE TO OPEN SLSS CONTROL FILE, SLSSCNTL.
00260013    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
00270013    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00280013    SET SLSSERR4 = REGARDING THIS ERROR.
00290013    SET SLSSERR5 =
00300013    SET SLSSERRX = PRESS ENTER TO CONTINUE
00310013    ISPEXEC TBEND SLSSCNTL
00320013    EXIT
00330013  END DO
00340013  IF &STR(&SLSS) ^= &STR( ) THEN GOTO WARN1
00350013SHOWSLSS: +
00360013  SET SL = &STR( )
00370013  ISPEXEC TBTOP SLSSCNTL
00380013  ISPEXEC TBDISPL SLSSCNTL PANEL(SLSSMSTR)
00390013  SET RC = &LASTCC
00400013  IF &RC = 8 THEN DO
00410013    ISPEXEC TBEND SLSSCNTL
00420013    GOTO BEGIN
00430013  END DO
00440013  IF &RC ^= 0 THEN DO
00450013    SET SLSSERR1 = UNABLE TO DISPLAY THE LIBRARIES IN SLSS SYSTEM.
00460013    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBDISPL' WAS &RC..
00470013    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00480013    SET SLSSERR4 = REGARDING THIS ERROR.
00490013    SET SLSSERR5 =
00500013    SET SLSSERRX = PRESS ENTER TO CONTINUE
00510013    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00520013    ISPEXEC TBEND SLSSCNTL
00530013    GOTO BEGIN
00540013  END DO
00550013  SET SLSS = &CIBN
00560013  ISPEXEC VPUT (SLSS) SHARED
00570013WARN1: +
00580013  SET SLSSSAV = &STR(&SLSS)
00590013  IF &STR(&SLSS) = &STR(ALL) THEN GOTO WARN2
00600013  SET SLSSWRN1 = THIS UTILITY REQUIRES THAT THE LIBRARY, '&SLSS',
00610013  SET SLSSWRN2 = IS NOT CURRENTLY BEING UPDATED.
00620013  SET SLSSWRN3 = ANY UPDATES DONE PRIOR TO THIS SESSION WILL BE LOST.
00630013  SET SLSSWRN4 =
00640008  SET SLSSWRN5 =
00650012  SET SLSSWRNX = PRESS ENTER TO CONTINUE, END KEY TO TERMINATE.
00660008  ISPEXEC DISPLAY PANEL(SLSS@WRN)
00670008  SET RC = &LASTCC
00680013  IF &RC = 0 THEN GOTO ENQ1
00690013  ISPEXEC TBEND SLSSCNTL
00700013  EXIT
00710013WARN2: +
00720013  SET SLSSWRN1 = THIS UTILITY REQUIRES THAT THE SLSS TABLE FILE
00730013  SET SLSSWRN2 = IS NOT CURRENTLY BEING UPDATED.
00740013  SET SLSSWRN3 = ANY UPDATES DONE PRIOR TO THIS SESSION WILL BE LOST.
00750013  SET SLSSWRN4 =
00760013  SET SLSSWRN5 =
00770013  SET SLSSWRNX = PRESS ENTER TO CONTINUE, END KEY TO TERMINATE.
00780013  ISPEXEC DISPLAY PANEL(SLSS@WRN)
00790013  SET RC = &LASTCC
00800013  IF &RC = 0 THEN GOTO ENQ2
00810013  ISPEXEC TBEND SLSSCNTL
00820013  EXIT
00830013ENQ1: +
00840008  ISPEXEC VPUT (SLSS DEBUG) SHARED
00850008  %SLSSENQ ENQTEST
00860008  SET RC = &LASTCC
00870013  IF &RC = 0 THEN GOTO DONE
00880008  ELSE DO
00890012    SET SLSSERR1 = LIBRARY '&SLSS' IS CURRENTLY BEING UPDATED.
00900012    SET SLSSERR2 = SUB LIB BUILD MAY NOT CONTINUE AT THIS TIME.
00910012    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
00920012    SET SLSSERR4 = REGARDING THIS ERROR.
00930008    SET SLSSERR5 =
00940012    SET SLSSERRX = &STR(PRESS ENTER TO CONTINUE.
00950008    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00960008    ISPEXEC TBEND SLSSCNTL
00970008    EXIT
00980008  END DO
00990013ENQ2: +
01000013  ISPEXEC TBVCLEAR SLSSCNTL
01010013  ISPEXEC TBSKIP SLSSCNTL NUMBER(+1)
01020013  SET RC = &LASTCC
01030013  IF &RC = 8 THEN GOTO DONE
01040013  IF &RC ^= 0 THEN DO
01050013    SET SLSSWRN1 = UNABLE TO OBTAIN CONTROL FILE INFORMATION
01060013    SET SLSSWRN2 = FOR ONE OF THE LIBRARIES. PROCESSING WILL
01070013    SET SLSSWRN3 = CONTINUE FOR REMAINING LIBRARIES.
01080013    SET SLSSWRN4 = RETURN CODE FOR 'ISPEXEC TBSKIP' WAS &RC.
01090013    SET SLSSWRN5 =
01100013    SET SLSSWRNX = PRESS ENTER TO CONTINUE.
01110013    ISPEXEC DISPLAY PANEL(SLSS@WRN)
01120013    GOTO ENQ2
01130013  END DO
01140013  SET SLSS = &STR(&CIBN)
01150013  ISPEXEC VPUT (SLSS DEBUG) SHARED
01160013  %SLSSENQ ENQTEST
01170013  SET RC = &LASTCC
01180013  IF &RC = 0 THEN GOTO ENQ2
01190013  ELSE DO
01200013    SET SLSSERR1 = LIBRARY '&SLSS' IS CURRENTLY BEING UPDATED.
01210013    SET SLSSERR2 = SUB LIB BUILD MAY NOT CONTINUE AT THIS TIME.
01220013    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
01230013    SET SLSSERR4 = REGARDING THIS ERROR.
01240013    SET SLSSERR5 =
01250013    SET SLSSERRX = &STR(PRESS ENTER TO CONTINUE.
01260013    ISPEXEC DISPLAY PANEL(SLSS@ERR)
01270013    ISPEXEC TBEND SLSSCNTL
01280013    EXIT
01290013  END DO
01300008DONE: +
01310008  ISPEXEC TBEND SLSSCNTL
01320009  SET SLSS = &STR(MAIN)
01330009  ISPEXEC VPUT (SLSS DEBUG) SHARED
01340009  %SLSSENQ ENQALL
01350009  IF &LASTCC ^= 0 THEN EXIT
01360014  ISPEXEC VPUT (SLSSSAV) SHARED
01370008  ISPEXEC SELECT PGM(SLSSSUBL) PARM(&DEBUG)
01380009  SET SLSS = &STR(MAIN)
01390012  SET CHGFLG = &STR(Y)
01400012  ISPEXEC VPUT (SLSS CHGFLG DEBUG) SHARED
01410009  %SLSSENQ ENQOFF
01420008  EXIT

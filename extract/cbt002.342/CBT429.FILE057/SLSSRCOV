00010000PROC 0
00020004  ISPEXEC VGET (DEBUG SLSS CHGFLG CIBOWNER LIBADMIN) SHARED
00030000  IF &DEBUG = &STR(DEBUG) THEN DO
00040000      CONTROL MSG NOFLUSH LIST CONLIST SYMLIST PROMPT
00050000  END DO
00060000  ELSE DO
00070000      CONTROL NOMSG NOFLUSH NOLIST NOCONLIST NOSYMLIST
00080000  END DO
00090000/*====================================================================*/
00100000/*  SITE:    BLUE CROSS BLUE SHIELD OF KANSAS                         */
00110000/*  REFER:   USER.CMDPROC(SLSS)                                       */
00120000/*  AUTHOR:  DAVE WEILERT                                             */
00130000/*  DOC:     SLSS DRIVER                                              */
00140000/*                                                                    */
00150000/*====================================================================*/
00160000/*                                                                    */
00170000CHKWHO: +
00180000  IF &SYSUID = &STR(&LIBADMIN) THEN GOTO INIT
00190004  IF &SYSUID = &STR(&CIBOWNER) THEN GOTO INIT
00200004  SET SLSSWRN1 = USER '&SYSUID' IS UNAUTHORIZED FOR SELECTED OPTION.
00210004  SET SLSSWRN2 = PLEASE CONTACT OWNER '&CIBOWNER' OF LIBRARY FOR
00220004  SET SLSSWRN3 = FURTHER ASSISTANCE.
00230004  SET SLSSWRN4 =
00240004  SET SLSSWRN5 =
00250004  SET SLSSWRNX = PRESS ENTER TO CONTINUE
00260000  ISPEXEC DISPLAY PANEL(SLSS@WRN)
00270000  EXIT
00280000INIT: +
00290000  ISPEXEC DISPLAY PANEL(SLSSRCOV)
00300000  IF &LASTCC = 8 THEN DO
00310000    EXIT
00320000  END DO
00330000  ISPEXEC TBEND &SLSS
00340000  ISPEXEC TBEND &SLSS.ENQ
00350000OPENENQ: +
00360001  ISPEXEC TBOPEN &SLSS.ENQ LIBRARY(SLSSTLIB)
00370004  SET RC = &LASTCC
00380000  IF &RC ^= 0 THEN DO
00390004    SET SLSSERR1 = UNABLE TO OPEN ENQUEUE FILE TO RESET.
00400004    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
00410004    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
00420004    SET SLSSERR4 = ASSISTANCE REGARDING THIS ERROR.
00430004    SET SLSSERR5 =
00440004    SET SLSSERRX = PRESS ENTER TO CONTINUE
00450000    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00460000    ISPEXEC TBEND &SLSS.ENQ
00470000    EXIT
00480000  END DO
00490000GETENQ: +
00500000  ISPEXEC TBSKIP &SLSS.ENQ NUMBER(+1)
00510004  SET RC = &LASTCC
00520000  IF &RC ^= 0 THEN DO
00530004    SET SLSSERR1 = UNABLE TO OBTAIN ENQUEUE RECORD.
00540004    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
00550004    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
00560004    SET SLSSERR4 = ASSISTANCE REGARDING THIS ERROR.
00570004    SET SLSSERR5 =
00580004    SET SLSSERRX = PRESS ENTER TO CONTINUE
00590000    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00600000    ISPEXEC TBEND &SLSS.ENQ
00610000    EXIT
00620000  END DO
00630004  SET ENQU = &STR(    )
00640000PUTENQ: +
00650000  ISPEXEC TBPUT &SLSS.ENQ
00660004  SET RC = &LASTCC
00670000  IF &RC ^= 0 THEN DO
00680004    SET SLSSERR1 = UNABLE TO RESET ENQUEUE RECORD.
00690004    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBPUT' WAS &RC.
00700004    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
00710004    SET SLSSERR4 = ASSISTANCE REGARDING THIS ERROR.
00720004    SET SLSSERR5 =
00730004    SET SLSSERRX = PRESS ENTER TO CONTINUE
00740000    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00750000    ISPEXEC TBEND &SLSS.ENQ
00760000    EXIT
00770000  END DO
00780000CLOSENQ: +
00790001  ISPEXEC TBCLOSE &SLSS.ENQ LIBRARY(SLSSTLIB)
00800004  SET RC = &LASTCC
00810000  IF &RC ^= 0 THEN DO
00820004    SET SLSSERR1 = UNABLE TO CLOSE ENQUEUE FILE PROPERLY.
00830004    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBPUT' WAS &RC.
00840004    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
00850004    SET SLSSERR4 = ASSISTANCE REGARDING THIS ERROR.
00860004    SET SLSSERR5 =
00870004    SET SLSSERRX = PRESS ENTER TO CONTINUE
00880000    ISPEXEC DISPLAY PANEL(SLSS@ERR)
00890000    ISPEXEC TBEND &SLSS.ENQ
00900000    EXIT
00910000  END DO
00920004  SET CHGFLG = &STR(Y)
00930004  ISPEXEC VPUT (CHGFLG) SHARED
00940000EXITENQ: +
00950000  EXIT

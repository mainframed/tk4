CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE SECSET
C
C  AT ENTRY TO SECTOR, CREATE THE MAP OF THE SECTOR FOR THE PLAYER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      DIMENSION ISECDT(100),NSEC(100),IC2(7),NUMS(7)
C
      DIMENSION ISECCY(100),ICLIST(5),NLIST(5)
C
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),NCX(
     *     9),NCY(9)
C
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
C
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
C
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
C
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
C
      EQUIVALENCE (ISECCY(1),ISECT(1,1)) , (NLIST(1),NSTARS) , (NSEC(1),
     *     NSECE(1,1)) , (ISECDT(1),ISECT(1,1))
C
      DATA IC2 / '*','S','#','C','F','P','B'/
C
      DATA NUMS / -200000000,100000000,-99999999,-5800,0,0,0 / ,ICRDOT /
     *      '.'/
C
      DATA ICLIST / '*','P','B','F','C'/
C
      CALL DBUGIN ('SECSET ENTERED',IW(14),0)
      NUMS(7) = ISBSET(DUMMY)
      DO 10 N1 = 1, 100
           ISECCY(N1) = ICRDOT
10    CONTINUE
      IX1 = (ISCPY2-1)*10+ISCPX2
      ISECCY(IX1) = IC2(2)
      DO 40 N = 1, 5
           IF (NLIST(N).EQ.0) GO TO 40
           J = NLIST(N)
           DO 30 NX = 1, J
20              IXX = IFIX(RAND(100.0)+1.0)
                IF (ISECCY(IXX).NE.ICRDOT) GO TO 20
                ISECCY(IXX) = ICLIST(N)
30         CONTINUE
40    CONTINUE
      IF (RAND(1.0).LE.0.6) GO TO 70
      NBH = RAND(3.0)+1.0
      DO 60 N4 = 1, NBH
50         IX1 = RAND(100.0)+1.0
           IF (ISECCY(IX1).NE.ICRDOT) GO TO 50
           ISECCY(IX1) = IC2(3)
60    CONTINUE
70    INPL = IPLNET(ISCPX1,ISCPY1)
      INPLC = INPL
      IF (INPLC.EQ.0) GO TO 80
      IPOP = 0
      IDIL = 0
      INPLC = INPLC/10
      NUMS(6) = -100000000
      IF (INPLC.GT.9999) IDIL = 1
      IPOP = INPLC
      IF (INPLC.GT.9999) IPOP = (INPLC-10000)
      IF (IPOP.GT.0) NUMS(6) = NUMS(6)-200000000
      IF (IPOP.GT.7000) NUMS(6) = NUMS(6)-100000000
      IF (IPOP.GT.0.AND.IDIL.EQ.1) NUMS(6) = NUMS(6)-100000000
      GO TO 90
80    NUMS(6) = 0
90    NUMS(5) = IFEDST(DUMMY)
      DO 120 N5 = 1, 100
           IF (ISECDT(N5).EQ.ICRDOT) GO TO 110
           DO 100 N6 = 1, 7
                IF (ISECDT(N5).NE.IC2(N6)) GO TO 100
                NSEC(N5) = NUMS(N6)
                GO TO 120
100        CONTINUE
110        NSEC(N5) = 0
120   CONTINUE
C
      IPLENG = NUMS(6)
      IPBASE = NUMS(7)
      IOVER = 0
      NOCALL = 0
      CALL SSPRNT (0)
      CALL BATTLE
      CALL DBUGIN ('SECSET EXITED',IW(13),0)
      RETURN
      END

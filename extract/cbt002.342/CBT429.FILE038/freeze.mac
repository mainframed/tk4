CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE FREEZE
C
C  PURPOSE: WRITE GAME VARIABLES TO A FREEZE FILE
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      COMMON /SHIPS/ IUSFED(15,13)
C
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
C
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
C
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
C
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),NCX(
     *     9),NCY(9)
C
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
C
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
C
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
C
      COMMON /SRCOPY/ ISCOP(10,10)
C
      DATA ICRBLK / ' '/
C  IDATF IS OLD VARIABLE LEFTOVER FROM CDC DAYS
      CALL DBUGIN ('FREEZE ENTERED',IW(14),0)
      IDATF = 0
      REWIND 27
      WRITE (27) CSDATE,TGIVEN,ILEV,WFACT,IDATF,BATTER,ISSAVE,IDUM,TARX,
     *     TARY,ISCPX2,ISCPY2,NSECE,IHIT,ISBC,IFSC,IKCC,ITORCT,ISB,IFS,
     *     IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,ISECT,TVX,TVY,ICMC,
     *     ICHART,IPLNET,IKY,IPAD3,XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,
     *     XSSDC,XPTDC,NSTARS,NPLNTS,NSBASE,NFED,NCOMM,ICOND,ENERGY,
     *     ISHUPD,ISHENG,IAPDEV,IPOF,IOVER,NOCALL,IPLENG,IPBASE,IFED2,
     *     ICOMM2,IUSFED
      ENDFILE 27
      REWIND 27
      CALL PRMSG ('GAME NOW ON FROZEN FILE (TAPE27/FT27F001)',IW(41))
      CALL DBUGIN ('FREEZE EXITED',IW(13),0)
      GO TO 90
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      ENTRY GET
C
C     READ THE VARIABLES BACK FROM THE FROZEN FILE
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C    PLEASE NOTE, IPAD1(1) IS USED AS AN ERROR FLAG
C    SINCE IT IS NOT OF GREAT IMPORTANCE TO THE MAIN
C    PROGRAM.
C
      CALL DBUGIN ('GET ENTERED',IW(11),0)
      IPAD1(1) = 999999
      REWIND 27
      READ (27,END=80,ERR=80)
     *     CSDATE,TGIVEN,ILEV,WFACT,IDATF,BATTER,ISSAVE,IDUM,
     *     TARX,TARY,ISCPX2,ISCPY2,NSECE,IHIT,ISBC,IFSC,IKCC,ITORCT,ISB,
     *     IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,ISECT,TVX,TVY,
     *     ICMC,ICHART,IPLNET,IKY,IPAD3,XCDC,XSRDC,XIEDC,XLRDC,XWEDC,
     *     XDSDC,XSSDC,XPTDC,NSTARS,NPLNTS,NSBASE,NFED,NCOMM,ICOND,
     *     ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER,NOCALL,IPLENG,IPBASE,
     *     IFED2,ICOMM2,IUSFED
      DO 75 I=1, 10
         DO 75 J=1,10
            ISCOP(I,J) = ICRBLK
75    CONTINUE
      CALL DBUGIN ('GET EXITED',IW(10),0)
      GO TO 90
80    CONTINUE
      CALL PRMSG ('ERROR WHILE READING FILE, TRY AGAIN',IW(35))
      IPAD1(1) = -99999
90    RETURN
      END

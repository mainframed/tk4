CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE EMPLAC (NFS)
C
C  PLACE FEDERATION STARSHIPS (FOR EMERITUS ONLY) SO THAT ALL
C  STARBASES ARE GUARDED BY A STARSHIP, AND "EXTRA" STARSHIPS ARE PUT
C  NEAR STARBASES TOO.
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      COMMON /SHIPS/ IUSFED(15,13)
C
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
C
      CALL DBUGIN ('EMPLAC ENTERED',IW(14),0)
      IRF = 0
      DO 30 J = 1, 8
           DO 20 I = 1, 8
                IF (MOD(ICHART(I,J)/10,10).EQ.0) GO TO 20
                IRF = IRF+1
10              IX = (IFIX(RAND(3.0)+1.0)-2)+I
                IY = (IFIX(RAND(3.0)+1.0)-2)+J
                IF (IX.LT.1.OR.IX.GT.8.OR.IY.LT.1.OR.IY.GT.8) GO TO 10
                ICHART(IX,IY) = ICHART(IX,IY)+100
                CALL SSINIT (IUSFED,IX,IY)
20         CONTINUE
30    CONTINUE
      IFMORE = NFS-IRF
      DO 90 J = 1, IFMORE
40         IX = RAND(8.0)+1.0
           IY = RAND(8.0)+1.0
           ILOX = IX-ISGN(IX-1)
           IHIX = ISGN(8-IX)+IX
           ILOY = IY-ISGN(IY-1)
           IHIY = ISGN(8-IY)+IY
           DO 60 N = ILOY, IHIY
                DO 50 I = ILOX, IHIX
                     IF (MOD(ICHART(I,N)/10,10).NE.0) GO TO 70
50              CONTINUE
60         CONTINUE
           IOK = 0
           GO TO 80
70         IOK = 1
80         IF (IOK.EQ.0) GO TO 40
           ICHART(IX,IY) = ICHART(IX,IY)+100
           CALL SSINIT (IUSFED,IX,IY)
90    CONTINUE
      CALL DBUGIN ('EMPLAC EXITED',IW(14),0)
      RETURN
      END

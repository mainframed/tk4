CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE NUMREC (ICOMSC,IPNTRO,IERRCD,RTN)
C
C  TAKE A CHARACTER STRING CONTAINING A NUMBER, AND TURN IT INTO
C  A REAL NUMBER, WHOLE  NUMBERS ARE COMPLETELY ACCURATE,
C  DECIMAL NUMBERS CAN BE AS MUCH AS .001 OFF
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      DIMENSION ICOMSC(50),IWORK(26), IWRK2(26)
C
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
C
      CALL DBUGIN ('NUMREC ENTERED',IW(14),0)
      IPNTR = IPNTRO
      IERRCD = 0
      IERCD = 0
      NEGFLG = 1
      DO 5  N=1,26
           IWORK(N) = ICRBLK
           IWRK2(N) = ICRZER
5     CONTINUE
10    CONTINUE
      IF (ICOMSC(IPNTR).NE.ICRPLS) GO TO 20
      IPNTR = IPNTR+1
      GO TO 10
20    CONTINUE
      IF (ICOMSC(IPNTR).NE.ICRMIN) GO TO 30
      NEGFLG = -1
      IPNTR = IPNTR+1
      GO TO 20
30    CONTINUE
      IF (ICOMSC(IPNTR).EQ.ICRBLK) GO TO 120
      N = IPNTR
      J = 1
      IDOTPS = 0
35    CONTINUE
      IF (ICOMSC(N).EQ.ICRBLK.OR.J.GT.20) GO TO 37
           IF (ICOMSC(N).EQ.ICRDOT) IDOTPS = J
           IWORK(J) = ICOMSC(N)
           N = N + 1
           J = J + 1
           GO TO 35
37    CONTINUE
      IF (J.GT.20) GO TO 120
      IF (IDOTPS.GT.0) GO TO 38
           IDOTPS = J
           IWORK(J) = ICRDOT
           J = J + 1
38    CONTINUE
      IDOTCT = 0
      DO 39 N = 1,21
           IF (IWORK(N).EQ.ICRDOT) IDOTCT = IDOTCT + 1
39    CONTINUE
      IF (IDOTCT.NE.1) GO TO 120
      IF (IWORK(IDOTPS+4).EQ.ICRBLK) IWORK(IDOTPS+4) = ICRZER
      IF (IWORK(IDOTPS+3).EQ.ICRBLK) IWORK(IDOTPS+3) = ICRZER
      IF (IWORK(IDOTPS+2).EQ.ICRBLK) IWORK(IDOTPS+2) = ICRZER
      IF (IWORK(IDOTPS+1).EQ.ICRBLK) IWORK(IDOTPS+1) = ICRZER
      IWRK2(25) = IWORK(IDOTPS+4)
      IWRK2(24) = IWORK(IDOTPS+3)
      IWRK2(23) = IWORK(IDOTPS+2)
      IWRK2(22) = IWORK(IDOTPS+1)
      N = IDOTPS - 1
      J = 21
43    CONTINUE
      IF (N.LT.1) GO TO 45
          IWRK2(J) = IWORK(N)
          J = J - 1
          N = N - 1
          GO TO 43
45    CONTINUE
      DO 50 N=1,25
          CALL IDENT(IWRK2(N),IERR,IRTN)
          IF (IERR.NE.0) GO TO 120
50    CONTINUE
      R = 0.0
      CALL IDENT(IWRK2(22),IERR,IRTN)
      R = R + .1 * FLOAT(IRTN)
      CALL IDENT(IWRK2(23),IERR,IRTN)
      R = R + .01 * FLOAT(IRTN)
      CALL IDENT(IWRK2(24),IERR,IRTN)
      R = R + .001 * FLOAT(IRTN)
      CALL IDENT(IWRK2(25),IERR,IRTN)
      R = R + .0001 * FLOAT(IRTN)
      N = 1000000
      J = 0
      DO 101 I=15,21
           CALL IDENT (IWRK2(I),IERR,IRTN)
           J = J + (IRTN*N)
           N = N/10
101   CONTINUE
      RTN = FLOAT(J) + R
      RTN = RTN * NEGFLG
      GO TO 100
120   CONTINUE
      IERRCD = 1
      RTN = 0.0
100   CONTINUE
      CALL DBUGRN ('NUMREC RETURN VALUE',IW(19),RTN)
      CALL DBUGIN ('NUMREC EXITED',IW(13),0)
      RETURN
      END

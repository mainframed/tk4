CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE NOVKIL (IIX,IIY)
C
C  KILL AND DAMAGE THINGS AROUND A STAR THAT NOVAS
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      COMMON /SHIPS/ IUSFED(15,13)
      INTEGER CSEC
C
      COMMON /TRACOM/ TARX,TARY,PRESX,PRESY,NSECE(10,10),IHIT,ISBC,IFSC,
     *     IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,
     *     CSEC(10,10),TVX,TVY,ICMC
C
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
C
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
C
      DIMENSION IDMSG(11)
C
      DATA IZNOVD / 'NOVA'/
      DATA IDMSG / '** S','TARS','HIP ','U.S.','S. ',0,0,0,
     *              'AT S','ECTO','R: '/
      CALL DBUGIN ('NOVKIL ENTERED',IW(14),0)
      IY = IIY
      IX = IIX
      IF (CSEC(IX,IY).EQ.ICRCRH.OR.CSEC(IX,IY).EQ.ICRDOT) GO TO 90
      IF (CSEC(IX,IY).EQ.ICRSTR) GO TO 90
      IF (CSEC(IX,IY).NE.KZC) GO TO 10
      CALL PRMSM (
     *  '*** COMMANDER AT:',17,IW(17),IY,IX,
     *  'DESTROYED BY NOVA',17,IW(17))
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-1000
      NSECE(IX,IY) = 0
      CSEC(IX,IY) = ICRDOT
      IKCC = IKCC+1
      IKC = IKC-1
      GO TO 90
C
10    IF (CSEC(IX,IY).NE.KZP) GO TO 40
      CALL PRMSM (
     *  '*** PLANET AT: ',15,IW(15),IY,IX,
     *  'DESTROYED BY NOVA',17,IW(17))
      IPR = IPR-1
      IPLNET(ISCPX1,ISCPY1) = IPLNET(ISCPX1,ISCPY1)/10
      IF (IPLNET(ISCPX1,ISCPY1).GT.9999) GO TO 20
      IPLC = IPLC+100+(IPLNET(ISCPX1,ISCPY1)/100.0+.5)
      ET = ET+.000025*IPLNET(ISCPX1,ISCPY1)
      GO TO 30
20    IPLC = IPLC+600+((IPLNET(ISCPX1,ISCPY1)-10000)/100.0+.5)
      ET = ET+.25+.000025*((IPLNET(ISCPX1,ISCPY1)-10000)/100.0+.5)
30    IPLNET(ISCPX1,ISCPY1) = 0
      NSECE(IX,IY) = 0
      CSEC(IX,IY) = ICRDOT
      GO TO 90
40    IF (CSEC(IX,IY).NE.KZF) GO TO 60
      NSECE(IX,IY) = NSECE(IX,IY)-5100
      IF (NSECE(IX,IY).LE.0) GO TO 50
      CALL PRMSM ('*** FEDERATION STARSHIP AT: ',28,IW(28),IY,IX,
     *     'DAMAGED BY NOVA',15,IW(15))
      GO TO 90
50    CONTINUE
      ET = ET+.3
      IFS = IFS-1
      IFSC = IFSC+1
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-100
      NSECE(IX,IY) = 0
      CSEC(IX,IY) = ICRDOT
      CALL SSDEST (IUSFED,ISCPX1,ISCPY1,IX,IY,IDMSG(6))
      CALL PRMSM (
     *  IDMSG,44,IWV(44),IY,IX,'DESTROYED BY NOVA',17,IW(17))
      GO TO 90
60    IF (CSEC(IX,IY).NE.KZB) GO TO 80
      NSECE(IX,IY) = NSECE(IX,IY)-5100
      IF (NSECE(IX,IY).LE.0) GO TO 70
      CALL PRMSM (
     *  '*** STARBASE AT: ',17,IW(17),IY,IX,
     *  'DAMAGED BY NOVA',15,IW(15))
      GO TO 90
70    ET = ET+.5
      ISB = ISB-1
      ISBC = ISBC+1
      CSEC(IX,IY) = ICRDOT
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-10
      CALL PRMSM ('*** STARBASE AT: ',17,IW(17),IY,IX,
     *  'DESTROYED BY NOVA',17,IW(17))
      GO TO 90
80    CALL BEEP
      CALL ADDQUE('REDA')
      IF (CSEC(IX,IY).EQ.KZS) GO TO 89
      CALL PRMSG ('PLEASE REPORT NOVKIL ERROR 5   ',IW(28))
      CALL PRMSG ('CALLING FREEZE TO SAVE DATA',IW(29))
89    CONTINUE
      CALL PRMSG ('*** KAZH HIT BY BLAST OF NOVA',IW(29))
      IHIT = IZNOVD
90    CONTINUE
      CALL DBUGIN ('NOVKIL EXITED',IW(13),0)
      RETURN
      END

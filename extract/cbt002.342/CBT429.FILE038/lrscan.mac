CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE LRSCAN
C
C  PURPOSE, FOR CPU=0 DISPLAY LRS SCAN, FOR CPU=1, FILL THE IOUTT
C  UNIT WITH LRS INFO TO BE READ LATER
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
C
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
C
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
C
      COMMON /CPU/ IBMT
C
      COMMON /OUTUNT/ IOUTT
C
      DIMENSION JPLAN (9,2)
      DATA NONE /999999/
      CALL DBUGIN ('LRSCAN ENTERED',IW(14),0)
      IOUT = IOUTT
      IF (IBMT.EQ.1) IOUT = IOUT - 1
1610  IF (XLRDC.GT.0.001) GO TO 1710
      IX = ISCPX1
      IY = ISCPY1
      IT2 = IY+1
      IT = IY-1
      N50 = IX-1
      N51 = IX+1
      IDXXX = 0
      IF (IBMT.EQ.1) GO TO 1615
      CALL LINEF
      CALL PRMSM ('LONG RANGE SCAN FOR AREA: ',24,IW(24),IY,IX,' ',0,1)
      CALL LINEF
      GO TO 1618
1615  CONTINUE
      WRITE (IOUT,49000)
1618  CONTINUE
      IF (IX.EQ.1) GO TO 1620
      IF (IX.EQ.8) GO TO 1640
      GO TO 1660
1620  CONTINUE
      WRITE (IOUT,50000) NONE,ICHART(IX,IT),  ICHART(N51,IT),
     *                   NONE,ICHART(IX,IT+1),ICHART(N51,IT+1),
     *                   NONE,ICHART(IX,IT+2),ICHART(N51,IT+2)
      GO TO 1680
1640  CONTINUE
      WRITE (IOUT,50000) ICHART(N50,IT),  ICHART(IX,IT),  NONE,
     *                   ICHART(N50,IT+1),ICHART(IX,IT+1),NONE,
     *                   ICHART(N50,IT+2),ICHART(IX,IT+2),NONE
      GO TO 1680
1660  CONTINUE
      WRITE (IOUT,50000)
     *            ICHART(N50,IT),  ICHART(N50+1,IT),  ICHART(N51,IT),
     *            ICHART(N50,IT+1),ICHART(N50+1,IT+1),ICHART(N51,IT+1),
     *            ICHART(N50,IT+2),ICHART(N50+1,IT+2),ICHART(N51,IT+2)
1680  IF (N50.EQ.0) N50 = 1
      IF (N51.EQ.9) N51 = 8
      IF (IT2.EQ.9) IT2 = 8
      IF (IT.EQ.0) IT = 1
      IF (IBMT.EQ.0) CALL LINEF
      DO 1700 N60 = N50, N51
           DO 1690 N70 = IT, IT2
                IKY(N60,N70) = 1
                IF (IPLNET(N60,N70).EQ.0) GO TO 1690
                IF (IBMT.EQ.0)
     *               CALL PRMSM (
     *               'PLANET DETECTED IN QUADRANT: ',29,IW(29),N70,N60,
     *               ' ',0,1)
                IDXXX = IDXXX + 1
                JPLAN (IDXXX,1) = N70
                JPLAN (IDXXX,2) = N60
1690       CONTINUE
1700  CONTINUE
      IF (IDXXX.EQ.0) GO TO 150
      IF (IBMT.EQ.0) GO TO 150
      WRITE(IOUT,50010) ((JPLAN(I,J),J=1,2),I=1,IDXXX)
      GO TO 150
1710  WRITE (IOUT,50020)
150   CONTINUE
      CALL DBUGIN ('LRSCAN EXITED',IW(13),0)
      RETURN
C
49000 FORMAT (1X,'LONG RANGE SCAN'/1X,'---------------')
50000 FORMAT (1X,3(I4,1X)//1X,3(I4,1X)//1X,3(I4,1X))
50010 FORMAT (1X,'PLANET(S) IN:'/(I2,'-',I2,3X,I2,'-',I2))
50020 FORMAT (/' *LRS DAMAGED*')
C
      END

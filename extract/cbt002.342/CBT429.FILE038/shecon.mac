CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE SHECON
C
C  AUTOMATIC SHIELD CONTROL TO RAISE AND LOWER SHIELDS
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
C
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
C
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8),INPUT(50),IPAD3
C
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
C
      DATA IZGRE / 'GREE'/ ,IZDOWN / 'DOWN'/
      DATA IZRED / 'RED'/ ,IZUP / 'UP'/
      DATA IZDAMG / 'DAMG'/
C
      CALL DBUGIN ('SHECON ENTERED',IW(14),0)
      IF (IOVER.NE.0) GO TO 30
      J = ICROG(ICHART(ISCPX1,ISCPY1))
      IF (J.EQ.IZGRE.AND.ISHUPD.EQ.IZDOWN) GO TO 30
      IF (J.EQ.IZRED.AND.ISHUPD.EQ.IZUP) GO TO 30
      CALL LINEF
      IF (J.EQ.IZGRE) GO TO 60
      CALL PRMSG ('ENTERING BATTLE ZONE - BATTLE STATIONS',IW(38))
      CALL ADDQUE ('REDB')
      IF (ISHUPD.EQ.IZDAMG.OR.ISHENG.EQ.0.OR.ENERGY.LT.50.0) GO TO 40
      IF (ISHENG.LT.1250) GO TO 50
      IF (ENERGY.LT.800.0) GO TO 50
10    CALL LINEF
      CALL PRMSG (
     *  'AUTOMATIC DEFLECTOR SHIELD CONTROL ACTIVATED',IW(44))
      CALL PRMSG ('SHIELDS RAISED.',IW(15))
      ENERGY = ENERGY-50.0
      ISHUPD = IZUP
      IOVER = 1
20    CALL LINEF
30    CONTINUE
      GO TO 70
40    CALL PRMSG ('SHIELDS NOT CURRENTLY USABLE.',IW(29))
      IOVER = 1
      GO TO 20
50    CALL PRMRM ('CURRENT ENERGY = ',17,IW(17),ENERGY,' ',0,1)
      CALL PRMIM ('CURRENT SHIELD ENERGY = ',24,IW(24),
     *        ISHENG,' ',0,1)
      CALL YESNO ('DO YOU WISH TO RAISE SHIELDS',IW(28),28,IYES)
      IF (IYES.EQ.0) GO TO 20
      IF (IYES.EQ.1) GO TO 10
60    IF (ISHUPD.EQ.IZDAMG) GO TO 70
      CALL PRMSG (
     *  'AUTOMATIC DEFLECTOR SCREEN CONTROL ACTIVATING',IW(45))
      CALL PRMSG ('SHIELDS DROPPED.',IW(16))
      ISHUPD = IZDOWN
      GO TO 20
70    CONTINUE
      CALL DBUGIN ('SHECON EXITED',IW(13),0)
      RETURN
      END

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE GRAFIC
C
C  HANDLE THE DISPLAY FOR "MOVING" IMAGES ON THE SCREEN
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      COMMON /WORKQ/ IGCNT, INQUE(10)
C
      COMMON /DISPLY/ IDPAD(2), IGOUT(20,43)
C
      COMMON /TERMSZ/ IILINE
C
      COMMON /GRAPH/ IOK
C
      DIMENSION ITIMER(50)
      DIMENSION INCORE (20,43,50)
C
      DATA IEOF /'*EOF'/
      DATA INVAL /'    '/
      CALL DBUGIN ('GRAFIC ENTERED',IW(14),0)
      IF (IOK.EQ.0) IGCNT = 0
      IF (IGCNT.EQ.0.OR.IOK.NE.1) GO TO 1000
      I = 1
      IF (INVAL.EQ.INQUE(I)) GO TO 900
      K = 0
10    CONTINUE
      IF (I.GT.IGCNT) GO TO 900
      REWIND 97
      READ (97,50000,END=800) NTYPE, INLNEC, ITIME2
20    CONTINUE
      IF (NTYPE.EQ.IEOF) GO TO 800
      IF (NTYPE.NE.INQUE(I)) GO TO 50
      IF (IILINE.NE.INLNEC) GO TO 50
      INVAL = NTYPE
      K = K + 1
      IF (K.GT.50) K = 50
      DO 30 J=1, INLNEC
      READ (97,50001,END=800) (INCORE(M,J,K),M=1,20)
30    CONTINUE
      ITIMER(K) = ITIME2
      GO TO 60
50    CONTINUE
      DO 55 J=1, INLNEC
      READ (97,50002,END=800) IDUMMY
55    CONTINUE
60    CONTINUE
      READ (97,50000,END=800) NTYPE, INLNEC, ITIME2
      GO TO 20
800   CONTINUE
      I = I + 1
      GO TO 10
900   CONTINUE
      DO 905 J=1, K
      DO 910 M=1, IILINE
      DO 910 L=1,20
      IGOUT (L,M) = INCORE (L,M,J)
910   CONTINUE
      CALL FSIO2
      CALL STIMER (ITIMER(J))
905   CONTINUE
      IGCNT = 0
      CALL CPAGE
1000  CONTINUE
      CALL DBUGIN ('GRAFIC EXITED',IW(14),0)
      RETURN
50000 FORMAT (A4,I2,I6)
50001 FORMAT (20A4)
50002 FORMAT (A4)
      END

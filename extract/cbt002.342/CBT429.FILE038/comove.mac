CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE COMOVE
C
C  PURPOSE: CHECK TO SEE IF A COMMANDER NEEDS TO MOVE AROUND
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
C
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
C
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
C
      DATA ICRDOT / '.'/ ,KZC / 'C'/ ,IZRED / 'RED'/
C
      CALL DBUGIN ('COMOVE ENTERED',IW(14),0)
      DO 40 IY = 1, 8
           DO 30 IX = 1, 8
                J = ICHART(IX,IY)
                IF (J.EQ.9999.OR.J.LT.1000.OR.(IX.EQ.ISCPX1.AND.IY.EQ.
     *               ISCPY1)) GO TO 30
                IXM = 1
                IYM = 1
                IF (RAND(2.0).GT.1.0) IXM = -IXM
                IF (RAND(2.0).GT.1.0) IYM = -IYM
                IXM = IXM+IX
                IYM = IYM+IY
                IF (IXM.NE.ISCPX1.OR.IYM.NE.ISCPY1) GO TO 20
                IF (XLRDC.GT.0.001.AND.XSRDC.GT.001) GO TO 10
                CALL LINEF
      CALL PRMSG (
     *  'LORD COMMANDER, SENSORS INDICATE ONE OF OUR COMMANDERS IS',
     *  IW(57))
                CALL PRMSG ('ENTERING THE QUADRANT',IW(21))
10              M1 = RAND(10.0)+1.0
                M2 = RAND(10.0)+1.0
                IF (ISECT(M1,M2).NE.ICRDOT) GO TO 10
                ISECT(M1,M2) = KZC
                NSECE(M1,M2) = -4500
                ICHART(IX,IY) = ICHART(IX,IY)-1000
                ICHART(IXM,IYM) = ICHART(IXM,IYM)+1000
                GO TO 30
20              IF (IXM.LT.1.OR.IXM.GT.8.OR.IYM.LT.1.OR.IYM.GT.8.OR.
     *               ICROG(ICHART(IXM,IYM)).EQ.IZRED.OR.ICHART(IXM,IYM)
     *               .GT.1000) GO TO 30
                ICHART(IX,IY) = ICHART(IX,IY)-1000
                ICHART(IXM,IYM) = ICHART(IXM,IYM)+1000
30         CONTINUE
40    CONTINUE
      CALL DBUGIN ('COMOVE EXITED',IW(13),0)
      RETURN
      END

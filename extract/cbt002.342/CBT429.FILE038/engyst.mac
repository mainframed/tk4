CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE ENGYST (IENGST,IZRED)
C
C     PURPOSE - TEST LEVEL OF ENERGY LEFT IN SHIP
C     SET IENGST = -1 IF OUT OF ENERGY, 0 IF OK TO CONTINUE
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
C
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
C
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
C
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
C
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
C
      CALL DBUGIN ('ENGYST ENTERED',IW(16),0)
      IENGST = 0
      IF (ENERGY.GT.0.0) GO TO 180
      CALL LINEF
      IF (XCDC.GT.0.001) GO TO 160
      CALL PRMSG (
     * 'MAIN ENERGY BANKS HAVE FALLEN TO ZERO, BATTLE COMPUTER',IW(54))
      CALL PRMSG (
     * 'LOCKED INTO EMERGENCY ENERGY CIRCUITS, CROSS-CIRCUITING',IW(55)
     * )
      CALL PRMSG ('TO EMERGENCY RUBIDIUM ENERGY STORAGE CELLS',IW(42))
      CALL LINEF
      ENERGY = ENERGY+BATTER
      BATTER = 0.0
      IF (ENERGY.GT.0.0) GO TO 180
160   CONTINUE
      IF (ICROG(ICHART(ISCPX1,ISCPY1)).EQ.IZRED) GO TO 170
      CALL LINEF
      CALL PRMSG ('YOUR COMPUTER WAS UNABLE TO RESTORE YOUR ENERGY,',
     *     IW(48))
      CALL PRMSG ('YOU AND YOUR CREW DIE IN THE CRUEL COLDNESS OF SPACE'
     *     ,IW(52))
      GO TO 190
170   CONTINUE
      CALL LINEF
      CALL PRMSG ('THE SUPERCOMMANDER KAZH IS DESTROYED IN BATTLE',
     *     IW(46))
      CALL PRMSG ('AS FAR AS A KLINGON IS CONCERNED, THIS IS THE ONLY',
     *     IW(50))
      CALL PRMSG ('WAY TO DIE!',IW(11))
      GO TO 190
180   CONTINUE
      GO TO 200
190   CONTINUE
      IENGST = -1
200   CONTINUE
      CALL DBUGIN ('ENGYST EXITED',IW(16),0)
      RETURN
      END

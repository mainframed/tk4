CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE ABSORB (HHIT,SHIPO,SHEO)
C
C  PURPOSE: DETERMINE HOW MUCH HIT IS TO BE ABSORBED BY THE SHIELDS,
C  AND HOW MUCH BY THE SHIP
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      DATA IZDAMG / 'DAMG'/ ,IZDOWN / 'DOWN'/
      CALL DBUGIN ('ABSORB ENTERED',IW(14),0)
      CALL DBUGCH ('CURRENT SHIELD STATUS',IW(21),ISHUPD,IW(4))
      CALL DBUGRN ('HIT TO ABSORB ',IW(14),HIT)
      CALL DBUGIN ('SHIELD ENERGY ',IW(14),ISHENG)
      HIT = HHIT
      IF (ISHUPD.EQ.IZDAMG.OR.ISHUPD.EQ.IZDOWN.OR.ISHENG.EQ.0) GO TO 10
      IF (ISHENG.GT.2500) GO TO 20
      GO TO 40
10    CONTINUE
      CALL DBUGIN ('SHIP FULL HIT ',IW(14),0)
      SHE = 0.0
      SHIP = HIT
      GO TO 50
20    IF (HIT.GT.ISHENG) GO TO 30
      CALL DBUGIN ('SHLD FULL HIT ',IW(14),0)
      SHIP = 0.0
      SHE = HIT
      GO TO 50
30    HIT = HIT-FLOAT(ISHENG)
      SHE = FLOAT(ISHENG)
      SHIP = HIT
      GO TO 50
40    PCT = FLOAT(ISHENG)/25.0
      XPCT = 100.0-PCT
      SHIP = HIT*(XPCT/100.0)
      SHE = HIT*(PCT/100.0)
50    ENERGY = ENERGY-SHIP
      ISHENG = ISHENG-IFIX(SHE+.5)
      IF (ISHENG.LT.0) ISHENG = 0
      SHEO = SHE
      SHIPO = SHIP
      CALL DBUGRN ('SHIP ABSORB   ',IW(14),SHIPO)
      CALL DBUGRN ('SHIELD ABSORB ',IW(14),SHEO)
      CALL DBUGIN ('ABSORB EXITED ',IW(14),0)
      RETURN
      END

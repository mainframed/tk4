CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE SRSCAN (ISTAT,ISRS,ISCAN)
C
C  DISPLAY FORMATED INFORMATION ABOUT THE QUADRANT WE ARE IN
C  IF ISTAT = -1 AND ISCAN = -1 THEN THIS IS "COPY" OF LAST SRS
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
C
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
C
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
C
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
C
      COMMON /CPU/ IBMT
C
      COMMON /OUTUNT/ IOUTT
C
      DIMENSION ISCAN(10,10)
      DIMENSION IAPIND(2),IPTZ(2),IZARM(2), IZREAD(2),IZDAMG(2)
C
      DATA IBLK / ' '/ ,IYES / 1 / ,IZARM / 'ARME','D'/,IZOFF / 'OFF'/
      DATA IZREAD / 'READ','Y'/ ,IZOUT / 'OUT'/
      DATA IZDAMG / 'DAMA','GED'/
C
      CALL DBUGIN ('SRSCAN ENTERED',IW(14),0)
      NSDAM = 0
      IF (IBMT.EQ.0) CALL LINEF
      IOUT = IOUTT
      IF (IBMT.EQ.1) IOUT = IOUT - 1
      IPTZ(1) = IZREAD(1)
      IPTZ(2) = IZREAD(2)
      IF (XPTDC.LE.0.001) GO TO 5
      IPTZ(1) = IZDAMG(1)
      IPTZ(2) = IZDAMG(2)
5     CONTINUE
      IF (ITORCT.NE.0) GO TO 6
      IPTZ(1) = IZOUT
      IPTZ(2) = IBLK
6     CONTINUE
      REMAIN = TGIVEN-CSDATE
      IAPIND(1) = IZARM(1)
      IAPIND(2) = IZARM(2)
      IF (IAPDEV.EQ.1) GO TO 7
      IAPIND(1) = IZOFF
      IAPIND(2) = IBLK
7     CONTINUE
      ISHPCT = IFIX(FLOAT(ISHENG)/25.0)
      IF (ISTAT.NE.-1.OR.ISRS.NE.-1) GO TO 8
      NSDAM = IYES
      GO TO 30
8     CONTINUE
      IF (ISTAT.EQ.IYES.AND.ISRS.EQ.IYES) GO TO 30
      IF (ISTAT.NE.IYES.AND.ISRS.EQ.IYES) GO TO 20
      IF (ISTAT.EQ.IYES.AND.ISRS.NE.IYES) GO TO 10
      GO TO 30
C
C----------
C  STATUS ONLY AT THIS POINT.
C----------
C
10    WRITE (IOUT,50010)
     *     ITORCT,IPTZ,ISCPY1,ISCPX1,ISCPY2,ISCPX2,CSDATE,
     *     REMAIN,ICOND,IAPIND,ENERGY,ISHUPD,ISHPCT,ISHENG,WFACT,ISB,IFS
     *     ,IKC
      GO TO 40
C
C----------
C  SHORT FORM SRS
C----------
C
20    CONTINUE
      WRITE (IOUT,50000)
      WRITE (IOUT,50020) ((ISCAN(J,I),J=1,10),I=1,10)
      GO TO 40
C
C----------
C  LONG FORM SRS
C----------
C
30    CONTINUE
      WRITE (IOUT,50000)
      WRITE (IOUT,50030)
     *      (ISCAN(J,1),J=1,10),ITORCT,IPTZ,(ISCAN(J,2),J=1,10),
     *     ISCPY1,ISCPX1,ISCPY2,ISCPX2,(ISCAN(J,3),J=1,10),CSDATE,
     *     (ISCAN(J,4),J=1,10),REMAIN,(ISCAN(J,5),J=1,10),ICOND,IAPIND,
     *    (ISCAN(J,6),J=1,10),ENERGY,(ISCAN(J,7),J=1,10),ISHUPD,ISHPCT,
     *     ISHENG,(ISCAN(J,8),J=1,10),WFACT,(ISCAN(J,9),J=1,10),ISB,IFS,
     *     (ISCAN(J,10),J=1,10),IKC
      IF (NSDAM.EQ.IYES) WRITE (IOUT,50040)
      WRITE (IOUT,50050)
40    CONTINUE
      CALL DBUGIN ('SRSCAN EXITED',IW(13),0)
      RETURN
C
50000 FORMAT (1X,'   1 2 3 4 5 6 7 8 9 10 ')
50010 FORMAT (2X,'TORPEDOES',4X,I3,2X,'CONDITION:',2X,
     * A4,A3/ 2X,'POSITION',4X,I2,' - ',I2,',',I2,
     *' - ',I2/2X,'STARDATE',3X,F8.2/
     * 2X,'REMAINING',3X,F8.2/2X,'CONDITION',3X,2A4,
     * '  A.P.D. ',A4,A1/2X,'ENERGY',6X,F9.2/
     * 2X,'SHIELDS',6X,A4,2X,I3,' PCT ',I5,' UNTS'/
     * 2X,'WARP FACTOR ',F6.2/2X,
     * 'FEDERATION BASES ',I2,'  STARSHIPS ',I2/2X,
     * 'COMMANDERS   ',I2//)
C
50020 FORMAT (' 1  ',10(A1,1X)
     * / ' 2  ',10(A1,1X)/
     * ' 3  ',10(A1,1X)/' 4  ',10(A1,1X)/
     * ' 5  ',10(A1,1X)/
     * ' 6  ',10(A1,1X)/' 7  ',10(A1,1X)/
     * ' 8  ',10(A1,1X)/' 9  ',10(A1,1X)/
     * ' 10 ',10(A1,1X))
C
50030 FORMAT (' 1  ',10(A1,1X),2X,'TORPEDOES',4X,I3,2X,'CONDITION:',2X,
     * A4,A3/ ' 2  ',10(A1,1X),2X,'POSITION',4X,I2,' - ',I2,',',I2,
     *' - ',I2/' 3  ',10(A1,1X),2X,'STARDATE',3X,F8.2/' 4  ',10(A1,1X),
     * 2X,'REMAINING',3X,F8.2/' 5  ',10(A1,1X),2X,'CONDITION',3X,2A4,
     * '  A.P.D. ',A4,A1/' 6  ',10(A1,1X),2X,'ENERGY',6X,F9.2/' 7  ',
     * 10(A1,1X),2X,'SHIELDS',6X,A4,2X,I3,' PCT ',I5,' UNTS'/' 8  ',
     * 10(A1,1X),2X,'WARP FACTOR ',F6.2/' 9  ',10(A1,1X),2X,
     * 'FEDERATION BASES ',I2,'  STARSHIPS ',I2/' 10 ',10(A1,1X),2X,
     * 'COMMANDERS   ',I2)
50040 FORMAT
     *(' +++ SCANNERS DAMAGED, COPY OF LAST SCAN *** (STATUS CURRENT)')
50050 FORMAT (//)
      END

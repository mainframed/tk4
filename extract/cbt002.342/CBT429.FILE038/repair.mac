CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      SUBROUTINE REPAIR (TME)
C
C  BASED ON THE TIME USED UP, REPAIR BROKEN DEVICES ON THE SHIP
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      DIMENSION DEV(8)
      EQUIVALENCE (DEV(1),XCDC)
      DATA IZDOWN / 'DOWN'/ ,IZDAMG / 'DAMG'/
      CALL DBUGIN ('REPAIR ENTERED',IW(14),0)
      CALL CORAND (TME)
      DO 10 N = 1, 8
           DEV(N) = DEV(N)-TME
           IF (DEV(N).GT..0009999) GO TO 10
           DEV(N) = 0.0
10    CONTINUE
      IF (XDSDC.LE.0.001.AND.ISHUPD.EQ.IZDAMG) ISHUPD = IZDOWN
      CALL DBUGIN ('REPAIR EXITED',IW(13),0)
      RETURN
      END

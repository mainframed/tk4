         TITLE 'TMCTABC - CREATE TMC TABLE FROM SEQ INPUT'
***********************************************************************
*                                                                     *
*             MODULE NAME = TMCTABC                                   *
*                                                                     *
*             CHANGE ACTIVITY =                                       *
*                03/26/86  WRITTEN.                              JWC. *
*                                                                     *
*                04/09/86  CHANGE AFTER ALLOWING FOR DSNB'S.     JWC. *
*                                                                     *
*                12/12/86  CORRECT CATALOG DETERMINATION PART.   JWC. *
*                                                                     *
***********************************************************************
         EJECT
         TITLE 'TMCTABC - ISPCALL MACRO'
         MACRO
&LBL     ISPCALL &LIST,        CALL PARAMETERS                         +
               &EP=ISPLINK,                                            +
               &LISTLBL=,      LABEL FOR PARAMETER LIST (NON-REENT)    +
               &EPADDR=,       LABEL FOR ADDRESS OF EP OF ISPLINK      +
               &WKAREA=,       TO BUILD CALL LIST (REENTERANT CODE)    +
               &WKREG=,        WORK REGISTER (DEFAULT 1)               +
               &TRACE=         'OFF' OR BIT FOR TRACE MODE
.*  ONCE WKAREA, WKREG, AND TRACE ARE SPECIFIED, THEY ARE USED IN ALL
.*  SUBSEQUENT OCCURRENCES OF THIS MACRO, UNLESS THE PARAMETER IS
.*  EXPLICITLY CODED.
.*  NOTE: FIRST 4 BYTES OF WKAREA ARE USED TO STORE NUMERIC VALUES,
.*  WHICH ARE PRIMARILY LENGTH FIELDS.
         LCLA  &S,&T,&U,&TRCEMSK
         LCLB  &NUMSW
         LCLC  &NDX,&WKAR,&WKRG,&WKEP
         GBLC  &ISPRREG,&ISPRAR,&ISPTRC1,&ISPEP
         GBLA  &ISPTRC2
&NDX     SETC  '&SYSNDX'
&S       SETA  1               SUBSCRIPT FOR GOING THRU &LIST
***********************************************************************
         AIF   (T'&LBL NE 'O').L1
*                  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
         AGO   .L2
.L1      ANOP
&LBL     DS    0H  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
.L2      ANOP
         AIF   (T'&LIST NE 'O').A1
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE PROVIDED ***'
         AGO   .EXIT
.A1      AIF   ('&LIST'(1,1) EQ '(').CHKTRCE
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE ENCLOSED IN PARENTHES+
               ES ***'
         AGO   .EXIT
.****************** ANALYZE "TRACE" PARAMETER *************************
.CHKTRCE AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' NE '').TRCE4
         AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' EQ '').TRCEOFF
         AIF   ('&TRACE'(1,1) EQ '(').TRCEON
         AIF   ('&TRACE' EQ 'OFF').TRCEOFF
         MNOTE 12,'*** INVALID TRACE PARAMETERS ***'
         AGO   .EXIT
.TRCEON  AIF   (T'&TRACE(2) EQ 'N').TRCE2
.TRCE8   MNOTE 12,'*** TRACE BIT (2ND PARAMETER) MUST BE 0 - 7 ***'
         AGO   .EXIT
.TRCE2   AIF   (&TRACE(2) GE 0 OR &TRACE(2) LE 7).TRCE3
         AGO   .TRCE8
.TRCE3   ANOP
&ISPTRC1 SETC  '&TRACE(1)'     SET GLOBAL VARIABLE
&ISPTRC2 SETA  &TRACE(2)       SET GLOBAL VARIABLE
.TRCE4   ANOP
&U       SETA  0
&TRCEMSK SETA  255
&T       SETA  128
.TRCE5   AIF   (&U GT 7).CHKREG
         AIF   (&ISPTRC2 NE &U).TRCE7
.TRCE6   ANOP
&U       SETA  &U+1
&T       SETA  &T/2
         AGO   .TRCE5
.TRCE7   ANOP
&TRCEMSK SETA  &TRCEMSK-&T
         AGO   .TRCE6
.TRCEOFF ANOP
&ISPTRC1 SETC  ''              SET GLOBAL VARIABLE
.****************** ANALYZE "WKREG" PARAMETER *************************
.CHKREG  AIF   (T'&WKREG EQ 'O').A2
&ISPRREG SETC  '&WKREG'        SET GLOBAL VARIABLE
.A2      AIF   ('&ISPRREG' EQ '').A3
&WKRG    SETC  '&ISPRREG'
         AGO   .CHKAREA
.A3      ANOP
&ISPRREG SETC  '1'             SET GLOBAL VARIABLE
         AGO   .A2
.****************** SEE IF USING PROVIDED WORKAREA ********************
.CHKAREA AIF   (T'&WKAREA NE 'O' OR '&ISPRAR' NE '').RENT
         AIF   (T'&LISTLBL EQ 'O').B1
&WKAR    SETC  '&LISTLBL'
         AGO   .B2
.B1      ANOP
&WKAR    SETC  'ISPC&NDX'      LABEL FOR MACRO WORKAREA
.B2      ANOP
&T       SETA  4*(N'&LIST+1)   LENGTH OF MACRO WORKAREA
         B     &WKAR.+&T             BRANCH AROUND DATA         ISPCALL
&T       SETA  N'&LIST+1
&WKAR    DC    &T.F'0'               PARAMETER LIST             ISPCALL
.******************** BUILD PARAMETER LIST ****************************
.LOOP    AIF   (&S GT N'&LIST).ENDLOOP
         AIF   ('&LIST(&S)'(1,1) EQ '''').C1 TEST FOR LITERAL
         AIF   (T'&LIST(&S) EQ 'N').NUM      TEST FOR NUMERIC
         AIF   ('&LIST(&S)'(1,1) EQ '(').REG TEST FOR REG NOTATION
         LA    &WKRG,&LIST(&S)       LOAD DATA ADDR             ISPCALL
.ST      ANOP
&T       SETA  4*&S
         ST    &WKRG,&WKAR.+&T       STORE IN PARAM LIST        ISPCALL
         AIF   ('&ISPTRC1' EQ '' OR &S GT 1).C3           TRACE
         TM    &ISPTRC1,&TRCEMSK     IS TRACE BIT ON?     TRACE ISPCALL
         BZ    ISPT&NDX                                   TRACE ISPCALL
         AIF   ('&WKRG' EQ '1' OR '&WKRG' EQ 'R1').C4     TRACE
         LR    1,&WKRG               LOAD SRVC NAME ADDR  TRACE ISPCALL
         EJECT
.C4      AIF   ('&LIST(&S)'(1,1) EQ '''').C5 LITERAL?     TRACE
         LA    0,8                   LOAD LENGTH          TRACE ISPCALL
         AGO   .C6                                        TRACE
.C5      ANOP                                             TRACE
&U       SETA  K'&LIST(&S)-2   LENGTH OF SERVICE NAME     TRACE
         LA    0,&U                  LOAD LENGTH          TRACE ISPCALL
.C6      ANOP                                             TRACE
         SVC   93                    ISSUE TPUT SVC       TRACE ISPCALL
ISPT&NDX EQU   *                                          TRACE ISPCALL
.C3      ANOP
&S       SETA  &S+1
         AGO   .LOOP
.C1      AIF   (&S EQ 1).C2    SPF SERVICE NAME - LENGTH IS OK
&T       SETA  K'&LIST(&S)-2
         AIF   (&T GT 7).C2    LENGTH 8 OR GREATER IS OK
&T       SETA  &T+1            ADD FOR ONE BLANK
         LA    &WKRG,=CL&T.&LIST(&S) LOAD DATA ADDR             ISPCALL
         AGO   .ST
.C2      ANOP
         LA    &WKRG,=C&LIST(&S)     LOAD DATA ADDR             ISPCALL
         AGO   .ST
.NUM     AIF   (&NUMSW).NUM2
.*  NOTE: SPF WILL MODIFY LENGTH FIELDS, SO THEY CANNOT BE IN
.*  REENTERANT CODE.
         MVC   &WKAR.(4),=F'&LIST(&S)'                                 +
                                     MOVE NUMERIC VALUE         ISPCALL
&NUMSW   SETB  1
         AGO   .LA
.NUM2    MNOTE 12,'*** ONLY ONE NUMERIC ALLOWED PER ISPCALL MACRO - LIS+
               T ITEM &S --&LIST(&S)-- IS SECOND OCCURRENCE ***'
         AGO   .EXIT
.LA      ANOP
         LA    &WKRG,&WKAR           LOAD DATA ADDR             ISPCALL
         AGO   .ST
.REG     ANOP
&T       SETA  4*&S
         ST    &LIST(&S),&WKAR.+&T                              ISPCALL
         AGO   .C3
.******************** USING PROVIDED WORKAREA *************************
.RENT    AIF   (T'&WKAREA EQ 'O').RENT2
&ISPRAR  SETC  '&WKAREA'       SET GLOBAL VARIABLE
.RENT2   ANOP
&WKAR    SETC  '&ISPRAR'
         AGO   .LOOP
         EJECT
.****************** GENERATE STATEMENTS FOR CALL **********************
.ENDLOOP ANOP
         OI    &WKAR.+&T,X'80'       TURN ON VL BIT             ISPCALL
.*       LA    1,&WKAR.+4                                       ISPCALL
.*       L     15,=V(&EP)                                       ISPCALL
.*       BALR  14,15                                            ISPCALL
         AIF   (T'&EPADDR EQ 'O').EP2
&ISPEP   SETC  '&EPADDR'
         LOAD  EP=ISPLINK
         ST    R0,&ISPEP
.EP2     ANOP
&WKEP    SETC  '&ISPEP'
         L     15,&WKEP
         LA    1,&WKAR.+4
         CALL  (15)
.EXIT    ANOP
***********************************************************************
         SPACE 2
         MEND
         EJECT
         TITLE 'TMCTABC - INITIALIZATION SECTION'
TMCTABC CSECT
***********************************************************************
*  INITIALIZATION SECTION - GETMAIN WORKAREA AND SAVE AREA CHAINING
***********************************************************************
         SAVE  (14,12),,TMCTABC_&SYSDATE_&SYSTIME    SAVE REGISTERS
         LR    R12,R15                 LOAD REG 12 WITH ENTRY ADDRESS
         USING TMCTABC,R12             ESTABLISH ADDRESSABILITY TO
*                                      PROGRAM CSECT
         LA    R11,4095(R12)           LOAD REG 11 WITH EXTENDED ENTRY
         USING TMCTABC+4095,R11        EXTEND ADDRESSABILITY
         GETMAIN R,LV=WORKLEN          GETMAIN DYNAMIC WORKAREA
         ST    R13,4(R1)               STORE ADDRESS PREVIOUS SAVEAREA
         ST    R1,8(,R13)              STORE ADDRESS OF CURRENT
*                                      SAVEAREA IN PREVIOUS SAVEAREA
         LR    R13,R1                  LOAD REG 13 WITH ADDRESS OF
*                                      CURRENT SAVEAREA
         USING WORKAREA,R13            ESTABLISH ADDRESSABILITY TO
*                                      DYNAMIC WORKAREA
         LA    R4,DATA                 SET UP
         LA    R5,DATALEN                  REGISTERS
         LA    R6,INITDATA                     FOR
         LA    R7,DATALEN                          LONG MOVE
         MVCL  R4,R6                   INITIALIZE PART GETMAINED AREA
         MVC   TMCMSG,SPACES           INITIALIZE ERROR MESSAGE
         MVC   FINDFLGS,FLAGS1         INITIALIZE FLAGS FOR LOCATE
         LA    R4,TMCDSN               R4 - ADDRESS OF DATA SET NAME
         ST    R4,FINDDSN              STORE IN CAMLIST FOR LOCATE
         SR    R4,R4                   CLEAR REG 4
         ST    R4,FINDVOL              INITIALIZE FINDVOL
         LA    R4,WORK                 R4 - ADDR - WORK AREA FOR LOCATE
         ST    R4,FINDWORK             MOVE INTO FINDSN
***********************************************************************
*  INITIALIZATION SECTION - SET DIALOG CONTROL, DEFINE VARIABLES
***********************************************************************
*                                      SET DIALOG CONTROL
         ISPCALL ('CONTROL','ERRORS','RETURN'),                        +
               WKAREA=PARMS,                                           +
               EPADDR=ISPADDR
VDEF1    EQU   *
         MVC   ISPFSERV,DEFID          SET ISPF DIALOG SERVICE
         MVC   REGID,NONE              SET REIONAL IDENTIFIER
*                                      DEFINE VARIABLES
         ISPCALL ('VDEFINE',NAMELST2,TMCDSN,'CHAR',44)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF2                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF2    EQU   *
         ISPCALL ('VDEFINE',NAMELST3,TMCVOL,'CHAR',6)
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF10   EQU   *
         B     TBCREAT$                RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR VDEF)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (NOT VALID FOR VDEF)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE ADMIN TABLE
***********************************************************************
TBCREAT$ EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID$            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB$',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE$10(R15)           CHECK RETURN CODE
TBCRE$10 EQU   *
         B     TBCREAT1                RC = 00 (CONTINUE)
         B     TBCREAT1                RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION 1 TABLE
***********************************************************************
TBCREAT1 EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID1            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB1',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE110(R15)           CHECK RETURN CODE
TBCRE110 EQU   *
         B     TBCREAT2                RC = 00 (CONTINUE)
         B     TBCREAT2                RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION 2 TABLE
***********************************************************************
TBCREAT2 EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID2            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB2',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE210(R15)           CHECK RETURN CODE
TBCRE210 EQU   *
         B     TBCREAT3                RC = 00 (CONTINUE)
         B     TBCREAT3                RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION 3 TABLE
***********************************************************************
TBCREAT3 EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID3            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB3',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE310(R15)           CHECK RETURN CODE
TBCRE310 EQU   *
         B     TBCREAT4                RC = 00 (CONTINUE)
         B     TBCREAT4                RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION 4 TABLE
***********************************************************************
TBCREAT4 EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID4            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB4',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE410(R15)           CHECK RETURN CODE
TBCRE410 EQU   *
         B     TBCREAT5                RC = 00 (CONTINUE)
         B     TBCREAT5                RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION 5 TABLE
***********************************************************************
TBCREAT5 EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID5            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB5',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE510(R15)           CHECK RETURN CODE
TBCRE510 EQU   *
         B     TBCREAT6                RC = 00 (CONTINUE)
         B     TBCREAT6                RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION 6 TABLE
***********************************************************************
TBCREAT6 EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID6            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB6',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE610(R15)           CHECK RETURN CODE
TBCRE610 EQU   *
         B     TBCREAT7                RC = 00 (CONTINUE)
         B     TBCREAT7                RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION 7 TABLE
***********************************************************************
TBCREAT7 EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID7            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB7',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE710(R15)           CHECK RETURN CODE
TBCRE710 EQU   *
         B     TBCREAT8                RC = 00 (CONTINUE)
         B     TBCREAT8                RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION 8 TABLE
***********************************************************************
TBCREAT8 EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID8            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTAB8',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCRE810(R15)           CHECK RETURN CODE
TBCRE810 EQU   *
         B     TBCREATP                RC = 00 (CONTINUE)
         B     OPEN                    RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - CREATE REGION P TABLE
***********************************************************************
TBCREATP EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGIDP            SET REIONAL IDENTIFIER
*                                      CREATE A NEW TABLE
         ISPCALL ('TBCREATE','TMCTABP',' ',NAMELST1,'WRITE','REPLACE','+
               TMCTLIB')
         B     TBCREP10(R15)           CHECK RETURN CODE
TBCREP10 EQU   *
         B     OPEN                    RC = 00 (CONTINUE)
         B     OPEN                    RC = 04 (TABLE WILL BE REPLACED)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  INITIALIZATION SECTION - OPEN 'UCC.ONE.TMC'
***********************************************************************
OPEN     EQU   *
         MVC   ISPFSERV,OPNID          SET ISPF DIALOG SERVICE
         MVC   REGID,NONE              SET REIONAL IDENTIFIER
         OPEN  (INPUT,INPUT),MF=(E,OPENLST_)
         B     OPEN10(R15)             CHECK RETURN CODE
OPEN10   EQU   *
         B     GETREC                  RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (PRINT ERROR MESSAGE)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
         TITLE 'TMCTABC - PROCESSING SECTION'
***********************************************************************
*  PROCESSING SECTION - GET RECORD FROM TMC AND EXTRACT TABLE INFO
***********************************************************************
GETREC   EQU   *
         GET   INPUT                   GET RECORD FROM TMC
         MVC   TMCDSN,0(R1)            EXTRACT DATA SET NAME FROM TMC
         MVC   TMCVOL,44(R1)           EXTRACT VOLUME SERIAL FROM TMC
         LA    R2,VALIDSNR             R2 - INDEX THRU VALID REG DSN'S
GETREC10 EQU   *
         CLC   0(3,R2),SPACES          END OF REGIONAL DSN TABLE?
         BE    GETREC20                YES, PREPARE TO CHECK ADMIN TABL
         CLC   0(3,R2),TMCDSN          VALID DATA SET NAME?
         BE    REGBRNCH                YES, CONTINUE
         LA    R2,3(R2)                INCREMENT R2
         B     GETREC10                CHECK NEXT TABLE ENTRY
GETREC20 EQU   *
         LA    R2,VALIDSN$             R2 - INDEX THRU VALIDSN$
         LH    R3,0(R2)                R3 - LENGTH OF QUALIFIER
         LA    R4,2(R2)                R4 - POINTER TO QUALIFIER
         BCTR  R3,0                    DECREMENT LENGTH FOR 'EX'
GETREC30 EQU   *
         CLC   0(8,R2),SPACES          END OF TABLE?
         BE    GETREC                  YES, INVALID DSN
         LA    R5,TBADD$               R5 - BRANCH ADDR AFTER LOCATE
         EX    R3,DSNCLC               COMPARE TABLE AND TMCDSN
         BE    LOCATE                  YES, CONTINUE
         LA    R2,10(R2)               INCREMENT R2
         LH    R3,0(R2)                R3 - LENGTH OF QUALIFIER
         LA    R4,2(R2)                R4 - POINTER TO QUALIFIER
         BCTR  R3,0                    DECREMENT LENGTH FOR 'EX'
         B     GETREC30                CHECK NEXT TABLE ENTRY
DSNCLC   CLC   TMCDSN(0),0(R4)         VALID DSN?
***********************************************************************
*  PROCESSING SECTION - DETERMINE WHICH TABLE TO BE UPDATED
***********************************************************************
REGBRNCH EQU   *
         LA    R2,TMCDSN               R2 - INDEX THROUGH DATA SET NAME
         LA    R3,44                   R3 - MAXIMUM LENGTH OF DSN
         LA    R5,TBADD$               R5 - BRANCH ADDR AFTER LOCATE
REGBR10  EQU   *
         CLC   0(1,R2),SPACES          END OF DSN?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         CLC   0(1,R2),PERIOD          END OF FIRST QUALIFIER?
         BE    REGBR15                 YES, GO LOOK FOR SECOND
         LA    R2,1(R2)                INCREMENT R2
         BCT   R3,REGBR10              CONTINUE
         B     LOCATE                  SEE IF DSN CATALOGED
REGBR15  EQU   *
         LA    R2,1(R2)                POINT TO START OF NEXT QUALIFIER
REGBR20  EQU   *
         CLC   0(1,R2),SPACES          END OF DSN?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         CLC   0(1,R2),PERIOD          END OF SECOND QUALIFIER?
         BE    REGBR25                 YES, GO DETERMINE TABLE UPDATE
         LA    R2,1(R2)                INCREMENT R2
         BCT   R3,REGBR20              CONTINUE
         B     LOCATE                  SEE IF DSN CATALOGED
REGBR25  EQU   *
         LA    R2,1(R2)                POINT TO START OF NEXT QUALIFIER
         CLC   0(1,R2),REG$            THIS AN ADMIN DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD1               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REG1            THIS AN REG1 DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD2               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REG2            THIS AN REG2 DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD3               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REG3            THIS AN REG3 DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD4               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REG4            THIS AN REG4 DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD5               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REG5            THIS AN REG5 DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD6               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REG6            THIS AN REG6 DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD7               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REG7            THIS AN REG7 DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD8               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REG8            THIS AN REG8 DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADDP               R5 - BRANCH ADDR AFTER LOCATE
         CLC   0(1,R2),REGP            THIS AN REGP DATA SET?
         BE    LOCATE                  YES, SEE IF DSN CATALOGED
         LA    R5,TBADD$               R5 - BRANCH ADDR AFTER LOCATE
***********************************************************************
*  PROCESSING SECTION - VERIFY THAT DSN IS CATALOGED
***********************************************************************
LOCATE   EQU   *
         LOCATE FINDSN                 IS DSN CATALOGED?
         LTR   R15,R15                 CHECK RETURN CODE
         BNZ   GETREC                  IF NON-ZERO, GET NEXT RECORD
         SLR   R2,R2                   CLEAR R2
         LH    R2,WORK                 R2 - NUMBER OF VOLS DSN RESIDES
         LA    R3,WORK+2               R3 - INDEX THROUGH WORK AREA
LOCATE10 EQU   *
         CLC   TMCVOL,4(R3)            THIS THE VOL WE'RE LOOKING FOR?
         BER   R5                      YES, ADD TO CORRECT TABLE
         LA    R3,12(R3)               NO, POINT TO NEXT ENTRY
         BCT   R2,LOCATE10             CONTINUE LOOKING
         B     GETREC                  GET NEXT RECORD
***********************************************************************
*  PROCESSING SECTION - UPDATE ADMIN TABLE
***********************************************************************
TBADD$   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID$            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB$')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION 1 TABLE
***********************************************************************
TBADD1   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID1            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB1')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION 2 TABLE
***********************************************************************
TBADD2   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID2            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB2')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION 3 TABLE
***********************************************************************
TBADD3   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID3            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB3')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION 4 TABLE
***********************************************************************
TBADD4   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID4            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB4')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION 5 TABLE
***********************************************************************
TBADD5   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID5            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB5')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION 6 TABLE
***********************************************************************
TBADD6   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID6            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB6')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION 7 TABLE
***********************************************************************
TBADD7   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID7            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB7')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION 8 TABLE
***********************************************************************
TBADD8   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID8            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTAB8')
         B     TBADD10(R15)
***********************************************************************
*  PROCESSING SECTION - UPDATE REGION P TABLE
***********************************************************************
TBADDP   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGIDP            SET REIONAL IDENTIFIER
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','TMCTABP')
         B     TBADD10(R15)
TBADD10  EQU   *
         B     GETREC                  RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBADD)
         B     ERR08                   RC = 08 (PRINT ERROR MESSAGE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE ADMIN TABLE
***********************************************************************
TBCLSE$  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID$            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB$','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO$10(R15)
TBCLO$10 EQU   *
         B     TBCLSE1                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION 1 TABLE
***********************************************************************
TBCLSE1  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID1            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB1','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO110(R15)
TBCLO110 EQU   *
         B     TBCLSE2                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION 2 TABLE
***********************************************************************
TBCLSE2  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID2            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB2','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO210(R15)
TBCLO210 EQU   *
         B     TBCLSE3                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION 3 TABLE
***********************************************************************
TBCLSE3  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID3            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB3','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO310(R15)
TBCLO310 EQU   *
         B     TBCLSE4                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION 4 TABLE
***********************************************************************
TBCLSE4  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID4            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB4','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO410(R15)
TBCLO410 EQU   *
         B     TBCLSE5                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION 5 TABLE
***********************************************************************
TBCLSE5  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID5            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB5','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO510(R15)
TBCLO510 EQU   *
         B     TBCLSE6                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION 6 TABLE
***********************************************************************
TBCLSE6  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID6            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB6','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO610(R15)
TBCLO610 EQU   *
         B     TBCLSE7                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION 7 TABLE
***********************************************************************
TBCLSE7  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID7            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB7','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO710(R15)
TBCLO710 EQU   *
         B     TBCLSE8                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION 8 TABLE
***********************************************************************
TBCLSE8  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGID8            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTAB8','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLO810(R15)
TBCLO810 EQU   *
         B     TBCLSEP                 RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
***********************************************************************
*  PROCESSING SECTION - CLOSE REGION P TABLE
***********************************************************************
TBCLSEP  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
         MVC   REGID,REGIDP            SET REIONAL IDENTIFIER
*                                      CLOSE AND SAVE A TABLE
         ISPCALL ('TBCLOSE','TMCTABP','REPLCOPY',' ',' ','TMCTLIB')
         B     TBCLOP10(R15)
TBCLOP10 EQU   *
         B     FINISH                  RC = 00 (CONTINUE)
         B     ERR04                   RC = 04 (NOT VALID FOR TBCLOSE)
         B     ERR08                   RC = 08 (NOT VALID FOR TBCLOSE)
         B     ERR12                   RC = 12 (PRINT ERROR MESSAGE)
         B     ERR16                   RC = 16 (PRINT ERROR MESSAGE)
         B     ERR20                   RC = 20 (PRINT ERROR MESSAGE)
         TITLE 'TMCTABC - ERROR PROCESSING SECTION'
***********************************************************************
*  ERROR PROCESSING SECTION
***********************************************************************
ERR04    EQU   *
         MVC   ISPFRC,FOUR             SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
ERR08    EQU   *
         MVC   ISPFRC,EIGHT            SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
ERR12    EQU   *
         MVC   ISPFRC,TWELVE           SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
ERR16    EQU   *
         MVC   ISPFRC,SIXTEEN          SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
ERR20    EQU   *
         MVC   ISPFRC,TWENTY           SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
MSGDISP1 EQU   *
         OPEN  (OUTPUT,OUTPUT),MF=(E,OPENLST_)  OPEN OUTPUT
         MVC   TMCMSG,TMCERR           SET ERROR MESSAGE
         MVC   TMCMSG+22(8),ISPFSERV   SET ISPF DIALOG SERVICE
         MVC   TMCMSG+48(2),ISPFRC     SET DIALOG SERVICE RETURN CODE
         MVC   TMCMSG+99(5),REGID      SET REGIONAL IDENTIFIER
         PUT   OUTPUT,TMCMSG           PRINT ERROR MESSAGE
         CLOSE OUTPUT,MF=(E,CLOSLST_)  CLOSE OUTPUT
         TITLE 'TMCTABC - CLOSING SECTION'
***********************************************************************
*  CLOSING SECTION - FREE GETMAINED AREA, SET RETURN CODE RESTORE REGS
***********************************************************************
FINISH   EQU   *
         CLOSE INPUT,MF=(E,CLOSLST_)   CLOSE INPUT
         LA    R0,WORKLEN              R0 - LENGTH OF WORKAREA
         LR    R1,R13                  R1 - ADDRESS OF WORKAREA
         L     R13,4(R13)              R13 - ADDR CALLER'S SAVE AREA
         FREEMAIN R,LV=(0),A=(1)       FREE GETMAINED VIRTUAL STORAGE
         RETURN (14,12),RC=(15)        RESTORE REGISTERS AND RETURN
         TITLE 'TMCTABC - REGISTER EQUATES'
***********************************************************************
*  REGISTER EQUATES
***********************************************************************
         EQUATE
SCRATCH  EQU   X'04'                   TMFLAG1 - TAPE LISTED SCR LIST
DELETED  EQU   X'02'                   TMFLAG1 - VOL DELETED FROM LIB
DSNB     EQU   X'FF'                   1ST BYTE DSN-DATA SET NAME BLOCK
         TITLE 'TMCTABC - DATA CONSTANTS'
***********************************************************************
*  CONSTANTS
***********************************************************************
FLAGS1   DS    0F                      FLAGS FOR LOCATE
         DC    AL1(68)
         DC    AL1(0)
         DC    AL1(0)
         DC    AL1(0)
FOUR     DC    CL2'04'                 RETURN CODE OF '04'
EIGHT    DC    CL2'08'                 RETURN CODE OF '08'
TWELVE   DC    CL2'12'                 RETURN CODE OF '12'
SIXTEEN  DC    CL2'16'                 RETURN CODE OF '16'
TWENTY   DC    CL2'20'                 RETURN CODE OF '20'
CREID    DC    CL8'TBCREATE'           ISPF DIALOG SERVICE (TBCREATE)
ADDID    DC    CL8'TBADD'              ISPF DIALOG SERVICE (TBADD)
CLOID    DC    CL8'TBCLOSE'            ISPF DIALOG SERVICE (TBCLOSE)
DEFID    DC    CL8'VDEFINE'            ISPF DIALOG SERVICE (VDEFINE)
OPNID    DC    CL8'OPEN'               DATA SET OPEN
NONE     DC    CL5'NONE '              NO REGION BEING PROCESSED
REGID$   DC    CL5'ADMIN'              ADMIN
REGID1   DC    CL5'REG-1'              REGION 1
REGID2   DC    CL5'REG-2'              REGION 2
REGID3   DC    CL5'REG-3'              REGION 3
REGID4   DC    CL5'REG-4'              REGION 4
REGID5   DC    CL5'REG-5'              REGION 5
REGID6   DC    CL5'REG-6'              REGION 6
REGID7   DC    CL5'REG-7'              REGION 7
REGID8   DC    CL5'REG-8'              REGION 8
REGIDP   DC    CL5'REG-P'              REGION P
REG$     DC    CL1'$'                  ADMIN
REG1     DC    CL1'A'                  REGION 1
REG2     DC    CL1'B'                  REGION 2
REG3     DC    CL1'C'                  REGION 3
REG4     DC    CL1'D'                  REGION 4
REG5     DC    CL1'E'                  REGION 5
REG6     DC    CL1'F'                  REGION 6
REG7     DC    CL1'G'                  REGION 7
REG8     DC    CL1'H'                  REGION 8
REGP     DC    CL1'P'                  REGION P
VALIDSNR DS    0F                      VALID REGIONAL DSN'S
         DC    CL3'AOE'                AOE DATA SET
         DC    CL3'BIL'                BIL DATA SET
         DC    CL3'CAR'                CAR DATA SET
         DC    CL3'INV'                INV DATA SET
         DC    CL3'LED'                LED DATA SET
         DC    CL3'MAS'                MAS DATA SET
         DC    CL3'MIS'                MIS DATA SET
         DC    CL3'PAY'                PAY DATA SET
         DC    CL3'PER'                PER DATA SET
         DC    CL3'PRD'                PRD DATA SET
         DC    CL3'REF'                REF DATA SET
         DC    CL3'SLS'                SLS DATA SET
         DC    CL3'SUP'                SUP DATA SET
         DC    CL3'TFI'                TFI DATA SET
         DC    CL3'VAL'                VAL DATA SET
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
         DC    CL3' '                  DUMMY DSN'S
VALIDSN$ DS    0F                      VALID ADMIN DSN'S
         DC    H'04'                   LENGTH OF QUALIFIER
         DC    CL8'DLX1'               DLX1 DATA SET (ADMIN ONLY)
         DC    H'03'                   LENGTH OF QUALIFIER
         DC    CL8'DSV'                DSV DATA SET (ADMIN ONLY)
         DC    H'05'                   LENGTH OF QUALIFIER
         DC    CL8'FICHE'              FICHE DATA SET (ADMIN ONLY)
         DC    H'02'                   LENGTH OF QUALIFIER
         DC    CL8'MD'                 MD DATA SET (ADMIN ONLY)
         DC    H'03'                   LENGTH OF QUALIFIER
         DC    CL8'OFF'                OFF DATA SET (ADMIN ONLY)
         DC    H'05'                   LENGTH OF QUALIFIER
         DC    CL8'VIDEO'              VIDEO DATA SET (ADMIN ONLY)
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
         DC    H'00'                   LENGTH OF QUALIFIER
         DC    CL8' '                  DUMMY DSN'S
PERIOD   DC    CL1'.'                  PERIOD
SPACES   DC    CL133' '                SPACES
TMCERR   DC    CL133' ISPF DIALOG SERVICE, 12345678, ENDED WITH RC = 00+
               . NOTIFY SYSTEMS PROGRAMMING. PROCESSING WAS FOR 12345.'
*                                      ERROR MESSAGE TEXT
NAMELST1 DS    0F                      NAMES OF VARIABLES IN TABLE
         DC    F'02'
         DC    F'00'
         DC    CL8'TMCDSN'
         DC    CL8'TMCVOL'
NAMELST2 DS    0F                      NAMES OF VARIABLES (LENGTH 44)
         DC    F'01'
         DC    F'00'
         DC    CL8'TMCDSN'
NAMELST3 DS    0F                      NAMES OF VARIABLES (LENGTH 6)
         DC    F'01'
         DC    F'00'
         DC    CL8'TMCVOL'
         TITLE 'TMCTABC - LITERAL POOL'
         LTORG
***********************************************************************
*        INITIALIZATION DATA FOR PART OF GETMAINED AREA
***********************************************************************
INITDATA DS    0F
DCBIN    DCB   DDNAME=TMCIN,DSORG=PS,MACRF=(GL),EODAD=TBCLSE$
DCBOUT   DCB   DDNAME=ERROUT,DSORG=PS,MACRF=(PM)
OPENLST  OPEN  (,),MF=L            STATIC LIST FORM OF OPEN MACRO
CLOSLST  CLOSE (,),MF=L            STATIC LIST FORM OF CLOSE MACRO
DATALEN  EQU   *-INITDATA
         TITLE 'TMCTABC - DYNAMIC WORK AREA'
***********************************************************************
*  DYNAMIC WORK AREA
***********************************************************************
WORKAREA DSECT
SAVEAREA DS    18F                     PROGRAM SAVE AREA
FINDSN   DS    0F                      CAMLIST FOR LOCATE
FINDFLGS DS    A                       FLAGS FOR LOCATE
FINDDSN  DS    A                       ADDR OF DSN FOR LOCATE
FINDVOL  DS    A                       HEX ZERO'S - NOT USED
FINDWORK DS    A                       ADDR OF WORK AREA FOR LOCATE
WORK     DS    40D                     BUFFER FOR LOCATE
ISPADDR  DS    A                       ADDRESS OF EP TO ISPLINK
PARMS    DS    7A                      PARM LIST FOR CALL
TMCDSN   DS    CL44                    DATA SET NAME FROM TMC
TMCVOL   DS    CL6                     VOLSER FROM TMC
TMCMSG   DS    CL133                   ERROR MESSAGE
ISPFSERV DS    CL8                     ISPF DIALOG SERVICE
ISPFRC   DS    CL2                     ISPF DIALOG SERVICE RETURN CODE
REGID    DS    CL5                     REGIONAL IDENTIFIER
DATA     DS    0F
INPUT    DCB   DDNAME=TMCIN,DSORG=PS,MACRF=(GL),EODAD=TBCLSE$
OUTPUT   DCB   DDNAME=ERROUT,DSORG=PS,MACRF=(PM)
OPENLST_ OPEN  (,),MF=L            DYNAMIC LIST FORM OF OPEN MACRO
CLOSLST_ CLOSE (,),MF=L            DYNAMIC LIST FORM OF CLOSE MACRO
WORKLEN  EQU   *-WORKAREA
         END   TMCTABC

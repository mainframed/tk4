         TITLE 'USRADD1 - DELUXE USER REGISTRATION (ADD A USER)'
***********************************************************************
*                                                                     *
*        MODULE NAME = USRADD1                                        *
*                                                                     *
*        CHANGE ACTIVITY =                                            *
*              04/30/86  WRITTEN.                               JWC.  *
*                                                                     *
*              05/06/86  ADD 'OWNER', 'DFLTGRP' VERIFICATION.   JWC.  *
*                                                                     *
*              05/08/86  ADD REGIONS.                           JWC.  *
*                                                                     *
***********************************************************************
         EJECT
         TITLE 'USRADD1 - ISPCALL MACRO'
         MACRO
&LBL     ISPCALL &LIST,        CALL PARAMETERS                         +
               &EP=ISPLINK,                                            +
               &LISTLBL=,      LABEL FOR PARAMETER LIST (NON-REENT)    +
               &EPADDR=,       LABEL FOR ADDRESS OF EP OF ISPLINK      +
               &WKAREA=,       TO BUILD CALL LIST (REENTERANT CODE)    +
               &WKREG=,        WORK REGISTER (DEFAULT 1)               +
               &TRACE=         'OFF' OR BIT FOR TRACE MODE
.*  ONCE WKAREA, WKREG, AND TRACE ARE SPECIFIED, THEY ARE USED IN ALL
.*  SUBSEQUENT OCCURRENCES OF THIS MACRO, UNLESS THE PARAMETER IS
.*  EXPLICITLY CODED.
.*  NOTE: FIRST 4 BYTES OF WKAREA ARE USED TO STORE NUMERIC VALUES,
.*  WHICH ARE PRIMARILY LENGTH FIELDS.
         LCLA  &S,&T,&U,&TRCEMSK
         LCLB  &NUMSW
         LCLC  &NDX,&WKAR,&WKRG,&WKEP
         GBLC  &ISPRREG,&ISPRAR,&ISPTRC1,&ISPEP
         GBLA  &ISPTRC2
&NDX     SETC  '&SYSNDX'
&S       SETA  1               SUBSCRIPT FOR GOING THRU &LIST
***********************************************************************
         AIF   (T'&LBL NE 'O').L1
*                  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
         AGO   .L2
.L1      ANOP
&LBL     DS    0H  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
.L2      ANOP
         AIF   (T'&LIST NE 'O').A1
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE PROVIDED ***'
         AGO   .EXIT
.A1      AIF   ('&LIST'(1,1) EQ '(').CHKTRCE
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE ENCLOSED IN PARENTHES+
               ES ***'
         AGO   .EXIT
.****************** ANALYZE "TRACE" PARAMETER *************************
.CHKTRCE AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' NE '').TRCE4
         AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' EQ '').TRCEOFF
         AIF   ('&TRACE'(1,1) EQ '(').TRCEON
         AIF   ('&TRACE' EQ 'OFF').TRCEOFF
         MNOTE 12,'*** INVALID TRACE PARAMETERS ***'
         AGO   .EXIT
.TRCEON  AIF   (T'&TRACE(2) EQ 'N').TRCE2
.TRCE8   MNOTE 12,'*** TRACE BIT (2ND PARAMETER) MUST BE 0 - 7 ***'
         AGO   .EXIT
.TRCE2   AIF   (&TRACE(2) GE 0 OR &TRACE(2) LE 7).TRCE3
         AGO   .TRCE8
.TRCE3   ANOP
&ISPTRC1 SETC  '&TRACE(1)'     SET GLOBAL VARIABLE
&ISPTRC2 SETA  &TRACE(2)       SET GLOBAL VARIABLE
.TRCE4   ANOP
&U       SETA  0
&TRCEMSK SETA  255
&T       SETA  128
.TRCE5   AIF   (&U GT 7).CHKREG
         AIF   (&ISPTRC2 NE &U).TRCE7
.TRCE6   ANOP
&U       SETA  &U+1
&T       SETA  &T/2
         AGO   .TRCE5
.TRCE7   ANOP
&TRCEMSK SETA  &TRCEMSK-&T
         AGO   .TRCE6
.TRCEOFF ANOP
&ISPTRC1 SETC  ''              SET GLOBAL VARIABLE
.****************** ANALYZE "WKREG" PARAMETER *************************
.CHKREG  AIF   (T'&WKREG EQ 'O').A2
&ISPRREG SETC  '&WKREG'        SET GLOBAL VARIABLE
.A2      AIF   ('&ISPRREG' EQ '').A3
&WKRG    SETC  '&ISPRREG'
         AGO   .CHKAREA
.A3      ANOP
&ISPRREG SETC  '1'             SET GLOBAL VARIABLE
         AGO   .A2
.****************** SEE IF USING PROVIDED WORKAREA ********************
.CHKAREA AIF   (T'&WKAREA NE 'O' OR '&ISPRAR' NE '').RENT
         AIF   (T'&LISTLBL EQ 'O').B1
&WKAR    SETC  '&LISTLBL'
         AGO   .B2
.B1      ANOP
&WKAR    SETC  'ISPC&NDX'      LABEL FOR MACRO WORKAREA
.B2      ANOP
&T       SETA  4*(N'&LIST+1)   LENGTH OF MACRO WORKAREA
         B     &WKAR.+&T             BRANCH AROUND DATA         ISPCALL
&T       SETA  N'&LIST+1
&WKAR    DC    &T.F'0'               PARAMETER LIST             ISPCALL
.******************** BUILD PARAMETER LIST ****************************
.LOOP    AIF   (&S GT N'&LIST).ENDLOOP
         AIF   ('&LIST(&S)'(1,1) EQ '''').C1 TEST FOR LITERAL
         AIF   (T'&LIST(&S) EQ 'N').NUM      TEST FOR NUMERIC
         AIF   ('&LIST(&S)'(1,1) EQ '(').REG TEST FOR REG NOTATION
         LA    &WKRG,&LIST(&S)       LOAD DATA ADDR             ISPCALL
.ST      ANOP
&T       SETA  4*&S
         ST    &WKRG,&WKAR.+&T       STORE IN PARAM LIST        ISPCALL
         AIF   ('&ISPTRC1' EQ '' OR &S GT 1).C3           TRACE
         TM    &ISPTRC1,&TRCEMSK     IS TRACE BIT ON?     TRACE ISPCALL
         BZ    ISPT&NDX                                   TRACE ISPCALL
         AIF   ('&WKRG' EQ '1' OR '&WKRG' EQ 'R1').C4     TRACE
         LR    1,&WKRG               LOAD SRVC NAME ADDR  TRACE ISPCALL
         EJECT
.C4      AIF   ('&LIST(&S)'(1,1) EQ '''').C5 LITERAL?     TRACE
         LA    0,8                   LOAD LENGTH          TRACE ISPCALL
         AGO   .C6                                        TRACE
.C5      ANOP                                             TRACE
&U       SETA  K'&LIST(&S)-2   LENGTH OF SERVICE NAME     TRACE
         LA    0,&U                  LOAD LENGTH          TRACE ISPCALL
.C6      ANOP                                             TRACE
         SVC   93                    ISSUE TPUT SVC       TRACE ISPCALL
ISPT&NDX EQU   *                                          TRACE ISPCALL
.C3      ANOP
&S       SETA  &S+1
         AGO   .LOOP
.C1      AIF   (&S EQ 1).C2    SPF SERVICE NAME - LENGTH IS OK
&T       SETA  K'&LIST(&S)-2
         AIF   (&T GT 7).C2    LENGTH 8 OR GREATER IS OK
&T       SETA  &T+1            ADD FOR ONE BLANK
         LA    &WKRG,=CL&T.&LIST(&S) LOAD DATA ADDR             ISPCALL
         AGO   .ST
.C2      ANOP
         LA    &WKRG,=C&LIST(&S)     LOAD DATA ADDR             ISPCALL
         AGO   .ST
.NUM     AIF   (&NUMSW).NUM2
.*  NOTE: SPF WILL MODIFY LENGTH FIELDS, SO THEY CANNOT BE IN
.*  REENTERANT CODE.
         MVC   &WKAR.(4),=F'&LIST(&S)'                                 +
                                     MOVE NUMERIC VALUE         ISPCALL
&NUMSW   SETB  1
         AGO   .LA
.NUM2    MNOTE 12,'*** ONLY ONE NUMERIC ALLOWED PER ISPCALL MACRO - LIS+
               T ITEM &S --&LIST(&S)-- IS SECOND OCCURRENCE ***'
         AGO   .EXIT
.LA      ANOP
         LA    &WKRG,&WKAR           LOAD DATA ADDR             ISPCALL
         AGO   .ST
.REG     ANOP
&T       SETA  4*&S
         ST    &LIST(&S),&WKAR.+&T                              ISPCALL
         AGO   .C3
.******************** USING PROVIDED WORKAREA *************************
.RENT    AIF   (T'&WKAREA EQ 'O').RENT2
&ISPRAR  SETC  '&WKAREA'       SET GLOBAL VARIABLE
.RENT2   ANOP
&WKAR    SETC  '&ISPRAR'
         AGO   .LOOP
         EJECT
.****************** GENERATE STATEMENTS FOR CALL **********************
.ENDLOOP ANOP
         OI    &WKAR.+&T,X'80'       TURN ON VL BIT             ISPCALL
.*       LA    1,&WKAR.+4                                       ISPCALL
.*       L     15,=V(&EP)                                       ISPCALL
.*       BALR  14,15                                            ISPCALL
         AIF   (T'&EPADDR EQ 'O').EP2
&ISPEP   SETC  '&EPADDR'
         LOAD  EP=ISPLINK
         ST    R0,&ISPEP
.EP2     ANOP
&WKEP    SETC  '&ISPEP'
         L     15,&WKEP
         LA    1,&WKAR.+4
         CALL  (15)
.EXIT    ANOP
***********************************************************************
         SPACE 2
         MEND
         EJECT
         TITLE 'USRADD1 - INITIALIZATION SECTION'
USRADD1  CSECT
***********************************************************************
*  INITIALIZATION SECTION - GETMAIN WORKAREA AND SAVE AREA CHAINING
***********************************************************************
         SAVE  (14,12),,USRADD1_&SYSDATE_&SYSTIME    SAVE REGISTERS
         LR    R12,R15                 LOAD REG 12 WITH ENTRY ADDRESS
         USING USRADD1,R12             ESTABLISH ADDRESSABILITY TO
*                                      PROGRAM CSECT
         LA    R11,4095(R12)           LOAD REG 11 WITH ENTRY + 4095
         USING USRADD1+4095,R11        ESTABLISH ADDRESSABILITY TO
*                                      REST OF PROGRAM
         LA    R10,4095(R11)           LOAD REG 11 WITH ENTRY + 4095
         USING USRADD1+8190,R10        ESTABLISH ADDRESSABILITY TO
*                                      REST OF PROGRAM
         GETMAIN R,LV=WORKLEN          GETMAIN DYNAMIC WORKAREA
         ST    R13,4(R1)               STORE ADDRESS PREVIOUS SAVEAREA
         ST    R1,8(,R13)              STORE ADDRESS OF CURRENT
*                                      SAVEAREA IN PREVIOUS SAVEAREA
         LR    R13,R1                  LOAD REG 13 WITH ADDRESS OF
*                                      CURRENT SAVEAREA
         USING WORKAREA,R13            ESTABLISH ADDRESSABILITY TO
*                                      DYNAMIC WORKAREA
         MVI   ADDFLAG,OFF             INITIALIZE ADDFLAG
***********************************************************************
*  INITIALIZATION SECTION - SET DIALOG CONTROL, DEFINE VARIABLES
***********************************************************************
CONTROL  EQU   *
*                                      SET DIALOG CONTROL
         ISPCALL ('CONTROL','ERRORS','RETURN'),                        +
               WKAREA=PARMS,                                           +
               EPADDR=ISPADDR
VDEF1    EQU   *
         MVC   ISPFSERV,DEFID          SET ISPF DIALOG SERVICE
*                                      DEFINE VARIABLES
         ISPCALL ('VDEFINE',NAMELST1,USERID,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF2                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF2    EQU   *
         ISPCALL ('VDEFINE',NAMELST2,NAME,'CHAR',20)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF3                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF3    EQU   *
         ISPCALL ('VDEFINE',NAMELST3,RACFATT,'CHAR',12)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF4                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF4    EQU   *
         ISPCALL ('VDEFINE',NAMELST4,USERDATA,'CHAR',70)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF5                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF5    EQU   *
         ISPCALL ('VDEFINE',NAMELST5,ROOM,'CHAR',4)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF6                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF6    EQU   *
         ISPCALL ('VDEFINE',NAMELST6,CNCTGRP1,'CHAR',40)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF7                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF7    EQU   *
         ISPCALL ('VDEFINE',NAMELST7,SELCT,'CHAR',1)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF8                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF8    EQU   *
         ISPCALL ('VDEFINE',NAMELST8,TSODEST0,'CHAR',14)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF9                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF9    EQU   *
         ISPCALL ('VDEFINE',NAMELST9,ZTEMPF,'CHAR',44)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFA                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFA    EQU   *
         ISPCALL ('VDEFINE',NAMELSTA,USERMSGS,'CHAR',24)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFB                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFB    EQU   *
         ISPCALL ('VDEFINE',NAMELSTB,USERMSGL,'CHAR',78)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFC                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFC    EQU   *
         ISPCALL ('VDEFINE',NAMELSTF,ZLLGJOB1,'CHAR',80)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFD                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFD    EQU   *
         ISPCALL ('VDEFINE',NAMLIST$,TSOMAXR$,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFE                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFE    EQU   *
         ISPCALL ('VDEFINE',NAMLIST1,TSOMAXR1,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFF                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFF    EQU   *
         ISPCALL ('VDEFINE',NAMLIST2,TSOMAXR2,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFG                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFG    EQU   *
         ISPCALL ('VDEFINE',NAMLIST3,TSOMAXR3,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFH                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFH    EQU   *
         ISPCALL ('VDEFINE',NAMLIST4,TSOMAXR4,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFI                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFI    EQU   *
         ISPCALL ('VDEFINE',NAMLIST5,TSOMAXR5,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFJ                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFJ    EQU   *
         ISPCALL ('VDEFINE',NAMLIST6,TSOMAXR6,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFK                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFK    EQU   *
         ISPCALL ('VDEFINE',NAMLIST7,TSOMAXR7,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFL                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFL    EQU   *
         ISPCALL ('VDEFINE',NAMLIST8,TSOMAXR8,'CHAR',8)
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF10   EQU   *
         B     TBOPEN                  RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR VDEF)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (NOT VALID FOR VDEF)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  INITIALIZATION SECTION - OPEN 'USERTAB'
***********************************************************************
TBOPEN   EQU   *
         MVC   ISPFSERV,OPNID          SET ISPF DIALOG SERVICE
*                                      OPEN A TABLE
         ISPCALL ('TBOPEN','USERTAB','WRITE','USRTLIB')
         B     TBOPN10(R15)            CHECK RETURN CODE
TBOPN10  EQU   *
         B     TBCREATE                RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBOPEN)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  INITIALIZATION SECTION - CREATE FILE TAILORING TABLE
***********************************************************************
TBCREATE EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
*                                      CREATE A TABLE
         ISPCALL ('TBCREATE','USRADD',' ',NAMELSTC,'WRITE','REPLACE')
         B     TBCRE10(R15)            CHECK RETURN CODE
TBCRE10  EQU   *
         B     INITVAL                 RC = 00 (CONTINUE)
         B     INITVAL                 RC = 04 (CONTINUE)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
         TITLE 'USRADD1 - PROCESSING SECTION'
***********************************************************************
*  INITIALIZATION SECTION - INITIALIZE TABLE VALUES
***********************************************************************
INITVAL  EQU   *
         MVC   OWNER,SPACES            INITIALIZATION
         MVC   DFLTGRP,SPACES          INITIALIZATION
         MVC   RACFATT0,SPACES         INITIALIZATION
         MVC   RACFATT1,SPACES         INITIALIZATION
         MVC   RACFATT2,SPACES         INITIALIZATION
         MVC   RACFATT3,SPACES         INITIALIZATION
         MVC   RACFATT4,SPACES         INITIALIZATION
         MVC   RACFATT5,SPACES         INITIALIZATION
         MVC   REVOKE,NONE             INITIALIZATION
         MVC   RESUME,NONE             INITIALIZATION
         MVC   USERDATA,SPACES         INITIALIZATION
         MVC   NCCFUSER,NO             INITIALIZATION
         MVC   TSOUSER,NO              INITIALIZATION
         MVC   ROOM,SPACES             INITIALIZATION
         MVC   AUTHORTY,SPACES         INITIALIZATION
         MVC   UACC,SPACES             INITIALIZATION
         MVC   CNCTGRP1,SPACES         INITIALIZATION
         MVC   NCCFPROF,NCCFINIT       INITIALIZATION
INITV10  EQU   *
         MVC   USERID,SPACES           INITIALIZATION
         MVC   NAME,SPACES             INITIALIZATION
         MVC   LNAME,SPACES            INITIALIZATION
         MVC   FNAME,SPACES            INITIALIZATION
         MVC   EXTENS,SPACES           INITIALIZATION
         MVC   TSOMAXR,SPACES          INITIALIZATION
         MVC   TSODEST,SPACES          INITIALIZATION
         MVC   TSONAM0,SPACES          INITIALIZATION
         MVC   TSOSIZ0,SPACES          INITIALIZATION
         MVC   TSOUNT0,SPACES          INITIALIZATION
         MVC   TSOATT0,NOACCT          INITIALIZATION
         MVC   TSOATT1,NOJCL           INITIALIZATION
         MVC   TSOATT2,NOMOUNT         INITIALIZATION
         MVC   TSOATT3,NOOPER          INITIALIZATION
         MVC   TSOMAXR$,SPACES         INITIALIZATION
         MVC   TSODEST$,SPACES         INITIALIZATION
         MVC   TSONAM0$,SPACES         INITIALIZATION
         MVC   TSOSIZ0$,SPACES         INITIALIZATION
         MVC   TSOUNT0$,SPACES         INITIALIZATION
         MVC   TSONAM1$,SPACES         INITIALIZATION
         MVC   TSOSIZ1$,SPACES         INITIALIZATION
         MVC   TSOUNT1$,SPACES         INITIALIZATION
         MVC   TSONAM2$,SPACES         INITIALIZATION
         MVC   TSOSIZ2$,SPACES         INITIALIZATION
         MVC   TSOUNT2$,SPACES         INITIALIZATION
         MVC   TSOATT0$,SPACES         INITIALIZATION
         MVC   TSOATT1$,SPACES         INITIALIZATION
         MVC   TSOATT2$,SPACES         INITIALIZATION
         MVC   TSOATT3$,SPACES         INITIALIZATION
         MVC   TSOMAXR1,SPACES         INITIALIZATION
         MVC   TSODEST1,SPACES         INITIALIZATION
         MVC   TSONAM01,SPACES         INITIALIZATION
         MVC   TSOSIZ01,SPACES         INITIALIZATION
         MVC   TSOUNT01,SPACES         INITIALIZATION
         MVC   TSONAM11,SPACES         INITIALIZATION
         MVC   TSOSIZ11,SPACES         INITIALIZATION
         MVC   TSOUNT11,SPACES         INITIALIZATION
         MVC   TSONAM21,SPACES         INITIALIZATION
         MVC   TSOSIZ21,SPACES         INITIALIZATION
         MVC   TSOUNT21,SPACES         INITIALIZATION
         MVC   TSOATT01,SPACES         INITIALIZATION
         MVC   TSOATT11,SPACES         INITIALIZATION
         MVC   TSOATT21,SPACES         INITIALIZATION
         MVC   TSOATT31,SPACES         INITIALIZATION
         MVC   TSOMAXR2,SPACES         INITIALIZATION
         MVC   TSODEST2,SPACES         INITIALIZATION
         MVC   TSONAM02,SPACES         INITIALIZATION
         MVC   TSOSIZ02,SPACES         INITIALIZATION
         MVC   TSOUNT02,SPACES         INITIALIZATION
         MVC   TSONAM12,SPACES         INITIALIZATION
         MVC   TSOSIZ12,SPACES         INITIALIZATION
         MVC   TSOUNT12,SPACES         INITIALIZATION
         MVC   TSONAM22,SPACES         INITIALIZATION
         MVC   TSOSIZ22,SPACES         INITIALIZATION
         MVC   TSOUNT22,SPACES         INITIALIZATION
         MVC   TSOATT02,SPACES         INITIALIZATION
         MVC   TSOATT12,SPACES         INITIALIZATION
         MVC   TSOATT22,SPACES         INITIALIZATION
         MVC   TSOATT32,SPACES         INITIALIZATION
         MVC   TSOMAXR3,SPACES         INITIALIZATION
         MVC   TSODEST3,SPACES         INITIALIZATION
         MVC   TSONAM03,SPACES         INITIALIZATION
         MVC   TSOSIZ03,SPACES         INITIALIZATION
         MVC   TSOUNT03,SPACES         INITIALIZATION
         MVC   TSONAM13,SPACES         INITIALIZATION
         MVC   TSOSIZ13,SPACES         INITIALIZATION
         MVC   TSOUNT13,SPACES         INITIALIZATION
         MVC   TSONAM23,SPACES         INITIALIZATION
         MVC   TSOSIZ23,SPACES         INITIALIZATION
         MVC   TSOUNT23,SPACES         INITIALIZATION
         MVC   TSOATT03,SPACES         INITIALIZATION
         MVC   TSOATT13,SPACES         INITIALIZATION
         MVC   TSOATT23,SPACES         INITIALIZATION
         MVC   TSOATT33,SPACES         INITIALIZATION
         MVC   TSOMAXR4,SPACES         INITIALIZATION
         MVC   TSODEST4,SPACES         INITIALIZATION
         MVC   TSONAM04,SPACES         INITIALIZATION
         MVC   TSOSIZ04,SPACES         INITIALIZATION
         MVC   TSOUNT04,SPACES         INITIALIZATION
         MVC   TSONAM14,SPACES         INITIALIZATION
         MVC   TSOSIZ14,SPACES         INITIALIZATION
         MVC   TSOUNT14,SPACES         INITIALIZATION
         MVC   TSONAM24,SPACES         INITIALIZATION
         MVC   TSOSIZ24,SPACES         INITIALIZATION
         MVC   TSOUNT24,SPACES         INITIALIZATION
         MVC   TSOATT04,SPACES         INITIALIZATION
         MVC   TSOATT14,SPACES         INITIALIZATION
         MVC   TSOATT24,SPACES         INITIALIZATION
         MVC   TSOATT34,SPACES         INITIALIZATION
         MVC   TSOMAXR5,SPACES         INITIALIZATION
         MVC   TSODEST5,SPACES         INITIALIZATION
         MVC   TSONAM05,SPACES         INITIALIZATION
         MVC   TSOSIZ05,SPACES         INITIALIZATION
         MVC   TSOUNT05,SPACES         INITIALIZATION
         MVC   TSONAM15,SPACES         INITIALIZATION
         MVC   TSOSIZ15,SPACES         INITIALIZATION
         MVC   TSOUNT15,SPACES         INITIALIZATION
         MVC   TSONAM25,SPACES         INITIALIZATION
         MVC   TSOSIZ25,SPACES         INITIALIZATION
         MVC   TSOUNT25,SPACES         INITIALIZATION
         MVC   TSOATT05,SPACES         INITIALIZATION
         MVC   TSOATT15,SPACES         INITIALIZATION
         MVC   TSOATT25,SPACES         INITIALIZATION
         MVC   TSOATT35,SPACES         INITIALIZATION
         MVC   TSOMAXR6,SPACES         INITIALIZATION
         MVC   TSODEST6,SPACES         INITIALIZATION
         MVC   TSONAM06,SPACES         INITIALIZATION
         MVC   TSOSIZ06,SPACES         INITIALIZATION
         MVC   TSOUNT06,SPACES         INITIALIZATION
         MVC   TSONAM16,SPACES         INITIALIZATION
         MVC   TSOSIZ16,SPACES         INITIALIZATION
         MVC   TSOUNT16,SPACES         INITIALIZATION
         MVC   TSONAM26,SPACES         INITIALIZATION
         MVC   TSOSIZ26,SPACES         INITIALIZATION
         MVC   TSOUNT26,SPACES         INITIALIZATION
         MVC   TSOATT06,SPACES         INITIALIZATION
         MVC   TSOATT16,SPACES         INITIALIZATION
         MVC   TSOATT26,SPACES         INITIALIZATION
         MVC   TSOATT36,SPACES         INITIALIZATION
         MVC   TSOMAXR7,SPACES         INITIALIZATION
         MVC   TSODEST7,SPACES         INITIALIZATION
         MVC   TSONAM07,SPACES         INITIALIZATION
         MVC   TSOSIZ07,SPACES         INITIALIZATION
         MVC   TSOUNT07,SPACES         INITIALIZATION
         MVC   TSONAM17,SPACES         INITIALIZATION
         MVC   TSOSIZ17,SPACES         INITIALIZATION
         MVC   TSOUNT17,SPACES         INITIALIZATION
         MVC   TSONAM27,SPACES         INITIALIZATION
         MVC   TSOSIZ27,SPACES         INITIALIZATION
         MVC   TSOUNT27,SPACES         INITIALIZATION
         MVC   TSOATT07,SPACES         INITIALIZATION
         MVC   TSOATT17,SPACES         INITIALIZATION
         MVC   TSOATT27,SPACES         INITIALIZATION
         MVC   TSOATT37,SPACES         INITIALIZATION
         MVC   TSOMAXR8,SPACES         INITIALIZATION
         MVC   TSODEST8,SPACES         INITIALIZATION
         MVC   TSONAM08,SPACES         INITIALIZATION
         MVC   TSOSIZ08,SPACES         INITIALIZATION
         MVC   TSOUNT08,SPACES         INITIALIZATION
         MVC   TSONAM18,SPACES         INITIALIZATION
         MVC   TSOSIZ18,SPACES         INITIALIZATION
         MVC   TSOUNT18,SPACES         INITIALIZATION
         MVC   TSONAM28,SPACES         INITIALIZATION
         MVC   TSOSIZ28,SPACES         INITIALIZATION
         MVC   TSOUNT28,SPACES         INITIALIZATION
         MVC   TSOATT08,SPACES         INITIALIZATION
         MVC   TSOATT18,SPACES         INITIALIZATION
         MVC   TSOATT28,SPACES         INITIALIZATION
         MVC   TSOATT38,SPACES         INITIALIZATION
         MVC   TSODEST0,SPACES         INITIALIZATION
         MVC   TSOMAXR0,SPACES         INITIALIZATION
         MVC   RACF$,YES               INITIALIZATION
         MVC   RACF1,NO                INITIALIZATION
         MVC   RACF2,NO                INITIALIZATION
         MVC   RACF3,NO                INITIALIZATION
         MVC   RACF4,NO                INITIALIZATION
         MVC   RACF5,NO                INITIALIZATION
         MVC   RACF6,NO                INITIALIZATION
         MVC   RACF7,NO                INITIALIZATION
         MVC   RACF8,NO                INITIALIZATION
         MVC   TSO$,NO                 INITIALIZATION
         MVC   TSO1,NO                 INITIALIZATION
         MVC   TSO2,NO                 INITIALIZATION
         MVC   TSO3,NO                 INITIALIZATION
         MVC   TSO4,NO                 INITIALIZATION
         MVC   TSO5,NO                 INITIALIZATION
         MVC   TSO6,NO                 INITIALIZATION
         MVC   TSO7,NO                 INITIALIZATION
         MVC   TSO8,NO                 INITIALIZATION
         MVC   USRADD_,SKELNAM$        INITIALIZATION
         LA    R5,SKELNAM$             INITIALIZATION
         MVC   PANLNAM,PANLNAMA        INITIALIZATION
         LA    R6,DISPL230             INITIALIZATION
         MVC   SELCT,SPACES            INITIALIZATION
         MVC   SUB,NO                  INITIALIZATION
         MVC   SUBCMD2,SUBCMD1         MOVE STATIC INFO TO DYNAMIC
         MVC   VERCMD2,VERCMD1         MOVE STATIC INFO TO DYNAMIC
***********************************************************************
*  PROCESSING SECTION - DISPLAY RACF DATA ENTRY PANEL
***********************************************************************
DISPLAY1 EQU   *
         MVC   ISPFSERV,DISID          SET ISPF DIALOG SERVICE
*                                      DISPLAY PANEL
         ISPCALL ('DISPLAY','USRADD1')
         B     DISPL110(R15)           CHECK RETURN CODE
DISPL110 EQU   *
         B     SELECT1                 RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (DISPLAY PANEL / MSG)
         B     TBCLOSE1                RC = 08 (CONTINUE)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - SELECT CMD VERUSGRP TO VERIFY OWNER & DFLTGRP
***********************************************************************
SELECT1 EQU    *
         CLC   SAVOWN,OWNER            OWNER ALREADY BEEN VERIFIED?
         BNE   SELCT110                NO, CONTINUE
         CLC   SAVGRP,DFLTGRP          DFLTGRP ALREADY BEEN VERIFIED?
         BNE   SELCT110                NO, CONTINUE
         B     VGET120                 SKIP VERIFICATION
SELCT110 EQU   *
         MVC   ISPFSERV,SELID          SET ISPF DIALOG SERVICE
         MVC   VERCMD2+13(8),OWNER     MOVE OWNER TO VERUSGRP COMMAND
         MVC   VERCMD2+22(8),DFLTGRP   MOVE DFLTGRP TO VERUSGRP COMMAND
*                                      EXECUTE CLIST
         ISPCALL ('SELECT',FULL31,VERCMD2)
         B     SELCT120(R15)           CHECK RETURN CODE
SELCT120 EQU   *
         B     VGET1                   RC = 00 (CONTINUE)
         B     VGET1                   RC = 04 (CONTINUE)
         B     USRERR08                RC = 08 (NOT VALID FOR SELECT)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - RETRIEVE 'OWNVER' & 'GRPVER'
***********************************************************************
VGET1    EQU   *
         MVC   ISPFSERV,GETID          SET ISPF DIALOG SERVICE
*                                      RETRIEVE DIALOG VARIABLE
         ISPCALL ('VGET',NAMELSTE)
         B     VGET110(R15)            CHECK RETURN CODE
VGET110  EQU   *
         B     VGET120                 RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR VGET)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (NOT VALID FOR VGET)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
VGET120  EQU   *
         CLC   OWNVER,VALID            VALID RACF OWNER SPECIFIED?
         BNE   VALIDERR                NO, DISPLAY PANEL / MESSAGE
         MVC   SAVOWN,OWNER            SAVE VALID OWNER
         CLC   GRPVER,VALID            VALID RACF GROUP SPECIFIED?
         BNE   VALIDERR                NO, DISPLAY PANEL / MESSAGE
         MVC   SAVGRP,DFLTGRP          SAVE VALID DEFAULT GROUP
         CLC   TSOUSER,YES             THIS A TSO USER?
         BNE   VGET130                 NO, CHECK NCCF
         BAL   R9,DISPLAY2             DISPLAY TSO DATA ENTRY PANEL
VGET130  EQU   *
         CLC   NCCFUSER,YES            THIS AN NCCF USER?
         BNE   BLDVARS                 RE-DISPLAY RACF DATA ENTRY PANEL
         BAL   R9,DISPLAY3             DISPLAY NCCF DATA ENTRY PANEL
***********************************************************************
*  PROCESSING SECTION - BUILD NAME, ROOM, CNCTGRP1,
*                       NCCFPROF, TSODEST0 & TSOMAXR0
***********************************************************************
BLDVARS  EQU   *
         MVI   ADDFLAG,ON              TURN ON ADDFLAG
         MVC   NAME,FNAME              MOVE FIRST NAME TO NAME
         CLC   LNAME,SPACES            IS THERE A LAST NAME?
         BE    BLDVAR40                NO, BUILD ROOM
         LA    R2,NAME                 R2 - INDEX THROUGH NAME
         LA    R3,LNAME                R3 - INDEX THROUGH LAST NAME
         LA    R4,20                   R4 - MAXIMUM NAME LENGTH
BLDVAR10 EQU   *
         CLC   0(2,R2),SPACES          END OF FIRST NAME?
         BE    BLDVAR20                YES, ADD LAST NAME
         LA    R2,1(R2)                NO, INCREMENT R2
         BCT   R4,BLDVAR10                 AND CONTINUE
         B     BLDVAR40                NO ROOM FOR LAST NAME
BLDVAR20 EQU   *
         LA    R2,1(R2)                POINT TO LOCATION FOR LNAME
         BCTR  R4,0                    DECREMENT R4
BLDVAR30 EQU   *
         MVC   0(1,R2),0(R3)           MOVE LNAME TO NAME
         LA    R2,1(R2)                INCREMENT R2
         LA    R3,1(R3)                    INCREMENT R3
         BCT   R4,BLDVAR30                     AND CONTINUE
BLDVAR40 EQU   *
         CLC   ROOM#,USERDATA          IS THERE A ROOM NUMBER?
         BNE   BLDVAR50                NO, BUILD CNCTGRP1
         MVC   ROOM,USERDATA+5         MOVE ROOM NUMBER TO VARIABLE
BLDVAR50 EQU   *
         LA    R2,CNCTGRP1             R2 - INDEX THROUGH CNCTGRP1
         MVC   0(8,R2),DFLTGRP         MOVE DEFAULT GROUP
         LA    R2,8(R2)                POINT TO NEXT SLOT
         MVC   0(8,R2),AUTHORTY        MOVE AUTHORITY
         LA    R2,8(R2)                POINT TO NEXT SLOT
         MVC   0(8,R2),UACC            MOVE UNIVERSAL ACCESS
         LA    R2,8(R2)                POINT TO NEXT SLOT
         MVC   0(8,R2),REVOKE          MOVE REVOKE DATE
         LA    R2,8(R2)                POINT TO NEXT SLOT
         MVC   0(8,R2),RESUME          MOVE RESUME DATE
BLDVAR60 EQU   *
         CLC   NCCFUSER,YES            THIS AN NCCF USER?
         BNE   BLDVAR70                NO, BUILD TSODEST0
         MVC   NCCFPROF+5(1),SELCT     YES, FINISH NCCF PROFILE NAME
BLDVAR70 EQU   *
         CLC   NODEST,TSODEST          DESTINATION SPECIFIED?
         BE    BLDVAR80                NO, BUILD TSOMAXR0
         MVC   TSODEST0(5),DEST#       MOVE 'DEST('
         MVC   TSODEST0+5(8),TSODEST   MOVE TSODEST
         MVC   TSODEST0+13(1),CLOPAREN MOVE ')'
         B     BLDVAR90                NO, BUILD TSOMAXR0
BLDVAR80 EQU   *
         MVC   TSODEST0(8),TSODEST
BLDVAR90 EQU   *
         CLC   NOLIM,TSOMAXR           MAXSIZE SPECIFIED?
         BE    BLDVARA0                NO, SET ROW POINTER FOR
         MVC   TSOMAXR0(8),MAXSIZE#    MOVE 'MAXSIZE('
         MVC   TSOMAXR0+8(5),TSOMAXR   MOVE TSOMAXR
         MVC   TSOMAXR0+13(1),CLOPAREN MOVE ')'
         B     TBADD1
BLDVARA0 EQU   *
         MVC   TSOMAXR0(8),TSOMAXR
***********************************************************************
*  PROCESSING SECTION - ADD A USER TO THE USER TABLE
***********************************************************************
TBADD1   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','USERTAB',' ','ORDER')
         B     TBADD110(R15)           CHECK RETURN CODE
TBADD110 EQU   *
         B     TBADD2                  RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBADD)
         B     ADDERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - ADD A USER TO THE FILE TAILORING TABLE
***********************************************************************
TBADD2   EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD','USRADD')
         B     TBADD210(R15)           CHECK RETURN CODE
TBADD210 EQU   *
         B     INITV10                 RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBADD)
         B     USRERR08                RC = 08 (NOT VALID FOR TBADD)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - CLOSE USER TABLE (USERTAB)
***********************************************************************
TBCLOSE1 EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
*                                      CLOSE AND SAVE TABLE
         ISPCALL ('TBCLOSE','USERTAB','REPLCOPY',' ',' ','USRTLIB')
         B     TBCLO110(R15)           CHECK RETURN CODE
TBCLO110 EQU   *
         B     TBCLOSE2                RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBCLOSE)
         B     USRERR08                RC = 08 (NOT VALID FOR TBCLOSE)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - CLOSE FILE TAILORING TABLE (USRADD)
***********************************************************************
TBCLOSE2 EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
*                                      CLOSE AND SAVE TABLE
         ISPCALL ('TBCLOSE','USRADD','REPLCOPY')
         B     TBCLO210(R15)           CHECK RETURN CODE
TBCLO210 EQU   *
         B     VGET2                   RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBCLOSE)
         B     USRERR08                RC = 08 (NOT VALID FOR TBCLOSE)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - RETRIEVE 'ZLLGJOB1' & 'ZLLGJOB2'
***********************************************************************
VGET2    EQU   *
         MVC   ISPFSERV,GETID          SET ISPF DIALOG SERVICE
*                                      RETRIEVE DIALOG VARIABLE
         ISPCALL ('VGET',NAMELSTF)
         B     VGET210(R15)            CHECK RETURN CODE
VGET210  EQU   *
         B     FTOPEN                  RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR VGET)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (NOT VALID FOR VGET)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - OPEN TEMPORARY FILE TAILORING FILE
***********************************************************************
FTOPEN   EQU   *
         MVC   ISPFSERV,FTOID          SET ISPF DIALOG SERVICE
         TM    ADDFLAG,ON              ANY DATA PROCESSED?
         BNO   TBERASE                 NO, ERASE FILE TAILORING TABLE
*                                      OPEN TEMP FILE TAILORING FILE
         ISPCALL ('FTOPEN','TEMP')
         B     FTOPN10(R15)            CHECK RETURN CODE
FTOPN10  EQU   *
         B     FTINCL                  RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR FTOPEN)
         B     FTINCL                  RC = 08 (CONTINUE)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - INCLUDE SKELETON FOR FILE TAILORING
***********************************************************************
FTINCL   EQU   *
         MVC   ISPFSERV,FTIID          SET ISPF DIALOG SERVICE
*                                      INCLUDE SKELETON FOR TAILORING
         ISPCALL ('FTINCL',USRADD_)
         B     FTINC10(R15)            CHECK RETURN CODE
FTINC10  EQU   *
         B     FTCLOSE                 RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR FTINCL)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - CLOSE TEMPORARY FILE
***********************************************************************
FTCLOSE  EQU   *
         MVC   ISPFSERV,FTCID          SET ISPF DIALOG SERVICE
*                                      CLOSE TEMP FILE TAILORING FILE
         ISPCALL ('FTCLOSE')
         B     FTCLO10(R15)            CHECK RETURN CODE
FTCLO10  EQU   *
         B     VGET3                   RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR FTCLOSE)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - RETRIEVE 'ZTEMPF'
***********************************************************************
VGET3    EQU   *
         CLC   SUB,NO                  REGIONAL FILE TAILORING?
         BE    SELCT220                NO, PROCESS NEXT REGION
         MVC   ISPFSERV,GETID          SET ISPF DIALOG SERVICE
*                                      RETRIEVE DIALOG VARIABLE
         ISPCALL ('VGET',NAMELST9)
         B     VGET310(R15)            CHECK RETURN CODE
VGET310  EQU   *
         B     SELECT2                 RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR VGET)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (NOT VALID FOR VGET)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - SELECT CMD ZTEMPF TO DEFINE USER(S)
***********************************************************************
SELECT2 EQU    *
         MVC   ISPFSERV,SELID          SET ISPF DIALOG SERVICE
         MVC   SUBCMD2+11(44),ZTEMPF   NO, MOVE ZTEMPF TO SUBCMD
         ISPCALL ('SELECT',FULL56,SUBCMD2)
         B     SELCT210(R15)           CHECK RETURN CODE
SELCT210 EQU   *
         B     SELCT220                RC = 00 (CONTINUE)
         B     SELCT220                RC = 04 (CONTINUE)
         B     USRERR08                RC = 08 (NOT VALID FOR SELECT)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
SELCT220 EQU   *
         CLC   0(8,R5),SKELNAM8        ARE WE DONE?
         BE    TBERASE                 YES, ERASE TABLE
         LA    R5,8(R5)                POINT TO NEXT SKELETON NAME
         MVC   USRADD_,0(R5)           MOVE IT INTO USRADD_
         MVC   SUB,NO                  RE-SET SUB
         B     FTOPEN                  CONTINUE WITH FILE TAILORING
***********************************************************************
*  PROCESSING SECTION - ERASE FILE TAILORING TABLE (USRADD)
***********************************************************************
TBERASE  EQU   *
         MVC   ISPFSERV,ERAID          SET ISPF DIALOG SERVICE
*                                      CLOSE TABLE WITHOUT SAVING
         ISPCALL ('TBERASE','USRADD')
         B     TBERA10(R15)            CHECK RETURN CODE
TBERA10  EQU   *
         B     FINISH                  RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBERASE)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - DISPLAY TSO DATA ENTRY PANEL
***********************************************************************
DISPLAY2 EQU   *
         MVC   ISPFSERV,DISID          SET ISPF DIALOG SERVICE
*                                      DISPLAY PANEL
         ISPCALL ('DISPLAY',PANLNAM)
         B     DISPL210(R15)           CHECK RETURN CODE
DISPL210 EQU   *
         B     DISPL220                RC = 00 (CONTINUE)
         B     DISPL220                RC = 04 (CONTINUE)
         B     DISPL2D0                RC = 08 (CONTINUE)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
DISPL220 EQU   *
         BR    R6                      BRANCH TO REGNL TSO
DISPL230 EQU   *
         MVC   TSO$,YES                ADD TO ADMIN 'SYS1.UADS'
         MVC   TSOMAXR$,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST$,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM0$,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ0$,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT0$,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT0$,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT1$,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT2$,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT3$,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL240 EQU   *
         CLC   TSO1,YES                ADD TO REG 1 'SYS1.UADS'?
         BNE   DISPL250                NO, CHECK REG 2
         LA    R6,DISPL245             R6 - RETURN ADDRESS
         MVC   REGID,REG1              SET REGIONAL ID
         MVC   PANLNAM,PANLNAMB        SET TSO ADD PANEL NAME
         B     DISPLAY2                DISPLAY ENTRY PANEL
DISPL245 EQU   *
         MVC   TSOMAXR1,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST1,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM01,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ01,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT01,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT01,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT11,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT21,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT31,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL250 EQU   *
         CLC   TSO2,YES                ADD TO REG 2 'SYS1.UADS'?
         BNE   DISPL260                NO, CHECK REG 3
         LA    R6,DISPL255             R6 - RETURN ADDRESS
         MVC   REGID,REG2              SET REGIONAL ID
         MVC   PANLNAM,PANLNAMB        SET TSO ADD PANEL NAME
         B     DISPLAY2                DISPLAY ENTRY PANEL
DISPL255 EQU   *
         MVC   TSOMAXR2,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST2,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM02,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ02,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT02,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT02,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT12,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT22,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT32,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL260 EQU   *
         CLC   TSO3,YES                ADD TO REG 3 'SYS1.UADS'?
         BNE   DISPL270                NO, CHECK REG 4
         LA    R6,DISPL265             R6 - RETURN ADDRESS
         MVC   REGID,REG3              SET REGIONAL ID
         MVC   PANLNAM,PANLNAMB        SET TSO ADD PANEL NAME
         B     DISPLAY2                DISPLAY ENTRY PANEL
DISPL265 EQU   *
         MVC   TSOMAXR3,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST3,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM03,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ03,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT03,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT03,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT13,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT23,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT33,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL270 EQU   *
         CLC   TSO4,YES                ADD TO REG 4 'SYS1.UADS'?
         BNE   DISPL280                NO, CHECK REG 5
         LA    R6,DISPL275             R6 - RETURN ADDRESS
         MVC   REGID,REG4              SET REGIONAL ID
         MVC   PANLNAM,PANLNAMB        SET TSO ADD PANEL NAME
         B     DISPLAY2                DISPLAY ENTRY PANEL
DISPL275 EQU   *
         MVC   TSOMAXR4,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST4,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM04,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ04,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT04,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT04,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT14,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT24,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT34,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL280 EQU   *
         CLC   TSO5,YES                ADD TO REG 5 'SYS1.UADS'?
         BNE   DISPL290                NO, CHECK REG 6
         LA    R6,DISPL285             R6 - RETURN ADDRESS
         MVC   REGID,REG5              SET REGIONAL ID
         MVC   PANLNAM,PANLNAMB        SET TSO ADD PANEL NAME
         B     DISPLAY2                DISPLAY ENTRY PANEL
DISPL285 EQU   *
         MVC   TSOMAXR5,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST5,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM05,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ05,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT05,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT05,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT15,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT25,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT35,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL290 EQU   *
         CLC   TSO6,YES                ADD TO REG 6 'SYS1.UADS'?
         BNE   DISPL2A0                NO, CHECK REG 7
         LA    R6,DISPL295             R6 - RETURN ADDRESS
         MVC   REGID,REG6              SET REGIONAL ID
         MVC   PANLNAM,PANLNAMB        SET TSO ADD PANEL NAME
         B     DISPLAY2                DISPLAY ENTRY PANEL
DISPL295 EQU   *
         MVC   TSOMAXR6,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST6,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM06,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ06,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT06,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT06,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT16,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT26,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT36,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL2A0 EQU   *
         CLC   TSO7,YES                ADD TO REG 7 'SYS1.UADS'?
         BNE   DISPL2B0                NO, CHECK REG 8
         LA    R6,DISPL2A5             R6 - RETURN ADDRESS
         MVC   REGID,REG7              SET REGIONAL ID
         MVC   PANLNAM,PANLNAMB        SET TSO ADD PANEL NAME
         B     DISPLAY2                DISPLAY ENTRY PANEL
DISPL2A5 EQU   *
         MVC   TSOMAXR7,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST7,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM07,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ07,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT07,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT07,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT17,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT27,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT37,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL2B0 EQU   *
         CLC   TSO8,YES                ADD TO REG 8 'SYS1.UADS'?
         BNE   DISPL2C0                NO, CHECK LNAME
         LA    R6,DISPL2B5             R6 - RETURN ADDRESS
         MVC   REGID,REG8              SET REGIONAL ID
         MVC   PANLNAM,PANLNAMB        SET TSO ADD PANEL NAME
         B     DISPLAY2                DISPLAY ENTRY PANEL
DISPL2B5 EQU   *
         MVC   TSOMAXR8,TSOMAXR        INSERT INFORMATION FROM PANEL
         MVC   TSODEST8,TSODEST        INSERT INFORMATION FROM PANEL
         MVC   TSONAM08,TSONAM0        INSERT INFORMATION FROM PANEL
         MVC   TSOSIZ08,TSOSIZ0        INSERT INFORMATION FROM PANEL
         MVC   TSOUNT08,TSOUNT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT08,TSOATT0        INSERT INFORMATION FROM PANEL
         MVC   TSOATT18,TSOATT1        INSERT INFORMATION FROM PANEL
         MVC   TSOATT28,TSOATT2        INSERT INFORMATION FROM PANEL
         MVC   TSOATT38,TSOATT3        INSERT INFORMATION FROM PANEL
DISPL2C0 EQU   *
         BR    R9                      RETURN
DISPL2D0 EQU   *
         CLC   TSO$,YES                TSO USER ADDED?
         BER   R9                      YES, RETURN
         MVC   TSOUSER,NO              NO, DON'T ADD TSO USER
         BR    R9                      RETURN
***********************************************************************
*  PROCESSING SECTION - DISPLAY NCCF DATA ENTRY PANEL
***********************************************************************
DISPLAY3 EQU   *
         MVC   ISPFSERV,DISID          SET ISPF DIALOG SERVICE
*                                      DISPLAY PANEL
         ISPCALL ('DISPLAY','USRADD3')
         B     DISPL310(R15)           CHECK RETURN CODE
DISPL310 EQU   *
         B     SELECT3                 RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (DISPLAY PANEL / MSG)
         B     DISPL320                RC = 08 (CONTINUE)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
DISPL320 EQU   *
         BR    R9                      RETURN
***********************************************************************
*  PROCESSING SECTION - SELECT PGM 'USRADD2' TO ADD NCCF USER
***********************************************************************
SELECT3 EQU    *
         MVC   ISPFSERV,SELID          SET ISPF DIALOG SERVICE
         ISPCALL ('CONTROL','DISPLAY','SAVE')    SAVE LOGICAL SCREEN
*                                      SELECT PROGRAM FOR EXECUTION
         ISPCALL ('SELECT',FULL12,USRADD2)    SELECT 'USRADD2'
         B     SELCT310(R15)           CHECK RETURN CODE
SELCT310 EQU   *
         B     SELCT320                RC = 00 (CONTINUE)
         B     SELCT320                RC = 04 (CONTINUE)
         B     USRERR08                RC = 08 (NOT VALID FOR SELECT)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
SELCT320 EQU   *
         ISPCALL ('CONTROL','DISPLAY','RESTORE')    RESTORE SCREEN
         BR    R9                      RETURN
         TITLE 'USRADD1 - ERROR PROCESSING SECTION'
***********************************************************************
*  ERROR PROCESSING SECTION
***********************************************************************
USRERR04 EQU   *
         MVC   ISPFRC,FOUR             SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
USRERR08 EQU   *
         MVC   ISPFRC,EIGHT            SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
USRERR12 EQU   *
         MVC   ISPFRC,TWELVE           SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
USRERR16 EQU   *
         MVC   ISPFRC,SIXTEEN          SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
USRERR20 EQU   *
         MVC   ISPFRC,TWENTY           SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
MSGDISP1 EQU   *
         MVC   USERMSGS,USERERRS       SET SHORT MESSAGE
         MVC   USERMSGL,USERERRL       SET LONG MESSAGE
         MVC   USERMSGL+21(8),ISPFSERV    SET ISPF DIALOG SERVICE
         MVC   USERMSGL+47(2),ISPFRC   SET DIALOG SERVICE RETURN CODE
*                                      DISPLAY SELECTION PANEL
         ISPCALL ('DISPLAY','USRADD1',USERMSG)
         B     FINISH
ADDERR08 EQU   *
         MVC   USERMSGS,ADDERRS        SET SHORT MESSAGE
         MVC   USERMSGL,ADDERRL        SET LONG MESSAGE
         MVC   USERMSGL(8),USERID      MOVE USERID TO MESSAGE
         MVC   USERMSGL+52(3),NCCFUSER MOVE NCCF USER INDICATION
         MVC   USERMSGL+68(3),TSOUSER  MOVE TSO USER INDICATION
*                                      DISPLAY SELECTION PANEL
         ISPCALL ('DISPLAY','USRADD1',USERMSG)
         B     INITV10
VALIDERR EQU   *
         MVC   USERMSGS,VERERRS        SET SHORT MESSAGE
         MVC   USERMSGL,VERERRL        SET LONG MESSAGE
         MVC   USERMSGL+6(8),OWNER     MOVE OWNER TO MESSAGE
         MVC   USERMSGL+18(8),OWNVER   MOVE 'VALID' OR 'INVALID' TO MSG
         MVC   USERMSGL+42(8),DFLTGRP  MOVE DFLTGRP TO MESSAGE
         MVC   USERMSGL+54(8),GRPVER   MOVE 'VALID' OR 'INVALID' TO MSG
*                                      DISPLAY SELECTION PANEL
         ISPCALL ('DISPLAY','USRADD1',USERMSG)
         B     DISPLAY1
         TITLE 'USRADD1 - CLOSING SECTION'
***********************************************************************
*  CLOSING SECTION - FREE GETMAINED AREA, SET RETURN CODE RESTORE REGS
***********************************************************************
FINISH   EQU   *
         LA    R0,WORKLEN              R0 - LENGTH OF WORKAREA
         LR    R1,R13                  R1 - ADDRESS OF WORKAREA
         L     R13,4(R13)              R13 - ADDR CALLER'S SAVE AREA
         FREEMAIN R,LV=(0),A=(1)       FREE GETMAINED VIRTUAL STORAGE
         RETURN (14,12),RC=(15)        RESTORE REGISTERS AND RETURN
         TITLE 'USRADD1 - REGISTER EQUATES'
***********************************************************************
*  REGISTER EQUATES
***********************************************************************
         EQUATE
OFF      EQU   X'00'                   NO USERS HAVE BEEN ADDED
ON       EQU   X'10'                   USER(S) HAVE BEEN ADDED
         TITLE 'USRADD1 - DATA CONSTANTS'
***********************************************************************
*  CONSTANTS
***********************************************************************
FULL00   DC    F'00'                   FULLWORD CONSTANT VALUE '00'
FULL01   DC    F'01'                   FULLWORD CONSTANT VALUE '01'
FULL12   DC    F'12'                   FULLWORD CONSTANT VALUE '12'
FULL15   DC    F'15'                   FULLWORD CONSTANT VALUE '15'
FULL31   DC    F'31'                   FULLWORD CONSTANT VALUE '31'
FULL56   DC    F'56'                   FULLWORD CONSTANT VALUE '56'
SPACES   DC    CL80' '                 SPACES
FOUR     DC    CL2'04'                 RETURN CODE OF '04'
EIGHT    DC    CL2'08'                 RETURN CODE OF '08'
TWELVE   DC    CL2'12'                 RETURN CODE OF '12'
SIXTEEN  DC    CL2'16'                 RETURN CODE OF '16'
TWENTY   DC    CL2'20'                 RETURN CODE OF '20'
DEST#    DC    CL5'DEST('              INDICATE SYSOUT DEST
MAXSIZE# DC    CL8'MAXSIZE('           INDICATE MAXIMUM REGION SIZE
ROOM#    DC    CL5'ROOM='              INDICATE ROOM NUMBER
NCCFINIT DC    CL8'DPF30'              NCCF PROFILE NAME PREFIX
NODEST   DC    C'NODEST'               INDICATES NO TSO SYSOUT DEST
NOLIM    DC    C'NOLIM'                INDICATES 'MAXSIZE' PARM UNUSED
ACCT     DC    CL8'ACCT'               TSO ACCT ATTRIBUTE
NOACCT   DC    CL8'NOACCT'             TSO NOACCT ATTRIBUTE
JCL      DC    CL8'JCL'                TSO JCL ATTRIBUTE
NOJCL    DC    CL8'NOJCL'              TSO NOJCL ATTRIBUTE
MOUNT    DC    CL8'MOUNT'              TSO MOUNT ATTRIBUTE
NOMOUNT  DC    CL8'NOMOUNT'            TSO NOMOUNT ATTRIBUTE
OPER     DC    CL8'OPER'               TSO OPER ATTRIBUTE
NOOPER   DC    CL8'NOOPER'             TSO NOOPER ATTRIBUTE
NONE     DC    CL8'NONE'               INITIALIZE REVOKE & RESUME
NO       DC    CL1'N'                  INDICATE NOT TSO OR NCCF USER
YES      DC    CL1'Y'                  INDICATE TSO OR NCCF USER
VALID    DC    CL8'VALID'              INDICATE OWNER/DFLTGRP VALID
INVALID  DC    CL8'INVALID'            INDICATE OWNER/DFLTGRP INVALID
CLOPAREN DC    CL1')'                  CLOSING PARENTHESIS
QUOTE    DC    CL1''''                 QUOTE
ZERO     DC    CL1'0'                  CHAR CONSTANT VALUE '0'
USERMSG  DC    CL8'USER000'            GENERIC USER MESSAGE
USRADD2  DC    C'PGM(USRADD2)'         FUNTION CALLED FROM USRADD1
SUBCMD1  DC    CL56'CMD(SUBMIT                                         +
                    )'
VERCMD1  DC    CL31'CMD(VERUSGRP 12345678 12345678)'
PANLNAMA DC    CL8'USRADD2A'           ADMIN TSO ADD PANEL
PANLNAMB DC    CL8'USRADD2B'           REGNL TSO ADD PANEL
SKELNAM$ DC    CL8'USRADD$'            ADMIN SKELETON
SKELNAM1 DC    CL8'USRADD1'            REGION 1 SKELETON
SKELNAM2 DC    CL8'USRADD2'            REGION 2 SKELETON
SKELNAM3 DC    CL8'USRADD3'            REGION 3 SKELETON
SKELNAM4 DC    CL8'USRADD4'            REGION 4 SKELETON
SKELNAM5 DC    CL8'USRADD5'            REGION 5 SKELETON
SKELNAM6 DC    CL8'USRADD6'            REGION 6 SKELETON
SKELNAM7 DC    CL8'USRADD7'            REGION 7 SKELETON
SKELNAM8 DC    CL8'USRADD8'            REGION 8 SKELETON
REG1     DC    CL4'REG1'               REGION 1 ID
REG2     DC    CL4'REG2'               REGION 2 ID
REG3     DC    CL4'REG3'               REGION 3 ID
REG4     DC    CL4'REG4'               REGION 4 ID
REG5     DC    CL4'REG5'               REGION 5 ID
REG6     DC    CL4'REG6'               REGION 6 ID
REG7     DC    CL4'REG7'               REGION 7 ID
REG8     DC    CL4'REG8'               REGION 8 ID
ADDID    DC    CL8'TBADD'              ISPF DIALOG SERVICE (TBADD)
CLOID    DC    CL8'TBCLOSE'            ISPF DIALOG SERVICE (TBCLOSE)
CREID    DC    CL8'TBCREATE'           ISPF DIALOG SERVICE (TBCREATE)
DEFID    DC    CL8'VDEFINE'            ISPF DIALOG SERVICE (VDEFINE)
DISID    DC    CL8'DISPLAY'            ISPF DIALOG SERVICE (DISPLAY)
ERAID    DC    CL8'TBERASE'            ISPF DIALOG SERVICE (TBERASE)
FTCID    DC    CL8'FTCLOSE'            ISPF DIALOG SERVICE (FTCLOSE)
FTIID    DC    CL8'FTINCL'             ISPF DIALOG SERVICE (FTINCL)
FTOID    DC    CL8'FTOPEN'             ISPF DIALOG SERVICE (FTOPEN)
GETID    DC    CL8'VGET'               ISPF DIALOG SERVICE (VGET)
OPNID    DC    CL8'TBOPEN'             ISPF DIALOG SERVICE (TBOPEN)
SELID    DC    CL8'SELECT'             ISPF DIALOG SERVICE (SELECT)
USERERRS DC    CL24'USRADD1 program error.  '
USERERRL DC    CL78'ISPF Dialog Service, 12345678, ended with RC = 00. +
               Notify Systems Programming.'
ADDERRS  DC    CL24'User already exists.    '
ADDERRL  DC    CL78'12345678 already exists as a RACF user. NCCF User =+
                123; TSO User = 123.      '
VERERRS  DC    CL24'Invalid OWNER or DFLTGRP'
VERERRL  DC    CL78'Owner 12345678 is 12345678. Default Group 12345678 +
               is 12345678.               '
NAMELST1 DS    0F                      NAMES OF VARIABLES (LENGTH 8)
         DC    F'19'
         DC    F'00'
         DC    CL8'USERID'
         DC    CL8'OWNER'
         DC    CL8'DFLTGRP'
         DC    CL8'REVOKE'
         DC    CL8'RESUME'
         DC    CL8'AUTHORTY'
         DC    CL8'UACC'
         DC    CL8'NCCFPROF'
         DC    CL8'TSONAM0'
         DC    CL8'TSOSIZ0'
         DC    CL8'TSOUNT0'
         DC    CL8'TSODEST'
         DC    CL8'TSOMAXR'
         DC    CL8'TSOATT0'
         DC    CL8'TSOATT1'
         DC    CL8'TSOATT2'
         DC    CL8'TSOATT3'
         DC    CL8'OWNVER'
         DC    CL8'GRPVER'
NAMELST2 DS    0F                      NAMES OF VARIABLES (LENGTH 20)
         DC    F'03'
         DC    F'00'
         DC    CL8'NAME'
         DC    CL8'LNAME'
         DC    CL8'FNAME'
NAMELST3 DS    0F                      NAMES OF VARIABLES (LENGTH 10)
         DC    F'06'
         DC    F'00'
         DC    CL8'RACFATT0'
         DC    CL8'RACFATT1'
         DC    CL8'RACFATT2'
         DC    CL8'RACFATT3'
         DC    CL8'RACFATT4'
         DC    CL8'RACFATT5'
NAMELST4 DS    0F                      NAMES OF VARIABLES (LENGTH 70)
         DC    F'01'
         DC    F'00'
         DC    CL8'USERDATA'
NAMELST5 DS    0F                      NAMES OF VARIABLES (LENGTH 4)
         DC    F'03'
         DC    F'00'
         DC    CL8'ROOM'
         DC    CL8'EXTENS'
         DC    CL8'REGID'
NAMELST6 DS    0F                      NAMES OF VARIABLES (LENGTH 40)
         DC    F'01'
         DC    F'00'
         DC    CL8'CNCTGRP1'
NAMELST7 DS    0F                      NAMES OF VARIABLES (LENGTH 1)
         DC    F'22'
         DC    F'00'
         DC    CL8'SELCT'
         DC    CL8'RACF$'
         DC    CL8'RACF1'
         DC    CL8'RACF2'
         DC    CL8'RACF3'
         DC    CL8'RACF4'
         DC    CL8'RACF5'
         DC    CL8'RACF6'
         DC    CL8'RACF7'
         DC    CL8'RACF8'
         DC    CL8'NCCFUSER'
         DC    CL8'TSOUSER'
         DC    CL8'TSO$'
         DC    CL8'TSO1'
         DC    CL8'TSO2'
         DC    CL8'TSO3'
         DC    CL8'TSO4'
         DC    CL8'TSO5'
         DC    CL8'TSO6'
         DC    CL8'TSO7'
         DC    CL8'TSO8'
         DC    CL8'SUB'
NAMELST8 DS    0F                      NAMES OF VARIABLES (LENGTH 14)
         DC    F'02'
         DC    F'00'
         DC    CL8'TSODEST0'
         DC    CL8'TSOMAXR0'
NAMELST9 DS    0F                      NAMES OF VARIABLES (LENGTH 44)
         DC    F'01'
         DC    F'00'
         DC    CL8'ZTEMPF'
NAMELSTA DS    0F                      NAMES OF VARIABLES (LENGTH 24)
         DC    F'01'
         DC    F'00'
         DC    CL8'USERMSGS'
NAMELSTB DS    0F                      NAMES OF VARIABLES (LENGTH 78)
         DC    F'01'
         DC    F'00'
         DC    CL8'USERMSGL'
NAMELSTC DS    0F                      NAMES OF VARIABLES FT TABLE
         DC    F'37'
         DC    F'00'
         DC    CL8'USERID'
         DC    CL8'NAME'
         DC    CL8'OWNER'
         DC    CL8'DFLTGRP'
         DC    CL8'AUTHORTY'
         DC    CL8'UACC'
         DC    CL8'RACFATT0'
         DC    CL8'RACFATT1'
         DC    CL8'RACFATT2'
         DC    CL8'USERDATA'
         DC    CL8'RACF$'
         DC    CL8'RACF1'
         DC    CL8'RACF2'
         DC    CL8'RACF3'
         DC    CL8'RACF4'
         DC    CL8'RACF5'
         DC    CL8'RACF6'
         DC    CL8'RACF7'
         DC    CL8'RACF8'
         DC    CL8'TSO$'
         DC    CL8'TSO1'
         DC    CL8'TSO2'
         DC    CL8'TSO3'
         DC    CL8'TSO4'
         DC    CL8'TSO5'
         DC    CL8'TSO6'
         DC    CL8'TSO7'
         DC    CL8'TSO8'
         DC    CL8'TSONAM0'
         DC    CL8'TSOSIZ0'
         DC    CL8'TSOUNT0'
         DC    CL8'TSODEST0'
         DC    CL8'TSOMAXR0'
         DC    CL8'TSOATT0'
         DC    CL8'TSOATT1'
         DC    CL8'TSOATT2'
         DC    CL8'TSOATT3'
NAMELSTE DS    0F                      NAMES OF VERUSGRP CLIST VARS
         DC    F'02'
         DC    F'00'
         DC    CL8'OWNVER'
         DC    CL8'GRPVER'
NAMELSTF DS    0F                      NAMES OF VARIABLES (LENGTH 80)
         DC    F'02'
         DC    F'00'
         DC    CL8'ZLLGJOB1'
         DC    CL8'ZLLGJOB2'
NAMLIST$ DS    0F                      NAMES OF EXTENSION VARIABLES $
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR$'
         DC    CL8'TSODEST$'
         DC    CL8'TSONAM0$'
         DC    CL8'TSOSIZ0$'
         DC    CL8'TSOUNT0$'
         DC    CL8'TSONAM1$'
         DC    CL8'TSOSIZ1$'
         DC    CL8'TSOUNT1$'
         DC    CL8'TSONAM2$'
         DC    CL8'TSOSIZ2$'
         DC    CL8'TSOUNT2$'
         DC    CL8'TSOATT0$'
         DC    CL8'TSOATT1$'
         DC    CL8'TSOATT2$'
         DC    CL8'TSOATT3$'
NAMLIST1 DS    0F                      NAMES OF EXTENSION VARIABLES 1
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR1'
         DC    CL8'TSODEST1'
         DC    CL8'TSONAM01'
         DC    CL8'TSOSIZ01'
         DC    CL8'TSOUNT01'
         DC    CL8'TSONAM11'
         DC    CL8'TSOSIZ11'
         DC    CL8'TSOUNT11'
         DC    CL8'TSONAM21'
         DC    CL8'TSOSIZ21'
         DC    CL8'TSOUNT21'
         DC    CL8'TSOATT01'
         DC    CL8'TSOATT11'
         DC    CL8'TSOATT21'
         DC    CL8'TSOATT31'
NAMLIST2 DS    0F                      NAMES OF EXTENSION VARIABLES 2
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR2'
         DC    CL8'TSODEST2'
         DC    CL8'TSONAM02'
         DC    CL8'TSOSIZ02'
         DC    CL8'TSOUNT02'
         DC    CL8'TSONAM12'
         DC    CL8'TSOSIZ12'
         DC    CL8'TSOUNT12'
         DC    CL8'TSONAM22'
         DC    CL8'TSOSIZ22'
         DC    CL8'TSOUNT22'
         DC    CL8'TSOATT02'
         DC    CL8'TSOATT12'
         DC    CL8'TSOATT22'
         DC    CL8'TSOATT32'
NAMLIST3 DS    0F                      NAMES OF EXTENSION VARIABLES 3
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR3'
         DC    CL8'TSODEST3'
         DC    CL8'TSONAM03'
         DC    CL8'TSOSIZ03'
         DC    CL8'TSOUNT03'
         DC    CL8'TSONAM13'
         DC    CL8'TSOSIZ13'
         DC    CL8'TSOUNT13'
         DC    CL8'TSONAM23'
         DC    CL8'TSOSIZ23'
         DC    CL8'TSOUNT23'
         DC    CL8'TSOATT03'
         DC    CL8'TSOATT13'
         DC    CL8'TSOATT23'
         DC    CL8'TSOATT33'
NAMLIST4 DS    0F                      NAMES OF EXTENSION VARIABLES 4
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR4'
         DC    CL8'TSODEST4'
         DC    CL8'TSONAM04'
         DC    CL8'TSOSIZ04'
         DC    CL8'TSOUNT04'
         DC    CL8'TSONAM14'
         DC    CL8'TSOSIZ14'
         DC    CL8'TSOUNT14'
         DC    CL8'TSONAM24'
         DC    CL8'TSOSIZ24'
         DC    CL8'TSOUNT24'
         DC    CL8'TSOATT04'
         DC    CL8'TSOATT14'
         DC    CL8'TSOATT24'
         DC    CL8'TSOATT34'
NAMLIST5 DS    0F                      NAMES OF EXTENSION VARIABLES 5
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR5'
         DC    CL8'TSODEST5'
         DC    CL8'TSONAM05'
         DC    CL8'TSOSIZ05'
         DC    CL8'TSOUNT05'
         DC    CL8'TSONAM15'
         DC    CL8'TSOSIZ15'
         DC    CL8'TSOUNT15'
         DC    CL8'TSONAM25'
         DC    CL8'TSOSIZ25'
         DC    CL8'TSOUNT25'
         DC    CL8'TSOATT05'
         DC    CL8'TSOATT15'
         DC    CL8'TSOATT25'
         DC    CL8'TSOATT35'
NAMLIST6 DS    0F                      NAMES OF EXTENSION VARIABLES 6
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR6'
         DC    CL8'TSODEST6'
         DC    CL8'TSONAM06'
         DC    CL8'TSOSIZ06'
         DC    CL8'TSOUNT06'
         DC    CL8'TSONAM16'
         DC    CL8'TSOSIZ16'
         DC    CL8'TSOUNT16'
         DC    CL8'TSONAM26'
         DC    CL8'TSOSIZ26'
         DC    CL8'TSOUNT26'
         DC    CL8'TSOATT06'
         DC    CL8'TSOATT16'
         DC    CL8'TSOATT26'
         DC    CL8'TSOATT36'
NAMLIST7 DS    0F                      NAMES OF EXTENSION VARIABLES 7
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR7'
         DC    CL8'TSODEST7'
         DC    CL8'TSONAM07'
         DC    CL8'TSOSIZ07'
         DC    CL8'TSOUNT07'
         DC    CL8'TSONAM17'
         DC    CL8'TSOSIZ17'
         DC    CL8'TSOUNT17'
         DC    CL8'TSONAM27'
         DC    CL8'TSOSIZ27'
         DC    CL8'TSOUNT27'
         DC    CL8'TSOATT07'
         DC    CL8'TSOATT17'
         DC    CL8'TSOATT27'
         DC    CL8'TSOATT37'
NAMLIST8 DS    0F                      NAMES OF EXTENSION VARIABLES 8
         DC    F'15'
         DC    F'00'
         DC    CL8'TSOMAXR8'
         DC    CL8'TSODEST8'
         DC    CL8'TSONAM08'
         DC    CL8'TSOSIZ08'
         DC    CL8'TSOUNT08'
         DC    CL8'TSONAM18'
         DC    CL8'TSOSIZ18'
         DC    CL8'TSOUNT18'
         DC    CL8'TSONAM28'
         DC    CL8'TSOSIZ28'
         DC    CL8'TSOUNT28'
         DC    CL8'TSOATT08'
         DC    CL8'TSOATT18'
         DC    CL8'TSOATT28'
         DC    CL8'TSOATT38'
         TITLE 'USRADD1 - LITERAL POOL'
         LTORG
         TITLE 'USRADD1 - DYNAMIC WORK AREA'
***********************************************************************
*  DYNAMIC WORK AREA
***********************************************************************
WORKAREA DSECT
SAVEAREA DS    18F                     PROGRAM SAVE AREA
ISPADDR  DS    A                       ADDRESS OF EP TO ISPLINK
PARMS    DS    7A                      PARM LIST FOR CALL
ADDFLAG  DS    C                       FLAG SET WHEN USER ADDED
SUBCMD2  DS    CL56'CMD(SUBMIT                                         +
                    )'
VERCMD2  DS    CL31'CMD(VERUSGRP 12345678 12345678)'
USERID   DS    CL8                     RACF USER ID
OWNER    DS    CL8                     RACF OWNER
DFLTGRP  DS    CL8                     RACF DFLTGRP
REVOKE   DS    CL8                     RACF REVOKE DATE
RESUME   DS    CL8                     RACF RESUME DATE
AUTHORTY DS    CL8                     RACF AUTHORTY
UACC     DS    CL8                     RACF UACC
NCCFPROF DS    CL8                     NCCF PROFILE NAME
TSONAM0  DS    CL8                     TSO PROC NAME
TSOSIZ0  DS    CL8                     TSO PROC REGION SIZE
TSOUNT0  DS    CL8                     TSO PROC UNIT NAME
TSODEST  DS    CL8                     TSO SYSOUT DESTINATION
TSOMAXR  DS    CL8                     TSO PROC MAXIMUM REGION SIZE
TSOATT0  DS    CL8                     TSO ACCT / NOACCT ATTRIBUTE
TSOATT1  DS    CL8                     TSO JCL / NOJCL ATTRIBUTE
TSOATT2  DS    CL8                     TSO MOUNT / NOMOUNT ATTRIBUTE
TSOATT3  DS    CL8                     TSO OPER / NOOPER ATTRIBUTE
OWNVER   DS    CL8                     VERIFY OWNER AS RACF USER/GROUP
GRPVER   DS    CL8                     VERIFY DFLTGRP AS RACF GROUP
TSOMAXR$ DS    CL8                     MAXIMUM REGION SIZE
TSODEST$ DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM0$ DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ0$ DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT0$ DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM1$ DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ1$ DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT1$ DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM2$ DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ2$ DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT2$ DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT0$ DS    CL8                     OPER / NOOPER
TSOATT1$ DS    CL8                     ACCT / NOACCT
TSOATT2$ DS    CL8                     JCL / NOJCL
TSOATT3$ DS    CL8                     MOUNT / NOMOUNT
TSOMAXR1 DS    CL8                     MAXIMUM REGION SIZE
TSODEST1 DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM01 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ01 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT01 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM11 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ11 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT11 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM21 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ21 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT21 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT01 DS    CL8                     OPER / NOOPER
TSOATT11 DS    CL8                     ACCT / NOACCT
TSOATT21 DS    CL8                     JCL / NOJCL
TSOATT31 DS    CL8                     MOUNT / NOMOUNT
TSOMAXR2 DS    CL8                     MAXIMUM REGION SIZE
TSODEST2 DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM02 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ02 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT02 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM12 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ12 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT12 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM22 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ22 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT22 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT02 DS    CL8                     OPER / NOOPER
TSOATT12 DS    CL8                     ACCT / NOACCT
TSOATT22 DS    CL8                     JCL / NOJCL
TSOATT32 DS    CL8                     MOUNT / NOMOUNT
TSOMAXR3 DS    CL8                     MAXIMUM REGION SIZE
TSODEST3 DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM03 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ03 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT03 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM13 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ13 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT13 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM23 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ23 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT23 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT03 DS    CL8                     OPER / NOOPER
TSOATT13 DS    CL8                     ACCT / NOACCT
TSOATT23 DS    CL8                     JCL / NOJCL
TSOATT33 DS    CL8                     MOUNT / NOMOUNT
TSOMAXR4 DS    CL8                     MAXIMUM REGION SIZE
TSODEST4 DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM04 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ04 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT04 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM14 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ14 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT14 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM24 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ24 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT24 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT04 DS    CL8                     OPER / NOOPER
TSOATT14 DS    CL8                     ACCT / NOACCT
TSOATT24 DS    CL8                     JCL / NOJCL
TSOATT34 DS    CL8                     MOUNT / NOMOUNT
TSOMAXR5 DS    CL8                     MAXIMUM REGION SIZE
TSODEST5 DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM05 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ05 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT05 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM15 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ15 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT15 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM25 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ25 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT25 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT05 DS    CL8                     OPER / NOOPER
TSOATT15 DS    CL8                     ACCT / NOACCT
TSOATT25 DS    CL8                     JCL / NOJCL
TSOATT35 DS    CL8                     MOUNT / NOMOUNT
TSOMAXR6 DS    CL8                     MAXIMUM REGION SIZE
TSODEST6 DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM06 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ06 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT06 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM16 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ16 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT16 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM26 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ26 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT26 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT06 DS    CL8                     OPER / NOOPER
TSOATT16 DS    CL8                     ACCT / NOACCT
TSOATT26 DS    CL8                     JCL / NOJCL
TSOATT36 DS    CL8                     MOUNT / NOMOUNT
TSOMAXR7 DS    CL8                     MAXIMUM REGION SIZE
TSODEST7 DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM07 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ07 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT07 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM17 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ17 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT17 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM27 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ27 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT27 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT07 DS    CL8                     OPER / NOOPER
TSOATT17 DS    CL8                     ACCT / NOACCT
TSOATT27 DS    CL8                     JCL / NOJCL
TSOATT37 DS    CL8                     MOUNT / NOMOUNT
TSOMAXR8 DS    CL8                     MAXIMUM REGION SIZE
TSODEST8 DS    CL8                     TSO DEFAULT SYSOUT DESTINATION
TSONAM08 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ08 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT08 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM18 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ18 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT18 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSONAM28 DS    CL8                     LOGON PROCEDURE NAME
TSOSIZ28 DS    CL8                     REGION SIZE SPECIFIED IN PROC
TSOUNT28 DS    CL8                     ESOTERIC GROUP UNIT NAME
TSOATT08 DS    CL8                     OPER / NOOPER
TSOATT18 DS    CL8                     ACCT / NOACCT
TSOATT28 DS    CL8                     JCL / NOJCL
TSOATT38 DS    CL8                     MOUNT / NOMOUNT
USRADD_  DS    CL8                     GENERIC SKELETON NAME
PANLNAM  DS    CL8                     GENERIC TSO ADD PANEL NAME
NAME     DS    CL20                    USER NAME
LNAME    DS    CL20                    USER LAST NAME
FNAME    DS    CL20                    USER FIRST NAME
RACFATT  DS    0CL72                   NCCF PROFILE (COMMAND AUTHORITY)
RACFATT0 DS    CL12                    RACF SPECIAL / NOSPECIAL ATTR
RACFATT1 DS    CL12                    RACF OPERATIONS / NOOPERATIONS
RACFATT2 DS    CL12                    RACF AUDITOR / NOAUDITOR
RACFATT3 DS    CL12                    RACF ATTRIBUTE
RACFATT4 DS    CL12                    RACF ATTRIBUTE
RACFATT5 DS    CL12                    RACF ATTRIBUTE
USERDATA DS    CL70                    RACF USERDATA
ROOM     DS    CL4                     USER'S ROOM NUMBER
EXTENS   DS    CL4                     USER'S PHONE EXTENSION
REGID    DS    CL4                     REGONAL ID
CNCTGRP1 DS    CL40                    RACF CONNECT GROUP INFO
SELCT    DS    CL1                     DETERMINE NCCF PROFILE
RACF$    DS    CL1                     CREATE RACF PROFILE IN REGION 1
RACF1    DS    CL1                     CREATE RACF PROFILE IN REGION 1
RACF2    DS    CL1                     CREATE RACF PROFILE IN REGION 2
RACF3    DS    CL1                     CREATE RACF PROFILE IN REGION 3
RACF4    DS    CL1                     CREATE RACF PROFILE IN REGION 4
RACF5    DS    CL1                     CREATE RACF PROFILE IN REGION 5
RACF6    DS    CL1                     CREATE RACF PROFILE IN REGION 6
RACF7    DS    CL1                     CREATE RACF PROFILE IN REGION 7
RACF8    DS    CL1                     CREATE RACF PROFILE IN REGION 8
NCCFUSER DS    CL1                     INDICATES ADD NCCF USER
TSOUSER  DS    CL1                     INDICATES ADD TSO USER
TSO$     DS    CL1                     CREATE TSO ACCOUNT REC AT ADMIN
TSO1     DS    CL1                     CREATE TSO ACCOUNT REC IN REG 1
TSO2     DS    CL1                     CREATE TSO ACCOUNT REC IN REG 2
TSO3     DS    CL1                     CREATE TSO ACCOUNT REC IN REG 3
TSO4     DS    CL1                     CREATE TSO ACCOUNT REC IN REG 4
TSO5     DS    CL1                     CREATE TSO ACCOUNT REC IN REG 5
TSO6     DS    CL1                     CREATE TSO ACCOUNT REC IN REG 6
TSO7     DS    CL1                     CREATE TSO ACCOUNT REC IN REG 7
TSO8     DS    CL1                     CREATE TSO ACCOUNT REC IN REG 8
SUB      DS    CL1                     INDICATES REGIONAL JOB TO SUBMIT
TSODEST0 DS    CL14                    TSO ACCOUNT CMD (SYSOUT DEST)
TSOMAXR0 DS    CL14                    TSO ACCOUNT CMD (MAXSIZE)
ZTEMPF   DS    CL44                    FILE TAILORING TEMPORARY FILE
USERMSGS DS    CL24                    SHORT VERSION OF ISPF ERROR MSG
USERMSGL DS    CL78                    LONG VERSION OF ISPF ERROR MSG
ZLLGJOB1 DS    CL80                    JOB CARD 1 FROM OPTION 0.2
ZLLGJOB2 DS    CL80                    JOB CARD 2 FROM OPTION 0.2
ISPFSERV DS    CL8                     ISPF SERVICE ROUTINE ID
ISPFRC   DS    CL2                     ISPF SERVICE ROUTINE RETURN CODE
SAVOWN   DS    CL8                     VERIFY OWNER AS RACF USER/GROUP
SAVGRP   DS    CL8                     VERIFY DFLTGRP AS RACF GROUP
WORKLEN  EQU   *-WORKAREA
         END   USRADD1

         TITLE 'USRUPD3 - DELUXE USER REGISTRATION (UPDATE A USER)'
***********************************************************************
*                                                                     *
*        MODULE NAME = USRUPD3                                        *
*                                                                     *
*        CHANGE ACTIVITY:                                             *
*              06/19/86  WRITTEN.                               JWC.  *
*                                                                     *
***********************************************************************
         EJECT
         TITLE 'USRUPD3 - ISPCALL MACRO'
         MACRO
&LBL     ISPCALL &LIST,        CALL PARAMETERS                         +
               &EP=ISPLINK,                                            +
               &LISTLBL=,      LABEL FOR PARAMETER LIST (NON-REENT)    +
               &EPADDR=,       LABEL FOR ADDRESS OF EP OF ISPLINK      +
               &WKAREA=,       TO BUILD CALL LIST (REENTERANT CODE)    +
               &WKREG=,        WORK REGISTER (DEFAULT 1)               +
               &TRACE=         'OFF' OR BIT FOR TRACE MODE
.*  ONCE WKAREA, WKREG, AND TRACE ARE SPECIFIED, THEY ARE USED IN ALL
.*  SUBSEQUENT OCCURRENCES OF THIS MACRO, UNLESS THE PARAMETER IS
.*  EXPLICITLY CODED.
.*  NOTE: FIRST 4 BYTES OF WKAREA ARE USED TO STORE NUMERIC VALUES,
.*  WHICH ARE PRIMARILY LENGTH FIELDS.
         LCLA  &S,&T,&U,&TRCEMSK
         LCLB  &NUMSW
         LCLC  &NDX,&WKAR,&WKRG,&WKEP
         GBLC  &ISPRREG,&ISPRAR,&ISPTRC1,&ISPEP
         GBLA  &ISPTRC2
&NDX     SETC  '&SYSNDX'
&S       SETA  1               SUBSCRIPT FOR GOING THRU &LIST
***********************************************************************
         AIF   (T'&LBL NE 'O').L1
*                  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
         AGO   .L2
.L1      ANOP
&LBL     DS    0H  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
.L2      ANOP
         AIF   (T'&LIST NE 'O').A1
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE PROVIDED ***'
         AGO   .EXIT
.A1      AIF   ('&LIST'(1,1) EQ '(').CHKTRCE
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE ENCLOSED IN PARENTHES+
               ES ***'
         AGO   .EXIT
.****************** ANALYZE "TRACE" PARAMETER *************************
.CHKTRCE AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' NE '').TRCE4
         AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' EQ '').TRCEOFF
         AIF   ('&TRACE'(1,1) EQ '(').TRCEON
         AIF   ('&TRACE' EQ 'OFF').TRCEOFF
         MNOTE 12,'*** INVALID TRACE PARAMETERS ***'
         AGO   .EXIT
.TRCEON  AIF   (T'&TRACE(2) EQ 'N').TRCE2
.TRCE8   MNOTE 12,'*** TRACE BIT (2ND PARAMETER) MUST BE 0 - 7 ***'
         AGO   .EXIT
.TRCE2   AIF   (&TRACE(2) GE 0 OR &TRACE(2) LE 7).TRCE3
         AGO   .TRCE8
.TRCE3   ANOP
&ISPTRC1 SETC  '&TRACE(1)'     SET GLOBAL VARIABLE
&ISPTRC2 SETA  &TRACE(2)       SET GLOBAL VARIABLE
.TRCE4   ANOP
&U       SETA  0
&TRCEMSK SETA  255
&T       SETA  128
.TRCE5   AIF   (&U GT 7).CHKREG
         AIF   (&ISPTRC2 NE &U).TRCE7
.TRCE6   ANOP
&U       SETA  &U+1
&T       SETA  &T/2
         AGO   .TRCE5
.TRCE7   ANOP
&TRCEMSK SETA  &TRCEMSK-&T
         AGO   .TRCE6
.TRCEOFF ANOP
&ISPTRC1 SETC  ''              SET GLOBAL VARIABLE
.****************** ANALYZE "WKREG" PARAMETER *************************
.CHKREG  AIF   (T'&WKREG EQ 'O').A2
&ISPRREG SETC  '&WKREG'        SET GLOBAL VARIABLE
.A2      AIF   ('&ISPRREG' EQ '').A3
&WKRG    SETC  '&ISPRREG'
         AGO   .CHKAREA
.A3      ANOP
&ISPRREG SETC  '1'             SET GLOBAL VARIABLE
         AGO   .A2
.****************** SEE IF USING PROVIDED WORKAREA ********************
.CHKAREA AIF   (T'&WKAREA NE 'O' OR '&ISPRAR' NE '').RENT
         AIF   (T'&LISTLBL EQ 'O').B1
&WKAR    SETC  '&LISTLBL'
         AGO   .B2
.B1      ANOP
&WKAR    SETC  'ISPC&NDX'      LABEL FOR MACRO WORKAREA
.B2      ANOP
&T       SETA  4*(N'&LIST+1)   LENGTH OF MACRO WORKAREA
         B     &WKAR.+&T             BRANCH AROUND DATA         ISPCALL
&T       SETA  N'&LIST+1
&WKAR    DC    &T.F'0'               PARAMETER LIST             ISPCALL
.******************** BUILD PARAMETER LIST ****************************
.LOOP    AIF   (&S GT N'&LIST).ENDLOOP
         AIF   ('&LIST(&S)'(1,1) EQ '''').C1 TEST FOR LITERAL
         AIF   (T'&LIST(&S) EQ 'N').NUM      TEST FOR NUMERIC
         AIF   ('&LIST(&S)'(1,1) EQ '(').REG TEST FOR REG NOTATION
         LA    &WKRG,&LIST(&S)       LOAD DATA ADDR             ISPCALL
.ST      ANOP
&T       SETA  4*&S
         ST    &WKRG,&WKAR.+&T       STORE IN PARAM LIST        ISPCALL
         AIF   ('&ISPTRC1' EQ '' OR &S GT 1).C3           TRACE
         TM    &ISPTRC1,&TRCEMSK     IS TRACE BIT ON?     TRACE ISPCALL
         BZ    ISPT&NDX                                   TRACE ISPCALL
         AIF   ('&WKRG' EQ '1' OR '&WKRG' EQ 'R1').C4     TRACE
         LR    1,&WKRG               LOAD SRVC NAME ADDR  TRACE ISPCALL
         EJECT
.C4      AIF   ('&LIST(&S)'(1,1) EQ '''').C5 LITERAL?     TRACE
         LA    0,8                   LOAD LENGTH          TRACE ISPCALL
         AGO   .C6                                        TRACE
.C5      ANOP                                             TRACE
&U       SETA  K'&LIST(&S)-2   LENGTH OF SERVICE NAME     TRACE
         LA    0,&U                  LOAD LENGTH          TRACE ISPCALL
.C6      ANOP                                             TRACE
         SVC   93                    ISSUE TPUT SVC       TRACE ISPCALL
ISPT&NDX EQU   *                                          TRACE ISPCALL
.C3      ANOP
&S       SETA  &S+1
         AGO   .LOOP
.C1      AIF   (&S EQ 1).C2    SPF SERVICE NAME - LENGTH IS OK
&T       SETA  K'&LIST(&S)-2
         AIF   (&T GT 7).C2    LENGTH 8 OR GREATER IS OK
&T       SETA  &T+1            ADD FOR ONE BLANK
         LA    &WKRG,=CL&T.&LIST(&S) LOAD DATA ADDR             ISPCALL
         AGO   .ST
.C2      ANOP
         LA    &WKRG,=C&LIST(&S)     LOAD DATA ADDR             ISPCALL
         AGO   .ST
.NUM     AIF   (&NUMSW).NUM2
.*  NOTE: SPF WILL MODIFY LENGTH FIELDS, SO THEY CANNOT BE IN
.*  REENTERANT CODE.
         MVC   &WKAR.(4),=F'&LIST(&S)'                                 +
                                     MOVE NUMERIC VALUE         ISPCALL
&NUMSW   SETB  1
         AGO   .LA
.NUM2    MNOTE 12,'*** ONLY ONE NUMERIC ALLOWED PER ISPCALL MACRO - LIS+
               T ITEM &S --&LIST(&S)-- IS SECOND OCCURRENCE ***'
         AGO   .EXIT
.LA      ANOP
         LA    &WKRG,&WKAR           LOAD DATA ADDR             ISPCALL
         AGO   .ST
.REG     ANOP
&T       SETA  4*&S
         ST    &LIST(&S),&WKAR.+&T                              ISPCALL
         AGO   .C3
.******************** USING PROVIDED WORKAREA *************************
.RENT    AIF   (T'&WKAREA EQ 'O').RENT2
&ISPRAR  SETC  '&WKAREA'       SET GLOBAL VARIABLE
.RENT2   ANOP
&WKAR    SETC  '&ISPRAR'
         AGO   .LOOP
         EJECT
.****************** GENERATE STATEMENTS FOR CALL **********************
.ENDLOOP ANOP
         OI    &WKAR.+&T,X'80'       TURN ON VL BIT             ISPCALL
.*       LA    1,&WKAR.+4                                       ISPCALL
.*       L     15,=V(&EP)                                       ISPCALL
.*       BALR  14,15                                            ISPCALL
         AIF   (T'&EPADDR EQ 'O').EP2
&ISPEP   SETC  '&EPADDR'
         LOAD  EP=ISPLINK
         ST    R0,&ISPEP
.EP2     ANOP
&WKEP    SETC  '&ISPEP'
         L     15,&WKEP
         LA    1,&WKAR.+4
         CALL  (15)
.EXIT    ANOP
***********************************************************************
         SPACE 2
         MEND
         EJECT
         TITLE 'USRUPD3 - INITIALIZATION SECTION'
USRUPD3  CSECT
***********************************************************************
*  INITIALIZATION SECTION - GETMAIN WORKAREA AND SAVE AREA CHAINING
***********************************************************************
         SAVE  (14,12),,USRUPD3_&SYSDATE_&SYSTIME    SAVE REGISTERS
         LR    R12,R15                 LOAD REG 12 WITH ENTRY ADDRESS
         USING USRUPD3,R12             ESTABLISH ADDRESSABILITY TO
*                                      PROGRAM CSECT
         LA    R11,4095(R12)           LOAD REG 11 WITH ENTRY + 4095
         USING USRUPD3+4095,R11        ESTABLISH ADDRESSABILITY TO
*                                      REST OF PROGRAM
         GETMAIN R,LV=WORKLEN          GETMAIN DYNAMIC WORKAREA
         ST    R13,4(R1)               STORE ADDRESS PREVIOUS SAVEAREA
         ST    R1,8(,R13)              STORE ADDRESS OF CURRENT
*                                      SAVEAREA IN PREVIOUS SAVEAREA
         LR    R13,R1                  LOAD REG 13 WITH ADDRESS OF
*                                      CURRENT SAVEAREA
         USING WORKAREA,R13            ESTABLISH ADDRESSABILITY TO
*                                      DYNAMIC WORKAREA
***********************************************************************
*  INITIALIZATION SECTION - SET DIALOG CONTROL, DEFINE VARIABLES
***********************************************************************
CONTROL  EQU   *
*                                      SET DIALOG CONTROL
         ISPCALL ('CONTROL','ERRORS','RETURN'),                        +
               WKAREA=PARMS,                                           +
               EPADDR=ISPADDR
VDEF1    EQU   *
         MVC   ISPFSERV,DEFID          SET ISPF DIALOG SERVICE
*                                      DEFINE VARIABLES
         ISPCALL ('VDEFINE',NAMELST1,USERID,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF2                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF2    EQU   *
         ISPCALL ('VDEFINE',NAMELST2,FNAME,'CHAR',20)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF3                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF3    EQU   *
         ISPCALL ('VDEFINE',NAMELST3,RACFATT0,'CHAR',12)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF4                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF4    EQU   *
         ISPCALL ('VDEFINE',NAMELST4,USERDATA,'CHAR',70)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF5                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF5    EQU   *
         ISPCALL ('VDEFINE',NAMELST5,ROOM,'CHAR',4)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF6                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF6    EQU   *
         ISPCALL ('VDEFINE',NAMELST6,CNCTGRP1,'CHAR',40)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF7                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF7    EQU   *
         ISPCALL ('VDEFINE',NAMELST7,USERMSGS,'CHAR',24)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF8                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF8    EQU   *
         ISPCALL ('VDEFINE',NAMELST8,USERMSGL,'CHAR',78)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF9                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF9    EQU   *
         ISPCALL ('VDEFINE',NAMELST9,UPDCMD,'CHAR',80)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEFA                   YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEFA    EQU   *
         ISPCALL ('VDEFINE',NAMELSTA,RACF$,'CHAR',1)
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF10   EQU   *
         B     TBOPEN                  RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR VDEF)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (NOT VALID FOR VDEF)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  INITIALIZATION SECTION - OPEN FILE TAILORING TABLE (USRUPD)
***********************************************************************
TBOPEN   EQU   *
         MVC   ISPFSERV,OPNID          SET ISPF DIALOG SERVICE
*                                      OPEN A TABLE
         ISPCALL ('TBOPEN','USRUPD','WRITE')
         B     TBOPN10(R15)            CHECK RETURN CODE
TBOPN10  EQU   *
         B     TBBOTTOM                RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBOPEN)
         B     TBCREATE                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  INITIALIZATION SECTION - SET CRP TO BOTTOM OF TABLE (USRUPD)
***********************************************************************
TBBOTTOM EQU   *
         MVC   ISPFSERV,BOTID          SET ISPF DIALOG SERVICE
*                                      SET ROW POINTER TO BOTTOM
         ISPCALL ('TBBOTTOM','USRUPD')
         B     TBBOT10(R15)            CHECK RETURN CODE
TBBOT10  EQU   *
         B     VGET                    RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBBOTTOM)
         B     VGET                    RC = 08 (CONTINUE)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  INITIALIZATION SECTION - CREATE FILE TAILORING TABLE
***********************************************************************
TBCREATE EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
*                                      CREATE A TABLE
         ISPCALL ('TBCREATE','USRUPD',' ',NAMELSTB,'WRITE','REPLACE')
         B     TBCRE10(R15)            CHECK RETURN CODE
TBCRE10  EQU   *
         B     VGET                    RC = 00 (CONTINUE)
         B     VGET                    RC = 04 (CONTINUE)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - RETRIEVE VARIABLES FOR RACF UPDATE
***********************************************************************
VGET     EQU   *
         MVC   ISPFSERV,GETID          SET ISPF DIALOG SERVICE
*                                      RETRIEVE VARIABLES
         ISPCALL ('VGET',NAMELSTX)
         B     VGET10(R15)             CHECK RETURN CODE
VGET10   EQU   *
         B     BLDRAC                  RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR VGET)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (NOT VALID FOR VGET)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - BUILD RACF COMMANDS TO UPDATE USER PROFILE
***********************************************************************
BLDRAC   EQU   *
         MVC   RTFLAG,RACF             INDICATES RACF CMD PROCESSING
         MVC   EXTENS,UPDEXT           UPDATE EXTENSION
         CLC   FNAME,UPDFNAM           UPDATE FIRST NAME?
         BE    BLDRAC10                NO, CHECK LAST NAME
         MVC   FNAME,UPDFNAM           YES, UPDATE FNAME
         CLC   LNAME,UPDLNAM           UPDATE LAST NAME?
         BE    BLDRAC20                NO, BUILD NAME
         MVC   LNAME,UPDLNAM           YES, UPDATE LNAME
         B     BLDRAC20                BUILD NAME
BLDRAC10 EQU   *
         CLC   LNAME,UPDLNAM           UPDATE LAST NAME?
         BE    BLDRAC70                NO, CHECK OWNER CHANGE
         MVC   LNAME,UPDLNAM           YES, UPDATE LNAME
BLDRAC20 EQU   *
         MVC   NAME,FNAME              MOVE FNAME TO NAME
         LA    R3,NAME                 R3 - INDEX THROUGH NAME
         LA    R4,20                   R4 - MAXIMUM LENGTH OF NAME
BLDRAC30 EQU   *
         CLC   0(2,R3),SPACES          END OF NAME?
         BE    BLDRAC40                YES, ADD LAST NAME
         LA    R3,1(R3)                INCREMENT R3
         BCT   R4,BLDRAC30             CONTINUE
BLDRAC40 EQU   *
         LA    R2,LNAME                R2 - INDEX THROUGH FIRST NAME
         LA    R3,1(R3)                R3 - INDEX THROUGH NAME
         BCTR  R4,0                    DECREMENT R4
BLDRAC50 EQU   *
         CLC   0(1,R2),SPACES          END OF LNAME?
         BE    BLDRAC60                YES, BUILD RACF 'ALTUSER' CMD
         MVC   0(1,R3),0(R2)           MOVE LNAME TO NAME
         LA    R2,1(R2)                INCREMENT R2
         LA    R3,1(R3)                INCREMENT R3
         BCT   R4,BLDRAC50             CONTINUE
BLDRAC60 EQU   *
         MVC   UPDCMD,ALUCMD1          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+25(20),NAME      MOVE NAME TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRAC70 EQU   *
         CLC   OWNER,UPDOWNR           OWNER BEEN UPDATED?
         BE    BLDRAC80                NO, CHECK DFLTGRP CHANGE
         MVC   UPDCMD,ALUCMD2          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+25(8),OWNER      MOVE OWNER TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRAC80 EQU   *
         CLC   DFLTGRP,UPDDFLT         DFLTGRP BEEN UPDATED?
         BE    BLDRAC90                NO, CHECK RACFATT0 CHANGE
         MVC   DFLTGRP,UPDDFLT         YES, UPDATE DFLTGRP
         MVC   UPDCMD,COCMD1           MOVE 'CONNECT' CMD TO UPDCMD
         MVC   UPDCMD+4(8),USERID      MOVE USERID TO 'CONNECT' CMD
         MVC   UPDCMD+20(8),DFLTGRP    MOVE DFLTGRP TO 'CONNECT' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
         MVC   UPDCMD,ALUCMD3          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+27(8),DFLTGRP    MOVE DFLTGRP TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRAC90 EQU   *
         CLC   RACFATT0,UPDRAT0        RACFATT0 BEEN UPDATED?
         BE    BLDRACA0                NO, CHECK RACFATT1 CHANGE
         MVC   UPDCMD,ALUCMD4          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+19(12),RACFATT0  MOVE RACFATT0 TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRACA0 EQU   *
         CLC   RACFATT1,UPDRAT1        RACFATT1 BEEN UPDATED?
         BE    BLDRACB0                NO, CHECK RACFATT2 CHANGE
         MVC   RACFATT1,UPDRAT1        YES, UPDATE RACFATT1
         MVC   UPDCMD,ALUCMD4          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+19(12),RACFATT1  MOVE RACFATT1 TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRACB0 EQU   *
         CLC   RACFATT2,UPDRAT2        RACFATT2 BEEN UPDATED?
         BE    BLDRACC0                NO, CHECK REVOKE CHANGE
         MVC   RACFATT2,UPDRAT2        YES, UPDATE RACFATT2
         MVC   UPDCMD,ALUCMD4          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+19(12),RACFATT2  MOVE RACFATT2 TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRACC0 EQU   *
         CLC   UPDREV,REVOKE           REVOKE DATE UPDATED?
         BE    BLDRACD0                NO, CHECK RESUME DATE
         CLC   UPDREV,SPACES           REVOKE DATE ENTERED?
         BNE   BLDRC10                 YES, SET UP ALTUSER COMMAND
         MVC   REVOKE,NONE             YES, UPDATE REVOKE
         MVC   RACFATT3,REVOKED        YES, UPDATE RACFATT3
         MVC   UPDCMD,ALUCMD8          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
         B     BLDRACD0                CHECK RESUME DATE
BLDRC10  EQU   *
         MVC   REVOKE,UPDREV           YES, UPDATE REVOKE
         MVC   UPDCMD,ALUCMD5          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+26(8),REVOKE     MOVE REVOKE TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRACD0 EQU   *
         CLC   UPDRES,RESUME           RESUME DATE UPDATED?
         BE    BLDRACE0                NO, CHECK USERDATA
         CLC   UPDRES,SPACES           RESUME DATE ENTERED?
         BNE   BLDRD10                 YES, SET UP ALTUSER COMMAND
         MVC   RESUME,NONE             YES, UPDATE RESUME
         MVC   RACFATT3,SPACES         YES, UPDATE RACFATT3
         MVC   UPDCMD,ALUCMD9          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
         B     BLDRACE0                CHECK USERDATA
BLDRD10  EQU   *
         MVC   RESUME,UPDRES           YES, UPDATE RESUME
         MVC   UPDCMD,ALUCMD6          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+9(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+26(8),RESUME     MOVE RESUME TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRACE0 EQU   *
         CLC   USERDATA,UPDDATA        USERDATA BEEN UPDATED?
         BE    BLDRACF0                NO, CHECK CNCTGRP1 CHANGE
         MVC   USERDATA,UPDDATA        YES, UPDATE USERDATA
         CLC   USERDATA(5),ROOM#       ROOM BEEN UPDATED?
         BNE   BLDRE10                 NO, SET UP ALTUSER COMMAND
         MVC   ROOM,USERDATA+5         UPDATE ROOM
BLDRE10  EQU   *
         MVC   UPDCMD,ALUCMD7          MOVE 'ALTUSER' CMD TO UPDCMD
         MVC   UPDCMD+5(8),USERID      MOVE USERID TO 'ALTUSER' CMD
         MVC   UPDCMD+21(54),USERDATA  MOVE USERDATA TO 'ALTUSER' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRACF0 EQU   *
         LA    R2,UPDCGRP1             R2 - INDEX THRU UPDCGRP'S
         LA    R3,CNCTGRP1             R3 - INDEX THRU CNCTGRP'S
         LA    R4,15                   R4 - MAX NUMBER OF CNCTGRPS
BLDRACG0 EQU   *
         CLC   0(40,R3),0(R2)          CONNECT GROUP INFO UPDATED?
         BE    BLDRACH0                NO, CHECK NEXT CONNECT GROUP
         CLC   0(8,R2),SPACES          CONNECT GROUP REMOVED?
         BNE   BLDRG10                 NO, CHECK FOR CHANGE
         MVC   UPDCMD,RECMD1           MOVE 'REMOVE' CMD TO UPDCMD
         MVC   UPDCMD+8(8),USERID      MOVE USERID TO 'REMOVE' CMD
         MVC   UPDCMD+24(8),0(R3)      MOVE GROUP TO 'REMOVE' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
         B     BLDRACH0                CHECK NEXT CONNECT GROUP
BLDRG10  EQU   *
         CLC   0(8,R3),0(R2)           CONNECT GROUP CHANGED?
         BE    BLDRG20                 NO, SET UP COCMD2
         CLC   0(8,R3),SPACES          CONNECT GROUP ADDED?
         BE    BLDRG20                 YES, SET UP COCMD2
         MVC   UPDCMD,RECMD1           MOVE 'REMOVE' CMD TO UPDCMD
         MVC   UPDCMD+8(8),USERID      MOVE USERID TO 'REMOVE' CMD
         MVC   UPDCMD+24(8),0(R3)      MOVE GROUP TO 'REMOVE' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRG20  EQU   *
         MVC   UPDCMD,COCMD2           MOVE 'CONNECT' CMD TO UPDCMD
         MVC   UPDCMD+4(8),USERID      MOVE USERID TO 'CONNECT' CMD
         MVC   UPDCMD+20(8),0(R2)      MOVE GROUP TO 'CONNECT' CMD
         MVC   UPDCMD+52(7),8(R2)      MOVE AUTHORITY TO 'CONNECT' CMD
         MVC   UPDCMD+66(7),16(R2)     MOVE UACC TO 'CONNECT' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
         CLC   24(8,R2),24(R3)         REVOKE DATE UPDATED?
         BE    BLDRG30                 NO, CHECK FOR NEW CONNECT GROUP
         CLC   24(8,R2),SPACES         REVOKE DATE ENTERED?
         BNE   BLDRG40                 YES, SET UP CONNECT COMMAND
         MVC   24(8,R2),NONE           UPDATE REVOKE DATE
         MVC   UPDCMD,COCMD5           MOVE 'CONNECT' CMD TO UPDCMD
         MVC   UPDCMD+4(8),USERID      MOVE USERID TO 'CONNECT' CMD
         MVC   UPDCMD+20(8),0(R2)      MOVE GROUP TO 'CONNECT' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
         B     BLDRG50                 CHECK RESUME DATE
BLDRG30  EQU   *
         CLC   0(8,R3),SPACES          CONNECT GROUP ADDED?
         BNE   BLDRG50                 NO, CHECK RESUME DATE
         MVC   24(8,R2),NONE           UPDATE REVOKE DATE
         B     BLDRG50                 CHECK RESUME DATE
BLDRG40  EQU   *
         MVC   UPDCMD,COCMD3           MOVE 'CONNECT' CMD TO UPDCMD
         MVC   UPDCMD+4(8),USERID      MOVE USERID TO 'CONNECT' CMD
         MVC   UPDCMD+20(8),0(R2)      MOVE GROUP TO 'CONNECT' CMD
         MVC   UPDCMD+49(8),24(R2)     MOVE REVOKE TO 'CONNECT' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRG50  EQU   *
         CLC   32(8,R2),32(R3)         RESUME DATE UPDATED?
         BE    BLDRG60                 NO, CHECK FOR NEW CONNECT GROUP
         CLC   32(8,R2),SPACES         RESUME DATE ENTERED?
         BNE   BLDRG70                 YES, SET UP CONNECT COMMAND
         MVC   32(8,R2),NONE           UPDATE RESUME DATE
         MVC   UPDCMD,COCMD6           MOVE 'CONNECT' CMD TO UPDCMD
         MVC   UPDCMD+4(8),USERID      MOVE USERID TO 'CONNECT' CMD
         MVC   UPDCMD+20(8),0(R2)      MOVE GROUP TO 'CONNECT' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
         B     BLDRACH0                CHECK NEXT CONNECT GROUP
BLDRG60  EQU   *
         CLC   0(8,R3),SPACES          CONNECT GROUP ADDED?
         BNE   BLDRACH0                NO, CHECK NEXT CONNECT GROUP
         MVC   32(8,R2),NONE           UPDATE RESUME DATE
         B     BLDRACH0                CHECK NEXT CONNECT GROUP
BLDRG70  EQU   *
         MVC   UPDCMD,COCMD4           MOVE 'CONNECT' CMD TO UPDCMD
         MVC   UPDCMD+4(8),USERID      MOVE USERID TO 'CONNECT' CMD
         MVC   UPDCMD+20(8),0(R2)      MOVE GROUP TO 'CONNECT' CMD
         MVC   UPDCMD+49(8),32(R2)     MOVE RESUME TO 'CONNECT' CMD
         BAL   R8,TBADD                ADD RECORD TO TABLE
BLDRACH0 EQU   *
         LA    R2,40(R2)               R2 - INDEX THRU UPDCGRP'S
         LA    R3,40(R3)               R3 - INDEX THRU CNCTGRP'S
         BCT   R4,BLDRACG0             CONTINUE WITH NEXT GROUP
BLDRACI0 EQU   *
         LA    R2,CNCTGRP1             R2 - INDEX THRU CNCTGRP'S
         LA    R3,15                   R3 - MAX NUMBER OF CNCTGRP'S
BLDRI10  EQU   *
         MVC   0(40,R2),SPACES         INITIALIZE CNCTGRP
         LA    R2,40(R2)               INCREMENT R2
         BCT   R3,BLDRI10              CONTINUE
         LA    R2,CNCTGRP1             R2 - INDEX THRU CNCTGRP'S
         LA    R3,UPDCGRP1             R3 - INDEX THRU UPDCGRP'S
         LA    R4,15                   R4 - MAX NUMBER OF CNCTGRP'S
BLDRI20  EQU   *
         CLC   0(8,R3),SPACES          CONNECT GROUP REMOVED?
         BE    BLDRI30                 YES, DON'T UPDATE CNCTGRP
         MVC   0(40,R2),0(R3)          UPDATE CNCTGRP
         LA    R2,40(R2)               INCREMENT R2
BLDRI30  EQU   *
         LA    R3,40(R3)               INCREMENT R3
         BCT   R4,BLDRI20              CONTINUE
***********************************************************************
*  PROCESSING SECTION - UPDATE VARIABLES IN POOL
***********************************************************************
VPUT     EQU   *
         MVC   ISPFSERV,PUTID          SET ISPF DIALOG SERVICE
*                                      UPDATE VARIABLES IN POOL
         ISPCALL ('VPUT',NAMELSTY)
         B     VPUT10(R15)             CHECK RETURN CODE
VPUT10   EQU   *
         B     TBCLOSE                 RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR VPUT)
         B     USRERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (NOT VALID FOR VPUT)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - CLOSE FILE TAILORING TABLE (USRUPD)
***********************************************************************
TBCLOSE  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
*                                      CLOSE AND SAVE TABLE
         ISPCALL ('TBCLOSE','USRUPD','REPLCOPY')
         B     TBCLO10(R15)            CHECK RETURN CODE
TBCLO10  EQU   *
         B     FINISH                  RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBCLOSE)
         B     USRERR08                RC = 08 (NOT VALID FOR TBCLOSE)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
***********************************************************************
*  PROCESSING SECTION - ADD A RECORD TO FILE TAILORING TABLE
***********************************************************************
TBADD    EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
*                                      ADD A RECORD TO THE TABLE
         ISPCALL ('TBADD','USRUPD')
         B     TBADD10(R15)            CHECK RETURN CODE
TBADD10  EQU   *
         B     TBADD20                 RC = 00 (CONTINUE)
         B     USRERR04                RC = 04 (NOT VALID FOR TBADD)
         B     USRERR08                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     USRERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     USRERR20                RC = 20 (DISPLAY PANEL / MSG)
TBADD20  EQU   *
         BR    R8                      RETURN
         TITLE 'USRUPD3 - ERROR PROCESSING SECTION'
***********************************************************************
*  ERROR PROCESSING SECTION
***********************************************************************
USRERR04 EQU   *
         MVC   ISPFRC,FOUR             SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
USRERR08 EQU   *
         MVC   ISPFRC,EIGHT            SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
USRERR12 EQU   *
         MVC   ISPFRC,TWELVE           SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
USRERR16 EQU   *
         MVC   ISPFRC,SIXTEEN          SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
USRERR20 EQU   *
         MVC   ISPFRC,TWENTY           SET RETURN CODE
         B     MSGDISP1                DISPLAY PANEL WITH MESSAGE
MSGDISP1 EQU   *
         MVC   USERMSGS,USERERRS       SET SHORT MESSAGE
         MVC   USERMSGL,USERERRL       SET LONG MESSAGE
         MVC   USERMSGL+21(8),ISPFSERV    SET ISPF DIALOG SERVICE
         MVC   USERMSGL+47(2),ISPFRC   SET DIALOG SERVICE RETURN CODE
*                                      DISPLAY SELECTION PANEL
         ISPCALL ('DISPLAY','USRUPD3A',USERMSG)
         B     FINISH
         TITLE 'USRUPD3 - CLOSING SECTION'
***********************************************************************
*  CLOSING SECTION - FREE GETMAINED AREA, SET RETURN CODE RESTORE REGS
***********************************************************************
FINISH   EQU   *
         LA    R0,WORKLEN              R0 - LENGTH OF WORKAREA
         LR    R1,R13                  R1 - ADDRESS OF WORKAREA
         L     R13,4(R13)              R13 - ADDR CALLER'S SAVE AREA
         FREEMAIN R,LV=(0),A=(1)       FREE GETMAINED VIRTUAL STORAGE
         RETURN (14,12),RC=(15)        RESTORE REGISTERS AND RETURN
         TITLE 'USRUPD3 - REGISTER EQUATES'
***********************************************************************
*  REGISTER EQUATES
***********************************************************************
         EQUATE
         TITLE 'USRUPD3 - DATA CONSTANTS'
***********************************************************************
*  CONSTANTS
***********************************************************************
SPACES   DC    CL80' '                 SPACES
FOUR     DC    CL2'04'                 RETURN CODE OF '04'
EIGHT    DC    CL2'08'                 RETURN CODE OF '08'
TWELVE   DC    CL2'12'                 RETURN CODE OF '12'
SIXTEEN  DC    CL2'16'                 RETURN CODE OF '16'
TWENTY   DC    CL2'20'                 RETURN CODE OF '20'
RACF     DC    CL1'R'                  INDICATES RACF COMMAND
ROOM#    DC    C'ROOM='                USED WITH REVOKE & RESUME
NONE     DC    CL8'NONE'               USED WITH REVOKE & RESUME
REVOKED  DC    CL12'REVOKED'           RACFATT3 VALUE IF USER REVOKED
USERMSG  DC    CL8'USER000'            GENERIC USER MESSAGE
ADDID    DC    CL8'TBADD'              ISPF DIALOG SERVICE (TBADD)
CLOID    DC    CL8'TBCLOSE'            ISPF DIALOG SERVICE (TBCLOSE)
CREID    DC    CL8'TBCREATE'           ISPF DIALOG SERVICE (TBCREATE)
DEFID    DC    CL8'VDEFINE'            ISPF DIALOG SERVICE (VDEFINE)
GETID    DC    CL8'VGET'               ISPF DIALOG SERVICE (VGET)
OPNID    DC    CL8'TBOPEN'             ISPF DIALOG SERVICE (TBOPEN)
PUTID    DC    CL8'VPUT'               ISPF DIALOG SERVICE (VPUT)
BOTID    DC    CL8'TBBOTTOM'           ISPF DIALOG SERVICE (TBBOTTOM)
USERERRS DC    CL24'USRUPD3 Program Error. '
USERERRL DC    CL78'ISPF Dialog Service, 12345678, Ended with RC = 00. +
               Notify Systems Programming.'
ALUCMD1  DC    CL80'ALTUSER (12345678) NAME(''123456789.123456789.'')  +
                                              '
ALUCMD2  DC    CL80'ALTUSER (12345678) OWNER(12345678)                 +
                                            '
ALUCMD3  DC    CL80'ALTUSER (12345678) DFLTGRP(12345678)               +
                                            '
ALUCMD4  DC    CL80'ALTUSER (12345678) 123456789.12                    +
                                            '
ALUCMD5  DC    CL80'ALTUSER (12345678) REVOKE(12345678)                +
                                            '
ALUCMD6  DC    CL80'ALTUSER (12345678) RESUME(12345678)                +
                                            '
ALUCMD7  DC    CL80'ALU (12345678) DATA(''123456789.123456789.123456789+
               .123456789.123456789.1234'')   '
ALUCMD8  DC    CL80'ALTUSER (12345678) REVOKE                          +
                                            '
ALUCMD9  DC    CL80'ALTUSER (12345678) RESUME                          +
                                            '
COCMD1   DC    CL80'CO (12345678) GROUP(12345678) OWNER(SYS1)          +
                                            '
COCMD2   DC    CL80'CO (12345678) GROUP(12345678) OWNER(SYS1) AUTHORITY+
               (1234567) UACC(1234567)      '
COCMD3   DC    CL80'CO (12345678) GROUP(12345678) OWNER(SYS1) REVOKE(12+
               345678)                      '
COCMD4   DC    CL80'CO (12345678) GROUP(12345678) OWNER(SYS1) RESUME(12+
               345678)                      '
COCMD5   DC    CL80'CO (12345678) GROUP(12345678) OWNER(SYS1) REVOKE   +
                                            '
COCMD6   DC    CL80'CO (12345678) GROUP(12345678) OWNER(SYS1) RESUME   +
                                            '
RECMD1   DC    CL80'REMOVE (12345678) GROUP(12345678)                  +
                                            '
NAMELST1 DS    0F                      NAMES OF VARIABLES (LENGTH 8)
         DC    F'09'
         DC    F'00'
         DC    CL8'USERID'
         DC    CL8'OWNER'
         DC    CL8'UPDOWNR'
         DC    CL8'DFLTGRP'
         DC    CL8'UPDDFLT'
         DC    CL8'REVOKE'
         DC    CL8'UPDREV'
         DC    CL8'RESUME'
         DC    CL8'UPDRES'
NAMELST2 DS    0F                      NAMES OF VARIABLES (LENGTH 20)
         DC    F'05'
         DC    F'00'
         DC    CL8'FNAME'
         DC    CL8'UPDFNAM'
         DC    CL8'LNAME'
         DC    CL8'UPDLNAM'
         DC    CL8'NAME'
NAMELST3 DS    0F                      NAMES OF VARIABLES (LENGTH 12)
         DC    F'07'
         DC    F'00'
         DC    CL8'RACFATT0'
         DC    CL8'UPDRAT0'
         DC    CL8'RACFATT1'
         DC    CL8'UPDRAT1'
         DC    CL8'RACFATT2'
         DC    CL8'UPDRAT2'
         DC    CL8'RACFATT3'
NAMELST4 DS    0F                      NAMES OF VARIABLES (LENGTH 70)
         DC    F'02'
         DC    F'00'
         DC    CL8'USERDATA'
         DC    CL8'UPDDATA'
NAMELST5 DS    0F                      NAMES OF VARIABLES (LENGTH 4)
         DC    F'04'
         DC    F'00'
         DC    CL8'ROOM'
         DC    CL8'UPDROOM'
         DC    CL8'EXTENS'
         DC    CL8'UPDEXT'
NAMELST6 DS    0F                      NAMES OF VARIABLES (LENGTH 40)
         DC    F'30'
         DC    F'00'
         DC    CL8'CNCTGRP1'
         DC    CL8'CNCTGRP2'
         DC    CL8'CNCTGRP3'
         DC    CL8'CNCTGRP4'
         DC    CL8'CNCTGRP5'
         DC    CL8'CNCTGRP6'
         DC    CL8'CNCTGRP7'
         DC    CL8'CNCTGRP8'
         DC    CL8'CNCTGRP9'
         DC    CL8'CNCTGRPA'
         DC    CL8'CNCTGRPB'
         DC    CL8'CNCTGRPC'
         DC    CL8'CNCTGRPD'
         DC    CL8'CNCTGRPE'
         DC    CL8'CNCTGRPF'
         DC    CL8'UPDCGRP1'
         DC    CL8'UPDCGRP2'
         DC    CL8'UPDCGRP3'
         DC    CL8'UPDCGRP4'
         DC    CL8'UPDCGRP5'
         DC    CL8'UPDCGRP6'
         DC    CL8'UPDCGRP7'
         DC    CL8'UPDCGRP8'
         DC    CL8'UPDCGRP9'
         DC    CL8'UPDCGRPA'
         DC    CL8'UPDCGRPB'
         DC    CL8'UPDCGRPC'
         DC    CL8'UPDCGRPD'
         DC    CL8'UPDCGRPE'
         DC    CL8'UPDCGRPF'
NAMELST7 DS    0F                      NAMES OF VARIABLES (LENGTH 24)
         DC    F'01'
         DC    F'00'
         DC    CL8'USERMSGS'
NAMELST8 DS    0F                      NAMES OF VARIABLES (LENGTH 78)
         DC    F'01'
         DC    F'00'
         DC    CL8'USERMSGL'
NAMELST9 DS    0F                      NAMES OF VARIABLES (LENGTH 80)
         DC    F'01'
         DC    F'00'
         DC    CL8'UPDCMD'
NAMELSTA DS    0F                      NAMES OF VARIABLES (LENGTH 1)
         DC    F'10'
         DC    F'00'
         DC    CL8'RACF$'
         DC    CL8'RACF1'
         DC    CL8'RACF2'
         DC    CL8'RACF3'
         DC    CL8'RACF4'
         DC    CL8'RACF5'
         DC    CL8'RACF6'
         DC    CL8'RACF7'
         DC    CL8'RACF8'
         DC    CL8'RTFLAG'
NAMELSTB DS    0F                      NAMES OF FT TABLE VARIABLES
         DC    F'11'
         DC    F'00'
         DC    CL8'UPDCMD'
         DC    CL8'RACF$'
         DC    CL8'RACF1'
         DC    CL8'RACF2'
         DC    CL8'RACF3'
         DC    CL8'RACF4'
         DC    CL8'RACF5'
         DC    CL8'RACF6'
         DC    CL8'RACF7'
         DC    CL8'RACF8'
         DC    CL8'RTFLAG'
NAMELSTX DS    0F                      NAMES OF VGET VARIABLES
         DC    F'66'
         DC    F'00'
         DC    CL8'USERID'
         DC    CL8'FNAME'
         DC    CL8'UPDFNAM'
         DC    CL8'LNAME'
         DC    CL8'UPDLNAM'
         DC    CL8'NAME'
         DC    CL8'OWNER'
         DC    CL8'UPDOWNR'
         DC    CL8'DFLTGRP'
         DC    CL8'UPDDFLT'
         DC    CL8'RACFATT0'
         DC    CL8'UPDRAT0'
         DC    CL8'RACFATT1'
         DC    CL8'UPDRAT1'
         DC    CL8'RACFATT2'
         DC    CL8'UPDRAT2'
         DC    CL8'RACFATT3'
         DC    CL8'REVOKE'
         DC    CL8'UPDREV'
         DC    CL8'RESUME'
         DC    CL8'UPDRES'
         DC    CL8'USERDATA'
         DC    CL8'UPDDATA'
         DC    CL8'CNCTGRP1'
         DC    CL8'UPDCGRP1'
         DC    CL8'CNCTGRP2'
         DC    CL8'UPDCGRP2'
         DC    CL8'CNCTGRP3'
         DC    CL8'UPDCGRP3'
         DC    CL8'CNCTGRP4'
         DC    CL8'UPDCGRP4'
         DC    CL8'CNCTGRP5'
         DC    CL8'UPDCGRP5'
         DC    CL8'CNCTGRP6'
         DC    CL8'UPDCGRP6'
         DC    CL8'CNCTGRP7'
         DC    CL8'UPDCGRP7'
         DC    CL8'CNCTGRP8'
         DC    CL8'UPDCGRP8'
         DC    CL8'CNCTGRP9'
         DC    CL8'UPDCGRP9'
         DC    CL8'CNCTGRPA'
         DC    CL8'UPDCGRPA'
         DC    CL8'CNCTGRPB'
         DC    CL8'UPDCGRPB'
         DC    CL8'CNCTGRPC'
         DC    CL8'UPDCGRPC'
         DC    CL8'CNCTGRPD'
         DC    CL8'UPDCGRPD'
         DC    CL8'CNCTGRPE'
         DC    CL8'UPDCGRPE'
         DC    CL8'CNCTGRPF'
         DC    CL8'UPDCGRPF'
         DC    CL8'RACF$'
         DC    CL8'RACF1'
         DC    CL8'RACF2'
         DC    CL8'RACF3'
         DC    CL8'RACF4'
         DC    CL8'RACF5'
         DC    CL8'RACF6'
         DC    CL8'RACF7'
         DC    CL8'RACF8'
         DC    CL8'EXTENS'
         DC    CL8'UPDEXT'
         DC    CL8'ROOM'
         DC    CL8'UPDROOM'
NAMELSTY DS    0F                      NAMES OF VPUT VARIABLES
         DC    F'39'
         DC    F'00'
         DC    CL8'USERID'
         DC    CL8'FNAME'
         DC    CL8'LNAME'
         DC    CL8'NAME'
         DC    CL8'OWNER'
         DC    CL8'DFLTGRP'
         DC    CL8'RACFATT0'
         DC    CL8'RACFATT1'
         DC    CL8'RACFATT2'
         DC    CL8'RACFATT3'
         DC    CL8'REVOKE'
         DC    CL8'RESUME'
         DC    CL8'USERDATA'
         DC    CL8'CNCTGRP1'
         DC    CL8'CNCTGRP2'
         DC    CL8'CNCTGRP3'
         DC    CL8'CNCTGRP4'
         DC    CL8'CNCTGRP5'
         DC    CL8'CNCTGRP6'
         DC    CL8'CNCTGRP7'
         DC    CL8'CNCTGRP8'
         DC    CL8'CNCTGRP9'
         DC    CL8'CNCTGRPA'
         DC    CL8'CNCTGRPB'
         DC    CL8'CNCTGRPC'
         DC    CL8'CNCTGRPD'
         DC    CL8'CNCTGRPE'
         DC    CL8'CNCTGRPF'
         DC    CL8'RACF$'
         DC    CL8'RACF1'
         DC    CL8'RACF2'
         DC    CL8'RACF3'
         DC    CL8'RACF4'
         DC    CL8'RACF5'
         DC    CL8'RACF6'
         DC    CL8'RACF7'
         DC    CL8'RACF8'
         DC    CL8'EXTENS'
         DC    CL8'ROOM'
         TITLE 'USRUPD3 - LITERAL POOL'
         LTORG
         TITLE 'USRUPD3 - DYNAMIC WORK AREA'
***********************************************************************
*  DYNAMIC WORK AREA
***********************************************************************
WORKAREA DSECT
SAVEAREA DS    18F                     PROGRAM SAVE AREA
ISPADDR  DS    A                       ADDRESS OF EP TO ISPLINK
PARMS    DS    7A                      PARM LIST FOR CALL
USERID   DS    CL8                     RACF USER ID
OWNER    DS    CL8                     RACF OWNER
UPDOWNR  DS    CL8                     RACF OWNER
DFLTGRP  DS    CL8                     RACF DFLTGRP
UPDDFLT  DS    CL8                     RACF DFLTGRP
REVOKE   DS    CL8                     RACF REVOKE DATE
UPDREV   DS    CL8                     RACF REVOKE DATE
RESUME   DS    CL8                     RACF RESUME DATE
UPDRES   DS    CL8                     RACF RESUME DATE
CNCTGRP1 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP1    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH1   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC1   DS    CL8                     USER'S CONNECT GROUP UACC
CREV1    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES1    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRP2 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP2    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH2   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC2   DS    CL8                     USER'S CONNECT GROUP UACC
CREV2    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES2    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRP3 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP3    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH3   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC3   DS    CL8                     USER'S CONNECT GROUP UACC
CREV3    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES3    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRP4 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP4    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH4   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC4   DS    CL8                     USER'S CONNECT GROUP UACC
CREV4    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES4    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRP5 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP5    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH5   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC5   DS    CL8                     USER'S CONNECT GROUP UACC
CREV5    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES5    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRP6 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP6    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH6   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC6   DS    CL8                     USER'S CONNECT GROUP UACC
CREV6    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES6    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRP7 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP7    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH7   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC7   DS    CL8                     USER'S CONNECT GROUP UACC
CREV7    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES7    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRP8 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP8    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH8   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC8   DS    CL8                     USER'S CONNECT GROUP UACC
CREV8    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES8    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRP9 DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRP9    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTH9   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACC9   DS    CL8                     USER'S CONNECT GROUP UACC
CREV9    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRES9    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRPA DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRPA    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTHA   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACCA   DS    CL8                     USER'S CONNECT GROUP UACC
CREVA    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRESA    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRPB DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRPB    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTHB   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACCB   DS    CL8                     USER'S CONNECT GROUP UACC
CREVB    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRESB    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRPC DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRPC    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTHC   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACCC   DS    CL8                     USER'S CONNECT GROUP UACC
CREVC    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRESC    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRPD DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRPD    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTHD   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACCD   DS    CL8                     USER'S CONNECT GROUP UACC
CREVD    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRESD    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRPE DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRPE    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTHE   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACCE   DS    CL8                     USER'S CONNECT GROUP UACC
CREVE    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRESE    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
CNCTGRPF DS    0CL40                   USER'S CONNECT GROUP INFORMATION
CGRPF    DS    CL8                     USER'S CONNECT GROUP NAME
CAUTHF   DS    CL8                     USER'S CONNECT GROUP AUTHORITY
CUACCF   DS    CL8                     USER'S CONNECT GROUP UACC
CREVF    DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
CRESF    DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP1 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP1  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH1 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC1 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV1  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES1  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP2 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP2  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH2 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC2 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV2  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES2  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP3 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP3  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH3 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC3 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV3  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES3  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP4 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP4  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH4 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC4 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV4  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES4  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP5 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP5  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH5 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC5 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV5  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES5  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP6 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP6  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH6 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC6 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV6  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES6  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP7 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP7  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH7 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC7 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV7  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES7  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP8 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP8  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH8 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC8 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV8  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES8  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRP9 DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRP9  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTH9 DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACC9 DS    CL8                     USER'S CONNECT GROUP UACC
UPDREV9  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRES9  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRPA DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRPA  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTHA DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACCA DS    CL8                     USER'S CONNECT GROUP UACC
UPDREVA  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRESA  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRPB DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRPB  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTHB DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACCB DS    CL8                     USER'S CONNECT GROUP UACC
UPDREVB  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRESB  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRPC DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRPC  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTHC DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACCC DS    CL8                     USER'S CONNECT GROUP UACC
UPDREVC  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRESC  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRPD DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRPD  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTHD DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACCD DS    CL8                     USER'S CONNECT GROUP UACC
UPDREVD  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRESD  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRPE DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRPE  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTHE DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACCE DS    CL8                     USER'S CONNECT GROUP UACC
UPDREVE  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRESE  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
UPDCGRPF DS    0CL40                   USER'S CONNECT GROUP NAME
UPDGRPF  DS    CL8                     USER'S CONNECT GROUP NAME
UPDAUTHF DS    CL8                     USER'S CONNECT GROUP AUTHORITY
UPDUACCF DS    CL8                     USER'S CONNECT GROUP UACC
UPDREVF  DS    CL8                     USER'S CONNECT GROUP REVOKE DATE
UPDRESF  DS    CL8                     USER'S CONNECT GROUP RESUME DATE
FNAME    DS    CL20                    USER'S FIRST NAME
UPDFNAM  DS    CL20                    USER'S FIRST NAME
LNAME    DS    CL20                    USER'S LAST NAME
UPDLNAM  DS    CL20                    USER'S LAST NAME
NAME     DS    CL20                    USER'S NAME
RACFATT0 DS    CL12                    SPECIAL / NOSPECIAL RACF ATTR
UPDRAT0  DS    CL12                    SPECIAL / NOSPECIAL RACF ATTR
RACFATT1 DS    CL12                    OPERATIONS / NOOPERATIONS RACF
UPDRAT1  DS    CL12                    OPERATIONS / NOOPERATIONS RACF
RACFATT2 DS    CL12                    AUDITOR / NOAUDITOR RACF ATTR
UPDRAT2  DS    CL12                    AUDITOR / NOAUDITOR RACF ATTR
RACFATT3 DS    CL12                    REVOKED INDICATION
USERDATA DS    CL70                    RACF USER DEFINED DATA
UPDDATA  DS    CL70                    RACF USER DEFINED DATA
ROOM     DS    CL4                     USER'S ROOM NUMBER
UPDROOM  DS    CL4                     USER'S ROOM NUMBER
EXTENS   DS    CL4                     USER'S PHONE EXTENSION
UPDEXT   DS    CL4                     USER'S PHONE EXTENSION
USERMSGS DS    CL24                    SHORT VERSION OF ISPF ERROR MSG
USERMSGL DS    CL78                    LONG VERSION OF ISPF ERROR MSG
UPDCMD   DS    CL80                    UPDATING COMMAND
RACF$    DS    CL1                     ADMIN RACF USER
RACF1    DS    CL1                     REG 1 RACF USER
RACF2    DS    CL1                     REG 2 RACF USER
RACF3    DS    CL1                     REG 3 RACF USER
RACF4    DS    CL1                     REG 4 RACF USER
RACF5    DS    CL1                     REG 5 RACF USER
RACF6    DS    CL1                     REG 6 RACF USER
RACF7    DS    CL1                     REG 7 RACF USER
RACF8    DS    CL1                     REG 8 RACF USER
RTFLAG   DS    CL1                     INDICATES RACF OR TSO COMMAND
ISPFSERV DS    CL8                     ISPF SERVICE ROUTINE ID
ISPFRC   DS    CL2                     ISPF SERVICE ROUTINE RETURN CODE
WORKLEN  EQU   *-WORKAREA
         END   USRUPD3

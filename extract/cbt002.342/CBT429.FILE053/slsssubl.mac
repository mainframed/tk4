         TITLE 'SLSSSUBL - BUILD SLSS SUB LIBRARIES FROM ''MAIN'''
***********************************************************************
*                                                                     *
*        MODULE NAME = SLSSSUBL                                       *
*                                                                     *
*        CHANGE ACTIVITY =                                            *
*              06/15/87  WRITTEN.                               JWC.  *
*                                                                     *
***********************************************************************
         EJECT
         TITLE 'SLSSSUBL - ISPCALL MACRO'
         MACRO
&LBL     ISPCALL &LIST,        CALL PARAMETERS                         +
               &EP=ISPLINK,                                            +
               &LISTLBL=,      LABEL FOR PARAMETER LIST (NON-REENT)    +
               &EPADDR=,       LABEL FOR ADDRESS OF EP OF ISPLINK      +
               &WKAREA=,       TO BUILD CALL LIST (REENTERANT CODE)    +
               &WKREG=,        WORK REGISTER (DEFAULT 1)               +
               &TRACE=         'OFF' OR BIT FOR TRACE MODE
.*  ONCE WKAREA, WKREG, AND TRACE ARE SPECIFIED, THEY ARE USED IN ALL
.*  SUBSEQUENT OCCURRENCES OF THIS MACRO, UNLESS THE PARAMETER IS
.*  EXPLICITLY CODED.
.*  NOTE: FIRST 4 BYTES OF WKAREA ARE USED TO STORE NUMERIC VALUES,
.*  WHICH ARE PRIMARILY LENGTH FIELDS.
         LCLA  &S,&T,&U,&TRCEMSK
         LCLB  &NUMSW
         LCLC  &NDX,&WKAR,&WKRG,&WKEP
         GBLC  &ISPRREG,&ISPRAR,&ISPTRC1,&ISPEP
         GBLA  &ISPTRC2
&NDX     SETC  '&SYSNDX'
&S       SETA  1               SUBSCRIPT FOR GOING THRU &LIST
***********************************************************************
         AIF   (T'&LBL NE 'O').L1
*                  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
         AGO   .L2
.L1      ANOP
&LBL     DS    0H  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
.L2      ANOP
         AIF   (T'&LIST NE 'O').A1
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE PROVIDED ***'
         AGO   .EXIT
.A1      AIF   ('&LIST'(1,1) EQ '(').CHKTRCE
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE ENCLOSED IN PARENTHES+
               ES ***'
         AGO   .EXIT
.****************** ANALYZE "TRACE" PARAMETER *************************
.CHKTRCE AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' NE '').TRCE4
         AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' EQ '').TRCEOFF
         AIF   ('&TRACE'(1,1) EQ '(').TRCEON
         AIF   ('&TRACE' EQ 'OFF').TRCEOFF
         MNOTE 12,'*** INVALID TRACE PARAMETERS ***'
         AGO   .EXIT
.TRCEON  AIF   (T'&TRACE(2) EQ 'N').TRCE2
.TRCE8   MNOTE 12,'*** TRACE BIT (2ND PARAMETER) MUST BE 0 - 7 ***'
         AGO   .EXIT
.TRCE2   AIF   (&TRACE(2) GE 0 OR &TRACE(2) LE 7).TRCE3
         AGO   .TRCE8
.TRCE3   ANOP
&ISPTRC1 SETC  '&TRACE(1)'     SET GLOBAL VARIABLE
&ISPTRC2 SETA  &TRACE(2)       SET GLOBAL VARIABLE
.TRCE4   ANOP
&U       SETA  0
&TRCEMSK SETA  255
&T       SETA  128
.TRCE5   AIF   (&U GT 7).CHKREG
         AIF   (&ISPTRC2 NE &U).TRCE7
.TRCE6   ANOP
&U       SETA  &U+1
&T       SETA  &T/2
         AGO   .TRCE5
.TRCE7   ANOP
&TRCEMSK SETA  &TRCEMSK-&T
         AGO   .TRCE6
.TRCEOFF ANOP
&ISPTRC1 SETC  ''              SET GLOBAL VARIABLE
.****************** ANALYZE "WKREG" PARAMETER *************************
.CHKREG  AIF   (T'&WKREG EQ 'O').A2
&ISPRREG SETC  '&WKREG'        SET GLOBAL VARIABLE
.A2      AIF   ('&ISPRREG' EQ '').A3
&WKRG    SETC  '&ISPRREG'
         AGO   .CHKAREA
.A3      ANOP
&ISPRREG SETC  '1'             SET GLOBAL VARIABLE
         AGO   .A2
.****************** SEE IF USING PROVIDED WORKAREA ********************
.CHKAREA AIF   (T'&WKAREA NE 'O' OR '&ISPRAR' NE '').RENT
         AIF   (T'&LISTLBL EQ 'O').B1
&WKAR    SETC  '&LISTLBL'
         AGO   .B2
.B1      ANOP
&WKAR    SETC  'ISPC&NDX'      LABEL FOR MACRO WORKAREA
.B2      ANOP
&T       SETA  4*(N'&LIST+1)   LENGTH OF MACRO WORKAREA
         B     &WKAR.+&T             BRANCH AROUND DATA         ISPCALL
&T       SETA  N'&LIST+1
&WKAR    DC    &T.F'0'               PARAMETER LIST             ISPCALL
.******************** BUILD PARAMETER LIST ****************************
.LOOP    AIF   (&S GT N'&LIST).ENDLOOP
         AIF   ('&LIST(&S)'(1,1) EQ '''').C1 TEST FOR LITERAL
         AIF   (T'&LIST(&S) EQ 'N').NUM      TEST FOR NUMERIC
         AIF   ('&LIST(&S)'(1,1) EQ '(').REG TEST FOR REG NOTATION
         LA    &WKRG,&LIST(&S)       LOAD DATA ADDR             ISPCALL
.ST      ANOP
&T       SETA  4*&S
         ST    &WKRG,&WKAR.+&T       STORE IN PARAM LIST        ISPCALL
         AIF   ('&ISPTRC1' EQ '' OR &S GT 1).C3           TRACE
         TM    &ISPTRC1,&TRCEMSK     IS TRACE BIT ON?     TRACE ISPCALL
         BZ    ISPT&NDX                                   TRACE ISPCALL
         AIF   ('&WKRG' EQ '1' OR '&WKRG' EQ 'R1').C4     TRACE
         LR    1,&WKRG               LOAD SRVC NAME ADDR  TRACE ISPCALL
         EJECT
.C4      AIF   ('&LIST(&S)'(1,1) EQ '''').C5 LITERAL?     TRACE
         LA    0,8                   LOAD LENGTH          TRACE ISPCALL
         AGO   .C6                                        TRACE
.C5      ANOP                                             TRACE
&U       SETA  K'&LIST(&S)-2   LENGTH OF SERVICE NAME     TRACE
         LA    0,&U                  LOAD LENGTH          TRACE ISPCALL
.C6      ANOP                                             TRACE
         SVC   93                    ISSUE TPUT SVC       TRACE ISPCALL
ISPT&NDX EQU   *                                          TRACE ISPCALL
.C3      ANOP
&S       SETA  &S+1
         AGO   .LOOP
.C1      AIF   (&S EQ 1).C2    SPF SERVICE NAME - LENGTH IS OK
&T       SETA  K'&LIST(&S)-2
         AIF   (&T GT 7).C2    LENGTH 8 OR GREATER IS OK
&T       SETA  &T+1            ADD FOR ONE BLANK
         LA    &WKRG,=CL&T.&LIST(&S) LOAD DATA ADDR             ISPCALL
         AGO   .ST
.C2      ANOP
         LA    &WKRG,=C&LIST(&S)     LOAD DATA ADDR             ISPCALL
         AGO   .ST
.NUM     AIF   (&NUMSW).NUM2
.*  NOTE: SPF WILL MODIFY LENGTH FIELDS, SO THEY CANNOT BE IN
.*  REENTERANT CODE.
         MVC   &WKAR.(4),=F'&LIST(&S)'                                 +
                                     MOVE NUMERIC VALUE         ISPCALL
&NUMSW   SETB  1
         AGO   .LA
.NUM2    MNOTE 12,'*** ONLY ONE NUMERIC ALLOWED PER ISPCALL MACRO - LIS+
               T ITEM &S --&LIST(&S)-- IS SECOND OCCURRENCE ***'
         AGO   .EXIT
.LA      ANOP
         LA    &WKRG,&WKAR           LOAD DATA ADDR             ISPCALL
         AGO   .ST
.REG     ANOP
&T       SETA  4*&S
         ST    &LIST(&S),&WKAR.+&T                              ISPCALL
         AGO   .C3
.******************** USING PROVIDED WORKAREA *************************
.RENT    AIF   (T'&WKAREA EQ 'O').RENT2
&ISPRAR  SETC  '&WKAREA'       SET GLOBAL VARIABLE
.RENT2   ANOP
&WKAR    SETC  '&ISPRAR'
         AGO   .LOOP
         EJECT
.****************** GENERATE STATEMENTS FOR CALL **********************
.ENDLOOP ANOP
         OI    &WKAR.+&T,X'80'       TURN ON VL BIT             ISPCALL
.*       LA    1,&WKAR.+4                                       ISPCALL
.*       L     15,=V(&EP)                                       ISPCALL
.*       BALR  14,15                                            ISPCALL
         AIF   (T'&EPADDR EQ 'O').EP2
&ISPEP   SETC  '&EPADDR'
         LOAD  EP=ISPLINK
         ST    R0,&ISPEP
.EP2     ANOP
&WKEP    SETC  '&ISPEP'
         L     15,&WKEP
         LA    1,&WKAR.+4
         CALL  (15)
.EXIT    ANOP
***********************************************************************
         SPACE 2
         MEND
         EJECT
         TITLE 'SLSSSUBL - INITIALIZATION SECTION'
SLSSSUBL CSECT
SLSSSUBL AMODE ANY
SLSSSUBL RMODE ANY
***********************************************************************
*  INITIALIZATION SECTION - GETMAIN WORKAREA AND SAVE AREA CHAINING
***********************************************************************
         SAVE  (14,12),,SLSSSUBL_&SYSDATE_&SYSTIME   SAVE REGISTERS
         LR    R12,R15                 LOAD REG 12 WITH ENTRY ADDRESS
         USING SLSSSUBL,R12            ESTABLISH ADDRESSABILITY TO
*                                      PROGRAM CSECT
         LA    R11,4095(R12)           LOAD REG 11 WITH ENTRY + 4095
         USING SLSSSUBL+4095,R11       ESTABLISH ADDRESSABILITY TO
*                                      REST OF PROGRAM
         LA    R10,4095(R11)           LOAD REG 11 WITH ENTRY + 4095
         USING SLSSSUBL+8190,R10       ESTABLISH ADDRESSABILITY TO
*                                      REST OF PROGRAM
         GETMAIN R,LV=WORKLEN          GETMAIN DYNAMIC WORKAREA
         ST    R13,4(R1)               STORE ADDRESS PREVIOUS SAVEAREA
         ST    R1,8(,R13)              STORE ADDRESS OF CURRENT
*                                      SAVEAREA IN PREVIOUS SAVEAREA
         LR    R13,R1                  LOAD REG 13 WITH ADDRESS OF
*                                      CURRENT SAVEAREA
         USING WORKAREA,R13            ESTABLISH ADDRESSABILITY TO
*                                      DYNAMIC WORKAREA
***********************************************************************
*  INITIALIZATION SECTION - SET DIALOG CONTROL, DEFINE VARIABLES
***********************************************************************
*                                      SET DIALOG CONTROL
         ISPCALL ('CONTROL','ERRORS','RETURN'),                        +
               WKAREA=PARMS,                                           +
               EPADDR=ISPADDR
VDEF00   EQU   *
         MVC   SLSSERR1,ISPMSG16       INITIALIZE MESSAGE ONE
         MVC   ISPFSERV,DEFID          SET ISPF DIALOG SERVICE
*                                      DEFINE VARIABLES
         ISPCALL ('VDEFINE',NAMELST0,LOC1,'CHAR',8)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF01                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF01   EQU   *
         ISPCALL ('VDEFINE',NAMELST1,ORDSTS,'CHAR',1)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF02                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF02   EQU   *
         ISPCALL ('VDEFINE',NAMELST2,SLSSERR1,'CHAR',62)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF03                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF03   EQU   *
         ISPCALL ('VDEFINE',NAMELST3,NAME1,'CHAR',60)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF04                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF04   EQU   *
         ISPCALL ('VDEFINE',NAMELST4,SUBLIB,'CHAR',4)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF05                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF05   EQU   *
         ISPCALL ('VDEFINE',NAMELST5,LOCID,'CHAR',13)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF06                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF06   EQU   *
         ISPCALL ('VDEFINE',NAMELST6,SLSID,'CHAR',9)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF07                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF07   EQU   *
         ISPCALL ('VDEFINE',NAMELST7,SLSSVER,'CHAR',2)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF08                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF08   EQU   *
         ISPCALL ('VDEFINE',NAMELST8,LSTUTIM,'CHAR',5)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF09                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF09   EQU   *
         ISPCALL ('VDEFINE',NAMELST9,CIBJDATE,'CHAR',6)
         LTR   R15,R15                 DEFINE SUCCESSFUL?
         BZ    VDEF0A                  YES, CONTINUE DEFINE
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF0A   EQU   *
         ISPCALL ('VDEFINE',NAMELSTA,CIBNAME,'CHAR',20)
         B     VDEF10(R15)             CHECK RETURN CODE
VDEF10   EQU   *
         B     VDEF20                  RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR VDEF)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (NOT VALID FOR VDEF)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
VDEF20   EQU   *
         BAL   R4,VGET                 RETRIEVE 'SLSSSAV' VARIABLE
***********************************************************************
*  PROCESSING SECTION - CREATE MEMBER LIBRARY BUILDING TABLE
***********************************************************************
SUBLD000 EQU   *
         MVC   TABLE,MAINMEMS          SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG17       SET SLSSERR1
         LA    R15,4                   SET BRANCH DISPLACEMENT
         BAL   R4,TBCREATE             CREATE MEMBER TABLE
         MVC   TABLE,SLSSCNTL          SET NAME OF TABLE
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   ACCESS,WRITE            SET TABLE OPEN ACCESS
         MVC   SLSSERR1,ISPMSG07       SET SLSSERR1
         BAL   R4,TBOPEN               OPEN TABLE FOR USE
         MVC   SLSSERR1,ISPMSG08       SET SLSSERR1
         BAL   R4,TBTOP                SET ROW POINTER TO TOP OF TABLE
SUBLD010 EQU   *
         MVC   TABLE,SLSSCNTL          SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG08       SET SLSSERR1
         BAL   R4,TBVCLEAR             CLEAR TABLE VARIABLES
         MVC   SLSSWRN1,ISPMSG18       SET SLSSWRN1
         BAL   R4,TBSKIP               MOVE THE ROW POINTER
         C     R15,FULL08              MEMBER LIST FOUND?
         BNE   SUBLD020                YES, CONTINUE
         BAL   R4,TBCLOSE              CLOSE AND SAVE TABLE
         B     SUBLD100                CREATE SUB-LIB BUILDING TABLE
SUBLD020 EQU   *
         CLC   CIBN,MAIN               MAIN LIBRARY?
         BE    SUBLD010                YES, PROCESS NEXT SUB-LIB
         MVC   CIBSRTKY,SPACES         RE-SET LIBRARY SORT KEY
         BAL   R4,TBMOD                UPDATE ROW IN TABLE
         MVC   SUBLIB,CIBN             SET SUB-LIBRARY
         LA    R2,SLB1                 INDEX THROUGH MEMBER NAMES
         LA    R3,120                  MAX NUMBER OF MEMBERS / SUB-LIB
         MVC   TABLE,MAINMEMS          SET NAME OF TABLE
SUBLD030 EQU   *
         CLC   0(8,R2),SPACES          DONE WITH THIS SUB-LIB?
         BE    SUBLD010                YES, PROCESS NEXT SUB-LIB
         MVC   MEMBER,0(R2)            SET MEMBER
         MVC   SLSSERR1,ISPMSG20       SET SLSSERR1
         BAL   R4,TBBOTTOM             SET ROW POINTER TO THE BOTTOM
         MVC   SLSSERR1,ISPMSG20       SET SLSSERR1
         BAL   R4,TBADD                ADD A ROW TO A TABLE
         C     R15,FULL08              ADD OK?
         BNE   SUBLD040                YES, CONTINUE
         B     ISPERR08                DISPLAY ERROR PANEL
SUBLD040 EQU   *
         LA    R2,8(R2)                POINT TO NEXT MEMBER
         BCT   R3,SUBLD030             CONTINUE
         B     SUBLD010                PROCESS NEXT SUB-LIB
***********************************************************************
*  PROCESSING SECTION - CREATE SUB-LIBRARY BUILDING TABLE
***********************************************************************
SUBLD100 EQU   *
         MVC   TABLE,SUBUILD           SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG01       SET SLSSERR1
         LA    R15,0                   SET BRANCH DISPLACEMENT
         BAL   R4,TBCREATE             CREATE SUBUILD TABLE
         MVC   TABLE,MAINLOCS          SET NAME OF TABLE
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   ACCESS,NOWRITE          SET TABLE OPEN ACCESS
         MVC   SLSSERR1,ISPMSG02       SET SLSSERR1
         BAL   R4,TBOPEN               OPEN TABLE FOR USE
         MVC   SLSSERR1,ISPMSG03       SET SLSSERR1
         BAL   R4,TBTOP                SET ROW POINTER TO TOP OF TABLE
SUBLD110 EQU   *
         MVC   TABLE,MAINLOCS          SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG03       SET SLSSERR1
         BAL   R4,TBVCLEAR             CLEAR TABLE VARIABLES
         MVC   SLSSWRN1,ISPMSG04       SET SLSSWRN1
         BAL   R4,TBSKIP               MOVE THE ROW POINTER
         C     R15,FULL08              SUB-LIBRARY LIST FOUND?
         BNE   SUBLD120                YES, CONTINUE
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         B     SUBLD200                BEGIN BUILDING SUB-LIBRARIES
SUBLD120 EQU   *
         MVC   SUBID,LOCID+4           SET MANUAL ID
         LA    R2,LOC1                 INDEX THROUGH MANUAL LOCATIONS
         LA    R3,60                   MAX NUMBER OF LOCATIONS / MANUAL
SUBLD130 EQU   *
         CLC   0(8,R2),SPACES          DONE WITH THIS MANUAL ID?
         BE    SUBLD110                YES, PROCESS NEXT MANUAL ID
         MVC   TABLE,MAINMEMS          SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG21       SET SLSSERR1
         BAL   R4,TBTOP                SET ROW POINTER TO TOP OF TABLE
         BAL   R4,TBVCLEAR             CLEAR TABLE VARIABLES
         MVC   MEMBER,0(R2)            SET MEMBER
         BAL   R4,TBSARG               DEFINE SEARCH ARGUMENT
         BAL   R4,TBSCAN               SEARCH A TABLE
         C     R15,FULL08              MEMBER NAME FOUND?
         BNE   SUBLD140                YES, CONTINUE
         MVC   SLSSERR1,ISPMSG22       SET SLSSERR1
         MVC   SLSSERR1+8(8),MEMBER    IDENTIFY MEMBER NAME
         MVC   SLSSERR1+48(9),SUBID    IDENTIFY MEMBER NAME
         MVC   SLSSERR2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSERR2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSERR2+39(2),EIGHT    IDENTIFY RETURN CODE
         B     ISPERR30                WE'RE DONE
SUBLD140 EQU   *
         MVC   TABLE,SUBUILD           SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG05       SET SLSSERR1
         BAL   R4,TBBOTTOM             SET ROW POINTER TO THE BOTTOM
         MVC   SLSSERR1,ISPMSG05       SET SLSSERR1
         BAL   R4,TBADD                ADD A ROW TO A TABLE
         C     R15,FULL08              ADD OK?
         BNE   SUBLD150                YES, CONTINUE
         B     ISPERR08                DISPLAY ERROR PANEL
SUBLD150 EQU   *
         LA    R2,8(R2)                POINT TO NEXT SUB-LIBRARY
         BCT   R3,SUBLD130             CONTINUE
***********************************************************************
*  PROCESSING SECTION - BUILD SUB-LIBRARIES FROM MAIN LIBRARY
***********************************************************************
SUBLD200 EQU   *
         MVC   TABLE,SUBUILD           SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG06       SET SLSSERR1
         BAL   R4,TBTOP                SET ROW POINTER TO TOP OF TABLE
         MVC   TABLE,MAIN              SET NAME OF TABLE
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   ACCESS,NOWRITE          SET TABLE OPEN ACCESS
         MVC   SLSSERR1,ISPMSG12       SET SLSSERR1
         BAL   R4,TBOPEN               OPEN TABLE FOR USE
         LA    R2,SLSSSAV              ADDR OF SELECTED LIBRARY OR ALL
         CLC   ALL,SLSSSAV             ARE WE BUILDING ALL SUB-LIBS?
         BNE   SUBLD220                NO, DON'T NEED SLSSCNTL
         MVC   TABLE,SLSSCNTL          SET NAME OF TABLE
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   ACCESS,NOWRITE          SET TABLE OPEN ACCESS
         MVC   SLSSERR1,ISPMSG07       SET SLSSERR1
         BAL   R4,TBOPEN               OPEN TABLE FOR USE
         MVC   SLSSERR1,ISPMSG08       SET SLSSERR1
         BAL   R4,TBVCLEAR             CLEAR TABLE VARIABLES
         MVC   CIBN,MAIN               SET CIBN
         BAL   R4,TBSARG               DEFINE SEARCH ARGUMENT
         BAL   R4,TBSCAN               SEARCH A TABLE
         C     R15,FULL08              SUB-LIBRARY LIST FOUND?
         BNE   SUBLD210                YES, CONTINUE
         MVC   SLSSERR1,ISPMSG09       SET SLSSERR1
         MVC   SLSSERR1+19(4),CIBN     IDENTIFY SLSS LIBRARY
         MVC   SLSSERR2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSERR2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSERR2+39(2),EIGHT    IDENTIFY RETURN CODE
         B     ISPERR30                WE'RE DONE
SUBLD210 EQU   *
         LA    R2,SLB1                 INDEX THROUGH SUB-LIBRARIES
         LA    R3,120                  MAX NUMBER OF SUB-LIBRARIES
SUBLD220 EQU   *
         CLC   0(8,R2),SPACES          ARE WE DONE?
         BE    SUBLD280                YES, CLOSE TABLES AND EXIT
         MVC   SLSS,0(R2)              SET SUB-LIBRARY
         MVC   TABLE,SPACES            CLEAR TABLE NAME
         MVC   TABLE(4),0(R2)          SET TABLE NAME
         MVC   SLSSERR1,ISPMSG10       SET SLSSERR1
         MVC   SLSSERR1+17(4),SLSS     MOVE IN LIBRARY NAME
         LA    R15,8                   BRANCH DISPLACEMENT FOR TBCREATE
         BAL   R4,TBCREATE             CREATE NEW SLSS TABLE
         MVC   SLSSPRC1,PMSG1          SET SLSSPRC1
         MVC   SLSSPRC2,PMSG2          SET SLSSPRC2
         MVC   SLSSPRC3,PMSG3          SET SLSSPRC3
         MVC   SLSSPRC4,PMSG4          SET SLSSPRC4
         MVC   SLSSPRC4+25(4),SLSS     MOVE IN LIBRARY NAME
         MVC   SLSSPRC5,PMSG5          SET SLSSPRC5
         MVC   SLSSPRCX,PMSGX          SET SLSSPRCX
         MVC   PANEL,SLSS@PRC          SET PANEL NAME
         MVC   SLSSERR1,ISPMSG11       SET SLSSERR1
         MVC   CONTROL1,DISPL          SET CONTROL FUNCTION ONE
         MVC   CONTROL2,LOCK           SET CONTROL FUNCTION TWO
         BAL   R4,CONTROL              SET PROCESSING CONTROL FOR BUILD
         BAL   R4,DISPLAY              DISPLAY PROCESSING PANEL
         MVC   SUBMASK,SPACES          CLEAR SUBMASK
         MVC   TABLE,SUBUILD           SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG06       SET SLSSERR1
         BAL   R4,TBVCLEAR             CLEAR TABLE VARIABLES
         MVC   SUBLIB,SLSS             SET SUBLIB
         BAL   R4,TBSARG               DEFINE SEARCH ARGUMENT
SUBLD230 EQU   *
         MVC   TABLE,SUBUILD           SET NAME OF TABLE
         BAL   R4,TBSCAN               SEARCH A TABLE
         C     R15,FULL08              DONE WITH THIS SUB-LIBRARY?
         BE    SUBLD250                YES, CONTINUE
         CLC   SUBMASK,SUBID           PROCESSED ALREADY?
         BE    SUBLD230                YES, GET NEXT
         MVC   SUBMASK,SUBID           UPDATE SUBMASK
         MVC   TABLE,MAIN              SET NAME OF TABLE
         MVC   SLSSERR1,ISPMSG06       SET SLSSERR1
         BAL   R4,TBTOP                SET ROW POINTER TO TOP OF TABLE
         BAL   R4,TBVCLEAR             CLEAR TABLE VARIABLES
         MVC   SLSID,SUBID             SET SLSID
         BAL   R4,TBSARG               DEFINE SEARCH ARGUMENT
         BAL   R4,TBSCAN               SEARCH A TABLE
         C     R15,FULL08              MANUAL-ID FOUND?
         BNE   SUBLD240                YES, CONTINUE
         MVC   CONTROL1,ERRORS         SET CONTROL FUNCTION ONE
         MVC   CONTROL2,RETURN         SET CONTROL FUNCTION TWO
         BAL   R4,CONTROL              CLOSE TABLE WITHOUT SAVING
         MVC   SLSSWRN1,ISPMSG13       SET SLSSERR1
         MVC   SLSSWRN1+11(9),SLSID    IDENTIFY MANUAL-ID
         MVC   SLSSWRN2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSWRN2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSWRN2+39(2),EIGHT    IDENTIFY RETURN CODE
         MVC   SLSSWRN3,WMSG3          SET MESSAGE THREE
         MVC   SLSSWRN4,WMSG4          SET MESSAGE FOUR
         MVC   SLSSWRN5,EMSG5          SET MESSAGE FIVE
         MVC   SLSSWRNX,EMSGX          SET MESSAGE X
         MVC   PANEL,SLSS@WRN          IDENTIFY DISPLAY PANEL
         BAL   R4,DISPLAY              DISPLAY ERROR PANEL
         MVC   CONTROL1,DISPL          SET CONTROL FUNCTION ONE
         MVC   CONTROL2,LOCK           SET CONTROL FUNCTION TWO
         BAL   R4,CONTROL              CLOSE TABLE WITHOUT SAVING
         B     SUBLD230                CONTINUE
SUBLD240 EQU   *
         MVC   TABLE,SPACES            CLEAR TABLE NAME
         MVC   TABLE(4),SLSS           SET TABLE NAME
         MVC   SLSSERR1,ISPMSG14       SET SLSSERR1
         MVC   SLSSERR1+17(4),SLSS     SET SUB-LIBRARY NAME
         BAL   R4,TBBOTTOM             SET ROW POINTER TO THE BOTTOM
         BAL   R4,TBADD                ADD A ROW TO A TABLE
         B     SUBLD230                CONTINUE
SUBLD250 EQU   *
         MVC   TABLE,SPACES            CLEAR TABLE NAME
         MVC   TABLE(4),SLSS           SET TABLE NAME
         MVC   SLSSERR1,ISPMSG15       SET SLSSERR1
         MVC   SLSSERR1+29(4),SLSS     SET SUB-LIBRARY NAME
         BAL   R4,TBCLOSE              CLOSE AND SAVE TABLE
         LA    R7,TABLE                INDEX THROUGH TABLE
         LA    R8,4                    MAX LENGTH OF SLSS NAME
SUBLD260 EQU   *
         CLC   0(1,R7),SPACES          INSERT 'ENQ' HERE?
         BE    SUBLD270                YES, INSERT AND CONTINUE
         LA    R7,1(R7)                INCREMENT R7
         BCT   R8,SUBLD260             CONTINUE
SUBLD270 EQU   *
         MVC   0(4,R7),ENQ             SET TABLE NAME
         MVC   SLSSERR1,ISPMSG23       SET SLSSERR1
         MVC   SLSSERR1+17(4),SLSS     MOVE IN LIBRARY NAME
         LA    R15,12                  BRANCH DISPLACEMENT FOR TBCREATE
         BAL   R4,TBCREATE             CREATE NEW SLSS.ENQ TABLE
         MVC   SLSSERR1,ISPMSG24       SET SLSSERR1
         MVC   SLSSERR1+29(4),SLSS     SET SUB-LIBRARY NAME
         BAL   R4,TBCLOSE              CLOSE AND SAVE TABLE
         CLC   ALL,SLSSSAV             ARE WE BUILDING ALL SUB-LIBS?
         BNE   SUBLD280                NO, THEN WE'RE DONE
         LA    R2,8(R2)                POINT TO NEXT SUB-LIBRARY
         BCT   R3,SUBLD220             CONTINUE
SUBLD280 EQU   *
         MVC   TABLE,MAIN              SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   TABLE,SLSSCNTL          SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   TABLE,MAINLOCS          SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   TABLE,SUBUILD           SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   TABLE,MAINMEMS          SET TABLE NAME
         MVC   SLSSERR1,ISPMSG25       SET SLSSERR1
         BAL   R4,TBCLOSE              CLOSE TABLE AND SAVE
         MVC   SLSSPRC1,PMSG1          SET SLSSPRC1
         MVC   SLSSPRC2,PMSG22         SET SLSSPRC2
         MVC   SLSSPRC3,PMSG3          SET SLSSPRC3
         MVC   SLSSPRC4,PMSG44         SET SLSSPRC4
         MVC   SLSSPRC5,PMSG5          SET SLSSPRC5
         MVC   SLSSPRCX,PMSGXX         SET SLSSPRCX
         MVC   PANEL,SLSS@PRC          SET PANEL NAME
         BAL   R4,DISPLAY              DISPLAY PROCESSING PANEL
         SLR   R15,R15                 SET RETURN CODE TO ZERO
         B     FINISH                  WE'RE DONE
         TITLE 'SLSSSUBL - CLOSING SECTION'
***********************************************************************
*  CLOSING SECTION - FREE GETMAINED AREA, SET RETURN CODE RESTORE REGS
***********************************************************************
FINISH   EQU   *
         LR    R1,R13                  ADDRESS OF WORKAREA
         L     R13,4(R13)              ADDR CALLER'S SAVE AREA
         FREEMAIN R,LV=WORKLEN,A=(1)   FREE GETMAINED VIRTUAL STORAGE
         RETURN (14,12),RC=(15)        RESTORE REGISTERS AND RETURN
         TITLE 'SLSSSUBL - ROUTINE SECTION'
***********************************************************************
*  ROUTINE SECTION - RETRIEVE VARIABLES
***********************************************************************
VGET     EQU   *
         MVC   ISPFSERV,GETID          SET ISPF DIALOG SERVICE
*                                      RETRIEVE DIALOG VARIABLE
         ISPCALL ('VGET',NAMELSTI)
         B     VGET10(R15)             CHECK RETURN CODE
VGET10   EQU   *
         B     VGET20                  RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR VGET)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (NOT VALID FOR VGET)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
VGET20   EQU   *
         BR    R4                      RETURN
***********************************************************************
*  ROUTINE SECTION - CREATE NEW TABLE
***********************************************************************
TBCREATE EQU   *
         MVC   ISPFSERV,CREID          SET ISPF DIALOG SERVICE
*                                      CREATE A NEW TABLE
         B     TBCRE10(R15)            CREATE DESIRED TABLE
TBCRE10  EQU   *
         B     TBCRE20                 CREATE SUBUILD TABLE
         B     TBCRE30                 CREATE MEMBER TABLE
         B     TBCRE40                 CREATE SLSS TABLE
         B     TBCRE50                 CREATE SLSS.ENQ TABLE
TBCRE20  EQU   *
         ISPCALL ('TBCREATE',TABLE,' ',NAMELSTE,'NOWRITE','REPLACE','SL+
               SSTLIB')
         B     TBCRE60(R15)            CHECK RETURN CODE
TBCRE30  EQU   *
         ISPCALL ('TBCREATE',TABLE,NAMELSTF,NAMELSTG,'WRITE','REPLACE',+
               'SLSSTLIB')
         B     TBCRE60(R15)            CHECK RETURN CODE
TBCRE40  EQU   *
         ISPCALL ('TBCREATE',TABLE,NAMELSTC,NAMELSTD,'WRITE','REPLACE',+
               'SLSSTLIB')
         B     TBCRE60(R15)            CHECK RETURN CODE
TBCRE50  EQU   *
         ISPCALL ('TBCREATE',TABLE,' ',NAMELSTH,'WRITE','REPLACE','SLSS+
               TLIB')
         B     TBCRE60(R15)            CHECK RETURN CODE
TBCRE60  EQU   *
         B     TBCRE70                 RC = 00 (CONTINUE)
         B     TBCRE70                 RC = 04 (CONTINUE)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     TBCRE80                 RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (NOT VALID FOR TBTOP)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBCRE70  EQU   *
         BR    R4                      RETURN
TBCRE80  EQU   *
         MVC   SLSSERR1,ISPMSG19       SET SLSSERR1
         MVC   SLSSERR1+12(8),TABLE    SET TABLE NAME
         B     ISPERR12                (DISPLAY PANEL / MSG)
***********************************************************************
*  ROUTINE SECTION - CLOSE TABLE WITHOUT SAVING
***********************************************************************
TBEND    EQU   *
*                                      CLOSE TABLE WITHOUT SAVING
         ISPCALL ('TBEND',TABLE)
         BR    R4                      RETURN
***********************************************************************
*  ROUTINE SECTION - OPEN TABLE
***********************************************************************
TBOPEN   EQU   *
         MVC   ISPFSERV,OPNID          SET ISPF DIALOG SERVICE
*                                      OPEN A TABLE
         ISPCALL ('TBOPEN',TABLE,ACCESS,'SLSSTLIB')
         B     TBOPN10(R15)            CHECK RETURN CODE
TBOPN10  EQU   *
         B     TBOPN20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBOPEN)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     TBOPN30                 RC = 12 (CONTINUE)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBOPN20  EQU   *
         BR    R4                      RETURN
TBOPN30  EQU   *
         MVC   SLSSERR1,ISPMSG19       SET SLSSERR1
         MVC   SLSSERR1+12(8),TABLE    SET TABLE NAME
         B     ISPERR12                (DISPLAY PANEL / MSG)
***********************************************************************
*  ROUTINE SECTION - SET ROW POINTER TO TOP OF TABLE
***********************************************************************
TBTOP    EQU   *
         MVC   ISPFSERV,TOPID          SET ISPF DIALOG SERVICE
*                                      SET ROW POINTER TO TOP OF TABLE
         ISPCALL ('TBTOP',TABLE)
         B     TBTOP10(R15)            CHECK RETURN CODE
TBTOP10  EQU   *
         B     TBTOP20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBTOP)
         B     ISPERR08                RC = 08 (NOT VALID FOR TBTOP)
         B     TBTOP30                 RC = 12 (CONTINUE)
         B     ISPERR16                RC = 16 (NOT VALID FOR TBTOP)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBTOP20  EQU   *
         BR    R4                      RETURN
TBTOP30  EQU   *
         LR    R5,R4                   SAVE RETURN ADDRESS
         BAL   R4,TBOPEN               TRY TO OPEN TABLE
         LR    R4,R5                   RESTORE RETURN ADDRESS
         B     TBTOP                   SET ROW POINTER TO TOP OF TABLE
***********************************************************************
*  ROUTINE SECTION - CLEAR TABLE VARIABLES
***********************************************************************
TBVCLEAR EQU   *
         MVC   ISPFSERV,CLRID          SET ISPF DIALOG SERVICE
*                                      CLEAR TABLE VARIABLES
         ISPCALL ('TBVCLEAR',TABLE)
         B     TBVCL10(R15)            CHECK RETURN CODE
TBVCL10  EQU   *
         B     TBVCL20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBVCLEAR)
         B     ISPERR08                RC = 08 (NOT VALID FOR TBVCLEAR)
         B     TBVCL30                 RC = 12 (CONTINUE)
         B     ISPERR16                RC = 16 (NOT VALID FOR TBVCLEAR)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBVCL20  EQU   *
         BR    R4                      RETURN
TBVCL30  EQU   *
         LR    R5,R4                   SAVE RETURN ADDRESS
         BAL   R4,TBOPEN               TRY TO OPEN TABLE
         LR    R4,R5                   RESTORE RETURN ADDRESS
         B     TBVCLEAR                CLEAR TABLE VARIABLES
***********************************************************************
*  ROUTINE SECTION - MOVE ROW POINTER TO NEXT ROW
***********************************************************************
TBSKIP   EQU   *
         SLR   R5,R5                   CLEAR REG 5
         MVC   ISPFSERV,SKPID          SET ISPF DIALOG SERVICE
*                                      OPEN A TABLE
         ISPCALL ('TBSKIP',TABLE)
         B     TBSKP10(R15)            CHECK RETURN CODE
TBSKP10  EQU   *
         B     TBSKP20                 RC = 00 (CONTINUE)
         B     ISPWRN04                RC = 04 (NOT VALID FOR TBSKIP)
         B     TBSKP20                 RC = 08 (CONTINUE)
         B     ISPWRN12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPWRN16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPWRN20                RC = 20 (DISPLAY PANEL / MSG)
TBSKP20  EQU   *
         BR    R4                      RETURN
***********************************************************************
*  ROUTINE SECTION - SET THE ROW POINTER TO BOTTOM
***********************************************************************
TBBOTTOM EQU   *
         MVC   ISPFSERV,BOTID          SET ISPF DIALOG SERVICE
*                                      SET THE ROW POINTER TO BOTTOM
         ISPCALL ('TBBOTTOM',TABLE,' ',' ','NOREAD')
         B     TBBOT10(R15)            CHECK RETURN CODE
TBBOT10  EQU   *
         B     TBBOT20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBBOTTOM)
         B     TBBOT20                 RC = 08 (CONTINUE)
         B     TBBOT30                 RC = 12 (CONTINUE)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBBOT20  EQU   *
         BR    R4                      RETURN
TBBOT30  EQU   *
         LR    R5,R4                   SAVE RETURN ADDRESS
         BAL   R4,TBOPEN               TRY TO OPEN TABLE
         LR    R4,R5                   RESTORE RETURN ADDRESS
         B     TBBOTTOM                SET THE ROW POINTER TO BOTTOM
***********************************************************************
*  ROUTINE SECTION - ADD A ROW TO A TABLE
***********************************************************************
TBADD    EQU   *
         MVC   ISPFSERV,ADDID          SET ISPF DIALOG SERVICE
*                                      ADD A ROW TO A TABLE
         ISPCALL ('TBADD',TABLE)
         B     TBADD10(R15)            CHECK RETURN CODE
TBADD10  EQU   *
         B     TBADD20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBADD)
         B     TBADD20                 RC = 08 (CONTINUE)
         B     TBADD30                 RC = 12 (CONTINUE)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBADD20  EQU   *
         BR    R4                      RETURN
TBADD30  EQU   *
         LR    R5,R4                   SAVE RETURN ADDRESS
         BAL   R4,TBOPEN               TRY TO OPEN TABLE
         LR    R4,R5                   RESTORE RETURN ADDRESS
         B     TBADD                   ADD A ROW TO A TABLE
***********************************************************************
*  ROUTINE SECTION - DEFINE SEARCH ARGUMENT
***********************************************************************
TBSARG   EQU   *
         MVC   ISPFSERV,ARGID          SET ISPF DIALOG SERVICE
*                                      DEFINE SEARCH ARGUMENT
         ISPCALL ('TBSARG',TABLE)
         B     TBSARG10(R15)           CHECK RETURN CODE
TBSARG10 EQU   *
         B     TBSARG20                RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBSARG)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     TBSARG30                RC = 12 (CONTINUE)
         B     ISPERR16                RC = 16 (NOT VALID FOR TBSARG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBSARG20 EQU   *
         BR    R4                      RETURN
TBSARG30 EQU   *
         LR    R5,R4                   SAVE RETURN ADDRESS
         BAL   R4,TBOPEN               TRY TO OPEN TABLE
         LR    R4,R5                   RESTORE RETURN ADDRESS
         B     TBSARG                  DEFINE SEARCH ARGUMENT
***********************************************************************
*  ROUTINE SECTION - SEARCH TABLE
***********************************************************************
TBSCAN   EQU   *
         SLR   R5,R5                   CLEAR REG 5
         MVC   ISPFSERV,SCNID          SET ISPF DIALOG SERVICE
*                                      SEARCH TABLE
         ISPCALL ('TBSCAN',TABLE)
         B     TBSCAN10(R15)           CHECK RETURN CODE
TBSCAN10 EQU   *
         B     TBSCAN20                RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBSCAN)
         B     TBSCAN20                RC = 08 (CONTINUE)
         B     TBSCAN30                RC = 12 (CONTINUE)
         B     TBSCAN20                RC = 16 (CONTINUE)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBSCAN20 EQU   *
         BR    R4                      RETURN
TBSCAN30 EQU   *
         LR    R5,R4                   SAVE RETURN ADDRESS
         BAL   R4,TBOPEN               TRY TO OPEN TABLE
         LR    R4,R5                   RESTORE RETURN ADDRESS
         B     TBSCAN                  SEARCH TABLE
***********************************************************************
*  ROUTINE SECTION - MODIFY A ROW IN A TABLE
***********************************************************************
TBMOD    EQU   *
         MVC   ISPFSERV,MODID          SET ISPF DIALOG SERVICE
*                                      MODIFY A ROW IN A TABLE
         ISPCALL ('TBMOD',TABLE)
         B     TBMOD10(R15)            CHECK RETURN CODE
TBMOD10  EQU   *
         B     TBMOD20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBMOD)
         B     ISPERR08                RC = 08 (DISPLAY PANEL / MSG)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBMOD20  EQU   *
         BR    R4                      RETURN
***********************************************************************
*  ROUTINE SECTION - DISPLAY PANEL
***********************************************************************
DISPLAY  EQU   *
         SLR   R5,R5                   CLEAR REG 5
         MVC   ISPFSERV,DISID          SET ISPF DIALOG SERVICE
*                                      DISPLAY PANEL
         ISPCALL ('DISPLAY',PANEL)
         B     DISPL10(R15)            CHECK RETURN CODE
DISPL10  EQU   *
         B     DISPL20                 RC = 00 (CONTINUE)
         B     DISPL20                 RC = 04 (CONTINUE)
         B     DISPL20                 RC = 08 (CONTINUE)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
DISPL20  EQU   *
         LR    R5,R15                  SAVE RETURN CODE
         BR    R4                      RETURN
***********************************************************************
*  ROUTINE SECTION - DISPLAY ERROR PANEL
***********************************************************************
DISPLERR EQU   *
         ISPCALL ('DISPLAY',PANEL)
         LA    R15,20                  SET RETURN CODE
         B     FINISH                  RETURN
***********************************************************************
*  ROUTINE SECTION - SET PROCESSING MODE
***********************************************************************
CONTROL  EQU   *
         MVC   ISPFSERV,CONID          SET ISPF DIALOG SERVICE
*                                      SET PROCESSING MODE
         ISPCALL ('CONTROL',CONTROL1,CONTROL2)
         B     CONTL10(R15)            CHECK RETURN CODE
CONTL10  EQU   *
         B     CONTL20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR CONTROL)
         B     ISPERR08                RC = 08 (NOT VALID FOR CONTROL)
         B     ISPERR12                RC = 12 (NOT VALID FOR CONTROL)
         B     ISPERR16                RC = 16 (NOT VALID FOR CONTROL)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
CONTL20  EQU   *
         BR    R4                      RETURN
***********************************************************************
*  ROUTINE SECTION - CLOSE TABLE AND SAVE
***********************************************************************
TBCLOSE  EQU   *
         MVC   ISPFSERV,CLOID          SET ISPF DIALOG SERVICE
*                                      OPEN A TABLE
         ISPCALL ('TBCLOSE',TABLE,'REPLCOPY',' ',' ','SLSSTLIB')
         B     TBCLO10(R15)            CHECK RETURN CODE
TBCLO10  EQU   *
         B     TBCLO20                 RC = 00 (CONTINUE)
         B     ISPERR04                RC = 04 (NOT VALID FOR TBCLOSE)
         B     ISPERR08                RC = 08 (NOT VALID FOR TBCLOSE)
         B     ISPERR12                RC = 12 (DISPLAY PANEL / MSG)
         B     ISPERR16                RC = 16 (DISPLAY PANEL / MSG)
         B     ISPERR20                RC = 20 (DISPLAY PANEL / MSG)
TBCLO20  EQU   *
         BR    R4                      RETURN
         TITLE 'SLSSSUBL - ERROR PROCESSING SECTION'
***********************************************************************
*  ERROR PROCESSING SECTION
***********************************************************************
ISPERR04 EQU   *
         MVC   SLSSERR2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSERR2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSERR2+39(2),FOUR     IDENTIFY RETURN CODE
         B     ISPERR30                DISPLAY ERROR PANEL
ISPERR08 EQU   *
         MVC   SLSSERR2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSERR2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSERR2+39(2),EIGHT    IDENTIFY RETURN CODE
         B     ISPERR30                DISPLAY ERROR PANEL
ISPERR12 EQU   *
         MVC   SLSSERR2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSERR2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSERR2+39(2),TWELVE   IDENTIFY RETURN CODE
         B     ISPERR30                DISPLAY ERROR PANEL
ISPERR16 EQU   *
         MVC   SLSSERR2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSERR2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSERR2+39(2),SIXTEEN  IDENTIFY RETURN CODE
         B     ISPERR30                DISPLAY ERROR PANEL
ISPERR20 EQU   *
         MVC   SLSSERR2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSERR2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSERR2+39(2),TWENTY   IDENTIFY RETURN CODE
ISPERR30 EQU   *
         MVC   CONTROL1,ERRORS         SET CONTROL FUNCTION ONE
         MVC   CONTROL2,RETURN         SET CONTROL FUNCTION TWO
         BAL   R4,CONTROL              CLOSE TABLE WITHOUT SAVING
         MVC   SLSSERR3,EMSG3          SET MESSAGE THREE
         MVC   SLSSERR4,EMSG4          SET MESSAGE FOUR
         MVC   SLSSERR5,EMSG5          SET MESSAGE FIVE
         MVC   SLSSERRX,EMSGX          SET MESSAGE X
         MVC   PANEL,SLSS@ERR          IDENTIFY DISPLAY PANEL
         MVC   TABLE,SLSSCNTL          SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   TABLE,MAIN              SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   TABLE,MAINLOCS          SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   TABLE,SUBUILD           SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         MVC   TABLE,MAINMEMS          SET TABLE NAME
         BAL   R4,TBEND                CLOSE TABLE WITHOUT SAVING
         B     DISPLERR                DISPLAY ERROR PANEL
         TITLE 'SLSSSUBL - WARNING PROCESSING SECTION'
***********************************************************************
*  WARNING PROCESSING SECTION
***********************************************************************
ISPWRN04 EQU   *
         MVC   SLSSWRN2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSWRN2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSWRN2+39(2),FOUR     IDENTIFY RETURN CODE
         B     ISPWRN30                DISPLAY WARNING PANEL
ISPWRN08 EQU   *
         MVC   SLSSWRN2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSWRN2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSWRN2+39(2),EIGHT    IDENTIFY RETURN CODE
         B     ISPWRN30                DISPLAY WARNING PANEL
ISPWRN12 EQU   *
         MVC   SLSSWRN2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSWRN2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSWRN2+39(2),TWELVE   IDENTIFY RETURN CODE
         B     ISPWRN30                DISPLAY WARNING PANEL
ISPWRN16 EQU   *
         MVC   SLSSWRN2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSWRN2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSWRN2+39(2),SIXTEEN  IDENTIFY RETURN CODE
         B     ISPWRN30                DISPLAY WARNING PANEL
ISPWRN20 EQU   *
         MVC   SLSSWRN2,ISPFMSG2       SET MESSAGE TWO
         MVC   SLSSWRN2+25(8),ISPFSERV IDENTIFY ISPF SERVICE
         MVC   SLSSWRN2+39(2),TWENTY   IDENTIFY RETURN CODE
ISPWRN30 EQU   *
         MVC   SLSSWRN3,WMSG3          SET MESSAGE THREE
         MVC   SLSSWRN4,WMSG4          SET MESSAGE FOUR
         MVC   SLSSWRN5,EMSG5          SET MESSAGE FIVE
         MVC   SLSSWRNX,EMSGX          SET MESSAGE X
         MVC   PANEL,SLSS@WRN          IDENTIFY DISPLAY PANEL
         LR    R5,R4                   SAVE RETURN ADDRESS
         BAL   R4,DISPLAY              DISPLAY WARNING PANEL
         BR    R5                      RETURN
         TITLE 'SLSSSUBL - REGISTER EQUATES'
***********************************************************************
*  REGISTER EQUATES
***********************************************************************
         EQUATE
         TITLE 'SLSSSUBL - DATA CONSTANTS'
***********************************************************************
*  CONSTANTS
***********************************************************************
FULL08   DC    F'08'                   FULLWORD CONSTANT, VALUE '08'
FOUR     DC    CL2'04'                 RETURN CODE OF '04'
EIGHT    DC    CL2'08'                 RETURN CODE OF '08'
TWELVE   DC    CL2'12'                 RETURN CODE OF '12'
SIXTEEN  DC    CL2'16'                 RETURN CODE OF '16'
TWENTY   DC    CL2'20'                 RETURN CODE OF '20'
SPACES   DC    CL80' '                 USED FOR INITIALIZATION
ERRORS   DC    CL8'ERRORS'             FOR CONTROL FUNCTION
RETURN   DC    CL8'RETURN'             FOR CONTROL FUNCTION
DISPL    DC    CL8'DISPLAY'            FOR CONTROL FUNCTION
LOCK     DC    CL8'LOCK'               FOR CONTROL FUNCTION
ALL      DC    CL3'ALL'                BUILD ALL SUB LIBRARIES
NOWRITE  DC    CL8'NOWRITE'            TABLE OPEN ACCESS
WRITE    DC    CL8'WRITE'              TABLE OPEN ACCESS
SUBUILD  DC    CL8'SUBUILD'            TABLE NAME
MAINLOCS DC    CL8'MAINLOCS'           TABLE NAME
MAIN     DC    CL8'MAIN'               TABLE NAME
ENQ      DC    CL4'ENQ'                FOR CREATING ENQ TABLE
MAINMEMS DC    CL8'MAINMEMS'           TABLE NAME
SLSSCNTL DC    CL8'SLSSCNTL'           TABLE NAME
SLSS@ERR DC    CL8'SLSS@ERR'           ERROR DISPLAY PANEL NAME
SLSS@PRC DC    CL8'SLSS@PRC'           PROCESSING DISPLAY PANEL NAME
SLSS@WRN DC    CL8'SLSS@WRN'           WARNING DISPLAY PANEL NAME
ADDID    DC    CL8'TBADD'              ISPF DIALOG SERVICE (TBADD)
BOTID    DC    CL8'TBBOTTOM'           ISPF DIALOG SERVICE (TBBOTTOM)
CLOID    DC    CL8'TBCLOSE'            ISPF DIALOG SERVICE (TBCLOSE)
CONID    DC    CL8'CONTROL'            ISPF DIALOG SERVICE (CONTROL)
CREID    DC    CL8'TBCREATE'           ISPF DIALOG SERVICE (TBCREATE)
DEFID    DC    CL8'VDEFINE'            ISPF DIALOG SERVICE (VDEFINE)
GETID    DC    CL8'VGET'               ISPF DIALOG SERVICE (VGET)
OPNID    DC    CL8'TBOPEN'             ISPF DIALOG SERVICE (TBOPEN)
SKPID    DC    CL8'TBSKIP'             ISPF DIALOG SERVICE (TBSKIP)
ENDID    DC    CL8'TBEND'              ISPF DIALOG SERVICE (TBEND)
TOPID    DC    CL8'TBTOP'              ISPF DIALOG SERVICE (TBTOP)
CLRID    DC    CL8'TBVCLEAR'           ISPF DIALOG SERVICE (TBVCLEAR)
ARGID    DC    CL8'TBSARG'             ISPF DIALOG SERVICE (TBSARG)
SCNID    DC    CL8'TBSCAN'             ISPF DIALOG SERVICE (TBSCAN)
MODID    DC    CL8'TBMOD'              ISPF DIALOG SERVICE (TBMOD)
DISID    DC    CL8'DISPLAY'            ISPF DIALOG SERVICE (DISPLAY)
ISPMSG01 DC    CL62'UNABLE TO CREATE ''SUBUILD'' TABLE.'
ISPMSG02 DC    CL62'UNABLE TO OPEN LIBRARY LOCATION FILE, MAINLOCS.'
ISPMSG03 DC    CL62'UNABLE TO PROCESS LIBRARY LOCATION FILE, MAINLOCS.'
ISPMSG04 DC    CL62'UNABLE TO OBTAIN LOCATION INFORMATION FOR A MANUAL.+
               '
ISPMSG05 DC    CL62'UNABLE TO BUILD ''SUBUILD'' TABLE.'
ISPMSG06 DC    CL62'UNABLE TO PROCESS ''SUBUILD'' TABLE.'
ISPMSG07 DC    CL62'UNABLE TO OPEN CONTROL FILE, SLSSCNTL.'
ISPMSG08 DC    CL62'UNABLE TO PROCESS CONTROL FILE, SLSSCNTL.'
ISPMSG09 DC    CL62'REQUESTED LIBRARY, 1234, DOES NOT EXIST.'
ISPMSG10 DC    CL62'UNABLE TO CREATE 1234 LIBRARY.'
ISPMSG11 DC    CL62'UNABLE TO SET CONTROL FOR BUILD PROCESSING.'
ISPMSG12 DC    CL62'UNABLE TO OPEN PRIMARY LIBRARY FILE, MAIN.'
ISPMSG13 DC    CL62'MANUAL ID, 1234-1234, NOT FOUND IN LIBRARY ''MAIN''+
               .'
ISPMSG14 DC    CL62'UNABLE TO BUILD ''1234'' SUB-LIBRARY.'
ISPMSG15 DC    CL62'UNABLE TO CLOSE SUB-LIBRARY, 1234.'
ISPMSG16 DC    CL62'UNABLE TO DEFINE DIALOG VARIABLES.'
ISPMSG17 DC    CL62'UNABLE TO CREATE ''MAINMEMS'' TABLE.'
ISPMSG18 DC    CL62'UNABLE TO OBTAIN MEMBER INFORMATION FOR A SUB-LIBRA+
               RY.'
ISPMSG19 DC    CL62'ENQ FAILED; 12345678 IN USE BY ANOTHER USER.'
ISPMSG20 DC    CL62'UNABLE TO BUILD ''MAINMEMS'' TABLE.'
ISPMSG21 DC    CL62'UNABLE TO PROCESS ''MAINMEMS'' TABLE.'
ISPMSG22 DC    CL62'MEMBER, 12345678, DOES NOT EXIST FOR MANUAL ID, 123+
               456789.'
ISPMSG23 DC    CL62'UNABLE TO CREATE 1234ENQ LIBRARY.'
ISPMSG24 DC    CL62'UNABLE TO CLOSE SUB-LIBRARY, 1234ENQ.'
ISPMSG25 DC    CL62'UNABLE TO CLOSE MEM-LIBRARY, MAINMEMS.'
ISPFMSG2 DC    CL62'RETURN CODE FOR ''ISPEXEC 12345678'' WAS 12.'
EMSG3    DC    CL62'CONTACT SYSTEMS PROGRAMMING FOR FURTHER INFORMATION+
               '
WMSG3    DC    CL62'PROCESSING WILL CONTINUE FOR REMAINING MANUALS.'
WMSG4    DC    CL62' '
EMSG4    DC    CL62'REGARDING THIS ERROR.'
EMSG5    DC    CL62' '
EMSGX    DC    CL62'PRESS ENTER TO CONTINUE.'
PMSG1    DC    CL62' '
PMSG2    DC    CL62'                   BUILDING'
PMSG22   DC    CL62'           LIBRARY BUILD PROCESSING'
PMSG3    DC    CL62' '
PMSG4    DC    CL62'                 LIBRARY 1234'
PMSG44   DC    CL62'                C O M P L E T E '
PMSG5    DC    CL62' '
PMSGX    DC    CL62'RUN RUN RUN ... RUN RUN'
PMSGXX   DC    CL62'PRESS ENTER TO CONTINUE.'
NAMELST0 DS    0F                      NAMES OF VARIABLES (LENGTH 8)
         DC    F'195'
         DC    F'00'
         DC    CL8'LOC1'
         DC    CL8'LOC2'
         DC    CL8'LOC3'
         DC    CL8'LOC4'
         DC    CL8'LOC5'
         DC    CL8'LOC6'
         DC    CL8'LOC7'
         DC    CL8'LOC8'
         DC    CL8'LOC9'
         DC    CL8'LOC10'
         DC    CL8'LOC11'
         DC    CL8'LOC12'
         DC    CL8'LOC13'
         DC    CL8'LOC14'
         DC    CL8'LOC15'
         DC    CL8'LOC16'
         DC    CL8'LOC17'
         DC    CL8'LOC18'
         DC    CL8'LOC19'
         DC    CL8'LOC20'
         DC    CL8'LOC21'
         DC    CL8'LOC22'
         DC    CL8'LOC23'
         DC    CL8'LOC24'
         DC    CL8'LOC25'
         DC    CL8'LOC26'
         DC    CL8'LOC27'
         DC    CL8'LOC28'
         DC    CL8'LOC29'
         DC    CL8'LOC30'
         DC    CL8'LOC31'
         DC    CL8'LOC32'
         DC    CL8'LOC33'
         DC    CL8'LOC34'
         DC    CL8'LOC35'
         DC    CL8'LOC36'
         DC    CL8'LOC37'
         DC    CL8'LOC38'
         DC    CL8'LOC39'
         DC    CL8'LOC40'
         DC    CL8'LOC41'
         DC    CL8'LOC42'
         DC    CL8'LOC43'
         DC    CL8'LOC44'
         DC    CL8'LOC45'
         DC    CL8'LOC46'
         DC    CL8'LOC47'
         DC    CL8'LOC48'
         DC    CL8'LOC49'
         DC    CL8'LOC50'
         DC    CL8'LOC51'
         DC    CL8'LOC52'
         DC    CL8'LOC53'
         DC    CL8'LOC54'
         DC    CL8'LOC55'
         DC    CL8'LOC56'
         DC    CL8'LOC57'
         DC    CL8'LOC58'
         DC    CL8'LOC59'
         DC    CL8'LOC60'
         DC    CL8'SLB1'
         DC    CL8'SLB2'
         DC    CL8'SLB3'
         DC    CL8'SLB4'
         DC    CL8'SLB5'
         DC    CL8'SLB6'
         DC    CL8'SLB7'
         DC    CL8'SLB8'
         DC    CL8'SLB9'
         DC    CL8'SLB10'
         DC    CL8'SLB11'
         DC    CL8'SLB12'
         DC    CL8'SLB13'
         DC    CL8'SLB14'
         DC    CL8'SLB15'
         DC    CL8'SLB16'
         DC    CL8'SLB17'
         DC    CL8'SLB18'
         DC    CL8'SLB19'
         DC    CL8'SLB20'
         DC    CL8'SLB21'
         DC    CL8'SLB22'
         DC    CL8'SLB23'
         DC    CL8'SLB24'
         DC    CL8'SLB25'
         DC    CL8'SLB26'
         DC    CL8'SLB27'
         DC    CL8'SLB28'
         DC    CL8'SLB29'
         DC    CL8'SLB30'
         DC    CL8'SLB31'
         DC    CL8'SLB32'
         DC    CL8'SLB33'
         DC    CL8'SLB34'
         DC    CL8'SLB35'
         DC    CL8'SLB36'
         DC    CL8'SLB37'
         DC    CL8'SLB38'
         DC    CL8'SLB39'
         DC    CL8'SLB40'
         DC    CL8'SLB41'
         DC    CL8'SLB42'
         DC    CL8'SLB43'
         DC    CL8'SLB44'
         DC    CL8'SLB45'
         DC    CL8'SLB46'
         DC    CL8'SLB47'
         DC    CL8'SLB48'
         DC    CL8'SLB49'
         DC    CL8'SLB50'
         DC    CL8'SLB51'
         DC    CL8'SLB52'
         DC    CL8'SLB53'
         DC    CL8'SLB54'
         DC    CL8'SLB55'
         DC    CL8'SLB56'
         DC    CL8'SLB57'
         DC    CL8'SLB58'
         DC    CL8'SLB59'
         DC    CL8'SLB60'
         DC    CL8'SLB61'
         DC    CL8'SLB62'
         DC    CL8'SLB63'
         DC    CL8'SLB64'
         DC    CL8'SLB65'
         DC    CL8'SLB66'
         DC    CL8'SLB67'
         DC    CL8'SLB68'
         DC    CL8'SLB69'
         DC    CL8'SLB70'
         DC    CL8'SLB71'
         DC    CL8'SLB72'
         DC    CL8'SLB73'
         DC    CL8'SLB74'
         DC    CL8'SLB75'
         DC    CL8'SLB76'
         DC    CL8'SLB77'
         DC    CL8'SLB78'
         DC    CL8'SLB79'
         DC    CL8'SLB80'
         DC    CL8'SLB81'
         DC    CL8'SLB82'
         DC    CL8'SLB83'
         DC    CL8'SLB84'
         DC    CL8'SLB85'
         DC    CL8'SLB86'
         DC    CL8'SLB87'
         DC    CL8'SLB88'
         DC    CL8'SLB89'
         DC    CL8'SLB90'
         DC    CL8'SLB91'
         DC    CL8'SLB92'
         DC    CL8'SLB93'
         DC    CL8'SLB94'
         DC    CL8'SLB95'
         DC    CL8'SLB96'
         DC    CL8'SLB97'
         DC    CL8'SLB98'
         DC    CL8'SLB99'
         DC    CL8'SLB100'
         DC    CL8'SLB101'
         DC    CL8'SLB102'
         DC    CL8'SLB103'
         DC    CL8'SLB104'
         DC    CL8'SLB105'
         DC    CL8'SLB106'
         DC    CL8'SLB107'
         DC    CL8'SLB108'
         DC    CL8'SLB109'
         DC    CL8'SLB110'
         DC    CL8'SLB111'
         DC    CL8'SLB112'
         DC    CL8'SLB113'
         DC    CL8'SLB114'
         DC    CL8'SLB115'
         DC    CL8'SLB116'
         DC    CL8'SLB117'
         DC    CL8'SLB118'
         DC    CL8'SLB119'
         DC    CL8'SLB120'
         DC    CL8'BOOK'
         DC    CL8'DATEORD'
         DC    CL8'DATERECV'
         DC    CL8'LSTUWHO'
         DC    CL8'LSTUDAT'
         DC    CL8'CRETWHO'
         DC    CL8'CRETDAT'
         DC    CL8'MEMBER'
         DC    CL8'ENQU'
         DC    CL8'CIBCDATE'
         DC    CL8'CIBMDATE'
         DC    CL8'CIBSDATE'
         DC    CL8'CIBNUMBR'
         DC    CL8'CIBOWNER'
         DC    CL8'SLSSRTKY'
NAMELST1 DS    0F                      NAMES OF VARIABLES (LENGTH 1)
         DC    F'04'
         DC    F'00'
         DC    CL8'ORDSTS'
         DC    CL8'CIBSTABL'
         DC    CL8'CIBSRTKY'
         DC    CL8'CIBEXTRA'
NAMELST2 DS    0F                      NAMES OF VARIABLES (LENGTH 62)
         DC    F'18'
         DC    F'00'
         DC    CL8'SLSSERR1'
         DC    CL8'SLSSERR2'
         DC    CL8'SLSSERR3'
         DC    CL8'SLSSERR4'
         DC    CL8'SLSSERR5'
         DC    CL8'SLSSERRX'
         DC    CL8'SLSSPRC1'
         DC    CL8'SLSSPRC2'
         DC    CL8'SLSSPRC3'
         DC    CL8'SLSSPRC4'
         DC    CL8'SLSSPRC5'
         DC    CL8'SLSSPRCX'
         DC    CL8'SLSSWRN1'
         DC    CL8'SLSSWRN2'
         DC    CL8'SLSSWRN3'
         DC    CL8'SLSSWRN4'
         DC    CL8'SLSSWRN5'
         DC    CL8'SLSSWRNX'
NAMELST3 DS    0F                      NAMES OF VARIABLES (LENGTH 60)
         DC    F'03'
         DC    F'00'
         DC    CL8'NAME1'
         DC    CL8'NAME2'
         DC    CL8'NAME3'
NAMELST4 DS    0F                      NAMES OF VARIABLES (LENGTH 4)
         DC    F'04'
         DC    F'00'
         DC    CL8'SUBLIB'
         DC    CL8'SLSS'
         DC    CL8'CIBN'
         DC    CL8'SLSSSAV'
NAMELST5 DS    0F                      NAMES OF VARIABLES (LENGTH 13)
         DC    F'01'
         DC    F'00'
         DC    CL8'LOCID'
NAMELST6 DS    0F                      NAMES OF VARIABLES (LENGTH 9)
         DC    F'02'
         DC    F'00'
         DC    CL8'SLSID'
         DC    CL8'SUBID'
NAMELST7 DS    0F                      NAMES OF VARIABLES (LENGTH 2)
         DC    F'02'
         DC    F'00'
         DC    CL8'SLSSVER'
         DC    CL8'SLSSNUM'
NAMELST8 DS    0F                      NAMES OF VARIABLES (LENGTH 5)
         DC    F'03'
         DC    F'00'
         DC    CL8'LSTUTIM'
         DC    CL8'CRETTIM'
         DC    CL8'CIBTIME'
NAMELST9 DS    0F                      NAMES OF VARIABLES (LENGTH 6)
         DC    F'01'
         DC    F'00'
         DC    CL8'CIBJDATE'
NAMELSTA DS    0F                      NAMES OF VARIABLES (LENGTH 20)
         DC    F'06'
         DC    F'00'
         DC    CL8'CIBNAME'
         DC    CL8'CIBLOC1'
         DC    CL8'CIBLOC2'
         DC    CL8'CIBLOC3'
         DC    CL8'CIBLOC4'
         DC    CL8'CIBLOC5'
NAMELSTC DS    0F                      KEYS - SLSS TABLE
         DC    F'01'
         DC    F'00'
         DC    CL8'SLSID'
NAMELSTD DS    0F                      NAMES - SLSSTABLE
         DC    F'33'
         DC    F'00'
         DC    CL8'SLSSRTKY'
         DC    CL8'SLSSVER'
         DC    CL8'SLSSNUM'
         DC    CL8'NAME1'
         DC    CL8'NAME2'
         DC    CL8'NAME3'
         DC    CL8'ORDSTS'
         DC    CL8'BOOK'
         DC    CL8'UPD'
         DC    CL8'DATEORD'
         DC    CL8'DATERECV'
         DC    CL8'LSTUWHO'
         DC    CL8'LSTUDAT'
         DC    CL8'LSTUTIM'
         DC    CL8'CRETWHO'
         DC    CL8'CRETDAT'
         DC    CL8'CRETTIM'
         DC    CL8'UPD0'
         DC    CL8'UPD1'
         DC    CL8'UPD2'
         DC    CL8'UPD3'
         DC    CL8'UPD4'
         DC    CL8'UPD5'
         DC    CL8'UPD6'
         DC    CL8'UPD7'
         DC    CL8'UPD8'
         DC    CL8'UPD9'
         DC    CL8'UPDA'
         DC    CL8'UPDB'
         DC    CL8'UPDC'
         DC    CL8'UPDD'
         DC    CL8'UPDE'
         DC    CL8'UPDF'
NAMELSTE DS    0F                      NAMES - SUBUILD TABLE
         DC    F'02'
         DC    F'00'
         DC    CL8'SUBLIB'
         DC    CL8'SUBID'
NAMELSTF DS    0F                      KEYS - MEMBER TABLE
         DC    F'01'
         DC    F'00'
         DC    CL8'MEMBER'
NAMELSTG DS    0F                      NAMES - MEMBER TABLE
         DC    F'01'
         DC    F'00'
         DC    CL8'SUBLIB'
NAMELSTH DS    0F                      NAMES - SLSS.ENQ TABLE
         DC    F'01'
         DC    F'00'
         DC    CL8'ENQU'
NAMELSTI DS    0F                      NAME OF VGET VARIABLE
         DC    F'01'
         DC    F'00'
         DC    CL8'SLSSSAV'
         TITLE 'SLSSSUBL - LITERAL POOL'
         LTORG
         TITLE 'SLSSSUBL - DYNAMIC WORK AREA'
***********************************************************************
*  DYNAMIC WORK AREA
***********************************************************************
WORKAREA DSECT
SAVEAREA DS    18F                     PROGRAM SAVE AREA
ISPADDR  DS    A                       ADDRESS OF EP TO ISPLINK
PARMS    DS    7A                      PARM LIST FOR CALL
ISPFSERV DS    CL8                     ISPF DIALOG SERVICE
ACCESS   DS    CL8                     GENERIC TABLE OPEN ACCESS
PANEL    DS    CL8                     GENERIC PANEL NAME
TABLE    DS    CL8                     GENERIC TABLE NAME
CONTROL1 DS    CL8                     GENERIC CONTROL FUNCTION ONE
CONTROL2 DS    CL8                     GENERIC CONTROL FUNCTION TWO
LOC1     DS    CL8                     MANUAL LOCATION
LOC2     DS    CL8                     MANUAL LOCATION
LOC3     DS    CL8                     MANUAL LOCATION
LOC4     DS    CL8                     MANUAL LOCATION
LOC5     DS    CL8                     MANUAL LOCATION
LOC6     DS    CL8                     MANUAL LOCATION
LOC7     DS    CL8                     MANUAL LOCATION
LOC8     DS    CL8                     MANUAL LOCATION
LOC9     DS    CL8                     MANUAL LOCATION
LOC10    DS    CL8                     MANUAL LOCATION
LOC11    DS    CL8                     MANUAL LOCATION
LOC12    DS    CL8                     MANUAL LOCATION
LOC13    DS    CL8                     MANUAL LOCATION
LOC14    DS    CL8                     MANUAL LOCATION
LOC15    DS    CL8                     MANUAL LOCATION
LOC16    DS    CL8                     MANUAL LOCATION
LOC17    DS    CL8                     MANUAL LOCATION
LOC18    DS    CL8                     MANUAL LOCATION
LOC19    DS    CL8                     MANUAL LOCATION
LOC20    DS    CL8                     MANUAL LOCATION
LOC21    DS    CL8                     MANUAL LOCATION
LOC22    DS    CL8                     MANUAL LOCATION
LOC23    DS    CL8                     MANUAL LOCATION
LOC24    DS    CL8                     MANUAL LOCATION
LOC25    DS    CL8                     MANUAL LOCATION
LOC26    DS    CL8                     MANUAL LOCATION
LOC27    DS    CL8                     MANUAL LOCATION
LOC28    DS    CL8                     MANUAL LOCATION
LOC29    DS    CL8                     MANUAL LOCATION
LOC30    DS    CL8                     MANUAL LOCATION
LOC31    DS    CL8                     MANUAL LOCATION
LOC32    DS    CL8                     MANUAL LOCATION
LOC33    DS    CL8                     MANUAL LOCATION
LOC34    DS    CL8                     MANUAL LOCATION
LOC35    DS    CL8                     MANUAL LOCATION
LOC36    DS    CL8                     MANUAL LOCATION
LOC37    DS    CL8                     MANUAL LOCATION
LOC38    DS    CL8                     MANUAL LOCATION
LOC39    DS    CL8                     MANUAL LOCATION
LOC40    DS    CL8                     MANUAL LOCATION
LOC41    DS    CL8                     MANUAL LOCATION
LOC42    DS    CL8                     MANUAL LOCATION
LOC43    DS    CL8                     MANUAL LOCATION
LOC44    DS    CL8                     MANUAL LOCATION
LOC45    DS    CL8                     MANUAL LOCATION
LOC46    DS    CL8                     MANUAL LOCATION
LOC47    DS    CL8                     MANUAL LOCATION
LOC48    DS    CL8                     MANUAL LOCATION
LOC49    DS    CL8                     MANUAL LOCATION
LOC50    DS    CL8                     MANUAL LOCATION
LOC51    DS    CL8                     MANUAL LOCATION
LOC52    DS    CL8                     MANUAL LOCATION
LOC53    DS    CL8                     MANUAL LOCATION
LOC54    DS    CL8                     MANUAL LOCATION
LOC55    DS    CL8                     MANUAL LOCATION
LOC56    DS    CL8                     MANUAL LOCATION
LOC57    DS    CL8                     MANUAL LOCATION
LOC58    DS    CL8                     MANUAL LOCATION
LOC59    DS    CL8                     MANUAL LOCATION
LOC60    DS    CL8                     MANUAL LOCATION
SLB1     DS    CL8                     SUB-LIBRARY
SLB2     DS    CL8                     SUB-LIBRARY
SLB3     DS    CL8                     SUB-LIBRARY
SLB4     DS    CL8                     SUB-LIBRARY
SLB5     DS    CL8                     SUB-LIBRARY
SLB6     DS    CL8                     SUB-LIBRARY
SLB7     DS    CL8                     SUB-LIBRARY
SLB8     DS    CL8                     SUB-LIBRARY
SLB9     DS    CL8                     SUB-LIBRARY
SLB10    DS    CL8                     SUB-LIBRARY
SLB11    DS    CL8                     SUB-LIBRARY
SLB12    DS    CL8                     SUB-LIBRARY
SLB13    DS    CL8                     SUB-LIBRARY
SLB14    DS    CL8                     SUB-LIBRARY
SLB15    DS    CL8                     SUB-LIBRARY
SLB16    DS    CL8                     SUB-LIBRARY
SLB17    DS    CL8                     SUB-LIBRARY
SLB18    DS    CL8                     SUB-LIBRARY
SLB19    DS    CL8                     SUB-LIBRARY
SLB20    DS    CL8                     SUB-LIBRARY
SLB21    DS    CL8                     SUB-LIBRARY
SLB22    DS    CL8                     SUB-LIBRARY
SLB23    DS    CL8                     SUB-LIBRARY
SLB24    DS    CL8                     SUB-LIBRARY
SLB25    DS    CL8                     SUB-LIBRARY
SLB26    DS    CL8                     SUB-LIBRARY
SLB27    DS    CL8                     SUB-LIBRARY
SLB28    DS    CL8                     SUB-LIBRARY
SLB29    DS    CL8                     SUB-LIBRARY
SLB30    DS    CL8                     SUB-LIBRARY
SLB31    DS    CL8                     SUB-LIBRARY
SLB32    DS    CL8                     SUB-LIBRARY
SLB33    DS    CL8                     SUB-LIBRARY
SLB34    DS    CL8                     SUB-LIBRARY
SLB35    DS    CL8                     SUB-LIBRARY
SLB36    DS    CL8                     SUB-LIBRARY
SLB37    DS    CL8                     SUB-LIBRARY
SLB38    DS    CL8                     SUB-LIBRARY
SLB39    DS    CL8                     SUB-LIBRARY
SLB40    DS    CL8                     SUB-LIBRARY
SLB41    DS    CL8                     SUB-LIBRARY
SLB42    DS    CL8                     SUB-LIBRARY
SLB43    DS    CL8                     SUB-LIBRARY
SLB44    DS    CL8                     SUB-LIBRARY
SLB45    DS    CL8                     SUB-LIBRARY
SLB46    DS    CL8                     SUB-LIBRARY
SLB47    DS    CL8                     SUB-LIBRARY
SLB48    DS    CL8                     SUB-LIBRARY
SLB49    DS    CL8                     SUB-LIBRARY
SLB50    DS    CL8                     SUB-LIBRARY
SLB51    DS    CL8                     SUB-LIBRARY
SLB52    DS    CL8                     SUB-LIBRARY
SLB53    DS    CL8                     SUB-LIBRARY
SLB54    DS    CL8                     SUB-LIBRARY
SLB55    DS    CL8                     SUB-LIBRARY
SLB56    DS    CL8                     SUB-LIBRARY
SLB57    DS    CL8                     SUB-LIBRARY
SLB58    DS    CL8                     SUB-LIBRARY
SLB59    DS    CL8                     SUB-LIBRARY
SLB60    DS    CL8                     SUB-LIBRARY
SLB61    DS    CL8                     SUB-LIBRARY
SLB62    DS    CL8                     SUB-LIBRARY
SLB63    DS    CL8                     SUB-LIBRARY
SLB64    DS    CL8                     SUB-LIBRARY
SLB65    DS    CL8                     SUB-LIBRARY
SLB66    DS    CL8                     SUB-LIBRARY
SLB67    DS    CL8                     SUB-LIBRARY
SLB68    DS    CL8                     SUB-LIBRARY
SLB69    DS    CL8                     SUB-LIBRARY
SLB70    DS    CL8                     SUB-LIBRARY
SLB71    DS    CL8                     SUB-LIBRARY
SLB72    DS    CL8                     SUB-LIBRARY
SLB73    DS    CL8                     SUB-LIBRARY
SLB74    DS    CL8                     SUB-LIBRARY
SLB75    DS    CL8                     SUB-LIBRARY
SLB76    DS    CL8                     SUB-LIBRARY
SLB77    DS    CL8                     SUB-LIBRARY
SLB78    DS    CL8                     SUB-LIBRARY
SLB79    DS    CL8                     SUB-LIBRARY
SLB80    DS    CL8                     SUB-LIBRARY
SLB81    DS    CL8                     SUB-LIBRARY
SLB82    DS    CL8                     SUB-LIBRARY
SLB83    DS    CL8                     SUB-LIBRARY
SLB84    DS    CL8                     SUB-LIBRARY
SLB85    DS    CL8                     SUB-LIBRARY
SLB86    DS    CL8                     SUB-LIBRARY
SLB87    DS    CL8                     SUB-LIBRARY
SLB88    DS    CL8                     SUB-LIBRARY
SLB89    DS    CL8                     SUB-LIBRARY
SLB90    DS    CL8                     SUB-LIBRARY
SLB91    DS    CL8                     SUB-LIBRARY
SLB92    DS    CL8                     SUB-LIBRARY
SLB93    DS    CL8                     SUB-LIBRARY
SLB94    DS    CL8                     SUB-LIBRARY
SLB95    DS    CL8                     SUB-LIBRARY
SLB96    DS    CL8                     SUB-LIBRARY
SLB97    DS    CL8                     SUB-LIBRARY
SLB98    DS    CL8                     SUB-LIBRARY
SLB99    DS    CL8                     SUB-LIBRARY
SLB100   DS    CL8                     SUB-LIBRARY
SLB101   DS    CL8                     SUB-LIBRARY
SLB102   DS    CL8                     SUB-LIBRARY
SLB103   DS    CL8                     SUB-LIBRARY
SLB104   DS    CL8                     SUB-LIBRARY
SLB105   DS    CL8                     SUB-LIBRARY
SLB106   DS    CL8                     SUB-LIBRARY
SLB107   DS    CL8                     SUB-LIBRARY
SLB108   DS    CL8                     SUB-LIBRARY
SLB109   DS    CL8                     SUB-LIBRARY
SLB110   DS    CL8                     SUB-LIBRARY
SLB111   DS    CL8                     SUB-LIBRARY
SLB112   DS    CL8                     SUB-LIBRARY
SLB113   DS    CL8                     SUB-LIBRARY
SLB114   DS    CL8                     SUB-LIBRARY
SLB115   DS    CL8                     SUB-LIBRARY
SLB116   DS    CL8                     SUB-LIBRARY
SLB117   DS    CL8                     SUB-LIBRARY
SLB118   DS    CL8                     SUB-LIBRARY
SLB119   DS    CL8                     SUB-LIBRARY
SLB120   DS    CL8                     SUB-LIBRARY
BOOK     DS    CL8                     BINDER NUMBER
DATEORD  DS    CL8                     DATE MANUAL ORDERED
DATERECV DS    CL8                     DATE MANUAL RECEIVED
LSTUWHO  DS    CL8                     LAST PERSON TO UPDATE ENTRY
LSTUDAT  DS    CL8                     DATE MANUAL ENTRY UPDATED
CRETWHO  DS    CL8                     PERSON WHO CREATED ENTRY
CRETDAT  DS    CL8                     DATE MANUAL ENTRY CREATED
MEMBER   DS    CL8                     MEMBER NAME (MEMBER)
ENQU     DS    CL8                     ENQ USER
CIBCDATE DS    CL8                     LIBRARY CREATION DATE
CIBMDATE DS    CL8                     LIBRARY MODIFICATION DATE
CIBSDATE DS    CL8                     LIBRARY SORT DATE
CIBNUMBR DS    CL8                     LIBRARY NUMBER
CIBOWNER DS    CL8                     LIBRARY OWNER ID
SLSSRTKY DS    CL8                     SORT KEY (LAST 8 CHAR OF MAN ID)
ORDSTS   DS    CL1                     ON-ORDER STATUS
CIBSTABL DS    CL1                     I DON'T KNOW
CIBSRTKY DS    CL1                     LIBRARY SORT KEY
CIBEXTRA DS    CL1                     I DON'T KNOW
SLSSERR1 DS    CL62                    SLSS ERROR MESSAGE 1
SLSSERR2 DS    CL62                    SLSS ERROR MESSAGE 2
SLSSERR3 DS    CL62                    SLSS ERROR MESSAGE 3
SLSSERR4 DS    CL62                    SLSS ERROR MESSAGE 4
SLSSERR5 DS    CL62                    SLSS ERROR MESSAGE 5
SLSSERRX DS    CL62                    SLSS ERROR MESSAGE X
SLSSPRC1 DS    CL62                    SLSS PROCESSING MESSAGE 1
SLSSPRC2 DS    CL62                    SLSS PROCESSING MESSAGE 2
SLSSPRC3 DS    CL62                    SLSS PROCESSING MESSAGE 3
SLSSPRC4 DS    CL62                    SLSS PROCESSING MESSAGE 4
SLSSPRC5 DS    CL62                    SLSS PROCESSING MESSAGE 5
SLSSPRCX DS    CL62                    SLSS PROCESSING MESSAGE X
SLSSWRN1 DS    CL62                    SLSS WARNING MESSAGE 1
SLSSWRN2 DS    CL62                    SLSS WARNING MESSAGE 2
SLSSWRN3 DS    CL62                    SLSS WARNING MESSAGE 3
SLSSWRN4 DS    CL62                    SLSS WARNING MESSAGE 4
SLSSWRN5 DS    CL62                    SLSS WARNING MESSAGE 5
SLSSWRNX DS    CL62                    SLSS WARNING MESSAGE X
NAME1    DS    CL60                    LINE 1 OF MANUAL TITLE
NAME2    DS    CL60                    LINE 2 OF MANUAL TITLE
NAME3    DS    CL60                    LINE 3 OF MANUAL TITLE
SUBLIB   DS    CL4                     LIBRARY NAME (SUBUILD)
SLSS     DS    CL4                     LIBRARY TABLE NAME
CIBN     DS    CL4                     LIBRARY NAME (TABLE KEY)
SLSSSAV  DS    CL4                     LIBRARY TO BUILD OR 'ALL'
LOCID    DS    CL13                    MANUAL/LOCATION ID
SLSID    DS    CL9                     MANUAL ID FOR LIBRARY TABLE
SUBID    DS    CL9                     MANUAL ID FOR TEMPORARY TABLE
SLSSVER  DS    CL2                     MANUAL VERSION NUMBER
SLSSNUM  DS    CL2                     NUMBER OF MANUALS
LSTUTIM  DS    CL5                     TIME ENTRY LAST UPDATED
CRETTIM  DS    CL5                     TIME ENTRY WAS CREATED
CIBTIME  DS    CL5                     LIBRARY UPDATE TIME
CIBJDATE DS    CL6                     LIBRARY UPDATE DATE (JULIAN)
CIBNAME  DS    CL20                    LIBRARY OWNER NAME
CIBLOC1  DS    CL20                    LIBRARY LOCATION 1
CIBLOC2  DS    CL20                    LIBRARY LOCATION 2
CIBLOC3  DS    CL20                    LIBRARY LOCATION 3
CIBLOC4  DS    CL20                    LIBRARY LOCATION 4
CIBLOC5  DS    CL20                    LIBRARY LOCATION 5
SUBMASK  DS    CL13                    SUBID/SUBLIB MASK
WORKLEN  EQU   *-WORKAREA
         END   SLSSSUBL

./ ADD NAME=$AMODE   0100-1998177-1998177-1143-00019-00019-00000-DCM080
         MACRO
         $AMODE &MODE,&WORK=R15
         AIF   ('&MODE' EQ '').ERR1
         AIF   ('&MODE' NE '24').MODE31
         LA    &WORK,*+4+2
         BSM   0,&WORK
         SPACE
         MEXIT
.*
.MODE31  AIF   ('&MODE' NE '31').ERR2
         LA    &WORK,*+4+4+2
         O     &WORK,=X'80000000'
         BSM   0,&WORK
         SPACE
         MEXIT
.ERR1    MNOTE 8,'Missing MODE'
         MEXIT
.ERR2    MNOTE 8,'Invalid MODE. Only 24 or 31 valid'
         MEND
./ ADD NAME=$BOX     0100-1998177-1998177-1143-00101-00101-00000-DCM080
         MACRO
&LABEL   $BOX  &COMM,&ID=,&TITLE=,&HEAD=,&CTL1=SPACE,&CTL2=SPACE,      -
               &PRINT=,&HDR=,&CTR=NO
         GBLB  &BOXID
         GBLC  &BOXHDR
         LCLB  &BCTR
         LCLA  &I,&J,&N
         LCLC  &BID,&BTITLE,&BCOMM,&BLANK,&CR
&CR      SETC  'DCM V0.8 Copyright Alfred Nykolyn 1992, 1994 '
&BLANK   SETC  '                                                       -
                              '
&BCTR    SETB  ('&CTR' EQ 'YES')
.*
.*       TURN PRINT ON IF NECESSARY
.*
         AIF   (T'&PRINT EQ 'O').TESTID
         PRINT ON
.*
.*       PICK UP ID FIELD
.*
.TESTID  AIF   ('&ID' EQ '' AND '&LABEL' EQ '').TESTHDR
         AIF   ('&ID' EQ '' OR '&LABEL' EQ '').TESTPRV
         MNOTE 4,'BOX001: ID specified twice - label field ignored'
.TESTPRV AIF   (NOT &BOXID).SETID
         MNOTE 4,'BOX002: ID already specified - this one ignored'
         AGO   .TESTHDR
.SETID   ANOP
&BOXID   SETB  1
&BID     SETC  '&ID'
         AIF   ('&ID' NE '').TESTHDR
&BID     SETC  '&LABEL'
.*
.*       PICK UP HEADER SPECIFICATION
.*
.TESTHDR AIF   (T'&HDR EQ 'O' AND T'&HEAD EQ 'O').TESTTTL
&BOXHDR  SETC  '&HDR&HEAD'
         AIF   ('&BOXHDR'(1,1) NE '''').TESTTTL
&BOXHDR  SETC  '&BOXHDR'(2,K'&BOXHDR-2)
.*
.*       PICK UP TITLE SPECIFICATION
.*
.TESTTTL AIF   (T'&TITLE EQ 'O').TSTCTL1
&BTITLE  SETC  '&TITLE'
         AIF   ('&BTITLE'(1,1) NE '''').GENTTL
&BTITLE  SETC  '&BTITLE'(2,K'&BTITLE-2)
.GENTTL  ANOP
&BID     TITLE '&CR&BOXHDR&BTITLE'
         AGO   .GENCOMM
.*
.*       GENERATE LISTING CONTROL IF APPROPRIATE
.*
.TSTCTL1 AIF   (T'&CTL1 EQ 'O').GENCOMM
         &CTL1
.*
.*       GENERATE COMMENTS
.*
.GENCOMM AIF   (T'&COMM EQ 'O').MEND
*---------------------------------------------------------------------*
*                                                                     *
&N       SETA  N'&SYSLIST
&I       SETA  1
.COMLOOP ANOP
&BCOMM   SETC  '&SYSLIST(&I)'
         AIF   ('&BCOMM' EQ '' OR '&BCOMM' EQ '''''').NXTCOMM
         AIF   ('&BCOMM'(1,1) NE '''').TESTLEN
&BCOMM   SETC  '&BCOMM'(2,K'&BCOMM-2)
.TESTLEN AIF   (K'&BCOMM LE 56).MNOTE
&J       SETA  56
.SCAN    AIF   ('&BCOMM'(&J,1) EQ ' ').MNOTE1
&J       SETA  &J-1
         AIF   (&J GE 10).SCAN
&J       SETA  56
.MNOTE1  AIF   (&BCTR).CENTRE1
&BTITLE  SETC  '&BLANK'(1,13).'&BCOMM'(1,&J-1).'&BLANK'
         AGO   .STAR1
.CENTRE1 ANOP
&BTITLE  SETC  '&BLANK'(1,32-&J/2).'&BCOMM'(1,&J-1).'&BLANK'
.STAR1   ANOP
&BTITLE  SETC  '&BTITLE'(1,68).'*'
         MNOTE *,'&BTITLE'
&BCOMM   SETC  '&BCOMM'(&J+1,K'&BCOMM-&J)
         AIF   (K'&BCOMM GE 56).TESTLEN
.MNOTE   AIF   (&BCTR).CENTRE
&BCOMM   SETC  '&BLANK'(1,13).'&BCOMM'.'&BLANK'
         AGO   .STAR
.CENTRE  ANOP
&BCOMM   SETC  '&BLANK'(1,(63-K'&BCOMM)/2).'&BCOMM'.'&BLANK'
.STAR    ANOP
&BCOMM   SETC  '&BCOMM'(1,68).'*'
         MNOTE *,'&BCOMM'
.NXTCOMM ANOP
&I       SETA  &I+1
         AIF   (&I LE &N).COMLOOP
*                                                                     *
*---------------------------------------------------------------------*
.*
.*       TEST SECOND LISTING CONTROL
.*
         AIF   (T'&CTL2 EQ 'O').MEND
         &CTL2
.MEND    MEND
./ ADD NAME=$CCW     0100-1998177-1998177-1143-00060-00060-00000-DCM080
         MACRO
         $CCW
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*              CCW  (FORMAT 0)                                        *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
CCW      DSECT
CCW0     DS    0F
CCWCC    DS    X                       COMMAND
CCWDATA  DS    AL3                     DATA ADDRESS
                                       SPACE
CCW1     DS    0F
CCWFLAGS DS    X                       FLAGS
$DC      EQU   X'80'                   DATA CHAINING
$CC      EQU   X'40'                   COMMAND CHAINING
$SLI     EQU   X'20'                   SUPPRESS INCORRECT LENGTH
$SKIP    EQU   X'10'                   SKIP DATA TRANSFER
$PCI     EQU   X'08'
$IDA     EQU   X'04'                   DATA ADDRESS -> IDAW
$SUSPEND EQU   X'02'                   SUPEND BEFORE EXECUTING THIS CCW
                                       SPACE
         DS    X                       RESERVED
CCWCNT   DS    H                       LENGTH
         SPACE
CCWLEN   EQU   *-CCW
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*              CCW CODES                                              *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
$WRITE   EQU   X'01'                   WRITE
$READ    EQU   X'02'                   READ
$NOP     EQU   X'03'                   NOOP
$SNS     EQU   X'04'                   SENSE
$SNSID   EQU   X'E4'                   SENSE ID
$SNSSS   EQU   X'54'                   SENSE SUBSYSTEM STATUS
$RDC     EQU   X'64'                   READ DEVICE CHARACTERISTICS
$PSF     EQU   X'27'                   PERFORM SUBSYSTEM FUNCTION
$SEEK    EQU   X'07'                   SEEK
$SEEKCC  EQU   X'0B'                   SEEK CYL
$SEEKHD  EQU   X'1B'                   SEEK HEAD
$SETSEC  EQU   X'23'                   SET SECTOR
$SIDEQ   EQU   X'31'                   SEARCH ID EQUAL
$TIC     EQU   X'08'                   TRANSFER IN CHANNEL
$MT      EQU   X'80'                   MULTI TRACK
$LR      EQU   X'47'                   LOCATE RECORD
                                       SPACE
$WCKD    EQU   X'1D'                   WRITE COUNT KEY AND DATA
$WD      EQU   X'05'                   WRITE DATA
$RD      EQU   X'06'                   READ  DATA
$RT      EQU   X'5E'                   READ  TRACK
$RSD     EQU   X'3E'                   READ  SUBSYSTEM STATUS
$RCD     EQU   X'FA'                   READ  CONFIGURATION DATA
                                       SPACE
         MEND
./ ADD NAME=$CMB     0100-1998177-1998177-1143-00020-00020-00000-DCM080
         MACRO
         $CMB
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        CHANNEL MEASUREMENT BLOCK                                    *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
CMB      DSECT
         SPACE
CMBSSCHC DS    XL2                     SSCH COUNT
CMBSAMPC DS    XL2                     SSCH'S WITH MEASUREMENT
CMBCONNT DS    F                       DEVICE CONNECT TIME (128*USECS)
CMBPENDT DS    F                       DEVICE PENDING TIME (128*USECS)
CMBDISCT DS    F                       DEVICE DISCONN TIME (128*USECS)
         DS    4F                      RESERVED
         SPACE
$CMBLEN  EQU   *-CMB
         MEND
./ ADD NAME=$DAB     0100-1998177-1998177-1143-00141-00141-00000-DCM080
         MACRO
         $DAB
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        DCM    ANCHOR BLOCK                                          *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
DAB      DSECT
         DS    72F                     Savarea stack
         SPACE
WA       DS    D                       Workarea
WA2      DS    D                       Workarea
         SPACE
D_PATHS  DS    D                       Chpids
         SPACE
D_FLAGS  DS    0F                      Flags
D_FLG1   DS    X                       First flag
$OPENOK  EQU   B'00000001'             Monitor file open
$NEWFILE EQU   B'00000010'             Monitor file data create
$IOERR   EQU   B'00000100'             Excp i/o error
$OFFLINE EQU   B'00001000'             Device offline
$TERMERR EQU   B'00010000'             Terminating error
$FSCRN   EQU   B'00100000'             Full screen message issued
$SWITCH  EQU   B'01000000'             Switches formatted
$CAPTURE EQU   B'10000000'             Screen capture log available
                                       SPACE
IN_FLGS  DS    X                       Second flag
$DELTA   EQU   B'00000001'             %statistics- short or long
$RUN     EQU   B'00000010'             Cycle through all devices
$AUTO    EQU   B'00000100'             Auto update
$ALL     EQU   B'00001000'             Report on all devices
$GENERIC EQU   B'00010000'             Report on device string
$HIST    EQU   B'00100000'             Rates- short or long
$NOUPD   EQU   B'01000000'             Do not update history file
$FINI    EQU   B'10000000'             Finished
         DS    H
                                       SPACE
D_DEVST  DS    H                       Device status
D_CUST   DS    H                       CU     status
                                       SPACE
$DEVS    EQU   64                      Devices/cu
D_CU     DS    F                       Controller base address
D_DEV    DS    F                       Device to report
D_DEVOFF DS    F                       Device offset from base
D_DEV#   DS    F                       Number of devices to report
D_DEVF   DS    A                       First active device in cu
D_DEVL   DS    A                       Last  active
                                       SPACE
D_NEW@   DS    A                       New monitor data
D_OLD@   DS    A                       Old monitor data
D_FILE@  DS    A                       Old monitor data (from file)
D_SCRN@  DS    A                       Display area
D_NMB@   DS    A                       New mb area
D_OMB@   DS    A                       Old mb area
                                       SPACE
D_UCB@   DS    A                       UCB address (MONITOR file)
D_CMB@   DS    A                       CMB address
D_UCMBS@ DS    A                       UCB+CMB table
                                       SPACE
D_RSD#   DS    F                       # devices returned in rsd
D_SSDOFF DS    F                       Offset in ssd record
                                       SPACE
D_DUR    DS    F                       Interval duration
D_REPCNT DS    F                       Repeat count (from user)
D_REPREM DS    F                       Repeat count remaining
                                       SPACE
D_SAMPC  DS    F                       Total sample count
D_CONNT  DS    F                       Total connect time
D_PENDT  DS    F                       Total pending time
D_DISCT  DS    F                       Total disconn time
D_CMBLN  EQU   *-D_SAMPC               Length
                                       SPACE
D_SWITCH DS    F                       7980-3 enable/disable switches
D_ERROR  DS    F                       Error number
D_OPN    DS    F                       Open/close parm list
MONDCB   DS    XL(DCBLEN)              Monitor file
CAPDCB   DS    XL(DCBLEN)              Capture file
D_JFCB@  DS    A                       Jfcb pointer
$JFCB    EQU   X'07'
                                       SPACE
ECB      DS    F                       Ecb for excp
IOBAREA  DS    XL(IOBLEN)              Iob
                                       SPACE
P1CCW    DS    0D
P1LR     CCW   $LR,*-*,$CC,16          Locate record
P1RD     CCW   $RD,*-*,$SLI,*-*        Read/write data
P1WCKDD  CCW   $WCKD,*-*,0,*-*         Write count key data (data )
P1WCKDC  CCW   $WCKD,*-*,$DC,8         Write count key data (count)
                                       SPACE
P2CCW    DS    0D
P2PSF    CCW   $PSF,*-*,$CC,12         Perform subsystem function
P2RSD    CCW   $RSD,*-*,$SLI,*-*       Read subsystem data
P2RDC    CCW   $RDC,*-*,$CC+$SKIP,64   Read device chracteristics
P2SSS    CCW   $SNSSS,*-*,0,40         Sense subsystem status
                                       SPACE
P3RCD    CCW   $RCD,*-*,$CC+$SLI,256   Read configuration data
P3SNSID  CCW   $SNSID,*-*,0,12         Sense id
                                       SPACE
PSFPARM  DS    X'18000000'             Paramters for      0-3
         DS    X'000001FF'               read subsystem   4-7
         DS    X'00000000'                 data           8-11
                                       SPACE
D_WAIT   DS    F                       Wait interval
LRPARM   DS    XL16                    Locate record parmameters
                                       SPACE
CC1      DS    XL2                     Count + key area
HH1      DS    XL2
RR1      DS    XL1
KK1      DS    XL1
DL1      DS    XL2
                                       SPACE
D_INPUT  DS    CL8                     Input area
                                       SPACE
DATEF    DS    0CL14                   Old monitor date/time
DATEDF   DS    CL6
         ORG   DATEDF+4
TIMEF    DS    CL10
D_SERIAL DS    CL6                     CU serial #
                                       SPACE
*   DELTAS OF ALL SUBSYSTEM RECORDS
*   KEEP IN SAME ORDER AS SSR LAYOUT
         DS    0D
DSSR     DS    XL(STATSLEN)            Delta statistics
                                       SPACE
         DS    0D
CSSR     DS    XL(STATSLEN)            Cumulative statistics
                                       SPACE
D_ERRMSG DS    CL72                    Error message
                                       SPACE
         DS    0D
SSSAREA  DS    XL64                    Sense subsystem status area
SNIDAREA DS    XL16                    Sense id
                                       SPACE
U_PARM   DS    CL128                   Ucbscan parm list
U_DEV    DS    H
         DS    0D
                                       SPACE
DABLEN   EQU   *-DAB
         MEND
./ ADD NAME=$DCB     0100-1998177-1998177-1143-00020-00020-00000-DCM080
         MACRO
         $DCB
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        PROTOTYPE DCB                                                *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
D_DCB    DSECT
*        DCB   MACRF=PM,DSORG=PS,DEVD=DA,RECFM=FB,LRECL=*-*,           *
               DDNAME=*-*,EXLST=*-*,BLKSIZE=*-*
         PUSH  PRINT
         PRINT NOGEN
MODELDCB DCB   MACRF=PM,DSORG=PS,DEVD=DA,RECFM=FB,LRECL=*-*,           *
               DDNAME=*-*,EXLST=*-*,BLKSIZE=*-*
         POP   PRINT
DCBLEN   EQU   *-MODELDCB
                                   SPACE
         MEND
./ ADD NAME=$DEB     0100-1998177-1998177-1143-00018-00018-00000-DCM080
         MACRO
         $DEB
*---------------------------------------------------------------------*
*                                                                     *
*              DEB                                                    *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
DEB      DSECT
DEBDVMOD EQU   DEB+32,1
DEBUCBA  EQU   DEB+33,3
DEBSTRCC EQU   DEB+38,2
DEBSTRHH EQU   DEB+40,2
DEBENDCC EQU   DEB+42,2
DEBENDHH EQU   DEB+44,2
DEBNMTRK EQU   DEB+46,2
         SPACE
         MEND
./ ADD NAME=$ERRCODE 0100-1998177-1998177-1143-00017-00017-00000-DCM080
         MACRO
         $ERRCODE
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*              ERROR CODES                                            *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
$ERR_OPEN      EQU  1                  Open fail
$ERR_CTLB      EQU  2                  Control block chain error
$ERR_CU        EQU  3                  Not a 7980-3 control unit
$ERR_VOL       EQU  4                  Unable to find volume
$ERR_IO        EQU  9                  I/o error
$ERR_CHARS     EQU  13                 Invalid characters
                                       SPACE
         MEND
./ ADD NAME=$IC      0100-1998177-1998177-1143-00004-00004-00000-DCM080
         MACRO
&LABEL   $IC
&LABEL   DC    X'13'
         MEND
./ ADD NAME=$IOB     0100-1998177-1998177-1143-00067-00067-00000-DCM080
         MACRO
         $IOB
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*              IOB                                                    *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
IOB      DSECT
         DS    0F
IOBFLAG1 DS    X
$IOBDC   EQU   X'80'               DATA CHAINING
$IOBCC   EQU   X'40'               COMMAND CHAINING
$IOBNRL  EQU   X'02'               UN-RELATED REQUEST
                                   SPACE
IOBFLAG2 DS    X
IOBSENSE DS    0H
IOBSENS0 DS    X
$CMDREJ  EQU   X'80'               COMMAND REJECT
$INTREQ  EQU   X'40'               INTERVENTION REQUIRED
$BUSOUT  EQU   X'20'               BUS OUT PARITY ERROR
$EQCHK   EQU   X'10'               EQUIPMENT CHECK
$DATACHK EQU   X'08'               DATA CHECK
$OVRUN   EQU   X'04'               OVERRUN
IOBSENS1 DS    X
$PERMERR EQU   X'80'               PERMANENT ERROR
$INVALTR EQU   X'40'               INVALID TRACK FORMAT
$ENDCYL  EQU   X'20'               END OF CYLINDER
$MSGTOOP EQU   X'10'               MESSAGE TO OPERATOR
$NRF     EQU   X'08'               NO RECORD FOUND
$FPROT   EQU   X'04'               FILE PROTECT
$WRINHIB EQU   X'02'               WRITE INHIBITED
$IMPREND EQU   X'01'               IMPRECISE END
                                   SPACE
IOBECB   DS    A                   ECB ADDRESS
$IOOK    EQU   X'7F'               I/O COMPLETED OK
$IOPERM  EQU   X'41'               I/O COMPLETED WITH PERMANENT ERROR
$IOXTNT  EQU   X'42'               EXTENT VIOLATION
$IOINT   EQU   X'44'               CHANNEL PGM INTERCEPTED
$IORQPUR EQU   X'48'               CHANNEL PGM INTERCEPTED
$IO4B    EQU   X'4B'
$IORCVF  EQU   X'4F'               ERROR RECOVERY ENTERED BUT FAILED
                                   SPACE
IOBCSW   DS    2F                  CSW
         ORG   IOBCSW
IOBCSW1  DS    F
IOBCSW2  DS    F
                                   SPACE
IOBCCW   DS    A                   CCW ADDRESS
IOBDCB   DS    A                   DCB ADDRESS
         DC    F'0'
         DC    H'0'
         DC    H'0'
                                   SPACE
IOBSEEK  DS    0D
IOBM     DS    X
IOBBCHR  DS    0XL7
IOBBB    DS    XL2
IOBCCHHR DS    0XL5
IOBCC    DS    XL2
IOBHH    DS    XL2
IOBR     DS    X
         SPACE
IOBLEN   EQU   *-IOB
         SPACE
         MEND
./ ADD NAME=$LRD     0100-1998177-1998177-1143-00044-00044-00000-DCM080
         MACRO
         $LRD
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        LOCATE RECORD DESCRIPTOR                                     *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
LRD      DSECT
LR_OP    DC    X'00'                   Orientation + operation
$LR_CA   EQU   B'00000000'             Count area orientation
$LR_HA   EQU   B'01000000'             Home  addr orientation
$LR_DA   EQU   B'10000000'             Data  area orientation
$LR_IN   EQU   B'11000000'             Index      orientation
                                       SPACE
$LR_OR   EQU   B'00000000'             Orient
$LR_WD   EQU   B'00000001'             Write data
$LR_FW   EQU   B'00000011'             Format write
$LR_RD   EQU   B'00000110'             Read
$LR_WT   EQU   B'00001011'             Write track
$LR_RT   EQU   B'00001100'             Read tracks
$LR_RE   EQU   B'00010110'             Read
                                       SPACE
LR_AUX   DC    X'00'
$LR_TLF  EQU   B'10000000'             TLF present
$LR_RCNT EQU   B'00000001'             Last ccw is a read count
                                       SPACE
         DC    X'00'
LR_COUNT DC    X'00'                   # following ccws
LR_SEEK  DC    XL4'00'                 Seek address
         ORG   LR_SEEK
LR_CC0   DC    XL2'00'                 Cyl
LR_HH0   DC    XL2'00'                 Track
                                       SPACE
LR_SRCH  DC    XL5'00'                 Search addrress
         ORG   LR_SRCH
LR_CC1   DC    XL2'00'                 Cyl
LR_HH1   DC    XL2'00'                 Track
LR_R     DC    X'00'                   Record
LR_SEC   DC    X'00'                   Sector
LR_TLF   DC    XL2'00'                 Transfer length factor
         SPACE
         MEND
./ ADD NAME=$MODID   0100-1998177-1998177-1143-00019-00019-00000-DCM080
         MACRO
         $MODID &BR=NO
         LCLC  &NDX
&NDX     SETC  '&SYSNDX'
         AIF   ('&BR' EQ 'NO').NOBR
         B     AN&NDX-*(,R15)
.NOBR    SPACE 1
.*       PUSH  PRINT
.*       PRINT DATA
         DC    AL1(8+8)                Set id length
         DC    CL8'&SYSECT'            Csect name
         DC    CL8'&SYSDATE'           Assembly date
         DC    CL47' DCM V0.8 (C) COPYRIGHT ALFRED NYKOLYN 1992 1994'
         SPACE 1
.*       POP   PRINT
         AIF   ('&BR' EQ 'NO').NOLAB
AN&NDX   DS    0H                      Start it up
.NOLAB   ANOP
         MEND
./ ADD NAME=$MONREC  0100-1998177-1998177-1143-00023-00023-00000-DCM080
         MACRO
         $MONREC
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        MONITOR RECORD                                               *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
MONREC   DSECT
         SPACE
MON_ID   DC    CL4'*DCM'               Identifier
MON_LEN  DS    F                       Record length 6144+24=6168
MON_DTE  DS    PL4                     Date yymmm
MON_TME  DS    F                       Time hhmmsshh
MON_TOD  DS    2F                      Time in tod format
MON_CUA  DS    F                       Control unit address
         DS    F
$MONHDLN EQU   *-MONREC                Header length
         SPACE
MON_SSR  DS    0D                      Subsystem status records start
         SPACE
         MEND
./ ADD NAME=$MORG    0100-1998177-1998177-1143-00019-00019-00000-DCM080
         MACRO
&LABEL   $MORG  &MOD,&FILL=X'00'
.*    $MORG(modulus origin) - macro to change location ctr to
.*        specified boundary
.*     LABEL - optional (defaults to &SYSECT) - specifies origin
.*        of module to be $MORG'd
.*     MOD - required. specifies modulus desired
.*     FILL - specifies fill characters desired
         AIF   (T'&MOD EQ 'O').ERR01
         AIF   (T'&LABEL EQ 'O').CSECT
         DC    (((*-&LABEL-1)/&MOD)*&MOD+&MOD+&LABEL-*)&FILL
         MEXIT
.CSECT   AIF   ('&SYSECT' EQ '').ERR02
         DC    (((*-&SYSECT-1)/&MOD)*&MOD+&MOD+&SYSECT-*)&FILL
         MEXIT
.ERR01   MNOTE 4,'Modulus value omitted - but is required'
         MEXIT
.ERR02   MNOTE 4,'Lable omitted in blank csect'
         MEND
./ ADD NAME=$OPEN    0100-1998177-1998177-1143-00027-00027-00000-DCM080
         MACRO
         $OPEN
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*              OPEN/CLOSE  PARAMETER LIST                             *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
OPNCLSD  DSECT
         OPEN  *-*,MF=L
         SPACE
$LAST    EQU   X'80'
$DISP    EQU   X'00'
$LEAVE   EQU   X'30'
$REREAD  EQU   X'10'
$INPUT   EQU   X'00'
$OUTPUT  EQU   X'0F'
$UPDAT   EQU   X'04'
$OUTIN   EQU   X'07'
$INOUT   EQU   X'03'
$RDBACK  EQU   X'01'
$OUTINX  EQU   X'06'
         SPACE
OPNCLSL  EQU   *-OPNCLSD
         SPACE
         MEND
./ ADD NAME=$RCDD    0100-1998177-1998177-1143-00067-00067-00000-DCM080
         MACRO
         $RCDD
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        READ CONFIGURATION DATA                                      *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
RCD      DSECT
         SPACE
RCDFLAG1 DS    X                       Flags
RCDNED1  DS    X                       Node element descriptor
RCDCLS1  DS    X                       Class
         DS    X
RCDTYP1  DS    XL6                     Device type
RCDMODL1 DS    XL3                     Device model
RCDMAN1  DS    CL3                     Hda manufacurer
RCDLOC1  DS    CL2                     Hda manufacurer location
RCDSER1  DS    CL12                    Hda serial#
RCDTAG1  DS    XL2                     Id tag
                                       SPACE
RCDFLAG2 DS    X                       Flags
RCDNED2  DS    X                       Node element descriptor
         DS    XL2
RCDTYP2  DS    XL6                     Device type
RCDMODL2 DS    XL3                     Device model
RCDMAN2  DS    CL3                     Dasd manufacurer
RCDLOC2  DS    CL2                     Dasd manufacurer location
RCDSER2  DS    CL12                    Dasd serial#
RCDTAG2  DS    XL2                     Id tag
                                       SPACE
RCDFLAG3 DS    X                       Flags
RCDNED3  DS    X                       Node element descriptor
         DS    XL2
RCDTYP3  DS    XL6                     Device type
RCDMODL3 DS    XL3                     Device model
RCDMAN3  DS    CL3                     SCU manufacurer
RCDLOC3  DS    CL2                     SCU manufacurer location
RCDSER3  DS    CL12                    SCU serial#
RCDTAG3  DS    XL2                     ID tag
                                       SPACE
RCDFLAG4 DS    X                       Flags
RCDNED4  DS    X                       Node element descriptor
         DC    XL2'00001'
RCDTYP4  DS    XL6                     Device type
         DC    CL3' '                  Blanks
RCDMAN4  DS    CL3                     Scu manufacurer
RCDLOC4  DS    CL2                     Scu manufacurer location
RCDSER4  DS    0CL12                   Scu serial#
         DS    CL6                     Scu serial# - 1st half
RCDSER24 DS    CL6                     Scu serial# - 2nd half
RCDTAG4  DS    XL2                     Id tag
         DS    XL96                    Zeros
                                       SPACE
RCDFLAG5 DS    X                       Flags
RCDSEL4  DS    X                       Node element descriptor
RCDINTF  DS    XL2                     Interface id
         DS    XL4'00'                 Zeros
RCDSSID  DS    XL2                     Ssid
RCDCLID  DS    X                       Cluster id
RCDCUA   DS    X                       Unit address
RCDLDVA  DS    X                       Logical device address
RCDPDVA  DS    X 2                     Physical device address
         DS    XL18'00'                Zeros
$RCDLEN  EQU   *-RCD
         MEND
./ ADD NAME=$RDCD    0100-1998177-1998177-1143-00056-00056-00000-DCM080
         MACRO
         $RDCD
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        READ DEVICE CHARACTERISTI CS                                 *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
RDC      DSECT
         SPACE
RDCCUTYP DS    XL2                     Cu type
RDCCUMOD DS    X                       Cu model
RDCDVTYP DS    XL2                     Device type
RDCDVMOD DS    X                       Device model
                                       SPACE
RDCCTL1  DS    X                       Control facilities 1
$RDCDEV  EQU   B'10000000'             3380 j, k or 3390
$RDCRDTR EQU   B'01000000'             Read track support
$RDCRD   EQU   B'00010000'             Read       support
                                       SPACE
RDCCTL2  DS    X                       Control facilities 2
RDCCTL3  DS    X                       Control facilities 3
                                       SPACE
RDCCTL4  DS    X                       Control facilities 3
$RDCCFW  EQU   B'10000000'             CFW              SUPPORTED
$RDCCASH EQU   B'00010000'             Cache            supported
$RDCDUAL EQU   B'00001000'             Dual copy        supported
$RDCDFW  EQU   B'00000100'             DFW              SUPPORTED
$RDCRA   EQU   B'00000010'             Reset allegiance supported
$RDCSN32 EQU   B'00000001'             32 byte sense    supported
                                       SPACE
RDCCLASS DS    X                       Device class code
RDCDVTYC DS    X                       Device type code
RDCPRI#  DS    XL2                     # primary cyls
RDCTRK#  DS    XL2                     # tracks/cyl
RDCSEC#  DS    X                       # sectors
RDCUTRK  DS    XL3                     Useable track length
RDCHALN  DS    XL2                     HA + R0 LENGTH
RDCCAP1  DS    X                       Track capacity calc 1
RDCCAP2  DS    XL5                     Track capacity calc 2
RDCALT   DS    XL2                     First alt cylinder
RDCALT#  DS    XL2                     # alternate tracks
RDCDIAG  DS    XL2                     First diag cyl
RDCDIAG# DS    XL2                     # diag tracks
RDCDVSP  DS    XL2                     First device support cyl
RDCDVSP# DS    XL2                     # device support tracks
RDCMDR   DS    X                       MDR ID
RDCOBR   DS    X                       OBR ID
RDCSCUTY DS    X 2                     SC TYPE CODE
         DS    X
RDCMAXLN DS    XL2                     Max r0 data length
         DS    XL18
                                       SPACE
$RDCLEN  EQU   *-RDC
         MEND
./ ADD NAME=$REGS    0100-1998177-1998177-1143-00026-00026-00000-DCM080
         MACRO
         $REGS
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*              R E G I S T E R S                                      *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         MEND
./ ADD NAME=$SBA     0100-1998177-1998177-1143-00047-00047-00000-DCM080
         MACRO
&LABEL   $SBA  &ROW,&COL,&SF=
.*   Macro to generate buffer addresses for 3270
.*   Use as follows:
.*        $SBA   X,Y
.*   or   $SBA   X,Y,SF=U
.*   where X,Y specify a buffer address in row-column form
.*   and SF indicates a start field.
         LCLA  &A,&B,&J
         AIF   ('&SYSLIST(1)' EQ '').ERR01
         AIF   (N'&SYSLIST NE 2).ERR02
         AIF   (&ROW GT 24 OR &ROW EQ 0).ERR03
         AIF   (&COL GT 80 OR &COL EQ 0).ERR04
&B       SETA  80*(&ROW-1)+&COL-1
         AIF   (&B LT 64).SETHI
&A       SETA  &B/64
&B       SETA  &B-64*&A
.SETHI   ANOP
&A       SETA  &A+64
&B       SETA  &B+64
&J       SETA  &A-(&A/64)*64
         AIF   (&J EQ 0 OR &J GE 58).TESTB
         AIF   (&J GE 10 AND &J LE 16).TESTB
         AIF   (&J GE 26 AND &J LE 33).TESTB
         AIF   (&J GE 42 AND &J LE 47).TESTB
&A       SETA  &A+128
.TESTB   ANOP
&J       SETA  &B-(&B/64)*64
         AIF   (&J EQ 0 OR &J GE 58).GEN
         AIF   (&J GE 10 AND &J LE 16).GEN
         AIF   (&J GE 26 AND &J LE 33).GEN
         AIF   (&J GE 42 AND &J LE 47).GEN
&B       SETA  &B+128
.GEN     ANOP
&LABEL   DC    AL1(17),AL1(&A,&B)
         AIF   (T'&SF EQ 'O').MEXIT
         $SF   &SF(1),&SF(2),&SF(3),&SF(4),&SF(5)
.MEXIT   MEXIT
.ERR01   MNOTE 8,'Buffer address omitted'
         MEXIT
.ERR02   MNOTE 8,'Incorrect number of operands (must be 2)'
         MEXIT
.ERR03   MNOTE 8,'Row number &ROW is not in range 1-24'
         MEXIT
.ERR04   MNOTE 8,'Column number &COL is not in range 1-80'
         MEXIT
         MEND
./ ADD NAME=$SCREEN  0100-1998177-1998177-1143-00211-00211-00000-DCM080
         MACRO
         $SCREEN   &DSECT=YES
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        SCREEN DESCRIPTOR                                            *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
         AIF   ('&DSECT' NE 'YES').NODSECT
SCREEN   DSECT
.NODSECT ANOP
SC_HDR   DC    X'C3'                   PROLOGUE
         $SBA  1,1,SF=(HI,P)
SCREF    DC    C'Auto'
SCREF#   DC    CL4' >10'
         $SBA  1,20,SF=(HI,P)
         DC    C'Dirt Cheap Monitor V0.8'
         $SBA  1,64,SF=(LO,P)
SCDATE   DC    CL5' '
SCTIME   DC    CL9' '
         $SBA  2,1,SF=(LO,P)
         DC    C'Devices '
SDEVICES DC    XL10'00'
         DC    C'  Ssid '
SCSSID   DC    CL4' '
         $SBA  2,40,SF=(LO,P)
         DC    C'I/O rates measured from'
         $SBA  2,64,SF=(LO,P)
SODATE   DC    CL5' '
SOTIME   DC    CL9' '
         $SBA  3,1,SF=(LO,P)
         DC    C' Volume '
SVOL     DC    CL6' '
         DC    C'   DevAddr '
SDEV0    DC    CL12' '
         ORG   SDEV0+5
SDEV1    DC    CL7' '
         $SBA  3,40,SF=(LO,P)
         DC    C'SSCH rate'
SIOCH    DC    CL7' '
         DC    C'/s'
         $SBA  4,1,SF=(LO,P)
         DC    C'  Paths '
SPATHS   DC    CL24' '
         $SBA  4,40,SF=(LO,P)
SDPLX    DC    C'Duplexed: '
SDPLPS   DC    C'Secondary device'
         DC    C' '
SDPLDEV  DC    CL3' '
SDPLLN   EQU   *-SDPLX
         $SBA  5,1,SF=(LO,P)
         DC    C'Cache: '
SCASHST  DC    C'Not Available'
         $SBA  5,25,SF=(LO,P)
         DC    C'DFW: '
SDFWST   DC    C'Not available'
         $SBA  5,48,SF=(HI,P)
SPINST   DC    C'Pinned data'
         $SBA  7,1,SF=(LO,P)
         DC    C'   I/O time(ms)'
SIOTT    DC    CL7' '
         DC    C'   Pend'
SIOPT    DC    CL7' '
         DC    C'   Disc'
SIODT    DC    CL7' '
         DC    C'   Conn'
SIOCT    DC    CL7' '
         $SBA  8,1,SF=(LO,P)
         DC    C'     I/O'
STIO     DC    CL7' '
         DC    C'/s     Reads'
STRD     DC    CL7' '
         DC    C'/s    Writes'
STWR     DC    CL7' '
         DC    C'/s '
         $SBA  8,60
SDELTAR  DC    C'Short'
         DC    C' term I/O rates'
         $SBA  9,1,SF=(LO,P)
         DC    C'  Normal'
SNIO     DC    CL7' '
         DC    C'/s     Reads'
SNRD     DC    CL7' '
         DC    C'/s    Writes'
SNWR     DC    CL7' '
         DC    C'/s '
         $SBA  9,60
SDELTAP  DC    C'Short'
         DC    C' term hit%'
         $SBA  10,1,SF=(LO,P)
         DC    C'    Seql'
SSQ      DC    CL7' '
         DC    C'/s     Reads'
SSQRD    DC    CL7' '
         DC    C'/s    Writes'
SSQWR    DC    CL7' '
         DC    C'/s'
         $SBA  11,1,SF=(LO,P)
         DC    C'     CFW'
SCFWIO   DC    CL7' '
         DC    C'/s     Reads'
SCFWRD   DC    CL7' '
         DC    C'/s    Writes'
SCFWWR   DC    CL7' '
         DC    C'/s '
         $SBA  12,1,SF=(LO,P)
         DC    C'     DFW'
SDFWIO   DC    CL7' '
         DC    C'/s    Normal'
SDFWWRN  DC    CL7' '
         DC    C'/s      Seql'
SDFWSQ   DC    CL7' '
         DC    C'/s '
SSWCHS   EQU   *
         $SBA  10,66
         DC    C'--Switches--'
         $SBA  11,66
         DC    C'SD0: '
SSWCH0   DC    CL8' '
         $SBA  12,66
         DC    C'SD1: '
SSWCH1   DC    CL8' '
         $SBA  13,66
         DC    C'SD2: '
SSWCH2   DC    CL8' '
         $SBA  14,66
         DC    C'SD3: '
SSWCH3   DC    CL8' '
$SWCHLEN EQU   *-SSWCHS
         $SBA  13,1,SF=(LO,P)
         DC    C'  Bypass'
SBYPASS  DC    CL7' '
         DC    C'/s   Inhibit'
SINHIB   DC    CL7' '
         DC    C'/s'
         $SBA  15,60
         DC    C'CU serial#   '
SSERIAL# DC    CL6' '
         $SBA  14,1,SF=(LO,P)
         DC    C'  Stages'
STDTC    DC    CL7' '
         DC    C'/s    Normal'
SDTCNRM  DC    CL7' '
         DC    C'/s  Seql '
SDTCSQ   DC    CL7' '
         DC    C'/s'
         $SBA  15,1,SF=(LO,P)
         DC    C'DeStages'
STCTD    DC    CL7' '
         DC    C'/s'
         DC    C'  PreReads'
STPRD    DC    CL7' '
         DC    C'/s'
         $SBA  16,1
         DC    C'Read Hit%'
STRDH    DC    CL7' '
         DC    C'     Normal%'
SNRMRDH  DC    CL7' '
         DC    C'    Seql%'
SSQLRDH  DC    CL7' '
         $SBA  16,55
         DC    C'Cache installed'
SCAINST  DC    CL8' '
         DC    C'K'
         $SBA  17,1
         DC    C' CFW Hit%'
STCFH    DC    CL7' '
         DC    C'       Read%'
SCFWRDH  DC    CL7' '
         DC    C'   Write%'
SCFWWRH  DC    CL7' '
         $SBA  17,55
         DC    C'Cache available'
SCAAVAIL DC    CL8' '
         DC    C'K'
         $SBA  18,1
         DC    C' DFW Hit%'
STDFH    DC    CL7' '
         DC    C'     Normal%'
SNRMDFH  DC    CL7' '
         DC    C'    Seql%'
SSQLDFH  DC    CL7' '
         $SBA  18,55
         DC    C'  NVS installed'
SNVSINST DC    CL8' '
         DC    C'K'
         $SBA  19,1
         DC    C'R/W ratio'
STRW     DC    CL7' '
         DC    C'  Hits/Stage'
SHTSTG   DC    CL7' '
         DC    C'   Retry%'
SRTRYS   DC    CL7' '
         $SBA  19,55
         DC    C'    Pinned data'
SPINNVS  DC    CL8' '
         DC    C'K'
         $SBA  21,1,SF=(LO,P)
         DC    C'Enter: SR, LR, SH, LH, All, Onl, '
         DC    C'Auto, <dev-addr>, <volume> or End'
         $SBA  22,8,SF=(LO,U,MDT)
         DC    CL6' '
         $SBA  22,15,SF=(HI,P)
         $SBA  24,1
SERRMSG  DC    XL72'00'
         $SBA  22,9
         $IC
$SCRNLEN EQU   *-SC_HDR
         SPACE
         MEND
./ ADD NAME=$SF      0100-1998177-1998177-1143-00066-00066-00000-DCM080
         MACRO
&LABEL   $SF
.*    Macro to generate field seperators for 3270
.*    use:   $SF   U,LO,A,MDT
.*                 P HI N
.*                   NO S
.*    where U/P specify unprotected/protected; LO/HI/NO specify
.*    display intensity; A/N/S sepcify alphanumeric/numeric/skip;
.*    MDT specifies that modified data tag is to be on.
.*    Operands may appear in any order
         LCLA  &PROT,&INTEN,&NUM,&MDT,&SF,&I
         LCLC  &OP
&SF      SETA  64
&I       SETA  1
.LOOP    AIF   ('&SYSLIST(&I)' EQ '').NEXT
&OP      SETC  '&SYSLIST(&I)'
         AIF   ('&OP' NE 'U' AND '&OP' NE 'P').TINTEN
         AIF   (&PROT NE 0).ERPROT
&PROT    SETA  &I
         AIF   ('&OP' EQ 'U').NEXT
&SF      SETA  &SF+32
         AGO   .NEXT
.TINTEN  AIF   ('&OP' NE 'HI' AND '&OP' NE 'LO' AND '&OP' NE 'NO').TNUM
         AIF   (&INTEN NE 0).ERINTEN
&INTEN   SETA  &I
         AIF   ('&OP' EQ 'LO').NEXT
&SF      SETA  &SF+8
         AIF   ('&OP' EQ 'HI').NEXT
&SF      SETA  &SF+4
         AGO   .NEXT
.TNUM    AIF   ('&OP' NE 'N' AND '&OP' NE 'A' AND '&OP' NE 'S').TMDT
         AIF   (&NUM NE 0).ERNUM
&NUM     SETA  &I
         AIF   ('&OP' EQ 'A').NEXT
&SF      SETA  &SF+16
         AGO   .NEXT
.TMDT    AIF   ('&OP' NE 'MDT').ERUNKN
         AIF   (&MDT NE 0).ERMDT
&MDT     SETA  &I
&SF      SETA  &SF+1
.NEXT    ANOP
&I       SETA  &I+1
         AIF   (&I LE N'&SYSLIST).LOOP
&I       SETA  &SF-(&SF/64)*64
         AIF   (&I EQ 0 OR &I GE 58).GEN
         AIF   (&I GE 10 AND &I LE 16).GEN
         AIF   (&I GE 26 AND &I LE 33).GEN
         AIF   (&I GE 42 AND &I LE 47).GEN
&SF      SETA  &SF+128
.GEN     ANOP
&LABEL   DC    AL1(29),AL1(&SF)
         MEXIT
.ERPROT  MNOTE 8,'Operand &I (&OP) ignored - &SYSLIST(&PROT) already sp-
               ecified'
         AGO   .NEXT
.ERNUM   MNOTE 8,'Operand &I (&OP) ignored - &SYSLIST(&NUM) already spe-
               cified'
         AGO   .NEXT
.ERINTEN MNOTE 8,'Operand &I (&OP) ignored - &SYSLIST(&INTEN) already s-
               pecified'
         AGO   .NEXT
.ERMDT   MNOTE 8,'Operand &I ignored - MDT already specified'
         AGO   .NEXT
.ERUNKN  MNOTE 8,'Operand &I (&OP) ignored - unknown specification'
         AGO   .NEXT
         MEND
./ ADD NAME=$SPSD    0100-1998177-1998177-1143-00032-00032-00000-DCM080
         MACRO
         $SPSD
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        STORAG PATH STATUS RECORD                                    *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
SPS      DSECT
*    STORAGE PATH 0
SPSFLAG0 DS    X                       Storage path status
SPSCHP0  DS    X                       Channels configured
SPSSWCH0 DS    X                       Enable/disable switches
SPSFENC0 DS    X                       Channels fenced
*    STORAGE PATH 1
SPSFLAG1 DS    X                       Storage path status
SPSCHP1  DS    X                       Channels configured
SPSSWCH1 DS    X                       Enable/disable switches
SPSFENC1 DS    X                       Channels fenced
*    STORAGE PATH 2
SPSFLAG2 DS    X                       Storage path status
SPSCHP2  DS    X                       Channels configured
SPSSWCH2 DS    X                       Enable/disable switches
SPSFENC2 DS    X                       Channels fenced
*    STORAGE PATH 3
SPSFLAG3 DS    X                       Storage path status
SPSCHP3  DS    X                       Channels configured
SPSSWCH3 DS    X                       Enable/disable switches
SPSFENC3 DS    X                       Channels fenced
SPSLEN   EQU   *-SPS
         MEND
./ ADD NAME=$SSRD    0100-1998177-1998177-1143-00052-00052-00000-DCM080
         MACRO
         $SSRD
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        SUBSYSTEM STATUS RECORD                                      *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
SSR      DSECT
         SPACE
S_FLAGS  DS    XL1                     Flags
$NOCACHE EQU   B'10000000'             Cache not available
UA       DS    X                       Device unit address
DEVSTAT1 DS    XL2                     Device status - group 1
         SPACE
RD#      DS    F                       Read or search I/O's
RD#H     DS    F                       Read or search cache hits
WR#      DS    F                       Write normal I/O's
WR#H     DS    F                       DFW I/O hits
RDSQ#    DS    F                       Read sequential I/O's
RDSQ#H   DS    F                       Read sequential hits
WRSQ#    DS    F                       Write sequential I/O's
WRSQ#H   DS    F                       Write sequential hits
RDCFW#   DS    F                       Read CFW I/O's
RDCFW#H  DS    F                       Read CFW hits
WRCFW#   DS    F                       Write CFW I/O's
WRCFW#H  DS    F                       Write CFW hits
INH#     DS    F                       Inhibit cache load I/O's
BYP#     DS    F                       Bypass cache I/O's
SQCHE#   DS    F                       Seqential dasd to cache I/O's
DACHE#   DS    F                       Dasd to cache I/O's (non-seql)
CHEDA#   DS    F                       Destages
RTRY#    DS    F                       DFW direct to dasd - retrys
DFWWR#   DS    F                       DFW write normal I/O's
DFWWRSQ# DS    F                       DFW write sequential I/O's
         DS    F
SDSQRD#  DS    F                       Seql-detected sequential access
*                                        read I/O's - prereads
DEVSTAT2 DS    X                       Device status - group 2
         DS    X
SSID     DS    XL2                     Subsystem id
SSRMLEN  EQU   *-SSR                   Length for monitor record
                                       SPACE
SWRE     DS    F                       Write chains received on
*                                        an escon port
SWREH    DS    F                       Write hits on escon ports
SCFWNP   DS    F                       # operations that did not
*                                        promote a track because
*                                        ther were no free segments
SSRLEN   EQU   *-SSR
         MEND
./ ADD NAME=$SSSD    0100-1998177-1998177-1143-00045-00045-00000-DCM080
         MACRO
         $SSSD
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        SENSE SUBSYSTEM STATUS RE CORD                               *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
SSS      DSECT
         SPACE
SSSMODEL DS    X                       3990 Model + features
SSSUA    DS    X                       Device unit address
SSSDEV#  DS    X                       Number of devices
SSSSTAT# DS    X                       # stats sets/device
SSSOCHE  DS    X                       Overall cache status
$CACHEAC EQU   B'11100000'             If zero, cache active
                                       SPACE
SSSONVS  DS    X                       Overall NVS   status
$NVSAC   EQU   B'11000000'             If zero, NVS   active
                                       SPACE
PSTATLEN DS    XL2                     Performance stats length
         DS    XL2
CFCACHE  DS    XL4                     Configured cache capacity
AVCACHE  DS    XL4                     Available  cache capacity
PINCACHE DS    XL4                     Pinned cache
OFFCACHE DS    XL4                     Offline cache capacity
                                       SPACE
SSSSTAT1 DS    X                       Device status
$DCASHAC EQU   B'11000000'             If zero, cache active
$DDFWAC  EQU   B'00110000'             If zero, DFW active
$DDPLXP  EQU   B'00001000'             Primary   (duplex pair)
$DDPLXS  EQU   B'00000100'             Secondary (duplex pair)
$DDPLXST EQU   B'00000011'             If zero, duplex pair available
                                       SPACE
SSSSTAT2 DS    X                       Device status
$PINST   EQU   B'11000000'             If zero, no pinned data
                                       SPACE
CFNVS    DS    XL4                     Configured NVS
PINNVS   DS    XL4                     Pinned NVS ntial hits
SSSSTAT3 DS    X                       Device status
         DS    X
SSSSSID  DS    XL2                     Subsystem id
SSSLEN   EQU   *-SSS
         MEND
./ ADD NAME=$STATSD  0100-1998177-1998177-1143-00036-00036-00000-DCM080
         MACRO
         $STATSD
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        SENSE SUBSYSTEM STATISTICS DESCRIPTOR                        *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
STATSD   DSECT
*   KEEP IN SAME ORDER AS SSR LAYOUT
CRD#     DS    F                   NR  Read or search I/O's
CRD#H    DS    F                       Read or search cache hits
CWR#     DS    F                   NW  Write normal I/O's
CWR#H    DS    F                       DFW I/O hits
CRDSQ#   DS    F                   SR  Read sequential I/O's
CRDSQ#H  DS    F                       Read sequential hits
CWRSQ#   DS    F                   SW  Write sequential I/O's
CWRSQ#H  DS    F                       Write sequential hits
CRDCFW#  DS    F                   CR  Read CFW I/O's
CRDCFW#H DS    F                       Read CFW hits
CWRCFW#  DS    F                   CW  Write CFW I/O's
CWRCFW#H DS    F                       Write CFW hits
CINH#    DS    F                   I   Inhibit cache load I/O's
CBYP#    DS    F                   B   Bypass cache I/O's
CSQCHE#  DS    F                       Seqential dasd to cache I/O's
CDACHE#  DS    F                       Dasd to cache I/O's (non-seql)
CCHEDA#  DS    F                       Destages
CRTRY#   DS    F                       DFW direct to dasd - retrys
CDFWWR#  DS    F                       DFW write normal I/O's
CDFWWRSQ#  DS  F                       DFW write sequential I/O's
         DS    F
CSDSQRD# DS    F                       Seql-detected sequential access
STATSLEN EQU   *-STATSD
                                       SPACE
         MEND
./ ADD NAME=$UCMBS   0100-1998177-1998177-1143-00018-00018-00000-DCM080
         MACRO
         $UCMBS
         SPACE
*---------------------------------------------------------------------*
*                                                                     *
*        UCMB   ADDRESS TABLE                                         *
*                                                                     *
*---------------------------------------------------------------------*
         SPACE
UCMBS    DSECT
U_UCB@   DS    A                       UCB address
U_CMB@   DS    A                       CMB address
U_UCBPFX DS    CL48                    UCB prefix copy
U_UCB    DS    CL48                    UCB        copy
         DS    CL24                    Pad to length 128
$UCMBLEN EQU   *-UCMBS                 Length
         SPACE
         MEND

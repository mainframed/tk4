000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.
000030     RDOC72.
000040 AUTHOR. KEITH R OSTLING, MODIFICATION BY PAT RUSSELL & ED H.
000050 REMARKS.  MODIFICATION OF RDOC TO USE ONLY COLS 1-72, SEQ 73-80.
000060     THE PURPOSE OF THIS PROGRAM IS TO PRINT SYSTEMS AND
000070     PROGRAMMING DOCUMENTATION FROM PUNCHED CARDS-  REFER
000080     TO DOCUMENTATION PROGRAM MEMORANDUM FOR DETAILS.
000090     EJECT
000100 ENVIRONMENT DIVISION.
000110     SKIP3
000120 CONFIGURATION SECTION.
000130     SKIP2
000140 SOURCE-COMPUTER.  IBM-370.
000150 OBJECT-COMPUTER.  IBM-370.
000160     SKIP2
000170 INPUT-OUTPUT SECTION.
000180     SKIP2
000190 FILE-CONTROL.
000200     SELECT CARD-FILE ASSIGN TO UT-S-SYSIN.
000210     SELECT PRINT-FILE ASSIGN TO UT-S-SYSPRINT.
000220     SELECT PUNCH-FILE ASSIGN TO UT-S-SYSPUNCH.
000230     SELECT DIAGNOSTICS-FILE ASSIGN TO UT-S-DIAGNOSE.
000240     SELECT TABLE-FILE ASSIGN TO UT-S-TABLES.
000250     SELECT TWO-UP-TAPE ASSIGN TO UT-S-TWOUP.
000260     SELECT ONE-UP-TAPE ASSIGN TO UT-S-ONEUP.
000270     SELECT LINE-IMAGE ASSIGN TO UT-S-LINEIMAG.
000280     EJECT
000290 DATA DIVISION.
000300     SKIP3
000310 FILE SECTION.
000320     SKIP2
000330 FD  CARD-FILE
000340     BLOCK CONTAINS 0 RECORDS
000350     LABEL RECORDS ARE STANDARD
000360     DATA RECORD IS CARD-IN.
000370     SKIP1
000380 01  CARD-IN.
000390     02 CTL-WORD     PICTURE X(5).
000400     88 BKHED-CARD                         VALUE 'BKHED'.
000410     88 BKNUM-CARD                         VALUE 'BKNUM'.
000420     88 BOOK-CARD                          VALUE 'BOOK '.
000430     88 COLM1-CARD                         VALUE 'COLM1'.
000440     88 COLM2-CARD                         VALUE 'COLM2'.
000450     88 COLM3-CARD                         VALUE 'COLM3'.
000460     88 COPY-CARD                          VALUE 'COPY '.
000470     88 COVR1-CARD                         VALUE 'COVR1'.
000480     88 COVR2-CARD                         VALUE 'COVR2'.
000490     88 COVR3-CARD                         VALUE 'COVR3'.
000500     88 DATE-CARD                          VALUE 'DATE '.
000510     88 DOUBL-CARD                         VALUE 'DOUBL'.
000520     88 EJECT-CARD                         VALUE 'EJECT'.
000530     88 ENSUB-CARD                         VALUE 'ENSUB'.
000540     88 HEAD-CARD                          VALUE 'HEAD '.
000550     88 IND-A-CARD                         VALUE 'IND-A'.
000560     88 IND-B-CARD                         VALUE 'IND-B'.
000570     88 IND-C-CARD                         VALUE 'IND-C'.
000580     88 IND-D-CARD                         VALUE 'IND-D'.
000590     88 INDEX-CARD                         VALUE 'INDEX'.
000600     88 LINES-CARD                         VALUE 'LINES'.
000610     88 LIST-CARD                          VALUE 'LIST '.
000620     88 NARR-CARD                          VALUE 'NARR '.
000630     88 NOHED-CARD                         VALUE 'NOHED'.
000640     88 NORM-CARD                          VALUE '     '.
000650     88 NOTAB-CARD                         VALUE 'NOTAB'.
000660     88 PAGE-CARD                          VALUE 'PAGE '.
000670     88 PARA-CARD                          VALUE 'PARA '.
000680     88 PARIN-CARD                         VALUE 'PARIN'.
000690     88 PLAB1-CARD                         VALUE 'PLAB1'.
000700     88 PLAB2-CARD                         VALUE 'PLAB2'.
000710     88 PLAB3-CARD                         VALUE 'PLAB3'.
000720     88 PLAB4-CARD                         VALUE 'PLAB4'.
000730     88 PLAB5-CARD                         VALUE 'PLAB5'.
000740     88 PLAB6-CARD                         VALUE 'PLAB6'.
000750     88 PLAB7-CARD                         VALUE 'PLAB7'.
000760     88 PLAB8-CARD                         VALUE 'PLAB8'.
000770     88 PLAB9-CARD                         VALUE 'PLAB9'.
000780     88 PLABA-CARD                         VALUE 'PLABA'.
000790     88 PLABB-CARD                         VALUE 'PLABB'.
000800     88 PLABC-CARD                         VALUE 'PLABC'.
000810     88 PLABD-CARD                         VALUE 'PLABD'.
000820     88 PLABE-CARD                         VALUE 'PLABE'.
000830     88 PLABF-CARD                         VALUE 'PLABF'.
000840     88 PLABG-CARD                         VALUE 'PLABG'.
000850     88 PLABH-CARD                         VALUE 'PLABH'.
000860     88 PLABI-CARD                         VALUE 'PLABI'.
000870     88 PRTPG-CARD                         VALUE 'PRTPG'.
000880     88 REPRT-CARD                         VALUE 'REPRT'.
000890     88 SAVE1-CARD                         VALUE 'SAVE1'.
000900     88 SAVE2-CARD                         VALUE 'SAVE2'.
000910     88 SAVE3-CARD                         VALUE 'SAVE3'.
000920     88 SAVE4-CARD                         VALUE 'SAVE4'.
000930     88 SAVE5-CARD                         VALUE 'SAVE5'.
000940     88 SAVE6-CARD                         VALUE 'SAVE6'.
000950     88 SAVE7-CARD                         VALUE 'SAVE7'.
000960     88 SAVE8-CARD                         VALUE 'SAVE8'.
000970     88 SAVE9-CARD                         VALUE 'SAVE9'.
000980     88 SECT-CARD                          VALUE 'SECT '.
000990     88 SECTN-CARD                         VALUE 'SECTN'.
001000     88 SEHED-CARD                         VALUE 'SEHED'.
001010     88 SENUM-CARD                         VALUE 'SENUM'.
001020     88 SEQ-CARD                           VALUE 'SEQ  '.
001030     88 SINGL-CARD                         VALUE 'SINGL'.
001040     88 SKIP-CARD                          VALUE 'SKIP '.
001050     88 SPAC1-CARD                         VALUE 'SPAC1'.
001060     88 SPAC2-CARD                         VALUE 'SPAC2'.
001070     88 SPAC3-CARD                         VALUE 'SPAC3'.
001080     88 SPAC4-CARD                         VALUE 'SPAC4'.
001090     88 SPAC5-CARD                         VALUE 'SPAC5'.
001100     88 SPAC6-CARD                         VALUE 'SPAC6'.
001110     88 SPAC7-CARD                         VALUE 'SPAC7'.
001120     88 SPAC8-CARD                         VALUE 'SPAC8'.
001130     88 SPAC9-CARD                         VALUE 'SPAC9'.
001140     88 SUBPG-CARD                         VALUE 'SUBPG'.
001150     88 TITLE-CARD                         VALUE 'TITLE'.
001160     88 XLINE-CARD                         VALUE 'XLINE'.
001170
001180     02  CARD-DATA.
001190         03  DATA-A          PICTURE X(65).
001200         03  BLANKS-A        PICTURE X(2).
001210     02  CARD-DATA-B     REDEFINES   CARD-DATA.
001220         03  DATA-B          PICTURE X(60).
001230         03  BLANKS-B        PICTURE X(7).
001240     02  CARD-DATA-C     REDEFINES   CARD-DATA.
001250         03  DATA-C          PICTURE X(55).
001260         03  BLANKS-C        PICTURE X(12).
001270     02  CARD-DATA-D     REDEFINES   CARD-DATA.
001280         03  DATA-D          PICTURE X(50).
001290         03  BLANKS-D        PICTURE X(17).
001300     02  CARD-DATA-H     REDEFINES   CARD-DATA.
001310         03  DATA-H          PIC X(45).
001320         03  BLANKS-H        PIC X(22).
001330     02  CARD-REDEF      REDEFINES   CARD-DATA.
001340         03  BEG-PAG-NUM     PIC     9(3).
001350         03  BEG-PAG-SPAC    REDEFINES   BEG-PAG-NUM PIC X(3).
001360         03  FILLER          PICTURE X.
001370         03  BEG-SUB-NUM     PIC     99.
001380         03  FILLER          PIC     X(61).
001390     02  NO-NO           REDEFINES   CARD-DATA.
001400         03  NUM-COPIES      PICTURE 99.
001410         03  NUM-LINES   REDEFINES   NUM-COPIES  PICTURE 99.
001420         03  FILLER          PICTURE X(65).
001430     02  CD-REDEF        REDEFINES   CARD-DATA.
001440         03  REPORT-CARD     PICTURE X(66).
001450         03  R-CRD-BLANKS    PICTURE X(1).
001460     02  C-REDEF         REDEFINES   CARD-DATA.
001470         03  BEG-SEQ-NUM     PICTURE 9(5).
001480         03  BEG-SEQ-SPAC    REDEFINES   BEG-SEQ-NUM PICTURE X(5).
001490         03  FILLER          PICTURE X(62).
001500     02  CRDEF           REDEFINES   CARD-DATA.
001510         03  CD-BOOK-NAME    PICTURE X(55).
001520         03  CD-BOOK-BLNK    PICTURE X(4).
001530         03  CD-BOOK-NUM     PICTURE X(8).
001540     02  CRDF            REDEFINES   CARD-DATA.
001550         03  CD-SECT-NAME    PICTURE X(55).
001560         03  CD-SECT-BLNK    PICTURE X(6).
001570         03  CD-SECT-NUM     PICTURE X(6).
001580     02  DATE-REDEF      REDEFINES   CARD-DATA.
001590         03  CARD-DATE       PIC 9(6).
001600         03  FILLER          PIC XXX.
001610         03  OUTPUT-IND      PIC X.
001620         03  FILLER          PIC X(57).
001630     02  CARD-SEQ            PIC X(8).
001640     EJECT
001650 FD  PRINT-FILE RECORDING MODE F, LABEL RECORDS OMITTED,
001660     RECORD CONTAINS 133 CHARACTERS,
001670     DATA RECORDS ARE PRINT-REC, HEAD-REC, SECT-REC.
001680     SKIP1
001690 01  PRINT-REC.
001700     02  SPAC-CTL            PICTURE X.
001710     02  PRINT-LINE          PICTURE X(132).
001720     02  NORM-LINE       REDEFINES   PRINT-LINE.
001730         03  FILLER          PICTURE X(1).
001740         03  PR-PAGLIN       PICTURE 9(8).
001750         03  PRINT-PAGLIN    REDEFINES   PR-PAGLIN   PICTURE X(8).
001760         03  FILLER          PICTURE X.
001770         03  NORM-MARGIN     PICTURE X(70).
001780         03  FILLER          PICTURE X(52).
001790     02  INDENTA         REDEFINES   PRINT-LINE.
001800         03  FILLER          PICTURE X(15).
001810         03  A-MARGIN        PICTURE X(65).
001820         03  FILLER          PICTURE X(52).
001830     02  INDENTB         REDEFINES   PRINT-LINE.
001840         03  FILLER          PICTURE X(20).
001850         03  B-MARGIN        PICTURE X(60).
001860         03  FILLER          PICTURE X(52).
001870     02  INDENTC         REDEFINES   PRINT-LINE.
001880         03  FILLER          PICTURE X(25).
001890         03  C-MARGIN        PICTURE X(55).
001900         03  FILLER          PICTURE X(52).
001910     02  INDENTD         REDEFINES   PRINT-LINE.
001920         03  FILLER          PICTURE X(30).
001930         03  D-MARGIN        PICTURE X(50).
001940         03  FILLER          PICTURE X(52).
001950     02  REP-LINE        REDEFINES   PRINT-LINE.
001960         03  LEFT-HALF       PICTURE X(66).
001970         03  RIGHT-HALF      PICTURE X(66).
001980     02  X-ALIGN         REDEFINES   PRINT-LINE.
001990         03  PRT-POS-ONE     PICTURE X.
002000         03  FILLER          PICTURE X(83).
002010         03  PRT-POS-85      PICTURE X.
002020         03  FILLER          PICTURE X(46).
002030         03  PRT-POS-132     PICTURE X.
002040     02  FILLER          REDEFINES   PRINT-LINE.
002050         03  LIST-CTL        PICTURE X(5).
002060         03  LIST-DATA       PICTURE X(67).
002070         03  LIST-SEQ        PICTURE X(8).
002080         03  FILLER          PICTURE X(52).
002090     02  DOUBLE-UP       REDEFINES   PRINT-LINE.
002100         03  FILLER          PICTURE X(8).
002110         03  P-72            PICTURE X(72).
002120         03  FILLER          PICTURE X(52).
002130     02  COVER-LINE      REDEFINES   PRINT-LINE.
002140         03  FILLER          PIC     X(52).
002150         03  COVER-DATA      PIC     X(25).
002160         03  FILLER          PIC     X(55).
002170     SKIP1
002180 01  HEAD-REC.
002190     02  FILLER              PICTURE X(11).
002200     02  HEAD-LINE           PIC     X(45).
002210     02  FILLER              PIC     XXX.
002220     02 PR-DATE      PICTURE Z9B99B99.
002230     02  PAGE-LABEL          PIC     X(8).
002240     02  PR-PAGE             PIC     ZZZ.
002250     02 PR-DEC       PICTURE X.
002260     02  PR-SUBPG            PIC     99.
002270     02  FILLER              PIC X(52).
002280     SKIP1
002290 01  SECT-REC.
002300     02 FILLER       PICTURE X(11).
002310     02 SECT-LINE    PICTURE X(66).
002320     02 FILLER       PICTURE X(56).
002330     EJECT
002340 FD  TABLE-FILE RECORDING MODE F, LABEL RECORDS STANDARD,
002350     BLOCK CONTAINS  20 RECORDS, RECORD CONTAINS 133 CHARACTERS,
002360     DATA RECORDS ARE TABLE-RECORD, TABLE-IN.
002370     SKIP1
002380 01  TABLE-RECORD.
002390     05  TAB-REC-SPAC        PICTURE X.
002400     05  FILLER          PIC X(8).
002410     05  TAB-NAME        PIC X(72).
002420     05  TABLE-ENTRY-1   REDEFINES           TAB-NAME.
002430         10  TAB-SECT-NAM    PIC X(72).
002440     05  TABLE-ENTRY-2   REDEFINES           TAB-NAME.
002450         10  FILLER          PIC X(3).
002460         10  TAB-HEAD        PIC X(62).
002470         10  FILLER          PIC X.
002480         10  TAB-PAGE-NO     PIC ZZZ.
002490         10  TAB-DECIMAL     PIC X.
002500         10  TAB-SUB-PAGE    PIC 99.
002510     05  TABLE-ENTRY-3   REDEFINES           TAB-NAME.
002520         10  FILLER          PIC X(6).
002530         10  TAB-INDEX       PIC X(66).
002540     05  TABLE-ENTRY-4   REDEFINES   TAB-NAME.
002550         10  FILLER          PIC X(6).
002560         10  LEADERS         PIC XX          OCCURS 33 TIMES.
002570     05  FILLER              PIC X(52).
002580     SKIP1
002590 01  TABLE-IN.
002600     02 TABLE-SPACE  PICTURE X.
002610     02 TABLE-LINE   PICTURE X(132).
002620     EJECT
002630 FD  DIAGNOSTICS-FILE RECORDING MODE F, LABEL RECORDS STANDARD,
002640     BLOCK CONTAINS  05 RECORDS, RECORD CONTAINS 133 CHARACTERS,
002650     DATA RECORDS ARE DIAGNOSTICS, DIAG-TWO.
002660     SKIP1
002670 01  DIAGNOSTICS.
002680     02 DIAG-SPAC    PICTURE X.
002690     02 FILLER       PICTURE X(6).
002700     02 DIAG-CARD    PICTURE X(6).
002710     02 FILLER       PICTURE X.
002720     02 DIAG-CARD-NO PICTURE Z(6).
002730     02 FILLER       PICTURE X.
002740     02 DIAG-PAGE    PICTURE X(6).
002750     02 FILLER       PICTURE X.
002760     02 DIAG-PAG-NO  PICTURE Z(4).
002770     02 DIAG-DEC     PICTURE X.
002780     02 DIAG-SUBPG   PICTURE 999.
002790     02 FILLER       PICTURE XX.
002800     02 DIAG-MESSAGE PICTURE X(35).
002810     02 DIAG-BYP     PICTURE X(10).
002820     02 FILLER       PICTURE X(50).
002830     SKIP1
002840 01  DIAG-TWO.
002850     02 DIAG-SPACE   PICTURE X.
002860     02 DIAG-CTL-WD  PICTURE X(5).
002870     02 FILLER       PICTURE X.
002880     02 DIAG-CARD-DATA PICTURE X(67).
002890     02 FILLER       PICTURE X.
002900     02 DIAG-SEQ     PICTURE X(8).
002910     02 FILLER       PICTURE X(50).
002920     EJECT
002930 FD  LINE-IMAGE RECORDING MODE F, LABEL RECORDS STANDARD,
002940     BLOCK CONTAINS  54 RECORDS, RECORD CONTAINS 133 CHARACTERS,
002950     DATA RECORD IS DISK-REC.
002960     SKIP1
002970 01  DISK-REC.
002980     02 DISK-SPAC    PICTURE X.
002990     02 DISK-LINE    PICTURE X(132).
003000     EJECT
003010 FD  PUNCH-FILE RECORDING MODE F, LABEL RECORDS OMITTED,
003020     DATA RECORD IS PUNCH-REC.
003030     SKIP1
003040 01  PUNCH-REC.
003050     02 NEW-PAGLIN   PICTURE 9(5).
003060     02 PUNCH-CTL    PICTURE X(5).
003070     02 CARD-OUT     PICTURE X(70).
003080     EJECT
003090 FD  TWO-UP-TAPE
003100         RECORDING MODE IS F,
003110         LABEL RECORDS ARE OMITTED,
003120             BLOCK CONTAINS  06  RECORDS,
003130         RECORD CONTAINS 161 CHARACTERS,
003140         DATA RECORD IS  TWO-UP-LINE.
003150     SKIP1
003160 01  TWO-UP-LINE.
003170     02  T-LINE-CNTRL        PICTURE X.
003180     02  TAPE-REC1.
003190         05  LEFT-PAGE       PIC X(72).
003200         05  CENTER          PIC X(13).
003210         05  RIGHT-PAGE      PIC X(72).
003220         05  EXTRAS          PIC X(3).
003230     02  TAPE-REC2   REDEFINES   TAPE-REC1.
003240         05  TAPE-LEFT.
003250             10  TAPE-POS-ONE    PIC X.
003260             10  FILLER          PIC X(70).
003270             10  TAPE-POS-72     PIC X.
003280             10  FILLER          PIC X(3).
003290             10  TAPE-POS-76     PIC X.
003300         05  FILLER              PIC X(84).
003310     EJECT
003320 FD  ONE-UP-TAPE
003330         RECORDING MODE IS F,
003340         LABEL RECORDS ARE OMITTED,
003350         BLOCK CONTAINS  01 RECORDS,
003360         DATA RECORD IS  ONE-UP-LINE.
003370     SKIP1
003380 01  ONE-UP-LINE.
003390     02  O-LINE-CNTRL        PICTURE X.
003400     02  O-DATA-LINE         PICTURE X(132).
003410     EJECT
003420 WORKING-STORAGE SECTION.
003425 77  PAN-VALET PICTURE X(24) VALUE '002CBT1778   10/01/87'.
003430     SKIP2
003440 77  VER-MOD-NAME            PIC X(20)   VALUE
003450     'RDOC V03M04 AUG15,71'.
003460 77  SKIP-TO-ONE             PIC X       VALUE   '1'.
003470 77  SPACE-ONE               PIC X       VALUE   ' '.
003480 77  SPACE-TWO               PIC X       VALUE   '0'.
003490 77  SPACE-THREE             PIC X       VALUE   '-'.
003500 77  X-LINES-CTR             PIC S99     VALUE   ZERO    COMP-3.
003510 77  DIAG-INDICATOR          PIC 99.
003520 77  FIRST-BOOK-IND          PIC X       VALUE   SPACE.
003530 77  TAPE-FILES              PIC 9(2)          VALUE ZEROES.
003540     SKIP3
003550 01  SWITCHES.
003560     05  BKHED-SW            PIC X.
003570     05  BKNUM-SW            PIC X.
003580     05  COVER-SW            PIC X.
003590     05  DIAGNOSTICS-SW      PIC X.
003600     05  EJECT-SW            PIC X.
003610     05  LEFT-SW             PIC X.
003620     05  NO-TABLE-SW         PIC X.
003630     05  NO-DATE-SW          PIC X.
003640     05  NOHED-SW            PIC X.
003650     05  PAGLIN-SW           PIC X.
003660     05  PLAB-SW             PIC X.
003670     05  RESEQ-SW            PIC X.
003680     05  SEHED-SW            PIC X.
003690     05  SENUM-SW            PIC X.
003700     05  SUB-PAG-SW          PIC X.
003710     05  TABLE-SW            PIC X.
003720     05  TOO-LATE-SW         PIC X.
003730     05  MODE-OF-OUTPUT      PICTURE X.
003740         88  PRINT-ONE-UP-ROUGH              VALUE '1'.
003750         88  TAPE-TWO-UP                     VALUE '2'.
003760         88  PRINT-ONE-UP-FORMAL             VALUE '3'.
003770         88  TAPE-ONE-UP                     VALUE '4'.
003780     SKIP3
003790 01  COUNTERS.
003800     05  CARD-CTR            PIC 9(6)    COMP-3.
003810     05  COPY-CTR            PIC 99      COMP-3.
003820     05  COPIES-PTD          PIC 99      COMP-3.
003830     05  COVER-CTR           PIC 99      COMP-3.
003840     05  LINES-CTR           PIC S99     COMP-3.
003850     05  LINES-LIMIT         PIC S99     COMP-3.
003860     05  PAGE-CTR            PIC S999    COMP-3.
003870     05  PAGLIN-CTR          PIC 9(5)    COMP-3.
003880     05  SUB                 PIC 99      COMP-3.
003890     05  SUB-PAG-CTR         PIC S99     COMP-3.
003900     05  TAPE-RECDS          PIC     9(5).
003910     05  XLINES-LIMIT        PIC S99     COMP-3.
003920     SKIP3
003930 01  STORAGE-AREAS.
003940     05  CURR-DATE-DATE.
003950          10  BYY            PIC 99.
003960          10  MMDDYY.
003970               15  MMDD      PIC 9(4).
003980               15  AYY       PIC 99.
003990          10  CURR-DATE REDEFINES MMDDYY    PIC 9(6).
004000     05  NORM-SPAC           PIC X.
004010     05  PLAB-CARD-STORE     PIC X(70).
004020     05  STORE-HEAD          PIC X(45).
004030     05  STORE-OLD-HEAD      PIC X(45).
004040     05  STORE-PRINT-REC     PIC X(132).
004050     05  STORE-SPAC-CTL      PIC X.
004060     SKIP3
004070 01  MODE-INDICATOR  PICTURE X(5).
004080     88 NARR-MODE                          VALUE 'NARR '.
004090     88 REPORT-MODE                        VALUE 'REPRT'.
004100     88 TITLE-MODE                         VALUE 'TITLE'.
004110     88 LIST-MODE                          VALUE 'LIST '.
004120     SKIP3
004130 01  BOOK-STORE.
004140     02  FILLER              PIC     X(10)   VALUE   SPACES.
004150     02 BOOK-NAME    PICTURE X(55)         VALUE SPACES.
004160     02 FILLER       PICTURE X             VALUE SPACES.
004170     02 BOOK-NUMBER  PICTURE X(8)          VALUE SPACES.
004180     02 FILLER       PICTURE X(58)         VALUE SPACES.
004190     SKIP3
004200 01  SECT-STORE.
004210     02 SECT-NAME    PICTURE X(55)         VALUE SPACES.
004220     02 SECT-SEC     PICTURE X(5)          VALUE SPACES.
004230     02 SECT-NUMBER  PICTURE X(6)          VALUE SPACES.
004240     SKIP3
004250 01  COLM-HEAD-STORE.
004260     05  COLM-ONE-STORE      PIC X(70).
004270     05  COLM-TWO-STORE      PIC X(70).
004280     05  COLM-THREE-STORE    PIC X(70).
004290     SKIP3
004300 01  PARA-LABELS.
004310     02  PLAB-ONE            PIC X(70).
004320     02  PLAB-TWO            PIC X(70).
004330     02  PLAB-THREE          PIC X(70).
004340     02  PLAB-FOUR           PIC X(70).
004350     02  PLAB-FIVE           PIC X(70).
004360     02  PLAB-SIX            PIC X(70).
004370     02  PLAB-SEVEN          PIC X(70).
004380     02  PLAB-EIGHT          PIC X(70).
004390     02  PLAB-NINE           PIC X(70).
004400     SKIP3
004410 01  TABLE-HEADER.
004420     02  FILLER              PIC     X(10)   VALUE   SPACES.
004430     02  HEADER-DATE         PIC     Z9B99B99.
004440     02  FILLER              PIC     X(11)   VALUE   SPACES.
004450     02  TOC-NAME            PIC X(17) VALUE  'TABLE OF CONTENTS'.
004460     02  FILLER              PIC X(21)   VALUE   SPACES.
004470     02  FILLER              PIC     X(5)    VALUE   'PAGE '.
004480     02  TOC-PAGE            PIC X(6).
004490 01  TABLE-HEADER-1.
004500     05  FILLER              PIC X(76)   VALUE   SPACES.
004510     05  FILLER              PIC X(4)    VALUE 'PAGE'.
004520     SKIP2
004530 01  COVER-LINE-1            PIC X(70).
004540 01  COVER-LINE-2            PIC X(70).
004550 01  COVER-LINE-3            PIC X(70).
004560 01  COVER-LINE-4 PIC X(25) VALUE 'PEOPLES NATIONAL BANK'.
004570 01  COVER-LINE-5 PIC X(25) VALUE 'OPERATIONS CENTER'.
004580 01  COVER-LINE-7 PIC X(25) VALUE 'P.O. BOX 12787      '.
004590 01  COVER-LINE-8 PIC X(25) VALUE 'SEATTLE, WASHINGTON 98111'.
004600 01  TAPE-ALIGN-1            PIC X(72)   VALUE
004610     '         1         2         3         4         5         6
004620-    '         7  '.
004630 01  TAPE-ALIGN-2            PIC X(72)   VALUE
004640     '123456789012345678901234567890123456789012345678901234567890
004650-    '123456789012'.
004660 01  TAPE-ALIGN-3            PIC X(72)   VALUE     '* *  P R I N T
004670-    ' E R    A L I G N M E N T    I N S T R U C T I O N S   * *'.
004680 01  TAPE-ALIGN-4            PIC X(72)   VALUE     '* FOR PROPER F
004690-    'ORM ALIGNMENT PRINT POSITION ONE SHOULD BE 1.3 INCHES    *'.
004700 01  TAPE-ALIGN-5            PIC X(72)   VALUE     '* FROM THE LEF
004710-    'T EDGE OF THE PAPER. TRIM THE PAPER .4 OF AN INCH FROM   *'.
004720 01  TAPE-ALIGN-6            PIC X(72)   VALUE     '* THE EDGES
004730-    'AND TO THE RIGHT OF THE X. THE ASTERISKS SHOW THE FIRST  *'.
004740 01  TAPE-ALIGN-7            PIC X(72)   VALUE     '* AND LAST POS
004750-    'ITIONS OF THE BODY OF THE DOCUMENT.                      *'.
004760     SKIP2
004770 01  ROMAN-NUMERALS.
004780     02  FILLER              PIC X(6)    VALUE  'I     '.
004790     02  FILLER              PIC X(6)    VALUE  'II    '.
004800     02  FILLER              PIC X(6)    VALUE  'III   '.
004810     02  FILLER              PIC X(6)    VALUE  'IV    '.
004820     02  FILLER              PIC X(6)    VALUE  'V     '.
004830     02  FILLER              PIC X(6)    VALUE  'VI    '.
004840     02  FILLER              PIC X(6)    VALUE  'VII   '.
004850     02  FILLER              PIC X(6)    VALUE  'VIII  '.
004860     02  FILLER              PIC X(6)    VALUE  'IX    '.
004870     02  FILLER              PIC X(6)    VALUE  'X     '.
004880     02  FILLER              PIC X(6)    VALUE  'XI    '.
004890     02  FILLER              PIC X(6)    VALUE  'XII   '.
004900     02  FILLER              PIC X(6)    VALUE  'XIII  '.
004910     02  FILLER              PIC X(6)    VALUE  'XIV   '.
004920     02  FILLER              PIC X(6)    VALUE  'XV    '.
004930     02  FILLER              PIC X(6)    VALUE  'XVI   '.
004940     02  FILLER              PIC X(6)    VALUE  'XVII  '.
004950     02  FILLER              PIC X(6)    VALUE  'XVIII '.
004960     02  FILLER              PIC X(6)    VALUE  'XIX   '.
004970     02  FILLER              PIC X(6)    VALUE  'XX    '.
004980     02  FILLER              PIC X(6)    VALUE  'XXI   '.
004990     02  FILLER              PIC X(6)    VALUE  'XXII  '.
005000     02  FILLER              PIC X(6)    VALUE  'XXIII '.
005010     02  FILLER              PIC X(6)    VALUE  'XXIV  '.
005020     02  FILLER              PIC X(6)    VALUE  'XXV   '.
005030     02  FILLER              PIC X(6)    VALUE  'XXVI  '.
005040     02  FILLER              PIC X(6)    VALUE  'XXVII '.
005050     02  FILLER              PIC X(6)    VALUE  'XXVIII'.
005060     02  FILLER              PIC X(6)    VALUE  'XXIX  '.
005070     02  FILLER              PIC X(6)    VALUE  'XXX   '.
005080     02  FILLER              PIC X(6)    VALUE  'XXXI  '.
005090     02  FILLER              PIC X(6)    VALUE  'XXXII '.
005100     02  FILLER              PIC X(6)    VALUE  'XXXIII'.
005110     02  FILLER              PIC X(6)    VALUE  'XXXIV '.
005120     02  FILLER              PIC X(6)    VALUE  'XXXV  '.
005130     02  FILLER              PIC X(6)    VALUE  'XXXVI '.
005140     02  FILLER              PIC X(6)    VALUE  'XXXVII'.
005150     02  FILLER              PIC X(6)    VALUE  'XXXIIX'.
005160     02  FILLER              PIC X(6)    VALUE  'XXXIX '.
005170     02  FILLER              PIC X(6)    VALUE  'XL    '.
005180     02  FILLER              PIC X(6)    VALUE  'XLI   '.
005190     02  FILLER              PIC X(6)    VALUE  'XLII  '.
005200     02  FILLER              PIC X(6)    VALUE  'XLIII '.
005210     02  FILLER              PIC X(6)    VALUE  'XLIV  '.
005220     02  FILLER              PIC X(6)    VALUE  'XLV   '.
005230     02  FILLER              PIC X(6)    VALUE  'XLVI  '.
005240     02  FILLER              PIC X(6)    VALUE  'XLVII '.
005250     02  FILLER              PIC X(6)    VALUE  'XLVIII'.
005260     02  FILLER              PIC X(6)    VALUE  'IL    '.
005270     02  FILLER              PIC X(6)    VALUE  'L     '.
005280 01  R-NUMS              REDEFINES   ROMAN-NUMERALS.
005290     02  ROMAN-NBRS          PIC X(6)      OCCURS 50 TIMES.
005300     EJECT
005310 PROCEDURE DIVISION.
005320     SKIP3
005330 START-RUN.
005340     OPEN INPUT CARD-FILE.
005350     OPEN OUTPUT PRINT-FILE.
005360     EJECT
005370 INITIALIZE.
005380     MOVE 1 TO EJECT-SW.
005390     MOVE 1 TO MODE-OF-OUTPUT.
005400     OPEN OUTPUT LINE-IMAGE, TABLE-FILE, DIAGNOSTICS-FILE.
005410     MOVE 'NARR ' TO MODE-INDICATOR.
005420     MOVE SPACES TO  BKHED-SW,       BKNUM-SW,       COVER-SW,
005430                     COLM-HEAD-STORE,
005440                     DIAGNOSTICS-SW, LEFT-SW,        NO-TABLE-SW,
005450         NO-DATE-SW, NOHED-SW,       PAGLIN-SW,      RESEQ-SW,
005460                     PARA-LABELS,    PLAB-SW,
005470                     PLAB-CARD-STORE,
005480                     SEHED-SW,       SENUM-SW,       SUB-PAG-SW,
005490                     TABLE-SW,       TOO-LATE-SW,
005500                     NORM-SPAC,      STORE-HEAD,   STORE-OLD-HEAD,
005510                     STORE-PRINT-REC, STORE-SPAC-CTL, PRINT-REC,
005520                     SECT-NAME,      SECT-NUMBER.
005530     MOVE ZEROES TO  CARD-CTR,       COPIES-PTD,     COVER-CTR,
005540                     LINES-CTR,      PAGE-CTR,       PAGLIN-CTR,
005550                     TAPE-RECDS,
005560                     SUB,            SUB-PAG-CTR,    CURR-DATE.
005570     ACCEPT CURR-DATE-DATE FROM DATE.
005580     MOVE BYY TO AYY.
005590     MOVE '1' TO NO-DATE-SW.
005600     MOVE 01     TO  COPY-CTR.
005610     MOVE 56     TO  LINES-LIMIT.
005620     MOVE 70 TO XLINES-LIMIT.
005630     ALTER TABLE-EXIT TO PROCEED TO BEGIN-COPIES.
005640     EJECT
005650 READ-CARD.
005660     IF PLAB-SW IS NOT EQUAL TO 1, GO TO READ-CARD-CONTD.
005670         MOVE SPACE TO PLAB-SW.
005680         MOVE SPACES TO CTL-WORD.
005690         MOVE PLAB-CARD-STORE TO CARD-DATA.
005700     IF CARD-DATA IS EQUAL TO SPACES GO TO READ-CARD.
005710         GO TO TEST-MODE.
005720 READ-CARD-CONTD.
005730     READ CARD-FILE, AT END GO TO LAST-CARD.
005740 READ-CARD-1.
005750     ADD 1 TO CARD-CTR.
005760     IF RESEQ-SW NOT = 1 GO TO TEST-MODE.
005770     ADD 10 TO PAGLIN-CTR.
005780     MOVE PAGLIN-CTR TO NEW-PAGLIN.
005790     MOVE CTL-WORD TO PUNCH-CTL.
005800     MOVE CARD-DATA TO CARD-OUT.
005810     WRITE PUNCH-REC.
005820 TEST-MODE.
005830     IF REPORT-MODE GO TO REPORT-PRINTING.
005840     IF LIST-MODE GO TO LIST-PRINTING.
005850
005860 TEST-CARD-TYPE.
005870     IF  BKHED-CARD  GO TO   PROC-BKHED.
005880     IF  BKNUM-CARD  GO TO   PROC-BKNUM.
005890     IF   BOOK-CARD  GO TO   PROC-BOOK.
005900     IF   COPY-CARD  GO TO   PROC-COPY.
005910     IF  COVR1-CARD  GO TO   PROC-COVER.
005920     IF   DATE-CARD  GO TO   PROC-DATE.
005930     IF  DOUBL-CARD  GO TO   PROC-DOUBL.
005940     IF  EJECT-CARD  GO TO   PROC-EJECT.
005950     IF  LINES-CARD  GO TO   PROC-LINES.
005960     IF   LIST-CARD  GO TO   PROC-MODE-CHG.
005970     IF   NARR-CARD  GO TO   PROC-MODE-CHG.
005980     IF  NOHED-CARD  GO TO   PROC-NOHED.
005990     IF  NOTAB-CARD  GO TO   PROC-NOTAB.
006000     IF   PAGE-CARD  GO TO   PROC-PAGE.
006010     IF  PRTPG-CARD  GO TO   PROC-PRTPG.
006020     IF  REPRT-CARD  GO TO   PROC-MODE-CHG.
006030     IF  SAVE1-CARD  GO TO   PROC-SAVE1.
006040     IF  SAVE2-CARD  GO TO   PROC-SAVE2.
006050     IF  SAVE3-CARD  GO TO   PROC-SAVE3.
006060     IF  SAVE4-CARD  GO TO   PROC-SAVE4.
006070     IF  SAVE5-CARD  GO TO   PROC-SAVE5.
006080     IF  SAVE6-CARD  GO TO   PROC-SAVE6.
006090     IF  SAVE7-CARD  GO TO   PROC-SAVE7.
006100     IF  SAVE8-CARD  GO TO   PROC-SAVE8.
006110     IF  SAVE9-CARD  GO TO   PROC-SAVE9.
006120     IF  SEHED-CARD  GO TO   PROC-SEHED.
006130     IF  SENUM-CARD  GO TO   PROC-SENUM.
006140     IF    SEQ-CARD  GO TO   PROC-SEQ.
006150     IF  SINGL-CARD  GO TO   PROC-SINGL.
006160     IF  TITLE-CARD  GO TO   PROC-MODE-CHG.
006170     IF  XLINE-CARD  GO TO   PROC-XLINE.
006180     MOVE 1 TO TOO-LATE-SW.
006190     IF  COLM1-CARD  GO TO   PROC-COLM1.
006200     IF  COLM2-CARD  GO TO   PROC-COLM2.
006210     IF  COLM3-CARD  GO TO   PROC-COLM3.
006220     IF  ENSUB-CARD  GO TO   PROC-ENSUB.
006230     IF   HEAD-CARD  GO TO   PROC-HEAD.
006240     IF  SPAC1-CARD  GO TO   PROC-SPAC1.
006250     IF  SPAC2-CARD  GO TO   PROC-SPAC2.
006260     IF  SPAC3-CARD  GO TO   PROC-SPAC3.
006270     IF  SPAC4-CARD  GO TO   PROC-SPAC4.
006280     IF  IND-A-CARD  GO TO   PROC-IND-A.
006290     IF  IND-B-CARD  GO TO   PROC-IND-B.
006300     IF  IND-C-CARD  GO TO   PROC-IND-C.
006310     IF  IND-D-CARD  GO TO   PROC-IND-D.
006320     IF  INDEX-CARD  GO TO   PROC-INDEX.
006330     IF   NORM-CARD  GO TO   PROC-NORM.
006340     IF   PARA-CARD  GO TO   PROC-PARA.
006350     IF  PARIN-CARD  GO TO   PROC-PARIN.
006360     IF  PLAB1-CARD  GO TO   PROC-PLAB.
006370     IF  PLAB2-CARD  GO TO   PROC-PLAB.
006380     IF  PLAB3-CARD  GO TO   PROC-PLAB.
006390     IF  PLAB4-CARD  GO TO   PROC-PLAB.
006400     IF  PLAB5-CARD  GO TO   PROC-PLAB.
006410     IF  PLAB6-CARD  GO TO   PROC-PLAB.
006420     IF  PLAB7-CARD  GO TO   PROC-PLAB.
006430     IF  PLAB8-CARD  GO TO   PROC-PLAB.
006440     IF  PLAB9-CARD  GO TO   PROC-PLAB.
006450     IF  PLABA-CARD  GO TO   PROC-PLAB.
006460     IF  PLABB-CARD  GO TO   PROC-PLAB.
006470     IF  PLABC-CARD  GO TO   PROC-PLAB.
006480     IF  PLABD-CARD  GO TO   PROC-PLAB.
006490     IF  PLABE-CARD  GO TO   PROC-PLAB.
006500     IF  PLABF-CARD  GO TO   PROC-PLAB.
006510     IF  PLABG-CARD  GO TO   PROC-PLAB.
006520     IF  PLABH-CARD  GO TO   PROC-PLAB.
006530     IF  PLABI-CARD  GO TO   PROC-PLAB.
006540     IF   SECT-CARD  GO TO   PROC-SECT.
006550     IF  SECTN-CARD  GO TO   PROC-SECT.
006560     IF   SKIP-CARD  GO TO   PROC-SKIP.
006570     IF  SPAC5-CARD  GO TO   PROC-SPAC5.
006580     IF  SPAC6-CARD  GO TO   PROC-SPAC6.
006590     IF  SPAC7-CARD  GO TO   PROC-SPAC7.
006600     IF  SPAC8-CARD  GO TO   PROC-SPAC8.
006610     IF  SPAC9-CARD  GO TO   PROC-SPAC9.
006620     IF  SUBPG-CARD  GO TO   PROC-SUBPG.
006630     MOVE 01 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
006640     EJECT
006650 PROC-BKHED.
006660     MOVE 1 TO BKHED-SW.
006670     MOVE SPACES TO BOOK-STORE.
006680     GO TO READ-CARD.
006690
006700 PROC-BKNUM.
006710     MOVE 1 TO BKNUM-SW.
006720     MOVE SPACES TO BOOK-NUMBER.
006730     GO TO READ-CARD.
006740
006750 PROC-BOOK.
006760     IF CD-BOOK-BLNK NOT EQUAL TO SPACES ALTER TOO-LONG-EXIT
006770     TO PROCEED TO PROC-BOOK-CONTD, GO TO DATA-TOO-LONG.
006780 PROC-BOOK-CONTD.
006790     IF CARD-CTR EQUAL TO 1,
006800     MOVE CD-BOOK-NAME TO BOOK-NAME,
006810     MOVE CD-BOOK-NUM TO BOOK-NUMBER,
006820     GO TO READ-CARD.
006830     GO TO LAST-CARD.
006840
006850 PROC-COPY.
006860     IF TOO-LATE-SW = 1, GO TO TOO-LATE.
006870     IF NUM-COPIES NOT NUMERIC,
006880     MOVE 03 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
006890     IF NUM-COPIES LESS THAN 02 GO TO READ-CARD.
006900     IF COPY-CTR GREATER THAN 01 GO TO TOO-LATE.
006910     IF  TAPE-TWO-UP, ADD 1 TO NUM-COPIES,
006920         DIVIDE NUM-COPIES BY 2 GIVING COPY-CTR,
006930         GO TO READ-CARD.
006940     MOVE NUM-COPIES TO COPY-CTR.
006950     GO TO READ-CARD.
006960
006970 PROC-COLM1.
006980         MOVE CARD-DATA TO COLM-ONE-STORE.
006990         IF CARD-DATA IS EQUAL TO SPACES GO TO READ-CARD.
007000         GO TO PROC-NORM.
007010
007020 PROC-COLM2.
007030         MOVE CARD-DATA TO COLM-TWO-STORE.
007040         IF CARD-DATA IS EQUAL TO SPACES GO TO READ-CARD.
007050         GO TO PROC-NORM.
007060
007070 PROC-COLM3.
007080         MOVE CARD-DATA TO COLM-THREE-STORE.
007090         IF CARD-DATA IS EQUAL TO SPACES GO TO READ-CARD.
007100         GO TO PROC-NORM.
007110
007120 PROC-COVER.
007130     IF  TOO-LATE-SW = 1, GO TO TOO-LATE.
007140     MOVE SPACES TO COVER-LINE-2,  COVER-SW,  COVER-LINE-3.
007150     MOVE CARD-DATA TO COVER-LINE-1.
007160     READ CARD-FILE, AT END GO TO LAST-CARD.
007170     IF  NOT COVR2-CARD  GO TO CK-COVR3.
007180     ADD 1 TO CARD-CTR.
007190     IF  RESEQ-SW = 1, PERFORM SEQ-COVER.
007200     MOVE CARD-DATA TO COVER-LINE-2.
007210     READ CARD-FILE, AT END GO TO LAST-CARD.
007220 CK-COVR3.
007230     IF  NOT COVR3-CARD  GO TO PRINT-COVER.
007240     ADD 1 TO CARD-CTR.
007250     IF  RESEQ-SW = 1, PERFORM SEQ-COVER.
007260     MOVE 1 TO COVER-SW.
007270     MOVE CARD-DATA TO COVER-LINE-3.
007280 PRINT-COVER.
007290     MOVE 1 TO EJECT-SW.
007300     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-1.
007310     GO TO WRITE-IMAGE.
007320 PR-COVR-1.
007330     PERFORM COVER-BLANK-LINES THRU COVER-BLANK-EXIT.
007340     MOVE COVER-LINE-1 TO NORM-MARGIN.
007350     MOVE SPACE-ONE TO SPAC-CTL.
007360     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-2.
007370     GO TO WRITE-IMAGE.
007380 PR-COVR-2.
007390     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-2A.
007400     GO TO WRITE-IMAGE.
007410 PR-COVR-2A.
007420     MOVE COVER-LINE-2 TO NORM-MARGIN.
007430     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-3.
007440     GO TO WRITE-IMAGE.
007450 PR-COVR-3.
007460     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-3A.
007470     GO TO WRITE-IMAGE.
007480 PR-COVR-3A.
007490     MOVE COVER-LINE-3 TO NORM-MARGIN.
007500     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-4.
007510     GO TO WRITE-IMAGE.
007520 PR-COVR-4.
007530     PERFORM COVER-BLANK-LINES THRU COVER-BLANK-EXIT.
007540     MOVE COVER-LINE-4 TO COVER-DATA.
007550     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-5.
007560     GO TO WRITE-IMAGE.
007570 PR-COVR-5.
007580     MOVE COVER-LINE-5 TO COVER-DATA.
007590     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-7.
007600     GO TO WRITE-IMAGE.
007610 PR-COVR-7.
007620     MOVE COVER-LINE-7 TO COVER-DATA.
007630     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-8.
007640     GO TO WRITE-IMAGE.
007650 PR-COVR-8.
007660     MOVE COVER-LINE-8 TO COVER-DATA.
007670     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-9.
007680     GO TO WRITE-IMAGE.
007690 PR-COVR-9.
007700     MOVE LINES-LIMIT TO LINES-CTR.
007710     IF  COVER-SW = SPACE GO TO READ-CARD-1.
007720     GO TO READ-CARD.
007730 COVER-BLANK-LINES.
007740     MOVE 7 TO COVER-CTR.
007750     ALTER WRITE-IMAGE-EXIT TO PROCEED TO PR-COVR-10.
007760 PR-COVR-10.
007770     IF  COVER-CTR = 0 GO TO COVER-BLANK-EXIT.
007780     MOVE SPACE-THREE TO SPAC-CTL.
007790     SUBTRACT 1 FROM COVER-CTR.
007800     GO TO WRITE-IMAGE.
007810 COVER-BLANK-EXIT. EXIT.
007820 SEQ-COVER.
007830     ADD 10 TO PAGLIN-CTR.
007840     MOVE PAGLIN-CTR TO NEW-PAGLIN.
007850     MOVE CTL-WORD TO PUNCH-CTL.
007860     MOVE CARD-DATA TO CARD-OUT.
007870     WRITE PUNCH-REC.
007880     SKIP1
007890 PROC-DATE.
007900     IF  TOO-LATE-SW = 1, GO TO TOO-LATE.
007910     MOVE '1'        TO  NO-DATE-SW.
007920     IF CARD-DATE IS NUMERIC,
007930     MOVE CARD-DATE  TO  CURR-DATE.
007940     IF OUTPUT-IND IS EQUAL TO 2, GO TO PROC-DATE-CONTD.
007950     IF OUTPUT-IND IS EQUAL TO 3, GO TO PROC-DATE-CONTD.
007960     IF OUTPUT-IND IS EQUAL TO 4, GO TO PROC-DATE-CONTD.
007970     GO TO READ-CARD.
007980 PROC-DATE-CONTD.
007990     MOVE OUTPUT-IND TO  MODE-OF-OUTPUT.
008000     IF  TAPE-TWO-UP OPEN OUTPUT TWO-UP-TAPE WITH NO REWIND,
008010         GO TO ALIGN-TAPE.
008020     IF  TAPE-ONE-UP OPEN OUTPUT ONE-UP-TAPE WITH NO REWIND,
008030         GO TO ALIGN-TAPE.
008040     IF  PRINT-ONE-UP-FORMAL  GO TO ALIGN-PRINTER.
008050     GO TO READ-CARD.
008060
008070 PROC-DOUBL.
008080     MOVE SPACE-TWO   TO NORM-SPAC.
008090     GO TO READ-CARD.
008100
008110 PROC-EJECT.
008120     ALTER HEAD-EXIT TO PROCEED TO READ-CARD.
008130     GO TO PAGE-HEADINGS.
008140
008150 PROC-ENSUB.
008160     MOVE SPACE TO SUB-PAG-SW.
008170     MOVE ZEROS TO SUB-PAG-CTR.
008180     GO TO READ-CARD.
008190
008200 PROC-HEAD.
008210     MOVE SPACES TO COLM-HEAD-STORE.
008220     IF TITLE-MODE MOVE SPACES TO STORE-HEAD GO TO READ-CARD.
008230     IF NOHED-SW EQUAL TO 1 GO TO PROC-EJECT.
008240     MOVE DATA-H TO STORE-HEAD.
008250     ALTER HEAD-EXIT TO PROCEED TO PROC-HEAD-CONTD.
008260     GO TO PAGE-HEADINGS.
008270 PROC-HEAD-CONTD.
008280     MOVE SPACES TO TABLE-RECORD.
008290     MOVE STORE-HEAD TO TAB-HEAD.
008300     ALTER TABLE-ENTRY-EXIT TO PROCEED TO PROC-HEAD-BLANKS.
008310     GO TO TABLE-ENTRY.
008320 PROC-HEAD-BLANKS.
008330     IF  BLANKS-H NOT EQUAL TO SPACES
008340         ALTER TOO-LONG-EXIT TO PROCEED TO READ-CARD,
008350     GO TO DATA-TOO-LONG.
008360 PROC-HEAD-EXIT.
008370     GO TO READ-CARD.
008380
008390 PROC-IND-A.
008400     IF BLANKS-A NOT = SPACES, ALTER TOO-LONG-EXIT TO PROCEED TO
008410     IND-A-CONTD, GO TO DATA-TOO-LONG.
008420 IND-A-CONTD.
008430     MOVE DATA-A TO A-MARGIN.
008440     GO TO PROC-NORM-CONTD.
008450
008460 PROC-IND-B.
008470     IF BLANKS-B NOT = SPACES, ALTER TOO-LONG-EXIT TO PROCEED TO
008480     IND-B-CONTD, GO TO DATA-TOO-LONG.
008490 IND-B-CONTD.
008500     MOVE DATA-B TO B-MARGIN.
008510     GO TO PROC-NORM-CONTD.
008520
008530 PROC-IND-C.
008540     IF BLANKS-C NOT = SPACES, ALTER TOO-LONG-EXIT TO PROCEED TO
008550     IND-C-CONTD, GO TO DATA-TOO-LONG.
008560 IND-C-CONTD.
008570     MOVE DATA-C TO C-MARGIN.
008580     GO TO PROC-NORM-CONTD.
008590
008600 PROC-IND-D.
008610     IF BLANKS-D NOT = SPACES, ALTER TOO-LONG-EXIT TO PROCEED TO
008620     IND-D-CONTD, GO TO DATA-TOO-LONG.
008630 IND-D-CONTD.
008640     MOVE DATA-D TO D-MARGIN.
008650     GO TO PROC-NORM-CONTD.
008660
008670 PROC-INDEX.
008680     MOVE DATA-B TO NORM-MARGIN.
008690     MOVE '    *' TO PRINT-PAGLIN.
008700     MOVE SPACE-THREE TO SPAC-CTL.
008710     IF LINES-CTR IS GREATER THAN XLINES-LIMIT,
008720         MOVE 67 TO LINES-CTR.
008730     ALTER NORM-EXIT TO PROCEED TO TABLE-INDEX.
008740     GO TO NORM-PRINT.
008750 TABLE-INDEX.
008760     IF BLANKS-B NOT EQUAL TO SPACES,
008770     ALTER TOO-LONG-EXIT TO PROCEED TO INDEX-CONTD,
008780     GO TO DATA-TOO-LONG.
008790 INDEX-CONTD.
008800     MOVE SPACES TO TABLE-RECORD.
008810     MOVE DATA-B TO TAB-INDEX.
008820     ALTER TABLE-ENTRY-EXIT TO PROCEED TO INDEX-EXIT.
008830     GO TO TABLE-ENTRY.
008840 INDEX-EXIT.
008850     IF REPORT-MODE GO TO READ-CARD.
008860     ALTER NORM-EXIT TO PROCEED TO READ-CARD.
008870     GO TO PRINT-BLANK.
008880
008890 PROC-LINES.
008900     IF NUM-LINES  NOT NUMERIC,
008910     MOVE 04 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
008920     IF NUM-LINES GREATER THAN 66,
008930     MOVE 05 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
008940     MOVE NUM-LINES TO LINES-LIMIT.
008950     IF LINES-CTR LESS THAN LINES-LIMIT GO TO READ-CARD.
008960     ALTER HEAD-EXIT TO PROCEED TO READ-CARD.
008970     GO TO PAGE-HEADINGS.
008980
008990 PROC-MODE-CHG.
009000     MOVE CTL-WORD TO MODE-INDICATOR.
009010     IF REPORT-MODE MOVE SPACE TO PAGLIN-SW.
009020     IF CARD-DATA EQUAL TO SPACES GO TO PROC-MODE-CONTD.
009030     DISPLAY 'NOW CHANGING TO ', CTL-WORD, 'MODE ', CARD-CTR,
009040     UPON CONSOLE.
009050     DISPLAY CARD-DATA UPON CONSOLE.
009060     STOP 'EOB TO CONTINUE.'.
009070 PROC-MODE-CONTD.
009080     IF NARR-MODE GO TO PROC-SINGL.
009090     IF LIST-MODE GO TO PROC-SINGL.
009100     IF PAGE-CTR EQUAL TO ZEROS ADD 1 TO PAGE-CTR.
009110     GO TO PROC-SINGL.
009120
009130 PROC-NOHED.
009140     IF TOO-LATE-SW EQUAL TO 1 GO TO TOO-LATE.
009150     MOVE 1 TO NOHED-SW, NO-TABLE-SW.
009160     GO TO READ-CARD.
009170
009180 PROC-NORM.
009190     MOVE CARD-DATA TO NORM-MARGIN.
009200 PROC-NORM-CONTD.
009210     MOVE NORM-SPAC TO SPAC-CTL.
009220     ALTER NORM-EXIT TO PROCEED TO READ-CARD.
009230     GO TO NORM-PRINT.
009240
009250 PROC-NOTAB.
009260     IF TOO-LATE-SW = 1 GO TO TOO-LATE.
009270     MOVE 1 TO NO-TABLE-SW.
009280     GO TO READ-CARD.
009290
009300 PROC-PAGE.
009310     IF BEG-PAG-NUM NOT NUMERIC,
009320     MOVE 06 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
009330     MOVE BEG-PAG-NUM TO PAGE-CTR.
009340     SUBTRACT 1 FROM PAGE-CTR.
009350     MOVE SPACE TO SUB-PAG-SW.
009360     MOVE ZEROS TO SUB-PAG-CTR.
009370     GO TO READ-CARD.
009380
009390 PROC-PARA.
009400     MOVE CARD-DATA TO NORM-MARGIN.
009410 PROC-PARA-CONTD.
009420     IF  NORM-SPAC = SPACE-TWO,  MOVE SPACE-THREE TO SPAC-CTL.
009430     IF  NORM-SPAC = SPACE-ONE,  MOVE SPACE-TWO   TO SPAC-CTL.
009440     ALTER NORM-EXIT TO PROCEED TO READ-CARD.
009450     GO TO NORM-PRINT.
009460
009470 PROC-PARIN.
009480     MOVE DATA-A TO A-MARGIN.
009490     IF BLANKS-A NOT = SPACES, ALTER TOO-LONG-EXIT TO PROCEED TO
009500     PROC-PARA-CONTD,
009510     GO TO DATA-TOO-LONG.
009520     GO TO PROC-PARA-CONTD.
009530
009540 PROC-PLAB.
009550     MOVE 1 TO PLAB-SW.
009560     MOVE CARD-DATA TO PLAB-CARD-STORE.
009570     IF PLAB1-CARD,
009580         MOVE PLAB-ONE   TO CARD-DATA,
009590         GO TO PROC-PLAB-NORM.
009600     IF PLAB2-CARD,
009610         MOVE PLAB-TWO   TO CARD-DATA,
009620         GO TO PROC-PLAB-NORM.
009630     IF PLAB3-CARD,
009640         MOVE PLAB-THREE TO CARD-DATA,
009650         GO TO PROC-PLAB-NORM.
009660     IF PLAB4-CARD,
009670         MOVE PLAB-FOUR  TO CARD-DATA,
009680         GO TO PROC-PLAB-NORM.
009690     IF PLAB5-CARD,
009700         MOVE PLAB-FIVE  TO CARD-DATA,
009710         GO TO PROC-PLAB-NORM.
009720     IF PLAB6-CARD,
009730         MOVE PLAB-SIX   TO CARD-DATA,
009740         GO TO PROC-PLAB-NORM.
009750     IF PLAB7-CARD,
009760         MOVE PLAB-SEVEN TO CARD-DATA,
009770         GO TO PROC-PLAB-NORM.
009780     IF PLAB8-CARD,
009790         MOVE PLAB-EIGHT TO CARD-DATA,
009800         GO TO PROC-PLAB-NORM.
009810     IF PLAB9-CARD,
009820         MOVE PLAB-NINE  TO CARD-DATA,
009830         GO TO PROC-PLAB-NORM.
009840     IF PLABA-CARD,
009850         MOVE PLAB-ONE   TO CARD-DATA,
009860         GO TO PROC-PLAB-PARA.
009870     IF PLABB-CARD,
009880         MOVE PLAB-TWO   TO CARD-DATA,
009890         GO TO PROC-PLAB-PARA.
009900     IF PLABC-CARD,
009910         MOVE PLAB-THREE TO CARD-DATA,
009920         GO TO PROC-PLAB-PARA.
009930     IF PLABD-CARD,
009940         MOVE PLAB-FOUR  TO CARD-DATA,
009950         GO TO PROC-PLAB-PARA.
009960     IF PLABE-CARD,
009970         MOVE PLAB-FIVE  TO CARD-DATA,
009980         GO TO PROC-PLAB-PARA.
009990     IF PLABF-CARD,
010000         MOVE PLAB-SIX   TO CARD-DATA,
010010         GO TO PROC-PLAB-PARA.
010020     IF PLABG-CARD,
010030         MOVE PLAB-SEVEN TO CARD-DATA,
010040         GO TO PROC-PLAB-PARA.
010050     IF PLABH-CARD,
010060         MOVE PLAB-EIGHT TO CARD-DATA,
010070         GO TO PROC-PLAB-PARA.
010080     IF PLABI-CARD,
010090         MOVE PLAB-NINE  TO CARD-DATA,
010100         GO TO PROC-PLAB-PARA.
010110 PROC-PLAB-NORM.
010120     MOVE SPACES TO CTL-WORD.
010130     GO TO PROC-NORM.
010140 PROC-PLAB-PARA.
010150     MOVE 'PARA ' TO CTL-WORD.
010160     GO TO PROC-PARA.
010170
010180 PROC-PRTPG.
010190     MOVE 1 TO PAGLIN-SW.
010200     GO TO READ-CARD.
010210
010220 PROC-SAVE1.
010230     MOVE CARD-DATA TO PLAB-ONE.
010240     GO TO READ-CARD.
010250
010260 PROC-SAVE2.
010270     MOVE CARD-DATA TO PLAB-TWO.
010280     GO TO READ-CARD.
010290
010300 PROC-SAVE3.
010310     MOVE CARD-DATA TO PLAB-THREE.
010320     GO TO READ-CARD.
010330
010340 PROC-SAVE4.
010350     MOVE CARD-DATA TO PLAB-FOUR.
010360     GO TO READ-CARD.
010370
010380 PROC-SAVE5.
010390     MOVE CARD-DATA TO PLAB-FIVE.
010400     GO TO READ-CARD.
010410
010420 PROC-SAVE6.
010430     MOVE CARD-DATA TO PLAB-SIX.
010440     GO TO READ-CARD.
010450
010460 PROC-SAVE7.
010470     MOVE CARD-DATA TO PLAB-SEVEN.
010480     GO TO READ-CARD.
010490
010500 PROC-SAVE8.
010510     MOVE CARD-DATA TO PLAB-EIGHT.
010520     GO TO READ-CARD.
010530
010540 PROC-SAVE9.
010550     MOVE CARD-DATA TO PLAB-NINE.
010560     GO TO READ-CARD.
010570
010580 PROC-SECT.
010590     MOVE SPACES TO COLM-HEAD-STORE.
010600     IF TITLE-MODE MOVE SPACES TO CARD-DATA.
010610     IF NOHED-SW EQUAL TO 1 GO TO PROC-EJECT.
010620     IF SEHED-SW EQUAL TO 1 MOVE SPACES TO CARD-DATA.
010630     IF SENUM-SW EQUAL TO 1 MOVE SPACES TO CD-SECT-NUM.
010640     MOVE CD-SECT-NAME TO SECT-NAME.
010650     MOVE CD-SECT-NUM TO SECT-NUMBER.
010660     IF SECT-NUMBER EQUAL TO SPACES
010670     MOVE SPACES TO SECT-SEC
010680     ELSE MOVE ' SEC ' TO SECT-SEC.
010690     MOVE SPACES TO STORE-HEAD.
010700     IF CARD-DATA EQUAL TO SPACES GO TO READ-CARD.
010710     IF SECTN-CARD GO TO PROC-SECT-CONTD.
010720     ALTER HEAD-EXIT TO PROCEED TO PROC-SECT-CONTD.
010730     GO TO PAGE-HEADINGS.
010740 PROC-SECT-CONTD.
010750     MOVE SPACES TO TABLE-RECORD.
010760     MOVE SECT-STORE TO TAB-SECT-NAM.
010770     ALTER TABLE-ENTRY-EXIT TO PROCEED TO PROC-SECT-BLANKS.
010780     GO TO TABLE-ENTRY.
010790 PROC-SECT-BLANKS.
010800     IF CD-SECT-BLNK NOT EQUAL TO SPACES ALTER TOO-LONG-EXIT
010810     TO PROCEED TO READ-CARD,
010820     GO TO DATA-TOO-LONG.
010830     GO TO READ-CARD.
010840
010850 PROC-SEHED.
010860     MOVE 1 TO SEHED-SW.
010870     MOVE SPACES TO SECT-STORE.
010880     GO TO READ-CARD.
010890
010900 PROC-SENUM.
010910     MOVE 1 TO SENUM-SW.
010920     MOVE SPACES TO SECT-NUMBER, SECT-SEC.
010930     GO TO READ-CARD.
010940
010950 PROC-SEQ.
010960     IF TOO-LATE-SW = 1, GO TO TOO-LATE.
010970     IF RESEQ-SW EQUAL TO 1 GO TO TOO-LATE.
010980     IF BEG-SEQ-SPAC EQUAL TO SPACES,
010990     MOVE  ZEROS TO BEG-SEQ-NUM.
011000     IF BEG-SEQ-NUM NOT NUMERIC,
011010     MOVE 07 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
011020     MOVE 1 TO RESEQ-SW.
011030     OPEN OUTPUT PUNCH-FILE.
011040     MOVE BEG-SEQ-NUM TO PAGLIN-CTR.
011050     GO TO READ-CARD.
011060
011070 PROC-SINGL.
011080     MOVE SPACE-ONE   TO NORM-SPAC.
011090     GO TO READ-CARD.
011100
011110 PROC-SKIP.
011120     MOVE STORE-HEAD TO STORE-OLD-HEAD.
011130     ALTER PROC-HEAD-EXIT TO PROCEED TO PROC-SKIP-CONTD.
011140     GO TO PROC-HEAD.
011150 PROC-SKIP-CONTD.
011160     ALTER PROC-HEAD-EXIT TO PROCEED TO READ-CARD.
011170     MOVE STORE-OLD-HEAD TO STORE-HEAD.
011180     MOVE 67 TO LINES-CTR.
011190     GO TO READ-CARD.
011200
011210 PROC-SPAC9.
011220     ALTER  NORM-EXIT TO PROCEED TO PROC-SPAC8.
011230     GO TO PRINT-BLANK.
011240
011250 PROC-SPAC8.
011260     ALTER  NORM-EXIT TO PROCEED TO PROC-SPAC7.
011270     GO TO PRINT-BLANK.
011280
011290 PROC-SPAC7.
011300     ALTER  NORM-EXIT TO PROCEED TO PROC-SPAC6.
011310     GO TO PRINT-BLANK.
011320
011330 PROC-SPAC6.
011340     ALTER  NORM-EXIT TO PROCEED TO PROC-SPAC5.
011350     GO TO PRINT-BLANK.
011360
011370 PROC-SPAC5.
011380     ALTER  NORM-EXIT TO PROCEED TO PROC-SPAC4.
011390     GO TO PRINT-BLANK.
011400
011410 PROC-SPAC4.
011420     ALTER  NORM-EXIT TO PROCEED TO PROC-SPAC3.
011430     GO TO PRINT-BLANK.
011440
011450 PROC-SPAC3.
011460     ALTER  NORM-EXIT TO PROCEED TO PROC-SPAC2.
011470     GO TO PRINT-BLANK.
011480
011490 PROC-SPAC2.
011500     ALTER  NORM-EXIT TO PROCEED TO PROC-SPAC1.
011510     GO TO PRINT-BLANK.
011520
011530 PROC-SPAC1.
011540     IF CARD-DATA IS NOT EQUAL TO SPACES GO TO PROC-PARA.
011550     ALTER  NORM-EXIT TO PROCEED TO READ-CARD.
011560     MOVE CARD-DATA TO NORM-MARGIN.
011570     MOVE SPACE-ONE TO SPAC-CTL.
011580     GO TO NORM-PRINT.
011590
011600 PRINT-BLANK.
011610     MOVE SPACES TO PRINT-LINE.
011620     MOVE NORM-SPAC TO SPAC-CTL.
011630     GO TO TEST-LINES.
011640
011650 PROC-SUBPG.
011660     IF BEG-PAG-SPAC EQUAL TO SPACES GO TO PROC-SUBPG-BLNKS.
011670     IF BEG-PAG-NUM NOT NUMERIC,
011680     MOVE 08 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
011690     IF BEG-SUB-NUM NOT NUMERIC,
011700     MOVE 09 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
011710     MOVE 1 TO SUB-PAG-SW.
011720     MOVE BEG-SUB-NUM TO SUB-PAG-CTR.
011730     SUBTRACT 1 FROM SUB-PAG-CTR.
011740     MOVE BEG-PAG-NUM TO PAGE-CTR.
011750     GO TO READ-CARD.
011760 PROC-SUBPG-BLNKS.
011770     MOVE 1 TO SUB-PAG-SW.
011780     MOVE ZEROS TO SUB-PAG-CTR.
011790     GO TO READ-CARD.
011800
011810 PROC-XLINE.
011820     IF NUM-LINES NOT NUMERIC,
011830         MOVE 04 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
011840     IF NUM-LINES GREATER THAN 66,
011850         MOVE 05 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
011860     MOVE NUM-LINES TO XLINES-LIMIT.
011870     SUBTRACT 03 FROM  XLINES-LIMIT.
011880     IF XLINES-LIMIT IS NEGATIVE, MOVE ZEROS TO XLINES-LIMIT.
011890     GO TO READ-CARD.
011900     EJECT
011910 NORM-PRINT.
011920     IF PAGLIN-SW NOT EQUAL TO 1 GO TO TEST-LINES.
011930     IF RESEQ-SW EQUAL TO 1 MOVE PAGLIN-CTR TO PR-PAGLIN, ELSE
011940     MOVE CARD-SEQ TO PRINT-PAGLIN.
011950 TEST-LINES.
011960     IF  SPAC-CTL EQUAL TO   SPACE-ONE   ADD 1 TO LINES-CTR.
011970     IF  SPAC-CTL EQUAL TO   SPACE-TWO   ADD 2 TO LINES-CTR.
011980     IF  SPAC-CTL EQUAL TO   SPACE-THREE ADD 3 TO LINES-CTR.
011990     IF LINES-CTR IS NOT GREATER THAN LINES-LIMIT
012000     GO TO NORM-PRINT-CONTD.
012010     MOVE PRINT-LINE TO STORE-PRINT-REC.
012020     MOVE SPAC-CTL TO STORE-SPAC-CTL.
012030     MOVE SPACES TO PRINT-REC.
012040     ALTER HEAD-EXIT TO PROCEED TO NORM-PRINT-RESTORE.
012050     GO TO PAGE-HEADINGS.
012060 NORM-PRINT-RESTORE.
012070     MOVE STORE-PRINT-REC TO PRINT-LINE.
012080     MOVE STORE-SPAC-CTL TO SPAC-CTL.
012090     GO TO NORM-PRINT.
012100 NORM-PRINT-CONTD.
012110     ALTER WRITE-IMAGE-EXIT TO PROCEED TO NORM-EXIT.
012120     GO TO WRITE-IMAGE.
012130 NORM-EXIT. GO TO READ-CARD.
012140     EJECT
012150 WRITE-IMAGE.
012160     IF  EJECT-SW EQUAL TO 1 MOVE SKIP-TO-ONE TO SPAC-CTL,
012170     MOVE SPACE TO EJECT-SW.
012180     IF COPY-CTR NOT GREATER THAN 01, GO TO PRINT-A-LINE.
012190     MOVE PRINT-REC TO DISK-REC.
012200
012210     WRITE DISK-REC, INVALID KEY GO TO PRINT-A-LINE.
012220 PRINT-A-LINE.
012230     IF  TAPE-TWO-UP, GO TO WRITE-TWO-UP.
012240     IF  TAPE-ONE-UP, GO TO WRITE-ONE-UP.
012250     WRITE PRINT-REC AFTER POSITIONING SPAC-CTL.
012260     MOVE SPACES TO PRINT-REC.
012270 WRITE-IMAGE-EXIT. GO TO NORM-EXIT.
012280
012290 WRITE-TWO-UP.
012300     MOVE SPAC-CTL   TO  T-LINE-CNTRL.
012310     MOVE P-72       TO  LEFT-PAGE.
012320     MOVE SPACES     TO  CENTER.
012330     MOVE P-72       TO  RIGHT-PAGE.
012340     MOVE SPACES     TO  EXTRAS.
012350     WRITE TWO-UP-LINE.
012360     MOVE SPACES     TO  PRINT-REC.
012370     ADD 1 TO TAPE-RECDS.
012380     GO TO WRITE-IMAGE-EXIT.
012390
012400 WRITE-ONE-UP.
012410     MOVE SPAC-CTL   TO  O-LINE-CNTRL.
012420     MOVE PRINT-LINE TO  O-DATA-LINE.
012430     WRITE ONE-UP-LINE.
012440     MOVE SPACES     TO  PRINT-REC.
012450     ADD 1 TO TAPE-RECDS.
012460     GO TO WRITE-IMAGE-EXIT.
012470
012480 PRINTER.
012490     WRITE PRINT-REC AFTER POSITIONING SPAC-CTL.
012500     MOVE SPACES TO PRINT-REC.
012510 PRINT-EXIT. GO TO.
012520     EJECT
012530 TABLE-ENTRY.
012540     IF NO-TABLE-SW EQUAL TO 1 GO TO TABLE-ENTRY-EXIT.
012550     MOVE 1 TO TABLE-SW.
012560     MOVE SPACE-TWO TO TAB-REC-SPAC.
012570     IF SECTN-CARD, GO TO WRITE-TRIK.
012580     PERFORM LEADER-FILL THRU LEADER-EXIT.
012590     MOVE PAGE-CTR TO TAB-PAGE-NO.
012600     IF SUB-PAG-SW IS EQUAL TO 1, MOVE '.' TO TAB-DECIMAL,
012610         MOVE SUB-PAG-CTR TO TAB-SUB-PAGE.
012620 WRITE-TRIK.
012630     WRITE TABLE-RECORD, INVALID KEY GO TO TABLE-ENTRY-EXIT.
012640 TABLE-ENTRY-EXIT. GO TO.
012650
012660 LEADER-FILL.
012670     MOVE 30 TO SUB.
012680 LEADER-LOOP.
012690     IF  LEADERS (SUB) EQUAL TO SPACE AND
012700         SUB GREATER THAN ZERO
012710     MOVE ' .' TO LEADERS (SUB),
012720         SUBTRACT 01 FROM SUB,
012730         GO TO LEADER-LOOP.
012740 LEADER-EXIT. EXIT.
012750     EJECT
012760 REPORT-PRINTING.
012770     IF BKHED-CARD GO TO PROC-BKHED.
012780     IF BKNUM-CARD GO TO PROC-BKNUM.
012790     IF BOOK-CARD GO TO LAST-CARD.
012800     IF COPY-CARD  GO TO PROC-COPY.
012810     IF DOUBL-CARD GO TO TEST-LEFT.
012820     IF EJECT-CARD GO TO TEST-LEFT.
012830     IF LINES-CARD GO TO PROC-LINES.
012840     IF LIST-CARD GO TO TEST-LEFT.
012850     IF NARR-CARD GO TO TEST-LEFT.
012860     IF NOHED-CARD GO TO PROC-NOHED.
012870     IF NOTAB-CARD GO TO PROC-NOTAB.
012880     IF PAGE-CARD GO TO PROC-PAGE.
012890     IF PRTPG-CARD GO TO PROC-PRTPG.
012900     IF REPRT-CARD GO TO TEST-LEFT.
012910     IF SEHED-CARD GO TO PROC-SEHED.
012920     IF SENUM-CARD GO TO PROC-SENUM.
012930     IF SEQ-CARD   GO TO PROC-SEQ.
012940     IF SINGL-CARD GO TO TEST-LEFT.
012950     IF TITLE-CARD GO TO TEST-LEFT.
012960     IF XLINE-CARD GO TO PROC-XLINE.
012970     MOVE 1 TO TOO-LATE-SW.
012980     IF ENSUB-CARD GO TO PROC-ENSUB.
012990     IF INDEX-CARD GO TO TABLE-INDEX.
013000     IF NORM-CARD GO TO REPORT-NORMAL.
013010     IF SPAC1-CARD GO TO TEST-LEFT.
013020     IF SPAC2-CARD GO TO TEST-LEFT.
013030     IF SPAC3-CARD GO TO TEST-LEFT.
013040     IF SPAC4-CARD GO TO TEST-LEFT.
013050     IF SPAC5-CARD GO TO TEST-LEFT.
013060     IF SPAC6-CARD GO TO TEST-LEFT.
013070     IF SPAC7-CARD GO TO TEST-LEFT.
013080     IF SPAC8-CARD GO TO TEST-LEFT.
013090     IF SPAC9-CARD GO TO TEST-LEFT.
013100     IF SUBPG-CARD GO TO PROC-SUBPG.
013110     MOVE 02 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
013120
013130 REPORT-NORMAL.
013140     IF R-CRD-BLANKS NOT EQUAL TO SPACES ALTER TOO-LONG-EXIT TO
013150     PROCEED TO REPORT-CONTD, GO TO DATA-TOO-LONG.
013160 REPORT-CONTD.
013170     IF LEFT-SW = 1 GO TO PRINT-RIGHT.
013180     MOVE 1 TO LEFT-SW.
013190     MOVE REPORT-CARD TO LEFT-HALF.
013200     GO TO READ-CARD.
013210
013220 PRINT-RIGHT.
013230     MOVE SPACE TO LEFT-SW.
013240     MOVE REPORT-CARD TO RIGHT-HALF.
013250     GO TO PROC-NORM-CONTD.
013260
013270 TEST-LEFT.
013280     IF LEFT-SW = 1 MOVE SPACE TO LEFT-SW,
013290     ALTER NORM-EXIT TO PROCEED TO TEST-REPORT-CARDS,
013300     MOVE NORM-SPAC TO SPAC-CTL,
013310     GO TO NORM-PRINT.
013320
013330 TEST-REPORT-CARDS.
013340     IF DOUBL-CARD GO TO PROC-DOUBL.
013350     IF EJECT-CARD GO TO PROC-EJECT.
013360     IF LIST-CARD GO TO PROC-MODE-CHG.
013370     IF NARR-CARD GO TO PROC-MODE-CHG.
013380     IF REPRT-CARD GO TO PROC-MODE-CHG.
013390     IF SINGL-CARD GO TO PROC-SINGL.
013400     IF SPAC1-CARD GO TO PROC-SPAC1.
013410     IF SPAC2-CARD GO TO PROC-SPAC2.
013420     IF SPAC3-CARD GO TO PROC-SPAC3.
013430     IF SPAC4-CARD GO TO PROC-SPAC4.
013440     IF SPAC5-CARD GO TO PROC-SPAC5.
013450     IF SPAC6-CARD GO TO PROC-SPAC6.
013460     IF SPAC7-CARD GO TO PROC-SPAC7.
013470     IF SPAC8-CARD GO TO PROC-SPAC8.
013480     IF SPAC9-CARD GO TO PROC-SPAC9.
013490     IF TITLE-CARD GO TO PROC-MODE-CHG.
013500     GO TO READ-CARD.
013510     EJECT
013520 LIST-PRINTING.
013530     IF BOOK-CARD GO TO LAST-CARD.
013540     IF DOUBL-CARD GO TO PROC-DOUBL.
013550     IF EJECT-CARD GO TO PROC-EJECT.
013560     IF  LIST-CARD GO TO PROC-MODE-CHG.
013570     IF  NARR-CARD GO TO PROC-MODE-CHG.
013580     IF REPRT-CARD GO TO PROC-MODE-CHG.
013590     IF SINGL-CARD GO TO PROC-SINGL.
013600     IF TITLE-CARD GO TO PROC-MODE-CHG.
013610     IF RESEQ-SW EQUAL TO 1 MOVE PAGLIN-CTR TO LIST-SEQ, ELSE
013620     MOVE CARD-SEQ TO LIST-SEQ.
013630     MOVE CTL-WORD TO LIST-CTL.
013640     MOVE CARD-DATA TO LIST-DATA.
013650     MOVE NORM-SPAC TO SPAC-CTL.
013660     ALTER NORM-EXIT TO PROCEED TO LIST-PRINT-CONTD.
013670     GO TO NORM-PRINT.
013680 LIST-PRINT-CONTD.
013690     IF BKHED-CARD GO TO PROC-BKHED.
013700     IF BKNUM-CARD GO TO PROC-BKNUM.
013710     IF COPY-CARD GO TO PROC-COPY.
013720     IF LINES-CARD GO TO PROC-LINES.
013730     IF NOHED-CARD GO TO PROC-NOHED.
013740     IF NOTAB-CARD GO TO PROC-NOTAB.
013750     IF PAGE-CARD GO TO PROC-PAGE.
013760     IF PRTPG-CARD GO TO PROC-PRTPG.
013770     IF SEHED-CARD GO TO PROC-SEHED.
013780     IF SENUM-CARD GO TO PROC-SENUM.
013790     IF SEQ-CARD GO TO PROC-SEQ.
013800     IF XLINE-CARD GO TO PROC-XLINE.
013810     MOVE 1 TO TOO-LATE-SW.
013820     IF ENSUB-CARD GO TO PROC-ENSUB.
013830     IF SUBPG-CARD GO TO PROC-SUBPG.
013840     GO TO READ-CARD.
013850     EJECT
013860 PAGE-HEADINGS.
013870     MOVE ZEROS TO LINES-CTR.
013880     IF SUB-PAG-SW EQUAL TO 1 ADD 1 TO SUB-PAG-CTR, ELSE
013890     ADD 1 TO PAGE-CTR.
013900     IF TITLE-MODE GO TO SKIP-ONE.
013910     IF REPORT-MODE GO TO SKIP-ONE.
013920     IF NOHED-SW EQUAL TO 1 GO TO SKIP-ONE.
013930     IF LIST-MODE GO TO SKIP-ONE.
013940     MOVE SKIP-TO-ONE TO SPAC-CTL.
013950     IF BKHED-SW EQUAL TO 1 GO TO SECT-HEAD.
013960     IF BOOK-NAME EQUAL TO SPACES GO TO SECT-HEAD.
013970     IF BKNUM-SW EQUAL TO 1 MOVE SPACES TO BOOK-NUMBER.
013980     MOVE BOOK-STORE TO PRINT-LINE.
013990     ALTER WRITE-IMAGE-EXIT TO PROCEED TO FINISH-BOOK-HEAD.
014000     GO TO WRITE-IMAGE.
014010 FINISH-BOOK-HEAD.
014020     MOVE SPACE-ONE   TO SPAC-CTL.
014030     ADD 1 TO LINES-CTR.
014040 SECT-HEAD.
014050     IF SECT-NAME EQUAL TO SPACES GO TO HEADING-LINE.
014060     MOVE SECT-STORE TO SECT-LINE.
014070     ALTER WRITE-IMAGE-EXIT TO PROCEED TO FINISH-SECT-HEAD.
014080     GO TO WRITE-IMAGE.
014090 FINISH-SECT-HEAD.
014100     MOVE SPACE-ONE TO SPAC-CTL.
014110     ADD 1 TO LINES-CTR.
014120 HEADING-LINE.
014130     MOVE PAGE-CTR TO PR-PAGE.
014140     MOVE CURR-DATE TO PR-DATE.
014150     MOVE '   PAGE ' TO PAGE-LABEL.
014160     IF SUB-PAG-SW EQUAL TO 1 MOVE '.' TO PR-DEC,
014170     MOVE SUB-PAG-CTR TO PR-SUBPG.
014180     MOVE STORE-HEAD TO HEAD-LINE.
014190     ALTER WRITE-IMAGE-EXIT TO PROCEED TO FINISH-HEAD.
014200     GO TO WRITE-IMAGE.
014210 FINISH-HEAD.
014220     ADD 2 TO LINES-CTR.
014230     ALTER WRITE-IMAGE-EXIT TO PROCEED TO COLUMN-HEADING-ONE.
014240     GO TO WRITE-IMAGE.
014250 COLUMN-HEADING-ONE.
014260     MOVE SPACE-ONE TO SPAC-CTL.
014270     IF COLM-ONE-STORE IS EQUAL TO SPACES
014280         GO TO COLUMN-HEADING-TWO.
014290     ADD 1 TO LINES-CTR.
014300     MOVE COLM-ONE-STORE TO NORM-MARGIN.
014310     ALTER WRITE-IMAGE-EXIT TO PROCEED TO COLUMN-HEADING-TWO.
014320     GO TO WRITE-IMAGE.
014330 COLUMN-HEADING-TWO.
014340     MOVE SPACE-ONE TO SPAC-CTL.
014350     IF COLM-TWO-STORE IS EQUAL TO SPACES
014360         GO TO COLUMN-HEADING-THREE.
014370     ADD 1 TO LINES-CTR.
014380     MOVE COLM-TWO-STORE TO NORM-MARGIN.
014390     ALTER WRITE-IMAGE-EXIT TO PROCEED TO COLUMN-HEADING-THREE.
014400     GO TO WRITE-IMAGE.
014410 COLUMN-HEADING-THREE.
014420     MOVE SPACE-ONE TO SPAC-CTL.
014430     IF COLM-THREE-STORE IS EQUAL TO SPACES GO TO HEAD-EXIT.
014440     ADD 1 TO LINES-CTR.
014450     MOVE COLM-THREE-STORE TO NORM-MARGIN.
014460     ALTER WRITE-IMAGE-EXIT TO PROCEED TO HEAD-EXIT.
014470     GO TO WRITE-IMAGE.
014480 HEAD-EXIT. GO TO NORM-PRINT-RESTORE.
014490
014500 SKIP-ONE.
014510     MOVE 1 TO EJECT-SW.
014520     GO TO HEAD-EXIT.
014530
014540 TOO-LATE.
014550     MOVE 10 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
014560
014570 DATA-TOO-LONG.
014580     MOVE 11 TO DIAG-INDICATOR, GO TO DIAGNOSTICS-ROUT.
014590 TOO-LONG-EXIT. GO TO NORM-PRINT.
014600     EJECT
014610 ALIGN-PRINTER.
014620     IF  FIRST-BOOK-IND NOT = SPACE  GO TO READ-CARD.
014630     MOVE '1' TO FIRST-BOOK-IND.
014640     MOVE SKIP-TO-ONE TO SPAC-CTL.
014650 ALIGNMENT-MESSAGE.
014660     MOVE '         1         2         3         4         5
014670-    '    6      ' TO LEFT-HALF.
014680     MOVE '   7         8         9         0         1         2
014690-    '        3  ' TO RIGHT-HALF.
014700     ALTER PRINT-EXIT TO PROCEED TO ALIGN-RETN-1, GO TO PRINTER.
014710 ALIGN-RETN-1.
014720     MOVE SPACE-ONE   TO SPAC-CTL.
014730     MOVE '1234567890123456789012345678901234567890123456789012345
014740-    '67890123456' TO LEFT-HALF.
014750     MOVE '7890123456789012345678901234567890123456789012345678901
014760-    '23456789012' TO RIGHT-HALF.
014770     ALTER PRINT-EXIT TO PROCEED TO ALIGN-RETN-2, GO TO PRINTER.
014780 ALIGN-RETN-2.
014790     ADD  03 TO X-LINES-CTR.
014800 ALIGN-EXIT-ONE. GO TO ALIGNMENT-X.
014810
014820 ALIGNMENT-X.
014830     MOVE 'X' TO PRT-POS-ONE.
014840     MOVE 'X' TO PRT-POS-85.
014850     MOVE 'X' TO PRT-POS-132.
014860     ALTER PRINT-EXIT TO PROCEED TO ALIGN-RETN-3, GO TO PRINTER.
014870 ALIGN-RETN-3.
014880     SUBTRACT 01 FROM X-LINES-CTR.
014890     IF X-LINES-CTR IS POSITIVE GO TO ALIGNMENT-X.
014900 ALIGN-EXIT-TWO. GO TO ALIGN-MESS.
014910
014920 ALIGN-MESS.
014930     MOVE 'X        FOR PROPER FORMS ALIGNMENT ON DOCUMENTATION PA
014940-    'PER, PRINT ' TO LEFT-HALF.
014950     MOVE 'POSITIONS         X
014960-    '          X' TO RIGHT-HALF.
014970     ALTER PRINT-EXIT TO PROCEED TO ALIGN-RETN-4, GO TO PRINTER.
014980 ALIGN-RETN-4.
014990     MOVE 'X        1 THROUGH 85 SHOULD APPEAR EXACTLY BETWEEN PER
015000-    'FORATIONS. ' TO LEFT-HALF.
015010     MOVE 'X' TO PRT-POS-85.
015020     MOVE 'X' TO PRT-POS-132.
015030     ALTER PRINT-EXIT TO PROCEED TO ALIGN-RETN-5, GO TO PRINTER.
015040 ALIGN-RETN-5.
015050     MOVE 'X' TO PRT-POS-85.
015060     MOVE 'X' TO PRT-POS-132.
015070     MOVE 'X        ALIGNMENT PAGE WILL AUTOMATICALLY PRINT ONE MO
015080-    'RE TIME,   ' TO LEFT-HALF.
015090     ALTER PRINT-EXIT TO PROCEED TO ALIGN-RETN-6, GO TO PRINTER.
015100 ALIGN-RETN-6.
015110     MOVE 'X' TO PRT-POS-85.
015120     MOVE 'X' TO PRT-POS-132.
015130     MOVE 'X        THEN NORMAL PROCESSING WILL BEGIN.  DEPRESS EO
015140-    'B.         ' TO LEFT-HALF.
015150     ALTER PRINT-EXIT TO PROCEED TO ALIGN-RETN-7, GO TO PRINTER.
015160 ALIGN-RETN-7.
015170     MOVE 45 TO X-LINES-CTR.
015180     ALTER ALIGN-EXIT-TWO TO PROCEED TO ALIGNMENT-MESSAGE.
015190     ALTER ALIGN-EXIT-ONE TO PROCEED TO CONSOLE-MESSAGE.
015200 ALIGN-EXIT-THREE. GO TO ALIGNMENT-X.
015210
015220 CONSOLE-MESSAGE.
015230     MOVE SKIP-TO-ONE TO SPAC-CTL.
015240     ALTER PRINT-EXIT TO PROCEED TO CONSOLE-RETN, GO TO PRINTER.
015250 CONSOLE-RETN.
015260     ALTER ALIGN-EXIT-ONE TO PROCEED TO ALIGNMENT-X.
015270     ALTER ALIGN-EXIT-TWO TO PROCEED TO CONSOLE-RETN-1.
015280     MOVE 49 TO X-LINES-CTR.
015290     MOVE SPACE-ONE   TO SPAC-CTL.
015300     GO TO ALIGNMENT-MESSAGE.
015310 CONSOLE-RETN-1.
015320     ALTER ALIGN-EXIT-ONE TO PROCEED TO READ-CARD.
015330     GO TO ALIGNMENT-MESSAGE.
015340 ALIGN-TAPE.
015350     ADD 1 TO TAPE-FILES.
015360     MOVE SKIP-TO-ONE TO T-LINE-CNTRL.
015370     MOVE SPACES      TO TAPE-REC1.
015380     MOVE TAPE-ALIGN-1 TO LEFT-PAGE.
015390     PERFORM WRIT-ALIGN-TAPE THRU W-A-T-EXIT.
015400     MOVE TAPE-ALIGN-2 TO LEFT-PAGE.
015410     PERFORM WRIT-ALIGN-TAPE THRU W-A-T-EXIT.
015420     MOVE 03 TO X-LINES-CTR.
015430     PERFORM ALIGN-TAPE-1 THRU A-T-1-EXIT.
015440     MOVE TAPE-ALIGN-3 TO LEFT-PAGE.
015450     MOVE 'X' TO TAPE-POS-76.
015460     PERFORM WRIT-ALIGN-TAPE THRU W-A-T-EXIT.
015470     MOVE TAPE-ALIGN-4 TO LEFT-PAGE.
015480     MOVE 'X' TO TAPE-POS-76.
015490     PERFORM WRIT-ALIGN-TAPE THRU W-A-T-EXIT.
015500     MOVE TAPE-ALIGN-5 TO LEFT-PAGE.
015510     MOVE 'X' TO TAPE-POS-76.
015520     PERFORM WRIT-ALIGN-TAPE THRU W-A-T-EXIT.
015530     MOVE TAPE-ALIGN-6 TO LEFT-PAGE.
015540     MOVE 'X' TO TAPE-POS-76.
015550     PERFORM WRIT-ALIGN-TAPE THRU W-A-T-EXIT.
015560     MOVE TAPE-ALIGN-7 TO LEFT-PAGE.
015570     MOVE 'X' TO TAPE-POS-76.
015580     PERFORM WRIT-ALIGN-TAPE THRU W-A-T-EXIT.
015590     MOVE 47 TO X-LINES-CTR.
015600     PERFORM ALIGN-TAPE-1 THRU A-T-1-EXIT.
015610     MOVE 1 TO EJECT-SW.
015620     MOVE 57 TO TAPE-RECDS.
015630     GO TO READ-CARD.
015640 ALIGN-TAPE-1.
015650     MOVE 'X' TO TAPE-POS-ONE.
015660     MOVE 'X' TO TAPE-POS-76.
015670     PERFORM WRIT-ALIGN-TAPE THRU W-A-T-EXIT.
015680     SUBTRACT 01 FROM X-LINES-CTR.
015690     IF  X-LINES-CTR IS POSITIVE GO TO ALIGN-TAPE-1.
015700 A-T-1-EXIT.
015710
015720 WRIT-ALIGN-TAPE.
015730     IF  TAPE-ONE-UP GO TO W-A-T-1.
015740     MOVE LEFT-PAGE TO RIGHT-PAGE.
015750     WRITE TWO-UP-LINE.
015760     MOVE SPACES TO TWO-UP-LINE.
015770     GO TO W-A-T-EXIT.
015780 W-A-T-1.
015790     MOVE T-LINE-CNTRL TO O-LINE-CNTRL.
015800     MOVE TAPE-LEFT    TO O-DATA-LINE.
015810     WRITE ONE-UP-LINE.
015820     MOVE SPACES TO TWO-UP-LINE.
015830 W-A-T-EXIT. EXIT.
015840     EJECT
015850 DIAGNOSTICS-ROUT.
015860     MOVE SPACES TO DIAGNOSTICS.
015870     MOVE SPACE-TWO   TO SPAC-CTL.
015880     MOVE 1 TO DIAGNOSTICS-SW.
015890     MOVE CARD-SEQ TO DIAG-SEQ.
015900     MOVE 'CARD #' TO DIAG-CARD.
015910     MOVE CARD-CTR TO DIAG-CARD-NO.
015920     MOVE 'PAGE #' TO DIAG-PAGE.
015930     MOVE PAGE-CTR TO DIAG-PAG-NO.
015940     IF SUB-PAG-SW EQUAL TO 1 MOVE '.' TO DIAG-DEC,
015950     MOVE SUB-PAG-CTR TO DIAG-SUBPG.
015960     GO TO DIAG-ERR-1, DIAG-ERR-2, DIAG-ERR-3, DIAG-ERR-4,
015970     DIAG-ERR-5, DIAG-ERR-6, DIAG-ERR-7, DIAG-ERR-8, DIAG-ERR-9,
015980     DIAG-ERR-10, DIAG-ERR-11 DEPENDING ON DIAG-INDICATOR.
015990
016000 DIAG-ERR-1.
016010     MOVE 'INVALID CTL WORD-PROCESSED AS BLANK' TO DIAG-MESSAGE.
016020     MOVE ' CTL WORD.' TO DIAG-BYP.
016030     MOVE '*' TO PRT-POS-85.
016040     GO TO DIAG-WRITE.
016050
016060 DIAG-ERR-2.
016070     MOVE 'CONTROL WORD INVALID IN REPORT MODE' TO DIAG-MESSAGE.
016080     GO TO DIAG-MOVE-BYP.
016090
016100 DIAG-ERR-3.
016110     MOVE 'COLS 11-12 OF COPY CARD NOT NUMERIC' TO DIAG-MESSAGE.
016120     GO TO DIAG-MOVE-BYP.
016130
016140 DIAG-ERR-4.
016150     MOVE 'COLS 11-12 OF LINES CRD NOT NUMERIC' TO DIAG-MESSAGE.
016160     GO TO DIAG-MOVE-BYP.
016170
016180 DIAG-ERR-5.
016190     MOVE 'LINES CARD REQUESTS OVER 66 LINES  ' TO DIAG-MESSAGE.
016200     GO TO DIAG-MOVE-BYP.
016210
016220 DIAG-ERR-6.
016230     MOVE 'COLS 11-14 OF PAGE CARD NOT NUMERIC' TO DIAG-MESSAGE.
016240     GO TO DIAG-MOVE-BYP.
016250
016260 DIAG-ERR-7.
016270     MOVE 'COLS 11-16 OF SEQ CARD NOT NUMERIC ' TO DIAG-MESSAGE.
016280     GO TO DIAG-MOVE-BYP.
016290
016300 DIAG-ERR-8.
016310     MOVE 'COLS 11-14 OF SUBPG CRD NOT NUMERIC' TO DIAG-MESSAGE.
016320     GO TO DIAG-MOVE-BYP.
016330
016340 DIAG-ERR-9.
016350     MOVE 'COLS 16-18 OF SUBPG CRD NOT NUMERIC' TO DIAG-MESSAGE.
016360     GO TO DIAG-MOVE-BYP.
016370
016380 DIAG-ERR-10.
016390     MOVE 'MUST PRECEDE FIRST LINE OF PRINTING' TO DIAG-MESSAGE.
016400     GO TO DIAG-MOVE-BYP.
016410
016420 DIAG-ERR-11.
016430     MOVE 'DATA TOO LONG, EXCESS TRUNCATED.   ' TO DIAG-MESSAGE.
016440     IF REPORT-MODE GO TO DIAG-WRITE.
016450     IF BOOK-CARD GO TO DIAG-WRITE.
016460     IF SECT-CARD GO TO DIAG-WRITE.
016470     IF HEAD-CARD GO TO DIAG-WRITE.
016480     MOVE '*' TO PRT-POS-85.
016490     GO TO DIAG-WRITE.
016500
016510 DIAG-MOVE-BYP.
016520     MOVE '-BYPASSED.' TO DIAG-BYP.
016530 DIAG-WRITE.
016540     ALTER DIAG-WRITE-EXIT TO PROCEED TO DIAG-SECOND-LINE.
016550 DIAGNOSTICS-WRITE.
016560     WRITE DIAGNOSTICS, INVALID KEY GO TO DIAG-WRITE-1.
016570 DIAG-WRITE-1.
016580     MOVE SPACES TO DIAGNOSTICS.
016590 DIAG-WRITE-EXIT. GO TO.
016600
016610 DIAG-SECOND-LINE.
016620     MOVE CTL-WORD TO DIAG-CTL-WD.
016630     MOVE CARD-DATA TO DIAG-CARD-DATA.
016640     ALTER DIAG-WRITE-EXIT TO PROCEED TO DIAG-END.
016650     GO TO DIAGNOSTICS-WRITE.
016660
016670 DIAG-END.
016680     IF DIAG-INDICATOR EQUAL TO 01 GO TO PROC-NORM.
016690     IF DIAG-INDICATOR EQUAL TO 11 GO TO TOO-LONG-EXIT.
016700     GO TO READ-CARD.
016710     EJECT
016720 LAST-CARD.
016730     IF NOT REPORT-MODE GO TO END-OF-CARDS.
016740     IF LEFT-SW = 1 MOVE SPACE TO LEFT-SW,
016750     ALTER NORM-EXIT TO PROCEED TO END-OF-CARDS,
016760     GO TO NORM-PRINT.
016770
016780 END-OF-CARDS.
016790     IF RESEQ-SW = 1,
016800     MOVE SPACES TO PUNCH-REC,
016810     WRITE PUNCH-REC, CLOSE PUNCH-FILE.
016820     CLOSE LINE-IMAGE, TABLE-FILE, DIAGNOSTICS-FILE.
016830
016840 DIAGNOSTICS-PRINTING.
016850     IF DIAGNOSTICS-SW NOT EQUAL TO 1 GO TO DIAG-PRINT-HEAD.
016860     OPEN INPUT DIAGNOSTICS-FILE.
016870 DIAG-PRINT-HEAD.
016880     MOVE ZERO TO LINES-CTR.
016890     MOVE BOOK-STORE TO PRINT-LINE.
016900     MOVE SKIP-TO-ONE TO SPAC-CTL.
016910     ALTER PRINT-EXIT TO PROCEED TO DIAG-RETN-1, GO TO PRINTER.
016920 DIAG-RETN-1.
016930     MOVE SPACE-TWO   TO SPAC-CTL.
016940     MOVE CURR-DATE TO PR-DATE.
016950     MOVE 'DIAGNOSTICS' TO HEAD-LINE.
016960     ALTER PRINT-EXIT TO PROCEED TO DIAG-RETN-2, GO TO PRINTER.
016970 DIAG-RETN-2.
016980     MOVE SPACE-ONE   TO SPAC-CTL.
016990     ALTER PRINT-EXIT TO PROCEED TO DIAG-DETAIL, GO TO PRINTER.
017000 DIAG-DETAIL.
017010     IF DIAGNOSTICS-SW NOT EQUAL TO 1 GO TO DIAG-NONE.
017020     ADD 1 TO LINES-CTR.
017030     IF LINES-CTR GREATER THAN 34 GO TO DIAG-PRINT-HEAD.
017040     READ DIAGNOSTICS-FILE AT END GO TO DIAG-CLOSE.
017050     MOVE DIAGNOSTICS TO PRINT-REC.
017060     MOVE DIAG-SPAC TO SPAC-CTL.
017070     ALTER PRINT-EXIT TO PROCEED TO DIAG-DETAIL, GO TO PRINTER.
017080
017090 DIAG-NONE.
017100     MOVE SPACE-TWO   TO SPAC-CTL.
017110     MOVE 'NONE' TO NORM-MARGIN.
017120     ALTER PRINT-EXIT TO PROCEED TO TABLE-OF-CONTENTS.
017130     GO TO PRINTER.
017140
017150 DIAG-CLOSE.
017160     CLOSE DIAGNOSTICS-FILE.
017170     EJECT
017180 TABLE-OF-CONTENTS.
017190     IF TABLE-SW NOT EQUAL TO 1 GO TO TABLE-EXIT.
017200     OPEN INPUT TABLE-FILE.
017210     MOVE ZERO TO PAGE-CTR.
017220
017230 TABLE-HEADING.
017240     MOVE ZERO TO LINES-CTR.
017250     MOVE BOOK-STORE TO PRINT-LINE.
017260     MOVE SKIP-TO-ONE TO SPAC-CTL.
017270     ALTER WRITE-IMAGE-EXIT TO PROCEED TO    TABLE-RETN-1,
017280         GO TO PRINT-A-LINE.
017290 TABLE-RETN-1.
017300     MOVE SPACE-TWO   TO SPAC-CTL.
017310     MOVE CURR-DATE TO HEADER-DATE.
017320     ADD 1 TO PAGE-CTR.
017330     MOVE ROMAN-NBRS (PAGE-CTR) TO TOC-PAGE.
017340     MOVE TABLE-HEADER TO PRINT-LINE.
017350     ALTER WRITE-IMAGE-EXIT TO PROCEED TO    TABLE-RETN-2,
017360         GO TO PRINT-A-LINE.
017370 TABLE-RETN-2.
017380     MOVE SPACE-TWO TO SPAC-CTL.
017390     MOVE TABLE-HEADER-1 TO PRINT-LINE.
017400     ALTER WRITE-IMAGE-EXIT TO PROCEED TO TABLE-RETN-3.
017410     GO TO PRINT-A-LINE.
017420 TABLE-RETN-3.
017430     MOVE SPACE-ONE   TO SPAC-CTL.
017440     ALTER WRITE-IMAGE-EXIT TO PROCEED TO    TABLE-DETAIL,
017450         GO TO PRINT-A-LINE.
017460
017470
017480
017490 TABLE-DETAIL.
017500     ADD 1 TO LINES-CTR.
017510     IF LINES-CTR GREATER THAN 25 GO TO TABLE-HEADING.
017520     READ TABLE-FILE AT END GO TO END-OF-TABLE.
017530     MOVE TABLE-RECORD TO PRINT-REC.
017540     MOVE SPACE-TWO   TO SPAC-CTL.
017550     ALTER WRITE-IMAGE-EXIT TO PROCEED TO    TABLE-DETAIL,
017560         GO TO PRINT-A-LINE.
017570
017580 END-OF-TABLE.
017590     CLOSE TABLE-FILE.
017600     MOVE ZEROS TO LINES-CTR.
017610 TABLE-EXIT. GO TO BEGIN-COPIES.
017620     EJECT
017630 BEGIN-COPIES.
017640     ADD 1 TO COPIES-PTD.
017650     IF COPIES-PTD EQUAL TO COPY-CTR GO TO END-OF-COPIES.
017660     ALTER TABLE-EXIT TO PROCEED TO PRINT-COPIES.
017670     GO TO TABLE-OF-CONTENTS.
017680
017690 PRINT-COPIES.
017700     OPEN INPUT LINE-IMAGE.
017710 READ-LINE-IMAGE.
017720     READ LINE-IMAGE AT END GO TO END-LINE-IMAGE.
017730     MOVE DISK-LINE TO PRINT-LINE.
017740     MOVE DISK-SPAC TO SPAC-CTL.
017750     ALTER WRITE-IMAGE-EXIT TO PROCEED TO    READ-LINE-IMAGE,
017760         GO TO PRINT-A-LINE.
017770
017780 END-LINE-IMAGE.
017790     CLOSE LINE-IMAGE.
017800     GO TO BEGIN-COPIES.
017810
017820 END-OF-COPIES.
017830     IF NOT BOOK-CARD GO TO END-OF-JOB.
017840     MOVE CD-BOOK-NAME TO BOOK-NAME.
017850     MOVE CD-BOOK-NUM TO BOOK-NUMBER.
017860     IF  TAPE-TWO-UP     CLOSE   TWO-UP-TAPE WITH    NO REWIND,
017870         DISPLAY TAPE-RECDS, ' RECORDS WRITTEN TO TAPE'.
017880     IF  TAPE-ONE-UP     CLOSE   ONE-UP-TAPE WITH    NO REWIND,
017890         DISPLAY TAPE-RECDS, ' RECORDS WRITTEN TO TAPE'.
017900     GO TO INITIALIZE.
017910
017920 END-OF-JOB.
017930     MOVE SKIP-TO-ONE TO SPAC-CTL.
017940     WRITE PRINT-REC AFTER POSITIONING SPAC-CTL.
017950     CLOSE CARD-FILE, PRINT-FILE.
017960     IF  TAPE-TWO-UP     CLOSE   TWO-UP-TAPE WITH    LOCK,
017970         DISPLAY TAPE-RECDS, ' RECORDS WRITTEN TO TAPE'.
017980     IF  TAPE-ONE-UP     CLOSE   ONE-UP-TAPE WITH    LOCK,
017990         DISPLAY TAPE-RECDS, ' RECORDS WRITTEN TO TAPE'.
018000         DISPLAY TAPE-FILES, ' FILES WRITTEN TO TAPE'.
018010     STOP RUN.

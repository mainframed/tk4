**********************************************************************
*
*  THIS PROGRAM TELLS YOU WHO IS USING CSA.  THIS PROGRAM CAN BE
*  RUN EITHER AGAINST THE CURRENT TSO ADDRESS SPACE, OR IT CAN BE
*  RUN UNDER IPCS AGAINST A DUMP FILE.  IT CAN TELL YOU WHO WAS
*  USING CSA AT THE TIME OF THE DUMP.
*
**********************************************************************
*  PLEASE REFER ANY QUESTIONS OR INQUIRIES TO:
*
*  ROBERT E. STYMA    GTE COMMUNICATION SYSTEMS
*                     2500 WEST UTOPIA ROAD
*                     PHOENIX, ARIZONA 85027
*                     (602) 582-7323
*
**********************************************************************
*
* PROGRAM VSMDUMP (VIRTUAL STORAGE MANAGER DUMP) AND
*          VSMDATA (VSM DUMP FOR CURRENT ADDRESS SPACE)
*
*  PROGRAM TO RUN ALL THE DQE'S FOR AN MVS/XA ADDRESS SPACE
*  ALSO SELECTED DATA FROM THE GDA AND LDA ARE ROUTED TO FILE OUTPUT
*  ALSO CVT LPA AND NUC DATA IS ROUTED TO FILE OUTPUT
*  THE SPT IS LOOKED AT
*  THE LPA DIRECTORY IS DUMPED
*
*  TWO OUTPUTS, DDNAMES PRINT AND OUTPUT
*  DCB ATTRIBUTES ARE HARD CODED IN THIS PROGRAM
*  FBA 133
*
*  TO CALL AS AN IPCS VERB EXIT,  GO INTO IPCS OPTION 4 AND TYPE:
*  VERBX  VSMDUMP 'QC22505.OUTPUT.DATA'
*             OR
*  VERBX  VSMDUMP 'QC22505.OUTPUT.DATA PRINT NOLPA CDE'
*
*  REPLACE QC22505.OUTPUT.DATA WITH THE TARGET OUTPUT FILE.  THE
*  FULLY QUALIFIED NAME IS REQUIRED, THE FILE MUST BE SEQUENTIAL,
*  THE FILE WILL BE CREATED IF NECESSARY.   THE DCB IS HARD CODED
*  IN THIS PROGRAM.
*
*  THE KEYWORDS PRINT, NOLPA, AND CDE ARE OPTIONS.
*  PRINT  CAUSES THE VSM DATA TO BE PUT IN THE IPCS PRINT DATASET.
*  CDE    CAUSES CDE RECORDS TO BE DISPLAYED IN THE IPCS PRINT DATASET.
*  NOLPA  CAUSES TYPE 3 AND 4 RECORDS FOR LPA MODULES TO BE OMITTED
*         IN THE OUTPUT FILE.
*
*
*  THIS PROGRAM RUNS AMODE=31 RMODE=24
*  THIS PROGRAM CAN BE COMPILED AS EITHER AN IPCS VERB EXIT OR
*  A REGULAR PROGRAM.  AS A REGULAR PROGRAM, THE CURRENT ADDRESS
*  SPACE IS PROCESSED.  AS AN IPCS VERB EXIT, THE DUMP ADDRESS SPACE
*  IS PROCESSED.
*
*  A NORMAL ASSEMBLER H COMPILE WILL COMPILE THIS PROGRAM AS AN NORMAL
*  PROGRAM.  SPECIFY  'SYSPARM(IPCS)' IN THE IEV90 PARM TO COMPILE AS
*  AN IPCS EXIT.
*  ASSEMBLER ROUTINES FG500215  ARE REQUIRED.
*                     FG201887
*                     FG201693
*
*  SIX RECORD TYPES ARE GENERATED BY THIS ROUTINE.  THEY ARE
*  IDENTIFIED BY A CHARACTER NUMBER 1 THROUGH 6 IN COLUMN 112.  THE
*  RECORD DESCRIPTIONS FOLLOW:
*  KEY:
*  HEX FIELDS:  PADDED ON LEFT WITH ZEROS.
*  DEC FIELDS:  RIGHT JUSTIFIED IN FIELD, PADDED ON LEFT WITH BLANKS
*  CHAR FIELDS: LEFT JUSTIFIED IN FIELD, PADDED ON RIGHT WITH BLANKS
*
**********************************************************************
*
*  TYPE 1:   MEMORY RECORD
*  THIS RECORD IS GENERATED FOR A DQE, OR AQAT ENTRY.  IT DESCRIBES
*  A CONTIGUOUS AREA OF MEMORY.
*
*           COL  LEN  TYPE
*
*  AREA       2    8   HEX   START ADDRESS OF THE AREA
*
*  SIZE      13    8   HEX   LENGTH OF THE AREA
*
*  ENDADDR   24    8   HEX   ENDING ADDRESS (FIRST BYTE PAST AREA)
*
*  SUBPOOL   35    8   DEC   SUBPOOL NUMBER.
*
*  KEY       46    8   DEC   MEMORY KEY.  NOT AVAILABLE FOR SUBPOOLS
*                            227, 228, 231, 241 IF PROCESSING A DUMP.
*                            THESE SUBPOOLS COME FROM THE SPT.
*
*  PGMNAME   57    8   CHAR  PROGRAM NAME ASSOCIATED WITH THE TCB WHICH
*                            DID THE GETMAIN.  FOR SYSTEM SUBPOOLS,
*                            FIXED VALUES ARE USED:
*                            226  - SQA
*                            227  - SPT CSA
*                            228  - SPT CSA
*                            231  - SPT CSA
*                            239  - SQA
*                            241  - SPT CSA
*                            245  - SQA
*                            255  - LSQA
*
*  ENTRYPT   68    8   HEX   ENTRY POINT OF THE PROGRAM ASSOCIATED WITH
*                            THE TCB WHICH DID THE GETMAIN.  FOR THE
*                            SYSTEM SUBPOOLS, THIS IS BLANK.
*
*  TCBADDR   79    8   HEX   ADDRESS OF THE TCB WHICH DID THE GETMAIN.
*                            FOR THE SYSTEM SUBPOOLS, THIS IS BLANK
*
*  SHARED    90    8   CHAR  IF THE DQE MARKS THIS SUBPOOL SHARED, THE
*                            WORD SHARED APPEARS HERE.
*                            FOR THE SYSTEM SUBPOOLS, THIS IS BLANK
*
*  OWNED    101    8   CHAR  IF THS DQE MARKS THIS SUBPOOL OWNED, THE
*                            WORD OWNED APPEARS HERE.
*                            FOR THE SYSTEM SUBPOOLS, THIS IS BLANK
*
*  RECTYPE  112    1   DEC   CONSTANT CHAR 1 FOR THIS RECORD TYPE
*
**********************************************************************
*
*
*  TYPE 2:   REGION RECORD
*  THIS RECORD IS GENERATED FOR VARIOUS SYSTEM BOUNDARY MARKERS. THE
*  FIELDS FILLED IN VARY.
*
*           COL  LEN  TYPE
*
*  AREA       2    8   HEX   START ADDRESS OF THE AREA
*                            THE EXCEPTIONS ARE LPVT END, HPVT END,
*                            REGION LIMIT, REGION END.  WHEN THIS IS
*                            THE MARKER ADDRESS.
*
*  SIZE      13    8   HEX   LENGTH OF THE AREA. BLANK FOR MARKER ADDRS
*
*  ENDADDR   24    8   HEX   ENDING ADDRESS (FIRST BYTE PAST AREA)
*                            BLANK FOR MARKER ADDRESSES.
*
*  SUBPOOL   35    8   DEC   BLANK
*
*  KEY       46    8   DEC   BLANK
*
*  PGMNAME   57    8   CHAR  VALUES:
*                            MLPA     - MODIFIED LINK PACK AREA
*                            FLPA     - FIXED LINK PACK AREA
*                            PLPA     - PAGABLE LINK PACK AREA
*                            PLPA EXT - PLPA ABOVE 16 MEG LINE
*                            FLPA EXT - FLPA ABOVE 16 MEV LINE
*                            MLPA EXT - MLPA ABOVE 16 MEG LINE
*                            R/W NUC  - READ/WRITE NUCLEUS
*                            R/O NUC  - READ ONLY NUCLEUS
*                            R/W NUCE - READ/WRITE NUCLEUS ABOVE 16MEG
*                            CSA LOW  - COMMON SERVICE AREA
*                            CSA HIGH - COMMON SERVICE AREA ABOVE 16MEG
*                            SQA LOW  - SYSTEM QUEUE AREA
*                            SQA HIGH - SYSTEM QUEUE AREA ABOVE 16MEG
*                            PVT LOW  - PRIVATE (USER) AREA
*                            PVT HIGH - PRIVATE (USER) AREA
*                            MGT AREA - VSM MANAGEMENT AREA
*                            PG TBLS  - PAGE TABLES
*                            PVT STRT - START OF USEABLE PRIVATE AREA
*                            SYSREG L - SYSTEM REGION IN PRIVATE AREA
*                            SYSREG H - SYSTEM REGION IN PRIVATE AREA
*                            LPVT END - END OF USED PART OF PVT AREA
*                            HPVT END - END OF USED PVT AREA > 16 MEG
*                            REG END  - END OF REGION FROM < 16 MEG
*                                       PARM ON EXEC. USED FIELDS
*                            REG LMT  - ACTUAL MAX ADDR+1 AVAILABLE TO
*                                       THE PRIVATE AREA BELOW 16 MEG.
*                            VSM MGMT - VIRTUAL STORAGE MANAGER
*                                       MANAGEMENT AREA.
*                            LPA DIR  - LINK PACK AREA DIRECTORY
*
*  ENTRYPT   68    8   HEX   BLANK
*
*  TCBADDR   79    8   HEX   BLANK
*
*  SHARED    90    8   CHAR  BLANK
*
*  OWNED    101    8   CHAR  SYSTEM TABLE THIS DATA TAKEN FROM.
*                            CVT, GDA, LDA
*
*  RECTYPE  112    1   DEC   CONSTANT CHAR 2 FOR THIS RECORD TYPE
*
**********************************************************************
*
*  TYPE 3:   LPA RECORD
*  THIS RECORD IS GENERATED FOR EACH MAJOR LPDE FOUND IN THE
*  LINK PACK AREA DIRECTORY.
*
*           COL  LEN  TYPE
*
*  AREA       2    8   HEX   LOAD POINT OF MODULE
*
*  SIZE      13    8   HEX   LENGTH OF THE STORAGE CONTAINING MODULE
*
*  ENDADDR   24    8   HEX   ENDING ADDRESS (FIRST BYTE PAST AREA)
*
*  SUBPOOL   35    8   DEC   SUBPOOL NUMBER.
*
*  KEY       46    8   DEC   CONTAINS AC(1) FOR APF AUTHORIZED PROGRAMS
*
*  PGMNAME   57    8   CHAR  LPA PROGRAM NAME
*
*  ENTRYPT   68    8   HEX   ENTRY POINT OF THE LPA MODULE
*
*  TCBADDR   79    8   HEX   BLANK
*
*  SHARED    90    8   CHAR  THE STRING 'LPA MOD '
*
*  OWNED    101    8   CHAR  BLANK
*
*  RECTYPE  112    1   DEC   CONSTANT CHAR 3 FOR THIS RECORD TYPE
*
**********************************************************************
*
*  TYPE 4:   ACTIVE CDE RECORD
*  THIS RECORD IS GENERATED FOR THE FIRST CDE FOUND ASSOCIATED
*  WITH A PRB FOR A TASK ON THE TCB CHAIN.  THERE MAY BE DUPLICATE
*  RECORDS FOR A CDE IF THE CDE IS FIRST FOR MORE THAN ONE PRB.
*
*           COL  LEN  TYPE
*
*  AREA       2    8   HEX   LOAD POINT OF MODULE
*
*  SIZE      13    8   HEX   LENGTH OF THE STORAGE CONTAINING MODULE
*
*  ENDADDR   24    8   HEX   ENDING ADDRESS (FIRST BYTE PAST AREA)
*
*  SUBPOOL   35    8   DEC   SUBPOOL NUMBER.
*
*  KEY       46    8   DEC   CONTAINS AC(1) FOR APF AUTHORIZED PROGRAMS
*
*  PGMNAME   57    8   CHAR  PROGRAM NAME
*
*  ENTRYPT   68    8   HEX   ENTRY POINT OF THE MODULE
*
*  TCBADDR   79    8   HEX   TCB ASSOCIATED WITH THIS PROGRAM
*
*  SHARED    90    8   CHAR  THE STRING 'LPA MOD ' IF THIS IS AN LPA
*                            MODULE.
*
*  OWNED    101    8   CHAR  IF THIS IS A MINOR CDE, THIS IS THE NAME
*                            OF THE MAJOR CDE.
*
*  RECTYPE  112    1   DEC   CONSTANT CHAR 4 FOR THIS RECORD TYPE
*
**********************************************************************
*
*  TYPE 5:   LOAD LIST RECORD
*  THIS RECORD IS GENERATED FOR EACH CDE FOUND ON THE LLE (LOAD LIST
*  ENTRY) FOR EACH TASK ON THE TCB CHAIN.  THESE ARE MODULES LOADED VIA
*  THE LOAD (SVC 6) SYSTEM CALL.  THERE MAY BE DUMPLICATES IF A MODULE
*  IS LOADED BY MORE THAN ONE TCB.
*
*           COL  LEN  TYPE
*
*  AREA       2    8   HEX   LOAD POINT OF MODULE
*
*  SIZE      13    8   HEX   LENGTH OF THE STORAGE CONTAINING MODULE
*
*  ENDADDR   24    8   HEX   ENDING ADDRESS (FIRST BYTE PAST AREA)
*
*  SUBPOOL   35    8   DEC   SUBPOOL NUMBER.
*
*  KEY       46    8   DEC   CONTAINS AC(1) FOR APF AUTHORIZED PROGRAMS
*
*  PGMNAME   57    8   CHAR  PROGRAM NAME
*
*  ENTRYPT   68    8   HEX   ENTRY POINT OF THE MODULE
*
*  TCBADDR   79    8   HEX   TCB ASSOCIATED WITH THIS PROGRAM
*
*  SHARED    90    8   CHAR  THE STRING 'LPA MOD ' IF THIS IS AN LPA
*                            MODULE.
*
*  OWNED    101    8   CHAR  IF THIS IS A MINOR CDE, THIS IS THE NAME
*                            OF THE MAJOR CDE.
*
*  RECTYPE  112    1   DEC   CONSTANT CHAR 4 FOR THIS RECORD TYPE
*
**********************************************************************
*
*  TYPE 6:   ACTIVE CDE RECORD B
*  THIS RECORD IS JUST LIKE A TYPE 4 RECORD EXCEPT IT IS GENERATED
*  FOR ENTRIES ON THE CDE CHAIN AFTER THE FIRST FOR A PRB.
*
**********************************************************************
*
*  ERROR RECORDS:
*  WHEN THIS PROGRAM IS RUNNING AS AN IPCS VERB EXIT.  ERROR RECORDS
*  ARE GENERATED TO BOTH THE PRINT AND OUTPUT DATASETS FOR STORAGE
*  LOCATIONS WHICH WERE NOT IN THE DUMP.
*
*  THESE RECORDS HAVE BLANKS IN COLUMS 1 AND 2 AND A # IN COLUMN 3.
*
**********************************************************************
*
*  SORTING RECORDS:
*  ALL RECORDS WRITTEN TO FILE OUTPUT HAVE A TRAILING RECORD CONSISTING
*  OF DASHES AND PLUSSES.  THE RECORDS IN THIS FILE MAY BE SORTED
*  AS 266 BYTE RECORDS AND THEN "FIXDCB"ED BACK TO 133 BYTE RECORDS.
*
*  THE FOLLOWING JCL WILL PERFORM THE SORT.
*
*  //QC225054 JOB (),'VSMDATA2',
*  //    NOTIFY=QC22505,
*  //    MSGLEVEL=(2,0),PRTY=0,CLASS=K,MSGCLASS=X
*  /*JOBPARM LINES=150
*  //KILL   EXEC  PGM=IEFBR14
*  //FILE     DD  DSN=QC22505.OUTPUT2.DATA,
*  //             DISP=(MOD,DELETE),UNIT=SYSDA,SPACE=(TRK,1)
*  //SORT1  EXEC  PGM=SORT,REGION=5000K
*  //*
*  //SORTLIB   DD DSN=SYS1.SORTLIB,DISP=SHR
*  //*
*  //SORTIN    DD DSN=QC22505.OUTPUT.DATA,DISP=SHR,
*  //             DCB=(LRECL=266,RECFM=FB,BLKSIZE=10640)
*  //*
*  //SORTOUT   DD DSN=QC22505.OUTPUT2.DATA,
*  //             DISP=(NEW,CATLG),UNIT=SYSDA,
*  //             SPACE=(CYL,(5,1),RLSE),
*  //             DCB=(LRECL=266,RECFM=FB,BLKSIZE=10640)
*  //*
*  //SYSOUT    DD SYSOUT=*
*  //SORTWK01  DD UNIT=SYSDA,SPACE=(CYL,(65))
*  //SORTWK02  DD UNIT=SYSDA,SPACE=(CYL,(65))
*  //SORTWK03  DD UNIT=SYSDA,SPACE=(CYL,(65))
*  //SYSIN     DD *
*   SORT FIELDS=(2,8,AC,A),EQUALS
*   RECORD TYPE=F,LENGTH=(266,266,266)
*  //FIXDCB  EXEC PGM=FIXDCB
*  //STEPLIB  DD  DISP=SHR,DSN=EXD.EAX.LOADLIB
*  //FILE     DD  DSN=QC22505.OUTPUT.DATA,DISP=SHR,
*  //             DCB=(LRECL=133,RECFM=FB,BLKSIZE=10640)
*  //FIXDCB2 EXEC PGM=FIXDCB
*  //STEPLIB  DD  DISP=SHR,DSN=EXD.EAX.LOADLIB
*  //FILE     DD  DSN=QC22505.OUTPUT2.DATA,DISP=SHR,
*  //             DCB=(LRECL=133,RECFM=FB,BLKSIZE=10640)
*
**********************************************************************
*

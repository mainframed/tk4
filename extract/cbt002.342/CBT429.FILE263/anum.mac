         MACRO
&NAME    ANUM
         B     F&SYSNDX+6
A&SYSNDX DC    X'FF00FFFFFFFFFF00FFFFFFFFFF00'
B&SYSNDX DC    X'C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0'
C&SYSNDX DC    X'C0'
         DC    XL9'00'
         DC    X'CACBCCCDCECFD0'
         DC    XL9'00'
         DC    X'DADBDCDDDEDFE0E1'
         DC    XL8'00'
         DC    X'EAEBECEDEEEF'
         DC    XL10'00'
         DC    X'FAFBFCFDFEFF'
X&SYSNDX DC    F'0'                SAVE AREA REGISTER 2
D&SYSNDX NC    B&SYSNDX,0(14)
E&SYSNDX XC    B&SYSNDX,=20X'C0'
F&SYSNDX TRT   0(0,14),C&SYSNDX-192
&NAME    MVI   D&SYSNDX+1,X'00'    SET INSTR. LENGTHS TO ZERO
         MVI   E&SYSNDX+1,X'00'
         MVI   F&SYSNDX+1,X'00'
         BCTR  15,0
         ST    2,X&SYSNDX          SAVE REGISTER 2
         MVC   B&SYSNDX,=20X'C0'   SET MASK TO LOWEST VALID CHAR.LESS 1
         EX    15,D&SYSNDX         EXECUTE AND WITH DATA LENGTH IN R15
         EX    15,E&SYSNDX         EYECUTE EXCL.OR- DATA LENGTH IN R15
         BM    G&SYSNDX            ERROR IF ANY BITS LEFT ON
         EX    15,F&SYSNDX         EXECUTE TRANSLATE AND TEST
         BC    8,H&SYSNDX          IF  OK  BYPASS ERROR ROUTINE
G&SYSNDX LR    14,15               ERROR RTN.SETS R14 AND R15 EQUAL
H&SYSNDX L     2,X&SYSNDX          RESTORE REGISTER 2
         MEND

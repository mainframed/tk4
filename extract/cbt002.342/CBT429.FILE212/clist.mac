./ ADD NAME=$INDEX   0175-92287-94038-0300-00409-00127-00000-DB2CSC
  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

               REFERENCE INDEX FOR XDBS.TSOISPF.CLIST
             ------------------------------------------

    XDBS.TSOISPF.CLIST: Library for TSO command lists.
    -------- --------------------------------------------------


  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

   MEMBER   Description or purpose
  -------- -------------------------------------------------------------
  $INDEX    This member.
  -------- -------------------------------------------------------------
  ALCDDIR   Allocate IPCS DDIR dataset
  --------  ------------------------------------------------------------
  ALTLQMF   Attempt to ALTLIB a QMF library.
  --------  ------------------------------------------------------------
  A828CHGS  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  BAKDBSC1  SINGLE IMAGE DIALOG - BACKUP ZONE
  --------  ------------------------------------------------------------
  BAKDBSC2  SINGLE IMAGE DIALOG - BACKUP ZONE
  --------  ------------------------------------------------------------
  BAKDBSC3  SINGLE IMAGE DIALOG - BACKUP ZONE
  --------  ------------------------------------------------------------
  BAKOEMC1  OEM Single Image BACKOUT clist 1
  --------  ------------------------------------------------------------
  BAKOEMC2  OEM Single Image Back-Out clist 2.
  --------  ------------------------------------------------------------
  BATCH     Execute ISPSTART to run ISPF from batch
  --------  ------------------------------------------------------------
  CHGDCL    Add table name to DCLGEN output copybook
  --------  ------------------------------------------------------------
  CLNBKPC1  Dataset clean up facilities clist 1.
  --------  ------------------------------------------------------------
  CLNBKPC2  Dataset clean up facilities clist 2.
  --------  ------------------------------------------------------------
  CMPCLUST  Compares VSAM cluster to data and index and produces
  CMPCLUST+ a miss-match report.
  --------  ------------------------------------------------------------
  CMS2TSO   Execute TSO RECEIVE for files sent from VM/CMS.
  --------  ------------------------------------------------------------
  CMS2TSOO  Receive transmitted data
  --------  ------------------------------------------------------------
  CP        Compress a PDS
  --------  ------------------------------------------------------------
  CPRT      Like on VM: print a dataset
  --------  ------------------------------------------------------------
  CSCINDEX  Edit dataset using INDEX@ macro.
  --------  ------------------------------------------------------------
  CSPEZE    Allocates NLS files, builds CSP370/AD init parameter
  --------  ------------------------------------------------------------
  CSP370    CSP370/AD CLIST which gets invoked for start CSP.
  --------  ------------------------------------------------------------
  DB2CMD    Execute DB2 command passed via parm in JCL
  --------  ------------------------------------------------------------
  DBPTEST   BORGY chose not to tell us
  --------  ------------------------------------------------------------
  DB2PGM    Run a DB2 program passed via parm in JCL
  --------  ------------------------------------------------------------
  DB2PNL    Select the DB2PNL
  --------  ------------------------------------------------------------
  DB2SQL    Run an SQL program
  --------  ------------------------------------------------------------
  DELDBSC1  Deletes a DBS or CSP single image zone - Clist 1.
  --------  ------------------------------------------------------------
  DELDBSC2  Deletes a DBS or CSP single image zone - Clist 2.
  --------  ------------------------------------------------------------
  DELOEMC1  OEM zone deletion clist 1.
  --------  ------------------------------------------------------------
  DELOEMC2  OEM zone deletion clist 2.
  --------  ------------------------------------------------------------
  DELOMGC1  Delete Omegamon II for DB2 zone
  --------  ------------------------------------------------------------
  DOC       Edit XDBS.SOFTWARE.CHANGES
  --------  ------------------------------------------------------------
  DOCARCHM  Document archive was done for backup zone
  --------  ------------------------------------------------------------
  DOCBKOTM  Document a backout of software occurred
  --------  ------------------------------------------------------------
  DOCCLNEM  Document a clone of software occurred
  --------  ------------------------------------------------------------
  DOCCLNE   Document a clone took place
  --------  ------------------------------------------------------------
  DOCIMPM   Documents implemented zone from target
  --------  ------------------------------------------------------------
  DOCLVLM   Document a level change
  --------  ------------------------------------------------------------
  DSQPRINT  Allocate the QMF print ddname
  --------  ------------------------------------------------------------
  DS34      Invoke utility option 3.4 with modified panel
  --------  ------------------------------------------------------------
  DUPES     Exclude duplicate records in file
  --------  ------------------------------------------------------------
  ED        Edit when recursive edit is not available
  --------  ------------------------------------------------------------
  ELACUSER  CSP370 RS creates user files for run-time services.
  --------  ------------------------------------------------------------
  ELACUSR2  CSP370 RS called by ELACUSER.
  --------  ------------------------------------------------------------
  FMMSTRIP  For Franklin Mundo, strip down to pages copied and time
  --------  ------------------------------------------------------------
  GETSYSID  Gets SMF system id and TSO variables
  --------  ------------------------------------------------------------
  GETSYSIO  Gets SMF system id and TSO variables (old)
  --------  ------------------------------------------------------------
  GETVOMAC  get volume from listcat
  --------  ------------------------------------------------------------
  GETVOLID  BORGY chose not to tell us
  --------  ------------------------------------------------------------
  GTSYSID   alternate way to get sysid
  --------  ------------------------------------------------------------
  IMAGJOB   Run the dynamic IMAGCOPY program
  --------  ------------------------------------------------------------
  IMPDBSC1  Implements a DBS or CSP single image zone - Clist 1.
  --------  ------------------------------------------------------------
  IMPDBSC2  Implements a DBS or CSP single image zone - Clist 2.
  --------  ------------------------------------------------------------
  IMPOEMC1  OEM zone implementation clist 1.
  --------  ------------------------------------------------------------
  IMPOEMC2  OEM zone implementation clist 2.
  --------  ------------------------------------------------------------
  IMPOMGC1  Implement Omegamon II for DB2
  --------  ------------------------------------------------------------
  IMPOMGC2  Implement Omegamon II for DB2
  --------  ------------------------------------------------------------
  INFOTEL   allocate a file for Franklin
  --------  ------------------------------------------------------------
  INVIPCSA  Invoke IPCS part 1.
  --------  ------------------------------------------------------------
  INVIPCSB  Invoke IPCS part 2.
  --------  ------------------------------------------------------------
  INVK      invokes invkpro2for Franklin
  --------  ------------------------------------------------------------
  INVKHRF   LIBDEF for RACF ISPF dialog
  --------  ------------------------------------------------------------
  INVK@PRF  Old DB2PM invocation
  --------  ------------------------------------------------------------
  INVKDSNB  Makes the libraries available to TSO, needed to run
  --------  ------------------------------------------------------------
  INVKDSNT  Invoke DB2 installation clist with right datasets
  INVKDSNT+ the DSNTINST and then executes the install clist.
  --------  ------------------------------------------------------------
  INVKIPCS  Invokes IPCS.
  --------  ------------------------------------------------------------
  INVKOMVS  Invokes OMEGAMON/MVS.
  --------  ------------------------------------------------------------
  INVKO2DB  Invoke Omegamon II for DB2
  --------  ------------------------------------------------------------
  INVKPLAT  This clist uses altlib for an application level sysproc
  --------  ------------------------------------------------------------
  INVKPRO2  Invoke ProEdit
  --------  ------------------------------------------------------------
  INVKPRO9  Invoke ProEdit (old)
  INVKPRO9+ and then the platinum quick install clist picstart
  --------  ------------------------------------------------------------
  INVKQKIN  Invoke PLATINUM's QUICK INSTALL product.
  --------  ------------------------------------------------------------
  INVKQMF   Invoke QMF
  --------  ------------------------------------------------------------
  INVKRACF  Invoke RACF (but you a SYSPROC allocated first)
  --------  ------------------------------------------------------------
  INVKSMPE  Invoke SMP/E
  --------  ------------------------------------------------------------
  INVKTLMS  Invoke TLMS database system.
  --------  ------------------------------------------------------------
  ISDB2UP   Connects to DB2 if it is up, else display messages
  ISDB2UPW  Checks if DB2 is up and issues rc=4
  --------  ------------------------------------------------------------
  ISPFJC    Jack Corbett way of logging on our procs
  --------  ------------------------------------------------------------
  ISPFTEST  BORGY chose not to tell us
  --------  ------------------------------------------------------------
  ISPFKET   Ken Tomiak test way of logging on our procs
  --------  ------------------------------------------------------------
  ISPFON    CLIST to establish ISPF environment for DB2 users.
  --------  ------------------------------------------------------------
  ISPFPS    Petes version of ISPFON (used to implm't cmd tbl entries)
  --------  ------------------------------------------------------------
  ISPFQMF   Allocate and start QMF direct
  --------  ------------------------------------------------------------
  JOBCARD   Add jobcacrd
  --------  ------------------------------------------------------------
  KENF      Kens fileaid menu
  --------  ------------------------------------------------------------
  L         logon as self
  LNAME     BORGY chose not to tell us
  LCVOLS    BORGY chose not to tell us
  LCVOLSM   BORGY chose not to tell us
  LCVOLSE   BORGY chose not to tell us
  --------  ------------------------------------------------------------
  LE        Does a LISTCAT directing output to DASD.
  --------  ------------------------------------------------------------
  LISTDDS   Lists allocated datasets on sysout
  LIBDEF    BORGY chose not to tell us
  --------  ------------------------------------------------------------
  LVLADD    Adds to XDBS.SOFTWARE.CHANGES(LEVELS) level tracking.
  --------  ------------------------------------------------------------
  LVLDEL    Deletes XDBS.SOFTWARE.CHANGES(LEVELS) level tracking.
  --------  ------------------------------------------------------------
  LVLNO     Get the source zone level number from tracking board.
  --------  ------------------------------------------------------------
  LVLNOEM   Auto tracking level number for OEM (ISV) software
  --------  ------------------------------------------------------------
  LVLNOM    Edit macro used by clist LVLNO.
  --------  ------------------------------------------------------------
  LVLNOME   Auto tracking level number for OEM (ISV) software
  --------  ------------------------------------------------------------
  LVLTRCK   Updates XDBS.SOFTWARE.CHANGES(LEVELS) level tracking.
  --------  ------------------------------------------------------------
  LVLUPDT   Updates XDBS.SOFTWARE.CHANGES(LEVELS) level tracking.
  --------  ------------------------------------------------------------
  MIGDBSC1  Migrates a DBS or CSP single image zone - Clist 1.
  --------  ------------------------------------------------------------
  MIGDBSC2  Migrates a DBS or CSP single image zone - Clist 2.
  --------  ------------------------------------------------------------
  MIGOEMC1  Migrates a OEM single image zone - Clist 1.
  --------  ------------------------------------------------------------
  MIGOEMC2  Migrates a OEM single image zone - Clist 2.
  --------  ------------------------------------------------------------
  MIGOMGC1  migrate Omegamon II for DB2 software
  --------  ------------------------------------------------------------
  MIGOMGC2  migrate Omegamon II for DB2 software
  --------  ------------------------------------------------------------
  MYSUB     pops up panel to get a userid/password and submits member
  --------  ------------------------------------------------------------
  NEST      invoke ISPF above existing sessions
  --------  ------------------------------------------------------------
  NO        Like ON, pop back into ISPF
  --------  ------------------------------------------------------------
  OEMLVADD  Adds    XDBS.SOFTWARE.CHANGES(OEMLVL) level tracking.
  ODOCCLN   BORGY chose not to tell us
  ODOCCLNM  BORGY chose not to tell us
  --------  ------------------------------------------------------------
  OEMLVDEL  Deletes XDBS.SOFTWARE.CHANGES(OEMLVL) level tracking.
  --------  ------------------------------------------------------------
  OEMLVL#   Get the source zone level number from tracking board.
  --------  ------------------------------------------------------------
  OEMLVL#M  Edit macro used by clist OEMLVL#.
  --------  ------------------------------------------------------------
  OEMLVTRK  Updates XDBS.SOFTWARE.CHANGES(OEMLVL) level tracking.
  --------  ------------------------------------------------------------
  OEMLVUPD  Updates XDBS.SOFTWARE.CHANGES(OEMLVL) level tracking.
  --------  ------------------------------------------------------------
  OMEGDB2   One way to get Omegmaon II for DB2 session on TSO
  --------  ------------------------------------------------------------
  OMEGLVL   Update level of Omegmaon II for DB2 tracking
  --------  ------------------------------------------------------------
  OMEGTRCK  Update level of Omegmaon II for DB2 tracking
  --------  ------------------------------------------------------------
  OMGCLNE   Clone Omegmaon II for DB2
  --------  ------------------------------------------------------------
  OMGLVTRK  updates the Omegamon II level tracking board
  --------  ------------------------------------------------------------
  OMGCLNEM  Clone Omegmaon II for DB2 macro
  --------  ------------------------------------------------------------
  OMGIMP    Implement Omegmaon in the early days
  --------  ------------------------------------------------------------
  OMGIMPM   Document Omegamon implement macro
  --------  ------------------------------------------------------------
  ON        Return to ISPF after premature exit
  --------  ------------------------------------------------------------
  ON#OLD    Return to ISPF after premature exit (old)
  --------  ------------------------------------------------------------
  PARSEIT   attempt to parse listcat output into variables
  PROINSTL  BORGY chose not to tell us
  --------  ------------------------------------------------------------
  PDSBATCH  RUN PDSMACRO via batch.
  --------  ------------------------------------------------------------
  PDSCHG    global PDS changer
  --------  ------------------------------------------------------------
  PDSCHGIT  global PDS changer (macro to do it)
  --------  ------------------------------------------------------------
  PDSMACRO  global PDS macro executer
  --------  ------------------------------------------------------------
  PLAN      utility option 3.4 on XDBS.project datasets
  --------  ------------------------------------------------------------
  PLATSET   Set Platinum MODEL dsn in profile
  --------  ------------------------------------------------------------
  PTFAPCK   Apply check a PTF
  --------  ------------------------------------------------------------
  PTFF1     Fetch a PTF
  --------  ------------------------------------------------------------
  PTFF2     Fetch a PTF
  --------  ------------------------------------------------------------
  PTFF3     Fetch a PTF
  --------  ------------------------------------------------------------
  PTFR1     receive a PTF
  --------  ------------------------------------------------------------
  PTFR2     receive a PTF
  --------  ------------------------------------------------------------
  QMF       allocate and invoke QMF
  --------  ------------------------------------------------------------
  QMFCHRT   allocate and invoke QMF with datasets for charting
  --------  ------------------------------------------------------------
  QMFPRT    reallocate DSQPRINT
  --------  ------------------------------------------------------------
  QMFXX     olf qmf clist
  --------  ------------------------------------------------------------
  SAV       Replacement for SAVE, enforces $INDEX update
  --------  ------------------------------------------------------------
  SAVMAC    Replacement for SAVE, enforces $INDEX update
  --------  ------------------------------------------------------------
  SERCHALC  Searches your TSO allocations to find what dataset
  --------  ------------------------------------------------------------
  SETDB2OP  Sets DB2I variable to ssid.
  --------  ------------------------------------------------------------
  SETPROOP  Sets ProEdit variable to ssid.
  --------  ------------------------------------------------------------
  SK        invoke kens script facility front end
  --------  ------------------------------------------------------------
  SKK       Invoke document composition facility
  --------  ------------------------------------------------------------
  SK4       Invoke document composition facility - V1R4M0
  --------  ------------------------------------------------------------
  SLEHDR    IBM's ServiceLink CLIST for receiving PTF's.
  --------  ------------------------------------------------------------
  STAMPIT   turn stats on and save member
  --------  ------------------------------------------------------------
  TRCKA00   Time tracking dialog
  --------  ------------------------------------------------------------
  TEST      BORGY chose not to tell us
  --------  ------------------------------------------------------------
  TRCKLDPW  load PW data into time tracking
  --------  ------------------------------------------------------------
  TRCKWEEK  Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK001   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK100   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK200   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK201   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK202   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK203   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK204   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK300   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK301   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK400   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK410   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK500   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK600   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK601   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK700   Format time tracking for lazer printer (PSF)
  --------  ------------------------------------------------------------
  TRCK710   Format timetracking for local printer (but landscape)
  --------  ------------------------------------------------------------
  TRCK800   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK802   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK900   Time tracking dialog
  --------  ------------------------------------------------------------
  TRCK902   Time tracking dialog
  --------  ------------------------------------------------------------
  USERCSP   CSP370 CLISTs that creates User files.
  --------  ------------------------------------------------------------
  USERCSP2  CSP370 CLISTs which is called by USERCSP.
  V23INST   BORGY chose not to tell us
  V23ISPF   BORGY chose not to tell us
  --------  ------------------------------------------------------------
  WHO       display userid and logon proc
  --------  ------------------------------------------------------------
  WTCOCHGS  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTCOTSNM  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTS1CHGS  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTS1TSNM  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTS2CHGS  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTS2TSNM  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTTRCHGS  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTTRTSNM  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTUNCHGS  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  WTUNTSNM  edit macro to tailor waterboard environments.
  --------  ------------------------------------------------------------
  X         Logoff
  --------  ------------------------------------------------------------
  XDBSALC   allocate necessary datasets to invoke this system
  --------  ------------------------------------------------------------
  XSYSMISC  get to the mvs datasets
  --------  ------------------------------------------------------------
  XSYS34    other way to use utility option 3.4
  --------  ------------------------------------------------------------
  Z         compress a PDS
  --------  ------------------------------------------------------------
  ZTABLMAC  Adds zonename and hi-lvl to XDBS.SOFTWARE.CHANGES(ZONETABL).
  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *


./ ADD NAME=ALCDDIR  0125-92318-93330-0925-00046-00034-00042-KETCSC
PROC 0
 /* LIB: CLIST(ALCDDIR)                                              */
 /* GDE: MANNY PRISCIANDARO                                          */
 /* DOC: THIS CLIST INVOKES IPCS.                                    */
 /*                                                                  */
/*  CONTROL LIST CONLIST SYMLIST MSG
         CONTROL NOPROMPT NOFLUSH
    GETSYSID
    IF (&SYSID = MVSP) THEN SET &DB2VOL = D1DB01
    IF (&SYSID = MVSW) THEN SET &DB2VOL = D2DB01
    IF (&SYSID = MVSX) THEN SET &DB2VOL = XDB001
    IF (&SYSID = DOFD) THEN SET &DB2VOL = DDBS01
    IF (&SYSID = DOFP) THEN SET &DB2VOL = PDBS01
    IF (&SYSID = DOFX) THEN SET &DB2VOL = XDB001
         SET   SYSOUTTRAP = 10
         ATTR  INVKDDIR
         SET   LINES = &SYSOUTLINE
         SET   SYSOUTTRAP = 0
         IF    &LINES ^= 0 THEN +
               DO
                 ISPEXEC CONTROL ERRORS RETURN
                 ISPEXEC LIBDEF ISPSLIB DATASET ID('SYS1.SBLSKEL0')
                 ISPEXEC LIBDEF ISPMLIB DATASET ID('SYS1.SBLSMSG0')
                 ISPEXEC LIBDEF ISPPLIB DATASET ID('SYS1.SBLSPNL0')
                 ISPEXEC LIBDEF ISPTLIB DATASET ID('SYS1.SBLSTBL0')
                 SET &MYCC = &LASTCC
                 ISPEXEC SELECT PGM(BLSG) PARM(PANEL(BLSPPRIM)) +
                                NEWAPPL(BLSG) PASSLIB
                 EXIT  CODE(0)
               END
        FREE  F(IPCSDDIR)
        %BLSCDDIR VOLUME(&DB2VOL)
         ISPEXEC DISPLAY PANEL(IPCSREQA)
         SET   RC = &LASTCC
         IF    &RC = 8 × &R ^= Y THEN +
            DO
               FREE  ATTR(INVKDDIR)
               EXIT CODE(0)
            END
         CONTROL NOMSG
         ATTR  IPCSINVK
         CONTROL MSG
/*       SET   RETSTACK = &STR(RETURN;SWAP;RETURN;SWAP;RETURN) */
         SET   RETSTACK = &STR(=X;=X)
         ISPEXEC DISPLAY COMMAND(RETSTACK)
         EXIT  CODE(0)
./ ADD NAME=ALTLQMF  0104-92217-92217-1559-00011-00018-00000-DMV0016
PROC 0
    CONTROL   NOFLUSH NOPROMPT   MSG
    CONTROL  CONLIST SYMLIST LIST MSG

    ALTLIB ACTIVATE SYSTEM(EXEC)
    ALTLIB ACTIVATE APPLICATION(EXEC) DATASET('D2DB.DSQEXECE')

    DSQQMFE DSQSSUBS=D2DB,DSQPLAN=QMF310

    ALTLIB DEACTIVATE APPLICATION(EXEC)
    ALTLIB DEACTIVATE SYSTEM(EXEC)
./ ADD NAME=A828CHGS 0112-93077-94033-1442-00049-00043-00014-DB2CSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
    ISREDIT C 'R828' 'P828' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C 'R828' 'P828' WORD ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KWTS2'  '2KWPPR' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '10DB2FSG' '10DB2PXS' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    IF (&SAVEIT = YES) THEN +
      DO
        SET &CHGIT = &NRSTR(MEMBER: &MEMBER)
        ISPEXEC CONTROL DISPLAY LOCK
        ISPEXEC DISPLAY PANEL(PDSMACRO)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            SET &CHGIT = &NRSTR(COMPRESSING ONCE)
            ISPEXEC CONTROL DISPLAY LOCK
            ISPEXEC DISPLAY PANEL(PDSMACRO)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                SET &CHGIT = &NRSTR(COMPRESS FAILED)
                ISPEXEC DISPLAY PANEL(PDSMACRO)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=BAKDBSC1 0112-92205-93330-0927-00176-00154-00176-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(BAKDBSC1)                               */
/* GDE: MANUEL PRISCIANDARO AND DAN BORGES                         */
/* DOC: ABOVE TWO INDIVIDUALS DID NOT FEEL THEY SHOULD LET         */
/*      ANY PARTICULAR PERSON KNOW WHAT THIS DOES.                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (TGTSYS ACTZNE)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
            SET &JOBCLASS = V
/*                                                                 */
/* DB2 OR CSP SKELETON?                                            */
/*                                                                 */
    SET &CSPSFLAG = N
    IF &SUBSTR(1:3,&STR(&ACTZNE)) = CSP THEN SET &CSPSFLAG = Y
    IF &CSPSFLAG = N THEN +
       SET &SKELE = DBSDSLST
    ELSE +
       SET &SKELE = CSPDSLST
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET ACTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
       ELSE EXIT
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &ACTZNE = &ZNENAME THEN +
        DO
         SET SKELACT = &HILVL
         SET ACTFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN BACKOUT OF THE &ACTZNE +
                           ZONE ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &ACTFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(&ACTZNE NOT FOUND)
        SET &ZERRLM = &STR(&ACTZNE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* CREATE TARGET AND BACKUP ZONE NAMES AND HILVL QUAL FROM ACTIVE  */
/*                                                                 */
    SET &TGTZNE = T&ACTZNE
    SET &BKPZNE = B&ACTZNE
    SET &SKELTGT = &SKELACT..TARGET
    SET &SKELBKP = &SKELACT..BACKUP
/*                                                                 */
/* CHECKS IF THE BACKUP AND ACTIVE CSI DATA SET EXISTS             */
/* ALSO CHECKS IF TARGET CSI EXISTS                                */
/*                                                                 */
         %GETVOLID '&SKELBKP..CSI'
         ISPEXEC VGET (VOLID)
         SET &VOLBKP = &VOLID
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(BACKUP DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELBKP..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
         %GETVOLID '&SKELACT..CSI'
         ISPEXEC VGET (VOLID)
         SET &VOLACT = &VOLID
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(ACTIVE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELACT..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
         %GETVOLID '&SKELTGT..CSI'
         ISPEXEC VGET (VOLID)
    IF (&VOLID ^= NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR('&SKELTGT..CSI' EXISTS)
        SET &ZERRLM = &STR(DELETE TARGET ENVIRONMENT FIRST AND +
                           THEN PERFORM BACKOUT AGAIN)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*
/*
/* GO TO NEXT PANEL
/*
        ISPEXEC VPUT (TGTSYS ACTZNE TGTZNE BKPZNE SKELACT SKELTGT  +
                      SKELBKP VOLACT VOLBKP SKELE JOBCLASS)
        ISPEXEC SELECT PANEL(BAKDBSP2)
        EXIT CODE(0)
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    EXIT CODE(&MAXCC)
./ ADD NAME=BAKDBSC2 0110-92205-93330-1001-00133-00055-00083-KETCSC
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: CLIST(BAKDBSC2)                                            */
/* GDE: D. BORGES AND M. PRISCIANDARO                             */
/* DOC: ABOVE TWO INDIVIDUALS DID NOT FEEL THEY SHOULD LET         */
/*      ANY PARTICULAR PERSON KNOW WHAT THIS DOES.                 */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR  +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
 ISPEXEC VGET (TGTSYS ACTZNE TGTZNE BKPZNE SKELACT SKELTGT  +
               EDITIT SKELBKP VOLACT VOLBKP SKELE)
/*                                                                 */
/* TAILOR THE JCL                                                  */
/*                                                                 */
BEGDSLST: +
SET RC = 0
SET DDCTR = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(&SKELE)') +
    SHR REUSE
  ISPEXEC TBCREATE TABLEBAK +
    NAMES(SUFFIX ACTFLAG BKPFLAG ACTVSAM BKPVSAM DDCTR) +
    NOWRITE
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  DO WHILE &RC = 0
    READDVAL DSSUFFIX
    SET SUFFIX = &DSSUFFIX
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELACT..&SUFFIX')
    SET &ACTCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&ACTCC EQ 0) THEN +
      DO
        SET ACTFLAG = Y
        IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET ACTVSAM = N
          ELSE +
             SET ACTVSAM = Y
      END
    ELSE +
      DO
         SET ACTFLAG = N
         SET ACTVSAM = N
      END
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELBKP..&SUFFIX')
    SET &BKPCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&BKPCC EQ 0) THEN +
      DO
        SET BKPFLAG = Y
        IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET BKPVSAM = N
         ELSE +
            SET BKPVSAM = Y
      END
    ELSE +
      DO
         SET BKPFLAG = N
         SET BKPVSAM = N
      END
    SET DDCTR = &DDCTR + 1
    IF (&ACTVSAM = Y OR &BKPVSAM = Y) THEN +
      DO
        SET TSUFFIX = &SUFFIX
        SET &SUFFIX = &TSUFFIX..DATA
        ISPEXEC TBADD TABLEBAK
        SET &SUFFIX = &TSUFFIX..INDEX
        ISPEXEC TBADD TABLEBAK
        SET &ACTVSAM = N
        SET &BKPVSAM = N
        SET &SUFFIX = &TSUFFIX
        ISPEXEC TBADD TABLEBAK
      END
    ELSE ISPEXEC TBADD TABLEBAK
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
ENDDSLST: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC VPUT (SRCZNE DESTZNE) SHARED
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL BAKDBSS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC TBEND TABLEBAK
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        EXIT CODE(0)
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
/*                                                                 */
/* WRAP IT UP                                                      */
/*                                                                 */
    EXIT CODE(0)
./ ADD NAME=BAKOEMC1 0103-93218-93330-0936-00084-00079-00019-KETCSC
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: CLIST(BAKOEMC1)                                            */
/* GDE: M. PRISCIANDARO                                            */
/* DOC: THIS CLIST TAILORS THE JOB TO CLONE A OEM TARGET ZONE      */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(TABLEDS) SHR  DA('&DSNAME.') REUSE
/*                                                                 */
/* BUILD A LIST OF OEM PRODUCTS FROM OEMDSLST                      */
/* THIS LIST IS THEN USED TO DISPLAY AN OEM PANEL SELECTION LIST   */
/*                                                                 */

BEGDSLST: +
SET RC = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(OEMDSLST)') +
    SHR REUSE
  ISPEXEC TBCREATE PANELSEL +
    NAMES(CMD PRODUCT) +
    NOWRITE LIBRARY(TABLEDS)
  ISPEXEC TBCREATE TABLEBAK +
    NAMES(PDUCTLST SUFFIX PDUCTCHK ACTFLAG BKPFLAG DDCTR  +
          ACTVSAM BKPVSAM) +
    WRITE   LIBRARY(TABLEDS)
  SET CMD = &STR( )
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  SET &OPRODUCT = &STR()
  DO WHILE &RC = 0
    READDVAL PRODUCT SUFFIX PDUCTCHK
    SET &PDUCTLST = &PRODUCT
    ISPEXEC TBADD TABLEBAK
    IF &PRODUCT ^= &OPRODUCT THEN +
      DO
         ISPEXEC TBADD PANELSEL
         SET &OPRODUCT = &PRODUCT
      END
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
ENDDSLST: +
    ISPEXEC TBTOP PANELSEL
    ISPEXEC TBDISPL PANELSEL +
        PANEL(BAKOEMP1) CURSOR(&CURS) +
        AUTOSEL(NO)
    ISPEXEC VPUT (PRODUCT) SHARED
    ISPEXEC TBTOP TABLEBAK
    ISPEXEC TBSKIP TABLEBAK
    SET MYCC = 0
    DO WHILE &MYCC = 0
      IF &PRODUCT ^= &PDUCTLST THEN +
        DO
           ISPEXEC TBDELETE TABLEBAK
        END
      ISPEXEC TBSKIP TABLEBAK
      SET &MYCC = &LASTCC
    END
    ISPEXEC TBEND PANELSEL
    ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC SELECT PANEL(BAKOEMP2)
    ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
    EXIT CODE(0)
./ ADD NAME=BAKOEMC2 0104-93218-93330-0936-00329-00353-00329-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(BAKOEMC2)                               */
/* GDE: MANUEL PRISCIANDARO                                        */
/* DOC: */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(TABLEDS) SHR  DA('&DSNAME.') REUSE
    ISPEXEC VGET (TGTSYS ACTZNE PRODUCT)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
          IF &TGTSYS = MVSW THEN SET &JOBCLASS = J
            ELSE +
              SET &JOBCLASS = V
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET ACTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
       ELSE EXIT
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &ACTZNE = &ZNENAME THEN +
        DO
         SET SKELACT = &HILVL
         SET ACTFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    ERROR OFF
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN IMPLEMENTATION OF THE &ACTZNE +
                           ZONE ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
    IF &ACTFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(&ACTZNE NOT FOUND)
        SET &ZERRLM = &STR(&ACTZNE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
/*                                                                 */
/* CREATE TARGET AND BACKUP ZONE NAMES AND HILVL QUAL FROM ACTIVE  */
/*                                                                 */
    SET &TGTZNE = T&ACTZNE
    SET &BKPZNE = B&ACTZNE
    SET &SKELTGT = &SKELACT..TARGET
    SET &SKELBKP = &SKELACT..BACKUP
/*                                                                 */
/* READ TABLE AND GET LOADLIB SUFFIX                               */
/*                                                                 */
    ISPEXEC TBOPEN TABLEBAK WRITE LIBRARY(TABLEDS)
    ISPEXEC TBTOP TABLEBAK
    ISPEXEC TBSKIP TABLEBAK
    SET &ENDTABLE = NO
    DO WHILE &ENDTABLE = NO
       IF &PDUCTCHK = &STR(X) THEN +
          DO
             SET &PDUCTSFX = &SUFFIX
             SET &ENDTABLE = YES
          END
       ELSE +
          DO
             ISPEXEC TBSKIP TABLEBAK
             SET MYCC = &LASTCC
             IF &MYCC = 8 THEN +
                DO
                   SET &ENDTABLE = YES
                   SET &ZERRHM = &STR(*)
                   SET &ZERRALRM = &STR(NO)
                   SET &ZERRSM = &STR(LOADLIB NOT CHECKED)
                   SET &ZERRLM = &STR('&PRODUCT HAS NO LOADLIB X')
                   SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
                   ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
                   ISPEXEC SETMSG MSG(ISRZ002)
                   ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
                   ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
                   EXIT CODE(0)
                END
          END
    END
/*                                                                 */
/* CHECKS IF THE TARGET AND ACTIVE CSI DATA SET EXISTS             */
/*                                                                 */
    %GETVOLID '&SKELTGT..&PDUCTSFX'
    ISPEXEC VGET (VOLID)
    IF (&VOLID ^= NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR('&SKELTGT..&PDUCTSFX' EXISTS)
        SET &ZERRLM = &STR(DELETE TARGET ENVIRONMENT FIRST AND +
                           THEN PERFORM BACKOUT AGAIN)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
    %GETVOLID '&SKELACT..&PDUCTSFX'
    ISPEXEC VGET (VOLID)
    SET &VOLACT = &VOLID
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(ACTIVE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELACT..&PDUCTSFX' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
    %GETVOLID '&SKELBKP..&PDUCTSFX'
    ISPEXEC VGET (VOLID)
    SET &VOLACT = &VOLID
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(BACKUP DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELBKP..&PDUCTSFX' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
/*
/* GO TO NEXT PANEL
/*
        ISPEXEC VPUT (TGTSYS ACTZNE TGTZNE BKPZNE SKELACT SKELTGT  +
                      SKELBKP VOLACT VOLBKP JOBCLASS)
        ISPEXEC DISPLAY PANEL(BAKOEMP3)

/* CHECK WHAT DATASETS ARE PRESENT
BEGDSLST: +
ISPEXEC TBTOP TABLEBAK
ISPEXEC TBSKIP TABLEBAK
SET RC = 0
SET DDCTR = 0
  DO WHILE &RC = 0
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELACT..&SUFFIX')
    SET &ACTCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&ACTCC EQ 0) THEN +
      DO
        SET ACTFLAG = Y
        IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET ACTVSAM = N
          ELSE +
             SET ACTVSAM = Y
      END
    ELSE +
      DO
         SET ACTFLAG = N
         SET ACTVSAM = N
      END
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELBKP..&SUFFIX')
    SET &BKPCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&BKPCC EQ 0) THEN +
      DO
        SET BKPFLAG = Y
        IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET BKPVSAM = N
          ELSE +
             SET BKPVSAM = Y
      END
    ELSE +
      DO
         SET BKPFLAG = N
         SET BKPVSAM = N
      END
    SET DDCTR = &DDCTR + 1
    IF (&ACTVSAM = Y OR &BKPVSAM = Y) THEN +
      DO
        ISPEXEC TBPUT TABLEBAK
        SET TSUFFIX = &SUFFIX
        SET &SUFFIX = &TSUFFIX..DATA
        ISPEXEC TBADD TABLEBAK
        IF (&ACTLNES > 4 OR &BKPLNES > 4) THEN +
          DO
            IF &SUBSTR(4:8,&SYSOUTLINE5) = INDEX THEN +
              DO
                SET &SUFFIX = &TSUFFIX..INDEX
                ISPEXEC TBADD TABLEBAK
              END
          END
        SET &ACTVSAM = N
        SET &BKPVSAM = N
        SET &SUFFIX = &TSUFFIX
      END
    ELSE ISPEXEC TBPUT TABLEBAK
    ISPEXEC TBSKIP TABLEBAK
    SET &RC = &LASTCC
    IF &RC = 8 THEN +
       DO
         GOTO ENDDSLST
       END
  END
ENDDSLST: +
    SET &PNLLVL = &LV
    ISPEXEC VPUT (SRCZNE DESTZNE) SHARED
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL BAKOEMS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
    ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
/*                                                                 */
/* WRAP IT UP                                                      */
/*                                                                 */
    EXIT CODE(0)
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC TBCLOSE TABLEBAK LIBRARY(TABLEDS)
    ISPEXEC TBERASE TABLEBAK LIBRARY(TABLEDS)
    EXIT CODE(&MAXCC)
./ ADD NAME=BATCH    0100-92007-92007-1428-00026-00026-00000-DMV0016
PROC 1 CMD PARMA() PARMB() PARMC() PARMD() PARME()
/*********************************************************************/
/*                                                                   */
/* LIB: CLIST(BATCH)                                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM.                      */
/* DOC: THIS CLIST INVOKES ISPF IN BATCHMODE.                        */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH MSG MAIN END(ENDO)
    WRITE
    WRITE LIB: CLIST(ISPBATCH)
    WRITE GDE: INSTALLATION/MIGRATION/CONVERSION TEAM
    WRITE DOC: THIS CLIST INVOKES ISPF IN BATCH MODE.
    WRITE
    GETSYSID
    WRITE SYSTEM&STR(:)&SYSID
    WRITE CMD=&NRSTR(&CMD)
    WRITE PARMA=&NRSTR(&PARMA)
    WRITE PARMB=&NRSTR(&PARMB)
    WRITE PARMC=&NRSTR(&PARMC)
    WRITE PARMD=&NRSTR(&PARMD)
    WRITE PARME=&NRSTR(&PARME)
    WRITE
    ISPSTART CMD(&CMD &PARMA &PARMB &PARMC &PARMD &PARME)
    WRITE EXITING WITH CC=&MAXCC
    EXIT CODE(&MAXCC)
./ ADD NAME=CHGDCL   0100-92090-92090-1342-00012-00012-00000-DMV0016
PROC 0
    ISREDIT MACRO
    WRITENR ENTER PREFIX FOR COLUMN NAMES ==>
    READ TBL
/*                                                                 */
/* LIB: DMV0016.CLIST(DCLGEN)                                      */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS EDIT CLIST MACRO UPDATES DCLGEN OUTPUT.               */
/*                                                                 */
  ISREDIT C ' 10 ' ' 10  &TBL-' 11 ALL
  ISREDIT C ' 49 ' ' 49  &TBL-' 14 ALL
  EXIT CODE(0)
./ ADD NAME=CLNBKPC1 0140-92097-92104-1615-00154-00096-00086-MANN
/*********************** REXX ****************************************/
/*                                                                   */
/*********************************************************************/
/* TRACE ?R */
    "ISPEXEC CONTROL ERRORS RETURN"
    "ISPEXEC VGET (DSLIST EDITIT)"
    L = LENGTH(DSLIST)
    IF SUBSTR(DSLIST,1,1) = "'" THEN NOP
      ELSE DSLIST = "'" ×× DSLIST
    L = LENGTH(DSLIST)
    IF SUBSTR(DSLIST,L,1) = "'" THEN NOP
      ELSE DSLIST = DSLIST ×× "'"
    DROP L
"ALLOC FI(INPUTDD) DA("DSLIST") SHR REUSE"
"EXECIO * DISKR INPUTDD (STEM LINEIN."
CNTOUT = 0
DATOUT = 0
VALCNT = 0
/* MSG_STATUS = MSG("OFF") */
DO CNTIN = 1 TO LINEIN.0 BY 1
  IF (TRANSLATE(SUBSTR(LINEIN.CNTIN,2,1)) = ' ' &&,
      TRANSLATE(SUBSTR(LINEIN.CNTIN,2,1)) = '-' &&,
      TRANSLATE(SUBSTR(LINEIN.CNTIN,2,11)) = '***** TOTAL') THEN NOP
  ELSE
     IF TRANSLATE(SUBSTR(LINEIN.CNTIN,2,2)) = '* ' THEN
        DO
           DATOUT = DATOUT + 1
           DATINX.DATOUT = TRANSLATE(SUBSTR(LINEIN.CNTIN,4,36))
           DATINX.DATOUT = STRIP(DATINX.DATOUT)
           DATDS = "'" ×× DATINX.DATOUT ×× "'"
        END
     ELSE
        DO
           CNTOUT = CNTOUT + 1
           LNEOUT1.CNTOUT = TRANSLATE(SUBSTR(LINEIN.CNTIN,2,38))
           LNEOUT1.CNTOUT = STRIP(LNEOUT1.CNTOUT)
           LINEDS = "'" ×× LNEOUT1.CNTOUT ×× "'"
           Y = LISTDSI(LINEDS)
           DSORG = SYSDSORG
           VOLUME = SYSVOLUME
           IF DSORG ^= "VS" && Y > 4 THEN NOP
           ELSE
              DO
                 X = OUTTRAP('NAME.')
                 "LISTC ENT ("LINEDS") DATA IX"
                 X = OUTTRAP('OFF')
                 DO I = 1 TO NAME.0 BY 1
                   IF WORD(NAME.I,1) = "DATA" &&,
                      WORD(NAME.I,1) = "INDEX" THEN
                      DO
                        VALCNT = VALCNT + 1
                        VALDSX.VALCNT = WORD(NAME.I,3)
                        VALDSX.VALCNT = STRIP(VALDSX.VALCNT)
                      END
                   ELSE NOP
                 END
              END
           ALTER.CNTOUT = "Y"
           IF Y = 0 & SUBSTR(VOLUME,1,3) ^= "HRA" THEN
              DO
                ALTER.CNTOUT = "N"
                SAY LINEDS " NOT CATALOGED ON A HRA VOLUME =>",
                    VOLUME ALTER.CNTOUT
              END
        END
END
"EXECIO 0 DISKR INPUTDD (FINIS"
"FREE FI(INPUTDD)"
 STEMNO = 0
 DO S = 1 TO DATOUT BY 1
    MATCH = "N"
    CALL CHKFILES
    IF MATCH = "N" THEN
      DO
         STEMNO = STEMNO + 1
         LNEOUT2.STEMNO = DATINX.S
      END
    ELSE NOP
 END
CALL BKUPSTEP

CHKFILES: PROCEDURE EXPOSE VALCNT S DATINX.S VALDSX. MATCH
    DO T = 1 TO VALCNT BY 1
       IF DATINX.S = VALDSX.T THEN
          DO
             MATCH = "Y"
             RETURN
          END
    END
    MATCH = "N"
    RETURN

BKUPSTEP:
    "ISPEXEC FTOPEN TEMP"
     MYCC = RC
    "ISPEXEC FTINCL CLNBKPS1"
    DO U = 1 TO CNTOUT BY 1
       DSNAME = LNEOUT1.U
       "ISPEXEC VPUT (DSNAME)"
       "ISPEXEC FTINCL CLNBKPS2"
    END
    DO V = 1 TO STEMNO BY 1
       DSNAME = LNEOUT2.V
       "ISPEXEC VPUT (DSNAME)"
       IF V = STEMNO THEN
          "ISPEXEC FTINCL CLNBKPS3"
       ELSE
          "ISPEXEC FTINCL CLNBKPS2"
    END
    "ISPEXEC FTINCL CLNRENS1"
    DO W = 1 TO CNTOUT BY 1
       IF ALTER.W = "N" THEN NOP
       ELSE
         DO
           DSNAME = LNEOUT1.W
           "ISPEXEC VPUT (DSNAME)"
           "ISPEXEC FTINCL CLNRENS2"
           "ISPEXEC FTINCL CLNRENS3"
         END
    END
    "ISPEXEC FTINCL CLNRENS4"
    "ISPEXEC FTCLOSE"
     MYCC = RC + MYCC
    IF MYCC ^= 0 THEN
      DO
        ZERRHM   = "*"
        ZERRALRM = "NO"
        ZERRSM   = "TAILORING FAILED"
        ZERRLM   = "FILE TAILORING FAILED WITH"
        ZERRLM   = "ZERRLM " ×× "RC=" ×× MYCC
        "ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED"
        "ISPEXEC SETMSG MSG(ISRZ002)"
        EXIT
      END
   "ISPEXEC VGET ZTEMPF"
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF EDITIT = "Y" THEN
      DO
       "ISPEXEC EDIT DATASET('&ZTEMPF')"
        EXIT
      END
/*
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    "ISPEXEC CONTROL DISPLAY SM START(13)"
    SUBMIT 'ZTEMPF' NOHOLD
/*                                                                 */
/* WRAP IT UP                                                      */
/*                                                                 */
*/
    EXIT
./ ADD NAME=CLNBKPC2 0107-92099-92101-0951-00050-00060-00016-MANN
/*********************** REXX ****************************************/
/*                                                                   */
/*********************************************************************/
/* TRACE ?R */
    "ISPEXEC CONTROL ERRORS RETURN"
DSLIST = "'XDBS.SCRIPT(HRACLNBK)'"
"ALLOC FI(INPUTDD) DA("DSLIST") SHR REUSE"
"EXECIO * DISKR INPUTDD (STEM LINEIN."
CNTOUT = 0
DATOUT = 0
VALCNT = 0
/* MSG_STATUS = MSG("OFF") */
DO CNTIN = 1 TO LINEIN.0 BY 1
  IF (TRANSLATE(SUBSTR(LINEIN.CNTIN,2,1)) = ' ' &&,
      TRANSLATE(SUBSTR(LINEIN.CNTIN,2,1)) = '-' &&,
      TRANSLATE(SUBSTR(LINEIN.CNTIN,2,11)) = '***** TOTAL') THEN NOP
  ELSE
     IF TRANSLATE(SUBSTR(LINEIN.CNTIN,2,2)) = '* ' THEN
        DO
           DATOUT = DATOUT + 1
           DATINX.DATOUT = TRANSLATE(SUBSTR(LINEIN.CNTIN,4,36))
           DATINX.DATOUT = STRIP(DATINX.DATOUT)
           VOLRPT.DATOUT = TRANSLATE(SUBSTR(LINEIN.CNTIN,41,6))
           DATDS = "'" ×× DATINX.DATOUT ×× "'"
           X = LISTDSI(DATDS)
           VOLUME = SYSVOLUME
           IF X > 4 THEN SAY DATDS " NOT CATALOGED " VOLRPT.DATOUT
           ELSE
             IF SUBSTR(VOLUME,1,3) ^= "HRA" THEN,
                SAY DATDS " NOT CATALOGED ON A HRA VOLUME =>",
                    VOLRPT.DATOUT " CATALOGED ON =>" VOLUME
        END
     ELSE
        DO
           CNTOUT = CNTOUT + 1
           LNEOUT1.CNTOUT = TRANSLATE(SUBSTR(LINEIN.CNTIN,2,38))
           LNEOUT1.CNTOUT = STRIP(LNEOUT1.CNTOUT)
           VOLRPT.CNTOUT = TRANSLATE(SUBSTR(LINEIN.CNTIN,41,6))
           LINEDS = "'" ×× LNEOUT1.CNTOUT ×× "'"
           Y = LISTDSI(LINEDS)
           VOLUME = SYSVOLUME
           IF Y > 4 THEN SAY LINEDS " NOT CATALOGED " VOLRPT.CNTOUT
           ELSE
             IF SUBSTR(VOLUME,1,3) ^= "HRA" THEN,
                SAY LINEDS " NOT CATALOGED ON A HRA VOLUME =>",
                    VOLRPT.CNTOUT " CATALOGED ON =>" VOLUME
        END
END
"EXECIO 0 DISKR INPUTDD (FINIS"
"FREE FI(INPUTDD)"
./ ADD NAME=CMPCLUST 0108-92147-92147-1531-00056-00154-00031-MANN
/*********************** REXX ****************************************/
/* THIS PROGRAM COMPARES THE CLUSTER NAME TO ITS DATA AND INDEX      */
/* PORTION AND PRODUCES A LIST OF NON-MATCHES.(INPUT IS A LISTVTOC)  */
/*********************************************************************/
/* TRACE ?R */
    "ISPEXEC CONTROL ERRORS RETURN"
INDSLST = "'MANN.SDSF.OUTPUT'"
OUTDSLST = "'MANN.HRAFIX.LIST'"
"ALLOC FI(INPUTDD) DA("INDSLST") SHR REUSE"
"ALLOC FI(OUTDD) DA("OUTDSLST") SHR REUSE"
"EXECIO * DISKR INPUTDD (STEM LINEIN."
DATOUT = 0
VALCNT = 0
DO CNTIN = 1 TO LINEIN.0 BY 1
  IF TRANSLATE(SUBSTR(LINEIN.CNTIN,3,46)) = ' ' THEN NOP
  ELSE
    /* BEGIN HRA MIGRATION ONLY */
    IF TRANSLATE(SUBSTR(LINEIN.CNTIN,3,3)) = 'CSP' &&,
       TRANSLATE(SUBSTR(LINEIN.CNTIN,3,4)) = 'C069' &&,
       TRANSLATE(SUBSTR(LINEIN.CNTIN,3,4)) = 'P069' THEN
    /* END HRA MIGRATION ONLY */
        DO
           DATIXDSN = TRANSLATE(SUBSTR(LINEIN.CNTIN,3,46))
           DATIXDSN = STRIP(DATIXDSN)
           LINEDS = "'" ×× DATIXDSN ×× "'"
           Y = LISTDSI(LINEDS)
           DSORG = SYSDSORG
           IF DSORG ^= "VS" && Y > 4 THEN NOP
           ELSE
              DO
                 X = OUTTRAP('NAME.')
                 "LISTC ENT ("LINEDS") ALL"
                 X = OUTTRAP('OFF')
                 DO I = 1 TO NAME.0 BY 1
                   IF SUBSTR(WORD(NAME.I,1),1,9) = "CLUSTER--" THEN
                      DO
                        CLUSTDSN = SUBSTR(WORD(NAME.I,1),10,44)
                        CLUSTDSN = STRIP(CLUSTDSN)
                        P = LASTPOS('.',DATIXDSN)
                        P = P - 1
                        IF CLUSTDSN ^= SUBSTR(DATIXDSN,1,P) THEN
                          DO
                             SAY 'CLUSTER ==>' CLUSTDSN
                             SAY '        ==>' DATIXDSN
                          END
                      END
                   ELSE NOP
                 END
              END
        END
END
"EXECIO 0 DISKR INPUTDD (FINIS"
"EXECIO 0 DISKW OUTDD (FINIS"
"FREE FI(INPUTDD)"
"FREE FI(OUTDD)"
EXIT
./ ADD NAME=CMS2TSO  0106-93005-93103-1518-00219-00203-00000-KETCSC
PROC 1 FORUSER
/*                                                                 */
/* LIB: SYSPROC(CMS2TSO)                                           */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST INVOKES "RECEIVE" AND RESPONDS TO EVERY         */
/*      WAITING DATASET.                                           */
/*                                                                 */
BEGIN: +
    CONTROL NOLIST NOFLUSH END(ENDO) PROMPT
    PROFILE MSGID
    WRITE ATTEMPTING RECEIVE OF &FORUSER DATASETS
/*  CONTROL LIST MSG
/*  CONTROL CONLIST SYMLIST
    CONTROL PROMPT
    SET &NULL =
    SET &SYSOUTEND = 25
    SET &RCVD = 0
REEXEC: +
    ERROR +
      DO
        ERROR OFF
        GOTO NOEND
      ENDO
    SET &SYSOUTTRAP = &SYSOUTEND
    RECEIVE USERID(&FORUSER)
/*  DATA PROMPT
      END
/*  ENDDATA
    &NULL
NOEND: +
    CONTROL PROMPT
    SET &SYSOUTTRAP = 0
    ERROR OFF
    IF (&SYSOUTLINE LT 2) THEN +
      DO
        IF (&RCVD = 0) THEN +
          DO
            WRITE NOTHING TODAY
            EXIT CODE(0)
          ENDO
        IF (&RCVD > 0) THEN +
          DO
            WRITE TOTAL RECEIVED DATASETS&STR(:) &RCVD
            EXIT CODE(0)
          ENDO
      ENDO
    IF (&SYSOUTLINE GT &SYSOUTEND) THEN +
      DO
        SET &SYSOUTEND = &SYSOUTLINE
        GOTO REEXEC
      ENDO
    SET &CTR = 0
FIND901I: +
    SET &CTR = &CTR + 1
    IF (&CTR > &SYSOUTLINE) THEN +
      DO
        WRITE ZERO LINES TRAPPED CAN THIS BE?
        EXIT CODE(1)
      ENDO
    SET &LINE = &&SYSOUTLINE&CTR
    SET &LINE = &NRSTR(&LINE)
    SET &SYSDVAL = &STR(&LINE)
    READDVAL MSGNBR NULLDATA
    IF (&STR(&MSGNBR) EQ INMR003I) THEN +
      DO
        WRITE NOTHING TO RECEIVE
        EXIT CODE(0)
      ENDO
    IF (&STR(&MSGNBR) EQ INMR000I) THEN +
      DO
        WRITE ALL OUTSTANDING DATASETS PROCESSED
        EXIT CODE(0)
      ENDO
    READDVAL YOU HAVE NO NULLDATA
    IF (&STR(&NO) EQ NO) THEN +
      DO
        WRITE NOTHING TO RECEIVE
        EXIT CODE(0)
      ENDO
    IF (&STR(&MSGNBR) NE INMR901I) THEN +
      DO
        GOTO FIND901I
      ENDO
    READDVAL MSGNBR DUMMY XMITDSN FROM XMITUSER ON XMITSYSID
PARSERTN: +
    SET &CTR = 0
    SET &DSNL = &LENGTH(&STR(&XMITDSN))
    SET &DSNLEVEL = &STR()
FINDDOT: +
    SET &CTR = &CTR + 1
    IF (&CTR > &DSNL) THEN +
      DO
        GOTO DSNSHOW
      ENDO
    SET &BYTE = &SUBSTR(&CTR:&CTR,&STR(&XMITDSN))
    IF (&STR(&BYTE) EQ &STR(.)) THEN SET &BYTE = &STR( )
    IF (&STR(&BYTE) EQ &STR('''')) THEN SET &BYTE = &STR( )
    SET &DSNLEVEL = &STR(&DSNLEVEL.&BYTE)
    GOTO FINDDOT
DSNSHOW: +
    SET &RDSN = '&FORUSER..A.BOGUS.FILE'
    SET &SYSDVAL = &STR(&DSNLEVEL)
    READDVAL QUAL LEVEL1 LEVEL2 LEVEL3 LEVEL4 LEVEL5 LEVEL6 LEVEL7
    IF (&STR(&LEVEL2) EQ LISTING) THEN +
      DO
        SET &OK = &SYSDSN('&FORUSER..OUTPUT.LISTING')
        IF (&STR(&OK) EQ &STR(DATASET NOT FOUND)) THEN +
          DO
            FREE FILE(LISTINGS)
            ALLOC FILE(LISTINGS) DATASET('&FORUSER..OUTPUT.LISTING') +
              UNIT(SYSDA)  NEW CATALOG   +
              RECFM(F B) BLKSIZE(7448) LRECL(133)    +
              SPACE(15 5) TRACKS DIR(45)
            FREE FILE(LISTINGS)
          ENDO
        SET &RDSN = &STR('&FORUSER..OUTPUT.LISTING(&LEVEL1)')
      ENDO
    ELSE +
    IF (&STR(&LEVEL2) EQ JCL) THEN +
      DO
        SET &OK = &SYSDSN('&FORUSER..JCL.CNTL')
        IF (&STR(&OK) EQ &STR(DATASET NOT FOUND)) THEN +
          DO
            FREE FILE(CNTL)
            ALLOC FILE(CNTL) DATASET('&FORUSER..JCL.CNTL') +
              UNIT(SYSDA)  NEW CATALOG   +
              RECFM(F B) BLKSIZE(7440) LRECL(80)    +
              SPACE(15 5) TRACKS DIR(45)
            FREE FILE(CNTL)
          ENDO
        SET &RDSN = &STR('&FORUSER..JCL.CNTL(&LEVEL1)')
      ENDO
    ELSE +
    IF (&STR(&LEVEL1) EQ NAMES) THEN +
      DO
        SET &RDSN = &STR('&FORUSER..NAMES.TEXT')
      ENDO
    ELSE +
    IF (&STR(&LEVEL1) EQ DB2CSC) THEN +
      DO
        SET &DTMBR = DT&SUBSTR(7:8,&SYSDATE)&SUBSTR(1:2,&SYSDATE)
        SET &DTMBR = &STR(&DTMBR.&SUBSTR(4:5,&SYSDATE))
        SET &RDSN = &STR('&FORUSER..NETLOG(&DTMBR)')
      ENDO
    ELSE +
    IF (&STR(&LEVEL2) EQ DATA) THEN +
      DO
        SET &RDSN = &STR('XDBS.PARMLIB(&LEVEL1)')
      ENDO
    SET &CTR = &CTR + 1
    IF (&CTR > &SYSOUTLINE) THEN +
      DO
        GOTO GODOIT
      ENDO
    SET &LINE = &&SYSOUTLINE&CTR
    SET &LINE = &NRSTR(&LINE)
    SET &SYSDVAL = &STR(&LINE)
    READDVAL MSGNBR NULLDATA MEMLIST
    IF (&STR(&MSGNBR) EQ INMR902I) THEN +
      DO
        GOTO YESMBRS
      ENDO
    IF (&STR(&MSGNBR) EQ INMR906A) THEN +
      DO
        GOTO GODOIT
      ENDO
NEWMSG: +
    WRITE THIS IS NEW TO ME
    WRITE &LINE
    GOTO GODOIT
YESMBRS: +
    WRITE MEMBERS CHOSEN &NRSTR(&MEMLIST)
    SET &CTR = &CTR + 1
    IF (&CTR > &SYSOUTLINE) THEN +
      DO
        WRITE ZERO LINES TRAPPED CAN THIS BE?
        EXIT CODE(1)
      ENDO
    SET &LINE = &&SYSOUTLINE&CTR
    SET &LINE = &NRSTR(&LINE)
    SET &SYSDVAL = &STR(&LINE)
    READDVAL MSGNBR NULLDATA MEMLIST
    IF (&STR(&MSGNBR) EQ INMR902I) THEN +
      DO
        GOTO YESMBRS
      ENDO
    IF (&STR(&MSGNBR) EQ INMR906A) THEN +
      DO
        GOTO GODOIT
      ENDO
    GOTO GODOIT
GODOIT: +
    SET &MAXCC = 0
    WRITE RECEIVING &XMITDSN INTO &RDSN
    ERROR +
      DO
        ERROR OFF
        IF (&MAXCC > 0) THEN +
          DO
            IF (&MAXCC = 968) THEN +
              DO
                WRITE END OF RECEIVABLES REACHED
                EXIT CODE(0)
              ENDO
            WRITE UNABLE TO COMPLETE RECEIVE MAXCC=&MAXCC
            EXIT CODE(&MAXCC)
          ENDO
        GOTO WEDONE
      ENDO
    RECEIVE USERID(&FORUSER)
    DATA PROMPT
      DSNAME(&RDSN)
      END
    ENDDATA
    &NULL
    ERROR OFF
    SET &RCVD = &RCVD + 1
WEDONE: +
    GOTO REEXEC
./ ADD NAME=CMS2TSOO 0100-93006-93006-0921-00218-00218-00000-KETCSC
PROC 1 FORUSER
/*                                                                 */
/* LIB: SYSPROC(CMS2TSO)                                           */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST INVOKES "RECEIVE" AND RESPONDS TO EVERY         */
/*      WAITING DATASET.                                           */
/*                                                                 */
BEGIN: +
    CONTROL NOLIST NOFLUSH END(ENDO) PROMPT
    PROFILE MSGID
    WRITE ATTEMPTING RECEIVE OF &FORUSER DATASETS
/*  CONTROL LIST MSG
/*  CONTROL CONLIST SYMLIST
    CONTROL PROMPT
    SET &NULL =
    SET &SYSOUTEND = 25
    SET &RCVD = 0
REEXEC: +
    ERROR +
      DO
        ERROR OFF
        GOTO NOEND
      ENDO
    SET &SYSOUTTRAP = &SYSOUTEND
    RECEIVE USERID(&FORUSER)
/*  DATA PROMPT
      END
/*  ENDDATA
    &NULL
NOEND: +
    CONTROL PROMPT
    SET &SYSOUTTRAP = 0
    ERROR OFF
    IF (&SYSOUTLINE LT 2) THEN +
      DO
        IF (&RCVD = 0) THEN +
          DO
            WRITE NOTHING TODAY
            EXIT CODE(0)
          ENDO
        IF (&RCVD > 0) THEN +
          DO
            WRITE TOTAL RECEIVED DATASETS&STR(:) &RCVD
            EXIT CODE(0)
          ENDO
      ENDO
    IF (&SYSOUTLINE GT &SYSOUTEND) THEN +
      DO
        SET &SYSOUTEND = &SYSOUTLINE
        GOTO REEXEC
      ENDO
    SET &CTR = 0
FIND901I: +
    SET &CTR = &CTR + 1
    IF (&CTR > &SYSOUTLINE) THEN +
      DO
        WRITE ZERO LINES TRAPPED CAN THIS BE?
        EXIT CODE(1)
      ENDO
    SET &LINE = &&SYSOUTLINE&CTR
    SET &LINE = &NRSTR(&LINE)
    SET &SYSDVAL = &STR(&LINE)
    READDVAL MSGNBR NULLDATA
    IF (&STR(&MSGNBR) EQ INMR003I) THEN +
      DO
        WRITE NOTHING TO RECEIVE
        EXIT CODE(0)
      ENDO
    IF (&STR(&MSGNBR) EQ INMR000I) THEN +
      DO
        WRITE ALL OUTSTANDING DATASETS PROCESSED
        EXIT CODE(0)
      ENDO
    READDVAL YOU HAVE NO NULLDATA
    IF (&STR(&NO) EQ NO) THEN +
      DO
        WRITE NOTHING TO RECEIVE
        EXIT CODE(0)
      ENDO
    IF (&STR(&MSGNBR) NE INMR901I) THEN +
      DO
        GOTO FIND901I
      ENDO
    READDVAL MSGNBR DUMMY XMITDSN FROM XMITUSER ON XMITSYSID
PARSERTN: +
    SET &CTR = 0
    SET &DSNL = &LENGTH(&STR(&XMITDSN))
    SET &DSNLEVEL = &STR()
FINDDOT: +
    SET &CTR = &CTR + 1
    IF (&CTR > &DSNL) THEN +
      DO
        GOTO DSNSHOW
      ENDO
    SET &BYTE = &SUBSTR(&CTR:&CTR,&STR(&XMITDSN))
    IF (&STR(&BYTE) EQ &STR(.)) THEN SET &BYTE = &STR( )
    IF (&STR(&BYTE) EQ &STR('''')) THEN SET &BYTE = &STR( )
    SET &DSNLEVEL = &STR(&DSNLEVEL.&BYTE)
    GOTO FINDDOT
DSNSHOW: +
    SET &RDSN = '&FORUSER..A.BOGUS.FILE'
    SET &SYSDVAL = &STR(&DSNLEVEL)
    READDVAL QUAL LEVEL1 LEVEL2 LEVEL3 LEVEL4 LEVEL5 LEVEL6 LEVEL7
    IF (&STR(&LEVEL2) EQ LISTING) THEN +
      DO
        SET &OK = &SYSDSN('&FORUSER..TSO.LISTINGS')
        IF (&STR(&OK) EQ &STR(DATASET NOT FOUND)) THEN +
          DO
            FREE FILE(LISTINGS)
            ALLOC FILE(LISTINGS) DATASET('&FORUSER..TSO.LISTINGS') +
              UNIT(3380) VOLUME(STS001) NEW CATALOG    +
              RECFM(F B) BLKSIZE(1320) LRECL(132)    +
              SPACE(15 5) TRACKS DIR(45)
            FREE FILE(LISTINGS)
          ENDO
        SET &RDSN = &STR('&FORUSER..TSO.LISTINGS(&LEVEL1)')
      ENDO
    ELSE +
    IF (&STR(&LEVEL2) EQ JCL) THEN +
      DO
        SET &OK = &SYSDSN('&FORUSER..JCL.CNTL')
        IF (&STR(&OK) EQ &STR(DATASET NOT FOUND)) THEN +
          DO
            FREE FILE(CNTL)
            ALLOC FILE(CNTL) DATASET('&FORUSER..JCL.CNTL') +
              UNIT(3380) VOLUME(STS001) NEW CATALOG    +
              RECFM(F B) BLKSIZE(3200) LRECL(80)    +
              SPACE(15 5) TRACKS DIR(45)
            FREE FILE(CNTL)
          ENDO
        SET &RDSN = &STR('&FORUSER..JCL.CNTL(&LEVEL1)')
      ENDO
    ELSE +
    IF (&STR(&LEVEL2) EQ TEXT) THEN +
      DO
        SET &RDSN = &STR('&FORUSER..NAMES.TEXT')
      ENDO
    ELSE +
    IF (&STR(&LEVEL2) EQ DATA) THEN +
      DO
        SET &RDSN = &STR('XDBS.PARMLIB(&LEVEL1)')
      ENDO
    SET &CTR = &CTR + 1
    IF (&CTR > &SYSOUTLINE) THEN +
      DO
        GOTO GODOIT
      ENDO
    SET &LINE = &&SYSOUTLINE&CTR
    SET &LINE = &NRSTR(&LINE)
    SET &SYSDVAL = &STR(&LINE)
    READDVAL MSGNBR NULLDATA MEMLIST
    IF (&STR(&MSGNBR) EQ INMR902I) THEN +
      DO
        GOTO YESMBRS
      ENDO
    IF (&STR(&MSGNBR) EQ INMR906A) THEN +
      DO
        GOTO GODOIT
      ENDO
    IF (&STR(&MSGNBR) EQ INMR000I) THEN +
      DO
        WRITE ALL OUTSTANDING DATASETS PROCESSED
        EXIT CODE(0)
      ENDO
NEWMSG: +
    WRITE THIS IS NEW TO ME
    WRITE &LINE
    GOTO GODOIT
YESMBRS: +
    WRITE MEMBERS CHOSEN &NRSTR(&MEMLIST)
    SET &CTR = &CTR + 1
    IF (&CTR > &SYSOUTLINE) THEN +
      DO
        WRITE ZERO LINES TRAPPED CAN THIS BE?
        EXIT CODE(1)
      ENDO
    SET &LINE = &&SYSOUTLINE&CTR
    SET &LINE = &NRSTR(&LINE)
    SET &SYSDVAL = &STR(&LINE)
    READDVAL MSGNBR NULLDATA MEMLIST
    IF (&STR(&MSGNBR) EQ INMR902I) THEN +
      DO
        GOTO YESMBRS
      ENDO
    IF (&STR(&MSGNBR) EQ INMR906A) THEN +
      DO
        GOTO GODOIT
      ENDO
    GOTO GODOIT
GODOIT: +
    SET &MAXCC = 0
    WRITE RECEIVING &XMITDSN INTO &RDSN
    ERROR +
      DO
        ERROR OFF
        IF (&MAXCC > 0) THEN +
          DO
            IF (&MAXCC = 968) THEN +
              DO
                WRITE MUST BE DONE RC=968
                EXIT CODE(0)
              ENDO
            WRITE UNABLE TO COMPLETE RECEIVE MAXCC=&MAXCC
            EXIT CODE(&MAXCC)
          ENDO
        GOTO WEDONE
      ENDO
    RECEIVE USERID(&FORUSER)
    DATA PROMPT
      DSNAME(&RDSN)
      END
      &NULL
    ENDDATA
    &NULL
    ERROR OFF
    SET &RCVD = &RCVD + 1
WEDONE: +
    GOTO REEXEC
./ ADD NAME=CP       0100-93077-93077-1114-00121-00121-00000-KETCSC
ISREDIT MACRO (TRACE)
/*                                                                 */
/* LIB: CLIST.LIBRARY.NAME(Z)                                      */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES LIBRARY SERVICES TO COMPRESS A DATASET.    */
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  SET UP ERROR HANDLING PROCESSING                               */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG    /*  INITIAL SETTINGS */
    IF (&TRACE = TRACE) THEN +
      CONTROL LIST MSG CONLIST SYMLIST        /*  DEBUGGING HELP   */
    IF (&STR(&SYSISPF) NE ACTIVE) THEN +
      DO                                      /* - - - - - - - - - */
        WRITENR YOU MUST BE IN ISPF/EDIT      /* WRITE MESSAGE     */
        WRITE TO USE THIS EDIT MACRO          /* WRITE MESSAGE     */
        EXIT CODE(16)                         /* TERMINATE         */
      ENDO                                    /* - - - - - - - - - */
    ISPEXEC CONTROL ERRORS RETURN             /*  ISPF ERRORS      */
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  RETRIEVE DATA SET NAME FOR CURRENT EDIT DATASET                */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    ISREDIT (DSN) = DATASET                   /*  RETRIEVE DATASET */
    SET &DSN = &STR('&DSN')                   /*  WRAP IN APOST    */
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  INITIALIZE MESSAGE HANDLING ENVIRONMENT                        */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    SET &ZERRHM = &STR(NOHELP)                /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(YES)                 /*  ALARM STATUS     */
    SET &ZERRSM = &STR(COMPRESSED!!)          /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR( )                     /*  LONG MESSAGE     */
    SET &ZERRLM = &STR(THE REQUESTED PDS: &DATASET WAS COMPRESSED)
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  USE LIBRARY SERVICES TO SET UP DATASET                         */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    ISPEXEC LMINIT DATAID(DSNID) DATASET(&DSN) +
        ENQ(EXCLU)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRSM = &STR(DATASET IN USE)
        SET &ZERRLM = &STR(DATASET &DSN IS CURRENTLY IN USE)
        SET &ZERRLM = &STR(&ZERRLM BY ANOTHER USER OR TASK)
        IF (&MYCC EQ 8) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(DATASET NOT ALLOCATED OR DATA SET)
            SET &ZERRLM = &STR(&ZERRLM ORGANIZATION NOT SUPPORTED)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 12) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(INVALID PARAMETER VALUE)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 16) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(TRUNCATION OR TRANSLATION ERROR)
            SET &ZERRLM = &STR(&ZERRLM IN ACCESSING DIALOG VARIABLES)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 20) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(SEVERE ERROR)
          ENDO                                /* - - - - - - - - - */
        GOTO EXITIT
      ENDO
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  USE LIBRARY SERVICES TO COMPRESS CURRENT DATASET               */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    ISPEXEC LMCOMP DATAID(&DSNID)             /*  COMPRESS         */
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRSM = &STR(COMPRESS FAILED)
        SET &ZERRLM = &STR(THE DSN: &DSN FAILED TO)
        SET &ZERRLM = &STR(&ZERRLM COMPRESS RC=&MYCC)
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  SET MESSAGE TO TELL USER WHY THE LMCOMP FAILED                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
        IF (&MYCC EQ 10) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(NO DATA SET ASSOCIATED)
            SET &ZERRLM = &STR(&ZERRLM WITH GIVEN DATA-ID.)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 12) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(DATA SET NOT PARTITIONED OR)
           SET &ZERRLM = &STR(&ZERRLM DATA SET NOT ALLOCATED OR OPENED.)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 20) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(SEVERE ERROR, UNABLE TO CONTINUE.)
          ENDO                                /* - - - - - - - - - */
        GOTO FREEIT
      ENDO
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  USE LIBRARY SERVICES TO FREE DATASET                           */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
FREEIT: +
    ISPEXEC LMFREE DATAID(&DSNID)             /*  DONE WITH IT     */
EXITIT: +
    ISPEXEC VPUT (ZERRALRM ZERRHM ZERRLM ZERRSM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
    IF (&STR(&ZERRLM) NE ) THEN WRITE &ZERRLM
    SET &MYCC = &LASTCC
    EXIT CODE(&MAXCC)
./ ADD NAME=CPRT     0100-92157-92157-1637-00259-00259-00000-DMV0016
PROC 1 DATASET TRACE
/*                                                                 */
/* LIB: CLIST(PRT)                                                 */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST WILL PRINT AS BY PANEL OPTIONS.                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    SET &TRACE = &SYSCAPS(&TRACE)
    IF (&TRACE = TRACE) THEN +
      CONTROL LIST SYMLIST CONLIST
    ISPEXEC CONTROL ERRORS RETURN
    SET &OUTDEF = &STR()
    SET &PAGEDEF = &STR()
    SET &FORMDEF = &STR()
    SET &CHARFNT = &STR()
BEGIN: +
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DATASETL = &LENGTH(&DATASET)
        SET &DATASETL = &DATASETL - 1
        SET &DATASETE = &SUBSTR(2:&DATASETL,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    SET &DSNL = 1
    SET &DSNR = &LENGTH(&DATASETE)
    SET &RIGHTP = &SUBSTR(&DSNR:&DSNR,&DATASETE)
    IF &RIGHTP = ) THEN +
      DO
        SET &MEML = &DSNR
        SET &LEFTP = N
        DO WHILE &LEFTP ^= (
          SET &MEML = &MEML - 1
          SET &LEFTP = &SUBSTR(&MEML:&MEML,&DATASETE)
        ENDO
        SET &MEML = &MEML + 1
        SET &MEMR = &DSNR - 1
        SET &DSNR = &MEML - 2
        SET &MEM = &SUBSTR(&MEML:&MEMR,&DATASETE )
      ENDO
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    SET &DATASETG = &STR(&DATASETE)
    LISTDSI '&DSN'
    SET &RECFM = &SYSRECFM
    ISPEXEC VGET (WAY RECFM SYSOUT DEST)
    IF (&SYSOUT = ) THEN SET &SYSOUT=X
    IF (&DEST = ) THEN SET &DEST = LOCAL
    ISPEXEC VGET (PDEF FONT FDEF) PROFILE
    IF (&PDEF = ) THEN SET &PDEF = &STR(?)
    IF (&FONT = ) THEN SET &FONT = &STR(?)
    IF (&FDEF = ) THEN SET &FDEF = &STR(?)
    ISPEXEC DISPLAY PANEL(CPRT)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN EXIT CODE(0)
    ISPEXEC VGET (WAY RECFM SYSOUT DEST SS CPY UCNT)
    ISPEXEC VGET (PDEF FONT FDEF) PROFILE
    IF (&WAY = 1) THEN GOTO WAYA
    IF (&NRSTR(&DEST) NE ) THEN +
      DO
        SET &COMMA = &STR()
        IF (&NRSTR(&PDEF) EQ &STR(?)) THEN +
          DO
            %PRTPDEF &TRACE
            ISPEXEC VGET (PDEF)
          ENDO
        IF (&NRSTR(&PDEF) NE ) THEN +
          DO
            SET &PAGESTR = &STR(PAGEDEF=&PDEF)
            SET &COMMA = &STR(,)
            SET &OUTDEF = &STR(&OUTDEF.Y)
            ISPEXEC VPUT (PDEF) PROFILE
          ENDO
        IF (&NRSTR(&FONT) EQ &STR(?)) THEN +
          DO
            %PRTFONT &TRACE
            ISPEXEC VGET (FONT) PROFILE
          ENDO
        IF (&NRSTR(&FONT) NE ) THEN +
          DO
            SET &FONTSTR = &STR(&COMMA.CHARS=&FONT)
            SET &COMMA = &STR(,)
            SET &OUTDEF = &STR(&OUTDEF.Y)
            ISPEXEC VPUT (FONT) PROFILE
          ENDO
        IF (&NRSTR(&FDEF) EQ &STR(?)) THEN +
          DO
            %PRTFDEF &TRACE
            ISPEXEC VGET (FDEF) PROFILE
          ENDO
        IF (&NRSTR(&FDEF) NE ) THEN +
          DO
            SET &FORMSTR = &STR(&COMMA.FORMDEF=&FDEF)
            SET &OUTDEF = &STR(&OUTDEF.Y)
            ISPEXEC VPUT (FDEF) PROFILE
          ENDO
      ENDO
/*********************************************************************/
/*                                                                   */
/* DOC: WAY=2 USE IEBGENER                                           */
/*                                                                   */
/*********************************************************************/
WAYB: +
    IF (&WAY = 2) THEN +
      DO
        ISPEXEC VPUT (PAGESTR FORMSTR FONTSTR)
        SET &BLKSIZE = &SYSBLKSIZE
        SET &LRECL = &SYSLRECL
        ISPEXEC VGET (JA JB JC JD)
        ISPEXEC FTOPEN TEMP
        ISPEXEC FTINCL PRTGENER
        ISPEXEC FTCLOSE
        ISPEXEC VGET (ZTEMPF)
        ISPEXEC CONTROL DISPLAY SM START(13)
        CONTROL MSG
        SUBMIT '&ZTEMPF' NOHOLD
        EXIT CODE(0)
      ENDO
/*********************************************************************/
/*                                                                   */
/* DOC: WAY=3 TRY USING IEBPTPCH                                     */
/*                                                                   */
/*********************************************************************/
WAYC: +
    IF (&WAY = 3) THEN +
      DO
        SET &ORG = &SYSDSORG
        SET &ASA = &STR()
        IF (&SYSRECFM = FBA) OR   +
           (&SYSRECFM = VBA) THEN +
          SET &ASA = A
        IF (&SYSRECFM = FBM) OR   +
           (&SYSRECFM = VBM) THEN +
          SET &ASA = M
        SET &WHR = &SS + 1
        SET &LEN = &SYSLRECL
        ISPEXEC VPUT (PAGESTR FORMSTR FONTSTR)
        ISPEXEC VPUT (ASA ORG WHR LEN MEM)
        SET &BLKSIZE = &SYSBLKSIZE
        SET &LRECL = &SYSLRECL
        ISPEXEC VGET (JA JB JC JD)
        ISPEXEC FTOPEN TEMP
        ISPEXEC FTINCL PRTPTPCH
        ISPEXEC FTCLOSE
        ISPEXEC VGET (ZTEMPF)
        ISPEXEC CONTROL DISPLAY SM START(13)
        CONTROL MSG
        SUBMIT '&ZTEMPF' NOHOLD
        EXIT CODE(0)
      ENDO
/*********************************************************************/
/*                                                                   */
/* DOC: WAY=1 SPIN OFF FROM CLIST                                    */
/*                                                                   */
/*********************************************************************/
WAYA: +
    SET &MYRECFM =
    IF (&LENGTH(&RECFM) GT 0) THEN +
      DO
        SET &MYRECFM = &SUBSTR(1:1,&RECFM)
      ENDO
    IF (&LENGTH(&RECFM) GT 1) THEN +
      DO
        SET &MYRECFM = &SUBSTR(1:1,&RECFM)
        SET &MYRECFM = &STR(&MYRECFM &SUBSTR(2:2,&RECFM))
      ENDO
    IF (&LENGTH(&RECFM) GT 2) THEN +
      DO
        SET &MYRECFM = &SUBSTR(1:1,&RECFM)
        SET &MYRECFM = &STR(&MYRECFM &SUBSTR(2:2,&RECFM))
        SET &MYRECFM = &STR(&MYRECFM &SUBSTR(3:3,&RECFM))
      ENDO
    FREE FILE(INDD,OUTDD)
    ALLOC FI(INDD) DATASET('&DATASETE') SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0 ) THEN +
      DO
        WRITE ALLOCATION OF &DSN FAILED, RC=&MYCC
        GOTO EXITIT
      ENDO
    ALLOC FI(OUTDD) SYSOUT(&SYSOUT) +
      DEST(&DEST) RECFM(&MYRECFM) COPIES(&CPY) +
       BLKSIZE(&SYSBLKSIZE) LRECL(&SYSLRECL)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0 ) THEN +
      DO
        WRITE ALLOCATION OF SYSOUT FAILED, RC=&MYCC
        GOTO EXITIT
      ENDO
    OPENFILE OUTDD OUTPUT
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0 ) THEN +
      DO
        WRITE OPEN OF SYSOUT FAILED, RC=&MYCC
        GOTO EXITIT
      ENDO
    OPENFILE INDD  INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0 ) THEN +
      DO
        WRITE OPEN OF &DSN FAILED, RC=&MYCC
        GOTO EXITIT
      ENDO
    SET &SSCTR = 0
    IF (&SS > 0) THEN +
      DO WHILE &SSCTR < &SS
        SET &MYS = &STR(&MYS )
        SET &SSCTR = &SSCTR + 1
      ENDO
    SET &LNCTR = &UCNT
READLOOP: +
    ERROR +
      DO
        ERROR OFF
        SET &MAXCC = 0
        GOTO EXITIT
      ENDO
    GETFILE INDD
    ERROR OFF
/*********************************************************************/
/*  FORCE USERS LINE-PER-PAGE LIMIT                                  */
/*********************************************************************/
    SET &LNCTR = &LNCTR + 1
    IF (&SYSRECFM = FBA) OR   +
       (&SYSRECFM = VBA) THEN +
      DO
        SET &ASA = &SUBSTR(1:1,&NRSTR(&INDD))
        SET &INL = &LENGTH(&NRSTR(&INDD))
        IF (&INL > 1) THEN +
          SET &INDD = &SUBSTR(2:&INL,&NRSTR(&INDD))
        ELSE +
          SET &INDD = &STR()
      ENDO
    ELSE +
      DO
        IF (&LNCTR GT &UCNT) THEN +
          DO
            SET &ASA = 1
            SET &LNCTR = 1
          ENDO
        ELSE +
          DO
            SET &ASA = &STR( )
          ENDO
      ENDO
/*********************************************************************/
/*  PRINT                                                            */
/*********************************************************************/
    SET &OUTDD = &NRSTR(&ASA.&MYS.&INDD)
    PUTFILE OUTDD
    GOTO READLOOP
EXITIT: +
    CLOSFILE INDD
    CLOSFILE OUTDD
    FREE FILE(INDD,OUTDD)
    WRITE &STR(CHECK SDSF HELD/OUTPUT QUEUE)
    EXIT CODE(&MAXCC)
./ ADD NAME=CSPEZE   0107-93078-93090-0901-00208-00207-00000-DB2CSC
/**********************************************************************/
/*   BECAUSE THIS IS COPYRIGHTED MATERIAL, I HAD TO LEAVE THIS OUT.   */
/**********************************************************************/
./ ADD NAME=CSP370   0107-93078-93137-1408-00258-00257-00000-LAWCSC
/**********************************************************************/
/*   BECAUSE THIS IS COPYRIGHTED MATERIAL, I HAD TO LEAVE THIS OUT.   */
/**********************************************************************/
./ ADD NAME=DBPTEST  0102-92227-92227-1142-00017-00144-00000-BORGY
/* REXX PROGRAM NAME: MODLVSAM                                  */
/*                                                              */
/* LIB: XDBS.TSOISPF.CLIST(MODLVSAM)                            */
/* GDE: D.BORGES/ DB2 SYSTEMS GROUP                             */
/* DOC: DEFINE A NEW CLUSTER (OUTDS), MODELING IT AFTER AN      */
/*      ALREADY EXISTING ONE (INDS). THE NEW VSAM CLUSTER       */
/*      WILL ONLY BE ALLOCATED THE SPACE USED, NOT SPACE ALLO-  */
/*      CATED TO ORIGINAL MODEL.                                */
/* NOTE: THIS REXX EXEC IS CURRENTLY SET UP TO BE USED IN       */
/*       BATCH MODE. SAMPLE JCL IN 'XDBS.INSTALL.CNTL(DB2MCHKR)'*/
/*                                                              */
/*                                                              */
   TRACE ON
/*                                                              */
   MYVAR = 'D1DB.DSNDBC.DSNDB06.SYSCOPY.I0001.A001'
   MYVAR2 = OVERLAY('DSNDBD',MYVAR,INDEX(MYVAR,'DSNDBC'))
   SAY MYVAR2
./ ADD NAME=DB2CMD   0102-91317-91342-0955-00027-00027-00000-DMV0016
PROC 3 DB2SID COMMAND OPERAND OP1( ) OP2( ) OP3( ) OP4( ) OP5( )
    CONTROL MSG NOFLUSH MAIN END(ENDO)
    WRITE &STR(DB2CMD - //* )
    WRITE &STR(DB2CMD - //* LIB: DMV0016.CLIST(DB2CMD) )
    WRITE &STR(DB2CMD - //* GDE: OPERATIONS MANUAL)
    WRITE &STR(DB2CMD - //* DOC: INVOKE DB2 AND EXECUTE A COMMAND )
    WRITE &STR(DB2CMD - //* )
    WRITE DB2CMD &STR(-) +
      DSN SYSTEM(&DB2SID)
    SET &DB2TRYS = 0
DB2LOOP: +
    DSN SYSTEM(&DB2SID)
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE DB2 SUBSYSTEM &DB2SID IS NOT ACTIVE.
        SET &MAXCC = 16
        GOTO DISPRC
      ENDO
      SET &MAXCC = 0
      WRITE DB2CMD +
       &COMMAND &OPERAND &OP1 &OP2 &OP3 &OP4 &OP5
     &COMMAND &OPERAND &OP1 &OP2 &OP3 &OP4 &OP5
    END
DISPRC: +
    WRITE DB2CMD &STR(-) HIGHEST RETURN CODE IS &MAXCC
    EXIT CODE(&MAXCC)
./ ADD NAME=DB2PGM   0105-92092-92094-1016-00034-00028-00000-DMV0016
PROC 4 DB2SID PGMID PLANID PARM
/*                                                           */
/* LIB: XDBS.TSOISPF.CLIST(DB2PGM)                           */
/* GDE: KEN TOMIAK                                           */
/* DOC: EXECUTE A USER DB2 PROGRAM UNDER THE REQUESTED       */
/*      DB2 SUBSYSTEM.                                       */
/*                                                           */
    CONTROL MSG NOFLUSH MAIN
    WRITE +
      DSN SYSTEM(&DB2SID)
    ERROR GOTO DISPRC
    DSN SYSTEM(&DB2SID)
      SET &MYCC = &LASTCC
      IF (&MYCC ^= 0) THEN +
        DO
          WRITE DB2 SUBSYSTEM NOT INVOKED
          GOTO DISPRC
        END
      WRITE +
        RUN PROGRAM(&PGMID) PLAN(&PLANID) +
          PARMS('&PARM/')
      RUN PROGRAM(&PGMID) PLAN(&PLANID) +
        PARMS('&PARM/')
    END
DISPRC: +
    ERROR OFF
    SET &MYCC = &MAXCC
    SET &SUBCC = &SUBSTR(1:1,&MYCC )
    WRITE HIGHEST RETURN CODE IS &MYCC
    IF (&SUBCC = &STR(S)) THEN +
      SET &MYCC = 48
    IF (&SUBCC = &STR(U)) THEN +
      SET &MYCC = 36
    EXIT CODE(&MYCC)
./ ADD NAME=DB2PNL   0100-93101-93101-0938-00014-00014-00000-DD20008
PROC 0 PANEL()
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    GETSYSID
BEGIN: +
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)
    ERROR RETURN
    ISPEXEC SELECT &PNL
    EXIT CODE(&MAXCC)
./ ADD NAME=DB2SQL   0104-91341-92349-0855-00028-00017-00000-DD20008
PROC 1 DB2SID
 /*                                                      */
 /* LIB: TECHSERV.SYSPROC(DB2SQL)                        */
 /* GDE: IBM CONVERSION/MIGRATION/IMPLEMENTATION TEAM    */
 /* DOC: INVOKE DYNAMIC BATCH SQL PROGRAM DSNTEP2.       */
 /*                                                      */
BEGIN: +
    CONTROL NOLIST NOMSG END(ENDO) NOFLUSH
    WRITE &STR(DB2SQL  : &SYSDATE &SYSTIME USING DB2 ID=&DB2SID)

    SET &MAXCC = 0
    WRITE DSN SYSTEM(&DB2SID)
    DSN SYSTEM(&DB2SID)
      SET &MYCC = &MAXCC
      IF (&MYCC NE 0) THEN +
        DO
          WRITE &DB2SID IS NOT RESPONDING, TRY LATER
          EXIT CODE(24)
        ENDO
      SET &PLAN = DSNTEP22
      IF (&DB2SID = D2DB) THEN SET &PLAN = DSNTEP2
      WRITE RUN PROGRAM(DSNTEP2) PLAN(&PLAN) -
        LIBRARY('&DB2SID..RUNLIB.LOAD')
      RUN PROGRAM(DSNTEP2) PLAN(&PLAN) -
        LIBRARY('&DB2SID..RUNLIB.LOAD')
    END
    WRITE &STR(DB2SQL  : &SYSDATE &SYSTIME EXITING RC=&MAXCC)
    EXIT CODE(&MAXCC)
./ ADD NAME=DELDBSC1 0109-92204-93330-0938-00141-00127-00141-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(DELDBSC1)                               */
/* GDE: MANUEL PRISCIANDARO AND DAN BORGES                         */
/* DOC: ABOVE TWO INDIVIDUALS CHOSE NOT TO TELL US WHAT THIS DOES  */
/*                                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (TGTSYS DELZNE)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
            SET &JOBCLASS = V
/*                                                                 */
/* SET SKELETON VARIABLE
/*                                                                 */
       SET &CSPSFLAG = N
    IF &SUBSTR(2:4,&STR(&DELZNE )) = CSP THEN SET &CSPSFLAG = Y
    IF &SUBSTR(1:3,&STR(&DELZNE )) = CSP THEN SET &CSPSFLAG = Y
    IF &CSPSFLAG = N THEN +
       SET &SKELE = DBSDSLST
    ELSE +
       SET &SKELE = CSPDSLST
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET ACTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
       ELSE EXIT
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    SET DELFOUND = N
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &DELZNE = &ZNENAME THEN +
        DO
         SET SKELDEL = &HILVL
         SET DELFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN IMPLEMENTATION OF THE &DELZNE +
                           ZONE ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &DELFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(&DELZNE NOT FOUND)
        SET &ZERRLM = &STR(&DELZNE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* CHECKS IF THE CSI DATA SET EXISTS                               */
/*                                                                 */
         %GETVOLID '&SKELDEL..CSI'
         ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELDEL..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*
/*
/* GO TO NEXT PANEL
/*
        ISPEXEC VPUT (TGTSYS DELZNE SKELDEL SKELE JOBCLASS)
        ISPEXEC SELECT PANEL(DELDBSP2)
        EXIT CODE(0)
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    EXIT CODE(&MAXCC)
./ ADD NAME=DELDBSC2 0108-92204-93330-0938-00095-00055-00043-KETCSC
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: CLIST(DELDBSC2)                                            */
/* GDE: D. BORGES AND M. PRISCIANDARO                             */
/* DOC: ABOVE TWO INDIVIDUALS CHOSE NOT TO TELL US WHAT THIS DOES  */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
 ISPEXEC VGET (TGTSYS DELZNE SKELDEL EDITIT SKELE)
/*                                                                 */
/*                                                                 */
/* TAILOR THE JCL                                                  */
/*                                                                 */

BEGDSLST: +
SET RC = 0
    SET &DDCTR = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(&SKELE)') +
    SHR REUSE
  ISPEXEC TBCREATE TABLEDEL +
    NAMES(SUFFIX DELFLAG DDCTR) +
    NOWRITE
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  DO WHILE &RC = 0
    READDVAL DSSUFFIX
    SET SUFFIX = &DSSUFFIX
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELDEL..&SUFFIX')
    SET &DELCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&DELCC EQ 0) THEN SET DELFLAG = Y
      ELSE SET DELFLAG = N
    ISPEXEC TBADD TABLEDEL
    SET &DDCTR = &DDCTR + 1
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
ENDDSLST: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC VPUT (DELZNE) SHARED
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL DELDBSS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC TBEND TABLEDEL
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        EXIT CODE(0)
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
/*                                                                 */
/* WRAP IT UP                                                      */
/*                                                                 */
    EXIT CODE(0)
./ ADD NAME=DELOEMC1 0104-93216-93330-0942-00083-00077-00018-KETCSC
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: CLIST(DELOEMC1)                                            */
/* GDE: M. PRISCIANDARO                                            */
/* DOC: THIS CLIST TAILORS THE JOB TO CLONE A OEM TARGET ZONE      */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(TABLEDS) SHR  DA('&DSNAME.') REUSE
/*                                                                 */
/* BUILD A LIST OF OEM PRODUCTS FROM OEMDSLST                      */
/* THIS LIST IS THEN USED TO DISPLAY AN OEM PANEL SELECTION LIST   */
/*                                                                 */

BEGDSLST: +
SET RC = 0
SET DDCTR = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(OEMDSLST)') +
    SHR REUSE
  ISPEXEC TBCREATE PANELSEL +
    NAMES(CMD PRODUCT) +
    NOWRITE LIBRARY(TABLEDS)
  ISPEXEC TBCREATE TABLEDEL +
    NAMES(PDUCTLST SUFFIX PDUCTCHK DELFLAG DDCTR) +
    WRITE   LIBRARY(TABLEDS)
  SET CMD = &STR( )
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  SET &OPRODUCT = &STR()
  DO WHILE &RC = 0
    READDVAL PRODUCT SUFFIX PDUCTCHK
    SET &PDUCTLST = &PRODUCT
    ISPEXEC TBADD TABLEDEL
    IF &PRODUCT ^= &OPRODUCT THEN +
      DO
         ISPEXEC TBADD PANELSEL
         SET &OPRODUCT = &PRODUCT
      END
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
ENDDSLST: +
    ISPEXEC TBTOP PANELSEL
    ISPEXEC TBDISPL PANELSEL +
        PANEL(DELOEMP1) CURSOR(&CURS) +
        AUTOSEL(NO)
    ISPEXEC VPUT (PRODUCT) SHARED
    ISPEXEC TBTOP TABLEDEL
    ISPEXEC TBSKIP TABLEDEL
    SET MYCC = 0
    DO WHILE &MYCC = 0
      IF &PRODUCT ^= &PDUCTLST THEN +
        DO
           ISPEXEC TBDELETE TABLEDEL
        END
      ISPEXEC TBSKIP TABLEDEL
      SET &MYCC = &LASTCC
    END
    ISPEXEC TBEND PANELSEL
    ISPEXEC TBCLOSE TABLEDEL LIBRARY(TABLEDS)
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC SELECT PANEL(DELOEMP2)
    EXIT CODE(0)
./ ADD NAME=DELOEMC2 0117-93216-93330-0943-00218-00210-00218-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(MIGOEMC2)                               */
/* GDE: MANUEL PRISCIANDARO                                        */
/* DOC: ABOVE INDIVIDUAL CHOSE NOT TO TELL US WHAT THIS DOES       */
/*                                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(TABLEDS) SHR  DA('&DSNAME.') REUSE
    ISPEXEC VGET (TGTSYS DELZNE PRODUCT)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
          IF &TGTSYS = MVSW THEN SET &JOBCLASS = J
            ELSE +
              SET &JOBCLASS = S
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO WRAPUP
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO WRAPUP
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET ACTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
       ELSE EXIT
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    SET DELFOUND = N
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &DELZNE = &ZNENAME THEN +
        DO
          SET SKELDEL = &HILVL
          SET DELFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    ERROR OFF
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN IMPLEMENTATION OF THE &DELZNE +
                           ZONE ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &DELFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(&DELZNE NOT FOUND)
        SET &ZERRLM = &STR(&DELZNE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*
/* CHECK IF SOURCE DATASETS EXIST
/*
    ISPEXEC TBOPEN TABLEDEL WRITE LIBRARY(TABLEDS)
    ISPEXEC TBTOP TABLEDEL
    ISPEXEC TBSKIP TABLEDEL
    SET &ENDTABLE = NO
    DO WHILE &ENDTABLE = NO
       IF &PDUCTCHK = &STR(X) THEN +
          DO
             SET &PDUCTSFX = &SUFFIX
             SET &ENDTABLE = YES
          END
       ELSE +
          DO
             ISPEXEC TBSKIP TABLEDEL
             SET MYCC = &LASTCC
             IF &MYCC = 8 THEN +
                DO
                   SET &ENDTABLE = YES
                   SET &ZERRHM = &STR(*)
                   SET &ZERRALRM = &STR(NO)
                   SET &ZERRSM = &STR(LOADLIB NOT CHECKED)
                   SET &ZERRLM = &STR('&PRODUCT HAS NO LOADLIB X')
                   SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
                   ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
                   ISPEXEC SETMSG MSG(ISRZ002)
                   EXIT CODE(0)
                END
          END
    END
    %GETVOLID '&SKELDEL..&PDUCTSFX'
    ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(SRCE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELDEL..&PDUCTSFX' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/* CHECK WHAT DATASETS ARE PRESENT
    ISPEXEC TBTOP TABLEDEL
    ISPEXEC TBSKIP TABLEDEL
    SET RC = 0
    DO WHILE &RC = 0
       SET SYSOUTTRAP = 500
       LISTCAT ENTRY('&SKELDEL..&SUFFIX')
       SET &SRCCC = &LASTCC
       SET SYSOUTTRAP = 0
       IF (&SRCCC EQ 0) THEN SET DELFLAG = Y
         ELSE SET DELFLAG = N
       ISPEXEC TBPUT TABLEDEL
       ISPEXEC TBSKIP TABLEDEL
       SET &RC = &LASTCC
       IF &RC = 8 THEN +
         DO
           GOTO ENDDSLST
         END
    END
ENDDSLST: +
    IF &DELFOUND = Y THEN +
      DO
        ISPEXEC VPUT (TGTSYS DELZNE SKELDEL JOBCLASS)
        ISPEXEC DISPLAY PANEL(DELOEMP3)
        ISPEXEC VGET (EDITIT)
        ISPEXEC FTOPEN TEMP
        SET &MYCC = &LASTCC
        ISPEXEC FTINCL DELOEMS1
        SET &MYCC = &LASTCC.&MYCC
        ISPEXEC FTCLOSE
        SET &MYCC = &LASTCC.&MYCC
        IF (&MYCC NE 0) THEN +
          DO
            SET &ZERRHM = &STR(*)
            SET &ZERRALRM = &STR(NO)
            SET &ZERRSM = &STR(TAILORING FAILED)
            SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
            SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
            ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
            ISPEXEC SETMSG MSG(ISRZ002)
            ISPEXEC TBCLOSE TABLEDEL LIBRARY(TABLEDS)
            ISPEXEC TBERASE TABLEDEL LIBRARY(TABLEDS)
            EXIT CODE(0)
          END
        ISPEXEC VGET ZTEMPF
/*                                                                 */
/*      EDIT ????????????????????????????????????????              */
/*                                                                 */
        IF (&EDITIT = Y) THEN +
          DO
            ISPEXEC EDIT DATASET('&ZTEMPF')
            GOTO WRAPUP
          END
/*                                                                 */
/*      SUBMIT JCL                                                 */
/*                                                                 */
        ISPEXEC CONTROL DISPLAY SM START(13)
        CONTROL MSG
        SUBMIT '&ZTEMPF' NOHOLD
        CONTROL NOMSG
        ISPEXEC TBCLOSE TABLEDEL LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEDEL LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
WRAPUP: +
    ISPEXEC TBCLOSE TABLEDEL LIBRARY(TABLEDS)
    ISPEXEC TBERASE TABLEDEL LIBRARY(TABLEDS)
    EXIT CODE(&MAXCC)
./ ADD NAME=DELOMGC1 0104-93343-93354-0928-00234-00226-00023-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(DELOMGC1)                               */
/* GDE: MIKE LOVARI AND KEN TOMIAK                                 */
/* DOC: ZONE MAINTENANCE, DELETE A ZONE WHEN YOU NO LONGER WANT IT */
/*                                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
    %GETSYSID
    ISPEXEC VGET (SYSID)
    ISPEXEC DISPLAY PANEL(DELOMGP1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(YOU CANCELLED REQUEST)
        SET &ZERRLM = &STR(COME ON, YOU DID IT)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
            SET &JOBCLASS = S
/*                                                                 */
/* SET SKELETON VARIABLE
/*                                                                 */
    SET &SKELE = OMGDSLST
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(OMEGTABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET ACTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         ERROR OFF
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         GOTO ACTION
        END
       ELSE +
         GOTO ACTION
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    SET DELFOUND = N
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &DELZNE = &ZNENAME THEN +
        DO
         SET SKELDEL = &HILVL
         SET DELFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN IMPLEMENTATION OF THE &DELZNE +
                           ZONE ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &DELFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(&DELZNE NOT FOUND)
        SET &ZERRLM = &STR(&DELZNE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(OMEGTABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* CHECKS IF THE CSI DATA SET EXISTS                               */
/*                                                                 */
         %GETVOLID '&SKELDEL..CSI'
         ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELDEL..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*
/*
/* GO TO NEXT PANEL
/*
        ISPEXEC VPUT (TGTSYS DELZNE SKELDEL SKELE JOBCLASS)
    FREE FILE(SYSDVAL)
    ISPEXEC DISPLAY PANEL(DELOMGP2)
    SET &MYCC = &LASTCC
    ISPEXEC TBEND TABLEDEL
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(YOU CANCELLED REQUEST)
        SET &ZERRLM = &STR(COME ON, YOU DID IT)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
BEGDSLST: +
SET RC = 0
    SET &DDCTR = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(&SKELE)') +
    SHR REUSE
  ISPEXEC TBCREATE TABLEDEL +
    NAMES(SUFFIX DELFLAG DDCTR) +
    NOWRITE
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  DO WHILE &RC = 0
    READDVAL DSSUFFIX
    SET SUFFIX = &DSSUFFIX
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELDEL..&SUFFIX')
    SET &DELCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&DELCC EQ 0) THEN SET DELFLAG = Y
      ELSE SET DELFLAG = N
    ISPEXEC TBADD TABLEDEL
    SET &DDCTR = &DDCTR + 1
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
ENDDSLST: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC VPUT (DELZNE) SHARED
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL DELOMGS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC TBEND TABLEDEL
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        EXIT CODE(0)
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
/*                                                                 */
/* WRAP IT UP                                                      */
/*                                                                 */
    EXIT CODE(0)
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    EXIT CODE(&MAXCC)
./ ADD NAME=DOC      0100-93090-93090-0754-00023-00023-00000-KETCSC
PROC 0
/*                                                                 */
/* LIB: KETCSC.CLIST(ED)                                           */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST INVOKES THE ISPF EDITOR.                        */
/*                                                                 */
    CONTROL NOLIST FLUSH END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    SET &DATASET = XDBS.SOFTWARE.CHANGES
AGAIN: +
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DATASETL = &LENGTH(&DATASET)
        SET &DATASETL = &DATASETL - 1
        SET &DATASETE = &SUBSTR(2:&DATASETL,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    ISPEXEC EDIT DATASET('&DATASETE')
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCARCH  0112-92056-92058-1111-00040-00040-00036-DD20002
PROC 3 BKUPZN  BKUPLV TAPEDSN
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(DOCCLNE)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST DOCUMENTS A BACKUP SCENARIO.                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
/*
    SET &DSN = XDBS.SOFTWARE.CHANGES    /* PDS DOC MEMBERS RESIDE IN
/*
/* NAMES OF MEMBERS TO BE UPDATED WITH INFORMATION
/* SHOULD NOT HAVE ANY PREFIXES SUCH AS A 'T'
/*
    IF &SUBSTR(1:1,&STR(&BKUPZN)) = B THEN +
      DO                            /* STRIP PREFIX OUT OF NAME
        SET ENDOFSTR =  &LENGTH(&BKUPZN)
        SET &MEMBER = &SUBSTR(2:&ENDOFSTR,&STR(&BKUPZN))
      ENDO                          /* END STRIP PREFIX
    ELSE +
      SET &MEMBER = &BKUPZN       /* THE 'TO' ZONE HAD NO PREFIX
/*
    SET &PDSMBR = &STR(&MEMBER)     /* PDSMBR NOW HAS NO PREFIX
/*
    SET &MBRFLAG = OLDMBR
    IF &SYSDSN('&DSN(&PDSMBR)') EQ MEMBER NOT FOUND  THEN +
      SET &MBRFLAG = NEWMBR
/*
    ISPEXEC VPUT (BKUPZN BKUPLV TAPEDSN MBRFLAG) SHARED
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(DOCARCHM)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        WRITE &NRSTR(&PDSDSN)
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCARCHM 0114-92056-93235-1317-00094-00094-00076-KETCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCBKPM)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE CHANGES MEMBER FOR BACKUPS.      */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST ASIS
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (BKUPZN BKUPLV TAPEDSN MBRFLAG)
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/* INITIALIZE &NEWDASH
    SET &NEWDASH = &STR(-------- ------- -------- -----)
    SET &NEWDASH = &STR(&NEWDASH -----------------------------------)
    SET &NEWDASH = &STR(&NEWDASH.-----)
    WRITE &NRSTR(&NEWDASH)
/*
/*
/*  IF MEMBER NEVER EXISTED THEN &MBRFLAG WOULD CONTAIN NEWMEM
/*  IF SO, COPY THE HEADING FORM A MODEL MEMBER
/*
    IF &MBRFLAG = NEWMBR THEN +
       ISREDIT COPY MODEL AFTER .ZFIRST
/*
    ISREDIT F '----- --' FIRST
    SET &MYCC = &LASTCC
    ISREDIT (ROW,COL) = CURSOR
    SET &ROW = &ROW
/*
/*  GET PERSONS LASTNAME ASSOCIATED WITH THIS USERID
/*
    %LNAME &SYSUID
    ISPEXEC VGET (LNAME)
/*
/* FORMULATE LINE 1 OF TEXT AN INSERT ON TOP
    SET &NULNE1 = &SUBSTR(1:8,&SYSUID          )
    SET &NULNE1 = &STR(&LNAME &NULNE1)
    SET &NULNE1 = &STR(&NULNE1.&MM./&DD./&YY )
    SET &NULNE1 = &STR(&NULNE1.&IPLTIM)
    SET &NULNE1 = &STR(&NULNE1 Project: DB2???)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE1)
/*
/* FORMULATE LINE 2 OF TEXT AN INSERT ON TOP
    SET &ROW = &ROW + 1
    SET &NULNE1 = &STR(&NULNE2                               )
    SET &NULNE1 = &STR(&NULNE1 TAPE ARCHIVE OF &BKUPZN WAS CREATED.)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE1)
/* FORMULATE LINE 3 OF TEXT AFTER LINE 1
    SET &ROW = &ROW + 1
    SET &NULNE2 = &STR(&NULNE2                               )
    SET &NULNE2 = &STR(&NULNE2 OUTPUT TAPE DSN = &TAPEDSN..LVL&BKUPLV)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE2'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE2)
/* INSERT A NEW DASH LINE ON TOP
    SET &ROW = &ROW + 1
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWDASH'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWDASH)
    ISREDIT SAVE
    SET &MYCC = &LASTCC
/*
    ISPEXEC  CONTROL SUBTASK CLEAR
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT (DATASET) = DATASET
        SET &MAXCC = 0
        %Z &DATASET
        SET &MYCC = &MAXCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE COMPRESS FAILED, ABORT IPL DOCUMENTOR
            ISREDIT CANCEL
            EXIT CODE(20)
          ENDO
        ISREDIT SAVE
        SET &MYCC = &LASTCC
      ENDO
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    ISREDIT END
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCBKOT  0105-92057-92058-1111-00040-00040-00000-DD20002
PROC 2 FROMZN TOZN
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(DOCCLNE)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST DOCUMENTS A BACKOUT SCENARIO.                   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
/*
    SET &DSN = XDBS.SOFTWARE.CHANGES    /* PDS DOC MEMBERS RESIDE IN
/*
/* NAMES OF MEMBERS TO BE UPDATED WITH INFORMATION
/* SHOULD NOT HAVE ANY PREFIXES SUCH AS A 'T'
/*
    IF &SUBSTR(1:1,&STR(&TOZN)) = T  THEN +
      DO                            /* STRIP PREFIX OUT OF NAME
        SET ENDOFSTR =  &LENGTH(&TOZN)
        SET &MEMBER = &SUBSTR(2:&ENDOFSTR,&STR(&TOZN))
      ENDO                          /* END STRIP PREFIX
    ELSE +
      SET &MEMBER = &TOZN         /* THE 'TO' ZONE HAD NO PREFIX
/*
    SET &PDSMBR = &STR(&MEMBER)     /* PDSMBR NOW HAS NO PREFIX
/*
    SET &MBRFLAG = OLDMBR
    IF &SYSDSN('&DSN(&PDSMBR)') EQ MEMBER NOT FOUND  THEN +
      SET &MBRFLAG = NEWMBR
/*
    ISPEXEC VPUT (FROMZN TOZN MBRFLAG) SHARED
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(DOCBKOTM)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        WRITE &NRSTR(&PDSDSN)
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCBKOTM 0114-92057-93265-1347-00098-00100-00080-KETCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCBKPM)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE CHANGES MEMBER FOR BACKUPS.      */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST ASIS
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (FROMZN TOZN LV MBRFLAG)
    SET &NULNE3 = &STR(                               )
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/* INITIALIZE &NEWDASH
    SET &NEWDASH = &STR(-------- ------- -------- -----)
    SET &NEWDASH = &STR(&NEWDASH -----------------------------------)
    SET &NEWDASH = &STR(&NEWDASH.-----)
    WRITE &NRSTR(&NEWDASH)
/*
/*  IF MEMBER NEVER EXISTED THEN &MBRFLAG WOULD CONTAIN NEWMEM
/*  IF SO, COPY THE HEADING FORM A MODEL MEMBER
/*
    IF &MBRFLAG = NEWMBR THEN +
       ISREDIT COPY MODEL AFTER .ZFIRST
/*
    ISREDIT F '----- --' FIRST
    SET &MYCC = &LASTCC
    ISREDIT (ROW,COL) = CURSOR
    SET &ROW = &ROW
/*
/*  GET PERSONS LASTNAME ASSOCIATED WITH THIS USERID
/*
    %LNAME &SYSUID
    ISPEXEC VGET (LNAME)
/*
/* FORMULATE LINE 1 OF TEXT AN INSERT ON TOP
    SET &NEWLINE1 = &SUBSTR(1:8,&SYSUID        )
    SET &NEWLINE1 = &STR(&LNAME &NEWLINE1)
    SET &NEWLINE1 = &STR(&NEWLINE1.&MM./&DD./&YY )
    SET &NEWLINE1 = &STR(&NEWLINE1.&IPLTIM)
    SET &NEWLINE1 = &STR(&NEWLINE1 Project: DB2???)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE1)
/*
/* FORMULATE LINE 2 OF TEXT AN INSERT ON TOP
    SET &ROW = &ROW + 1
    SET &NEWLINE1 = &STR(&NULNE3 THE &TOZN ZONE HAS BEEN RESTORED FROM)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE1)
/* FORMULATE LINE 3 OF TEXT AFTER LINE 1
    SET &ROW = &ROW + 1
    SET &NEWLINE2 = &STR(&NULNE3 IT'S BACKUP, &FROMZN.. REFER TO THE)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE2'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE2)
/* FORMULATE LINE 4 OF TEXT AFTER LINE 2
    SET &ROW = &ROW + 1
    SET &NULNE3 = &STR(&NULNE3 LVL TRCKING BOARD TO VERIFY LVL BACKOUT)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE3'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE3)
/* INSERT A NEW DASH LINE ON TOP
    SET &ROW = &ROW + 1
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWDASH'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWDASH)
    ISREDIT SAVE
    SET &MYCC = &LASTCC
/*
    ISPEXEC  CONTROL SUBTASK CLEAR
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT (DATASET) = DATASET
        SET &MAXCC = 0
        %Z &DATASET
        SET &MYCC = &MAXCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE COMPRESS FAILED, ABORT IPL DOCUMENTOR
            ISREDIT CANCEL
            EXIT CODE(20)
          ENDO
        ISREDIT SAVE
        SET &MYCC = &LASTCC
      ENDO
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    ISREDIT END
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCCLNE  0117-92057-93330-1418-00040-00040-00000-KETCSC
PROC 3 FROMZN   TOZN PRODUCT
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(DOCCLNE)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST DOCUMENTS A PROPAGATION SCENARIO                */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
/*
    SET &DSN = XDBS.SOFTWARE.CHANGES   /* PDS DOC MEMBERS RESIDE IN
/*
/* NAMES OF MEMBERS TO BE UPDATED WITH INFORMATION
/* SHOULD NOT HAVE ANY PREFIXES SUCH AS A 'T'
/*
    IF &SUBSTR(1:1,&STR(&TOZN)) = T  THEN +
      DO                            /* STRIP PREFIX OUT OF NAME
        SET ENDOFSTR =  &LENGTH(&TOZN)
        SET &MEMBER = &SUBSTR(2:&ENDOFSTR,&STR(&TOZN))
      ENDO                          /* END STRIP PREFIX
    ELSE +
      SET &MEMBER = &TOZN         /* THE 'TO' ZONE HAD NO PREFIX
/*
    SET &PDSMBR = &STR(&MEMBER)     /* PDSMBR NOW HAS NO PREFIX
/*
    SET &MBRFLAG = OLDMBR
    IF &SYSDSN('&DSN(&PDSMBR)') EQ MEMBER NOT FOUND  THEN +
      SET &MBRFLAG = NEWMBR
/*
    ISPEXEC VPUT (FROMZN TOZN MBRFLAG PRODUCT) SHARED
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(DOCCLNEM)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        WRITE &NRSTR(&PDSDSN)
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCCLNEM 0128-92057-94028-1923-00085-00100-00084-DD20001
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCBKPM)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE CHANGES MEMBER FOR CLONING.      */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST ASIS
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (FROMZN TOZN MBRFLAG PRODUCT)
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    %LVLNOEM &FROMZN
    ISPEXEC VGET (LV4NTRY)
    SET &FLV = &LV4NTRY
/*
/*    ISREDIT EDIT &PDSMBR
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/* INITIALIZE &NEWDASH
    SET &NEWDASH = &STR(-------- ------- -------- -----)
    SET &NEWDASH = &STR(&NEWDASH -----------------------------------)
    SET &NEWDASH = &STR(&NEWDASH.-----)
    WRITE &NRSTR(&NEWDASH)
/*
/*  IF MEMBER NEVER EXISTED THEN &MBRFLAG WOULD CONTAIN NEWMEM
/*  IF SO, COPY THE HEADING FROM A MODEL MEMBER
/*
    IF &MBRFLAG = NEWMBR THEN +
       ISREDIT COPY MODEL AFTER .ZFIRST
/*
    ISREDIT F '----- --' FIRST
    SET &MYCC = &LASTCC
    ISREDIT (ROW,COL) = CURSOR
    SET &ROW = &ROW
/*
/*  GET PERSONS LASTNAME ASSOCIATED WITH THIS USERID
/*
    %LNAME &SYSUID
    ISPEXEC VGET (LNAME)
/*
/* FORMULATE LINE 1 OF TEXT AFTER LINE 1
    SET &NEWLINE1 = &SUBSTR(1:8,&SYSUID        )
    SET &NEWLINE1 = &STR(&LNAME &NEWLINE1)
    SET &NEWLINE1 = &STR(&NEWLINE1.&MM./&DD./&YY )
    SET &NEWLINE1 = &STR(&NEWLINE1.&IPLTIM)
    SET &NEWLINE1 = &STR(&NEWLINE1 Project: DB2???)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE1)
/* FORMULATE LINE 2 OF TEXT AFTER LINE 1
    SET &ROW = &ROW + 1
    SET &NEWLINE1 = &STR(&NEWLINE2                               )
    SET &NEWLINE1 = &STR(&NEWLINE1 product: &PRODUCT)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE1)
/* FORMULATE LINE 3 OF TEXT AFTER LINE 1
    SET &ROW = &ROW + 1
    SET &NEWLINE1 = &STR(&NEWLINE2                               )
    SET &NEWLINE1 = &STR(&NEWLINE1 &TOZN., WAS CLONED FROM A LEVEL &FLV)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE1)
/* FORMULATE LINE 4 OF TEXT AFTER LINE 1
    SET &ROW = &ROW + 1
    SET &NEWLINE2 = &STR(&NEWLINE2                               )
    SET &NEWLINE2 = &STR(&NEWLINE2 &FROMZN ZONE VIA IMPLEMENTATION)
    SET &NEWLINE2 = &STR(&NEWLINE2 DIALOG)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE2'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE2)
/* INSERT A NEW DASH LINE ON TOP
    SET &ROW = &ROW + 1
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWDASH'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWDASH)
    ISREDIT END
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCIMP   0108-92057-92058-1112-00041-00041-00000-DD20002
PROC 4 FROMZN TOZN TGTHILV ACTHILV
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(DOCCLNE)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST DOCUMENTS AN IMPLEMENTAION SCENARIO             */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
/*
/*
    SET &DSN = XDBS.SOFTWARE.CHANGES   /* PDS DOC MEMBERS RESIDE IN
/*
/* NAMES OF MEMBERS TO BE UPDATED WITH INFORMATION
/* SHOULD NOT HAVE ANY PREFIXES SUCH AS A 'T'
/*
    IF &SUBSTR(1:1,&STR(&TOZN)) = T  THEN +
      DO                            /* STRIP PREFIX OUT OF NAME
        SET ENDOFSTR =  &LENGTH(&TOZN)
        SET &MEMBER = &SUBSTR(2:&ENDOFSTR,&STR(&TOZN))
      ENDO                          /* END STRIP PREFIX
    ELSE +
      SET &MEMBER = &TOZN         /* THE 'TO' ZONE HAD NO PREFIX
/*
    SET &PDSMBR = &STR(&MEMBER)     /* PDSMBR NOW HAS NO PREFIX
/*
    SET &MBRFLAG = OLDMBR
    IF &SYSDSN('&DSN(&PDSMBR)') EQ MEMBER NOT FOUND  THEN +
      SET &MBRFLAG = NEWMBR
/*
    ISPEXEC VPUT (FROMZN TOZN ACTHILV TGTHILV MBRFLAG) SHARED
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(DOCIMPM)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        WRITE &NRSTR(&PDSDSN)
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCIMPM  0113-92057-93250-1158-00111-00106-00093-KETCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XDBS.TSOISPF.CLIST(DOCIMPM)                                  */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE CHANGES MEMBER FOR IMPLEMENTATIN */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST ASIS
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (FROMZN TOZN ACTHILV TGTHILV MBRFLAG)
/*
    WRITE '************' &FROMZN &TOZN &LV
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/* INITIALIZE &NEWDASH
    SET &NEWDASH = &STR(-------- ------- -------- -----)
    SET &NEWDASH = &STR(&NEWDASH -----------------------------------)
    SET &NEWDASH = &STR(&NEWDASH.-----)
    WRITE &NRSTR(&NEWDASH)
/*
/*  IF MEMBER NEVER EXISTED THEN &MBRFLAG WOULD CONTAIN NEWMEM
/*  IF SO, COPY THE HEADING FORM A MODEL MEMBER
/*
    IF &MBRFLAG = NEWMBR THEN +
       ISREDIT COPY MODEL AFTER .ZFIRST
/*
    ISREDIT F '----- --' FIRST
    SET &MYCC = &LASTCC
    ISREDIT (ROW,COL) = CURSOR
    SET &ROW = &ROW
/*
/*
/*  GET PERSONS LASTNAME ASSOCIATED WITH THIS USERID
/*
    %LNAME &SYSUID
    ISPEXEC VGET (LNAME)
/*
/* FORMULATE LINE 1 OF TEXT AFTER LINE 1
    SET &NULNE1 = &SUBSTR(1:8,&SYSUID          )
    SET &NULNE1 = &STR(&LNAME &NULNE1)
    SET &NULNE1 = &STR(&NULNE1.&MM./&DD./&YY )
    SET &NULNE1 = &STR(&NULNE1.&IPLTIM)
    SET &NULNE1 = &STR(&NULNE1 Project: DB2???)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE1)
/* FORMULATE LINE 2 OF TEXT AFTER LINE 1
    SET &ROW = &ROW + 1
    SET &NULNE1 = &STR(&NULNE2                               )
    SET &NULNE1 = &STR(&NULNE1 CHREQ# 00000)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE1)
/* FORMULATE LINE 3 OF TEXT AFTER LINE 1
    SET &ROW = &ROW + 1
    SET &NULNE1 = &STR(&NULNE2                               )
    SET &NULNE1 = &STR(&NULNE1 SOFTWARE WAS IMPLEMENTED FROM THE TARGET)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE1)
/* FORMULATE LINE 4 OF TEXT AFTER LINE 1
    SET &ROW = &ROW + 1
    SET &NULNE2 = &STR(&NULNE2                               )
    SET &NULNE2 = &STR(&NULNE2 ZONE &FROMZN, &TGTHILV..*, TO THE       )
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE2'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE2)
/* FORMULATE LINE 5 OF TEXT AFTER LINE 2
    SET &ROW = &ROW + 1
    SET &NULNE3 = &STR(&NULNE3                               )
    SET &NULNE3 = &STR(&NULNE3 ACTIVE ZONE &TOZN, &ACTHILV..* )
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE3'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE3)
/* INSERT A NEW DASH LINE ON TOP
    SET &ROW = &ROW + 1
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWDASH'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWDASH)
/*  ISREDIT SAVE
    ISREDIT END
EXIT
    SET &MYCC = &LASTCC
/*
    ISPEXEC  CONTROL SUBTASK CLEAR
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT (DATASET) = DATASET
        SET &MAXCC = 0
        %Z &DATASET
        SET &MYCC = &MAXCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE COMPRESS FAILED, ABORT IPL DOCUMENTOR
            ISREDIT CANCEL
            EXIT CODE(20)
          ENDO
        ISREDIT SAVE
        SET &MYCC = &LASTCC
      ENDO
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    ISREDIT END
    EXIT CODE(&MAXCC)
./ ADD NAME=DOCLVLM  0103-92021-92021-1152-00053-00059-00000-DMV0016
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCLVLM)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE CHANGES MEMBER FOR CLONES.       */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (OTRES LV)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
    SET &MAXLEN = 8 - &LENGTH(&STR(&LV))
    SET &LV = &SUBSTR(1:&MAXLEN,&STR(         ))&LV
    SET &NEWLINE = &STR(      &OTRES &LV  &SYSDATE &IPLTIM)
    ISREDIT F '&OTRES' FIRST
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT LINE_AFTER .ZLAST = DATALINE '&NEWLINE'
      ENDO
    ELSE +
      DO
        ISREDIT (ROW,COL) = CURSOR
        SET &ROW = &ROW
        ISREDIT LINE &ROW = '&NEWLINE'
      ENDO
    ISREDIT SORT
    ISREDIT SAVE
    SET &MYCC = &LASTCC
    ISPEXEC  CONTROL SUBTASK CLEAR
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT (DATASET) = DATASET
        SET &MAXCC = 0
        %Z &DATASET
        SET &MYCC = &MAXCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE COMPRESS FAILED, ABORT IPL DOCUMENTOR
            ISREDIT CANCEL
            EXIT CODE(20)
          ENDO
        ISREDIT SAVE
        SET &MYCC = &LASTCC
      ENDO
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    ISREDIT END
    EXIT CODE(&MAXCC)
./ ADD NAME=DSQPRINT 0109-91151-93164-1235-00014-00004-00000-KETCSC
PROC 2 SYSOUTCLASS SYSOUTDEST
/*                                                                 */
/* LIB: KETCSC.CLIST(DSQPRINT)                                     */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST RE-ALLOCATES DSQPRINT                           */
/*                                                                 */
BEGIN: +
    CONTROL NOLIST NOFLUSH NOMSG END(ENDO)
    FREE FILE(DSQPRINT)
    CONTROL MSG
    ALLOC FI(DSQPRINT) NEW SYSOUT(&SYSOUTCLASS) +
        DEST(&SYSOUTDEST)                       +
        LRECL(133) BLKSIZE(1330) RECFM(F B A)
    CONTROL NOMSG
./ ADD NAME=DS34     0101-92087-92087-0941-00015-00015-00000-DMV0016
PROC 1 KETPFX
/*                                                                 */
/* LIB: CLIST(DS34)                                                */
/* GDE: IBM CONVERSION/MIGRATION/IMPLEMENTATION TEAM.              */
/* DOC: THIS CLIST INVOKES 3.4 WITH A PREFIX SET.                  */
/*                                                                 */
    CONTROL NOLIST FLUSH END(ENDO)
/*  CONTROL LIST CONLIST SYMLIST MSG
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC LIBDEF ISPPLIB DATASET ID(PANELS)
    SET &KETDR = BYPASS
    ISPEXEC VPUT (KETDR KETPFX) SHARED
AGAIN: +
    ISPEXEC SELECT PGM(ISRUDL) PARM(DB2UDLP)
    EXIT CODE(&LASTCC)
./ ADD NAME=DUPES    0100-92264-92264-1623-00051-00051-00000-KETCSC
ISREDIT MACRO
/*                                                                 */
/* LIB: CLIST(DUPES)                                               */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS MACRO EXCLUDES DUPLICATE LINES.                       */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (TOPLINE,COL) = CURSOR
    ISREDIT CURSOR = .ZLAST &COL
    ISREDIT (LASTLINE,COL) = CURSOR
    SET &DUP = 0
    SET &CTR = 1
    DO WHILE &CTR < &LASTLINE
      ISREDIT (LINEA) = LINE &CTR
      SET &COMPA = &SUBSTR(1:72,&STR(&LINEA))
      SET &CTR = &CTR + 1
      IF (&CTR > 9) THEN +
        CONTROL NOLIST NOMSG NOCONLIST NOSYMLIST
      ISREDIT (LINEB) = LINE &CTR
      SET &COMPB = &SUBSTR(1:72,&STR(&LINEB))
      IF (&NRSTR(&COMPA) = &NRSTR(&COMPB)) THEN +
        DO
          SET &DUP = &DUP + 1
          ISREDIT X "&COMPB" FIRST
          SET &MYCC = &LASTCC
        ENDO
    ENDO
/*                                                                 */
    IF (&DUP = 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(NO DUPES)
        SET &ZERRLM = &STR(OKAY, YOU ARE THE DUPE)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&DUP DUPES)
        SET &ZERRLM = &STR(THERE ARE &DUP DUPES)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
      ENDO
/*                                                                 */
    ISREDIT CURSOR = &TOPLINE 1
    EXIT CODE(1)
./ ADD NAME=ED       0100-91148-91148-1156-00024-00024-00000-DMV0016
PROC 1 DATASET MAC()
/*                                                                 */
/* LIB: TECHSERV.SYSPROC(ED)                                       */
/* GDE: IBM CONVERSION/MIGRATION/IMPLEMENTATION TEAM.              */
/* DOC: THIS CLIST INVOKES THE ISPF EDITOR.                        */
/*                                                                 */
    CONTROL NOLIST FLUSH END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
AGAIN: +
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DATASETL = &LENGTH(&DATASET)
        SET &DATASETL = &DATASETL - 1
        SET &DATASETE = &SUBSTR(2:&DATASETL,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    SET &MACRO = &STR()
    IF (&NRSTR(&MAC) NE ) THEN SET &MACRO = &NRSTR(MACRO(&MAC))
    ISPEXEC EDIT DATASET('&DATASETE') &MACRO
    EXIT CODE(&MAXCC)
./ ADD NAME=ELACUSER 0100-93078-93078-1157-00244-00244-00000-LAWCSC
/**********************************************************************/
/*   BECAUSE THIS IS COPYRIGHTED MATERIAL, I HAD TO LEAVE THIS OUT.   */
/**********************************************************************/
./ ADD NAME=ELACUSR2
/**********************************************************************/
/*   BECAUSE THIS IS COPYRIGHTED MATERIAL, I HAD TO LEAVE THIS OUT.   */
/**********************************************************************/
./ ADD NAME=FMMSTRIP 0100-93364-93364-1357-00010-00010-00000-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT X ' ' ALL
    ISREDIT F 'DSNU050I' ALL
    ISREDIT F 'NUMBER OF PAGES' ALL
    ISREDIT F 'ELAPSED TIME' ALL
    ISREDIT END
    EXIT CODE(0)
./ ADD NAME=GETSYSID 0103-91226-94026-1718-00047-00113-00000-DMV0016
/*---------REXX GETSYSID -------------------------------*/
/*                                                      */
/* LIB: KETCSC.CLIST(GETSYSID)          */
/* GDE: KETCSC                                */
/* DOC: THIS REXX EXEC ......                           */
/*                                                      */
/*---------REXX GETSYSID -------------------------------*/
PARSE ARG 0
/*-------------------------------------------------------------------*/
/*                                                                   */
/* LIB: TECHSERV.SYS (GETSYSID)                                      */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS CLIST GETS THE SYSTEM ID, IPL VOLUME, DATE AND TIME.    */
/*                                                                   */
/*-------------------------------------------------------------------*/
PTR2CVT = STORAGE(10,4)
PTR2SMF = STORAGE(D2X(C2D(PTR2CVT)+197),3)
SYSID = STORAGE(D2X(C2D(PTR2SMF)+16),4)
ADDRESS ISPEXEC "VPUT (SYSID) SHARED"
    TSOPROC = SYSVAR(SYSPROC)
    ADDRESS ISPEXEC "VPUT (TSOPROC) PROFILE"
SYSUID = SYSVAR(SYSUID)
/* ****************************************************************** */
/* GET RACF INFORMATION.                                              */
/* ****************************************************************** */
    X = OUTTRAP('NAME.')
    "LISTUSER" SYSUID
    X = OUTTRAP('OFF')

/******************************************************************/
/* LOOP THROUGH TRAPPED OUTPUT AND FIND THE NAME+ LINE.           */
/******************************************************************/
    DO I = 1 TO 2 BY 1
      LOC = INDEX(NAME.I,'NAME=')
      IF LOC > 0 THEN,
        DO
          IF (I = 1) THEN,
            THISNME = SUBSTR(NAME.I,LOC+5,20)
        END
      ELSE
        NOP
    END
SETPGMR:
    PGMR = THISNME
NOPGMR:
    ADDRESS ISPEXEC "VPUT (PGMR)"
    EXIT 0
./ ADD NAME=GETSYSIO 0100-93245-93245-1723-00113-00113-00000-KETCSC
PROC 0
/*********************************************************************/
/*                                                                   */
/* LIB: TECHSERV.SYSPROC(GETSYSID)                                   */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS CLIST GETS THE SYSTEM ID, IPL VOLUME, DATE AND TIME.    */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG MAIN END(ENDO)
    GETSYSID
    SET &TSOPROC = &SYSPROC
    ISPEXEC VPUT (TSOPROC) PROFILE
    ISPEXEC VPUT (SYSID)
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
    SET &B = 9
    SET &E = 29
    SET &LEN = &LENGTH(&NRSTR(&SYSOUTLINE1))
    IF (&LEN < 8) THEN +
      DO
        SET &PGMR = &STR(NOT A RACF USER)
        GOTO NOPGMR
      ENDO
    SET &EQUAL = &SUBSTR(8:8,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 9
        SET &E = 29
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(9:9,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 10
        SET &E = 30
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(10:10,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 11
        SET &E = 31
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(11:11,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 12
        SET &E = 32
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(12:12,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 13
        SET &E = 33
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(13:13,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 14
        SET &E = 34
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(14:14,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 15
        SET &E = 35
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(15:15,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 16
        SET &E = 36
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(16:16,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 17
        SET &E = 37
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(17:17,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 18
        SET &E = 38
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(18:18,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 19
        SET &E = 39
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(19:19,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 20
        SET &E = 40
        GOTO SETPGMR
      ENDO
SETPGMR: +
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
NOPGMR: +
    ISPEXEC VPUT (PGMR)
    EXIT CODE(0)
./ ADD NAME=GETVOLID 0152-92003-92008-1242-00041-00886-00000-DD20002
PROC 1 CSINAME
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(GETVOLID)
/* GDE: D. BORGES                                                  */
/* DOC: THIS CLIST RETURNS THE VOLID FOR VSAM DATA SETS THAT       */
/*      RESIDE ON A SINGLE VOLUME                                  */

    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG
/*  CONTROL CONLIST LIST SYMLIST  MSG END(ENDO)
/*
    IF &SYSDSN('&SYSUID..TEMP.LISTCAT')=OK THEN +
       DELETE '&SYSUID..TEMP.LISTCAT'
    ISPEXEC  VERASE  VOLID  ASIS
/*
    FREE FILE(LCOUT)
    ALLOC FILE(LCOUT) DATASET('&SYSUID..TEMP.LISTCAT') +
          BLKSIZE(3990) LRECL(133) RECFM(V B)               +
          NEW CATALOG UNIT(SYSALLDA) SPACE(1 1) TRACKS REUSE
/*
    SET &SYSOUTTRAP = 100
    LISTCAT ENTRY(&CSINAME) VOL +
      OUTFILE(LCOUT)
    SET &MYCC = &LASTCC
    SET &SYSOUTTRAP = 0
/*
    IF (&MYCC EQ 0) THEN +
      DO
       ISPEXEC EDIT DATASET('&SYSUID..TEMP.LISTCAT') MACRO (GETVOMAC)
       ISPEXEC VGET (VOLID)
       SET &VOLID = &SUBSTR(9:14,&STR(&VOLID))
       ISPEXEC VPUT (VOLID)
      ENDO
    ELSE +
      DO
       SET &VOLID = NOCSI
       ISPEXEC VPUT (VOLID)
      ENDO
/*
    FREE FILE(LCOUT)
    DELETE '&SYSUID..TEMP.LISTCAT'
    EXIT CODE(0)
./ ADD NAME=GETVOMAC 0111-92003-93245-1448-00006-00027-00000-DD20008
ISREDIT MACRO
  ISREDIT CHANGE 'VOLSER------------' ''
  ISREDIT (VOLID) = LINE .ZCSR
  ISPEXEC VPUT (VOLID)
  ISREDIT CANCEL
  EXIT CODE(0)
./ ADD NAME=GTSYSID  0101-92101-92167-0833-00274-00269-00274-DMV0016
PROC 0
/*********************************************************************/
/*                                                                   */
/* LIB: CLIST(GTSYSID)                                               */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS CLIST GETS THE SYSTEM ID, IPL VOLUME, DATE AND TIME.    */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG MAIN END(ENDO)
    GETSYSID
    LASTIPL
    LISTDSI 'SYS1.LINKLIB'
    SET &IPLVOL = &SYSVOLUME
    SET &TSOPROC = &SYSPROC
    ISPEXEC VPUT (SYSID IPLTIME IPLVOL TSOPROC)
/*********************************************************************/
/* BUILD TABLE OF DESCRIPTIVE DAY                                    */
/*********************************************************************/
    SET &DAY  = &&DAY
    SET &DAY1 = MONDAY
    SET &DAY  = &&DAY
    SET &DAY2 = TUESDAY
    SET &DAY  = &&DAY
    SET &DAY3 = WEDNESDAY
    SET &DAY  = &&DAY
    SET &DAY4 = THURSDAY
    SET &DAY  = &&DAY
    SET &DAY5 = FRIDAY
    SET &DAY  = &&DAY
    SET &DAY6 = SATURDAY
    SET &DAY  = &&DAY
    SET &DAY7 = SUNDAY
/*********************************************************************/
/* CONVERT TODAYS DATE TO DESCRIPTIVE DAY                            */
/*********************************************************************/
    SET &GREG_YEAR  = &SUBSTR(7:8,&STR(&SYSDATE))
    SET &GREG_MONTH = &SUBSTR(1:2,&STR(&SYSDATE))
    SET &GREG_DAY   = &SUBSTR(4:5,&STR(&SYSDATE))
    SET &JULI_DAY   = &SUBSTR(4:6,&STR(&SYSJDATE))
    SET &LAST_YEAR = &GREG_YEAR - 1
    SET &WS_DAYS = 1461 * &LAST_YEAR
    SET &WS_DAYS = &WS_DAYS / 4
    SET &WS_DAYS = &WS_DAYS + &JULI_DAY
    SET &WS_WEEK = &WS_DAYS / 7
    SET &DAY_OF_WEEK = &WS_DAYS - (7 * &WS_WEEK) + 1
    SET &TODAY = &DAY&DAY_OF_WEEK
/*********************************************************************/
/* CONVERT IPL DATE TO GREGORIAN AND DESCRIPTIVE DAY                 */
/*********************************************************************/
    SET &IPLJDTE    = &SUBSTR(2:7,&STR(&IPLDATE))
    SET &GREG_YEAR  = &SUBSTR(1:2,&STR(&IPLJDTE))
    SET &TEMP_DAY   = &SUBSTR(4:6,&STR(&IPLJDTE))
    SET &JULI_DAY   = &SUBSTR(4:6,&STR(&IPLJDTE))
/*********************************************************************/
/* JANUARY                                                           */
/*********************************************************************/
    SET &GREG_MONTH = &STR(01)
/*********************************************************************/
/* FEBRUARY                                                          */
/*********************************************************************/
    IF (&TEMP_DAY GT 31) THEN +
      DO
        SET &GREG_MONTH = &STR(02)
        SET &TEMP_DAY = &TEMP_DAY - 31
      ENDO
/*********************************************************************/
/* MARCH LEAP YEAR                                                   */
/*********************************************************************/
    IF ((&GREG_YEAR EQ 92)  OR   +
        (&GREG_YEAR EQ 96)) THEN +
      DO
        IF (&TEMP_DAY GT 29) THEN +
          DO
            SET &GREG_MONTH = &STR(03)
            SET &TEMP_DAY = &TEMP_DAY - 29
          ENDO
      ENDO
    ELSE +
      DO
/*********************************************************************/
/* MARCH                                                             */
/*********************************************************************/
        IF (&TEMP_DAY GT 28) THEN +
          DO
            SET &GREG_MONTH = &STR(03)
            SET &TEMP_DAY = &TEMP_DAY - 28
          ENDO
        ENDO
/*********************************************************************/
/* APRIL                                                             */
/*********************************************************************/
    IF (&TEMP_DAY GT 31) THEN +
      DO
        SET &GREG_MONTH = &STR(04)
        SET &TEMP_DAY = &TEMP_DAY - 31
      ENDO
/*********************************************************************/
/* MAY                                                               */
/*********************************************************************/
    IF (&TEMP_DAY GT 30) THEN +
      DO
        SET &GREG_MONTH = &STR(05)
        SET &TEMP_DAY = &TEMP_DAY - 30
      ENDO
/*********************************************************************/
/* JUNE                                                              */
/*********************************************************************/
    IF (&TEMP_DAY GT 31) THEN +
      DO
        SET &GREG_MONTH = &STR(06)
        SET &TEMP_DAY = &TEMP_DAY - 31
      ENDO
/*********************************************************************/
/* JULY                                                              */
/*********************************************************************/
    IF (&TEMP_DAY GT 30) THEN +
      DO
        SET &GREG_MONTH = &STR(07)
        SET &TEMP_DAY = &TEMP_DAY - 30
      ENDO
/*********************************************************************/
/* AUGUST                                                            */
/*********************************************************************/
    IF (&TEMP_DAY GT 31) THEN +
      DO
        SET &GREG_MONTH = &STR(08)
        SET &TEMP_DAY = &TEMP_DAY - 31
      ENDO
/*********************************************************************/
/* SEPTEMBER                                                         */
/*********************************************************************/
    IF (&TEMP_DAY GT 31) THEN +
      DO
        SET &GREG_MONTH = &STR(09)
        SET &TEMP_DAY = &TEMP_DAY - 31
      ENDO
/*********************************************************************/
/* OCTOBER                                                           */
/*********************************************************************/
    IF (&TEMP_DAY GT 30) THEN +
      DO
        SET &GREG_MONTH = &STR(10)
        SET &TEMP_DAY = &TEMP_DAY - 30
      ENDO
/*********************************************************************/
/* NOVEMBER                                                          */
/*********************************************************************/
    IF (&TEMP_DAY GT 30) THEN +
      DO
        SET &GREG_MONTH = &STR(11)
        SET &TEMP_DAY = &TEMP_DAY - 30
      ENDO
/*********************************************************************/
/* DECEMBER                                                          */
/*********************************************************************/
    IF (&TEMP_DAY GT 31) THEN +
      DO
        SET &GREG_MONTH = &STR(12)
        SET &TEMP_DAY = &TEMP_DAY - 31
      ENDO
/*********************************************************************/
/* STRING INTO ISPF GREGORIAN DATE FORMAT                            */
/*********************************************************************/
    SET &GREG_DAY = &TEMP_DAY
    SET &IPLDATE = &STR(&GREG_YEAR)&STR(/)
    SET &IPLDATE = &STR(&IPLDATE)&STR(&GREG_MONTH)&STR(/)
    IF (&GREG_DAY LT 10) THEN +
      SET &IPLDATE = &STR(&IPLDATE)&STR(0)&STR(&GREG_DAY)
    ELSE +
      SET &IPLDATE = &STR(&IPLDATE)&STR(&GREG_DAY)
    SET &LAST_YEAR = &GREG_YEAR - 1
    SET &WS_DAYS = 1461 * &LAST_YEAR
    SET &WS_DAYS = &WS_DAYS / 4
    SET &WS_DAYS = &WS_DAYS + &JULI_DAY
    SET &WS_WEEK = &WS_DAYS / 7
    SET &DAY_OF_WEEK = &WS_DAYS - (7 * &WS_WEEK) + 1
    SET &IPLDAY = &DAY&DAY_OF_WEEK
    ISPEXEC VPUT (TODAY IPLDAY IPLDATE IPLJDTE)
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
    SET &B = 9
    SET &E = 29
    SET &EQUAL = &SUBSTR(8:8,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 9
        SET &E = 29
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(9:9,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 10
        SET &E = 30
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(10:10,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 11
        SET &E = 31
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(11:11,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 12
        SET &E = 32
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(12:12,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 13
        SET &E = 33
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(13:13,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 14
        SET &E = 34
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(14:14,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 15
        SET &E = 35
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(15:15,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 16
        SET &E = 36
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(16:16,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 17
        SET &E = 37
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(17:17,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 18
        SET &E = 38
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(18:18,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 19
        SET &E = 39
        GOTO SETPGMR
      ENDO
    SET &EQUAL = &SUBSTR(19:19,&NRSTR(&SYSOUTLINE1))
    IF (&STR(&EQUAL) EQ &STR(=)) THEN +
      DO
        SET &B = 20
        SET &E = 40
        GOTO SETPGMR
      ENDO
SETPGMR: +
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    SET &PGMR = &PGMR
    SET &MENUGRP = TECH
    ISPEXEC VPUT (MENUGRP) PROFILE
    ISPEXEC VPUT (PGMR)
    EXIT CODE(0)
./ ADD NAME=IMAGJOB  0101-91341-92349-0859-00024-00025-00000-DD20008
PROC 4 DB2SID PGMID PLANID PARM
    CONTROL MSG NOFLUSH MAIN
    WRITE +
      DSN SYSTEM(&DB2SID)
    ERROR GOTO DISPRC
    DSN SYSTEM(&DB2SID)
      SET &MYCC = &LASTCC
      IF (&MYCC ^= 0) THEN +
        DO
          WRITE DB2 SUBSYSTEM NOT INVOKED
          GOTO DISPRC
        END
      WRITE +
        RUN PROGRAM(&PGMID) PLAN(&PLANID) +
          LIBRARY('&DB2SID..DYNBKUP.LOADLIB') +
          PARMS('&PARM/')
      RUN PROGRAM(&PGMID) PLAN(&PLANID) +
        LIBRARY('&DB2SID..DYNBKUP.LOADLIB') +
        PARMS('&PARM/')
    END
DISPRC: +
    ERROR OFF
    WRITE HIGHEST RETURN CODE IS &MAXCC
    EXIT CODE(&MAXCC)
./ ADD NAME=IMPDBSC1 0114-92192-93330-0944-00195-00184-00195-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(IMPDBSC1)                               */
/* GDE: MANUEL PRISCIANDARO AND DAN BORGES                         */
/* DOC: ABOVE TWO INDIVIDUALS DID NOT FEEL THEY SHOULD LET         */
/*      ANY PARTICULAR PERSON KNOW WHAT THIS DOES.                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (TGTSYS ACTZNE LV)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
            SET &JOBCLASS = S
/*                                                                 */
/* DB2 OR CSP SKELETON?                                            */
/*                                                                 */
    SET &CSPSFLAG = N
    IF &SUBSTR(1:3,&STR(&ACTZNE)) = CSP THEN SET &CSPSFLAG = Y
    IF &SUBSTR(2:4,&STR(&ACTZNE    )) = CSP THEN SET &CSPSFLAG = Y
    IF &CSPSFLAG = N THEN +
       SET &SKELE = DBSDSLST
    ELSE +
       SET &SKELE = CSPDSLST
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET ACTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
       ELSE EXIT
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &ACTZNE = &ZNENAME THEN +
        DO
         SET SKELACT = &HILVL
         SET ACTFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN IMPLEMENTATION OF THE &ACTZNE +
                           ZONE ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &ACTFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(&ACTZNE NOT FOUND)
        SET &ZERRLM = &STR(&ACTZNE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* CREATE TARGET AND BACKUP ZONE NAMES AND HILVL QUAL FROM ACTIVE  */
/*                                                                 */
    SET &TGTZNE = T&ACTZNE
    SET &BKPZNE = B&ACTZNE
    SET &SKELTGT = &SKELACT..TARGET
    SET &SKELBKP = &SKELACT..BACKUP
/*                                                                 */
/* CHECKS IF THE TARGET AND ACTIVE CSI DATA SET EXISTS             */
/*                                                                 */
         %GETVOLID '&SKELTGT..CSI'
         ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TARGET DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELTGT..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
         %GETVOLID '&SKELACT..CSI'
         ISPEXEC VGET (VOLID)
         SET &VOLACT = &VOLID
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(ACTIVE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELACT..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*
/*
/* CHECK IF BACKUP CSI EXISTS
/*
   %GETVOLID '&SKELBKP..CSI'   /* IF NOT FOUND, THE &VOLID */
   ISPEXEC VGET (VOLID)         /* WILL BE SET TO "NOCSI"   */
   SET &VOLBKP = &VOLID
   IF &VOLID NE NOCSI THEN +
     DO  /* FOUND BACKUP;
       SET &CONDPRM = &STR(,COND=(0,NE,DELBCK))
       %LVLNO &BKPZNE      /* OBTAIN LEVEL FROM BKPZNE
       ISPEXEC VGET (LV4NTRY)    /* LINES ADDED FOR LVL TRACKING
       SET &BKUPLVL = &LV4NTRY
       SET &BFOUND = Y   /* TO INCLUDE THE DELETE STEP FOR BACKUP ZONE
     END
   ELSE +
     DO /* DID NOT FIND BACKUP
       SET &CONDPRM = &STR(     )
       SET &VOLBKP = &VOLACT
       SET &BKUPLVL = &STR()
       SET &BFOUND = N  /* TO EXCLUDE THE DELETE STEP FOR BACKUP ZONE
     END
/*
   ISPEXEC VPUT (BFOUND)
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    %LVLNO &TGTZNE
    ISPEXEC VGET (LV4NTRY)
    SET &LV = &LV4NTRY
/*  SET &LV = &STR(&LV4NTRY)
/*
/*    ISREDIT EDIT &PDSMBR
/* GO TO NEXT PANEL
/*
        ISPEXEC VPUT (TGTSYS LV ACTZNE TGTZNE BKPZNE SKELACT SKELTGT  +
              BKUPLVL SKELBKP VOLACT VOLBKP SKELE JOBCLASS)
/*            ADDED BKUPLVL ON VPUT FOR LEVEL TRACKING  2/26 DPB
        ISPEXEC SELECT PANEL(IMPDBSP2)
        EXIT CODE(0)
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    EXIT CODE(&MAXCC)
./ ADD NAME=IMPDBSC2 0130-92192-93330-0945-00181-00066-00121-KETCSC
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: CLIST(IMPDBSC2)                                            */
/* GDE: D. BORGES AND M. PRISCIANDARO                             */
/* DOC: ABOVE TWO INDIVIDUALS DID NOT FEEL THEY SHOULD LET         */
/*      ANY PARTICULAR PERSON KNOW WHAT THIS DOES.                 */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
/*                                                                 */
 ISPEXEC VGET (TGTSYS LV ACTZNE TGTZNE BKPZNE SKELACT SKELTGT  +
               EDITIT SKELBKP VOLACT VOLBKP SKELE BKUPLVL BFOUND)
/*                                                                 */
/* SET UP DFDSS VARIABLE TRANSLATION FOR SKELETON                  */
/* SET UP IEBCOPY SYSUT1 DEFAULT                                   */
/*                                                                 */
   SET &A = &SYSINDEX(TARGET,&SKELDEST)
   IF &A = 0 THEN +
      SET &DFDSSDST = &SKELDEST
   ELSE +
      SET &DFDSSDST = &SUBSTR(1:&A-2,&STR(&SKELDEST))
/*                                                                 */
/* TAILOR THE JCL                                                  */
/*                                                                 */
BEGDSLST: +
SET RC = 0
SET DDCTR = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(&SKELE)') +
    SHR REUSE
  ISPEXEC TBCREATE TABLEIMP +
 NAMES(SUFFIX TGTFLAG ACTFLAG BKPFLAG DDCTR TGTVSAM ACTVSAM BKPVSAM) +
    NOWRITE
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  DO WHILE &RC = 0
    READDVAL DSSUFFIX
    SET SUFFIX = &DSSUFFIX
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELTGT..&SUFFIX')
    SET &TGTCC = &LASTCC
    SET &TGTLNES = &SYSOUTLINE
    SET SYSOUTTRAP = 0
    IF (&TGTCC EQ 0) THEN +
      DO
        SET TGTFLAG = Y
        IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET TGTVSAM = N
          ELSE +
             SET TGTVSAM = Y
      END
    ELSE +
      DO
         SET TGTFLAG = N
         SET TGTVSAM = N
      END
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELACT..&SUFFIX')
    SET &ACTCC = &LASTCC
    SET &ACTLNES = &SYSOUTLINE
    SET SYSOUTTRAP = 0
    IF (&ACTCC EQ 0) THEN +
      DO
        SET ACTFLAG = Y
        IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET ACTVSAM = N
          ELSE +
             SET ACTVSAM = Y
      END
    ELSE +
      DO
         SET ACTFLAG = N
         SET ACTVSAM = N
      END
    IF &BFOUND = Y THEN +
      DO
        SET SYSOUTTRAP = 500
        LISTCAT ENTRY('&SKELBKP..&SUFFIX')
        SET &BKPCC = &LASTCC
        SET &BKPLNES = &SYSOUTLINE
        SET SYSOUTTRAP = 0
      IF (&BKPCC EQ 0) THEN +
        DO
          SET BKPFLAG = Y
          IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET BKPVSAM = N
           ELSE +
              SET BKPVSAM = Y
        END
      ELSE +
        DO
           SET BKPFLAG = N
           SET BKPVSAM = N
        END
      END
    ELSE +
      DO
         SET BKPFLAG = N
         SET BKPVSAM = N
      END
    SET DDCTR = &DDCTR + 1
    IF (&TGTVSAM = Y OR &ACTVSAM = Y OR &BKPVSAM = Y) THEN +
      DO
        SET TSUFFIX = &SUFFIX
        SET &SUFFIX = &TSUFFIX..DATA
        ISPEXEC TBADD TABLEIMP
        IF (&TGTLNES > 4 OR &ACTLNES > 4 OR &BKPLNES > 4) THEN +
          DO
            IF &SUBSTR(4:8,&SYSOUTLINE5) = INDEX THEN +
              DO
                SET &SUFFIX = &TSUFFIX..INDEX
                ISPEXEC TBADD TABLEIMP
              END
          END
        SET &TGTVSAM = N
        SET &ACTVSAM = N
        SET &BKPVSAM = N
        SET &SUFFIX = &TSUFFIX
        ISPEXEC TBADD TABLEIMP
      END
    ELSE ISPEXEC TBADD TABLEIMP
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
/*                                                                 */
/* TAILOR THE JCL                                                  */
/*                                                                 */
ENDDSLST: +
    SET &PNLLVL = &LV
    ISPEXEC VPUT (SRCZNE DESTZNE BKUPLVL) SHARED
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL IMPDBSS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC TBEND TABLEIMP
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        EXIT CODE(0)
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
/*                                                                 */
/* WRAP IT UP                                                      */
/*                                                                 */
    EXIT CODE(0)
./ ADD NAME=IMPOEMC1 0106-93217-93330-1513-00085-00077-00020-KETCSC
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: CLIST(IMPOEMC1)                                            */
/* GDE: M. PRISCIANDARO                                            */
/* DOC: THIS CLIST TAILORS THE JOB TO CLONE A OEM TARGET ZONE      */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(TABLEDS) SHR  DA('&DSNAME.') REUSE
/*                                                                 */
/* BUILD A LIST OF OEM PRODUCTS FROM OEMDSLST                      */
/* THIS LIST IS THEN USED TO DISPLAY AN OEM PANEL SELECTION LIST   */
/*                                                                 */

BEGDSLST: +
SET RC = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(OEMDSLST)') +
    SHR REUSE
  ISPEXEC TBCREATE PANELSEL +
    NAMES(CMD PRODUCT) +
    NOWRITE LIBRARY(TABLEDS)
  ISPEXEC TBCREATE TABLEIMP +
    NAMES(PDUCTLST SUFFIX PDUCTCHK TGTFLAG ACTFLAG BKPFLAG DDCTR  +
          TGTVSAM ACTVSAM BKPVSAM) +
    WRITE   LIBRARY(TABLEDS)
  SET CMD = &STR( )
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  SET &OPRODUCT = &STR()
  DO WHILE &RC = 0
    READDVAL PRODUCT SUFFIX PDUCTCHK
    SET &PDUCTLST = &PRODUCT
    SET &DDCTR = &DDCTR + 1
    ISPEXEC TBADD TABLEIMP
    IF &PRODUCT ^= &OPRODUCT THEN +
      DO
         ISPEXEC TBADD PANELSEL
         SET &OPRODUCT = &PRODUCT
         SET &DDCTR = 1
      END
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
ENDDSLST: +
    ISPEXEC TBTOP PANELSEL
    ISPEXEC TBDISPL PANELSEL +
        PANEL(IMPOEMP1) CURSOR(&CURS) +
        AUTOSEL(NO)
    ISPEXEC VPUT (PRODUCT) SHARED
    ISPEXEC TBTOP TABLEIMP
    ISPEXEC TBSKIP TABLEIMP
    SET MYCC = 0
    DO WHILE &MYCC = 0
      IF &PRODUCT ^= &PDUCTLST THEN +
        DO
           ISPEXEC TBDELETE TABLEIMP
        END
      ISPEXEC TBSKIP TABLEIMP
      SET &MYCC = &LASTCC
    END
    ISPEXEC TBEND PANELSEL
    ISPEXEC TBCLOSE TABLEIMP LIBRARY(TABLEDS)
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC SELECT PANEL(IMPOEMP2)
    EXIT CODE(0)
./ ADD NAME=IMPOEMC2 0112-93217-93330-1501-00373-00252-00373-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(IMPOEMC2)                               */
/* GDE: M. PRISCIANDARO                                            */
/* DOC: THIS CLIST TAILORS THE JOB TO CLONE A OEM TARGET ZONE      */
/*                                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(TABLEDS) SHR  DA('&DSNAME.') REUSE
    ISPEXEC VGET (TGTSYS ACTZNE PRODUCT)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
          IF &TGTSYS = MVSW THEN SET &JOBCLASS = J
            ELSE +
              SET &JOBCLASS = S
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET ACTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
       ELSE EXIT
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &ACTZNE = &ZNENAME THEN +
        DO
         SET SKELACT = &HILVL
         SET ACTFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    ERROR OFF
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN IMPLEMENTATION OF THE &ACTZNE +
                           ZONE ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &ACTFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(&ACTZNE NOT FOUND)
        SET &ZERRLM = &STR(&ACTZNE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* CREATE TARGET AND BACKUP ZONE NAMES AND HILVL QUAL FROM ACTIVE  */
/*                                                                 */
    SET &TGTZNE = T&ACTZNE
    SET &BKPZNE = B&ACTZNE
    SET &SKELTGT = &SKELACT..TARGET
    SET &SKELBKP = &SKELACT..BACKUP
/*                                                                 */
/* READ TABLE AND GET LOADLIB SUFFIX                               */
/*                                                                 */
    ISPEXEC TBOPEN TABLEIMP WRITE LIBRARY(TABLEDS)
          SET MYCC = &LASTCC
    ISPEXEC TBTOP TABLEIMP
          SET MYCC = &LASTCC
    ISPEXEC TBSKIP TABLEIMP
          SET MYCC = &LASTCC
    SET &ENDTABLE = NO
    DO WHILE &ENDTABLE = NO
      IF &PDUCTCHK = &STR(X) THEN +
        DO
          SET &PDUCTSFX = &SUFFIX
          SET &ENDTABLE = YES
        END
      ELSE +
        DO
          ISPEXEC TBSKIP TABLEIMP
          SET MYCC = &LASTCC
          IF &MYCC > 7 THEN +
            DO
              SET &ENDTABLE = YES
              SET &ZERRHM = &STR(*)
              SET &ZERRALRM = &STR(NO)
              SET &ZERRSM = &STR(LOADLIB NOT CHECKED)
              SET &ZERRLM = &STR('&PRODUCT HAS NO LOADLIB X')
              SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
              ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
              ISPEXEC SETMSG MSG(ISRZ002)
              ISPEXEC TBCLOSE TABLEIMP LIBRARY(TABLEDS)
              ISPEXEC TBERASE TABLEIMP LIBRARY(TABLEDS)
              EXIT CODE(0)
            END
        END
    END
/*                                                                 */
/* CHECKS IF THE TARGET AND ACTIVE CSI DATA SET EXISTS             */
/*                                                                 */
    %GETVOLID '&SKELTGT..&PDUCTSFX'
    ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TARGET DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELTGT..&PDUCTSFX' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEIMP LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEIMP LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
    %GETVOLID '&SKELACT..&PDUCTSFX'
    ISPEXEC VGET (VOLID)
    SET &VOLACT = &VOLID
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(ACTIVE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELACT..&PDUCTSFX' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEIMP LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEIMP LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
/*
/* CHECK IF BACKUP CSI EXISTS
/*
   %GETVOLID '&SKELBKP..&PDUCTSFX' /* IF NOT FOUND, THE &VOLID */
   ISPEXEC VGET (VOLID)            /* WILL BE SET TO "NOCSI"   */
   SET &VOLBKP = &VOLID
   IF &VOLID NE NOCSI THEN +
     DO  /* FOUND BACKUP;
       SET &CONDPRM = &STR(,COND=(0,NE,DELBCK))
       %OEMLVL# &PRODUCT &BKPZNE /* OBTAIN LEVEL FROM BKPZNE
       ISPEXEC VGET (LV4NTRY)    /* LINES ADDED FOR LVL TRACKING
       SET &BKUPLVL = &LV4NTRY
       SET &BFOUND = Y   /* TO INCLUDE THE DELETE STEP FOR BACKUP ZONE
     END
   ELSE +
     DO /* DID NOT FIND BACKUP
       SET &CONDPRM = &STR(     )
       SET &VOLBKP = &VOLACT
       SET &BKUPLVL = &STR()
       SET &BFOUND = N  /* TO EXCLUDE THE DELETE STEP FOR BACKUP ZONE
     END
/*
   ISPEXEC VPUT (BFOUND)
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    WRITE &STR(GET LEVEL OF SOURCE ZONE)
    %OEMLVL# &PRODUCT &TGTZNE
    ISPEXEC VGET (LV4NTRY)
    SET &LV = &STR(&LV4NTRY)
    SET &LV = &LV
/*
/*    ISREDIT EDIT &PDSMBR
/* GO TO NEXT PANEL
/*
        ISPEXEC VPUT (TGTSYS LV ACTZNE TGTZNE BKPZNE SKELACT SKELTGT  +
              BKUPLVL SKELBKP VOLACT VOLBKP JOBCLASS)
        ISPEXEC DISPLAY PANEL(IMPOEMP3)

/* CHECK WHAT DATASETS ARE PRESENT
BEGDSLST: +
    ISPEXEC TBTOP TABLEIMP
    ISPEXEC TBSKIP TABLEIMP
    SET RC = 0
    SET DDCTR = 0
    DO WHILE &RC = 0
      SET SYSOUTTRAP = 500
      LISTCAT ENTRY('&SKELTGT..&SUFFIX')
      SET &TGTCC = &LASTCC
      SET &TGTLNES = &SYSOUTLINE
      SET SYSOUTTRAP = 0
      IF (&TGTCC EQ 0) THEN +
        DO
          SET TGTFLAG = Y
          IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET TGTVSAM = N
            ELSE +
              SET TGTVSAM = Y
        END
      ELSE +
        DO
           SET TGTFLAG = N
           SET TGTVSAM = N
        END
      SET SYSOUTTRAP = 500
      LISTCAT ENTRY('&SKELACT..&SUFFIX')
      SET &ACTCC = &LASTCC
      SET &ACTLNES = &SYSOUTLINE
      SET SYSOUTTRAP = 0
      IF (&ACTCC EQ 0) THEN +
        DO
          SET ACTFLAG = Y
          IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET ACTVSAM = N
            ELSE +
               SET ACTVSAM = Y
        END
      ELSE +
        DO
           SET ACTFLAG = N
           SET ACTVSAM = N
        END
      IF &BFOUND = Y THEN +
        DO
          SET SYSOUTTRAP = 500
          LISTCAT ENTRY('&SKELBKP..&SUFFIX')
          SET &BKPCC = &LASTCC
          SET &BKPLNES = &SYSOUTLINE
          SET SYSOUTTRAP = 0
          IF (&BKPCC EQ 0) THEN +
            DO
              SET BKPFLAG = Y
            IF (&SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM) THEN SET BKPVSAM =
              ELSE +
                SET BKPVSAM = Y
            END
        ELSE +
        DO
            SET BKPFLAG = N
            SET BKPVSAM = N
        END
    END
    ELSE +
      DO
         SET BKPFLAG = N
         SET BKPVSAM = N
      END
    SET DDCTR = &DDCTR + 1
    IF (&TGTVSAM = Y OR &ACTVSAM = Y OR &BKPVSAM = Y) THEN +
      DO
        ISPEXEC TBPUT TABLEIMP
        SET TSUFFIX = &SUFFIX
        SET &SUFFIX = &TSUFFIX..DATA
        ISPEXEC TBADD TABLEIMP
        IF (&TGTLNES > 4 OR &ACTLNES > 4 OR &BKPLNES > 4) THEN +
          DO
            IF &SUBSTR(4:8,&SYSOUTLINE5) = INDEX THEN +
              DO
                SET &SUFFIX = &TSUFFIX..INDEX
                ISPEXEC TBADD TABLEIMP
              END
          END
        SET &TGTVSAM = N
        SET &ACTVSAM = N
        SET &BKPVSAM = N
        SET &SUFFIX = &TSUFFIX
      END
    ELSE ISPEXEC TBPUT TABLEIMP
    ISPEXEC TBSKIP TABLEIMP
    SET &RC = &LASTCC
    IF &RC = 8 THEN +
       DO
         GOTO ENDDSLST
       END
  END
ENDDSLST: +
    SET &PNLLVL = &LV
    ISPEXEC VPUT (SRCZNE DESTZNE BKUPLVL) SHARED
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL IMPOEMS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        ISPEXEC TBCLOSE TABLEIMP LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEIMP LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        ISPEXEC TBCLOSE TABLEIMP LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEIMP LIBRARY(TABLEDS)
        EXIT CODE(0)
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    ISPEXEC TBCLOSE TABLEIMP LIBRARY(TABLEDS)
    ISPEXEC TBERASE TABLEIMP LIBRARY(TABLEDS)
/*                                                                 */
/* WRAP IT UP                                                      */
/*                                                                 */
    EXIT CODE(0)
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC TBCLOSE TABLEIMP LIBRARY(TABLEDS)
    ISPEXEC TBERASE TABLEIMP LIBRARY(TABLEDS)
    EXIT CODE(&MAXCC)
./ ADD NAME=IMPOMGC1 0103-93049-93341-0841-00188-00188-00005-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(IMPOMGC1)                               */
/* GDE: MANUEL PRISCIANDARO AND DAN BORGES                         */
/*      AND THEN MODIFIED BY KEN TOMIAK FOR OMEGAMON II FOR DB2    */
/* DOC: THIS CLIST IS ONE STEP IN BUILDING JCL TO IMPLEMENT        */
/*      NEW LEVELS OF SOFTWARE.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (TGTSYS ACTZNE LV)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
            SET &JOBCLASS = S
/*                                                                 */
    SET &SKELE = OMGDSLST
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(OMEGTABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET ACTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
       ELSE EXIT
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &ACTZNE = &ZNENAME THEN +
        DO
         SET SKELACT = &HILVL
         SET ACTFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN IMPLEMENTATION OF THE &ACTZNE +
                           ZONE ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &ACTFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(&ACTZNE NOT FOUND)
        SET &ZERRLM = &STR(&ACTZNE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(OMEGTABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* CREATE TARGET AND BACKUP ZONE NAMES AND HILVL QUAL FROM ACTIVE  */
/*                                                                 */
    SET &TGTZNE = T&ACTZNE
    SET &BKPZNE = B&ACTZNE
    SET &SKELTGT = &SKELACT..TARGET
    SET &SKELBKP = &SKELACT..BACKUP
/*                                                                 */
/* CHECKS IF THE TARGET AND ACTIVE CSI DATA SET EXISTS             */
/*                                                                 */
         %GETVOLID '&SKELTGT..CSI'
         ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TARGET DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELTGT..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
         %GETVOLID '&SKELACT..CSI'
         ISPEXEC VGET (VOLID)
         SET &VOLACT = &VOLID
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(ACTIVE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELACT..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*
/*
/* CHECK IF BACKUP CSI EXISTS
/*
   %GETVOLID '&SKELBKP..CSI'   /* IF NOT FOUND, THE &VOLID */
   ISPEXEC VGET (VOLID)         /* WILL BE SET TO "NOCSI"   */
   SET &VOLBKP = &VOLID
   IF &VOLID NE NOCSI THEN +
     DO  /* FOUND BACKUP;
       SET &CONDPRM = &STR(,COND=(0,NE,DELBCK))
       %OMEGLVL &BKPZNE    /* OBTAIN LEVEL FROM BKPZNE
       ISPEXEC VGET (LV4NTRY)    /* LINES ADDED FOR LVL TRACKING
       SET &BKUPLVL = &LV4NTRY
       SET &BFOUND = Y   /* TO INCLUDE THE DELETE STEP FOR BACKUP ZONE
     END
   ELSE +
     DO /* DID NOT FIND BACKUP
       SET &CONDPRM = &STR(     )
       SET &VOLBKP = &VOLACT
       SET &BKUPLVL = &STR()
       SET &BFOUND = N  /* TO EXCLUDE THE DELETE STEP FOR BACKUP ZONE
     END
/*
   ISPEXEC VPUT (BFOUND)
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    %OMEGLVL &TGTZNE
    ISPEXEC VGET (LV4NTRY)
    SET &LV = &LV4NTRY
/*  SET &LV = &STR(&LV4NTRY)
/*
/*    ISREDIT EDIT &PDSMBR
/* GO TO NEXT PANEL
/*
        ISPEXEC VPUT (TGTSYS LV ACTZNE TGTZNE BKPZNE SKELACT SKELTGT  +
              BKUPLVL SKELBKP VOLACT VOLBKP SKELE JOBCLASS)
/*            ADDED BKUPLVL ON VPUT FOR LEVEL TRACKING  2/26 DPB
        ISPEXEC SELECT PANEL(IMPOMGP2)
        EXIT CODE(0)
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    EXIT CODE(&MAXCC)
./ ADD NAME=IMPOMGC2 0100-93049-93049-1026-00172-00172-00000-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(IMPOMGC2)                                            */
/* GDE: D. BORGES AND M. PRISCIANDARO                              */
/*      THEN MODIFIED BY KEN TOMIAK FOR OMEGAMON II FOR DB2.       */
/* DOC: SUBMIT OMEG MIGRATION JOB                                  */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
/*                                                                 */
 ISPEXEC VGET (TGTSYS LV ACTZNE TGTZNE BKPZNE SKELACT SKELTGT  +
               EDITIT SKELBKP VOLACT VOLBKP SKELE BKUPLVL BFOUND)
/*                                                                 */
/* SET UP DFDSS VARIABLE TRANSLATION FOR SKELETON                  */
/* SET UP IEBCOPY SYSUT1 DEFAULT                                   */
/*                                                                 */
   SET &A = &SYSINDEX(TARGET,&SKELDEST)
   IF &A = 0 THEN +
      SET &DFDSSDST = &SKELDEST
   ELSE +
      SET &DFDSSDST = &SUBSTR(1:&A-2,&STR(&SKELDEST))
/*                                                                 */
/* TAILOR THE JCL                                                  */
/*                                                                 */
BEGDSLST: +
SET RC = 0
SET DDCTR = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(&SKELE)') +
    SHR REUSE
  ISPEXEC TBCREATE TABLEIMP +
 NAMES(SUFFIX TGTFLAG ACTFLAG BKPFLAG DDCTR TGTVSAM ACTVSAM BKPVSAM) +
    NOWRITE
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  DO WHILE &RC = 0
    READDVAL DSSUFFIX
    SET SUFFIX = &DSSUFFIX
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELTGT..&SUFFIX')
    SET &TGTCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&TGTCC EQ 0) THEN +
      DO
        SET TGTFLAG = Y
        IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET TGTVSAM = N
          ELSE +
             SET TGTVSAM = Y
      END
    ELSE +
      DO
         SET TGTFLAG = N
         SET TGTVSAM = N
      END
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELACT..&SUFFIX')
    SET &ACTCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&ACTCC EQ 0) THEN +
      DO
        SET ACTFLAG = Y
        IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET ACTVSAM = N
          ELSE +
             SET ACTVSAM = Y
      END
    ELSE +
      DO
         SET ACTFLAG = N
         SET ACTVSAM = N
      END
    IF &BFOUND = Y THEN +
      DO
        SET SYSOUTTRAP = 500
        LISTCAT ENTRY('&SKELBKP..&SUFFIX')
        SET &BKPCC = &LASTCC
        SET SYSOUTTRAP = 0
      IF (&BKPCC EQ 0) THEN +
        DO
          SET BKPFLAG = Y
          IF &SUBSTR(1:7,&SYSOUTLINE1) = NONVSAM THEN SET BKPVSAM = N
           ELSE +
              SET BKPVSAM = Y
        END
      ELSE +
        DO
           SET BKPFLAG = N
           SET BKPVSAM = N
        END
      END
    ELSE +
      DO
         SET BKPFLAG = N
         SET BKPVSAM = N
      END
    SET DDCTR = &DDCTR + 1
    IF (&TGTVSAM = Y OR &ACTVSAM = Y OR &BKPVSAM = Y) THEN +
      DO
        SET TSUFFIX = &SUFFIX
        SET &SUFFIX = &TSUFFIX..DATA
        ISPEXEC TBADD TABLEIMP
        SET &SUFFIX = &TSUFFIX..INDEX
        ISPEXEC TBADD TABLEIMP
        SET &TGTVSAM = N
        SET &ACTVSAM = N
        SET &BKPVSAM = N
        SET &SUFFIX = &TSUFFIX
        ISPEXEC TBADD TABLEIMP
      END
    ELSE ISPEXEC TBADD TABLEIMP
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
/*                                                                 */
/* TAILOR THE JCL                                                  */
/*                                                                 */
ENDDSLST: +
    SET &PNLLVL = &LV
    ISPEXEC VPUT (SRCZNE DESTZNE BKUPLVL) SHARED
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL IMPOMGS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC TBEND TABLEIMP
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        EXIT CODE(0)
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
/*                                                                 */
/* WRAP IT UP                                                      */
/*                                                                 */
    EXIT CODE(0)
./ ADD NAME=INFOTEL  0100-92258-92258-1425-00005-00005-00000-KETCSC
PROC 0
  CONTROL MSG LIST CONLIST SYMLIST
  ALLOC FILE(MUNDO) DATASET(TEST.DATA) UNIT(SYSDA) +
    SPACE(10 10) TRACKS NEW CATALOG
  SET &MYCC = &LASTCC
./ ADD NAME=INVIPCSA 0105-90200-92317-1207-00021-00022-00001-MANN
         PROC  0
         SET   SYSOUTTRAP = 10
         ATTR  IPCSDDIR
         SET   LINES = &SYSOUTLINE
         SET   SYSOUTTRAP = 0
         IF    &LINES ^= 0 THEN -
               DO
                 ISPEXEC SELECT PGM(BLSG) PARM(PANEL(BLSPPRIM)) +
                                NEWAPPL(BLSG) PASSLIB
                 EXIT  CODE(0)
               END
         FREE  F(IPCSDDIR)
         ISPEXEC DISPLAY PANEL(IPCSREQA)
         SET   RC = &LASTCC
         IF    &RC = 8 × &R ^= Y THEN EXIT CODE(0)
         CONTROL NOMSG
         ATTR  IPCSINVK
         CONTROL MSG
         SET   RETSTACK = &STR(RETURN;SWAP;RETURN;SWAP;RETURN)
         ISPEXEC DISPLAY COMMAND(RETSTACK)
         EXIT  CODE(0)
./ ADD NAME=INVIPCSB 0100-92317-92317-1132-00022-00022-00000-MANN
         PROC  0
    CONTROL LIST CONLIST SYMLIST MSG
         SET   SYSOUTTRAP = 10
         ATTR  IPCSDDIR
         SET   LINES = &SYSOUTLINE
         SET   SYSOUTTRAP = 0
         IF    &LINES ^= 0 THEN -
               DO
                 ISPEXEC SELECT PGM(BLSG) PARM(PANEL(BLSPPRIM)) +
                                NEWAPPL(BLSG) PASSLIB
                 EXIT  CODE(0)
               END
         FREE  F(IPCSDDIR)
         ISPEXEC DISPLAY PANEL(IPCSREQA)
         SET   RC = &LASTCC
         IF    &RC = 8 × &R ^= Y THEN EXIT CODE(0)
         CONTROL NOMSG
         ATTR  IPCSINVK
         CONTROL MSG
         SET   RETSTACK = &STR(RETURN;SWAP;RETURN;SWAP;RETURN)
         ISPEXEC DISPLAY COMMAND(RETSTACK)
         EXIT  CODE(0)
./ ADD NAME=INVK     0100-92253-92253-0830-00002-00002-00000-DD20008
PROC 1 DSNEOV01
 EX 'XDBS.TSOISPF.CLIST(INVKPRO2)' &DSNEOV01
./ ADD NAME=INVK@PRF 0101-92101-92101-1027-00010-00010-00003-DMV0016
PROC 0
 /* LIB: CLIST(INVK@PRF)                                             */
 /* GDE: KENNETH E. TOMIAK                                           */
 /* DOC: THIS CLIST INVOKES THE CORRECT CLIST BY SYSTEM.             */
 /*                                                                  */
BEGIN: +
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS
    GETSYSID
    WRITE &STR(&SYSID) SEE KEN
    EXIT CODE(0)
./ ADD NAME=INVKDSNB 0100-92224-92224-1317-00047-00047-00000-MANN
PROC 0
/******************
/* THIS CLIST MAKES THE LIBRARIES AVAILABLE TO TSO, NEEDED TO RUN
/* THE DSNTINST AND THEN EXECUTES THE INSTALL CLIST(DSNTINST).
/******************
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
/*
   PROFILE WTP MSGID
   ISPEXEC CONTROL ERRORS RETURN
   ISPEXEC DISPLAY PANEL(INVKDSNT)
   SET &MYCC = &LASTCC
   IF (&MYCC NE 0) THEN +
     DO
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(REQUEST CANCELLED)     /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(YOU DID IT)            /*  LONG MESSAGE     */
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
    EXIT CODE(0)
      END
/*                                                                 */
/*
   ALTLIB ACTIVATE APPLICATION(CLIST) +
       DATASET('&HILVLQ..DSNCLIST')
   SET &MYCC = &LASTCC
   IF (&MYCC NE 0) THEN +
     DO
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(REQUEST FAILED)        /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(ALTLIB FAILED &MYCC)   /*  LONG MESSAGE     */
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
    EXIT CODE(4)
      END
/*
   ISPEXEC LIBDEF ISPPLIB DATASET ID('&HILVLQ..DSNSPFP')
   ISPEXEC LIBDEF ISPMLIB DATASET ID('&HILVLQ..DSNSPFM')
/*
   ISPEXEC SELECT CMD(DSNTINST)
   ALTLIB DEACTIVATE APPLICATION(CLIST)
   ISPEXEC LIBDEF ISPPLIB
   ISPEXEC LIBDEF ISPMLIB
/*
EXIT
./ ADD NAME=INVKDSNT 0118-92188-92226-2202-00070-00031-00000-DMV0016
PROC 0
/******************
/* THIS CLIST MAKES THE LIBRARIES AVAILABLE TO TSO, NEEDED TO RUN
/* THE DSNTINST AND THEN EXECUTES THE INSTALL CLIST(DSNTINST).
/******************
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
/*
   PROFILE WTP MSGID
   ISPEXEC CONTROL ERRORS RETURN
   ISPEXEC DISPLAY PANEL(INVKDSNT)
   SET &MYCC = &LASTCC
   IF (&MYCC NE 0) THEN +
     DO
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(REQUEST CANCELLED)     /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(YOU DID IT)            /*  LONG MESSAGE     */
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
    EXIT CODE(0)
      END
/*                                                                 */
/*
   ISPEXEC VGET(HILVLQ DSNTIMEM)
   ISPEXEC LMINIT DATAID(DDIN) DATASET('XDBS.DSNTID.SOURCE') ENQ(SHR)
   ISPEXEC LMINIT DATAID(DDOUT) +
                  DATASET('&HILVLQ..DSNSAMP') ENQ(SHR)

   ISPEXEC LMCOPY FROMID(&DDIN) FROMMEM(&DSNTIMEM) +
                TODATAID(&DDOUT) REPLACE

   ISPEXEC LMFREE DATAID(&DDIN)
   ISPEXEC LMFREE DATAID(&DDOUT)

   ALTLIB ACTIVATE APPLICATION(CLIST) +
       DATASET('&HILVLQ..DSNCLIST')
   SET &MYCC = &LASTCC
   IF (&MYCC NE 0) THEN +
     DO
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(REQUEST FAILED)        /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(ALTLIB FAILED &MYCC)   /*  LONG MESSAGE     */
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
    EXIT CODE(4)
      END
/*
   ISPEXEC LIBDEF ISPPLIB DATASET ID('&HILVLQ..DSNSPFP')
   ISPEXEC LIBDEF ISPMLIB DATASET ID('&HILVLQ..DSNSPFM')
/*
   ISPEXEC SELECT CMD(DSNTINST)
   ALTLIB DEACTIVATE APPLICATION(CLIST)
   ISPEXEC LIBDEF ISPPLIB
   ISPEXEC LIBDEF ISPMLIB
/*
   ISPEXEC LMINIT DATAID(DDIN) +
                  DATASET('&HILVLQ..DSNSAMP') ENQ(SHR)
   ISPEXEC LMINIT DATAID(DDOUT) DATASET('XDBS.DSNTID.SOURCE') ENQ(SHR)

   ISPEXEC LMCOPY FROMID(&DDIN) FROMMEM(&DSNTIMEM) +
                TODATAID(&DDOUT) REPLACE

   ISPEXEC LMFREE DATAID(&DDIN)
   ISPEXEC LMFREE DATAID(&DDOUT)
   ISPEXEC EDIT DATASET('XDBS.DSNTID.SOURCE(&DSNTIMEM)') +
     MACRO(STAMPIT)
/*
EXIT
./ ADD NAME=INVKHRF  0100-93349-93349-0919-00050-00050-00000-KETCSC
 PROC 0
 /*                                                      */
 /* LIB: CLIST(INVKHRF)                                  */
 /* GDE: TECHNICAL SUPPORT GROUP                         */
 /* DOC: ISSUE LIBDEFS, THEN INVOKE RACF DIALOGS.        */
 /*                                                      */
    CONTROL NOFLUSH NOMSG MAIN ASIS END(ENDO)
 /* CONTROL CONLIST SYMLIST LIST MSG
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC LIBDEF ISPMLIB DATASET +
        ID(                        +
           'SYS1.HRFMSG'           +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE
        WRITE ISPMLIB FAILED LIBDEF RC=&MYCC
        WRITE
      ENDO
    ISPEXEC LIBDEF ISPPLIB DATASET +
        ID(                        +
           'SYS1.HRFPANL'          +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE
        WRITE ISPPLIB FAILED LIBDEF RC=&MYCC
        WRITE
      ENDO
    ISPEXEC LIBDEF ISPSLIB DATASET +
        ID(                        +
           'SYS1.HRFSKEL'          +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE
        WRITE ISPSLIB FAILED LIBDEF RC=&MYCC
        WRITE
      ENDO
    ISPEXEC SELECT PANEL(ICHP00) NEWAPPL(RACF) PASSLIB
    SET &MYCC = &LASTCC
 ISPEXEC LIBDEF ISPLLIB
 ISPEXEC LIBDEF ISPPLIB
 ISPEXEC LIBDEF ISPMLIB
 ISPEXEC LIBDEF ISPSLIB
 ISPEXEC LIBDEF ISPTLIB
 ISPEXEC LIBDEF ISPTABL
./ ADD NAME=INVKIPCS 0112-92212-92317-1258-00034-00024-00024-MANN
PROC 0
 /* LIB: CLIST(INVKIPCS)                                             */
 /* GDE: MANNY PRISCIANDARO                                          */
 /* DOC: THIS CLIST INVOKES IPCS.                                    */
 /*                                                                  */
BEGIN: +
    CONTROL LIST CONLIST SYMLIST MSG END(ENDO)
/*  CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS
    GETSYSID
    IF (&STR(&SYSID) = MVSP) THEN +
      DO
        ALTLIB ACTIVATE APPLICATION(CLIST) +
          DATASET('SYS1.SBLSCLI0')
        ISPEXEC CONTROL ERRORS RETURN
        ISPEXEC LIBDEF ISPSLIB DATASET ID('SYS1.SBLSKEL0')
        ISPEXEC LIBDEF ISPMLIB DATASET ID('SYS1.SBLSMSG0')
        ISPEXEC LIBDEF ISPPLIB DATASET ID('SYS1.SBLSPNL0')
        ISPEXEC LIBDEF ISPTLIB DATASET ID('SYS1.SBLSTBL0')
        SET &MYCC = &LASTCC
        FREE  F(IPCSDDIR)
        %BLSCDDIR VOLUME(XDB001)
        %INVIPCSA
      ENDO
/*      ALTLIB DEACTIVATE APPLICATION(CLIST)
    EXIT CODE(0)
         ISPEXEC DISPLAY PANEL(IPCSREQA)
         SET   RC = &LASTCC
         IF    &RC = 8 × &R ^= Y THEN EXIT CODE(0)
         CONTROL NOMSG
         ATTR  IPCSINVK
         CONTROL MSG
         SET   RETSTACK = &STR(RETURN;SWAP;RETURN;SWAP;RETURN)
         ISPEXEC DISPLAY COMMAND(RETSTACK)
         EXIT  CODE(0)
./ ADD NAME=INVKOMVS 0105-92101-93211-1144-00029-00003-00028-DD20006
PROC 0
 /* LIB: CLIST(INVKOMVS)                                             */
 /* GDE: KENNETH E. TOMIAK                                           */
 /* DOC: THIS CLIST INVOKES OMEGAMON/MVS.                            */
 /*                                                                  */
BEGIN: +
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS
    GETSYSID
    IF (&STR(&SYSID) = MVSP) THEN +
      DO
        EX 'SYS1.TSOE.CLISTS(OM)'
      ENDO
    IF (&STR(&SYSID) = MVSW) THEN +
      DO
        EX 'SYS1.TSOE.CLISTS(OM)'
      ENDO
    IF (&STR(&SYSID) = MVSX) THEN +
      DO
        EX 'CSC.CLISTS(OMX)'
      ENDO
    IF (&STR(&SYSID) = DOFD) THEN +
      DO
        EX 'TECHSERV.SYSPROC(OMD)'
      ENDO
    IF (&STR(&SYSID) = DOFP) THEN +
      DO
        EX 'TECHSERV.SYSPROC(OMP)'
      ENDO
    EXIT CODE(0)
./ ADD NAME=INVKO2DB 0100-94021-94021-1436-00053-00053-00000-DMV0016
PROC 2 DB2ID CUST
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(INVKO2DB)                               */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST ALLOCATES THE ALTLIBS FOR OMEG2-DB2 AND         */
/*      INVOKES OMEG2-DB2                                          */
/*                                                                 */
BEGIN: +
    CONTROL NOMSG NOLIST NOFLUSH END(ENDO)
/*  CONTROL LIST CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    GETSYSID
    ALTLIB ACTIVATE APPLICATION(CLIST) +
      DATASET('XDBS.TSOISPF.EXEC' +
              'XDBS.TSOISPF.CLIST')
    %CHCKSSID &DB2ID
    SET &MYCC = &LASTCC
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    IF (&MYCC = 0) THEN GOTO ITSGOOD
    WRITE DB2 SUBSYSTEM &DB2ID IS NOT INSTALLED ON &SYSID, TRY ANOTHER.
    EXIT CODE(16)
 /******************************************************
 /*           TSO AND ISPF DATASETS                    *
 /******************************************************
ITSGOOD: +
    ALTLIB ACTIVATE APPLICATION(CLIST) +
      DATASET('XDBS.TSOISPF.EXEC' +
              'XDBS.TSOISPF.CLIST' +
              '&DB2ID..OMEGDB2.CLIST')
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(REQUEST FAILED)
        SET &ZERRLM = &STR(CLIST ALTLIB FAILED &MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(4)
      ENDO
/*
 /******************************************************
 /*       INVOKE THE PRODUCT                           *
 /******************************************************
    ISPEXEC VPUT (DB2ID) SHARED
    %O2SPF O2CUST(&CUST)
    SET &MYCC = &LASTCC
 /******************************************************
 /*       FREE THE MESS ALLOCATED                      *
 /******************************************************
    ALTLIB DEACTIVATE APPLICATION(CLIST)
QMFXIT: +
    EXIT CODE(0)
./ ADD NAME=INVKPLAT 0115-93119-93300-1143-00031-00000-00031-KETCSC
PROC 1 SSID
 /*                                                                  */
 /* LIB: CLIST(INVKPLAT)                                             */
 /* GDE: DB2 GROUP                                                   */
 /* DOC: THIS CLIST USES ALTLIB FOR AN APPLICATION LEVEL SYSPROC     */
 /*      AND THEN THE PLATINUM QUICK INSTALL CLIST PICSTART          */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
/*  CONTROL LIST MSG CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    SET &OK = &SYSDSN('&SSID..PLATINUM.CLIST')
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(NOT INSTALLED THERE)
        SET &ZERRLM = &STR(DB2 PLATINUM IS NOT INSTALLED IN)
        SET &ZERRLM = &STR(&ZERRLM &SSID SUBSYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(4)
      ENDO
    ALTLIB ACTIVATE APPLICATION(CLIST) +
      DA('XDBS.TSOISPF.CLIST')  /* CDCSA/DB2 */
    ISPEXEC SELECT CMD(%PLATSET &SSID) NEWAPPL(RC)
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    ALTLIB ACTIVATE APPLICATION(CLIST) +
      DA('&SSID..PLATINUM.CLIST')  /* PLATINUM */
    ISPEXEC SELECT CMD(%RSPMAIN HIGHLVL(&SSID..PLATINUM))
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    EXIT CODE(0)
./ ADD NAME=INVKPRO2 0112-92168-94031-1658-00030-00001-00030-KETCSC
PROC 1 SSID
 /*                                                                  */
 /* LIB: CLIST(INVKPRO2)                                             */
 /* GDE: DB2 GROUP                                                   */
 /* DOC: THIS CLIST USES ALTLIB FOR AN APPLICATION LEVEL SYSPROC     */
 /*      AND THEN THE PROEDIT CLIST PROEDT.                          */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
    ISPEXEC CONTROL ERRORS RETURN
    SET &OK = &SYSDSN('&SSID..PROEDIT.CLIST')
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(NOT INSTALLED THERE)
        SET &ZERRLM = &STR(DB2 ProEdit IS NOT INSTALLED IN)
        SET &ZERRLM = &STR(&ZERRLM SUBSYSTEM &SSID)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(4)
      ENDO
    ALTLIB ACTIVATE APPLICATION(CLIST) +
      DA('&SSID..PROEDIT.CLIST',  /* PROEDIT  */ +
         'XDBS.TSOISPF.CLIST')
    ISPEXEC SELECT CMD(%SETPROOP &SSID) NEWAPPL(CDSY)
    ALLOC FILE(PRODKEYS) DATASET('&SSID.PROINSTL.PRODKEYS') SHR
    ISPEXEC SELECT CMD(%PROEDT PROF) NEWAPPL(CDSY) PASSLIB
    FREE FILE(PRODKEYS)
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    EXIT CODE(0)
./ ADD NAME=INVKPRO9 0100-92175-92175-1638-00018-00018-00000-DMV0016
PROC 1 SSID
 /*                                                                  */
 /* LIB: CLIST(INVKPRO2)                                             */
 /* GDE: KEN TOMIAK                                                  */
 /* DOC: THIS CLIST ALLOCATES SYSUPROC DDNAME AND EXECUTES PROEDIT   */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
    FREE FI(SYSUPROC)
    ALLOC FI(SYSUPROC) SHR DA('&SSID..PROEDIT.CLIST')  /* PROEDIT  */
    ALTLIB ACTIVATE USER(CLIST)

    ISPEXEC CONTROL ERRORS RETURN

    ISPEXEC SELECT CMD(%PROEDT PROF) NEWAPPL(CDSY) PASSLIB

    ALTLIB DEACTIVATE USER(CLIST)
    FREE FI(SYSUPROC)
    EXIT CODE(0)
./ ADD NAME=INVKQKIN 0110-93103-93166-1422-00047-00026-00047-MANN
PROC 1 SSID
 /*                                                                  */
 /* LIB: CLIST(INVKQKIN)                                             */
 /* GDE: DB2 GROUP                                                   */
 /* DOC: THIS CLIST USES ALTLIB FOR AN APPLICATION LEVEL SYSPROC     */
 /*      AND THEN THE PLATINUM QUICK INSTALL CLIST PICSTART          */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
    ISPEXEC CONTROL ERRORS RETURN
 /* PLATTEMP IS USED TO ADD NEW PRODUCTS TO XDBS.PLATINUM.***        */
    IF &SSID = &STR(PLATTEMP) THEN +
      DO
        SET &OK = &SYSDSN('XDBS.PLATTEMP.CLIST')
        IF (&STR(&OK) NE OK) THEN +
          DO
            SET &ZERRHM = &STR(*)
            SET &ZERRALRM = &STR(YES)
            SET &ZERRSM = &STR(DOES NOT EXIST)
            SET &ZERRLM = &STR(XDBS.PLATTEMP.CLIST NOT FOUND)
            SET &ZERRLM = &STR(&ZERRLM &SSID SUBSYSTEM)
            ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
            ISPEXEC SETMSG MSG(ISRZ002)
            EXIT CODE(4)
          ENDO
        ALTLIB ACTIVATE APPLICATION(CLIST) +
          DA('XDBS.PLATTEMP.CLIST')  /* PLATINUM */
        ISPEXEC SELECT CMD(%PICSTART HIGHLVL(XDBS.PLATTEMP))
        ALTLIB DEACTIVATE APPLICATION(CLIST)
        EXIT CODE(0)
      ENDO
    SET &OK = &SYSDSN('&SSID..PLATINUM.CLIST')
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(NOT INSTALLED THERE)
        SET &ZERRLM = &STR(DB2 PLATINUM IS NOT INSTALLED IN)
        SET &ZERRLM = &STR(&ZERRLM &SSID SUBSYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(4)
      ENDO
    ALTLIB ACTIVATE APPLICATION(CLIST) +
      DA('&SSID..PLATINUM.CLIST')  /* PLATINUM */
    ISPEXEC SELECT CMD(%PICSTART HIGHLVL(&SSID..PLATINUM))
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    EXIT CODE(0)
./ ADD NAME=INVKQMF  0100-92244-92244-1706-00192-00192-00000-KETCSC
PROC 1 DB2ID
/*                                                                 */
/* LIB: IPO1.CMDPROC(QMF)                                          */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST ALLOCATES THE QMF TEMPORARY DATASETS AND        */
/*      INVOKES QMF.                                               */
/*                                                                 */
BEGIN: +
    CONTROL NOMSG NOLIST NOFLUSH END(ENDO)
/*  CONTROL LIST CONLIST SYMLIST
    ATTN GOTO QMFCAN
    ISPEXEC CONTROL ERRORS RETURN
    GETSYSID
    IF (&NRSTR(&DB2ID) NE ) THEN GOTO HAVEID
    SET &DB2ID = XXXX
    IF (&SYSID = DOFX) THEN SET &DB2ID = DB2X
    IF (&SYSID = MVSX) THEN SET &DB2ID = DB2M
HAVEID: +
    IF (&DB2ID = DB2X) AND +
       (&SYSID = DOFX) THEN GOTO QMFIN
    IF (&DB2ID = D1DB) AND +
       (&SYSID = MVSP) THEN GOTO QMFIN
    IF (&DB2ID = P1DB) AND +
       (&SYSID = MVSP) THEN GOTO QMFIN
    IF (&DB2ID = DSN) AND +
       (&SYSID = DOFD) THEN GOTO QMFIN
    IF (&DB2ID = DB2M) AND +
       (&SYSID = MVSX) THEN GOTO QMFIN
    IF (&DB2ID = D2DB) AND +
       (&SYSID = MVSW) THEN GOTO QMFIN
    WRITE QMF IS NOT INSTALLED IN SUBSYSTEM &DB2ID, TRY ANOTHER.
    EXIT CODE(16)
 /******************************************************
 /*           TSO AND ISPF DATASETS                    *
 /******************************************************
QMFIN: +
    ALTLIB ACTIVATE APPLICATION(EXEC) +
      DATASET('&DB2ID..DSQEXECE')
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(REQUEST FAILED)
        SET &ZERRLM = &STR(EXEC ALTLIB FAILED &MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(4)
      ENDO
    ALTLIB ACTIVATE APPLICATION(CLIST) +
      DATASET('&DB2ID..DSQCLSTE')
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(REQUEST FAILED)
        SET &ZERRLM = &STR(CLIST ALTLIB FAILED &MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(4)
      ENDO
/*
    ISPEXEC LIBDEF ISPLLIB DATASET ID('&DB2ID..DSQLOAD' +
                                     '&DB2ID..DSNLOAD')
    SET &MYCC = &LASTCC
    SET &DD = ISPLLIB
    IF (&MYCC ^= 0) THEN GOTO QMFERR
    ISPEXEC LIBDEF ISPMLIB DATASET ID('&DB2ID..DSQMLIBE')
    SET &MYCC = &LASTCC
    SET &DD = ISPMLIB
    IF (&MYCC ^= 0) THEN GOTO QMFERR
    ISPEXEC LIBDEF ISPPLIB DATASET ID('&DB2ID..DSQPLIBE')
    SET &MYCC = &LASTCC
    SET &DD = ISPPLIB
    IF (&MYCC ^= 0) THEN GOTO QMFERR
    ISPEXEC LIBDEF ISPSLIB DATASET ID('&DB2ID..DSQSLIBE')
    SET &MYCC = &LASTCC
    SET &DD = ISPSLIB
    IF (&MYCC ^= 0) THEN GOTO QMFERR
/*
 /******************************************************
 /*           QMF/GDDM  MAPS                           *
 /******************************************************
    FREE FILE(ADMGGMAP)
    ALLOC FILE(ADMGGMAP) DA('&DB2ID..DSQMAPE') SHR REUSE
    SET &MYCC = &LASTCC
    SET &DD = ADMGGMAP
    IF (&MYCC ^= 0) THEN GOTO QMFERR
 /******************************************************
 /*           DATASETS USED BY QMF                     *
 /******************************************************
    FREE FILE(DSQPRINT)
    ALLOC FILE(DSQPRINT) SYSOUT(X) +
      RECFM(F B A) BLKSIZE(1330) LRECL(133)
    SET &MYCC = &LASTCC
    SET &DD = DSQPRINT
    IF (&MYCC ^= 0) THEN GOTO QMFERR
    FREE FILE(DSQDEBUG)
    ALLOC FILE(DSQDEBUG) SYSOUT(X) +
      RECFM(F B A) BLKSIZE(1210) LRECL(121)
    SET &MYCC = &LASTCC
    SET &DD = DSQDEBUG
    IF (&MYCC ^= 0) THEN GOTO QMFERR
    FREE FILE(DSQPNLE)
    ALLOC FILE(DSQPNLE) DATASET('&DB2ID..DSQPNLE') SHR REUSE
    SET &MYCC = &LASTCC
    SET &DD = DSQPNLE
/*  IF (&MYCC ^= 0) THEN GOTO QMFERR
    FREE FILE(DSQSPILL)
    ALLOC FILE(DSQSPILL) SYSOUT(X) +
      RECFM(F) BLKSIZE(4096) LRECL(4096)
    SET &MYCC = &LASTCC
    SET &DD = DSQSPILL
    IF (&MYCC ^= 0) THEN GOTO QMFERR
    DELETE DSQEDIT
    FREE FILE(DSQEDIT)
    ALLOC FILE(DSQEDIT) NEW CATALOG +
      RECFM(F B) BLKSIZE(4029) LRECL(79) +
      UNIT(SYSDA) DATASET(DSQEDIT)
    SET &MYCC = &LASTCC
    SET &DD = DSQEDIT
    IF (&MYCC ^= 0) THEN GOTO QMFERR
 /******************************************************
 /*       INVOKE THE PRODUCT                           *
 /******************************************************
    SET &STATISPF = &SYSISPF
    IF (&STATISPF = ACTIVE) THEN +
      DO
        ISPEXEC VGET (ZSPLIT)
        IF (&ZSPLIT = YES) THEN GOTO QMFSPLT
        ISPEXEC SELECT PGM(DSQQMFE) NEWAPPL(DSQE) +
            PARM(S=&DB2ID) PASSLIB
        SET &MYCC = &LASTCC
        SET &DD = &STR(RUNNING DSQQMFE)
        IF (&MYCC ^= 0) THEN GOTO QMFERR
      ENDO
    ELSE +
      DO
        ISPSTART SELECT PGM(DSQQMFE) NEWAPPL(DSQE) +
          PARM(S=&DB2ID) PASSLIB
        SET &MYCC = &LASTCC
        SET &DD = &STR(RUNNING DSQQMFE)
        IF (&MYCC ^= 0) THEN GOTO QMFERR
      ENDO
 /******************************************************
 /*       FREE THE MESS ALLOCATED                      *
 /******************************************************
    FREE FILE(ADMGGMAP)
    FREE FILE(DSQPRINT)
    FREE FILE(DSQDEBUG)
    FREE FILE(DSQPNLE)
    FREE FILE(DSQSPILL)
    FREE FILE(SYSEXEC)
    FREE FILE(DSQEDIT)
    DELETE DSQEDIT
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    ALTLIB DEACTIVATE APPLICATION(EXEC)
    ISPEXEC LIBDEF ISPLLIB
    ISPEXEC LIBDEF ISPMLIB
    ISPEXEC LIBDEF ISPPLIB
    ISPEXEC LIBDEF ISPSLIB
QMFXIT: +
    ATTN OFF
    FREE FILE(ADMGGMAP DSQDEBUG DSQUDUMP DSQSPILL DSQPRINT)
    EXIT CODE(0)
QMFSPLT: +
    WRITE
    WRITE CANNOT INVOKE QMF WHEN ISPF SCREENS ARE SPLIT
    WRITE
    GOTO QMFXIT
QMFCAN: +
    ATTN OFF
    WRITE ATTENTION KEY PRESSED, EXECUTION TERMINATED
    FREE FILE(ADMGGMAP DSQDEBUG DSQUDUMP DSQSPILL DSQPRINT)
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    ALTLIB DEACTIVATE APPLICATION(EXEC)
    ISPEXEC LIBDEF ISPLLIB
    ISPEXEC LIBDEF ISPMLIB
    ISPEXEC LIBDEF ISPPLIB
    ISPEXEC LIBDEF ISPSLIB
    EXIT CODE(0)
QMFERR: +
    WRITE FILE(&DD) ALLOCATION ERROR, RC=&MYCC
    FREE FILE(ADMGGMAP DSQDEBUG DSQUDUMP DSQSPILL DSQPRINT)
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    ALTLIB DEACTIVATE APPLICATION(EXEC)
    ISPEXEC LIBDEF ISPLLIB
    ISPEXEC LIBDEF ISPMLIB
    ISPEXEC LIBDEF ISPPLIB
    ISPEXEC LIBDEF ISPSLIB
    EXIT CODE(0)
./ ADD NAME=INVKRACF 0100-92182-92182-0938-00047-00047-00000-DMV0016
 PROC 0
 /*                                                      */
 /* LIB: XDBS.TSOISPF.CLIST(INVKRACF)                    */
 /* GDE: KENNETH E. TOMIAK                               */
 /* DOC: ISSUE LIBDEFS, THEN INVOKE RACF.                */
 /*                                                      */
    CONTROL NOFLUSH NOMSG MAIN ASIS END(ENDO)
 /* CONTROL CONLIST SYMLIST LIST MSG
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC LIBDEF ISPMLIB DATASET +
        ID(                        +
           'SYS1.HRFMSG'           +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE
        WRITE ISPMLIB FAILED LIBDEF RC=&MYCC
        WRITE
      ENDO
    ISPEXEC LIBDEF ISPPLIB DATASET +
        ID(                        +
           'SYS1.HRFPANL'          +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE
        WRITE ISPPLIB FAILED LIBDEF RC=&MYCC
        WRITE
      ENDO
    ISPEXEC LIBDEF ISPSLIB DATASET +
        ID(                        +
           'SYS1.HRFSKEL'          +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE
        WRITE ISPSLIB FAILED LIBDEF RC=&MYCC
        WRITE
      ENDO
    ISPEXEC SELECT PANEL(ICHP00) NEWAPPL(RACF) PASSLIB
    SET &MYCC = &LASTCC
 ISPEXEC LIBDEF ISPMLIB
 ISPEXEC LIBDEF ISPPLIB
 ISPEXEC LIBDEF ISPSLIB
./ ADD NAME=INVKSMPE 0101-92181-92184-1452-00064-00056-00011-DMV0016
 PROC 0
 /*                                                      */
 /* LIB: XDBS.TSOISPF.CLIST(INVKSMPE)                    */
 /* GDE: DB2 GROUP                                       */
 /* DOC: ISSUE LIBDEFS AND THEN INVOKE SMP/E.            */
 /*                                                      */
    CONTROL NOFLUSH NOMSG MAIN ASIS END(ENDO)
/*  CONTROL CONLIST SYMLIST LIST MSG
    ISPEXEC CONTROL ERRORS RETURN
    SET &MSG = &STR(ISPLLIB: GIM.SGIMLMD0)
    ISPEXEC LIBDEF ISPLLIB DATASET +
        ID(                        +
        'GIM.SGIMLMD0'             +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN GOTO ABNDEXIT
    SET &MSG = &STR(ISPMLIB: GIM.SGIMMENU)
    ISPEXEC LIBDEF ISPMLIB DATASET +
        ID(                        +
        'GIM.SGIMMENU'             +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN GOTO ABNDEXIT
    SET &MSG = &STR(ISPPLIB: GIM.SGIMPENU)
    ISPEXEC LIBDEF ISPPLIB DATASET +
        ID(                        +
        'GIM.SGIMPENU'             +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN GOTO ABNDEXIT
    SET &MSG = &STR(ISPSLIB: GIM.SGIMSENU)
    ISPEXEC LIBDEF ISPSLIB DATASET +
        ID(                        +
        'GIM.SGIMSENU'             +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN GOTO ABNDEXIT
    SET &MSG = &STR(SMPTABL: USERID.ISPF.ISPPROF)
    ISPEXEC LIBDEF SMPTABL DATASET +
        ID(                        +
        ISPF.ISPPROF               +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN GOTO ABNDEXIT
    SET &MSG = &STR(ISPTLIB: GIM.SGIMTENU)
    ISPEXEC LIBDEF ISPTLIB DATASET +
        ID(                        +
        ISPF.ISPPROF               +
        'GIM.SGIMTENU'             +
          )
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN GOTO ABNDEXIT
    ISPEXEC SELECT PGM(GIMSTART) PARM() NOCHECK NEWAPPL(GIM) PASSLIB
    EXIT CODE(0)
/*                                                                 */
ABNDEXIT: +
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(&MSG)
    SET &ZERRLM = &STR(IT AINT GONNA WORK THIS WAY)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
/*                                                                 */
    EXIT CODE(16)
./ ADD NAME=INVKTLMS 0100-93187-93187-1421-00015-00015-00000-MANN
PROC 0
 /* LIB: CLIST(INVKTLMS)                                             */
 /* GDE: MANNY PRISCIANDARO                                          */
 /* DOC: THIS CLIST INVOKES TLMS/TSO.                                */
 /*      USERID==> INQR                                              */
 /*      PSWD  ==> INQR                                              */
 /*                                                                  */
BEGIN: +
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS
    GETSYSID
    IF (&STR(&SYSID) = MVSP) THEN +
      DO
        EX 'CSC.CLISTS(CATLTP)'
      ENDO
    EXIT CODE(0)
./ ADD NAME=ISDB2UP  0100-93178-93178-0748-00024-00024-00000-DMV0016
PROC 1 SSID MSG
    CONTROL NOFLUSH NOMSG END(ENDO)
    DSN SYSTEM(&SSID)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        WRITE &SSID IS NOT OPERATIONAL, PLEASE INVESTIGATE
        IF (&MSG = MSG) THEN +
          DO
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
          ENDO
        GOTO EXITIT
      ENDO
    IF (&MSG = MSG) THEN +
      DO
        WRITE '&SSID SUBSYSTEM IS UP'
      ENDO
    END
EXITIT: +
    EXIT CODE(&MAXCC)
./ ADD NAME=ISDB2UPW 0100-93330-93330-1631-00025-00025-00000-DMV0016
PROC 1 SSID MSG
    CONTROL NOFLUSH NOMSG END(ENDO)
    DSN SYSTEM(&SSID)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        WRITE &SSID IS NOT OPERATIONAL, PLEASE INVESTIGATE
        IF (&MSG = MSG) THEN +
          DO
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SE '&SSID SUBSYSTEM IS NOT OPERATIONAL, PLEASE INVESTIGATE'
            SET &MAXCC = 4
          ENDO
        GOTO EXITIT
      ENDO
    IF (&MSG = MSG) THEN +
      DO
        WRITE '&SSID SUBSYSTEM IS UP'
      ENDO
    END
EXITIT: +
    EXIT CODE(&MAXCC)
./ ADD NAME=ISPFJC   0102-93027-93048-1549-00615-00508-00615-KETCSC
PROC 0 PANEL()
 /*                                                                  */
 /* LIB: CLIST(ISPFON)                                               */
 /* GDE: KEN TOMIAK                                                  */
 /* DOC: THIS CLIST ALLOCATES THE TSO AND ISPF DDNAMES.              */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    GETSYSID
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO GETOWNR
      ENDO
    SET &PGMR = &PGMR
GETOWNR: +
    SET &B = &SYSINDEX(OWNER=,&STR(&SYSOUTLINE1))
    SET &B = &B + 6
    SET &E = &B + 8
    SET &OWNR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO CHKAUTH
      ENDO
    SET &OWNR = &OWNR
 /*                                                                  */
 /*  check user authority                                            */
 /*                                                                  */
CHKAUTH: +
    ERROR OFF
 /*                                                                  */
 /*  Check for HRA                                                   */
 /*                                                                  */
    IF (&OWNR = CWA069D) THEN EXIT CODE(0)
 /*                                                                  */
 /*  Check for RACF/MVS                                              */
 /*                                                                  */
    IF (&SYSUID = TONY)    OR +
       (&SYSUID = CSCSEC)  OR +
       (&SYSUID = ACTCSC)  OR +
       (&SYSUID = HJLCSC)  OR +
       (&SYSUID = LXGCSC)  THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  CDCSA CICS GROUP                                                */
 /*                                                                  */
    IF (&SYSUID = AXGCSC)  OR +
       (&SYSUID = JOJO)    THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  CDCSA DB2 GROUP                                                 */
 /*                                                                  */
    IF (&SYSUID = DMV0016) OR +
       (&SYSUID = JXCCSC)  THEN +
      GOTO NEWC828
    IF (&OWNR = CSCDB2) THEN GOTO BEGIN
    IF (&SYSUID = SUE)     OR +
       (&SYSUID = MJLCSC)  OR +
       (&SYSUID = DB2CSC)  OR +
       (&SYSUID = BORGY)   OR +
       (&SYSUID = MANN)    OR +
       (&SYSUID = PETE)    OR +
       (&SYSUID = KETCSC)  OR +
       (&SYSUID = LAWCSC)  OR +
       (&SYSUID = FSGCSC)  OR +
       (&SYSUID = FMMCSC)  THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  Check for waterboard                                            */
 /*                                                                  */
    SET &AUTHID = &SUBSTR(1:4,&SYSUID    )
    IF (&AUTHID = C828) THEN +
      GOTO ISPFC828
 /*                                                                  */
 /*  UNKNOWN USERS                                                   */
 /*                                                                  */
    SE '&SYSUID USING &SYSPROC' U(DMV0016),LOGON
    EXIT CODE(0)
BEGIN: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSID = MVSP) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(P1DB.)
            SET &CSPPRE = &STR(CSP.PROD.)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D1DB.)
            SET &CSPPRE = &STR(CSP.DEVL.)
          ENDO
      ENDO
    ELSE +
    IF (&SYSID = MVSW) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(error)
            SET &CSPPRE = &STR(error)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D2DB.)
            SET &CSPPRE = &STR(         )
          ENDO
      ENDO
    ELSE +
    IF (&SYSID = MVSX) THEN +
      DO
        SET &DB2PRE = &STR(DB2M.)
        SET &CSPPRE = &STR(CSPT.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
    IF (&SYSID = MVSW) THEN +
      GOTO ALCMVSW
    IF (&SYSID = MVSX) THEN +
      GOTO ALCMVSX
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSP: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSX: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&DB2PRE.DSNLOAD'        /* DB2      */  +
                             '&DB2PRE.DSQLOAD'        /* QMF      */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSW: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
/*********************************************************************/
/*  CHECK FOR USER DEFINED INVOCATION
/*********************************************************************/
INVKPDF: +
    SET &DSNOK = &SYSDSN('&SYSUID..CLIST(ADDON)')
    IF (&STR(&DSNOK) EQ OK) THEN +
      GOTO INVKUSER
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE         %ipcs new (to invoke Interactive Problem Control)
    WRITE
    EXIT CODE(&MAXCC)
ISPFC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  Using Jack's panels
/*********************************************************************/
NEWC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE ISPFJC
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(PRIMPNL)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  USER HAS OWN INVOCATION CLIST
/*********************************************************************/
INVKUSER: +
    EX '&SYSUID..CLIST(ADDON)'
    EXIT CODE(&MAXCC)
./ ADD NAME=ISPFKET  0100-93111-93111-1127-00663-00663-00000-KETCSC
PROC 0 PANEL()
 /*                                                                  */
 /* LIB: CLIST(ISPFON)                                               */
 /* GDE: KEN TOMIAK                                                  */
 /* DOC: THIS CLIST ALLOCATES THE TSO AND ISPF DDNAMES.              */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    GETSYSID
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
    CONTROL LIST CONLIST SYMLIST MSG
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO GETOWNR
      ENDO
    SET &PGMR = &PGMR
GETOWNR: +
    SET &B = &SYSINDEX(OWNER=,&STR(&SYSOUTLINE1))
    SET &B = &B + 6
    SET &E = &B + 8
    SET &OWNR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO CHKAUTH
      ENDO
    SET &OWNR = &OWNR
 /*                                                                  */
 /*  check user authority                                            */
 /*                                                                  */
CHKAUTH: +
    ERROR OFF
 /*                                                                  */
 /*  Check for HRA                                                   */
 /*                                                                  */
    IF (&OWNR = CWA069D) THEN EXIT CODE(0)
 /*                                                                  */
 /*  Check for RACF/MVS                                              */
 /*                                                                  */
    IF (&SYSUID = TONY)    OR +
       (&SYSUID = CSCSEC)  OR +
       (&SYSUID = ACTCSC)  OR +
       (&SYSUID = HJLCSC)  OR +
       (&SYSUID = LXGCSC)  THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  CDCSA CICS GROUP                                                */
 /*                                                                  */
    IF (&SYSUID = AXGCSC)  OR +
       (&SYSUID = JOJO)    THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  CDCSA MVS IBM Consultants                                       */
 /*                                                                  */
    IF (&SYSUID = DMV0016) OR +
       (&SYSUID = SXSCSC)  OR   +
       (&SYSUID = EXDCSC) OR +
       (&SYSUID = JXCCSC)  THEN +
      GOTO NEWC828
 /*                                                                  */
 /*  CDCSA DB2 GROUP                                                 */
 /*                                                                  */
    SET &UID = &SUBSTR(1:3,&SYSUID   )
    IF (&UID = DD2) THEN GOTO DOFBEGIN
    IF (&OWNR = CSCDB2) THEN GOTO BEGIN
    IF (&SYSUID = SUE)     OR +
       (&SYSUID = MJLCSC)  OR +
       (&SYSUID = DB2CSC)  OR +
       (&SYSUID = BORGY)   OR +
       (&SYSUID = MANN)    OR +
       (&SYSUID = PETE)    OR +
       (&SYSUID = KETCSC)  OR +
       (&SYSUID = LAWCSC)  OR +
       (&SYSUID = FSGCSC)  OR +
       (&SYSUID = FMMCSC)  OR   +
       (&SYSUID = DD20008) THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  Check for waterboard                                            */
 /*                                                                  */
    SET &AUTHID = &SUBSTR(1:4,&SYSUID    )
    IF (&AUTHID = C828) THEN +
      GOTO NEWC828
 /*                                                                  */
 /*  UNKNOWN USERS                                                   */
 /*                                                                  */
    EXIT CODE(0)
BEGIN: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSID = MVSP) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(P1DB.)
            SET &CSPPRE = &STR(CSP.PROD.)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D1DB.)
            SET &CSPPRE = &STR(CSP.DEVL.)
          ENDO
      ENDO
    ELSE +
    IF (&SYSID = MVSW) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(error)
            SET &CSPPRE = &STR(error)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D2DB.)
            SET &CSPPRE = &STR(         )
          ENDO
      ENDO
    ELSE +
    IF (&SYSID = MVSX) THEN +
      DO
        SET &DB2PRE = &STR(DB2M.)
        SET &CSPPRE = &STR(CSPT.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
    IF (&SYSID = MVSW) THEN +
      GOTO ALCMVSW
    IF (&SYSID = MVSX) THEN +
      GOTO ALCMVSX
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSP: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             'SYS1.CSC.USRMLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSX: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&DB2PRE.DSNLOAD'        /* DB2      */  +
                             '&DB2PRE.DSQLOAD'        /* QMF      */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSW: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
/*********************************************************************/
/*  CHECK FOR USER DEFINED INVOCATION
/*********************************************************************/
INVKPDF: +
    SET &DSNOK = &SYSDSN('&SYSUID..CLIST(ADDON)')
    IF (&STR(&DSNOK) EQ OK) THEN +
      GOTO INVKUSER
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE         %ipcs new (to invoke Interactive Problem Control)
    WRITE
    EXIT CODE(&MAXCC)
ISPFC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  Using Jack's panels
/*********************************************************************/
NEWC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(PRIMPNL)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'SYS1.CSC.USRSLIB'       /* MVS GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  USER HAS OWN INVOCATION CLIST
/*********************************************************************/
INVKUSER: +
    EX '&SYSUID..CLIST(ADDON)'
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  DOF Enhancement - add XDBS.TSOISPF
/*********************************************************************/
DOFBEGIN: +
    ALLOC FI(XDBSPRC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST')    /* DB2 GROUP*/  +
          REUSE
    CONCAT (SYSPROC,XDBSPRC)
    CONTROL MSG
    ERROR EXIT
    ALLOC FI(XDBSMLB) SHR DA('XDBS.TSOISPF.MSGS')     /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPMLIB,XDBSMLB)
    ALLOC FI(XDBSPLB) SHR DA('XDBS.TSOISPF.PANELS')   /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPPLIB,XDBSPLB)
    ALLOC FI(XDBSSLB) SHR DA('XDBS.TSOISPF.SKELS')    /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPSLIB,XDBSSLB)
    ALLOC FI(XDBSTLB) SHR DA('XDBS.TSOISPF.TABLES')   /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPTLIB,XDBSTLB)
    ERROR RETURN
    WRITE
    WRITE     XDBS Enhanced Version
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
./ ADD NAME=ISPFON   0104-93193-93295-1058-00694-00693-00016-KETCSC
PROC 0 PANEL()
 /*                                                                  */
 /* LIB: CLIST(ISPFON)                                               */
 /* GDE: KEN TOMIAK                                                  */
 /* DOC: THIS CLIST ALLOCATES THE TSO AND ISPF DDNAMES.              */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    GETSYSID
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO GETOWNR
      ENDO
    SET &PGMR = &PGMR
GETOWNR: +
    SET &B = &SYSINDEX(OWNER=,&STR(&SYSOUTLINE1))
    SET &B = &B + 6
    SET &E = &B + 8
    SET &OWNR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO CHKAUTH
      ENDO
    SET &OWNR = &OWNR
 /*                                                                  */
 /*  check user authority                                            */
 /*                                                                  */
CHKAUTH: +
    ERROR OFF
 /*                                                                  */
 /*  Check for HRA                                                   */
 /*                                                                  */
    IF (&OWNR = CWA069D) THEN EXIT CODE(0)
 /*                                                                  */
 /*  Check for RACF/MVS                                              */
 /*                                                                  */
    IF (&SYSUID = TONY)    OR +
       (&SYSUID = CSCSEC)  OR +
       (&SYSUID = ACTCSC)  OR +
       (&SYSUID = HJLCSC)  OR +
       (&SYSUID = LXGCSC)  THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  CDCSA CICS GROUP                                                */
 /*                                                                  */
    IF (&SYSUID = AXGCSC)  OR +
       (&SYSUID = JOJO)    THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  CDCSA MVS IBM Consultants                                       */
 /*                                                                  */
    IF (&SYSUID = SXSCSC)  OR   +
       (&SYSUID = JXCCSC)  THEN +
      GOTO NEWC828
 /*                                                                  */
 /*  CDCSA DB2 GROUP                                                 */
 /*                                                                  */
    SET &UID = &SUBSTR(1:3,&SYSUID   )
    IF (&UID = DD2) THEN GOTO DOFBEGIN
    IF (&UID = DMV) AND +
       ((&SYSID = DOFX) OR +
       ((&SYSID = DOFD) OR +
       ((&SYSID = DOFP)) THEN +
      GOTO DOFBEGIN
    IF (&OWNR = CSCDB2) THEN GOTO BEGIN
    IF (&SYSUID = SUE)     OR +
       (&SYSUID = MJLCSC)  OR +
       (&SYSUID = DB2CSC)  OR +
       (&SYSUID = MANN)    OR +
       (&SYSUID = PETE)    OR +
       (&SYSUID = KETCSC)  OR +
       (&SYSUID = LAWCSC)  OR +
       (&SYSUID = ACSCFSG)  OR +
       (&SYSUID = ACSCJFG)  OR +
       (&SYSUID = FMMCSC)  OR   +
       (&SYSUID = DMV0016) THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  Check for waterboard                                            */
 /*                                                                  */
    SET &AUTHID = &SUBSTR(1:4,&SYSUID    )
    IF (&AUTHID = C828) THEN +
      GOTO NEWC828
 /*                                                                  */
 /*  UNKNOWN USERS                                                   */
 /*                                                                  */
    EXIT CODE(0)
BEGIN: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSID = MVSP) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(P1DB.)
            SET &CSPPRE = &STR(CSP.PROD.)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D1DB.)
            SET &CSPPRE = &STR(CSP.DEVL.)
          ENDO
      ENDO
    ELSE +
      IF (&SYSID = MVSW) THEN +
        DO
          IF (&SYSPROC = DB2PROD) THEN +
            DO
              SET &DB2PRE = &STR(P1DB.)
              SET &CSPPRE = &STR(CSP.PROD.)
            ENDO
          ELSE +
            DO
              IF (&SYSPROC = D2DBEVL) THEN +
                DO
                  SET &DB2PRE = &STR(D1DB.)
                  SET &CSPPRE = &STR(CSP.DEVL.)
                ENDO
              ELSE +
                DO
                  SET &DB2PRE = &STR(D2DB.)
                  SET &CSPPRE = &STR(         )
                ENDO
            ENDO
        ENDO
    ELSE +
    IF (&SYSID = MVSX) THEN +
      DO
        SET &DB2PRE = &STR(DB2M.)
        SET &CSPPRE = &STR(CSPX.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
    IF (&SYSID = MVSW) THEN +
      GOTO ALCMVSW
    IF (&SYSID = MVSX) THEN +
      GOTO ALCMVSX
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSP: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             'SYS1.CSC.USRMLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSX: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */
/*                           '&CSPPRE.ADCLIST'        /* CSP/AD   */
/*                           '&CSPPRE.AECLIST'   )    /* CSP/AE   */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&DB2PRE.DSNLOAD'        /* DB2      */  +
                             '&DB2PRE.DSQLOAD')       /* QMF      */  +
          REUSE
/*                           '&CSPPRE.AELOAD'    )    /* CSP/AE   */
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
/*                           '&CSPPRE.ADPLIB'         /* CSP/AD   */
/*                           '&CSPPRE.AEPLIB'    )    /* CSP/AE   */
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
/*                           '&CSPPRE.ADPLIB'         /* CSP/AD   */
/*                           '&CSPPRE.AEPLIB'    )    /* CSP/AE   */
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSW: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             'SYS1.CSC.USRMLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
/*********************************************************************/
/*  CHECK FOR USER DEFINED INVOCATION
/*********************************************************************/
INVKPDF: +
    SET &DSNOK = &SYSDSN('&SYSUID..CLIST(ADDON)')
    IF (&STR(&DSNOK) EQ OK) THEN +
      GOTO INVKUSER
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    CONTROL NOPROMPT MSG
    SET SYSOUTTRAP = 10
    ATTR IPCSINVK
    SET LINES = &SYSOUTLINE
    FREE F(IPCSINVK)
    SET SYSOUTTRAP = 0
    IF &LINES = 0 THEN GOTO NOIPCS
    WRITE *************************************************************
    WRITE *                                                           *
    WRITE *     IPCS IS IN THE PROCESS OF COMING UP.  THIS WILL       *
    WRITE *     TAKE SEVERAL SECONDS TO ACCOMPLISH.  PLEASE WAIT.     *
    WRITE *                                                           *
    WRITE *************************************************************
    IPCS
    ISPSTART &PNL
NOIPCS: +
    EXIT CODE(&MAXCC)
ISPFC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  Using Jack's panels
/*********************************************************************/
NEWC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(PRIMPNL)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'SYS1.CSC.USRSLIB'       /* MVS GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  USER HAS OWN INVOCATION CLIST
/*********************************************************************/
INVKUSER: +
    EX '&SYSUID..CLIST(ADDON)'
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  DOF Enhancement - add XDBS.TSOISPF
/*********************************************************************/
DOFBEGIN: +
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(ISP@MSTR)
    ALLOC FI(XDBSPRC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST')    /* DB2 GROUP*/  +
          REUSE
    CONCAT (SYSPROC,XDBSPRC)
    CONTROL MSG
    ERROR EXIT
    ALLOC FI(XDBSMLB) SHR DA('XDBS.TSOISPF.MSGS')     /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPMLIB,XDBSMLB)
    ALLOC FI(XDBSPLB) SHR DA('XDBS.TSOISPF.PANELS')   /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPPLIB,XDBSPLB)
    ALLOC FI(XDBSSLB) SHR DA('XDBS.TSOISPF.SKELS')    /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPSLIB,XDBSSLB)
    ALLOC FI(XDBSTLB) SHR DA('XDBS.TSOISPF.TABLES')   /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPTLIB,XDBSTLB)
    ERROR RETURN
    WRITE
    WRITE     XDBS Enhanced Version
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
./ ADD NAME=ISPFPS   0100-93202-93202-1826-00695-00695-00000-PETE
PROC 0 PANEL()
 /*                                                                  */
 /* LIB: CLIST(ISPFON)                                               */
 /* GDE: KEN TOMIAK                                                  */
 /* DOC: THIS CLIST ALLOCATES THE TSO AND ISPF DDNAMES.              */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    GETSYSID
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO GETOWNR
      ENDO
    SET &PGMR = &PGMR
GETOWNR: +
    SET &B = &SYSINDEX(OWNER=,&STR(&SYSOUTLINE1))
    SET &B = &B + 6
    SET &E = &B + 8
    SET &OWNR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO CHKAUTH
      ENDO
    SET &OWNR = &OWNR
 /*                                                                  */
 /*  check user authority                                            */
 /*                                                                  */
CHKAUTH: +
    ERROR OFF
 /*                                                                  */
 /*  Check for HRA                                                   */
 /*                                                                  */
    IF (&OWNR = CWA069D) THEN EXIT CODE(0)
 /*                                                                  */
 /*  Check for RACF/MVS                                              */
 /*                                                                  */
    IF (&SYSUID = TONY)    OR +
       (&SYSUID = CSCSEC)  OR +
       (&SYSUID = ACTCSC)  OR +
       (&SYSUID = HJLCSC)  OR +
       (&SYSUID = LXGCSC)  THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  CDCSA CICS GROUP                                                */
 /*                                                                  */
    IF (&SYSUID = AXGCSC)  OR +
       (&SYSUID = JOJO)    THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  CDCSA MVS IBM Consultants                                       */
 /*                                                                  */
    IF (&SYSUID = SXSCSC)  OR   +
       (&SYSUID = JXCCSC)  THEN +
      GOTO NEWC828
 /*                                                                  */
 /*  CDCSA DB2 GROUP                                                 */
 /*                                                                  */
    SET &UID = &SUBSTR(1:3,&SYSUID   )
    IF (&UID = DD2) THEN GOTO DOFBEGIN
    IF (&UID = DMV) AND +
       ((&SYSID = DOFX) OR +
       ((&SYSID = DOFD) OR +
       ((&SYSID = DOFP)) THEN +
      GOTO DOFBEGIN
    IF (&OWNR = CSCDB2) THEN GOTO BEGIN
    IF (&SYSUID = SUE)     OR +
       (&SYSUID = MJLCSC)  OR +
       (&SYSUID = DB2CSC)  OR +
       (&SYSUID = MANN)    OR +
       (&SYSUID = PETE)    OR +
       (&SYSUID = KETCSC)  OR +
       (&SYSUID = LAWCSC)  OR +
       (&SYSUID = ACSCFSG)  OR +
       (&SYSUID = FMMCSC)  OR   +
       (&SYSUID = DMV0016) THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  Check for waterboard                                            */
 /*                                                                  */
    SET &AUTHID = &SUBSTR(1:4,&SYSUID    )
    IF (&AUTHID = C828) THEN +
      GOTO NEWC828
 /*                                                                  */
 /*  UNKNOWN USERS                                                   */
 /*                                                                  */
    EXIT CODE(0)
BEGIN: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSID = MVSP) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(P1DB.)
            SET &CSPPRE = &STR(CSP.PROD.)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D1DB.)
            SET &CSPPRE = &STR(CSP.DEVL.)
          ENDO
      ENDO
    ELSE +
      IF (&SYSID = MVSW) THEN +
        DO
          IF (&SYSPROC = DB2PROD) THEN +
            DO
              SET &DB2PRE = &STR(P1DB.)
              SET &CSPPRE = &STR(CSP.PROD.)
            ENDO
          ELSE +
            DO
              IF (&SYSPROC = D2DBEVL) THEN +
                DO
                  SET &DB2PRE = &STR(D1DB.)
                  SET &CSPPRE = &STR(CSP.DEVL.)
                ENDO
              ELSE +
                DO
                  SET &DB2PRE = &STR(D2DB.)
                  SET &CSPPRE = &STR(         )
                ENDO
            ENDO
        ENDO
    ELSE +
    IF (&SYSID = MVSX) THEN +
      DO
        SET &DB2PRE = &STR(DB2M.)
        SET &CSPPRE = &STR(CSPT.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
    IF (&SYSID = MVSW) THEN +
      GOTO ALCMVSW
    IF (&SYSID = MVSX) THEN +
      GOTO ALCMVSX
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSP: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             'SYS1.CSC.USRMLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'SYS1.SMP.OTABLES'       /* CSC USER */  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSX: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&DB2PRE.DSNLOAD'        /* DB2      */  +
                             '&DB2PRE.DSQLOAD'        /* QMF      */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSW: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             'SYS1.CSC.USRMLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'SYS1.SMP.OTABLES'       /* CSC USER */  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
/*********************************************************************/
/*  CHECK FOR USER DEFINED INVOCATION
/*********************************************************************/
INVKPDF: +
    SET &DSNOK = &SYSDSN('&SYSUID..CLIST(ADDON)')
    IF (&STR(&DSNOK) EQ OK) THEN +
      GOTO INVKUSER
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    CONTROL NOPROMPT MSG
    SET SYSOUTTRAP = 10
    ATTR IPCSINVK
    SET LINES = &SYSOUTLINE
    FREE F(IPCSINVK)
    SET SYSOUTTRAP = 0
    IF &LINES = 0 THEN GOTO NOIPCS
    WRITE *************************************************************
    WRITE *                                                           *
    WRITE *     IPCS IS IN THE PROCESS OF COMING UP.  THIS WILL       *
    WRITE *     TAKE SEVERAL SECONDS TO ACCOMPLISH.  PLEASE WAIT.     *
    WRITE *                                                           *
    WRITE *************************************************************
    IPCS
    ISPSTART &PNL
NOIPCS: +
    EXIT CODE(&MAXCC)
ISPFC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  Using Jack's panels
/*********************************************************************/
NEWC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'SYS1.CSC.CLIST'         /* MVS GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(2,2) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(PRIMPNL)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'SYS1.CSC.USRPLIB'       /* MVS GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'SYS1.CSC.USRSLIB'       /* MVS GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  USER HAS OWN INVOCATION CLIST
/*********************************************************************/
INVKUSER: +
    EX '&SYSUID..CLIST(ADDON)'
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  DOF Enhancement - add XDBS.TSOISPF
/*********************************************************************/
DOFBEGIN: +
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(ISP@MSTR)
    ALLOC FI(XDBSPRC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST')    /* DB2 GROUP*/  +
          REUSE
    CONCAT (SYSPROC,XDBSPRC)
    CONTROL MSG
    ERROR EXIT
    ALLOC FI(XDBSMLB) SHR DA('XDBS.TSOISPF.MSGS')     /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPMLIB,XDBSMLB)
    ALLOC FI(XDBSPLB) SHR DA('XDBS.TSOISPF.PANELS')   /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPPLIB,XDBSPLB)
    ALLOC FI(XDBSSLB) SHR DA('XDBS.TSOISPF.SKELS')    /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPSLIB,XDBSSLB)
    ALLOC FI(XDBSTLB) SHR DA('XDBS.TSOISPF.TABLES')   /* DB2 GROUP*/  +
          REUSE
    CONCAT (ISPTLIB,XDBSTLB)
    ERROR RETURN
    WRITE
    WRITE     XDBS Enhanced Version
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
./ ADD NAME=ISPFQMF  0102-92244-92244-1720-00039-00041-00000-KETCSC
PROC 1 DB2ID
/*                                                                 */
/* LIB: IPO1.CMDPROC(QMF)                                          */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST ALLOCATES THE QMF TEMPORARY DATASETS AND        */
/*      INVOKES QMF.                                               */
/*                                                                 */
BEGIN: +
    CONTROL NOMSG NOLIST NOFLUSH END(ENDO)
/*  CONTROL LIST CONLIST SYMLIST
    GETSYSID
    IF (&NRSTR(&DB2ID) NE ) THEN GOTO HAVEID
    SET &DB2ID = XXXX
    IF (&SYSID = DOFX) THEN SET &DB2ID = DB2X
    IF (&SYSID = MVSX) THEN SET &DB2ID = DB2M
HAVEID: +
    IF (&DB2ID = DB2X) AND +
       (&SYSID = DOFX) THEN GOTO QMFIN
    IF (&DB2ID = D1DB) AND +
       (&SYSID = MVSP) THEN GOTO QMFIN
    IF (&DB2ID = P1DB) AND +
       (&SYSID = MVSP) THEN GOTO QMFIN
    IF (&DB2ID = DSN) AND +
       (&SYSID = DOFD) THEN GOTO QMFIN
    IF (&DB2ID = DB2M) AND +
       (&SYSID = MVSX) THEN GOTO QMFIN
    IF (&DB2ID = D2DB) AND +
       (&SYSID = MVSW) THEN GOTO QMFIN
    WRITE QMF IS NOT INSTALLED IN SUBSYSTEM &DB2ID, TRY ANOTHER.
    EXIT CODE(16)
 /******************************************************
 /*           TSO AND ISPF DATASETS                    *
 /******************************************************
QMFIN: +
    FREE FILE(ISPLLIB)
    ALLOC FILE(ISPLLIB) DATASET('&DB2ID..DSQLOAD' +
                                     '&DB2ID..DSNLOAD') SHR
    %ON
    EXIT CODE(0)
./ ADD NAME=ISPFTEST 0121-92318-92366-1221-00521-00492-00032-BORGY
PROC 0 PANEL()
 /*                                                                  */
 /* LIB: CLIST(ISPFON)                                               */
 /* GDE: KEN TOMIAK                                                  */
 /* DOC: THIS CLIST ALLOCATES THE TSO AND ISPF DDNAMES.              */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    GETSYSID
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO GETOWNR
      ENDO
    SET &PGMR = &PGMR
GETOWNR: +
    SET &B = &SYSINDEX(OWNER=,&STR(&SYSOUTLINE1))
    SET &B = &B + 6
    SET &E = &B + 8
    SET &OWNR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO CHKAUTH
      ENDO
    SET &OWNR = &OWNR
 /*                                                                  */
 /*  check user authority                                            */
 /*                                                                  */
CHKAUTH: +
    ERROR OFF
 /*                                                                  */
 /*  CDCSA DB2 GROUP                                                 */
 /*                                                                  */
    IF (&OWNR = CSCDB2) THEN GOTO BEGIN
    IF (&SYSUID = DMV0016) THEN +
      GOTO BEGIN
    IF (&SYSUID = DMV0016) OR +
       (&SYSUID = SUE)     OR +
       (&SYSUID = MJLCSC)  OR +
       (&SYSUID = DB2CSC)  OR +
       (&SYSUID = BORGY)   OR +
       (&SYSUID = MANN)    OR +
       (&SYSUID = PETE)    OR +
       (&SYSUID = CSCSEC)  OR +
       (&SYSUID = KETCSC)  OR +
       (&SYSUID = LAWCSC)  OR +
       (&SYSUID = AXGCSC)  THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  Check for waterboard                                            */
 /*                                                                  */
    SET &AUTHID = &SUBSTR(1:4,&SYSUID)
    IF (&AUTHID = C828) THEN +
      GOTO ISPFC828
 /*                                                                  */
 /*  UNKNOWN USERS                                                   */
 /*                                                                  */
    SE '&SYSUID USING &SYSPROC' U(DMV0016),LOGON
    EXIT CODE(0)
BEGIN: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSID = MVSP) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(P1DB.)
            SET &CSPPRE = &STR(CSP.PROD.)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D1DB.)
            SET &CSPPRE = &STR(CSP.DEVL.)
          ENDO
      ENDO
    ELSE +
    IF (&SYSID = MVSW) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(error)
            SET &CSPPRE = &STR(error)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D2DB.)
            SET &CSPPRE = &STR(         )
          ENDO
      ENDO
    ELSE +
    IF (&SYSID = MVSX) THEN +
      DO
        SET &DB2PRE = &STR(DB2M.)
        SET &CSPPRE = &STR(CSPT.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
    IF (&SYSID = MVSW) THEN +
      GOTO ALCMVSW
    IF (&SYSID = MVSX) THEN +
      GOTO ALCMVSX
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSP: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             'SYS1.SBLSCLI0'          /* IPCS     */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSX: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
/* removed 12/8/92           '&DB2PRE.DVRSAMPE'       /* DXT      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD'            /* ISPF     */  +
                             '&DB2PRE.DSNLOAD'        /* DB2      */  +
                             '&DB2PRE.DSQLOAD'        /* QMF      */  +
                             '&CSPPRE.AELOAD'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
ALCMVSW: +
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             'SYS1.SBLSCLI0'          /* IPCS     */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */
    FREE FI(SYSEXEC)
    ALLOC FI(SYSEXEC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             '&DB2PRE.DSQEXECE')      /* QMF      */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    GOTO INVKPDF
/*********************************************************************/
/*  CHECK FOR USER DEFINED INVOCATION
/*********************************************************************/
INVKPDF: +
    SET &DSNOK = &SYSDSN('&SYSUID..CLIST(ADDON)')
    IF (&STR(&DSNOK) EQ OK) THEN +
      GOTO INVKUSER
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
/*********************************************************************/
/*  INSERT CODE HERE
FLOWON: +
CONTROL NOPROMPT MSG
SET SYSOUTTRAP = 10
ATTR IPCSINVK
SET LINES = &SYSOUTLINE
SET SYSOUTTRAP = 0
IF &LINES = 0 THEN EXIT CODE(0)
ALLOC F(IPCSPARM) SHR REUSE DA('SYS1.PARMLIB')
WRITE ****************************************************
WRITE *                                                  *
WRITE *     IPCS IS IN THE PROCESS OF COMING UP.         *
WRITE *     PLEASE BE PATIENT.......                     *
WRITE *                                                  *
WRITE ****************************************************
WRITE
WRITE Press ENTER when &STR(***) appears.
WRITE
IPCS
ISPSTART &PNL OPT(5.I)
END
FREE F(IPCSDDIR)
FREE F(IPCSPARM)
FREE ATTR(INVKDDIR)
FREE ATTR(IPCSINVK)
/*                                                        */
/*********************************************************************/
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE         %ipcs new (to invoke Interactive Problem Control)
    WRITE
    EXIT CODE(&MAXCC)
ISPFC828: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSPROC = DB2PROD) THEN +
      DO
        SET &DB2PRE = &STR(error)
      ENDO
    ELSE +
      DO
        SET &DB2PRE = &STR(D2DB.)
      ENDO
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE')      /* QMF      */  +
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE')      /* QMF      */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  USER HAS OWN INVOCATION CLIST
/*********************************************************************/
INVKUSER: +
    EX '&SYSUID..CLIST(ADDON)'
    EXIT CODE(&MAXCC)
./ ADD NAME=JOBCARD  0107-89320-93099-1544-00017-00003-00000-KETCSC
ISREDIT MACRO
ISPEXEC CONTROL ERRORS RETURN
ISREDIT (DSN) = DATASET
ISREDIT (MBR) = MEMBER
SET JOBC = &STR(//&SYSUID.X JOB (A006,SYTM,99,99),"10DB2GRP: &MBR", )
ISREDIT LINE_AFTER 0 = '&JOBC'
ISREDIT CHANGE '"' "'" .ZF .ZF ALL
ISREDIT LINE_AFTER 1 = '//             MSGCLASS=V,CLASS=S, '
ISREDIT LINE_AFTER 2 = '//             NOTIFY=&SYSUID,REGION=5M'
ISREDIT LINE_AFTER 3 = '//*'
ISREDIT LINE_AFTER 4 = '//*ROUTE PRINT CSCBATCH'
ISREDIT LINE_AFTER 5 = '//*ROUTE PRINT DOFNY'
ISREDIT LINE_AFTER 6 = '//*'
ISREDIT LINE_AFTER 7 = '//* LIB: &DSN(&MBR)'
ISREDIT LINE_AFTER 8 = '//* GDE: NUMBER MANUAL NAME'
ISREDIT LINE_AFTER 9 = '//* DOC: WHAT THIS JOB DOES.'
ISREDIT LINE_AFTER 10 = '//*'
./ ADD NAME=KENF     0109-93049-93049-1404-00045-00043-00000-KETCSC
PROC 0
/*********************************************************************/
/*        COMPUWARE CORPORATION   FARMINGTON HILLS, MICHIGAN         */
/*                                                                   */
/*               FAMENU - BRING UP FILE-AID MAIN MENU                */
/*                                                                   */
/* THIS IS A CLIST TO INVOKE FILEAID/SPF AND FILEAID/XE.             */
/* THIS CLIST CALLS THE FADYNALC CLIST TO PERFORM LIBDEFS IF NEEDED  */
/* FADYNALC THEN CALLS THE FAEXEC CLIST TO PERFORM SETUP             */
/*                                                                   */
/* CLIST OBTAINED FROM D/S CWMVSW.FA.ISPCLIB ON 2/11/93.             */
/*                                                                   */
/* THIS CLIST MAY BE EXECUTED FROM WITHIN TSO BY USING THE COMMAND:  */
/*                                                                   */
/*       TSO %FAMENU                                                 */
/*   OR                                                              */
/*       TSO FAMENU                                                  */
/*                                                                   */
/* THIS CLIST MAY BE EXECUTED FROM AN ISPF SELECTION MENU VIA:       */
/*                                                                   */
/*     EXAMPLE:  (PROC SECTION OF MENU PANEL - TRANS ENTRY)          */
/*            . . .                                                  */
/*            F,'CMD(%FAMENU) NOCHECK'                               */
/*            . . .                                                  */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
ISPEXEC CONTROL ERRORS RETURN
ALTLIB ACTIVATE APPLICATION(CLIST) DA('XDBS.TSOISPF.CLIST' +
                                      'CWMVSW.FA.ISPCLIB')
/*                                                                   */
/*********************************************************************/
ISPEXEC VGET (ZTRAIL) SHARED
SET FUNCVAR = &ZTRAIL
IF &FUNCVAR = &STR() THEN -
   SET &FUNCVAR = &STR(MENU)
SET &QUOTE = &STR()
SET DSNVAR = &STR(GO)
/*********************************************************************/
/* PASS PARMS TO FADYNALC TO SET LIBS AND INVOKE FILE-AID            */
/*********************************************************************/
ISPEXEC SELECT -
      CMD(%FADYNALC &FUNCVAR DSN(&DSNVAR) &QUOTE)
/*
END
./ ADD NAME=L        0101-92087-92087-1220-00002-00002-00002-DMV0016
PROC 0
    LOGON &SYSUID
./ ADD NAME=LCVOLS   0129-92104-92105-1424-00146-00145-00146-BORGY
/* REXX PROGRAM NAME: LCVOLS                                    */
   TRACE O
/* LIB: XDBS.TSOISPF.EXEC(LCVOLS)                               */
/* GDE: D.BORGES/ DB2 SYSTEMS GROUP                             */
/* DOC: GENERATE JOB STREAM TO EXECUTE A LISTCAT AND EXTRACT    */
/*      THE DB2 DATA SET NAMES FOR A SPECIFIC VOLUME.           */
   ARG SUBSYS VOLUME
/*                                                              */
/* VALIDATE ARGUMENTS                                           */
/*      */
   DO WHILE (SUBSYS = " ") × (VOLUME = " ")
      SAY "ENTER DB2_SUBSYSTEM_NAME AND VOLUME"
      SAY "(EG. ==> DDB2 DFX003)"
      PULL SUBSYS VOLUME
   END
/*                                                             */
/* MODIFY THE FOLLOWING SELECT WHEN ADDING NEW SUBSYSTEM OR    */
/* WHEN USING A NEW VCAT NAME UNDER ONE OF THE CURRENT SYSTMS  */
/*                                                             */
   SELLBL:
   SELECT
      WHEN SUBSYS = "PDB2" THEN
        DO
          HILEV.1 = "PDB2"    /* VCAT NAMES USED UNDER SUBSYSTEM    */
          NVCAT   = 1         /* NO. OF VCAT'S                      */
        END
      WHEN SUBSYS = "DDB2" THEN
        DO
          HILEV.1 = "DDB2"    /* VCAT NAMES USED UNDER SUBSYSTEM    */
          NVCAT   = 1         /* NO. OF VCAT'S                      */
        END
      WHEN SUBSYS = "D1DB" THEN
        DO
          HILEV.1 = "D1DB"    /* VCAT NAMES USED UNDER SUBSYSTEM    */
          HILEV.2 = "D069"
          NVCAT   = 2         /* NO. OF VCAT'S                      */
        END
      WHEN SUBSYS = "P1DB" THEN
        DO
          HILEV.1 = "P1DB"    /* VCAT NAMES USED UNDER SUBSYSTEM    */
          HILEV.2 = "P069"
          NVCAT   = 2         /* NO. OF VCAT'S                      */
        END
   OTHERWISE
      SAY "ENTER VALID SUBSYSTEM NAME"
      SAY "(EG. D1DB, DDB2, OR P1DB)"
      PULL SUBSYS
      SIGNAL SELLBL
   END    /* END SELECT */
/*                                                             */
   DO WHILE (LENGTH(VOLUME) <> 6)
     SAY "ENTER 6 CHARACTER VOLUME"
     PULL VOLUME
   END
/*                                                             */
    ADDRESS TSO "GETSYSID"
   "ISPEXEC VGET (SYSID)"
    IF SYSID = "DOFD"
      THEN
        DO
          CLS =  "L"
          MCLS = "X"
        END
    IF SYSID = "DOFP"
      THEN
        DO
          CLS  = "P"
          MCLS = "X"
        END
    IF SYSID = "MVSP"
      THEN
        DO
          CLS  = "S"
          MCLS = "V"
        END
/*                                                             */
    USERID = SYSVAR(SYSUID)
/*                                                             */
/* JOB CARD                                                    */
/*                                                             */
 QUEUE "//"USERID"L JOB (A006,SYTM,9,9),'ROOM 9',"
 QUEUE "//    MSGCLASS="MCLS",CLASS="CLS",REGION=4096K,TIME=1200,"
 QUEUE "//    NOTIFY="USERID
/*                                                             */
DO I = 1 TO NVCAT
   QUEUE "//* *****************************************************"
   QUEUE "//* LISTVOL: EXECUTE LISTCAT NO."I
   QUEUE "//* *****************************************************"
   QUEUE "//IDCAMS"I " EXEC PGM=IDCAMS"
   QUEUE "//OUT    DD DSN="HILEV.I".LISTVOL.OUTPUT"I","
   QUEUE "//          DISP=(NEW,CATLG),"
   QUEUE "//          SPACE=(CYL,(10,5),RLSE),"
   QUEUE "//          DCB=(RECFM=VBA,BLKSIZE=629,LRECL=125),"
   QUEUE "//          UNIT=SYSDA"
   QUEUE "//SYSPRINT DD  SYSOUT=*"
   QUEUE "//SYSIN    DD  *"
   QUEUE " LISTCAT LEVEL("HILEV.I") VOLUMES OUTFILE(OUT)"
   QUEUE "/*"
END
/*                                                             */
DO I = 1 TO NVCAT
   QUEUE "//***************************************************"
   QUEUE "//* LCVOLSE"I": EXTRACTS LINES FOR LSTCAT OUTPUT FOR A VOLUME"
   QUEUE "//***************************************************"
   QUEUE "//LCVOLSE EXEC PGM=IKJEFT01,DYNAMNBR=35,"
   QUEUE "// REGION=8192K,TIME=1200,"
   QUEUE "// PARM=('%BATCH LCVOLSE PARMA("HILEV.I"),PARMB("VOLUME")',"
   QUEUE "//   'PARMC("I")')"
   QUEUE "//SYSTSPRT DD SYSOUT=*"
   QUEUE "//SYSTSIN DD DUMMY"
   QUEUE "//SYSPROC DD DISP=SHR,DSN=XDBS.TSOISPF.CLIST"
   QUEUE "//ISPLIST DD SYSOUT=*,DCB=(RECFM=FBA,BLKSIZE=1210,LRECL=121)"
   QUEUE "//ISPLOG DD SYSOUT=*,DCB=(RECFM=VA,BLKSIZE=129,LRECL=125)"
   QUEUE "//ISPPROF DD DISP=(NEW,DELETE,DELETE),DSN=&&PROFILE,"
   QUEUE "//      UNIT=SYSALLDA,SPACE=(TRK,(1,1,5)),"
   QUEUE "//      DCB=(RECFM=FB,BLKSIZE=3120,LRECL=80)"
   QUEUE "//ISPLLIB DD DISP=SHR,DSN=ISR.ISRLOAD"
   QUEUE "//  DD  DISP=SHR,DSN=ISP.ISPLOAD"
   QUEUE "//ISPPLIB DD DISP=SHR,DSN=ISR.ISRPENU"
   QUEUE "//  DD  DISP=SHR,DSN=ISP.ISPPENU"
   QUEUE "//ISPMLIB DD DISP=SHR,DSN=ISR.ISRMENU"
   QUEUE "//  DD  DISP=SHR,DSN=ISP.ISPMENU"
   QUEUE "//ISPSLIB DD DISP=SHR,DSN=ISR.ISRSENU"
   QUEUE "//  DD  DISP=SHR,DSN=ISP.ISPSLIB"
   QUEUE "//ISPTLIB DD DISP=SHR,DSN=ISR.ISRTLIB"
   QUEUE "//  DD  DISP=SHR,DSN=ISP.ISPTENU"
END
/*                                                             */
   QUEUE "//* ****************************************************"
   QUEUE "//* PRTLCVOL: PRINT OUTPUT; DELETE DATASET"
   QUEUE "//* ****************************************************"
   QUEUE "//PRTLCVOL EXEC PGM=IEBGENER"
   QUEUE "//SYSPRINT DD SYSOUT=*"
   QUEUE "//SYSUT1 DD DSN="HILEV.1".LISTVOL.OUTPUT1,DISP=(OLD,DELETE)"
   IF NVCAT > 1
   THEN
   DO I = 2 TO NVCAT
     QUEUE "//   DD DSN="HILEV.I".LISTVOL.OUTPUT"I",DISP=(OLD,DELETE)"
   END
   QUEUE "//SYSUT2 DD SYSOUT=*"
   QUEUE "//SYSIN DD *"
   QUEUE "/*"
   QUEUE "//"
   QUEUE "$$"
/*                                                             */
"SUBMIT * END($$)"
./ ADD NAME=LCVOLSE  0120-92072-92105-1050-00018-00030-00000-BORGY
PROC 3 HILVL VOL NVCAT
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(LVLTRCK)                                */
/* GDE: D.BORGES/DB2 SYSTEMS GROUP                                */
/* DOC: EXTRACT DATA SET NAMES FROM A LISTCAT OUTPUT FOR A GIVEN   */
/*      VOLUME                                                     */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*
     SET &DSN = &HILVL..LISTVOL.OUTPUT&NVCAT
/*
/*
    ISPEXEC VPUT (HILVL VOL NVCAT)
    ISPEXEC EDIT DATASET('&DSN') +
      MACRO(LCVOLSM)
/*
    EXIT CODE(&MAXCC)
./ ADD NAME=LCVOLSM  0128-92075-92105-1413-00106-00085-00000-BORGY
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCBKPM)                                 */
/* GDE: DB2 SYSTEMS STAFF                                            */
/* DOC: THIS EDIT MACRO DELETES ALL LINES EXCEPT THOSE WITH THE DB2  */
/*      DATASET NAMES RESIDING ON A SPECIFIC VOLUME                  */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
/*
    ISPEXEC VGET (HILVL VOL NVCAT)
/*
    SET &ENTRIES = NO
    SET &DSCOUNT = 0
/*
    ISREDIT FIND FIRST &VOL
    SET &FINDCC = &LASTCC
    IF &FINDCC = 0 THEN +
      DO
        ISREDIT FIND &HILVL PREV
        ISREDIT (LINENO) = CURSOR
        SET &RLN = &LINENO - 1
        ISREDIT DELETE ALL .ZFIRST &RLN
        SET &ENTRIES = YES
        ISREDIT FIND FIRST &VOL
      ENDO
/*
    DO WHILE &FINDCC = 0
      SET &DSCOUNT = &DSCOUNT + 1
      ISREDIT LABEL .ZCSR = .Y 0
      ISREDIT FIND &HILVL PREV
      ISREDIT (LINENO) = CURSOR
      SET &RLN = &LINENO + 1
      SET &LASTX = &RLN
      ISREDIT LABEL &RLN = .X 0
      ISREDIT DELETE ALL .X .Y
/*    ISREDIT (LINENO) = CURSOR
/*    SET &RLN = &LINENO + 1
      ISREDIT RESET LABEL
      SET &LASTX1 = &LASTX + 1
      ISREDIT LABEL &LASTX = .A 0
      ISREDIT FIND FIRST &VOL
      IF &LASTCC = 0 THEN +
        DO
          ISREDIT FIND &HILVL PREV
          ISREDIT (LINENO) = CURSOR
          SET &RLN = &LINENO - 1
          IF &LINENO > &LASTX THEN +
            DO
               ISREDIT LABEL &RLN = .B 0
               ISREDIT DELETE ALL .A .B
            ENDO
        ENDO
      ISREDIT FIND FIRST &VOL
      SET &FINDCC = &LASTCC
/*    GOTO BOUT
    ENDO
/*
      ISREDIT DELETE ALL .A .ZLAST
      ISREDIT C ALL P'=' '         ' 1
/*
      ISREDIT X ALL
      ISREDIT FIND IDCAMS ALL
      ISREDIT DELETE ALL NX
/*
    IF &ENTRIES = NO  THEN +
      DO
        WRITE **
        WRITE LCVOLS: NO LISTCAT ENTRIES WERE LOCATED FOR VOLUME &VOL
        WRITE         FOR HIGH LEVEL QUALIFIER &HILVL
        WRITE
        ISREDIT DELETE ALL .ZFIRST .ZLAST
      ENDO
    ELSE +
      DO
       IF &NVCAT = 1 THEN +
       DO
        SET &HLINE1 = &STR(****************************************)
        SET &HLINE1 = &STR(&HLINE1.********************************)
        SET &HLINE2 = &STR(                DATA SET LINE EXTRACT FROM)
        SET &HLINE2 = &STR(&HLINE2 IDCAMS LISTCAT)
/*      SET &HLINE3 = &STR(        &HLINE3 'LISTCAT LEVEL(&HILVL)
/*      SET &HLINE3 = &STR(&HLINE3 VOLUMES' FOR VOLSER=&VOL)
        SET &HLINE3 = &STR(                            FOR VOLSER=&VOL)
/*      SET &HLINE4 = &STR(                NUMBER OF EXTRACTED RECS=)
/*      SET &HLINE4 = &STR(&HLINE4.&DSCOUNT)
        SET &HLINE5 = &STR(                )
        ISREDIT LINE_AFTER  0 = DATALINE '&HLINE5'
        ISREDIT LINE_AFTER  0 = DATALINE '&HLINE1'
/*      ISREDIT LINE_AFTER 0 = DATALINE '&HLINE4'
        ISREDIT LINE_AFTER 0 = DATALINE "&HLINE3"
        ISREDIT LINE_AFTER 0 = DATALINE '&HLINE2'
        ISREDIT LINE_AFTER 0 = DATALINE '&HLINE1'
        ISREDIT LABEL 6 = .D
        ISREDIT X .ZFIRST .D
        ISREDIT C P'=' '      ' 1 NX
        WRITE **
        WRITE LCVOLS: &DSCOUNT LISTCAT ENTRIES WERE LOCATED FOR VOLUME
        WRITE         &VOL FOR HIGH LEVEL QUALIFIER &HILVL
        WRITE
       ENDO
      ENDO
    ISREDIT END
EXIT CODE(&MAXCC)
./ ADD NAME=LE       0100-92099-92099-1416-00022-00022-00000-MANN
PROC 1 DATASET
/*********************************************************************/
/*                                                                   */
/* LIB: IPO1.CMDPROC(LE)                                             */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS CLIST DOES A LISTCAT DIRECTING OUTPUT TO DASD.          */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG MAIN
/*  CONTROL CONLIST SYMLIST MSG LIST
    ISPEXEC CONTROL ERRORS RETURN
    GETSYSID
    SET &LELIST = &SYSID..LE.LIST.T&SYSSRV
    FREE FILE(LELIST)
    DELETE &LELIST
    ALLOC FILE(LELIST) DATASET(&LELIST) NEW CATALOG +
      RECFM(V B A) BLKSIZE(6144) LRECL(141) TRACKS +
      SPACE(10 5)
    LISTCAT ENTRY(&DATASET) ALL OUTFILE(LELIST)
    ISPEXEC BROWSE DATASET(&LELIST)
    FREE FILE(LELIST)
    DELETE &LELIST
./ ADD NAME=LIBDEF   0103-92006-92076-1512-00020-00019-00000-BORGY
PROC 0
/* SPECIFY THE APPLICATION PANEL LIBRARY NEEDED */

   ISPEXEC LIBDEF ISPPLIB DATASET ID('XDBS.TSOISPF.CLIST')
   ISPEXEC LIBDEF ISPMLIB DATASET ID('XDBS.TSOISPF.MSGS')
   ISPEXEC LIBDEF ISPPLIB DATASET ID('XDBS.TSOISPF.PANELS')

                            /* RETURN CODES                        */
                            /*  4 - APPLICATION LIBRARY DOES NOT   */
                            /*      EXIST FOR THIS TYPE IF A       */
                            /*  8 - APPLICATION ALREADY EXIST FOR  */
                            /*      THIS TYPE ID, COND SPECIFIED   */
                            /* 12 - ISPPROF WAS SPECIFIED AS THE   */
                            /*      LIB-TYPE OR EXCLDATA OR        */
                            /*      EXCLLIBR WAS SPECIFIED WITH    */
                            /*      LIB-TYPE OTHER THAN ISPXLIB OR */
                            /*      ISPLLIB                        */
                            /* 16 - A LIBNAME WAS NOT ALLOCATED OR */
                            /*      THE DATASET-LIST IS INCOMPLETE */
                            /* 20 - SEVERE ERROR                   */
./ ADD NAME=LISTDDS  0100-93318-93318-1514-00034-00034-00000-KETCSC
PROC 0
/*                                                                 */
/* LIB: KETCSC.LIB.CLIST(LISTDDS)                                  */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST PRINTS THE DDS ALLOCATED TO A TSO SESSION.      */
/*                                                                 */
    CONTROL NOLIST MAIN NOFLUSH END(ENDO)
    SET &SYSOUTTRAP = 1500
GETSTA: +
    LISTALC STATUS
    SET &SYSOUTEND = &SYSOUTLINE
    SET &SYSOUTTRAP = 0
SETFILE: +
    FREE ATTRLIST(DCBRPT)
    ATTRIB DCBRPT RECFM(F B A) +
        BLKSIZE(3990) LRECL(133)
    ALLOC FILE(REPORT) SYSOUT(X) +
        USING(DCBRPT)
    OPENFILE REPORT OUTPUT
    SET REPORT = &STR(1LISTALC STATUS OUTPUT     &SYSDATE &SYSTIME)
    PUTFILE REPORT
    SET &SYSOUTLOOP = 0
GETLOOP: +
    SET &SYSOUTLOOP = &SYSOUTLOOP + 1
    IF (&SYSOUTLOOP > &SYSOUTEND) THEN GOTO ENDOLOOP
    SET &THISLINE = &&SYSOUTLINE&SYSOUTLOOP
    SET REPORT = &STR( )&STR(&THISLINE)
    PUTFILE REPORT
    GOTO GETLOOP
ENDOLOOP: +
    CLOSFILE REPORT
    WRITE DONE.
    FREE FILE(REPORT)
    EXIT
./ ADD NAME=LNAME    0114-92085-92091-1325-00022-00078-00000-DD20002
PROC 1 USER
/*
/* LIB: XDBS.TSOISPF.CLIST(LCVOLS)
/* GDE: D.BORGES
/* DOC: GET ME PERSONS LASTNAME ASSOCIATED WITH THIS USERID
    CONTROL NOLIST NOFLUSH END(ENDO)
/*  CONTROL LIST MSG CONLIST SYMLIST END(ENDO)
/*
    SET &SYSOUTTRAP = 25
    LISTUSER &USER
    SET &SYSOUTTRAP = 0
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    SET &C = &SYSINDEX( ,&STR(&PGMR))
    SET &C = &C + 2
    SET &D = &C + 7
    SET &LNAME = &SUBSTR(&C:&D,(&PGMR))
/*  SET &LNAME = &LNAME
    ISPEXEC VPUT (LNAME)
EXIT
./ ADD NAME=LVLADD   0157-92052-93251-1421-00080-00061-00080-KETCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XDBS.TSOISPF.CLIST(LVLADD)                                   */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO ADDS AN ENTRY TO THE DB2 SOFTWARE TRACKING   */
/*      BOARD                                                        */
/* MOD: ADDED SMP/E DATE/TIME FOR MIGRATION AND IMPLEMENTATION LAW   */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
/*
    ISPEXEC VGET (LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM SMPDAT SMPTIM)
/*
/*  PAD LVLLVL WITH A ZERO IF ONLY 1 DIGIT
/*
    SET &LVLLEN = &LENGTH(&LVLLVL)
    IF &LVLLEN = 1 THEN +
      SET &LVLLVL = &STR(0&LVLLVL)
    SET &LVLLEN = 7 - &LENGTH(&LVLLVL)
    SET &LVLSPC = &SUBSTR(1:&LVLLEN,        )
/*
/* SET UP DATE AND TIME
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/*
/* MAKE SURE ENTRY DOES NOT ALREADY EXIST
/*
    SET &ENDCOL = &LENGTH(&LVLTRG)
    ISREDIT FIND FIRST '&LVLTRG' 1 &ENDCOL
    SET &RETCODE = &LASTCC
    IF &RETCODE = 4 THEN +
       SET &RESULT = NOTFOUND
    IF &RETCODE = 0 THEN +
       SET &RESULT = FOUND
/*
    IF &RESULT EQ NOTFOUND THEN +
      DO
         SET &FRSTCHAR = &SUBSTR(1:1,&LVLTRG)
         IF &FRSTCHAR = T OR &FRSTCHAR = B  THEN +
           DO    /* STRIP PREFIX OUT OF NAME
             SET ENDOFSTR =  &LENGTH(&LVLTRG)
             SET &BASENAM = &SUBSTR(2:&ENDOFSTR,&STR(&LVLTRG))
           ENDO /* END STRIP PREFIX
         ELSE SET &BASENAM = &LVLTRG
         ISREDIT FIND FIRST '&BASENAM' 65 72 /* DOES SECTION
         SET &RETCODE = &LASTCC        /* IN FILE EXIST
         IF &RETCODE = 4 THEN +
            SET &RESULT = NOTFOUND     /* SECTION DOES NOT EXIST
         IF &RETCODE = 0 THEN +
            SET &RESULT = FOUND        /* SECTION EXIST
         IF &RESULT = NOTFOUND  THEN +
            DO    /*INITIALIZE AND ADD LINE TO DELIMIT NEW SECTION
            SET &DELIMLN = &STR(---------------------------------)
            SET &DELIMLN = &STR(&DELIMLN.-----------------------)
            SET &DELIMLN = &STR(&DELIMLN.---------&BASENAM)
              ISREDIT LINE_AFTER .ZLAST = DATALINE '&DELIMLN'
              SET &ROW = .ZLAST
            ENDO
         ELSE +
            ISREDIT (ROW,COL) = CURSOR
/*                                         ADD DATA LINE           */
/* SET UP TEMPLATE  AND ADD LINE
/*
         SET &ROW = &ROW
         SET &ZONECOL = &SUBSTR(1:8,&LVLTRG        )
         SET &TMPLATE = &STR(&ZONECOL &LVLSPC &LVLLVL  )
         SET &TMPLATE = &STR(&TMPLATE   &MM./&DD./&YY)
         SET &TMPLATE = &STR(&TMPLATE    &IPLTIM    &SMPDAT  &SMPTIM)
         SET &TMPLATE = &STR(&TMPLATE  &SYSUID)
         ISREDIT LINE_BEFORE &ROW = DATALINE '&TMPLATE'
         ISREDIT END
      ENDO
    ELSE +
      ISREDIT CANCEL
EXIT CODE(&MAXCC)
./ ADD NAME=LVLDEL   0111-92056-92307-1519-00042-00078-00000-LAWCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XDBS.TSOISPF.CLIST(LVLADD)                                   */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO DELETES AN ENTRY FROM THE DB2 SOFTWARE       */
/*      TRACKING BOARD. THE ENTRY DELETED IS THE  ONE PASSED AS THE  */
/*      LVLTRG PARAMETER.                                            */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
/*
    ISPEXEC VGET (FUNCTN LVLSRC LVLTRG LVLLVL)
    SET &EDTCMD = SAVE    /* INITIALIZE EDIT COMMAND
/*
/* MAKE SURE ENTRY DOES  EXIST
/*
    SET &ENDCOL = &LENGTH(&LVLTRG)
    ISREDIT FIND FIRST '&LVLTRG' 1 &ENDCOL
    SET &RETCODE = &LASTCC
    IF &RETCODE = 4 THEN +
       SET &RESULT = NOTFOUND
    IF &RETCODE = 0 THEN +
       SET &RESULT = FOUND
/*
    IF &RESULT EQ NOTFOUND THEN +
       DO
          IF &FUNCTN = DEL THEN +
             SET &EDTCMD = END
          ISREDIT &EDTCMD
        ENDO
    ELSE +
       DO
          ISREDIT X ALL
          ISREDIT FIND FIRST '&LVLTRG' 1 &ENDCOL
          ISREDIT DELETE ALL NX
          ISREDIT RESET X
          IF &FUNCTN = DEL THEN +
             SET &EDTCMD = END
          ISREDIT &EDTCMD
        ENDO
EXIT CODE(&MAXCC)
./ ADD NAME=LVLNO    0110-92057-92058-1447-00017-00009-00000-DD20002
PROC 1 ENTRYNM
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(LVLTRCK)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST UPDATES THE DB2 SOFTWARE LEVEL TRACKING BOARD   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*                                                                 */
    SET &DSN = XDBS.SOFTWARE.CHANGES
/*
    ISPEXEC VPUT (ENTRYNM)
/*                                                                 */
    ISPEXEC EDIT DATASET('&DSN(LEVELS)') +
      MACRO(LVLNOM)
/*
RETURN
./ ADD NAME=LVLNOEM  0102-93327-93327-1609-00017-00017-00000-KETCSC
PROC 1 ENTRYNM
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(LVLTRCK)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST UPDATES THE DB2 SOFTWARE LEVEL TRACKING BOARD   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*                                                                 */
    SET &DSN = XDBS.SOFTWARE.CHANGES
/*
    ISPEXEC VPUT (ENTRYNM)
/*                                                                 */
    ISPEXEC EDIT DATASET('&DSN(OEMLVL)') +
      MACRO(LVLNOME)
/*
RETURN
./ ADD NAME=LVLNOM   0111-92057-93346-0809-00025-00023-00000-KETCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCBKPM)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO OBTAINS THE LEVEL NUMBER FOR AN ENTRY IN     */
/*      THE LEVEL TRACKING BOARD                                     */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (ENTRYNM)
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    SET &ENDCOL = &LENGTH(&ENTRYNM)
    ISREDIT FIND FIRST &ENTRYNM 1 &ENDCOL
    ISREDIT (ROW,COL) = CURSOR
    SET &SRCLINE = &ROW
    ISREDIT (LINETXT) = LINE &SRCLINE
    SET &LV4NTRY = &SUBSTR(16:18,(&LINETXT)
    SET &LV4NTRY = &LV4NTRY
    ISPEXEC VPUT (LV4NTRY)
    ISREDIT END
EXIT CODE(&MAXCC)
./ ADD NAME=LVLNOME  0100-93327-93327-1557-00025-00025-00000-KETCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCBKPM)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO OBTAINS THE LEVEL NUMBER FOR AN ENTRY IN     */
/*      THE LEVEL TRACKING BOARD                                     */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (ENTRYNM)
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    SET &ENDCOL = &LENGTH(&ENTRYNM)
    ISREDIT FIND FIRST &ENTRYNM
    ISREDIT FIND NEXT
    ISREDIT (ROW,COL) = CURSOR
    SET &SRCLINE = &ROW
    ISREDIT (LINETXT) = LINE &SRCLINE
    SET &LV4NTRY = &SUBSTR(16:18,(&LINETXT)
    ISPEXEC VPUT (LV4NTRY)
    ISREDIT END
EXIT CODE(&MAXCC)
./ ADD NAME=LVLTRCK  0150-92052-93200-1059-00074-00022-00074-MANN
PROC 4 FUNCTN LVLSRC LVLTRG LVLLVL
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(LVLTRCK)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST UPDATES THE DB2 SOFTWARE LEVEL TRACKING BOARD   */
/* MOD: ADDED SMP/E DATE/TIME FOR MIGRATION AND IMPLEMENTION LAW   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*
     SET &DSN = XDBS.SOFTWARE.CHANGES
     SET &MACNAME = NONAME
/*
    IF &FUNCTN = ADD THEN +
       SET &MACNAME = LVLADD
    IF &FUNCTN = DEL THEN +
       SET &MACNAME = LVLDEL
    IF &FUNCTN = UPD THEN +
       SET &MACNAME = LVLUPD
/*
    IF &MACNAME = NONAME THEN +
       DO
         WRITE &FUNCTN IS NOT A VALID FUNCTION
         EXIT CODE(12)
       ENDO
 SET DONE = NO
 SET EOF = OFF
 SET RCODE = 0
/*
/* ERROR ROUTINE
/*
 ERROR +
  DO
     SET RCODE = &LASTCC
     IF &RCODE=400 THEN +
       DO
         SET EOF=ON
         RETURN
      ENDO
  ELSE +
    EXIT
 ENDO
/*
/*
/* THIS SEGMENT READS THE LEVEL CHART AND GET THE SMP/E DATE/TIME
/*
 ALLOC FI(SYSDVAL) DA('&DSN(LEVELS)') SHR REU
 OPENFILE SYSDVAL
 DO WHILE &DONE=NO
    GETFILE SYSDVAL
    IF &EOF=ON THEN GOTO NEXT
    READDVAL MVLSRC MVLLVL MRCDAT MRCTIM MMPDAT MMPTIM
    IF &STR(&LVLSRC) = DONTCARE  THEN +
       GOTO NEXT
    IF &STR(&LVLSRC) = &STR(&MVLSRC) THEN +
      DO
        SET &SMPDAT = &STR(&MMPDAT)
        SET &SMPTIM = &STR(&MMPTIM)
        SET DONE = YES
      ENDO
 ENDO
/*
NEXT: +
CLOSFILE SYSDVAL
FREE FILE(SYSDVAL)
 ERROR OFF
 SET &SRCDAT = &STR(&SYSDATE)
 SET &SRCTIM = &STR(&SYSTIME)
 ISPEXEC VPUT (FUNCTN LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM SMPDAT SMPTIM)
 ISPEXEC EDIT DATASET('&DSN(LEVELS)') +
   MACRO(&MACNAME)
/*
    EXIT CODE(&MAXCC)
/*
./ ADD NAME=LVLUPD   0158-92052-92304-0917-00084-00067-00084-LAWCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XDBS.TSOISPF.CLIST(LVLUPD)                                   */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE TRG ZONE LEVEL FROM THE SRC ZONE */
/*      LEVEL IN THE DB2 SOFTWARE TRACKING BOARD                     */
/* MOD: ADDED SMP/E DATE/TIME FOR MIGRATION AND IMPLEMENTATION LAW   */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
/*
    ISPEXEC VGET (LVLSRC LVLTRG LVLLVL SMPDAT SMPTIM)
/*
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    SET &ENDCOL = &LENGTH(&LVLSRC)
    ISREDIT FIND FIRST &LVLSRC 1 &ENDCOL
    IF &LASTCC NE 0 THEN +
      DO
        SET &ERR1 = &STR(WARNING: &LVLSRC ZONE NOT FOUND IN LEVEL )
        SET &ERR1 = &STR(&ERR1.TRACKING BOARD.)
        SET &ERR2 = &STR(         LEVEL UPDTE HAS BEEN TERMINATED)
        SET &RSN1 = &STR(REASON : PARTIAL IMPLEMENTATION JOB MAY HAVE)
        SET &RSN1 = &STR(&RSN1 BEEN RUN.)
        SET &RSN2 = &STR(         TABLE UPDATE STEP MAY HAVE BEEN)
        SET &RSN2 = &STR(&RSN2 EXCLUDED FROM JOB STREAM)
        SET &ACT1 = &STR(ACTION:  ADD  &LVLSRC ZONE TO THE LEVL BOARD)
        WRITE
        WRITE **************************************************
        WRITE &ERR1
        WRITE &ERR2
        WRITE &RSN1
        WRITE &RSN2
        WRITE &ACT1
        WRITE **************************************************
        WRITE
        ISREDIT CANCEL
        EXIT CODE(12)
      ENDO
    ISREDIT (ROW,COL) = CURSOR
    SET &SRCLINE = &ROW
    ISREDIT (LINETXT) = LINE &SRCLINE
    SET &SRCLVL = &SUBSTR(16:18,(&LINETXT)
    SET &SRCDAT = &SUBSTR(24:31,(&LINETXT)
    SET &SRCTIM = &SUBSTR(36:40,(&LINETXT)
/*
/* DOES TARGET ZONE EXIST
/*
    SET &ENDCOL = &LENGTH(&LVLTRG)
    ISREDIT FIND FIRST &LVLTRG 1 &ENDCOL
    SET &RETCODE = &LASTCC
    IF &RETCODE = 4 THEN +
       SET &RESULT = NOTFOUND
    IF &RETCODE = 0 THEN +
       SET &RESULT = FOUND
/* DOES SOURCE ZONE EXIST
/*
    SET &ENDCOL = &LENGTH(&LVLSRC)
    ISREDIT FIND FIRST &LVLSRC 1 &ENDCOL
    SET &RETCODE = &LASTCC
    IF &RETCODE = 0 THEN +
     DO
       SET &OLDDAT = &STR(&SMPDAT)
       SET &OLDTIM = &STR(&SMPTIM)
     ENDO
/*
    IF &RESULT EQ NOTFOUND THEN +
        DO /* START OF NOTFOUND DO
         SET &LVLLVL = &SRCLVL
         ISPEXEC VPUT (LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM OLDDAT OLDTIM)
         ISREDIT LVLADD
        ENDO /* END OF NOTFOUND DO
    ELSE +
        DO /*  FOUND IT
         SET &LVLLVL = &SRCLVL
         ISPEXEC VPUT (LVLSRC LVLTRG LVLLVL)
         ISREDIT LVLDEL
         ISPEXEC VPUT (LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM OLDDAT OLDTIM)
         ISREDIT LVLADD
        ENDO
EXIT CODE(&MAXCC)
./ ADD NAME=MIGDBSC1 0132-92198-93339-1152-00287-00211-00287-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(MIGDBSC1)                               */
/* GDE: MANUEL PRISCIANDARO AND DAN BORGES                         */
/* DOC: THIS CLIST CALLS XDBS.SOFTWARE.CHANGES(ZONETABL) TO VERFIY */
/*      THAT THE */
/*      ZONE NAME BEING ENTERED EXISTS. IF THE DESTINATION ZONE    */
/*      DOES NOT EXIST IN THE TABLE IT WILL THEN PROMPT FOR DATA   */
/*      SET PREFIX                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (TGTSYS SRCZNE DESTZNE LV)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
            SET &JOBCLASS = S
/*                                                                 */
/* DB2 OR CSP SKELETON?                                            */
/*                                                                 */
    SET &PRODUCT = &STR(DB2)
    SET &CSPSFLAG = N
    SET &CSPDFLAG = N
    IF &SUBSTR(2:4,&STR(&SRCZNE )) = CSP THEN SET &CSPSFLAG = Y
    IF &SUBSTR(1:3,&STR(&SRCZNE )) = CSP THEN SET &CSPSFLAG = Y
    IF &SUBSTR(2:4,&STR(&DESTZNE )) = CSP THEN SET &CSPDFLAG = Y
    IF &SUBSTR(1:3,&STR(&DESTZNE )) = CSP THEN SET &CSPDFLAG = Y
    IF (&CSPSFLAG NE &CSPDFLAG) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INCOMPATIBLE ZONES)
        SET &ZERRLM = &STR(CANNOT MIX DB2 AND CSP ZONES)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC VPUT (SRCZNE DESTZNE)
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &CSPSFLAG = N THEN +
       SET &SKELE = DBSDSLST
    ELSE +
      DO
       SET &SKELE = CSPDSLST
    SET &PRODUCT = &STR(CSP)
      END
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET SRCFOUND = N
    SET DSTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
       ELSE EXIT
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &SRCZNE = &ZNENAME THEN +
        DO
          SET SKELSRC = &HILVL
          SET SRCFOUND = Y
        END
      IF &DESTZNE = &ZNENAME THEN +
        DO
         SET SKELDEST = &HILVL
         SET DSTFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN SPECIFIED DESTINATION ZONE +
                           ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &SRCFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(SRCE ZONE NAME NOT FOUND)
        SET &ZERRLM = &STR(SOURCE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*
/* IF MIGRATING TO A ACTIVE THAT EXISTS THEN ISSUE ERROR
/*
    SET TPOS = &SYSINDEX(TARGET,&SKELDEST)
    SET BPOS = &SYSINDEX(BACKUP,&SKELDEST)
    SET ACTCHK = &TPOS.&BPOS
    IF &ACTCHK = 0 THEN +
      DO
         %GETVOLID '&SKELDEST..CSI'
         ISPEXEC VGET (VOLID)
      END
    ELSE SET VOLID = NOCSI
    IF &ACTCHK = 0 AND &VOLID NE NOCSI THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(ACTIVE ALREADY EXISTS)
        SET &ZERRLM = &STR(MIGRATE FIRST TO THE TARGET AND THEN +
                           IMPLEMENT TO THE ACTIVE)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* CHECK IF SOURCE ZONE CSI EXISTS                                 */
/*                                                                 */
         %GETVOLID '&SKELSRC..CSI'
         ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(SRCE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELSRC..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
/* ADD COMPRESSION STEP IF SOURCE EQUALS TV2R3                     */
/*                                                                 */
    IF &SRCZNE = TV2R3 THEN +
      DO
        SET COMPRESS = Y
        SET VOLSRC = &VOLID
        ISPEXEC VPUT (VOLSRC)
      END
    ELSE SET COMPRESS = N
    ISPEXEC VPUT (COMPRESS)
/*
   SET &VOLID = NOCSI
   SET &DFOUND = N
/*
/* IF DESTINATION ZONE A TARGET, GET VOLID, IF IT EXISTS
/*
    SET &STRTPOS = &SYSINDEX(TARGET,&SKELDEST)
    IF &STRTPOS NE 0 THEN +
       DO                        /* SEE IF TARGET ACTUALLY EXISTS */
         %GETVOLID '&SKELDEST..CSI'   /* IF NOT FOUND, THE &VOLID */
         ISPEXEC VGET (VOLID)         /* WILL BE SET TO "NOCSI"   */
         IF &VOLID NE NOCSI THEN SET &DFOUND = Y
         SET &SKELACTV = &SUBSTR(1:&STRTPOS-2,&STR(&SKELDEST))
         %GETVOLID '&SKELACTV..BACKUP.CSI'
         ISPEXEC VGET (VOLID)
         IF &VOLID NE NOCSI THEN +
           DO  /* FOUND BACKUP;
             IF &SUBSTR(1:4,&SKELACTV) = &STR(XDBS) THEN +
                DO
                   SET LEN = &LENGTH(&SKELACTV)
                   SET &BKPZNE = B&SUBSTR(6:&LEN,&SKELACTV)
                END
             ELSE +
                SET &BKPZNE = B&SKELACTV
             %LVLNO &BKPZNE
             ISPEXEC VGET (LV4NTRY)
             SET &BKUPLVL = &LV4NTRY
             SET &SKELBKP = &SKELACTV..BACKUP
             SET &VOLBKP = &VOLID
             SET &BFOUND = Y
           END
         ELSE +
           DO /* DID NOT FIND BACKUP
             SET &BKUPLVL = &STR()
             SET &BKPZNE =  &STR()
             SET &SKELBKP = &STR()
             SET &VOLBKP =  &STR()
             SET &BFOUND = N
           END
         ISPEXEC VPUT (SKELBKP BKUPLVL VOLBKP BKPZNE BFOUND)
       END
/*
/* IF TARGET ZONE (CSI) WAS NOT FOUND, GET VOL FROM ACTIVE ZONE
/*
    IF &VOLID NE NOCSI THEN     /* VOLID CONTAINS VOL FOR TARGET */
    ELSE +
        DO                       /* GET VOL ID FROM ACTIVE ZONE */
          IF &STRTPOS NE 0 THEN +
            DO
             %GETVOLID '&SKELACTV..CSI'
             ISPEXEC VGET (VOLID)
            END
          ELSE +
            DO
             %GETVOLID '&SKELDEST..CSI'
             ISPEXEC VGET (VOLID)
             IF &VOLID NE NOCSI THEN SET &DFOUND = Y
            END
        END
    ISPEXEC VPUT (DFOUND)
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    %LVLNO &SRCZNE
    ISPEXEC VGET (LV4NTRY)
    SET &LV = &STR(&LV4NTRY)
    SET &LV = &LV
/*
/*    ISREDIT EDIT &PDSMBR
/* GO TO NEXT PANEL
    SET ENVRMENT = YES
    ISPEXEC VPUT (ENVRMENT PRODUCT)
    IF &DSTFOUND = N THEN +
      DO
        SET ENVRMENT = NO
        ISPEXEC VPUT (TGTSYS SRCZNE DESTZNE LV SKELSRC SKELE ENVRMENT +
                      JOBCLASS)
        ISPEXEC SELECT PANEL(MIGDBSP3)
        EXIT CODE(0)
      END
    IF &VOLID = NOCSI THEN +
      DO
        ISPEXEC VPUT (TGTSYS SRCZNE DESTZNE LV SKELDEST SKELSRC SKELE +
                      JOBCLASS)
        ISPEXEC SELECT PANEL(MIGDBSP4)
        EXIT CODE(0)
      END
    IF &SRCFOUND = Y AND &DSTFOUND = Y THEN +
      DO
        ISPEXEC VPUT (TGTSYS SRCZNE DESTZNE LV SKELSRC SKELDEST SKELE +
                      VOLID JOBCLASS)
        ISPEXEC SELECT PANEL(MIGDBSP2)
        EXIT CODE(0)
      END
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    EXIT CODE(&MAXCC)
./ ADD NAME=MIGDBSC2 0129-92198-93339-1151-00163-00100-00074-KETCSC
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(MIGDBSC2)                               */
/* GDE: D. BORGES AND M. PRISCIANDARO                             */
/* DOC: THIS CLIST TAILORS THE JOB TO CLONE A DB2 OR CSP TARGET ZONE */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
/*                                                                 */
ISPEXEC VGET (SRCZNE DESTZNE LV TGTSYS SKELSRC SKELDEST EDITIT  +
     PRODUCT  SKELE VOLID ENVRMENT DFOUND BFOUND SKELBKP)
/*                                                                 */
/* SET UP IEBCOPY SYSUT1 DEFAULT FOR STEP DSNEXIT                  */
/*                                                                 */
   SET &A = &SYSINDEX(TARGET,&SKELDEST)
   IF &A = 0 THEN +
      SET &IEBSUT1 = &SKELDEST
   ELSE +
      SET &IEBSUT1 = &SUBSTR(1:&A-2,&STR(&SKELDEST))
/*                                                                 */
/* SET UP DFDSS VARIABLE TRANSLATION FOR SKELETON                  */
/*                                                                 */
/* SET &LVLCNT = 1
/* SET &J = &SYSINDEX(.,&SKELSRC)
/* DO WHILE &J NE 0
/*    SET &LVLCNT = &LVLCNT + 1
/*    SET &JINDX = &SYSINDEX(.,&SKELSRC,&J+1)
/*    SET &J = &JINDX
/* END
/*
/* IF &LVLCNT = 1 THEN SET &DFDSSDST = &SYSUID
/*   ELSE +
/*     IF &LVLCNT = 2 THEN SET &DFDSSDST = &SYSUID.LVL2
/*       ELSE +
/*         IF &LVLCNT = 3 THEN SET &DFDSSDST = &SYSUID.LVL2.LVL3
/*            ELSE +
/*              DO
/*                SET &ZERRHM = &STR(*)
/*                SET &ZERRALRM = &STR(NO)
/*                SET &ZERRSM = &STR(TOO MANY LEVELS)
/*                SET &ZERRLM = &STR(&SKELSRC CANNOT BE > THAN 3 LVLS)
/*                SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
/*                ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
/*                ISPEXEC SETMSG MSG(ISRZ002)
/*                EXIT CODE(0)
/*              END
/*                                                                 */
/* TAILOR THE JCL                                                  */
/*                                                                 */

BEGDSLST: +
SET RC = 0
/* FREE FILE(SYSDVAL)
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(&SKELE)') +
    SHR REUSE
  ISPEXEC TBCREATE TABLEMIG +
    NAMES(SUFFIX SRCFLAG DESTFLAG BKPFLAG SUFFIX2) +
    NOWRITE
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  DO WHILE &RC = 0
    READDVAL DSSUFFIX
    SET SUFFIX = &DSSUFFIX
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELSRC..&SUFFIX')
    SET &SRCCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&SRCCC EQ 0) THEN SET SRCFLAG = Y
      ELSE SET SRCFLAG = N
    IF &DFOUND = Y THEN +
      DO
        SET SYSOUTTRAP = 500
        LISTCAT ENTRY('&SKELDEST..&SUFFIX')
        SET &DESTCC = &LASTCC
        SET SYSOUTTRAP = 0
        IF (&DESTCC EQ 0) THEN SET DESTFLAG = Y
          ELSE SET DESTFLAG = N
      END
    ELSE SET DESTFLAG = N
    IF &BFOUND = Y THEN +
      DO
        SET SYSOUTTRAP = 500
        LISTCAT ENTRY('&SKELBKP..&SUFFIX')
        SET &DESTCC = &LASTCC
        SET SYSOUTTRAP = 0
        IF (&DESTCC EQ 0) THEN SET BKPFLAG = Y
          ELSE SET BKPFLAG = N
      END
    ELSE SET BKPFLAG = N
    SET SUFFIX2 = &STR(, -)
    ISPEXEC TBADD TABLEMIG
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
ENDDSLST: +
       ISPEXEC TBBOTTOM TABLEMIG
       SET SUFFIX2 = &STR(  -)
       ISPEXEC TBPUT TABLEMIG
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC VPUT (SRCZNE DESTZNE PRODUCT) SHARED
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL MIGDBSS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC TBEND TABLEMIG
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        GOTO WRAPUP
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
/*                                                                 */
/* IF THIS IS NEW ENVIRONNMENT GIVE OPTION TO EDIT ZONE TABLE      */
/*                                                                 */
WRAPUP: +
IF &ENVRMENT EQ NO THEN +
   DO
    ISPEXEC DISPLAY PANEL(MIGDBSP5)
    ISPEXEC VGET (UPDTABL)
    IF &UPDTABL EQ Y THEN +
      ISPEXEC EDIT DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
       MACRO (ZTABLMAC)
   END
/*                                                                 */
    EXIT CODE(0)
./ ADD NAME=MIGOEMC1 0142-93189-93330-1316-00447-00153-00432-KETCSC
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: CLIST(MIGOEMC1)                                            */
/* GDE: M. PRISCIANDARO                                            */
/* DOC: THIS CLIST TAILORS THE JOB TO CLONE A OEM TARGET ZONE      */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS END(ENDO) NOMSG
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       ENDO
    ISPEXEC CONTROL ERRORS RETURN
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    %GETSYSID
    ISPEXEC VGET (SYSID) SHARED
    SET &TGTSYS = &SYSID
    SET &SRCZNE = &STR()
    SET &DESTZNE = &STR()
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(TABLEDS) SHR  DA('&DSNAME.') REUSE
/*                                                                 */
/* BUILD A LIST OF OEM PRODUCTS FROM OEMDSLST AND EACH PRODUCTS    */
/* LIST OF DATASETS BY DDNAME.                                     */
/*                                                                 */
BEGDSLST: +
    SET RC = 0
    SET DDCTR = 0
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(OEMDSLST)') +
      SHR REUSE
    ISPEXEC TBCREATE PANELSEL +
      NAMES(CMD PRODUCT) +
      NOWRITE LIBRARY(TABLEDS)
    ISPEXEC TBCREATE TABLEMIG +
      NAMES(PDUCTLST SUFFIX PDUCTCHK SRCFLAG DESTFLAG SUFFIX2 DDCTR) +
      WRITE LIBRARY(TABLEDS)
    SET CMD = &STR( )
    OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
    SET &OPRODUCT = &STR()
    DO WHILE &RC = 0
      READDVAL PRODUCT SUFFIX PDUCTCHK
      SET &PDUCTLST = &PRODUCT
      SET DDCTR = &DDCTR + 1
      ISPEXEC TBADD TABLEMIG
      IF &PRODUCT ^= &OPRODUCT THEN +
        DO
          ISPEXEC TBADD PANELSEL
          SET &OPRODUCT = &PRODUCT
        ENDO
      ERROR +
        DO
          ERROR OFF
          GOTO EOFDSLST
        ENDO
      GETFILE SYSDVAL
      ERROR OFF
    ENDO
EOFDSLST: +
    ISPEXEC TBTOP PANELSEL
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
/*                                                                 */
/* THIS LIST IS THEN USED TO DISPLAY AN OEM PANEL SELECTION LIST   */
/*                                                                 */
SELPROD: +
    ISPEXEC TBDISPL PANELSEL +
        PANEL(MIGOEMP1) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        ISPEXEC TBCLOSE PANELSEL LIBRARY(TABLEDS)
        ISPEXEC TBERASE PANELSEL LIBRARY(TABLEDS)
        ISPEXEC TBCLOSE TABLEMIG LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEMIG LIBRARY(TABLEDS)
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(REQUEST CANCELLED)     /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(YOU CANCELLED THE)     /*  LONG MESSAGE     */
    SET &ZERRLM = &STR(&ZERRLM REQUEST, WHAT MORE DO YOU NEED TO KNOW?)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
        EXIT CODE(0)
      ENDO
    DO WHILE &ZTDSELS > 0
      SET &MIGPROD = &PRODUCT
      IF (&NRSTR(&CMD) NE ) THEN +
        GOTO LOOPBR
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    GOTO SELPROD
/*                                                                 */
/* USER SELECTED ONE, PROCESS THE REQUEST.                         */
/*                                                                 */
LOOPBR: +
    ISPEXEC TBTOP TABLEMIG
    ISPEXEC TBSKIP TABLEMIG
/*                                                                 */
/* DELETE DATASETS NOT FROM THIS PRODUCT.                          */
/*                                                                 */
    SET MYCC = 0
    DO WHILE &MYCC = 0
      IF &PRODUCT ^= &PDUCTLST THEN +
        DO
           ISPEXEC TBDELETE TABLEMIG
        ENDO
      ISPEXEC TBSKIP TABLEMIG
      SET &MYCC = &LASTCC
    ENDO
    ISPEXEC TBEND PANELSEL
/*                                                                 */
/* GET ZONE NAMES                                                  */
/*                                                                 */
    SET &JOB = MIGRATE
    SET &DOIN = &STR(WAITING FOR YOU TO ENTER ZONE NAMES)
    ISPEXEC DISPLAY PANEL(MIGOEMP2)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        ISPEXEC TBCLOSE PANELSEL LIBRARY(TABLEDS)
        ISPEXEC TBERASE PANELSEL LIBRARY(TABLEDS)
        ISPEXEC TBCLOSE TABLEMIG LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEMIG LIBRARY(TABLEDS)
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(REQUEST CANCELLED)     /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(YOU CANCELLED THE)     /*  LONG MESSAGE     */
    SET &ZERRLM = &STR(&ZERRLM REQUEST, WHAT MORE DO YOU NEED TO KNOW?)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
        EXIT CODE(0)
      ENDO
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
          IF &TGTSYS = MVSW THEN SET &JOBCLASS = J
            ELSE +
              SET &JOBCLASS = S
/*                                                                 */
/* READ ZONE TABLE AND VERIFY IF IT IS OKAY TO MIGRATE FROM HERE   */
/*                                                                 */
    SET &DOIN = &STR(VALIDATING ZONES AND SYSTEM AUTHORITY)
    ISPEXEC CONTROL DISPLAY LOCK
    ISPEXEC DISPLAY PANEL(MIGOEMP2)
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(ZONETABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO WRAPUP
      ENDO
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO WRAPUP
      ENDO
    SET SRCFOUND = N
    SET DSTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        ENDO
       ELSE EXIT CODE(4)
     ENDO
/* FIRST TWO GETFILES READ IN THE HEADING
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &SRCZNE = &ZNENAME THEN +
        DO
          SET SKELSRC = &HILVL
          SET SRCFOUND = Y
        ENDO
      IF &DESTZNE = &ZNENAME THEN +
        DO
         SET SKELDEST = &HILVL
         SET DSTFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        ENDO
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    ENDO
    CONTROL CONLIST LIST SYMLIST
/*                                                                 */
/* BASED ON LOGIC ABOVE, CAN IT BE DONE?                           */
/*                                                                 */
ACTION: +
    ERROR OFF
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN SPECIFIED DESTINATION ZONE +
                           ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      ENDO
    IF &SRCFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(SRCE ZONE NAME NOT FOUND)
        SET &ZERRLM = &STR(SOURCE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      ENDO
    IF &DSTFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(DEST ZONE NAME NOT FOUND)
        SET &ZERRLM = &STR(DEST ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      ENDO
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    SET &DOIN = &STR(OBTAINING LEVEL OF THE SOURCE ZONE)
    ISPEXEC CONTROL DISPLAY LOCK
    ISPEXEC DISPLAY PANEL(MIGOEMP2)
    %OEMLVL# &PRODUCT &SRCZNE
    ISPEXEC VGET (LV4NTRY)
    SET &LV = &STR(&LV4NTRY)
    SET &LV = &LV
/*
/* CHECK IF SOURCE DATASETS EXIST
/*
    ISPEXEC TBTOP TABLEMIG
    ISPEXEC TBSKIP TABLEMIG
    SET &ENDTABLE = NO
    DO WHILE &ENDTABLE = NO
       IF &PDUCTCHK = &STR(X) THEN +
          DO
             SET &PDUCTSFX = &SUFFIX
             SET &ENDTABLE = YES
          ENDO
       ELSE +
          DO
             ISPEXEC TBSKIP TABLEMIG
             SET MYCC = &LASTCC
             IF &MYCC = 8 THEN +
                DO
                   SET &ENDTABLE = YES
                   SET &ZERRHM = &STR(*)
                   SET &ZERRALRM = &STR(NO)
                   SET &ZERRSM = &STR(LOADLIB NOT CHECKED)
                   SET &ZERRLM = &STR('&PRODUCT HAS NO LOADLIB X')
                   SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
                   ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
                   ISPEXEC SETMSG MSG(ISRZ002)
                   EXIT CODE(0)
                ENDO
          ENDO
    ENDO
/*                                                                 */
/* FIND WHAT VOLUME THIS DATASET IS ON                             */
/*                                                                 */
    SET &DOIN = &STR(CHECKING WHERE &SKELSRC..&PDUCTSFX RESIDES)
    ISPEXEC CONTROL DISPLAY LOCK
    ISPEXEC DISPLAY PANEL(MIGOEMP2)
    %GETVOLID '&SKELSRC..&PDUCTSFX'
    ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(SRCE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELSRC..&PDUCTSFX' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      ENDO
    SET &DFOUND = N
    SET &DOIN = &STR(CHECKING WHERE &SKELDEST..&PDUCTSFX RESIDES)
    ISPEXEC CONTROL DISPLAY LOCK
    ISPEXEC DISPLAY PANEL(MIGOEMP2)
    %GETVOLID '&SKELDEST..&PDUCTSFX'
    ISPEXEC VGET (VOLID)
    IF &VOLID NE NOCSI THEN SET &DFOUND = Y
    IF &VOLID = NOCSI THEN SET &VOLID = &STR()
/*                                                                 */
/* FIND WHAT DATASETS FROM THE LIST EXIST                          */
/*                                                                 */
    ISPEXEC TBTOP TABLEMIG
    ISPEXEC TBSKIP TABLEMIG
    SET RC = 0
    SET DDCTR = 0
    DO WHILE &RC = 0
      SET &DOIN = &STR(CHECKING IF &SUFFIX EXISTS)
      ISPEXEC CONTROL DISPLAY LOCK
      ISPEXEC DISPLAY PANEL(MIGOEMP2)
      SET SYSOUTTRAP = 500
      LISTCAT ENTRY('&SKELSRC..&SUFFIX')
      SET &SRCCC = &LASTCC
      SET SYSOUTTRAP = 0
      IF (&SRCCC EQ 0) THEN SET SRCFLAG = Y
        ELSE SET SRCFLAG = N
      IF &DFOUND = Y THEN +
        DO
          SET SYSOUTTRAP = 500
          LISTCAT ENTRY('&SKELDEST..&SUFFIX')
          SET &DESTCC = &LASTCC
          SET SYSOUTTRAP = 0
          IF (&DESTCC EQ 0) THEN SET DESTFLAG = Y
            ELSE SET DESTFLAG = N
         ENDO
       ELSE SET DESTFLAG = N
       SET SUFFIX2 = &STR(, -)
       ISPEXEC TBPUT TABLEMIG
       ISPEXEC TBSKIP TABLEMIG
       SET &RC = &LASTCC
       IF &RC = 8 THEN +
         DO
           GOTO ENDDSLST
         ENDO
    ENDO
/*                                                                 */
/* VERIFY MIGRATE GENERATION AND VOLSER TO BE USED                 */
/*                                                                 */
ENDDSLST: +
       ISPEXEC TBBOTTOM TABLEMIG
       SET SUFFIX2 = &STR(  -)
       ISPEXEC TBPUT TABLEMIG
    IF &SRCFOUND = Y AND &DSTFOUND = Y THEN +
      DO
        SET &EDITIT= Y
   SET &JC1 = &STR(//&SYSUID.M JOB (A006,SYTM,99,99),'10DB2GRP: MIG', )
        SET &JC2 = &STR(//         CLASS=&JOBCLASS,MSGCLASS=V,)
        SET &JC3 = &STR(//           NOTIFY=&SYSUID,REGION=8M,TIME=1200)
        SET &JC4 = &STR(//*ROUTE XEQ   CSCBATCH DOFNY)
        SET &JC5 = &STR(//*ROUTE PRINT CSCBATCH)
        ISPEXEC DISPLAY PANEL(MIGOEMP3)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        ISPEXEC TBCLOSE PANELSEL LIBRARY(TABLEDS)
        ISPEXEC TBERASE PANELSEL LIBRARY(TABLEDS)
        ISPEXEC TBCLOSE TABLEMIG LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEMIG LIBRARY(TABLEDS)
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(REQUEST CANCELLED)     /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(YOU CANCELLED THE)     /*  LONG MESSAGE     */
    SET &ZERRLM = &STR(&ZERRLM REQUEST, WHAT MORE DO YOU NEED TO KNOW?)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
        EXIT CODE(0)
      ENDO
        ISPEXEC FTOPEN TEMP
        SET &MYCC = &LASTCC
        ISPEXEC FTINCL MIGOEMS1
        SET &MYCC = &LASTCC.&MYCC
        ISPEXEC FTCLOSE
        SET &MYCC = &LASTCC.&MYCC
        IF (&MYCC NE 0) THEN +
          DO
            SET &ZERRHM = &STR(*)
            SET &ZERRALRM = &STR(NO)
            SET &ZERRSM = &STR(TAILORING FAILED)
            SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
            SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
            ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
            ISPEXEC SETMSG MSG(ISRZ002)
            ISPEXEC TBCLOSE TABLEMIG LIBRARY(TABLEDS)
            ISPEXEC TBERASE TABLEMIG LIBRARY(TABLEDS)
            ISPEXEC TBCLOSE PANELSEL LIBRARY(TABLEDS)
            ISPEXEC TBERASE PANELSEL LIBRARY(TABLEDS)
            FREE FILE(TABLEDS)
            EXIT CODE(0)
          ENDO
        ISPEXEC VGET ZTEMPF
/*                                                                 */
/*      EDIT ????????????????????????????????????????              */
/*                                                                 */
        IF (&EDITIT = Y) THEN +
          DO
            ISPEXEC EDIT DATASET('&ZTEMPF')
            GOTO WRAPUP
          ENDO
/*                                                                 */
/*      SUBMIT JCL                                                 */
/*                                                                 */
        ISPEXEC CONTROL DISPLAY SM START(13)
        CONTROL MSG
        SUBMIT '&ZTEMPF' NOHOLD
        CONTROL NOMSG
        ISPEXEC TBCLOSE TABLEMIG LIBRARY(TABLEDS)
        ISPEXEC TBERASE TABLEMIG LIBRARY(TABLEDS)
        ISPEXEC TBCLOSE PANELSEL LIBRARY(TABLEDS)
        ISPEXEC TBERASE PANELSEL LIBRARY(TABLEDS)
        FREE FILE(TABLEDS)
        EXIT CODE(0)
      ENDO
WRAPUP: +
    ISPEXEC TBCLOSE PANELSEL LIBRARY(TABLEDS)
    ISPEXEC TBERASE PANELSEL LIBRARY(TABLEDS)
    ISPEXEC TBCLOSE TABLEMIG LIBRARY(TABLEDS)
    ISPEXEC TBERASE TABLEMIG LIBRARY(TABLEDS)
    FREE FILE(TABLEDS)
    EXIT CODE(0)
./ ADD NAME=MIGOMGC1 0100-93049-93049-1128-00206-00206-00000-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(MIGOMGC1)                               */
/* GDE: MANUEL PRISCIANDARO AND DAN BORGES                         */
/*      AND MODIFIED BY KEN TOMIAK FOR OMEGAMON II FOR DB2.        */
/* DOC: THIS CLIST CALLS XDBS.SOFTWARE.CHANGES(ZONETABL) TO VERFIY */
/*      ZONE NAME BEING ENTERED EXISTS. IF THE DESTINATION ZONE    */
/*      DOES NOT EXIST IN THE TABLE IT WILL THEN PROMPT FOR DATA   */
/*      SET PREFIX                                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (TGTSYS SRCZNE DESTZNE LV)
/*                                                                 */
/* SET JOBCLASS TO CLASS OF SYSTEM YOU ARE LOGGED ON TO            */
/*                                                                 */
    IF &TGTSYS = DOFD OR &TGTSYS = DOFX THEN SET &JOBCLASS = J
      ELSE +
      IF &TGTSYS = DOFP THEN SET &JOBCLASS = K
        ELSE +
        IF &TGTSYS = MVSP OR &TGTSYS = MVSX THEN SET &JOBCLASS = S
          ELSE +
            SET &JOBCLASS = V
/*                                                                 */
    SET &SKELE = OMGDSLST
/*                                                                 */
/* READ ZONE TABLE
/*                                                                 */
    FREE FILE(SYSDVAL)
    ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(OMEGTABL)') +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      END
    OPENFILE SYSDVAL INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      END
/* FIRST TWO GETFILES READ IN THE HEADING
    SET SRCFOUND = N
    SET DSTFOUND = N
    SET RC = 0
    SET EOF = OFF
    SET RCODE = 0
    ERROR +
     DO
       SET RCODE = &LASTCC
       IF &RCODE = 400 THEN +
        DO
         CLOSFILE SYSDVAL
         FREE FILE(SYSDVAL)
         SET EOF = ON
         RETURN
        END
        ELSE DO
          SET &ZERRHM = &STR(*)
          SET &ZERRALRM = &STR(YES)
          SET &ZERRSM = &STR(OTHER ERROR)
          SET &ZERRLM = &STR(SOME OTHER ERROR OCCURRED)
          ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
          ISPEXEC SETMSG MSG(ISRZ002)
          EXIT
       END
     END
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    GETFILE SYSDVAL
    DO WHILE &RC = 0
      READDVAL ZNENAME HILVL S1 S2 S3 S4 S5 S6 S7 S8
      IF &SRCZNE = &ZNENAME THEN +
        DO
          SET SKELSRC = &HILVL
          SET SRCFOUND = Y
        END
      IF &DESTZNE = &ZNENAME THEN +
        DO
         SET SKELDEST = &HILVL
         SET DSTFOUND = Y
         SET SYSSRCH = &SYSINDEX(&TGTSYS,&STR(&S1&S2&S3&S4&S5&S6&S7&S8))
         IF &SYSSRCH = 0 THEN +
            SET VALIDSYS = N
         ELSE +
            SET VALIDSYS = Y
        END
      GETFILE SYSDVAL
      IF &EOF = ON THEN GOTO ACTION
    END
ACTION: +
    IF &VALIDSYS = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(INVALID SYSTEM)
        SET &ZERRLM = &STR(CANNOT RUN SPECIFIED DESTINATION ZONE +
                           ON THIS SYSTEM)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    IF &SRCFOUND = N THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(SRCE ZONE NAME NOT FOUND)
        SET &ZERRLM = &STR(SOURCE ZONE NAME NOT FOUND IN TABLE +
                           'XDBS.SOFTWARE.CHANGES(ZONETABL)')
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*                                                                 */
         %GETVOLID '&SKELSRC..CSI'
         ISPEXEC VGET (VOLID)
    IF (&VOLID EQ NOCSI) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(SRCE DATASET NOT FOUND)
        SET &ZERRLM = &STR('&SKELSRC..CSI' NOT FOUND)
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
/*
   SET &VOLID = NOCSI
   SET &DFOUND = N
/*
/* IF DESTINATION ZONE A TARGET, GET VOLID, IF IT EXISTS
/*
    SET &STRTPOS = &SYSINDEX(TARGET,&SKELDEST)
    IF &STRTPOS NE 0 THEN +
       DO                        /* SEE IF TARGET ACTUALLY EXISTS */
         %GETVOLID '&SKELDEST..CSI'   /* IF NOT FOUND, THE &VOLID */
         ISPEXEC VGET (VOLID)         /* WILL BE SET TO "NOCSI"   */
         IF &VOLID NE NOCSI THEN SET &DFOUND = Y
       END
/*
/* IF TARGET ZONE (CSI) WAS NOT FOUND, GET VOL FROM ACTIVE ZONE
/*
    IF &VOLID NE NOCSI THEN     /* VOLID CONTAINS VOL FOR TARGET */
    ELSE +
        DO                       /* GET VOL ID FROM ACTIVE ZONE */
          IF &STRTPOS NE 0 THEN +
            DO
             SET &SKELACTV = &SUBSTR(1:&STRTPOS-2,&STR(&SKELDEST))
             %GETVOLID '&SKELACTV..CSI'
             ISPEXEC VGET (VOLID)
            END
          ELSE +
            DO
             %GETVOLID '&SKELDEST..CSI'
             ISPEXEC VGET (VOLID)
             IF &VOLID NE NOCSI THEN SET &DFOUND = Y
            END
        END
    ISPEXEC VPUT (DFOUND)
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    %OMEGLVL &SRCZNE
    ISPEXEC VGET (LV4NTRY)
    SET &LV = &STR(&LV4NTRY)
/*
/*    ISREDIT EDIT &PDSMBR
/* GO TO NEXT PANEL
    SET ENVRMENT = YES
    ISPEXEC VPUT (ENVRMENT)
    IF &DSTFOUND = N THEN +
      DO
        SET ENVRMENT = NO
        ISPEXEC VPUT (TGTSYS SRCZNE DESTZNE LV SKELSRC SKELE ENVRMENT +
                      JOBCLASS)
        ISPEXEC SELECT PANEL(MIGOMGP3)
        EXIT CODE(0)
      END
    IF &VOLID = NOCSI THEN +
      DO
        ISPEXEC VPUT (TGTSYS SRCZNE DESTZNE LV SKELDEST SKELSRC SKELE +
                      JOBCLASS)
        ISPEXEC SELECT PANEL(MIGOMGP4)
        EXIT CODE(0)
      END
    IF &SRCFOUND = Y AND &DSTFOUND = Y THEN +
      DO
        ISPEXEC VPUT (TGTSYS SRCZNE DESTZNE LV SKELSRC SKELDEST SKELE +
                      VOLID JOBCLASS)
        ISPEXEC SELECT PANEL(MIGOMGP2)
        EXIT CODE(0)
      END
ABORTIT: +
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    EXIT CODE(&MAXCC)
./ ADD NAME=MIGOMGC2 0102-93049-94011-1707-00126-00123-00004-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(MIGOMGC2)                                            */
/* GDE: D. BORGES AND M. PRISCIANDARO                              */
/* DOC: THIS CLIST TAILORS THE JOB TO CLONE OMEGAMON II FOR DB2.   */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
    CONTROL NOLIST NOFLUSH  MAIN CAPS
/*  CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    IF (&SYSUID = 'DB2CSC') OR +
       (&SYSUID = 'DD20010') THEN +
       DO
         WRITE USE YOUR OWN ID FOR THIS FUNCTION.
         EXIT CODE(4)
       END
    ISPEXEC CONTROL ERRORS RETURN
/*                                                                 */
ISPEXEC VGET (SRCZNE DESTZNE LV TGTSYS SKELSRC SKELDEST EDITIT  +
              SKELE VOLID ENVRMENT DFOUND)
/*                                                                 */
/* SET UP IEBCOPY SYSUT1 DEFAULT FOR STEP DSNEXIT                  */
/*                                                                 */
   SET &A = &SYSINDEX(TARGET,&SKELDEST)
   IF &A = 0 THEN +
      SET &IEBSUT1 = &SKELDEST
   ELSE +
      SET &IEBSUT1 = &SUBSTR(1:&A-2,&STR(&SKELDEST))
   SET &ACTZNE = &SUBSTR(1:4,&STR(&SKELDEST))
   IF (&STR(&ACTZNE) = 'DSN.') THEN +
     SET &ACTZNE = &SUBSTR(1:3,&STR(&SKELDEST))
/*                                                                 */
/*                                                                 */
BEGDSLST: +
    SET RC = 0
  ALLOC FILE(SYSDVAL) DATASET('XDBS.SOFTWARE.CHANGES(&SKELE)') +
    SHR REUSE
  ISPEXEC TBCREATE TABLEMIG +
    NAMES(SUFFIX SRCFLAG DESTFLAG SUFFIX2) +
    NOWRITE
  OPENFILE SYSDVAL INPUT
    GETFILE SYSDVAL
  DO WHILE &RC = 0
    READDVAL DSSUFFIX
    SET SUFFIX = &DSSUFFIX
    SET SYSOUTTRAP = 500
    LISTCAT ENTRY('&SKELSRC..&SUFFIX')
    SET &SRCCC = &LASTCC
    SET SYSOUTTRAP = 0
    IF (&SRCCC EQ 0) THEN SET SRCFLAG = Y
      ELSE SET SRCFLAG = N
    IF &DFOUND = Y THEN +
      DO
        SET SYSOUTTRAP = 500
        LISTCAT ENTRY('&SKELDEST..&SUFFIX')
        SET &DESTCC = &LASTCC
        SET SYSOUTTRAP = 0
        IF (&DESTCC EQ 0) THEN SET DESTFLAG = Y
          ELSE SET DESTFLAG = N
      END
    ELSE SET DESTFLAG = N
    SET SUFFIX2 = &STR(, -)
    ISPEXEC TBADD TABLEMIG
    ERROR +
     DO
       ERROR OFF
       GOTO ENDDSLST
     END
    GETFILE SYSDVAL
    ERROR OFF
  END
ENDDSLST: +
       ISPEXEC TBBOTTOM TABLEMIG
       SET SUFFIX2 = &STR(  -)
       ISPEXEC TBPUT TABLEMIG
    CLOSFILE SYSDVAL
    FREE FILE(SYSDVAL)
    ISPEXEC VPUT (SRCZNE DESTZNE) SHARED
    ISPEXEC FTOPEN TEMP
    SET &MYCC = &LASTCC
    ISPEXEC FTINCL MIGOMGS1
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC FTCLOSE
    SET &MYCC = &LASTCC.&MYCC
    ISPEXEC TBEND TABLEMIG
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(TAILORING FAILED)
        SET &ZERRLM = &STR(FILE TAILORING FAILED WITH
        SET &ZERRLM = &STR(&ZERRLM RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      END
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* EDIT ????????????????????????????????????????                   */
/*                                                                 */
    IF (&EDITIT = Y) THEN +
      DO
        ISPEXEC EDIT DATASET('&ZTEMPF')
        GOTO WRAPUP
      END
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
/*                                                                 */
/* IF THIS IS NEW ENVIRONNMENT GIVE OPTION TO EDIT ZONE TABLE      */
/*                                                                 */
WRAPUP: +
IF &ENVRMENT EQ NO THEN +
   DO
    ISPEXEC DISPLAY PANEL(MIGOMGP5)
    ISPEXEC VGET (UPDTABL)
    IF &UPDTABL EQ Y THEN +
      ISPEXEC EDIT DATASET('XDBS.SOFTWARE.CHANGES(OMEGTABL)') +
       MACRO (ZTABLMAC)
   END
/*                                                                 */
    EXIT CODE(0)
./ ADD NAME=MYSUB    0101-92328-93021-0837-00078-00078-00000-KETCSC
ISREDIT MACRO
/*                                                                 */
/* LIB: CLIST(MYSUB)                                               */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS MACRO WRAPS THE USERS PASSWORD INTO A JOB.            */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    SET &SUID = &SYSUID
    ISPEXEC DISPLAY PANEL(MYSUB)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(CANCELLED)
        SET &ZERRLM = &STR(YOU CANCELLED THE JOB SUBMISSION)
        SET &ZERRLM = &STR(&ZERRLM REQUEST)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(0)
      ENDO                                                         */
    ISREDIT (LPTR,COL) = CURSOR
    ISREDIT CURSOR = .ZLAST &COL
    ISREDIT (LASTLINE,COL) = CURSOR
    ISREDIT CURSOR = &LPTR &COL
    FREE FILE(MYSUB)
    DELETE MYSUB.CNTL
    ALLOC FILE(MYSUB) DATASET(MYSUB.CNTL) +
      RECFM(F B) BLKSIZE(3120) LRECL(80) +
      NEW CATALOG UNIT(SYSDA) +
      SPACE(1 5) TRACKS
    OPENFILE MYSUB OUTPUT
    SET &CTR = 2
    ISREDIT (MYSUB) = LINE 1
    PUTFILE MYSUB
    SET &MYSUB = &STR(//             )
    SET &MYSUB = &STR(&MYSUB.USER=&SUID,PASSWORD=&SUIDPSWD, )
    PUTFILE MYSUB
    DO WHILE &CTR <= &LASTLINE
      ISREDIT (MYSUB) = LINE &CTR
      PUTFILE MYSUB
      SET &CTR = &CTR + 1
    ENDO
    CLOSFILE MYSUB
    CONTROL MSG
    SET &SYSOUTTRAP = 200
    SUBMIT MYSUB.CNTL
    SET &MYCC = &LASTCC
    SET &SYSOUTTRAP = 0
    CONTROL NOMSG
    FREE FILE(MYSUB)
    DELETE MYSUB.CNTL
    SET &SYSDVAL = &NRSTR(&SYSOUTLINE1)
    READDVAL MSGID JOB JOBTXT JUNK
    IF (&MSGID NE IKJ56250I) THEN +
      DO
        SET &SYSDVAL = &NRSTR(&SYSOUTLINE3)
        READDVAL MSGID JOB JOBTXT JUNK
      ENDO
    SET &JE = &LENGTH(&JOBTXT)
    SET &JE = &JE - 1
    SET &NE = &JE - 9
    SET &JOBNAME = &SUBSTR(1:&NE,&JOBTXT)
    SET &JS = &JE - 4
    SET &JNUM = &SUBSTR(&JS:&JE,&JOBTXT)
    SET &JNUM = &JNUM
/*                                                                 */
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(YES)                 /*  ALARM STATUS     */
    SET &ZERRSM = &STR(#&JNUM SUBMITTED)      /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(MYSUB SUBMITTED &JOBNAME)
    SET &ZERRLM = &STR(&ZERRLM #&JNUM FOR YOU WITH USERID/PASSWORD)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
/*                                                                 */
    EXIT CODE(&MYCC)
./ ADD NAME=NEST     0101-92217-93295-1328-00027-00026-00000-KETCSC
PROC 0 PANEL()
/*********************************************************************/
/*                                                                   */
/* LIB: IPO1.CMDPROC(NEST)                                           */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS CLIST POPS UP ANOTHER ISPF MENU.                        */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG MAIN
    ISPEXEC CONTROL ERRORS RETURN
    GETSYSID
    SET &PANEL = &SYSCAPS(&PANEL)
    IF &PANEL = &STR() THEN +
      DO
        IF (&SYSID EQ DOFC) THEN SET &PANEL = ISP@MSTR
        IF (&SYSID EQ DOFT) THEN SET &PANEL = ISP@MSTR
        IF (&SYSID EQ MVSE) THEN SET &PANEL = CSC@MSTR
        IF (&SYSID EQ DOFP) THEN SET &PANEL = DOF@MSTR
        IF (&SYSID EQ DOFD) THEN SET &PANEL = DOF@MSTR
        IF (&SYSID EQ MVSP) THEN SET &PANEL = CSC@MSTR
        IF (&SYSID EQ MVSX) THEN SET &PANEL = CSC@MSTR
        IF (&SYSID EQ MVSZ) THEN SET &PANEL = CSC@MSTR
        IF (&SYSID EQ MVSW) THEN SET &PANEL = CSC@MSTR
      END
    ELSE +
      SET &PNL = PANEL(ISR@MSTR)
    ISPEXEC SELECT PANEL(&PANEL)
./ ADD NAME=NO       0100-92106-92106-1330-00048-00048-00000-DMV0016
PROC 0 PANEL()
 /*                                                                  */
 /* LIB: CLIST(ISPFON)                                               */
 /* GDE: KEN TOMIAK                                                  */
 /* DOC: THIS CLIST ALLOCATES THE TSO AND ISPF DDNAMES.              */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS
    IF (&SYSUID = DMV0016) OR +
       (&SYSUID = SUE)     OR +
       (&SYSUID = MJLCSC)  OR +
       (&SYSUID = BORGY)   OR +
       (&SYSUID = MANN)    OR +
       (&SYSUID = PETE)    OR +
       (&SYSUID = AXGCSC)  THEN +
      GOTO BEGIN
    SE '&SYSUID ON &SYSPROC' U(DMV0016) LOGON
    EXIT CODE(0)
BEGIN: +
    SE '&SYSUID ON &SYSPROC' U(DMV0016) LOGON
    GETSYSID
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    SET &PGMR = &PGMR
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE         %ipcs new (to invoke Interactive Problem Control)
    WRITE
./ ADD NAME=ODOCCLN  0106-92051-92056-1522-00036-00041-00000-DD20002
PROC 3 FROMZN TOZN LV
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(DOCCLNE)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST DOCUMENTS A BACKUP SCENARIO.                    */
/*                                                                 */
/*  CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
    CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
/*
    SET &DSN = XDBS.SOFTWARE.TESTING    /* PDS DOC MEMBERS RESIDE IN
/*
/* NAMES OF MEMBERS TO BE UPDATED WITH INFORMATION
/* SHOULD NOT HAVE ANY PREFIXES SUCH AS A 'T'
/*
    IF &SUBSTR(1:1,&STR(&TOZN)) = T  THEN +
      DO                            /* STRIP PREFIX OUT OF NAME
        SET ENDOFSTR =  &LENGTH(&TOZN)
        SET &MEMBER = &SUBSTR(2:&ENDOFSTR,&STR(&TOZN))
      ENDO                          /* END STRIP PREFIX
    ELSE +
      SET &MEMBER = &TOZN         /* THE 'TO' ZONE HAD NO PREFIX
/*
    SET &PDSMBR = &STR(&MEMBER)     /* PDSMBR NOW HAS NO PREFIX
/*
    ISPEXEC VPUT (FROMZN TOZN LV) SHARED
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(DOCCLNEM)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        WRITE &NRSTR(&PDSDSN)
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=ODOCCLNM 0124-92051-92051-1348-00094-00076-00000-DD20002
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCBKPM)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE CHANGES MEMBER FOR BACKUPS.      */
/*                                                                   */
/*********************************************************************/
/*  CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
    CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (FROMZN TOZN LV)
/*
    WRITE '************' &FROMZN &TOZN &LV
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/* INITIALIZE &NEWDASH
    SET &NEWDASH = &STR(-------- ------- -------- -----)
    SET &NEWDASH = &STR(&NEWDASH -----------------------------------)
    SET &NEWDASH = &STR(&NEWDASH.-----)
    WRITE &NRSTR(&NEWDASH)
/*
    ISREDIT F '----- --' FIRST
    SET &MYCC = &LASTCC
    ISREDIT (ROW,COL) = CURSOR
    SET &ROW = &ROW
/*
/*  SET &WHAT = &STR(XCICS.BACKUP.LVL&LV..&PROD)
/*  CONTROL MSG
/*  SET &SYSOUTTRAP = 50
/*  LISTCAT ENTRY('&WHAT') ALL
/*  SET &MYCC = &LASTCC
/*  SET &SYSOUTTRAP = 0
/*  CONTROL NOMSG
/*  SET &LNCTR = &SYSOUTLINE - 1
/*  DO WHILE &LNCTR > 6
/*    SET &NEWLINE = &&SYSOUTLINE&LNCTR
/*    SET &NEWLINE = &SUBSTR(1:35,&NEWLINE)
/*    SET &NEWLINE = &STR(                              &NEWLINE)
/*    WRITE &NEWLINE
/*    ISREDIT LINE_BEFORE &ROW = DATALINE '&NEWLINE'
/*    SET &MYCC = &LASTCC
/*    SET &LNCTR = &LNCTR - 1
/*  ENDO
/* FORMULATE LINE 1 OF TEXT AN INSERT ON TOP
    SET &NEWLINE1 = &SUBSTR(1:8,&SYSUID        )
    SET &NEWLINE1 = &STR(&NEWLINE1 &NEWLINE1)
    SET &NEWLINE1 = &STR(&NEWLINE1.&MM./&DD./&YY )
    SET &NEWLINE1 = &STR(&NEWLINE1.&IPLTIM)
    SET &NEWLINE1 = &STR(&NEWLINE1 &TOZN., WAS CLONED FROM A LEVEL &LV)
    ISREDIT LINE_BEFORE &ROW = DATALINE '&NEWLINE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE1)
/* FORMULATE LINE 2 OF TEXT AFTER LINE 1
    SET &NEWLINE2 = &STR(&NEWLINE2                               )
    SET &NEWLINE2 = &STR(&NEWLINE2 &FROMZN ZONE VIA IMPLEMENTATION)
    SET &NEWLINE2 = &STR(&NEWLINE2 DIALOG)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE2'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE2)
/* INSERT A NEW DASH LINE ON TOP
    ISREDIT LINE_BEFORE &ROW = DATALINE '&NEWDASH'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWDASH)
/*  ISREDIT SAVE
    ISREDIT END
EXIT
    SET &MYCC = &LASTCC
/*
    ISPEXEC  CONTROL SUBTASK CLEAR
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT (DATASET) = DATASET
        SET &MAXCC = 0
        %Z &DATASET
        SET &MYCC = &MAXCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE COMPRESS FAILED, ABORT IPL DOCUMENTOR
            ISREDIT CANCEL
            EXIT CODE(20)
          ENDO
        ISREDIT SAVE
        SET &MYCC = &LASTCC
      ENDO
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    ISREDIT END
    EXIT CODE(&MAXCC)
./ ADD NAME=OEMLVADD 0122-93200-93216-1053-00080-00081-00054-MANN
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XDBS.TSOISPF.CLIST(OEMLVADD)                                 */
/* DOC: THIS EDIT MACRO ADDS AN ENTRY TO THE OEM SOFTWARE TRACKING   */
/*      BOARD                                                        */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
/*
    ISPEXEC VGET (LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM SMPDAT SMPTIM +
                  LVLPROD)
/*
/*  PAD LVLLVL WITH A ZERO IF ONLY 1 DIGIT
/*
    SET &LVLLEN = &LENGTH(&LVLLVL)
    IF &LVLLEN = 1 THEN +
      SET &LVLLVL = &STR(0&LVLLVL)
/*
/* SET UP DATE AND TIME
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/*
    SET &FRSTCHAR = &SUBSTR(1:1,&LVLTRG)
    IF &FRSTCHAR = T OR &FRSTCHAR = B  THEN +
      DO    /* STRIP PREFIX OUT OF NAME
        SET ENDOFSTR =  &LENGTH(&LVLTRG)
        SET &BASENAM = &SUBSTR(2:&ENDOFSTR,&STR(&LVLTRG))
      ENDO /* END STRIP PREFIX
    ELSE SET &BASENAM = &LVLTRG
    SET &ENDCOL = &LENGTH(&LVLPROD)
    IF &ENDCOL = 8 THEN SET &A = &STR( -----)
    IF &ENDCOL = 7 THEN SET &A = &STR(  -----)
    IF &ENDCOL = 6 THEN SET &A = &STR(   -----)
    IF &ENDCOL = 5 THEN SET &A = &STR(    -----)
    IF &ENDCOL = 4 THEN SET &A = &STR(     -----)
    IF &ENDCOL = 3 THEN SET &A = &STR(      -----)
    IF &ENDCOL = 2 THEN SET &A = &STR(       -----)
    SET &SRCHTEXT = &STR(&LVLPROD&A&BASENAM)
    ISREDIT FIND FIRST '&SRCHTEXT'
    SET &RETCODE = &LASTCC        /* IN FILE EXIST
    IF &RETCODE = 4 THEN +
       SET &RESULT = NOTFOUND     /* SECTION DOES NOT EXIST
    IF &RETCODE = 0 THEN +
       SET &RESULT = FOUND        /* SECTION EXIST
    IF &RESULT = NOTFOUND  THEN +
       DO    /*INITIALIZE AND ADD LINE TO DELIMIT NEW SECTION
          SET &SRCHPROD = &STR(&LVLPROD&A)
          ISREDIT FIND FIRST '&SRCHPROD'
          ISREDIT (ROW,COL) = CURSOR
          SET &ROW = &ROW
          SET &DELIMLN = &STR(--------------------)
          SET &DELIMLN = &STR(&DELIMLN.--------------------)
          SET &DELIMLN = &STR(&DELIMLN.-----------&SRCHTEXT)
          ISREDIT LINE_AFTER &ROW = DATALINE '&DELIMLN'
          ISREDIT FIND FIRST '&SRCHTEXT'
          ISREDIT (ROW,COL) = CURSOR
       ENDO
    ELSE +
       ISREDIT (ROW,COL) = CURSOR
/*                                         ADD DATA LINE           */
/* SET UP TEMPLATE  AND ADD LINE
/*
    SET &ROW = &ROW
    SET &TMPLATE = &STR(LVLPROD   ZONECOL     &LVLLVL    &MM./&DD./&YY)
    SET &TMPLATE = &STR(&TMPLATE   &IPLTIM   &SMPDAT  &SMPTIM)
    SET &TMPLATE = &STR(&TMPLATE  &SYSUID)
    ISREDIT LINE_BEFORE &ROW = DATALINE '&TMPLATE'
/* MODIFY TEMPLATE
    ISREDIT CHANGE ALL ZONECOL &LVLTRG
    ISREDIT CHANGE ALL LVLPROD &LVLPROD
/*  ISREDIT BOUNDS 16 21
/*  ISREDIT CHANGE ALL LVLCOL  '&LVLLVL'
/*  ISREDIT BOUNDS 1  80
    ISREDIT END
EXIT CODE(&MAXCC)
./ ADD NAME=OEMLVDEL 0104-93200-93216-1031-00049-00042-00000-MANN
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XDBS.TSOISPF.CLIST(OEMLVDEL)                                 */
/* DOC: THIS EDIT MACRO DELETES AN ENTRY FROM THE OEM SOFTWARE       */
/*      TRACKING BOARD. THE ENTRY DELETED IS THE  ONE PASSED AS THE  */
/*      LVLTRG PARAMETER.                                            */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
/*
    ISPEXEC VGET (FUNCTN LVLSRC LVLTRG LVLLVL LVLPROD)
    SET &EDTCMD = SAVE    /* INITIALIZE EDIT COMMAND
/*
/* MAKE SURE ENTRY DOES  EXIST
/*
    SET &ENDCOL = &LENGTH(&LVLPROD)
    IF &ENDCOL = 8 THEN SET &A = &STR(  )
    IF &ENDCOL = 7 THEN SET &A = &STR(   )
    IF &ENDCOL = 6 THEN SET &A = &STR(    )
    IF &ENDCOL = 5 THEN SET &A = &STR(     )
    IF &ENDCOL = 4 THEN SET &A = &STR(      )
    IF &ENDCOL = 3 THEN SET &A = &STR(       )
    IF &ENDCOL = 2 THEN SET &A = &STR(        )
    SET &SRCHTEXT = &LVLPROD&A&LVLTRG
    ISREDIT FIND FIRST '&SRCHTEXT'
    SET &RETCODE = &LASTCC
    IF &RETCODE = 4 THEN +
       SET &RESULT = NOTFOUND
    IF &RETCODE = 0 THEN +
       SET &RESULT = FOUND
/*
    IF &RESULT EQ NOTFOUND THEN +
       DO
          IF &FUNCTN = DEL THEN +
             SET &EDTCMD = END
          ISREDIT &EDTCMD
        ENDO
    ELSE +
       DO
          ISREDIT X ALL
          ISREDIT FIND FIRST '&SRCHTEXT'
          ISREDIT DELETE ALL NX
          ISREDIT RESET X
          IF &FUNCTN = DEL THEN +
             SET &EDTCMD = END
          ISREDIT &EDTCMD
        ENDO
EXIT CODE(&MAXCC)
./ ADD NAME=OEMLVL#  0105-93194-93217-1530-00017-00017-00000-MANN
PROC 2 PRODUCT ENTRYNM
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(OEMLVL#)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST UPDATES THE OEM SOFTWARE LEVEL TRACKING BOARD   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*                                                                 */
    SET &DSN = XDBS.SOFTWARE.CHANGES
/*
    ISPEXEC VPUT (PRODUCT ENTRYNM)
/*                                                                 */
    ISPEXEC EDIT DATASET('&DSN(OEMLVL)') +
      MACRO(OEMLVL#M)
/*
RETURN
./ ADD NAME=OEMLVL#M 0104-93194-93194-1446-00032-00024-00000-MANN
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XDBS.TSOISPF.CLIST(OEMLVL#M)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO OBTAINS THE LEVEL NUMBER FOR AN ENTRY IN     */
/*      THE LEVEL TRACKING BOARD                                     */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (PRODUCT ENTRYNM)
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    SET &ENDCOL = &LENGTH(&PRODUCT)
    IF &ENDCOL = 8 THEN SET &A = &STR(  )
    IF &ENDCOL = 7 THEN SET &A = &STR(   )
    IF &ENDCOL = 6 THEN SET &A = &STR(    )
    IF &ENDCOL = 5 THEN SET &A = &STR(     )
    IF &ENDCOL = 4 THEN SET &A = &STR(      )
    IF &ENDCOL = 3 THEN SET &A = &STR(       )
    IF &ENDCOL = 2 THEN SET &A = &STR(        )
    SET &SRCHTEXT = &PRODUCT&A&ENTRYNM
    ISREDIT FIND FIRST '&SRCHTEXT'
    ISREDIT (ROW,COL) = CURSOR
    SET &SRCLINE = &ROW
    ISREDIT (LINETXT) = LINE &SRCLINE
    SET &LV4NTRY = &SUBSTR(23:25,(&LINETXT)
    ISPEXEC VPUT (LV4NTRY)
    ISREDIT END
EXIT CODE(&MAXCC)
./ ADD NAME=OEMLVTRK 0121-93200-93216-0923-00076-00072-00013-MANN
PROC 5 FUNCTN LVLSRC LVLTRG LVLLVL LVLPROD
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(OEMLVTRK)                               */
/* DOC: THIS CLIST UPDATES THE OEM SOFTWARE LEVEL TRACKING BOARD   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*
     SET &DSN = XDBS.SOFTWARE.CHANGES
     SET &MACNAME = NONAME
/*
    IF &FUNCTN = ADD THEN +
       SET &MACNAME = OEMLVADD
    IF &FUNCTN = DEL THEN +
       SET &MACNAME = OEMLVDEL
    IF &FUNCTN = UPD THEN +
       SET &MACNAME = OEMLVUPD
/*
    IF &MACNAME = NONAME THEN +
       DO
         WRITE &FUNCTN IS NOT A VALID FUNCTION
         EXIT CODE(12)
       ENDO
 SET DONE = NO
 SET EOF = OFF
 SET RCODE = 0
/*
/* ERROR ROUTINE
/*
 ERROR +
  DO
     SET RCODE = &LASTCC
     IF &RCODE=400 THEN +
       DO
         SET EOF=ON
         RETURN
      ENDO
  ELSE +
    EXIT
 ENDO
/*
/*
/* THIS SEGMENT READS THE LEVEL CHART AND GET THE SMP/E DATE/TIME
/*
 ALLOC FI(SYSDVAL) DA('&DSN(OEMLVL)') SHR REU
 OPENFILE SYSDVAL
 DO WHILE &DONE=NO
    GETFILE SYSDVAL
    IF &EOF=ON THEN GOTO NEXT
    READDVAL MVLPROD MVLSRC MVLLVL MRCDAT MRCTIM MMPDAT MMPTIM
/*  IF &MVLSRC = &STR() THEN SET MVLSRC  = &STR(X)
    IF &STR(&LVLSRC) = DONTCARE  THEN +
       GOTO NEXT
    IF (&STR(&MVLPROD) = &STR(&LVLPROD)) AND +
       (&STR(&LVLSRC) = &STR(&MVLSRC)) THEN +
      DO
        SET SMPDAT = &STR(&MMPDAT)
        SET SMPTIM = &STR(&MMPTIM)
        SET &DONE = YES
      ENDO
 ENDO
/*
NEXT: +
CLOSFILE SYSDVAL
FREE FILE(SYSDVAL)
 ERROR OFF
 SET &SRCDAT = &STR(&SYSDATE)
 SET &SRCTIM = &STR(&SYSTIME)
 SET &LVLLVL = &STR(&MVLLVL)
 ISPEXEC VPUT (FUNCTN LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM SMPDAT +
               SMPTIM LVLPROD)
 ISPEXEC EDIT DATASET('&DSN(OEMLVL)') +
   MACRO(&MACNAME)
/*
    EXIT CODE(&MAXCC)
/*
./ ADD NAME=OEMLVUPD 0108-93200-93216-0942-00108-00084-00045-MANN
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XDBS.TSOISPF.CLIST(OEMLVUPD)                                 */
/* DOC: THIS EDIT MACRO UPDATES THE TRG ZONE LEVEL FROM THE SRC ZONE */
/*      LEVEL IN THE OEM SOFTWARE TRACKING BOARD                     */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
/*
    ISPEXEC VGET (LVLPROD LVLSRC LVLTRG LVLLVL SMPDAT SMPTIM)
/*
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    SET &ENDCOL = &LENGTH(&LVLPROD)
    IF &ENDCOL = 8 THEN SET &A = &STR(  )
    IF &ENDCOL = 7 THEN SET &A = &STR(   )
    IF &ENDCOL = 6 THEN SET &A = &STR(    )
    IF &ENDCOL = 5 THEN SET &A = &STR(     )
    IF &ENDCOL = 4 THEN SET &A = &STR(      )
    IF &ENDCOL = 3 THEN SET &A = &STR(       )
    IF &ENDCOL = 2 THEN SET &A = &STR(        )
    SET &SRCHTEXT = &LVLPROD&A&LVLSRC
    ISREDIT FIND FIRST '&SRCHTEXT'
    IF &LASTCC NE 0 THEN +
      DO
        SET &ERR1 = &STR(WARNING: &LVLSRC ZONE NOT FOUND IN LEVEL )
        SET &ERR1 = &STR(&ERR1.TRACKING BOARD.)
        SET &ERR2 = &STR(         LEVEL UPDTE HAS BEEN TERMINATED)
        SET &RSN1 = &STR(REASON : PARTIAL IMPLEMENTATION JOB MAY HAVE)
        SET &RSN1 = &STR(&RSN1 BEEN RUN.)
        SET &RSN2 = &STR(         TABLE UPDATE STEP MAY HAVE BEEN)
        SET &RSN2 = &STR(&RSN2 EXCLUDED FROM JOB STREAM)
        SET &ACT1 = &STR(ACTION:  ADD  &LVLSRC ZONE TO THE LEVL BOARD)
        WRITE
        WRITE **************************************************
        WRITE &ERR1
        WRITE &ERR2
        WRITE &RSN1
        WRITE &RSN2
        WRITE &ACT1
        WRITE **************************************************
        WRITE
        ISREDIT CANCEL
        EXIT CODE(12)
      ENDO
    ISREDIT (ROW,COL) = CURSOR
    SET &SRCLINE = &ROW
    ISREDIT (LINETXT) = LINE &SRCLINE
    SET &SRCLVL = &SUBSTR(23:25,(&LINETXT)
    SET &SRCDAT = &SUBSTR(30:37,(&LINETXT)
    SET &SRCTIM = &SUBSTR(41:45,(&LINETXT)
/*
/* DOES TARGET ZONE EXIST
/*
    SET &ENDCOL = &LENGTH(&LVLPROD)
    IF &ENDCOL = 8 THEN SET &A = &STR(  )
    IF &ENDCOL = 7 THEN SET &A = &STR(   )
    IF &ENDCOL = 6 THEN SET &A = &STR(    )
    IF &ENDCOL = 5 THEN SET &A = &STR(     )
    IF &ENDCOL = 4 THEN SET &A = &STR(      )
    IF &ENDCOL = 3 THEN SET &A = &STR(       )
    IF &ENDCOL = 2 THEN SET &A = &STR(        )
    SET &SRCHTEXT = &LVLPROD&A&LVLTRG
    ISREDIT FIND FIRST '&SRCHTEXT'
    SET &RETCODE = &LASTCC
    IF &RETCODE = 4 THEN +
       SET &RESULT = NOTFOUND
    IF &RETCODE = 0 THEN +
       SET &RESULT = FOUND
/* DOES SOURCE ZONE EXIST
/*
    SET &ENDCOL = &LENGTH(&LVLPROD)
    IF &ENDCOL = 8 THEN SET &A = &STR(  )
    IF &ENDCOL = 7 THEN SET &A = &STR(   )
    IF &ENDCOL = 6 THEN SET &A = &STR(    )
    IF &ENDCOL = 5 THEN SET &A = &STR(     )
    IF &ENDCOL = 4 THEN SET &A = &STR(      )
    IF &ENDCOL = 3 THEN SET &A = &STR(       )
    IF &ENDCOL = 2 THEN SET &A = &STR(        )
    SET &SRCHTEXT = &LVLPROD&A&LVLSRC
    ISREDIT FIND FIRST '&SRCHTEXT'
    SET &RETCODE = &LASTCC
    IF &RETCODE = 0 THEN +
     DO
       SET &OLDDAT = &STR(&SMPDAT)
       SET &OLDTIM = &STR(&SMPTIM)
     ENDO
/*
    IF &RESULT EQ NOTFOUND THEN +
        DO /* START OF NOTFOUND DO
         SET &LVLLVL = &SRCLVL
         ISPEXEC VPUT (LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM OLDDAT +
                       OLDTIM LVLPROD)
         ISREDIT OEMLVADD
        ENDO /* END OF NOTFOUND DO
    ELSE +
        DO /*  FOUND IT
         SET &LVLLVL = &SRCLVL
         ISPEXEC VPUT (LVLSRC LVLTRG LVLLVL)
         ISREDIT OEMLVDEL
         ISPEXEC VPUT (LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM OLDDAT +
                       OLDTIM LVLPROD)
         ISREDIT OEMLVADD
        ENDO
EXIT CODE(&MAXCC)
./ ADD NAME=OMEGDB2  0101-93007-94021-1424-00034-00037-00001-KETCSC
PROC 0
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(OMEGDB2)                                */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST DETERMINES WHICH OMEGAMON TO INVOKE.            */
/*                                                                 */
BEGIN: +
    CONTROL NOMSG NOLIST NOFLUSH END(ENDO)
/*  CONTROL LIST CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    GETSYSID
    IF (&SYSID = MVSW) THEN SET &SSID = D2DB
    IF (&SYSID = DOFD) THEN SET &SSID = DDB2
    IF (&SYSID = DOFP) THEN SET &SSID = PDB2
    IF (&SSID NE ) THEN GOTO ITSGOOD
    WRITE SYSTEM &SYSID IS NOT KNOWN TO THIS PROCESS.
    EXIT CODE(16)
 /******************************************************
 /*   FIGURE OUT WHICH ONE TO EXECUTE                  *
 /******************************************************
ITSGOOD: +
    SET &OK = &SYSDSN('&SSID..DSNSAMP(DS@QVALI)')
    IF (&STR(&OK) = OK) THEN      +
      DO
        SET &MAXCC = 0
        EXEC 'XDBS.TSOISPF.EXEC(INVKO2DB)' '&SSID NO'
      ENDO
    ELSE +
      DO
        WRITE SUBSYSTEM &SSID IS NOT KNOWN TO THIS PROCESS.
        EXIT CODE(16)
      ENDO
    SET &MYCC = &MAXCC
    EXIT CODE(&MAXCC)
./ ADD NAME=OMEGLVL  0101-93049-93049-1411-00017-00017-00000-DD20008
PROC 1 ENTRYNM
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(OMEGLVL)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST UPDATES THE DB2 SOFTWARE LEVEL TRACKING BOARD   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*                                                                 */
    SET &DSN = XDBS.SOFTWARE.CHANGES
/*
    ISPEXEC VPUT (ENTRYNM)
/*                                                                 */
    ISPEXEC EDIT DATASET('&DSN(OMEGLVL)') +
      MACRO(LVLNOM)
/*
RETURN
./ ADD NAME=OMEGTRCK 0100-93049-93049-1039-00074-00074-00000-KETCSC
PROC 4 FUNCTN LVLSRC LVLTRG LVLLVL
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(LVLTRCK)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST UPDATES THE DB2 SOFTWARE LEVEL TRACKING BOARD   */
/* MOD: ADDED SMP/E DATE/TIME FOR MIGRATION AND IMPLEMENTION LAW   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*
     SET &DSN = XDBS.SOFTWARE.CHANGES
     SET &MACNAME = NONAME
/*
    IF &FUNCTN = ADD THEN +
       SET &MACNAME = LVLADD
    IF &FUNCTN = DEL THEN +
       SET &MACNAME = LVLDEL
    IF &FUNCTN = UPD THEN +
       SET &MACNAME = LVLUPD
/*
    IF &MACNAME = NONAME THEN +
       DO
         WRITE &FUNCTN IS NOT A VALID FUNCTION
         EXIT CODE(12)
       ENDO
 SET DONE = NO
 SET EOF = OFF
 SET RCODE = 0
/*
/* ERROR ROUTINE
/*
 ERROR +
  DO
     SET RCODE = &LASTCC
     IF &RCODE=400 THEN +
       DO
         SET EOF=ON
         RETURN
      ENDO
  ELSE +
    EXIT
 ENDO
/*
/*
/* THIS SEGMENT READS THE LEVEL CHART AND GET THE SMP/E DATE/TIME
/*
 ALLOC FI(SYSDVAL) DA('&DSN(OMEGLVL)') SHR REU
 OPENFILE SYSDVAL
 DO WHILE &DONE=NO
    GETFILE SYSDVAL
    IF &EOF=ON THEN GOTO NEXT
    READDVAL MVLSRC MVLLVL MRCDAT MRCTIM MMPDAT MMPTIM
    IF &STR(&LVLSRC) = DONTCARE  THEN +
       GOTO NEXT
    IF &STR(&LVLSRC) = &STR(&MVLSRC) THEN +
      DO
        SET &SMPDAT = &STR(&MMPDAT)
        SET &SMPTIM = &STR(&MMPTIM)
        SET DONE = YES
      ENDO
 ENDO
/*
NEXT: +
CLOSFILE SYSDVAL
FREE FILE(SYSDVAL)
 ERROR OFF
 SET &SRCDAT = &STR(&SYSDATE)
 SET &SRCTIM = &STR(&SYSTIME)
 ISPEXEC VPUT (FUNCTN LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM SMPDAT SMPTIM)
 ISPEXEC EDIT DATASET('&DSN(OMEGLVL)') +
   MACRO(&MACNAME)
/*
    EXIT CODE(&MAXCC)
/*
./ ADD NAME=OMGCLNE  0100-93049-93049-1411-00040-00040-00000-DD20008
PROC 2 FROMZN   TOZN
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(OMGCLNE)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST DOCUMENTS A PROPAGATION SCENARIO                */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
/*
    SET &DSN = XDBS.SOFTWARE.CHANGES   /* PDS DOC MEMBERS RESIDE IN
/*
/* NAMES OF MEMBERS TO BE UPDATED WITH INFORMATION
/* SHOULD NOT HAVE ANY PREFIXES SUCH AS A 'T'
/*
    IF &SUBSTR(1:1,&STR(&TOZN)) = T  THEN +
      DO                            /* STRIP PREFIX OUT OF NAME
        SET ENDOFSTR =  &LENGTH(&TOZN)
        SET &MEMBER = &SUBSTR(2:&ENDOFSTR,&STR(&TOZN))
      ENDO                          /* END STRIP PREFIX
    ELSE +
      SET &MEMBER = &TOZN         /* THE 'TO' ZONE HAD NO PREFIX
/*
    SET &PDSMBR = &STR(&MEMBER)     /* PDSMBR NOW HAS NO PREFIX
/*
    SET &MBRFLAG = OLDMBR
    IF &SYSDSN('&DSN(&PDSMBR)') EQ MEMBER NOT FOUND  THEN +
      SET &MBRFLAG = NEWMBR
/*
    ISPEXEC VPUT (FROMZN TOZN MBRFLAG) SHARED
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(OMGCLNEM)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        WRITE &NRSTR(&PDSDSN)
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=OMGCLNEM 0107-93049-93049-1705-00102-00111-00000-KETCSC
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(OMGCLNEM)                                */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE CHANGES MEMBER FOR CLONING.      */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (FROMZN TOZN MBRFLAG)
/*
/* OBTAIN THE LEVEL OF THE SOURCE ZONE
/*
    %OMEGLVL &FROMZN
    ISPEXEC VGET (LV4NTRY)
    SET &FLV = &LV4NTRY
/*
/*    ISREDIT EDIT &PDSMBR
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/* INITIALIZE &NEWDASH
    SET &NEWDASH = &STR(-------- ------- -------- -----)
    SET &NEWDASH = &STR(&NEWDASH -----------------------------------)
    SET &NEWDASH = &STR(&NEWDASH.-----)
    WRITE &NRSTR(&NEWDASH)
/*
/*  IF MEMBER NEVER EXISTED THEN &MBRFLAG WOULD CONTAIN NEWMEM
/*  IF SO, COPY THE HEADING FORM A MODEL MEMBER
/*
    IF &MBRFLAG = NEWMBR THEN +
       ISREDIT COPY MODEL AFTER .ZFIRST
/*
    ISREDIT F '----- --' FIRST
    SET &MYCC = &LASTCC
    ISREDIT (ROW,COL) = CURSOR
    SET &ROW = &ROW
/*
/*  GET PERSONS LASTNAME ASSOCIATED WITH THIS USERID
/*
    %LNAME &SYSUID
    ISPEXEC VGET (LNAME)
/* FORMULATE LINE OF TEXT TO INSERT ON TOP
    SET &NEWLINE1 = &SUBSTR(1:8,&SYSUID        )
    SET &NEWLINE1 = &STR(&LNAME &NEWLINE1)
    SET &NEWLINE1 = &STR(&NEWLINE1.&MM./&DD./&YY )
    SET &NEWLINE1 = &STR(&NEWLINE1.&IPLTIM)
    SET &NEWLINE1 = &STR(&NEWLINE1 OMEGAMON II FOR DB2 SOFTWARE)
    ISREDIT LINE_AFTER  &ROW = DATALINE '&NEWLINE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE1)
    SET &ROW = &ROW + 1
/* FORMULATE LINE 2 OF TEXT AFTER LINE 1
    SET &NEWLINE1 = &STR(                               )
    SET &NEWLINE1 = &STR(&NEWLINE1 &TOZN., WAS CLONED FROM A LEVEL &FLV)
    ISREDIT LINE_AFTER  &ROW = DATALINE '&NEWLINE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE1)
    SET &ROW = &ROW + 1
/* FORMULATE LINE 3 OF TEXT AFTER LINE 2
    SET &NEWLINE2 = &STR(                               )
    SET &NEWLINE2 = &STR(&NEWLINE2 &FROMZN ZONE VIA IMPLEMENTATION)
    SET &NEWLINE2 = &STR(&NEWLINE2 DIALOG)
    ISREDIT LINE_AFTER &ROW = DATALINE '&NEWLINE2'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWLINE2)
    SET &ROW = &ROW + 1
/* INSERT A NEW DASH LINE ON TOP
    ISREDIT LINE_AFTER  &ROW = DATALINE '&NEWDASH'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWDASH)
/*  ISREDIT SAVE
    ISREDIT END
EXIT
    SET &MYCC = &LASTCC
/*
    ISPEXEC  CONTROL SUBTASK CLEAR
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT (DATASET) = DATASET
        SET &MAXCC = 0
        %Z &DATASET
        SET &MYCC = &MAXCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE COMPRESS FAILED, ABORT IPL DOCUMENTOR
            ISREDIT CANCEL
            EXIT CODE(20)
          ENDO
        ISREDIT SAVE
        SET &MYCC = &LASTCC
      ENDO
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    ISREDIT END
    EXIT CODE(&MAXCC)
./ ADD NAME=OMGIMP   0100-93049-93049-1432-00041-00041-00000-DD20008
PROC 4 FROMZN TOZN TGTHILV ACTHILV
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(DOCCLNE)                                */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST DOCUMENTS AN IMPLEMENTAION SCENARIO             */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
/*
/*
    SET &DSN = XDBS.SOFTWARE.CHANGES   /* PDS DOC MEMBERS RESIDE IN
/*
/* NAMES OF MEMBERS TO BE UPDATED WITH INFORMATION
/* SHOULD NOT HAVE ANY PREFIXES SUCH AS A 'T'
/*
    IF &SUBSTR(1:1,&STR(&TOZN)) = T  THEN +
      DO                            /* STRIP PREFIX OUT OF NAME
        SET ENDOFSTR =  &LENGTH(&TOZN)
        SET &MEMBER = &SUBSTR(2:&ENDOFSTR,&STR(&TOZN))
      ENDO                          /* END STRIP PREFIX
    ELSE +
      SET &MEMBER = &TOZN         /* THE 'TO' ZONE HAD NO PREFIX
/*
    SET &PDSMBR = &STR(&MEMBER)     /* PDSMBR NOW HAS NO PREFIX
/*
    SET &MBRFLAG = OLDMBR
    IF &SYSDSN('&DSN(&PDSMBR)') EQ MEMBER NOT FOUND  THEN +
      SET &MBRFLAG = NEWMBR
/*
    ISPEXEC VPUT (FROMZN TOZN ACTHILV TGTHILV MBRFLAG) SHARED
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(OMGIMPM)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        WRITE &NRSTR(&PDSDSN)
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=OMGIMPM  0100-93049-93049-1433-00095-00095-00000-DD20008
ISREDIT MACRO
/*********************************************************************/
/*                                                                   */
/* LIB: XCICS.TSOISPF.CLIST(DOCBKPM)                                 */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM                       */
/* DOC: THIS EDIT MACRO UPDATES THE CHANGES MEMBER FOR IMPLEMENTATIN */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (FROMZN TOZN ACTHILV TGTHILV MBRFLAG)
/*
    WRITE '************' &FROMZN &TOZN &LV
/*
    SET &MM = &SUBSTR(1:2,&SYSDATE)
    SET &DD = &SUBSTR(4:5,&SYSDATE)
    SET &YY = &SUBSTR(7:8,&SYSDATE)
    SET &IPLTIM = &SUBSTR(1:5,&SYSTIME)
/* INITIALIZE &NEWDASH
    SET &NEWDASH = &STR(-------- ------- -------- -----)
    SET &NEWDASH = &STR(&NEWDASH -----------------------------------)
    SET &NEWDASH = &STR(&NEWDASH.-----)
    WRITE &NRSTR(&NEWDASH)
/*
/*  IF MEMBER NEVER EXISTED THEN &MBRFLAG WOULD CONTAIN NEWMEM
/*  IF SO, COPY THE HEADING FORM A MODEL MEMBER
/*
    IF &MBRFLAG = NEWMBR THEN +
       ISREDIT COPY MODEL AFTER .ZFIRST
/*
    ISREDIT F '----- --' FIRST
    SET &MYCC = &LASTCC
    ISREDIT (ROW,COL) = CURSOR
    SET &ROW = &ROW
/*
/*
/*  GET PERSONS LASTNAME ASSOCIATED WITH THIS USERID
/*
    %LNAME &SYSUID
    ISPEXEC VGET (LNAME)
/*
/* FORMULATE LINE 1 OF TEXT AN INSERT ON TOP
    SET &NULNE1 = &SUBSTR(1:8,&SYSUID          )
    SET &NULNE1 = &STR(&LNAME &NULNE1)
    SET &NULNE1 = &STR(&NULNE1.&MM./&DD./&YY )
    SET &NULNE1 = &STR(&NULNE1.&IPLTIM)
    SET &NULNE1 = &STR(&NULNE1 OMEGAMON II FOR DB2 SOFTWARE CLONED FROM)
    ISREDIT LINE_BEFORE &ROW = DATALINE '&NULNE1'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE1)
/* FORMULATE LINE 2 OF TEXT AFTER LINE 1
    SET &NULNE2 = &STR(&NULNE2                               )
    SET &NULNE2 = &STR(&NULNE2 ZONE &FROMZN, &TGTHILV..*, TO THE       )
    ISREDIT LINE_AFTER &ROW = DATALINE '&NULNE2'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE2)
/* FORMULATE LINE 3 OF TEXT AFTER LINE 2
    SET &NULNE3 = &STR(&NULNE3                               )
    SET &NULNE3 = &STR(&NULNE3 ACTIVE ZONE &TOZN, &ACTHILV..* )
    SET &NEXTLNE = &ROW + 1
    ISREDIT LINE_AFTER &NEXTLNE = DATALINE '&NULNE3'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NULNE3)
/* INSERT A NEW DASH LINE ON TOP
    ISREDIT LINE_BEFORE &ROW = DATALINE '&NEWDASH'
    SET &MYCC = &LASTCC
    WRITE &NRSTR(&NEWDASH)
/*  ISREDIT SAVE
    ISREDIT END
EXIT
    SET &MYCC = &LASTCC
/*
    ISPEXEC  CONTROL SUBTASK CLEAR
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT (DATASET) = DATASET
        SET &MAXCC = 0
        %Z &DATASET
        SET &MYCC = &MAXCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE COMPRESS FAILED, ABORT IPL DOCUMENTOR
            ISREDIT CANCEL
            EXIT CODE(20)
          ENDO
        ISREDIT SAVE
        SET &MYCC = &LASTCC
      ENDO
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    ISREDIT END
    EXIT CODE(&MAXCC)
./ ADD NAME=OMGLVTRK 0100-93340-93341-1015-00075-00075-00000-MJLCSC
PROC 4 FUNCTN LVLSRC LVLTRG LVLLVL
/*                                                                 */
/* LIB: XDBS.TSOISPF.CLIST(OMGLVTRK)                               */
/* GDE: IBM INSTALLATION/CONVERSION/MIGRATION TEAM                 */
/* DOC: THIS CLIST UPDATES THE DB2 SOFTWARE LEVEL TRACKING BOARD   */
/*      FOR THE OMEGAMON PRODUCT                                   */
/* MOD: ADDED SMP/E DATE/TIME FOR MIGRATION AND IMPLEMENTION LAW   */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
/*  CONTROL LIST SYMLIST CONLIST MSG END(ENDO)
/*
     SET &DSN = XDBS.SOFTWARE.CHANGES
     SET &MACNAME = NONAME
/*
    IF &FUNCTN = ADD THEN +
       SET &MACNAME = LVLADD
    IF &FUNCTN = DEL THEN +
       SET &MACNAME = LVLDEL
    IF &FUNCTN = UPD THEN +
       SET &MACNAME = LVLUPD
/*
    IF &MACNAME = NONAME THEN +
       DO
         WRITE &FUNCTN IS NOT A VALID FUNCTION
         EXIT CODE(12)
       ENDO
 SET DONE = NO
 SET EOF = OFF
 SET RCODE = 0
/*
/* ERROR ROUTINE
/*
 ERROR +
  DO
     SET RCODE = &LASTCC
     IF &RCODE=400 THEN +
       DO
         SET EOF=ON
         RETURN
      ENDO
  ELSE +
    EXIT
 ENDO
/*
/*
/* THIS SEGMENT READS THE LEVEL CHART AND GET THE SMP/E DATE/TIME
/*
 ALLOC FI(SYSDVAL) DA('&DSN(OMEGLVL)') SHR REU
 OPENFILE SYSDVAL
 DO WHILE &DONE=NO
    GETFILE SYSDVAL
    IF &EOF=ON THEN GOTO NEXT
    READDVAL MVLSRC MVLLVL MRCDAT MRCTIM MMPDAT MMPTIM
    IF &STR(&LVLSRC) = DONTCARE  THEN +
       GOTO NEXT
    IF &STR(&LVLSRC) = &STR(&MVLSRC) THEN +
      DO
        SET &SMPDAT = &STR(&MMPDAT)
        SET &SMPTIM = &STR(&MMPTIM)
        SET DONE = YES
      ENDO
 ENDO
/*
NEXT: +
CLOSFILE SYSDVAL
FREE FILE(SYSDVAL)
 ERROR OFF
 SET &SRCDAT = &STR(&SYSDATE)
 SET &SRCTIM = &STR(&SYSTIME)
 ISPEXEC VPUT (FUNCTN LVLSRC LVLTRG LVLLVL SRCDAT SRCTIM SMPDAT SMPTIM)
 ISPEXEC EDIT DATASET('&DSN(OMEGLVL)') +
   MACRO(&MACNAME)
/*
    EXIT CODE(&MAXCC)
/*
./ ADD NAME=ON#OLD   0101-93050-93164-0843-00125-00125-00000-KETCSC
PROC 0 PANEL()
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    GETSYSID
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO GETOWNR
      ENDO
    SET &PGMR = &PGMR
GETOWNR: +
    SET &B = &SYSINDEX(OWNER=,&STR(&SYSOUTLINE1))
    SET &B = &B + 6
    SET &E = &B + 8
    SET &OWNR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO CHKAUTH
      ENDO
    SET &OWNR = &OWNR
 /*                                                                  */
 /*  HRA                                                             */
 /*                                                                  */
CHKAUTH: +
    ERROR OFF
 /*                                                                  */
 /*  HRA                                                             */
 /*                                                                  */
    IF (&OWNR = CWA069D) THEN GOTO HRAUSER
 /*                                                                  */
 /*  CDCSA DB2 GROUP                                                 */
 /*                                                                  */
    IF (&OWNR = CSCDB2) THEN GOTO BEGIN
    IF (&SYSUID = DMV0016) OR +
       (&SYSUID = SUE)     OR +
       (&SYSUID = MJLCSC)  OR +
       (&SYSUID = BORGY)   OR +
       (&SYSUID = MANN)    OR +
       (&SYSUID = PETE)    OR +
       (&SYSUID = LAWCSC)  OR +
       (&SYSUID = KETCSC)  OR +
       (&SYSUID = AXGCSC)  THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  UNKNOWN USERS                                                   */
 /*                                                                  */
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(0)
HRAUSER: +
    WRITE
    WRITE Hi &PGMR.. Welcome back to the &SYSID system.
    WRITE
    WRITE &STR(********************************************)
    WRITE &STR(*                                          *)
    WRITE &STR(*  ENTER D FOR DEVELOPMENT OR              *)
    WRITE &STR(*        P FOR PRODUCTION                  *)
    WRITE &STR(*                                          *)
    WRITE &STR(********************************************)
    READ TYPE
    IF (&STR(&TYPE) EQ D) THEN %ID2DB &PANEL
    IF (&STR(&TYPE) EQ P) THEN %IDB2P &PANEL
    ERROR RETURN
    PDF &PANEL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE
    EXIT CODE(0)
BEGIN: +
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)
    ERROR RETURN
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE         %ipcs new (to invoke Interactive Problem Control)
    WRITE
    EXIT CODE(&MAXCC)
./ ADD NAME=PARSEIT  0106-90341-91323-1210-00886-00883-00000-DMV0016
PROC 2 DATASET YOURNAME
/*                                                                 */
/* LIB: DMV0016.CLIST(PARSEIT)                                     */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST PARSES THE OUTPUT OF A LISTCAT COMMAND.         */
/*                                                                 */
DASDPER: +
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    SET &WHERE = &SYSENV
    SET &OUTCTR = 0
    FREE FILE(CATLIST)
    ALLOC FILE(CATLIST) DATASET(&DATASET)               +
      SHR REUSE
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE PARSEIT: ALLOCATION OF DATASET FAILED RC=&MYCC
        GOTO ABORTIT
      ENDO
    OPENFILE CATLIST INPUT
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE PARSEIT: OPEN OF DATASET FOR INPUT FAILED RC=&MYCC
        GOTO ABORTIT
      ENDO
    ISPEXEC TBERASE &YOURNAME
    ISPEXEC TBOPEN &YOURNAME
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
       ISPEXEC TBCREATE &YOURNAME +
         KEYS(ENTRY)                                                   +
         NAMES(TYPE       CAT OWNER CREDT REL EXPDT                    +
               PROTPSWD RACF KEYLEN                                    +
               AVGREC BUFSPC CISIZE RKP MAXREC EXCPEXIT CICA REGION    +
               SYSTEM RCVRY UNIQUE ERASE INDXED WRTCHK IMBED REPLIC    +
               ORDER REUSE SPANNED DRTOTAL DSPLITCI DEXCPS DRDEL       +
               DSPLITCA DEXTENTS DRINS DFREECI DRUPD DFREECA DTIMSTMP  +
               DRRET DFREBYTE DSPACTYP DHIRBA DALCP DHURBA DALCS       +
               DUSE                                                    +
               ISPLITCI IEXCPS IRDEL ISPLITCA IEXTENTS IRINS IFREECI   +
               IRUPD IFREECA ITIMSTMP IRRET IFREBYTE ISPACTYP IHIRBA   +
               IALCP IHURBA IALCS                                      +
               IRTOTAL IUSE                                            +
               GLIM GSCR GEMPTY                                        +
               ACLSTR ADATA AINDEX AGDG ANVSAM                         +
               VOLSER DEVTYPE FSEQN)
        SET &MYCC = &LASTCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE PARSEIT: TBCREATE OF &YOURNAME FAILED RC=&MYCC
            GOTO ABORTIT
          ENDO
      ENDO
    ELSE +
    IF (&MYCC ^= 0) THEN +
      DO
        WRITENR PARSEIT: +
        TBOPEN FAILED FOR OTHER THAN NONEXISTENCE RC=&MYCC
        GOTO ABORTIT
      ENDO
    SET &TYPE =
GETLOOP: +
    ERROR +
      DO
        ERROR OFF
        GOTO CLOSIT
      ENDO
    GETFILE CATLIST
    ERROR OFF
    SET &LINEL = &LENGTH(&STR(&CATLIST))
    SET &ASA = &SUBSTR(1:1,&STR(&CATLIST))
    IF (&STR(&ASA) = 1) THEN GOTO GETLOOP
    IF (&LINEL < 17) THEN GOTO SHRTREC
    SET &TEMP = &SUBSTR(2:17,&STR(&CATLIST))
    IF (&STR(&TEMP) = &STR(GDG BASE ------ )) THEN GOTO RECG
    IF (&STR(&TEMP) = &STR(USERCATALOG --- )) THEN GOTO RECU
    IF (&STR(&TEMP) = &STR(CLUSTER ------- )) THEN GOTO RECC
    IF (&STR(&TEMP) = &STR(DATA ---------- )) THEN GOTO RECD
    IF (&STR(&TEMP) = &STR(INDEX --------- )) THEN GOTO RECI
    IF (&STR(&TEMP) = &STR(NONVSAM ------- )) THEN GOTO RECN
    IF (&STR(&TEMP) = &STR(ALIAS --------- )) THEN GOTO RECA
    IF (&STR(&TEMP) = &STR(PAGESPACE ----- )) THEN GOTO RECP
SHRTREC: +
    SET &SYSDVAL = &SUBSTR(2:&LINEL,&STR(&CATLIST))
    READDVAL A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
    IF (&STR(&A) = &STR(IN-CAT) THEN +
      DO
        SET &CAT = &STR(&C)
        GOTO GETLOOP
      ENDO
    IF (&STR(&A) = HISTORY) THEN +
        GOTO GETLOOP
    IF (&STR(&A) = ASSOCIATIONS) THEN +
        GOTO GETLOOP
    IF (&STR(&A) = ATTRIBUTES) THEN +
        GOTO GETLOOP
    IF (&STR(&A) = STATISTICS) THEN +
        GOTO GETLOOP
    IF (&STR(&A) = ALLOCATION) THEN +
        GOTO GETLOOP
    IF (&STR(&A) = &STR(NONVSAM)) THEN GOTO RECN
    IF (&STR(&A) = &STR(DATA)) THEN GOTO RECD
    IF (&STR(&A) = &STR(INDEX)) THEN GOTO RECI
    SET &AL = &LENGTH(&STR(&A))
    IF (&AL < 24) THEN GOTO SMALLFLD
    SET &ASUB = &SUBSTR(1:7,&STR(&A))
    IF (&STR(&ASUB) = &STR(DEVTYPE)) THEN +
        GOTO GETLOOP
    IF (&STR(&ASUB) = &STR(VOLFLAG)) THEN +
        GOTO GETLOOP
    IF (&STR(&ASUB) = &STR(HIGH-CC)) THEN +
        GOTO GETLOOP
    IF (&STR(&ASUB) = &STR(OWNER-I)) THEN +
      DO
        SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &OWNER = &STR(&IT&OWNER)
          SET &AL = &AL - 1
          SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
          IF (&AL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &BL = &LENGTH(&STR(&B))
        SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &CREDT = &STR(&IT&CREDT)
          SET &BL = &BL - 1
          SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
          IF (&BL = 0) THEN SET &IT = &STR(-)
        ENDO
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(RELEASE)) THEN +
      DO
        SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &REL = &STR(&IT&REL)
          SET &AL = &AL - 1
          SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
          IF (&AL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &BL = &LENGTH(&STR(&B))
        SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &EXPDT = &STR(&IT&EXPDT)
          SET &BL = &BL - 1
          SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
          IF (&BL = 0) THEN SET &IT = &STR(-)
        ENDO
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(PROTECT)) THEN +
      DO
        SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &PROTPSWD = &STR(&IT&PROTPSWD)
          SET &AL = &AL - 1
          SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
          IF (&AL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &BL = &LENGTH(&STR(&B))
        SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &RACF = &STR(&IT&RACF)
          SET &BL = &BL - 1
          SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
          IF (&BL = 0) THEN SET &IT = &STR(-)
        ENDO
        GOTO GETLOOP
      ENDO
    IF (&STR(&A) = &STR(NONVSAM--)) THEN +
      DO
        SET &ANVSAM = &STR(&SUBSTR(10:&AL,&STR(&A)), &ANVSAM)
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(DATA---)) THEN +
      DO
        SET &ADATA = &SUBSTR(10:&AL,&STR(&A))
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(INDEX--)) THEN +
      DO
        SET &AINDEX = &SUBSTR(10:&AL,&STR(&A))
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(CLUSTER)) THEN +
      DO
        SET &ACLSTR = &SUBSTR(10:&AL,&STR(&A))
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(GDG----)) THEN +
      DO
        SET &AGDG = &STR(&SUBSTR(10:&AL,&STR(&A)) &AGDG)
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(KEYLEN-)) THEN +
      DO
        SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &KEYLEN = &STR(&IT&KEYLEN)
          SET &AL = &AL - 1
          SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
          IF (&AL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &BL = &LENGTH(&STR(&B))
        SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &AVGREC = &STR(&IT&AVGREC)
          SET &BL = &BL - 1
          SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
          IF (&BL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &CL = &LENGTH(&STR(&C))
        SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &BUFSPC = &STR(&IT&BUFSPC)
          SET &CL = &CL - 1
          SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
          IF (&CL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &DL = &LENGTH(&STR(&D))
        SET &IT = &SUBSTR(&DL:&DL,&STR(&D))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &CISIZE = &STR(&IT&CISIZE)
          SET &DL = &DL - 1
          SET &IT = &SUBSTR(&DL:&DL,&STR(&D))
          IF (&DL = 0) THEN SET &IT = &STR(-)
        ENDO
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(RKP----)) THEN +
      DO
        SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &RKP = &STR(&IT&RKP)
          SET &AL = &AL - 1
          SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
          IF (&AL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &BL = &LENGTH(&STR(&B))
        SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &MAXREC = &STR(&IT&MAXREC)
          SET &BL = &BL - 1
          SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
          IF (&BL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &CL = &LENGTH(&STR(&C))
        SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &EXCPEXIT = &STR(&IT&EXCPEXIT)
          SET &CL = &CL - 1
          SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
          IF (&CL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &DL = &LENGTH(&STR(&D))
        SET &IT = &SUBSTR(&DL:&DL,&STR(&D))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &CICA = &STR(&IT&CICA)
          SET &DL = &DL - 1
          SET &IT = &SUBSTR(&DL:&DL,&STR(&D))
          IF (&DL = 0) THEN SET &IT = &STR(-)
        ENDO
        GOTO GETLOOP
      ENDO
    IF (&STR(&ASUB) = &STR(REC-TOT)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DRTOTAL = &STR(&IT&DRTOTAL)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DSPLITCI = &STR(&IT&DSPLITCI)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &CL = &LENGTH(&STR(&C))
            SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DEXCPS = &STR(&IT&DEXCPS)
              SET &CL = &CL - 1
              SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
              IF (&CL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IRTOTAL = &STR(&IT&IRTOTAL)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &ISPLITCI = &STR(&IT&ISPLITCI)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &CL = &LENGTH(&STR(&C))
            SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IEXCPS = &STR(&IT&IEXCPS)
              SET &CL = &CL - 1
              SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
              IF (&CL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
      ENDO
    IF (&STR(&ASUB) = &STR(REC-DEL)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DRDEL = &STR(&IT&DRDEL)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DSPLITCA = &STR(&IT&DSPLITCA)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &CL = &LENGTH(&STR(&C))
            SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DEXTENTS = &STR(&IT&DEXTENTS)
              SET &CL = &CL - 1
              SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
              IF (&CL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IRDEL = &STR(&IT&IRDEL)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &ISPLITCA = &STR(&IT&ISPLITCA)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &CL = &LENGTH(&STR(&C))
            SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IEXTENTS = &STR(&IT&IEXTENTS)
              SET &CL = &CL - 1
              SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
              IF (&CL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
      ENDO
    IF (&STR(&ASUB) = &STR(REC-INS)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DRINS = &STR(&IT&DRINS)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DFREECI = &STR(&IT&DFREECI)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IRINS = &STR(&IT&IRINS)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IFREECI = &STR(&IT&IFREECI)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
      ENDO
    IF (&STR(&ASUB) = &STR(REC-UPD)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DRUPD = &STR(&IT&DRUPD)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DFREECA = &STR(&IT&DFREECA)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &DTIMSTMP = &STR(&C)
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IRUPD = &STR(&IT&IRUPD)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IFREECA = &STR(&IT&IFREECA)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &ITIMSTMP = &STR(&C)
          ENDO
      ENDO
    IF (&STR(&ASUB) = &STR(REC-RET)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DRRET = &STR(&IT&DRRET)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DFREBYTE = &STR(&IT&DFREBYTE)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IRRET = &STR(&IT&IRRET)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IFREBYTE = &STR(&IT&IFREBYTE)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
      ENDO
    IF (&STR(&ASUB) = &STR(SPACE-T)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &TEMP = &SUBSTR(&AL:&AL,&STR(&A))
            SET &DSPACTYP = (VOID)
            IF (&TEMP = R) THEN +
              SET &DSPACTYP = CYLINDER
            IF (&TEMP = K) THEN +
              SET &DSPACTYP = TRACK
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DHIRBA = &STR(&IT&DHIRBA)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &TEMP = &SUBSTR(&AL:&AL,&STR(&A))
            SET &ISPACTYP = (VOID)
            IF (&TEMP = R) THEN +
              SET &ISPACTYP = CYLINDER
            IF (&TEMP = K) THEN +
              SET &ISPACTYP = TRACK
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IHIRBA = &STR(&IT&IHIRBA)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
      ENDO
    IF (&STR(&ASUB) = &STR(SPACE-P)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DALCP = &STR(&IT&DALCP)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DHURBA = &STR(&IT&DHURBA)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IALCP = &STR(&IT&IALCP)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &BL = &LENGTH(&STR(&B))
            SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IHURBA = &STR(&IT&IHURBA)
              SET &BL = &BL - 1
              SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
      ENDO
    IF (&STR(&ASUB) = &STR(SPACE-S)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &DALCS = &STR(&IT&DALCS)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&AL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &IALCS = &STR(&IT&IALCS)
              SET &AL = &AL - 1
              SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
              IF (&BL = 0) THEN SET &IT = &STR(-)
            ENDO
          ENDO
      ENDO
    IF (&STR(&ASUB) = &STR(LIMIT--)) THEN +
      DO
        SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
        DO WHILE &STR(&IT) NE &STR(-)
          SET &GLIM = &STR(&IT&GLIM)
          SET &AL = &AL - 1
          SET &IT = &SUBSTR(&AL:&AL,&STR(&A))
          IF (&AL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &GSCR = &STR(&B)
        SET &GEMPTY = &STR(&C)
      ENDO
    IF (&STR(&ASUB) = &STR(VOLSER-)) THEN +
      DO
        IF (&VOLSER ^= ) THEN SET &VOLSER = &STR(&VOLSER,)
        SET &VOLSER = &STR(&VOLSER &SUBSTR(19:24,&STR(&A))
        SET &BL = &LENGTH(&STR(&B))
        SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
        IF (&STR(&DEVTYPE) ^= ) THEN +
          SET &DEVTYPE = &STR(&DEVTYPE)&STR(,)
        SET &DEVIT =
        DO WHILE &STR(&IT) NE &STR(-)
          SET &DEVIT = &STR(&IT&DEVIT)
          SET &BL = &BL - 1
          SET &IT = &SUBSTR(&BL:&BL,&STR(&B))
          IF (&BL = 0) THEN SET &IT = &STR(-)
        ENDO
        IF (&STR(&DEVIT) = &STR(X'78008080') THEN +
          SET &DEVIT = 3480
        IF (&STR(&DEVIT) = &STR(X'78048080') THEN +
          SET &DEVIT = 3480
        IF (&STR(&DEVIT) = &STR(X'000D8000') THEN +
          SET &DEVIT = 3480
        IF (&STR(&DEVIT) = &STR(X'32008003') THEN +
          SET &DEVIT = TAPE
        IF (&STR(&DEVIT) = &STR(X'000C8000') THEN +
          SET &DEVIT = TAPE
        SET &DEVTYPE = &STR(&DEVTYPE &DEVIT)
        SET &CL = &LENGTH(&STR(&C))
        SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
        IF (&STR(&FSEQN) ^= ) THEN +
          SET &FSEQN = &STR(&FSEQN)&STR(,)
        SET &FSEQIT =
        DO WHILE &STR(&IT) NE &STR(-)
          SET &FSEQIT = &STR(&IT&FSEQIT)
          SET &CL = &CL - 1
          SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
          IF (&CL = 0) THEN SET &IT = &STR(-)
        ENDO
        SET &FSEQN = &STR(&FSEQN &FSEQIT)
      ENDO
    IF (&STR(&ASUB) = &STR(LOW-CCH)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &CL = &LENGTH(&STR(&C))
            SET &TMPUSE =
            SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &TMPUSE = &STR(&IT&TMPUSE)
              SET &CL = &CL - 1
              SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
              IF (&CL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &DUSE = &DUSE + &TMPUSE
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &CL = &LENGTH(&STR(&C))
            SET &TMPUSE =
            SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
            DO WHILE &STR(&IT) NE &STR(-)
              SET &TMPUSE = &STR(&IT&TMPUSE)
              SET &CL = &CL - 1
              SET &IT = &SUBSTR(&CL:&CL,&STR(&C))
              IF (&CL = 0) THEN SET &IT = &STR(-)
            ENDO
            SET &IUSE = &IUSE + &TMPUSE
          ENDO
      ENDO
    GOTO GETLOOP
SMALLFLD: +
    SET &SYSDVAL = &SUBSTR(2:&LINEL,&STR(&CATLIST))
    READDVAL A B C D E F G H
    IF (&STR(&A) = VOLUME) THEN +
        GOTO GETLOOP
    IF (&STR(&A) = VOLUMES) THEN +
        GOTO GETLOOP
    IF (&STR(&A) = &STR(EXTENTS:)) THEN +
        GOTO GETLOOP
    SET &ASUB = &SUBSTR(1:3,&STR(&A))
    IF (&STR(&ASUB) = &STR(SHR)) THEN +
      DO
        IF (&TYPE = DATA) THEN +
          DO
            SET &REGION = &SUBSTR(10:10,&STR(&A))
            SET &SYSTEM = &SUBSTR(1:1,&STR(&B))
            SET &RCVRY = &STR(&C)
            SET &UNIQUE = &STR(&D)
            SET &ERASE = &STR(&E)
            SET &INDXED = &STR(&F)
            SET &WRTCHK = &STR(&G)
            SET &IMBED = &STR(&H)
            SET &REPLIC = &STR(&I)
            GETFILE CATLIST
            SET &LINEL = &LENGTH(&STR(&CATLIST))
            SET &SYSDVAL = &SUBSTR(2:&LINEL,&STR(&CATLIST))
            READDVAL A B C D E F G H
            SET &ORDER = &STR(&A)
            SET &REUSE = &STR(&B)
            SET &SPANNED = &STR(&C)
            GOTO GETLOOP
          ENDO
        IF (&TYPE = INDEX) THEN +
          DO
            SET &REGION = &SUBSTR(10:10,&STR(&A))
            SET &SYSTEM = &SUBSTR(1:1,&STR(&B))
            SET &RCVRY = &STR(&C)
            SET &UNIQUE = &STR(&D)
            SET &ERASE = &STR(&E)
            SET &WRTCHK = &STR(&F)
            SET &IMBED = &STR(&G)
            SET &REPLIC = &STR(&H)
            SET &ORDER = &STR(&I)
            GETFILE CATLIST
            SET &LINEL = &LENGTH(&STR(&CATLIST))
            SET &SYSDVAL = &SUBSTR(2:&LINEL,&STR(&CATLIST))
            READDVAL A B C D E F G H
            SET &REUSE = &STR(&A)
            GOTO GETLOOP
          ENDO
      ENDO
    GOTO GETLOOP
RECG: +
    SET &GOBACK = GETENT
    GOTO INITONE
RECU: +
    SET &GOBACK = GETENT
    GOTO INITONE
RECC: +
    SET &GOBACK = GETENT
    GOTO INITONE
RECD: +
    SET &GOBACK = GETENT
    GOTO INITONE
RECI: +
    SET &GOBACK = GETENT
    GOTO INITONE
RECN: +
    SET &GOBACK = GETENT
    GOTO INITONE
RECA: +
    SET &GOBACK = GETENT
    GOTO INITONE
RECP: +
    SET &GOBACK = GETENT
    GOTO INITONE
GETENT: +
    SET &SYSDVAL = &SUBSTR(2:&LINEL,&STR(&CATLIST))
    READDVAL A B C D E F G H
    SET &TYPE = &STR(&A)
    SET &ENTRY = &STR(&C)
    IF (&STR(&A) = GDG) THEN SET &ENTRY = &STR(&D)
    GOTO GETLOOP
INITONE: +
    IF (&STR(&TYPE) NE ) THEN +
      DO
        SET &OUTCTR = &OUTCTR + 1
        IF (&WHERE = BACK) THEN +
          DO
            SET &DISPCTR = &OUTCTR
            SET &L = &LENGTH(&DISPCTR)
            DO WHILE &L < 7
              SET &DISPCTR = &STR( &DISPCTR)
              SET &L = &LENGTH(&DISPCTR)
            ENDO
            SET &DISPTYPE = &TYPE
            SET &L = &LENGTH(&DISPTYPE)
            DO WHILE &L < 11
              SET &DISPTYPE = &STR(&DISPTYPE )
              SET &L = &LENGTH(&DISPTYPE)
            ENDO
            WRITE PARSEIT: &DISPCTR &DISPTYPE &ENTRY
          ENDO
        ISPEXEC TBADD &YOURNAME
        SET &MYCC = &LASTCC
        IF (&MYCC ^= 0) THEN +
          DO
            WRITE PARSEIT: TBADD OF &TYPE &ENTRY FAILED RC=&MYCC
          ENDO
      ENDO
    SET &TYPE =
    SET &ENTRY =
    SET &CAT =
    SET &OWNER =
    SET &CREDT =
    SET &REL =
    SET &EXPDT =
    SET &PROTPSWD =
    SET &RACF =
    SET &ADATA =
    SET &AINDEX =
    SET &ANVSAM =
    SET &KEYLEN =
    SET &AVGREC =
    SET &BUFSPC =
    SET &CISIZE =
    SET &RKP =
    SET &MAXREC =
    SET &EXCPEXIT =
    SET &CICA =
    SET &REGION =
    SET &SYSTEM =
    SET &RCVRY =
    SET &UNIQUE =
    SET &ERASE =
    SET &INDXED =
    SET &WRTCHK =
    SET &IMBED =
    SET &REPLIC =
    SET &ORDER =
    SET &REUSE =
    SET &SPANNED =
    SET &DRTOTAL =
    SET &DSPLITCI =
    SET &DEXCPS =
    SET &DRDEL =
    SET &DSPLITCA =
    SET &DEXTENTS =
    SET &DRINS =
    SET &DFREECI =
    SET &DRUPD =
    SET &DFREECA =
    SET &DTIMSTMP =
    SET &DRRET =
    SET &DFREBYTE =
    SET &DSPACTYP =
    SET &DHIRBA =
    SET &DALCP =
    SET &DHURBA =
    SET &DALCS =
    SET &IRTOTAL =
    SET &ISPLITCI =
    SET &IEXCPS =
    SET &IRDEL =
    SET &ISPLITCA =
    SET &IEXTENTS =
    SET &IRINS =
    SET &IFREECI =
    SET &IRUPD =
    SET &IFREECA =
    SET &ITIMSTMP =
    SET &IRRET =
    SET &IFREBYTE =
    SET &ISPACTYP =
    SET &IHIRBA =
    SET &IALCP =
    SET &IHURBA =
    SET &IALCS =
    SET &GLIM =
    SET &GSCR =
    SET &GEMPTY =
    SET &VOLSER =
    SET &DEVTYPE =
    SET &FSEQN =
    SET &DUSE = 0
    SET &IUSE = 0
    SET &ACLSTR =
    SET &AGDG =
    GOTO &GOBACK
CLOSIT: +
    SET &GOBACK = CLOSLIST
    GOTO INITONE
CLOSLIST: +
    CLOSFILE CATLIST
    FREE FILE(CATLIST)
    ISPEXEC TBCLOSE &YOURNAME
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        WRITE PARSEIT: TBCLOSE OF &YOURNAME FAILED RC=&MYCC
        ISPEXEC TBEND &YOURNAME
        EXIT CODE(&MAXCC)
      ENDO
    EXIT CODE(0)
ABORTIT: +
    CLOSFILE CATLIST
    FREE FILE(CATLIST)
    ISPEXEC TBCLOSE &YOURNAME
    EXIT CODE(&MAXCC)
./ ADD NAME=PDSBATCH 0101-93134-93135-1154-00113-00111-00002-KETCSC
PROC 2 DATASET MACRO
/*                                                                 */
/* LIB: KETCSC.CLIST(PDSBATCH)                                     */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST RUNS THRU A PDS AND MAKES GLOBAL CHANGES.       */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
    ISPEXEC CONTROL ERRORS RETURN
AGAIN: +
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DSNR = &LENGTH(&DATASET)
        SET &DSNR = &DSNR - 1
        SET &DATASETE = &SUBSTR(2:&DSNR,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    SET &DSNL = 1
    SET &DSNR = &LENGTH(&DATASETE)
    SET &RIGHTP = &SUBSTR(&DSNR:&DSNR,&DATASETE)
    IF &RIGHTP = ) THEN +
      DO
        SET &MEML = &DSNR
        SET &LEFTP = N
        DO WHILE &LEFTP ^= (
          SET &MEML = &MEML - 1
          SET &LEFTP = &SUBSTR(&MEML:&MEML,&DATASETE)
        ENDO
        SET &MEML = &MEML + 1
        SET &MEMR = &DSNR - 1
        SET &DSNR = &MEML - 2
        SET &MEM = &SUBSTR(&MEML:&MEMR,&DATASETE )
      ENDO
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    LISTDSI '&DSN'
    IF (&NRSTR(&SYSDSORG) ^= PO) THEN +
      DO
        SET &ZERRLM = &STR(THE TEMPORARY USER-ENTITY TABLE)
        WRITE &STR(&ZERRLM.WAS NOT CREATED)
        EXIT CODE(12)
      ENDO
    SET &PDSDSN = &DSN
    ISPEXEC LMINIT DATAID(PDSID) +
      DATASET('&PDSDSN') ENQ(SHR)
    IF (&LASTCC ^= 0) THEN +
      DO
        WRITE &STR(THE FILE &PDSDSN IS IN USE)
        GOTO ABNEXIT
      ENDO
    ISPEXEC LMOPEN DATAID(&PDSID) +
      OPTION(INPUT)
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        SET &ZERRLM = &STR(THE FILE &PDSDSN FAILED TO)
        WRITE &STR(&ZERRLM.OPEN RC=&MYCC)
        GOTO ABNEXIT
      ENDO
    SET &CHGIT = &STR( )
    WRITE &STR(EXECUTING &MACRO ON &DATASET)
    SET &PDSMBR = &MEMB
PDSREAD: +
    ISPEXEC LMMLIST DATAID(&PDSID) +
      OPTION(LIST) MEMBER(PDSMBR) STATS(YES)
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        GOTO NORMEXIT
      ENDO
    SET &PDSMBR = &PDSMBR
    IF (&MEME NE ) THEN +
      DO
        IF (&PDSMBR > &MEME) THEN +
          DO
            GOTO NORMEXIT
          ENDO
      ENDO
    IF (&MEMB NE ) THEN +
      DO
        IF (&PDSMBR < &MEMB) THEN +
          DO
            GOTO PDSREAD
          ENDO
      ENDO
    GOTO EDITIT
EDITIT: +
    SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))
    ISPEXEC VPUT (PDSDSN) SHARED
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(&MACRO)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        WRITE &NRSTR(&PDSDSN)
      ENDO
    GOTO PDSREAD
ABNEXIT: +
    ISPEXEC LMMLIST DATAID(&PDSID) OPTION(FREE)
    ISPEXEC LMCLOSE DATAID(&PDSID)
    ISPEXEC LMFREE  DATAID(&PDSID)
    WRITE &STR(ABENDED SOMEWHERE)
    EXIT CODE(4)
NORMEXIT: +
    ISPEXEC LMMLIST DATAID(&PDSID) OPTION(FREE)
    ISPEXEC LMCLOSE DATAID(&PDSID)
    ISPEXEC LMFREE      DATAID(&PDSID)
    WRITE &STR(ALL DONE)
    EXIT CODE(0)
./ ADD NAME=PDSCHG   0102-90341-91022-0928-00131-00131-00001-DMV0016
PROC 1 DATASET
/*                                                                 */
/* LIB: KETCSC.CLIST(PDSCHG)                                       */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST RUNS THRU A PDS AND MAKES GLOBAL CHANGES.       */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
    ISPEXEC CONTROL ERRORS RETURN
AGAIN: +
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DSNR = &LENGTH(&DATASET)
        SET &DSNR = &DSNR - 1
        SET &DATASETE = &SUBSTR(2:&DSNR,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    SET &DSNL = 1
    SET &DSNR = &LENGTH(&DATASETE)
    SET &RIGHTP = &SUBSTR(&DSNR:&DSNR,&DATASETE)
    IF &RIGHTP = ) THEN +
      DO
        SET &MEML = &DSNR
        SET &LEFTP = N
        DO WHILE &LEFTP ^= (
          SET &MEML = &MEML - 1
          SET &LEFTP = &SUBSTR(&MEML:&MEML,&DATASETE)
        ENDO
        SET &MEML = &MEML + 1
        SET &MEMR = &DSNR - 1
        SET &DSNR = &MEML - 2
        SET &MEM = &SUBSTR(&MEML:&MEMR,&DATASETE )
      ENDO
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    LISTDSI '&DSN'
    IF (&NRSTR(&SYSDSORG) ^= PO) THEN +
      DO
        SET &ZERRSM = &STR(ERROR BUILDING TABLE)
        SET &ZERRLM = &STR(THE TEMPORARY USER-ENTITY TABLE)
        SET &ZERRLM = &STR(&ZERRLM.WAS NOT CREATED)
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(12)
      ENDO
    SET &PDSDSN = &DSN
    ISPEXEC LMINIT DATAID(PDSID) +
      DATASET('&PDSDSN') ENQ(SHR)
    IF (&LASTCC ^= 0) THEN +
      DO
        SET &ZERRSM = &STR(FILE IN USE)
        SET &ZERRLM = &STR(THE FILE &PDSDSN IS IN USE)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ISPEXEC LMOPEN DATAID(&PDSID) +
      OPTION(INPUT)
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        SET &ZERRSM = &STR(FILE FAILED TO OPEN)
        SET &ZERRLM = &STR(THE FILE &PDSDSN FAILED TO)
        SET &ZERRLM = &STR(&ZERRLM.OPEN RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    SET &CHGIT = &STR( )
    ISPEXEC DISPLAY PANEL(PDSCHG)
    IF (&LASTCC ^= 0) THEN +
      DO
        SET &ZERRSM = &STR(REQUEST CANCELLED)
        SET &ZERRLM = &STR(YOU CANCELLED THE REQUEST TO)
        SET &ZERRLM = &STR(&ZERRLM.MAKE CHANGES)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ISPEXEC LOG MSG(DBG003)
    ISPEXEC LOG MSG(DBG004)
    ISPEXEC LOG MSG(DBG005)
    SET &PDSMBR = &MEMB
PDSREAD: +
    ISPEXEC LMMLIST DATAID(&PDSID) +
      OPTION(LIST) MEMBER(PDSMBR) STATS(YES)
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        GOTO NORMEXIT
      ENDO
    SET &PDSMBR = &PDSMBR
    IF (&MEME NE ) THEN +
      DO
        IF (&PDSMBR > &MEME) THEN +
          DO
            GOTO NORMEXIT
          ENDO
      ENDO
    IF (&MEMB NE ) THEN +
      DO
        IF (&PDSMBR < &MEMB) THEN +
          DO
            GOTO PDSREAD
          ENDO
      ENDO
    GOTO EDITIT
EDITIT: +
    SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))
    ISPEXEC VPUT (PDSDSN) SHARED
    ISPEXEC CONTROL DISPLAY LOCK
    ISPEXEC DISPLAY PANEL(PDSCHG)
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(PDSCHGIT)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        ISPEXEC CONTROL DISPLAY LOCK
        ISPEXEC DISPLAY PANEL(PDSCHG)
      ENDO
    GOTO PDSREAD
ABNEXIT: +
    ISPEXEC LMMLIST DATAID(&PDSID) OPTION(FREE)
    ISPEXEC LMCLOSE DATAID(&PDSID)
    ISPEXEC LMFREE  DATAID(&PDSID)
    EXIT CODE(4)
NORMEXIT: +
    ISPEXEC LMMLIST DATAID(&PDSID) OPTION(FREE)
    ISPEXEC LMCLOSE DATAID(&PDSID)
    ISPEXEC LMFREE      DATAID(&PDSID)
    EXIT CODE(0)
./ ADD NAME=PDSCHGIT 0101-90341-92189-0934-00070-00071-00000-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT CAPS OFF
    ISPEXEC VGET (OLDTXT, NEWTXT, DSN, PDSMBR, PDSDSN, COLB, COLE) ASIS
    SET &PDSDSN = &PDSDSN
    SET &APOST = &SUBSTR(1:1,&NRSTR(&OLDTXT))
    IF (&NRSTR(&APOST) EQ &STR(')) THEN +
      DO
        SET &APOST = &SUBSTR(1:1,&NRSTR(&NEWTXT))
        IF (&NRSTR(&APOST) EQ &STR(')) THEN +
          DO
            ISREDIT C &OLDTXT &NEWTXT &COLB &COLE ALL
            SET &MYCC = &LASTCC
          ENDO
        ELSE +
          DO
            ISREDIT C &OLDTXT '&NEWTXT' &COLB &COLE ALL
            SET &MYCC = &LASTCC
          ENDO
      ENDO
    ELSE +
      DO
        SET &APOST = &SUBSTR(1:1,&NRSTR(&NEWTXT))
        IF (&NRSTR(&APOST) EQ &STR(')) THEN +
          DO
            ISREDIT C '&OLDTXT' &NEWTXT &COLB &COLE ALL
            SET &MYCC = &LASTCC
          ENDO
        ELSE +
          DO
            ISREDIT C '&OLDTXT' '&NEWTXT' &COLB &COLE ALL
            SET &MYCC = &LASTCC
          ENDO
      ENDO
    IF (&MYCC = 0) THEN +
      DO
        ISREDIT (CHGROW,CHGLINE) = CHANGE_COUNTS
        SET &CHGROW = &CHGROW
        SET &CHGLINE = &CHGLINE
        IF (&CHGLINE = 0) THEN SET &CHGLINE = &CHGROW
        SET &CHGIT = &NRSTR(STRINGS: &CHGROW, IN &CHGLINE LINES)
        ISPEXEC CONTROL DISPLAY LOCK
        ISPEXEC DISPLAY PANEL(PDSCHG)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC ^= 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            SET &CHGIT = &NRSTR(COMPRESSING ONCE)
            ISPEXEC CONTROL DISPLAY LOCK
            ISPEXEC DISPLAY PANEL(PDSCHG)
            %CP &DATASET
            IF (&MYCC ^= 0) THEN +
              DO
                SET &CHGIT = &NRSTR(COMPRESS FAILED)
                ISPEXEC DISPLAY PANEL(PDSCHG)
              ENDO
            ISREDIT SAVE
          ENDO
        ISPEXEC VPUT (PDSMBR CHGROWS CHGLINES) SHARED
        ISREDIT END
      ENDO
    IF (&MYCC ^= 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=PDSMACRO 0103-90341-91022-0928-00131-00131-00003-DMV0016
PROC 1 DATASET
/*                                                                 */
/* LIB: KETCSC.CLIST(PDSCHG)                                       */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST RUNS THRU A PDS AND MAKES GLOBAL CHANGES.       */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG MAIN ASIS
    ISPEXEC CONTROL ERRORS RETURN
AGAIN: +
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DSNR = &LENGTH(&DATASET)
        SET &DSNR = &DSNR - 1
        SET &DATASETE = &SUBSTR(2:&DSNR,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    SET &DSNL = 1
    SET &DSNR = &LENGTH(&DATASETE)
    SET &RIGHTP = &SUBSTR(&DSNR:&DSNR,&DATASETE)
    IF &RIGHTP = ) THEN +
      DO
        SET &MEML = &DSNR
        SET &LEFTP = N
        DO WHILE &LEFTP ^= (
          SET &MEML = &MEML - 1
          SET &LEFTP = &SUBSTR(&MEML:&MEML,&DATASETE)
        ENDO
        SET &MEML = &MEML + 1
        SET &MEMR = &DSNR - 1
        SET &DSNR = &MEML - 2
        SET &MEM = &SUBSTR(&MEML:&MEMR,&DATASETE )
      ENDO
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    LISTDSI '&DSN'
    IF (&NRSTR(&SYSDSORG) ^= PO) THEN +
      DO
        SET &ZERRSM = &STR(ERROR BUILDING TABLE)
        SET &ZERRLM = &STR(THE TEMPORARY USER-ENTITY TABLE)
        SET &ZERRLM = &STR(&ZERRLM.WAS NOT CREATED)
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(12)
      ENDO
    SET &PDSDSN = &DSN
    ISPEXEC LMINIT DATAID(PDSID) +
      DATASET('&PDSDSN') ENQ(SHR)
    IF (&LASTCC ^= 0) THEN +
      DO
        SET &ZERRSM = &STR(FILE IN USE)
        SET &ZERRLM = &STR(THE FILE &PDSDSN IS IN USE)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ISPEXEC LMOPEN DATAID(&PDSID) +
      OPTION(INPUT)
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        SET &ZERRSM = &STR(FILE FAILED TO OPEN)
        SET &ZERRLM = &STR(THE FILE &PDSDSN FAILED TO)
        SET &ZERRLM = &STR(&ZERRLM.OPEN RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    SET &CHGIT = &STR( )
    ISPEXEC DISPLAY PANEL(PDSMACRO)
    IF (&LASTCC ^= 0) THEN +
      DO
        SET &ZERRSM = &STR(REQUEST CANCELLED)
        SET &ZERRLM = &STR(YOU CANCELLED THE REQUEST TO)
        SET &ZERRLM = &STR(&ZERRLM.MAKE CHANGES)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ISPEXEC LOG MSG(DBG003)
    ISPEXEC LOG MSG(DBG004)
    ISPEXEC LOG MSG(DBG005)
    SET &PDSMBR = &MEMB
PDSREAD: +
    ISPEXEC LMMLIST DATAID(&PDSID) +
      OPTION(LIST) MEMBER(PDSMBR) STATS(YES)
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN +
      DO
        GOTO NORMEXIT
      ENDO
    SET &PDSMBR = &PDSMBR
    IF (&MEME NE ) THEN +
      DO
        IF (&PDSMBR > &MEME) THEN +
          DO
            GOTO NORMEXIT
          ENDO
      ENDO
    IF (&MEMB NE ) THEN +
      DO
        IF (&PDSMBR < &MEMB) THEN +
          DO
            GOTO PDSREAD
          ENDO
      ENDO
    GOTO EDITIT
EDITIT: +
    SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))
    ISPEXEC VPUT (PDSDSN) SHARED
    ISPEXEC CONTROL DISPLAY LOCK
    ISPEXEC DISPLAY PANEL(PDSMACRO)
    SET &MAXCC = 0
    ISPEXEC EDIT DATASET('&DSN(&PDSMBR)') +
      MACRO(&MACRO)
    SET &MYCC = &MAXCC
    IF (&MYCC > 4) THEN +
      DO
        SET &PDSDSN = &NRSTR(&DSN(&PDSMBR))&STR(, RC=&MYCC)
        ISPEXEC CONTROL DISPLAY LOCK
        ISPEXEC DISPLAY PANEL(PDSMACRO)
      ENDO
    GOTO PDSREAD
ABNEXIT: +
    ISPEXEC LMMLIST DATAID(&PDSID) OPTION(FREE)
    ISPEXEC LMCLOSE DATAID(&PDSID)
    ISPEXEC LMFREE  DATAID(&PDSID)
    EXIT CODE(4)
NORMEXIT: +
    ISPEXEC LMMLIST DATAID(&PDSID) OPTION(FREE)
    ISPEXEC LMCLOSE DATAID(&PDSID)
    ISPEXEC LMFREE      DATAID(&PDSID)
    EXIT CODE(0)
./ ADD NAME=PLAN     0102-93090-93140-0804-00014-00023-00014-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(PLAN)                                                */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST INVOKES 3.4 WITH A PREFIX SET.                  */
/*                                                                 */
    CONTROL NOLIST FLUSH END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    SET &XDBSPFX = XDBS.PROJECT
    SET &XDBSDR = BYPASS
    ISPEXEC VPUT (XDBSDR XDBSPFX) SHARED
AGAIN: +
    ISPEXEC SELECT PGM(ISRUDL) PARM(XDBSUDLP)
    EXIT CODE(&LASTCC)
./ ADD NAME=PLATSET  0102-93190-94031-1652-00015-00012-00005-KETCSC
PROC 1 SSID
 /*                                                                  */
 /* LIB: CLIST(PLATSET)                                              */
 /* GDE: DB2 GROUP                                                   */
 /* DOC: THIS CLIST SETS THE MODEL DSN IN THE PROFILE.               */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
/*  CONTROL LIST MSG CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VGET (BBMDSN) PROFILE
    IF (&NRSTR(&BBMDSN) = ) THEN +
      SET &BBMDSN = &SSID..PLATINUM.MODEL
    SET &SYS = &SSID
    ISPEXEC VPUT (BBMDSN SYS) PROFILE
    EXIT CODE(0)
./ ADD NAME=PROINSTL 0125-92086-92366-1221-00199-00077-00199-BORGY
PROC 1 SSID PANEL()
 /*                                                                  */
 /* LIB: CLIST(ISPFON)                                               */
 /* GDE: KEN TOMIAK                                                  */
 /* DOC: THIS CLIST ALLOCATES THE TSO AND ISPF DDNAMES.              */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    GETSYSID
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
 /*                                                                  */
 /*  NEVER TURN ON MSG CONLIST OR SYMLIST BEFORE THE LISTUSER CMD.   */
 /*                                                                  */
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO GETOWNR
      ENDO
    SET &PGMR = &PGMR
GETOWNR: +
    SET &B = &SYSINDEX(OWNER=,&STR(&SYSOUTLINE1))
    SET &B = &B + 6
    SET &E = &B + 8
    SET &OWNR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ERROR +
      DO
        ERROR OFF
        GOTO CHKAUTH
      ENDO
    SET &OWNR = &OWNR
 /*                                                                  */
 /*  HRA                                                             */
 /*                                                                  */
CHKAUTH: +
    ERROR OFF
 /*                                                                  */
 /*  HRA                                                             */
 /*                                                                  */
    IF (&OWNR = CWA069D) THEN EXIT CODE(0)
 /*                                                                  */
 /*  CDCSA DB2 GROUP                                                 */
 /*                                                                  */
    IF (&OWNR = CSCDB2) THEN GOTO BEGIN
    IF (&SYSUID = DMV0016) OR +
       (&SYSUID = SUE)     OR +
       (&SYSUID = MJLCSC)  OR +
       (&SYSUID = DB2CSC)  OR +
       (&SYSUID = BORGY)   OR +
       (&SYSUID = MANN)    OR +
       (&SYSUID = PETE)    OR +
       (&SYSUID = AXGCSC)  THEN +
      GOTO BEGIN
 /*                                                                  */
 /*  UNKNOWN USERS                                                   */
 /*                                                                  */
    EXIT CODE(0)
BEGIN: +
    WRITE
    WRITE Hi &PGMR.. Welcome to the &SYSID system.
    WRITE
    IF (&SYSID = MVSP) THEN +
      DO
        IF (&SYSPROC = DB2PROD) THEN +
          DO
            SET &DB2PRE = &STR(P1DB.)
            SET &CSPPRE = &STR(CSP.PROD.)
          ENDO
        ELSE +
          DO
            SET &DB2PRE = &STR(D1DB.)
            SET &CSPPRE = &STR(CSP.DEVL.)
          ENDO
      ENDO
    ELSE +
    IF (&SYSID = MVSX) THEN +
      DO
        SET &DB2PRE = &STR(DB2M.)
        SET &CSPPRE = &STR(CSPT.)
      ENDO
 /*                                                                  */
 /*  SET UP TSO ENVIRONMENT                                          */
 /*                                                                  */
    PROFILE MODE WTPMSG MSGID PREFIX(&SYSUID)
    FREE FI(SYSPROC)
    ALLOC FI(SYSPROC) SHR DA('XDBS.TSOISPF.EXEC'      /* DB2 GROUP*/  +
                             'XDBS.TSOISPF.CLIST'     /* DB2 GROUP*/  +
                             'ISR.ISRCLIB'            /* ISPF/PDF */  +
                             'SYS1.CSC.HRACLIB'       /* CDCSA/HRA*/  +
                             'XDBS.PROINSTL.CLIST'    /* PROINSTAL*/  +
                             '&SSID..PROEDIT.CLIST'   /* PROEDIT  */  +
                             '&DB2PRE.DSNCLIST'       /* DB2      */  +
                             '&DB2PRE.DSQCLSTE'       /* QMF      */  +
                             '&CSPPRE.ADCLIST'        /* CSP/AD   */  +
                             '&CSPPRE.AECLIST'   )    /* CSP/AE   */
 /*                                                                  */
 /*  SET UP ISPF ENVIRONMENT                                         */
 /*                                                                  */
    FREE FILE(ISPLLIB,ISPMLIB,ISPPLIB,ISPSLIB,ISPTLIB,ISPPROF,ISPTABL)
    SET &DSNAME = &SYSUID..ISPF.ISPPROF
    ALLOC FI(ISPPROF) SHR  DA('&DSNAME.') REUSE
    IF &LASTCC ^= 0 THEN +
      DO
        FREE FI(ISPCRTE)
        CONTROL MSG
        ATTRIB ISPCRTE DSORG(PO) RECFM(F B) LRECL(80) BLKSIZE(3120)
        ALLOC DA('&DSNAME.') SP(5,0) TRACKS DIR(8) USING(ISPCRTE) +
            FI(ISPPROF)
        IF &LASTCC = 0 THEN +
          WRITE *** ISPF PROFILE DATA SET '&DSNAME.' HAS BEEN CREATED
        ELSE +
         DO
          WRITE  *** UNABLE TO ALLOCATE ISPF PROFILE DATA SET '&DSNAME.'
          FREE FI(ISPCRTE)
          EXIT CODE(12)
         ENDO
        FREE FI(ISPCRTE)
      ENDO
    CONTROL MSG
    ERROR EXIT
    IF &PANEL = &STR() THEN +
      SET &PNL = PANEL(CSC@MSTR)
    ELSE +
      SET &PNL = PANEL(&PANEL)

    ALLOC FI(ISPLLIB) SHR DA('ISR.ISRLOAD'            /* ISPF/PDF */  +
                             'ISP.ISPLOAD')           /* ISPF     */  +
          REUSE
    ALLOC FI(ISPMLIB) SHR DA( +
                             'XDBS.TSOISPF.MSGS'      /* DB2 GROUP*/  +
                             'ISR.ISRMENU'            /* ISPF/PDF */  +
                             'ISP.ISPMENU'            /* ISPF     */  +
                             '&DB2PRE.DSNSPFM'        /* DB2      */  +
                             '&DB2PRE.DSQMLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPPLIB) SHR DA( +
                             'XDBS.TSOISPF.PANELS'    /* DB2 GROUP*/  +
                             'ISF.ISFPLIB'            /* SDSF     */  +
                             'ISR.ISRPENU'            /* ISPF/PDF */  +
                             'ISP.ISPPENU'            /* ISPF     */  +
                             'SYS1.CSC.HRAPLIB'       /* CDCSA/HRA*/  +
                             '&DB2PRE.DSNSPFP'        /* DB2      */  +
                             '&DB2PRE.DSQPLIBE'       /* QMF      */  +
                             '&CSPPRE.ADPLIB'         /* CSP/AD   */  +
                             '&CSPPRE.AEPLIB'    )    /* CSP/AE   */  +
          REUSE
    ALLOC FI(ISPSLIB) SHR DA( +
                             'XDBS.TSOISPF.SKELS'     /* DB2 GROUP*/  +
                             'ISR.ISRSENU'            /* ISPF/PDF */  +
                             'ISP.ISPSLIB'            /* ISPF     */  +
                             '&DB2PRE.DSQSLIBE'  )    /* QMF      */  +
          REUSE
    ALLOC FI(ISPTABL) SHR DA('&DSNAME.')              /* USER     */  +
          REUSE
    ALLOC FI(ISPTLIB) SHR DA('&DSNAME' +
                             'XDBS.TSOISPF.TABLES'    /* DB2 GROUP*/  +
                             'ISF.ISFTLIB'            /* SDSF     */  +
                             'ISR.ISRTLIB'            /* ISPF/PDF */  +
                             'ISP.ISPTENU'            /* ISPF     */  +
                             '&DB2PRE.DSQTLIBE'  )    /* QMF      */  +
          REUSE
    ERROR RETURN
/*********************************************************************/
/*  CHECK FOR USER DEFINED INVOCATION
/*********************************************************************/
    SET &DSNOK = &SYSDSN('&SYSUID..CLIST(ADDON)')
    IF (&STR(&DSNOK) EQ OK) THEN +
      GOTO INVKUSER
    WRITE
    WRITE Press ENTER when &STR(***) appears.
    WRITE
    ISPSTART &PNL
    WRITE
    WRITE SYSTEM&STR(:)&SYSID
    WRITE
    WRITE You are now out of ISPF.
    WRITE      OPTIONS are:
    WRITE         %l (to logon as &sysuid)
    WRITE         %x or logoff (to logoff)
    WRITE         %on (to get back to ispf menu)
    WRITE         %ipcs new (to invoke Interactive Problem Control)
    WRITE
    EXIT CODE(&MAXCC)
/*********************************************************************/
/*  USER HAS OWN INVOCATION CLIST
/*********************************************************************/
INVKUSER: +
    EX '&SYSUID..CLIST(ADDON)'
    EXIT CODE(&MAXCC)
./ ADD NAME=PTFAPCK  0101-91240-91240-1440-00024-00024-00000-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(PTFAPCK)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: SMP/E APPLY CHECK OF A PTF.                                */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) ASIS
/*  CONTROL   LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    %GETSYSID
    ISPEXEC VGET (SYSID)
BEGIN: +
    ISPEXEC DISPLAY PANEL(PTFAPCK)
    IF (&LASTCC ^= 0) THEN EXIT CODE(0)
    ISPEXEC VGET (ZONE SYSMOD) ASIS
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PTFAPCK
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    GOTO BEGIN
./ ADD NAME=PTFF1    0106-91074-92100-0950-00042-00040-00000-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(PTFF1)                                               */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: FRONT END THE IESERV SLEHDR CLIST.                         */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) ASIS
/*  CONTROL   LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    %GETSYSID
    ISPEXEC VGET (SYSID)
    SET &NODE = CSCBATCH
    ISPEXEC VGET (USRCLS TYPE DSN USER)
    ISPEXEC VGET (WA WB WC WD WE)
    ISPEXEC VGET (CSCSUSER)
BEGIN: +
    ISPEXEC DISPLAY PANEL(PTFF1)
    IF (&LASTCC ^= 0) THEN EXIT CODE(0)
    ISPEXEC VGET (USRCLS TYPE DSN USER PW)
    ISPEXEC VGET (WA WB WC WD WE)
    ISPEXEC VGET (CSCSUSER CSCSPSWD)
    SET &ACCT = &SUBSTR(1:4,&STR(&USER.1234)
    SET &RECA = &SUBSTR(1:8,&STR(&ACCT           )
    SET &RECA = &STR(&RECA.&SUBSTR(1:8,&STR(&USER           ))
    SET &RECA = &STR(&RECA.&SUBSTR(1:8,&STR(&PW            ))
    SET &RECA = &STR(&RECA.&STR(        W0400))
    SET &RECB = &STR(                     MLST)
    SET &RECB = &STR(&RECB.&SUBSTR(1:4,&STR(&USRCLS)          ))
    SET &RECB = &STR(&RECB.                G)
    SET &RECC = &STR(                     MPTF)
    SET &RECC = &STR(&RECC.&SUBSTR(1:4,&STR(&USRCLS)          ))
    SET &RECC = &STR(&RECC.                G)
    ISPEXEC VPUT (RECA RECB RECC) SHARED
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PTFF1
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    GOTO BEGIN
./ ADD NAME=PTFF2    0107-91098-92100-0950-00039-00037-00000-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(PTFF2)                                               */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: FRONT END THE IESERV SLEHDR CLIST.                         */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) ASIS
/*  CONTROL   LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    %GETSYSID
    ISPEXEC VGET (SYSID)
    SET &NODE = CSCBATCH
    ISPEXEC VGET (USRCLS TYPE DSN USER)
    ISPEXEC VGET (WA WB WC WD WE)
    ISPEXEC VGET (CSCSUSER)
BEGIN: +
    ISPEXEC DISPLAY PANEL(PTFF2)
    IF (&LASTCC ^= 0) THEN EXIT CODE(0)
    ISPEXEC VGET (USRCLS TYPE DSN USER PW)
    ISPEXEC VGET (WA WB WC WD WE)
    ISPEXEC VGET (CSCSUSER CSCSPSWD)
    SET &ACCT = &SUBSTR(1:4,&STR(&USER.1234)
    SET &RECA = &SUBSTR(1:8,&STR(&ACCT           )
    SET &RECA = &STR(&RECA.&SUBSTR(1:8,&STR(&USER           ))
    SET &RECA = &STR(&RECA.&SUBSTR(1:8,&STR(&PW            ))
    SET &RECA = &STR(&RECA.&STR(        W0400))
    SET &RECB = &STR(                     )
    SET &RECB = &STR(&RECB.&SUBSTR(1:7,&STR(&USRCLS)          ))
    SET &RECB = &STR(&RECB.                G)
    ISPEXEC VPUT (RECA RECB RECC) SHARED
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PTFF2
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    GOTO BEGIN
./ ADD NAME=PTFF3    0102-91178-92100-0950-00042-00042-00000-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(PTFF3)                                               */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: FRONT END THE IESERV SLEHDR CLIST.                         */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) ASIS
/*  CONTROL   LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    %GETSYSID
    ISPEXEC VGET (SYSID)
    SET &NODE = CSCBATCH
    ISPEXEC VGET (USRCLS TYPE DSN USER)
    ISPEXEC VGET (WA WB WC WD WE)
    ISPEXEC VGET (CSCSUSER)
BEGIN: +
    ISPEXEC DISPLAY PANEL(PTFF1)
    IF (&LASTCC ^= 0) THEN EXIT CODE(0)
    ISPEXEC VGET (USRCLS TYPE DSN USER PW)
    ISPEXEC VGET (WA WB WC WD WE)
    ISPEXEC VGET (CSCSUSER CSCSPSWD)
    SET &ACCT = &SUBSTR(1:4,&STR(&USER.1234)
    SET &RECA = &SUBSTR(1:8,&STR(&ACCT           )
    SET &RECA = &STR(&RECA.&SUBSTR(1:8,&STR(&USER           ))
    SET &RECA = &STR(&RECA.&SUBSTR(1:8,&STR(&PW            ))
    SET &RECA = &STR(&RECA.&STR(        W0400))
    SET &RECB = &STR(                     ELST)
    SET &RECB = &STR(&RECB.&SUBSTR(1:4,&STR(&USRCLS)          ))
    SET &RECB = &STR(&RECB.                G)
    SET &RECC = &STR(                     EPTF)
    SET &RECC = &STR(&RECC.&SUBSTR(1:4,&STR(&USRCLS)          ))
    SET &RECC = &STR(&RECC.                G)
    ISPEXEC VPUT (RECA RECB RECC) SHARED
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PTFF3
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    GOTO BEGIN
./ ADD NAME=PTFR1    0103-91074-91148-1326-00029-00027-00000-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(PTFR1)                                               */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: SMP/E RECEIVE OF PTF.                                      */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) ASIS
/*  CONTROL   LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    %GETSYSID
    ISPEXEC VGET (SYSID)
    ISPEXEC VGET (CSCDSN DOFDSN)
    ISPEXEC VGET (CSCSUSER CSCSPSWD)
    ISPEXEC VGET (USRCLS)
BEGIN: +
    ISPEXEC DISPLAY PANEL(PTFR1)
    IF (&LASTCC ^= 0) THEN EXIT CODE(0)
    ISPEXEC VGET (CSCDSN DOFDSN)
    ISPEXEC VGET (CSCSUSER CSCSPSWD)
    ISPEXEC VGET (USRCLS)
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PTFR1
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    GOTO BEGIN
./ ADD NAME=PTFR2    0101-91115-91148-1326-00029-00027-00000-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(PTFR2)                                               */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: SMP/E RECEIVE OF PTF.                                      */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) ASIS
/*  CONTROL   LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    %GETSYSID
    ISPEXEC VGET (SYSID)
    ISPEXEC VGET (CSCDSN DOFDSN)
    ISPEXEC VGET (CSCSUSER CSCSPSWD)
    ISPEXEC VGET (USRCLS)
BEGIN: +
    ISPEXEC DISPLAY PANEL(PTFR2)
    IF (&LASTCC ^= 0) THEN EXIT CODE(0)
    ISPEXEC VGET (CSCDSN DOFDSN)
    ISPEXEC VGET (CSCSUSER CSCSPSWD)
    ISPEXEC VGET (USRCLS)
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PTFR2
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    GOTO BEGIN
./ ADD NAME=QMF      0112-92217-93164-1409-00079-00051-00060-KETCSC
PROC 1 DB2ID
    CONTROL NOMSG NOLIST NOFLUSH END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    GETSYSID
    EX 'XDBS.TSOISPF.EXEC(CHCKSSID)' '&DB2ID'
    SET &MYCC = &LASTCC
    IF (&MYCC  = 0) THEN GOTO QMFIN
    WRITE SUBSYSTEM &DB2ID DOES NOT RUN ON &SYSID..
    EXIT CODE(16)
QMFIN: +
    ALTLIB ACTIVATE APPLICATION(EXEC) +
      DATASET('&DB2ID..DSQEXECE')
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(REQUEST FAILED)
        SET &ZERRLM = &STR(EXEC ALTLIB FAILED &MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(4)
      ENDO
    ALTLIB ACTIVATE APPLICATION(CLIST) +
      DATASET('&DB2ID..DSQCLSTE')
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(REQUEST FAILED)
        SET &ZERRLM = &STR(CLIST ALTLIB FAILED &MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(4)
      ENDO
/*
    FREE FILE(ADMGGMAP)
    ALLOC FILE(ADMGGMAP) DA('&DB2ID..DSQMAPE') SHR REUSE
    IF (&LASTCC NE 0) THEN +
      DO
        WRITE QMF IS NOT INSTALLED IN SUBSYSTEM &DB2ID..
        EXIT CODE(16)
      ENDO
    SET &SYS = X
    IF (&SYSID = MVSP) THEN SET &SYS = V
    IF (&SYSID = MVSW) THEN SET &SYS = V
    IF (&SYSID = MVSX) THEN SET &SYS = V
    FREE FILE(DSQPRINT)
    ALLOC FILE(DSQPRINT) SYSOUT(&SYS) +
      RECFM(F B A) BLKSIZE(1330) LRECL(133)
    FREE FILE(DSQDEBUG)
    ALLOC FILE(DSQDEBUG) SYSOUT(&SYS) +
      RECFM(F B A) BLKSIZE(1210) LRECL(121)
    FREE FILE(DSQPNLE)
    ALLOC FILE(DSQPNLE) DATASET('&DB2ID..DSQPNLE') SHR REUSE
    FREE FILE(SYSEXEC)
    ALLOC FILE(SYSEXEC) DATASET('&DB2ID..DSQEXECE') SHR REUSE
    FREE FILE(DSQSPILL)
    ALLOC FILE(DSQSPILL) SYSOUT(&SYS) +
      RECFM(F) BLKSIZE(4096) LRECL(4096)
    DELETE DSQEDIT
    FREE FILE(DSQEDIT)
    ALLOC FILE(DSQEDIT) NEW CATALOG +
      RECFM(F B) BLKSIZE(4029) LRECL(79) +
      UNIT(SYSDA) DATASET(DSQEDIT)
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC CONTROL SUBTASK PROTECT
    ISPEXEC SELECT PGM(DSQQMFE) NEWAPPL(DSQE) PARM(S=&DB2ID) PASSLIB
    FREE FILE(ADMGGMAP)
    FREE FILE(DSQPRINT)
    FREE FILE(DSQDEBUG)
    FREE FILE(DSQPNLE)
    FREE FILE(DSQSPILL)
    FREE FILE(SYSEXEC)
    FREE FILE(DSQEDIT)
    DELETE DSQEDIT
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    ALTLIB DEACTIVATE APPLICATION(EXEC)
./ ADD NAME=QMFCHRT  0107-92192-92241-1558-00029-00088-00006-KETCSC
PROC 1 DB2ID
    CONTROL NOMSG NOLIST NOFLUSH END(ENDO)
/*                                                            */
/*   QMF AND GDDM LIBRARIES FOR CHARTS                        */
/*                                                            */
    ALLOC FILE(ADMCFORM) DA('&DB2ID..DSQCHART') SHR REUSE
    ALLOC FILE(DSQUCFRM) DA('&SYSUID..DSQUCFRM') SHR REUSE
    IF (&LASTCC NE 0) THEN +
      ALLOC FILE(DSQUCFRM) NEW CATALOG +
        RECFM(F) BLKSIZE(400) LRECL(400) +
        UNIT(SYSDA) DATASET('&SYSUID..DSQUCFRM') +
        SPACE(2 5) DIR(25) TRACKS
    ALLOC FILE(ADMCDATA) DA('&SYSUID..ADMCDATA') SHR REUSE
    IF (&LASTCC NE 0) THEN +
      ALLOC FILE(ADMCDATA) NEW CATALOG +
        UNIT(SYSDA) DATASET('&SYSUID..ADMCDATA') +
        SPACE(2 5) DIR(25) TRACKS
    ALLOC FILE(ADMGDF) DA('&SYSUID..ADMGDF') SHR REUSE
    IF (&LASTCC NE 0) THEN +
      ALLOC FILE(ADMGDF) NEW CATALOG +
        UNIT(SYSDA) DATASET('&SYSUID..ADGMGDF') +
        SPACE(2 5) DIR(25) TRACKS
    ALLOC FILE(ADMSYMBL) DATASET('SYS1.GDDMSYM') SHR REUSE
    %QMF &DB2ID
    FREE FILE(ADMCFORM)
    FREE FILE(DSQUCFRM)
    FREE FILE(ADMCDATA)
    FREE FILE(ADMGDF)
    FREE FILE(ADMSYMBL)
./ ADD NAME=QMFPRT   0100-92337-92337-1654-00037-00037-00000-KETCSC
PROC 0
/*                                                                 */
/* LIB: XXXXXXXX.XXX(QMFPRT)                                       */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST FREES THE QMF REPORT DD AND ALLOCATES IT        */
/*      WITH A DEST PARAMETER.                                     */
/*                                                                 */
BEGIN: +
    CONTROL NOMSG NOLIST NOFLUSH END(ENDO)
/*  CONTROL MSG LIST CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ATTN GOTO QMFCAN
 /******************************************************
 /*           DATASETS USED BY QMF                     *
 /******************************************************
    ISPEXEC VGET(SYSX DEST) PROFILE
    ISPEXEC DISPLAY PANEL(QMFPRT)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN EXIT CODE(4)
ALCQMF: +
    SET &DD = DSQPRINT
    FREE FILE(&DD)
    ALLOC FILE(&DD) SYSOUT(&SYSX) +
      RECFM(F B A) LRECL(133) BLKSIZE(3990) +
      DEST(&DEST)
    SET &MYCC = &LASTCC
    IF (&MYCC ^= 0) THEN GOTO QMFERR
QMFXIT: +
    ATTN OFF
    EXIT CODE(0)
QMFCAN: +
    WRITE ATTENTION KEY PRESSED, EXECUTION TERMINATED
    ATTN OFF
    EXIT CODE(0)
QMFERR: +
    WRITE FILE(&DD) ALLOCATION ERROR, RC=&MYCC
    EXIT CODE(&MYCC)
./ ADD NAME=QMFXX    0100-93055-93055-1412-00004-00004-00000-DMV0016
PROC 1 DB2ID
    CONTROL NOMSG NOLIST NOFLUSH END(ENDO)
/*  CONTROL LIST MSG CONLIST SYMLIST
    EX 'XDBS.TSOISPF.CLIST(QMF)' '&DB2ID'
./ ADD NAME=SERCHALC 0120-92113-93194-0849-00080-00032-00080-MANN
/*********************** REXX ****************************************/
/*THIS EXEC SEARCHS YOUR TSO ALLOCATIONS TO FIND WHAT DATA SET THE   */
/*REQUESTED MEMBER IS IN.                                            */
/*********************************************************************/
/* TRACE ?R */

SAY 'ENTER MEMBER NAME TO BE SEARCHED:'
PULL MEMNAME
IF MEMNAME = ' ' THEN
  DO
     SAY 'MEMBER NAME NOT SPECIFIED'
     EXIT
  END
SAY 'ENTER ''DDNAME'' TO SEARCH OR HIT ENTER FOR ALL'
PULL DD
IF DD = ' ' THEN
  DO
     DD = 'ALL'
  END

X = OUTTRAP('LINE.')
'LISTALC STATUS'
CNT = 0
DO I = 2 TO LINE.0 BY 1
   IF SUBSTR(LINE.I,1,2) ^= '  ' THEN
      DO
         DATASET = STRIP(LINE.I)
      END
   IF SUBSTR(LINE.I,1,11) = '           ' THEN
      DO
         CNT = CNT + 1
         LEVEL.CNT = DDNAME ×× DATASET
      END
   ELSE IF SUBSTR(LINE.I,1,2) = '  ' THEN
           DO
              CNT = CNT + 1
              DDNAME = SUBSTR(LINE.I,3,8)
              LEVEL.CNT = DDNAME ×× DATASET
           END
END
DDFLG = 'N'
MEMFLG = 'N'
IF DD = 'ALL' THEN
   DO J = 1 TO CNT BY 1
      DDFLG = 'Y'
      DS = STRIP(SUBSTR(LEVEL.J,9,44))
      DSNAME = '''' ×× DS ×× '(' ×× MEMNAME ×× ')' ×× ''''
      Y = SYSDSN(DSNAME)
      IF Y = 'OK' THEN
         DO
            SAY MEMNAME 'FOUND IN' SUBSTR(LEVEL.J,1,8) DS
            MEMFLG = 'Y'
         END
      ELSE NOP
   END
ELSE
   DO J = 1 TO CNT BY 1
      IF DD = STRIP(SUBSTR(LEVEL.J,1,8)) THEN
         DO
            DDFLG = 'Y'
            DS = STRIP(SUBSTR(LEVEL.J,9,44))
            DSNAME = '''' ×× DS ×× '(' ×× MEMNAME ×× ')' ×× ''''
            Y=SYSDSN(DSNAME)
            IF Y = 'OK' THEN
               DO
                  SAY MEMNAME 'FOUND IN' DS
                  MEMFLG = 'Y'
               END
            ELSE NOP
         END
      ELSE NOP
   END
IF MEMFLG = 'N' THEN
   DO
      SAY 'MEMBER' MEMNAME 'NOT FOUND IN YOUR TSO ALLOCATIONS'
   END
IF DDFLG = 'N' THEN
   DO
      SAY 'DDNAME' DD 'NOT FOUND IN YOUR TSO ALLOCATIONS'
   END
./ ADD NAME=SETDB2OP 0100-94032-94032-0831-00011-00011-00000-KETCSC
PROC 1 SSID
 /*                                                                  */
 /* LIB: CLIST(SETDB2OP)                                             */
 /* GDE: DB2 GROUP                                                   */
 /* DOC: THIS CLIST SETS DSNEOV01.                                   */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
    ISPEXEC CONTROL ERRORS RETURN
    SET &DSNEOV01 = &SSID
    ISPEXEC VPUT (DSNEOV01) PROFILE
    EXIT CODE(0)
./ ADD NAME=SETPROOP 0100-94031-94031-1657-00012-00012-00000-KETCSC
PROC 1 SSID
 /*                                                                  */
 /* LIB: CLIST(SETPROOP)                                             */
 /* GDE: DB2 GROUP                                                   */
 /* DOC: THIS CLIST SETS THE PROEDIT DEFAULT SUBSYSTEM ID.           */
 /*                                                                  */
    CONTROL END(ENDO) NOFLUSH MAIN NOMSG ASIS NOLIST
/*  CONTROL LIST MSG CONLIST SYMLIST END(ENDO)
    ISPEXEC CONTROL ERRORS RETURN
    SET &SSN = &SSID
    ISPEXEC VPUT (SSN) PROFILE
    EXIT CODE(0)
./ ADD NAME=SK       0103-93083-93139-1238-00314-00285-00000-KETCSC
PROC 1 DATASET
/*********************************************************************/
/*                                                                   */
/* LIB: CLIST(SK)                                                    */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM.                      */
/* DOC: THIS CLIST INVOKES SCRIPT IN TSO MODE.                       */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG MAIN END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST MSG
    GETSYSID
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC LIBDEF ISPLLIB DATASET +
      ID('DCF.R32.DCFLOAD')
    ISPEXEC VGET (OPTS SCRPRNT)
    IF (&NRSTR(&OPTS) = ) THEN +
      SET &OPTS = &STR(SYSVAR(X NO H YES T CENTER) QUIET INDEX)
    IF (&NRSTR(&SCRPRNT) = ) THEN +
      SET &SCRPRNT = &STR(1403W6)
RESETIT: +
    SET &OPTA = Y
    SET &OPTB = Y
    SET &OPTC = N
    SET &OPTD = N
MYLOOP: +
    ISPEXEC DISPLAY PANEL(SK)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        EXIT CODE(0)
      ENDO
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DATASETL = &LENGTH(&DATASET)
        SET &DATASETL = &DATASETL - 1
        SET &DATASETE = &SUBSTR(2:&DATASETL,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    SET &DSNL = 1
    SET &DSNR = &LENGTH(&DATASETE)
    SET &RIGHTP = &SUBSTR(&DSNR:&DSNR,&DATASETE)
    IF &RIGHTP = ) THEN +
      DO
        SET &MEML = &DSNR
        SET &LEFTP = N
        DO WHILE &LEFTP ^= (
          SET &MEML = &MEML - 1
          SET &LEFTP = &SUBSTR(&MEML:&MEML,&DATASETE)
        ENDO
        SET &MEML = &MEML + 1
        SET &MEMR = &DSNR - 1
        SET &DSNR = &MEML - 2
        SET &MEM = &SUBSTR(&MEML:&MEMR,&DATASETE )
      ENDO
    IF (&OPTA = Y) THEN GOTO EDITIT
    IF (&OPTB = Y) THEN GOTO SCRPIT
    IF (&OPTC = Y) THEN GOTO BRWSIT
    IF (&OPTD = Y) THEN GOTO PRNTIT
    SET &ZERRHM = &STR(*)
    SET &ZERRALRM = &STR(YES)
    SET &ZERRSM = &STR(CHOOSE AT LEAST ONE)
    SET &ZERRLM = &STR(COME ON, PICK AN OPTION WITH A Y)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)
    GOTO RESETIT
/*                                                                 */
MOREOPT: +
    IF (&OPTA = Y) THEN GOTO EDITIT
    IF (&OPTB = Y) THEN GOTO SCRPIT
    IF (&OPTC = Y) THEN GOTO BRWSIT
    IF (&OPTD = Y) THEN GOTO PRNTIT
    GOTO RESETIT
/*                                                                 */
EDITIT: +
    SET &MAC = &STR()
    SET &OK = &SYSDSN(&DATASET)
    IF (&STR(&OK) = &STR(MEMBER NOT FOUND)) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(YOU CAN USE GMLNEW)
        SET &ZERRLM = &STR(GMLNEW WILL GIVE YOU A BASIC GML TAGGED)
        SET &ZERRLM = &STR(&ZERRLM DOCUMENT FOR STARTERS)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        SET &MAC = &STR(MACRO(GMLHELP) )
      ENDO
    ELSE +
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&DATASET &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ISPEXEC EDIT DATASET(&DATASET) &MAC
    SET &OPTA = N
    GOTO MOREOPT
/*                                                                 */
SCRPIT: +
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    SET &OK = &SYSDSN(&DATASET)
    IF (&STR(&OK) = &STR(MEMBER NOT FOUND)) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(YOU BLEW IT)
        SET &ZERRLM = &STR(TRY SAVING THE MEMBER THIS TIME)
        SET &ZERRLM = &STR(&ZERRLM &DSN IS &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ELSE +
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&DATASET &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    SET &OK = &SYSDSN(SKRIPT)
    IF (&STR(&OK) NE OK) THEN +
      DO
        ALLOC FILE(MANUAL) DATASET(SKRIPT) +
          SPACE(25 5) TRACKS +
          RECFM(V B M) LRECL(8202) BLKSIZE(8206) +
          DSORG(PS) +
          NEW CATALOG UNIT(SYSDA)
        FREE FILE(MANUAL)
      ENDO
/*  CLEAR
    CONTROL LIST MSG
    SET &MAXCC = 0
    IF (&STR(&SYSID) EQ MVSW) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('CSC.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ MVSP) THEN +
      DO
      WRITE &STR(******************************************************)
      WRITE &STR(*                                                    *)
      WRITE &STR(*       ***** W A R N I N G *****                    *)
      WRITE &STR(*                                                    *)
      WRITE &STR(* DOCUMENT COMPOSITION FACILITY (DCF) ALIAS SCRIPT   *)
      WRITE &STR(* IS NOT LICENSED FOR USE ON THE 3090 AND SHOULD NOT *)
      WRITE &STR(* BE USED. YOU ARE VIOLATING A CITY CONTRACT IF MVSP *)
      WRITE &STR(* IS RUNNING ON THE 3090.                            *)
      WRITE &STR(*                                                    *)
      WRITE &STR(*       ***** W A R N I N G *****                    *)
      WRITE &STR(*                                                    *)
      WRITE &STR(*                                  KENNETH TOMIAK    *)
      WRITE &STR(******************************************************)
      WRITE
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('CSC.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
      ENDO
    ELSE +
    IF (&STR(&SYSID) EQ MVSX) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('SYS1.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ DOFD) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('PPFA.USER.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ DOFP) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('PPFA.USER.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    SCRIPT &DATASET +
      TWOPASS DEVICE(&SCRPRNT)   +
      PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
      LIB('DCF.R32.DCFGML3')  +
      FONTLIB('SYS1.FONTLIBB') +
      SEGLIB('SYS1.PSEGLIB') +
      FILE('&SYSUID..SKRIPT') +
      SEARCH('&DSN') +
      &OPTS
    SET &MYCC = &MAXCC
    CONTROL NOLIST NOMSG
    IF (&MYCC > 4) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&MYCC GT 0)
        SET &ZERRLM = &STR(&MAYBE IT IS NOT READY TO PRINT)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        SET &OPTA = Y
        SET &OPTD = N
        WRITE TRY AGAIN
        GOTO MYLOOP
      ENDO
    SET &OPTB = N
    GOTO MOREOPT
/*                                                                 */
BRWSIT: +
    SET &OPTC = N
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    SET &OK = &SYSDSN(SKRIPT)
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&SYSUID..SKRIPT &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ISPEXEC BROWSE DATASET(SKRIPT)
    GOTO MOREOPT
/*                                                                 */
PRNTIT: +
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    ISPEXEC VGET (SYSOUT, PAGE, FORM, DEST, CPY, JA, JB, JC, JD)
    SET &OUTDEF = &STR()
    SET &PAGEDEF = &STR()
    SET &FONTSTR = &STR()
    SET &FORMDEF = &STR()
    SET &PDEF = &PAGE
    SET &FDEF = &FORM
    LISTDSI SKRIPT
    SET &RECFM = &SYSRECFM
    IF (&DEST = ) THEN SET &DEST = LOCAL
    SET &COMMA = &STR()
    IF (&NRSTR(&PDEF) EQ &STR(?)) THEN +
      DO
        %PRTPAGE
        ISPEXEC VGET (PDEF)
        SET &PAGE = &PDEF
        ISPEXEC VPUT (PAGE) PROFILE
      ENDO
    IF (&NRSTR(&PDEF) NE ) THEN +
      DO
        SET &PAGESTR = &STR(PAGEDEF=&PDEF)
        SET &COMMA = &STR(,)
        SET &OUTDEF = &STR(&OUTDEF.Y)
        ISPEXEC VPUT (PDEF) PROFILE
      ENDO
    IF (&NRSTR(&FDEF) EQ &STR(?)) THEN +
      DO
        %PRTFORM
        ISPEXEC VGET (FDEF) PROFILE
        SET &FORM = &FDEF
        ISPEXEC VPUT (FORM) PROFILE
      ENDO
    IF (&NRSTR(&FDEF) NE ) THEN +
      DO
        SET &FORMSTR = &STR(&COMMA.FORMDEF=&FDEF)
        SET &OUTDEF = &STR(&OUTDEF.Y)
        ISPEXEC VPUT (FDEF) PROFILE
      ENDO
    ISPEXEC VPUT (PAGESTR FORMSTR FONTSTR)
    SET &DATASETG = &SYSUID..SKRIPT
    ISPEXEC VPUT (DATASETG) SHARED
    SET &BLKSIZE = &SYSBLKSIZE
    SET &LRECL =  &SYSLRECL
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PRTGENER
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    SET &OPTD = N
    GOTO MYLOOP
./ ADD NAME=SKK      0100-93320-93320-1700-00314-00314-00000-KETCSC
PROC 1 DATASET
/*********************************************************************/
/*                                                                   */
/* LIB: CLIST(SK)                                                    */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM.                      */
/* DOC: THIS CLIST INVOKES SCRIPT IN TSO MODE.                       */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG MAIN END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST MSG
    GETSYSID
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC LIBDEF ISPLLIB DATASET +
      ID('DCF.R32.DCFLOAD')
    ISPEXEC VGET (OPTS SCRPRNT)
    IF (&NRSTR(&OPTS) = ) THEN +
      SET &OPTS = &STR(SYSVAR(X NO H YES T CENTER) QUIET INDEX)
    IF (&NRSTR(&SCRPRNT) = ) THEN +
      SET &SCRPRNT = &STR(1403W6)
RESETIT: +
    SET &OPTA = Y
    SET &OPTB = Y
    SET &OPTC = N
    SET &OPTD = N
MYLOOP: +
    ISPEXEC DISPLAY PANEL(SKK)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        EXIT CODE(0)
      ENDO
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DATASETL = &LENGTH(&DATASET)
        SET &DATASETL = &DATASETL - 1
        SET &DATASETE = &SUBSTR(2:&DATASETL,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    SET &DSNL = 1
    SET &DSNR = &LENGTH(&DATASETE)
    SET &RIGHTP = &SUBSTR(&DSNR:&DSNR,&DATASETE)
    IF &RIGHTP = ) THEN +
      DO
        SET &MEML = &DSNR
        SET &LEFTP = N
        DO WHILE &LEFTP ^= (
          SET &MEML = &MEML - 1
          SET &LEFTP = &SUBSTR(&MEML:&MEML,&DATASETE)
        ENDO
        SET &MEML = &MEML + 1
        SET &MEMR = &DSNR - 1
        SET &DSNR = &MEML - 2
        SET &MEM = &SUBSTR(&MEML:&MEMR,&DATASETE )
      ENDO
    IF (&OPTA = Y) THEN GOTO EDITIT
    IF (&OPTB = Y) THEN GOTO SCRPIT
    IF (&OPTC = Y) THEN GOTO BRWSIT
    IF (&OPTD = Y) THEN GOTO PRNTIT
    SET &ZERRHM = &STR(*)
    SET &ZERRALRM = &STR(YES)
    SET &ZERRSM = &STR(CHOOSE AT LEAST ONE)
    SET &ZERRLM = &STR(COME ON, PICK AN OPTION WITH A Y)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)
    GOTO RESETIT
/*                                                                 */
MOREOPT: +
    IF (&OPTA = Y) THEN GOTO EDITIT
    IF (&OPTB = Y) THEN GOTO SCRPIT
    IF (&OPTC = Y) THEN GOTO BRWSIT
    IF (&OPTD = Y) THEN GOTO PRNTIT
    GOTO RESETIT
/*                                                                 */
EDITIT: +
    SET &MAC = &STR()
    SET &OK = &SYSDSN(&DATASET)
    IF (&STR(&OK) = &STR(MEMBER NOT FOUND)) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(YOU CAN USE GMLNEW)
        SET &ZERRLM = &STR(GMLNEW WILL GIVE YOU A BASIC GML TAGGED)
        SET &ZERRLM = &STR(&ZERRLM DOCUMENT FOR STARTERS)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        SET &MAC = &STR(MACRO(GMLHELP) )
      ENDO
    ELSE +
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&DATASET &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ISPEXEC EDIT DATASET(&DATASET) &MAC
    SET &OPTA = N
    GOTO MOREOPT
/*                                                                 */
SCRPIT: +
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    SET &OK = &SYSDSN(&DATASET)
    IF (&STR(&OK) = &STR(MEMBER NOT FOUND)) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(YOU BLEW IT)
        SET &ZERRLM = &STR(TRY SAVING THE MEMBER THIS TIME)
        SET &ZERRLM = &STR(&ZERRLM &DSN IS &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ELSE +
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&DATASET &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    SET &OK = &SYSDSN(SKRIPT)
    IF (&STR(&OK) NE OK) THEN +
      DO
        ALLOC FILE(MANUAL) DATASET(SKRIPT) +
          SPACE(25 5) TRACKS +
          RECFM(V B M) LRECL(8202) BLKSIZE(8206) +
          DSORG(PS) +
          NEW CATALOG UNIT(SYSDA)
        FREE FILE(MANUAL)
      ENDO
/*  CLEAR
    CONTROL LIST MSG
    SET &MAXCC = 0
    IF (&STR(&SYSID) EQ MVSW) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('CSC.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ MVSP) THEN +
      DO
      WRITE &STR(******************************************************)
      WRITE &STR(*                                                    *)
      WRITE &STR(*       ***** W A R N I N G *****                    *)
      WRITE &STR(*                                                    *)
      WRITE &STR(* DOCUMENT COMPOSITION FACILITY (DCF) ALIAS SCRIPT   *)
      WRITE &STR(* IS NOT LICENSED FOR USE ON THE 3090 AND SHOULD NOT *)
      WRITE &STR(* BE USED. YOU ARE VIOLATING A CITY CONTRACT IF MVSP *)
      WRITE &STR(* IS RUNNING ON THE 3090.                            *)
      WRITE &STR(*                                                    *)
      WRITE &STR(*       ***** W A R N I N G *****                    *)
      WRITE &STR(*                                                    *)
      WRITE &STR(*                                  KENNETH TOMIAK    *)
      WRITE &STR(******************************************************)
      WRITE
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('CSC.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
      ENDO
    ELSE +
    IF (&STR(&SYSID) EQ MVSX) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('SYS1.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ DOFD) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('PPFA.USER.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ DOFP) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
        LIB('DCF.R32.DCFGML3')  +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('PPFA.USER.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    SCRIPT &DATASET +
      TWOPASS DEVICE(&SCRPRNT)   +
      PROFILE('DCF.R32.DCFGML3(DSMPROF3)') +
      LIB('DCF.R32.DCFGML3')  +
      FONTLIB('SYS1.FONTLIBB') +
      SEGLIB('SYS1.PSEGLIB') +
      FILE('&SYSUID..SKRIPT') +
      SEARCH('&DSN') +
      &OPTS
    SET &MYCC = &MAXCC
    CONTROL NOLIST NOMSG
    IF (&MYCC > 4) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&MYCC GT 0)
        SET &ZERRLM = &STR(&MAYBE IT IS NOT READY TO PRINT)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        SET &OPTA = Y
        SET &OPTD = N
        WRITE TRY AGAIN
        GOTO MYLOOP
      ENDO
    SET &OPTB = N
    GOTO MOREOPT
/*                                                                 */
BRWSIT: +
    SET &OPTC = N
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    SET &OK = &SYSDSN(SKRIPT)
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&SYSUID..SKRIPT &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ISPEXEC BROWSE DATASET(SKRIPT)
    GOTO MOREOPT
/*                                                                 */
PRNTIT: +
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    ISPEXEC VGET (SYSOUT, PAGE, FORM, DEST, CPY, JA, JB, JC, JD)
    SET &OUTDEF = &STR()
    SET &PAGEDEF = &STR()
    SET &FONTSTR = &STR()
    SET &FORMDEF = &STR()
    SET &PDEF = &PAGE
    SET &FDEF = &FORM
    LISTDSI SKRIPT
    SET &RECFM = &SYSRECFM
    IF (&DEST = ) THEN SET &DEST = LOCAL
    SET &COMMA = &STR()
    IF (&NRSTR(&PDEF) EQ &STR(?)) THEN +
      DO
        %PRTPAGE
        ISPEXEC VGET (PDEF)
        SET &PAGE = &PDEF
        ISPEXEC VPUT (PAGE) PROFILE
      ENDO
    IF (&NRSTR(&PDEF) NE ) THEN +
      DO
        SET &PAGESTR = &STR(PAGEDEF=&PDEF)
        SET &COMMA = &STR(,)
        SET &OUTDEF = &STR(&OUTDEF.Y)
        ISPEXEC VPUT (PDEF) PROFILE
      ENDO
    IF (&NRSTR(&FDEF) EQ &STR(?)) THEN +
      DO
        %PRTFORM
        ISPEXEC VGET (FDEF) PROFILE
        SET &FORM = &FDEF
        ISPEXEC VPUT (FORM) PROFILE
      ENDO
    IF (&NRSTR(&FDEF) NE ) THEN +
      DO
        SET &FORMSTR = &STR(&COMMA.FORMDEF=&FDEF)
        SET &OUTDEF = &STR(&OUTDEF.Y)
        ISPEXEC VPUT (FDEF) PROFILE
      ENDO
    ISPEXEC VPUT (PAGESTR FORMSTR FONTSTR)
    SET &DATASETG = &SYSUID..SKRIPT
    ISPEXEC VPUT (DATASETG) SHARED
    SET &BLKSIZE = &SYSBLKSIZE
    SET &LRECL =  &SYSLRECL
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PRTGENER
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    SET &OPTD = N
    GOTO MYLOOP
./ ADD NAME=SK4      0100-93320-93320-1638-00314-00314-00000-KETCSC
PROC 1 DATASET
/*********************************************************************/
/*                                                                   */
/* LIB: CLIST(SK)                                                    */
/* GDE: INSTALLATION/MIGRATION/CONVERSION TEAM.                      */
/* DOC: THIS CLIST INVOKES SCRIPT IN TSO MODE.                       */
/*                                                                   */
/*********************************************************************/
    CONTROL NOFLUSH NOMSG MAIN END(ENDO) NOLIST
/*  CONTROL LIST CONLIST SYMLIST MSG
    GETSYSID
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC LIBDEF ISPLLIB DATASET +
      ID('SCRIPT.R40.DCFLOAD')
    ISPEXEC VGET (OPTS SCRPRNT)
    IF (&NRSTR(&OPTS) = ) THEN +
      SET &OPTS = &STR(SYSVAR(X NO H YES T CENTER) QUIET INDEX)
    IF (&NRSTR(&SCRPRNT) = ) THEN +
      SET &SCRPRNT = &STR(1403W6)
RESETIT: +
    SET &OPTA = Y
    SET &OPTB = Y
    SET &OPTC = N
    SET &OPTD = N
MYLOOP: +
    ISPEXEC DISPLAY PANEL(SK)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        EXIT CODE(0)
      ENDO
    SET &APOST = &SUBSTR(1:1,&DATASET)
    IF (&APOST = &STR(')) THEN +
      DO
        SET &DATASETL = &LENGTH(&DATASET)
        SET &DATASETL = &DATASETL - 1
        SET &DATASETE = &SUBSTR(2:&DATASETL,&DATASET)
      ENDO
    ELSE +
      DO
        SET &DATASETE = &DATASET
      ENDO
    SET &DSNL = 1
    SET &DSNR = &LENGTH(&DATASETE)
    SET &RIGHTP = &SUBSTR(&DSNR:&DSNR,&DATASETE)
    IF &RIGHTP = ) THEN +
      DO
        SET &MEML = &DSNR
        SET &LEFTP = N
        DO WHILE &LEFTP ^= (
          SET &MEML = &MEML - 1
          SET &LEFTP = &SUBSTR(&MEML:&MEML,&DATASETE)
        ENDO
        SET &MEML = &MEML + 1
        SET &MEMR = &DSNR - 1
        SET &DSNR = &MEML - 2
        SET &MEM = &SUBSTR(&MEML:&MEMR,&DATASETE )
      ENDO
    IF (&OPTA = Y) THEN GOTO EDITIT
    IF (&OPTB = Y) THEN GOTO SCRPIT
    IF (&OPTC = Y) THEN GOTO BRWSIT
    IF (&OPTD = Y) THEN GOTO PRNTIT
    SET &ZERRHM = &STR(*)
    SET &ZERRALRM = &STR(YES)
    SET &ZERRSM = &STR(CHOOSE AT LEAST ONE)
    SET &ZERRLM = &STR(COME ON, PICK AN OPTION WITH A Y)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)
    GOTO RESETIT
/*                                                                 */
MOREOPT: +
    IF (&OPTA = Y) THEN GOTO EDITIT
    IF (&OPTB = Y) THEN GOTO SCRPIT
    IF (&OPTC = Y) THEN GOTO BRWSIT
    IF (&OPTD = Y) THEN GOTO PRNTIT
    GOTO RESETIT
/*                                                                 */
EDITIT: +
    SET &MAC = &STR()
    SET &OK = &SYSDSN(&DATASET)
    IF (&STR(&OK) = &STR(MEMBER NOT FOUND)) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(YOU CAN USE GMLNEW)
        SET &ZERRLM = &STR(GMLNEW WILL GIVE YOU A BASIC GML TAGGED)
        SET &ZERRLM = &STR(&ZERRLM DOCUMENT FOR STARTERS)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        SET &MAC = &STR(MACRO(GMLHELP) )
      ENDO
    ELSE +
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&DATASET &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ISPEXEC EDIT DATASET(&DATASET) &MAC
    SET &OPTA = N
    GOTO MOREOPT
/*                                                                 */
SCRPIT: +
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    SET &OK = &SYSDSN(&DATASET)
    IF (&STR(&OK) = &STR(MEMBER NOT FOUND)) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        SET &ZERRSM = &STR(YOU BLEW IT)
        SET &ZERRLM = &STR(TRY SAVING THE MEMBER THIS TIME)
        SET &ZERRLM = &STR(&ZERRLM &DSN IS &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ELSE +
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&DATASET &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    SET &OK = &SYSDSN(SKRIPT)
    IF (&STR(&OK) NE OK) THEN +
      DO
        ALLOC FILE(MANUAL) DATASET(SKRIPT) +
          SPACE(25 5) TRACKS +
          RECFM(V B M) LRECL(8202) BLKSIZE(8206) +
          DSORG(PS) +
          NEW CATALOG UNIT(SYSDA)
        FREE FILE(MANUAL)
      ENDO
/*  CLEAR
    CONTROL LIST MSG
    SET &MAXCC = 0
    IF (&STR(&SYSID) EQ MVSW) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('SCRIPT.R40.MACLIB(DSMPROF4)') +
        LIB('SCRIPT.R40.MACLIB') +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('CSC.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ MVSP) THEN +
      DO
      WRITE &STR(******************************************************)
      WRITE &STR(*                                                    *)
      WRITE &STR(*       ***** W A R N I N G *****                    *)
      WRITE &STR(*                                                    *)
      WRITE &STR(* DOCUMENT COMPOSITION FACILITY (DCF) ALIAS SCRIPT   *)
      WRITE &STR(* IS NOT LICENSED FOR USE ON THE 3090 AND SHOULD NOT *)
      WRITE &STR(* BE USED. YOU ARE VIOLATING A CITY CONTRACT IF MVSP *)
      WRITE &STR(* IS RUNNING ON THE 3090.                            *)
      WRITE &STR(*                                                    *)
      WRITE &STR(*       ***** W A R N I N G *****                    *)
      WRITE &STR(*                                                    *)
      WRITE &STR(*                                  KENNETH TOMIAK    *)
      WRITE &STR(******************************************************)
      WRITE
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('SCRIPT.R40.MACLIB(DSMPROF4)') +
        LIB('SCRIPT.R40.MACLIB') +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('CSC.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
      ENDO
    ELSE +
    IF (&STR(&SYSID) EQ MVSX) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('SCRIPT.R40.MACLIB(DSMPROF4)') +
        LIB('SCRIPT.R40.MACLIB') +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('SYS1.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ DOFD) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('SCRIPT.R40.MACLIB(DSMPROF4)') +
        LIB('SCRIPT.R40.MACLIB') +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('PPFA.USER.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    IF (&STR(&SYSID) EQ DOFP) THEN +
      SCRIPT &DATASET +
        TWOPASS DEVICE(&SCRPRNT)   +
        PROFILE('SCRIPT.R40.MACLIB(DSMPROF4)') +
        LIB('SCRIPT.R40.MACLIB') +
        FONTLIB('SYS1.FONTLIBB') +
        SEGLIB('PPFA.USER.PSEGLIB') +
        FILE('&SYSUID..SKRIPT') +
        SEARCH('&DSN') +
        &OPTS
    ELSE +
    SCRIPT &DATASET +
      TWOPASS DEVICE(&SCRPRNT)   +
      PROFILE('SCRIPT.R40.MACLIB(DSMPROF4)') +
      LIB('SCRIPT.R40.MACLIB') +
      FONTLIB('SYS1.FONTLIBB') +
      SEGLIB('SYS1.PSEGLIB') +
      FILE('&SYSUID..SKRIPT') +
      SEARCH('&DSN') +
      &OPTS
    SET &MYCC = &MAXCC
    CONTROL NOLIST NOMSG
    IF (&MYCC > 4) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&MYCC GT 0)
        SET &ZERRLM = &STR(&MAYBE IT IS NOT READY TO PRINT)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        SET &OPTA = Y
        SET &OPTD = N
        WRITE TRY AGAIN
        GOTO MYLOOP
      ENDO
    SET &OPTB = N
    GOTO MOREOPT
/*                                                                 */
BRWSIT: +
    SET &OPTC = N
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    SET &OK = &SYSDSN(SKRIPT)
    IF (&STR(&OK) NE OK) THEN +
      DO
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        SET &ZERRSM = &STR(&OK)
        SET &ZERRLM = &STR(&SYSUID..SKRIPT &OK)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO MYLOOP
      ENDO
    ISPEXEC BROWSE DATASET(SKRIPT)
    GOTO MOREOPT
/*                                                                 */
PRNTIT: +
    SET &DSN = &SUBSTR(&DSNL:&DSNR,&DATASETE)
    ISPEXEC VGET (SYSOUT, PAGE, FORM, DEST, CPY, JA, JB, JC, JD)
    SET &OUTDEF = &STR()
    SET &PAGEDEF = &STR()
    SET &FONTSTR = &STR()
    SET &FORMDEF = &STR()
    SET &PDEF = &PAGE
    SET &FDEF = &FORM
    LISTDSI SKRIPT
    SET &RECFM = &SYSRECFM
    IF (&DEST = ) THEN SET &DEST = LOCAL
    SET &COMMA = &STR()
    IF (&NRSTR(&PDEF) EQ &STR(?)) THEN +
      DO
        %PRTPAGE
        ISPEXEC VGET (PDEF)
        SET &PAGE = &PDEF
        ISPEXEC VPUT (PAGE) PROFILE
      ENDO
    IF (&NRSTR(&PDEF) NE ) THEN +
      DO
        SET &PAGESTR = &STR(PAGEDEF=&PDEF)
        SET &COMMA = &STR(,)
        SET &OUTDEF = &STR(&OUTDEF.Y)
        ISPEXEC VPUT (PDEF) PROFILE
      ENDO
    IF (&NRSTR(&FDEF) EQ &STR(?)) THEN +
      DO
        %PRTFORM
        ISPEXEC VGET (FDEF) PROFILE
        SET &FORM = &FDEF
        ISPEXEC VPUT (FORM) PROFILE
      ENDO
    IF (&NRSTR(&FDEF) NE ) THEN +
      DO
        SET &FORMSTR = &STR(&COMMA.FORMDEF=&FDEF)
        SET &OUTDEF = &STR(&OUTDEF.Y)
        ISPEXEC VPUT (FDEF) PROFILE
      ENDO
    ISPEXEC VPUT (PAGESTR FORMSTR FONTSTR)
    SET &DATASETG = &SYSUID..SKRIPT
    ISPEXEC VPUT (DATASETG) SHARED
    SET &BLKSIZE = &SYSBLKSIZE
    SET &LRECL =  &SYSLRECL
    ISPEXEC FTOPEN TEMP
    ISPEXEC FTINCL PRTGENER
    ISPEXEC FTCLOSE
    ISPEXEC VGET (ZTEMPF)
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
    SET &OPTD = N
    GOTO MYLOOP
./ ADD NAME=SLEHDR   0101-93139-93139-1101-00755-00758-00000-KETCSC
WRITE /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
WRITE /*                                                           */
WRITE /*                ServiceLink Enhancements                   */
WRITE /*                   Version 2.02                            */
WRITE /*            (c) Copyright IBM Corporation 1987             */
WRITE /*               RETRIEVE file from IE mailbox               */
WRITE /*                                                           */
WRITE /*             MVS, VM or DPPX CORRECTIVE SERVICE            */
WRITE /*                                                           */
WRITE /*                                                           */
WRITE /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
/**********************************************************************/
/*   BECAUSE THIS IS COPYRIGHTED MATERIAL, I HAD TO LEAVE THIS OUT.   */
/**********************************************************************/
./ ADD NAME=STAMPIT  0101-92226-92226-2202-00004-00004-00000-DMV0016
ISREDIT MACRO
ISREDIT STATS ON
ISREDIT SAVE
ISREDIT END
./ ADD NAME=TEST     0101-92010-92010-0943-00022-00064-00010-DD20002
PROC 0                             /* SUBMIT SYSRES MIGRATION JOB  */
/*                                                                 */
/* LIB: CLIST(MIGDBSC1)                                            */
/* GDE: D. BORGES AND M. PRISCIANDARO                             */
/* DOC: THIS CLIST TAILORS THE JOB TO CLONE A DB2 OR CSP TARGET ZONE */
/*                                                                 */
/* SETUP ERROR HANDLING PROCESSING                                 */
/*                                                                 */
/*  CONTROL NOLIST NOFLUSH  MAIN CAPS
    CONTROL CONLIST LIST SYMLIST   MAIN CAPS
    ISPEXEC CONTROL ERRORS RETURN
/*                                                                 */
   SET &SKELSRC = 'CSP.XXX.YYY'
/*                                                                 */
   SET &LVLCNT = 0
   SET &J = &SYSINDEX(.,&SKELSRC)
   DO WHILE J NE 0
      SET &LVLCNT = &LVLCNT + 1
      SET &J = &SYSINDEX(.,&SKELSRC,&J+1)
   END
   WRITE LEVEL IS => &J
    EXIT CODE(0)
./ ADD NAME=TRCKA00  0105-92085-92087-1203-00273-00273-00008-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCKA00)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO UPDATE A TABLE    */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XAGENCY
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMAJ DESC) +
          REPLACE
        SET &CMD  = &STR()
        SET &CDMAJ = 1234
        SET &DESC = &STR(WHAT IS THE AGENCY)
        ISPEXEC TBADD &TBL
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &ORIGROW = &RUPDNAME
        IF (&RCURNAME = 0) THEN +
          DO
            SET &CMD  = &STR()
            SET &CDMAJ = 1234
            SET &DESC = &STR(WHAT IS THE AGENCY)
            ISPEXEC TBADD &TBL
          ENDO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A,DESC,C,A)
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &EXITCC = NO
    SET &TBLCHG = NO
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN GOTO PANLEXIT
    SET &EXITCC = NO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCKA00) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = CANCEL) THEN +
      DO
        ISPEXEC TBEND &TBL
        EXIT CODE(0)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SAVE) THEN +
      DO
        ISPEXEC TBSAVE &TBL
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        SET &SORTFLD = &NRSTR(&FIELDB)
        SET &SORTORD = A
        ISPEXEC TBSORT &TBL +
            FIELDS(&SORTFLD,C,&SORTORD)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCKA00 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    IF (&NRSTR(&PRICMD) = I) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &TBLCHG = YES
        SET &PRICMD = &STR()
        SET &CMD = &STR()
        SET &CDMAJ = 1234
        SET &DESC = &STR(WHAT IS THE AGENCY)
        ISPEXEC TBADD &TBL
      ENDO
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = I) × (&NRSTR(&CMD) = IN) THEN +
        GOTO LOOPIN
      IF (&NRSTR(&CMD) = D) × (&NRSTR(&CMD) = DE) THEN +
        GOTO LOOPDE
UPDATE: +
      IF (&STR(&CDMAJ) = ) THEN +
        DO
          SET &ZERRSM = &STR(MINOR CODE REQUIRED)
          SET &ZERRLM = &STR(YOU REALLY HAVE TO ENTER A MINOR CODE)
          SET &ZERRHM = &STR(*)
          SET &ZERRALRM = &STR(YES)
          ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
          ISPEXEC SETMSG MSG(ISRZ002)
          SET &ZTDSELS = 0
          SET &CURS = CDMAJ
          GOTO NEXTSEL
        ENDO
      SET &CMD  = &STR()
      ISPEXEC TBPUT &TBL
      SET &TBLCHG = YES
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
LOOPIN: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    SET &TBLCHG = YES
    SET &CMD = &STR()
    SET &CDMAJ = 1234
    SET &DESC = &STR(WHAT IS THE AGENCY)
    ISPEXEC TBADD &TBL
    GOTO NEXTSEL
LOOPDE: +
    ISPEXEC TBDELETE &TBL
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    SET &TBLCHG = YES
    IF (&RCURNAME = 0) THEN GOTO LOOPIN
    GOTO NEXTSEL
PANLEXIT: +
    ISPEXEC TBTOP &TBL
CLNUP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      GOTO EXITCODE
    IF (&NRSTR(&CDMAJ) = ) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&DESC) = &STR(WHAT IS THE AGENCY)) THEN +
       ISPEXEC TBDELETE &TBL
    GOTO CLNUP
EXITCODE: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    IF (&TBLCHG = YES) THEN +
      DO
        ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A,DESC,C,A)
        ISPEXEC TBCLOSE &TBL +
          LIBRARY(TIMETRK)
        SET &MYCC = &LASTCC
        IF (&MYCC NE 0) THEN +
          DO
            SET &ZERRSM = &STR(TABLE NOT SAVED)
            SET &ZERRLM = &STR(TABLE &TBL HAD ERRORS RC=&MYCC)
            ISPEXEC SETMSG MSG(ISRZ002)
          ENDO
      ENDO
    ELSE +
      DO
        ISPEXEC TBEND &TBL
        SET &MYCC = &LASTCC
      ENDO
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCKLDPW 0102-93165-93173-0844-00308-00295-00020-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCKLDPW)                                            */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO UPDATE A TABLE    */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XCDMAJ
    ISPEXEC TBEND &TBL
    ISPEXEC TBERASE &TBL LIBRARY(TIMETRK)
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMAJ DESC TGT RESP STAT) +
          REPLACE
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &ORIGROW = &RUPDNAME
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY ADDITIONS
/* **************************************************************
DISPLAY: +
    ALLOC FILE(PWDATA) DATASET('XDBS.PROJECT.WORKBNCH(ALLOFEM)') +
      SHR REUSE
    OPENFILE PWDATA INPUT
    SET &SAFETY = &STR(                                        )
    SET &SAFETY = &STR(&SAFETY                                        )
    SET &SAFETY = &STR(&SAFETY                                        )
    SET &SAFETY = &STR(&SAFETY                                        )
    SET &SAFETY = &STR(&SAFETY                                        )
    SET &SAFETY = &STR(&SAFETY                                        )
READIT: +
    ERROR +
      DO
        ERROR OFF
        GOTO CLOSIT
      ENDO
    GETFILE PWDATA
    ERROR OFF
    SET &DESC  = &SUBSTR(16:65,&NRSTR(&PWDATA.&SAFETY))
    SET &BYPS  = &SUBSTR(1:5,&NRSTR(&DESC     ))
    IF (&STR(&BYPS) = &STR(-----)) THEN +
      GOTO READIT
    IF (&STR(&BYPS) = &STR(     )) THEN +
      GOTO READIT
    IF (&STR(&DESC) = &STR(Problems)) THEN +
      GOTO READIT
    SET &USER = PW
    SET &CMD = &STR()
    SET &CDMAJ = &SUBSTR(3:8,&NRSTR(&PWDATA))
    SET &TGT  = &SUBSTR(75:82,&NRSTR(&PWDATA))
    SET &RESP  = &SUBSTR(90:105,&NRSTR(&PWDATA                    ))
    SET &STAT  = &SUBSTR(84:87,&NRSTR(&PWDATA                    ))
    ISPEXEC TBADD &TBL
    GOTO READIT
CLOSIT: +
    CLOSFILE PWDATA
    FREE FILE(PWDATA)
    ISPEXEC TBSAVE &TBL LIBRARY(TIMETRK)
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DSPLYTB: +
    ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A)
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &EXITCC = NO
    SET &TBLCHG = NO
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN GOTO PANLEXIT
    SET &EXITCC = NO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK800) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = CANCEL) THEN +
      DO
        ISPEXEC TBEND &TBL
        EXIT CODE(0)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SAVE) THEN +
      DO
        ISPEXEC TBSAVE &TBL
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        SET &SORTFLD = &NRSTR(&FIELDB)
        SET &SORTORD = A
        ISPEXEC TBSORT &TBL +
            FIELDS(&SORTFLD,C,&SORTORD)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCK800 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    IF (&NRSTR(&PRICMD) = I) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &TBLCHG = YES
        SET &PRICMD = &STR()
        SET &CMD = &STR()
        SET &CDMAJ = PROJID
        SET &DESC = &STR()
        SET &TGT = &STR(MM-DD-YY)
        SET &RESP = &STR(????)
        ISPEXEC TBADD &TBL
      ENDO
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = I) × (&NRSTR(&CMD) = IN) THEN +
        GOTO LOOPIN
      IF (&NRSTR(&CMD) = D) × (&NRSTR(&CMD) = DE) THEN +
        GOTO LOOPDE
UPDATE: +
      IF (&STR(&CDMAJ) = ) THEN +
        DO
          SET &ZERRSM = &STR(MAJOR CODE REQUIRED)
          SET &ZERRLM = &STR(YOU REALLY HAVE TO ENTER A MAJOR CODE)
          SET &ZERRHM = &STR(*)
          SET &ZERRALRM = &STR(YES)
          ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
          ISPEXEC SETMSG MSG(ISRZ002)
          SET &ZTDSELS = 0
          SET &CURS = CDMAJ
          GOTO NEXTSEL
        ENDO
      SET &CMD  = &STR()
      ISPEXEC TBPUT &TBL
      SET &TBLCHG = YES
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
LOOPIN: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    SET &TBLCHG = YES
    SET &CMD = &STR()
    SET &CDMAJ = PROJID
    SET &DESC = &STR()
    SET &TGT = &STR(MM-DD-YY)
    SET &RESP = &STR(????)
    ISPEXEC TBADD &TBL
    GOTO NEXTSEL
LOOPDE: +
    ISPEXEC TBDELETE &TBL
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    SET &TBLCHG = YES
    IF (&RCURNAME = 0) THEN GOTO LOOPIN
    GOTO NEXTSEL
PANLEXIT: +
    ISPEXEC TBTOP &TBL
CLNUP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      GOTO EXITCODE
    IF (&NRSTR(&CDMAJ) = ) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&DESC) = &STR(WHAT IS THE PROJECT)) THEN +
       ISPEXEC TBDELETE &TBL
    GOTO CLNUP
EXITCODE: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    IF (&TBLCHG = YES) THEN +
      DO
        ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A)
        ISPEXEC TBCLOSE &TBL +
          LIBRARY(TIMETRK)
        SET &MYCC = &LASTCC
        IF (&MYCC NE 0) THEN +
          DO
            SET &ZERRSM = &STR(TABLE NOT SAVED)
            SET &ZERRLM = &STR(TABLE &TBL HAD ERRORS RC=&MYCC)
            ISPEXEC SETMSG MSG(ISRZ002)
          ENDO
      ENDO
    ELSE +
      DO
        ISPEXEC TBEND &TBL
        SET &MYCC = &LASTCC
      ENDO
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCKWEEK 0121-92072-93235-1332-00141-00141-00132-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCKWEEK)                                            */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST CALCULATES THE WEEK IN THE YEAR.                */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG
    ISPEXEC CONTROL ERRORS RETURN
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    IF (&WEMM = ) THEN SET &WEMM = &SUBSTR(1:2,&SYSDATE)
    IF (&WEDD = ) THEN SET &WEDD = &SUBSTR(4:5,&SYSDATE)
    IF (&WEYY = ) THEN SET &WEYY = &SUBSTR(7:8,&SYSDATE)
    SET &MM = &WEMM
    SET &MM = &MM
    SET &DD = &WEDD
    SET &DD = &DD
    SET &YY = &WEYY
    SET &YY = &YY
/*                                                                 */
/* FORMAT DAYS OF THE WEEK                                         */
/*                                                                 */
    SET &DAY = &&DAY
    SET &DAY0 = MONDAY
    SET &DAY = &&DAY
    SET &DAY1 = TUESDAY
    SET &DAY = &&DAY
    SET &DAY2 = WEDNESDAY
    SET &DAY = &&DAY
    SET &DAY3 = THURSDAY
    SET &DAY = &&DAY
    SET &DAY4 = FRIDAY
    SET &DAY = &&DAY
    SET &DAY5 = SATURDAY
    SET &DAY = &&DAY
    SET &DAY6 = SUNDAY
    SET &DAY = &&DAY
    SET &DAY7 = MONDAY
/*                                                                 */
/* CALCULATE DAY OF WEEK.                                          */
/*                                                                 */
    SET &DY  = &&DY
    SET &DY1 = 31
    SET &DY  = &&DY
    SET &DY2 = 28
    SET &DY  = &&DY
    SET &DY3 = 31
    SET &DY  = &&DY
    SET &DY4 = 30
    SET &DY  = &&DY
    SET &DY5 = 31
    SET &DY  = &&DY
    SET &DY6 = 30
    SET &DY  = &&DY
    SET &DY7 = 31
    SET &DY  = &&DY
    SET &DY8 = 31
    SET &DY  = &&DY
    SET &DY9 = 30
    SET &DY  = &&DY
    SET &DY10 = 31
    SET &DY  = &&DY
    SET &DY11 = 30
    SET &DY  = &&DY
    SET &DY12 = 31
    SET &LAST_YEAR  = &YY - 1
    SET &GREG_MONTH = &MM
    SET &GREG_DAY   = &DD
    SET &TEMP_YEAR = &YY / 4
    SET &LEAP_YEAR = &YY - (&TEMP_YEAR * 4)
    IF (&LEAP_YEAR = 0) THEN +
      DO
        SET &DY  = &&DY
        SET &DY2 = 29
      ENDO
    SET &JULI_DAY = &DD
    SET &LOOP_CTR = 0
LOOPER: +
    SET &LOOP_CTR = &LOOP_CTR + 1
    IF (&LOOP_CTR = &MM) THEN GOTO LOOPEND
    SET &JULI_DAY = &JULI_DAY + &DY&LOOP_CTR
    GOTO LOOPER
LOOPEND: +
    SET &WS_DAYS = (1461 * &LAST_YEAR) / 4
/*  CONTROL LIST MSG CONLIST SYMLIST
    SET &WS_DAYS = &WS_DAYS + &JULI_DAY
    SET &WS_WEEK = &WS_DAYS / 7
    SET &DAY_OF_WEEK = &WS_DAYS - (7 * &WS_WEEK)
    /* 0 = MONDAY */
    SET &DAY = &&DAY
/*  WRITENR &JULI_DAY FALLS ON A
/*  WRITENR &DAY&DAY_OF_WEEK
/*  WRITE THE &DAY_OF_WEEK WORKING DAY
    SET &INCDD = 9 - &DAY_OF_WEEK
    IF (&DAY_OF_WEEK = 0) THEN SET &INCDD = 3
    IF (&DAY_OF_WEEK = 1) THEN SET &INCDD = 2
    IF (&DAY_OF_WEEK = 2) THEN SET &INCDD = 1
    IF (&DAY_OF_WEEK = 3) THEN SET &INCDD = 0
    IF (&DAY_OF_WEEK = 4) THEN SET &INCDD = 6
    IF (&DAY_OF_WEEK = 5) THEN SET &INCDD = 5
    IF (&DAY_OF_WEEK = 6) THEN SET &INCDD = 4
    IF (&DAY_OF_WEEK = 7) THEN SET &INCDD = 3
/*                                                                 */
/* CALCULATE WEEK ENDING DATE.                                     */
/*                                                                 */
    SET &DD = &DD + &INCDD
    SET &MMM = &MM
    SET &DYDD = &&DY&MMM
    IF (&DD > &DYDD) THEN +
      DO
        SET &DD = &DD - &DYDD
        SET &MM = &MM + 1
        IF (&MM > 12) THEN +
          DO
            SET &MM = 1
            SET &YY = &YY + 1
          ENDO
      ENDO
ISEND: +
    IF (&YY < 10) THEN SET &YY = &STR(0&YY)
    IF (&MM < 10) THEN SET &MM = &STR(0&MM)
    IF (&DD < 10) THEN SET &DD = &STR(0&DD)
    SET &WEEKDATE = &STR(&MM./&DD./19&YY)
    SET &WEEK_ENDING = &JULI_DAY + &INCDD
    SET &WE_WEEK = (&WEEK_ENDING / 7) + 1
    SET &WEYR = &WE_WEEK
    SET &WKYY = &STR(&YY)
    SET &WKMM = &STR(&MM)
    SET &WKDD = &STR(&DD)
    ISPEXEC VPUT (WEYR WEEKDATE WKYY WKMM WKDD) SHARED
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        WRITE VPUT FAILED RC=&MYCC
        WRITE WEYR=&WEYR
        WRITE WEEKDATE=&WEEKDATE
        WRITE WKYY=&WKYY
        WRITE WKMM=&WKMM
        WRITE WKDD=&WKDD
      ENDO
    EXIT CODE(0)
./ ADD NAME=TRCK001  0115-92048-94026-1321-00052-00118-00044-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK001)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST GETS TODAYS DATE, DETERMINES WHAT THE PERIOD    */
/*      ENDING DATE (THURSDAY) IS, AND PUTS UP A SELECTION PANEL.  */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ISPEXEC VPUT (PGMR)
    TRCKPGMR
    ISPEXEC VGET (PGMR)
/*  SET &PGMR = &PGMR
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    SET &WHOITBE = &SYSUID
/*                                                                 */
/* SUBROUTINE: CALL SUBROUTINE TRCKWEEK                            */
/*      CALCULATE WEEK ENDING DATE FOR CURRENT WEEK.               */
/*                                                                 */
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC VPUT (WHOITBE WEMM WEDD WEYY)
    %TRCKWEEK
    ISPEXEC VGET (WEYR WEEKDATE WKYY WKMM WKDD)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        WRITE VGET FAILED RC=&MYCC
        WRITE WEYR=&WEYR
        WRITE WEEKDATE=&WEEKDATE
        WRITE WKYY=&WKYY
        WRITE WKMM=&WKMM
        WRITE WKDD=&WKDD
      ENDO
    SET &WEYY = &STR(&WKYY)
    SET &WEMM = &STR(&WKMM)
    SET &WEDD = &STR(&WKDD)
    ISPEXEC VPUT (WEYR WEEKDATE WEYY WEMM WEDD)
WHATDATE: +
    IF (&SYSUID EQ DD20008) OR   +
       (&SYSUID EQ KETCSC)  OR   +
       (&SYSUID EQ SUE)     THEN +
      ISPEXEC SELECT PANEL(TRCK002)
    ELSE +
      ISPEXEC SELECT PANEL(TRCK001)
    EXIT CODE(0)
./ ADD NAME=TRCK100  0121-92048-92087-1204-00156-00111-00060-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK100)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO DISPLAY A TABLE   */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    SET &PGMR = &PGMR
    SET &SYSDVAL = &STR(&PGMR)
    READDVAL NAMEA NAMEB
    SET &INITB = &SUBSTR(1:3,&NAMEB)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL NOSAVE
    ISPEXEC TBCLOSE &TBL +
      LIBRARY(TIMETRK)
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL NOWRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        SET &ZERRSM = &STR(NO ENTRIES FOR &TBL)
        SET &ZERRLM = &STR(USE OPTION 2 TO ADD ENTRIES)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        GOTO TOTDAY
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
        GOTO ABNEXIT
      ENDO
TOTDAY: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0
    SET &TDAY2 = 0
    SET &TDAY3 = 0
    SET &TDAY4 = 0
    SET &TDAY5 = 0
    SET &TDAY6 = 0
    SET &TDAY7 = 0
    SET &TTOT  = 0
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    GOTO TOTSKP
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBTOP &TBL
PANLLOOP: +
    SET &ZCMD = &STR( )
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK100) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN GOTO PANLEXIT
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &COLNAME = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&COLNAME) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&COLNAME) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
VARPPROC: +
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
PANLEXIT: +
    ISPEXEC TBEND &TBL
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCK200  0130-92080-94038-0754-00471-00331-00237-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK200)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO UPDATE A TABLE    */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ISPEXEC VPUT (PGMR)
    TRCKPGMR
    ISPEXEC VGET (PGMR NAMEA NAMEB)
    SET &INITB = &SUBSTR(1:3,&NAMEB)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMAJ CDMIN DESC +
                DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT X) +
          REPLACE
        SET &USER = &SYSUID
        SET &CMD  = &STR()
        SET &CDMAJ = 1234
        SET &CDMIN = 1234
        SET &DESC = &STR(BRIEF WHAT YOU DID)
        SET &DAY1 = 0
        SET &DAY2 = 0
        SET &DAY3 = 0
        SET &DAY4 = 0
        SET &DAY5 = 0
        SET &DAY6 = 0
        SET &DAY7 = 0
        SET &TOT = 0
        SET &X = &STR()
        ISPEXEC TBADD &TBL
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &ORIGROW = &RUPDNAME
        IF (&RCURNAME = 0) THEN +
          DO
            SET &USER = &SYSUID
            SET &CMD  = &STR()
            SET &CDMAJ = 1234
            SET &CDMIN = 1234
            SET &DESC = &STR(BRIEF WHAT YOU DID)
            SET &DAY1 = 0
            SET &DAY2 = 0
            SET &DAY3 = 0
            SET &DAY4 = 0
            SET &DAY5 = 0
            SET &DAY6 = 0
            SET &DAY7 = 0
            SET &TOT = 0
            SET &X = &STR()
            ISPEXEC TBADD &TBL
          ENDO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0.0
    SET &TDAY2 = 0.0
    SET &TDAY3 = 0.0
    SET &TDAY4 = 0.0
    SET &TDAY5 = 0.0
    SET &TDAY6 = 0.0
    SET &TDAY7 = 0.0
    SET &TTOT  = 0.0
CLCSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO CLCEND
      ENDO
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    GOTO CLCSKP
/* **************************************************************
/*       END OF RECALCULATION
/* **************************************************************
CLCEND: +
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &EXITCC = NO
    SET &TBLCHG = NO
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN GOTO PANLEXIT
    SET &EXITCC = NO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK200) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = D) × (&NRSTR(&CMD) = DE) THEN +
        GOTO LOOPDE
      SET &INSERT = NO
      IF (&NRSTR(&CMD) = I) × (&NRSTR(&CMD) = IN) THEN +
        SET &INSERT = YES
      SET &REPEAT = NO
      IF (&NRSTR(&CMD) = R) × (&NRSTR(&CMD) = RE) THEN +
        SET &REPEAT = YES
UPDATE: +
    IF (&STR(&CDMAJ) = &STR(?)) THEN +
      DO
        SET &CDMAJ =
        ISPEXEC CONTROL DISPLAY SAVE
        %TRCK202
        ISPEXEC CONTROL DISPLAY RESTORE
        ISPEXEC VGET (CDMAJ DESC) SHARED
      ENDO
    IF (&STR(&CDMAJ) = &STR(!)) THEN +
      DO
        SET &CDMAJ =
        ISPEXEC CONTROL DISPLAY SAVE
        %TRCK204
        ISPEXEC CONTROL DISPLAY RESTORE
        ISPEXEC VGET (CDMAJ DESC) SHARED
      ENDO
    IF (&STR(&CDMIN) = &STR(?)) THEN +
      DO
        SET &CDMIN =
        ISPEXEC CONTROL DISPLAY SAVE
        %TRCK203
        ISPEXEC CONTROL DISPLAY RESTORE
        SET &OLDDESC = &STR(&DESC)
        ISPEXEC VGET (CDMIN DESC) SHARED
        SET &NEWDESC = &NRSTR(&OLDDESC &DESC)
        SET &DESC = &STR(&NEWDESC)
      ENDO
      IF (&STR(&CDMIN) = ) THEN +
        DO
          SET &ZERRSM = &STR(MINOR CODE REQUIRED)
          SET &ZERRLM = &STR(YOU REALLY HAVE TO ENTER A MINOR CODE)
          SET &ZERRHM = &STR(*)
          SET &ZERRALRM = &STR(YES)
          ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
          ISPEXEC SETMSG MSG(ISRZ002)
          SET &ZTDSELS = 0
          SET &CURS = CDMIN
          GOTO NEXTSEL
        ENDO
      SET &CMD  = &STR()
      ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7) SHARED
      %TRCKADD
      ISPEXEC VGET (TOT) SHARED
      ISPEXEC TBPUT &TBL
      IF (&REPEAT = YES) THEN +
        GOTO LOOPRE
      IF (&INSERT = YES) THEN +
        GOTO LOOPIN
      SET &TBLCHG = YES
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SAVE) THEN +
      DO
        ISPEXEC TBSAVE &TBL
      ENDO
    IF (&NRSTR(&FIELDA) = CALC)   OR +
       (&NRSTR(&FIELDA) = SAVE) THEN +
      DO
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0.0
    SET &TDAY2 = 0.0
    SET &TDAY3 = 0.0
    SET &TDAY4 = 0.0
    SET &TDAY5 = 0.0
    SET &TDAY6 = 0.0
    SET &TDAY7 = 0.0
    SET &TTOT  = 0.0
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO TOTEND
      ENDO
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    GOTO TOTSKP
/* **************************************************************
/*       END OF RECALCULATION
/* **************************************************************
TOTEND: +
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        ISPEXEC TBSORT &TBL +
            FIELDS(CDMAJ,C,A,CDMIN,C,A,DESC,C,A)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCK200 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    IF (&NRSTR(&PRICMD) = I) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &TBLCHG = YES
        ISPEXEC CONTROL DISPLAY SAVE
        %TRCK201
        ISPEXEC CONTROL DISPLAY RESTORE
        SET &CMD = &STR()
        SET &PRICMD = &STR()
        ISPEXEC VGET (ADDOK) SHARED
        IF (&ADDOK = YES) THEN +
          DO
            ISPEXEC VGET (CDMAJ CDMIN DESC TOT X) SHARED
            ISPEXEC VGET (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7) SHARED
            ISPEXEC TBADD &TBL
          ENDO
      ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
LOOPDE: +
    SET &TBLCHG = YES
    ISPEXEC TBDELETE &TBL
    SET &CRP = &CRP - 1
    ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                        UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                        USER(USERNAME)     ROWCREAT(RCRTNAME) +
                        ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                        TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                        RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                        STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                        LIBRARY(LIBNAME)
    IF (&RCURNAME = 0) THEN +
      DO
        SET &USER = &SYSUID
        SET &CMD  = &STR()
        SET &CDMAJ = 1234
        SET &CDMIN = 1234
        SET &DESC = &STR(BRIEF WHAT YOU DID)
        SET &DAY1 = 0
        SET &DAY2 = 0
        SET &DAY3 = 0
        SET &DAY4 = 0
        SET &DAY5 = 0
        SET &DAY6 = 0
        SET &DAY7 = 0
        SET &TOT = 0
        SET &X = &STR()
        ISPEXEC TBADD &TBL
        SET &CRP = 1
      ENDO
    GOTO NEXTSEL
LOOPIN: +
    %TRCK201
    SET &CMD = &STR()
    ISPEXEC VGET (ADDOK) SHARED
    IF (&ADDOK NE YES) THEN +
      GOTO NEXTSEL
    ISPEXEC VGET (CDMAJ CDMIN DESC TOT X) SHARED
    ISPEXEC VGET (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7) SHARED
    ISPEXEC TBADD &TBL
    SET &TBLCHG = YES
    GOTO NEXTSEL
LOOPRE: +
    SET &CMD = &STR()
    ISPEXEC TBADD &TBL
    SET &TBLCHG = YES
    GOTO NEXTSEL
PANLEXIT: +
    ISPEXEC TBTOP &TBL
CLNUP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      GOTO EXITCODE
    IF (&TOT = 0) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&CDMAJ) = ) AND +
       (&NRSTR(&CDMIN) = ) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&CDMIN) = &STR(?) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&DESC) = &STR(BRIEF WHAT YOU DID)) AND +
       (&NRSTR(&CDMAJ) = 1234) AND +
       (&NRSTR(&CDMIN) = 1234) THEN +
       ISPEXEC TBDELETE &TBL
    GOTO CLNUP
EXITCODE: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    IF (&TRACE = TRACE) THEN +
      WRITE TBSTATS &TBL    CDATE(&CDATNAME)    CTIME(&CTIMNAME)    +
                            UDATE(&UDATNAME)    UTIME(&UTIMNAME)    +
                            USER(&USERNAME)     ROWCREAT(&RCRTNAME) +
                            ROWCURR(&RCURNAME)  ROWUPD(&RUPDNAME)   +
                            TABLEUPD(&TUPDNAME) SERVICE(&SERVNAME)  +
                            RETCODE(&RETCNAME)  STATUS1(&STA1NAME)  +
                            STATUS2(&STA2NAME)  STATUS3(&STA3NAME)  +
                            LIBRARY(&LIBNAME)
/*
/*   TABLENAM - NAME OF THE TABLE FOR WHICH STATISTICAL INFORMATION IS
/*              TO BE OBTAINED
/*   CDATNAME - OPTIONAL, VARIABLE NAME WHERE TABLE CREATION DATE IS
/*              TO BE STORED.
/*   CTIMNAME - OPTIONAL, VARIABLE NAME WHERE TABLE CREATION TIME IS
/*              TO BE STORED.
/*   UDATNAME - OPTIONAL, VARIABLE NAME WHERE THE DATE THE TABLE WAS
/*              LAST UPDATED IS STORED.
/*   UTIMNAME - OPTIONAL, VARIABLE NAME WHERE THE TIME THE TABLE WAS
/*              LAST UPDATED IS STORED.
/*   USERNAME - OPTIONAL, VARIABLE NAME WHERE THE USERID OF THE USER
/*              THAT CREATED OR LAST UPDATED THE TABLE IS TO BE STORED.
/*   RCRTNAME - OPTIONAL, VARIABLE NAME WHERE THE NUMBER OF ROWS THAT
/*              EXISTED AT THE END OF THE "CREATE PROCESS" IS TO BE
/*              STORED.
/*   RCURNAME - OPTIONAL, VARIABLE NAME WHERE THE CURRENT NUMBER OF
/*              ROWS CONTAINED IN THE TABLE IS TO BE STORED.
/*   RUPDNAME - OPTIONAL, VARIABLE NAME WHERE THE NUMBER OF UPDATED
/*              ROWS IS STORED.
/*   TUPDNAME - OPTIONAL, VARIABLE NAME WHERE THE NUMBER OF TIMES THE
/*              TABLE HAS BEEN UPDATED IS STORED.
/*   SERVNAME - OPTIONAL, VARIABLE NAME WHERE THE NAME OF THE LAST
/*              TABLE SERVICES COMMAND FOR THIS TABLE IS TO BE STORED.
/*   RETCNAME - OPTIONAL, VARIABLE NAME WHERE THE RETURN CODE
/*              ASSOCIATED WITH THE LAST TABLE SERVICES COMMAND ISSUED
/*              FOR THIS TABLE IS TO BE STORED.
/*   STA1NAME - OPTIONAL, VARIABLE NAME WHERE THE STATUS OF THE TABLE
/*              IN THE TABLE INPUT LIBRARY CHAIN IS STORED.
/*   STA2NAME - OPTIONAL, VARIABLE NAME WHERE THE STATUS OF THE TABLE
/*              IN THIS LOGICAL SCREEN IS STORED.
/*   STA3NAME - OPTIONAL, VARIABLE NAME WHERE THE AVAILABILITY OF THE
/*              TABLE TO BE USED IN WRITE MODE IS TO BE STORED.
/*   LIBNAME  - OPTIONAL, SPECIFIES AN ALTERNATE INPUT LIBRARY NAME.
/*              DEFAULT IS ISPTLIB.
/*
    IF (&TBLCHG = YES) THEN +
      DO
        ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A,CDMIN,C,A,DESC,C,A)
        ISPEXEC TBCLOSE &TBL +
          LIBRARY(TIMETRK)
        SET &MYCC = &LASTCC
        IF (&MYCC NE 0) THEN +
          DO
            SET &ZERRSM = &STR(TABLE NOT SAVED)
            SET &ZERRLM = &STR(TABLE &TBL HAD ERRORS RC=&MYCC)
            ISPEXEC SETMSG MSG(ISRZ002)
          ENDO
      ENDO
    ELSE +
      DO
        ISPEXEC TBEND &TBL
        SET &MYCC = &LASTCC
      ENDO
    EXIT CODE(0)
./ ADD NAME=TRCK201  0118-92080-94038-0939-00113-00077-00058-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK201)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO POP UP A DATA     */
/*      ENTRY PANEL.                                               */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
/*  CONTROL LIST MSG CONLIST SYMLIST
    SET &CDMAJ = &STR(?)
    SET &CDMIN = &STR(?)
    SET &DESC = &STR()
    SET &DAY1 = 0
    SET &DAY2 = 0
    SET &DAY3 = 0
    SET &DAY4 = 0
    SET &DAY5 = 0
    SET &DAY6 = 0
    SET &DAY7 = 0
    SET &TOT = 0
    SET &X = &STR()
    SET &ADDOK = NO
    SET &CURS = CDMAJ
/* **************************************************************
/*       PANLLOOP TABLE
/* **************************************************************
PANLLOOP: +
    ISPEXEC DISPLAY PANEL(TRCK201) CURSOR(&CURS)
    SET &QUITCC = &LASTCC
    IF (&NRSTR(&ZCMD) = CANCEL) THEN +
      DO
        SET &ADDOK = NO
        ISPEXEC VPUT (ADDOK) SHARED
        EXIT CODE(0)
      ENDO
    IF (&STR(&CDMAJ) = &STR(?)) THEN +
      DO
        SET &CDMAJ =
        SET &DESC  =
        ISPEXEC VPUT (CDMAJ) SHARED
        ISPEXEC CONTROL DISPLAY SAVE
        %TRCK202
        ISPEXEC CONTROL DISPLAY RESTORE
        ISPEXEC VGET (CDMAJ DESC) SHARED
      ENDO
    IF (&STR(&CDMAJ) = &STR(!)) THEN +
      DO
        SET &CDMAJ =
        SET &DESC  =
        ISPEXEC VPUT (CDMAJ) SHARED
        ISPEXEC CONTROL DISPLAY SAVE
        %TRCK204
        ISPEXEC CONTROL DISPLAY RESTORE
        ISPEXEC VGET (CDMAJ DESC) SHARED
      ENDO
    IF (&STR(&CDMIN) = &STR(?)) THEN +
      DO
        ISPEXEC CONTROL DISPLAY SAVE
        %TRCK203
        ISPEXEC CONTROL DISPLAY RESTORE
        SET &OLDDESC = &STR(&DESC)
        ISPEXEC VGET (CDMIN DESC) SHARED
        SET &NEWDESC = &NRSTR(&OLDDESC &DESC)
        SET &DESC = &STR(&NEWDESC)
      ENDO
    IF (&STR(&CDMIN) = ) THEN +
      DO
        SET &ZERRSM = &STR(MINOR CODE REQUIRED)
        SET &ZERRLM = &STR(YOU REALLY HAVE TO ENTER A MINOR CODE)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        SET &ADDOK = NO
        SET &CURS = CDMIN
        GOTO PANLLOOP
      ENDO
    IF (&NRSTR(&DESC) = ) THEN +
      DO
        SET &ZERRSM = &STR(DESCRIPTION REQUIRED)
        SET &ZERRLM = &STR(YOU REALLY HAVE TO ENTER A DESCRIPTION)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(YES)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        SET &ADDOK = NO
        SET &CURS = DESC
        GOTO PANLLOOP
      ENDO
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7) SHARED
    %TRCKADD
    ISPEXEC VGET (TOT) SHARED
    SET &ADDOK = YES
    IF (&QUITCC NE 0) THEN +
      DO
        ISPEXEC VPUT (CDMAJ CDMIN DESC TOT X) SHARED
        ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7) SHARED
        ISPEXEC VPUT (ADDOK) SHARED
        EXIT CODE(0)
      ENDO
/*                                                                 */
    IF (&ADDOK = YES) THEN +
      DO
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(PF3 TO INSERT)
    SET &ZERRLM = &STR(PRESS PF3/PF15 (END) TO INSERT)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
      ENDO
/*                                                                 */
    GOTO PANLLOOP
./ ADD NAME=TRCK202  0113-92080-93165-1346-00174-00161-00025-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK202)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO SELECT FROM       */
/*      A TABLE OF MAJOR CODES.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XCDMAJ
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL NOWRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(OPEN ERROR)
        SET &ZERRLM = &STR(THE TABLE &TBL DID NOT OPEN RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A,DESC,C,A)
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &CDMAJ = &STR()
    SET &DESC = &STR()
    SET &EXITCC = NO
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN +
      DO
        GOTO PANLEXIT
      ENDO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK202) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    SET &EXITCC = NO
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = CANCEL) THEN +
      DO
        ISPEXEC TBEND &TBL
        SET &CDMAJ = &STR()
        SET &DESC = &STR()
        ISPEXEC VPUT (CDMAJ DESC)
        EXIT CODE(0)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        SET &SORTFLD = &NRSTR(&FIELDB)
        SET &SORTORD = A
        ISPEXEC TBSORT &TBL +
            FIELDS(&SORTFLD,C,&SORTORD)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCK202 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = S) THEN +
        GOTO LOOPIN
      SET &CMD  = &STR()
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    SET &CDMAJ = &STR()
    SET &DESC  = &STR()
    GOTO PANLLOOP
LOOPIN: +
    IF (&STR(&STAT) = Cmpl) THEN +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(YES)             /*  ALARM STATUS     */
        SET &ZERRSM = &STR(NON SELECTABLE)
        SET &ZERRLM = &STR(THE Major Code &CDMAJ Is Not Selectable)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO PANLLOOP
      ENDO
PANLEXIT: +
    IF (&CDMAJ ^= ) THEN ISPEXEC VPUT (CDMAJ DESC) SHARED
    ISPEXEC TBEND &TBL
    SET &MYCC = &LASTCC
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCK203  0112-92080-92175-0804-00164-00157-00014-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK203)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO SELECT FROM       */
/*      A TABLE OF MINOR CODES.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XCDMIN
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL NOWRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(OPEN ERROR)
        SET &ZERRLM = &STR(THE TABLE &TBL DID NOT OPEN RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBSORT &TBL FIELDS(CDMIN,C,A,DESC,C,A)
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &EXITCC = NO
    SET &CDMIN = &STR()
    SET &DESC = &STR()
    ISPEXEC VPUT (CDMIN DESC) SHARED
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN +
      DO
        GOTO PANLEXIT
      ENDO
    SET &EXITCC = NO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK203) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = CANCEL) THEN +
      DO
        ISPEXEC TBEND &TBL
        SET &CDMIN = &STR()
        SET &DESC = &STR()
        ISPEXEC VPUT (CDMIN DESC) SHARED
        EXIT CODE(0)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        SET &SORTFLD = &NRSTR(&FIELDB)
        SET &SORTORD = A
        ISPEXEC TBSORT &TBL +
            FIELDS(&SORTFLD,C,&SORTORD)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCK203 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = S) THEN +
        GOTO PANLEXIT
      SET &CMD  = &STR()
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    SET &CDMIN = &STR()
    SET &DESC = &STR()
    GOTO PANLLOOP
PANLEXIT: +
    IF (&CDMIN ^= ) THEN ISPEXEC VPUT (CDMIN DESC) SHARED
    ISPEXEC TBEND &TBL
    SET &MYCC = &LASTCC
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCK204  0104-92085-93161-0738-00171-00167-00009-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK204)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO SELECT FROM       */
/*      A TABLE OF MAJOR CODES.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XAGENCY
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL NOWRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(OPEN ERROR)
        SET &ZERRLM = &STR(THE TABLE &TBL DID NOT OPEN RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A,DESC,C,A)
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &CDMAJ = &STR()
    SET &EXITCC = NO
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN +
      DO
        IF (&CDMAJ ^= ) THEN ISPEXEC VPUT (CDMAJ DESC) SHARED
        GOTO PANLEXIT
      ENDO
    SET &EXITCC = NO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK204) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = CANCEL) THEN +
      DO
        ISPEXEC TBEND &TBL
        SET &CDMAJ = &STR()
        ISPEXEC VPUT (CDMAJ) SHARED
        EXIT CODE(0)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        SET &SORTFLD = &NRSTR(&FIELDB)
        SET &SORTORD = A
        ISPEXEC TBSORT &TBL +
            FIELDS(&SORTFLD,C,&SORTORD)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCK204 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = S) THEN +
        GOTO LOOPIN
      SET &CMD  = &STR()
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
LOOPIN: +
    IF (&STR(&RESP) = DONE) THEN +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(YES)             /*  ALARM STATUS     */
        SET &ZERRSM = &STR(NON SELECTABLE)
        SET &ZERRLM = &STR(THE MINOR CODE &CDMIN IS NOT SELECTABLE)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO PANLLOOP
      ENDO
    ISPEXEC VPUT (CDMAJ) SHARED
PANLEXIT: +
    ISPEXEC TBEND &TBL
    SET &MYCC = &LASTCC
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCK300  0116-92073-94026-1326-00138-00113-00041-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK300)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO READ   A TABLE    */
/*      OF TIME TRACKING HOURS AND SUBMIT A SCRIPT JOB.            */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
/*  CONTROL LIST MSG CONLIST SYMLIST
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR WEEKDATE)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    ISPEXEC VPUT (PGMR)
    TRCKPGMR
    ISPEXEC VGET (PGMR)
    SET &SYSDVAL = &STR(&PGMR)
    READDVAL NAMEA NAMEB
    SET &INITB = &SUBSTR(1:3,&NAMEB)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        SET &ZERRSM = &STR(NO ENTRIES FOR &TBL)
        SET &ZERRLM = &STR(USE OPTION 2 TO ADD ENTRIES)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(16)
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)  CTIME(CTIMNAME)    +
                          UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                          USER(USERNAME)     ROWCREAT(RCRTNAME) +
                          ROWCURR(RCURNAME)
        IF (&RCURNAME = 0) THEN +
          DO
            EXIT CODE(16)
          ENDO
        GOTO PANLLOOP
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       PANLLOOP TABLE
/* **************************************************************
PANLLOOP: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0
    SET &TDAY2 = 0
    SET &TDAY3 = 0
    SET &TDAY4 = 0
    SET &TDAY5 = 0
    SET &TDAY6 = 0
    SET &TDAY7 = 0
    SET &TTOT  = 0
    SET &ENTRIES = 0
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    IF (&TOT = 0) THEN +
       ISPEXEC TBDELETE &TBL
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    SET &ENTRIES = &ENTRIES + 1
    GOTO TOTSKP
DISPLAY: +
    ISPEXEC TBBOTTOM &TBL
    SET &CDMAJ =
    SET &CDMIN =
    SET &DESC  = &STR( )
    SET &DAY1  =
    SET &DAY2  =
    SET &DAY3  =
    SET &DAY4  =
    SET &DAY5  =
    SET &DAY6  =
    SET &DAY7  =
    SET &TOT   =
    SET &X     =
    DO WHILE &EVAL(&ENTRIES // 25) NE 0
      ISPEXEC TBADD &TBL
      SET &ENTRIES = &ENTRIES + 1
    ENDO
    FREE FILE(ISPFILE)
    DELETE '&SYSUID..TRCK300.&TBL'
    ALLOC FILE(ISPFILE) DATASET('&SYSUID..TRCK300.&TBL') +
      RECFM(F B) BLKSIZE(3120) LRECL(80) +
      NEW CATALOG UNIT(SYSDA) +
      SPACE(1 5) TRACKS
    ISPEXEC  VPUT (TBL) SHARED
    ISPEXEC  FTOPEN
    ISPEXEC  FTINCL TRCKSCRP
    ISPEXEC  FTCLOSE
    FREE FILE(ISPFILE)
    ISPEXEC  FTOPEN TEMP
    ISPEXEC  FTINCL TRCK300
    ISPEXEC  FTCLOSE
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
EXITCODE: +
    ISPEXEC TBEND &TBL
    EXIT CODE(0)
./ ADD NAME=TRCK301  0103-92215-93229-0930-00136-00134-00005-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK301)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO READ   A TABLE    */
/*      OF TIME TRACKING HOURS AND SUBMIT A SCRIPT JOB.            */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
/*  CONTROL LIST MSG CONLIST SYMLIST
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR WEEKDATE)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    SET &PGMR = &PGMR
    SET &SYSDVAL = &STR(&PGMR)
    READDVAL NAMEA NAMEB
    SET &INITB = &SUBSTR(1:3,&NAMEB)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        SET &ZERRSM = &STR(NO ENTRIES FOR &TBL)
        SET &ZERRLM = &STR(USE OPTION 2 TO ADD ENTRIES)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(16)
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)  CTIME(CTIMNAME)    +
                          UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                          USER(USERNAME)     ROWCREAT(RCRTNAME) +
                          ROWCURR(RCURNAME)
        IF (&RCURNAME = 0) THEN +
          DO
            EXIT CODE(16)
          ENDO
        GOTO PANLLOOP
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       PANLLOOP TABLE
/* **************************************************************
PANLLOOP: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0
    SET &TDAY2 = 0
    SET &TDAY3 = 0
    SET &TDAY4 = 0
    SET &TDAY5 = 0
    SET &TDAY6 = 0
    SET &TDAY7 = 0
    SET &TTOT  = 0
    SET &ENTRIES = 0
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    IF (&TOT = 0) THEN +
       ISPEXEC TBDELETE &TBL
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    SET &ENTRIES = &ENTRIES + 1
    GOTO TOTSKP
DISPLAY: +
    ISPEXEC TBBOTTOM &TBL
    SET &CDMAJ =
    SET &CDMIN =
    SET &DESC  = &STR( )
    SET &DAY1  =
    SET &DAY2  =
    SET &DAY3  =
    SET &DAY4  =
    SET &DAY5  =
    SET &DAY6  =
    SET &DAY7  =
    SET &TOT   =
    SET &X     =
    DO WHILE &EVAL(&ENTRIES // 25) NE 0
      ISPEXEC TBADD &TBL
      SET &ENTRIES = &ENTRIES + 1
    ENDO
    FREE FILE(ISPFILE)
    DELETE '&SYSUID..TRCK302.&TBL'
    ALLOC FILE(ISPFILE) DATASET('&SYSUID..TRCK301.&TBL') +
      RECFM(F B) BLKSIZE(3120) LRECL(80) +
      NEW CATALOG UNIT(SYSDA) +
      SPACE(1 5) TRACKS
    ISPEXEC  VPUT (TBL) SHARED
    ISPEXEC  FTOPEN
    ISPEXEC  FTINCL TRCKSCRP
    ISPEXEC  FTCLOSE
    FREE FILE(ISPFILE)
    ISPEXEC  FTOPEN TEMP
    ISPEXEC  FTINCL TRCK301
    ISPEXEC  FTCLOSE
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL NOMSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
EXITCODE: +
    ISPEXEC TBEND &TBL
    EXIT CODE(0)
./ ADD NAME=TRCK400  0110-92084-93202-0857-00094-00020-00084-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK400)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES TSO TO TELL KEN A WEEK IS READY.           */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG
    GETSYSID
    SET &MC = 7
    IF (&SYSID = DOFD) OR +
       (&SYSID = DOFP) OR +
       (&SYSID = DOFX) THEN +
       SET &MC = Z
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VPUT (MC) SHARED
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &INIT = &SUBSTR(1:3,&WHOITBE   )
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR WEEKDATE)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &SYSOUTTRAP = 25
    LISTUSER &SYSUID
    SET &SYSOUTTRAP = 0
/*  CONTROL LIST CONLIST SYMLIST MSG
    SET &B = &SYSINDEX(NAME=,&STR(&SYSOUTLINE1))
    SET &B = &B + 5
    SET &E = &B + 20
    SET &PGMR = &SUBSTR(&B:&E,&NRSTR(&SYSOUTLINE1))
    SET &PGMR = &PGMR
    SET &SYSDVAL = &STR(&PGMR)
    READDVAL NAMEA NAMEB
    SET &INITB = &SUBSTR(1:3,&NAMEB)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC VPUT (TBL)
    %TRCK301
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        SET &ZERRSM = &STR(NO ENTRIES FOR &TBL)
        SET &ZERRLM = &STR(USE OPTION 2 TO ADD ENTRIES)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        EXIT CODE(16)
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)  CTIME(CTIMNAME)    +
                          UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                          USER(USERNAME)     ROWCREAT(RCRTNAME) +
                          ROWCURR(RCURNAME)
        IF (&RCURNAME = 0) THEN +
          DO
            EXIT CODE(16)
          ENDO
        GOTO SENDIT
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
SENDIT: +
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    ISPEXEC VPUT (WHOITBE WEMM WEDD WEYY PGMR)
    ISPEXEC  FTOPEN TEMP
    ISPEXEC  FTINCL TRCK400
    ISPEXEC  FTCLOSE
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    SUBMIT '&ZTEMPF' NOHOLD
/*                                                                 */
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(MSG SUBMITTED)         /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(IT IS BEING ROUTED TO VM)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
/*                                                                 */
    ISPEXEC TBEND &TBL
/*  %TRCK710
    EXIT CODE(0)
./ ADD NAME=TRCK410  0101-93202-93229-0930-00137-00135-00002-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK410)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO READ   A TABLE    */
/*      OF TIME TRACKING HOURS AND SUBMIT A SCRIPT JOB.            */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
/*  CONTROL LIST MSG CONLIST SYMLIST
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR WEEKDATE)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    ISPEXEC VGET (INITB WEMM WEDD WEYY PGMR)
    SET &INITB = &SUBSTR(1:3,&INITB)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMAJ CDMIN DESC +
                DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT X) +
          REPLACE
        SET &ZERRSM = &STR(&TBL CREATED)
        SET &ZERRLM = &STR(TABLE DID NOT EXIST, NO ENTRIES)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO PANLLOOP
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)  CTIME(CTIMNAME)    +
                          UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                          USER(USERNAME)     ROWCREAT(RCRTNAME) +
                          ROWCURR(RCURNAME)
        IF (&RCURNAME = 0) THEN +
          DO
            SET &ZERRSM = &STR(EMPTY &TBL)
            SET &ZERRLM = &STR(USE OPTION 2 TO ADD ENTRIES)
            SET &ZERRHM = &STR(*)
            SET &ZERRALRM = &STR(NO)
            ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
            ISPEXEC SETMSG MSG(ISRZ002)
            GOTO PANLLOOP
          ENDO
        GOTO PANLLOOP
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       PANLLOOP TABLE
/* **************************************************************
PANLLOOP: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0
    SET &TDAY2 = 0
    SET &TDAY3 = 0
    SET &TDAY4 = 0
    SET &TDAY5 = 0
    SET &TDAY6 = 0
    SET &TDAY7 = 0
    SET &TTOT  = 0
    SET &ENTRIES = 1
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    IF (&TOT = 0) THEN +
       ISPEXEC TBDELETE &TBL
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    SET &ENTRIES = &ENTRIES + 1
    GOTO TOTSKP
DISPLAY: +
    ISPEXEC TBBOTTOM &TBL
    SET &CDMAJ =
    SET &CDMIN =
    SET &DESC  = &STR( )
    SET &DAY1  =
    SET &DAY2  =
    SET &DAY3  =
    SET &DAY4  =
    SET &DAY5  =
    SET &DAY6  =
    SET &DAY7  =
    SET &TOT   =
    SET &X     =
    DO WHILE &EVAL(&ENTRIES // 21) NE 0
      ISPEXEC TBADD &TBL
      SET &ENTRIES = &ENTRIES + 1
    ENDO
    FREE FILE(ISPFILE)
    DELETE '&SYSUID..TIME.TRACK.&TBL'
    ALLOC FILE(ISPFILE) DATASET('&SYSUID..TIME.TRACK.&TBL') +
      RECFM(F B) BLKSIZE(3120) LRECL(80) +
      NEW CATALOG UNIT(SYSDA) +
      SPACE(1 5) TRACKS
    ISPEXEC  VPUT (TBL) SHARED
    ISPEXEC  FTOPEN
    ISPEXEC  FTINCL TRCKSCRL
    ISPEXEC  FTCLOSE
    FREE FILE(ISPFILE)
    ISPEXEC  FTOPEN TEMP
    ISPEXEC  FTINCL TRCK710
    ISPEXEC  FTCLOSE
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
EXITCODE: +
    ISPEXEC TBEND &TBL
    EXIT CODE(0)
./ ADD NAME=TRCK500  0105-92077-92092-1639-00152-00151-00132-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK500)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO DISPLAY A TABLE   */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    ISPEXEC DISPLAY PANEL(TRCK600)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        EXIT CODE(0)
      ENDO
    ISPEXEC VGET (INITB WEMM WEDD WEYY)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL NOSAVE
    ISPEXEC TBCLOSE &TBL +
      LIBRARY(TIMETRK)
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL NOWRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        SET &ZERRSM = &STR(NO ENTRIES FOR &TBL)
        SET &ZERRLM = &STR(USE OPTION 2 TO ADD ENTRIES)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        GOTO TOTDAY
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
        GOTO ABNEXIT
      ENDO
TOTDAY: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0
    SET &TDAY2 = 0
    SET &TDAY3 = 0
    SET &TDAY4 = 0
    SET &TDAY5 = 0
    SET &TDAY6 = 0
    SET &TDAY7 = 0
    SET &TTOT  = 0
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    GOTO TOTSKP
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBTOP &TBL
PANLLOOP: +
    SET &ZCMD = &STR( )
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK100) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN GOTO PANLEXIT
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &COLNAME = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&COLNAME) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&COLNAME) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
VARPPROC: +
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
PANLEXIT: +
    ISPEXEC TBEND &TBL
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCK600  0108-92077-93161-0743-00466-00289-00444-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK600)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO UPDATE A TABLE    */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
/*  CONTROL LIST MSG CONLIST SYMLIST
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    ISPEXEC DISPLAY PANEL(TRCK600)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        EXIT CODE(0)
      ENDO
    ISPEXEC VGET (INITB WEMM WEDD WEYY)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMAJ CDMIN DESC +
                DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT X) +
          REPLACE
        SET &USER = &SYSUID
        SET &CMD  = &STR()
        SET &CDMAJ = 1234
        SET &CDMIN = 1234
        SET &DESC = &STR(BRIEF WHAT YOU DID)
        SET &DAY1 = 0
        SET &DAY2 = 0
        SET &DAY3 = 0
        SET &DAY4 = 0
        SET &DAY5 = 0
        SET &DAY6 = 0
        SET &DAY7 = 0
        SET &TOT = 0
        SET &X = &STR()
        ISPEXEC TBADD &TBL
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &ORIGROW = &RUPDNAME
        IF (&RCURNAME = 0) THEN +
          DO
            SET &USER = &SYSUID
            SET &CMD  = &STR()
            SET &CDMAJ = 1234
            SET &CDMIN = 1234
            SET &DESC = &STR(BRIEF WHAT YOU DID)
            SET &DAY1 = 0
            SET &DAY2 = 0
            SET &DAY3 = 0
            SET &DAY4 = 0
            SET &DAY5 = 0
            SET &DAY6 = 0
            SET &DAY7 = 0
            SET &TOT = 0
            SET &X = &STR()
            ISPEXEC TBADD &TBL
          ENDO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0.0
    SET &TDAY2 = 0.0
    SET &TDAY3 = 0.0
    SET &TDAY4 = 0.0
    SET &TDAY5 = 0.0
    SET &TDAY6 = 0.0
    SET &TDAY7 = 0.0
    SET &TTOT  = 0.0
CLCSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO CLCEND
      ENDO
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    GOTO CLCSKP
/* **************************************************************
/*       END OF RECALCULATION
/* **************************************************************
CLCEND: +
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &EXITCC = NO
    SET &TBLCHG = NO
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN GOTO PANLEXIT
    SET &EXITCC = NO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK200) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SAVE) THEN +
      DO
        ISPEXEC TBSAVE &TBL
      ENDO
    IF (&NRSTR(&FIELDA) = CALC)   OR +
       (&NRSTR(&FIELDA) = SAVE) THEN +
      DO
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0.0
    SET &TDAY2 = 0.0
    SET &TDAY3 = 0.0
    SET &TDAY4 = 0.0
    SET &TDAY5 = 0.0
    SET &TDAY6 = 0.0
    SET &TDAY7 = 0.0
    SET &TTOT  = 0.0
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO TOTEND
      ENDO
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    GOTO TOTSKP
/* **************************************************************
/*       END OF RECALCULATION
/* **************************************************************
TOTEND: +
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        ISPEXEC TBSORT &TBL +
            FIELDS(CDMAJ,C,A,CDMIN,C,A,DESC,C,A)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCK200 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    IF (&NRSTR(&PRICMD) = I) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &TBLCHG = YES
        ISPEXEC CONTROL DISPLAY SAVE
        %TRCK201
        ISPEXEC CONTROL DISPLAY RESTORE
        SET &CMD = &STR()
        SET &PRICMD = &STR()
        ISPEXEC VGET (ADDOK) SHARED
        IF (&ADDOK = YES) THEN +
          DO
            ISPEXEC VGET (CDMAJ CDMIN DESC TOT X) SHARED
            ISPEXEC VGET (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7) SHARED
            ISPEXEC TBADD &TBL
          ENDO
      ENDO
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = D) × (&NRSTR(&CMD) = DE) THEN +
        GOTO LOOPDE
      SET &INSERT = NO
      IF (&NRSTR(&CMD) = I) × (&NRSTR(&CMD) = IN) THEN +
        SET &INSERT = YES
      SET &REPEAT = NO
      IF (&NRSTR(&CMD) = R) × (&NRSTR(&CMD) = RE) THEN +
        SET &REPEAT = YES
UPDATE: +
      IF (&STR(&CDMIN) = ) THEN +
        DO
          SET &ZERRSM = &STR(MINOR CODE REQUIRED)
          SET &ZERRLM = &STR(YOU REALLY HAVE TO ENTER A MINOR CODE)
          SET &ZERRHM = &STR(*)
          SET &ZERRALRM = &STR(YES)
          ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
          ISPEXEC SETMSG MSG(ISRZ002)
          SET &ZTDSELS = 0
          SET &CURS = CDMIN
          GOTO NEXTSEL
        ENDO
      SET &CMD  = &STR()
      ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7) SHARED
      %TRCKADD
      ISPEXEC VGET (TOT) SHARED
      ISPEXEC TBPUT &TBL
      IF (&REPEAT = YES) THEN +
        GOTO LOOPRE
      IF (&INSERT = YES) THEN +
        GOTO LOOPIN
      SET &TBLCHG = YES
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
LOOPDE: +
    SET &TBLCHG = YES
    ISPEXEC TBDELETE &TBL
    SET &CRP = &CRP - 1
    ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                        UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                        USER(USERNAME)     ROWCREAT(RCRTNAME) +
                        ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                        TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                        RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                        STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                        LIBRARY(LIBNAME)
    IF (&RCURNAME = 0) THEN +
      DO
        SET &USER = &SYSUID
        SET &CMD  = &STR()
        SET &CDMAJ = 1234
        SET &CDMIN = 1234
        SET &DESC = &STR(BRIEF WHAT YOU DID)
        SET &DAY1 = 0
        SET &DAY2 = 0
        SET &DAY3 = 0
        SET &DAY4 = 0
        SET &DAY5 = 0
        SET &DAY6 = 0
        SET &DAY7 = 0
        SET &TOT = 0
        SET &X = &STR()
        ISPEXEC TBADD &TBL
        SET &CRP = 1
      ENDO
    GOTO NEXTSEL
LOOPIN: +
    %TRCK201
    SET &CMD = &STR()
    ISPEXEC VGET (ADDOK) SHARED
    IF (&ADDOK NE YES) THEN +
      GOTO NEXTSEL
    ISPEXEC VGET (CDMAJ CDMIN DESC TOT X) SHARED
    ISPEXEC VGET (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7) SHARED
    ISPEXEC TBADD &TBL
    GOTO NEXTSEL
LOOPRE: +
    SET &CMD = &STR()
    ISPEXEC TBADD &TBL
    GOTO NEXTSEL
PANLEXIT: +
    ISPEXEC TBTOP &TBL
CLNUP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      GOTO EXITCODE
    IF (&NRSTR(&CDMAJ) = ) AND +
       (&NRSTR(&CDMIN) = ) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&CDMIN) = &STR(?) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&DESC) = &STR(BRIEF WHAT YOU DID)) AND +
       (&NRSTR(&CDMAJ) = 1234) AND +
       (&NRSTR(&CDMIN) = 1234) THEN +
       ISPEXEC TBDELETE &TBL
    GOTO CLNUP
EXITCODE: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    IF (&TRACE = TRACE) THEN +
      WRITE TBSTATS &TBL    CDATE(&CDATNAME)    CTIME(&CTIMNAME)    +
                            UDATE(&UDATNAME)    UTIME(&UTIMNAME)    +
                            USER(&USERNAME)     ROWCREAT(&RCRTNAME) +
                            ROWCURR(&RCURNAME)  ROWUPD(&RUPDNAME)   +
                            TABLEUPD(&TUPDNAME) SERVICE(&SERVNAME)  +
                            RETCODE(&RETCNAME)  STATUS1(&STA1NAME)  +
                            STATUS2(&STA2NAME)  STATUS3(&STA3NAME)  +
                            LIBRARY(&LIBNAME)
/*
/*   TABLENAM - NAME OF THE TABLE FOR WHICH STATISTICAL INFORMATION IS
/*              TO BE OBTAINED
/*   CDATNAME - OPTIONAL, VARIABLE NAME WHERE TABLE CREATION DATE IS
/*              TO BE STORED.
/*   CTIMNAME - OPTIONAL, VARIABLE NAME WHERE TABLE CREATION TIME IS
/*              TO BE STORED.
/*   UDATNAME - OPTIONAL, VARIABLE NAME WHERE THE DATE THE TABLE WAS
/*              LAST UPDATED IS STORED.
/*   UTIMNAME - OPTIONAL, VARIABLE NAME WHERE THE TIME THE TABLE WAS
/*              LAST UPDATED IS STORED.
/*   USERNAME - OPTIONAL, VARIABLE NAME WHERE THE USERID OF THE USER
/*              THAT CREATED OR LAST UPDATED THE TABLE IS TO BE STORED.
/*   RCRTNAME - OPTIONAL, VARIABLE NAME WHERE THE NUMBER OF ROWS THAT
/*              EXISTED AT THE END OF THE "CREATE PROCESS" IS TO BE
/*              STORED.
/*   RCURNAME - OPTIONAL, VARIABLE NAME WHERE THE CURRENT NUMBER OF
/*              ROWS CONTAINED IN THE TABLE IS TO BE STORED.
/*   RUPDNAME - OPTIONAL, VARIABLE NAME WHERE THE NUMBER OF UPDATED
/*              ROWS IS STORED.
/*   TUPDNAME - OPTIONAL, VARIABLE NAME WHERE THE NUMBER OF TIMES THE
/*              TABLE HAS BEEN UPDATED IS STORED.
/*   SERVNAME - OPTIONAL, VARIABLE NAME WHERE THE NAME OF THE LAST
/*              TABLE SERVICES COMMAND FOR THIS TABLE IS TO BE STORED.
/*   RETCNAME - OPTIONAL, VARIABLE NAME WHERE THE RETURN CODE
/*              ASSOCIATED WITH THE LAST TABLE SERVICES COMMAND ISSUED
/*              FOR THIS TABLE IS TO BE STORED.
/*   STA1NAME - OPTIONAL, VARIABLE NAME WHERE THE STATUS OF THE TABLE
/*              IN THE TABLE INPUT LIBRARY CHAIN IS STORED.
/*   STA2NAME - OPTIONAL, VARIABLE NAME WHERE THE STATUS OF THE TABLE
/*              IN THIS LOGICAL SCREEN IS STORED.
/*   STA3NAME - OPTIONAL, VARIABLE NAME WHERE THE AVAILABILITY OF THE
/*              TABLE TO BE USED IN WRITE MODE IS TO BE STORED.
/*   LIBNAME  - OPTIONAL, SPECIFIES AN ALTERNATE INPUT LIBRARY NAME.
/*              DEFAULT IS ISPTLIB.
/*
    IF (&TBLCHG = YES) THEN +
      DO
        ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A,CDMIN,C,A,DESC,C,A)
        ISPEXEC TBCLOSE &TBL +
          LIBRARY(TIMETRK)
        SET &MYCC = &LASTCC
        IF (&MYCC NE 0) THEN +
          DO
            SET &ZERRSM = &STR(TABLE NOT SAVED)
            SET &ZERRLM = &STR(TABLE &TBL HAD ERRORS RC=&MYCC)
            ISPEXEC SETMSG MSG(ISRZ002)
          ENDO
        ELSE +
          DO
/*  CONTROL LIST MSG CONLIST SYMLIST
          GETSYSID
          SET &MC = 7
          IF (&SYSID = DOFD) OR +
             (&SYSID = DOFP) OR +
             (&SYSID = DOFX) THEN +
             SET &MC = Z
          ISPEXEC VPUT (MC) SHARED
          ISPEXEC CONTROL ERRORS RETURN
          ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
          ISPEXEC VPUT (WHOITBE WEMM WEDD WEYY PGMR)
          ISPEXEC  FTOPEN TEMP
          ISPEXEC  FTINCL TRCK600
          ISPEXEC  FTCLOSE
          ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
          SUBMIT '&ZTEMPF' NOHOLD
/*                                                                 */
          SET &ZERRHM = &STR(*)
          SET &ZERRALRM = &STR(NO)
          SET &ZERRSM = &STR(MSG SUBMITTED)
          SET &ZERRLM = &STR(IT IS BEING ROUTED TO VM)
          ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
          ISPEXEC SETMSG MSG(ISRZ002)
        ENDO
      ENDO
    ELSE +
      DO
        ISPEXEC TBEND &TBL
        SET &MYCC = &LASTCC
      ENDO
    EXIT CODE(0)
./ ADD NAME=TRCK700  0117-92077-93229-0931-00143-00129-00123-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK700)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO READ   A TABLE    */
/*      OF TIME TRACKING HOURS AND SUBMIT A SCRIPT JOB.            */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
/*  CONTROL LIST MSG CONLIST SYMLIST
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR WEEKDATE)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    ISPEXEC DISPLAY PANEL(TRCK600)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        EXIT CODE(0)
      ENDO
    ISPEXEC VGET (INITB WEMM WEDD WEYY PGMR)
    SET &INITB = &SUBSTR(1:3,&INITB)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMAJ CDMIN DESC +
                DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT X) +
          REPLACE
        SET &ZERRSM = &STR(&TBL CREATED)
        SET &ZERRLM = &STR(TABLE DID NOT EXIST, NO ENTRIES)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO PANLLOOP
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)  CTIME(CTIMNAME)    +
                          UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                          USER(USERNAME)     ROWCREAT(RCRTNAME) +
                          ROWCURR(RCURNAME)
        IF (&RCURNAME = 0) THEN +
          DO
            SET &ZERRSM = &STR(EMPTY &TBL)
            SET &ZERRLM = &STR(USE OPTION 2 TO ADD ENTRIES)
            SET &ZERRHM = &STR(*)
            SET &ZERRALRM = &STR(NO)
            ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
            ISPEXEC SETMSG MSG(ISRZ002)
            GOTO PANLLOOP
          ENDO
        GOTO PANLLOOP
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       PANLLOOP TABLE
/* **************************************************************
PANLLOOP: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0
    SET &TDAY2 = 0
    SET &TDAY3 = 0
    SET &TDAY4 = 0
    SET &TDAY5 = 0
    SET &TDAY6 = 0
    SET &TDAY7 = 0
    SET &TTOT  = 0
    SET &ENTRIES = 1
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    IF (&TOT = 0) THEN +
       ISPEXEC TBDELETE &TBL
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    SET &ENTRIES = &ENTRIES + 1
    GOTO TOTSKP
DISPLAY: +
    ISPEXEC TBBOTTOM &TBL
    SET &CDMAJ =
    SET &CDMIN =
    SET &DESC  = &STR( )
    SET &DAY1  =
    SET &DAY2  =
    SET &DAY3  =
    SET &DAY4  =
    SET &DAY5  =
    SET &DAY6  =
    SET &DAY7  =
    SET &TOT   =
    SET &X     =
    DO WHILE &EVAL(&ENTRIES // 26) NE 0
      ISPEXEC TBADD &TBL
      SET &ENTRIES = &ENTRIES + 1
    ENDO
    FREE FILE(ISPFILE)
    DELETE '&SYSUID..TIME.TRACK.&TBL'
    ALLOC FILE(ISPFILE) DATASET('&SYSUID..TIME.TRACK.&TBL') +
      RECFM(F B) BLKSIZE(3120) LRECL(80) +
      NEW CATALOG UNIT(SYSDA) +
      SPACE(1 5) TRACKS
    ISPEXEC  VPUT (TBL) SHARED
    ISPEXEC  FTOPEN
    ISPEXEC  FTINCL TRCKSCRP
    ISPEXEC  FTCLOSE
    FREE FILE(ISPFILE)
    ISPEXEC  FTOPEN TEMP
    ISPEXEC  FTINCL TRCK700
    ISPEXEC  FTCLOSE
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
EXITCODE: +
    ISPEXEC TBEND &TBL
    EXIT CODE(0)
./ ADD NAME=TRCK710  0103-93200-93229-0931-00143-00141-00004-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK710)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO READ   A TABLE    */
/*      OF TIME TRACKING HOURS AND SUBMIT A SCRIPT JOB.            */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
/*  CONTROL LIST MSG CONLIST SYMLIST
    SET &WHOITBE = &SYSUID
    ISPEXEC VGET (WHOITBE WEMM WEDD WEYY)
    SET &WEEKEND = &STR(&WEMM./&WEDD./&WEYY)
    ISPEXEC VPUT (WEEKEND)
    %TRCKWEEK
    ISPEXEC VGET (WEYR WEEKDATE)
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    ISPEXEC DISPLAY PANEL(TRCK600)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        EXIT CODE(0)
      ENDO
    ISPEXEC VGET (INITB WEMM WEDD WEYY PGMR)
    SET &INITB = &SUBSTR(1:3,&INITB)
    SET &TBL = X&INITB.&WEYY.&WEYR
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMAJ CDMIN DESC +
                DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT X) +
          REPLACE
        SET &ZERRSM = &STR(&TBL CREATED)
        SET &ZERRLM = &STR(TABLE DID NOT EXIST, NO ENTRIES)
        SET &ZERRHM = &STR(*)
        SET &ZERRALRM = &STR(NO)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO PANLLOOP
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)  CTIME(CTIMNAME)    +
                          UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                          USER(USERNAME)     ROWCREAT(RCRTNAME) +
                          ROWCURR(RCURNAME)
        IF (&RCURNAME = 0) THEN +
          DO
            SET &ZERRSM = &STR(EMPTY &TBL)
            SET &ZERRLM = &STR(USE OPTION 2 TO ADD ENTRIES)
            SET &ZERRHM = &STR(*)
            SET &ZERRALRM = &STR(NO)
            ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
            ISPEXEC SETMSG MSG(ISRZ002)
            GOTO PANLLOOP
          ENDO
        GOTO PANLLOOP
      ENDO
    ELSE +
      DO
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       PANLLOOP TABLE
/* **************************************************************
PANLLOOP: +
    ISPEXEC TBTOP &TBL
    SET &TDAY1 = 0
    SET &TDAY2 = 0
    SET &TDAY3 = 0
    SET &TDAY4 = 0
    SET &TDAY5 = 0
    SET &TDAY6 = 0
    SET &TDAY7 = 0
    SET &TTOT  = 0
    SET &ENTRIES = 1
TOTSKP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        GOTO DISPLAY
      ENDO
    IF (&TOT = 0) THEN +
       ISPEXEC TBDELETE &TBL
    ISPEXEC VPUT (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    ISPEXEC VPUT (DAY1 DAY2 DAY3 DAY4 DAY5 DAY6 DAY7 TOT)
    %TRCKTOT
    ISPEXEC VGET (TDAY1 TDAY2 TDAY3 TDAY4 TDAY5 TDAY6 TDAY7 TTOT)
    SET &ENTRIES = &ENTRIES + 1
    GOTO TOTSKP
DISPLAY: +
    ISPEXEC TBBOTTOM &TBL
    SET &CDMAJ =
    SET &CDMIN =
    SET &DESC  = &STR( )
    SET &DAY1  =
    SET &DAY2  =
    SET &DAY3  =
    SET &DAY4  =
    SET &DAY5  =
    SET &DAY6  =
    SET &DAY7  =
    SET &TOT   =
    SET &X     =
    DO WHILE &EVAL(&ENTRIES // 21) NE 0
      ISPEXEC TBADD &TBL
      SET &ENTRIES = &ENTRIES + 1
    ENDO
    FREE FILE(ISPFILE)
    DELETE '&SYSUID..TIME.TRACK.&TBL'
    ALLOC FILE(ISPFILE) DATASET('&SYSUID..TIME.TRACK.&TBL') +
      RECFM(F B) BLKSIZE(3120) LRECL(80) +
      NEW CATALOG UNIT(SYSDA) +
      SPACE(1 5) TRACKS
    ISPEXEC  VPUT (TBL) SHARED
    ISPEXEC  FTOPEN
    ISPEXEC  FTINCL TRCKSCRL
    ISPEXEC  FTCLOSE
    FREE FILE(ISPFILE)
    ISPEXEC  FTOPEN TEMP
    ISPEXEC  FTINCL TRCK710
    ISPEXEC  FTCLOSE
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    ISPEXEC CONTROL DISPLAY SM START(13)
    CONTROL MSG
    SUBMIT '&ZTEMPF' NOHOLD
    CONTROL NOMSG
EXITCODE: +
    ISPEXEC TBEND &TBL
    EXIT CODE(0)
./ ADD NAME=TRCK800  0113-92080-93161-0741-00279-00272-00072-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK800)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO UPDATE A TABLE    */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XCDMAJ
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMAJ DESC TGT RESP) +
          REPLACE
        SET &CMD  = &STR()
        SET &CDMAJ = 1234
        SET &DESC = &STR(WHAT IS THE PROJECT)
        SET &TGT = &STR(&SYSDATE)
        SET &RESP = &STR(???/???)
        ISPEXEC TBADD &TBL
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &ORIGROW = &RUPDNAME
        IF (&RCURNAME = 0) THEN +
          DO
            SET &CMD  = &STR()
            SET &CDMAJ = 1234
            SET &DESC = &STR(WHAT IS THE PROJECT)
            ISPEXEC TBADD &TBL
          ENDO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A)
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &EXITCC = NO
    SET &TBLCHG = NO
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN GOTO PANLEXIT
    SET &EXITCC = NO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK800) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = CANCEL) THEN +
      DO
        ISPEXEC TBEND &TBL
        EXIT CODE(0)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SAVE) THEN +
      DO
        ISPEXEC TBSAVE &TBL
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        SET &SORTFLD = &NRSTR(&FIELDB)
        SET &SORTORD = A
        ISPEXEC TBSORT &TBL +
            FIELDS(&SORTFLD,C,&SORTORD)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCK800 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    IF (&NRSTR(&PRICMD) = I) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &TBLCHG = YES
        SET &PRICMD = &STR()
        SET &CMD = &STR()
        SET &CDMAJ = PROJID
        SET &DESC = &STR()
        SET &TGT = &STR(MM-DD-YY)
        SET &RESP = &STR(????)
        ISPEXEC TBADD &TBL
      ENDO
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = I) × (&NRSTR(&CMD) = IN) THEN +
        GOTO LOOPIN
      IF (&NRSTR(&CMD) = D) × (&NRSTR(&CMD) = DE) THEN +
        GOTO LOOPDE
UPDATE: +
      IF (&STR(&CDMAJ) = ) THEN +
        DO
          SET &ZERRSM = &STR(MAJOR CODE REQUIRED)
          SET &ZERRLM = &STR(YOU REALLY HAVE TO ENTER A MAJOR CODE)
          SET &ZERRHM = &STR(*)
          SET &ZERRALRM = &STR(YES)
          ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
          ISPEXEC SETMSG MSG(ISRZ002)
          SET &ZTDSELS = 0
          SET &CURS = CDMAJ
          GOTO NEXTSEL
        ENDO
      SET &CMD  = &STR()
      ISPEXEC TBPUT &TBL
      SET &TBLCHG = YES
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
LOOPIN: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    SET &TBLCHG = YES
    SET &CMD = &STR()
    SET &CDMAJ = PROJID
    SET &DESC = &STR()
    SET &TGT = &STR(MM-DD-YY)
    SET &RESP = &STR(????)
    ISPEXEC TBADD &TBL
    GOTO NEXTSEL
LOOPDE: +
    ISPEXEC TBDELETE &TBL
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    SET &TBLCHG = YES
    IF (&RCURNAME = 0) THEN GOTO LOOPIN
    GOTO NEXTSEL
PANLEXIT: +
    ISPEXEC TBTOP &TBL
CLNUP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      GOTO EXITCODE
    IF (&NRSTR(&CDMAJ) = ) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&DESC) = &STR(WHAT IS THE PROJECT)) THEN +
       ISPEXEC TBDELETE &TBL
    GOTO CLNUP
EXITCODE: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    IF (&TBLCHG = YES) THEN +
      DO
        ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A)
        ISPEXEC TBCLOSE &TBL +
          LIBRARY(TIMETRK)
        SET &MYCC = &LASTCC
        IF (&MYCC NE 0) THEN +
          DO
            SET &ZERRSM = &STR(TABLE NOT SAVED)
            SET &ZERRLM = &STR(TABLE &TBL HAD ERRORS RC=&MYCC)
            ISPEXEC SETMSG MSG(ISRZ002)
          ENDO
      ENDO
    ELSE +
      DO
        ISPEXEC TBEND &TBL
        SET &MYCC = &LASTCC
      ENDO
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCK802  0105-92101-93146-0904-00091-00089-00005-KETCSC
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK802)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO UPDATE A TABLE    */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XCDMAJ
    ISPEXEC VPUT (TBL)
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        EXIT CODE(16)
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &ORIGROW = &RUPDNAME
        IF (&RCURNAME = 0) THEN +
          DO
            SET &ZERRHM = &STR(*)
            SET &ZERRALRM = &STR(NO)
            SET &ZERRSM = &STR(TABLE IS EMPTY)
            SET &ZERRLM = &STR(THE TABLE &TBL IS EMPTY)
            ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
            ISPEXEC SETMSG MSG(ISRZ002)
            GOTO ABNEXIT
          ENDO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBSORT &TBL FIELDS(CDMAJ,C,A)
    ISPEXEC TBTOP &TBL
    GETSYSID
    SET &MC = 7
    IF (&SYSID = DOFD) OR +
       (&SYSID = DOFP) OR +
       (&SYSID = DOFX) THEN +
       SET &MC = Z
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VPUT (MC) SHARED
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    ISPEXEC  FTOPEN TEMP
    ISPEXEC  FTINCL TRCK802
    ISPEXEC  FTCLOSE
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    SUBMIT '&ZTEMPF' NOHOLD
/*                                                                 */
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(JOB SUBMITTED)         /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(IT IS BEING ROUTED TO VM)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
/*                                                                 */
EXITCODE: +
    ISPEXEC TBEND &TBL
    SET &MYCC = &LASTCC
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCK900  0108-92080-92087-1204-00273-00242-00273-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK900)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO UPDATE A TABLE    */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XCDMIN
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        ISPEXEC TBCREATE &TBL +
          LIBRARY(TIMETRK) +
          NAMES(USER CMD CDMIN DESC) +
          REPLACE
        SET &CMD  = &STR()
        SET &CDMIN = 1234
        SET &DESC = &STR(WHAT IS THE TASK)
        ISPEXEC TBADD &TBL
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &ORIGROW = &RUPDNAME
        IF (&RCURNAME = 0) THEN +
          DO
            SET &CMD  = &STR()
            SET &CDMIN = 1234
            SET &DESC = &STR(WHAT IS THE TASK)
            ISPEXEC TBADD &TBL
          ENDO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
        ISPEXEC TBSORT &TBL FIELDS(CDMIN,C,A,DESC,C,A)
    ISPEXEC TBTOP &TBL
    SET &CURS = ZCMD
    SET &EXITCC = NO
    SET &TBLCHG = NO
PANLLOOP: +
    SET &ZCMD = &STR( )
    IF (&EXITCC = YES) THEN GOTO PANLEXIT
    SET &EXITCC = NO
    ISPEXEC TBDISPL &TBL +
        PANEL(TRCK900) CURSOR(&CURS) +
        AUTOSEL(NO)
    SET &DISPCC = &LASTCC
    IF (&DISPCC > 7) THEN SET &EXITCC = YES
    SET &MYTOP = 0
FIXDPROC: +
    SET &SYSDVAL = &NRSTR(&ZCMD)
    READDVAL FIELDA FIELDB FIELDC
    IF (&NRSTR(&FIELDA) = ) THEN +
      DO
        GOTO VARPPROC
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = CANCEL) THEN +
      DO
        ISPEXEC TBEND &TBL
        EXIT CODE(0)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SAVE) THEN +
      DO
        ISPEXEC TBSAVE &TBL
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = SORT) THEN +
      DO
        SET &SORTFLD = &NRSTR(&FIELDB)
        SET &SORTORD = A
        ISPEXEC TBSORT &TBL +
            FIELDS(&SORTFLD,C,&SORTORD)
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = F) × (&NRSTR(&FIELDA) = L) THEN +
      DO
        ISPEXEC TBTOP &TBL
        ISPEXEC TBVCLEAR &TBL
        SET &MEMBR = &NRSTR(&FIELDB.*)
        ISPEXEC TBSARG &TBL
        ISPEXEC TBSCAN &TBL +
          CONDLIST(GE) POSITION(MYTOP)
        SET &MYCC = &LASTCC
        IF (&MYCC > 4) THEN +
          DO
            ISPEXEC TBTOP &TBL
SELFSCAN: +
            ISPEXEC TBSKIP &TBL POSITION(MYTOP)
            SET &MYCC = &LASTCC
            IF (&MYCC > 0) THEN +
              DO
                GOTO SCANDONE
              ENDO
            IF (&NRSTR(&MEMBR) = &NRSTR(&FIELDB)) THEN +
              GOTO SCANDONE
            IF (&NRSTR(&MEMBR) > &NRSTR(&FIELDB)) THEN +
              DO
                SET &MYTOP = &MYTOP - 1
                GOTO SCANDONE
              ENDO
            GOTO SELFSCAN
SCANDONE: +
          ENDO
      ENDO
    ELSE +
    IF (&NRSTR(&FIELDA) = TRACE) THEN +
      DO
        IF (&NRSTR(&FIELDB) = OFF) THEN +
          DO
            CONTROL NOSYMLIST NOCONLIST NOLIST NOMSG
            SET &TRACE =
          ENDO
        ELSE +
          DO
            WRITE CLIST TRCK900 TRACE ON
            SET &TRACE = TRACE
            CONTROL SYMLIST CONLIST LIST MSG
          ENDO
      ENDO
VARPPROC: +
    IF (&NRSTR(&PRICMD) = I) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &TBLCHG = YES
        SET &PRICMD = &STR()
        SET &CMD = &STR()
        SET &CDMIN =
        SET &DESC = &STR()
        ISPEXEC TBADD &TBL
      ENDO
    SET &VARFLAG = ON
VARPROC: +
    DO WHILE &ZTDSELS > 0
      IF (&NRSTR(&CMD) = I) × (&NRSTR(&CMD) = IN) THEN +
        GOTO LOOPIN
      IF (&NRSTR(&CMD) = D) × (&NRSTR(&CMD) = DE) THEN +
        GOTO LOOPDE
UPDATE: +
      IF (&STR(&CDMIN) = ) THEN +
        DO
          SET &ZERRSM = &STR(MINOR CODE REQUIRED)
          SET &ZERRLM = &STR(YOU REALLY HAVE TO ENTER A MINOR CODE)
          SET &ZERRHM = &STR(*)
          SET &ZERRALRM = &STR(YES)
          ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
          ISPEXEC SETMSG MSG(ISRZ002)
          SET &ZTDSELS = 0
          SET &CURS = CDMIN
          GOTO NEXTSEL
        ENDO
      SET &CMD  = &STR()
      ISPEXEC TBPUT &TBL
      SET &TBLCHG = YES
NEXTSEL: +
      IF (&ZTDSELS > 1) THEN +
        DO
          ISPEXEC TBDISPL &TBL
        ENDO
      ELSE +
        DO
          SET &ZTDSELS = 0
        ENDO
    ENDO
    ISPEXEC TBTOP &TBL
    IF (&MYTOP = 0) THEN +
      SET &MYTOP = &ZTDTOP
    ISPEXEC TBSKIP &TBL NUMBER(&MYTOP)
    GOTO PANLLOOP
LOOPIN: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    SET &TBLCHG = YES
    SET &CMD = &STR()
    SET &CDMIN =
    SET &DESC = &STR()
    ISPEXEC TBADD &TBL
    GOTO NEXTSEL
LOOPDE: +
    ISPEXEC TBDELETE &TBL
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    SET &TBLCHG = YES
    IF (&RCURNAME = 0) THEN GOTO LOOPIN
    GOTO NEXTSEL
PANLEXIT: +
    ISPEXEC TBTOP &TBL
CLNUP: +
    ISPEXEC TBSKIP &TBL NUMBER(1)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      GOTO EXITCODE
    IF (&NRSTR(&CDMIN) = ) THEN +
       ISPEXEC TBDELETE &TBL
    IF (&NRSTR(&DESC) = &STR(WHAT IS THE TASK)) THEN +
       ISPEXEC TBDELETE &TBL
    GOTO CLNUP
EXITCODE: +
    ISPEXEC TBSTATS &TBL    CDATE(CDATNAME)    CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
    IF (&TBLCHG = YES) THEN +
      DO
        ISPEXEC TBSORT &TBL FIELDS(CDMIN,C,A,DESC,C,A)
        ISPEXEC TBCLOSE &TBL +
          LIBRARY(TIMETRK)
        SET &MYCC = &LASTCC
        IF (&MYCC NE 0) THEN +
          DO
            SET &ZERRSM = &STR(TABLE NOT SAVED)
            SET &ZERRLM = &STR(TABLE &TBL HAD ERRORS RC=&MYCC)
            ISPEXEC SETMSG MSG(ISRZ002)
          ENDO
      ENDO
    ELSE +
      DO
        ISPEXEC TBEND &TBL
        SET &MYCC = &LASTCC
      ENDO
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=TRCK902  0101-92101-92101-1518-00096-00091-00096-DMV0016
PROC 0
/*                                                                 */
/* LIB: CLIST(TRCK902)                                             */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES ISPF LIBRARY SERVICES TO UPDATE A TABLE    */
/*      OF TIME TRACKING HOURS.                                    */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    SET &TBL = XCDMIN
    ISPEXEC VPUT (TBL)
    ISPEXEC TBEND &TBL
    SET &TBLCTR = 0
    ISPEXEC TBOPEN &TBL WRITE LIBRARY(TIMETRK) SHARE
    SET &MYCC = &LASTCC
    IF (&MYCC = 8) THEN +
      DO
        EXIT CODE(16)
      ENDO
    ELSE +
    IF (&MYCC = 0) THEN +
      DO
        ISPEXEC TBSTATS &TBL CDATE(CDATNAME)   CTIME(CTIMNAME)    +
                            UDATE(UDATNAME)    UTIME(UTIMNAME)    +
                            USER(USERNAME)     ROWCREAT(RCRTNAME) +
                            ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   +
                            TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  +
                            RETCODE(RETCNAME)  STATUS1(STA1NAME)  +
                            STATUS2(STA2NAME)  STATUS3(STA3NAME)  +
                            LIBRARY(LIBNAME)
        SET &ORIGROW = &RUPDNAME
        IF (&RCURNAME = 0) THEN +
          DO
            SET &ZERRHM = &STR(*)
            SET &ZERRALRM = &STR(NO)
            SET &ZERRSM = &STR(TABLE IS EMPTY)
            SET &ZERRLM = &STR(THE TABLE &TBL IS EMPTY)
            ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
            ISPEXEC SETMSG MSG(ISRZ002)
            GOTO ABNEXIT
          ENDO
        GOTO DISPLAY
      ENDO
    ELSE +
      DO
        SET &ZERRHM = &STR(*)                 /*  ISPF HELP PANEL  */
        SET &ZERRALRM = &STR(NO)              /*  ALARM STATUS     */
        SET &ZERRSM = &STR(TABLE IN USE)
        SET &ZERRLM = &STR(THE TABLE &TBL IS IN USE RC=&MYCC)
        ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
        ISPEXEC SETMSG MSG(ISRZ002)
        GOTO ABNEXIT
      ENDO
/* **************************************************************
/*       DISPLAY TABLE
/* **************************************************************
DISPLAY: +
    ISPEXEC TBSORT &TBL FIELDS(CDMIN,C,A,DESC,C,A)
    ISPEXEC TBTOP &TBL
    GETSYSID
    SET &MC = 7
    SET &JC = V
    IF (&SYSID = DOFD) OR +
       (&SYSID = DOFP) OR +
       (&SYSID = DOFX) THEN +
       SET &MC = Z
    IF (&SYSID = DOFD) OR +
       (&SYSID = DOFP) OR +
       (&SYSID = DOFX) THEN +
       SET &JC = L
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC VPUT (MC JC) SHARED
    ALLOC FILE(TIMETRK) DATASET('XDBS.TIMETRCK.TABLES') SHR REUSE
    ISPEXEC  FTOPEN TEMP
    ISPEXEC  FTINCL TRCK902
    ISPEXEC  FTCLOSE
    ISPEXEC VGET ZTEMPF
/*                                                                 */
/* SUBMIT JCL                                                      */
/*                                                                 */
    SUBMIT '&ZTEMPF' NOHOLD
/*                                                                 */
    SET &ZERRHM = &STR(*)                     /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(NO)                  /*  ALARM STATUS     */
    SET &ZERRSM = &STR(JOB SUBMITTED)         /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR(IT IS BEING ROUTED TO VM)
    ISPEXEC VPUT (ZERRSM ZERRLM ZERRHM ZERRALRM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
/*                                                                 */
EXITCODE: +
    ISPEXEC TBEND &TBL
    SET &MYCC = &LASTCC
ABNEXIT: +
    EXIT CODE(0)
./ ADD NAME=USERCSP  0104-93078-93301-1057-00244-00244-00000-LAWCSC
/**********************************************************************/
/*   BECAUSE THIS IS COPYRIGHTED MATERIAL, I HAD TO LEAVE THIS OUT.   */
/**********************************************************************/
./ ADD NAME=USERCSP2
/**********************************************************************/
/*   BECAUSE THIS IS COPYRIGHTED MATERIAL, I HAD TO LEAVE THIS OUT.   */
/**********************************************************************/
./ ADD NAME=V23INST  0110-92154-92160-1339-00019-00020-00000-BORGY
PROC 0
/******************
/* THIS CLIST MAKES THE LIBRARIES AVAILABLE TO TSO, NEEDED TO RUN
/* THE DSNTINST AND THEN EXECUTES THE INSTALL CLIST(DSNTINST).
/******************
/*  CONTROL NOLIST NOFLUSH NOMSG
    CONTROL LIST MSG CONLIST SYMLIST
/*
   PROFILE WTP MSGID
/*
   ALTLIB ACTIVATE APPLICATION(CLIST) +
       DATASET('DB2M.DSNCLIST')
/*
   ISPEXEC LIBDEF ISPPLIB DATASET ID('XDBS.V2R3.TARGET.DSNSPFP')
   ISPEXEC LIBDEF ISPMLIB DATASET ID('XDBS.V2R3.TARGET.DSNSPFM')
/*
   ISPEXEC SELECT CMD(DSNTINST)
/*
EXIT
./ ADD NAME=V23ISPF  0111-92164-92167-1115-00026-00019-00000-BORGY
PROC 0
/******************
/* THIS CLIST MAKES THE LIBRARIES AVAILABLE TO TSO, NEEDED TO RUN
/* THE ISPF SAMPLE APPLICATION
/******************
/*  CONTROL NOLIST NOFLUSH NOMSG
    CONTROL LIST MSG CONLIST SYMLIST
/*
   PROFILE WTP MSGID
/*
   ALTLIB ACTIVATE APPLICATION(CLIST) +
       DATASET('DB2M.DSNCLIST')
/*
   ALLOC F(SYSPRINT) SYSOUT(V) REUSE
/*
   ISPEXEC LIBDEF ISPPLIB DATASET ID('DB2M.DSNSPFP')
   ISPEXEC LIBDEF ISPMLIB DATASET ID('DB2M.DSNSPFM')
   ISPEXEC LIBDEF ISPLLIB DATASET ID('SYS1.COB2LIB', +
                                     'PLI.V2R2M0.PLILINK', +
                                     'PLI.V2R2M0.SIBMLINK', +
                                     'DB2M.DSNEXIT','DB2M.DSNLOAD', +
                                     'DB2M.RUNLIB.LOAD')
/*
   CALL 'DB2M.RUNLIB.LOAD(DSN8SCM)'
/*
EXIT
./ ADD NAME=WHO      0100-92194-92194-1119-00002-00002-00000-DD20008
PROC 0
WRITE &SYSUID ON &SYSPROC..
./ ADD NAME=WTCOCHGS 0103-93134-93135-2218-00054-00052-00010-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
    ISREDIT C 'U828' 'C828' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KWTUN'  '2KWTCO' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KUNIT'  '2KWTCO' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'WECDWTUN'  'WECDWTCO' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'PLAN(P3'  'PLAN(P2' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '10DB2MXP' '10DB2FSG' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    IF (&SAVEIT = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTCOTSNM 0100-93137-93137-0825-00371-00371-00000-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
  ISREDIT C 'DDSDTSZA' +
      'C828TSZA' ALL
  ISREDIT C 'DDSDTSZB' +
      'C828TSZB' ALL
  ISREDIT C 'DDSDTSZC' +
      'C828TSZC' ALL
  ISREDIT C 'DDSDTSZD' +
      'C828TSZD' ALL
  ISREDIT C 'DDSDTSZE' +
      'C828TSZE' ALL
  ISREDIT C 'DDSDTSZF' +
      'C828TSZF' ALL
  ISREDIT C 'DDSDTSZG' +
      'C828TSZG' ALL
  ISREDIT C 'DDSDTSZH' +
      'C828TSZH' ALL
  ISREDIT C 'DDSDTSZI' +
      'C828TSZI' ALL
  ISREDIT C 'DDSDTSZJ' +
      'C828TSZJ' ALL
  ISREDIT C 'DDSDTSZK' +
      'C828TSZK' ALL
  ISREDIT C 'DDSDTSZL' +
      'C828TSZL' ALL
  ISREDIT C 'DDSDTSZM' +
      'C828TSZM' ALL
  ISREDIT C 'DDSDTSZN' +
      'C828TSZN' ALL
  ISREDIT C 'DDSDTSZO' +
      'C828TSZO' ALL
  ISREDIT C 'DDSDTSZP' +
      'C828TSZP' ALL
  ISREDIT C 'DDSDTSZQ' +
      'C828TSZQ' ALL
  ISREDIT C 'DDSDTSZR' +
      'C828TSZR' ALL
  ISREDIT C 'DDSDTSZS' +
      'C828TSZS' ALL
  ISREDIT C 'DDSDTSZT' +
      'C828TSZT' ALL
  ISREDIT C 'DDSDTSZU' +
      'C828TSZU' ALL
  ISREDIT C 'DDSDTSZV' +
      'C828TSZV' ALL
  ISREDIT C 'DDSDTSZW' +
      'C828TSZW' ALL
  ISREDIT C 'DDSDTSZX' +
      'C828TSZX' ALL
  ISREDIT C 'DDSDTSZY' +
      'C828TSZY' ALL
  ISREDIT C 'DDSDTSZZ' +
      'C828TSZZ' ALL
  ISREDIT C 'DDSDTSZ1' +
      'C828TSZ1' ALL
  ISREDIT C 'DDSDTSZ2' +
      'C828TSZ2' ALL
  ISREDIT C 'DDSDTSZ8' +
      'C828TSZ8' ALL
  ISREDIT C 'DDSDTSZ9' +
      'C828TSZ9' ALL
  ISREDIT C 'CSSTSM01' +
      'C828TS01' ALL
  ISREDIT C 'CSSTSM02' +
      'C828TS02' ALL
  ISREDIT C 'CSSTSSAC' +
      'C828TSAC' ALL
  ISREDIT C 'CSSTSSAD' +
      'C828TSAD' ALL
  ISREDIT C 'CSSTSSAP' +
      'C828TSAP' ALL
  ISREDIT C 'CSSTSSAR' +
      'C828TSAR' ALL
  ISREDIT C 'CSSTSSAT' +
      'C828TSAT' ALL
  ISREDIT C 'CSSTSSAY' +
      'C828TSAY' ALL
  ISREDIT C 'CSSTSSBA' +
      'C828TSBA' ALL
  ISREDIT C 'CSSTSSBC' +
      'C828TSBC' ALL
  ISREDIT C 'CSSTSSBD' +
      'C828TSBD' ALL
  ISREDIT C 'CSSTSSBE' +
      'C828TSBE' ALL
  ISREDIT C 'CSSTSSBG' +
      'C828TSBG' ALL
  ISREDIT C 'CSSTSSBH' +
      'C828TSBH' ALL
  ISREDIT C 'CSSTSSBI' +
      'C828TSBI' ALL
  ISREDIT C 'CSSTSSBJ' +
      'C828TSBJ' ALL
  ISREDIT C 'CSSTSSBL' +
      'C828TSBL' ALL
  ISREDIT C 'CSSTSSBM' +
      'C828TSBM' ALL
  ISREDIT C 'CSSTSSBN' +
      'C828TSBN' ALL
  ISREDIT C 'CSSTSSBT' +
      'C828TSBT' ALL
  ISREDIT C 'CSSTSSBU' +
      'C828TSBU' ALL
  ISREDIT C 'CSSTSSBW' +
      'C828TSBW' ALL
  ISREDIT C 'CSSTSSBX' +
      'C828TSBX' ALL
  ISREDIT C 'CSSTSSBY' +
      'C828TSBY' ALL
  ISREDIT C 'CSSTSSCA' +
      'C828TSCA' ALL
  ISREDIT C 'CSSTSSCC' +
      'C828TSCC' ALL
  ISREDIT C 'CSSTSSCD' +
      'C828TSCD' ALL
  ISREDIT C 'CSSTSSCE' +
      'C828TSCE' ALL
  ISREDIT C 'CSSTSSCH' +
      'C828TSCH' ALL
  ISREDIT C 'CSSTSSCI' +
      'C828TSCI' ALL
  ISREDIT C 'CSSTSSCJ' +
      'C828TSCJ' ALL
  ISREDIT C 'CSSTSSCL' +
      'C828TSCL' ALL
  ISREDIT C 'CSSTSSCN' +
      'C828TSCN' ALL
  ISREDIT C 'CSSTSSCO' +
      'C828TSCO' ALL
  ISREDIT C 'CSSTSSCP' +
      'C828TSCP' ALL
  ISREDIT C 'CSSTSSCS' +
      'C828TSCS' ALL
  ISREDIT C 'CSSTSSCT' +
      'C828TSCT' ALL
  ISREDIT C 'CSSTSSCU' +
      'C828TSCU' ALL
  ISREDIT C 'CSSTSSCX' +
      'C828TSCX' ALL
  ISREDIT C 'CSSTSSCY' +
      'C828TSCY' ALL
  ISREDIT C 'CSSTSSDA' +
      'C828TSDA' ALL
  ISREDIT C 'CSSTSSDC' +
      'C828TSDC' ALL
  ISREDIT C 'CSSTSSDD' +
      'C828TSDD' ALL
  ISREDIT C 'CSSTSSDF' +
      'C828TSDF' ALL
  ISREDIT C 'CSSTSSDH' +
      'C828TSDH' ALL
  ISREDIT C 'CSSTSSDI' +
      'C828TSDI' ALL
  ISREDIT C 'CSSTSSDO' +
      'C828TSDO' ALL
  ISREDIT C 'CSSTSSDR' +
      'C828TSDR' ALL
  ISREDIT C 'CSSTSSDS' +
      'C828TSDS' ALL
  ISREDIT C 'CSSTSSDY' +
      'C828TSDY' ALL
  ISREDIT C 'CSSTSSEM' +
      'C828TSEM' ALL
  ISREDIT C 'CSSTSSET' +
      'C828TSET' ALL
  ISREDIT C 'CSSTSSFF' +
      'C828TSFF' ALL
  ISREDIT C 'CSSTSSFH' +
      'C828TSFH' ALL
  ISREDIT C 'CSSTSSGA' +
      'C828TSGA' ALL
  ISREDIT C 'CSSTSSGB' +
      'C828TSGB' ALL
  ISREDIT C 'CSSTSSGC' +
      'C828TSGC' ALL
  ISREDIT C 'CSSTSSGD' +
      'C828TSGD' ALL
  ISREDIT C 'CSSTSSGE' +
      'C828TSGE' ALL
  ISREDIT C 'CSSTSSGL' +
      'C828TSGL' ALL
  ISREDIT C 'CSSTSSGM' +
      'C828TSGM' ALL
  ISREDIT C 'CSSTSSGT' +
      'C828TSGT' ALL
  ISREDIT C 'CSSTSSGY' +
      'C828TSGY' ALL
  ISREDIT C 'CSSTSSHR' +
      'C828TSHR' ALL
  ISREDIT C 'CSSTSSLI' +
      'C828TSLI' ALL
  ISREDIT C 'CSSTSSLN' +
      'C828TSLN' ALL
  ISREDIT C 'CSSTSSLO' +
      'C828TSLO' ALL
  ISREDIT C 'CSSTSSMA' +
      'C828TSMA' ALL
  ISREDIT C 'CSSTSSMC' +
      'C828TSMC' ALL
  ISREDIT C 'CSSTSSMD' +
      'C828TSMD' ALL
  ISREDIT C 'CSSTSSME' +
      'C828TSME' ALL
  ISREDIT C 'CSSTSSMJ' +
      'C828TSMJ' ALL
  ISREDIT C 'CSSTSSMN' +
      'C828TSMN' ALL
  ISREDIT C 'CSSTSSMS' +
      'C828TSMS' ALL
  ISREDIT C 'CSSTSSMV' +
      'C828TSMV' ALL
  ISREDIT C 'CSSTSSNC' +
      'C828TSNC' ALL
  ISREDIT C 'CSSTSSNH' +
      'C828TSNH' ALL
  ISREDIT C 'CSSTSSOC' +
      'C828TSOC' ALL
  ISREDIT C 'CSSTSSPA' +
      'C828TSPA' ALL
  ISREDIT C 'CSSTSSPC' +
      'C828TSPC' ALL
  ISREDIT C 'CSSTSSPL' +
      'C828TSPL' ALL
  ISREDIT C 'CSSTSSPR' +
      'C828TSPR' ALL
  ISREDIT C 'CSSTSSPS' +
      'C828TSPS' ALL
  ISREDIT C 'CSSTSSPU' +
      'C828TSPU' ALL
  ISREDIT C 'CSSTSSRA' +
      'C828TSRA' ALL
  ISREDIT C 'CSSTSSRB' +
      'C828TSRB' ALL
  ISREDIT C 'CSSTSSRD' +
      'C828TSRD' ALL
  ISREDIT C 'CSSTSSRF' +
      'C828TSRF' ALL
  ISREDIT C 'CSSTSSRG' +
      'C828TSRG' ALL
  ISREDIT C 'CSSTSSRI' +
      'C828TSRI' ALL
  ISREDIT C 'CSSTSSRL' +
      'C828TSRL' ALL
  ISREDIT C 'CSSTSSRM' +
      'C828TSRM' ALL
  ISREDIT C 'CSSTSSRS' +
      'C828TSRS' ALL
  ISREDIT C 'CSSTSSRT' +
      'C828TSRT' ALL
  ISREDIT C 'CSSTSSRU' +
      'C828TSRU' ALL
  ISREDIT C 'CSSTSSRV' +
      'C828TSRV' ALL
  ISREDIT C 'CSSTSSRW' +
      'C828TSRW' ALL
  ISREDIT C 'CSSTSSRX' +
      'C828TSRX' ALL
  ISREDIT C 'CSSTSSRY' +
      'C828TSRY' ALL
  ISREDIT C 'CSSTSSSA' +
      'C828TSSA' ALL
  ISREDIT C 'CSSTSSSB' +
      'C828TSSB' ALL
  ISREDIT C 'CSSTSSSF' +
      'C828TSSF' ALL
  ISREDIT C 'CSSTSSST' +
      'C828TSST' ALL
  ISREDIT C 'CSSTSSSU' +
      'C828TSSU' ALL
  ISREDIT C 'CSSTSSSW' +
      'C828TSSW' ALL
  ISREDIT C 'CSSTSSTC' +
      'C828TSTC' ALL
  ISREDIT C 'CSSTSSTE' +
      'C828TSTE' ALL
  ISREDIT C 'CSSTSSTN' +
      'C828TSTN' ALL
  ISREDIT C 'CSSTSSTO' +
      'C828TSTO' ALL
  ISREDIT C 'CSSTSSTR' +
      'C828TSTR' ALL
  ISREDIT C 'CSSTSSTT' +
      'C828TSTT' ALL
  ISREDIT C 'CSSTSSTU' +
      'C828TSTU' ALL
  ISREDIT C 'CSSTSSUC' +
      'C828TSUC' ALL
  ISREDIT C 'CSSTSSUP' +
      'C828TSUP' ALL
  ISREDIT C 'CSSTSSUR' +
      'C828TSUR' ALL
  ISREDIT C 'CSSTSSUT' +
      'C828TSUT' ALL
  ISREDIT C 'CSSTSSVA' +
      'C828TSVA' ALL
  ISREDIT C 'CSSTSSVB' +
      'C828TSVB' ALL
  ISREDIT C 'CSSTSSVC' +
      'C828TSVC' ALL
  ISREDIT C 'CSSTSSVD' +
      'C828TSVD' ALL
  ISREDIT C 'CSSTSSVE' +
      'C828TSVE' ALL
  ISREDIT C 'CSSTSSVF' +
      'C828TSVF' ALL
  ISREDIT C 'CSSTSSVG' +
      'C828TSVG' ALL
  ISREDIT C 'CSSTSSVH' +
      'C828TSVH' ALL
  ISREDIT C 'CSSTSSVI' +
      'C828TSVI' ALL
  ISREDIT C 'CSSTSSVJ' +
      'C828TSVJ' ALL
  ISREDIT C 'CSSTSSVK' +
      'C828TSVK' ALL
  ISREDIT C 'CSSTSSVM' +
      'C828TSVM' ALL
  ISREDIT C 'CSSTSSVO' +
      'C828TSVO' ALL
  ISREDIT C 'CSSTSSVP' +
      'C828TSVP' ALL
  ISREDIT C 'CSSTSSVR' +
      'C828TSVR' ALL
  ISREDIT C 'CSSTSSVS' +
      'C828TSVS' ALL
  ISREDIT C 'CSSTSSVT' +
      'C828TSVT' ALL
  ISREDIT C 'CSSTSSVU' +
      'C828TSVU' ALL
  ISREDIT C 'CSSTSSVW' +
      'C828TSVW' ALL
  ISREDIT C 'CSSTSSWM' +
      'C828TSWM' ALL
  ISREDIT C 'CSSTSSWT' +
      'C828TSWT' ALL
    ISREDIT (CHANGED) = DATA_CHANGED
    IF (&STR(&CHANGED) = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTS1CHGS 0103-93134-93135-2218-00054-00052-00010-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
    ISREDIT C 'U828' 'S828' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KWTUN'  '2KWTS1' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KUNIT'  '2KWTS1' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'WECDWTUN'  'WECDWTS1' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'PLAN(P3'  'PLAN(P5' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '10DB2MXP' '10DB2FSG' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    IF (&SAVEIT = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTS1TSNM 0100-93137-93137-0825-00371-00371-00000-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
  ISREDIT C 'DDSDTSZA' +
      'S828TSZA' ALL
  ISREDIT C 'DDSDTSZB' +
      'S828TSZB' ALL
  ISREDIT C 'DDSDTSZC' +
      'S828TSZC' ALL
  ISREDIT C 'DDSDTSZD' +
      'S828TSZD' ALL
  ISREDIT C 'DDSDTSZE' +
      'S828TSZE' ALL
  ISREDIT C 'DDSDTSZF' +
      'S828TSZF' ALL
  ISREDIT C 'DDSDTSZG' +
      'S828TSZG' ALL
  ISREDIT C 'DDSDTSZH' +
      'S828TSZH' ALL
  ISREDIT C 'DDSDTSZI' +
      'S828TSZI' ALL
  ISREDIT C 'DDSDTSZJ' +
      'S828TSZJ' ALL
  ISREDIT C 'DDSDTSZK' +
      'S828TSZK' ALL
  ISREDIT C 'DDSDTSZL' +
      'S828TSZL' ALL
  ISREDIT C 'DDSDTSZM' +
      'S828TSZM' ALL
  ISREDIT C 'DDSDTSZN' +
      'S828TSZN' ALL
  ISREDIT C 'DDSDTSZO' +
      'S828TSZO' ALL
  ISREDIT C 'DDSDTSZP' +
      'S828TSZP' ALL
  ISREDIT C 'DDSDTSZQ' +
      'S828TSZQ' ALL
  ISREDIT C 'DDSDTSZR' +
      'S828TSZR' ALL
  ISREDIT C 'DDSDTSZS' +
      'S828TSZS' ALL
  ISREDIT C 'DDSDTSZT' +
      'S828TSZT' ALL
  ISREDIT C 'DDSDTSZU' +
      'S828TSZU' ALL
  ISREDIT C 'DDSDTSZV' +
      'S828TSZV' ALL
  ISREDIT C 'DDSDTSZW' +
      'S828TSZW' ALL
  ISREDIT C 'DDSDTSZX' +
      'S828TSZX' ALL
  ISREDIT C 'DDSDTSZY' +
      'S828TSZY' ALL
  ISREDIT C 'DDSDTSZZ' +
      'S828TSZZ' ALL
  ISREDIT C 'DDSDTSZ1' +
      'S828TSZ1' ALL
  ISREDIT C 'DDSDTSZ2' +
      'S828TSZ2' ALL
  ISREDIT C 'DDSDTSZ8' +
      'S828TSZ8' ALL
  ISREDIT C 'DDSDTSZ9' +
      'S828TSZ9' ALL
  ISREDIT C 'CSSTSM01' +
      'S828TS01' ALL
  ISREDIT C 'CSSTSM02' +
      'S828TS02' ALL
  ISREDIT C 'CSSTSSAC' +
      'S828TSAC' ALL
  ISREDIT C 'CSSTSSAD' +
      'S828TSAD' ALL
  ISREDIT C 'CSSTSSAP' +
      'S828TSAP' ALL
  ISREDIT C 'CSSTSSAR' +
      'S828TSAR' ALL
  ISREDIT C 'CSSTSSAT' +
      'S828TSAT' ALL
  ISREDIT C 'CSSTSSAY' +
      'S828TSAY' ALL
  ISREDIT C 'CSSTSSBA' +
      'S828TSBA' ALL
  ISREDIT C 'CSSTSSBC' +
      'S828TSBC' ALL
  ISREDIT C 'CSSTSSBD' +
      'S828TSBD' ALL
  ISREDIT C 'CSSTSSBE' +
      'S828TSBE' ALL
  ISREDIT C 'CSSTSSBG' +
      'S828TSBG' ALL
  ISREDIT C 'CSSTSSBH' +
      'S828TSBH' ALL
  ISREDIT C 'CSSTSSBI' +
      'S828TSBI' ALL
  ISREDIT C 'CSSTSSBJ' +
      'S828TSBJ' ALL
  ISREDIT C 'CSSTSSBL' +
      'S828TSBL' ALL
  ISREDIT C 'CSSTSSBM' +
      'S828TSBM' ALL
  ISREDIT C 'CSSTSSBN' +
      'S828TSBN' ALL
  ISREDIT C 'CSSTSSBT' +
      'S828TSBT' ALL
  ISREDIT C 'CSSTSSBU' +
      'S828TSBU' ALL
  ISREDIT C 'CSSTSSBW' +
      'S828TSBW' ALL
  ISREDIT C 'CSSTSSBX' +
      'S828TSBX' ALL
  ISREDIT C 'CSSTSSBY' +
      'S828TSBY' ALL
  ISREDIT C 'CSSTSSCA' +
      'S828TSCA' ALL
  ISREDIT C 'CSSTSSCC' +
      'S828TSCC' ALL
  ISREDIT C 'CSSTSSCD' +
      'S828TSCD' ALL
  ISREDIT C 'CSSTSSCE' +
      'S828TSCE' ALL
  ISREDIT C 'CSSTSSCH' +
      'S828TSCH' ALL
  ISREDIT C 'CSSTSSCI' +
      'S828TSCI' ALL
  ISREDIT C 'CSSTSSCJ' +
      'S828TSCJ' ALL
  ISREDIT C 'CSSTSSCL' +
      'S828TSCL' ALL
  ISREDIT C 'CSSTSSCN' +
      'S828TSCN' ALL
  ISREDIT C 'CSSTSSCO' +
      'S828TSCO' ALL
  ISREDIT C 'CSSTSSCP' +
      'S828TSCP' ALL
  ISREDIT C 'CSSTSSCS' +
      'S828TSCS' ALL
  ISREDIT C 'CSSTSSCT' +
      'S828TSCT' ALL
  ISREDIT C 'CSSTSSCU' +
      'S828TSCU' ALL
  ISREDIT C 'CSSTSSCX' +
      'S828TSCX' ALL
  ISREDIT C 'CSSTSSCY' +
      'S828TSCY' ALL
  ISREDIT C 'CSSTSSDA' +
      'S828TSDA' ALL
  ISREDIT C 'CSSTSSDC' +
      'S828TSDC' ALL
  ISREDIT C 'CSSTSSDD' +
      'S828TSDD' ALL
  ISREDIT C 'CSSTSSDF' +
      'S828TSDF' ALL
  ISREDIT C 'CSSTSSDH' +
      'S828TSDH' ALL
  ISREDIT C 'CSSTSSDI' +
      'S828TSDI' ALL
  ISREDIT C 'CSSTSSDO' +
      'S828TSDO' ALL
  ISREDIT C 'CSSTSSDR' +
      'S828TSDR' ALL
  ISREDIT C 'CSSTSSDS' +
      'S828TSDS' ALL
  ISREDIT C 'CSSTSSDY' +
      'S828TSDY' ALL
  ISREDIT C 'CSSTSSEM' +
      'S828TSEM' ALL
  ISREDIT C 'CSSTSSET' +
      'S828TSET' ALL
  ISREDIT C 'CSSTSSFF' +
      'S828TSFF' ALL
  ISREDIT C 'CSSTSSFH' +
      'S828TSFH' ALL
  ISREDIT C 'CSSTSSGA' +
      'S828TSGA' ALL
  ISREDIT C 'CSSTSSGB' +
      'S828TSGB' ALL
  ISREDIT C 'CSSTSSGC' +
      'S828TSGC' ALL
  ISREDIT C 'CSSTSSGD' +
      'S828TSGD' ALL
  ISREDIT C 'CSSTSSGE' +
      'S828TSGE' ALL
  ISREDIT C 'CSSTSSGL' +
      'S828TSGL' ALL
  ISREDIT C 'CSSTSSGM' +
      'S828TSGM' ALL
  ISREDIT C 'CSSTSSGT' +
      'S828TSGT' ALL
  ISREDIT C 'CSSTSSGY' +
      'S828TSGY' ALL
  ISREDIT C 'CSSTSSHR' +
      'S828TSHR' ALL
  ISREDIT C 'CSSTSSLI' +
      'S828TSLI' ALL
  ISREDIT C 'CSSTSSLN' +
      'S828TSLN' ALL
  ISREDIT C 'CSSTSSLO' +
      'S828TSLO' ALL
  ISREDIT C 'CSSTSSMA' +
      'S828TSMA' ALL
  ISREDIT C 'CSSTSSMC' +
      'S828TSMC' ALL
  ISREDIT C 'CSSTSSMD' +
      'S828TSMD' ALL
  ISREDIT C 'CSSTSSME' +
      'S828TSME' ALL
  ISREDIT C 'CSSTSSMJ' +
      'S828TSMJ' ALL
  ISREDIT C 'CSSTSSMN' +
      'S828TSMN' ALL
  ISREDIT C 'CSSTSSMS' +
      'S828TSMS' ALL
  ISREDIT C 'CSSTSSMV' +
      'S828TSMV' ALL
  ISREDIT C 'CSSTSSNC' +
      'S828TSNC' ALL
  ISREDIT C 'CSSTSSNH' +
      'S828TSNH' ALL
  ISREDIT C 'CSSTSSOC' +
      'S828TSOC' ALL
  ISREDIT C 'CSSTSSPA' +
      'S828TSPA' ALL
  ISREDIT C 'CSSTSSPC' +
      'S828TSPC' ALL
  ISREDIT C 'CSSTSSPL' +
      'S828TSPL' ALL
  ISREDIT C 'CSSTSSPR' +
      'S828TSPR' ALL
  ISREDIT C 'CSSTSSPS' +
      'S828TSPS' ALL
  ISREDIT C 'CSSTSSPU' +
      'S828TSPU' ALL
  ISREDIT C 'CSSTSSRA' +
      'S828TSRA' ALL
  ISREDIT C 'CSSTSSRB' +
      'S828TSRB' ALL
  ISREDIT C 'CSSTSSRD' +
      'S828TSRD' ALL
  ISREDIT C 'CSSTSSRF' +
      'S828TSRF' ALL
  ISREDIT C 'CSSTSSRG' +
      'S828TSRG' ALL
  ISREDIT C 'CSSTSSRI' +
      'S828TSRI' ALL
  ISREDIT C 'CSSTSSRL' +
      'S828TSRL' ALL
  ISREDIT C 'CSSTSSRM' +
      'S828TSRM' ALL
  ISREDIT C 'CSSTSSRS' +
      'S828TSRS' ALL
  ISREDIT C 'CSSTSSRT' +
      'S828TSRT' ALL
  ISREDIT C 'CSSTSSRU' +
      'S828TSRU' ALL
  ISREDIT C 'CSSTSSRV' +
      'S828TSRV' ALL
  ISREDIT C 'CSSTSSRW' +
      'S828TSRW' ALL
  ISREDIT C 'CSSTSSRX' +
      'S828TSRX' ALL
  ISREDIT C 'CSSTSSRY' +
      'S828TSRY' ALL
  ISREDIT C 'CSSTSSSA' +
      'S828TSSA' ALL
  ISREDIT C 'CSSTSSSB' +
      'S828TSSB' ALL
  ISREDIT C 'CSSTSSSF' +
      'S828TSSF' ALL
  ISREDIT C 'CSSTSSST' +
      'S828TSST' ALL
  ISREDIT C 'CSSTSSSU' +
      'S828TSSU' ALL
  ISREDIT C 'CSSTSSSW' +
      'S828TSSW' ALL
  ISREDIT C 'CSSTSSTC' +
      'S828TSTC' ALL
  ISREDIT C 'CSSTSSTE' +
      'S828TSTE' ALL
  ISREDIT C 'CSSTSSTN' +
      'S828TSTN' ALL
  ISREDIT C 'CSSTSSTO' +
      'S828TSTO' ALL
  ISREDIT C 'CSSTSSTR' +
      'S828TSTR' ALL
  ISREDIT C 'CSSTSSTT' +
      'S828TSTT' ALL
  ISREDIT C 'CSSTSSTU' +
      'S828TSTU' ALL
  ISREDIT C 'CSSTSSUC' +
      'S828TSUC' ALL
  ISREDIT C 'CSSTSSUP' +
      'S828TSUP' ALL
  ISREDIT C 'CSSTSSUR' +
      'S828TSUR' ALL
  ISREDIT C 'CSSTSSUT' +
      'S828TSUT' ALL
  ISREDIT C 'CSSTSSVA' +
      'S828TSVA' ALL
  ISREDIT C 'CSSTSSVB' +
      'S828TSVB' ALL
  ISREDIT C 'CSSTSSVC' +
      'S828TSVC' ALL
  ISREDIT C 'CSSTSSVD' +
      'S828TSVD' ALL
  ISREDIT C 'CSSTSSVE' +
      'S828TSVE' ALL
  ISREDIT C 'CSSTSSVF' +
      'S828TSVF' ALL
  ISREDIT C 'CSSTSSVG' +
      'S828TSVG' ALL
  ISREDIT C 'CSSTSSVH' +
      'S828TSVH' ALL
  ISREDIT C 'CSSTSSVI' +
      'S828TSVI' ALL
  ISREDIT C 'CSSTSSVJ' +
      'S828TSVJ' ALL
  ISREDIT C 'CSSTSSVK' +
      'S828TSVK' ALL
  ISREDIT C 'CSSTSSVM' +
      'S828TSVM' ALL
  ISREDIT C 'CSSTSSVO' +
      'S828TSVO' ALL
  ISREDIT C 'CSSTSSVP' +
      'S828TSVP' ALL
  ISREDIT C 'CSSTSSVR' +
      'S828TSVR' ALL
  ISREDIT C 'CSSTSSVS' +
      'S828TSVS' ALL
  ISREDIT C 'CSSTSSVT' +
      'S828TSVT' ALL
  ISREDIT C 'CSSTSSVU' +
      'S828TSVU' ALL
  ISREDIT C 'CSSTSSVW' +
      'S828TSVW' ALL
  ISREDIT C 'CSSTSSWM' +
      'S828TSWM' ALL
  ISREDIT C 'CSSTSSWT' +
      'S828TSWT' ALL
    ISREDIT (CHANGED) = DATA_CHANGED
    IF (&STR(&CHANGED) = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTS2CHGS 0103-93134-93135-2219-00054-00052-00010-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
    ISREDIT C 'U828' 'R828' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KWTUN'  '2KWTS2' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KUNIT'  '2KWTS2' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'WECDWTUN'  'WECDWTS2' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'PLAN(P3'  'PLAN(P6' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '10DB2MXP' '10DB2FSG' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    IF (&SAVEIT = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTS2TSNM 0100-93137-93137-0825-00371-00371-00000-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
  ISREDIT C 'DDSDTSZA' +
      'R828TSZA' ALL
  ISREDIT C 'DDSDTSZB' +
      'R828TSZB' ALL
  ISREDIT C 'DDSDTSZC' +
      'R828TSZC' ALL
  ISREDIT C 'DDSDTSZD' +
      'R828TSZD' ALL
  ISREDIT C 'DDSDTSZE' +
      'R828TSZE' ALL
  ISREDIT C 'DDSDTSZF' +
      'R828TSZF' ALL
  ISREDIT C 'DDSDTSZG' +
      'R828TSZG' ALL
  ISREDIT C 'DDSDTSZH' +
      'R828TSZH' ALL
  ISREDIT C 'DDSDTSZI' +
      'R828TSZI' ALL
  ISREDIT C 'DDSDTSZJ' +
      'R828TSZJ' ALL
  ISREDIT C 'DDSDTSZK' +
      'R828TSZK' ALL
  ISREDIT C 'DDSDTSZL' +
      'R828TSZL' ALL
  ISREDIT C 'DDSDTSZM' +
      'R828TSZM' ALL
  ISREDIT C 'DDSDTSZN' +
      'R828TSZN' ALL
  ISREDIT C 'DDSDTSZO' +
      'R828TSZO' ALL
  ISREDIT C 'DDSDTSZP' +
      'R828TSZP' ALL
  ISREDIT C 'DDSDTSZQ' +
      'R828TSZQ' ALL
  ISREDIT C 'DDSDTSZR' +
      'R828TSZR' ALL
  ISREDIT C 'DDSDTSZS' +
      'R828TSZS' ALL
  ISREDIT C 'DDSDTSZT' +
      'R828TSZT' ALL
  ISREDIT C 'DDSDTSZU' +
      'R828TSZU' ALL
  ISREDIT C 'DDSDTSZV' +
      'R828TSZV' ALL
  ISREDIT C 'DDSDTSZW' +
      'R828TSZW' ALL
  ISREDIT C 'DDSDTSZX' +
      'R828TSZX' ALL
  ISREDIT C 'DDSDTSZY' +
      'R828TSZY' ALL
  ISREDIT C 'DDSDTSZZ' +
      'R828TSZZ' ALL
  ISREDIT C 'DDSDTSZ1' +
      'R828TSZ1' ALL
  ISREDIT C 'DDSDTSZ2' +
      'R828TSZ2' ALL
  ISREDIT C 'DDSDTSZ8' +
      'R828TSZ8' ALL
  ISREDIT C 'DDSDTSZ9' +
      'R828TSZ9' ALL
  ISREDIT C 'CSSTSM01' +
      'R828TS01' ALL
  ISREDIT C 'CSSTSM02' +
      'R828TS02' ALL
  ISREDIT C 'CSSTSSAC' +
      'R828TSAC' ALL
  ISREDIT C 'CSSTSSAD' +
      'R828TSAD' ALL
  ISREDIT C 'CSSTSSAP' +
      'R828TSAP' ALL
  ISREDIT C 'CSSTSSAR' +
      'R828TSAR' ALL
  ISREDIT C 'CSSTSSAT' +
      'R828TSAT' ALL
  ISREDIT C 'CSSTSSAY' +
      'R828TSAY' ALL
  ISREDIT C 'CSSTSSBA' +
      'R828TSBA' ALL
  ISREDIT C 'CSSTSSBC' +
      'R828TSBC' ALL
  ISREDIT C 'CSSTSSBD' +
      'R828TSBD' ALL
  ISREDIT C 'CSSTSSBE' +
      'R828TSBE' ALL
  ISREDIT C 'CSSTSSBG' +
      'R828TSBG' ALL
  ISREDIT C 'CSSTSSBH' +
      'R828TSBH' ALL
  ISREDIT C 'CSSTSSBI' +
      'R828TSBI' ALL
  ISREDIT C 'CSSTSSBJ' +
      'R828TSBJ' ALL
  ISREDIT C 'CSSTSSBL' +
      'R828TSBL' ALL
  ISREDIT C 'CSSTSSBM' +
      'R828TSBM' ALL
  ISREDIT C 'CSSTSSBN' +
      'R828TSBN' ALL
  ISREDIT C 'CSSTSSBT' +
      'R828TSBT' ALL
  ISREDIT C 'CSSTSSBU' +
      'R828TSBU' ALL
  ISREDIT C 'CSSTSSBW' +
      'R828TSBW' ALL
  ISREDIT C 'CSSTSSBX' +
      'R828TSBX' ALL
  ISREDIT C 'CSSTSSBY' +
      'R828TSBY' ALL
  ISREDIT C 'CSSTSSCA' +
      'R828TSCA' ALL
  ISREDIT C 'CSSTSSCC' +
      'R828TSCC' ALL
  ISREDIT C 'CSSTSSCD' +
      'R828TSCD' ALL
  ISREDIT C 'CSSTSSCE' +
      'R828TSCE' ALL
  ISREDIT C 'CSSTSSCH' +
      'R828TSCH' ALL
  ISREDIT C 'CSSTSSCI' +
      'R828TSCI' ALL
  ISREDIT C 'CSSTSSCJ' +
      'R828TSCJ' ALL
  ISREDIT C 'CSSTSSCL' +
      'R828TSCL' ALL
  ISREDIT C 'CSSTSSCN' +
      'R828TSCN' ALL
  ISREDIT C 'CSSTSSCO' +
      'R828TSCO' ALL
  ISREDIT C 'CSSTSSCP' +
      'R828TSCP' ALL
  ISREDIT C 'CSSTSSCS' +
      'R828TSCS' ALL
  ISREDIT C 'CSSTSSCT' +
      'R828TSCT' ALL
  ISREDIT C 'CSSTSSCU' +
      'R828TSCU' ALL
  ISREDIT C 'CSSTSSCX' +
      'R828TSCX' ALL
  ISREDIT C 'CSSTSSCY' +
      'R828TSCY' ALL
  ISREDIT C 'CSSTSSDA' +
      'R828TSDA' ALL
  ISREDIT C 'CSSTSSDC' +
      'R828TSDC' ALL
  ISREDIT C 'CSSTSSDD' +
      'R828TSDD' ALL
  ISREDIT C 'CSSTSSDF' +
      'R828TSDF' ALL
  ISREDIT C 'CSSTSSDH' +
      'R828TSDH' ALL
  ISREDIT C 'CSSTSSDI' +
      'R828TSDI' ALL
  ISREDIT C 'CSSTSSDO' +
      'R828TSDO' ALL
  ISREDIT C 'CSSTSSDR' +
      'R828TSDR' ALL
  ISREDIT C 'CSSTSSDS' +
      'R828TSDS' ALL
  ISREDIT C 'CSSTSSDY' +
      'R828TSDY' ALL
  ISREDIT C 'CSSTSSEM' +
      'R828TSEM' ALL
  ISREDIT C 'CSSTSSET' +
      'R828TSET' ALL
  ISREDIT C 'CSSTSSFF' +
      'R828TSFF' ALL
  ISREDIT C 'CSSTSSFH' +
      'R828TSFH' ALL
  ISREDIT C 'CSSTSSGA' +
      'R828TSGA' ALL
  ISREDIT C 'CSSTSSGB' +
      'R828TSGB' ALL
  ISREDIT C 'CSSTSSGC' +
      'R828TSGC' ALL
  ISREDIT C 'CSSTSSGD' +
      'R828TSGD' ALL
  ISREDIT C 'CSSTSSGE' +
      'R828TSGE' ALL
  ISREDIT C 'CSSTSSGL' +
      'R828TSGL' ALL
  ISREDIT C 'CSSTSSGM' +
      'R828TSGM' ALL
  ISREDIT C 'CSSTSSGT' +
      'R828TSGT' ALL
  ISREDIT C 'CSSTSSGY' +
      'R828TSGY' ALL
  ISREDIT C 'CSSTSSHR' +
      'R828TSHR' ALL
  ISREDIT C 'CSSTSSLI' +
      'R828TSLI' ALL
  ISREDIT C 'CSSTSSLN' +
      'R828TSLN' ALL
  ISREDIT C 'CSSTSSLO' +
      'R828TSLO' ALL
  ISREDIT C 'CSSTSSMA' +
      'R828TSMA' ALL
  ISREDIT C 'CSSTSSMC' +
      'R828TSMC' ALL
  ISREDIT C 'CSSTSSMD' +
      'R828TSMD' ALL
  ISREDIT C 'CSSTSSME' +
      'R828TSME' ALL
  ISREDIT C 'CSSTSSMJ' +
      'R828TSMJ' ALL
  ISREDIT C 'CSSTSSMN' +
      'R828TSMN' ALL
  ISREDIT C 'CSSTSSMS' +
      'R828TSMS' ALL
  ISREDIT C 'CSSTSSMV' +
      'R828TSMV' ALL
  ISREDIT C 'CSSTSSNC' +
      'R828TSNC' ALL
  ISREDIT C 'CSSTSSNH' +
      'R828TSNH' ALL
  ISREDIT C 'CSSTSSOC' +
      'R828TSOC' ALL
  ISREDIT C 'CSSTSSPA' +
      'R828TSPA' ALL
  ISREDIT C 'CSSTSSPC' +
      'R828TSPC' ALL
  ISREDIT C 'CSSTSSPL' +
      'R828TSPL' ALL
  ISREDIT C 'CSSTSSPR' +
      'R828TSPR' ALL
  ISREDIT C 'CSSTSSPS' +
      'R828TSPS' ALL
  ISREDIT C 'CSSTSSPU' +
      'R828TSPU' ALL
  ISREDIT C 'CSSTSSRA' +
      'R828TSRA' ALL
  ISREDIT C 'CSSTSSRB' +
      'R828TSRB' ALL
  ISREDIT C 'CSSTSSRD' +
      'R828TSRD' ALL
  ISREDIT C 'CSSTSSRF' +
      'R828TSRF' ALL
  ISREDIT C 'CSSTSSRG' +
      'R828TSRG' ALL
  ISREDIT C 'CSSTSSRI' +
      'R828TSRI' ALL
  ISREDIT C 'CSSTSSRL' +
      'R828TSRL' ALL
  ISREDIT C 'CSSTSSRM' +
      'R828TSRM' ALL
  ISREDIT C 'CSSTSSRS' +
      'R828TSRS' ALL
  ISREDIT C 'CSSTSSRT' +
      'R828TSRT' ALL
  ISREDIT C 'CSSTSSRU' +
      'R828TSRU' ALL
  ISREDIT C 'CSSTSSRV' +
      'R828TSRV' ALL
  ISREDIT C 'CSSTSSRW' +
      'R828TSRW' ALL
  ISREDIT C 'CSSTSSRX' +
      'R828TSRX' ALL
  ISREDIT C 'CSSTSSRY' +
      'R828TSRY' ALL
  ISREDIT C 'CSSTSSSA' +
      'R828TSSA' ALL
  ISREDIT C 'CSSTSSSB' +
      'R828TSSB' ALL
  ISREDIT C 'CSSTSSSF' +
      'R828TSSF' ALL
  ISREDIT C 'CSSTSSST' +
      'R828TSST' ALL
  ISREDIT C 'CSSTSSSU' +
      'R828TSSU' ALL
  ISREDIT C 'CSSTSSSW' +
      'R828TSSW' ALL
  ISREDIT C 'CSSTSSTC' +
      'R828TSTC' ALL
  ISREDIT C 'CSSTSSTE' +
      'R828TSTE' ALL
  ISREDIT C 'CSSTSSTN' +
      'R828TSTN' ALL
  ISREDIT C 'CSSTSSTO' +
      'R828TSTO' ALL
  ISREDIT C 'CSSTSSTR' +
      'R828TSTR' ALL
  ISREDIT C 'CSSTSSTT' +
      'R828TSTT' ALL
  ISREDIT C 'CSSTSSTU' +
      'R828TSTU' ALL
  ISREDIT C 'CSSTSSUC' +
      'R828TSUC' ALL
  ISREDIT C 'CSSTSSUP' +
      'R828TSUP' ALL
  ISREDIT C 'CSSTSSUR' +
      'R828TSUR' ALL
  ISREDIT C 'CSSTSSUT' +
      'R828TSUT' ALL
  ISREDIT C 'CSSTSSVA' +
      'R828TSVA' ALL
  ISREDIT C 'CSSTSSVB' +
      'R828TSVB' ALL
  ISREDIT C 'CSSTSSVC' +
      'R828TSVC' ALL
  ISREDIT C 'CSSTSSVD' +
      'R828TSVD' ALL
  ISREDIT C 'CSSTSSVE' +
      'R828TSVE' ALL
  ISREDIT C 'CSSTSSVF' +
      'R828TSVF' ALL
  ISREDIT C 'CSSTSSVG' +
      'R828TSVG' ALL
  ISREDIT C 'CSSTSSVH' +
      'R828TSVH' ALL
  ISREDIT C 'CSSTSSVI' +
      'R828TSVI' ALL
  ISREDIT C 'CSSTSSVJ' +
      'R828TSVJ' ALL
  ISREDIT C 'CSSTSSVK' +
      'R828TSVK' ALL
  ISREDIT C 'CSSTSSVM' +
      'R828TSVM' ALL
  ISREDIT C 'CSSTSSVO' +
      'R828TSVO' ALL
  ISREDIT C 'CSSTSSVP' +
      'R828TSVP' ALL
  ISREDIT C 'CSSTSSVR' +
      'R828TSVR' ALL
  ISREDIT C 'CSSTSSVS' +
      'R828TSVS' ALL
  ISREDIT C 'CSSTSSVT' +
      'R828TSVT' ALL
  ISREDIT C 'CSSTSSVU' +
      'R828TSVU' ALL
  ISREDIT C 'CSSTSSVW' +
      'R828TSVW' ALL
  ISREDIT C 'CSSTSSWM' +
      'R828TSWM' ALL
  ISREDIT C 'CSSTSSWT' +
      'R828TSWT' ALL
    ISREDIT (CHANGED) = DATA_CHANGED
    IF (&STR(&CHANGED) = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTTRCHGS 0104-93134-93135-2220-00054-00052-00014-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
    ISREDIT C 'U828' 'T828' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KWTUN'  '2KWTTR' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KUNIT'  '2KWTTR' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'WECDWTUN'  'WECDWTTR' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'PLAN(P3'  'PLAN(P4' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '10DB2MXP' '10DB2FSG' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    IF (&SAVEIT = YES) THEN +
      DO
        WRITE &STR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE COMPRESSING ONCE
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE COMPRESS FAILED
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTTRTSNM 0100-93137-93137-0825-00371-00371-00000-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
  ISREDIT C 'DDSDTSZA' +
      'T828TSZA' ALL
  ISREDIT C 'DDSDTSZB' +
      'T828TSZB' ALL
  ISREDIT C 'DDSDTSZC' +
      'T828TSZC' ALL
  ISREDIT C 'DDSDTSZD' +
      'T828TSZD' ALL
  ISREDIT C 'DDSDTSZE' +
      'T828TSZE' ALL
  ISREDIT C 'DDSDTSZF' +
      'T828TSZF' ALL
  ISREDIT C 'DDSDTSZG' +
      'T828TSZG' ALL
  ISREDIT C 'DDSDTSZH' +
      'T828TSZH' ALL
  ISREDIT C 'DDSDTSZI' +
      'T828TSZI' ALL
  ISREDIT C 'DDSDTSZJ' +
      'T828TSZJ' ALL
  ISREDIT C 'DDSDTSZK' +
      'T828TSZK' ALL
  ISREDIT C 'DDSDTSZL' +
      'T828TSZL' ALL
  ISREDIT C 'DDSDTSZM' +
      'T828TSZM' ALL
  ISREDIT C 'DDSDTSZN' +
      'T828TSZN' ALL
  ISREDIT C 'DDSDTSZO' +
      'T828TSZO' ALL
  ISREDIT C 'DDSDTSZP' +
      'T828TSZP' ALL
  ISREDIT C 'DDSDTSZQ' +
      'T828TSZQ' ALL
  ISREDIT C 'DDSDTSZR' +
      'T828TSZR' ALL
  ISREDIT C 'DDSDTSZS' +
      'T828TSZS' ALL
  ISREDIT C 'DDSDTSZT' +
      'T828TSZT' ALL
  ISREDIT C 'DDSDTSZU' +
      'T828TSZU' ALL
  ISREDIT C 'DDSDTSZV' +
      'T828TSZV' ALL
  ISREDIT C 'DDSDTSZW' +
      'T828TSZW' ALL
  ISREDIT C 'DDSDTSZX' +
      'T828TSZX' ALL
  ISREDIT C 'DDSDTSZY' +
      'T828TSZY' ALL
  ISREDIT C 'DDSDTSZZ' +
      'T828TSZZ' ALL
  ISREDIT C 'DDSDTSZ1' +
      'T828TSZ1' ALL
  ISREDIT C 'DDSDTSZ2' +
      'T828TSZ2' ALL
  ISREDIT C 'DDSDTSZ8' +
      'T828TSZ8' ALL
  ISREDIT C 'DDSDTSZ9' +
      'T828TSZ9' ALL
  ISREDIT C 'CSSTSM01' +
      'T828TS01' ALL
  ISREDIT C 'CSSTSM02' +
      'T828TS02' ALL
  ISREDIT C 'CSSTSSAC' +
      'T828TSAC' ALL
  ISREDIT C 'CSSTSSAD' +
      'T828TSAD' ALL
  ISREDIT C 'CSSTSSAP' +
      'T828TSAP' ALL
  ISREDIT C 'CSSTSSAR' +
      'T828TSAR' ALL
  ISREDIT C 'CSSTSSAT' +
      'T828TSAT' ALL
  ISREDIT C 'CSSTSSAY' +
      'T828TSAY' ALL
  ISREDIT C 'CSSTSSBA' +
      'T828TSBA' ALL
  ISREDIT C 'CSSTSSBC' +
      'T828TSBC' ALL
  ISREDIT C 'CSSTSSBD' +
      'T828TSBD' ALL
  ISREDIT C 'CSSTSSBE' +
      'T828TSBE' ALL
  ISREDIT C 'CSSTSSBG' +
      'T828TSBG' ALL
  ISREDIT C 'CSSTSSBH' +
      'T828TSBH' ALL
  ISREDIT C 'CSSTSSBI' +
      'T828TSBI' ALL
  ISREDIT C 'CSSTSSBJ' +
      'T828TSBJ' ALL
  ISREDIT C 'CSSTSSBL' +
      'T828TSBL' ALL
  ISREDIT C 'CSSTSSBM' +
      'T828TSBM' ALL
  ISREDIT C 'CSSTSSBN' +
      'T828TSBN' ALL
  ISREDIT C 'CSSTSSBT' +
      'T828TSBT' ALL
  ISREDIT C 'CSSTSSBU' +
      'T828TSBU' ALL
  ISREDIT C 'CSSTSSBW' +
      'T828TSBW' ALL
  ISREDIT C 'CSSTSSBX' +
      'T828TSBX' ALL
  ISREDIT C 'CSSTSSBY' +
      'T828TSBY' ALL
  ISREDIT C 'CSSTSSCA' +
      'T828TSCA' ALL
  ISREDIT C 'CSSTSSCC' +
      'T828TSCC' ALL
  ISREDIT C 'CSSTSSCD' +
      'T828TSCD' ALL
  ISREDIT C 'CSSTSSCE' +
      'T828TSCE' ALL
  ISREDIT C 'CSSTSSCH' +
      'T828TSCH' ALL
  ISREDIT C 'CSSTSSCI' +
      'T828TSCI' ALL
  ISREDIT C 'CSSTSSCJ' +
      'T828TSCJ' ALL
  ISREDIT C 'CSSTSSCL' +
      'T828TSCL' ALL
  ISREDIT C 'CSSTSSCN' +
      'T828TSCN' ALL
  ISREDIT C 'CSSTSSCO' +
      'T828TSCO' ALL
  ISREDIT C 'CSSTSSCP' +
      'T828TSCP' ALL
  ISREDIT C 'CSSTSSCS' +
      'T828TSCS' ALL
  ISREDIT C 'CSSTSSCT' +
      'T828TSCT' ALL
  ISREDIT C 'CSSTSSCU' +
      'T828TSCU' ALL
  ISREDIT C 'CSSTSSCX' +
      'T828TSCX' ALL
  ISREDIT C 'CSSTSSCY' +
      'T828TSCY' ALL
  ISREDIT C 'CSSTSSDA' +
      'T828TSDA' ALL
  ISREDIT C 'CSSTSSDC' +
      'T828TSDC' ALL
  ISREDIT C 'CSSTSSDD' +
      'T828TSDD' ALL
  ISREDIT C 'CSSTSSDF' +
      'T828TSDF' ALL
  ISREDIT C 'CSSTSSDH' +
      'T828TSDH' ALL
  ISREDIT C 'CSSTSSDI' +
      'T828TSDI' ALL
  ISREDIT C 'CSSTSSDO' +
      'T828TSDO' ALL
  ISREDIT C 'CSSTSSDR' +
      'T828TSDR' ALL
  ISREDIT C 'CSSTSSDS' +
      'T828TSDS' ALL
  ISREDIT C 'CSSTSSDY' +
      'T828TSDY' ALL
  ISREDIT C 'CSSTSSEM' +
      'T828TSEM' ALL
  ISREDIT C 'CSSTSSET' +
      'T828TSET' ALL
  ISREDIT C 'CSSTSSFF' +
      'T828TSFF' ALL
  ISREDIT C 'CSSTSSFH' +
      'T828TSFH' ALL
  ISREDIT C 'CSSTSSGA' +
      'T828TSGA' ALL
  ISREDIT C 'CSSTSSGB' +
      'T828TSGB' ALL
  ISREDIT C 'CSSTSSGC' +
      'T828TSGC' ALL
  ISREDIT C 'CSSTSSGD' +
      'T828TSGD' ALL
  ISREDIT C 'CSSTSSGE' +
      'T828TSGE' ALL
  ISREDIT C 'CSSTSSGL' +
      'T828TSGL' ALL
  ISREDIT C 'CSSTSSGM' +
      'T828TSGM' ALL
  ISREDIT C 'CSSTSSGT' +
      'T828TSGT' ALL
  ISREDIT C 'CSSTSSGY' +
      'T828TSGY' ALL
  ISREDIT C 'CSSTSSHR' +
      'T828TSHR' ALL
  ISREDIT C 'CSSTSSLI' +
      'T828TSLI' ALL
  ISREDIT C 'CSSTSSLN' +
      'T828TSLN' ALL
  ISREDIT C 'CSSTSSLO' +
      'T828TSLO' ALL
  ISREDIT C 'CSSTSSMA' +
      'T828TSMA' ALL
  ISREDIT C 'CSSTSSMC' +
      'T828TSMC' ALL
  ISREDIT C 'CSSTSSMD' +
      'T828TSMD' ALL
  ISREDIT C 'CSSTSSME' +
      'T828TSME' ALL
  ISREDIT C 'CSSTSSMJ' +
      'T828TSMJ' ALL
  ISREDIT C 'CSSTSSMN' +
      'T828TSMN' ALL
  ISREDIT C 'CSSTSSMS' +
      'T828TSMS' ALL
  ISREDIT C 'CSSTSSMV' +
      'T828TSMV' ALL
  ISREDIT C 'CSSTSSNC' +
      'T828TSNC' ALL
  ISREDIT C 'CSSTSSNH' +
      'T828TSNH' ALL
  ISREDIT C 'CSSTSSOC' +
      'T828TSOC' ALL
  ISREDIT C 'CSSTSSPA' +
      'T828TSPA' ALL
  ISREDIT C 'CSSTSSPC' +
      'T828TSPC' ALL
  ISREDIT C 'CSSTSSPL' +
      'T828TSPL' ALL
  ISREDIT C 'CSSTSSPR' +
      'T828TSPR' ALL
  ISREDIT C 'CSSTSSPS' +
      'T828TSPS' ALL
  ISREDIT C 'CSSTSSPU' +
      'T828TSPU' ALL
  ISREDIT C 'CSSTSSRA' +
      'T828TSRA' ALL
  ISREDIT C 'CSSTSSRB' +
      'T828TSRB' ALL
  ISREDIT C 'CSSTSSRD' +
      'T828TSRD' ALL
  ISREDIT C 'CSSTSSRF' +
      'T828TSRF' ALL
  ISREDIT C 'CSSTSSRG' +
      'T828TSRG' ALL
  ISREDIT C 'CSSTSSRI' +
      'T828TSRI' ALL
  ISREDIT C 'CSSTSSRL' +
      'T828TSRL' ALL
  ISREDIT C 'CSSTSSRM' +
      'T828TSRM' ALL
  ISREDIT C 'CSSTSSRS' +
      'T828TSRS' ALL
  ISREDIT C 'CSSTSSRT' +
      'T828TSRT' ALL
  ISREDIT C 'CSSTSSRU' +
      'T828TSRU' ALL
  ISREDIT C 'CSSTSSRV' +
      'T828TSRV' ALL
  ISREDIT C 'CSSTSSRW' +
      'T828TSRW' ALL
  ISREDIT C 'CSSTSSRX' +
      'T828TSRX' ALL
  ISREDIT C 'CSSTSSRY' +
      'T828TSRY' ALL
  ISREDIT C 'CSSTSSSA' +
      'T828TSSA' ALL
  ISREDIT C 'CSSTSSSB' +
      'T828TSSB' ALL
  ISREDIT C 'CSSTSSSF' +
      'T828TSSF' ALL
  ISREDIT C 'CSSTSSST' +
      'T828TSST' ALL
  ISREDIT C 'CSSTSSSU' +
      'T828TSSU' ALL
  ISREDIT C 'CSSTSSSW' +
      'T828TSSW' ALL
  ISREDIT C 'CSSTSSTC' +
      'T828TSTC' ALL
  ISREDIT C 'CSSTSSTE' +
      'T828TSTE' ALL
  ISREDIT C 'CSSTSSTN' +
      'T828TSTN' ALL
  ISREDIT C 'CSSTSSTO' +
      'T828TSTO' ALL
  ISREDIT C 'CSSTSSTR' +
      'T828TSTR' ALL
  ISREDIT C 'CSSTSSTT' +
      'T828TSTT' ALL
  ISREDIT C 'CSSTSSTU' +
      'T828TSTU' ALL
  ISREDIT C 'CSSTSSUC' +
      'T828TSUC' ALL
  ISREDIT C 'CSSTSSUP' +
      'T828TSUP' ALL
  ISREDIT C 'CSSTSSUR' +
      'T828TSUR' ALL
  ISREDIT C 'CSSTSSUT' +
      'T828TSUT' ALL
  ISREDIT C 'CSSTSSVA' +
      'T828TSVA' ALL
  ISREDIT C 'CSSTSSVB' +
      'T828TSVB' ALL
  ISREDIT C 'CSSTSSVC' +
      'T828TSVC' ALL
  ISREDIT C 'CSSTSSVD' +
      'T828TSVD' ALL
  ISREDIT C 'CSSTSSVE' +
      'T828TSVE' ALL
  ISREDIT C 'CSSTSSVF' +
      'T828TSVF' ALL
  ISREDIT C 'CSSTSSVG' +
      'T828TSVG' ALL
  ISREDIT C 'CSSTSSVH' +
      'T828TSVH' ALL
  ISREDIT C 'CSSTSSVI' +
      'T828TSVI' ALL
  ISREDIT C 'CSSTSSVJ' +
      'T828TSVJ' ALL
  ISREDIT C 'CSSTSSVK' +
      'T828TSVK' ALL
  ISREDIT C 'CSSTSSVM' +
      'T828TSVM' ALL
  ISREDIT C 'CSSTSSVO' +
      'T828TSVO' ALL
  ISREDIT C 'CSSTSSVP' +
      'T828TSVP' ALL
  ISREDIT C 'CSSTSSVR' +
      'T828TSVR' ALL
  ISREDIT C 'CSSTSSVS' +
      'T828TSVS' ALL
  ISREDIT C 'CSSTSSVT' +
      'T828TSVT' ALL
  ISREDIT C 'CSSTSSVU' +
      'T828TSVU' ALL
  ISREDIT C 'CSSTSSVW' +
      'T828TSVW' ALL
  ISREDIT C 'CSSTSSWM' +
      'T828TSWM' ALL
  ISREDIT C 'CSSTSSWT' +
      'T828TSWT' ALL
    ISREDIT (CHANGED) = DATA_CHANGED
    IF (&STR(&CHANGED) = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTUNCHGS 0102-93134-93135-2217-00057-00055-00010-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
    ISREDIT C 'A828' 'U828' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C 'A828' 'U828' WORD ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C 'U828.' 'A828.' WORD ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KBASE'  '2KWTUN' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  'WECDDDEV'  'WECDWTUN' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '2KUNIT'  '2KWTUN' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    ISREDIT C  '10DB2MXP' '10DB2FSG' ALL
    SET &MYCC = &LASTCC
    IF (&MYCC = 0) THEN SET &SAVEIT = YES
    IF (&SAVEIT = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=WTUNTSNM 0100-93137-93137-0824-00371-00371-00000-KETCSC
ISREDIT MACRO
    CONTROL NOLIST NOMSG END(ENDO) FLUSH ASIS
/*  CONTROL LIST MSG CONLIST SYMLIST
    ISPEXEC CONTROL ERRORS RETURN
    ISREDIT (MEMBER) = MEMBER
    SET &SAVEIT = NO
  ISREDIT C 'DDSDTSZA' +
      'U828TSZA' ALL
  ISREDIT C 'DDSDTSZB' +
      'U828TSZB' ALL
  ISREDIT C 'DDSDTSZC' +
      'U828TSZC' ALL
  ISREDIT C 'DDSDTSZD' +
      'U828TSZD' ALL
  ISREDIT C 'DDSDTSZE' +
      'U828TSZE' ALL
  ISREDIT C 'DDSDTSZF' +
      'U828TSZF' ALL
  ISREDIT C 'DDSDTSZG' +
      'U828TSZG' ALL
  ISREDIT C 'DDSDTSZH' +
      'U828TSZH' ALL
  ISREDIT C 'DDSDTSZI' +
      'U828TSZI' ALL
  ISREDIT C 'DDSDTSZJ' +
      'U828TSZJ' ALL
  ISREDIT C 'DDSDTSZK' +
      'U828TSZK' ALL
  ISREDIT C 'DDSDTSZL' +
      'U828TSZL' ALL
  ISREDIT C 'DDSDTSZM' +
      'U828TSZM' ALL
  ISREDIT C 'DDSDTSZN' +
      'U828TSZN' ALL
  ISREDIT C 'DDSDTSZO' +
      'U828TSZO' ALL
  ISREDIT C 'DDSDTSZP' +
      'U828TSZP' ALL
  ISREDIT C 'DDSDTSZQ' +
      'U828TSZQ' ALL
  ISREDIT C 'DDSDTSZR' +
      'U828TSZR' ALL
  ISREDIT C 'DDSDTSZS' +
      'U828TSZS' ALL
  ISREDIT C 'DDSDTSZT' +
      'U828TSZT' ALL
  ISREDIT C 'DDSDTSZU' +
      'U828TSZU' ALL
  ISREDIT C 'DDSDTSZV' +
      'U828TSZV' ALL
  ISREDIT C 'DDSDTSZW' +
      'U828TSZW' ALL
  ISREDIT C 'DDSDTSZX' +
      'U828TSZX' ALL
  ISREDIT C 'DDSDTSZY' +
      'U828TSZY' ALL
  ISREDIT C 'DDSDTSZZ' +
      'U828TSZZ' ALL
  ISREDIT C 'DDSDTSZ1' +
      'U828TSZ1' ALL
  ISREDIT C 'DDSDTSZ2' +
      'U828TSZ2' ALL
  ISREDIT C 'DDSDTSZ8' +
      'U828TSZ8' ALL
  ISREDIT C 'DDSDTSZ9' +
      'U828TSZ9' ALL
  ISREDIT C 'CSSTSM01' +
      'U828TS01' ALL
  ISREDIT C 'CSSTSM02' +
      'U828TS02' ALL
  ISREDIT C 'CSSTSSAC' +
      'U828TSAC' ALL
  ISREDIT C 'CSSTSSAD' +
      'U828TSAD' ALL
  ISREDIT C 'CSSTSSAP' +
      'U828TSAP' ALL
  ISREDIT C 'CSSTSSAR' +
      'U828TSAR' ALL
  ISREDIT C 'CSSTSSAT' +
      'U828TSAT' ALL
  ISREDIT C 'CSSTSSAY' +
      'U828TSAY' ALL
  ISREDIT C 'CSSTSSBA' +
      'U828TSBA' ALL
  ISREDIT C 'CSSTSSBC' +
      'U828TSBC' ALL
  ISREDIT C 'CSSTSSBD' +
      'U828TSBD' ALL
  ISREDIT C 'CSSTSSBE' +
      'U828TSBE' ALL
  ISREDIT C 'CSSTSSBG' +
      'U828TSBG' ALL
  ISREDIT C 'CSSTSSBH' +
      'U828TSBH' ALL
  ISREDIT C 'CSSTSSBI' +
      'U828TSBI' ALL
  ISREDIT C 'CSSTSSBJ' +
      'U828TSBJ' ALL
  ISREDIT C 'CSSTSSBL' +
      'U828TSBL' ALL
  ISREDIT C 'CSSTSSBM' +
      'U828TSBM' ALL
  ISREDIT C 'CSSTSSBN' +
      'U828TSBN' ALL
  ISREDIT C 'CSSTSSBT' +
      'U828TSBT' ALL
  ISREDIT C 'CSSTSSBU' +
      'U828TSBU' ALL
  ISREDIT C 'CSSTSSBW' +
      'U828TSBW' ALL
  ISREDIT C 'CSSTSSBX' +
      'U828TSBX' ALL
  ISREDIT C 'CSSTSSBY' +
      'U828TSBY' ALL
  ISREDIT C 'CSSTSSCA' +
      'U828TSCA' ALL
  ISREDIT C 'CSSTSSCC' +
      'U828TSCC' ALL
  ISREDIT C 'CSSTSSCD' +
      'U828TSCD' ALL
  ISREDIT C 'CSSTSSCE' +
      'U828TSCE' ALL
  ISREDIT C 'CSSTSSCH' +
      'U828TSCH' ALL
  ISREDIT C 'CSSTSSCI' +
      'U828TSCI' ALL
  ISREDIT C 'CSSTSSCJ' +
      'U828TSCJ' ALL
  ISREDIT C 'CSSTSSCL' +
      'U828TSCL' ALL
  ISREDIT C 'CSSTSSCN' +
      'U828TSCN' ALL
  ISREDIT C 'CSSTSSCO' +
      'U828TSCO' ALL
  ISREDIT C 'CSSTSSCP' +
      'U828TSCP' ALL
  ISREDIT C 'CSSTSSCS' +
      'U828TSCS' ALL
  ISREDIT C 'CSSTSSCT' +
      'U828TSCT' ALL
  ISREDIT C 'CSSTSSCU' +
      'U828TSCU' ALL
  ISREDIT C 'CSSTSSCX' +
      'U828TSCX' ALL
  ISREDIT C 'CSSTSSCY' +
      'U828TSCY' ALL
  ISREDIT C 'CSSTSSDA' +
      'U828TSDA' ALL
  ISREDIT C 'CSSTSSDC' +
      'U828TSDC' ALL
  ISREDIT C 'CSSTSSDD' +
      'U828TSDD' ALL
  ISREDIT C 'CSSTSSDF' +
      'U828TSDF' ALL
  ISREDIT C 'CSSTSSDH' +
      'U828TSDH' ALL
  ISREDIT C 'CSSTSSDI' +
      'U828TSDI' ALL
  ISREDIT C 'CSSTSSDO' +
      'U828TSDO' ALL
  ISREDIT C 'CSSTSSDR' +
      'U828TSDR' ALL
  ISREDIT C 'CSSTSSDS' +
      'U828TSDS' ALL
  ISREDIT C 'CSSTSSDY' +
      'U828TSDY' ALL
  ISREDIT C 'CSSTSSEM' +
      'U828TSEM' ALL
  ISREDIT C 'CSSTSSET' +
      'U828TSET' ALL
  ISREDIT C 'CSSTSSFF' +
      'U828TSFF' ALL
  ISREDIT C 'CSSTSSFH' +
      'U828TSFH' ALL
  ISREDIT C 'CSSTSSGA' +
      'U828TSGA' ALL
  ISREDIT C 'CSSTSSGB' +
      'U828TSGB' ALL
  ISREDIT C 'CSSTSSGC' +
      'U828TSGC' ALL
  ISREDIT C 'CSSTSSGD' +
      'U828TSGD' ALL
  ISREDIT C 'CSSTSSGE' +
      'U828TSGE' ALL
  ISREDIT C 'CSSTSSGL' +
      'U828TSGL' ALL
  ISREDIT C 'CSSTSSGM' +
      'U828TSGM' ALL
  ISREDIT C 'CSSTSSGT' +
      'U828TSGT' ALL
  ISREDIT C 'CSSTSSGY' +
      'U828TSGY' ALL
  ISREDIT C 'CSSTSSHR' +
      'U828TSHR' ALL
  ISREDIT C 'CSSTSSLI' +
      'U828TSLI' ALL
  ISREDIT C 'CSSTSSLN' +
      'U828TSLN' ALL
  ISREDIT C 'CSSTSSLO' +
      'U828TSLO' ALL
  ISREDIT C 'CSSTSSMA' +
      'U828TSMA' ALL
  ISREDIT C 'CSSTSSMC' +
      'U828TSMC' ALL
  ISREDIT C 'CSSTSSMD' +
      'U828TSMD' ALL
  ISREDIT C 'CSSTSSME' +
      'U828TSME' ALL
  ISREDIT C 'CSSTSSMJ' +
      'U828TSMJ' ALL
  ISREDIT C 'CSSTSSMN' +
      'U828TSMN' ALL
  ISREDIT C 'CSSTSSMS' +
      'U828TSMS' ALL
  ISREDIT C 'CSSTSSMV' +
      'U828TSMV' ALL
  ISREDIT C 'CSSTSSNC' +
      'U828TSNC' ALL
  ISREDIT C 'CSSTSSNH' +
      'U828TSNH' ALL
  ISREDIT C 'CSSTSSOC' +
      'U828TSOC' ALL
  ISREDIT C 'CSSTSSPA' +
      'U828TSPA' ALL
  ISREDIT C 'CSSTSSPC' +
      'U828TSPC' ALL
  ISREDIT C 'CSSTSSPL' +
      'U828TSPL' ALL
  ISREDIT C 'CSSTSSPR' +
      'U828TSPR' ALL
  ISREDIT C 'CSSTSSPS' +
      'U828TSPS' ALL
  ISREDIT C 'CSSTSSPU' +
      'U828TSPU' ALL
  ISREDIT C 'CSSTSSRA' +
      'U828TSRA' ALL
  ISREDIT C 'CSSTSSRB' +
      'U828TSRB' ALL
  ISREDIT C 'CSSTSSRD' +
      'U828TSRD' ALL
  ISREDIT C 'CSSTSSRF' +
      'U828TSRF' ALL
  ISREDIT C 'CSSTSSRG' +
      'U828TSRG' ALL
  ISREDIT C 'CSSTSSRI' +
      'U828TSRI' ALL
  ISREDIT C 'CSSTSSRL' +
      'U828TSRL' ALL
  ISREDIT C 'CSSTSSRM' +
      'U828TSRM' ALL
  ISREDIT C 'CSSTSSRS' +
      'U828TSRS' ALL
  ISREDIT C 'CSSTSSRT' +
      'U828TSRT' ALL
  ISREDIT C 'CSSTSSRU' +
      'U828TSRU' ALL
  ISREDIT C 'CSSTSSRV' +
      'U828TSRV' ALL
  ISREDIT C 'CSSTSSRW' +
      'U828TSRW' ALL
  ISREDIT C 'CSSTSSRX' +
      'U828TSRX' ALL
  ISREDIT C 'CSSTSSRY' +
      'U828TSRY' ALL
  ISREDIT C 'CSSTSSSA' +
      'U828TSSA' ALL
  ISREDIT C 'CSSTSSSB' +
      'U828TSSB' ALL
  ISREDIT C 'CSSTSSSF' +
      'U828TSSF' ALL
  ISREDIT C 'CSSTSSST' +
      'U828TSST' ALL
  ISREDIT C 'CSSTSSSU' +
      'U828TSSU' ALL
  ISREDIT C 'CSSTSSSW' +
      'U828TSSW' ALL
  ISREDIT C 'CSSTSSTC' +
      'U828TSTC' ALL
  ISREDIT C 'CSSTSSTE' +
      'U828TSTE' ALL
  ISREDIT C 'CSSTSSTN' +
      'U828TSTN' ALL
  ISREDIT C 'CSSTSSTO' +
      'U828TSTO' ALL
  ISREDIT C 'CSSTSSTR' +
      'U828TSTR' ALL
  ISREDIT C 'CSSTSSTT' +
      'U828TSTT' ALL
  ISREDIT C 'CSSTSSTU' +
      'U828TSTU' ALL
  ISREDIT C 'CSSTSSUC' +
      'U828TSUC' ALL
  ISREDIT C 'CSSTSSUP' +
      'U828TSUP' ALL
  ISREDIT C 'CSSTSSUR' +
      'U828TSUR' ALL
  ISREDIT C 'CSSTSSUT' +
      'U828TSUT' ALL
  ISREDIT C 'CSSTSSVA' +
      'U828TSVA' ALL
  ISREDIT C 'CSSTSSVB' +
      'U828TSVB' ALL
  ISREDIT C 'CSSTSSVC' +
      'U828TSVC' ALL
  ISREDIT C 'CSSTSSVD' +
      'U828TSVD' ALL
  ISREDIT C 'CSSTSSVE' +
      'U828TSVE' ALL
  ISREDIT C 'CSSTSSVF' +
      'U828TSVF' ALL
  ISREDIT C 'CSSTSSVG' +
      'U828TSVG' ALL
  ISREDIT C 'CSSTSSVH' +
      'U828TSVH' ALL
  ISREDIT C 'CSSTSSVI' +
      'U828TSVI' ALL
  ISREDIT C 'CSSTSSVJ' +
      'U828TSVJ' ALL
  ISREDIT C 'CSSTSSVK' +
      'U828TSVK' ALL
  ISREDIT C 'CSSTSSVM' +
      'U828TSVM' ALL
  ISREDIT C 'CSSTSSVO' +
      'U828TSVO' ALL
  ISREDIT C 'CSSTSSVP' +
      'U828TSVP' ALL
  ISREDIT C 'CSSTSSVR' +
      'U828TSVR' ALL
  ISREDIT C 'CSSTSSVS' +
      'U828TSVS' ALL
  ISREDIT C 'CSSTSSVT' +
      'U828TSVT' ALL
  ISREDIT C 'CSSTSSVU' +
      'U828TSVU' ALL
  ISREDIT C 'CSSTSSVW' +
      'U828TSVW' ALL
  ISREDIT C 'CSSTSSWM' +
      'U828TSWM' ALL
  ISREDIT C 'CSSTSSWT' +
      'U828TSWT' ALL
    ISREDIT (CHANGED) = DATA_CHANGED
    IF (&STR(&CHANGED) = YES) THEN +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER)
        ISPEXEC  CONTROL SUBTASK PROTECT
        ISREDIT SAVE
        SET &MYCC = &LASTCC
        ISPEXEC  CONTROL SUBTASK CLEAR
        IF (&MYCC NE 0) THEN +
          DO
            ISREDIT (DATASET) = DATASET
            WRITE &NRSTR(COMPRESSING ONCE)
            %CP &DATASET
            IF (&MYCC NE 0) THEN +
              DO
                WRITE &NRSTR(COMPRESS FAILED)
              ENDO
            ISREDIT SAVE
          ENDO
        ISREDIT END
      ENDO
    ELSE +
      DO
        WRITE &NRSTR(MEMBER: &MEMBER NOT CHANGED)
      ENDO
EXITIT: +
    IF (&MYCC NE 0) THEN +
      DO
        ISREDIT CANCEL
      ENDO
    EXIT CODE(&MAXCC)
./ ADD NAME=X        0102-92087-93195-1045-00001-00001-00001-FMMCSC
LOGOFF
./ ADD NAME=XDBSALC  0103-91353-92076-1552-00124-00121-00006-DMV0016
PROC 0
/************************************************************/
/*                                                          */
/* LIB: CLIST(XDBSALC)                                      */
/* GDE: TSO/E REFERENCE                                     */
/* DOC: APPEND LIBRARIES TO TSO/ISPF ENVIRONMENT.           */
/*                                                          */
/************************************************************/
/* GIVE TSO  ERRORS TO CLIST     */
    CONTROL NOMSG NOLIST NOFLUSH MAIN END(ENDO)

/**********************************************************/
/* CHECK USER AUTHORIZATION FIRST
/**********************************************************/
    CONTROL MSG
    SET &SYSOUTTRAP = 12
    LISTGRP
    SET &SYSOUTTRAP = 0
    CONTROL NOMSG
    SET &MYLINE = &SYSOUTLINE1
    SET &MYLEN = &LENGTH(&STR(&SYSOUTLINE1))
    SET &MYBEGIN = &MYLEN - 8
    SET &MYBEGIN = &SYSINDEX(&STR( ),&STR(&SYSOUTLINE1),&MYBEGIN)
    SET &MYGRP = &SUBSTR(&MYBEGIN:&MYLEN,&STR(&SYSOUTLINE1))
    SET &MYGRP = &MYGRP
    IF (&STR(&MYGRP) EQ DD200) OR +
       (&STR(&SYSUID) EQ DMV0016) OR +
       (&STR(&SYSUID) EQ BORGY) OR +
       (&STR(&SYSUID) EQ MANN) OR +
       (&STR(&MYGRP) EQ CSCDB2) THEN +
       GOTO ITSOKAY
    EXIT CODE(0)

/**********************************************************/
/* RETURN ISPF ERRORS TO CLIST
/**********************************************************/
ITSOKAY: +
    ISPEXEC CONTROL ERRORS RETURN
    SET &MYCC = &LASTCC
    IF &MYCC ^= 0 THEN +
      DO
        WRITE ISPEXEC CONTROL FAILED RC=&MYCC
        EXIT CODE(&MYCC)
      ENDO

/**********************************************************/
/* APPEND DIALOG CLIST LIBRARY                            */
/**********************************************************/
    ALTLIB DEACTIVATE APPLICATION(CLIST)
    FREE FILE(XDBSCLST)
    ALLOC FILE(XDBSCLST) +
      DATASET('XDBS.TSOISPF.CLIST') SHR REUSE
    ALTLIB ACTIVATE APPLICATION(CLIST) FILE(XDBSCLST) UNCOND
    SET &MYCC = &LASTCC
    IF &MYCC ^= 0 THEN +
      DO
        WRITE ALTLIB FAILED RC=&MYCC
        EXIT CODE(&MYCC)
      ENDO

    ISPEXEC LIBDEF ISPMLIB DATASET          -
       ID('XDBS.TSOISPF.MSGS')
    SET &MYCC = &LASTCC
    IF &MYCC ^= 0 THEN +
      DO
        WRITE ISPMLIB FAILED RC=&MYCC
        EXIT CODE(&MYCC)
      ENDO

    ISPEXEC LIBDEF ISPPLIB DATASET          -
       ID('XDBS.TSOISPF.PANELS')
    SET &MYCC = &LASTCC
    IF &MYCC ^= 0 THEN +
      DO
        WRITE ISPPLIB FAILED RC=&MYCC
        EXIT CODE(&MYCC)
      ENDO

    ISPEXEC LIBDEF ISPSLIB DATASET          -
       ID('XDBS.TSOISPF.SKELS')
    SET &MYCC = &LASTCC
    IF &MYCC ^= 0 THEN +
      DO
        WRITE ISPSLIB FAILED RC=&MYCC
        EXIT CODE(&MYCC)
      ENDO

    ISPEXEC LIBDEF ISPTABL DATASET          -
       ID('XDBS.TSOISPF.TABLES')
    SET &MYCC = &LASTCC
    IF &MYCC ^= 0 THEN +
      DO
        WRITE ISPTABL FAILED RC=&MYCC
        EXIT CODE(&MYCC)
      ENDO

    ISPEXEC LIBDEF ISPTLIB DATASET          -
       ID('XDBS.TSOISPF.TABLES')
    SET &MYCC = &LASTCC
    IF &MYCC ^= 0 THEN +
      DO
        WRITE ISPTLIB FAILED RC=&MYCC
        EXIT CODE(&MYCC)
      ENDO

/**********************************************************/
/* SPIN OFF TO APPLICATION                                */
/**********************************************************/
    ISPEXEC SELECT PANEL(XDBSPNL) NEWAPPL(XDBS) PASSLIB
    SET RCSAVE = &LASTCC

/**********************************************************/
/* DIALOG IS FINISHED.  RESTORE ALL DDNAMES THE WAY THEY  */
/* WERE ON ENTRY.                                         */
/**********************************************************/
    ISPEXEC LIBDEF ISPMLIB
    ISPEXEC LIBDEF ISPPLIB
    ISPEXEC LIBDEF ISPSLIB
    ISPEXEC LIBDEF ISPTABL
    ISPEXEC LIBDEF ISPTLIB

    ALTLIB DEACTIVATE APPLICATION(CLIST)

    EXIT CODE(&RCSAVE)
./ ADD NAME=XSYSMISC 0102-91165-91165-0940-00015-00014-00000-DMV0016
PROC 0
/*                                                                 */
/* LIB: XSYS.MVSESA.CLIST(XSYSMISC)                                */
/* GDE: IBM CONVERSION/MIGRATION/IMPLEMENTATION TEAM.              */
/* DOC: THIS CLIST INVOKES OTHER CLISTS WHILE UNDER THE            */
/*      XSYS UMBRELLA OF LIBDEF/ALTLIB CONCATENATIONS.             */
/*                                                                 */
    CONTROL NOLIST FLUSH END(ENDO) MAIN ASIS
    ISPEXEC CONTROL ERRORS RETURN
PNL: +
    ISPEXEC DISPLAY PANEL(XSYSMISC)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN EXIT CODE(0)
    &XSYSCMD
    GOTO PNL
./ ADD NAME=XSYS34   0102-91144-91206-1524-00014-00014-00000-DMV0016
PROC 1 KETPFX
/*                                                                 */
/* LIB: XSYS.MVSESA.CLIST(XSYS34)                                  */
/* GDE: IBM CONVERSION/MIGRATION/IMPLEMENTATION TEAM.              */
/* DOC: THIS CLIST INVOKES 3.4 WITH A PREFIX SET.                  */
/*                                                                 */
    CONTROL NOLIST FLUSH END(ENDO)
/*  CONTROL LIST CONLIST SYMLIST MSG
    ISPEXEC CONTROL ERRORS RETURN
    SET &KETDR = BYPASS
    ISPEXEC VPUT (KETDR KETPFX) SHARED
AGAIN: +
    ISPEXEC SELECT PGM(ISRUDL) PARM(XSYSUDLP)
    EXIT CODE(&LASTCC)
./ ADD NAME=Z        0100-91225-91225-1444-00121-00121-00000-DMV0016
ISREDIT MACRO (TRACE)
/*                                                                 */
/* LIB: CLIST.LIBRARY.NAME(Z)                                      */
/* GDE: KENNETH E. TOMIAK                                          */
/* DOC: THIS CLIST USES LIBRARY SERVICES TO COMPRESS A DATASET.    */
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  SET UP ERROR HANDLING PROCESSING                               */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    CONTROL NOLIST NOFLUSH END(ENDO) NOMSG    /*  INITIAL SETTINGS */
    IF (&TRACE = TRACE) THEN +
      CONTROL LIST MSG CONLIST SYMLIST        /*  DEBUGGING HELP   */
    IF (&STR(&SYSISPF) NE ACTIVE) THEN +
      DO                                      /* - - - - - - - - - */
        WRITENR YOU MUST BE IN ISPF/EDIT      /* WRITE MESSAGE     */
        WRITE TO USE THIS EDIT MACRO          /* WRITE MESSAGE     */
        EXIT CODE(16)                         /* TERMINATE         */
      ENDO                                    /* - - - - - - - - - */
    ISPEXEC CONTROL ERRORS RETURN             /*  ISPF ERRORS      */
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  RETRIEVE DATA SET NAME FOR CURRENT EDIT DATASET                */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    ISREDIT (DSN) = DATASET                   /*  RETRIEVE DATASET */
    SET &DSN = &STR('&DSN')                   /*  WRAP IN APOST    */
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  INITIALIZE MESSAGE HANDLING ENVIRONMENT                        */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    SET &ZERRHM = &STR(NOHELP)                /*  ISPF HELP PANEL  */
    SET &ZERRALRM = &STR(YES)                 /*  ALARM STATUS     */
    SET &ZERRSM = &STR(COMPRESSED!!)          /*  SHORT MESSAGE    */
    SET &ZERRLM = &STR( )                     /*  LONG MESSAGE     */
    SET &ZERRLM = &STR(THE REQUESTED PDS: &DATASET WAS COMPRESSED)
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  USE LIBRARY SERVICES TO SET UP DATASET                         */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    ISPEXEC LMINIT DATAID(DSNID) DATASET(&DSN) +
        ENQ(EXCLU)
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRSM = &STR(DATASET IN USE)
        SET &ZERRLM = &STR(DATASET &DSN IS CURRENTLY IN USE)
        SET &ZERRLM = &STR(&ZERRLM BY ANOTHER USER OR TASK)
        IF (&MYCC EQ 8) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(DATASET NOT ALLOCATED OR DATA SET)
            SET &ZERRLM = &STR(&ZERRLM ORGANIZATION NOT SUPPORTED)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 12) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(INVALID PARAMETER VALUE)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 16) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(TRUNCATION OR TRANSLATION ERROR)
            SET &ZERRLM = &STR(&ZERRLM IN ACCESSING DIALOG VARIABLES)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 20) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(SEVERE ERROR)
          ENDO                                /* - - - - - - - - - */
        GOTO EXITIT
      ENDO
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  USE LIBRARY SERVICES TO COMPRESS CURRENT DATASET               */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
    ISPEXEC LMCOMP DATAID(&DSNID)             /*  COMPRESS         */
    SET &MYCC = &LASTCC
    IF (&MYCC NE 0) THEN +
      DO
        SET &ZERRSM = &STR(COMPRESS FAILED)
        SET &ZERRLM = &STR(THE DSN: &DSN FAILED TO)
        SET &ZERRLM = &STR(&ZERRLM COMPRESS RC=&MYCC)
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  SET MESSAGE TO TELL USER WHY THE LMCOMP FAILED                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
        IF (&MYCC EQ 10) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(NO DATA SET ASSOCIATED)
            SET &ZERRLM = &STR(&ZERRLM WITH GIVEN DATA-ID.)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 12) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(DATA SET NOT PARTITIONED OR)
           SET &ZERRLM = &STR(&ZERRLM DATA SET NOT ALLOCATED OR OPENED.)
          ENDO                                /* - - - - - - - - - */
        ELSE +
        IF (&MYCC EQ 20) THEN +
          DO                                  /* - - - - - - - - - */
            SET &ZERRLM = &STR(SEVERE ERROR, UNABLE TO CONTINUE.)
          ENDO                                /* - - - - - - - - - */
        GOTO FREEIT
      ENDO
/*                                                                 */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*  USE LIBRARY SERVICES TO FREE DATASET                           */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/*                                                                 */
FREEIT: +
    ISPEXEC LMFREE DATAID(&DSNID)             /*  DONE WITH IT     */
EXITIT: +
    ISPEXEC VPUT (ZERRALRM ZERRHM ZERRLM ZERRSM) SHARED
    ISPEXEC SETMSG MSG(ISRZ002)               /* SIGNAL MSGID      */
    IF (&STR(&ZERRLM) NE ) THEN WRITE &ZERRLM
    SET &MYCC = &LASTCC
    EXIT CODE(&MAXCC)
./ ADD NAME=ZTABLMAC 0104-92022-93218-0734-00005-00004-00000-KETCSC
ISREDIT MACRO
  ISPEXEC VGET (DESTZNE SKELDEST)
  ISREDIT LINE_AFTER .ZLAST = <1,&DESTZNE> + <10,&SKELDEST>
  ISREDIT CURSOR = .ZLAST 26
  ISREDIT SAVE

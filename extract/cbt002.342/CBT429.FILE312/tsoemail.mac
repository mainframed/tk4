Œ\INMR01


 

¦



     
 EXEC    
·
 
ECDS 


ormation                                             ===================
========
                                   Tÿ
n their router during July of        1992 that will present problems wit
e of this application if you         define the node IBMMAIL as a non-TS
                                                   ÿ
                                       BACKGROUND

                                       IBM Mail Exchange defines nÿ
type of mail application used on         that node.  If you are planning
this application then you are            probably defined to IMX as a TS
 The only message types supported        from your node into IMX are TSO
(ÿ
s.
                                           PROBLEM
                ÿ
                                             If node IBMMAIL is defined
-TSO node then this application will         send the messages in PROFS
hich IMX will reject.          ÿ
                                               SOLUTION

                                              ÿ
s a type OEM node with PROFS and NETDATA         message support.  This
ve the problem.
                                                 CAVEAT      ÿ

                                                   Acknowledgements that
 returned to your node from PROFS and OV/VM        systems will now be r
d by this dialog using the TSO RECEIVE               command as an Inval
Type because of a 'bug' in the RECEIVE               command.  This prob
aused by the acknowledgements having a               trailer record that
d for PROFSÿ
An APAR has been attempted with no success so          far (perhaps if e
opened a problem with IBM on this they might           listen better).
                          Æ                              

   * It is updated by the TMAILSAF REXX procedure which can be called by
   * the TSO administrator (or anyone with update authorization to this
   *ÿ
     * task.
     *
     * The format oÿ
       *
       *  Comments are indicated by an asterisk in column 1
       *                          ÿ
         *  Userids for which Safe Mail processing is to be performed ar
ied      *  one per card image with the userid in column 1 for a length
         *                                       ÿ
           *  Any information after column 8 is ignored
           *
           USERID1                                              ÿ
             USERID2
             USERID3
             USERID4
               ü
               
                                         //SAFEMAIL PROC
                                         //* ---------------------------
---------------------------*             /ÿ
                             *             //*   THIS STARTED TASK IS CA
E PER DAY BY THE AUTOMATION  *             //*   PRODUCT AND PRESERVES M
OR FILES FOR THOSE           *             //*   INDIVIDUÿ
 PREVENT THEIR OUTPUT FROM     *             //*   BEING PURGED FROM THE
OL BECAUSE OF AGE.             *             //*
                               *             //*
                                 *             //* AUTHOR:  LIONEL DYCK
                                 *             //* ---------------------
---------------------------------*             //IEFPROC  EXEC PGM=IKJEF
MNBR=50ÿ
'                                                //SYSTSPRT DD  SYSOUT=*
                                                 //SYSTSIN  DD  DUMMY
                      `                            //SYSEXEC  DD  DISP=S
ISC.ROCK.CLIST                                     
ADD NAME=BITSW
      MACRO
BEL   BITSW   &BIT0,&BIT1,&BIT2,&BIT3,&BIT4,&BIT5,&BIT6,&BIT7,&DSECT
        LCLC  &#
#       SETC  '#'
        AIF   ('&BIT0' EQ '').A
BIT0    EQU  ÿ
 &BIT0&#  EQU   128  .        1... ....      BIT POSITION
 .A       AIF   ('&BIT1' EQ '').B
 &BIT1    EQU   *  .        ÿ
   &BIT1&#  EQU   64  .         .1.. ....      BIT POSITION
   .B       AIF   ('&BIT2' EQ '').C
   &BIT2    EQU   *  .          BIT 2.     ÿ
     &BIT2&#  EQU   32  .         ..1. ....      BIT POSITION
     .C       AIF   ('&BIT3' EQ '').D
     &BIT3    EQU   *  .          BIT 3.                  ÿ
       &BIT3&#  EQU   16  .         ...1 ....      BIT POSITION
       .D       AIF   ('&BIT4' EQ '').E
       &BIT4    EQU   *  .          BIT 4.
         &BIT4&#  EQU   8  .          .... 1...      BIT POSITION
         .E       AIF   ('&BIT5' EQ '').F
         &BIT5    EQU   *  .          BIT 5.
        ÿ
           .F       AIF   ('&BIT6' EQ '').G
           &BIT6    EQU   *  .          BIT 6.
           &BIT6&#  EQUÿ
             .G       AIF   ('&BIT7' EQ '').H
             &BIT7    EQU   *  .          BIT 7.
             &BIT7&#  EQU   1  .      ÿ
               .H       ANOP
                        AIF   ('&DSECT' EQ '').I
               &LABEL   DS    XL1  .        BIT BYTE.ÿ
                          SPACE
                          MEXIT
                 .I       ANOP                                      ÿ
                   &LABEL   DC    XL1'0' .      BIT BYTE.
                            SPACE
                            MEND
   +
 ÿ
                       &LABEL   IFOFF &BIT,&BROF,&BRON
                                LCLB  &BL121,&BL122
                ÿ
                         &#       SETC  '#'
                                  AIF   ('&BIT' NE '').A
                               ÿ
                                    MEXIT
                           .A       ANOP
                           &BL121   SETB  ('&Bÿ
                             &BL122   SETB  ('&BROF' NE '')
                                      AIF   (&BL121 OR &BL122).AA
                                      MNOTE 1,'NO TRANSFER ADÿ
                                        MEXIT
                               .AA      ANOP
                               &LABEL   TM    &BIT,&BIT&#  .          TE
 BIT.                                     AIF   (NOT &BL122).OTHER
                                          BZ    &BROF  .
OT ON.                                    AIF   (&BL121).OTHER
           ÿ
                                            MEXIT
                                   .OTHER   BO    &BRON  .
 ON.                      ÿ
                                              MEND
                                     ./ ADD NAME=IFON
                                         ÿ
                                       &LABEL   IFON  &BIT,&BRYES,&BRNO
                                                LCLB  &BL121,&BL122
                                                LCLC  &#ÿ
                                         &#       SETC  '#'
                                                  AIF   ('&BIT' NE '').A
                                                  MNOTE 1,'OPERAND 1 MIÿ
 NO GENERATION'                                     MEXIT
                                           .A       ANOP
                                           &BL121   SETB  ('&BRYES' NE '
      ÿ
                                                      AIF   (&BL121 OR &
A                                                     MNOTE 1,'NO TRANSF
SS'                  +
                   ÿ
                                                 &LABEL   TM    &BIT,&BI
        TEST FOR BIT.                                     AIF   (NOT &BL
NO                                ÿ
          BRANCH ON.                                        AIF   (&BL12
                                                            SPACE
                                                 ÿ
                                                     .TAKNO   ANOP
                                                              BZ    &BRN
            BRANCH NOT ON.                                    SPÿ
                                                                MEND
                                                       ./ ADD NAME=REGEQ
-82323-82323-1417-000021-000021-000000-$A1238                   MACRO

                                                         ***************
************************************************         R0       EQU
              ÿ
                                                           R2       EQU
                                                           R3       EQU
                             ÿ
                                                             R5       EQ
                                                             R6       EQ
                                            ÿ
                                                               R8
                                                               R9
                                                           ÿ
10                                                               R11
11                                                               R12
12                                                               R13
  13                                                               R14
  14                                                               R15
  15                                                               *****
*********ÿ
ND                                                                   ./
=SETOF
CRO                     ÿ
SETOF &A,&B,&C,&D,&E,&F,&G,&H,&I,&J,&K,&L,&M,&N,&O,&P
LCLA  &NU
LCLC  &VALUE                           +
  LCLC  &#                           ÿ
    SETC  '#'
    AIF   ('&A' NE '').OK
    MNOTE 5,'MISSING OPERANDS - NO GEN'             ÿ
      MEXIT
      AIF   ('&LABEL' EQ '').B1
BEL   EQU   *                                                      ÿ
B1      ANOP
NU      SETA  N'&SYSLIST
CHK     AIF   ('&NU' NE '0').LOOP
  ÿ
          MEXIT
 .LOOP    ANOP
 &VALUE   SETC  'ÿ
            NI    &SYSLIST(&NU),255-&VALUE&#
   &NU      SETA  &NU-1
            AGO   .CHK          ÿ
              MEND
     ./ ADD NAME=SETON
              MACRO                            ÿ
       &LABEL   SETON &A,&B,&C,&D,&E,&F,&G,&H,&I,&J,&K,&L,&M,&N,&O,&P
                LCLA  &NU
                LCLC  &VALUE                                  ÿ
                  LCLC  &#
         &#       SETC  '#'
                  AIF   ('&A' NE '').OK
                    MNOTE 5,'MISSING OPERANDS - NO GEN'
                    MEXIT
           .OK      AIF   ('&LABEL' EQ '').B1
           &ÿ
             .B1      ANOP
             &NU      SETA  N'&SYSLIST
             .CHK     AIF  ÿ
                        SPACE
                        MEXIT
               .LOOP    ANOP              ÿ
                 &VALUE   SETC  '&SYSLIST(&NU)'
                          OI    &SYSLIST(&NU),&VALUE&#
                 &NU      SETA  &NU-1                    +
                            AGO   .CHK                 ÿ
                              MEND
                     ./ ADD NAME=XABSM    0100-89168-89168-1749-000019-0
0000-$A1238                   MACRO                                   ÿ
                       &LAB     XABSM &MODE=24
                                AIF   ('&LAB' EQ '').NOLAB CHECK FOR LAB
                       &LAB     DS    0H                  MVS/XA SET MOD
     ÿ
                                  AIF   ('&MODE' EQ '31').XAON
                                  AIF   ('&MODE' EQ '24').XAOFF
                    ÿ
                           .XAON    ANOP                      GO TO 31 B
                                    CNOP  2,4                 FORCE FULL
IGNMENT                            ÿ
E = 31 CODE                           O     R1,*+6 .               TURN
 = 31 BIT                             BSM   0,R1 .                 BRANC
DE = 31 CODE                          DC    X'8000ÿ
                                        AGO   .MACEND
                               .XAOFF   LA    R1,*+6 .               POI
ODE = 24 CODE                           BSM   0,R1 .             }     B
 AMODE = 24 CODE                 .MACEND  ANOP
                                          MEND
                                 {
  0105-90306-94189-1505-00020-00013-00000-$A1238             This librar
ns the source for:
                                                              ÿ
                                                               TMAILQRY

                                                                  This r
 is to be assembled and linked into LPALIB (for performance)        or L
nd is used to return a return code indicating if there              is m
e received for the user.
            ÿ
ubroutine SHOW
                                                                      **
 show.zip file for the showÿ
 to enable others to more easily get the show files
                                                                     J2M
JES2 Version of INMXZ02 TSO Exit          ÿ
- JES3 Version of INMXZ02 TSO Exit

hanks to Sam Lepore for providing the original of this coÿ

 no guarentees about this code.
NAME=J2MXZ02
******************************************************************
                                                                 *
ODULE NAME:  INMXZ02                                             *
       ÿ
 DESCRIPTION:  WELLS FARGO BANK TSO/E TRANSMIT TERMINATION EXIT    *
                                                                   *
      STATUS:  TSO/E Rÿ
                                                                     *
      FUNCTION:  ISSUE EQUIVALENT OF "$HASP549 MAIL FROM" MESSAGE    *
                 TO NOTIFY RECEIVING ÿ
 *                 (LOCAL TRANSMIT DOES NOT PASS THROUGH JES EXIT 13). *
 *                                                                     *
 *     OPERATION:  -  SEARCH ADDRESS LIST FOR LOCAL ÿ
   *                 -  IF FOUND, VERIFY OUTPUT TARGET IS JES SYSOUT
   *                      AND TRANSMISSION SUCCESSFULLY COMPLETED.
   *                 -  ISSUE "SE '$HASP549...',USER=(),LOGON" VIA +
     *                 -  ALWAYS RETURN CONDITION ZERO (CONTINUE ÿ
       *
       *     REGISTERS:  R0  -  PARM/WORK REGISTER
       *                 R1  -  PARM/WORK REGISTER
ÿ
         *                 R3  -  POINTER TO FROM-NODE NAME
         *                 R4  -  MACHINE LENGTH OF FROM-NODE NAME
         *     ÿ
 *         *                 R6  -  POINTER TO FROM-USER ID
 *         *                 R7  -  MACHINE LENGTH OF FROM-USER ID
 *         *                 Rÿ
   *         *                 R11 -  POINTER TO INPUT PARAMETER LIST
   *         *                 R12 -  BASE REGISTER
   *         *                 R13 -  BASE REÿ
     *         *                 R14 -  RETURN REGISTER
     *         *                 R15 -  RETURN CODE REGISTER
     *         *                                            ÿ
       *         *    ATTRIBUTES:  KEY 8, PROBLEM STATE, APF ON, REENTRA
       *         *
       *         *         INPUT:  R1, POINTER TO PARAMETER LIST, SEE PL
         *         *
         *         *        OUTPUT:  TSO MAIL MESSAGE ISSUED VIA OPERATO
OMMAND   *         *
         *ÿ
NSMIT      *         *
           *         *  CONTROL BLKS:  NONE (SVC 34 PARAMETER LIST BUILT
ALLY)      *         *   ÿ
             *         * MACROS & SVCS:  FREEMAIN, GETMAIN, RETURN, SAVE
             *         *
             *         *   ABEND CODES: ÿ
               *         ***********************************************
****************                  EJECT
                         ******************************ÿ
******************         *
                 *         *    CHANGE LOG:  SAM LEPORE     JANUARY 1985
                 *         *                   ORIGINAL VERSION       ÿ
                   *         *
                   *         *******************************************
********************                  EJECT
     +
   ÿ
************************         *        INITIALIZATION
                       *         ***************************************
******************ÿ
                                   INMXZ02  CSECT
                                            SAVE  (14,12),,INMXZ02_V1.0_
_&SYSTIME                        ÿ
 ENTRY POINT                                  USING INMXZ02,R12
UP BASE REGISTER                              LR    R11,R1
 PARM LIST ADDRESS                            USÿ
TABLISH ADDRESSABILITY                          GETMAIN RU,LV=WORKLEN
TAIN STORAGE                                    ST    R13,4(,R1)
AIN SAVE AREAS                                  ST    R1,8(,R13ÿ
                                                  LR    R13,R1
NEW SAVEAREA                                      USING WORKAREA,R13
ESTABLISH ADDRESSABILITY                 *
                                           *****************************
**********************************         *        VERIFY DATA WAS SENT
UT (NOT TO DATASET OR DDNAME)    *         *****************************
*************ÿ
                                                      L     R2,PLSTAFLG
    ADDRESS 1 BYTE STATUS FLAGS                       TM    0(R2),PLNOTJ
    DID OUTPUT GO NON-JES ? ÿ
      YES, DONE (NOTHING REALLY XMITD)         *
                                               *************************
**************************************     ÿ
ETERS POINTS TO A TWO TEXT UNIT LIST   *         *        THAT DESCRIBES
NSMITTING USER:                        *         *        PARM  ==> +0 P
=> USERID TEXT UNIT                    *         *        ÿ
 ==> NODE TEXT UNIT                      *         *
                                         *         *        NOTE: EVERY
T (T/U) IS OF THE FOLLOWING FORMAT       *         *      +0  KEY   DS
 TYPE OF T/U               (EG. X'1011'  ) *         *      +2  NUM   DS
 NUMBER OF LEN+PARM PAIRS  (    X'0001'  ) *         *      +4  LEN   DS
 LENGTH OF PARM VALUE      (    X'0006'  ) *         *      +6  PARM  DS
 ACTUAL ÿ
                                             *         *****************
**********************************************         *
                       +
XTU             ADDREÿ
R2)               ADDRESS SECOND T/U                                LH
R3)               GET LENGTH OF FROM-NODE                           BCTR
                  DECREMENT FOR EXECÿ
(,R3)               POINT TO FROM-NODE NAME                  *
                                                                      L
(,R2)               ADDRESS FIRST T/U              ÿ
,4(,R6)               GET LENGTH OF FROM-USER
,0                    DECREMENT FOR EXECUTE
,6(,R6)               POINT TO FROM-USER ID                    *  ÿ

R2,PLNUMREC             ADDRESS NUMBER RECORDS XMITED
R2,0(,R2)               GET NUMBER
Rÿ
  RECSXMIT,RECXMASK       MOVE IN PATTERN MASK
  R1,RECSXMIT+7           DEFAULT TO LAST DIGIT AS SIGNIF
  R8,R1         ÿ
MK  RECSXMIT,DBLWORD+4      CONVERT TO PRINTABLE
C   RECSXMIT(7),0(R1)       SLIDE RESULT LEFT (MAX 7 CHARS)
    R8,R1                   GETÿ
                                                                       *
**************************************************************         *
SEARCH ADDRESS LIST FOR LOCAL NODE            ÿ
****************************************************************

  LA    R5,PLTULIST             POINT TO ADDRESS OF DATA CHAIÿ
    USING AL@LIST,R5
SER EQU   *
    ICM   R5,B'1111',ALNEXT       ADDRESS NEXT TO-USER DATA
      BZ    RETURN0                 END OF CHAIN
      EX    R4,CLCNODE              COMPARE FROM/TO NODE NAMES
      BNE   NEXTUSER                NOT EQUAL, RECV JES2 WILL VERIFY
           ÿ
**********************************************************************
        VERIFY TRANSMISSION WAS SUCCESSFULLY COMPLETED               *
**************************ÿ
 *
          TM    ALFLAG,ALXMITOK         TRANSMIT SUCCESSFUL ?
          BNO   NEXTUSER                N+
   *                                   ÿ
     *******************************************************************
     *        ISSUE: $HASP549 MAIL FROM(NODENAME/USERID ) RECORDS(NNNNNN
     *           BY: SE '$HASP549 ...',LOGON,USER=(USEÿ
       *        USING: SVC 34 TO GENERATE AN "INTERNAL CONSOLE COMMAND"
       *****************************************************************
       *                                                             ÿ
                  MVC   MSGAREA(SE549LEN),SE549HDR  MOVE "SE '$HASP549 "
                  LA    R1,MSGAREA+SE549LEN     POINT TO NEXT BYTE FOR N
                  EX    R4,MVCNODE              MOVE IN FROM-NODE
    ÿ
                    MVI   0(R1),C'/'              MOVE IN SEPARATOR SLAS
                    EX    R7,MVCFUID              MOVE IN FROM-USER ID
                   ÿ
R ID                  MVC   0(L'SE549REC,R1),SE549REC  MOVE IN ') RECORD
RAL                   EX    R8,MVCRECX              MOVE IN NUMBER RECOR
D                     LA    R1,L'Sÿ
C XMIT                  MVC   0(L'SE549LGN,R1),SE549LGN  MOVE IN 'LOGON,
ITERAL                  LH    R2,ALUSERL              GET LENGTH OF TO-U
                        BCTR  R2,0               ÿ
NGTH                      EX    R2,MVCTUID              MOVE IN TO-USER
                          LA    R1,L'SE549LGN+1(R2,R1)  POINT TO BYTE AF
SER ID                    MVI   0(R1),C')'              MOVE IN ÿ
RENTHESIS                   LA    R2,MSGAREA-1            POINT TO BEGIN
NUS 1)                      SR    R1,R2                   GET REAL LENGT
PLETE MSG                   STH   R1,MSGAREA              STORE IN FIRST

                              SR    R0,R0                   NO CONSOLE N
                              LA    R1,MSGAREA              POINT TO PAR
              ÿ
                                MODESET KEY=NZERO
                                B     NEXTUSER                GO CHECK T
TO-USER                *     ÿ
                         ***********************************************
****************         *        SET ZERO RETURN CODE
               *         *******************ÿ
******************         *
                           RETURN0  EQU   *
                                    SR    R2,R2            +
CODE                         *                           ÿ
                               *****************************************
**********************         *        RETURN ROUTINE
                     *         *****************************************
************************         *
                                 RETURN   EQU   *
                                          LR    R1,R13
NTER OFÿ
D SAVEAREA ADDRESS                          FREEMAIN RU,LV=WORKLEN,A=(1)
TORAGE                                      LR    R15,R2
ETURN CODE TO R15     ÿ
RETURN                                        SPACE 3
                                     *
                                     ÿ
******************************         *        LITERALS AND CONSTANTS
                             *         *********************************
******************************         *            ÿ
                                         CLCNODE  CLC   0(0,R3),ALNODE
(EXECUTED) COMPARE FROM/TO NODE          MVCNODE  MVC   0(0,R1),0(R3)
(EXECUTED) MOVE FROM-NODE TO MSG         MVCFUID  MVC   1(0,R1),0(Rÿ
  (EXECUTED) MOVE FROM-USER TO MSG         MVCRECX  MVC   L'SE549REC(0,R
MIT (EXECUTED) MOVE NUM RECS XMITD         MVCTUID  MVC   L'SE549LGN(0,R
R   (EXECUTED) MOVE TO-USER TO MSG         RECXMASK DC    X'402020202020
  ÿ
                                             SE549HDR DS    0F
    SVC34 PARMS MUST BE WORD BOUNDRY                  DC    H'0'
    LENGTH INCLUDÿ
      FILLER REQUIRED BY SVC34                          DC    C'SE ''$HA
IL FROM('                                      SE549LEN EQU   *-SE549HDR
      LENGTH OF HEADER          ÿ
                                                 SE549LGN DC    C')'',LO
=('                                              *
                                               ÿ
                                                            SPACE 3
                                                   R0       EQU   0
                                                   R1       EQÿ
                                                     R2       EQU   2
                                                     R3       EQU   3
                                                     R4       EQU   4
                                                       R5       EQU   5
                                                         R6       EQU
                                                         R7       EQU
                                                         R8       EQU
          ÿ
                                                           R10      EQU
                                                           R11      EQU
                         ÿ
                                                             R13      EQ
                                                             R14      EQ
                                        ÿ
                                                               *
                                                               *********
****************************************************** ÿ
 AND MAPPING MACROES                                   *         *******
********************************************************         *
                                                                 WORKAÿ
T                                                                  SAVEA
  9D                      STANDARD REGISTER SAVEAREA               DBLWO
  D                       DOUBLE WORD FOR CONVERT-PRINT            RECSX
  XL8ÿ
    0F,CL128                MSG CREATION AREA (ON FULLWORD!)         WOR
U   *-WORKAREA                                                       *
                    ÿ
**************************************************************         *
LOCAL MAPPING FOR INMZX02 ENTRY PARAMETER LIST               *         *
***********************************ÿ

  DSECT                         ENTRY PARAMETER LIST
D DS    A                       ADDR OF A USER WORÿ
WDP DS    A                       ADDR OF KEYWORD PARM('STRING')
FLG DS    A                       ADDR OF 1 BYTE ACTION FLAGS
PPL DS    A                       ADDR OF TSO CMD PROCSR PARM LISÿ
MEMSG DS    A                       ADDR OF ERR MSG XMIT TO ISSUE
TAFLG DS    A                       ADDR OF 1 BYTE STATUS FLAGS
OTJES EQU   X'80'                     OUTPUT NOT JES (IS DSN OR DD)
ÿ
LFDTXTU DS    A                       ADDR OF FROM-DATASET TEXT UNITS
LTULIST DS    A                       ADDR OF TO-USER DATA CHAIN
LNUMREC DS    A+
 PLXMITRC DS ÿ
   *
   *********************************************************************
   *        LOCAL MAPPING FOÿ
     *******************************************************************
     *
     AL@LIST  DSECT                        ÿ
       ALNEXT   DS    A                       ADDR OF NEXT ENTRY, OR ZER
       ALNODEL  DS    H                       LENGTH OF TARGET NODE NAME
       ALNODE   DS    CL8                     TARGET NODE ÿ
         ALUSERL  DS    H                       LENGTH OF TARGET USERID
         ALUSER   DS    CL8                     TARGET USERID
         ALNICKL  DS    H                       LENGTH OF NICKNAME, OR Z
           ALNICK   DS    CL8                     NICKNAME OF USERID
           ALNAMEL  DS    H                       LENGTH OF NAME TAG, OR
           ALNAME   DS    CL30                    NAME TAG OF USERID
        ÿ
             ALNOTIFY EQU   X'80'                     REQUEST NOTIFY FOR
ERID         ALXMITOK EQU   X'20'                     XMIT SUCCESFULLY C
                      Dÿ
               ALPARML  DS    H                       LENGTH OF PARM TAG
O              ALPARM   DS    CL30                    PARM TAG OF USERID
               *                      ÿ
                          END
                 ./ ADD NAME=J3MXZ02  0101-88265-91217-0717-00281-00281-
1238             ************************************ÿ
**********         *
         *         *   MODULE NAME:  INMXZ02
         *         *                                                ÿ
           *         *   DESCRIPTION:  ROCKWELL INTERNATIONAL TRANSMIT T
ON EXIT    *         *
           *         *        STATUS:  TSO/E RELEASE 2.0
   ÿ
             *         *      FUNCTION:  ISSUE EQUIVALENT OF "IAT9154 FI
 MESSAGE     *         *                 TO NOTIFY RECEIVING USERS OF LO
 TRANSMIT.   *    ÿ
 JES3 CODE).   *         *
               *         *     OPERATION:  -  SEARCH ADDRESS LIST FOR LO
.              *         *       +
S JES SYSOUT     *         *   ÿ
Y COMPLETED.       *         *                 -  ISSUE "SE 'RAT9154...'
,LOGON" VIA SVC34 *          *                 -  ALWAYS RETURN CONDITIO
CONTINUE TRANSMIT).*         *                ÿ
                     *         *     REGISTERS:  R0  -  PARM/WORK REGIST
                     *         *                 R1  -  PARM/WORK REGIST
                     *         *                 R2  -  WORK ÿ
ED TO PASS RC TO R15)  *         *                 R3  -  POINTER TO FRO
AME                    *         *                 R4  -  MACHINE LENGTH
-NODE NAME             *         *                 R5  -  POINTER TO CUR
O-USER DATA              *         *                 R6  -  POINTER TO F
 ID                      *         *                 R7  -  MACHINE LENG
OM-USER ID               *         *                 R8  -  MACHINE LENG
MBER OF RECÿ
ARAMETER LIST              *         *                 R12 -  BASE REGIS
                           *         *                 R13 -  BASE REGIS
WORKAREA                  ÿ
                             *         *                 R15 -  RETURN C
STER                         *         *
                             *         * ÿ
 APF ON, REENTRANT             *         *
                               *         *         INPUT:  R1, POINTER T
TER LIST, SEE PL@LIST          *         *              ÿ
                                 *         *        OUTPUT:  TSO MAIL ME
SUED VIA OPERATOR SEND COMMAND   *         *
                                 *         *          EXIT:  ALWAYS CONÿ
CODE ZERO - CONTINUE TRANSMIT      *         *
                                   *         *  CONTROL BLKS:  NONE (SVC
METER LIST BUILT DYNAMICALLY)      *         *
      ÿ
IN, RETURN, SAVE, SVC 34             *         *
                                     *         *   ABEND CODES:  NONE
                     ÿ
****************************************                  EJECT
                                                 ***********************
************************************ÿ ****         *
                                         *         *    CHANGE LOG:  SAM
    JANUARY 1985                         *         *                   O
VERSION                                  *         ÿç
                                                       *         *
   LIONEL DYCK    JANUARY 1987                         *         *
    ROCKWELL INTERNATIONAL 110-SH28                    *         *ÿ
      2201 SEAL BEACH BLVD                               *         *
      SEAL BEACH, CA 90740                               *         *
      213-797-1125                                       *         *
 ÿ
                                                           *         ***
************************************************************
ECT             ÿ
                                                                       *
**************************************************************         *
INITIALIZATION                 ÿ
****************************************************************

  CSECT                                       ÿ
    SAVE  (14,12),,INMXZ02_V1.0_&SYSDATE
    LR    R12,R15                 SAVE ENTRY POINT
    USING INMXZ02,R12             SET UP BASE REGISTER       ÿ
      LR    R11,R1                  COPY PARM LIST ADDRESS
      USING PL@LIST,R11             ESTABLISH ADDRESSABILITY
      GETMAIN RU,LV=WORKLEN         OBTAIN STORAGE
        ST    R13,4(,R1)              CHAIN SAVE AREAS
        ST    R1,8(,R13)
        LR    R13,R1                  NEW SAVEAREA
        USIÿ
 *
 ***********************************************************************
 *        VERIFY DATA WAS ÿ
   *********************************************************************
   *
            L     R2,PLSTAFLG            ÿ
              TM    0(R2),PLNOTJES          DID OUTPUT GO NON-JES ?
              BO    RETURN0                 YES, DONE (NOTHING REALLY XM
     *                                                  ÿ
       *****************************************************************
       *        ONE OF THE ENRTY PARAMETERS POINTS TO A TWO TEXT UNIT LI
       *        THAT DESCRIBES THE TRANSMITTING USER:                  +
         *        PARM  ==> +0 POINTER ==> USERID TEXT UNIT          ÿ
 *         *                  +4 POINTER ==> NODE TEXT UNIT
 *         *
 *         *        NOTE: EVERY TEXT UNIT (T/U) IS OF THE FOLLOWING FORM
 *  ÿ
 ) *         *      +2  NUM   DS  XL2    NUMBER OF LEN+PARM PAIRS  (
 ) *         *      +4  LEN   DS  XL2    LENGTH OF PARM VALUE      (
 ) *         *     ÿ
ST') *         *
     *         *********************************************************
******         *                  ÿ
                          L     R2,PLFUTXTU             ADDRESS "FROM" T
ER LIST                   L     R3,4(,R2)               ADDRESS SECOND T
                          LH    R4,4(,R3)        ÿ
E                           BCTR  R4,0                    DECREMENT FOR
                            LA    R3,6(,R3)               POINT TO FROM-
E                  *                                            ÿ
                              L     R6,0(,R2)               ADDRESS FIRS
                              LH    R7,4(,R6)               GET LENGTH O
SER                           BCTR  R7,0                    DECREMENT FO

 ID                    *
                                L     R2,PLNUMREC             ADDRESS NU
ORDS XMITED   ÿ
                                  CVD   R2,DBLWORD              CONVERT
D DECIMAL FORMAT                  MVC   RECSXMIT,RECXMASK       MOVE IN
MASK                         ÿ
T DIGIT AS SIGNIF                   LR    R8,R1                   SAVE F
H COMPUTATION                       EDMK  RECSXMIT,DBLWORD+4      CONVER
NTABLE                              MVC   REÿ
 LEFT (MAX 7 CHARS)                   SR    R8,R1                   GET
LENGTH OF RESULT             *
                             ******************************ÿ
**********************         *        SEARCH ADDRESS LIST FOR LOCAL NO
                     *         *****************************************
**********************         *
                                          LA    R5,PLTULIST
 ADDRESS OF DATA CHAIN                    USING AL@LIST,R5
                                 NEXTUSER EQU   *
         +
S NEXT ÿ
OF CHAIN                                      EX    R4,CLCNODE
ARE FROM/TO NODE NAMES                        BNE   NEXTUSER
EQUAL, RECV JES2 WILL ÿ
                                       *********************************
******************************         *        VERIFY TRANSMISSION WAS
ULLY COMPLETED               *       ÿ
********************************         *
                                                  TM    ALFLAG,ALXMITOK
TRANSMIT SUCCESSFUL ?                             BNÿ
  NO, IGNORE                               *
                                           *****************************
**********************************         *        ISSUE: RAT9154 ÿ
ODENAME  /USERID  RECORDS(NNNNNNN) *         *           BY: SE 'RAT9154
GON,USER=(USERID)                  *         *        USING: SVC 34 TO G
AN "INTERNAL CONSOLE COMMAND"      *         ***************************
**ÿ
                                                        MVC   MSGAREA(SE
SE549HDR  MOVE "SE 'RAT9154 " HEADER                    LA    R1,MSGAREA
N     POINT TO NEÿ
        MOVE IN FROM-NODE                                 LA    R1,1(R4,
        POINT TO BYTE AFTER NODENAME                      MVI   0(R1),C'
        MOVE IN SEPARATOR SLASH ÿ
          MOVE IN FROM-USER ID                              LA    R1,2(R
          POINT TO BYTE AFTER FROM-USER ID                  MVC   0(L'SE
1),SE549REC  MOVE IN ') RECORDS(' LITERAL      ÿ
            MOVE IN NUMBER RECORDS XMITED                     LA    R1,L
C+1(R8,R1)  POINT TO BYTE AFTER NUM REC XMIT                  MVC   0(L'
,R1),SE549LGN  MOVE IN 'LOGON,USER=' LITERAL                  ÿ
              GET LENGTH OF TO-USER ID                          BCTR  R2
              DECREMENT FOR MACHINE LENGTH                      EX    R2
              MOVE IN TO-USER ID                                LA    R1
49LGN+1(R2,R1)  POINT TO BYTE AFTER TO-USER ID                    MVI
)'              MOVE IN FINAL RIGHT PARENTHESIS                   LA
EA-1            POINT TO BEGINNING (MINUS 1)                      SR
            ÿ
AREA              STORE IN FIRST HALFWORD FOR SVC                   MODE
ZERO                                                                SR
                  NO CONSOL+
SGAREA              POINTÿ
                      ISSUE COMMAND
KEY=NZERO
XTUSER                GO CHECK THE NEXT ÿ
                                                                 *******
********************************************************         *
RO RETURN CODE                                         ÿ
**********************************************************         *
                                                                   RETUR
  *                                                                   ÿ
    R2,R2                   ZERO RETURN CODE                         *
                                                                     ***
************************************************************         *
TURN ÿ
**************************************************************         *
                                                                       R
EQU   *             ÿ
  LR    R1,R13                  SAVE POINTER OF STORAGE
  L     R13,4(,R13)             GET OLD SAVEAREA ADDRESS
  FREEMAIN RU,LV=WORKLEN,A=(1)  FREÿ
    LR    R15,R2                  PASS RETURN CODE TO R15
    RETURN (14,12),RC=(15)        AND RETURN
    SPACE 3                                       ÿ

********************************************************************
      LITERALS AND CONSTANTS                                     ÿ
**********************************************************************

LCNODE  CLC   0(0,R3),ALNODE          (EXECUTED) COMPARE FROM/TO NODE
ÿ
 MVCFUID  MVC   1(0,R1),0(R6)           (EXECUTED) MOVE FROM-USER TO MSG
 MVCRECX  MVC   L'SE549REC(0,R1),RECSXMIT (EXECUTED) MOVE NUM RECS XMITD
 MVCTUID  MVC  ÿ
   RECXMASK DC    X'4020202020202120'     PATTERN MASK TO EDITMARK REC N
   *
   SE549HDR DS    0F          ÿ
              DC    H'0'                    LENGTH INCLUDING PREFIX
              DC    H'0'                    FILLER REQUIRED BY SVC34
              DC    C'SE ''RAT9154 FILE FROM +
       SE549LEN EQU   *-SE549HDR           ÿ
         SE549REC DC    C'  RECORDS('
         SE549LGN DC    C')'',LOGON,USER=('
         *                                                ÿ
                    LTORG
                    SPACE 3
           R0       EQU   0
             R1       EQU   1
             R2       EQU   2
             R3       EQU   3
        ÿ
               R5       EQU   5
               R6       EQU   6
               R7      ÿ
                 R8       EQU   8
                 R9       EQU   9
                 R10      EQU   10    ÿ
                   R11      EQU   11
                   R12      EQU   12
                   R13      EQU   13                 ÿ
                     R14      EQU   14
                     R15      EQU   15
                     *                                              ÿ
                       *************************************************
**************         *        DSECTS AND MAPPING MACROES
             *         *************************************************
***ÿ
                         WORKAREA DSECT
                         SAVEAREA DS    9D                      STANDARD
R SAVEAREA        ÿ
R CONVERT-PRINT            RECSXMIT DS    XL8                     RECORD
ITTED (PRINTABLE)          MSGAREA  DS    0F,CL128                MSG CR
REA (ON FULLWORD!)         WORKLEÿ
                             *
                             *******************************************
********************         *        LOCAL MAPPÿ
R LIST               *         *****************************************
**********************         *
                               PL@LIST  DSECT                  +
RAMETER LIST                     PLUSERWD DS    A            ÿ
F A USER WORD                      PLXMKWDP DS    A
F KEYWORD PARM('STRING')           PLACTFLG DS    A
F 1 BYTE ACTION FLAGS              PLTSCPPL DS    A
 OF TSO CMD PROCSR PARM LIST         PLXMEMSG DS    A
 OF ERR MSG XMIT TO ISSUE            PLSTAFLG DS    A
 OF 1 BYTE STATUS FLAGS              PLNOTJES EQU   X'80'
TPUT NOT JEÿ
DR OF FROM-USER TEXT UNITS             PLFDTXTU DS    A
DR OF FROM-DATASET TEXT UNITS          PLTULIST DS    A
DR OF TO-USER DATA CHAIN  ÿ
ADDR OF WORD, NUM RECORDS XMITED         PLXMITRC DS    A
ADDR OF WORD, TRANSMIT CMD RETCD         *
                                         ÿ
**********************************         *        LOCAL MAPPING FOR AD
ST DATA CHAIN OF TO-USERS        *         *****************************
**********************************         *            ÿ
                                             AL@LIST  DSECT
    ADDRESS LIST CHAIN OF TO-USERS           ALNEXT   DS    A
    ADDR OF NEXT ENTRY, OR ZERO              ALNODEL  DS    H          ÿ
      LENGTH OF TARGET NODE NAME               ALNODE   DS    CL8
      TARGET NODE NAME                         ALUSERL  DS    H
      LENGTH OF TARGET USERID                  ALUSER   DS    CL8
      ÿ
        LENGTH OF NICKNAME, OR ZERO              ALNICK   DS    CL8
        NICKNAME OF USERID                       ALNAMEL  DS    H
        LENGTH OF NAMÿ
          NAME TAG OF USERID                       ALFLAG   DS    X
          FLAG BYTE                                ALNOTIFY EQU   X'80'
            REQUEST NOTIFY FOR THIS ÿ
              XMIT SUCCESFULLY COMPLETED                      DS    X
            (RESERVED)                               ALPARML  DS    H
            LENGTH OF PARM TAG, OR ZERO            ÿ
              PARM TAG OF USERID                       *
                                                                END
                                                       ./ ADD NAMEÿ
23-93096-93130-1034-00330-00104-00000-$A1238             TMAILQRY TITLE
L QUERY COMMAND'                                         *--------------
-----------------------------------------------*         * MODULE NAME:
 +

 IS A TSO COMMAND THAT WILL BE USED                *         *
EST FOR MAIL TO BE RECEIVED FOR THE USER           *         *
              ÿ
ACCOMPLISHED BY USING THE SUBSYSTEM REQUEST          *         *
NFORMATION ON THE FIRST SYSOUT DATA SET IN THE       *         *
SOUT CLASS WITH AN EXTERNAL Wÿ
RRENT TSO SESSION (JOB NAME FROM TIOT).                *         *
                                                       *         *
 CODES:  0  - MAIL WAITING TO BE RECEIVED   ÿ
           >0 - NO MAIL TO RECEIVE                       *         *----
---------------------------------------------------------*         * SYN
AILQRY                                                   * ÿ
                                                           *         *
TMAILQRY USERID                                            *         *--
-----------------------------------------------------------*         *
TTRIBUTES:  AUTHORIZED,  RENT, REUS                          *         *
                                                             *         *
 SYS1.PARMLIB MEMBER IKJTSO?? TO ADD THIS AS AN AUTHORIZED   *         *
OMMAND.  ÿ
                                                               *
SING ACF2 COMMAND LIMITING THEN ALSO ADD THIS COMMAND TO THAT  *
ABLE.                   ÿ
-----------------------------------------------------------------*
IS MODULE WAS CODED BY LIONEL B. DYCK                            *
                       ROCKWELL INTERNAÿ
                         M/C  110-SE28                             *
                         P.O. BOX 2515                             *
                         SEAL BEACH, CAL 90740        ÿ
                           (310) 797-1125                            *
                           IBMMAIL:  USROKNTN                        *
                           INTERNET:  LDYCK@OSREQ48.ROCKWELL.COM     ÿ
 *                                                                     *
 *---------------------------------------------------------------------*
          EJECT
 *--ÿ
   *        LOCAL MACROS
   *--------------------------------------------------------------------
            PRINT O+
              MACÿ
       &LABEL   $PROLOG &LV=0,&GM=Y
       .****************************************************************
       .*                       ÿ
         .*       THIS MACRO WILL PROVIDE ENTRY LINKAGE AND OPTIONALLY
         .*       MULTIPLE BASE REGISTERS.  ALSO, VIA THE 'LV=' KEYWORD
         .*       PROVIDE ADDITIONAL USER STORAÿ
           .*       SAVE AREA) ADDRESSABLE FROM REG 13.  IF NO OPERANDS
           .*       ARE CODED, REG 12 IS ASSUMED THE BASE. EXAMPLE:
           .*              SECTNAME $PROLOG          = STANDARÿ
             .*              SECTNAME $PROLOG 5        = STANDARD, REG 5
             .*              SECTNAME $PROLOG 10,LV=20 = ADD 20 BYTES TO
EA           .*                                             REG 10 IS BA
               .*              SECTNAME $PROLOG R10,R11  = REGS 10 AND 1
SES            .*
               .********************************************************
******      ÿ
                          GBLB  &PRORG
                          GBLC  &PROGM
                 &AC      Sÿ
                   &LABEL   CSECT
                            B     32(R15)             BRANCH AROUND
                            DC    AL1(26) ÿ
                              DC    CL8'&LABEL'         CSECT NAME
                              DC    C'-'
                              DC    CL8'&SYSDATE'       Cÿ
                                DC    C'-'
                                DC    CL8'&SYSTIME'       COMPILE TIME
                                CNOP  0,4                 ALIGNMENT
                                  STM   R14,R12,12(R13)     SAVE REGISTE
                                  LR    R12,R15             LOAD BASE RE
                                  USING &LABEL,R12          INFORM ASSEM
       ÿ
                                    AIF   ('&GM' EQ 'N').NOGM
                           &PROGM   SETC  'GETMAIN'
                      ÿ
LENGTH VARIABLE                       GETMAIN R,LV=(0)          GET CORE
EAREA AND USER                        AIF   (&LV+72 LE 256).XC2
                                     +
                                   ÿ
O FIRST BYTE                              LR    R2,R1               SAVE
 IN EVEN REG                              LA    R4,1(R1)            SET
G POINTER                                 LR    R5ÿ
ING LENGTH                                  BCTR  R5,R0               DE
LENGTH                                      LA    R5,0(R5)            CL
 ORDER BYTE                                 LA    R3,1           ÿ
ING LENGTH                                    MVCL  R4,R2
ION PADS WITH X'00'                           AGO   .STORE
                                     .XC1     ANOP
ÿ
LEAR SAVE AREA                                  XC    0(256,R1),0(R1)
LEAR SAVE AREA                                  AGO   .STORE
               ÿ
                                                  XC    0(&LV+72,R1),0(R
 CLEAR SAVE AREA                                  AGO   .STORE
                              ÿ
                                                    CNOP  0,4
                                                    LA    R1,SAVE&SYSNDX
                                             ÿ
                                             SAVE&SYSNDX DC 18F'0'
                                             .STORE   ANOP
                                                      ST    ÿ
  SAVE BACK CHAIN                                       ST    R1,8(R13)
  SET FORWARD CHAIN                                     LR    R11,R1
  SAVE NEW SAVEAREA ADDRESS                             L     R15,16(R13
    RESTORE REG 15                                        ST    R0,16(R1
    SAVE SAVEAREA LENGTH                                  LM    R0,R1,20
    RESTORE REGS USED IN GETMAIN                          LR    R13,R11
    SET SAÿ
 0).MEND                                                    AIF   ('&SYS
 EQ 'R12').SKIPIT                                           AIF   ('&SYS
 EQ '12').SKIPIT         ÿ
&LABEL  LOAD REQUESTED BASE REG                               DROP  R12
        DROP ASSUMED BASE REG                                 USING &LAB
IST(1)  INFORM ASSEMBLER                ÿ              .SKIPIT  ANOP
                                                       &AA      SETA  2
                                                       .LOOP    ANOP
                                                       ÿç
F   (&AA GT N'&SYSLIST).MEXIT                                        &AB
TA  &AA-1
    &SYSLIST(&AA),2048(&SYSLIST(&AB))  LOAD NEXT BASE REG             ÿ
LA    &SYSLIST(&AA),2048(&SYSLIST(&AA))  LOAD NEXT BASE REG
USING &LABEL+&AC,&SYSLIST(&AA) INFORM ASSEMBLER                        &
SETA  &AC+4096                                                         &
SETA ÿ
  AGO   .LOOP
  ANOP
  AIF   (&PRORG).MEXÿ
    SPACE
    $REGS
    SPACE                          ÿ
X2    ANOP
      SETA  &LV+72
      MNOTE *,'TOTAL STORAGE AREA RECEIVED = &AA' ÿ
        MEXIT
MEND    ANOP
        MNOTE *,'NO REGISTER SPECIFIED - R12 ASSUMED'            ÿ
          AGO   .MEXIT
 .MERR    ANOP
          MNOTE 12,'LV > 4023 - REQUEST IGNORED'
ÿ
            MEND
            MACRO
   &LABEL   $EPÿ
              GBLC  &PROGM
     &LABEL   LR    R1,R13              GET SAVEAREA ADDRESS
              L     R13,4(R13)ÿ
                AIF   ('&PROGM' NE 'GETMAIN').NOFREE
                L     R0,16(R13)          GET SAVEAREA LENGTH
                ST    R15,16(R13)         SAVÿ
                  FREEMAIN R,LV=(0),A=(1)   FREE SAVEAREA
                  AGO   .LM
         .NOFREE  ANOP                                      ÿ
                    ST    R15,16(R13)         SAVE REGISTER 15 (RETCODE)
           .LM      ANOP
                    LM    R14,R12,12(R13)     RESTORE CALLERS REGS
                      AIF   (T'&RC EQ 'O').SPEC
                        LA    R15,&RC             SET RETURN CODE
               .SPEC    ANOP
                        BR    R14                 RETURN TO CALLER
        ÿ
                          MACRO
                          $REGS
                       ÿ
                            AIF   (&PRORG).MEX2
                   &PRORG   SETB  1
                    SPACE             ÿ
                     R0       EQU   0
                     R1       EQU   1
                     R2       EQU   2                ÿ
                       R3       EQU   3
                       R4       EQU   4
                       R5       EQU   5                             ÿ
                         R6       EQU   6
                         R7       EQU   7
                         R8       EQU   8
   ÿ
                           R10      EQU   10
                           R11      EQU   11
                  ÿ
                             R13      EQU   13
                             R14      EQU   14
                             R15 ÿ
                                SPACE
                               REG0     EQU   0
                               REG1     EQU   1 ÿ
                                 REG2     EQU   2
                                 REG3     EQU   3
                                 REG4     EQU   4              ÿ
                                   REG5     EQU   5
                                   REG6     EQU   6
                                   REG7     EQU   7
                                     REG8     EQU   8
                                     REG9     EQU   9
                                     REG10    EQU   10
             +
           ÿ
                                         REG13    EQU   13
                                         REG14    EQU   14
                          ÿ
                                            SPACE
                                           .MEX2    ANOP
                                         ÿ
                                                      PRINT ON
                                                      EJECT
                                             TMAILQRY $Pÿ
                                                        USING WORK,R13
                                                        EJECT
                                               *-----------------------ÿ
---------------------------------------*         *        GET USERID TO
M PARM OR TIOT                         *         *----------------------
---------------------------------------*                  L     R1,0(R1)
      ÿ
    LOAD OFFSET                                             LH    R3,0(R
    LOAD LEN                                                SR    R3,R2
                     ÿ
      LESS HEADER                                             LTR   R3,R
      ANY LENGTH ?              *LBD 04/93*                   BZ    DOTI
      ZERO SO GET FROM TIOT     *LBDÿ
        ELSE CHECK LENGTH                                       BH    DO
        TOO LONG - IGNORE                                       AR    R1
        -> PARM                                    ÿ
          SKIP CMD HEADER                                         CLI
 '        CHECK FOR VALID PARM                                    BE
          NO PARM REALLY                                          ÿ
01'         LESS 1 FOR MVC                                          EX
MD                                                                  OC
M,=CL8' '   INSURE UPPER CASE                                       LA
Pÿ
SOB                                                          MVCMD    MV
ARM(0),0(R1)                                                 DOTIOT   DS
                ÿ
,16             -> CVT
,0(,R5)         -> TCB WORDS
,0(,R5)         -> MY TCB      +
R5,12(,R5)        -> MY TIOT ÿ
  R5,0(,R5)         -> MY JOBNAME
E 2                                                                *----
--------------------------------------------ÿ
T UP SSOB FOR SPOOL ACCESS                                 *         *--
-----------------------------------------------------------*
ACE                                                        ÿ
DS    0H
LA    R4,XSSOB           GET SSOB EXTENSION ADDR
ST    R4,SSOBPARM           SAVE IT IN SSOB
  OI    SSOBPARM,X'80'          AND SET FLAG
  XC    XSSOB,XSSOB           AND ZERO WORK AREA
  LA    R4,XSSOB
  USING Sÿ
    MVC   SSOBID,=C'SSOB'     INITIALIZE SSOB
    MVC   SSOBLEN,=AL2(SSOBHSIZ)
    MVC   SSOBFUNC,=AL2(ÿ
      MVC   SSSOLEN,=AL2(SSSOSIZE)
      OI    SSSOFLG1,SSSOSPGM   SET WTR NAME SELECTION FLAG
      MVC   SSSOPGMN,0(R5)      SET JOBÿ
        LA    R1,SSOBGN
        ST    R1,SSOBINDV
        MVC   SSSOCLSL,CLASS      SET CLASS FOR MAIL  ÿ
          EJECT
 *---------------------------------------------------------------------*
 *        ISSUE SUB SYSTEM REQUEST FOR FIRST SPOOL DATA-SET          ÿ
   *--------------------------------------------------------------------
            MODESET MODE=SUP,KEY=ZERO
            XC    SSSOFLG2,SSSOFLG2
    ÿ
              XC    SSSOUFLG,SSSOUFLG
              LA    R1,SSOBPARM
              IEFSSÿ
                LR    R2,R15              SAVE RTN CODE
                MODESET MODE=PROB,KEY=NZERO
                LTR   R2,R2       ÿ
                  BNZ   EXIT8
         CKRTN    CLC   SSOBRETN,=AL4(SSSORTOK)
                  BE    EXIT0                    +
                    CLC   SSOBRETN,=AL4(SSSOEODÿ
                      BE    EXIT4
                      CLC   SSOBRETN,=AL4(SSSOUNAV)
                      BE    EXIT16                            ÿ
                        CLC   SSOBRETN,=AL4(SSSODUPJ) DUPLICATE JOB #
                        BE    EXIT0               GET JOB ID FROM SSIB
                        B     EXIT12
                 EXIT0    EQU   *
                          LA    R2,0
                          B     EXIT
            ÿ
                            LA    R2,4
                            B     EXIT
                   EXIT8   ÿ
                              LA    R2,8
                              B     EXIT
                     EXIT12   EQU   *     ÿ
                                LA    R2,12
                                B     EXIT
                       EXIT16   EQU   *                  ÿ
                                  LA    R2,16
                         EXIT     DS    0H
                                  OI    SSSOFLG2,SSSOCTRL
                                    MODESET MODE=SUP,KEY=ZERO
                                    LA    R1,SSOBPARM
                                    IEFSSREQ
       ÿ
                                      LR    R15,R2            SET RETURN
                                      $EPILOG ,
                      ÿ
                               *----------------------------------------
---------------------*         *        DATA AREAS
                     *         *-----ÿ
-----------------------*                  LTORG
                                          SPACE 2
                                 CLASS    DC    CL8'ÿ
UT CLASS FOR MAIL                           SPACE 2
                                            EJECT
                                   *-------------------------------+
---------------------------*         *        MAPPING MACROS     ÿ
                             *         *--------------------------------
-----------------------------*         WORK     DSECT
                                                DS    18F
ÿ
                                                  DS    0D
                                         XSSOB    DS    140X
               ÿ
                                                    TITLE 'SSOB'
                                                    IEFJSSOB SO
                              ÿ
                                                      IEFJSSIB
                                                      TITLE 'JES CT'
                                             ÿ
                                                        TITLE 'CVT'
                                                        CVT   DSECT=YES,
                                                        END  
                                                 {
s package contains the Rockwell International, modified and enhanced
Kaiser Permanente, developed ISPF Dialog for processing mail on an
/TSO system.  The package was developed under MVS/XA 2.2.3, TSO/E 2.1
nd ISPF 2.3.  The dialog is written entirely in TSO/E REXX.  This
ialog will receive both messages and files that have been sent to the
xecuting user.  Files will be received into a unique data set without
rompting the ÿ

 The primary dialog elements provided are:
                            ÿ
   Rexx EXECs:

   TMAILLOG      This is the primary exec uÿ
                   application dialog.  It displays a menu allowing the
                   to select, review, create and delete log files.
                                                          ÿ
       TSOMAILM      This is the primary exec and is the entry point for
                     dialog.  It displays a menu allowing the user to se
                     open and read their mail or to send a note.

         TSOMAIL       This is the exec that actually performs the readi
e                      mail and the building/displaying/processing of th
        ÿ

           TMAILCPY      This exec is used for copying the files that ar
ed                     ÿ

             TMAILDEF      This exec is used to establish the defaults u
                           the other eÿ

               TMAILEDM      This exec is the ISPF EDIT Macro that estab
he                           environment used for entÿ
es.
                 TMAILEDX      This exec is the ISPF EDIT Macro that cle
he                             message and inserts the sendor informÿ
subject.
                   TMAILESM      This exec is the ISPF EDIT Macro that b
e SMTP                           message headers.
   +
 ÿ
sses the                             ISPF EDIT CANCEL command.

                ÿ
cesses the                             ISPF EDIT END command.

                         TMAILEÿ
ilds the PROFS                           header and trailer information
messages to PROFS.
                           TMAILPTF      This ÿ
terse a PTF file                           received via IBM Expedite/Mai

                             TMAILSAF      This exec is used ÿ
 process.
                               TMAILSND      This exec is used for sendi
ges and/or messages and                      files.  It is invoked by th
AIL exec for the command                       SENDMAIL and for the Answ
orwarding functions.
                                 TMAILNIK      This exec is used for the
e managemenÿ
eing developed.                                  ** This is in developme
s not complete                                   ** but it is usable.
                          ÿ
                                     TMIBMFAX      This is an ISPF Edit
r when you are in the Transmit                     application that will
for the building of the correct          ÿ
e to IBMMAIL.FAX and have it                         then sent as a fax
pecified phone number.
                                                        ÿ
                                         The TSOMAIL exec has a very goo
 with the logic of the dialog            spelled out in it.  You should
t to fully understand what               is happening.                 ÿ

                                           Create MAILCMDS, an ISPF Comm
e with the following:
      ÿ
                                                                  Log co
r TSO/E Mail                                 '''' RFIND     0  &USRFIND
                     +
ru variable        ÿ
                                                 Updates to ISPCMDS can
e the use of this dialog.  Sample updates follow:
                                  ÿ
%TSOMAIL READ) NEWAPPL(MAIL)
TSO/E ISPF MAIL TABLE                              '''' RECEIVE   0  SEL
%TSOMAIL) NEWAPPL(MAIL)                          ÿ
SO/E INTERACTIVE DATA TRANS MSGS {ALIAS RECV}        '''' RECV      0  S
D(%TSOMAIL) NEWAPPL(MAIL)
SO/E INTERACTIVE DATA TRANS MSGS {ALIAS RECEIVE}     '''' NICK  ÿ
CMD(%TMAILNIK) NEWAPPL(MAIL)
E-Mail Nick Name Dialog                                '''' SAFEMAIL  5
CMD(%TMAILSM  &ZPARM) NEWAPPL(MAIL)

T CMD(%TMAILSND &ZPARM) NEWAPPL(MAIL)
ANSMIT A MESSAGE USING TSO/E IDTF (ALIAS XMIT)           '''' TSOMAIL
T CMD(%TSOMAILÿ
TSO ISPF MAIL APPLICATION                                  '''' XMIT
ECT CMD(%TMAILSND &ZPARM) NEWAPPL(MAIL)
TRANSMIT A MESSAGE USING TSO/½ E IDTF (ALIAS TRANSMIT)       {

                    thus:
                    EXec 'dsname(RECEIVE)'
          ÿ
                      EXEC and PANELS members to create 2 new datasets:
                      userid.TSOEMAIL.NEW.EXEC and
                      useÿ
                        userid.TSOEMAIL.NEW.PANELS
                        You will then need to copy these datasets/member
                        datasets for proÿ
                          */

                       parse source with x1 x2 x3 dsn .ÿ
                          x = PROMPT("ON") /* enable prompting */
                         queue "dsn(TSOEMAIL.new.exec)"
                         "Receive inds('"dsn"(exec)')"                ÿ
                           queue "dsn(TSOEMAIL.new.msgs)"
                           "Receive inds('"dsn"(msgs)')"
                           queue "dsn(TSOEMAIL.new.panels)"
     %                       "Receive inds('"dsn"(panels)')"
                     
 dataset:
                                                  $README   - what you a
ng                                              ÿ
S2/3 exits and TMAILQRY source                      DOCUMENT  - very bri
entation                                            EXEC      - IDTF for
 Exec library                                       IBMMAIL   -ÿ
 on IBMMail                                           MACROS    - IEBUPD
s for ASM                                             MSGS      - IDTF I
age library                                           PANELS    - IDTF I
nels library                                            PROCLIB   - IEBU
ple SAFEMAIL proc                                       RECEIVE   - ** m
ed to automatically convert the IDTF                                ** m
nto real dataÿ
taset for SAFEMAIL
                                                          Note: IDTF sta
Interactive-Data-Transmissioÿ
T.
                                                         This data set c
an ISPF dialog that was developed using TSOÿ
ss mail and files sent to and from TSO using the           IBM provided
SMIT and RECEIVE commands.  It has been tested             most recently
SPF 4.4 under OS/390 V2R4.                                ÿ
                                                             A new addit
n ISPF Command Table for use with the dialog to support      the use of
command to enter the mail log dialog.  This must be          created usi
 following steps:
                                                                   1.  E
F 3.9 (Commands)                                                   2.  S
AIL for ÿ
 a verb of LOG
   t of 0
   action of PASSTHRU  ÿ
     description of - LOG command for TSO/E-Mail Dialog                4
o save
                                      ÿ
ed as part of this package is a TSO/E SAFE Mail application          tha
eceive mail messages and mail files for user's who are out           of
ce and thus unable to RECEIVE their mail before the J+
 of aged data.                                     ÿ

*** WARNING *********  WARNING  **********  WARNING *********
uploading this file from a PC to the host you may encounter *     ÿ
haracter translation problems (this has been reported with    *
ERM and PC/3270).  If you suspect or know that you have this  *
blem then after the upload:                                   *
 ÿ
   Change  x'52'  to   x'5F'                                    *
           x'6A'  to   x'4F'                                    *
****************ÿ

aveats:  Use this at your own risk and only after you have reviewed
very line of Rexx code to insurÿ
 is nothing that might be contrary to your installation standards or
 practices.  I have tried to remove or document all of the installation
 dependencies that I could find or think of, bÿ
   few - please let me know of any that need to be fixed or documented.

   If you find a problem, please let me know.  I may or may nÿ
     fix it depending upon your and my operating environment, but I will
     Also, if you have any extensions, fixes, etc. for this dialog pleas
     me know.

       All comments, suggestions, extensions/enhancements should be sent

           ÿ
              Kaiser Permanente
              Technical Services
              25 N. Via Moÿ
                Walnut Creek, CA 94598
                925-926-5332
                                         ÿ
                  Electronic Mail Addresses:
                       Internet:        lionel.b.dyck@kp.org
                                                        ÿ
               This data set contains the following members:

               >> This dialog has been updated to work at Kaiser and pr+
                 >> has the use of show and tmailqry commented out.  ÿ
                   >>
                   >> This will be corrected once I have implemented tho
s                  >> here at Kaiser.
    ÿ
                     The dialog now uses a new TSO command, TMAILQRY, th
s to                 determine if there is mail to receive.  This comman
e authorized       ÿ
thorized               TSO commands.  If you have ACF2 then it must also
uded in your           command limiting table.
                                  ÿ
                         JES3 users should code IATUX42 to generate a me
 TSO users when          mail is received from another node.
                                                 ÿ
                           JES2 users should code Exit 13 to generate a
to TSO users when          mail is received from another node.
                                                                ÿ
                             Special note about sending messages from TS
FS.  The dialog now          supports the sending of messages from TSO t
in the PROFS format.         This means that the PROFS user will see the

exists a problem when          acknowledgements are requested for these
 messages in that the          acknowledgement is returned to the MVS sy
a form that caÿ
o circumvention for this         at this time and IBM does not recognize
 a problem.
                             ÿ
ity that is designed to be         a started task that wakes up every 24
r is started by some               automation or job scheduling system o
y and it will read a users         mail and ÿ
 vacation or out of the              office for whatever reason.  This i
vent their mail from being           purged from the JES spool because o
                                                           ÿ
                                       SAFEMAIL requires TSO OPER author
t performs a RECEIVE on behalf         of other users and the RECEIVE co
forces this.  SAFEMAIL should          also be given the ability to allo
ata sets under any high level            index as the RECEIVE command wi
ate data sets for those users            who request it and you will not
 have SAFEMAIL abending because          of security.
         +
       ÿ
og a number of Rockwell dependencies         that you will have to addre
e you can completely install and             utilize this dialog.  These
ncies are:            ÿ
                                               Asm:     SHOW and SHOWTSO
                                                        These are the su
e and the TSO command that we use to ÿ
om various system control blocks and                      from ACF2.  Yo
 look VERY closely at the SHOW subroutine                 to remove anyt
t is local to Rockwell or does not apply            ÿ
  The full SHOW package is now included                     as of 4/28/9
cludes a CLIST and REXX function as well                    as a SHOWSPF
- sample link jcl is also included.                                ÿ
                                                     Panels:  TMAILMNU
                                                              This menu
lls the TMAILDEF exec to establish a set of                   defaults f
y ÿ
                                                       Execs:   TMAILDEF
                                                                This exe
he Rockwell TSO Cÿ
ion that is used by other elements of the ISPF                    dialog
an/should replace the use of SHOWTSO with your                    own de
ecification.  Or you can remove ÿ
 as this exec displays an ISPF Panel for the                        defa
 requires that they be filled in.
                                               ÿ
                                                                      Th
is used for the TSO Safe Mail process and uses the                    SH
mmand to extract the center name.  Based upon center          ÿ
a high-level index that is used for the control data
 and the log data set (this log is only used when the
command is issued for SAFEMAIL userid processing).

M
xec allocates a temporary file used for the message text
s sent to thÿ
egister for safe mail processing.  The unit value is
IO.  This exec also used the SHOWTSO command to extract
current home node (center).+
                         ÿ
TMAILPTF
This exec will unterse IBM PTF files received via Expedite/Mail
(ordered via IBMLINK).  The load libraryÿ
  unterse load module must be updated to reflect your library.

  TMAILSND                                             ÿ
    This exec allocates a temporary file used for entering the text
    of messages to a unit of SYSVIO.  If you have SYSVIO defined
    for VIO then you do not have to change this exec, otherwise       ÿ
      SYSVIO must be changed to either real disk or your VIO
      esoteric.

     ÿ
        if you wish to send mail via SMTP (e.g. Internet, Bitnet).

        This exec alÿ
          determine if the node is TSO or non-TSO.  You will need to
          update this list of node names.
                                   ÿ
            TMFIXSUB

            This exec is an ISPF Edit Macro that wÿ
              of the note being sent based on information in the text.
              would be used when forwarding a note from someone else or
              frequently sending an IBM announcement letter.  Theÿ
                aliased to FIXSUB in the initial edit macro and is invok
                entering FIXSUB on the edit command line.

ÿ

                  This exec is an ISPF Edit Macro that will build the ap
e              ÿ
                    service for delivery via a fax machine.  It is invok
                    entering FAXIBM on the ISPF Command Line while in th
                    creation Eÿ

                      TSOMAIL
                      This exec uses the Rock+
ct the                  current NJE Node Naÿ
our own                   command/clist/exec or hard code the node name
xec.                      This exec also defaults the name of the users
 log data                 set to userid.LOG.MISC.  If thisÿ
 (look at                   your INMXPARM assembly) then you must change
ec.  This                   exec also uses the PDS TSO command when the
mail table                  data set is full and must be reallocated and
d.  If you do                 not have the PDS command (it's free from v
VS tools                      tapes) then you should change the copy to
OPY or some                   other copy command.  Another dependency is
 of the ÿ
dialog of                       various print drivers for different vend
ters.  This                     dialog is not provided with this data se
 can probably          ˆ          do it better.
                         {
RA
COPYÇ
TSOEMAIL
¤
s



©



LARM = YES         ÿ
                                                           MAIL001  'Err
RM = YES                                                   ') Sub Option
d are 0 thru 8 only and only for O` ption S'                   
R06                                                            

2429
¦
¦

 YÃ\


 



p
 
MAILSAF
‰
ü°Ü0
ð
Ä
 

ÿÿÿÿÿÿ
©


xec */
   "(SENDLINE) = LINENUM .ZLAST"
                      "CANCEL"
                          end
SUBJ,SENDSTMP) SHARED"
RM3,SENDCTR) PROFILE"
OG3 EPILOG4 EPILOG5)",
GET (EPILOG6 EPILOG7 EPILOG8 EPILOG9 EPILOG10)",
        Address ISPEXEC "VGET (TMAILEPI)" PROFILE
F"
dsubj
BJ)"
ÿ
E .ZF =",

  "'Date:   " s+
         '"
 '    '"
gth(sendfrm3) > 0 then
"
         "sendfrm3"'"
length(epilog1) > 0 then do
ÿ
LINE_BEFORE .ZL ='"epilog2"'"
) > 0 then do

L ='"epilog4"'"

if length(epilog6) > 0 then do
"
  "LINE_BEFORE .ZL ='"epilog7"'"
og8) > 0 then do
  end
 .ZL ='"epilog9"'"
 do
     end





       /*                                            ÿ
      /* -------ÿ
     Address ISREDIT "MACRO (PARM) NOPROCESS"
DEFINE CANCEL RESET"  /* reset CANCEL back to normal */
EDIT "DEFINE END    RESET"  /* reò set END    back to normal */
 Address ISREDIT "END"
"VPUT (MAILEND)"
ro ÿ
--------------------------------------------- */
                                           */ÿ
cro is used as an ÿ
he TMAILSND exec.                        */
                                      */
---------------------------------+
M) NOPROCESS"
 END back to normal */
t]  CANCEL back to normal */
Address ISREDIT "END"
XEC "VPUT (MAILEND)"

        else cmd userid


 option
XEC "SELECT PANEL(TMAILMNU) NEWAPPL(MAIL)"
ess ISPEÕ XEC "SELECT PANEL(TMAILMNU) OPT("option") NEWAPPL(MAIL)"

essing */
------ */
*/

    /*                                                         */
--------------------------------x ----------------------- */
ISPEXEC "DISPLAY PANEL(TMAILDEF)"
EL(TMAILSUF)"
---------------  rexx procedure  ---------------------- *
   TMAILESM                                           *
                                                      *
:  Update the message to be transmitted to            *
 an SMTP (aka SMTPID) address.                      *
                                                    *
 ISPEXEC EDIT DATASET(...) MACRO(TMAILESM)          *
                                                  *
nel B.ÿ
ser Permanenÿ
N. Via Monte Ave.                               *
t Creek, CA 94598    ÿ
 926-5332                    ÿ
net: lionel.b.dyck@kp.org                     *
                                    ÿ
                                            *
7 - set replyto to sendid if null           *
- Add replyto field and change author adr *
- Created                                 *
                                            *
----------------------------------------- */
ACRO"
--ÿ
         *
------ */

var(sysuid)"@"smtphost
pt to:' FIRST"
lse do
(CLINE) = CURSOR"
        "CURSOR =" cline
ption
tpid "'"
     "LINE" cline "= 'Sender: " sendid "'"
T"
   "Line" line "= 'rcpt to:   <"smtpid">'"
nd 'helo ' FIRST 1"
 = 'helo "smtphost "'"
'"
   <"ÿ
 "= 'data'"

           parse valueÿ
)

"Line_after" line "= 'Reply-To: "replyt] o"'"
+1 "= 'X-Mailer:",
       end
²
------------------ */
                  */
                   */ÿ
AIL exec            */
 information       */
Execio.             */
                     */
                    */
Technology           */
                        */
                       */
                      */
rgÿ
                        */
                       */
         ÿ
                         */
                        */
ualified dsns          */
                          */
                         */
BGENER for sequentials  */
                           */
to new pds                */
                         */
 return code test           */
                           */
                          */

blem with call of iebgener  */
KLIB(IEBGENER)')           */
Y SYSPRINT fÿ
 SYSPRINT to terminal        */
SYSIN to terminal           */
                           ÿ
PY control card               */
oblem with call of iebcopy   */
PY"                         */
ck                             */
procedure                       */
                               */
------------------------------- */
mailfloc mailfid
        upper debug
 /* set the vio variable to your vio generic */

me = substr(m3,x+1,length(m3)-x)
listdsi+
en neÿ

rwise newdisp = "NEW"
newdisp = "SHR" thenÿ
       else newrep = "YES"
EXEC,
   "MAILLMSG NEWNAME NEWDISP NEWREPÿ
            parse value '' with zcmd newstat
ISPLAY PANEL(TMAILCPY)"
 0 then do
e
) <> "'" then do
(",newname)-1)
     elseÿ

'"
ÿ

p <> "NEW" & newdisp <> "MOD" then do
 data set" newnÿ
sposition of NEW."
   end
          maillmsg = "Target dÿ
newname "exists and Disposition",
                     signal copyfile
  if x <> "OK" & newdisp = "MOD" then newdispÿ
istdsi(mailtds directory)
sdsorg = "PO" & newdisp = "MOD" then do
osition of 'MOD' is not allowed for a PDS",
ify SHR or OLD+
  end
p = "YES" then

=SYSUT2'
                 if newdisp = "NEW" then
2) DS("newÿ
("sysadirblk")"
LE(SYSUT2) DS("newname")" newdisp "REUSE"
T1) DS("mailtds") SHR REU+
o") SPACE(1,1) TRACKS",ÿ
W"
      "ALLOC FILE(SYSPRINT) DS(TMAILCPY.REPORT)",
NEW SPACE(15,15) TR"
  ÿ
EPORT)"
SUT1 SYSUT2 SYSIN SYSPRINT)"

    else do
                  if newdisp = "NEW" then do
newname) > 0 then dir = "DIR(5)"
 else dir = ""
",
   ÿ
T2) DS("newname")" newdisp "REUSE"
"mailtds") SHR REUSE"
ener."
                  prc = rc
      gener. = ""
ES" then do
ˆ
2)"
                  Address ISPEXEC,
D("dataid") Member("new_ÿ
odlevel(0) Created("date('O')")",
ate("date('O')")",
e(),5)")",
"size")",
                          "User("sysvar('sysuid')")"
Address ISPEXEC "LMCLOSE  DATAID("dataid")"
SPEXEC "LMFREE   DATAID("dataid")"
        "FREE FILE(SYSUT1 SYSUT2)"
ilsmsg = "Copÿ
ame "rc =" prc
     mailsmsg = "Cancelled"
celled by user request"
s ISPEXEC "SETMSG MSG(MAIL000)"
SE"
0{
ocedure  ---------------------- *
                                *
                              *
it environment to be used     *
arding a TSO/E-Mail message   *
                            *
AILSND via IMACRO           *
                            *
                          *
                          *
      ÿ
on Technology           *
     ÿ
                     ÿ
                      *
                    *
                    *
                    *
                  *
n command line    *
cl>80             *
                *
--------------- */
 
OFF"
     "AUTOLIST OFF"
Aÿ
recl

LINENUM .ZLAST"
   fwd = ""
"DEFINE FIXSUB ALIAS TMFIXSÿ
   "DEFINE FAXIBM ALIAS TMIBMFAÿ
      "DEFINE TMAILEMC MACRO CMD"
    "DEFINE CANCEL ALIAS TMAILEMC"
                      "BOUNDS = 1" lrecl
"
       "SHIFT )" i "2"
                 "CHANGE ' ' '>' 1 ALL"
DS = 1" rbound
---------------- Forwarding the following message -----------------<'"
                      "LINE_AFTER .ZLAST = ",
nd of the forwarded message -------------------<'"
    exit_rc = 1
  "RESET"
c = 1 then exit¦  1{
-------  ÿ
ILEPF                                           *
                                              *
e the message to be tranÿ
-TSO user with valid PROFS header and         *
 information                                *
                                       ÿ
 EDIT DATASET(...) MACRO(TMAILEPF)          *
                                          *
yck ÿ
rmanente Information Technology           *
onte Ave.                               *
 CA 94598            ÿ
332                                     *
nel.b.dyck@kp.org                     *
                                    *
    ÿ
date to y2k                         *
fix and cleanup                   *
r NONUM            ÿ
unds for shift                    *
de for smtp to remove for profs *
mtp address from From:          *
MTP headers if present          *
ything right 1 column for     *
ion with ÿ
'.                            *
o support quotes in the sub *
is REXX Procedure         ÿ
                            *
------------------------- */
      /* ----------------------------------ÿ
ç
     *
-- */
              ÿ
uid)
  "Number Off"
---------+
hem      ÿ
----------------- */
n do
 if rc = 0 then do
 = LINE" line
 to = strip(to)
         end
n do
                 end
then do
ne
ip(from)
      endÿ
-------------- *
lete the     *
           *
---------- */
       "DELETE .zfirst"
            else call shift_right

 *

/
TO:",
     "CHANGE ' ' x'FE' 1 FIRST"
ANGE ' ' x'01' 80 FIRST"
--------------------------- *
                          *
----ÿ

x'FFFF00000011' 1 LAST"
LAST"
  Shift_right:
         to node IBMMAIL */
urn
S"
            do i = 1 to last
 end

----------- *
          *
        *
          *
        *
      *
        *
      *
    *
n'  *
    *
  *
  *
  *
*
ÿ
*
+

+

        *  5.  Display table of avÿ

        *      -  allow delete of a log data set and entry
      *      -  read/process a log                 ÿ
      *ÿ
      * Author:    Lionel B. Dyck                                     *
    *            Kaiser Permanente Information Technology           ÿ
    *            25 N.ÿ
    *            Walnut Creek, CA 94598                             *
  *            (925) 926-5332                                     *
*    ÿ
  *                                ÿ
  * History:                                                      *
*            05/06/92 - ÿ
*                       Set default Address to ISPÿ
*            06/28/91 - cleanup                                 *
           06/20/91 - Creation by Lionel +
---------------------------------------ÿ
     Arg options

C
ÿ
PPL(MAIL)"
tions with "LOG" log_number .
en log_process ÿ
s = "off"
fix".TSOMAIL.TABLE'"

ASET ID("table_log")"
Y(TSOMLOG) WRITE"
 lrc = 8 then do
              "NAMES(Logdesc Logds) LIBRARY(TSOMLOG) WRITE"
parse value "" with logdesc logds
     "TBADD TSOMLOG"
    "TBSORT TSOMLOG FIELDS (LOGNUM N,A)"
RARY(TSOMLOG) REPLCOPY"
n do
illmsg = "TSO/E Mail Log error code" lrc
000)"
      else do
       "TBÿ
                end
 do
 Mail Log errorÿ
            exit 4
        end
um = log_number
 if rc = 0 then do
D TSOMLOG"
      end
   maillmsg = "The selected log data set" log_number,ÿ
     "does not exist - try again"
          end
g_panel = "TMLOG1"

h zcmd zsel mailsmsg maillmsg

TBSÿ
           "TBDISPL TSOMLOG PANEL("log_panel")"
           "TBDISPL TSOMLOG PANEL("log_panel")",
ROW("rowcrp") AUTOÿ
op
hen do
   "LIBDEF TSOMLOG"
illmsg = 'ISPF TSO Mail Log Process Complete'
0)"
ngth(zcmd) = 0 then signal display
 = 0
                  "POSITION(ROWCRP)"

per zcmd
      parse value zcmd with v1 row
do
mmand:" zcÿ
splay
           mailsmsg = "Error"
d
              end
           "TBTOP TSOMLOG"

und"
                              zcmd
       end
                end
zcmd = "NEW" then do
        if rc = 8 then lognum = 1
um + 1
nel(TMLOG3)"
led"
d"

"logds"'"
g = "Error"
rent eÿ
msg MSG(MAIL000)"
     Address TSO
         "Free  ds("lÿ
lsmsg = "Created"
been allocated."
OG LIBRARY(TSOMLOG) REPLCOPY"
ogds")"
MAILFLOC MAILFID MAILTLOC MAILTID MAILDATN MAILDATD",
ILACTN MAILSUBJ MAILFDS MAILTDS)",

      "TBEND  TM"lognum
1
            "LMINIT ÿ
     "LMOPEN DATAID("dataid") OPTION(OUTPUT)"
taid") MEMBER(TSOMLOGX)"
 ÿ
,
  "TBTOP TSOMLOG"
OG ROWNUM("rows"ÿ
SOMLOG"
t + 1
IT DATAID(dataid) DATASET("logdÿ
TAID("dataid") OPTION(OUTPUT)"
ER(TM"lognum")",
      "LMCLOSE DATAID("dataid")"

    "TBADD TSOMLOGX"
SORT TSOMLOGX FIELDS (LOGNUM N,A)"
LOG) REPLCOPY"

le_log") ENQ(SHRW)"

EN DATAID("dataid") MEMBER(TSOMLOGX)",

)"
PEN TSOMLÿ
   mailsmsg = "Updated"
 been updated."
ay
then do
          "DISPLAY PANEL(TMLOGI)"
zsel = "C" th+
         if rÿ
   When zsel = "S" then do
           "TBEND TSOMLOG"
        exit 0
         end
         Select
ailsmsg = "Deleted"
"

ARY(ÿ
"I" then do
d
LOGC)"
 ÿ
ds
= "TM"lognum
 (table tablet ispÿ
AIL LOG)"
  end
        end
      "TBSAVE TSOMLOG LIBRARY(TSOMLOG) REPLCOPY"
ed"


---- *

   *
   *
 *
 *
 *


 *




         *                                               ÿ

         *
       *            Verb    T   Action                                 *
       *      ÿ
       *                        Allow RFIND to be processed by me.     *
     *                                                               *
   * Auÿ
     *            Kaiser Permanente Information Technology           *
   *            25 N. Via Monte Ave.                               *
 *            Walnut Cÿ
   *            (925) 926-5332                                     *
 *            Internet: lionel.b.dyck@kp.org                     *
                                     ÿ
 * History:                                                      *
            10/01/93 - minor fix to nickname on panel tmniktll *
          07/06/92 - change to use delword instead oÿ
  ÿ
          01/11/92 - Add 'Found' message for successful      *
                   search                                  *
        12/11/91 - ÿ
                                                           *
-------------------------------------------------------- */
opÿ
e = "'"sysvar(syspref)".NAMES.TEXTÿ
ispf') then do
md = sysvar('sysiÿ
       Address ISPEXEC "SELECT CMD(%"cmd options") ÿ
  exit
       Address ISPEXEC "Vget Senÿ
Showtso Center"  */
e = "Primary"
OK" then
ew_table = "on"
s_file"ÿ
BLKSIZE(0) DSORG(PS)"
    prim = names_file
d
EXEC "VPUT USRFIND"
z9 zcmd
> 0 then exit 0
then new_nick = prim

th(z3) > 0ÿ
_nick = alt4
      when length(z6) > 0 then new_nick = alt6
 0 then new_nick = alt7
alt8
herwise new_nick = null
= 0 then do
elect one daÿ
MAIL000)"
rim = new_nick then type = "Primary"
 "Alternate"
   mailsmsg = "Error"

p_query
     nickds = new_nick

     ÿ
      data set.
------ */
pper in_u
+
 in_u with ":ALTCTL." val
 altctl.c = strip(val)
²
       if type ÿ
EL." logsel .
0 then do
 in_u with ":LOGNAME." logname .ÿ
:PROLOG.",in_u) > 0 then do
             pos = pos(":PROLOG.",in_u)
os+8)
val)
Ë
Primary" then do
    val = substr(in.i,pos+8)
    epilog.c = strip(val)

in_u)ÿ
      c = nick.0
               end
ck.0 + 1
         nick.c = strip(val)
É
List*"
      list.c = list.c strip(val)
ODE.",in_u) > 0 then do
value in_u with ":NODE." val ":" .
             end
      c = nick.0

if pos(":PHONE.",in_u) > 0 then do
  parse value in_u with ":PHONE." val ":"  .
al)



l)
ip(substr(val,1,x-1))
n_u) > 0 then do
DRESS1.",in_u)
 = pos(":",val)
ress1.c = strip(val)
  Address1.c = strip(substr(val,1,x-1))
pos(":ADDRESS2.",in_u) > 0 then do
    pos = pos(":ADDRESS2.",in_u)

             Address2.c = strip(val)
                  Address2.c = strip(substr(val,1,x-1))

   c = nick.0
al = substr(in.i,pos+10)
if x = 0 then
              else
1))



l)
ip(substr(val,1,x-1))
 > 0 then do
,in_u)
",val)
(val)
substr(val,1,ÿ

      Address ISPEXEC
                        "NAMESÿ
        "PHONÿ
S4 SEARCH) Nowrite"
                      "NAMES(LIST SEARCH) Nowriÿ
TRL"table,
 
kname node user name,
ddress2,
 nick.0 = 0
epilog.0 = 0
iÿ
                    node     = node.i
i
nternet.i
 address1 = addresÿ
               address3 = address3.i
.i
        ÿ
               upper search
              end
nick.i
    search = nicknameÿ
          "TBADD LIST"table
 name
   = node.i
     upper search
    end
ltctl.ÿ
           search = option value
 CTRL"table
to prolog.0

BADD CTRL"table
= 1 to epilog.0
.ÿ
  "TBADD CTRL"table


upper search
f type = "Primary" then
     option = ":Logname."
 option value
       end
OP NICK"tabÿ
BTOP LIST"table
 then call do_Primary

   trc = 0

en call do_control
     otherwise if lrc = 0 then do
                    maillmsg = "Invalid option selected"
  "SETMSG MSG(MAIL000)"
     end
-------------------
           have to close the ISPF Tables and reset things



owing code is called or signaled only */
   trc = 0
            if trc = 4 then "TBDispl LIST"table
 "TBDispl LIST"table "PANEL(TMNIKTL)"
   select
            when zcmd = "SAVE" then call save_it
I" then do
Panel(TMNIKTLN)"
          nickname = listnick
              "TBADD LIST"table "ORDER"
n
   eÿ
                 maillmsg = "Error adding duplicate nickname list '",
                         listnick"' to the table"
    ÿ
                 change_list = "on"
           end
      ab = word(zcmd,ÿ
                 /*  do search in table */
                end
           when zsel = "D" then do


create TEMP Keys(LISTNICK) Nowrite Replace"
(list)
RDER"
       "TBTOP  TEMP"

»
ƒ
       xtÿ
      if change_list = "on" then do
ng"
ncel",
                  "SETMSG ÿ
 = null
                          "TBEND TEMP"
it = "on"
              if abbrev("CANCEL",zcmd,2) = 1 then do
END TEMP"
ilsmsg = "Cancelled"
e has been cancelled"
            end
   zcmd = null

                       listnick = newid
RDER"
ange_niÿ
              mailsmsg = "Error"
 adding duplicate nickname list '",
' to the table"
                                end
"
  if abbrev("SAVE",zcmd,2) = 1 then dÿ
top
t = null
TEMP"
       new_list = new_list listnick
                list = new_list
                  savetop = ztdtop
    ÿ
avetop")"
llmsg = "Nickname List has been saved"
00ÿ
d
pos(listnick,list)
              x =ÿ
n"

 do_control:
lsmsg = "Error"
or other than",
    "SETMSG MSG(MAIL000)"
         "TBTOP CTRL"table
           do until trc > 4

           trc = rc
EL" theÿ
t

                 end
      option = null
D CTRL"table

      when zsel = "D" then do
             end
ble
     do_Primary:



"table
"
disp_panel = nÿ
          parse value zcmd with w1 w2
off
ON" then trace i
h(zsel) = 0  then do



       "TBSKIP NICK"table "ROW("savetop")"

      zcmd = "FIND" argument
BSKIP NICK"table "POSITION(SKIPROW) ROWID(ROWID)"
          if abbrev("FIND",word(zcmÿ
foÿ
 = ztdtop

WID")"
orever
      "TBTOP NICK"table
)"
sg = "Found"
ch"
ÿ
SKIPROW) ROWID(ROWID)"
         "TBTOP NICK"table

llmsg = argumÿ
g Msg(MAIL000)"
       "TBTOP NICK"table
ID")"
 leave
p = "on"
        end
elect
 null with nickname node userid name,
address2 address3 address4,
             zcmd = null
               if rc = 0 then do
R"
ck = "on"
ailsmsg = "Error"
cate nickname '",
        ÿ
     end
en zsel = "N" then do

       zcmd ÿ
             then "Display Panel(TMNIKT1B)"
Y PANEL(TMNIKT1A)"
    "TBMOD NICK"table "ORDER"ÿ
                   end
then do
          mailsmsg = "Error"
 list entry from this option"
                    end
       "TBDELETE NICK"table

e nop;
do
+
          end
------------------ÿ
 data set
        save_niÿ
   "TBTOP LIST"table
ll

                if length(option) > 0 then do

                end
    "TBSKIP NICK"table
 "*List*" = left(node,6) then iterate
        out.c = ":Nick."left(nickname,8)
       c = out.0 + 1
     out.0 = c
rid."left(userid,8)

    if length(internet) > 0 then do
        outÿ
         end
c = out.0 + 1
.0 = c

ress1
ngth(address2) > 0 then do
 out.c = "  :Address2."address2
  end
t.0 + 1
ut.0 = c
do
ress4

 rc > 0 thÿ
st) > 7 then do
      ÿ
               out.0 = c
                    c = c + 1
t,cx,7)
          end
ick."left(nickname,7)
    out.c = ":List."list
 c
e") ds("names_file") SHR REUSE"
s stem out."
C
s been saved..............."
00)"
ad_it:
    Read in the nick name data set and prepare for
           ----ÿ
null

       if type = "Primary" then ÿ
------------------------------
y the user wisÿ
------------------------------------------ */
 with prim alt1 alt2 alt3 alt4 alt5 alt6 alt7 alt8 alt9
e null with zp z1 z2 z3 z4 z5ÿ
   prim = names_file
.i = in.i
i) > 0 then doÿç
:ALTCTL." val .
)

t_all:
  Perform the initializations of all the common
this REXX procedure.
----- */
           altctl.0 = 0

g.0 = 0

  userid. = null
 aÏ ddress2. = null

    have_nick = "off"
 /* ---------------------  rexx proceduÿ
  /* Name:      TMAILPTF                                           */
 /*                                                               */ÿ
  /* Function:  Un-Terse Files from IBMLINK           ÿ
   /*                                                               */
  /*            Called by the TSOMAIL Rexx Procedure               */
 /*  ÿ
    /* Syntax:    %TMAILPTF orig-dsn tsomail-dsn target-dsn        ÿ
     /*                                                               */
    /*            orig-dÿ
     /*                       TSOMAIL during the RECEIVE process.     */
  ÿ
     /*                       placed the ÿ
      /*                       RECEIVE.                                *
     /*          ÿ
      /*                       name into which the PTF wilÿ
       /*                       untersed.
      /*                        ÿ
       /*            Defaults:
        /*            orig-dsn    -  none
       /*            tsomail-dsn -  none       ÿ
        /*            target-dsn  -  userid.IBMLINK.xxxxxxxx
       /*   ÿ
        /*                           that immediately preceedsÿ

        /*                   ÿ






×

×
ÿ
×

×

 */
*/
/
  */
 */
*/
 */
              */
             */
              */
               */
              */
------------ */ÿ
if options = '' then exit 12
me ".SERVLINK" c

        parse value "" with ptferr1 ptferr2 ptferr3 ptferr4 ptferr5 ptfe
                               ptferr7 ptferr8 ptferr9 ptferr10
 ptferr2 = "The requested File does not have the ÿ
   ptferr3 = "characteristics to be a tersed file."
Browse the file to verify it's contents."
es should be",
4*ÿ
                   "file for MVS Unterse."
Data Set:" mailfds
   ÿ
 0

  parse value mailfdÿ
 targdsn = "" then targdsn = "IBMLINK."ptfname
 

 "Trsunpck" 'unpack'
*/
 = ""
 parse value "" with ptferr1 ptferr2 ptferr3 ptferr4 ptferr5 ptferr6,
                        ptferr7 ptferr8 ptferr9 ptferr10
1  = out.1
.3
          ptferr6  = out.6
ferr8  = out.8
.10
  end
        "FREE F(SYSPRINT INFILE OUTFILE)"

ure  --------------------ÿ
                         *
                     *
rocessing the      *
                 *
             *
n TSO      *
         *
     *
   *
 *

  ÿ
     ÿ
   *                                                             *
             - If tÿ
             Mail Saÿ
           the TSOMAIL exec is processed using the       *
       SAFE option for every userid ÿ
                                   ÿ
   During this process the user's mail will      *
e received and recorded in the user's        *
 Mail log (userid.TSOMAIL.LOG) and         *
 are received into unique data sets      *
 and time stamps.  The TSO Mail      *
set will not be updated at this    *
                                 *
                             *
       ÿ
ÿ
 the SAFEMAIL userid *
serid added      *
processing.    ÿ
within the   *
any      *
       *
     *
 *



       *                 least once per day with the following       *
     *                 commands:                          ÿ
   *                                                             *
                 TMAILSAF READ                               *
            ÿ
                                                         *
     3.  The SAFEMAIL userid data set is of the      *
     format:                 ÿ
        ÿ
 column  contents                            *
     Userid                              *
                       ÿ
B,LRECL=80,BLKSIZE=80*n              *
                                 *
 an * is column 1.             *
                             *
s)                       *
ÿ
                     *
                 *
             *
             *
         *
     *
   ÿ
 *

         * Additioÿ
       *                                                             *
   *        This REXX procedure should be processed at least     *
 *        once per day by a startÿ
        SAFEMAIL and thus a userid of SAFEMAIL.  It should   *
    be non-cancellable so that it can update data sets   *
ownedÿ
be updating is the user's userid.TSOMAIL.LOG.        *
 exec must also be able to read the user's       *
AMES.TEXT if one exist+
                      ÿ
 process WILL use a userid of SAFEMAIL       *
VE command.                              *
                                     *
ssing of this REXX procedure it      *
ssages indicating where it is    *
messages are written to      *
et which isÿ
t that this SYSOUT       *
s defined as hold    *
 the TSO           *
ool viewing      *
             *
         *ÿ
           *
         *
       *
         *
       *
     *
     *
 *

      ÿ
       *                      - add use of TMAILQRY                  *
   *             09/25/91 - Lionel Dyck                          *
 *                   ÿ
             05/01/90 - Lionel Dyck                          *
                  - Creation of this exec                *
     05/02/90 -ÿ
              - cleanup and improve doc              *
 06/11/90 - Lionel Dyck                          *
      - Fix receive for userid oÿ
        for logdsn                           *
0 - Lionel Dyck                          *
change initialization of ?.0 = 0     *
to ?. = 0 for speed                  *
                                 *
---------------------------  */
 +

 the word debug */
 in it */
---ÿ
 to be used ************** *
---------------------  */

À
g the SAFE Mail Control Data Set"
     "SAFE Mail procedure terminatingÿ
        exit  8
E DS("safedsn")"

n",
           "SAFE Mail Control Data Set:" safedsn
     end
-------------------------------------- *
                                *
                         *
        ÿÿ
               *
        *
 *
¤
     *     which will indicate that we have a userid to add or  *
    to DELETE from the Safe Mail Controÿ
                                                      *
nd then update appropriate variables.          *
                                        *
pdate routine if any updates are     *
                              *
                       *
m SAFE Mail         *
             *
      *
/
() "Starting the SAFEMAIL READ Processing"
      index  = "AISC"

       /* delete ÿ
    "DELETE '"index".LOG.DATA'"
   add.     =
= 0
        if word(output.i,1) = "SAFEMAIL:" then do
utput.i,2)
ADD" then do
           x = add.0
         update = "yes"
 = "DELETE" then do
   ÿ
Æ
             end
g update of the SAFEÿ
o
 DISKR SAFEMAIL (FINIS STEM safe."

 if substr(safe.i,1,8) = delete.d then do
i = ""
                "Userid" deÿ
               end    /* end of compare */
   /* end of delete scan */
hen do
                     idc = nsafe.0
 safe.i
d of safe.0 loop */
        ÿ
nsafe.0
      say date() time(),
ed to SAFEMAIL"
 DISKW SAFEMAIL (FINIS STEM nsafe."
 update of the SAFEMAIL CDS:" safedsn
-------ÿ
                                              *
                                       *
                      ÿ
                             *
                      *
               *
 on         *
         *
  *
         *     is mail then                       ÿ
    * 4.  Forÿ
     the SAFE option.                                     *
                                                   *
------------------------------ÿ
SAFE" then do
te() time() "Beginning SAFEMAIL SAFE Processing"
ÿ
   if substr(safe.idc,1,1) <> "*" then do
(safe.idc,1,8),)
"on" then do
user:" uid
       say date() time() "Completed TSOMAIL for user:" uid
  pid = pid + 1
 ÿ
                  "TSOMAIL Processing bypassed for user:",
       uid "because the user is currently logÿ
end
"SAFEMAIL SAFE Processing Completed for",
end
 F(SAFEMAIL)"
-------------------------------- *
                          *
                     *
                *
 the     *
  *

      * -------------------------------------------------------- */
estid:
then dÿ
no mail to be received at this time"
  = 1
ut.",'*',"CONCAT")

 i = 1 to output.0
        x = pos("EXECUTING+",output.i,1)+
ate
       end
  /* --------------------  rexx procedure  --------------------  */
 /* Name:      TMAILSM                                          */
                                                             */
Function:  Registration Dialog for the TSO/E Safe Mail      */
   ÿ
                                                        */
    Liÿ
    Kaiser Permaneÿ
    25 N. Via Monte Ave.                             */*
  Walnut Creek, CA 9459ÿ
  (925) 926-5332                 ÿ
  Internet: lionel.b.dyck@kp.org                   */*
                                        ÿ
5/02/90 - Lionel Dyck                           ÿ
eation of this exec                            */
                                            */
-----------------------------------------  */
        if opt = "DEBUG" then trace i
     Address ISPEXEC "Vget Sendctr"
  Address ISPEXEC "DISPLAY PANEL(TMAILSM)"

	
AFEMAIL (FIÿ
oes not see tÿ
AP("output.",'*',"CONCAT")
L) NOLOG NONOTIFY",
E F(SAFEMAIL)"
D" then opt = "registered with"
from"
L system"

------ */
                               *
         ÿ
d files to TSO and non-TSO     *
                             *
                          ÿ
 systems then TSO TRANSMIT     *
                             *
                           *
E PRINÿ
serid) SYSOUT(B)           *
                         *
                     ÿ
set that exceeds 80      *
occur sending the      *
s the TSO/E Transmit   *
MSGDS with greater     *
is type will be      *
an find no othÿ
                     *
                   *
s                *
                   *
                 *
               *
 ÿ
               *
             *
             *
             *
           *
  ÿ
message    *
         *
       *
e        *
       *
     *
       *
t      *
     *
     *
     *
   *
 *
  ÿ
             *
           *
           *
           *
         *
nt:      *
         *
       *
e      *
       *
     *
y    *
     *
   *
 *
 *
 *






         *             set in this exec using the Sÿ
         *                                                ÿ
         * History:
       *                                                          ÿ
       *    2.10    08/26/97 - support tso/e 2.5 sysvar(sysnode)       *
       *                       and remove history from 1990            *
     *    2.09    04/10/97 - support , as id separator               *
 ÿ
   *    2.07+
   *    2.ÿ
   *    2.05    ÿ
   *    2.04    02/21/95 - fix smtp mail to get id right           *
 *    2.03    02/10/95 - fiÿ
 *            to get the curren+
 *    2.02    09/14/94 - fix ÿ
 *    2.01    01/03/94 - remove wcc2 as a tso ÿ
 *    2.00    08/12/93 - fix for forward when lrecl < 80         *
                       add version id for paÿ
                                                               ÿ
 ------------------------------------------------------------- *
          Rexx exec to transmit messages and files         ÿ
          based upon TSO CLIST IDTFXMIT developed            *
ÿ
---------------------------------------------------------- */
parse arg w1
Address ISPEXEC "ÿ
then do
T CMD(%"cÿ
	
--------------------- *
------------------------ÿ
         /* At v2.5 or higher? */
              /* Use builtin func.  */
            "%tmgetnod"
         end

1 NKAISER2 NKAISERN IBMMAIL",
  /* set vio device type */
tem Dÿ
--- SMTP Defaults  --------- */
b  = "SMTP"
----------------------ÿ
- *
----ÿ
 smtpjob
 then do
k for        *
-------------------- */
t."
ft(zsysid,1)
,st.1) > 0 then
 end
f pl = 1 then do
lay(" ",wx,pr)
1)
rlay(" ",wÿ
     end
    Address ISPEXEC "SELECT CMD(%TMAILDEF) NEWAPPL(MAIL)"
1
n do

DEBUG" then do
5)  /* remove the word debug */
e word debugÿ
t values to null to start with */
n msg1 msg2 outdd null
x > 0 then do
        wx = delword(w1,x,8)  /* remove SENDFILE */
1 = wx
D"
                  nomsg = "on"
               ÿ
 else nomsg = "off"
 then do
d(w1,x,5)
              else log  = "N"
  if x > 0 then do
x = delword(w1,x,5)
end

          wx = delword(w1,x,3)
           end
",w1)
to put msg(..) as 1st word */
d *ÿ
ay(" ",w1,x,length(y)," ")

..) as 1st word */
           filedsnÿ
,w1,x,length(y)," ")
  if x > 0 then do
 1st word */
       filedsn = substr(y,4,length(y)-4)
length(y)," ")
> 0 then do
ord */
ÿ
" ")
en do

 = substr(y,6,length(y)-6)

stdsi(filedsn)
smsg = "Error"
oes not exist"

 sysdsorg = "PO" then do
wx <> "OK" then do
            maillmsg = "Requested data set" filedsn wx
   Address ISPEXEC "SETMSG MSG(MAIL000)"
e 4
dsorg = "PS" & seq = "SEQ" then seq = null
d
p(w1)

 "off" theÿ
pf screen number */
   call listdÿ
          if pos("(",msgdÿ
ll
                              ÿ
             Address ISPEXEC "SETMSG MSGÿ
t 4
o

 "Recfm("strip(recfm)")"
    end
recl = 0
  if syslrecl < 84 then
recl < 80 then
blksize sysrecfm

 usÿ
reen
) LRECL("syslrecl"ÿ
 90) TRACK NEW KEEÿ

gdsn") REUSE"
          "EXECIO * DISKW " xmitdÿ
"msgdd")"
DDNAME("xmitdd")"
                  time('n')
SENDCTR) SHARED"
      if length(sendfrm1) = 0 then do
MD(%TMAILDEF)"
UBJ)"
do
en
d") PANEL(TMAILEDT) MACRO(TMAILEDM)",
           else
TAID("xmited") PANEL(TMÿ
TSOMAIL)"
end = "CANCEL" then rc = 4
c = rc
      end /* end of processiÿ


it_here erc
     x = PROMPT("OFF")
 subject and date/time stamp */
   "EDIT DATAID("xmited") MACRO(TMAILEDX)",
IL)"
= 0 then call redo
           ÿ


         mailsmsg = "Message+
t messagÿ
d
n unexpected error occurred in Transmit Edit.",
ed."
ETMSG MSG(MAIL000)"

    if length(erc) = 0 then erc = 0
    Noid:
       call exit_here erc
,"*","NOCONCAT")

   else mack = "NONOTIFY"
all fix_nick sendid
cl > 80 then do

   if length(tnick.tso) > 0 then do
                "TRANSMIT ("tnickÿ

     "TRANSMIT ("tnick.tso") FILE("xmitdd") NOPROLOG NOEPILOG",
                mlog mack
r VM */
og = "NOLOG"

tpid = word(tnick.smtp,i)
D SMTPHOST) SHARED"
      "EDIT DATAID("xmited") MACRO(TMAILESM)",
(TSOÿ
 syslrecl,
     xmrc = rc
                  endÿ
       then do i = 1 to words(tnick.inet)
tnick.inet,i)
ARED"
T DATAID("xmited") MACRO(TMAILESM)",

SMIT INET.VM-SMTP FILE("xmitdd")",
OG" mlog maÿ
IT INET.VM-SMTP MSGDD("xmitdd")",
 mlog mack
 null then mlog = "NOLOG"
gth(tnick.vm) > 0
              parse value word(tnick.vm,i) with tonode "." toid
        Address ISPEXEC "VGET (TSOLOG) SH+
 ISPEXEC ÿ
ress ISPEXEC,
Ç
vm xmitdd word(tnick.vm,i)ÿ
e sysrecfm
             /* prevent duplicate logging under VM */
mlog = null then mlog = "NOLOG"
g1 = "Message"
    erc = 0

 <> ÿ
en call cancel
.tso) > 0 then send_file = tnick.tso
then send_file = seÿ
hen do
 
              ÿ
= "off" then
d data set",
                         else mÿ
              if words(tnick.smtp) > 0 then
"DISPLAY PANEL(TMAILSFE)"
           if xmrc = 0 then do
              maillmsg = msg2 sendid
               mailsmsg = "Transmit error"
pected error occurred in Transmit. RC="xmrc

EC "DISPLAY PANEL(TMAILRDO)"
        end
_vÿ
'"tsolog"'") = "OK" then
') MOD"
OLOG"') NEW",
LKSIZE(3120)"
        mv.0 = 4
 date = date()
,2,1) = ' ' then date = '0'date
ft("**MESSAGE**",46)date time()
ode,8) toid
              do ivm = 2 to words(tnick.vm) by 2
 mv.0 + 1
      " word(tnick.vm,ivm),
vm+1)
       c = mv.0

v.c = m.ivm
rofs trÿ
FINIS STEM mv."
 "on"
essage cancelled"
 "was aborted."
    call exit_here 4
--  rexx procedure  -----------------ÿ
ck                                           *
                                           *
ck Name validation for the TSO/E         *
log.                                       *
                                         *
 sendid                                *
                                         *
sed are:                               *
                                     *
  ÿ
dure is imbedded within              *
 procedure.                        *
                 ÿ
                                   *
 ',' as separation field         *
of procedure                   *ÿ
                                 *
------------------------------ */
 orig_names = nick_names
p out the commas */

_in.i = word(nick_names,i)
  +
ÿ
                wl = length(userid)
mes,i)
                nicÿ
eft(userid,8)
 length(nick_in.i) > 8
pos("@",niÿ
_in.i,8)
      wo = wordindex(nick_names,i)
(userid,nick_names,wo,wl)ÿ

                  end
 = w
l with inv. tnames
1 to tnick.0
k_in.j,substr(tnick.i,1,20)) > 0
       ÿ
            tnick.i = null
(tnick.i,1) = "*" then
ip(nick_in.j)
ick.i,2) <> "**" then do
                    tnick.i   = null
     ÿ
1 to tnick.0
    call test_node
      end
    if nick_in.j <> null then



end
 PANEL(TMAILNV)"
k_names = orÿ
        signal start_over
 
*/
 */
*/
ÿ /
- */
      if left(tnick.i,1) = "*" then
n return
        Select
        When pos(".",word(tnick.i,2)) > 0 then call set_smtp
ordpos(word(tnick.i,2),tso_nodÿ

     set_iÿ
        when pos("@",nick_in.j) > 0 then do
nick.0 + 1
eft("********",10) nick_in.ÿ
            end
= inv.0 + 1
_in.j
           parse value nick_in.j with node "." userid
nick.0 = tnick.0 + 1
nick.i = left("********",10) left(node,10) userid
test_node
end
(tnick.i,2)"."word(tnick.i,3)
 then return
3)
  new_nick  =  word(tnick.i,2)"."word(tnick.i,3)
ck,tnick.vm) > 0 then return
        return
 0 then
ck = word(tnick.i,3)"@"word(tnick.i,2)
) > 0 then do
   ÿ
    else do
              tnick.smtp = tnick.smtp new_nick
      return
arg nick_names
 null
 
k_id.    = null
     logname = null
--------------------ÿ
 they do not have one   */
agement dialog.        */
--------------------- */
Å
NEW SPACE(1,1) TRACKS RECFM(F B)",
E(6160)"
       "ÿ
ysvar(syspref)".NAMES.TEXT"
:
i)
hen do
                parse value name with ":LOGSEL." logsel x
      nick.i = null
 end
 pos(":LOGNAME.",name) > 0 then do
with ":LOGNAME." logname x
             ÿ
eft(name,8) = ":ALTCTL." then do
ith ":ALTCTL." nick_file
                  signal getÿ
         end
 logname = null then logname = "MISC"
"logsel"."log+
   list_opt =ÿ
        do_it:
e null with do_nick do_node do_id
ist_opt = 0

re
nt_nick = temp_name
                if wordpos(do_nick,nick_names) = 0 then do
        parse value null with do_nick do_node do_id
 do_nickÿ
         else do
              nick_name.0 = in
k
 ÿ
wordpos(do_nick,nick_names))
ames,wi,length(do_nick))
                  ÿ
     parse value null with do_nick do_node do_id


 more
e = word(temp_node,1)
re
p_id more

ength(temp_id) > 0 then do
 ÿ
with ":LIST." nick_list
         if wordpos(current_nick,nick_names) > 0 then do
o = woÿ
ck_names,wo)
       nick_names = wn nick_list
                    nicÿ
*"current_nick
 1
 = nick.il
 pos(":LIST.",t_list) > 0 & pos(":NICK.",t_list) = 0
 then do
 value t_list with ":LIST." nick_list
 = nick_names nick_list
   end
ck) > 0 then do

 in
de.in = do_node
   wi = worÿ
   wo = oveÿ
_names = wo
list_opt = 1 then signal oÿ

f pos("@",nick_id.i) = 0 then
ip(nick_node.i),
e
i


me hh:mm:ss.th */
tr(s,10,1)
_file"') SHR"
Eÿ
         if left(n.i,1) <> "*" then do
             j = nick.0
    ÿ
edure expose smtpjob
------------------ */
-TSO node locationsÿ
------------------------ */
srecfm

       "ALLOC F("outdd") SYSOUT(B) DEST("toid") Reuse",
sysrecfm") Lrecl("syslrecl") Blksize("sysblksize")"
SKR" indd "(FINIS STEM in."
n."

fwd <> "NEVER" then fwd = "No"
  Exit©  value{
--  rexx procedure  ---------------------- *
                                         *

subject line for the TSO/E Mail Send     *
he subject within the text being sent. *
              ÿ
n                                      *
                                     *
the word to look for that defÿ

                                   *
                                 *
                ÿ
                                 *
en 'subject' is used           *
                               *
                               *
                             *
                             *
 90740                       *
                           *
         +
ckwell.ÿ
                           *
                         *
    ÿ
                         *
 work                  *
-------------------- ÿ
pt)"
nd" opt "first"

else exit 0

substr(data,swo+swl)
PEXEC,
2
------------ *
  ÿ
          ÿ
                          *
                 ÿ
E node name from the       ÿ
                                       *
                                ÿ
will extract the current NJE node name, alsoÿ
enter name from the JES2 SSVT that is pointed to    *
CT.                                            ÿ
                                                            *ÿ
he current node is then placed into ISPF Variable: curnode       *
                                                              ÿ
    * Author:    Lionel B. Dyck
         *            Kaiser Permanente
‰
   *
      *
           *
            ÿ
                   *
                        *
from Mike Theys for        +
ES2 4.3 and cleaned up toÿ
t both 3.1.3 and 4.3                   *
ated                                      *
                                        ÿ
--------------------------------------------------- */
(systsoe) > "2040" then do            /* At v2.5 or higher? */
node = sysvar(sysnode)                   /* Use builtinÿ
  jesÿ
       if substr(curnode,1,1) <> "-" then do       /* Error check
             Address ISPEXEC "Vput (jessplv curnode) Shared"
return
t    = storage(10,4)                         /* load a(cvt)        */
 dcvt   = c2d(cvt)                              /* convert to decimal */
    jÿ
‰
l */
 jsct*/
o decimal */
 a(ssctsuse)   */
onvert to decimal */
 /* load a(ssvt)       */
     /* convert to decimal */
),8)    /* jes2 sp level      */
" then
e */
orage(c2x(d2c(dsuse+x2d(13c))),8)  /* jes2 ownnode */
       Address ISPEXEC "Vput (curnode) Shared"{

  
ÿ
 "LINE_After" line "= '/BA'"
er" line "= '/AK                  '"
LINE_After" linÿ
   if length(fÿ
 then call insert faxf3

f6) > 0 then call insert faxf6
t faxf7
After" line "= '/Fax" faxphone   "C=1'"
    "LINE_After" line "= '/To  " faxt1  "'"ÿ

) > 0 then call insert faxt3
xt4
gth(faxt6) > 0 then call insert faxt6
insert faxt7
LINE_After" line "= '/Subject" faxsub    "'"


'"
6"6
-------- */
intended to provide full mail          *
or tÿ
                                                 *
                                                    *
                     ÿ
rocess entry options                                          *
- debug will cause the REXX instruction tracing to be activated  *
   - USERID(userid) causes this exec tÿ
      *     (executing user must have TSO OPER)
         *   - SAFE is used by the SAFEMAIL facility that will be
‰
     *
        *
 reading   *
   ÿ
le if there is new   *
VE command receiving    *
         ÿ
 batch and then exit with no      *
g - AND NO RECEIVE PROCESSING.       *
nder that TMP in batch as:ÿ
serid)                                         *
cessary ispf data sets *                          *
TSOMAIL BATCH USERID(userid)) NEWAPPLID(MAIÿ
ify that the TSOMAIL Table data set exists and if not       *
do a 1 time test:                                              *
   - test if a log data set previously exists               ÿ
    *       - if not continue                                ÿ
         *       - if it does then allow the user to:
‰

        *
to         *
              *
           ÿ
 form:                  *
                           *
specified                 ÿ
red under the ISPF Applid of MAIL      *
OMAIL.LOG and create an ISPF              *
ery message and file.                    ÿ
 to determine if the table data set is large        *
r has enough room, if not create, copy and delete.     *
ust have less than 10 extents and more than 5 free      ÿ
   directory blocks to be acceptable)                            *
   - messages are placed into the partitioned data set in which     *
  *     the ISPF table is stored                                       ÿ
    ÿ
‰
 *
    *
           *
le (1.50)     *
                 *
                        *
                           *
send a message or file        *
r Sort blank to display menu) (1.43) *
                                        *
e the current TSO Mail defaults            *
                                                  *
 a message to the sender of the message/file         *
lias for 'S'                                            *
C:  Changÿ
   - D:  Delete the message or file                               *
*     - E:  Edit the message or file                                 *
 +

 *
    *
         *
              *
or processing    *
nied the data set     *
                           *
                              *
et                                 *
e data set                                *
he data set                                  *
 the PDS Command on the data set                *
  Delete the dÿ
 - 8:  Process the file using the UNTERSE utility         *
    - 9:  Forward the data set to another user               *
                               ÿ
  * ------------------------------------------------------------------ *
     * Change history:
        *ÿ
 *
    *
       *
              *
                 *
                    *
  ÿ
                              *
n reset_profile routine          *
                   ÿ
e table variable name                      *
                                              *
   If node=ibmmail then reply to ibmÿ
                                                        *
5 - 2.48   Fix for find/rfind                              *
    ÿ                                                ÿ
*  03/10/95 - 2.47   Fix for SMTP started task name of SMTP?         *
   *
      *  12/15/94 -ÿç
  ÿ
              *
just returns now *
                   ÿ
sh                         *
                              *
eset                               *ÿ
est for INMR901I to INMR906A            *
                                           *
fix printing of message data set closing table  *
                                                   ÿ
 - 2.41   correct reply-to: processing                    *

03/07/94 - 2.40   fix to correct receive not working for datasets *
  *                    intermittently                                  *
     *        ÿ


    *
         *
            *
 and prompt      *
                      *
 processing.             *
                              *
bug data set if receive is ok.     *
                                      *
og of all messages for error checking.     *
                                                *
   Add prompt for print when message and d/s in    *
        same message.                                   *
         ÿ
/24/93 - 2.32   Update to put messages w/lrecl>80 into pds      *
          ÿ
   *                    ÿ
        *                    Create variable for blksizes (FB_Blksize an

  *
       *
if PF3      *
                 *
 as a Message       *
 for log data set.       *
                              *
-all Noprompt option             *
                                      *
ÿ
                                              *
 Aÿ
      date stamp.+
               ÿ
/01/93 - 2.26   Aÿ
*                    Add DF (Delete File) option                     *
   *                            ÿ
        *  04/27/93 - 2.25   Fixÿ

  *
       *
            *
               *
                    *
 already allocated to    *
 allocation size.           *
   ÿ
l Forward flag options                *
                                         *
ove file delete optiÿ
 Bill Hortonÿ
                                                      *
- 2.18   Limit size of invalid.file'sÿ
                           ÿ
 12/06/92 - 2.17   fix for :msg with invalid.file                  *
 *                                                    ÿ
      *  12/04/92 - 2.16   Fix for receiveÿ

*
     *
          *
nge            *
          ÿ
IVE.INVALID.FILE       *
                            *
                           ÿ
D and current row location          *
     ÿ
ect SMTP to userid/node                     ÿ
                                                 *
9   fix length test ÿ
                                                         *
5/92 - 2.07/8 add panel TMAILNTW when copying table        ÿ
                                   ÿ
   *  09/24/92 - 2.06: Bug fix
      *

  *
     *
        *
               *
ata deleted       *
                     *
ÿ
me                             *
                                  *
t for SMTP Fromÿ
pport Answer and Forward *                  *
                                               *
0: Changed to version 2.0 to rÿ
        Set default REXX address to ISPEXEC              *
           Several minor performance enhancements           *
 ÿ
 *  11/10/89 - creation of this application                           *
    *
       * ---------ÿ
*
   *
      *
             *
                  *
                     *
                          *
--------ÿ
IVE" = sysvar('sysispf') then do
VGET ZAPPLID"
applid <> "MAIL" then dÿ
L)"

null

Set to "0" for System Det+
ot enabled set to:     ÿ
                               *
                  *
---- */
    if wordpos("DEBUG",options,1) > 0 then do
 i

safÿ
       if wordpos("READ",options,1) > 0 then
 
= "on"
    batch = "on"
            nodel = "on"

    else log_opt = "off"
 ")" .

    userid = user
                         end
                     userid = sysvar('sysuid'ÿ
    prefix = sysvar('syspref')
    /* set message data set without table suffix  *
ity with previous tsomail    *
            */
age_ds_l = length(message_ds)
age table data set */

  "'"prefixÿ

       if log_opt ÿ
MAIL.TABLE'"
  ntable     = "'"prefix".TSOMAIL.NTABLE'"
.TSOMAIL.OTABLE'"
  = "TMAILTBL"
le tablet ispftbl maillog)"
ad = "on"
      months = "JAN FEB MAR APR MAY JUN JUL ",
T NOV DEC"
  = "LOG"
 logname   = null
ount  = 0
ll  directory'
 */
----ÿ
re is a prefix.NAMES.TEXT and if so: *
                          *
d either       *
        *

* 3.  Use the specified log name if ÿ
therwise use prefix.LOG.MISC                    *
------------------------------------ */
79,'-')
listdsi(names)

("nts_dd") DS("names") SHR"
M nt."
  upper nt.i
hen do
1ÿ
= substr(nt.i,x+8,l-8)
                   logsel = "on"
                ÿ
                end
 x > 0 then do
 var p w1 w2
ix_name = substr(nt.i,x+9,l-9ÿ
hen do
x_name
nt.0
ame */
TSO "FREE FILE("nts_dd")"

     date = substr(d,7,2)substr(d,1,2)substr(d,4,2)
)  /* get the current time hh:mm:ss.th */
,2)substr(s,7,2)ÿ
ate".T"t".DEBUG'"
--------- *

    *    ÿ
ypass if SAFE process is occuring                   *
                                         *
tso log data set exists ÿ
                       *
            *
 *
        * ---------------------------------------------------- */
  log_ds_stat = sysdsn(maildsn)
      call listdsi table 'norecall  directory'
sreaÿ

 log_ds_stat = "OK" then do
g data set */
  if zcmd = "D" then
             if zcmd = "E" then,
"
safe <> "on" then do
          new_rc = rc
 = "on"
    end

fm(V B) Lrecl(255) Blksize(3120) Dÿ
sn")"
       /* receive counter       */
lue off */
     if rÿ
n
("profile.",'*')
OMSGID',profile.1) = 0 theÿ
          else msg = NOMSGID

lse intercom = "NOINTERCOM"

 wtpmsg = "NOWTPMSG"
               then prof_pause = "PAUSE"
ause = "NOPAÿ
of profile testing for the message id option   */
ass flag */

   if "OK" <> sysdsn(debug_dsn) then do
("debug_dsn") New Spa(15,30)",
size(3120) Dsorg(PS)"
end
dress ISPEXEC
n:
AP("p.",'*')
)
------------------------------------------------------ *
                                                ÿ
the captured output looking for INMR906A     *
te that we need to receive a data set.*
       ÿ
NMR906A, if 2 or > stop     *
                     *
              *
  ÿ
    *

      *            ÿ
 *   If INMR060I is found then queue a DELETE as we can't   *
ndle that data set.                                 ÿ
                                    ÿ
to the Receive subroutine.                 *
                                    *
ssage INMR933A....             *
ge INMR907A....             *
                     *
------------- */
ÿ
      do i = 1 to output.0
 then
,8)

LOG"random()
ceive"
maildsn")"
    "EXECIO" output.0 "DISKW" log_dd "(FINIS STEM output."
F("log_dd")"

" == substr(output.i,1,8) then do
nt time hh:mm:ss.th */
,2)substr(s,10,1)
".DATA')"
et the new mail flag on */

t = 0
_cnt = 0
 s = time(ÿ
tr(s,1,2)subÿ
ET('"prefix".TSOMAIL.D"date".T"t".DATA')"
            newmail = "onÿ
eceive = "on"
_cnt > 2 then do
 = "An error with RECEIVE may have been ÿ
      "contact Systems Support."
G MSG(MAIL000)"
               if prof_change = "on" then
O,
         exit 8
nd do loop for output trapped */
ve = "on" then signal receive
         Address TSO "Free F("debug_dd")"
     exit
nt fo+
ROFÿ
     x = OUTTRAP('OFF')
ess TSO "DELSTACK"
      x = MSG("ON"ÿ
then do
 = "off"
------------------------ *
TE" if non-blank    *
             *
------- */
   /* -------------------------------------------------------- *
 Queue out the TSO RECEIVE response to indicÿ
 set name to be used to receive the first          *
in the stack.  The SYSOUT(0) is used to       *
PY messages to a sysout class that     *
0 as we do not want to see them   *
to keep them from the screen *
--------------------- */
        queue rdsn "SYSOUT(0)"   /* queue out the dsn to receive into */
       queue ÿ
           end
 sysvar('sysispÿ
ch <> "on" then do
 PANEL(TMAILRW)"                  /* RECEIVE Wait Panel */
        end
 output.
" <> userid then
d") LOGDSNAME("maildsn")"
           "RECEIVE LOGDSNAME("maildsn")"
       if receive_rc < -50 then signal do_table
')
   /* turn off messages for now */
       Address TSO "DELSTACK"
 process */
isp+
tÿ
 = 0   /* initialize the message count received value */
 /* initialize the message files received value */

 wordpos(table_status,"9 25",) > 0 then do
splay Panel(TMAILRCL)"
 = outtrap("del.","*")


ise do
IR(60) SPACE(30,90) TRACKS",
0) BLKSIZE("FB_Blksize")"
all listdsi table 'directory'
"
yesÿ
    if newtable == "yes" then do
then do
CK"ÿ
   x = msg("OFF")
       Address TSO,

B) LRECL(80) BLKSIZE("FB_Blksize")"
"table")"
"LMCopy FROMID("tblin")",
)"
"
able  otable
ewtable = null

 "on" then do
L(TMAILWÿ
 "DATASET ID("table")"
N "mailtbl" WRITE LIBRARY("mailtbl")"
n code */

    maillmsg = 'The TSO Mail Table is currently in use',
  'probably iÿ
Y PANEL(TMAILUSE)"
     "TBEND "mailtbl
profile environment back to ÿ
en call reset_profile
 > 12 then do
A Severe Error has been encountered - ',
upport'
       else say "*****" maillmsg "*****"
et the profile environment back to normal */
 then
   "TBEND "maÿ
    if lcc == 8 then do
        "NAMES(MAILFLOC MAILFID MAILTLOC MAILTID MAILDATN MAILDATD",
     "MAILTIME MAILACTN MAILSUÿ
iltbl") WRITE"
  build:
sed > ÿ
) DS("maildsn") SHR"


 msgcount = 0
g_message mailfloc,
eeding 80 characters received"
a data set."
 ÿ
 of message indicator of 79 '-' */
(data.i,1,79) then do
ta.i,1),"ERROR TRAÿ
       else do
                   end
            hit = 0
                call store_msg
                     else do
 ÿ
g. mailtds type mailsmtp
nd


MIT" == substr(data.i,1,8) & length(type) = 0 then do

SSAGE*ÿ
               call toinfo1
ord = 1

           msg.1 = daÿ
a.i,17,44)
          msgcount = 1
tn = "Sent"
== substr(data.i,1,7) & length(type) = 0 then do
" = substr(data.i,17,13) then do
newmail = "on"  /* set the new mail flag on */
ceived"
          call finfo1
ENT **" =ÿ
h mailfds mailfloc
  mailactn = "Received"

 = "F"
* set the new mail flag on */
data.i,17,44)
call finfo1
            mailfloc mailfid mailtid mailtloc
    /*  end of RECEIVE processing  */

mailfloc) = 0 then

       end
i,2,6) == "FROM: " then do
           if substr(data.i,5,5) == "DSN: " then do
ubstÿ


g.msgcount = data.iÿ
          end
   if length(mailsubj) = 0 then do

hen
 end
 = 1
    if left(data.i,8) = "rcpt to:" then x = 3
           when x = 1 then do
              if x = 0
From: " work .
">"
             end

  parse value data.i with "Reply-To: " work .
e vaÿ
               end
 = pos("<",dÿ
  parse value data.i ÿ
se value data.i with "<" work ">"
en mailsmtp = work
;
sg.msgcount = data.i
if msgcount > 2 then
g_message = "on"
    end  /* end do to process recently received mail */
count > 0 then call store_msg
/

   Address TSO "DELETE" maildsn
 mailsmsg = '0 New Messages'
s or fileÿ
ch <> "on" then do
   "SETÿ
****" maillmsg "*****"
           mailsmsg = mcount 'New Messages'
      'There were' mcoÿ
            if batch <> "on" then do
ewmail = "on" then
         end
  end
           if tmdel = "Y" then nodel = "on"
 do
SO "Delete" debug_dsn
       Address TSO

            "'"prefix"."middle".HOLD3."suffix"'"
fix"."middle".ÿ
HOLD2."suffix"'"
"sÿ
               "RENAME '"prefix+
     "'"prefix"."middle".HOLDÿ
ddle".HOLD1.debug+
'"

L option */
 if check = "on" then do

    end
      if read <> "on" then
_profile
blÿ
LIBRARY("mailtbl")"
m_alloc = "on" then do
              drop ÿ
sg('on')
    end
 *
       "TBBottom" mailtbl
   "tbquerÿ
  do i = 1 to rows
h(maildatn) = 6 then do
        parse value maildÿ
f length(year) = 2 then
        then year = 1900 + year
r
" mailtbl

  * Now resume processing normally                     ÿ
" mailtbl
TBSORT" mailtbl "FIELDS ÿ
        if log_opt = "off" then do
hen maildisp = "LONG"   then tblpanel = "TMAILTBL"
isp = "SHORT"  then tblpanel = "TMAILTBS"ÿ
XLONG"  then tblpanel = "TMAILTBX"
LTBL"ÿ
           select
"TMLOGTBL"
"
              otherwise tblpanel = "TMLOGTBL"
       end
      parse value null with save_zv+
Errors Return"
        do forever
zsel
      if ispfds = "on" then do
       ispfds = "off"
	

ve_zverb save_zscrolln
PL "mailtbl
          "TBSKIP" mailtbl "NUMBER("crp")"
ull then do
"zscrolln")"
   "TBSkip" mailtbl "Number("zscrolln")"
     if rowcrÿ
l")"
ÿ
      end
cc = rc  /* save return code */
   if wordpos(zveÿ

e value null with save_zverb save_zscrolln
     "VPUT USRFIND"
then do
            "LIBDEF" mailtbl
 tsomnum_alloc = "on" then do
)"
   x = msg('on')
ilsmsg = 'Complete'
g Complete'
o
sg = 'ISPF TSO Mail Dialog Processing Complete'
     ÿ

       rowcrp = 0
ailtbl,
 & zsel = null then do
POSITION(ROWCRP)"
   rowcrp = 1
n do
 

nel = "TMAILTBS"
"
         end
  maildisp = "LONG"
TBL"
 ÿ

"XLONG"
                ÿ
 0
      when abbrev('SENDMAILÿ
"
      "VPUT (SENDSUBJ) SHARED"
ebug")"
 then do
               if log_opt = "on" then do
"

  end

brev('DEBUG',w1,3) then do
ispfds = "on"
                trace i
               ÿ
           ÿ
                end
  then do
ailsmsg = "Error"
d when processing",
          end
ltbl" REPLCOPY LIBRARY("mailtbl")"
                    if tsomnum_alloc = "on" then do
dress TSO "Free F("tsomnum")"
                       end
           "LIBDEF "mailtbl
                     "CONTROL DISPLAY RESTORE"
MD(+
ignÿ
         when abbrev('REFRESH',w1,3) then do
" then do
g = "Option REFRESH ÿ
    ÿ


                "TBÿ
          x = msg('off')

       drop tsomnum_alloc
  x = msg('on')
 y = wordpos("READ",options)
                              xopt = delword(optiÿ
                  options = xopt
                   signal start
 if n_rcÿ
                  maillmsg = "No new mail to receive.  Refresh terminate
                    end
        /* ---      ***FIÿ

           argument = w2 w3
ument = strip(argument)
»
   search = null
 "TBTOP" mailtbl
       "TBSKIP" mailtbl "POSIÿ
     end
(ROWID)"
         else f_smsg = "Found"

             do forever
AILTID MAILDAÿ
ILTDS
ch) > 0 then do
wcrp = crp
    mailsmsg = f_smsg
ng search in row:" crp
               leave
ailtbl "P+
       ÿ
                   if find_loop = "on" then do
sg = "Not Found"
ing search"
          rowid = crp
  end
dÿ
nd
w2) > 1 then do
 & length(w3) = 0 ÿ
3) = 0 then w3 = "D"
1)
 then w3 = "A"
OUSER",
hen do
 'Enter valid sort option: ',
TOÿ

 to report on */
   select
      w2 = "MAILDATN"
     end
      ÿ
     when w2 = "TONODE"   then w2 = "MAILTLOC"
"TOUSER"   then w2 = "MAILTID"
w2 = "MAILDATN"
ATN" /* was MAILTIME */
AILACTN"

LDS ("w2 w4","w3")"
LDS (MAILDATN" w4","w3" MAILTIME C,"w3")"

            end  /* end sort processing */
e do


on
                    if length(date)   = 1 then sort_parm = sort_parm,
           +
               if lengtÿ
      if length(tonode) = 1 then sort_parm = sort_parm,
   " MAILTLOC C" tonode
ast_sort = "TONODE"
                   sort_parm = sort_parm "MAILTID C" touser
      if length(touser) = 1 then last_sort = "TOUSER"
f length(fromuser) = 1 then sort_parm = sort_parm,
 " MAILFID C" fromuser
st_sort = "FROMUSER"
parm = sort_parm,
                  if length(fromnode) = 1 then last_sort = "FROMNODE"
             "TBSORT "mailtbl" FIELDS ("sort_parm")"
c = rc
           ÿ
Sort cancelled"
           end /* end ÿ
do
Invalid TSO Mail Table Command entered:" zcmd
          end
l message selections */
ft(message_ds,message_ds_l)
"¾"¾
l then do
º
     ÿ
else do
     "DISPLAY PANEL(TMAILFWD)"

d
   "VPUT (FWD SENDSUBJ) SHARED"
 fwdfile = "Y" then fwdfile = "FILE("maÿ
le = "M" then do
    message_ds_opt = "on"
wise fwdfile = null
 = "on" then
       "MSG("mailtds")" debug
MD(%TMAILSND" fwdid,
')" debug
              if fwd <> "NEVER" then fwd = nuÿ
 null
ctn = "Forwaÿ
smsg = 'Forwarded'
rded to' fwdid
            mailsmsg = "Canceÿ
d cancelled"
 
           Merge data set into Message        ÿ
--------------------------------- */
     mergeÿ
   else merge_force = null
e = null
= "Error"
           merge = "No"
ÿ
"The data set associated with this messaÿ
onger exists" mailtds
       if merge <ÿ
         if syslrecl > 80 then merge_ds = "ng"
ds = "ok"
 if syslrecl > 84 then merge_ds = +
"ok"
ge_ds = "ok"
lsmsg = "Error"
rged into",
l,

    parse value '' with md. mm.
      "Alloc f("m_ddÿ
 Diskr" m_ddn "(Finis Stem md."
          "Alloc f("m_ddn") ds('"tablet"(M"mailnum")') Shr Reuse"
   ÿ
+ 1
ta",72,'-')
       "Execio * Disÿ
ISPEXEC
ailsmsg = "Done"
d the data set",
           x = Msg("OFF")
                 x = Msg("ON")
      mailfds = null
   call save_table

"CONTROL DISPLAY SAVE"
BJ) SHARED"
 then
ug ")"
ILSND" strÿ
         sendsubj = null
if erc = 0 then do
all save_table
llmsg = 'An Answer has been sent to',
loc)"."strip(mailfid)
      mailsmsg = 'Cancelled'
ncelled to',
                end
          "VGET (TSOMPRT TSOMPRTO) PROFILE"
E"
f length(mailtds) > 0 then

zsel_print = null
"on"
           if length(tsomprt) = 0 then do
pt = "on" then
RINT "mailtdsÿ

           end
ds_opt = "on" then
          "PR DS("mailtds") NOTRC DEST("tsomprt")" tsomprto
      else "SELECT CMD(",
') NOTRC DEST("tsomprt")",
             end
e_table
ge has been processed by the Rockwell',
ialog'
 do
   mailsmsg = 'Flaged'
uÿ
 ÿ
AY PANEL(TMAILCML)"
able
e information haÿ
      /* Perform logging of messages in this routine */
 then do
ith logds lognum
ogsel) = 0 then log_n = ''
el
        "Select CMD(%TMAILLOG LOG" log_n")"
"
ncelled'

      else do
ailsmsg = 'Logged'
ly complÿ
        end
      if zsel = "S" && zsel = "B" && zsel = "E" && zsel = "R" then do
    "CONTROL DISPLAY SAVEÿ
si(mailtds ÿ
*/
migrated to disk */
                /* migrateÿ
25 then x = "OK"
(
              do until drc > 0

ubstr(subopt,x+1,1)
n do
             end

= rc  /* save return code */
       mailsmÿ
as been processed'
 mailactn = "File Select"
  end
when zcmd = 0 then do
um")')"

 end
DATASET("mailtds")"
 3 then do
   if length(tsomprt) = 0 then
                  "%KPRINT"  mailtds ") NEWAPPL(ISR)"
lse
mÿ
on"
                    parse var mailsubj x1 x2 x3
s(".",x3)

= 0 then do
                            if sysrÿ

ailtds newname
                                   mailactn = "Renamÿ
          mailÿ
= 'File' mailtds 'has been',
 to' newname
                             ÿ

             maillmsg = 'File' newname 'currently exists',
      +
      ÿ
end of the '4' select */
                 "SELECT CMD(",
ailsubj mailfloc mailfiÿ
                     end
                 Address TSO "PDS" mailtds

                     x = MSG("OFF")
" mailtds
      maiÿ
mailtds = null
 end
pos(".SERVLINK",mailfds)ÿ
 mailfds with "A." ptfname ".SERVLINK" c
IBMLINK."ptfname
e targdsn = null
 "DISPLAY Pÿ
                           mailsmsg = 'Cancelled'
  maillmsg = 'Unterse processing for:' ,
      mailtds 'has been cancÿ
                    else do
                     "%TMAILPTF" mailfds mailtds targdsn
       sel_msg = "on"
     end
 zcmd = null
            if rc > 0 then do
llÿ
                                  mailtds 'has been cancelled'
              end

O,
,
                ÿ

ess TSO,
tds')',
g fflack
            end
 
rocessing */
       subopt = null
 if sel_msg <> "on" then do
en do
               maillmsg = 'File' mailtds 'has been processed'
              end
            ÿ
    ÿ
»
          end
zsel = "R" then do
        "BROWSE DATASET('"tablet"(M"mailnum")')"
              "BROWSE DATASET("mailtds")"

      maillmsg = 'Message has been reviewed using ISPF BROWSE'
end
_opt = null then

           if rc = 0 then mailactn = "Edited"
 mailactn = "Read"
g = mailactn
g ISPF EDIT'
   if zsel = "D" then do
ds = ÿ
do
t
    when sysreason =ÿ
 = 26 then x = "OK"
       end
 if sysreason = 9 then Address TSO ÿ
reason = 0 then do
            Address TSO "DEL"  mailtds
                        parse value mailtds with "ÿ
                        "LMINIT DATAID(msgtb) DATASET('"ds"') Enq(Exclu)
                         "LMOPEN DATAID("msgtb") OPTION(OUTPUT)"
                "LMMDEL DATAID("msgtb") Member("mem")"

d("msgtb")"
              parse value null with mailtds dm
ÿ
PANEL(TMAILCFDÿ
 = "nono"
              iÿ

                then Address TSO "HDEL" mailtds
s TSO "DEL"  mailtds
m = 'and related file' mailtds
ltds = null
 then dm = "nono"
o" then do
.",'*')
M"mailnum")'"  /* delete message */
           "TBSAVE "mailtbl" REPLCOPY LIBRARY("mailtbl")"
msÿ


 "Delete Cancelled"
celled, use DM to",


EL '"tabÿ
ailtds "norecall")
iltds
       x = outtrap('OFFÿ
SAVE "mailtbl" REPLCOPY LIBRARY("mailtbl")"


¸
 message */

msg = 'Deÿ
    end
')
eason = 9 then Address TSOÿ
hen Address TSO "DEL"  mailtds
iltds = null
et ÿ
ocessing */
                  "SETMSG MSG(MAIL000)"
r table processingÿ
 message and ISPF table entry are copied by this
e primary TSO Mail data set and ISPF Table
 data set and ISPF table. */
before doing the log  */

rblk-sysudirblk) < 5 then do
      sysadirblk = sysadirblk + 15
ble = "yes" ÿ
      x = length(new_logds)
,x)
SG("OFF")
 Address TSO,
              Address TSO "Free  ds('"new_logds"')"
AID(tblin) DATASET("logds")"
'"new_logds"')"
     "TODATAI+
"

    "RENAME" logds "'"old_logds"'"

  ÿ
  "TBOPEN TM"lognum "LIBRARY(TM"lognum") WRITE"
"
lognum") REPLCOPY"
iltbl
 logdst = strip(logds,,"'")
et"')"
      "LMMove FROMID("msgin")",
(M"mailnum") REPLACE"
  "LMFREE Dataid("msgout")"
      = substr(data.i,63,2)  /* day of month   */
 = substr(data.i,66,3)  /* month name abr */
bstr(dÿ
str(data.i,75,8)  /* time hh:mm     */
reset the target data set */
      return
m node ÿ
serid    */
oc = center
 substr(data.i,17,8)  /*+
bstr(data.i,26,8)  /* ÿ
       toinfo1:   day      = substr(data.i,63,2)  /ÿ
               month    = substr(data.i,66,3)  /* month name abr */
          year     = substr(data.i,70,4ÿ
       mailtime = substr(data.i,75,8)  /* time hh:mm     */
    mailfid  = userid
    call fixdate
      if type = "F" && type = null then do
wÿ
       msgcount = 0
message,
      return    ÿ  /* incomplete file receive     */
       call getnum


  if left(mailtid,4) = "SMTP" then do
  mailtid  = mailsmtp
ALID.FILE" then call do_invalid_file
       mailsmtp = null
UNT FCOUNT)"
 "CONTROL DISPLAY LOCK"
end
      say "Message" mcount "has been added to the table with",
    msgcount "records"
n" then do
(M"mailnum")') SHR REUSE"
 msg."
    end
")'"
r message is:" mailtds
eck_message_ds
("mailtds") SHR"
       "FREE FILE(MSG)"
m")') SHR REUSE"
           "FREE FILE(MSG)"

ltds type msg. long_message


le *
ocks                     *
        *  > 1 cyl                         */

 sysusÿ
            if sysused > 4  then return
 then

("mailtds") SHR"
          "Free f("inv_dd")"
  Select
                 parse value invalid.1 with . "From:" ,
mailfid "--" mailfloc "To:",
atd mailtime
     mailfloc = strip(mailfloc)

ailtds

              /* now verify that the month/day/year are valid */
      if datatype(month) <> "NUM" then month = 00
pe(day)   <> "NUM" tÿ

   day   = day   + 100
ht(day,2)
              ÿ

   msg.1 = " From:    " mailfid "at" mailfloc "  on " ÿ
                mailtime
" mailtloc
  msg.4 = " "
     end
PEXEC
ubj) shared"
 mailsubÿ
ut (newsubj) shared"

eturn
0 then do
tsomnum = "TS"random()
UM)'")
Æ
s = "OK" then
i."
um = numi.1
+ 1
           num.1 = mailnum
tem num."
È
0
''month''day
         retuÿ
9) then

            return
lfloc
           mailfid = mailfid"@ibmmail.com"

= ÿ
f_pause
------------------------------------------------------------ *
heck_message_ds  ÿ






  if "OK" <> sysdsÿ
    "ALLOC DS("message_dsq") NEW DIR(60) SPACE(30,90) TRACKS DSORG(PO)",
       "RECFM(V B) LRECL(255) BLKSIZE("VB_Blksize")"
    else do
sysextents > 10 then newtable = "yes"
 5 then do
 sysadirblk + 15
ewtable == "yes" then do


            ÿ
sg("OFF")
,
SPACE("sysalloc",90) TRACKSÿ
KSIZE(ÿ
"
py FROMID("tblin")",
        "LMFREE Dataid(ÿ
       Address TSO "DELETE" message_ods
e_dsq message_ods

NMR06                                {




ÈÈÈ½





DEF
MAILFFL
º
D
ILHC 
   

HLP
 TMAILH0 

B
MAILH1D
8    

H2A
 TMAILH2C

B
MAILH3D
8    

ILPO 
   TMAILPTF
§
RW 
 TMAILSFL
8    
D
MAILSUF
D    TMAILTBS
¦Ì
ILUNT
 TMAÿ
238    
HLP
MLOGH1 
8    TMLOGH2B
 
OGTBS
   TMLOG1  
A1238    
TL 
 TMNIKTLL
8  ÿ
 
MNIKT1B
   ÿÿÿÿÿÿÿÿ


   Defaults displayed for */           /* + type(text  ) intens(low )
        information only  */            ÿ
) just(left ) ÿ
) just(asis ) color(yellow)                   | type(output) intens(low
ff) just(asis ) color(white)                  ` type(textÿ
ff) just(asis ) color(turq)  ÿ
ps(off) just(asis ) color(white)                  # type(text) intens(lo
(off) just(asis ) color(white)                 )Body
                                            ÿ
E-Mail Forward Processing +------------------------%Command ===>_zcmd
                                                   %
           ÿ
                                                       `      Enter the
 Userid of the person to receive the forwarded         `      TSO Mail i
`to send the mail back to thÿ
                                                           +
                                                            `    Userid
ame to receive the mail or %*`               ÿ
WDUSER   +
_FWDNODÿ
                                                                ÿ
rded flag in text%===>_FWD  ` Yes, No or Never                     `
 is shifted right 2 coÿ
s - set flag, No - do not set flag this time, Never - never set flag)`
 ÿ
iginal Sender:                       ÿ
         Userid:!mailfid
         Node:  !mÿ
                                                    ÿ
   Original Subject:
            !mailsubj              ÿ
Init                                                               ÿ
  .cursor = FWDUSER
  .help   = TMAILHFW                                ÿ
    if (&fwd NE NEVER)
  ÿ
     )Reinit                                                         +
        if (&fwd NE NEVER)                                         ÿ
              &FWÿ
           )Proc
            IF (&FWDUSER = '*')
    ÿ
                    &FWDNODE = &MAILFLOC
                VER (&FWDUSER,NB)
                VER (ÿ
                    IF (&FWDNODE NE &Z)
                       &FWDID = '&FWDNODE..&FWDUSER'
                    IF (&FWDNODE = &Z)ÿ
                           &FWDID = &FWDUSER
                        if (&fwd NE NEVER)
                           &FWD = TRANS(TRUNC(&FWD,1) Yÿ
                            Ver (&FWD,NB,List,YES,NO,NEVER)
                            VPUT (FWD) PROFILE
                           )End
            ÿ
                                                           /* % type(tex
ens(high)              Defaults displayed for */           /* + type(tex
ens(low )                  +
 intens(high) caps(on ) jÿ
t) intens(high) caps(on ) just(left ) pad('_')                      ^ ty
 intens(high) caps(off) just(asis ) color(yellow)                   @ ty

(uscore)
utput) intens(low ) caps(off) just(asis ) color(white)
ext) intens(low ÿ

----------------% TSO/E-Mail Forward Processing +-----------------------
d ===>_zcmd                      ÿ

 Enter the Node and Userid of the person to receive the forwarded item:
                                                  ÿ
   Usÿ
 %   Userid  %===>_fwduser
 %   Nodename%===>_fwdnode `    NJE Location for userid            ÿ
   `                ÿ
     `   Send the file      %===>_Z+ %Y`Yes%N`No or%M`as a message
     `
    ÿ
         `
         `   Subject: @mailsubj
         `           ÿ
             `   Origin Node:         |mailfloc
             `          User:         |mailfid
             `   Original data set:   ÿ
                 `   Associated data set: |mailtds
                 `
                 `   The Forward flag will shift the meÿ
ÿ
                     )Init
                      .cursor = fwduser
               ÿ
                          .ZVARS = '(MsgFILE)'
                          &Msgfile = trans(trunc(&Msgfile,1) Y,Y N,N M,M
         +
         ÿ
S *,*)                         )Reinit
                                if (&fwd NE N+
                          ÿ
&Z,YES *,*)                          )Proc
                                      IF (&FWDUSER = '*')
                                          &ÿ
                                              &FWDNODE = &MAILFLOC
                                          VER (&FWDUSER,NB)
                                          VER (&FWDNODE,NAMEÿ
                                              IF (&FWDNODE NE &Z)
                                                 &FWDID = '&FWDNODE..&FW
                                              IF (&FWDNODE = &Z)
        ÿ
                                                  VER (&MSGFILE,NB,LIST,
                                                  &FWDFILE = &MSGFILE
              ÿ
                                                         &FWD = TRANS(TR
,1) Y,YES N,NO *,*)                                   Ver (&FWD,NB,List,
EVER)                          «      ÿ
                                                         )End
                                                         {
	
       /* % type(text  ) intens(high)              Defaults displayed fo
       /* + type(text  ) intens(low )                   information only
       /ÿ
              ^ type(text) intens(high) caps(off) just(asis ) color(yell
              ! type(output) intens(low ) caps(off) just(asis ) color(wh
              | type(textÿ
   ÿ
               )Body
               +--------------------------ÿ
-----------------%ÿ
                   `
                   `                                       ÿ
                     `      The^Fÿ
et to an existing      `      or new data set.  If the received data set
S then you can         `      elect to have the members replace existing
rs during the copy       `      to an existing dÿ
                           `
                           `      Select^Yes`for ISPF statistics if you
ing a sequentÿ
generated.                     `                             ÿ
                                 )End
                                  
                                                             /* % type(t
 intens(high)              Defaults displayed for */           /* + type
 intens(low )                   information only  */           /ÿ
t) intens(high) caps(on ) just(left )               */              ^ ty
 intens(higÿ
put) intens(low ) caps(off) just(asis ) color(white)                  |
tÿ
ext) intens(low ) caps(offÿ
                                                                       +
------------------ÿ
d ===>_zcmd                              ÿ

                                   ÿ
  TSO Mail Defaults are important as they provide the neÿ
    for the proper processing of your mail.
                                                    ÿ
 `    Your%Name, Mailing address`and%Electronic address`will be used inÿ
   `    messages that you send to others.
   `                                                                 ÿ
     `    The current%Node`is used in the messages that you send to iden
re   `ÿ
       `
      ÿ
ause     `    a copy ÿ
ich will   `    allow you to resend them and/or print them.
           `           ÿ
             `    Specifying whetherÿ
nowledged`     `    will provide you with notification that your outgoin
e has been     `    read by the recipienÿ
                 )Init                             ÿ
                   )Proc
                     &zsel = *tmailhd2                   h
                     )End                                         ÿ
                       
                                                 /* % type(text  ) inten
             Defaults displayed for */           /* + type(text  ) inten
 +

gh) caps(off) just(asis ) color(yellow)                   ! type(output)
low ) caps(off) just(asis ) color(white)                  | type(textÿ
s(high) color(ÿ
s(low ) caps(off) just(asis ) color(turq)                  )Body
                                                           +------------
------ÿ
d                                                              %

                       ÿ
on to retain 3 mail logs for diagnostic purposes is available if   `
our systems programmer suspect that you may be losing mail         `
of some unique situation.  Since the maiÿ
 logs, retaining copies will help with diagnosis.  The logs will be    `
ixed HOLD1.LOG, HOLD2.LOG and HOLD3.LOG with a prefix of your userid   `
a qualifier as defined by the installation.              ÿ

The%Print`options are used to provide a fast path for printing of your
messages.  If the printer destination is blank then you will be prompted
  by a prÿ
    different print options and printer types.
Init
Proc       s            ÿ
   )End
   
                             /* % type(ÿ
lts displayed for */           /* + type(text  ) intens(low )
information only  */           /ÿ
eft )               */              ^ type(text) intenÿ
sis ) color(yellow)                   ! type(output) intens(low ) caps(o
(asis ) color(white)                  | type(textÿ
                                        ` type(text) intens(low ) capÿ
st(asis ) color(turq)                  )Body
                                       +------------------------% ÿ
orward Message +-------------------------%Command ===>_zcmd
    ÿ
                                           `    This dialog allows you t
d aÿ
ail.               +
                 ÿ
                      ÿ
                                                   ^    Userid     `The
) or nickname(s) of the intendedÿ
 be used to forward the message to the ÿ
a better technique for answering messages)             `
                                               ÿ
de name to be used if a userid is specified             ÿ
s field may be blank if you are using a nickname)          `
                                                           ^  ÿ
is message has an associated file.  Specify 'Y' if you       `
want to forward the file first.  Specify 'M' to send it        `
the file as the message.                                       `
                                                                 ^    Fo
 `If this ÿ
    2 columns and the '>' symbol inserted in column 1.  A line     `
    of text ÿ
      text to indicate the ÿ
                                                                       )
                           ÿ
                                            Æ


                     /* % type(text  ) intÿ
layed for */           /* + type(text  ) intens(low )
ion only  */           /ÿ
            */              ^ type(text) intens(high) capÿ
lor(yellow)                   ! type(output) intens(low ) caps(off) just
color(white)                  | type(textÿ
                                ` type(text) intens(low ) caps(off) just
) color(turq)                  )Body
                               +------------------------% ÿ
essage +-------------------------%Command ===>_zcmd
       ÿ
                                   `
                                     `    This dialog allows you to forw
ssage to other individÿ
                                       `
            ÿ
                                     +
                                   ÿ
ickname(s) of the intended reciÿ
ed to forward the message to the original      `                sender (
 technique for answering messages)             `  ÿ
                                                ÿ
e to be used if a userid is specified              `                (thi
may be blank if you are using a nickname)          `             ÿ
                                                     ^    Forwardÿ
is 'yes' the forwarded text will be shifted right      `
s and the '>' symbol inserted in column 1.  A line     `
ÿ
o ÿ
                                                           )Init
               ÿ
                   h                                           )End
                                                               

           /* % type(text  ) intens(high)              Defaults displaye
           /* + type(text  ) intens(low )                   information
           /ÿ
  */              ^ type(text) intens(high) caps(off) just(asis ) color(
                  ! type(output) intens(low ) caps(off) just(asis ) colo
                  | type(textÿ
                      ` type(text) intens(low ) caps(off) just(asis ) co
)                  )Body
                   +--------------------------ÿ
-----------------------%Command ===>_zcmd
                       %
                                                               ÿ
          ÿ
ard IBM provided TSO       `    Transmit and Receive commands that provi
 screen ISPF dialog        `    support for sending and receiving messag
ÿ

                                    The following tutorial options will
ayed in sequence ÿ

                                   |    1 -^Commands          `Commands
 be entered on the Command line   ÿ
election options for individual messages/files
                                                   )Init
                                                   )Proc       2      ÿ
                                                         &zsel = trans(&
mailh1 2,tmailh2 *,?)                                  )End
                                                       
 )Attÿ
   /* % type(text  ) intens(high)              Defaults displayed for */
   /* + type(text  ) intens(low )                   information only  */
   /ÿ
          ^ type(text) intens(high) caps(off) just(asis ) color(yellow)
          ! type(output) intens(low ) caps(off) just(asis ) color(white)
          | type(textÿ
              ` type(text) intens(low ) caps(off) just(asis ) color(turq
           )Body
           +--------------------------ÿ
---------------%Command ===>_zcmd
               %
                                                       ÿ
                   `    The TSO/E-Mail EPILOG is any comment, up to 10 l
at you wish to     `    have included at the end of every message that y
  This is          `    optional.
ÿ
                       )Init
                       )Proc
         %     ÿ
                           
                                                     /* % type(text  ) i
gh)              Defaults dispÿ
low )                   information only  */           /ÿ
s(high) caps(on ) just(left )               */              ^ type(text)
high) caps(off) just(asis ) color(yellow)    ÿ
ens(low ) caps(off) just(asis ) color(white)                  | type(tex
ntens(high) color(white)                                        ` type(t
ens(low ) caps(off) just(asis ) color(turq)                 ÿ
                                                               +--------
----------ÿ
cmd                                                              %
                                                                   `
                             ÿ
Mail Processing is an extension to the standard IBM provided TSO       `
smit and Receive commands that provides full screen ISPF dialog        `
ort for ÿ

With this ISPF Dialog you have the ability to^Open Mail`which will
receive all new messageÿ
    It will also receive any data sets that have been sent to you and
    store them as unique data sets pending further action by you.
                                      ÿ
ÿ
   `    another user, either at the current NJE Node or at another locat
   `                                                 ÿ
     `           ÿ
       `    The following tutorial will be displayed only if selected:
       `                                                            ÿ
         |      1 -^Full Tutorial ÿ

           )Init
   ÿ
                 &zsel = trans(&zcmd 1,*tmailhlp *,?)
               )End
               
                                           /* % type(text  ) intens(high
       Defaults displayed for */           /* + type(text  ) intens(low
            information only  */ ÿ
ps(on ) just(left )               */              ^ type(text) intens(hi
(off) just(asis ) color(yellow)                   ! type(output) intens(
ps(off) just(asis ) color(white)                ÿ
) color(white)                                        ` type(text) inten
caps(off) just(asis ) color(turq)                  )Body
                                                   +-----------ÿ
ÿ
                                                       %
                                                       `      The follow
mmands may be entÿ
l Table display.  Information on them will be presented    `      in seq
 selected by number.
             +
mand Optionÿ
                                                                 |
ults          `Establish TSO Mail Processing Defaulÿ
nd              `Find a chÿ
Refresh           `Process new mail and redisplay the mail table     |
Sendmail          `Send a note to another user                      ÿ
-^Sort              `Sort the table by thÿ
5 -^Safemail          `Registration for SAFE Mail Processing
6 -^Logging           `Log the message into a log of related messages
     ÿ
    Display Command Options:

       ^Long          ÿ
 |         ^Short             `Use a short 1 line display for each messa
 |         ^XLong             `Use a extra long 3 line display for each
                                       ÿ
   )Inÿ
     )Proc
       &zsel = trans(&zcmd 0,tmailh10  1,tmailh1a  2,tma“ ilh1b  3,tmail
                     ÿ
         )End
         
                                   /ÿ
 Defaults displayed for */           /* + type(text  ) intens(low )
      information only  */           /ÿ
just(left )               */              ^ type(teÿ
just(asis ) color(yellow)                   ! type(output) intens(low )
) just(asis ) color(white)                  | type(textÿ
white)                                        ` type(text) intens(ÿ
ff) just(asis ) color(turq)                  )Body
                                             +--------------------------
/E-Mail Tutorial +-----------------------------%Command ===>_zcmd
 ÿ
                                                 `
         ÿ
scroll the tableÿ
string is found in any field in the table.           `
                          ÿ
                               +
lue                          ÿ
                                             ÿ
D`can be abbreviated to^F                                    `
                                            ÿ
                                                              ÿ  `
                                                                 `
                                                           ÿ
                                                                   
ç
             /* % type(text  ) intens(high)              Defaults displa
r */           /* + type(text  ) intens(low )                   informat
  */           /ÿ
    */              ^ type(text) intens(high) caps(off) just(asis ) colo
)        ÿ
ite)                  | type(textÿ
                        ` type(text) intens(low ) caps(off) just(asis )
rq)                  )Boÿ
                       +--------------------------ÿ
-------------------------%Command ===>_zcmd
                         `             ÿ
                           `                                       ÿ
                             `      The^REFRESH`command will check for n
and update the mail table    `      for all new mail mÿ
                               `
    ÿ
                                 `                                   ÿ
                                   `      Note:   ^REFRESH`can be abbrev
^REF.                ¼               `
                                     )End
    ÿ
+_)                                                              /* % ty
 ) intens(high)              Defaults displayed for */           /* + ty
 ) intens(low )    ÿ
input) intens(high) caps(on ) just(left )               */
ext) intens(high) caps(off) just(asis ) color(yellow)
utput) intens(low ) caps(off) justÿ
(textÿ
pe(text) intens(low ) caps(off) just(asis ) color(turq)
                                                 +
----------------------ÿ
Command ===>_zcmd

                                       ÿ
   `      The^SENDMAIL`command allows you to send a message to another u
   `      anywhere in the network.
   `                                                    ÿ
       `      Syntax: ^SENDMAIL recipient
       `
       `      Note:    recipient is optional and if not specified a prom
panel    `  ÿ
           `              ^SENDMAIL`can be abbreviated to^SEND.
           `
          ø  `      SENDMAIÿ
e text.        )End
               
                                         /ÿ
       Defaults displayed for */           /* + type(text  ) intens(low
            information only  */           /ÿ
(on ) just(left )               */              ^ type(teÿ
(off) just(asis ) color(yellow)                   ! type(output) intens(
ps(off) just(asis ) color(white)                  | type(textÿ
color(white)                                        ` type(text) intens(
caps(off) just(asis ) color(turq)                  )Body
                                                   +--------------------
-% TSO/E-Mail Tutorial +-----------------------------%Command ===>_zcmd
       ÿ
                                                       `      The^SORT`c
ill sort the enÿ
e sort key or display ÿ
o sort by.                                                 `
                                ÿ
T field-name direction               ÿ
                                                               `      No
ield-name must be specified and must be one of thÿ
 names documented below^or`if blank will cause a selÿ
   panel to be displayed.                                          `
 - direction is^A`for ascending or^D`for descending (default=A).  ÿ
                                                                   +
pported field-names:                                             ÿ

FROMNÿ
  FROMUSER  `Sending User ID         ^TIME      `Time the message receiv
ÿ
    TOUSER    `Receivin ng User ID
End

                           /* % type(text  ) intens(high)              D
displayed for */           /* + type(text  ) intens(low )
rmation only  */           /ÿ
t )               */              ^ type(text) intens(high) caps(off) ju
) color(yellow)                   ! type(output) intens(low ) caps(off)
s ) color(white)                  | type(textÿ
                                      ` type(text) intens(low ) caps(off
sis ) color(turq)                  )Body
                                   +------------------------ÿ
Tutorial +-----------------------------%Command ===>_zcmd
                                       `
                                       `
 ÿ
ke the registration dialog for             `      Safe Mail procesing.
                                           `
          ÿ
                                               `
                                               `      SAFE Mail is a pro
t runs daily to receive mÿ
ve been sent to you from another user for          `      you while you
of the office for more than a few days.            `      This is to pre
se mail messages and mail files from    ÿ
 the system because of age.                            `
                                                       )End
                                                       ÿ

   /* % type(text  ) intens(high)              Defaults displayed for */
   /* + type(text  ) intens(low )                   information only  ÿ
     /ÿ
          ^ type(text) intens(high) caps(off) just(asis ) color(yellow)
          ! type(output) intens(low ) caps(off) just(asis ) color(white)
     +
   ÿ
             )Body
             +--------------------------ÿ
---------------%Coÿ
                 `
                 `                                       ÿ
                   `      The^LOGÿ
ou can review,       `      create and process multiple log data sets.
                     `
                       `      A LOG is a data seÿ
ata set, in which you    `      can log messages that are related.  It c
be used as a message     `      archive facility.
           ÿ
                             `      Message selection option^L`is used t
t that a message be          `      logged.
                            ÿ
                                 `      Optionally, by specifying a mess
ction option of Ln, where n is   `      the number of the log data set,
perform the logging task         `      fastes r.
             ÿ
                                     
)                                                              /* % type
 intens(high)              Dÿ
 ) intens(low )                   information only  */           /ÿ
put) intens(high) caps(on ) just(left )               */              ^
t) intens(high) caps(off) just(asis ) colorÿ
utput) intens(low ) caps(off) just(asis ) color(white)
extÿ
(text) intens(low ) caps(off) just(asis ) color(turq)     ÿ

--------------------ÿ
and ===>_zcmd

                                     ÿ
      The^DEFAULT`command will display a panel upon which certain requir
      vaÿ
 `      the first time it is required and may be selecÿ
   `      change the defaults at any time.
   `                   +
     `      Syntax: ^ÿ
         `
         `      Note:   ^DEFAULT`can be abbreviated to^DEF.
         )End                       ÿ
            
                                       /* % type(text  ) intens(high)
   Defaults displayed for */           /* + type(teÿ
          information only  */           /ÿ
n ) just(left )               */              ^ type(text) intens(high)
) just(asis ) color(yellow)                   ! type(text) intens(ÿ
ff) just(asis ) color(turq)                     | type(textÿ
lor(white)                                        ` type(text) intens(lo
(off) just(asis ) color(turq)                  )Body
 ÿ
 TSO/E-Mail Tutorial +-----------------------------%Command ===>_zcmd
                                                   %
                ÿ
election commÿ
he left of each message in the TSO Mail Table          `      display.
ion on them will be presented iÿ
er.                           ÿ
                                                           |      1^(A)|
 the mail                                     ÿ
te the note                                    ÿ
it the note                                                    |      4^
rward the note                                               ÿ
Print the note                                                  ÿ
-!Log/Archive the message                                          |
-!Change the subject and status of a message for clarity           |
)|-!Merge the data set associated with message into the message      |
)ÿ
File options:  Read, Browse, Copy, Delete,                             `
           ÿ
                  ÿ

                          ÿ
zsel = trans(&zcmd 1,tmailh2a  2,*tÿ
                     5,*tmailh2b 6,*tmailh2b  7,*tmailh2b
                     8,tmailh2c  9,tmailh+
                       A,tmailh2a  D,*tÿ
                           P,*tmailh2b L,*tmailh2b  C,*tmailh2b
                           M,tmailh2c  S,tmailh2d
                           *,?)                       ÿ
         )End                                                        
           {
                                       /* % type(text  ) intens(high)ÿ
     Defaults displayed for */           /* + type(text  ) intens(low )
          information only  */           /ÿ
n ) just(left )               */              \ type(text) intens(high)
) juÿ
(off) just(asis ) color(white)                  | type(textÿ
lor(white)                                        ` type(text) intens(lo
(off) just(asis ) cÿ
                                                 +----------------------
 TSO/E-Mail Tutorial +-----------------------------%Command ===>_zcmd
                                  ÿ
                                                     `      The\Answer`o
 used to sendÿ
 This option is a fast path to the SENDMAIL      ÿ
 receiving node and userid predefined with the node      `      name and
of the person who sent you theÿ
ined with the subject of the original message.             `    ÿ
                                                             `      The\
ption is used to delete the message and any assÿ
accompanied the message.  Note that you will be prompted       `      to

ugh you have deleted the message, or delete the file and        ÿ
 the message. Use of\DN`will delete the message and file           `
t any promptinÿ
                                                                     `
Dÿ
ssage, or as\DF`to delete theÿ

The\Edit`option wiV ll invoke ISPF Edit to allow the user to edit
  the saved message.                        ÿ
d

                       /* % type(text  ) intens(high)      ÿç
 Defaults displayed for */           /* + type(text  ) intens(low )
      information only  */           /ÿ
just(left )               */              ^ type(text) intens(high) caps
just(asis ) color(yellow)                   ! type(output) intens(low )
) just(asis ) color(white)                  | type(textÿ
white)                                        ` type(text) intens(low )
) just(asÿ
                                             +--------------------------
/E-Mail Tutorial +-----------------------------%Command ===>_zcmd
                        ÿ
                                                 `
         ÿ
used to resend the message and any     ÿ
 another user or users.  This option interfaces      `      to the SENDM
and and will copy in full ÿ
ext edit area of the new message so that you can      ÿ
e original message before sending it.                    `
                                           ÿ
on will display a selection menu of the available          `      ISPÿ
 for printing on various types of printers.  See the         `      tuto
 each of those dialogs for more specific information        ÿ
uirements for printing on the different printers.              `      Th
n wiÿ
.                                                                `
                                                                   `
option will move thÿ
ages.  ^Ln`where^n`is the number of the table can also be specified. `
              ÿ
e^C`option will allow you to changÿ
it's status to clarify it for later retrieval.
                               Î


                       /* % type(text  ) intens(high)              Defau
layed for */           /* + type(text  ) intens(low )
ion only  */           /ÿ
              */              \ type(text) intens(high) caps(off) just(a
lor(yellow)                   ! type(output) intens(low ) caps(off) just
color(white)                  | type(textÿ

s ) color(turq)                  )Body
                                 +--------------------------ÿ
rial +-----------------------------%Command ===>_zcmd
            ÿ
                                     `
                                       `      The\Merge`option is used t
the data set associated witÿ
 done only for those data sets that      `      have a line length of 80
ers per line oÿ
e.                                        ÿ
                                             `      Use of\MF`will force
 even if the data does exceed 8¼ 0 bytes       `      per line.
                                               )End      ÿ
                                                 
 Default(%+_)
type(text  ) intens(high)              Defaults displayed for */
+ type(text  ) intens(low )                   information only  */
* _ type( input) intens(high) caps(on ) just(left )               */
  ^ type(text) intens(high) caps(off) just(asis ) color(yellow)
  ! typÿ
    | type(textÿ
      ` type(text) intens(low ) caps(off) just(asis ) color(turq)
   )Body              ÿ
     +--------------------------ÿ
-------%Command ===>_zcmd
       %                             ÿ
         %                                       ÿ
           `      The^Select`option will display a selection menu of the
 that      `      are provided for processing the reÿ
ion can      `      be specified in the selection field by enterinÿ
n`is one       `      of the available options.
               `                                                   ÿ
                 `      The options available are:
   ÿ
                   |      0 -^Read the message that accompanied this dat
  ÿ
                    ÿ
                       |      3 -^Print the data set
                 +
               ÿ
                             |      6 -^Use the PDS command to process t
set                          |      7 -^Delete the data set
                             |ÿ
LINK                             |      9 -^Forward the data set to anot

                                 )Init       ÿ
                                     )Proc
                                       &zsel = trans(&zcmd 0,tmailh3a
h3a  2,*tmailh3a  3,tmailh3b                               4ÿ
ilh3b  6,t“ mailh3c                                            7,*tmailh
mailh3c  9,*tmailh3d *,?)                )End
                                         
lt(%+_)                                                              /*
ext  ) intens(high)              Defaults displayed for */           /*
ext  ) intens(low )                   information only  */           /ÿ
( input) iÿ
pe(text) intens(high) caps(off) just(asis ) color(yellow)
pe(output) intens(low ) caps(off) just(asis ) color(white)
pe(textÿ
` type(text) intens(low ) caps(off) just(asis ) color(turq)
dy
------------------------ÿ
-%Command ===>_zcmd
 `
 `                                       ÿ
     `      The^S.0`or^Read`option will display the transmit message tha
nt   `      along with the data set using ISPF Browse.
     `                                                    ÿ
         `      The^S.1`or^Browse`option will display the data set using
owse.    `      All of the standard ISPF Browse capabilities are availab
         `      browsing the selected data set.
     ÿ
             `      The^S.2`or^Edit`option will invoke ISPF Edit on the
 data set.   `      ALL of the standard ISPF Edit capabilities are avail
le editing  ÿ
                 `
                 %      Notes:
                 `     ^S.0`mÿ
                     `     ^S.1`mÿ
                       `     ^S.2`may also be specified as:^ED`or^EDIT
                       `                        n
                         )End                   ÿ
                           
                                                     /* % type(text  ) i
gh)              Defaults displayed for */           /* + type(ÿ
low )                   information only  */           /ÿ
s(high) caps(on ) just(left )               */              ^ type(text)
high) caps(off) just(asis ) color(yellow)                   ! type(outpu
ens(low ) caps(off) just(asis ) color(white)                  | type(tex
ntens(high) color(white)                                        ` type(t
ens(low ) caps(off) just(asis ) color(turq)                  )Body
             ÿ
----------ÿ
cmd                                                              `
                            ÿ
                           ÿ
S.3`or^Print`option will display a menu of the available print       `
ogs used for printing data sets.  See that ÿ
formation on printing the selected data set.ÿ

The^S.4`or^Rename`option will allow you to rename the seleÿ
                                                             ÿ
    The^S.5`or^Copy`option will allow you to copy the selected data set
    another data set.  If the data set does not exist then it can be
      allocated.
 `
 %      Notes:
 `     ^ÿ
   `     ^S.4`m2 ay also be specified as:^RN`or^REN`or^RENA`or^RENM
     `     ^S.5`may also be specified as:^CO`or^COP`or^COPY`or^CPY
     )End              ÿ
       
                                 /* % type(text  ) intens(high)
aults displayed for */           /* + ÿ
    information only  */           /ÿ
st(left )               */              ^ type(text) intens(high) caps(o
(asis ) color(yellow)                   ! type(output+
just(asis ) color(white)                  | type(teÿ
white)                                        ` type(text) intens(low )
) just(asis ) color(turq)                  )Body
                                           +----------------------ÿ
/E-Mail Tutorial +-----------------------------%Command ===>_zcmd
                                               `
                                               `
 ÿ
will invoke the ISPF PDS dialog for the selected   `      data set.  The
very complete tutorial for this option             `      available once
PDS dialog.     ÿ
                                                       `      The^S.7`or
option will allow you to delete the selected data set. `
                               ÿ
`option will invoke the IBM utility to unterse data sets   `      compre
ng the TERSE utility (e.g. PTFs from IBMLink)              `
                                              ÿ
                                                               `     ^S.
so be specified as:^PDS                                        `     ^S.
so be specified as:^DEL                                      ÿ
y also be specified as:^UNT, PTF, UNTERSE                          )End
                                                                   
ç
               /* % type(text  ) intens(high)              Defaults disp
r */           /* + type(text  ) intens(low )                   informat
  */           /ÿ
    */     ÿ
ow)                   ! type(output) intens(low ) caps(off) just(asis )
ite)                  | type(textÿ
                        ` ÿ
turq)                  )Body
                       +--------------------------ÿ
-------------------------%Command ===>_zcÿ
                           `
                           `                                       ÿ
                             `      The^S.9`or^XMIT`optiÿ
orward the selected data       `      data set to another user.
                               `
    ÿ
                                   `                                 ÿ
                                     `
                       ÿ
                                       %      Notes:
    ÿ
IT                                      ^  )End
                                           
lt(%+_)            ÿ
(text  ) intens(high)              Defaults displayed for */           /
(text  ) intens(low )                   information only  */           /
pe( input) intens(high) caps(on ) ÿ
type(output) intens(high) caps(off) just(asis ) color(white)
type(text) intens(high) caps(off) just(asis ) color(turq)
         ÿ
--------------------------% TSO/E-Mail Option Menu +--------------------
Selection ===>_zcmd
                          ÿ

   +              %0|- Defaults                           %Userid: !ZUSE
   +              %1|- Open Mail           ÿ

       +              %3|- Send a Note                        %Center: !
       +              %4|- Send a File                      ÿ
         +    ÿ
           +              %6|- SAFE Mail Registration
           +              %7|- Nick Name Management
             +               ÿ
               +
               +   %Defaults: |  Set various values related to sending m
              ÿ
selection table    |                 of all incoming and outgoing mail m
and files.         +   %Read Mail:|  Read all currently received mail.
                   +   %Send a ÿ
                       +   %Send a File:|Send a file to another user.
                       +   %Logs:       |Process and Create log data set
ssages.                +   %SAFE Mail:|  Registeÿ
                           +   %Nick Name:|  Work with nick names in you
e directory                +
                           )Init                                 ÿ
         +
       ÿ
                                 )Proc
    ÿ
                      ÿ
AIL)'                                               1, 'CMD(%TSOMAIL) NE
IL)'                 +
APPL(MAIL)'        ÿ
APPL(MAIL)'                                               4, 'CMD(%TMAIL
FILE) NEWAPPL(MAIL)'                                      5, 'CMD(%TMAIL
APPL(MAIL)'                         ÿ
                                                              7, 'CMD(%T
 NEWAPPL(MAIL)'                                               )
                                               )End  <             ÿ
                                                   {
Attr Default(%+_)
* % type(text  ) intens(high)              Defaults displayed for */
* ÿ
  ÿ
      + type(text  ) intens(low ) Skip(on)
      @ type( inpÿ
        | type(outpÿ
       )Body
       +---------------------% Tÿ
---------%Selection ===>_zcmd       ÿ
           +
           +Select which Nick Name data set youÿ
on-blank     +next to the data set name:             ÿ
               +
               + Sel  Data Set Name                           ÿ
                 +  @z+ |prim                                         ÿ
                   +  @z+ |alt1
                   +  @z+ |alt2
                     +  @z+ |alt3
       ÿ
                       +  @z+ |alt5
            ÿ
                        ÿ
                           +  @z+ |alt8
                           +
                         ÿ
                                 +
                                 !    To create a new alternate nick nam
elect the primary (1st) data set !    anÿ
n                                    +
                                     !    Enter PF3 to terminate process
his point.                           )Init             ÿ
                                           .ZVARS = 'ZP Z1 Z2 Z3 Z4 Z5 Z
Z9'                                      )Proc
                                         )End                         ÿ
              Æ                              
ault(%+_)                                                              /
(text  ) intens(high)              Defaults displayed for */           /
(textÿ
type( input) intens(high) caps(on ) just(left )               */
type( input) intens(high) caps(on ) just(left ) pad('_')
type(output) intens(ÿ
| type(textÿ
  ` type(output) intens(high) caps(off) just(right) color(white)
        hilite(uscore)             ÿ
    ~ type(text) intens(highÿ
   )Body
   +-------------------------% TSO/E-Mail Table Reÿ
-----%                                       ÿ
       %
       %                                                         ÿ
         %                                                    ÿ
           %          Your TSO Mail ISPF Table data set required more sp
           %
ÿ


               ÿ
                ÿ

                   )Init      ÿ
                     )Proc       s
                       )End
                       
                                           ÿ
gh)              Defaults displayed for */           /* + type(text  ) i
w )                   information only  */            ÿ
high) caps(on ) just(left )                               ÿ
s(high) caps(on ) just(left) pad('_') color(white)          ^ type(text)
high) caps(off) just(asis ) color(yellow)                   ` type(textÿ
s(low ) caps(off) just(asis ) color(turq)                     ! type(out
ntens(low ) caps(off) just(asis ) color(white)                  # type(t
ens(low ) caps(off) just(asis ) color(white)                 )Body
        ÿ
-----% Tÿ
cmd                                                              %
                         ÿ
                       ÿ
following nick names were specified, but could not be found in       `
nick name file.  Please correct the nick nÿ
t and then press the^ENTER`key to retrÿ

To cancel this^entire`transmission press the^&END`key.     ÿ
                                                     ÿ

    Invalid Nick Names:
     |tnames                                                        ÿ
 `
 )Init
  .cursor = tÿ
   ÿ
     )Proc
      &zcmd = &z              n
       )End       ÿ
         
                                   /* % type(text  ) intens(high)
efaults displayed for */         ÿ
      information only  */            ÿ
just(left )                               | type( input) intens(high) ca
just(left) pad('_') color(white)          ^ typeÿ (text) intens(high) ca
just(asis ) color(yellow)                   ` type(textÿ
) just(asis ) color(turq)                     ! type(output) intens(low
ff) just(asis ) color(white)                  # type(text) inteÿç
low ) caps(off) just(asis ) color(white)                 )Body
    ÿ
-----% TSO/E-Mail Print Option +---------------------------%Command ===>
                                                             %
                     ÿ
                                                               `      Th
e you have seÿ
.                                     ÿ
                                                                   `
nt the data set enter^Y`otheÿ
age associated with the data set.                      ÿ
                                                                       `
int the data set:===>_z+                   ÿ

  From:    !mailfid
  At:      !mailfloc                                      ÿ
    Subject: !mailsubj
    File:ÿ
Init
  .zvars = 'printopt'
  .cursor = printopt      ÿ
    &printopt = Y
     &ENÿ
     )Proc                                 ÿ
        &printopt = trunc(&printopt,1)
        ver (&printopt,ÿ
          &zcmd = &z                                        #
           )End
           
                                       /* % type(text  ) intens(high)
   Defaults displayed for */           /* + type(text  ) intens(low )
        information only  */            ÿ
n ) just(left )                               ^ type(text) intens(high)
) just(asis ) color(yellow)                   | type(output) intens(low
ff) just(asis ) color(white)                  ` type(textÿ
(off) just(asis ) color(turq)                     ! type(output) intens(
ps(off) just(asis ) color(white)                  # type(text) intens(lo
(off) just(asis ) color(white)                 )Body
   +
Eÿ
                                                     %
             ÿ
                ÿ
cessing was requested.                                   %
                              ÿ
                               ÿ
                                                             `!ptferr3
                                               ÿ
                                              ÿ
                                                                 `!ptfer
                                                                ÿ
                                                             ÿ
                                                                     `!p
                                                                     `!p
 ÿ


= &z              n
           ÿ

                       /* % type(text  ) intens(high)              Defau
layed for */           /* ÿ
ation only  */            ÿ
                              ^ type(text) intens(high) caps(off) just(a
lor(yellow)                   | type(outpÿ
) color(white)                  ` type(textÿ
) color(turq)                     ! type(output) intens(low ) caps(off)
s ) color(white)                  # type(text) intens(loÿ
s ) color(white)                 )Body                      ÿ
                                   +----------------------% TSO/E-Mail F
rse Status +-----------------------%Command ===>_zcmd                  ÿ
                                     %
                                       %
                                       `      File UnTerse Processing wa
ted.  ÿ
              ÿ

                     +
                   ÿ
                                                 `      Output Data Set:
gdsn
                                  ÿ
!mailtds
                                                     )Proc
                                                 ÿ
                                                         )End
                                                         

     /* % type(text  ) intens(high)              Defaults displayed for
     /* + type(text  ) intens(low )                   information only
     /ÿ

            | type(text) intens(low ) caps(off) just(asis ) color(white)
            ` type(outpÿ
              ÿ
                ~ type(text) intens(high) caps(off) just(asis ) color(wh
                   hilite(reverse)      ÿ
               )Body         ÿ
                 +----------------------% TSO/E-Mail RECEIVE Processing
-----------------%                                       ÿ
                   %                        ÿ
                     %
                     %           Your TSO Mail ISPF Table Data Set is cu
y migrated.            %                                   ÿ
                         %
                         %   Press~ENTER%to recall the data set now and
 processingÿ
ssing for now.               )Init
                               &KEND = PFK(END)
                            ø  )Proc
         ÿ
                                 
                                                           /* % type(tex
ens(high)              Dÿ
ntens(low )                   information only  */           /ÿ
 intens(high) caps(on ) just(left )               */              @ type
 intens(high) caps(on ) just(left ) pad+
t) intens(high) caps(off) just(asis )ÿ
pÿ
ext) intens(low ) caps(off) just(asis ) color(turq)
ext) intens(low ) caps(off) just(asis ) color(turq) ÿ
hilite(uscore)    ÿ

 -----------------% TSO/E-Mail Transmit Error +--------------------ÿ
and ===>_zcmd                      ÿ


 Eÿ
 %&maillmsg

                 ÿ
     `Verify the you have specified below a valid nickname or node.useri
     +
     `Send to  %===>_SENDID     ÿ
      ÿ
         +
         +                                     ÿ
           +           ÿ
             `Press%ENTER`to re-send Transmit Message or%END`to terminat
             +                                                ÿ
               +                        ÿ
                 +
                 )INIT
                     .CURSOR = SENDID                    ÿ
                     )PROC
                       VER (&SENDID,NB)
            ÿ
                         )END
                         
                           ÿ
gh)              Defaults displayed for */           /* + type(text  ) i
w )                   information only  */           /ÿ
high) caps(on ) just(left )               ÿ
s(high) caps(on ) just(left ) pad('_')                      ^ type(outpu
s(high) caps(off) just(left ) color(white)                  | type(textÿ
s(low ) caps(off) just(asis ) color(white)               +
ntens(high) caps(off) just(right) color(white)         ÿ
score)                                                            ~ type
ntens(highÿ
(uscore)                                                         )Bodyÿ
                                                                   +----
----------% TSO/E-Mail RECEÿ
                                                                     %
     ÿ
                                            ÿ

        Your~TSO MAIÿ
                                                             ÿ

                                   ÿ
                              Please be patient

                                                  ÿ

   %           ÿ
                                                                 ÿ

         Note: This only indicatÿ
 a               sequential file and your data sets received into unique
ÿ
           )Init                                 Q
             )Proc
             )Eÿ
               
                                         /* % type(text  ) intens(high)
     Defaults displayed for */ÿ
            information only  */            ÿ
(on ) just(left )                               ^ type(text) intens(high
ff) just(asis ) color(yellow)                ÿ
ps(off) just(asis ) color(white)                  ` type(textÿ
ps(off) just(asis ) color(turq)                     ! type(output) inten
caps(off) just(asis ) color(white)                  # type(tÿ
caps(off) just(asis ) color(white)                 )Body
                                                     +------------------
SO/E-Mail File Send Status+--------------------------%Command ===>_zcmd
                                                       %
                 ÿ
                                                           `       You r
 that a file be transmitted to a user via the              `       Inter
is requeÿ
ss the Internet.  All messages have been sent and the          `       r
 file has been sent to any TSO or VM addresses (if any).       `
                       ÿ
gret this inconvience caused by the design of Internet mail.       `
                                                                   `
                                      ÿ

&z                                                                     )
                                                     ÿ

                   /* % type(text  ) intens(high)              Defaults
d for */           /* + type(text  ) intens(low )                   ÿ
n only  */           /ÿ
          */              ! type(output) intens(high) caps(off) just(asi
r(white)                  | type(text) intens(high) caps(off) just(asis
turÿ
                           +-----------------------% TSO/E SAFE Mail Reg
n +------------------------%Option ===>_zcmd
                  ÿ

                               +              %A|- Add your userid for S
 Processing                    + ÿ
AFE Mail Processing                +
                                   +
                                   |    SAFE Maiÿ
mail messaÿ
out of the office for more             |    than a few days.  This will
these from being lost when             |    the Job Entry Subsyÿ
leaned.                    ÿ
                                           |   %A|- will add your userid
E Mail processing so that your mail        |        messages and mail fi
e received once per day until you return    ÿ
                                               |
                                               |   %D|- will remove your
from SAFE Mai+
return.    ÿ
                                                     )Init
                                                      &userid = trans(&z
,*)                       ÿ
                                                          VER (&ZCMD,NB,
)                                                         &opt = trans(&
ADD            Q                         ÿ
  D,DELETE)                                                  )End
                                                             


           %   TYPE(TEXT)  INTENS(HIGH)
           +   TYPE(TEXT)  INTENS(LOW)
          ÿ
             )BODY
             +&Z$SYS -----------------% TSO/E-Mail Transmit Error +-----
-------------+Command ===>_ÿ
      ÿ
                 +
                 %An Error occurred during Tÿ
           +       %&ÿ

                     +                                       ÿ
                       +Send to  %==ÿ
serid)                   +
                         +
                           +                       ÿ
                             +
                             +Press%ENTER+to re-send TSO Mail Message or
terminate.     ÿ
                                 +
                                 +
                                ÿ
 ÿ
                                     )PROC
                                       VER (&SEND2 ID,NB)
                ÿ
                                         )END
                                         
(%+_)                          +
ext  ) intens(high)          ÿ
(text  ) intens(low )                   information only  */           /
pe( input) intens(high) caps(on ) just(left )               */
pe( input) intens(high) caps(on ) just(left ÿ
type(text) intens(high) caps(off) just(asis ) color(turq)
type(textÿ
~ type(text) intens(low ) caps(off) skip(on)    color(turq)ÿ
  ! type(text) intens(high) caps(off) just(asis ) color(yellow)
BODY                      ÿ
 +------------------------% SORT the TSO/E-Mail Table +-----------------
---%Command ===>_zcmd
   +                                       ÿ
     `Select the sort fields by specifying the sort order (Ascending or
ng)  +   ÿ
       ~ ^Sel     Sort Field                                ÿ
         ~ @Z~     !From Node     ^Site where message originated
         ~ @Z~     !Fromÿ
           ~ @Z~     !To Node       ^Site where message was sent to
             ~ @Z~     !To Userid     ^User who message was sent to
             ~ @Z~     !Date/Time     ^ÿ
               ~ @Z~     !Last Action   ^The last action performed on th
e             ÿ
                 +                                    ÿ
                   `Press ENTER to continue or PF3 (End) to cancel the s
est.               +           ÿ
                     )INIT                                           ÿ
                         .ZVARS = '(FROMNODE FROMUSER TONODE TOUSER DATE
'                        .CURSOR = FROMNODE     ÿ
                           &fromnode = &z
    ÿ
                             &tonode   = &z                      ÿ
                               &touser   = &z
                   ÿ
                                 &action   = &z
  ÿ
                                  ÿ
                                    ver (&fromuser,list,A,D)
                   +
                 ÿ
                                          ver (ÿ
                                            ver (&action,list,A,D)
                                    Ø        )END
                                             {
 Default(%+_)
type(text  ) intens(high)              Defaults displayed for */
type(text  ) intens(low )                   information only  */
* _ type( input) intens(high) caps(on ) just(left )               */
  ^ type(output) intens(high) caps(off) just(asis ) color(turq)
  ` type(text)   intens(low ) caps(off) just(asis ) color(turq)
  ~ type(texÿ
            hilite(uscore)
      ! type(text) intens(high) caps(off) just(asis ) color(white)
   )BODY                   ÿ
       +-------------------% TSO/E-Mail Log Data Set Disposition +------
-------%Option ===>_zcmd
                                          ÿ

           `    Specify!D`to~delete`or!E`to~edit`your current TSO Mail L
set.                                                     ÿ
               `    This is the first time that you have used the TSO/E
l Dialog       `    and a pre-existing TSO Mail LOG data set has been de
 This data     `    set must either be deleted or all old and/or unwante
ageÿ
ason is that       `    this LOG data set is used to record all messages
re Transmitted     `    or Received and this dialog will use this same d
to copyÿ
en deleted once this   `    copy has been completed.
                       `
                      ÿ
l of the old and/or        `    unwanted messages the dialog make take a
o copy all of the          `    messages into the ISPF Table.
                           `         ÿ
                               `    The default (PF3) is to continue wit
mplete LOG data set.           +
                               )INIT                ÿ                  ÿ
                                   )PROC
                                     VER (&ZCMD,NB,LIST,D,E)
                                   )END                            ÿç
                   Æ                              
tr Default(%+_)
% type(text  ) intens(high)              Defaults displayed for */
+ ÿ
ÿ
    ^ type(text) intens(high) caps(off) just(asis ) color(yellow)
    | type(outputÿ
      ` type(textÿ
        ! type(output) intens(low ) caps(off) just(asis ) color(white)
        # type(text) intens(low ÿ
       )Body                      ÿ
         +----------------------% TSO/E-Mail File UnTerse Prompt +------
---------%Command ===>_zcmd                    ÿ
           %                                       ÿ
             %
             % The following data set has been requested to beÿ
               %                                                    ÿ
                 `      Original Data Set:  !mailfds

                   `      TSO Mail Data Set:  !mailtds
     ÿ

            ÿ
                      ÿ
                         )Init
                           ÿ
                           )Proc       ÿ
                              &zcmd = &z
                              VER (&TARGDSÿ
                               )End                      
                                 
                                                         ÿ
ntens(high)              Defaults displayed for */           /* + type(t
ntens(low )                   information only  */           /ÿ
 intens(high) caps(on ) just(left )               */              ! type
t) intens(high) caps(on ) just(left ) pad('_')                      ^ ty
t) intens(high) caps(off) just(left ) color(white)                  | ty

t) inte+
lite(ÿ
(text) intens(highÿ
  hilite(uscore)
                    ÿ
----------------------% TSO/E-Mail ÿ

                                   ÿ
                                                    ÿ
 %
 %              Your are currently using your`TSO/ÿ
   %                               ISPF Session.                     ÿ

     %              Use PF9 to swap to your other session and theÿ
       %                          TSO/E-Mail`Refresh%command.
      ÿ

ÿ
           )Init       2
             )Proc
             )Eÿ
               
                                         /* % type(text  ) intens(high)
     Defaults displayed for */ÿ
            information only  */           /ÿ
(on ) just(left )               */              ! type( input) intens(hi
(on ) just(left ) pad('_')                   ÿ
ps(off) just(left ) color(white)                  | type(textÿ
ps(off) just(asis ) color(white)                    ` type(output) inten
caps(off) just(right) color(white)                        hiÿ
                                                      ~ type(text) inten
) caps(off) just(asis ) color(white)                          hilite(usc
                                                     )Body
                                                       +----------------
--% TSO/E-Mail ÿ
                                                         %
          ÿ
                                ÿ
                                                             %
~TSO/E-MAIL%is now being +
                       ÿ

                                                                   %
                  Please be patient   ÿ


                                                     ÿ
     ÿ

                      Files Processed: `fcount%                     ÿ
it                    V
Proc
End

                           /* % type(text  ) intens(high)              D
displayed for */           /* + type(text  ) intens(low )
rmation only  */  ÿ
t )               */              ^ type(text) intens(high) caps(off) ju
) color(turq)                     ! type(output) intens(low ) caps(off)
s ) color(white)                 ÿ
                                      ~ TYPE(INPUT) CAPS(OFF) INTENS(HIG
(yellow) hilite(uscore)               ` TYPE(INPUT) CAPS(off) INTENS(HIG
(yellow) just(asis)                )Body        ÿ
                                       +-------------------------% TSO/E
ssage Info +---------------------------%Command ===>_zcmd
                                       %                       ÿ
 ÿ
                                           %     (optional if different
rent TSO address - internet only)          %
                  ÿ
age Epilog:                                    +
                                               +
             ÿ
                                              +<======>`EPILOG2
                                              +<======>`EPILOG3
                            ÿ
                                                  +<======>`EPILOG5
                                                  +<======>`EPILOG6
                                           +
                                         ÿ
                                                        +<======>`EPILOG
                                                        +<======>`EPILOG
      ÿ
                                                                 ^ The a
t will be inserted at the end of each TSO/E-Mail message that    ^ you s
                       ÿ
                                                                     )In
                                                                       .
MAILHS1                                 ÿ
      ÿ
T (replyto) profile
T (EPILOG1 EPILOG2 EPILOG3 EPILOG4 EPILOG5) PROFILE      +
PUT (EPILOG6 EPILOG7 ÿ
End
{
                                  % ÿ
                                    +   TYPE(TEXT) INTENS(LOW)
                              ÿ
(LEFT)                            ! type(text) inteÿ
s ) color(white)                    | type(text) intens(high) caps(off)
s ) color(turq)                  )BODY         ÿ
                                   +---------------------% TSO/E-Mÿ
e Processing +-----------------------%Command ===>_zcmd
                                     +                          ÿ
                                       +
 ÿ
                                         +
 ÿ
                ÿ
(Nickname or Distribution List)%*+           +
                  ÿ
 +(NJE Node Name)              ÿ
   +(Userid)                                     +
                                   ÿ
                                              ÿ
                                                     +      Sequential
+        Specify%Y+if the above data set is a PDS   ÿ
           member and you want it sent sequentially    +     +
                                                         + ÿ
                                                           +           ÿ
                                                             +
                                                             %*+See TSO
n NICKNAMES. Requires 'userid.NAMES.TEXT' file.                )INIT
        ÿ
NDNAME SENDNODE SENDUID SENDDSN SENDSEQ)'                          .CURS
DNAME    ÿ
DE = &Z) &SENDNODE = &SENÿ
= N                                                                  )PR
                        ÿ
NDDSN NE &Z)                              ÿ
ILE = 'DS(&SENDDSN)'
SENDSEQ = Y)                           ÿ
   &SQ = SEQ                                               +
F (&SENDSEQ = N)                                         ÿ
       &SQ = &Z                                       ÿ
   IF (&SENDDSN = &Z)
      &SQ = &Z
     IF (&SENDNAME  = &Z)                                            ÿ
         VER (&SENDUID,NONBLANK)
         VER (&SENDNODE,NB,NAME)
         VEÿ
    ÿ
             &ZSEL = 'CMD(%TMAILSND &SENDNODE..&SENDUID &FILE NOMSG &SQ)
           IF (&SENDNAME NE ÿ
               IF (ÿ
                      IF (&SENDNODE NE &Z)  &SENDERR = YES
                 IF (&SENDERR = YES)         ÿ
                    &SENDERR = &Z ÿ
                      &mailsmsg = 'Send to who? '
                      &maillmsg= 'Can''t specify both Nicknameÿ
SENDNODE..&SENDUID'      .MSG = MAIL000          ÿ
                         VER (&SENDNAME,NONBLANK)
                         VER (&SENDDSN,NB,DSNAME)

                             &ZSEL = 'CMD(%TMAILSND &SENDNAME &FILE NOMS
NDFILE)'                 )END
                          {

ens(high)              Defaults displayed for */           /* + type(tex
ens(low )                   information only  */           /ÿ
ntens(high) caps(on ) just(left )               */              @ type(
ntens(high) ÿ
 intens(high) caps(off) just(asis ) color(turq)                   ` type
   intens(low ) caps(off) just(asis ) color(turq)                   ~ ty
 intens(low ) caps(off) jusÿ
te(uscore)                                                            !
t) intens(highÿ
                                          ÿ
----------------% TSO/E-Mail Send Processing +-------------------------%
===>_zcmd                      ÿ
                                                         ÿ
 a Message or Data Set to a TSO or VM user
                                                ÿ
:       Nickname %===>_Z
         `(Nickname or Distribution List)%*+
                                                                 ÿ
 `or        Center   %===>_Z       `(NJE Node Name)
 `     ÿ
   +
  ÿ
     `             Seqÿ
a PDS  `                                     member and you want it sent
ially  `      Send ÿ
essage   +                           ÿ
           `Press ENTER for ISPF Edit to create your message.
           +                        ÿ
             +                                      ÿ
               %*`Notes:See TSO HELP on NICKNAMES. Requires 'userid.NAME
file.          )INIT                                 ÿ
                   .ZVARS = '(SENDNAME SENDNODE SENDUID SENDDSN SENÿ
G)'                  .CURSOR = SENDNAME
                     IF (&SENDNODE = &Z) &SENDNODE = &SENDCTR         ÿ
                       &SENDSEQ = trans(&SENDSEQ &Z,'N' *,*)
  ÿ
                         &FILE    = &Z
       +
     ÿ
               ÿ
                                    &SQ = SEQ
                        ÿ
                              ÿ
                                     IF (&SENDDSN NE &Z)
                                        Iÿ
                                             ÿ
                                            IF (&SENDMSG NE Y)
                                                &FILE = 'Dÿ
                                           IF (&SENDDSN = &Zÿ
                                                &SQ = &Z
                                             IF (&SENDNAME  = &Z)
                                                 VER (&SENDUID,NONBLANK)
                                                   VER (&SENDNODE,NB,NAM
                                                   &ZSEL = 'CMD(%TMAILSN
ODE..&SENDUIÿ
          ÿ
NDERR = YES                                                 IF (&SENDNOD
  &SENDERR = YES             ÿ
                         ÿ
                                                            &mailsmsg =
 who? '                                       ÿ
 specify both Nickname &SENDNAME and &SEÿ
                                                               VER (&SEN
NBLANK)                                                        ’ &ZSEL =
MAILSND &SENDNAME &FILE &SQ )'                         ÿ
                                                               {

             _ TYPE(INPUT) CAPS(OFF) INTENS(HIGH) FORMAT(&MIXED)      ÿ
               × AREA(DYNAMIC) EXTEND(ON) SCROLL(ON) USERMOD(20)
              ÿ
                 ~ TYPE(INPUT) CAPS(OFF) INTENS(HIGH) COLOR(TURQ)
     ÿ
                   ` TYPE(INPUTÿ
                     # type(output) intens(high) color(turq)
                    ÿ
                      02 TYPE(DATAOUT) INTENS(HIÿ
                        03 TYPE(DATAOUT) SKIP(ON) /* FOR TEXT ENTER CMD.
/                       04 TYPE(DAT+
     /*@OY36835*/         05 TYPEÿ
XED)     /*@OY36835*/         06 TYPE(DATAIN)  INTENS(LOW)  CAPS(IN)  FO
XED)                          07 TYPE(DATAIN)  INTENS(HIGH) CAPS(IN)  FO
XED)     /*@OY36835*/         08 TYPE(DATAIN)  Iÿ
    ÿ
                                  0A TYPE(DATAIN)  INTENS(LOW)  FORMAT(&
                                  0D TYPE(DATAIN)  INTENS(LOW) ÿ
AT(&MIXED) COLOR(BLUEÿ
AT(&MIXED)                           )BODY WIDTH(&ZWIDTH) EXPAND(//)
                                     %EDIT TSO Message #tmever%---------
--------------------------------------ÿ
 /                     +Scroll ===>_Z   %+To:~SENDID
                                         +From:~SENDFRM1
 +Log the mesÿ
     +Acknowledgement:`Z+ (Y or N)           ~SENDFRM3
     +Append Epilog:  `Z+ (Y or N)           +Subject:\SENDSUBJ
                            ÿ
-------/-/--------------------------------------××
       / /                                      ×× ---------------------
-------/-/---------------------------------ÿ
EL+to aboÿ
                                                       .ZVARS = 'ZSCED L
PI'                                                    IF ÿ
  /* VIEW MODE            ÿ
    /* DEFAULT TUTORIAL NAME     */                        ELSE
    /* EDIT MODE                 */                          .HELP = ISR
      /* DEFAULT TUTORIAL NAME     */      +
        /* SET FORMAT MIX            */  ÿ
)         /* IF EBCDIC MODE REQUESTED  */                          &MIXE
IC      ÿ
PROFILE     /* FILL SCROLL VARS IF       */               ÿ
= ' ')        /* BLANK WITH PAGE.          */                         &Z
PAGE'         /*       ÿ
                                                                       &
AN = &Z
PFK(END)                              ÿ
PFE = &Z)  &PFE = 'END'
= TRANS(&TMAÿ
K = TRANS(&TMAILACK Y,Y N,N &Z,Y *,*)                +
EPI = TRANS(&TMAILEPI Y,Y N,N &Z,Y *,*)            ÿ
 IF (&LOG = &Z)  &LOG = 'Y'    ÿ
   IF (&ACK = &Z)  &ACK = 'Y'
   IF (&EPI = &Z)  &EPI = 'Y'                                     ÿ
     IF (&SENDSUBJ = &Z)                        ÿ
          .CURSOR = SENDSUBJ
       IF (&SENDSUBJ NE &Z)
 ÿ
                 .CURSOR = zcmd

           VGET ÿ
  ÿ
             )REINIT
                               ÿ
                 REÿ
                   REFRESH(ZCMD,ZSCED,ZDATA)
                                              ÿ
                     VGET (SENDSUBJ)ÿ

                       IF (&ZVMODET = 'VIEW')   /* VIEW MODE ÿ
/                          .HELP = ISR10000       /* ÿ
 */                        ELSE                     /* EDIT MODE
 */                          .HELP = ISR20000       /* DEFAULT TUTORIAL
   */                                                                 ÿ
                             )PROC
                               &ZCURSOR = .CURSOR
           ÿ
       +
     ÿ
                          ÿ
                                         VER(&SENDFRM1,NB)
                      ÿ
                                         ÿ
                                             VER (&ACK,NB,LIST,Y,N)
                                       ÿ
                                               &TMAILLOGÿ  = &LOG
                                                 &TMAILACK = &ACK
                                                 &TMAILEÿ
                                                   VPUT (SENDFRM1,SENDFÿ

                                                             )END
     ÿ
      ÿ
******************************************************/          /* Use
 ZDSVOL to display theÿ
*********************ÿ
 AREA SCREEN WIDTH FROM PQUERY. (80,132,160)                         /*
 AREA SCREEN DEPTH FROM PQUERY. (24,32,ÿ
                                    ÿ
(ISREFR01) COMP(EDIT)       PROD(MVS):                        */
GE ACTIVITY                                             ÿ
N= REASON    RELEASE    DATE    ORIGIN : COMMENT   ÿ
$L1= SPELLCHK  M310      890307   040100 :                        */
$BE= USERREQ   OS390R3   961010   040100 :  add zdsvol            */
*                                                                 ÿ
 /* OY36835 - 901105 - SYSROUTE OF OY34744                             *
 /*                    UNABLE TO INVOKE THE EDIT SERVICE WITH PANEL    *
 /*       ÿ
 ÿ
     /*                    CHARS TO SUPPORT DBCS.
     /*                    ÿ
       /*       ÿ
/        /* OW19632 - 960409 - Column number fields expanded to 5 charac
/        /*                    GT4045 - MOS Ï
 */        /*                  ÿ
   */         /* 5645-001, 5655-042 (C) COPYRIGHT IBM CORP 1980, 1996 */
             {
                                         /* + ÿ
            information only  */           /* _ type( input) intens(high
n ) just(left )               */            ÿ
(on ) just(left ) pad('_')                      ! type(outputÿ
ps(off) just(asis ) color(white)                  ` type(output) intens(
ps(off) just(asis ) color(turq)                         hilitÿ
                                                    ~ type(text) intens(
caps(off) just(asis ) color(turq)                           hilite(uscor
                                                      % type(text) inten
)                                                       ^ type(text) int
) caps(off)+
high) colÿ
                 ÿ
tmver+-%TSO/E-Mail Processing+-----------------------------%Command ===>
                        ÿ
                                  ÿ
 %Find/LOG/REFresh/SENDmail/SORT/DEFaults      SHORT/LONG/XLONG+Line Opt
Read%A+Answer%C+Change%D+Delete%E+Edit%ÿ
                                                   ÿ
er      Node     ToUser   Node     Date       Time      Last Action+
                                                      ÿ
                                                                    ÿ
           !z       !z       !z       !z         !z        !z
                                                                     ÿ

 = TMÿ
ARS = '(ZSEL MAILFID MAILFLOC MAILTID MAILTLOC MAILDATD +
LTIMÿ
mamt = CSR            ÿ
 &zsel = &z
Proc               ÿ
  &zselx = &z                          ÿ
    IF (&ZCMD = &Z)
        IF (&ZSEL NE &Z)          ÿ
            if (&Zsel = '=')                            ÿ
                  &Zsel = &osel
              &osel = &zsel                      ÿ
                &ZSEL = TRANS(&ZSEL RE,S.0
                                      REA,S.0                          ÿ
                                        READ,S.0                ÿ
                                          BR,S.1
                                          BRO,S.1
        ÿ

                                              EDI,S.2
                         ÿ
              ÿ
                                                  PRT,S.3
                                          ÿ
                             +
                           ÿ
                                                        REN,Sÿ
                                                          RENA,S.4
                                          ÿ
                                                            CO,S.5
                                                              COP,S.5
                                                         ÿ
                                                                COPY,S.5
               ÿ
                                                                  DEL,S.
                                                                    PTF,
                                ÿ
                                                                      UN
       ÿ
8                                                ÿ
,S.8
E,S.8                 ÿ
,S.9                                                              ÿ
*)                                                        &ZT = TRUNC(&Z
                                     ÿ
                                                                &LOGSEL
   ÿ
                                                    ÿ
C(&ZSEL,'.') A,A L,L E,E M,M MF,MF DF,DF                              R,
D F,F P,P S,S DM,DM ÿ
                                                                   ÿ
= 'Error'                                                             &m
,C,D,DM,E,F,L,M,MF,P,S,U,DF,DN'      +
g = 'Enter a valid value: &ml Was &ÿ
NEÿ
= TRUNC(&ZSEL,'.')
T = .TRAIL                                          ÿ
(&ZSEL,LIST,R,A,Bÿ
 (&SUBOPT NE &Z)
 VER (&ZSEL,LIST,S,MSG=MAIL001)                                      u
   VER (&SUBOPT,RANGE,0,9,MSG=MAÿ


                       /* % type(text  ) intens+
splayed for */           /* + type(text  ) inÿ
rmation only  */           /ÿ
)               */              @ type( input) intens(high) caps(on ) ju
) pad('_')                      ! type(output) intens(high) ÿ
s ) color(white)                  ` type(outpÿ
sis ) color(turq)                         hilite(uscore)
                                    ~ type(text) intens(low ) caps(off)
sis ) color(turq)                           hilite(uscore)    ÿ
                                        ^ type(text) intens(high) caps(o
(asis ) color(turq)                     # type(output) intens(high) colo
          ÿ

il Processing+\-\                        %Command ===>_zcmd
 \                    %Scÿ
                ÿ
/SENDmail/SORT/DEFaults      SHORT/LONG/XLONG+Line Options:%S+Read%A+Ans
ange%D+Delete%E+Edit%F+Forward%L+Log%P+Pÿ
                                 ÿ
 Time     Subject                                +
                                                 )Modelÿ
                                                  ÿ
    !z       !z       \ \                            )Init
                                                       .HELP = TMAILHLÿ
                                                         .ZVARS = 'ÿ
ID MAILDATD MAILTIME MAILSUBJ)'                            &mamt = CSR
                                                           &zsel = &z
     ÿ
    ÿ
                                                              IF (&ZCMD
                    ÿ
 &Z)                 ÿ
l = '=')
l = &osel                          ÿ
= &zsel                               ÿ
L = TRANS(&ZSEL RE,S.0
                REA,S.0                           ÿ
                  READ,S.0                             +
                    BR,S.1                           ÿ
                      BRO,S.1                                    +
                        BROW,S.1                               ÿ
                          ED,S.2
                            EDI,S.2
                            EDIT,S.2
                              PR,S.3
         ÿ
                                PRNT,S.3
             ÿ
                          ÿ
                                    REN,S.4
                            ÿ
                                      RENM,ÿ
                                        CO,S.5
                                        COPÿ
                                          CPY,S.5           ÿ
                                            COPY,S.5
                                            PDS,S.6       ÿ
                                              DEL,S.7
                                                PTF,S.8
                                                UNT,S.8
                                                  UNTE,S.8
              ÿ
                                                    UNTERS,S.8
        ÿ
                               ÿ
                                                        *,*)
                       ÿ
                                       IF (&ZT =ÿ
                                            &LOGSEL = .TRAIL
                                      ÿ
                                          &ZT = TRANS(TRUNC(&ZSELÿ
 E,E M,M MF,MF DF,DF                              R,R B,B D,D F,F P,P S,
DN,DN C,C U,U *,X)                           IF (&ZT ÿ
                                                &mailsmsg = 'Error'
  ÿ
,S,U,DF,DN'                                       &maillmsg = 'Enterÿ
alue: &ml Was &zsel'                            IF (&ZSEL NE &Z)
                   +
                 ÿ
   +
Eÿ
                                    ÿ
,MSG=MAIL001)                                                  VER (&SUB
E,0,9,MSG=MAIL00ÿ
                                                     ¦   {

     /* % type(text  ) intens(hÿ
       /* + type(text  ) intens(low )                   information only
       /ÿ
            @ type( input) intens(high) caps(oÿ
              ^ type(output) intens(high) caps(off) just(asis ) color(tu
              $ type(textÿ
                ! type(output) intens(high) caps(off) just(asÿ
                  ` type(output) intens(low ) caps(off) just(asis ) colo
                        hilite(uscore)    ÿ
                    ~ type(text) intens(high) caps(off) just(asis ) colo
)                     # type(output) intens(high) color(turq)
                   )Body                                   ÿ
                     $Primary Mail Table+#tmver+-%TSO/E-Mail Processing+
-----------ÿ
     %Scroll ===>_mamt+%
                         +Command Options: %Find/LOG/REFresh/SENDmail/SO
lts      SHORT/LONG/XLONG+ÿ
it%F+Forward%L+Log%P+Print%+
             ÿ
e       Time      Last Action+           ÿ
                               )Model
                              ÿ
!z         !z         !z         +     ^z               ÿ
                                   +Target Dataset:    `z
                                   )Init       ÿ
                                       .HELP = TMAILHLP                ÿ
                                         .ZVARS = '(ZSEL MAILFID MAILFLO
D MAILTLOC MAILDATD +                    MAILTIME MAILACTN MAILSÿ
                                           &mamt = CSR
      ÿ
                                           )Proc
 ÿ
                     +
                   ÿ
                    ÿ
                                                              &Zsel = &o
                                  ÿ
                                     +
L RE,S.0                           ÿ
    REA,S.0                                      ÿ
      READ,S.0
      BR,S.1                                        ÿ
        BRO,S.1                                                 ÿ
          BROW,S.1
          ED,S.2                                                     ÿ
            EDI,S.2

              PR,S.3
      ÿ
              ÿ
                  PRIN,S.3
                  RN,S.ÿ
                    REN,S.4  ÿ
                      RENA,S.4
                      RENM,S.4          ÿ
                        CO,S.5              ÿ
                          COP,S.5
                          CPY,S.5                        ÿ
                            COPY,S.5                       ÿ
                              PDS,S.6
                              DEL,S.7
                                PTF,S.8
                                  UNT,S.8
                                  UNTE,S.8
           ÿ
         ÿ
                                      UNTERSE,S.8
                            ÿ
                        ÿ
                      &ZT = TRUNC(&Zsel,1)
                       IF (&ZT = 'L')        ÿ
                            &LOGSEL = .+
                              &ZSEL =ÿ
                            &ZT = TRANS(TRUNC(&ZSEL,'.') A,A L,Lÿ
 DF,DF                              R,R B,B D,D F,F P,P S,S DM,DM DN,DN
*,X)                           IF (&ZT = X)         ÿ
                                  &mailsmsg = 'Error'
 +

s &zsel'                            IF (&ZSEL NE &Z)
                                      &ZSEL = TRUNC(&ZSEL,'.')
                ÿ
  ÿ
DN,C,M,MF,L,U,MSG=MAIL000)                IF (&SUBOPT NE &Z)
                                 4             VER (&ZSEL,LIST,S,MSG=MAI
                 ÿ
001)                                   )End
                                       {
                                ÿ
input) intens(high) caps(on ) just(left ) pad('_')
ext) intens(low ) caps(off) just(asis ) color(white)                  ÿ
hilite(uscore)                                 ÿ
pe(output) intens(low ) caps(on) just(asis ) color(yellow)
pe(text) intens(high) caps(on) just(asis ) color(yellow)
pe(textÿ
~ type(text) intens(low ) caps(off) just(asis ) color(white)
      hilite(uscore)
dy                      ÿ
 +-------------------% TSO/E-Mail File Delete Confirmation +------------
-%Command ===>_zcmd
 %                                       ÿ
   %        ÿ
     %     Current Data Set Name:  !mailtds
     %                                                    ÿ
       %     Delete the aboÿ
essage   %                                         +No   - delete messag
         %                                         +File - delete only t
a set      %                              ÿ
             #    !mailsubj
             #           Userid:!mailfid
            ÿ
                 %                                     ÿ
                   %     Press 'END' or 'PF3' now to prevent the delete
 retain the        %     file. ÿ
                     %                                                ÿ
                       %     Or use the#DM%option to delete the message
in the data set.       %     Or use the#DF%optioÿ
etain the message.       %
     ÿ
                             &zcmd = &z                          ÿ
                               &dmopt = Yes
                    ÿ
                                 &zcmd = &z
  ÿ
                                 )Pÿ
                                    &dmopt = trans(trunc(&dmopt,1) Y,YES
FILE *,'?')        +
                 Ý                     )End       ÿ
                                         {

input) intens(high) caps(off) just(left ) color(white)           ÿ
(text) intens(low ) caps(off) just(asis ) color(white)
  hilite(uscore)
pe(output) intens(low ) caps(off) just(asis ) color(yellow)
ÿ
type(textÿ
~ type(text) intens(low ) caps(off) just(asis ) color(white)
      hilite(usÿ
Body                      ÿ
 +------------------------% TSO/E-Mail Change Display +-----------------
-%Command ===>_zcmd           ÿ
   %                                       ÿ
     %
     `  Mail from:!fid                       ÿ
                `on:!maildatd !mailtime                     ÿ
         %
         `  Mail subject:                                   ÿ
           %
             #==>@mailsubj
             %

                          ÿ
                             `   Change the subject and status if you wi
 press 'ENÿ
                               %           ÿ
                                 %
                         ÿ
                                   )Init                    ÿ
                                       &zcmd = &z
                                       .ÿ
                                        if (&mailfloc NE &z)
                                            &fid  = '&mailfid at &mailfl
                                          if (&mailflocÿ
                                               &fid  = &mailfid
              “                              )Proc
                                             )End                     ÿ
                                               

pe( input) intens(high) caps(on ) just(left ) pad('_')
pe(teÿ
      hilite(uscore)
! type(output) intens(low ) caps(on) just(left ) color(yellow)
| type(output) intenÿ
  # type(textÿ
    ` type(text) intens(high) caps(off) just(asis ) color(turq)
    ~ type(text) intens(low ) caps(ÿ
            hilite(uscore)    ÿ
     )Body
     +---------------------------% TSO/E-Mail Fileÿ
-------%Command ===>_zcmd                      ÿ
         |maillmsg
         %                                                       ÿ
           %     Current Data Set Name:  !mailtds               ÿ
             %
             %     Target Data Set Name ===>_newname
ÿ
 ÿ
default is^Yes+) %
               +
^No+         ÿ
                       % Note:  If^NEW%is specified then the data set wi
eated using the same   %        allocation attributes as the input data
                       %    ÿ
                           #    !mailsubj
                           #           Userid:!mailfid
                           #           Nodeÿ
                               %
                               %     Press^Enter%to copy or^END%to termi
y process.                     %                          ÿ
                                   )Init
                                    .HELP = TMAILHC
                                    IF (&newname = &z)
        ÿ
                                        IF (&newname NE &z)
                                         .CURSOR = newdisp
        ÿ
*)                     ÿ
*,*)                                           &newstat = trans(&newstat
*,*)                   ÿ
                                        ÿ
                                                  &newdisp = trans(trunc
p,1)                                  ÿ
                                                         ÿ
                                                                       S
                                                     ÿ

                                                          VER (&NEWDISP,
NEW,SHR,OLD,MOD)                                          &NEWREP = ÿ
C(&NEWREP,1) Y,YES N,NO &Z,YES)                             &NEWSTAT = T
NC(&NEWSTATÿ
ST,YES,NO)                                                    VER (&NEWS
ISTÿ
DISP NEWSTAT) PROFILE       ã                                    )End
                                                                 {
ç
               /* % type(text  ) intens(high)              Defaults disp
r */           /* + type(text  ) intens(low )                   informat
  */           /ÿ
      */              ^ type(teÿ
rq)                     ! type(output) intens(low ) caps(off) just(asis
white)                  | type(textÿ
                          ~ TYPE(INPUT) CAPS(Oÿ
ilite(uscore)               ` TYPE(INPUT) CAPS(ON)  INTENS(HIGH) COLOR(y
ilite(uscore)            )Body                      ÿ
                           +---------------------------% TSO/ÿ
-----------------------------%Command ===>_zcmd
                             %                                       ÿ
                               ^     Verify your TSO Mail Processing Def
                                 +
                                 ^     Your Name:          ~SENDFRM1
      ÿ
           ÿ
                       +             +
                       ÿ
                          ÿ
                                         ^     Should the Message be log
      `Z  + (Yes or No)                 ÿ
ledged: `Z  + (Yes or No)                ÿ
                                             ^     Retain 3 Mail Logs fo
ing:      `Z  + (Yes or No)                  +           ÿ
                                               ^     Priÿ
Messages:                                              (if blank you wil
mpted each time):                                ^     Printer Name:
PRT +                                              ^     Optional:  Chaÿ
   ^   FCB:   `Z   ^  Form: `Z   +                   ^                Cl
       Title: `Z  +   (Yes or No)                    +
           ÿ
      ÿ
AILACK TMDEL PRTCHAR PRTFCB PRTFORM PRTCLASS PRTHEAD'      &TMAILLOG = T
NC(&TMAILLOG,1) Y,Yes N,No &ÿ
RUNC(&TMAILACK,1) Y,Yÿ
(TRUNC(&TMDEL,1) Y,Yes N,No &Z,No *,*)                         &PRTHEAD
(TRUNC(&PRTHEAD,1) Y,Yes N,No &Z,Yes *,*)    +
NS(&PRTCLASS &Z,A *,*)              ÿ
ILHD1                                                              )Proc
                                                                       V
DFRM1,NB)                                          +
&SENDFRM2,NB)                                    ÿ
 (&SENDFRM3,NB)
 (&SENDCTR,NB,NAME)

 &TMAILACK = TRANS(TRUNC(&TMAILACK,1) Y,Y y,Y n,N N,N &Z,Y *,*)
 &TMDEL    = TRANS(TRUNC(&TMDEL,1) Y,Y N,N &Z,N *,*)
 &PRTHEAD  = TRAÿ

     VER (&TMAILACK,NB,LIST,Y,N,y,n)
     VER (&TMDEL,NB,LIST,Y,N)    ÿ
       VER (&Tÿ
         IF (&TSOMPRT NE &Z)
            VER (&PRTHEAD,LIST,Y,N)               ÿ
              &TSOMPRTO = &Z ÿ
                IF (&PRTFORM NE &Z)
                  &TSOMPRTO = ' FORM(&PRTFORM)'                    ÿ
                  IF (&PRTFCB NE &Z)        ÿ
                      &TSOMPRTO = '&TSOMPRTO FCB(&PRTFCB)'
                    IF (&PRTCHAR NE &Z)
    ÿ
                        IF (&PRTCLASS NE &Z)
                          &TSOMPRTO = '&TSOMPRTO CLASS(&PRTCLASS)'
                     ÿ
                              &TSOMPRTO = '&TSOMPRTO NOTITLE'
                         VPUT (SENDFRM1 SENDFRM2 SENDFRM3 TMAILLOG TMAIL
FILE                     VPUT (TSOMPRTÿ
PROFILE  ÿ
                             VPUT (SENDCTR) SHARED
                         )End                          Ì
                        ÿ
                                                         /* % type(text
s(high)              Defaults displayed for */           /* + type(text
s(low )                   information oÿ
ntens(high) caps(on ) just(left )               */              @ type(
ntens(high) caps(on ) just(left ) pad('_')                      ^ type(o
ntens(high) caps(off) just(asis ) color(turq)         ÿ
   intens(low ) caps(off) just(asis ) color(turq)                   ~ ty
 intens(low ) caps(off) just(asis ) color(turq)
(uscore)                                                            !+
t) intens(highÿ
                                                                       +
-----------------% TSO/E-Mail File Forward +---------------------------%
===>_zcmd                      ÿ
  ÿ
ard file to user specified below:
                                                ÿ
                 ÿ
To:       Nickname %===>_FFNICK  `(Nickname or Distribution List)%*+
                                                                 ÿ
 `or        Center   %===>_FFNODÿ
   `          Userid   %===>_FFUSER  `(Userid)
   +
  ÿ
       `Acknowledgement    %===>_Z  `    `(Yes or No)
       +
       +           ÿ
           +File to be forwarded:^mailtds
           +       received from:^fid
           +                  on:^maÿ
               +
               +Press 'ENTER' to send the file or 'PF3' to cancel
               )INIT                                 ÿ
            ÿ
                     &TMAILLOG = TRANS(&TMAILLOG Y,Yes N,No &Z,Yes )
                     &TMAILACK = TRANS(&TMAILACK Y,Yes N,No &Z,Yes )  ÿ
                      if (&ÿ
                          &fid  = '&mailfid at &mailfloc'
                        if (&mailfloc = &z)
       +
       ÿ
                                &TMAILLOG = TRUNC(&TMAILLOG,1)
                                &TMAILACK = TRUNC(&TMAILAÿ
                        ÿ
                                     VER (&TMAILACK,NB,LIST,Y,N,YES,NO)
                                    &FFLLOG = &Z
                                      &FFÿ
                                        IF (&TMAILLOG = Y)
                                           &FFLLOG = MLOG
       +
     ÿ
                                           )END
                                           {
                    ÿ
pe( input) intens(high) caps(on ) just(left ) pad('_')
pe(output) intens(high) caps(off) just(asis ) color(turq)
type(output) intens(low ) caps(off)ÿ
# type(text) intens(low ) caps(off) just(asis ) color(white)
` type(text) intens(high) caps(off) just(asis ) color(turq)
~ type(textÿ
          hilite(uscore)
 )Body
 +------------------------% ÿ
-----%Selection ===>_zcmd
     %
     %                                       ÿ
ÿ
                   %1  Browse  `- Browse the data set
                   %2  Edit    `- Edit the data set           ÿ
               ÿ
                       %4  Rename  `- Rename the data set
                       %5  Copy    `- Copy the data set

                           %7  Delete  `- Delete the data set
                           %8  Unterse `- Unterse a file from IBMLINK
                ÿ
                     %
                     %     Data Set Name:!mailtds
                     %           ÿ
                         #    !mailsubj
                         #           Userid:!mailfid
                         #           Node:  !mailfÿ
                             #           Date:  !maildatd    #Time: !mai
                             )Init
                               .HELP = TMAILH2C                    ÿ
          ÿ
                                 )Proc
                                        &ZCMD = TRANS(&ZCMD RE,0
    ÿ
                       ÿ
                                                                  B,1
                       +
                     ÿ


                                      ÿ

2
,2                                                     ÿ
P,3
PR,3
PRT,3
  Pÿ
    PRIN,3
    RN,4
    REN,4ÿ
        RENA,4
        RENM,4
        C,5               ÿ
            CO,5
            COP,5
            CPY,5                          ÿ
                COPY,5
                PDS,6
                DEL,7                                       ÿ
                    PTF,8
                    UNT,8
                    UNTE,8

                        UNTERS,8
                        UNTERSE,8
             ÿ
                            *,*)
             &mailsmsg = 'Error'
             &maillmsg = 'Opÿ
      VER (&ZCMD,RANGE,0,9,MSG=MAIL000)
     )End
     {
                                      @ tÿ
st(left ) pad('_')                      ^ type(text) intens(low ) caps(o
(asis ) color(white)                  ÿ
                                          ! type(output)ÿ
 just(asis ) color(yellow)                  ` type(text) intens(high) ca
just(asis ) color(turq)                     ~ type(textÿ
) just(asis ) color(white)                          hilite(uscore)     ÿ
                                             )Body
                                             +--------------------------
E-Mail File Rename +---------------------------%Command ===>_zcmd
      ÿ
                                                 %
         ÿ
 !mailtds            ÿ
                                                     %     New Data Set
==>_newname               ÿ
                                    ÿ
                                                         %
                                           ÿ
ata Set Name or^END%to terminate rename process.   ÿ
                                                             )Init
                                                            ÿ
me                                                               &ÿ
                                                                 )Proc
                                                                  VER (&
e,nb,dsname)                                                       )End
 ÿ

               /* % type(text  ) intens(high)              Defaults disp
r */           /ÿ
ly  */           /ÿ
      */              ^ type(text) intens(high) caps(off) just(asis ) co
)                     ! type(ouÿ
white)                  | type(textÿ
                          ~ TYPE(INPUT) CAPS(OFF) INTENS(HIGH) COLOR(yel
ite(uscore)               ` TYPE(INPUT) CAPS(Oÿ
ilite(uscore)               # area(SCRL) Extend(ON) ÿ
                           )Body
                           +----------------------% TSO/E Mai+
tion +-----------------------%Command ===>_zcmd            ÿ
                                 %
                                 ^     Verify your IBM Fax Information:
                                 +
        ÿ
------------------------------------#)Area Help
                                     ^     Fax Phone:      ==> ~FAXPHONE
         ÿ
                                         ^     Subject:        ==> ~FAXS
                                    +    +
                        ÿ
                                       +     ^                     ==> ~
                                       +     ^                     ==> ~
                                       ÿ
4                                          +     ^                     =
5                                          +     ^                     =
6                                          +     ^    ÿ
FAXT7                                          +     ^
FAXT8                                          +     +
                                                     ^     Your Name:ÿ
 ~FAXF1      ÿ
=> ~FAXF2                                          +     ^
=> ~FAXF3                                          +     ^
=> ~ÿ
   ==> ~FAXF5                                          +     ^
   ==> ~FAXF6                                          +     ^
   ==> ~FAXF7      ÿ
       ==> ~FAXF8                            ÿ
                                                                   +  Yo
ter all of this information in theÿ
                                                              ÿ
                                                                       )
                                                 ÿ
 = TMAILHF1

&FAXPHONE = 'XXX XXX-XXXX'                                      ÿ
oc
 VPUT (FAXF1 FAXì F2 FAXF3 FAXF4 FAXF5 FAXF6 FAXF7 FAXF8) PROFILE
End
ç
                                            @ type( input) intens(high)
) just(left ) pad('_')                      ^ type( input) intens(high)
) just(asis ) ÿ
(off) just(asis ) color(white)                  # type(text) intens(low
ff) just(asis ) color(white)                    ` type(text) intens(high
ff) just(asis ) color(turq)  ÿ
ps(off) just(asis ) color(turq)                           hilite(uscore)
                                                 )Body
                                            ÿ
TSO/E-Mail Log Processing +--------------------------%Command ===>_zcmd

                                                     %     ÿ
               ÿ
ion%===>^logdesc                                        +%
                                                         % Log Data Set
          !logds                ÿ
                                                             %
                                                             %
         ÿ
description will appear in the display of your TSO/E Mail        `
 and helps to easily identify the different logs you may         `
 created.               ÿ
                                                                     `
The log data set name may not be changed.                            )In
                                       ÿ
= lÿ
= TMAILH3
= &z                                                  ÿ
                    V
r (&logdesc,nb)
d                                                                    ÿ

                         /* % type(text  ) intens(high)              Def
splayed for */           /* + type(text  ) intens(low )
atioÿ
)               */              ^ type(text) intens(high) caps(off) just
color(yellow)                   ! type(output) intens(low ) caps(off) ju
) color(white)     +
                 ÿ
sis ) color(turq)                  )Body
                                   +-------------------------%ÿ
Tutorial  +---------------------ÿ
                                       %


extension to the TSO/E-Mail ISPF dialog.        This facility allows rec
ssages to be 'logged' or 'archived'             into an alternate ISPF t
 data set.  Thisÿ
nder, or any other grouping desired.

                                 ÿ
ptions will be displayed in sequence or may             be selected by n

                                                  ÿ
`Commands thÿ
  `Selection options for individual messages/files
                                                       )Init       ÿ
                           ÿ
                                                             &zsel = tra
 1,tmlogh1 2,tmlogh2 *,?)                                  )End
                                          ÿ

         /* % type(text  ) intens(high)              Defaults displayed
         /* + type(text  ) intens(low )                  ÿ
           /ÿ
*/              ^ type(text) intens(high) caps(off) just(asis ) color(ye
                ! type(output) intens(low ) caps(off) just(asis ) color(
                  | type(textÿ
                    ` type(text) intens(low ) caps(off) just(asis ) colo
                 )Body
       ÿ
---------------------%Command ===>_zcmd
                     %
                     `ÿ
F Command line when      `      in the TSO/E-Mail LOG Table display.

                         |      Actio+
ÿ
                               |     ^NEW                   `Create a ne
Mail LOG table and data set.   |     ^RENumber              `Renumber th
tries in the tablÿ
                                   |      Log selection options:

                                  ÿ
lected LOG                             |     ^C                     `Cha
rmation about the selected LOG         |     ^D                     `Del
selected LOG                           |     ^I    ÿ
ÿ
                                           )Init
                                           )Proc                    n
               ÿ
                                               
efault(%+_)
pe(text  ) intens(high)       ÿ
type(text  ) intens(low )                   information only  */
_ type( input) intens(high) caps(on ) just(left )               */
^ type(text) intens(high) caps(off) just(asisÿ
  ! type(output) intens(low ) caps(off) just(asis ) color(white)
  | type(textÿ
    ` type(text) intens(low ) caps(off) just(asis ) color(tuÿ
   )Body
   +-------------------------%ÿ
-----%Command ===>_zcmd
       %
       `      The following commands may be entÿ
hen      `      in the TSO/E-Mail LOG Table display.  Information on the
e        `ÿ
                                                                ÿ
             |      Action Command Options:
                         ÿ
               |      1 -^Find              `Find any character string a
iÿ
                 |      3 -^Sort        ÿ
 field name
                  ÿ
                                                       +
                       |         ^Long              `ÿ
splay for each message   |         ^Sÿ
lay for each message       |         ^XLong             `Use a extra lon
 display for each message                                           ÿ
                             )Init                    ÿ
                               )Proc
                                 &zsel = trans(&zcmd 1,tmailh1a  2,tmail
maiÿ
                                   
                                                             /* % type(t
ntens(high)       ÿ
 intens(low )                   information only  */           /ÿ
t) intens(high) caps(on ) just(left )               */              ^ ty
 intens(high) caps(off) just(asisÿ
put) intens(low ) caps(off) just(asis ) color(white)                  |
tÿ
ext) intens(low ) caps(off) just(asis ) color(tuÿ
                                                                       +
-----------------%ÿ
d ===>_zcmd                                                    ÿ

                                   ÿ
    The following mail log selection commands may be entered on the
      selection bar to the left of each message in the TSO/E-Mail LOG Ta
      display.  Information on them will be presenteÿ
 `      selected by number.
             ÿ
   |      1 -^Answer the mail                                        ÿ
     |      2 -^Delete the note
     |      3 -^Forward the ÿ
       |      4 -^Print the note
      ÿ
         |      6 -^Merge the associated daÿ
           |      7 -^Select the note or process the received File
                     `Fÿ
int, Rename)                                              ÿ
               )Init
               )Proc                    ÿ
                   &zsel = trans(&zcmd 1,tmailh2a  2,*tmailh2a  3,tmailh
                                         4,*tmailh2b 5,*tmailh2b  6,tmaÿ
,tmailh2d                                  *,?)            h
                       )End
                       
      ÿ
)              Defaults displayed for */           /* + type(text  ) int
)                   information only  */           /ÿ
gh) caps(on ) just(leÿ
gh) caps(off) just(asis ) color(yellow)                   ! type(output)
low ) caps(off) just(asis ) color(white)                  | type(textÿ
s(high) color(white)                ÿ
s(low ) caps(off) just(asis ) color(turq)                  )Body
                                                           +------------
------ÿ
d                                                              `
                                                               `
                       ÿ
rward`option is used to resend the message and any                 `
anying file to another user or users.  This option interfaces      `
 SENDMAIL command and will copy in full ÿ
 ÿ
d or change the original message before sending it.                    `
                                                         ÿ
The^Print`optionÿ
  ISPF dialogs for printing on various types of printers.  See the
  tutorial for each of those dialogs for more specific information
    on the requirements for priÿ
      This option will only print the message and not the accompanying
      data set.
           ÿ
   `      The^C`option will allow you to change the Subject of a message
   `      it's status to clarify it for later retrieval.
   )End                                                      ÿ
       
                                    @ type( input) intens(high) caps(on
eft ) pad('_')                      ^ type(output) intens(high) caps(off
(asis ) color(yellow)               ÿ
st(asis ) color(white)                  # type(text) intens(low ) caps(o
(asis ) color(white)                    ` type(text) intens(high) caps(o
(asis ) col+
just(asisÿ
                                           )Body
                                           +------------------------% ÿ
il Log Information +----ÿ

                                               %
       ÿ
=>^logdesc                                        +%
                                                   % Log Data Set Name
=>^logds                ÿ
                                                       %
                                                       %
                                         ÿ
ption appears in the display of your TSO/E-Mail            `          Lo
elps to easily identify the different logs you may         `          ha
ed.                                                       ÿ
    ÿ
                                                                &zcmd =
                                                               )Proc
                   ÿ
                                                                   
ç
             /* + type(text  ) intÿ
  */           /* _ type( input) intens(high) caps(on ) just(left )
  */            ÿ
                    ! type(output) intens(high) cÿ
ite)                  ` type(output) intens(low ) caps(off) just(asis )
rq)                         hilitÿ
                        ~ type(text) intens(low ) caps(off) justÿ
turq)                           hilite(uscore)
                          % type(text) intens(highÿ
                            ^ type(output) intens(high) caps(off) just(a

                           )Body                                   ÿ
                             ^maillog                    % TSO/E-Mail Pr
 +------------ÿ
             %Scroll ===>_mamt+%
    ÿ
             SHORT/LONG/XLONG+
+Delete%E+Edit%F+Forward%P+ÿ
                       ÿ
de      Date     Time       Last Action+
                                       )Moÿ
                                        ÿ
 !z        !z       !z         !z                `z
                                           )Init         ÿ
                                               .HELP = TMÿ
                                                 .ZVARS = '(ZSEL MAILFID
C MAILTID MAILTLOC MAILDATD +                    MAILTIME MAILACTN MAILS
                                                   &mamt = CSR
                                                     &zsel = &z
                                                   )Proc
       ÿ
           ÿ
                                                            IF (&ZSEL ^=
                      ÿ
                            ÿ
sel                                                               &osel
                                     ÿ
S(&ZSEL RE,S.0                               +
          REA,S.0                          ÿ
            READ,S.0                                ÿ
              BR,S.1
              BRO,S.1                                       ÿ
                BROW,S.1                                           ÿ
                  ED,S.2
                  EDI,S.2
                    EDIT,S.2
  ÿ
                      PRT,S.3
              ÿ
                 ÿ
                          RN,S.4
                          REN,Sÿ
                            RENAÿ
                              RENM,S.4
                              CO,S.5            ÿ
                                COP,S.5        +
                                  CPY,S.5    ÿ
                                    COPY,S.5                       ÿ
                                      PDS,S.6
                                      DEL,S.7               ÿ
                                        PTF,S.8
    ÿ
                                          UNTE,S.8
                                            UNTER,S.8
                     ÿ
                                              UNTERSE,S.8
          ÿ
                                      ÿ
                              &ZT = TRUNC(&Zsel,1)
                         ÿ
                                      R,R B,B D,D F,F Pÿ
                                   IF (&ZT = X)
                                       &ÿ
                                         &maillmsg = 'Enter a valid valu
,C,D,DM,E,F,M,P,S.  Was &zsel'      IF (&ZSEL ^= &Z)
                                      IF (&ZSEL ^= '=')ÿ
                                            &OSEL = &ZSEL
         +
       ÿ
                                              VER (&ZSEL,LIST,R,A,B,D,E,
,M,C,L,MSG=MAIL000)                           IF (&SUBOPT ^= &Z)
                        ÿ
)    ÿ
MAIL001)                                   )End
                                         ¦   {
efault(%+_)         ÿ
type(text  ) intens(high)              Defaults displayed for */
type(text  ) intens(low )                   information only  */
_ type( input) intens(high) caps(onÿ
  @ type( input) intens(high) caps(on ) just(left ) pad('_')
  ! type(output) intens(high) caps(off) just(asis ) color(white)
  ` type(outpÿ
            hilite(uscore)
      ~ type(text) intens(low ) caps(off) just(asis ) color(turq)
            hilite(uscore)    ÿ
          ^ type(output) intens(high) caps(off) just(asis ) colÿ
                  hilite(uscore)
         )Body Expand(\\) Width(&ZSCREENW)       ÿ
           ^maillog+\-\% TSO/E-Mail Processing +\-\
             %Command ===>_zcmd                    \ \
l  ===>_mamt+%                                                    ÿ
               +Command Options: %Find/SENDmail/SORT
/LONG/XLONG  ÿ
orward%P+Print   +
   ÿ
                   +        ÿ
                     )Model
                    ÿ
                       )Init               ÿ
                           .HELP = TMLOGHLP
                           .ZVARS = 'ÿ
'                            &mamt = CSR                  ÿ
                               &zsel = &z
                             )Proc                    ÿ
                                &zselx = &z
                                  IF (&ZCMD = &Z)
                                      IF (&ZSEL ^= &Z)                 ÿ
                                          if (&Zsel = '=')
        ÿ
                                            &osel = &zsel
        ÿ
                       ÿ
                                                                    READ
                         +
                       ÿ
1
.1
                                        ÿ
I,S.2
IT,S.2
,S.3                                                     ÿ
  PRT,S.3
  PRNT,S.3
  PRIN,S.3
   ÿç
                  REN,S.4
                  RENA,S.4
                  ÿ
                      CO,S.5
                      COP,S.5
                      CPY,S.5    ÿ
                          COPY,S.5
                          PDS,S.6
                          DEL,S.7               ÿ
                              PTF,S.8
                              UNT,S.8
                              UNTE,S.8                         ÿ
                                  UNTER,S.8
                                  UNTERS,S.8
                                  UNTERSE,S.8
             ÿ
                                      *,*)
                  &ZT = TRUNC(&Zsel,1)
             ÿ
                            R,R B,B D,D F,F P,P S,S DM,DM C,C *,X)
                       IF (&ZT = X)
                           &ÿ
                               &maillmsg = 'Enter a valid value: A,B,C,D
M,P,S.  Was &zsel'      IF (&ZSEL ^= &Z)
                          IF (&ZSEL ^= '=')ÿ
                                  &OSEL = &ZSEL
                              &ZSEL = TRUNC(&ZSEL,'.')
                              &SUBOPT = .TRAIL            ÿ
 +

                                       VER (&ZSEL,LIST,S,MSG=MAIL001)
                                         VER (&SUBOPT,RANGE,0,9,MSG=MAIL
                /                )End
                                 {
        ÿ
 intens(high)              Defaults displayed for */           /* + type
 intens(low )                   information only  */           /ÿ
t) intens(high) caps(on+
put) intens(high) capÿ
utput) intens(high) caps(off) just(asis ) color(turq)
utpÿ
(output) intens(low ) caps(off) justÿ
  hilite(uscore)
pe(output) intens(hiÿ
    hilite(uscore)                                 ÿ
dy
illog                    % TSO/E-Mailÿ
Command ===>_zcmd                                            %Scroÿ
+%
 +Command Options: %Find/SENDmail/SORT                ÿ
   +Line Options:    %S+Read%A+Answer%C+Change%D+Delete%E+Edit%F+Forward
 ÿ
     %Sel  %FromUser      Node     ToUser   Node      Date     Time    ÿ
 Action+
       )Model   ÿ
         @z   +!z            !z       !z       !z        !z       !z
        ÿ
           +Target Dataset:    ÿ
             )Init
               .HELP = TMÿ
                 .ZVARS = '(ZSEL MAILFID MAILFÿ
                   MAILTIME MAILACTN MAILSUBJ MAILTDS)'
                   &mamt = CSR            ÿ
                     &zsel = &z                              ÿ
                     )Proc
                      &zselx = &z                          ÿ
                        IF (&ZCMD = &Z)
                              IF (&ZSEL ^= &Z)
                                if (&Zsel = '=')
                                      &Zsel = &osel
           ÿ
                                    &ZSEL = TRANS(&ZSEL RE,S.0
             +
           ÿ
                                                              BR,S.1
                                                              BRO,S.1
                            ÿ
                                       ÿ
                                                                    EDI,
                                               ÿ
                                                      ÿ

                                                                ÿ
.3                                                                   ÿ
,S.3
.4
Sÿ
NA,Sÿ
RENM,S.4
CO,S.5            ÿ
  COP,S.5          ÿ
    CPY,S.5
    COPY,S.5                       ÿ
      PDS,S.6                     ÿ
        DEL,S.7
        PTF,S.8                                     ÿ
          UNT,S.8                                ÿ
            UNTE,S.8
            UNTER,S.8                                                ÿ
              UNTERS,S.8                                        ÿ
                UNTERSE,S.8
                XMIT,S.9
      ÿ

&ZT = TRANS(TRUNC(&ZSEL,'.') A,A E,E M,M
      R,R B,B D,D F,F Pÿ
   IF (&ZT = Xÿ
         &mailsmsg = 'Error'
         &maillmsg = 'Enter a valid valuÿ
    IF (&ZSEL ^= &Z)         ÿ
        IF (&ZSEL ^= '=')
            &OSEL = &ZSEL                                +
          &ZSEL = TRUNC(&ZSEL,'.')          ÿ
              &SUBOPT = .TRAIL
              VER (&ZSEL,LIST,R,A,B,D,E,F,P,S,DM,M,C,L,MSG=MAIL000)
              IF (&SUBOPT ^= &Z)                           +
                     VER (&ZSEL,LIST,S,MSG=MAIL001)      ÿ
                       VER (&SUBOPT,RANGE,0,9,MSG=MAIL001)
             )End
           ¦   {
                                             /* % type(text  ) intens(hi
         Defaults displayed for */           /* + type(text  ) intens(lo
              information only  */           /ÿ
ps(on )ÿ
caps(on ) just(left ) pad('_')                      ^ type(output) inten
caps(off) just(asis ) color(turq)                   ! type(outpÿ
) caps(off) just(asis ÿ
w ) caps(off) just(asis ) color(turq)                         hilite(usc
                                                        ~ type(text) int
ÿ
                                                         )Body
                                                         +--------------
--% TSO/E-Mail LOÿ
                                           %Scroll ===>_mamt+%
                                                             +Command Op
NEW    %S+log    %C+log     %RENumÿ
   %S+Read %D+Delete %I+Information %C+Change                    +
                                                                 %Sel  %
og Description                                     ÿ
  ÿ
                                                                     @z
  !z                                                                ÿ
                 ÿ
 = TMLOGHT
S = '(ZSEL LOGNUM LOGDESC)'
 = CSÿ
zsel = &z
oc
er (&zsel,list,S,D,I,Cn )                      ÿ
 )End
 
                           /* % type(text  ) intens(high)     ÿ
s displayed for */           /* + type(text  ) intens(low )
formation only  */           /ÿ
t )               */              @ type( input) intens(high) caps(on )
eft ) pad('_')                      ^ type(output) intens(high) caps(off
(asis ) color(turq)                   ! type(outpÿ
st(asis ) color(white)                  ` type(output) intens(low ) caps
st(asis ) color(turq)                         hilite(uscore)
          ÿ
just(asis ) color(turq)                           hilite(uscore)
                                         )Body
                         ÿ
 LOÿ
                           %Scroll ===>_mamt+%
                                        ÿ
   %C+log     %RENumÿ
 %I+Information %C+Change                        +
                                                 %Sel  ÿ
                                     ÿ
                                                     )Model
                                                     @z   +!z  +  !z  ÿ
                                                      ÿ
                                                           .HELP = TMLOG
                                                           .ZVARS = '(ZS
M LOGÿ
                                                               &zsel = &
                                                             )Proc
                    ÿ
,S,I,C) n                                                        )End
                                                                 

                @ type( input) intens(high) caps(on ) just(left ) pad('_
                ^ type( input) intens(high) caps(off) just(asis ) color(
              ÿ
e)                  # type(text) intens(low ) caps(off) just(asis ) colo
                    ` type(text) intens(high) caps(off) just(asis ) colo
                    ~ type(textÿ
rq)                           hilite(uscore)
                     )Body
                     +------------------------% ÿ
ÿ

                         %                                       ÿ
               +
             ÿ
                               % Log Data Set Name       %===>_logds
    ÿ
                            ÿ
                                   %
                     ÿ
he display of your TSO/E-Mail        `     ÿ
ify the different logs you may         `          have created.
                                      ÿ
                                         `          The Loÿ
equired and will be allocated as new.      `
                                           )Init       ÿ
                                              If (&logdesc = &z)
                                                   .CURSOR = logdesc
                                                If (&logdesc ^= &z)
                                                     .CURSOR = logds
        ÿ
                                                    &zcmd = &z
         ÿ
                       ÿ
                                                        Ver (&logds,nb,d
                          #                              )End
                                      ÿ
²
     /* % type(text  ) intens(high)              Defaults displayed for
     /* + type(text  ) intens(low )                  ÿ
       /ÿ
            @ type( input) intens(high) caps(on ) just(left ) pad('_')
            ! type(output) intens(high) caps(off) just(asis ) color(ÿ
              ` type(outpÿ
                ~ type(text) intens(low ) caps(off) just(asis ) color(tu
                      hilite(uscore)
   ÿ
                 +---------------------------% TSO Nick Name Table +----
-----------------%Command ===>_zcmd
Scroll ===>_mamt+%ÿ
                     +Command: %Cancel+-Cancel the update   %I+-Insert
-Save/Update         +Line:    %D+-Delete   %S+-Review/Update
                     %           +
                         %Sel  ÿ
                           +
                           )Model
             ÿ
                               )Init
                                 .ZVARS = '(ZSEL NICKNAME)'
                              ÿ
                                     &zsel = &z
                                   )Proc
                                   )End        ˆ
                                       
+_)                                                              /* % ty
 ) intens(high)              Defaults displayed for */           /* + ty
 ) intens(lÿ
input) intens(high) caps(on ) just(left )               */
input) intens(high) caps(on ) just(left ) pad('_')
utput) intens(high) caps(oÿ
(textÿ
pe(input) intens(low ) caps(on) just(asis ) color(turq)
  hilite(uscore)                         ÿ
                      ÿ
----------------------% TSO/E-Mail Nickname Entry +---------------------
mmand ===>_zcmd                                         ÿ
                                       ÿ
 %
 %   Enter the new nickname to be added to the nickname list of:!nicknaÿ
                                                        ÿ
     %   Nickname ===>~newid   +
     %
     `ÿ
         `   of another list.
         `
         `   At this ÿ
          ÿ
             +
             %   Press PF3 to cancelÿ
e              )Init       ÿ
                  &newid = &z
                 )Proc                             +
                      ver (&newid,nb)       n    ÿ
                       )End
                       
                                                 /* % type(text ÿ
)              Defaults displayed for */           /* + type(text  ) int
)                   information only  */           /ÿ
gh) caps(on ) just(left )               */              @ type( input) i

high) caps(off) just(asis ) color(turq)                   ! type(outpÿ
s(high) caps(off) just(asis ) color(white)                  ` type(outpu
s(high) caps(oÿ
s(low ) caps(off) just(asis ) color(turq)                           hili
e)    ÿ
                             ÿ
-----------% TSO Nick Name Table +-----------------------------%Command
d                      ÿ
                                            ÿ
-Insert   %CANCEL+-Cancel the changes   %Save+-Save the changes    +Line
-Delete                                 ÿ
                                                           ÿ
ckname in list!nickname                                                +
                                                         ÿ

+!z         +

ZVARS = '(ZSEL LISTNICK)'
mamt = CSÿ
 &zsel = &z
Proc       2
   ver (&zsel,list,&b,D)ÿ
   )End
   
                             /* % type(ÿ
lts displayed for */           /* + type(text  ) intens(low )
information only  */           /ÿ
eft )               */              @ type( input) intÿ
(left ) pad('_')                      ! type(output) intens(high) caps(o
(asis ) color(white)                  ` type(textÿ
(asis ) color(turq)                     ~ type(input) intens(low ) ca+
st(asis ) color(turq)                           hilite(uscore)     ÿ
                                         )Body                      ÿ
                                           +------------------------% TS
 Nickname Entry +--------------------------%Command ===>_zcmd
  ÿ
     ÿ
                                               %   Enter the new List na
 added           ÿ
                      ÿ
                                                   %
                                ÿ
                                       ÿ
                                                       %
                                               ÿ
                                                        ÿ
                                                           %   Press PF3
el the update or Enter to register the update              )Inÿ
                                                              &listnick
                                                               )Proc
                                                                  ver (&
ck,nb)                                                           )End
                                                                   
ç
            ÿ
r */           /* + type(text  ) intens(low )                   informat
  */           /ÿ
    */              ! type(ÿ
e)                    | type(text) intens(high) caps(off) just(asis ) co
)                    @  TYPE(outpÿ
                     )Body                ÿ
                       +----------------------% TSO Mail Nick Name Manag
-----------------------%Selection ===>_zcmd       ÿ
                         +                               ÿ
                           +
                                   %1+- Process Primary Nick Name eÿ
                                     %2+- Process Nick Name List entries
                                       %3+- Process Control Information
 LOGNAME and LOGSEL)%*                 %4+- Save the current file:@NICKD
    ÿ
       ÿç
                                               +    This dialog will sup
e creation and maintenance of youÿ
ame entries, LIST entrÿ
                                                   +    * Not supported
rnate control data sets.                          ÿ
                                     ÿ
te processing at this point.                           )Init
                                                       )Proc       2
                                                    ÿ
)                                                          )End
                                                           
§
       /* % type(text  ) intens(high)              Defaults displayed fo
       /* + type(text  ) intens(low )                   information only
       /ÿ
  ÿ
              ^ type(output) intens(high) caps(off) just(asis ) color(tu
              ! type(outpÿ
                `ÿ
                  ~ type(text) intens(low ) caps(off) just(asis ) color(
                        hilite(uscore)    ÿ
                 )Body          ÿ
                   +-------------------------% TSO Mail Nick Name Table
-------------------%Command ===>_zcmd                      ÿ
   %Scroll ===>_mamt+%                         ÿ
                       +Command: %I+-Insert   %F+-Find     %Cancel+-Canc
e+-Save                +Line:    %I+-Insert   %D+-Delete   %N+-Send note
+-Update/Review          %                                    ÿ
                           %Sel  %Nickname   Userid     Node     Name
                           +
             ÿ
                               @z   +!z         `z         `z       `z
                               )Init
                              ÿ
            ÿ
                                     &zsel = &z
                                   )Proc       2
                           +
                         ÿ
                                         
(%+_)                                                              /* %
t  ) intens(high)              Defaults ÿ
ext  ) intens(low )                   information only  */           /ÿ
( input) intens(high) caps(on ) just(left )               */
( input) intens(high) caps(off) just(left ) pad('')    ÿ
  hilite(uscore) color(turq)
pe(outpÿ
    hilite(uscore)                                                    ÿ
! type(text) intens(high) caps(off) just(asis ) color(white)
` type(text) intens(highÿ
  ~ type(text) intens(low ) caps(off) just(asis ) color(turq)
     ÿ
 )Body                                   ÿ
   +---------------------% TSO Mail Nick Name List Display +------------
---%Command ===>_zcmÿ
     %                                                    ÿ
       +
       `   Nick Name%===>^NICKNAME+ÿ
         +
           !   Use the Nick Name List Processing dialog to review or upd
 list.     +                                      ÿ
             )Init
            ø  )Proc
               )End                                              ÿ
                 
                                           /* % type(text  ) intens(high
       Defaults displayed for */           /* _ type( input) intens(high
ÿ
ps(on ) just(left ) pad('_')                      + type(text  ) intens(
ip(on)                                            ^ type(output) intens(
ps(off) just(asÿ
) caps(off) just(asis ) color(white)                  ` type( input) int
) caps(off) just(asis ) color(turq)                         hilite(uscor
')                            ÿ
ÿ
ad('')                                                 )Body
                                             +
----% TSO Mail Coÿ
                                           %Scroll ===>_mamt+%
                                                             +Command: %
t   %Cancel+-Cancel the update   %ÿ
nsert   %D+-Delete   %U+-Update current record (in place)        %
                                                                 %Sel  %
 Value                                             ÿ
                                                                     @z
                                                                     +
                                                                    ÿ
        ÿ
S = '(ZSEL Option Value)'
 = CSR
 = &zÿ
oc
If (&zsel ^= &z)
 Ver (&option,nb,list,n :Altctl.,:Prolÿ
 )End
 
                           /* % type(text  ) intens(hÿ
s displayed for */           /* + type(text  ) intens(low )
formation only  */           /ÿ
t )               */              @ type( input) intens(high) caps(oÿ
eft ) pad(nulls)                          hilite(uscore) color(turq)
                                    ^ type( inpÿ
(left ) pad(nulls)                          hilite(uscore)
   ÿ
st(asis ) color(white)                  ` type(text) intens(highÿ
st(asis ) color(turq)                     ~ type(text) intens(low ) caps
st(asis ) color(tuÿ
                                         )Body
 ÿ
 Name Update/Create +------------ÿ
                                             %
                  ÿ
                                               +ÿ
                                                 `   Nick Name%===>^NICK
 Nick Name you will use for this inÿ
   Userid Electronic Mail userid                   `   Node *  +
                                               +     `   Nameÿ
                                 +                    ÿ
RNET                               + optional            `   Address  %=
ESS1                               +    "                `   Address  %=
DRESS2                               +    "                `   Address ÿ
ADDRESS3                               +    "                `   Address
ADDRESS4                               +    "                `   Phone
PHONE      ÿ
        ÿ
                                                                 +   * a
ode will default to the thÿ
                         ÿ
ing PF3 to terminate update/creation                                 )In
                                         ÿ
                                          ÿ
&nickname,nb)
internet = &Z)                                          ÿ
er (&userid,nb)                                            +
er (&name,nb)                                            ÿ
 if (&node = &Z)                                                       H
       &node = &center
 )End
   {

Œ\INMR01








  


 NAME=LPR00    0105-1993356-1993356-1227-00004-00004-00000-$A1238

 data set name must be specified and must be a valid dsname'
02  '&LPRSMSG' .WINDOW=NORESP .TYPE=NOTIFY
RLMSG'
DD NAME=PSPR00
001       ÿ
nput data set name must be specified and must be a valid dsname'
PR002 '&SMSG' .WINDOW=NORESP .TYPE=NOTIFY
LMSG'                    T
PSPR003
'Output data set name, if specified, must be a valid dsname'

0117-00000-SYSLBD         )Attr Default(@+_)
                          /* _ type( input) intens(high) caps(on ) just(
             */            ÿ
olor(white)                       hilite(reverse)
                               $ type(output) intens(high) caps(off) jus
 color(white)                     hilite(rÿ
                                 ` type(text) intens(high) caps(off) jus
 color(yellow)                   ~ type(text) intens(high) caps(off) jus
 color(turq)                     @ type(text) intens(highÿ
                                   + type(text  ) intens(low )
                                     skip(on)
                                   # area(SCRL) Extend(ON)
                                  )Body
                                  +------------------! Print Data via TC
 Information +--------------------@Command ===>_zcmd
       ÿ
                                    +
                                    #help ------------------------------
----------------------ÿ
                                      `    Information on Printing to TC
nected Printers using LPR             ~
                                     ÿ
asy to use interface for printing       ~    user data on printers that
tely attached via the TCP/IP network.   ~
                                        ~    LPR is ÿ
ient command that prints the user         ~    information on a remote p
onnected via the TCP/IP network.  It      ~    communicates to the LPD (
nter server) on a remote Host on          ~    which the requested ÿ
attached.                                   ~
                                            ~    The information that is
or on the panel is:                         ~
  ÿ
                                              ~
                                              ~    This is the data set
t contains the inÿ
er.  The format is:                             ~
                                                ~              user.data
                                +
r)                            ÿ
data'                                               ~
                                                    `    Printer Name
>                                            ÿ
                                                      ~    This is the n
he printer as it is identified to the Host            ~    on which the
is attached.                                          ~     ÿ
                                                        ~       e.g.   l
                                                        ~              I
                                                        ~
                                                          `    Host Name
   ===>                                                   ~
                                                          ~    This is t
P Host Namÿ
owns the specified printer.                                 ~
                                                            ~       e.g.
int.rockwell.com         ÿ
                                                              `    Binar
       ===>                                                   ~
                                        ÿ
cify if the user data is to be translated from EBCDIC           ~    to
Specify`Yes~if the data is already in ASCII format and          ~    is
e translated by the LPR command.                       ÿ
                                                                  `    C
Control    ===>                                                   ~
                                                                  ~   ÿ
`Yes~if the data to be printed contains carriage control            ~
 DCB of the data set does not indicate this fact.  Otherwise        ~
`No~.  If the DCB contains carriage control then it will be         ~
     ÿ
                                                                      `
s              ===>                                                   ~
                    ÿ
icates the number of copies of the data to be printed.

es per Page      ===>              ÿ

ndicates the number of lines of data per page to be printed before
 new page is forced.  By specifying 0 the maximum +
 per page allowed by the printer will be printedÿ

   Header Info         ===>
                                                               ÿ
~    Indicates if you want a header printed with the name of the data se
~    being printed on the top of every page.  Only for No Binary and No
~
  `    Burst Page          ===>
  ~
  ~    Indicates if you want a banner page to be printed before your
  ~    data. ÿ
    ~    print requests and contains the ISPF Host Name, TSO Userid, and
    ~    the data set name being printed.
    ~                       ÿ
      `    Notify Complete     ===>
      ~
      ~    This option will request that anÿ
ed      ~    to you when the data has completed printing on the printer.
        ~    !Note:`this is not supported by all versions of LPD so even
        ~          `request the message, you may not receiÿ
          ~
          `    PostScript          ===>
          ~
            ~    This option may be Portrait, Landscape, or No.  If 'no'
ified then  ~    no Postscript control headers will be generated for pri
 a Postscrpt~    printer.  Portrait and Landscape will cause the appropr
ders to ÿ
tscript file. ~
              `    Other Options       ===>
              ~        ÿ
                ~    This option will allow the user to enter other LPR
that are not    ~    directly supported by this dialog.
                +                     ÿ
                  !Note:`Use the Enter key to just scroll down this tuto
                  `      Use key $LEFT`to scroll down and key $RIGHT`to
p.                )Init                              ÿ
                      .cursor = zcmd
                      &left  = PFK(LEFT)
                      &right = PFK(RIGHT)                           +
                      )Proc                                       ÿ
                        )end
                        ./ ADD NAME=LPRPM    0101-1994013-1994018-0732-0
30-00000-$A1238         )ATTR
 ÿ
                            × AREA(DYNAMIC) SCROLL(ON) EXTEND(ON)
                            + TYPE(TEXT) INTENS(LOW)
                ÿ
                             01 TYPE(DATAIN) INTENS(HIGH) CAPS(ON)
                             02 TYPE(DATAOUT) INTENS(LOW)
                             03ÿ
                               04 TYPE(DATAOUT)  INTENS(LOW)
                               05 TYPE(DATAOUT)  INTENS(HIGH)
                               06 TYPE(DATAOUTÿ
                                )BODY WIDTH(80)
                                %Member List -- &ZDSN ------------------
------------%ROWÖZMLCR%OFÖZMLTR+%Command ===>_ZCMD           ÿ
                %Scroll ===>_Z   +%Commands:      LOCATE, RESET, SELECT,
ELP                              +%Line commands: / or S = Select, B = B
                                 +&ZMLCOLS
                                    ×ZDATA -----------------------------
-----------------------------------××
                                   ×× ----------------------------------
-----------ÿ
                                        .ZVARS = 'ZSCML'         /* SCRO
ARIABLE NAME  */                        .HELP = ISR01130
                          ÿ
                                          VPUT (ZSCML) PROFILE
                                        )END
                                         ÿ
158590 : FUNCTION TEST          */         /*   PTM00000184
                                */         /*
                                */         /*   CHANGED ÿ
                             3@M1C*/        /* 5665-402 (C) COPYRIGHT IB
980, 1989 */                                ./ ADD NAME=LPRPRINT 0101-19
99043-1101-00079-00079-00000-SYSLBD         )Attr                      ÿ
                                                 @ type( input) intens(h
s(off) just(left ) pad('_')                        color(white)
                                                 ! type( input) intens(h
s(off)+
aps(ÿ
aps(off) just(asis ) color(white)                          hilite(uscore
                                                     × type(text) intens
aps(off) just(asis ÿ
                                                       # type(text) inte
 caps(on) just(left ) color(yellow)                          hilite(usco
                                  ÿ
h) caps(off) just(asis ) color(turq)                     ~ type(text) in
 ) caps(off) just(asis ) color(turq)                     % type(text) in
 ) caps(off) just(asis ) color(white)            ÿ
                                                        +---------------
rint Data via TCP/IP LPR Command +----------------------%Command ===>_zc
                                                        `       ÿ
                                                          `Enter/Verify:
                                                          `    Input Dat
 %===>_lprpinds                                         + %

   %===>!lprdest                                          + `    Host Na
)  %===>!lprhost                                          + %
              ÿ
     %===>!lprbin+   Use if the file is already ASCII         `    Carri
rol  %===>!lprcc+    Honor Carriage Control in Column 1       `    Copie
     %===>!lprcopy+          ÿ
age    %===>!lprlcnt+  Lines per page if no CC or (0=default)   `    Hea
       %===>!lprhead+  Generate header information              `    Bur
       %===>!lprburst+ Generate a burst pageÿ
mplete   %===>!lprntfy+  Send Mail when print complete            `    P
t        %===>!lprps    +Portrait, Landscape, or No               `    O
ions     %===>@lpruopt                                     ÿ
                                                                    )Ini
                                                                     .HE
ph0                                                                  .cu
= lprpinds                                                             &
= trans(trunc(&lprbin,1) Y,Yes N,No y,Yes n,No &z,No)                  &
= trans(trunc(&lprcc,1) Y,Yes N,No y,Yes n,No &z,No)                   &
= trans(&ÿ
t = trans(&lprlcnt &z,0 *,*)
d = trans(trunc(&lprhead,1) Y,Yes N,No y,Yes n,No &z,Yes)
st= trans(trunc(&lprburs+
tfy = trans(trunc(&lprÿ
rps   = trans(trunc(&lprps,1) P,Portrait, L,Landscape N,No
                              p,Portrait, l,Landscape n,No &z,No)
nit                                  ÿ
cursor = lprpinds
lprbin  = trans(trunc(&lprbin,1) Y,Yes N,No y,Yes n,No &z,No)
lprcc   = trans(trunc(&lprcc,1) Y,Yes N,No y,Yes n,Nÿ
 &lprcopy = trans(&lprcopy &z,1 *,*)
 &lprlcnt = trans(&lprlcnt &z,0 *,*)
 &lprhead = trans(trunc(&lprhead,1) Y,Yes N,No y,Yes n,No &z,Yes)  ÿ
   &lprburst= trans(trunc(&lprburst,1) Y,Yes N,No y,Yes n,No &z,Yes)
   &lprntfy = trans(trunc(&lprntfy,1) Y,Yes N,No y,Yes n,No &z,No)
   &lprps   = trans(trunc(&lprps,1) P,Portrait, L,Landscape N,No
  ÿ
    )Proc
     &lprbin = trans(trunc(&lprbin,1) Y,Yes N,No y,Yes n,No &z,No *,*)
     &lprcc   = tÿ
       &lprcopy = trans(&lprcopy &z,1 *,*)
       &lprlcnt = trans(&lprlcnt &z,0 *,*)
       &lprhead = trans(trunc(&lÿ
         &lprburst= trans(trunc(&lprburst,1) Y,Yes N,No y,Yes n,No &z,Ye
         &lprntfy = trans(trunc(&lprntfy,1) Y,Yes N,No y,Yes n,No &z,No
         &lprps   = trans(trunc(&lprps,1) P,Porÿ
                                            p,Portrait, l,Landscape n,No
,*)        ver (&lprpinds,nonblank,dsname,msg=lpr001)
           ver (&lprdest,nb)                                  ÿ
             ver (&lprhost,nb)
             ver (&lprbin,nb,list,Yes,No)
             ver (&lprcc,nb,list,Yes,No)
               ver (&lprcopy,nb,num)
               ver (&lprlcnt,nb,num)
               ver (&lprhead,nb,list,Yes,No)
            ÿ
                 ver (&lprntfy,nb,list,Yes,No)
                 ver (&lprps,nb,list,Portrait,Landscape,No)
                )End       ÿ
                  ./ ADD NAME=PSPRH0   0100-1994025-1994025-1028-00071-0
00-$A1238         )Attr Default(@+_)
                  /* _ type( input) intens+
       */              ! type(text) inteÿ
hite)                       hilite(reverse)
                         $ type(output) intens(high) caps(off) just(asis
(white)                     hilite(reverse)            ÿ
                           ` type(text) intens(high) caps(off) just(asis
(yellow)                   ~ type(text) intens(high) caps(off) just(asis
(turq)                     @ type(text) intens(high)                  ÿ
                             + type(text  ) intens(low )
                               skip(on)
                             # area(SCRL) Extend(ON)
     ÿ
                            +------------------------! Convert Text to P
t +-------------------------@Command ===>_zcmd
                    ÿ
                              +
                              #help ------------------------------------
-----------------------------#)Areaÿ
                                `    Information on Converting text to P
t                               ~
                                ~    This ISPF appÿ
ata into a data stream that       ~    can be printed on a PostScript pr
                                  ~
                                  ~    To print this data stream ÿ
 the data to an application         ~    that will convert it from EBCDI
VS character set) to ASCII          ~    and then direct the data stream
stScript printer.  The most         ~    common technique for this is to
ÿ
                                      ~    The information that is asked
the panel is:                         ~
               ÿ
                                        ~
                                        ~    This is the data set name t
ains the information that is tÿ
mat of this field is:                     ~
                                          ~              user.data
                                          ~  ÿ
                                            ~              'prefix.user.
                                            ~
                                            `    Print Orien+
                                              ~           ÿ
                                                ~    This is the orienta
the resulting printed output.  The valid        ~    options are:
                                                ~
                                                           PORT -  Portr
haracters by 60 lines in 11 pt. Courier                    WIDE -  Portr
characters by 103 lines in 6 pt. Courier                   LAND -  Lands
 charactÿ
characters by 66 lines side by side                                  in
e in 6 pt. Courier                                  ~
                       ÿ
==>                                                   ~
                                                      ~    This allows y
form the application that the ISPF LPRÿ
tically invoked.  If`no~is selected then the converted  ~    data stream
 saved into a data set (either the specified output     ~    data set or
ically generated data set).                          ÿ
                                                          `    Output Da
   ===>                                                   ~
                                                          ~    This ÿ
ptional and defines an output data set into which           ~    the con
ostScript data stream will be stored.                       +
                                                            !Note:`Use t
 keÿ
FT`to scroll down and key $RIGHT`to scroll up.                )Init
                                                                .cursor
                  ÿ
EFT)                                                              &right
IGHT)                                                           )Proc
                                 ÿ
                                                                  ./ ADD
PRINT  0107-1994025-1996003-1024-00055-00047-00000-SYSLBD         )Attr
                                                ÿ
nput) intens(high) caps(off) just(left ) pad('_')
hite)                                                                  !
nput) intens(high) caps(off) just(left ) color(white)          ÿ
 input) intens(high) caps(on ) just(left ) color(white)
text) intens(low ) caps(off) just(asis ) color(white)
ilite(uscore)
e(text) intens(high) caps(off) just(asis ) color(white)
   hilite(uscore)
ype(text) intens(high) caps(on) just(left ) color(yellow)
   hilite(uscore)
ype(text) iÿ
 type(text) intens(low ) caps(off) just(asis ) color(turq)
 type(text) intens(low ) caps(off) just(asis ) color(white)
y                         ÿ
-----------------------% Convert text to PostScript +-------------------
ommand ===>_zcmd
                                         ÿ
`Enter/Verify:
`
`    Input Data Set      %===>_psinds                   ÿ
  %
  `    Print orientation   %===>!pstype+    see list below
  %                                                                    ÿ
    `    Invoke LPRPRINT     %===>!lpr+       Yes or No
    `
    `    Output Data Set     %===>_psopds
    ` ÿ
      `
      `    Valid orientations:
      `          PORTÿ
        `          WIDE+-  Portrait 132 characters by 103 lines in 6 pt.
        `          LAND+-  Landscape 132 characters by 60 lines in 9 pt.
        `          2UP +-  2 pages 8ÿ
          `              +   in landscape in 6 pt. Courier
          )Init
           .HELP = psprh0                          ÿ
             .cursor  = psinds
             &pstype= trans(trunc(&pstype,1)
                        P,Port p,Port L,Land l,Land, W,Wide w,Wideÿ
rt)            &lpr     = trans(trunc(&lp,1) Y,Yes N,No y,Yes n,No &z,Ye
              )Reinit
               .cursor  = psinds
 ÿ               &pstype= trans(trunc(&pstype,1)
                            P,Port p,Port L,Land l,Land, W,Wide w,Wide 2
Port)            &lpr     = trans(trunc(&lp,1) Y,Yes N,No y,Yes n,No &z,
                ÿç
                               &pstype= trans(trunc(&pstype,1) P,Port p,
and l,Land,                                                        W,Wid
 2,2UP &z,Port *,*)            ÿ
n,No &z,Yes *,*)                 ver (&psinds,nonblank,dsname,msg=pspr00
                                 ver (&pstype,nb,list,Port,Land,Wide,2UP
                                 ver (&lpr,nb,ÿ
                                   ver (&psopds,dsname,msg=pspr003)
                                  )End
                                  ./ ADD NAME=PSPRM    0101-1ÿ
32-00031-00030-00000-$A1238         )ATTR
                                      _ TYPE(INPUT) CAPS(OFF) INTENS(HIG
                                      × AREA(DYNAMIC) SCROLL(ON) EXTEND(
                                        + TYPE(TEXT) INTENS(LOW)
                                        Ö TYPE(OUTPUT) INTENS(HIGH) JUST
PAD(0)                                 01 TYPE(DATAIN) INTENS(HIGH) CAPS
           ÿ
                                         03 TYPE(DATAIN)  INTENS(HIGH) C
                                         04 TYPE(DATAOUT)  INTENS(LOW)
                          ÿ
                                           06 TYPE(DATAOUT)  INTENS(LOW)
                                          )BODY WIDTH(80)
                                         ÿ
------------------------%ROWÖZMLCR%OFÖZMLTR+%Command ===>_ZCMD
                          %Scroll ===>_Z   +%Commands:      LOCATE, RESE
T, SORT, HELP                              +%Line commanÿ
 = Browse                                    +&ZMLCOLS
                                              ×ZDATA -------------------
---------------------------------------------××                        ÿ
                                               ×× ----------------------
-----------------------------------------------×)INIT
                                                  .ZVARS = 'ZSCML'
ROLL Aÿ
                                                  )PROC
                                                    VPUT (ZSCML) PROFILE
                     ÿ
                                                     /*  $M1= MEMLIST
 860923   158590 : FUNCTION TEST          */         /*   PTM00000184
                                    +
                                  ¶           */         /*   CHANGED 3
                                         3@M1C*/        /* 5665-402 (C)
T IBM CORP 1980, 1989 */                                {

            /* ---------------------  rexx procedure  ------------------
             * Name:      LPRPrint
     ÿ
               * Function:  Invoked by the user or via another ISPF dial
               *            to invoke the LPRPRINT ISPF Panel and then u
               *    ÿ
 *               *            data set on a TCP/IP connected printer.
 *               *
 *               *            Note ÿ
e  *               *            to receive the data.
   *               *
   *               * Syntax:    %lprprint dsname  ÿ
     *               *
     *               *            dsname is optional
     *               *                                           ÿ
       *               * Author:    Lionel B. Dyck
       *               *            Kaiser Permanente
       *               *            Walnut Creek, CA 94598
ÿ
         *               *            IBMMail:  USKFHLBD
         *               *            Internet: syslbd@ncal.kaiperm.org
         *     ÿ
           *               * History:
           *               *            03/20/97 - save inds in profile
           *               *  ÿ
esn't        *               *            08/29/94 - update for Postscri
n            *               *            06/23/94 - fix parse for pds d
             *               *            01/ÿ
r name         *               *            01/18/94 - add support for m
lection if     *               *                       dsname is pds and
er given       *               *            01/17/94 - fix fÿ
 for messages    *               *            01/07/94 - add option for
al user specified*               *                       parameters othe
hat is directly  *               *                       supported
                   *               *            01/04/94 - add entry opt
rameter of dsn     *               *                       and support A
n                  *               *            01/03/94 - updated to cl
vocation  +
tion    ÿ
                       *               * -------------------------------
---------------------- */
                       ÿ

                                         Address ISPEXEC
                                      ÿ
                                           do forever
                                             "VGET (lprdest lprhost lprb
 lprntfy lprlcnt lprhead ",                        "lÿ
uopt lprpinds) Profile"                         if length(inds) > 0 then
s = inds                                        "Display Panel(LPRPRINT)
                                                if rc > 3 then exit ÿ
                                                 "VPUT (lprdest lprhost
prcc lprntfy lprlcnt lprhead ",                        "lprburst lprntfy
pruopt lprpinds) Profile"
   ÿ
n do                                                lprsmsg = "Error"
                                                    lprlmsg = "Specified
t does not exist:"ÿ
                                                      "SETMSG MSG(LPR002
                                                      end
                                 ÿ
                                                          parse value ""
nary cc mail line_count header burst,
postscr                                         ÿ
then binary = "Binary"                                      if lprcc
then cc     = "CC"
else cc     = "NOCC"                                        if ÿ
" then mail   = "Mail"                                        if lprhead
  then header = "NoHeader"                                    if lprburs
  then burst  = "NoBurst"                                     if lprcopy
    then copies = "Copies" lprcopy                              if lprlc
    then line_count = "Linecount" lprlcnt                       if lprps
ortrait"  then postscr = "Postscript"                           if lprps
andscape" theÿ
                                                                  x = li
rpinds)                                                           if pos
pinds) > 0 then sysdsorg = "+
                          ÿ
dsorg = "PS" × pos("(",lprpinds) > 1
n call do_lpr lprpinds
dsorg = "PO"                             ÿ
hen call do_pds
ise nop;
                                                        ÿ
                                                                     end

                                                                     doÿ

t Dataid(dataid) Dataset("lprpinds") Enq(Shrw)"
n Dataid("dataid") Option(Input)"
sp Datÿ
ommands(Any) Panel(LPRPM)"
 while rc == 0
 Call process_selectiÿ
  "Lmmdisp Dataid("dataid") Option(Get)"
   if rc == 8
      then "Lmmdisp Dataid("dataid")ÿ
             "Commands(Any) Panel(LPRPM)"
  end
  "Lmmdisp Dataid("dataid") Option(Free)"          ÿ
    "Lmclose Dataid("dataid")"
    "Lmfree  Dataid("dataid")"
  return                                                          ÿ

 process_selection:
    if left(lprpinds,1) = "'"
 ÿ
         else w_dsn = sysvar("syspref")"."lprpinds
      zlmember = strip(zlmember)
      Select    ÿ
        When zllcmd = "/" × zllcmd = "S"
        Then do
          "Lmmdisp Dataid("dataÿ
                "Zludata(printed)"
            call do_lpr "'"w_dsn"("zlmember")'"
            end                               +
            When zllcmd = "B"               ÿ
              Then "Browse Dataid("dataid") Member("zlmember")"
              Otherwise nop;
              End                                          ÿ
                return

             do_lpr:
                  arg dsn
                  Address TSO,
                 "LPR" dsn "(Printer" lprdest "Host" lprhost "Type",
         ÿ
                         postscr lpruopt
                   if sysdsorg <> "PS" then return
                   lprsmÿ
                     lprlmsg = lprpinds "printed to" lprdest "at" lprhos
                    "Vput (lprsmsg lprlmsg)"
                    "SETMSG MSG(LPR002)ÿ
                       return
            ./ ADD NAME=PSPRINT
                    /* ---------------------  rexx proÿ
------ *               * Name:      PSPRINT
       *               *
       *               * Function:  Convert a text file into a PostScÿ
t        *               *            stream.
         *               *
         *               * Syntax:    %PSPRINT input-file output-file /
    ÿ
           *               * where:
           *               *        input-file is the data set name of t
 text file *       ÿ
t name that  *               *           will contain the postscript res
             *               *           - if not specified this is dyna
generated.   *               *    ÿ
ot be deleted  *               *             at the end of processing.
               *               *           - if specified as @ then the
log will be    *               *             invoÿ
                 *               *       / is the delimeter used to offs
ptions           *               *       options are optional values whi
e:               *               *           PORT, WIDE, LAND, o+
t orientation      *               *           DEBUG to cause ÿ
exx program          *               *             during execution
                     *               *           NOLPR to prevent the ex
of the LPRPRINT exec.*               *
                       *               * If no parameters are entered th
SPF Dialog is invoked. *               *
                       *               * Defaults:
            ÿ
e the output file after  *               *            invoking the lprpr
edure.                   *               *
                         * ÿ
                           *               *            Rockwell Interna
                           *               *            P.O. Box 2515
                           *              ÿ
 90740                       *               *            (310) 797-1125
                             *               *            IBMMail:  USRO
                             *               *           ÿ
8.rockwell.com                 *               *            IBMLINK:  RO
                               *               *
                               *               * History:
                                 *               *           02/22/96 -
dialog even if dsname provided   *               *           09/26/94 -
g fix in parse                   *               *           09/02/94 -
RPRINT ÿ
st for options                     *               *           04/27/94
ompt option                        *               *           01/26/94
d to support non-ISPF ÿ
ted for TSO/ISPF                     *               *
                                     *               * Originally based
 PSPRINT.cmd                         ÿ
s (10/31/92)                           *               * (c) Copyright I
 1992 All Rights Reserved              *               * modified to all
tion of lptn                           *            ÿ
                                         *               * modified to r
 MVS TSO/E by Lionel Dyck                *               * to use PostSc
gramming by Carl J. Lydick               *               * of CalTeÿ
p from comp.lang.postscript.               *               *
                                           *               * This elimin
 calculation of line placement and         *               * page ejects
vi+
ÿ
t 80 characters by 60 lines in 11 pt. Courier  *               * WIDE -
t 132 characters by 103 lines in 6 pt. Courier *               * LAND -
pe 132 characteÿ
es 80 characters by 66 lines side by side        *               *
ndscape in 6 pt. Courier                         *               *
                              ÿ
-------------------------------------------------- */
                                                                  parse
ds outname "/" options                       ÿ
                                                                    outn
anslate(strip(outname))
                                                            ÿ
psinds) >= 0 then prompt = 1                                          if
        = "@" then prompt = 1
 length(outname) > 0 then prompt = 0                                  if
h(options) > 0 then prompt = 0

svar("sysicmd")
svar("sysiÿ

mpt = 1 then do forever
spf <> "ACTIVE" then do  ÿ
  say cmd": Not running under ISPF and no parameters specified"
  say cmd": terminating - review the documentation and retry."
  exit 8                                ÿ
    end
 Address ISPEXEC
 "Display Panel(PSPRINT)"                              ÿ
   if rc > 3 then exit
   if lpr = "No" then lpr = "NOLPR"
                 else lpr = ""                                        ÿ
     if "OK" <> sysdsn(psinds) then do
         smsg = "Error"
         lmsg = sysdsn(psinds)
     ÿ
           "Setmsg Msg(Pspr002)"
            end
       else call tes+
      end         ÿ

        if length(options) > 0 then
           options = translate(opÿ

          /* test options for debug */
          if wordpos("DEBUG",options) > 1 then dÿ
               trace "?i"
               x = wordpos("DEBUG",options)
               new_opt = delword(options,x,1)                  ÿ
                 options = new_opt
                 end

                /* test options for nolpr */
                if wordpos("NOLPR",options) > 1 then do
                   no_lpr = "on"
             ÿ
                     x = wordpos("NOLPR",options)
                     new_opt = delword(options,x,1)
                     optionsÿ
                       end

                    if spf <> "ACTIVE" thenÿ

                      if length(outname) = 0 then do
                         d = date(u)                      ÿ
                           date = substr(d,7,2)substr(d,1,2)substr(d,4,2
                           s = time("L")  /* get the current time hh:mm:
                           t = substr(s,1,2)substr(s,4,2)substr(s,7,2)su
,10,1)                       prefix = sysvar(syspref)
                             pscript_dsn = "'"prefix".pscript.D"date".T"
                             end
        ÿ
                                 pscript_dsn = outname
                                 no_del = "on"
                       ÿ

                              out. = ""
                                      +
                                Seleÿ
                                    When options = "PORT" then call do_p
                                    When options = "WIDE" then call do_w
                                    When options = ÿ
                                      When options = "2UP"  then call do
                                      Otherwise call do_port
                                      end                         ÿ

                                      /* test the existence of the input
t */                                  if "OK" <> sysdsn(psinds) then
 ÿ
                                            smsg = "Error"
                                            lmsg = sysdsn(psinds)
                ÿ
                                              exit
                                          end
                               ÿ
                                            x = listdsi(psinds)
                                            if pos("(",psinds) > 0 then
 = "PS"                                     ifÿ
                                                 if spf <> "ACTIVE" then
                                                    say cmd": Has specif
rtitioned data set:",                                        ÿ
                                                      say cmd": which is
ported by this command",                                     "outside of
F enviornment."                                       say cmd": Terminat
ocessing.  Specify a member",                                  "name and
                                                        exit
                                                        end
           ÿ
                                                       call do_pds
                                                       exit
                          ÿ

                                                      /* generate a ddna
ynamically allocate the output           ÿ
                                                        pscript_odd = "P
om()                                                    "Alloc f("pscrip
ds("pscript_dsn") New Spa(30,30) Tr",                   +
l(255) Blksize(0) Dsorg(PS)"                          ÿ
                                                            /* read each
uote characters and then output */                          pscript_idd
random()                                                    "Alloc f(ÿ
idd") ds("psinds") Shr"                                       "Execio *
script_idd "(Finis stem in."                                  "Free f("p
dd")"
    ÿ
 pscript_odd "(stem out."                                       "Execio
 pscript_odd "(Finis stem in."                                  "Free f(
_odd")"            ÿ
                                                                  drop o

                                  ÿ
 "on" then do                                                         if
ACTIVE" then do
 ISPEXEC "Vget (lprps) Profile"                  ÿ
lprps = lprps
 = "No"
ss ISPEXEC "Vput (lprps) Profile"                               ÿ

rint" pscript_dsn
= hold_lprps

ddress ISPEXEC "Vput (lprps) Profile"

              ÿ
msg("OFF")
o_del <> "on" then
elete" pscript_dsn           ÿ
else do
  smsg = ""
  lmsg = "Output dsname is:" pscript_dsn    ÿ
    call do_msg
    end
                                                           ÿ
  exit

  do_msg:

                       Address ISPEXEC
                       "Vput (Smsg Lmsg)"
         ÿ
                         end
                      else do
                        ÿ
                             say lmsg
                             end
                        return         ÿ

                      do_port:
                                                      ÿ
                        do_port:
                        out.1 = "%!PS-Adobe-1.0"
                        out.2 = "%%Creator: Carl J Lydick"           ÿ
                          out.3 = "%%DocumentFonts: Courier"
                          out.4 = "%%Pages: (atend)"
                          out.5 = "/Courier findfont 11 scalefont setfon
    ÿ
                            out.7 = "/Q { 36 H moveto dup length 80 gt {
interval}",                         " if show /H H 12 sub def"
                   ÿ
                              out.9 = "/R 0 def"
                              out.10 = "/S 512 string def"
                              out.ÿ
} {pop pop /R 1 def}',                  " ifelse T} if} def"
                                out.12 = "/L {/H 750 def {currentfile S
 not {exit} if T Q}",                   " loop shÿ
                                  out.13 = "L"
                                  out.0 = 13
                                  return                        ÿ

                                    do_wide:
                                    out.1 = "%!PS-Adobe-1.0"

                                      out.3 = "%%DocumentFonts: Courier"
                                      out.4 = "%%Pages: (atend)"
              +
etfont"     ÿ
                                          out.7 = "/Q { 36 H moveto dup
32 gt {0 132 getinterval}",                       " if show /H H 7 sub d
                           ÿ
                                            out.9 = "/R 0 def"
                                            out.10 = "/S 512 string def"
                                          ÿ
 0 ne {Q pop P}',                                      " {pop pop /R 1 d
se T} if} def"                                out.12 = "/L {/H 750 def {
ile S readline not",                                   " ÿ
howpage} def"                                   out.13 = "L"
                                                out.0 = 13
                                                return

                                                  do_land:
                                                  out.1 = "%!PS-Adobe-1.
       ÿ
ydick"                                              out.3 = "%%DocumentF
urier"                                              out.4 = "%%Pages: (a
                      ÿ
 9 scalefont setfont"                                 out.6 = "/P {showp
otate 0 -618 translate /H 594 def} def"               out.7 = "/Q {36 H
up length 132 gt {0 132 getinterval}"ÿ
.5 sub def"                                             out.8 = "    H 3
 if} def"                                               out.9 = "/R 0 de
                                                    ÿ
g def"                                                    out.11 = '/T {
") search {R 0 ne {Q pop P}',                                      " {po
 1 def} ifelse T} if} def"                                out.12 = ÿ
ate 0 -618 translate /H 594 def",                                    " {
ile S readline not {exit} if"                               out.13 = " T
 showpage} def"                                             out.14 = "L"
  ÿ
                                                              return

                 ÿ
                                                                out.1 =
obe-1.0"                                                        out.2 =
or: Carl J Lydick"              +
umentFonts: Courier"          ÿ
ages: (atend)"                                                      out.
urier findfont 6 scalefont setfont"                                 out.
{showpage 90 rotate 0 -618 translate /H 538",ÿ
def /V 71 def} def"                                                   ou
O {/H 538 def /V 431 def} def"                                        ou
P {V 431 ne {O} {N} ifelse} def"                            ÿ
"/Q { V H moveto dup length 80 gt {0 80 getinterval}",
" if show /H H 7 sub def"
 "   H 79 le {P} if} def"
 = "/R 0 def"
 = "/S 512 string def"
 = '/T {(", FF, ") search {R 0 ne {Q pop P} {pop pop',
   " /R 1 ÿ
14 = "/L {90 rotate 0 -618 translate /H 538 def /V 71 def"
15 = "   {currentfile S readline not {exit} if T Q}",
     " loop showpage} defÿ
t.16 = "L"
t.0 = 16
turn                                    ÿ

test_pds:
      x = listdsi(psinds)                              ÿ
        if pos("(",psinds) > 0 then sysdsorg = "PS"
        Select
          When sysdsorg = "PS" × pos("(",psinds) > 1                  ÿ
                 then
                 "Select Cmd(%"cmd  psinds psopds "/" pstype lpr ")"
            When sysdsorg = "PO"
     ÿ
              Otherwise nop;
            end
      return        ÿ

        do_pds:
            "Lminit Dataid(dataid) ÿ
              "Lmopen Dataid("dataid") Option(Input)"
              "Lmmdisp Dataid("dataid") Option(Display)",
                "Commands(Any) Panel(PsprM)"      +
                  do while rc == 0              ÿ
                       Call process_selection
                      "Lmmdisp Dataid("dataid") Option(Get)"
                       if rc == 8                              ÿ
                            then "Lmmdisp Dataid("dataid") Option(Displa
                                 "Commands(Any) Panel(LPRPM)"
                      end
                        "Lmmdisp Dataid("dataid") Option(Free)"
                        "Lmclose Dataid("dataid")"
                        "Lmfree  Dataid("dataid")"
             ÿ

                     process_selection:
                        if lÿ
                             then parse value psinds with "'" w_dsn "'"
                             else w_dsn = sysvar("syspref")"."psinds
                          zlmember = strip(ÿ
                            Select
                            When zllcmd = "/" × zllcmd = "S"
                            Then do                       ÿ
                                "Lmmdisp Dataid("dataid") Option(Put) Me
member")",                          "Zludata(printed)"
                                "Select Cmd(%"cmd  "'"w_dsn"("zlmember")
                                      psopds "/" pstype lpr ")"
                                  end
                                When zllcmd = "B"
        ÿ
")"                               Otherwise nop;
                                  End
                       ‚            return
                        {
 dialogs:
                                                    LPRPRINT - used to p
ng the OS/390 (or MVS) TCP/IP LPR command to any     ÿ
PD server.  This includes intelligent printers which             have LP
in.                                                   PSPRINT  - used to
host output for printing on a PostScript printer                 andÿ
ke LPRPRINT.  Options include Portrait, Landscape,                 and 2
ing.
                                                        The members of t
setÿ
                                                          $DOC     - Wha
e reading                                                 EXEC     - The
 rexx execs which ÿ
ages                                                        PANELS   - I
ls, including brief tutorials, for these dialogs
                                 ÿ
with these dialogs - use them at your own risk.  They         may requir
ization to work in your environment.
                                                ÿ
tion, and an occasional (not too many) complaints are           welcome
uthor:
                                                               ÿ
                                                                  Kaiser
nte Information Technology                                        25 N.
e Ave.                                                            Walnut
, CA 94598                                                          e-ma
nel.b.dyck@kp.org                                                   
©\INMR06

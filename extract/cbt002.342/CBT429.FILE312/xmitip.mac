Œ\INMR01








ES 


	±
Y  
?

ES2

R02





  
ÿÿÿÿÿÿÿÿ



                                        //* TCP/IP for MVS
                                        /ÿ
              ÿ
                                            //*        5655-HAL (C) Copy
M Corp. 1989, 1994.                         //*        Allÿ
                             ÿ
estricted Rights -                              //*        Use, duplicat
isclosure restricted                            //*        by GSA ADP Sc
 Contract with IBM Corp.                    ÿ
 Instructions                                       //*
                                                    //* Change Activity:
            ÿ
RTPMCL: Added "NOSPIE" to PARMS list.     @P1A          //*
                                                        //* Turn on SMSG
                             ÿ
                                                            //SETSMSG EX
ETSMSG,PARM=ON                                              //SYSPRINT D
=*                                            ÿ
UT=*     ÿ
MMY                                                             //*
                                                               ÿ
C PGM=MVPMAIN,          ÿ
   PARM='&MODULE,PARM=&DEBUG,ERRFILE(&SYSERR),&PARMS',              //
   REGION=6144K,TIME=1440                                           //ST
ÿ
MP DD SYSOUT=*                       ÿ

     SYSPRINT pointÿ
       internal calls to IDCAMS.  It can be a temporÿ
*
SYSPRINT DD SYSOUT=*                ÿ
//*                                                                ÿ
  //*        SYSERR contains runtime diagnostics from Pascal.  It can be
  //*        a data set or SYSOUT.                   ÿ
    //*
  ÿ
      //*                                                             +
        //*        SYSDEBUG receives output that is generated when tÿ
          //*    ÿ
            //*        a data set or SYSOUT.
            //*
     ÿ
                //*
                //*        OUTPUT contains the startup and shutdown mess
m SMTP.         //*   ÿ
                    //*
                    //OUTPUT   DD SYSOUT=*
                    //*                ÿ
                        //*        LOGFILE receives output that is gener
n the LOG               //*        configuration statement is specified
  It can be             //*        a data set or SYSOUT.ÿ
                            //*
                            //*        LOGFILE routed to OPSMVS via gene
set interface               //*        for automation purposes. OPSMAIN
e started fiÿ
                                //*
                                //*LOGFILE  DD SYSOUT=*
          ÿ
                                    //*
                                    //*        SMTPNJE is the output of
NJE command.               ÿ
d use the SMTPNJE command               //*        to create the data se
en you can remove the                   //*        "*" from the followin
o activate SMTPNJE.                     //* ÿ
                                            //SMTPNJE  ÿ
PRO.SMTPNJE.HOSTINFO                          //*
                                              //*        CONFIGÿ
mple configuration data set.                    //*        Before runnÿ
 you should modify this file to                   //*        include par
suitable for your installation.                   //*        Refer to th
ÿ
ion aÿ
                                                      //CONFIG   DD DISP
=SYS1.TCPPARMS(SMÿ
                    ÿ
ints to your SMTP security table data set.                //*        If
running with the SECURE option, th+
ain a list of NJE users who are ÿ
he gateway.  Refer to the Chapter "Configuring the              //*
Server" in the Customization and Administration Guide.          //*
ust remove the "*" from the following line to allÿÿ
MTP to find the data set.                                           //*
                                                                    //*S
DD DSN=SMTP.SMTP.SECTABLE,DISP=SHR                               ÿ

   SMTPRULE points to the data set containing the rewrite rules
   for the header addresses. You must specify REWRITE822HEADER
ÿ
       "Configuring the SMTP Server" in the Customization and
       Administration Guide.  You must remove the "*" from the
       followinÿ
//*
//SMTPRULE DD DISP=SHR,DSN=SYS1.TCPPARMS(SMTPRULE)
//*                           ÿ
    //*        SYSTCPD explicitly identifies which data set is to be
    //*        used to obtain the parameters defined by TCPIP.DATA.
    //*        The SYSTCPD DD statement shoulÿ
        //*        procedure or in the JCL of any client or server execu
        //*        as a background task. The data set can be any sequent
        //*        data set or a member of a partitioned datÿ
            //*
            //*        For more information please see "Understanding TC
a           //*        Set Names" in the Customization and Administratio
e.        w     //*
                  //SYSTCPD  DD DISP=SHR,DSN=SYS1.TCPPARMS(TCPDATA)
                  {
                                              /*
        ÿ
                                        00030000*ÿ
                                          00040000* Description: OPSMVS
rule to process EZA54 pÿ
SMTP server                                 00060000*             ÿ
                                              00060000* Author: Paul Wel
                                      ÿ
g (UK) Ltd                                      00080000*         Imperi
   ÿ
ve                                                000ÿ
ne                                                  00080000*         HA
                    ÿ
x                                                     00080000*     ÿ
W                                                       00080000*
                                     ÿ
8515 5224                                                 00080000* Emai
welÿ
                                                      ÿ
                                                              00160000*
                  ÿ
                                                                0018000ÿ
4 prefixed messages from the MVS SMTP server are processed to     001900
d a notify for the TSO user when ÿ
 using OPSMVS global variables to track the internal SMTP note      0021
mber, thÿ
of the sender. e.g.                             ÿ
*
*  SE '12:59:32 2000/02/2ÿ
00*  ',LOGON,USER=(DT6)                                        ÿ
0000*
0000* Installation                        ÿ
500000* ------------
00510000*
00520000* The JCL of MVS SMTP server must be modified to roÿ
  00530000* to OPSMVS via the generic dataset interface. .e.g.
  00540000*  +
    0115000ÿ
        01150000*
          01150000* In the above example OPSS is the OPSMVS subsystem, O
 the      01150000* triggeÿ
for         01150000* messages in the OPSLOG, and SMTP is the report id
e to        0ÿ
              01150000*                  ÿ
                01150000* This member should be enabled and auto-enabled
PSMVS           01150000* ruleÿ
                  01150000*/                            ÿ
                            )PROC
                                               ÿ
                               if MSG.REPORTID ^= "SMTP" then return /*ÿ
ing messages via
c dataset interface                                             ÿ
 */                                lclnode = opsinfo("ORIGINNODE")
l JES ÿ
                                     dtout = left(dt,4)"/"substr(dt,5,2)
(ÿ
base stem for gvars *ÿ
                                         select
                  ÿ
                                    ÿ
d Note 00000002 via BSMTP From <SMPH        OLD@SPRO.ladbrokes.co.uk> 12
*/                                 ÿ
o                                                  ÿ
                                                     noteno = word(MSG.T
       /* note number */                            ÿ
ilfrom"  /* gvar name */                               emailfrom =ÿ
late(word(MSG.TEXT,10)," ","<>"))
           /* strip chevrons */                          rtvl = opsvaÿ
"U",emailfrom) /* update gvar */
 ÿ

      ÿ
:06:22 Received ÿ
uk:paul.wells@ladbrokes.co.uk> 622 Bytes*/                     when MSG.
A5475I" then do        ÿ
                               +
rd(MSG.TEXT,6)         /* notÿ
em"."noteno".emailfrom"  /* gvar name */  +
om = strip(translate(word(MSG.TEXT,11),"ÿ
                             /* strip chevroÿ
abbrev(emailfrom,"@") & pos(":",emailfrom) > 0 then ,
rse var emailfrom ":" emailfrom                          ÿ
                                 /* strip domain name */   ÿ
 rtvl = opsvalue(gvar,"U",emailfrom) /* update gvar */

 end

/*EZA5476I 02/17/00 16:06:26 Delivered Note 00000005 to DT6 at A09JES2*/
   when MSGÿ
         ÿ
         noteno = word(MSG.TEXT,6)         /* note number */
         gvar = stem"."notenÿ
           emailfrom = oÿ
             if emailfrom = gvar then emailfrom = "unknown"
                                             ÿ
                                       ÿ
                 tsouser = word(MSG.TEXT,8)        /* get TSO userid */
                 mailnode = word(MSG.TEXT,10)      /* get mailÿ
                                                      ÿ
                     if mailnode = lclnode then do     /* local node ? *


                           if length(cmdtext) > 99 then cmdtext = left(c
9)                                                         /* ensure max
mand            ÿ
ded ÿ
                               "SE '"cmdtext"',LOGON,USER=("tsouser")" /
TSO send */                      ÿ
                   ÿ

                                 rtvl = opsvalue(gÿ
r */                              ÿ
                                   end
                                                                   ÿ
                                     otherwise NO+
nore other messages */                         ÿ
                                       end
      +
    ÿ


                                             {
                                 {
 /*
                                                                    USAG
INSTALL IS TO UPDATE PROGXX                                   ÿ
TEMENT:                                                               EX
XITNAME(IEFDB401) MODNAME(KFHDB401)
                                                                      NO
==========================
GE THE MODULE NAME FROM KFHDB401 TO SOMETHING
 APPROPRIATE FOR YOUR SITE
 UNIVERSITY ÿ
ANGE THE FMID TO MATCH YOUR CURRENT JES2 RELEASE
VEL.  THERE ARE JES2 MACRO DEPENDENCIES.
ANGE THE USERMOD FROM SJ001ÿ
CONFORMS TO YOUR LOCAL INSTALLATION STANDARDS.

                                          ÿ
38) FMID (HJE6605).                                                    +
                                                                       /
  EXEC PGM=IEWL,                                         ÿ
    PARM=(LET,LIST,NCAL,RENT,
    'AMODE=31','RMODE=ANY','AC=1')
OD   DD DSN=SYS1.LINKLIB,DISP=SHR
PUNCH  DD DSN=*.ASM01.SYSPUNCH,DISP=(SHR,PASS)
LIN    DD *
LUDE SYSPUNCH(KFHDB401)
E    KFÿ

RC(KFHDB401) DISTLIB(SAMPLIB)  .
DB401 TITLE 'DYNAMIC Aÿ
FHDB401 AMODE 31
FHDB401 RMODE ANY
        SPACE 10                     ÿ
 ***********************************************************************
 * SEE THE OS/390 MVS INSTALLATION EXITS FOR MORE INFORMATION ON CODING
 * AND USING IEFDB401.                              ÿ
   *
   * R1 POINTS TO PARAMETER LIST
   *                                                               +
     *    +00 POINTER TO SVC 99 PARAMETER LIST                   ÿ
       *    +04 POINTER TO ADDRESS OF WORKAREA (APPENDED TO SVC 99 PARM
       *    +08 POINTER TO WORKAREA LENGTH
       *    +0C POINTER TO JOBNAME
ÿ
         *    +14 POINTER TO JOB ACCOUNTING INFORMATION
         *    +18 POINTER TO STEP NAME
         *    +ÿ
           *    +20 POINTER TO EXEC CARD ACCOUNTING INFORMATION.
           *
           * WARNING:  THIS ROÿ
             *    NO OPERATING SYSTEM CALLS ARE ALLOWED.
             *    A SECTION OF THE THE SMTP PROCESSING CODE DOES USE A
NER          *    SAVE AREA IN THE WORKAREA Pÿ
  NER          *
               * FUNCTION:
  NER          *     DYNAMIC ALLOCATION EXIT                ÿ
    NER          *     FOR PGM=MVPMAIN (SMTP MAIL TASK), THE EXIT CHECKS
    NER          *         ALLOCATIONS WITH A DESTINATION NODE MATCHING
    NER          *         JES NODE (FOR THE PRIMARY JES2 SUBSYSTEM) AND
      LBD          *         USERID, THEN SENDS AN SMTP MAIL TSO NOTIFY
      NER          *         TO THE USERID VIA SVC 34.
      LBD          *     ** THE DSNUTILB IS NOT USED AT KAISER AND IS CO
OUT   LBD ÿ
        NER          *         JCL TAPE "DEFER" KEYWORD TO ALLOW TMS MOU
GES     NER          *         TO BE DISPLAYED FOR DYNAMIC TAPE ALLOCATI
        NER          *   ÿ
          NER          * INSTALLATION:
          NER          *    TO USE EXIT FACILITY IN SYS1.PARMLIB(PROGXX)
E LINE:   NER          *     EXIT ADD EXÿ
01)         LBD          *
            NER          *    LINK AS RENT, REUS, AC(1) INTO A LINKLIST
            LBD          *                             ÿ
              NER          * TESTING:
              NER          *    TO TEST USING DYNAMIC EXIT FACILTY:
              NER          *     SETPROG EXIT,DELETE,EX=IEFDB401,MOD=Kÿ
                LBD          *     SETPROG EXIT,ADD,EX=IEFDB401,MOD=KFHD
=SYS2.LINKLIB   LBD          *
                NER          * MODIFICATIONS:
     +
   ÿ
                    LBD          *     - COMMENT PROGRAM NAME DSNUTILB A
E DEFER CODE        LBD          *     - ADD CODE TO DYNAMICALLY PICK UP
E (JES2 ONLY) **  ÿ
VED FROM.             LBD          *   12/07/99
                      NER          *     ADD CODE TO SEND TSO NOTIFY MES
 SMTP MAIL DELIVERY   NER        ÿ
****************************         * THIS ROUTINE DEVELOPED AT THE UNI
OF FLORIDA NORTHEAST       *         * REGIONAL DATA CENTER (NERDC) AND
 BY KAISER PERMANENTE      *         * INFORMATIÿ
ACCOMPANIES THIS CODE.       *         *********************************
******************************                  SPACE 1
                                       KFHDB401 CSECT          ÿ
                                                  SPACE 1
                                                  STM   R14,R12,12(R13)
                                                  LR    R12,R15
                                                    USING KFHDB401,R12
                                                    SPACE 1
                                                    L     R9,0(,R1)
C 99 REQUEST ÿ
                                                      SPACE 1
                                                      CLI   S99VERB,S99V
ALLOCATION REQUEST?         ÿ
  YES, PROCESS IT                                       SPACE 1
                                               RETURN0  SR    R15,R15
  CLEAR RETURN CODE                        ÿ
                                                 RETURN   L     R14,12(,
    RESTORE                                               LM    R0,R12,2
      CALLER'S REGS                                       ÿ
          AND RETURN                                        EJECT
                                                   ISALLOC  L     R2,X'1
      POINTER TO PROGRAM NAME                               LA    R15,PG
12      POINT TO LIST OF PROGRAM NAMES                        SPACE 1
                                                     TSTPGMLP LA    R15,
        BUMP TO NEXT PGM NAME                                 CLI   0(R1
        ÿ
          YES, SKIP ALL THIS                                    CLC   0(
(R2)      MATCH?                                                BNE   TS
          ELSE CONTINUE+
5)         LOAD POINTÿ
             AND GO THERE                     LBD          *
                                                           *        SMTP
ING ROUTINE                         ÿ
                                                NER                   SP
                                                NER          DOSMTP   L
4(,R1)          LOAD DB401 WORKAREA PTR         NERÿ
0,0(,R10)         LOAD DB401 WORKAREA ADDR        NER
RKAREA,R10        SET WORKAREA ADDRESSING         NER
5,8(,R1)          LOAD DB401 WORKAREA LENGTH      NER             ÿ
R15,=A(WORKLEN)     CHECK LENGTH OF WORKAREA        NER
RETURN0             INSUFFICIENT WORKAREA, RETURN   NER
1                                                   NER
Nÿ
  USERID,=CL8' '      INIT USERID                     NER
E 1                                                   NER
  R8,S99TXTPP   ÿ
ING S99TUPL,R8          SET ADDRESSING TO TUPL          NER
ACE 1                                                   NER          CKD
    R7,S99TUPTR         GET TEXÿ
USING S99TUNIT,R7         SET TEXT UNIT ADDRESSING        NER
LA    R7,0(,R7)           CLEAR HIGH ORDER LAST TU BIT    NER
LTR   R7,R7               CHECK FOR EMPTY TU  ÿ
  BZ    CKDLPE              EMPTY TU, SKIP CHECK            NER
  CLC   S99TUNUM,=H'1'      CHECK UNIT COUNT                NER
  BNE   CKDLPE              NOT 1, CHECK NEXT TEXT UNIT     Nÿ
    LH    R15,S99TULNG        LOAD TEXT UNIT LENGTH           NER
    CH    R15,=H'1'           CHECK CHECK UNIT LENGTH         NER
    BL    CKDLPE              LENGTH INVALID, CHECK NEXT TU   NER
      CH    R15,=H'8'           CHECK TEXT UNIT LENGTH          NER
      BH    CKDLPE              LENGTH TOO HIGH, CHECK NEXT TU  NER
      BCTR  R15,0               DECREMENT LENGTH FOR EX         NER
      CLC  ÿ
        BNE   CKU                 NOT NODE, CHECK USERID          NER
        B     *+10                SKIP EX                         NER
        MVC   NODE(*-*),S9ÿ
          EX    R15,*-6             SET NODE                        NER
          B     CKDLPE              CHECK NEXT TEXT UNIT            NER
 CKU      CLC   S99TUKEY,=AL2(DALUSRID)  +
            BNE   CKDLPE              Nÿ
              B     *+10                SKIP EX
              MVC   USERID(*-*),S99TUPAR EX
              EX    R15,*-6             SET USERID    ÿ
                CLI   USERID+7,C' '       CHECK USERID LENGTH
                BNE   RETURN0             USERID TOO LONG FOR SEND, EXIT
                SPACE 1                                              ÿ
         CKDLPE   TM    S99TUPTR,S99TUPLN   CHECK FOR LAST TEXT UNIT
                  BO    CKDEST              LAST TEXT UNIT, CHECK DEST
                  LA    R8,4(,R8)           POINT TO NEXT TEXT UNIT
    ÿ
R                   SPACE 1
R          CKDEST   CLC   NODE,=CL8' '        CHECK FOR NO NODE
R                  ÿ
NER          *----------------------------------------------------------
LBD                   L     R6,CVTPTR           -> CVT
LBD                   USING CVT,R6ÿ
  LBD                   L     R6,CVTJESCT         -> JESCT
  LBD                   DROP  R6
                        USING JESCT,R6           ÿ
    LBD                   L     R6,JESSSCT          -> SSCT FOR JES2 (PR
N)  LBD                   DROP  R6
    LBD                   USING SSCT,R6                         ÿ
      LBD                   L     R6,SSCTSUS2
      LBD                   DROP  R6
      LBD                   USING HCCT,R6

ODE     LBD                   DROP  R6
        LBD          *--------------------------------------------------
------- LBD   ÿ
N         NER          CKUSR    CLC   USERID,=CL8' '      CHECK USERID
          NER                   BE    RETURN0             NO USERID, RET
          NER                ÿ
            NER                   MVC   MSG(MSGLN),MSGL     SET MESSAGE
            NER                   MVC   MSG+67(8),USERID    SET USERID I
SG          NER                   LA    R14,ÿ
ERID          NER          EUSRLP   CLI   0(R14),C' '         CHECK FOR
SERID         NER                   BE    EUUSR               BLANK, MUS
              NER                   LA    R14,1(R14)       +
XT CHAR         NER                   B     EUSRLP       ÿ
R                 NER          EUUSR    MVI   0(R14),C')'         CLOSE
ND USERID         NER                   L     R14,12(,R1)         LOAD D
NAME PTR          NER                   MVC   MSG+45(8),0(R14)    SET SM
NAME IN SEND MSG    NER                   SPACE 1
                    NER                   LR    R1,R13              COPY
E AREA ADDR         NER                   LA    R13,SAVEAREA        LOAD
 NEW SAÿ
AVE AREA ADDR IN NEW  NER                   ST    R13,8(,R1)          SA
AVE AREA ADDR IN OLD  NER                   SPACE 1
                      ÿ
E AND DATE              NER                   TIME  DEC,TMEDTE,ZONE=LT,D
MMDDYYYY,LINKAGE=SYSTEM,    +                       MF=(E,TIME)
                        NER          ÿ
T TIME TO EBCDIC          NER                   MVC   MSG+8(2),TDWORK
ME HH IN SEND MSG         NER                   MVC   MSG+11(2),TDWORK+2
ME MM IN SEND MSG         NER                   MVC ÿ
TIME SS IN SEND MSG         NER                   UNPK  TDWORK,DTE(5)
ERT DATE TO EBCDIC          NER                   MVC   MSG+17(2),TDWORK
DATE MONTH IN SEND MSG      NER                   MVC   MSG+20(2),Tÿ
T DATE DAY IN SEND MSG        NER                   MVC   MSG+23(2),TDWO
T DATE YEAR IN SEND MSG       NER                   SPACE 1
                              NER                   MODESET KEY=ZERO
T ÿ
SETUP FOR SEND                  NER                   LA    R1,MSG
POINT TO SEND MSG               NER                   SVC   34
ISSUE THE SEND COÿ
  SET PROBLEM KEY                 NER                   SPACE 1
                                  NER                   L     R13,SAVEAR
  LOAD ADDR OF OLD SAVE AREA    ÿ
    EXIT                            NER                   SPACE 5
                                    NER          CHKDEFER DS    0H
                                    NER        ÿ
                                                   *
                                                   *        NOW WE THINK
IS IS ONE OF THE PROGRAMS THAT HAS                 *        BEÿ
 ALLOCATION OF TAPE DRIVES WITHOUT                   *        SPECIFYING
.                                                    *
                                                              SPACE 1
                                                                L     R1
1)          ADDRESS OF WORKAREA                                   L
10)         WORKAREA                                              SPACE
                                                                  L
TPP       ÿ
L,R8                                                                SPAC
                                                                    S
4'            BACK UP POIÿ
                                                             TESTPTR  LA
(,R8)           BUMP TO NEXT TU POINTER                               TM
UPTR,X'80'      LAST TEXT UNIT POINTER? ÿ
STPTR             NO, KEEP LOOKING

5,4(,R8)          SHOULD POINT TO WORK AREA            ÿ
R15,R10             SHOULD MATCH
SETDEFER            YES,
1                                                                     ÿ
  X'00DEAD01'         OOPS
E 1                                                                SETDE
  S99TUPTR,255-X'80'  CLEAR LAST FLAG
  R8,ÿ
    R10,4(,R10)         BUMP FOR TEXT UNIT AREA
    R10,S99TUPTR        SET IN LIST
    S99TUPTR,X'80'  ÿ
MVC   0(L'DEFERKEY,R10),DEFERKEY  SET DEFER TOKEN
SPACE 1
B     RETURN0             AND RETURÿ
  SPACE 3
  DS    0D
  DC    CL8'MVPMAIN',A(DOSMTP) SMTP ROUTINE       ÿ
    DC    CL8'DSNUTILB',A(CHKDEFER) DB2 RECOVERY UTILITY      LBD
    DC    CL8' ',A(0)         SPACE FOR MORE ENTRIES          LBD
    DC    CL8' END END',A(0)  END OF LIST                     LBDÿ
      SPACE 3
ERKY  DC    AL2(DALDEFER),AL2(0,0)
ERKEY EQU   DEFERKY,*-DEFERKY
ÿ
        DS    0F                  SVC 34 SEND COMMAND MODEL       NER
SGL     WTO   'SE ''HH.MM.SS MM/DD/YY MAIL RECEIVED FROM JOBNAMEJ'',LO+
              G+
          SPAÿ
            LTORG ,
            EJECT
            SPACE 10        ÿ
     *  WORKAREA
     WORKAREA DSECT ,                   DB401 WORKAREA
     SAVEAREA DS    18F                 SAVÿ
                SPACE ,
       NODE     DS    CL8                 SMTP MAIL FILE DEST NODE
       USERID   DS    CL8                 SMTP MAIL FILE Dÿ
                  SPACE ,
         TMEDTE   DS    0XL16               TIME AND DATE FROM SYSTEM
         TME      DS    XL8                 TIME (HHMMSSTHMIJU)
R          DTE      DS    XL4                 DATE (MMDDYYYY)
R                   DS    XL4                 (RESERVED)
R                   SPACE ,
R       ÿ
NER                   SPACE ,
NER          TIME     TIME  LINKAGE=SYSTEM,MF=L
NER                   Sÿ
  NER                   DS    0F                  SVC 34 SEND COMMAND
  NER          MSG      WTO   'SE ''HH.MM.SS MM/DD/YY MAIL RECEIVED FROM
J'',LO+                       GON,USERÿ
R                MSGLN    EQU   *-MSG
    NER                   SPACE ,
    NER          WORKLEN  EQU   *-WORKAREA          Wÿ
      NER                   SPACE 10
      NER          *  MAPPING MACROS
      NER                   SPACE 1                                 ÿ
        NER                   IEFZB4D0 ,
                              EJECT
                              IEFZB4D2 ,
   ÿ
                                CVT   DSECT=YES
                                EJECT
                  ÿ
                                  EJECT
                                  IEFJSCVT
                                 +
                               ÿ
                                      EJECT
                                      $HCCT
                                      EJECT   ÿ
                                        $HFAME
                                        EJECT
                                        $SCAT                ÿ
                                          EJECT
                                          $XECB
                                          SPACE 3
                                            END   KFHDB401
                                   {
exx exec is expected to be invoked by the EXEC command

dsname(RECEIVE)'                                                ÿ
it will then issue the TSO RECEIVE command for the
 and PANELS members to create 2 new datasets:
id.XMITIP.NEW.EXEC and

erid.XMITIP.NEW.NOTIFY
u will then need to copy these datasets/members into
tasets for proÿ
*/

se source with x1 x2 x3 dsn .ÿ
x = PROMPT("ON") /* enable prompting */
ueue "dsn(XMITIP.new.exec)"
Receive inds('"dsn"(exec)')"                ÿ
 queue "dsn(XMITIP.new.panels)"
 "Receive inds('"dsn"(panels)')"
 queue "dsn(XMITIP.new.notify)"                            ÿ
   "Receive inds('"dsn"(notify)')"
   if sysvar('sysispf') <> "ACTIVE" then exit
   Address ISPEXEC
        "Browse dataset('"dsn"(changes)')"
        "Browse dataset('"dsn"($doc)')"

ification              process for the XMITIP application.
                       
ASA carriage control conversion                   of the XMITIP applicat
                                                  This line should be si
ced                                               ÿ
paced                                              0This line should be
paced                                               This line should be
paced                                              0This line shoÿ
 spaced                                               This line should b
 spaced                                               This line should b
 spaced                                               This line should b
ÿ
le spaced                                               This line should
le spaced                                              -This line should
le spaced      ÿ
ngle spaced                                               And this line
ave the next line with -'s inserted                      +--------------
------------------------------ÿ
new page                                                    This line sh
single spaced                                               This line sh
single spaced                                ÿ
e double spaced                                               This line
e single spaced                                              0This line
e double spaced                                             ÿ
 be single spaced                                               This lin
 be single spaced                                               This lin
 be single spaced                                              -This lin
ld be triple spaced                                               This l
ld be single spaced                                              -This l
ld be triple spaced                                               This l
ld be singV le spaced                                               And
e should have the next line with -'s inserted                      +----
---------------------------------------------                      
ç
             To address1@node
             Cc address2@node
             C[ c address3@node
               BCc address4@node
               
TIFY=&SYSUID,                            //        RESTART=*,   (or IVP#
                                         //        MSGLEVEL=(1,1),MSGCLA
SS=A                                     /ÿ
,OUTDISP=(HOLD,HOLD)                       //* -------------------------
------------------------ *                 //* This job is an IVP for th
 package.  Please        *                 //* report anyÿ
tions to the author.       *                 //*
                           *                 //* Change the RESTART in t
ard to restart at any      *                 //* specific step if you wa
rerun.                       *                 //*
                             *                 //* To use:
                             *                 //*    - change the job c
your inÿ
if required at your shop       *                 //*    - change the //S
sname for the exec library     *                 //*      c rexx.lib hlq
new.exec all          ÿ
sname                            *                 //*      c install.pd
itip.pds all                     *                 //*    - change the e
dress to your own                *   ÿ
ss your.real@address all           *                 //*    - update the
r step IVP0                        *                 //*    - if you don
ISPZIP or PKZIP/MVS then           *                ÿ
 and IVP8                            *                 //*    - update m
PADDR to valid addresses             *                 //*
                                     *                 //* Step    ÿ
                                       *                 //* IVP0
to author                              *                 //* IVP1
essage                                 *                 //* IVP2
anÿ
e and a file with ASA                    *                 //* IVP4
e and multiple files                     *                 //* IVP5
e and rtf, html aÿ
 as 5 but with filedd                      *                 //* IVP7
 ZIP attachment - based on IVP5            *                 //* IVP8
 ZIP attachment - based on IVP6 ÿ
st address list                              *                 //* IVPA
st ziprtf, pdf, and zippdf attachments       *                 //* IVPZ
n TESTCU exec                                * +
                                             ÿ
------------------------------------------------ *                 //* I
ve other IVP's to suggest let me know            *                 //* -
------------------------------------------------ *          ÿ
PROC                                                                 //T
 PGM=IKJEFT01                                                        //S
 DD  DISP=SHR,DSN=rexx.lib                                           //S
T  DD  SYSOUT=*,OUTPUT=*.HOLD                                          /
   DD  DDNAME=SYSIN                                                    /
                                                                       /
EXEC BATCHÿ
  DD *
has been successfully installed at (insert your company name)
ert your name).          ÿ

ld like to be on the notification list for update (yes or no) ___
ld like to beta test updates (yes or no)ÿ

YSIN  DD *
itip lionel.b.dyck@kp.org subject 'XMITIP Installed' - ÿ
  from your.email@address -
  msgdd indd
*                                                                     ÿ
 //IVP1   EXEC BATCHTMP
 //SYSIN  DD *
 %xmitip your.email@address subject 'test message' -
    mÿ
   /*
   //IVP2   EXEC BATCHTMP
   //SYSIN  DD *    ÿ
     %xmitip your.email@address subject 'test message w/file' -
        from your.email@address -
        msgds 'install.pds(ivpmsg)'ÿ
          file  'install.pds($doc)'
       /*
       //IVP3   EXEC BATCHTMP                     ÿ
         //SYSIN  DD *
         %xmitip your.email@address subject 'test message w/file' -
            from your.email@address -                            +
              msgds 'install.pds(ivpmsg)' -                    ÿ
                file  'install.pds(ivpasa)' asa
             /*
             //IVP4   EXEC BATCHTMP
               //SYSIN  DD *
               %xmitip your.email@address -
                  subject 'test message with multiple files' -
             ÿ
                    msgds 'install.pds(ivpmsg)' -
                    file  ('install.pds($doc)' -
                           'ÿ
                   /*
                   //IVP5   EXEC BATCHTMP
                   //SYSIN  DD *           ÿ
                     %xmitip your.email@address -
                        subject 'test message with multiple files - rtf,
ext' -                  from your.email@address -         ÿ
                          msgds 'install.pds(ivpmsg)' -
                          file  ('install.pds($doc)' -
                                 'install.pds($doc)' -
                                   'install.pds($doc)') -
                            format (rtf/p/9/let html/white-blu txt)
                         /*
        ÿ
                           //DD1    DD DISP=SHR,DSN=install.pds($DOC)
                           //DD2    DD DISP=SHR,DSN=install.pds($DOC)
                       ÿ
                             //SYSIN  DD *
                             %xmitip your.email@address -
                                subjecÿ
f, html, text' -                  from your.email@address -
                                  msgds 'install.pds(ivpmsg)' -
                                  filedd (dd1 dd2 dd3ÿ
                                    format (rtf/p/9/let html/white-blu t
                                 /*
                                 //IVP7   EXEC BATCHTMP             ÿ
                                   //SYSIN  DD *
                                   %xmitip your.email@address -
                                      subject 'test message with multipl
- r+
 ÿ
                                          file  ('install.pds($doc)' -
                                                 'install.pds($doc)' -
                ÿ
                                            format (ziprtf/$doc.rtf/p/9/
tml/$doc.html/white-blu zip) -              filename (testrtf.zip testht
esttxt.zip)                    ÿ
                                           //IVP8   EXEC BATCHTMP
                                           //DD1    DD DISP=SHR,DSN=inst
$DOC)                                      //Dÿ
s($DOC)                                      //DD3    DD DISP=SHR,DSN=in
s($DOC)                                      //SYSIN  DD *
                                             %xmitip your.emaÿ
                                                  subject 'test message
tiple files - rtf, html, text' -                  from your.email@addres
                                                  msgds 'install.pds(ivp
-                                                   filedd (dd1 dd2 dd3)
                                                    format (ziprtf/$doc.
let ziphtml/$doc.html/white-blu zip) -              filename (testrtf.zi
ml.zip testÿ
                                                   //IVP9   EXEC BATCHTM
                                                   //SYSIN  DD *
                          ÿ
                                                        subject 'test ad
st' -                                                   addressfile 'ins
(ivpaddr)' -                             ÿ
s -                                                       msgds 'install
msg)'                                                  /*
                                                       /ÿ
                                                         //DD1    DD DIS
N=install.pds($DOC)                                      //DD2    DD DIS
N=install.pds($DOC)                                      //DD3    DD DIÿ
DSN=install.pds($DOC)                                      //SYSIN  DD *
                                                           %xmitip your.
dress -                                                       subject 't
age wiÿ
address -                                                       msgds 'i
ds(ivpmsg)' -                                                   filedd (
dd3) -               +
/$doc.rtf/p/9/let pÿ
df/$doc.pdf/land/10/let/8) -                                        file
strtf.zip testpdf.pdf testpdf.zip)                               /*
                                  ÿ
 BATCHTMP                                                          //SYS
                                                                   %test
                                                 Û                   /*
                                                                     {


                   APAR Identifier ...... PQ36249      Last Changed ....
07/11             ÿ
GES.

                     Symptom ....ÿ
OSED  UR1              Severity ................... 4      Date Closed .
 00/07/07              Component .......... 5655HAL00      Duplicate of
                       Reported Release ........ÿ
....... 999              Component Name TCP/IP V3 MVS        Special Not
  ATTENTION              Current Target Date ..00/07/31      Flags
                         SCP ...................               ÿ
W FUNCTION                 Platform ............

                           Status Detail: PACKAGING - Solution is being
ed for                                                  shipment.

                             PE PTF List:
             ÿ
                               PTF List:
                               Release 350   : PTF not available yet
                            ÿ
                                 Release 380   : PTF not available yet
                                 Release 50A   : PTF not available yet
                                           ÿ

                                   Parent APAR:
                                   Child APAR list: PQ3977ÿ


                                     ERROR DESCRIPTION:
                                       The current design of SMTP does N
rt a translate @                       character which is documented as
l character in the SMTP                RFCs. Some languages need this tr
n capabiÿ
dish codepage is unable                  to use SMTP. The @ character th
ed throughout SMTP as a                  part of internet addressing is
d to x'7C', due to     +
 it there. In other  ÿ
d to other values, and mail                  traffic addresses will not
preted correctly. Therefore,                 SMTP will not correctly pro
resses if it is running on a        ÿ
oes not map @ to x'7C'.

                                                   ÿ
                                                 LOCAL FIX:

                                                                  ÿ
                                                   PROBLEM SUMMARY:
                                                   *********************
***********************************                * USERS AFFECTED: All
fÿ
0 Release 6, 7, 8 and 10 IP: SMTP   *                *******************
*************************************                * PROBLEM DESCRIPTI
 hardcoded @ symÿ
mpatible with certain languages       *                *****************
***************************************                * RECOMMENDATION:
                               ÿ
*****************************************                The current des
MTP does not support a translate @                       character which
mented as a special character in the SMTP     ÿ
need this translation capability, so that                  the hexadecim
ing for the @ symbol can be something other                than x'7C'.
                                                           +-ÿ
-------------------------------------------+                 + Please ch
Communications Server for OS/390 homepages +                 + for commo
king tips and fixes.  The URL for these    +                 + homepages
e found in Informational APAR II11334.       +                 +--------
---------------------------------------------+

           ÿ
                                                                 PROBLEM
ION:
                          ÿ
                                                                   TEMPO
:
                                         +
                                       ÿ
                                                                       S
 has been modified to handle a substitution symbol for                 t
bol. This modification does NOT support installations ÿ
ke use of the RFC 822 header rewrite rules. If you make
that support, you cannot use this feature. This change
valent in function to VM APAR PN59425.                               ÿ

ional Keyword: CS390787900

olloÿ

=============================================================
390 Communications ÿ
P Configuration
ocument Number SC31-8513
                                  ÿ
 and for OS/390 Release 10 IP

 OS/390 Communications Server                    ÿ
   IP Configuration Reference
   Document Number SC31-8726
                                                                ÿ
     Chapter "Configuring the SMTP Server", Step 3 Update the System
     CLIST and PARMLIB Data Sets, under the customized variables
     in SMTPNOTE CLIST add the following:

         ATSIGN     Some foreign languages need to use a different
                    character to represent the @ symbol. This input
              ÿ
                      @ symbol in their national language codepage.

         Chapter "Configuringÿ
           Configuration Statements, add the ATSIGN statement and the
           description "Enables SMTP to replace the @ symbol used in
           addressing strings".             ÿ

             Chapter "SMTP Configuration Data Set Statements", add the
             ATSIGN Statement                              +
                                                         ÿ
                   Use the ATSIGN statement to specify that you want SMT
                   this character in the addressing strings generated by
                   This might affect your operability between sites usin
                     different code pages.

                     Syntax
       ÿ
                       >>----ATSIGN--symbol--------------------->

                      ÿ
                         symbol     The input symbol which is a single b
                                    representation of the @ symbol in th
onal                                lÿ

                           Usage Note:
                           If this statement is not ÿ
default to

                             using the @ symbol (defined as a valueÿ
                               For details on EBCDIC character set defin
ee book                        "3174 Character Set Reference", document
A27-3831.
  ÿ
ion with the                     REWRITE822HEADER statement. REWRITE822H
faults to YES,                   and you must set this to NO in your SMT
uration file if  ÿ
statement needs                    to come before the ATSIGN statement.

                                ÿ
iously, and you are                  assigning a new symbol for that sta
you need to ensure                   that all the mail has been sent. If
l exists that is                     using the ÿ
 occur.
                                       Related Topics
                                            "REWRITE822HEADER ÿ

                                       =================================
=======================
                                         OS/390 Communications Server
                                           IP Messages:
                                           Volume 1 (EZA)
                                           Document Number SC31-8517
          ÿ
                                               -------------------------
-----------------------------
                         ÿ
ol       : symbol
                                                 Explanation: The ATSIGN
nt in the hlq.SMTP.CONFIG file          ÿ
atement means that SMTP will use                   this symbol instead o
symbol between the user ID and                     host ID fields in add
strings, for example,                              userÿ
t should only be used for specific                   languages because o
ation encodings.
                                                     Setting this optiÿ
ause problems if notes are being sent                  between different
e sites. In the message text:
                                                         symbol     The
mbol ÿ
                                                         For more inform
out the ATSIGN configuration statement,                  see OS/390 Comm
ns Server: IP Configÿ
                                                           System Action
ontinues
                                   ÿ
sponse: None
                                                             System Prog
esponse: None                                     ÿ
                                                               Source Da
SMTP
                                                               Prÿ
 OpenOutputStreams
                                                                 -------
-----------------------------------------------
ÿ

                                                                   EZA53
rrect ATSIGN sy+
             ÿ
on: The input symbol replacing the @ symbol must be                    j
aracter in length. The specified input symbol is too                   l
 the message text:          ÿ

l    The input string replacing the @ symbol.
                                           ÿ
ore information about the ATSIGN configuration statement
S/390 Communications Server: IP Configuration.
                                                          ÿ
tem Action: SMTP ends.

r or Operator Response: None

ystem Programmer Response: Change the input string specified
n the ATSIGN configuration statement to one character.
estart Sÿ

 Source Data Set: SMTP
                       ÿ
   Procedure Name: ProcessConfigFile

   -----------------------------------ÿ

     EZA5345E Option conflict: the ATSIGN symbol and default
              REWRITE822HEADER table can not both be ÿ

       Explanation: The translate ATSIGN and REWRITE822HEADER cannot
       both be activated because the default REWRITE822HEADER table ÿ
         contains a hardcoded @ character that cannot be modified.
         Therefore, these options cannot be used together.

   ÿ
           OS/390 Communications Server: IP Configuration.

           System ÿ

             User or Operator Response: None
                                 +
               System Programmeÿ
                 activate in the :hlq.SMTP.CONFIG file. Restart SMTP

                 Source Data Set: SMTP        ÿ

                   Procedure Name: ProcessConfigFile
                                                             ÿ
                     ---------------------------------------------------
---                =====================================================
===

                     MODULES/MACROS:   EZAAA00H EZABB01X EZABB01Y EZABB0
004                  EZAEB01B
           ÿ

                       SRLS:      SC31872600 SC31851705 SC31851303 SC318
                       SC3ÿ


                         RTN CODES:      ÿ


                           CIRCUMVENTION:               ÿ


                             MESSAGE TO SUBMITTER:                     
                             {
he REXX Application XMITIP.  The contents are:
                                                         $DOC     what y
eading                                                   Cÿ
ed                                                         EXEC     The
c's in TSO Transmit (IDTF) format                          IEFDB401 Samp
ic allocation exit from University of Florida                       modi
y Lionel Dyck.  Will issue Notify messages to                         TS
for incoming mail.                                           NOTIFY   Fr
Wells: (in tso transmit format)                                       Th
s you toÿ
n process the logfile and issue messages to the user
coming mail.                                                   PANELS
 panels in TSO Transmitÿ
nts IBM APAR for @ support for other languages                   RECEIVE
le exec to receive the EXEC and PANELS members
artitioned datasets                   ÿ
e members are the Installation Verification members
e member IVPJOB for the job to run
                                                     ÿ
the RECEIVE member issue "TSO EXEC 'hlq.pds-dsname(RECEIVE)' EXEC"
                                                                     Loc
mizations should be made in the XMITIPCU rexx exec.                 ÿ
                                                                       Z
:                                                                      1
MVS can be found at www.asizip.com                                     2
 caÿ
nyone would like to help configure XMITIP for Infozip let me know
P/MVS pre 2.51 does not support the name-in-archive option
IP issues         ÿ
does not support ZIPPASS or ZIPMETHOD
does not support name-in-archive for pds members
resultant zip file does not work ÿ
  or Lotus Notes Viewer
If you have an issue with your language and the @ character then
check out IBM APAR PQ36249                      ÿ

omments, suggestions, and complaints should be directed to the author at
                                                               +
   Lionel B. Dyck                                            ÿ
     Kaiser Permanente Information Technology
     25 N. Via Monte Ave.
     Walnut Creek, CA 94598
       (925) 926-5332
       Internet: lionel.b.dyck@kp.org
     {
 mail to an existing             mail server within your enterprise do t
wing:
                                 1ÿ
 DD in the TCPIP started              task JCL and make a copy for use i
TP started task JCL.
                                   2. In the copyÿ
ERADDR statements.  These               statements are used to define th
 name servers that will                 be used to resolve host names.
                                                                ÿ
                                       3. In the SMTP CONFIG data add th
ERADDRESS statement.  The                 syntax is IPMAILERADDRESS xx.x
where the xx.xx.xx.xx is                  the numeric IP address of the

                                         SMTP will now forward all mail
h it is unable to resolve the            target host name to the server
in the IPMAILEÄ RADDRESS.                  
 documents the significant changes to this application
                                                                       V
8/29/2000                                                             ÿ
pi only to fix the 4.13 fix (sigh)
 08/29/2000 (GA Level)
argin statement generation in ispf dialog if only 1 pdf file
hed  ÿ
 - 08/07/2000 (GA Level)
ed zip of plain text
 subject to xmitipi ÿ
dditional minor cleanup
11 - 08/07/2000
emoved panel XMITIPXC              ÿ
 removed mention of ASA or Carriage Control option from XMITIP and from
 the ISPF dialog (will use DCB)
 fixed machine carriage control for RTF           ÿ
 V4.10 - 07/13/2000
 - update to xmitippd from leland lucius to support machine carriage
   control                                                       ÿ
   - added doc about ibm apar for @ national language support
     (nothing implemented in xmitip yet about this)
   V4.10 - 07/12/2000
ÿ
       using exec XMITIPPD provided by Leland Lucius and customized for
       XMITIP usage.
     V4.07 - 07ÿ
       - add support for Machine Carriage Control thanks to code provide
         Rich Stuemke (rstuemke@ILSOS.NET)
       V4.06 - 07/05/2000     ÿ
         - update xmitipds edit macro to prompt for to/from addresses
           and report type (text or rtf)
          - fix plain zip                    ÿ
            - allow paper or heightXwidth (e.g. 8.5x11)
            - if filename ends with .htm or html then set type=enrich
           V4.05 - 06/08/2000                               ÿ
             - fix another extraneous trace and fix a broken msgds (sigh
             V4.04 - 06/08/2000
             - remove trace statement left by accident (memory failure)
3              - delete zip work datasets if zip fails
                 V4.03 - 06/05/2000
                 - update to xmitipcu to remove test for invalid default
dress              (this will occur in xmitip if necessary)
        ÿ
 the panel           if the file attachment dsn selection is displayed
                   - update to xmitip to enable debug mode with msgds of
not                  reÿ
                     V4.02 - 06/01/2000
                     - fix a font size of x.x in rtf conversions
                     - update TESTCU tÿ
                       V4.01 - 05/30/2000 (released level)
                       - update to xmitipzp to test for negative rc afte
                       - support size_limit of 0 (in ÿ
                         - update xmitip to support temp d/s in addressf
                         - update xmitip to correct a bug with RTF conve
or ASA                     attachments with the very first line of tÿ
age                        V4.00 - 05/18/2000
                           - update to xmitipzp to add zip rc to error m
                           V4.00 - 05/11/2000
   ÿ
and no new reported)         - add IVP job and fixed problems that this
lighted                      - include TESTCU from Dana Mitchell to disp
XMITIPCU values   ÿ
s a verification step.         V4.00 - 04/26/2000
                               - major revision to support ZIP'ing attac
                                 ÿ
ML                                   to cause the file or converted file
tml)                                 to be zip'd after conversion and th
hed                                  in binary. ÿ
oduct                                  and library be defined in xmitipc
                                   - support for ISPZIP along with PKZIP
                                   - several updates to xmitipcÿ
erlink and zip.                      - *** Redo the File Attachment Tabl
*******                                - the table will be dynamically c
 but some                                information will be lost during
onversion.                                 Specficically the REPORT (sty
, paper)                                   information.
                                       - support for Interlink TCPAccess
             +
           ÿ
 that function                               from the FILEDESC keyword
                                             - will dynamically convert
 FILEDESC usage           ÿ
                                             - if a FILENAME is not code
attachment dsn is                              dsname(member) then the a
t name will be                           ÿ
ppropriate to the                                attachment type.
                                               - add size limit (in xmit
d test in xmitip                               - lntegraÿ
land Lucius for converting                         during the HTML conve
e characters <>&" into                             &lt; &gt; &amp; and &
 that they will display                            properly.           ÿ
                                                   - replace the REPORT
with FORMAT keyword                                  - will dynamically
existing REPORT to FORMAT                              and tell the user
he chaÿ
IP encryption password                               - some additional m
anup                                                 V3.14 - 04/05/2000
                     ÿ
                                                         - this was bein
ted by update in 3.10 to prevent multiple @            V3.13 - 03/31/200
                                    ÿ
ell as MSGDS of *@... to enable debug                    - in xmitipi fi
ing replaced by cc                                       - in xmitip all
 of 'list id' or "list id" to be used              ÿ
 not an address                                            V3.12 - 03/29
                                                           - add &TIME a
ial keyword in Subject.                                    V3.11 -ÿ
                                                             - addition
r NOTIFY from Paul Wells.  This allows you to                  route the
gfile to OPS/MVS which will then process the                   logfile a
 ÿ
ber IEFDB401 from University of Florida (NERDC)                  which h
modified by Lionel Dyck (thus blame me if it                     doesn't
 This is a dynamÿ
ification messages for incoming mail.                            V3.10 -
000                                                              - added
evel help to the ispf dialog   +
efault setup to xmitipcu     ÿ
n for append_domain if user enters address without                     a
.  set in xmitipcu and only used if non-null                         - c
ledesc to allow file-name/file-desc         ÿ
to only honor columns 1-72 for addressfile and
filedd                                                                 -
 bug fixes                                                 ÿ
ional validation test for multiple @ in address
upport for &DATE, &DATE-n, &DAY, and &DAY-n
port multiple &date and/or &day in subject
 scrname to xmitip and xmitipi select cmd.
hange to File Attachment Processing**
f the style contains a period then the style will be assumed
o be a fiÿ
 attachment.
 the file attachment table now retains all referenced
 files                  ÿ
 - this is now a selection table - only those files selected
   will be sent this session
 - if the table is in the old format itÿ
     converted to the new format
   - change to force no Text-Enter when editing the *create*
   - added the example GET Edit Macro                 ÿ
     - add test for file attachment table to insure at least one
       file is selected
   V3.03 - 01/17/2000                                                ÿ
     - Support for file attachment dsname of *create* which can be
       used to create and edit file attachments (useful for html
       and rtf attachments)
    ÿ
         e.g. REPORT htm/html/red
         - colors can be abbreviated to the shortest common sequence of
           letters ÿ
         - fixed several undefined variable problems
         - Use custom ISPF Edit Panel so the user knows they are enterin
           a message or an attachmÿ
           - eliminate the dynamic creation of the edit macro and altlib
             by moving the macro into exec XMITIPED
                                                 +
             V3.00 - 01/03/2000                ÿ
               - Support for HTML attachments
                 - converts text files to basic HTML format
                 - support for ASA carriage control           ÿ
                 - Support for Binary attachments
                   - input file is converted to mime without any other
                     form of translation
                   - Improved ASA carriage control handling
                     - support added for + (no space) by merging current
                       with prior record (only non-blanks merged)
            ÿ
                         as 0 (double space)
                       - If specified then honored for ALL file attachme
                       - Ifÿ
                       - Support for new options
                         - Importance
                         - Priority       ÿ
                           - Sensitivity
                           - Receipt
                             - Return Receipt address    ÿ
                             - Filedesc
                               - File Description option (support by som
s)                           - Murphy (cute saying added at the end of t
t message)                   - Allow an address to be specified as "firs
<first.last@domain>          - moved more local customizations to XMITIP
                               - add support for external writer name
       ÿ
                               - Improved ISPF dialog
                                 - improved address selection table dial
                      z            - improved (new) file attachment tabl
                                   - support for other new options
                               {
NKAISERA

SLBD
¦
8





Î
Õ




----------------- *               * Name:      GET
                  *               *
                  *       ÿ
pecified data set     *               *            into the data set cur
eing processed by     *               *            ISPF Edit.
                      *               *    ÿ
                          *               * Syntax:    GET dsname
                          *               *
                          *               * Author:    Lioneÿ
     ÿ
ormation Technology           *               *            25 N. Via Mon
                              *               *            Walnut Creek,
598                 ÿ
                                  *               *            Internet:
b.dyck@kp.org                     *               *
              ÿ
                                      *               *            02/11
x after copy position                 *               *            02/04
x width problem                ÿ
- created by Lionel Dyck                  *               *
                                          *               * ------------
----------------------------------------- */    ÿ
                                                             Adÿ
MACRO (DSN) NOPROCESS"
                                                               Addrÿ
 "PROCESS DEST"                                                  dest_rc

                                                                   /* In
t a ÿ
n) = 0 then dÿ
g = "Error:"
g = "Correct syntax iÿ
ess ISPEXEC "Setmsg Msg(ISRZÿ
it 16
d                                     ÿ
                                           ÿ
* Test to insure the data set exists */
 = sysdsn(dsn)                                         +
 if x <> "OK" then do                                ÿ
        zedsmsg = ""
        zedlmsg = "Error Specified data set:" dsn x
        Address ISPEXEC "Setmsg Msg(ISRZ000)"                         ÿ
            exit 16
            end

       ÿÿ
             if dest_rc = 8 then do
                zedsmsg = ""
                zedlmsgÿ
                    Address ISPEXEC "Setmsg Msg(ISRZ000)"
                    exit 16
                    end               ÿ

                     /* Now read the specified data set */
                     dd_name = "GET"random()         ÿ
                         "Alloc f("dd_name") shr reuse ds("dsn")"
                         "Execio * diskr" dd_name "(Finis Stem get."
                         "Free f("dd_name")"                        ÿ

                             /* Now default to Address ISREDIT */
                             Address ISREDIT
   +
 ÿ
                                   "(WIDTH) = DATA_WIDTH"
                               ÿ
                ÿ
ata set                                   and if so then set destination
r line 0                                  otherwÿ
                               ÿ
                                              else "(DEST) = LINENUM .ZD
                                           save_dest = dest      ÿ
                                              ÿ
                                               /* Now insert the data */
                                               do i = 1 to get.0
  ÿ
                                                      "LINE_AFTER" dest
INE (NEWLINE)"                                        dest = dest + 1
                   +
i) then to_long = "ÿ

                                                         "UP MAX"
           ÿ
                                                             if to_long
hen do                                                          zedsmsg
ated?"                    ÿ
ossible truncation of inserted data"                                Addr
XEC "SETMSG MSG(ISRZ000)"                                           end
                                         ÿ
                                                             {

/                /*                 variables set by XMIÿ
 */                /*
 */         ÿ
   */                /*       TSO EX 'test.library.exec(TESTCU)' will sÿ
     */                /*       test.library.exec first for XMITIPCU
     */                /*    ÿ
       */                /* Code contributed by Dana Mitchell dana.mitch
dm.comÿ
                            parse source . . .ÿ

                     +
--------------- *  ÿ
ation values        *                       * --------------------------
------------------- */
                                  ÿ
  ÿ
                                               /* ----------------------
----------------------- *                       *ÿ
ults to use them heÿ
--------------------------- */                     parse value cu with c
" zone "/" smtp "/" ,                                      vio "ÿ
 "/" smtp_address "/" ,             ÿ
ont "/" tenter "/" ,                                           sysout_cl
from_center "/" writer "/" ,                                   top "/" b

 "/" domain "/" from_default ,                                     "/" a
main "/" zip_type "/" zip_load "/" ,                               zip_u
interlink "/" ÿ
                                                               center =
nter)                                                          domain =
main)                        ÿ
host)  ÿ
p(name)                                                            smtp
p(smtp)                                     ÿ
rip(zone)               ÿ
strip(vio)                                                             f
strip(font)                                                ÿ
= strip(writer)                          +
  = strip(top)                         ÿ
tom = strip(bottom)
eft   = strip(left)
ight  = strip(right)                                    ÿ
 tenter = strip(tenter)
 smtp_addÿ
   smtp_domain   = strip(smtp_domain)
     sysout_class  = strip(sysout_class)
     from_center   = strÿ
       from_default  = strip(from_default)
       appÿ
         zip_load      = strip(zip_load+
           zip_type      = strip(zip_ÿ
             zip_unit      = ÿ

               /* ------------------------------ *  ÿ
                  * Create the Output for Dispÿ
                    * ------------------------------ */
                cudb.1  = " "                                      ÿ
                  if exec_lib <> "?" then                      ÿ
                       cudb.2  = "  Current Customization values in" ,
                                 exec_lib"(XMITIPCU)"
  ÿ
ÿ
                                     dd_lib" member (XMITIPCU)"
                 ÿ
                 ÿ
                            cudb.5  = "         zone:" zone
                            cudbÿ
                              cudbÿ
                                cudb.8  = "          vio:" vio
                                cudb.9  = "  smÿ
                                  cudb.10 = " smtp_ÿ
                                    cudb.11 = "  smtp_domain:" smtp_doma
                                    cudb.12 = "         font:"ÿ
                                      cudb.13 = "       tenter:" tenÿ
                                        cudb.14 = " sysout_class:" sysou
                                        cudb.15 = "  from_center:" from_
                                          cudb.16 = "       writer:" wri
     +
   ÿ
            ÿ
                                                cudb.20 = "        right
                    ÿ
t                          ÿ
ame                                                 cudb.23 = "       do
omain                                ÿ
 from_default                             ÿ
:" append_domain                                        cudb.26 = "
:" zip_type                                           ÿ
ad:" zip_load                                            +
unit:" zip_unit                                        ÿ
erlink:" interlink                                            cudb.30 =
ze_limit:" size_limit                                           cudb.31
                                                                cudb.0ÿ

          ÿ
ysispf') = "ACTIVE" then do                                            x
 "C"rÿ
TE FILE("xmit_dd") REUSE UNÿ
    "CYLINDER",
    "DSORG(PS) RECFMÿ
ECIO * DISKW" xmit_dd "(STEM cudb. FINIS)"  ÿ
ddress ISPEXEC "LMINIT DATAID(DATAID) DDNAME("xmit_dd")"
ddress ISPEXEC "BROWSE DATAID("dataÿ
 Address ISPEXEC "LMFREE DATAID("dataid")"                   ÿ
   "FREE FILE("xmit_dd")"
   end                                            ÿ
  else do
         do i = 1 to cudb.0
            say cudb.i                                           ÿ
              end
           end è
           Return
ÿ
-------------- */               ver = "4.14"
                                 /* Name:      XMITIP
               ÿ
                   *                  * Function:  Transmit a message to
on the LAN via     *                  *            using the Internet ga
                   *          ÿ
                       *                  * Syntax:    %XMITIP user@node
......                 *                  *
                       *                  *  ÿ
                           *                  *
                           *                  *            user@node
                           *                  *             ÿ

                               *                  *            (user@nod
node ...)                      *                  *            or
                ÿ
" <first.last@address>               *                  *            or
                                     *                  *            ("f
t" <first.last@address> ...)     ÿ
        ÿ
d*  (not an address but used in the TO   *                  *
the envelope with BCC for addressing.    *        ÿ
id need only start withÿ
                                             *                  *
st id'                                       *                  *  ÿ
ext enclosed in single or double quoteÿ
 will be used as the to address in the           *                  *
 envelope (but not for smtp delivery)            *                  *
 or ÿ
     * if using an AddressFile/AddressFileDD which   *
     will cause the * to be replaced by the TO       *
     addresses in theÿ
                                                         *
         CC user@node                                    *
           e-mail address of the recipÿ
   ÿ
*              (note the space after CC)                     *
*            or                                        +
  *            CC ÿ
      *            or                                              *
      *            CC "first last" <first.last@address>            *
      *            or            ÿ
          *            CC ("first last" <first.last@address> ...)      *
          *                                                            *
          *            BCC user@node            ÿ
         ÿ
              *              (note the space after BCC)
              *              These addresses will NOT be in theÿ
                *         ÿ
                  *            or
                  *            BCC (user@node user2@node ...)
 *                  *            or        ÿ
   *                  *            BCC "first last" <first.last@address>
   *                  *            or
   *         +
.)     *   ÿ
         *                  *            AddressFile dsname
         *                  *              Defines a dataset that contai
           *              ÿ
 the form:   *                  *              TO address
             *                  *              CC address
             *ÿ
                 *                  *              * comment
                 *                  *              Note: only 1 address
rd in col 1-72.  *             ÿ
mat:                 *                  *              first.last@addres
                     *                  *              or
                     *                  *       ÿ
ast@address>             *                  *
                         *                  *            AddressFileDD d
                         *                  *              Defineÿ
at conÿ
 of addresses in the form:   *                  *              TO addres
                             *                  *              CC addres
  ÿ
                                 *                  *              * com
                                 *                  *              Note:
address per record +
an be of the formatÿ
ast@address                            *                  *
                                       *           ÿ
t last" <first.last@address>        ÿ
                                           *                  *
                                           *                  *   ÿ
onverts ASA carriage controls to Form Feed   *       ÿ
   etc. as are used on ASCII printers.         *                  *
 This works with the REPORT option.            *                  *
 ÿ
      control)                                     *                  *
   MACH                                            *                  *
     Converts MAÿ
       ÿ
         This works with the REPORT option.            *
         (defaults if RECFM ind+
            control)    ÿ
*                                                            *
*            DEBUG - do not send but echo output via say     *
*                                        ÿ
    *            FILE dataset.to.be.attached or                  *
    *            FILE (dsn1 dsn2 ....)                           *
    *              sequential dataset to be sent as an attÿÿ
        *                                                            *
        *              if the dataset is *create* then the dataset   *
        *              will be allocated and ISPF Edit opened on it  *
            *
            *            FILEDD ddname or
            *            FILEDD (ddn1 ddn2 ...)
         ÿ
                *              the FILE keyword to reference datasets vi
                *              a JCL //xx DD statement.
                *       ÿ
 *                  *            FILEDESC description-of-file or
 *                  *            FILEDESC (desc-file1 desc-file2 ...)
 *                  *              Descÿ
t    *                  *              imbedded blanks.
     *                  *              - a filedesc of x (or X) may be u
     *                  *                multiple fileÿ
 or      *                  *                more do not have aÿ
           *                  *                e.g filedesc (x file-desc
desc)      *                  *                                      ÿ
             *                  *            FILENAME or
ÿ
               *                  *            the name of the file atta
hat ÿ
                 ÿ
                   *                  *            FORMAT - the format o
le attachment      ÿ
                     *            ÿ
ent suffix             *                  *            FORMAT TXT/suffix
                       *          ÿ         *                    plain t
chment (default)         *                  *      ÿ
 file attachment suffix    *                  *                        (
, txt, html, ...)          *                  *  ÿç
BIN/suffix                               *                  *
ÿ
       (e.g. xmit or .xmit)                *                  * ÿ
MAT HTML/color/suffix                        *                  *
    color is docuÿ
      suffix is the file attachment suffix     *                  *

 FORMAT PDF/layout/font/paper/lpi ÿ
          layout is Landscape (11x8.5)             *                  *
              ÿ
                      - default is Portrait        ÿ
              font is a font size where 72 points      *
                   is one incÿ
                paper is LETter for Letter (8.5 x 11)    *          ÿ
                           LEGal for Legal (11x14)         *
                           A4 for A4 (Europeÿ
*                               (8.27 x 11.7)                *
*    ÿ
  *            FORMAT RTF/layout/font/paper/suffix         ÿ
    *                   layout is Landscape (11x8.5)             *
    *                 ÿ
      *                             - default is Portrait          *
        *                   font is a font size where 72 points      *
        *                        is one+
          *                   paper iÿ
         ÿ
              *                            A4 for A4 (European paper)
              *                            or         ÿ
                *       ÿ
                  *                   suffix is the file attachment suff
                  *                       (default is .rtf)            ÿ
 *                  *            FORMATÿ
   *                  *                   to zip a text file
   *                  *                   name-in-archive is the name th
   *    ÿ
       *                  *            FORMAT ZIPBIN/name-in-archive
       *                  *                   to zip a binary file
       *                 ÿ
           *                  *                   to convert the fiÿ
and then     *                  *                   zip the file
             *                  *           ÿ
er/lpi         *                  *                   to convert the fil
 aÿ
                 *                  *            FORMAT ZIPRTÿ
/layout/font/paper *                  *                   to convert the
 RTF and then    ÿ
                     *                  *
                       *                  *            Color definitions
L attachments          *        ÿ
 color then it is the    *                  *                   text col
a white backgroÿ
lor-color then the first   *                  *ÿ
 background color and the    *                  *                   seco
 is the text color           *  ÿ
                               *                  *           ÿ
   Abbrev   Color     Abbrev     *                  *
   A        Navy      N          *               ÿ
     Bla      Olive     O          *                  *
       Blu      Purple    P          *                  *
sia    F        Red       R          *                  *         ÿ
ay      Gra       Silver    S          *                  *
een     Gre ÿ
Lime      L         White     W          *                  *
Mar+
 ÿ
 Each set applies to the relative FILE dsn or  *                  *
 FILEDD ddname.  If both FILE and FILEDD are   *                  *
 coded then the dsÿ
     FILE and then FILEDD.                         *                  *
                                                   *                  *
   FROM from.mail.address@node     ÿ
       or                                              *
       FROM "from name" <from.name@address>            *
         specifies the return mail address          ÿ
             (see REPLYTO keyword)                         *
                                                           *
           HTML                                            *         ÿ
*      +
  *  ÿ
    *                                                            *
    *   ÿ
      *             ÿ
        *              LOW                                           *
        *              NOÿ
          *              HIGH      ÿ
            *              or abbreviated as HI, LO, NO
            *                             ÿ
              *            MURPHY                 ÿ
                *              Include some random words of wisdom from
                *              Edward A. Murphy, Jr and othÿ
                  *                                              ÿ
 *                  *            MSGDS data-set-name
 *                  *              specifies the data set that contains
   *                  *              message
ÿ
nder *                  *              ISPF then the ISPF Editor will be
 to  *       ÿ
       *       ÿ
         *                  *              If the data-set-name is prefi
 *@      *                  * ÿ
           *                  ÿ
removed.     *                  *
             *                  *            MS+
               *                  *          ÿ
ontains the        *                  *              message
                   *                  *
                   *                  *            MSGQ     ÿ
                       *                  *              Indicates that
age will be passed     *                  *              in the TSO QUEU
                       *                  *
 ÿ
                           *                  *              Indicates t
 the first 72 characters   *                  *              per record
essage wilÿ
sequence numbers)              *                  *
                               *                  *            NOMSG
                         +
hat no message is beingÿ
le transmit is to occur.             *                  *
                                     *              ÿ
                                      ÿ
ates that no 'confirmation' message will *                  *
nerated out of this command.             *                  *        ÿ
                                           *         ÿ
LYTO reply.to.address@node                   *                  *
                                             *                  *
M "repÿ
   specifies the reply address which is different*                  *
   from the FROM address.                        *                  *
                       ÿ
   ÿ
     will cause a return receipt request to get asked*
     for to the specified address.      ÿ
                  ÿ
         MARGIN Lm/Rm/Tm/Bm                              *
         or                                              ÿ
           MARGIN (Lm/Rm/Tm/Bm Lmÿ
*              defines the margins for the REPORT attachments*
*              Lm = left margin   Rm = right margin          *
  *              Tm = top margin    Bm = bottom ÿ
    *            the values in inches (e.g. .8 for .8 inch)      *
    *            - Each set applies to the relative FILE dsn or  *
    *      +
        *  ÿ
          *              FILE and then FILEDD.                         *
          *                                                            *
            *            PRIÿ
              *              priority of the note - values may be
              *              NON-URGENT
             ÿ
                  *              URGENT
                  *              or abbreviated as NON, NOR, UR
                  *         ÿ
d) *                  *
   *                  *            SENSITIVITY value
   *                  *              sensit+

         *                  *              PRIVATE
         *                  *              CONFIDENTIAL
         *      ÿ
             *                  *              or abbreviated as PE, PR,
M            *                  *
             *                  *ÿ
                 *                  *              specifies a dsname fo
ature block      *                  *
                 *                  *            Sÿ
      ÿ
signature block      *                  *
                     *                  *            SUBJECT 'subjeÿ
age'                 ÿ
 for the message         *                  *              or
                         *                  *            SUBJECT "subjec
ssagÿ
r single (') or double (")   *                  *              quotes on
ds (both must be the same    *                  *              and then
use the other flavourÿ
bject.                           *                  *              Speci
rds: &DATE, &DAY, and &TIME      *                  *              Note:
E is found in the subject it is  *    ÿ
laced by the date month dd,yyyy      *                  *
&DAY is found in the subject it is   *                  *
laced by the day of the week         *                 +
fÿ
   replaced by the current time.           *                  *
   &DATE may also be represented by        *                  *
      &DATE-n (eÿ
       &DAY may also be represented by         *                  *
          &DAY-n (e.g. &DAY-1)                 *                  *
                               ÿ
 ZIPMETHOÿ
          The method of compression to be used     *                  *
           by the ZIP utility.                ÿ
             PKZIP supportÿ
                     Normal, Maximum, Fast,            *
                     Superfast, and Store              *     +
                                           ÿ
*            ZIPPASS pwd                                     *
*                    pwd is a password (case sensitive)      *
*                            that will be used by ZIP to    ÿ
    *                            encrypt the file                *
    *                                                            *
    * Notes: The default margins for REPORT are .8" for left and *
      *  ÿ
        *                                                            *
        * Customization: 1) update exec XMITIPCU for local custom    *
        *     ÿ
            *                2) find *custom* to find where you
            *                   need to customize some processing
            *                  ÿ
                * Author:    Lionel B. Dyck
                *            Kaiser Permanente Information Technology
                *            25 N. Via Monte Aveÿ
 *                  *            Walnut Creek, California 94598
 *                  *            (925) 926-5332
 *                  *            Internet: Lionel.B.Dyck@kp.org  ÿ
     *                  *
     *                  * ----------------------------------------------
---- *                  * Thanks to Leland Lucius for providing the code
  ÿ ÿ
com)     *                  * ------------------------------------------
-------- *                  * Thanks to Leland Lucius for providing the
 the     *         ÿ
e PDF conversion                            *           (Leland.Lucius@e
m)                       *                  * --------------------------
------------------------ *        ÿ
urphy code                   *                  *          Paul.Wells@la
co.uk                        *                  * ----------------------
---------------------------- *                  *ÿ
r the code to support the        *                  * Interlink TCPACCES
   dana.mitchell@ing-dm.com      *                  * ------------------
-------------------------------- *                  * Thanks to ÿ
 (rstuemke@ILSOS.NET)                *                  * of the Office
llinois Secretary of State           *                  * for the Machin
ge Control code                      *                  * --------------

                                           *                  * History:
                                           *                  *
/00:  4.14 update to xmitiÿ
29/00:  4.13ÿ
8/07/00:  4.12 (ga level)                      *                  *
          - fix no-cc rtf conversion       ÿ
            - fix syslrecl ÿ
              - Clean up mach cc support (fixed)   *                  *
              - Other minor cleanup                *        ÿ
                - Implement PDF support (xÿ
                  - add support for Machine Carriage   *
                    Control by ISOS                    *
                    - fix plain zip                      ÿ
                      - allow paper or heightXwidth        *
                      - if filename ends with .htm or html *
              ÿ
  *            06/08/00:  4.05                                 *
  *                       - fix extraneous trace and msgds     *
  *            06/06/00:  4.04 ÿ
    *  ÿ
      *            06/05/00:  4.03 - enable debug on msgds *@      *
      *            06/01/00:  4.02              ÿ
        *             ÿ
          *            05/24/00:  4.01                                 *
          *                       - if addressfiledd is temp allo+
            *                       -ÿ
                *                       - correct but with 1st page in r
                *            05/11/00:  several minor bug fixes before G
                *            04/16/00:  4.00 major rÿ
  ÿ
 *                  *                       - support new FILENAME keywo
 *                  *                       - support new ZIPMETHODÿ
   *               ÿ
     *                  *                       - support transition for
     *                  *                       - translate <>&" for htm
  ÿ
mitipzp) *                  *                       - support size_limit
         *                  *                       - if plain text atta
r note   *       +
 2 .'s       * ÿ
do bytes, etc. *                  *                         sent report
               *                  *                       - for attachÿ
 it is dsn(mem)  *            ÿ
specified then     *                  *                         use mem.
                   *                  *                       - support
rlink  ÿ
n address              *                  *                       - corr
nfirm on 3 statement   *                  *            03/31/00:  3.13 a
 option                *ÿ
TIME to subject options    *                  *                       -
 &date and &day spacing    *                  *            02/22/00:  3.
 bug fix for &date/&day    *             ÿ
ge drop to null setting        *                  *            01/31/00:
llow suffix on report to       *                  *
ally be the new file name      *                  *       ÿ
the attachÿ
add append_domain option           *                  *
move setup for from default to     *                  *
  xmitipcu               ÿ
  - add HTML option for MSGDx          *                  *
  - add &DATE and &DAY options in      *                  *
    Subject ÿ
      - additional rc tests for execio's   *                  *
      - FIX broken RTF processing          *                  *
      - split filedesc into n+
          - allow single quotÿ
            - only accept cols 1-72 for address  *                  *
              book input                         *                  * ÿ
   01/13/00:  3.03 Support FILE *Create*      ÿ
                - use custom ISPF Edit Panel         *
                - move ff and lf to default setting  *
     ÿ
         01/11/00:  3.02 allow message text to be mime   *
                    - html color now support on REPORT   *
         01/05/00:  ÿ
ÿ
*            11/29/99:  3.00 revision - major updates        *
*                       - html opti+
  *              ÿ
      *                       - binary file attachment option      *
      *                         (file is translated to mime)       *
      *                       - adÿ
          *                            with "name" <addr>              *
          *                       - add Return Receipt keyword RECEIPT *
          *                       - support SIGDD  ÿ
              *                       - if SIG or MURPHY then ignore use
              *                         regardless of NOMSG status
              *                       - add sender to header for traÿ
                  *                       - add new keywords
                  *                         - PRIORITY
                  *                         - IMPORTANCE
     ÿ
   *                  *                         - FILEDESC
   *                  *                       - subroutine file_info for
   *                  ÿ
       *                  *                       - add writer from xmit
       *                  *                       - fix asa so if not sp
then   *                  *            ÿ
m          *                  *            10/15/99:  2.43 fix suffix of
           *                  *            10/14/99:  2.42 fix counter i
and sig    *                  *            10/06/99:  2.ÿ
               *                  *                       - add content-
ion for pegasus*                  *            10/03/99:  2.40 moved mos
 values into   *                  *                            XMITIPCU
.                  *                  *            10/01/99:  2.34 suppo
refix for msgds *    *                  *                            tem
                     *                  *                       - remove
ph afterÿ
upport    ÿ
tine to dynamically get  *                  *
e offset from gmt      ÿ
                           ÿ
or XMITIP                    *                  *            09/21/90:
 of exec as xmitvm           *        ÿ           *
                               *            ÿ
-------------------------------- */
                                                   paÿç
ns
                                                                   signa
alue                                                                ÿ
                                                                     /*
----------ÿ
options and ISPF is active invoke ISPF frontend *
---ÿ
th(options) = 0 then       ÿ
 sysvar('sysispf') = "ACTIVE" then do
*** Insert LIBDEF ÿ
   Address ISPExec,                         ÿ
        "Select cmd(%xmitipi) scrname(XMITIP)"
     exit 0                      ÿ
       end                                                   ÿ

   /* -------------------------- *              ÿ
      * set up defaults            *
        * -------------------------- */
       parse value "" with address_n. printcc bcc bcc_n. cc cc_ÿ
                             confirm ddn dsn file filedd filedesc ,
               ÿ
                               from from_def from_n. header. msg72 ,
                                 importance lp margin msgdd msgds msgq ,
                                ÿ
                                   receipt receipt_n.  replyto replyto_n
             ÿ
                                     smtp_secure +
                                       create_dÿ
                            ÿ
                       workdd = "XMDD"random()
                       indd   = "XMDD"random()                  ÿ
                         eddd   = "XMDD"ranÿ

                           ff     = x2c('0C')   /* Form Feed */
 ÿ
                               in.0   = 0           /* set input counter
 */
                  ÿ
                                   pdf_count  = 0                      ÿ
                                     bytes      = 0
                                     ÿ
                                       msgid      = sysvar("sysicmd")":"
      ÿ
                                            msgid = syÿ

                     ÿ
--------------------- *                       * Invoke XMITIPCU for locÿ
omization values        *                       * ----------------------
----------------------- */          ÿ

        ÿ
--------------------------- *                      ÿ
defaults to use them here     *                       * ----------------
-------------------------ÿ
r "/" zone "/" smtp "/" ,                                      vioÿ
cure "/" smtp_address "/" ,                                      smtp_do
 font "/" tenter "/" ,                    ÿ
"/" from_center "/" writer "/" ,                                   top "
mÿ
me "/" domain "/" from_default ,                           ÿ
d_domain "/" zip_type "/" zip_load "/" ,                               z
"/" interlink "/ÿ
center)                                                          domain
p(domain)                                                          host
p(host)                        ÿ
rip(name)                                                            smt
rip(smtp)    +
strip(zone)ÿ
  = strip(vio)
  = strip(font)
r = strip(writer)           ÿ
op    = strip(top)
ottom = strip(bottom)
eft   = strip(left)                          ÿ
   right  = strip(right)
   tenter = strip(tenter)
   smtp_address  = strip(smtp_address)                        ÿ
     smtp_d+
       syÿ
         from_center   = strip(from_center)
 ÿ
           append_domainÿ
             zip_load      = strip(zip_load)
             zip_tÿ
               zip_unit      = strip(ziÿ
                 /* ----------------------------------------------------
                  * Now save the teÿ
                    * ispf edit macro.                ÿ
                      * ------------------------------------------------
                      if sysvar('sysispf') = "ACTIVEÿ
                           Address ISPExec "Vput (tenter)"           ÿ

                         /* -----------------------------------------ÿ
--- *                       * Process the To address
    ÿ
----- */                      Select
      ÿ
                   ÿ
                                          address = left(options,pl)
                       ÿ
                                  ÿ
                                         when left(options,1) = "'" then
                                        ÿ
                                                aÿ
                                                  options = substr(optio
                                                  end    +
                                               when lefÿ
en do                                                   parse value opti
 "(" address ")" options                                end
                                                   otherwise

with address options                                end
                                                    options = strip(opti
         ÿ
                                                       save_address = ad
                                                       call process_addr
ddress")"                 ÿ
                           ÿ
.0                                                              address_
names.i                                      ÿ
                                          ÿ
                                                                 if addr
" then signal exit_4                                          ÿ
ress) = 0 then signal exit_4                             ÿ
                                                                     /*
--------------------- *                                               *

------------------------- */
       = strip(options)
ptions = translaÿ
       ÿ
----------------------------------------------------- *
Now process the keywords         ÿ
* --------------------ÿ

 /* -------------------------- *                  ÿ
    * SUBJECT Keyword first.     *   ÿ
      * -------------------------- */
     if wordpos("SUBJECT",upper_options) > 0 then do               ÿ
          pw = wordpos("SUBJECT",upper_options)     ÿ
            pc = wordindex(upper_options,pw)
            /* make the word subject upper case */
    ÿ
                if left(word(options,pw+1),1) = "'" then do
                   parse value options with x "SUBJECT" "'" subject "'"
                   qt+
  ÿ
                      if left(word(options,pw+1),1) = '"' then do
                         parse value options with x "SUBJECT" '"' subjec
                 ÿ
                             end
                          /* now remove subject from options */
                          lq = pÿ
                              options = overlay(" ",options,lq,1)
                              rq = pos(qt,options,pc)
                              options = strip(d+
                                  upper_optioÿ

                                    /* ---------------------------------
---- *   ÿ
         *                               * -----------------------------
-------- */                             do while pos("&TIME",translate(s
 > 0                      ÿ
t))                                            if dp > 0 then
                                                  lsub = left(subject,dp
                                           ÿ
          ÿ
                                                        dp = 0
                                                        end ÿ
                         ÿ
                                                       rsub = right(subj
p+1)                                                   key  = translate(
sub,1))                                 ÿ
                                                           rsub = substr
+1)                                                        if pos(right(
,)") > 0 then ÿ
ey,1)                                                             rsub =
sub                                                               key  =
y,length(key)-1)               ÿ
                                                                   subje
b""time()""rsub                                                    end
                                                ÿ
     ÿ
------------------------------------ *                               * P
he &DATE if it exists                *                           +
--------------------ÿ
le pos("&DATE",translate(subject)) > 0
= pos("&DATE",translate(subject))
dp > 0 then                        ÿ
  ÿ
 else do
      lsub = ""                                   ÿ
        dp = 0     ÿ
          end
     sl = length(subject)                                        +
       rsub = right(subject,sl-dp+1)ÿ
           key  = translate(word(rsub,1))
           kl   = length(key)
           rsub = substr(rsub,kl+1)                  ÿ
               if pos(right(key,1),",)") > 0 then do
                  rkey = right(key,1)
                  rsub = rkey""rsub                                   ÿ
             ÿ
                      end
                   if pos("-",key) > 0 then do
       ÿ
                          d = date('B') - n
                          end
                       eÿ
                           parse value date(,d,'b') with dd x y
                           m = date('m',d,'b')
                           subject = lsubÿ
                               end

                            /* ---------------------------ÿ
 *                               * Process the &DAY if it exists
 *                               * -------------------------------------
 */                             do while pos("&DAY",translate(subject))
        ÿ
                                       if dp > 0 then
                                          lsub = left(subject,dp-1)
            ÿ          ÿ
                                                lsub = ""
                                                dp = 0
                             ÿç
                                                           sl = length(s
                                                           rsub = right(
sl-dp+1)                                      ÿ
word(rsub,1))                                                  kl   = le
)                                                              rsub = su
b,kl+1)                                                        ÿ
key,1),",)") > 0 then do                                              rk
ht(key,1)                                                             rs
y""rsub                                                               ke
ÿ
 ÿ
"-",key) > 0 then do
e value key with "&ÿ
= date('B') - n ÿ
end
e d = date('b')                     ÿ
 = date('w',d,'b')             ÿ
 subject = lsub""d""rsub
 end                                                 ÿ
end                                           ÿ

* -------------------------- *                                        ÿ
  * CC Keyword.                *                             ÿ
    * 'Carbon Copy' recipients   *
    *  CC id@node  or            *
    *  ÿ
        * -------------------------- */
       if wordpos("CC",upper_options) > 0 then do
          pw = wordpos("ÿ
           ÿ
              p2 = wordindex(upper_options,pw+1)
              /* make the word CC upper cÿ
                options = ÿ
                  parse value options with "CC" data
                  data = strip(data)                      ÿ
                    Select               ÿ
                         when left(data,1) = '"' then do
                              pl   = pos(">",data)
                                cc   = left(data,pl)    ÿ
                                    end
                               when left(data,1) = "'" then do
                                    pl   = pos(">",data)               ÿ
            ÿ
                                        end
                                   when left(data,1) = '(' then do
      ÿ
                                            parse value data with "(" cc
                                            end
                     +
                   ÿ
                                                  pl   = length(cc)
                                          end                  ÿ
                                  ÿ
                                              ropt = substr(options,p2+p
                                              options = strip(lopt ropt)
ÿ
ons)                                              call process_address c
                                                  cc = t_addrs
                 ÿ
                                                         cc_n.i = t_name
                                                         end
                                  ÿ

                                                       /* --------------
---- *                                             ÿ
       *      ÿ
'        *                                                  *  BCC id@no
         *                                                  *  BCC (ÿ
d2@node ..) *                ÿ
------------ */                                                if wordpo
upper_options) > 0 then do                                        pw = w
BCC",ÿ
ndex(upper_options,pw)                                                p2
ndex(upper_options,pw+1)                                              /*
e word BCC upper case ÿ
s = overlay("BCC",options,pc,3)
value options with "BCC" data
 strip(data)                           +
lect                                   ÿ
   when left(data,1) = '"' then do
        pl   = pos(">",data)
        bÿ
            end
       when left(data,1) = "'" then do
            pl   = pos("ÿ
                bcc  = left(data,pl)
                end
           when left(data,1) = '(' then+
          ÿ
                      parse value data with "(" bcc ")" .
                      end
                 otherwise ÿ
                          bcc = word(data,1)
                          pl   = length(bcc)
                  end                       ÿ
                      lopt = left(options,pc-1)
                      ropt = substr(options,p2+pl+1)
                      options = strip(lopt ropt)             ÿ
  ÿ
                          call process_address bcc
                          bcc = t_addrs
                 ÿ

                           /* -------------------------- *
               ÿ
                                * Optional From e-mail       *
                                * address.                   *
                                ÿ
                                   if wordpos("FROM",upper_options) > 0
                                      pw = wordpos("FROM",upper_options)
                                      pc = wordinÿ
                                          p2 = wordindex(upper_options,p
                                          /* make the word FROM upper ca
                                          options = overlay("FROM"ÿ
c,4)                                          parse value options with "
ta                                            data = strip(data)
                                              Select
   +
n dÿ
                                                            from = left(
                           ÿ
                    ÿ
'" then do                                                      pl   = p
ata)                                      ÿ                       from =
ta,pl)                               ÿ
                                                               when left
 = '(' then do                                           ÿç
  pl   = pos(")",data)                                            ÿ
    parse value data with "(" from ")" .
    end
 otherwise
   ÿ
        pl   = length(from)
end    ÿ
  lopt = left(optionÿ
    ropt = substr(options,p2+pl+1)
    options = strip(loÿ
      upper_options = translate(optioÿ
        call process_address from
        from = strip(t_addrs)        ÿ
          from_n.1 = strip(t_names.1)                 ÿ
            end
                                                    ÿ
           /* -------------------------- *                             ÿ
              * MSGQ Keyword.              *
              * Input is from the queue    *                       ÿ
                * -------------------------- */
        ÿ
                    pw = wordpos("MSGQ",upper_options)
  ÿ
                      optÿ
                        msgq    = 1
                 ÿ
                          msgsub  = "MSGDSÿ
                            end
                                ÿ
                           /* -----------------------------+
----- *                       * MSG72 keyword            ÿ
        *                       * use first 72 ÿ
          *                       * ------------------------------------
--------- */                     if wordpos("MSG72",upper_options) > 0 t
                                      pw = wordpos("MSG72",uppÿ
                                        upper_options = delword(upper_op
,1)                                     options = delword(options,pw,1)
           ÿ
                                            end

                              ÿ
                                              * MSGDS Keyword.
          ÿ
                                               ÿ
                                                  * --------------------
/                        ÿ
ons) > 0 then do                                      pw = wordpÿ
er_options)                                             dsn = word(upper
,pw+1)                                  ÿ
d(upper_options,pw,2)                                     options = delw
oÿ
n                                                      ÿ
*@" then do                                                      dsn = s
str(dsn,3))       ÿ
                                                                   if ÿ
ll then do
"off"                              ÿ
 0
     ÿ
                                                    ÿ

                    ÿ
-------------------- *                                               ÿ
Keyword                *
set containing the     *           ÿ
ssage to be sent.        *
------ÿ
wordpos("SIG",upper_options) > 0 then do          ÿ
  pw = wordpos("SIG",upper_options)
  sigdsn = word(upper_o+
    upper_options = dÿ
        options = delword(options,pw,2)
        end
                                      ÿ
ÿ
          * SIGDD Keyword              *
          * DDname containing the      *               ÿ
            * m+
             ÿ
               if wordpos("SIGDD",upper_options) > 0 then do
                    pw = wordpos("SIGDD",upper_options)
                    sigddn =ÿ
                      upper_options = delword(upper_options,pw,2)
           ÿ
                        end                ÿ

                       /* --ÿ
                          * MSGDD Keyword.             *  ÿ
                            * DDname for message text    *
                            * to be sent.    ÿ
                              * -------------------------- */
                               if wordpos("MSGDD",upper_options) > 0 the
                                  pw = wordpos("MSGDD",upper_oÿ
                                    if dsn = null then do
        ÿ
                                           call listdsi(ddn "FILE")

                       ÿ
                                               if length(sysdsname) = 0
                ÿ
 allocated"                           ÿ
ry."                                                  exit 4
                                 ÿ
                                                     ÿ
pper_options,pw,2)                                     options = delword
,pw,2)                                            ÿ
                                                         msgdd = 1  ÿ
                                                           end
                                                      else do      +
                                                        say msgidÿ
andÿ
rrect your options and try again."                          exit 4
                                                            end
  ÿ

                                                             /* --------
---------- *       ÿ
d.             *               ÿ
that no MSGDS    *                                                  * or
s specified.     *                    ÿ
------------------ */                         ÿ
s("NOMSG",upper_options) > 0 then do
ordpos("NOMSG",upper_options)                          ÿ
r_options = delword(upper_options,pw,1)                      ÿ
tions = delword(options,pw,1)
msg = "off"
in.0  = 0
  end

* -------ÿ
  * NOCONFIÿ
    * Turn off the confirmation  *
    * message from this exÿ
      * ------------------ÿ
       if wordpos("NOCONFIRM",upper_options) > 0 then do
          pw = wordpos("NOCONFIRM",upper_opÿ
            upper_options = delword(upperÿ
              options = delword(options,pw,1)
              confirm = "off"                               ÿ
                end                                     ÿ

               /* -------------------------- *
                  * ASA Keyword.               *                       ÿ
                    * (affects attachments only  *
                    * -------------------------- */
              ÿ
      ÿ
                          upper_options = delword(upper_options,pw,1)
                          optio+
                     ÿ
                                end

                             /* ----ÿ
                                  * MACH Keyword.              *
                                  * (affects attachments only  *
                                  * ---------------+
                                     if wordpos("ÿ
 do                                       pw = wordpos("MACH",upper_opti
                                          upper_options = delword(upper_
pwÿ
                                              printcc = "on"
                                              end
                   ÿ

                                                * ZIPMETHOD Keyword
                                    ÿ
 *            ÿ
   *                                                * used for all ZIP a
ts *                                                *ÿ
---- */                      ÿ
per_options) > 0 then do                                  pw = wordpos("
D",upper_options)                                         zip_method  ÿ
ptions,pw+1)                                ÿ
lword(upper_options,pw,2)                                     options =
options,pw,2)                                                 end
       ÿ
                                                               /* ------
-------------- *                                                * ZIPPAS
d              *        ÿ
rd                 *                                                * us
ll ZIP attachments *                                                * --
------------------ */                    ÿ
"ZIPPASS"ÿ
ordpos("ZIPPASS",upper_options)
s  = word(options,pw+1)                                   ÿ
r_options = delword(uppeÿ
tions = delword(options,pw,2)
d
                                       ÿ
 /* -------------------------- *
  * IMPORTANCE Keyword.        *
  * Optional importance        *                      ÿ
    * ------ÿ
     if wordpos("IMPORTANCE",upper_options) > 0 then do
        pw = wordpos("IMPORTANCE",upper_options)                     +
          importance = word(oÿ
              upper_options = delword(upper_options,pw,2)
              options = delword(options,pw,2)
              test = translate(importance)    ÿ
  ÿ
                    when abbrev("HIGH",test,2)   then importance = "High
                    when abbrev("LOW",test,2)    then importancÿ
                 ÿ
                        otherwise nop;
                        end
ÿ
                          valid_importance = "HIGH LOW NORMAL"
                          if wordpos(test,valid_importance) = 0 then do
                 ÿ
ified"                           say msgid "valid values are:" valid_imp
                                 importance = null
                                 eÿ
                                  end

                               /* -----------------ÿ
                                    * PRIORITY Keyword.          *
                                    * Optional priority          *
                                    * -------------------------- */ ÿ
            ÿ
then do                                   pw = wordpos("PRIORITY",upper_
                                          priority = word(options,pw+1)
     ÿ
                                              upper_options = delword(up
ons,pw,2)                                     options = delword(options,
                      ÿ                   ÿ
                                                    when abbrev("URGENT"
 then priority = "Urgent"                           when abbrev("HIGH",t
 then priority = "Urgent"              ÿç
"NON-URGENT",test,3) then
y = "Non-Urgent"                                                    when
"LOW",test,2) then                                      ÿ
ority = "Non-Urgent"
rev("NORMAL",test,3) then priority = "Normal"
e nop;
       +
 tranÿ
d_priority = "URGENT NORMAL NON-URGENT"
ordpos(test,ÿ
 say msgid "Invalid ÿ
   say msgid "valid values are:" valid_priority
   priority = null           ÿ
     end                           ÿ
    end
                                              ÿ
   /* -------------------------- *                ÿ
      * SENSITIVITY Keyword.       *
      * Optional sensitivity       *                           ÿ
        * -------------------------- */                          ÿ
         if wordpos("SENSITIVITY",upper_options) > 0 then do
            pw = wordpos("SENSITIVITY",upper_options)
ÿ
ÿ
                upper_options = delword(upper_options,pw,2)
                oÿ
               ÿ
                      when abbrev("CONFIDENTIAL",test,3) then
                           sensitiÿ
                        when aÿ
                               sensitivity = "Company-Confidential"
                          when abbrev("PRIVATE",tesÿ
                                 sensitivity ÿ
                              when abbrev("PERSONAL",test,3) then
                                   sensitivity = "Personal"         ÿ
                                otherwise nop;              ÿ
                                  end
                                test = translate(sensitivity)
     +
ENTIAÿ
                                      if wordpos(test,valid_sensitivity)
n do                                     say msgid "Invalid SENSITIVITY"
vity "specÿ
_sensitivity                                 sensitivity = null
                                             end
                         +
                       ÿ
                                             /* ------------------------
                                              * REPLYTO ÿ
                                      ÿ
                                                  * address.
                                                  * --------------------
 */                                                ifÿ
options) > 0 then do                                    pw = wordpos("RE
pper_options)                                           pc = wordindex(u
ions,pw)  ÿ
_options,pw+1)                                              /* make the
LYTO upper case */                                          options = ov
EPLYTO",options,pc,7)      ÿ
s wÿ
a)                                                              Select
                                            ÿ
ata,1) = '"' then ÿ
 = pos(">",data)
yto = left(data,pl)                                          ÿ
d                                ÿ
left(data,1) = "'" then do
pl   = pos(">",data)
  replyto = left(data,pl)                       ÿ
    end
hen left(data,1) = '(' then do
    pl   = pos(ÿ
        parse value data with "(" replyto ")" .
        end
   otherwise                    ÿ
            replyto = word(data,1)
            pl   = length(replyto)
    end                                          +
      lopt = ÿ
          ropt = substr(options,p2+pl+1)
          options = strip(lopt ropt)
          upper_options = trÿ
              call process_address replyto
              replyto = strip(t_addrs)
              replyto_n.1 = strip(t_names.1+
   ÿ

                 /* -------------------------- *
                  * ÿ
                      * -------------------------- */
                     if wordpos("REPORT",upper_options) > 0 then do
                        pw = wordpos(ÿ
                            pc = wordindex(upper_options,pw)
                            /* make the word REPORT upper case */
                            options = overlay("REPORT"ÿ
      ÿ
                                   parse value options with x "REPORT" "
t ")" more                         /* now remove REPORT from options */ÿ
                     ÿ
                                       options = overlay(" ",options,lq,
                                       rq = pos(")",options,pc)
        ÿ
                                           upper_options = delstr(upper_
pc,rq-pc+1)                                end
                         ÿ
                                                 report = word(options,p
                                                 options = delword(optio
                                          ÿ
er_options,pw,2)                                     end
                                                end
                                                           ÿ
 ÿ
                                                  * FORMAT Keyword
                                                  * --------------------
 */             ÿ
ptions) > 0 then do                                     pw = wordpos("FO
per_options)                                            pc = wordindex(u
ions,pw)     +
MAT upper casÿ
"FORMAT",options,pc,6)                                        if pos("("
tions,pw+1)) > 0 then do                      ÿ                    parse
ptions with x "FORMAT" "(" forÿ
ve FORMAT from options */                                            lq
",options,pc)                                                ÿç
   options = overlay(" ",options,lq,1)                     ÿ
     rq = pos(")",options,pc)
     options = delstr(options,pc,rq-pc+1)
       upper_options = delstr(upper_options,pc,rq-pc+1)
         end
      else do
           ÿ
             ÿ
               upper_options = delword(upper_options,pw,2)
               end        ÿ
            end               ÿ

           /* -------------------------- ÿ
              * Test for REPORT and FORMAT *   ÿ
                * -------------------------- */
               format_report = 0                        ÿ
                 if format <> null                              ÿ
                      then if report <> null then format_report = 1
                   if report <> null                                   ÿ
                        then if format <> null then format_report = 1
 ÿ
                          say msgid "Both FORMAT and REPORT are not allo
      ÿ
                  ÿ
                              signal exit_4
                     ÿ
                                   ÿ
                               /* --------------------------------------
------- *                       * Coÿ
cified)   *                       * ----------------ÿ
----------- */                     if words(report) > 0 then do
                                      do rp = 1 to ÿ
                                           parse value word(report,rp+
1 "/" rp2 "/" rp3                            rp1 = strip(rp1)      ÿ
                                               rp2 = strip(rp2)   ÿ
                                                 rp3 = strip(rp3)
                                                 if translate(rp1) = "X"
1 = ÿ
 +

ip(rp1)                ÿ
E",translate(rp1),1) = 1 then                                   format =
"rtf/"rp1"/"rpÿ
IT",translate(rp1),1) = 1 then          ÿ
mat "rtf/"rp1"/"rp2"/"rp3                                      When abbr
",translate(rp2),3) = 1 then ÿ
ormat "html/"rp3"/"rp1                                   ÿ
                                                                   When
e(rp2) = "RTF" then do                      ÿ
 = format "rtf/P"rp3"/"rp1
                                                                       O
 format = format rp1"/"                                    ÿ
                                                                       e
           ÿ
rip(format)                                                          say
 "---------------------------------------------"                       s
 "Information about REPORT tÿ
id " The REPORT Keyword is being replaced by the"
id " FORMÿ
rds(report) > 1 then rpt = "("report")"      ÿ
else rpt = report
 msgid "REPORT" rpt     ÿ
f words(format) > 1 then fmt = "("format")"                   ÿ
    else fmt = format
 say msgid " You should change this to:ÿ
   say msgid "FORMAT" fmt

     end                                              ÿ

     /* --------ÿ
        * MARGIN Keyword             *                               ÿ
          * -------------------------- */
         if wordpos("MARGIN",uppe+
              pw = wordpos("MARÿ
    ÿ
                  /* make the word MARGIN upper case */
                  options = overlay("MARGIN",optÿ
                   +
                 ÿ
re                         /* now remove MARGIN from options */    ÿ
                             lq = pos("(",options,pc)
                             optÿ
                               rq = pos(")",options,pc)
    ÿ
                                 upper_options ÿ
+1)                                end
                     ÿ
                                       margin = word(options,pÿ
                                         options = delword(options,pw,2)
                                      ÿ
,pw,2)                                     end
                                        end
                                                       ÿ
                                       /* -------------------------- *
            ÿ
                                          * -------------------------- *
                                           if wordpos("RECEIPT",upper_op
 0 then do                 ÿ
ions)                                           pc = wordindex(upper_opt
         ÿ
w+1)                                      ÿ
er case */                                          options = overlay("R
options,pc,7)             ÿ
RECEIPT" data                                         datÿ
                                                        Select
                                           ÿ
 '"' then do                                                      pl   =
>",data)                                                            rece
ft(data,pl)                                                 ÿ
                                                                 when le
1) = "'ÿ
os(">",data)
t = left(data,pl)
                      ÿ
ft(data,1) = '(' then do
   = pos(")",data)
rse value daÿ
  end                              ÿ
therwise
    receipt = word(data,1)     ÿ
      pl   = length(receipt)                      ÿ
end
lopt = left(options,pc-1)                       ÿ
  ropt = substr(options,p2+pl+1)                                 ÿ
    options = strip(lopt ropt)
    upper_options = translate(options)                           ÿ
      call process_address receipt
ÿ
        receipt_n.1 = strip(t_names.1)
  ÿ
               ÿ
         /* -------------------------- *
          * HTML Keÿ
            * ----------------ÿ
             if wordpos("HTML",upper_options) > 0 then do
                pw = wordpos("HTML",ÿ
                  upper_options = delword(uppÿ
                    options = delword(options,pw,1)
                    enrich = "html"                  ÿ
                      end                                   ÿ
                     else enrich = "plain"
                                                                      ÿ
                       /* -------------------------- *
                          * MURPHY Keyword.            *
                          * -------------------------- */
       ÿ
          ÿ
                                upper_options = delword(upper_options,pw
                        ÿ
                         ÿ
                                    end
                                         +
                                   /* -ÿÿ
                                        * DEBUG Keyword.             *
                                        * -------------------------- */
                                       if wordpos("DEBU+
 then do                                      pw = woÿ
ns)                                             upper_options = delword(
tions,pw,1)                                     options = delword(option
)                                                 debug = "on"      ÿ
                                                    end

            ÿ
 * ÿ
   *                                                  * ----------------
-- */                        ÿ
upper_options) > 0ÿ
SFILE",upper_options)                                       pc = wordind
_options,pw)                                  ÿ
DDRESSFILE upper case */         ÿ
y("ADDRESSFILE",options,pc,11)                                  address_
ord(options,pw+1)                                              ÿ
ord(options,pw,2)                               ÿ
s = delword(upper_options,pw,2)                                     if "
ysdsn(address_file) then do
ÿ
msgid "correct and retry."
 4
                 ÿ
oc f("eddd") ds("address_file") shr reuse"
cio * Diskr" eddd "(Finis Stem addr."
 = 1 to addr.0                    ÿ
 addr.i = strÿ
   end
"Free  f("eddd")"                                  ÿ
  Call Process_Address_File ÿ
    end
                                                                    ÿ
   /* -------------------------- *         ÿ
      * ADDRESSFILEDD Keyword.     *
      * -------------------------- */
     +
     ÿ
              pc = wordindex(upper_options,pw)
              /* make the word ADDRESSFILE upper case */
                optionÿ
                    address_filedd = word(options,pw+1)
                    options = delword(options,pw,2)
                    upper_options = delÿ
      ÿ
                        if sysreason+0 <> 3 then
                           if sysreason+0 <> 27 then    ÿ
                     ÿ
                                     say msgid address_filedd "Invalid -
ocated"                              say msgid "correct and retry."
                                    ÿ
                                          end
                                "Execio * Diskr" address_filedd "(Finis
r."       ÿ
                                       addr.i = strip(left(addr.i,72))
                                       end
                           ÿ
                                        end

                                     /* ----ÿ
 ÿ
                                          * -------------------------- *
                                         if wordpos("FILEDESCÿ
> 0 then do     ÿ
tions)                                          pc = wordindex(upper_opt
                                                /* make the word FILEDES
r case */                      ÿ
,options,pc,8)                                      if pos("(",word(opti
)) > 0 then do                                         parse value optio
x "FILEDESC" "(ÿ
C from options */                                          lq = pos("(",
pc)                                                        options = ove
,options,lq,1)                  ÿ                            ÿ
ons,pc)                                                        options =
options,pc,rq-pc+1)                                            upper_opt
elstr(upper_options,pc,rq-pc+1)                  ÿç
nd
 do
 filedesc = word(options,pw+1)                                    ÿ
   options +
     uppeÿ
       end
  filÿ
    end                 ÿ

   /* ----------------ÿ
      * FILENAME Keyword.          *   ÿ
        * -------------------------- */
       if wordpos("FILENAME",upper_optiÿ
            pw = wordpos("FILENAME",upper_options)    ÿ
              pc = wordindex(upper_options,pw)
              /* make the word FILENAME upper case */   ÿ
                options = overlay("FILENAME",options,pc,8)           ÿ
                  if pos("(",word(options,pw+1)) > 0 then do
                     parse value options with x "FILENAME" "(" filename
                       /* now remove FILENAME from options */
    ÿ
                         options = overlay(" ",options,lq,1)
          ÿ
                   ÿ
                             upper_options = delstr(upper_options,pc,rq-
                           ÿ
                            else dÿ
                                   filename = word(options,pw+1)
                                   options =ÿ
                                     upper_optionÿ
2)                                     end
                                  filename = strip(filename) ÿ
                                    end                         ÿ

                                   /* -------------------------- *
                                      * FILEDD Keyword.            *

                                       if wordpos("FILEDD",upper_options
en do          +
             ÿÿ
                                                /* make the word FILEDD
se */                                           options = overlay("FILED
ns,pc,6)                     +
)) > 0 then do             ÿ
h x "FILEDD" "(" FILEDD ")" more                         /* now remove F
om options */                                    ÿ
pc)                                       ÿ
 ",options,lq,1)                                             rq = pos(")
s,pc)                                                        optioÿ
options,pc,rq-pc+1)                                      ÿ
 delstr(upper_options,pc,rq-pc+1)                                end
                                                              else do
   ÿ
word(options,pw+1)                                                     o
 delword(options,pw,2)                                                 u
ions = delword(upperÿ
       ÿ

                                     ÿ
------------------ *  ÿ
eyword.              *
 for file to be      *                                ÿ
 as an attachment.     *             ÿ
ext Only)                *
------------------------ */                                            ÿ
wordpos("FILE",upper_options) > 0 then do           ÿ
  pw = wordpos("FILE",upper_options)
  options = strip(delword(options,pw,1))
  upper_ÿ
      if left(word(options,pw),1) <> "(" then do
         fdsn = word(options,pw)
         options = strip(ÿ
  ÿ
             file = fdsn
             end                          ÿ
             elseÿ
                   lp = 1
                    fdsn = word(options,pw)                +
                      options = ÿ
                          upper_options = strip(delword(upper_options,pw
                          if translate(left(fdsn,8)) = "*CREATE*" then d
                             parse value fdsn w+
                                 lp = null   ÿ
                                   end
                                if right(fdsn,1) = ")" then do
             ÿ
                                          fdsn = substr(fdsn,1,length(fd
                                          lp = null
                              ÿ
                                           if right(fdsn,3) = ")')" then
                                              fdsn = substr(fdsn,1,lengt
1)                                            lÿ
          ÿ
                                               end
                                            if left(fdsn,1) = "(ÿ
                         ÿ
dsn)-1)                                         file = strip(file fdsn)
                                                if length(options) = 0 t
eÿ
                                                 if lp = 1 then
                                                       file = substr(fil
th(file)-1)       ÿ
                                                   if translate(word(fil
"*CREATE*" then iterate                            if "OK" <> sysdsn(wor
)) then do                         ÿ
                                                           say msgid "DS
(file,i) '-' sysdsn(word(file,i))                          end
                                                    ÿ
     ÿ
because of invalid dsnames."                                  exit 4
                                                              end    ÿ
                    ÿ
                                                            end

      ÿ
--------------------------------------- *                       * Any th
 in options is invalid at this point    *                       * ------
-----------------------+
rip(options)) > 0 then ÿ
id "keyword(s)" options
id "is invalid in the syntax of this command."                   ÿç
       signal exit_4                                ÿ
         end

ÿ
          * Test if to=*list-id  then must have cc or bcc         *
          * ----------------------------------------------------- */
            if ÿ
      ÿ
                      say msgid "A *list-id* address must have a CC or"
                              ÿ
                       ÿ
                          signal exit_4
                          end                ÿ
                                        ÿ
                     /* ------------------------------------------------
                      * Test Validity of all e-mail addresseÿ
*                       * -------------------------------ÿ
- */                      parse value "" with t_address t_cc t_bcc
                          do i = 1 to words(address)
                               call test_address word(address,i)
                                 if trc = 1 then
                                    t_address = strip(t_address test_add
          ÿ
           ÿ
,i))                                 end
                         ÿ
                            ÿ
                                         if trc = 1 then
                                        ÿ
                                           elÿ
                                                t_cc = strip(t_cc word(c
                                             end       ÿ
                                            do i = 1 to words(ÿ
                                                 call test_address word(
                                                 if trc = 1 then      ÿ
                                                      t_bcc = strip(t_bc

                                                          t_bcc = strip(
rd(bc+
   ÿ
                ÿ
                                                          bcc     = t_bc
                  ÿ
                                 ÿ
------------------------------------- *                       * If MSGQ
fied then read in the QUEUED messÿ
--------------------------------------- */        ÿ
en do                                                                msg
ued()                                           ÿ
to msgqc                                                           ÿ
e pull msgqd
 = msgqd                                                       ÿ
d
= msÿ


---------------------ÿ
Test for MSGDS, MSGDD or   *
MSGQ unless Nÿ
* -------------------------- */       ÿ
 if nomsg = null then do
 if length(dsn) + length(ddnÿ
      say msgid "Neither the MSGDS, MSGDD, NOMSG" ,    ÿ
                  "or MSGQ were specified."
        say msgid "Command terminating - trÿ
          signal exit_4
            end
                                                          ÿ
           /* ----------------------------------------------------- *
         ÿ
              * create dsn....                                        *
                * -----------------------------------------------------
                if dsn = "ÿ
                     if sysvar('sysispf') <> "ACTIVE" then do
        ÿ
."                        say msgid "Try ag+
                            exit 4       ÿ
                       +
                     ÿ
                                    "Alloc f("eddd") unit("vÿ
 dsorg(ps)" ,                               "recfm(v b) lrecl(76) new re
ize(0)"                             ÿ
                                           o.1 = "<html><body><pre>"
                                             "Execio * diskw "eddd" (fin
o."                                          o. = nÿ
                                               end
              ÿ
                                              "LMInit dataid(xmiteÿ
ddd")"                                          edtitle = "XMITIP Messag
                               ÿ
                                                  "Edit dataid(&xmited)
xÿ
xmitiped)"                                      ÿ
                                                      ddn  = eddd
                ÿ
                                                        Address Tÿ
                                                          if e_rc > 3 th
                               ÿ
                                                               say msgid
 pÿ
                                              ÿ
                                                                end
                   ÿ
                                                             ÿ
                                                           /* ----------
-------- *                          ÿ
cified     *                                                  * process
or MSGDD     *                                                  * ------
------------ */                                      ÿ
l then do                                                              i
n          ÿ
stdsi(ddn "FILE")                                                     ÿ
tatype(syslrecl) <> "NUM"
en syslrecl = 0           ÿ
e_lrecl = max(syslrecl, save_lrecl)
 = sysd+
nd   ÿ
else if dsn <> "*" then do             ÿ
       if "OK" <> sysdsn(dsn) then do
          say msgid "Mesÿ
            say msgid dsn sysdsn(dsn)                 ÿ
              say msgid "Terminating - try again."
              exit 4                     ÿ
                end                                                  ÿ
               call listdsi(dsn)
               save_lrecl = max(syslrecl, save_lrecl)     ÿ
                 end
    ÿ

                if ddn = null then
                   ÿ

            ÿ
                    e_rc = rc     ÿ

                     /* -----ÿ
                        * fix up message lines thÿ
                          * first . will be lost via smtp...
                          * And count bytes   ÿ
 */                         do i = 1 to in.0                    ÿ
                                 if left(in.i,1) = "."
                                    then in.i = "."in.i        ÿ
                                   bytes = bytes + length(in.i)

                                  save_bytes = bytes
ÿ
              ÿ
                                      if msgds = "*" then
                 ÿ
d")"                         ÿ
                                             say msgid "Error in reading
 file.",                          ÿ
                                            ÿ
                                                 end
                                              end  +
                                                 ÿ
                                                 /* -----ÿ
                                                    * reset indd
                                                    * --------------ÿ
                                                     indd   = "XMDD"rand

                                                       /* --------------
-----ÿ
e to beÿ
----------------------------------- */                     if murphy = "
 do                   ÿ
()                    ÿ
 1                                                                in.n
                                       ÿ
                                     ÿ
.0 + 1                                                                in
                                                        ÿ
n                                                   ÿ
len = 1 to length(murph)
char = substr(murph,murlen,1)
f murchar = "0A"x then do   /* New line of Murphy ? */             ÿ
    n     = in.0 + 1
    in.n  = ""
    in.0  ÿ
  ÿ
     else in.n = in.n""murchar
     end                   ÿ
    end          ÿ

   /* -------------------------- *          ÿ
      * Process SIGnature       ÿ
        * -------------------------- */
        if length(sigdsn) + length(sigddn) > 0 then do       ÿ
             if sigdsn <> null then do         ÿ
                  "ALLOC F("indd") DS("sigdsn") SHR"
                  end
                 else do                                      ÿ
                      save_dd = indd
                      indd = sigddn
               +
               ÿ
                           e_rc = rc
                           if sigddn = null then
                              "Fÿ
          ÿ
                                  indd = save_dd
                               if e_rc > 0 then dÿ
                         ÿ
                                                "Ending XMITIP."
                                      exit 8                      ÿ
                                        ÿ
                                       m = in.0 + 1
                                       in.m = "  "
   ÿ
                                           if enrich = "html" then do
                                              m = in.0 + 1
                    ÿ
                                                  in.0 = m
                                                  end
                                     ÿ
     ÿ
                                                      in.m = sig.i
                                                      ÿ
                    ÿ
                                                       end
                                                                       ÿ
                                   ÿ
------------------------------- *                       * Fix the defaul
ddress to support nje if the    *                       * note originate
than wheÿ
ddress                              *                       * ----------
----------------------------------- */                     if from = nul
o                        ÿ
                                                                  from =
fault                                                             end
                                          ÿ                      call te
ÿ
en from = test_address                                             sende
                                                           ÿç
               +
   /* -------ÿ
      * Fixup ReplyTo              *
        * -------------------------- */
       if replyto <> null thÿ
            call test_address replyto
            if ÿ
              end                          ÿ

             /* ----------------ÿ
                * Fixup Receipt              *            ÿ
                  * -------------------------- */
                 if receipt <> null then do      ÿ
                      call test_address receipt
                        if trc = 1 then receipt = test_address
                        end                                       ÿ

        ÿ
                          * Fix SUBJECT.               *
   ÿ
                       ÿ
                                Select
                    ÿ
                                      ÿ
:" file                                     else subject = "Multiple Fil
                                    Wÿ
                                      When nomsg = "oÿ
ge from" from                           otherwise subject = "Note from"
                                        end           ÿ
                                                                    ÿ
                                         if confirm = null then do
                                            Say msgid "XMITIP Applicatiÿ
l:" ver                                       say msgid " "
   ÿ

        ÿ
------------------ÿ
                          *                       * --------------------
-------------------------+
                       ÿ
                               ÿ
 then  do                                                   say msgid su
,1,64,"-")                                ÿ
: " ,                                         ÿ
OM or REPLYTO keyword specified.",
g Default."                                                ÿ
lys to this e-mail will be delivered to" ,                   ÿ
SO address:"                                                        say
 " from                                                             say
"These must be read using the TSO RECEIVE command."                   sa
d substr("-",1,64,"-")
d " "
             ÿ
           ÿ

------------------------------ÿ
ild e-mail header used by ÿ
----------------------------------------------------- */
confirm = null then do                         ÿ
  say msgid "Message Addressing Informatiÿ
    end
 if interlink = 0 then do                                       ÿ
      header.1 = "helo" center                          ÿ
        header.2 = "mail from:<"from">"
        h = 2
 ÿ
         else do
              header.1 = "X-From:"from
              h = ÿ
      ÿ
             xhead = "From: "
             if confirm = null thenÿ
                  Sayÿ
                 xhead = "To:   "
                 address = strip(address)           ÿ
                   if interlink = 0 ÿ
                        rcpt = "rcpt to:"
                     else                                            +
                          rcpt = "X-To:"           +
                           do i = 1 to words(addrÿ
                                if left(strip(address),i) = "*" then ite
                                h = h + 1
      ÿ
                                    if confirm = null then
                                       Say msgid xhead word(address,i)
                       ÿ

                                     xhead = "Cc:   "
                                     if ÿ
              ÿ
                                            h = h + 1
                                            header.h = rcÿ
                             ÿ
                                                      Say msgid xhead wo
                                                xhead = "      "
                                            ÿ
                                                 xhead = "Bcc:  "
                                                 if length(bcc) > 0 then
           ÿ
                                                        h = h + 1
                                                        header.h = rcpt"
cc,i)">"                    ÿ
en                                                                Say ms
d word(bcc,i)                                               xhead = "
                                             ÿ
         ÿ
                                                             header.h =
                                                              ÿ
                        ÿ
----------------------------------------- *                       * Now
e mail envelope                           *                       * ----

 = null then
id " "                                                                if
 = null then    ÿ
 msgid "The Mail Envelope:"
alue date("s") date("m") with yy 5 . 7 dd 9 10 mm 13 .
 1                               +

            if confirm = null then
               say msgid header.h
    ÿ
                  h = h + 1
                  header.h    = "Priority:" priority
                  iÿ

                   if importance <> null then do
                      h = h + 1   ÿ
                ÿ
                          if confirm = null then say msgid header.h
                          end                    ÿ
                         if sensiÿ
                              h = h + 1
                              header.h    = "Sensitivity:" sensiÿ
                                if confirm = null ÿ
                                  end
                               h = h + 1

e                                  if confirm = null then
                                      Say msgid header.h
              ÿ
    ÿ
                                          header.h = "From:    " '"'from
'from'>'                     ÿ
                     ÿ
                                           h = h + 1
                                           iÿ
                                      ÿ
                                                     header.h = "Reply-T
replyto_n.1'" <'replyto'>'                        else     ÿ
                                                       ÿ
 replyto                                              if confirm = null
                                                         say msgid heade
                                                        h = h + 1
                                                          end
                                                       if receipt <> nul
o        +
ll thenÿ
eturn-Recÿ
'" <'receipt'>'                                                   else
                      ÿ
= "Return-Receipt-To: " reÿ
 = null then
id header.h                          ÿ
1                                          ÿ
                                                                       t
 "To:      "                                        ÿ
 = ","                                                      ÿ
= 1 to words(Address)
  if i      = words(address) then comma = " "                      ÿ
    addr      = word(address,i)
      if address_n.i <> null then
         addr = '"'strip(address_n.i)'" <'addr'>'
  ÿ
        if conÿ
             say msgid header.h
          to_headÿ
            h = h + 1          ÿ
              end
       if length(strip(address))ÿ
            header.h  = "To:      " save_addressÿ
              if confirm = null then
                 say msgid header.h            ÿ
                h = h + 1                                        ÿ
                  end
               cc_head = "Cc:      "                          ÿ
                 do i = 1 to words(cc)
  ÿ
                          if cc_n.i <> null then
                               addr = '"'strip(cc_n.i)'" <'addr'>'
                   ÿ
                              cc_head = "         "
            ÿ
                                   sÿ
                                  h = h + 1
                           +
                         ÿ
ec on MVS"                       h = h + 1           ÿ
                                   header.h    = "Subject: " subject
                                   if coÿ
                                        say msgid header.h            ÿ
                                       header.0 = h
                                       out.  = null    ÿ
                                         out.0 = 0
       ÿ
                                           /* ------------------------ÿ
                                              * If FILE used then setup
                        ÿ
                                                * ----------------------
     ÿ
) > 0 × enrich = "html" then do          ÿ
jul65lrhg.0x0zax1d"                                   char = '"iso-8859-
                    ÿ
0"                                                      mhÿ
multipart/mixed; boundary="'bnd'"'                        mh.3 = " "
                                   ÿ
lti-part message in MIME format."                           mh.5 = "--"b
                                                              mh.6 = "Co
pe: text/"enrich"; charset="char                  ÿ
Transfer-Encoding: 7bit"                                        mh.8 = "
            ÿ
                                                                 ÿ
ut.0 + 1                                                               n
                             ÿ
 mh.i
ÿ
                                              ÿ
                                                                       /
---------------ÿ
e out message.         *                                       ÿ
------------------------ */
gq = 1 then nomsg = null      ÿ
in.0 > 0 then do
ÿ
  out.0 = out.0 + 1                          +
    n = out.0                              ÿ
      out.n = "  " +
     if substr(inÿ
       do i = 1 to in.0                                   ÿ
            save_lrecl = max(save_lrecl,length(out.n))
            if save_lrecl > 1024 tÿ
              out.0 = out.0 + 1
                n = out.0
                if msg72 = 1 then                  ÿ
                     out.n = left(in.i,72)
        ÿ
                    end                                             ÿ
                      end
                   elseÿ
                          n     = out.0 + 1
     ÿ
                            out.0 = n ÿ
                              end
                      ÿ
                           /* -----------------------ÿ
                              * Write out FILE attachment  *
                              * -------ÿ
                               if length(file) > 0 then             ÿ
                                 do f = 1 to words(file)
                                       t  = translate(woÿ
                                         tl = word(format,f)
   ÿ
                                           if pos("(",file_dsn) > 0 then
                                                parse value file_dsn wit
member ")" .      ÿ
                                               if translate(file_dsn) =
*" then doÿ
                                 ÿ
                                                      end
                           ÿ
                                                ÿ
                                                          say msgid file
ror - can not process RECFM=U",             ÿ
                                                            exi+
                                                             ÿ
                                                             mh+
                                                             ÿ
nfo                                                              save_by
bytes                                                              "ALLO
d") DS("file_dsn") SHR Reuse"                                      in. =
                                                                     "EX
ISKR" indd ÿ
                                                                       "
indd")"        ÿ
cnt = 1 to in.0           ÿ
tes = bytes + length(in.bytecnt)
d                               ÿ
l test_limit                             ÿ
f e_rc > 0 then do
  say msgid "Error reading file:" file_dsn ,     ÿ
              "Ending XMITIP."                          ÿ
      exit 8
      end                                                         ÿ
     if confirm = null then do                                         ÿ
          Say msgid "File:    " file_dsn
          end
   ÿ
      ÿ

     /* ------------ÿ
        * Write out Fÿ
          * -------------------------- */
         if length(filedd) > 0 then  ÿ
           do f = 1 to words(filedd)ÿ
                   fd = f + words(file)
                   t  = translate(word(format,fd))    ÿ
                     tl = word(format,f)           ÿ
                       file_ddn = word(filedd,f)
                       call listdsi(file_ddn "FILE")                   ÿ
                         if sysrecfm = "U" then do                ÿ
                              say msgid file_dsn "error - can not proces
U",                                    "datasets."
        ÿ
 +

                           +
                         ÿ
              ÿ
                                       "EXECIO * DISKR" file_ddn "(FINIS
."                                     if ÿ
                             ÿ
le_ddn ,                                                "Ending XMITIP."
                                              exit 8       ÿ
                                            ÿ
                                               do bytecnt = 1 to in.0
                                                  bytes = bytes + length
tecnt)                                              end    ÿ
                                                   call test_limit
                                                   if confirm = null the
             ÿ
le_ddn                                                    end
                                                       call process_file
                              ÿ
         ÿ
                                                     /* ----------------
----------------------------- *                ÿ
ments then write out endÿ
                                  *                       * ------------
--------------------------------- */                     if lengÿ
gth(filedd) > 0 then do                ÿ
                                                                out.i =
--"                                                             out.0 =
 ÿ

                                                                 /* ----
------------------ÿ
 size_limit .........                         *                       *
--------------------------------------------- */                      by
                                   ÿ
nt =ÿ
es = bytes + length(out.bytecnt)
                                                    ÿ
 test_limit        +
                 ÿ
* ----------------------------------------------------- *              ÿ
°
              * the OS/390 TCP/Iÿ
                * -----------------------------------------------------
        ÿ
                     if writer <> null then do ÿ
                          writer_kw = "Writer("writer")"
                         ÿ
                            end                               ÿ
                           else dest_kw = "DEST("smtp_address")"
                          "ALLOC F("workddÿ
                               "recfm(v b) lrecl("save_lrecl+4") blksize
riter_kw                        end
                           else do                         ÿ
                                  space = (out.0 * save_lrecl)/34000
            ÿ
                                    space = space + 1
                                      space = space","space
                           ÿ
ace") tr" ,                                "recfm(v b) lrecl("save_lrecl
size(0)"     ÿ
                                          ÿ
                                       /* ------------------------------
--------------- *             ÿ
.                 *                       * -------------ÿ
------------------- */                      if rc > 0 then do
                                               ÿ
o" smtp_address                                  say msgid": contact you
rog to fix this"                                   exit 4
                                                   end          ÿ

       ÿ
--------------------------- *                       * Setup suffix to be
 ÿ
----------------------ÿ
                                                       suf.1 = "  "
                  ÿ
o                                    +
                                   ÿ
                                     +
                                   ÿ
                                                  ÿ
1
                                                    ÿ
--------------------------------------------- *                  ÿ
out the header then the data and finally the    *
.  Close and free the output to the SMTP        *                    ÿ
er.                                               *
ÿ
ebug <> "on" then do
XECIO ÿ
"EXECIO * DISKWÿ
  "EXECIO * DISKW" workdd "(FINIS STEM suf."
  if smtp_secure <> nulÿ
       "Transmit" smtp_addressÿ
         "FREE F("workdd") Delete"
         end                            ÿ
        else                                 ÿ
          "FREE F("workdd")"
          end                                            ÿ
         else do                                            ÿ
                say msgid "XMITIP Debug Option Enabled"
                say msgid "The following is the generated message:"
                  say " "
                    do deb = 1 to header.0
                       say header.deb
           ÿ
          ÿ
                           say out.deb
                           eÿ
                         ÿ
                               say suf.deb
                               end           ÿ
                              say " "   ÿ
                                say msgid "XMITIP Debug Report ending."
                                say " "                       ÿ
                                  end                  +
                                                     ÿ
                                 /* -------------------------- *
 +

                                       if confirm = null then do

                ÿ
---ÿ
Nadel               *                       * --------------------------
------------------- */           ÿ
,abc,def', ,      ÿ
,'), ,                                                          '0123456
f'),'L',',')                                    byÿ
                                 ÿ
                                                      say msgid " "
                                                      say msgid "Meÿ
um lrecl is:" save_lrecl+4                      ÿ
                                                          say msgid "Mes
cessfully transmitted"                                    if length(sigd
ngthÿ
ignature file used:" sigdsn                                      end
                                                              if debug =
en send_msg = "Not-Seÿ
  else send_msg = "Sent"                                          say ms
_msg out.0+header.0 ,                                                 "r
s text, attachments," ,               ÿ
trol informatÿ
"Approximate byte count is:" bytes                                    en
                                                       ÿ
                            ÿ
----------------------------------------------- *
ne - now delete any Create DSNs                 *
-------------------------------------------ÿ
ss TSO
sg("off")
ngth(creaÿ
  do i = 1 to words(create_dsns)
     deldsn = word(create_dsns,i)
     "Delete" deldsn      ÿ
Ð

               /* -------------------------- *         +
        ÿ
                      * -------------------------- */
                     exit 0
                       ÿ
                         /* --------------------------------------------
- *                       * Sub-routines used by the application.
  *                       * ----------ÿ
--- */   ÿ
                             /* ----------------------------------------
----- *                       * set file info for repÿ
        *                 ÿ
--------- */                      set_file_info:
                                  parse value "" with type zip suffiÿ
                                    if leftÿ
                                         t  = null
                                         tl = null
   ÿ
                                          parse value t with fmt1 "/" fm
mt3 "/" fmt4 "/" fmt5 ,                                      "/" fmt6
                  ÿ
l "/" fmt3l "/" . "/" . "/" fmt6              fmt1 = strip(fmt1)
                                              fmt2 = strip(fmt2)
                                 ÿ
              ÿ
                                                  fmt5 = strip(fmt5)
                                                ÿ
                               ÿ
                                                      fmt2l = strip(fmt2
                                                      fmt3l = sÿ
                                                ÿ
                                                             When left(f
 "ZIP" then do                                                    parse
"" with type enrich suffix html_color ,                          ÿ
     z_type zip                                                       if
e = null then do
id "The ZIP o+
sgÿ
xit 8
nd
mt1   = "ZIPHTML" t+
   type   = "HTML" ÿ
     enrich = "html"
     suffix = ".html"                    ÿ
       html_color = fmt3            ÿ
         end
      if fmt1   = "ZIPRTF" then do                      ÿ
           type   = "RTF"                            ÿ
             suffix = ".rtf"
             end                                                       ÿ
            if fmt1   = "ZIPBIN"  then do                             ÿ
                 type   = "Binary"
                 z_type = "ZIPBIN"
      ÿ
       ÿ
                  if fmt1   = "ZIPPDF" then do
                     ÿ
                       sÿ
                         end
                      if fmt1   = "Zÿ
                           type   = null ÿ
                             suffix = ".txt"
                             end                   ÿ
                            zip  = fmt1                   ÿ
                              end
                         When fmt1 = "HTML" then do               ÿ
                                type = fmt1
                                  html_color = fmt2
                                  enrich = "html"
 ÿ
            ÿ
                                         else suffix = ".html"
                ÿ
                             ÿ
                                          type = fmt1
                               +
                             ÿ
                                                   else suffix = ".rtf"
                                                   end
                                           Wÿ
                                                    type = "Binÿ
                                                      if fmt2 <> null
                                                         thÿ
                                                           else suffix =
ÿ
                                                     When fmt1 = "PDF" t
                                                            type = fmt1
                 ÿ
                                                              end
         ÿ
n do                              ÿ
l                                                                    the
 = fmt2                 ÿ
ix = ".txt"                                        ÿ
                                                                 otherwi
                                       ÿ
e = null                                                            ÿ
uffix = fmt1l
nd                                                    ÿ

     ÿ
te(suffix) = "X" then                                                ÿ
x = null
x <> null then        ÿ
left(suffix,1) <> "." then
suffÿ
                                       ÿ
sc = strip(word(filedesc,f))
 pos("/",desc) > 0 ÿ
   parse value desc with file_name "/" desc_d           ÿ
  else do
       file_name = null           ÿ
         desc_d = desc
           end
      if file_name <> null then do               +
           say msgid "-------------------------ÿ
            ÿ
               say msgid "changed to FILENAME.  FILEDESC will remain as"
               say msgid "the keyword for the description."   ÿ
                 say msgid "s+
                   say msgiÿ
                     end
                   if file_name = null then
                      file_name = strip(wordÿ
                     if translate(file_name) = "X" then
            ÿ
                                                             ÿ
                          mh. = null
                          iÿ
                               then mh_suf = ".zip"
                              else if suffix <> null
                                   then mhÿ
                                     else mh_suf = null
               ÿ
                                     if left(file_dsn,1) ÿ
                                       name = substr(file_dsn,2,length(f
-2)""mh_suf                     ÿ
                                         if pos("(",file_dsn) > 1 then d
                                              parse value file_dsn with
me ")" .                                      namÿ
                                                end
       ÿ
                                               end                ÿ
                                              if mh_type = "ddn" then
                      ÿ
mh_suf'"'                                       if file_name <> null the
   ÿ
                                     ÿ
                                                    mh.1 = "--"bnd
                    ÿ
ename,4)),".HTM HTML") > 0 then do                  ÿ
'                                                           mh.2 = "Cont
: text/enrich; charset="char";"      ÿ
                                                          else do  +
                                                               ifÿ
then                                                    ÿ
ntent-Type: text/plain;"                                           if ty
F" then do                                                            mh
ÿ
                                                                       ÿ
 = "HTML" then
 = "Content-Typÿ
d
os(left(ÿ
2 = "Content-Type: applicationÿ
_type = "base64"
nd                       ÿ
.3 = "              name="name               ÿ
mh.4 = "Content-Transfer-Encoding:" m_type
mh.5 = "Content-Disposition: attachment;" ÿ
  mh.6 = "   filename="name                                 ÿ
    if mh_type = "dsn" then
       mh.7 = "Content-Description:" strip(file_dsn,"B","'"ÿ
      else
           mh.7 = "Content-Description:" file_ddn""mh_suf
        if desc_d <> null then
             if desc_d <> "x" then
          ÿ
            mh.8 = " "
            dÿ
                 out.0 = ÿ
                   n = out.0
                   out.n = mh.ÿ
                     end                ÿ
                    return
                                               ÿ
                     /* -------------------------------ÿ
*                       * Test size limit and if we're over exit
*                       * --------------------------------------ÿ
- */                      Test_Limit:                                 ÿ
                            over = bytes - size_limit
                            if size_limit > 0 then
 ÿ
     +
 thÿ
size:" bytes        ÿ
r                                         say msgid "              limit
e_limit           ÿ
                                     +
                                   ÿ
                                 ÿ
                                           /* --------------------------
------------------- *                       * procesÿ
                      *                       * ÿ
----------------------- */                      Process_file:
                                                     start_out = out.ÿ
                                                       if printÿ
do_cc = 1                                                              e
c = 0                                                    if confirm = nu
do    ÿ
                                                                if pos("
1) > 0 then as = "as Rich Text"                                    else
<> null                ÿ
s = "as" typeÿ
,3) <> "ZIP" then                                                      s
 "-records:" in.0 as                    ÿ
me <> null then             ÿ
sgid "as attachment name:" file_name
                                                         ÿ
sysrecfm,1) = "A" then do_cc = 1           ÿ
t(sysrecfm,1) = "M" then do_cc = 1
 = "RTF" then do
yle    = fmt2                                             ÿ
size     = fmt3
if size = null then size = 9
if datatypeÿ
       say msgid "Error: Font size of" size ,
                 "invalid."
       say msgid "Ending Proÿ
        ÿ
           end
        paper    = fmt4                      ÿ
          margins = wor+
            call do_rÿ
              end                                               ÿ
             if fmt1 = "PDF" then do
                pdf = null          ÿ
                  if fmt2 <> null then
 ÿç
                                if fmt3 <> null theÿ
                                     pdf = pdf "FONT" fmt3
                  ÿ
                                       pdf = pdf "PAPER" fmt4     ÿ
                                      if fmt5 <> null then
                                   ÿ
                                        call do_pdf
 ÿ
                                       if fmt1 = "ZIÿ
                                            pdf = null
                ÿ
                                                 pdf = "ORIENT" fmt3 ÿ
                                                if fmt4 <> null then
                               ÿ
                                                  if fmt5 <> null then
      ÿ
                                              ÿ
                                                         pdf = pdf "LPI"
                       ÿ
                                                        end  ÿ
                                                       if fmt1 = "ZIPRTF
o                                       ÿ
                                                            size     = f
                                                              if size =
n size = 9                                               ÿ
) <> "NUM" then do                                                 say m
ror: Font sÿ
invalid."                                                            say
 "Ending Process."                                                     e
                          ÿ
                                                                      pa
 fmt5      ÿ
= word(margin,f)                         +
o_rtf_head                             ÿ
                              ÿ
s("HTML",translate(fmt1)) > 0 then call do_html
s(left(type,3),"ZIP Bin PDF HTM") = 0 then do         ÿ
bytes = save_bytes                             +
  do i = 1 to in.0                           ÿ
       skip_record = 0                                               ÿ
         if pos("RTF",fmt1) > 0 then call do_rtf
         else if do_cc = 1 then call do_cc                    ÿ
           if skip_record = 1 then iterate
    ÿ
             n = out.0

               if lÿ
                    in.i = "."in.i
                ÿ
                   save_lrecl = maÿ
                     if save_lrecl > 1024 then signal big_lrecl
                     bytes = byteÿ
                       end                       ÿ
                      call test_limit
                      end                         ÿ
                     if pos("RTF",fmt1) > 0 then call do_rtf_endÿ
                       if left(fmt1,3) = "ZIP" then do
                          if wordpos(fmt1,"ZIP ZIPRTF ZIPPDF ZIPHTMÿ
n                              suf = strip(substr(fmt1,4))

                                 fi = 0
    ÿ
              ÿ
o                                       drop in.
                     ÿ
                             ÿ
                                               fi = fi + 1
                                      ÿ
                                            ÿ
                                                   if lrec <= len then
                                                      lÿ
                                                     out.fo+
                                                       enÿ
                                                      out.0 = start_out
                                                        in.0 = fi
                                                        end
                                                       else do fi = 1 to
           +
i)       ÿ
then   ÿ
                                                                  end
                          ÿ
n suf = "txt"         ÿ
ork."eddd"."suf                                                  call ms
                                           ÿ
ork                                  ÿ
ddd") ds("zipwork") new" ,
,300) Recfm(V B) lrecl("lrec+8")" ,                         ÿ
size(0) reuse"                                      ÿ
 * diskw" eddd "(Finis stem in."
("eddd")"                                                             if
pe = "ddn" then                                                    ÿ
e_dsn = "DD:"file_ddn
ile_dsn = file_dsn
sn = zipwork  ÿ
onÿ
 say msgid " zip'ing file" save_file_dsn
 if fmt2l <> null then         ÿ
      say msgid "ÿ
     end
  save_bytes = bytes                            ÿ
    call do_zip                 ÿ
      "Delete" zipwork
      end                                                        ÿ
     if type = "Binary" then do                ÿ
          save_bytes = bytes
          call do_base64
  ÿ
      return

     /* -----------ÿ
	
                      * ------------------------------------------------
                     Test_Address: Procedure Expÿ
,           ÿ
                         parse arg test_address
                         inv = 0                                 +
                           ÿ
                               if left(test_address,1) = "*" then return
                               if pos("@",test_address) = 0 then do
                                  if appenÿ
  ÿ
                                           test_address = test_address"@
domain                                     trc = 1       ÿ
                   ÿ
                                          end
                                       p1 = pos("@",test_address)
                                    ÿ
n inv = 1                                  if pos(":",test_address,p1+1)
n inv = 0                                  if inv = 1 then do
       ÿ
est_address") was specified"                      say msgid "The address
 of the format",                                             "userid@lan
t.address"            ÿ
ysvar('sysuid')"@"domain                              exit 8
                                                      end
                                     ÿ
       ÿ
                                                       /* --------------
------------------------------- *                   ÿ
                        ÿ
file into Adobe Acrobat PDF format. *                       * ----------
----------------------------------- */                      Do_PDF:ÿ
                                         ÿ
argin,f)                                                        parse va
ins with left "/" right "/" top "/" bottom                      left   =
efÿ
ip(right)                                                           top
ip(top)                                                             bott
ip(bottom)       +
t = pdf_count +ÿ
  = "PDFWork.pdf"pdf_count".txt"
t = "PDFWork.pdf"pdf_count".pdf"
sg "off"    ÿ
dress TSO
elete" pdf_in
elete" pdf_out               +
  lrec = 0                   ÿ
    do flr = 1 to in.0
       if length(in.flr) > lrec                             ÿ
            then lrec = length(in.flr)        ÿ
           end
        "Alloc f("eddd") ds("pdf_in") new" ,
             "Spa(300,300) Recfm(V B) lrecl("lrec+8")" ,       ÿ
                 "Blksize(0) reuse"
            "Execio * diskw" eddd "(Finis stem in."
          ÿ
ÿ
                   pdf = pdf "LM" left
                if right ÿ
                 ÿ
                    if top <> null then
                       pdf = pdf "TM" toÿ
                      if bottom <>ÿ
                           pdf = pdf "BM" bottom
                        if do_cc = 1 then              ÿ
                             pdf = pdf "CC Yes"    ÿ
                            "%xmitippd in" pdf_in ,
                               "out" pdf_out ,                        ÿ
                                 pdf                                ÿ
                                "Alloc f("eddd") ds("pdf_out") shr reuse
                                "Execio * diskr" eddd "(Finis stem in."
     ÿ
     ÿ
                                    "Delete" pdf_out
                    ÿ
                      ÿ
                                        return
                                   +
                                 ÿ
--------------------- *                       * Do_RTF_Head Routine.
                      *                       * put out rtf headers
                      *                       * ÿ
                          *                       * The paperw/etc numbe
n twips. 1440 per inch.   *                       * --------------------
------------------------- */                      Do_RTF_Head: ÿ

                                                        parse value marg
 left "/" right "/" top "/" bottom
                                                          if left   = nu
left   = 1ÿ
e left   = trunc(left  * 1440)                              if right  =
n right  = 11ÿ
lse right  = trunc(right  *ÿ
 then top    = 1440
 else top    = trunc(top    ÿ
ll then bottom = 1440                       ÿ
     else bottom = trunc(bottom * 1440)
                                           ÿ
--------------------------------------------- *              ÿ
the paper size values (width/height)            *
----------------------------------------------- */        ÿ
= strip(translate(paper))
h  = 12240
ct
 when pos("X",paper) > 0 then do
      parse valÿ
        height = h * 1440
        ÿ
          if pos('.',height) theÿ
               parse value height with height '.' .
            if pos('.',ÿ
                 parse value width with width '.'ÿ
                end
           when abbrev("LETTER",paper,ÿ
             when abbrev("LEGAL",paper,3) = 1 then height = 20160 ÿ
               When paper = "LTR" then height = 15840
               When paper = "LGL" then height = 20160+
                 When paper = "A4"  then do        ÿ
     ÿ
                          height = 16833
                          end                                     ÿ
                      ÿ
                         end

 ÿ
                          n = out.0 +ÿ
                            out.n = "{\rtf1\ansi\ansicpg1252\deff0\defta
                ÿ
                              out.n = "{\fonttbl{\f0\fÿ
                                if left(style,1) = "L" then do
                               ÿ
                                      out.n  = "\landscape"            ÿ
                                        h      = width
                                        width ÿ
                                          height = h
        ÿ
                                        n     = n + 1        ÿ
                                          out.n = "\paperw"width"\paperh
                         ÿ
                                            out.n = "\margl"left"\margr"
\margt"top"\margb"bottom                      n     = n + 1
                                          ÿ
                                                n     = n + 1
           ÿ
18 = 9 points */                                  if size =ÿ
8                                                                  else
ize*2                     ÿ
"trunc(size)                                          out.0 = n
                                                        return
                                         ÿ
                                                         /* ------------
-------------ÿ
ne (base on idea/code from          *                   ÿ
 Leland Lucius)                       *                       * Add basi
age header.                   ÿ
then do:                                *                       * Conve+
 column 1 to horizontal line              *                       * Cÿ
in column 1 to a blank line then data line  *    ÿ
- in column 1 to 2 blank lines then data line *                       *
non-blank col 1 to a blank line then data line*                       *
n meÿ
ts data left 1 column to remove cc                *
------------------------------------------------- */
L:                 ÿ
gro+
 ÿ
   text       = "black"           ÿ
     end
  if pos("-",html_ÿ
       parse value html_color with background "-"ÿ
      else text = html_color
      /* --------------------------ÿ
         * Now fixup the color in case abbreviations were used *ÿ
          text       = fix_color(text)
          background = fix_color(background)        ÿ
            if background = null then background = "White"

              n = out.0 + 1                                          ÿ
                out.n = '<HTML><HEAD>'
              ÿ
                     n = n + 1
      ÿ
                       end   ÿ
                      n = n + 1
                      oÿ
                        n = n + 1           ÿ
                          out.n = " BODY { BACKGROUND:" background"; } <
/HEAD>"                   n = n + 1     ÿ
                            out.n = "<BODY><PRE>"          ÿ
                              n = n + 1
                              out.n = "<FONT color="text"ÿ
                                cc = " "
                                  do i = 1 to in.0
                                     save_lrecl = max(save_lrecl,length(
)                                      if save_lrecl > 1024 then signal
l        +
       ÿ
             ÿ
                                                   in.i = substr(in.i,2)
                      ÿ
                              ÿ

                                     ÿ
-------------------------- *                   +
 to &lt, &gt, &quot, &amp    *               ÿ
------------------------------ */                   ÿ
                                                         tranfrom = '&<>
                                                         trantÿ
; &gt; &quot;"                                             do trancÿ
gth(tranfrom)                                                   transt =
                                                                tranchar

  ÿ
anchar,in.i,transt) = 0 then iterate tranc                             t
  pos(tranchar,iÿ
= tranpos + 2    ÿ
eft = left(in.i,tranpos-1)
ight = substr(in.i,tranpos+1)    ÿ
i = tranleft""word(tranto,tranc)ÿ
nd
                                                  ÿ
                                               ÿ
ect
hen cc = "1" then do                                               ÿ
      n = n + 1                                               ÿ
        out.n = "</PRE><HR><PRE>"
        n = n + 1
    ÿ
            end
       When cc = "0" then do
            n = n + 1ÿ
            ÿ
                n = n + 1
                out.n = in.i          ÿ
                  end      +
               When cc = ÿ
                      n = n + 1                          ÿ
                        out.n = "   "
                        n = n + 1       ÿ
                          out.n = "   "
                            n = n + 1
                            out.n = in.i               ÿ
                              end
           ÿç
                                            n = n + 1                 ÿ
                                              out.n = in.i
                            ÿ
                                           When cc = "+" then do
     ÿ
                                             ÿ
in.i))                                              l1 = length(out.n)
                    ÿ
                                                         do c ÿ
                                                              c1 =  subs
c,1)                               ÿ
c,1) = " " then                                                    out.n

                                                  ÿ
                                                         /* machine carr
trol by ISOS */ ÿ
do         /* Before Top of page */                             nÿ
                                                                  out.n
./HR><PRE>"                      ÿ
                                                                    out.
ÿ
                                                  ÿ
' '
               ÿ
8B'x then do         /* Before Top of page */                      ÿ
n + 1
n = "</PRE><HR><PRE>"         ÿ
= n + 1
t.n ÿ
n = n + 1                                    +
  out.n = ' '                              ÿ
    end                ÿ
 When cc = '11'x then do         /* Before 2           */
      n = n + 1                                           ÿ
        out.n = in.i                    ÿ
          n = n + 1
          out.n = "   "
            end                                          +
         When cc = '13'x then do         /* Before 2   ÿ
                n = n + 1
        ÿ
                  n = n + 1
                    out.n = "   "
                    endÿ
                 When cc = '19'x then do         /* Before 3           *
         ÿ
                        out.n = in.i  ÿ
                          n = n + 1
                          ÿ
                            n = n + 1                ÿ
                              out.n = "   "
                              end          ÿ
                           When cc = '1B'x then do         /* Beforeÿ
   */                             n = n + 1
                                  out.n = in.i              ÿ
                                    n = n + 1
   ÿ
                                      n = n + 1
                                        out.n = "   "
                  ÿ
                                     When cc = '09'x then do         /*
           */ ÿ
                                 ÿ
                                              end
                               ÿ
fore 1           */                             ÿ
                                                  out.n = in.i
                                                ÿ
                                               When cc = '01'x +
 /* Before 0           */                             l1 = leÿ
                                                        l2 = lengthÿ
                                                          if l1 < l2 the
= left(out.n,l2,' ')                                      if in.i <> out
n                                                              do c = 1
    ÿ
(in.i,c,1)                                                          if s
.i,c,1) <> ÿ
 overlay(c1,out.n,c) +
                   ÿ
                          ÿ
 then do         /* Before 0           */                             l1
h(out.n)                            ÿ
gth(in.i)                                ÿ
< l2 then out.n = left(out.n,l2,' ')
i <> out.n then                                      ÿ
o c = 1 to l2                                           ÿ
    c1 =  substr(in.i,c,1)
    if substr(out.n,c,1) <> " " then                                  ÿ
         out.n = overlay(c1,out.n,c)                                   ÿ
        end
  end
erwise ÿ
    n ÿ
      out.n = "   "
      n = n + 1         ÿ
        out.n = in.i ÿ
          end
     end                                 ÿ
     end                            ÿ
    n = n + 1
    out.n = "</PRE></BODY></HTML>"                        ÿ
      n = n + 1                                    ÿ
        out.n = "  "
        out.0 = n
          return                                                  ÿ

           /* ----------------------------------------------------- *
            ÿ
 ÿç
    *                       *
    *                       * If Do_CC  =ÿ
      *         ÿ
        *                       *    except for the first record in the
        *                       *  0 in column 1 gets spacÿ
          *                    ÿ
            *                       *  + in column 1 gets data merged in
ous line    *                       *  other in col 1 treated as a 0
              *                       * ------ÿ
----------------- */                      Do_RTF:
                                          if do_cc = 1 then
                                          Select             ÿ
            ÿ
                                                      if i > 1 then
                                                         in.i = "\page"
(in.i,2)                     ÿ
                                                             in.i = subs
2)                                                   when left(in.i,1) =
n          ÿ
 substr(in.i,2)                                          when left(in.i,
 then                                                         in.i = "\l
\par" substr(in.i,2)      ÿ
 "+" then do                                                      parse
t.n with rh i1                                                    l1 = l
)                                        ÿ
ÿ
2 then
1 to l1                                                 ÿ
 =  substr(i2,c,1ÿ
if substr(i1,c,1) = " " then
   i1 = overlay(c1,i1,c)                                               ÿ
  end                             ÿ
t.n = rh i1
ip_record = 1
d     ÿ
n left(in.i,1) = " " then
  in.i = "\par" substr(in.i,2)
machine carriage cont+
 when left(in.i,1) ÿ
        if i > 1 then
           in.i = "\page" substr(in.i,2)
     ÿ
               in.i = substr(in.i,2)
       when left(in.i,1) = '8B'x then    /* before top of page */
            if i > 1 tÿ
                   in.i = "\page" substr(in.i,2)
                else
                   in.i = substr(in.i,2+
               when left(in.i,1) = '11'ÿ
                      in.i = "\line\par" substr(in.i,2)
                 when left(in.i,1) = '13'x then    /* before 2

                     when left(in.i,1) = '19'x then    /* before 3
                          in.i = "\line\line\par" substr(in.i,2)
              ÿ
 */                           in.i = "\line\line\par" substr(in.i,2)
                         otherwise in.i = "\par" substr(in.i,2)
                         end ÿ
          ÿ
                          return
                                            ÿ
                           ÿ
----- *                       * Do_RTF_End Routine
      *                       * put out rtf trailer        ÿ
        *                       * ----------ÿ
--------- */                      Do_RTF_End:
                                  n = out.0 + 1
                                    out.n = "\par }}"        ÿ
                                      out.0 = n
                                      return
         ÿ
                                         /* ----------------------------
----------------- *                       * Do_CC routine.
                  *     ÿ
for printing onÿ
rriage control or     *                       * Machine carriage control
ngly.                 *                +
----------------------- */      ÿ
                                                    if pos("RTF",fmt1) >
return                                              Select
                                                 ÿ
 " then                                                         in.i = s
.i,2)                                                      when left(in.
1" then do                                                      ifÿÿ
n                                                                      i
""substr(in.i,2)                                                    else
                                                                       i
"sÿ
   ÿ
n.i,1) = "0" then do
o_cc_add         ÿ
 = substr(in.i,2)   ÿ
d
ft(in.i,1) = "+" then do        ÿ
ip = i - 1                           ÿ
  in.i = substr(in.i,2)
  l1 = length(out.n)                           ÿ
    if in.i <> out.n then                             ÿ
         do c = 1 to l1
            c1 =  substr(in.i,c,1)                            ÿ
              if substr(out.n,c,1) = " " then                          ÿ
                   out.n = overlay(c1,out.n,c)
                end
            skip_record = 1
        ÿ
         when left(in.i,1) = "-" then do
            ÿ
                call do_cÿ
                  in.i = substr(in.i,2)
                  end      ÿ
               /* Machine Carriage Controlÿ
                 when left(in.i,1) = '09'x then    /* before 1
                      in.i = substr(in.i,2ÿ
                   when left(in.i,1) = '0B'x then    /* befÿ
                          in.i = substr(in.i,2)
                     when left(in.i,1) = '89'x then do /*+
/                           if i > 1 then              ÿ
                                   in.i = ff""substr(in.i,2)
                                else
                                   in.i = " "substr(in.i,2)           ÿ
               ÿ
                               when left(in.i,1) = '8B'x then do /* Befo
f page */                           if i > 1 then
     ÿ
                                        else
                                           in.i = " "substr(in.i,2)
                    ÿ
                                       when lefÿ
fore 2           */                           call do_cc_add
                                   ÿ
                                                end             ÿ
                                             when left(in.i,1) = '13'x t
* Before 2           */                           ÿ
                                                    in.i = substr(in.i,2
 ÿ
                                                 when left(in.i,1ÿ
n do /* Before 0           */                           ip = i - 1
                  ÿ
                                                          l1 = length(ou
ÿ
n                                  ÿ
                                                                    c1 =
(in.i,c,1)     ÿ
out.n,c,1) = " " then                               ÿ
 = overlay(c1,out.n,c)
                              ÿ
= 1                                                                 eÿ
                                                                 when le
1) = '03'x then do /* Before 0           */  ÿ
 1
ubstr(ÿ
ength(out.n)                                                ÿ
n.i <> out.n then
o c = 1 to l1          ÿ
    c1 =  substr(in.i,c,1)
      if substr(out.n,c,1) = " " then
           out.n = overlay(c1,out.n,c)    ÿ
          end
    skip_record = 1
    end ÿ
   when left(in.i,1) = '19'x then do /* Before 3           */
        call do_cc_add
        call do_cc_add ÿ
            in.i = substr(in.i,2)
            end
       when left(in.i,1) = '1B'x then ÿ
             +
           ÿ
                  in.i = substr(in.i,2)              ÿ
                    end
               otherwise do ÿ
                           call do_cc_add                           ÿ
                             in.i = substr(in.i,2)
                             end             ÿ
                     end
   ÿ
                                                              ÿ
                     /* -------------------------- *
                  ÿ
                        * -------------------------- */

                              outÿ
                                n = out.0
                ÿ
                                  return        ÿ

                               /*ÿ
--------- *                       * Process the AddressFile/Addÿ
            *                       * ----------------------------------
----------- */                      Process_Addresÿ
                                      use_address = null
                                        address = strip(address)
                                        if left(address,1) = "*" thÿ
                                             if length(address) > 1
             +
           ÿ
      ÿ
                                                   parse value addr.i wi
ddr                       ÿ
1))                    ÿ
                                                         when left(waddr
' then do                                ÿ
addr)                                   ÿ
addr,pl)                                                          end
                                                        ÿ
) = "'" then do                                          +
(">",waddr)                                            ÿ
left(waddr,pl)                                                         ÿ
                                                                     oth
addr = waddr                                                         end
                                                                     if
xaddr)ÿ
= null                                                                 e
         ÿ
e value waddr with naÿ
t
n w1 = "TO:"  then w1 = "Tÿ
hen w1 = "CC:"  then w1 = "CC"      ÿ
 When w1 = "BCC:" then w1 = "BCC"
 otherwise nop                             ÿ
   end                                             ÿ
   if w1 = "TO" then
      if use_address = 1 then w1 = "CC"                     ÿ
     Select                                                       ÿ
          when w1 = "TO" then do
               w  = words(address) + 1
                 address = address xaddr
 ÿ
                   end
              ÿ
                ÿ
                       cc = cc xaddr
                       cc_n.w =ÿ
                         end   +
                      when w1ÿ
                        otherwise nop             ÿ
                          end
                       end                  ÿ
                         address = strip(address)                  ÿ
                           cc      = strip(cc)
                           bcc     = strip(bcc)            ÿ
                             Return
    ÿ
                           /* ------------------------------------------
----- *                       * If lrecl > 1024 then exit with error mes
      *              ÿç
ver Limitation      *                       * --------------------------
---------ÿ
                                      ÿ
IP SMTP Server does not"                          say msgid "support dat
s larger than lrecl 1024ÿ
so far is:" save_lrecl                              sayÿ
terminating....."                                     exit 4
                                       ÿ
                                                     /* ================
=======================================                ×× Procedure:
     : Sends binary data after                        ÿ
       : converting to base64.                           ×× Author:
.Lucius@eÿ
owed with his permission                                   ×× =======ÿ
=============================================                */
                          ÿ
                                                                 /* ====
====ÿ
E64 character set                          ÿ
                                                                     cha
          'ABCDEFGHÿ
= char_set""'abcdefghijklmnopqrstuvwxyz'                    ÿ
t = char_set""'0123456789+/'
                                  ÿ
=========================================================
Process until we get to EOF
                                                 +
nnum  = in.0                                   ÿ
 buffer = null  ÿ
   recnum = 0
   eof = 0                                                    ÿ
     Do while \eof               ÿ

         /* =========================================================
           ×× Try to get a buffers worth of input ÿ
             */
             Do while length( buffer ) < 57 & \eof
            ÿ
                   IF recnum > innum THEN DO                     ÿ
                       eof = 1
                       LEAVÿ
                       end
  ÿ
                         buffer = buffer""ÿ
                         end
                   ÿ
                           /* ===========================ÿ
=========                    ×× Convert the first 57 characters in the b
 binary                      */     ÿ
                               sextets = X2b(C2x(Left(buffer,Min(57,Leng
fer)))))
                                 /* =================ÿ
===============                    ×× And remove 'em from the buffer
       ÿ
                                     buffer = Substr(buffer, 58)      ÿ

                      ÿ
=====================                    ×× Output the binary data
       ÿ
                                     ÿ
                                             Do sextetoff = 1 to Length(
 by 6                   ÿ
                                                 /* ÿ
=============================                      ×× Grab 75 cents wort
ng if necessary)                         ÿ
                                                     sextet = Subst+
extetoff,6,"0")                                                  ÿ
                                                         /* ÿ
=====================================                      ×× Convert it
se64 character                                             */
ÿ
tr(char_set,X2d(B2x(sextet))+1,1)                            end

               ÿ
==============ÿ
e (padding if necessary)                                         */
                              ÿ
 + 1                           +
.0                           ÿ
out""Copies("=",(76-Length(lout))//4)        ÿ
 bytes + length(out.n)                                                 e
                                              ÿ
st_limit                                                    ÿ

                                                               ÿ
--------------------------------------------------- *
Process Address                                       *
----------------------------------------------------- */
ÿ
arse arg aÿ

 /* -------------ÿ
    * Remove parens      ÿ
      if left(address,1) = "(" then
         parse value address with ÿ
        if right(address,1) = ")" then  ÿ
             parse value address with address ")"
          address = strip(address)                 ÿ
                                                       ÿ
             /* ----------------------------------------------------- *
              * Test for parenthesis                                ÿ
                 parens = 0                                           ÿ
                   if pos("(",address) > 1 then parens = 1
                   if pos(")",address) > 1 then parens = 1
     ÿ
     ÿç
                                      say msgid "                   incl
 or ')'" ,                        ÿ
nvalid"             ÿ
                                          end
                                                   ÿ
                                   ÿ
----------------- *                       * set up our variables
                  */                      t_addrs = ""              ÿ
                                            t_nameÿ
                                              t_names.0 = 0
                                              tn = 0
     +
     ÿ
--------------------------- *                       * Now process thru t
ded address                 *                       * ------------------
ÿ
= 0                                                          Select
                                                               /* ------
---------------ÿ
st an address in <>                      *                          * e.
t.last@address>                          */                        when
ress,1) = '<' then do         ÿ
 tn + 1
e value address with "<" addr ">" address
drs = t_addrs addr                           ÿ
address = strip(address)
end
------------------------------------------------ *          ÿ
double quoÿ
* e.g. "first last" <first.last@address>             */
hen left(address,1) = '"' then do
      right = pos(">",addreÿ
        if right = 0 then
           if pos("<",address) > 1
          ÿ
                      address = address">"
                      right = pos(">",address)
                      end+
                     elÿ
                  data = left(address,right)
                  x = length(address)
                    address = substr(aÿ
                      address = strip(address)
                      tn = tn + 1
               ÿ
                          parse value data with . "<" addr ">" .
                          t_addrs = t_addrs addr
                          end   ÿ
                         /* --------------------------------------------
                          * single quotes
                          * e.g. 'first last' <fi+
 */ÿ
                                    right = pos(">",address)
                                    if right = 0 then
                  ÿ
                                             then do
                                                  address = address">"
                                 ÿ
   ÿ
                                                 else right = length(add
                                            dataÿ
                    ÿ
)                                               address = strip(address)
                                                tn = tn + 1    ÿ
                                     ÿ
names.tn "'" .                                      parse value data wit
addr ">" .                                          t_addrs = t_addrs ad
                                                      ÿ
                                                   /* ------------------
-------------------------*                          * Only 1 word so mus
address      ÿ
hen do                                                      tn = tn + 1
                                                            t_addrs = t_
dress                       ÿ
        ÿ
                                                           /* ----------
---------------------------------*         +
ust be an address        ÿ
dress) = 0 then do                                                    tn
1                                                                     t_
t_addrs address                           ÿ
s = ""
                                                                     /*
-------------------------------------------*               ÿ
rwise assume name with no quotes               *
 first last <first.last@address>               */
se do
right ÿ
  data = left(address,right)
  address = substr(address,right+1)
  address = s+
      tn = tnÿ
        parse value data with t_names.tn "<" .
        parse value data with . "<" ÿ
          t_addrs = t_addrs adÿ
            end
       end                                         ÿ
       end                                     ÿ
         t_names.0 = tn
         return                                                   ÿ
                                                                ÿ
       /* ----------------------------------------------------- *
        * Create_file: create a file attachment using ISPF      *
 ÿ
 ÿ
            Create_File:
               iÿ
                  ÿ
                      say msgid "Try again when under ISPF."
                      exit 4   ÿ
                        end        ÿ
                       parse value t with cr1 "/" cr2 "/" .
                       if abbrev("HTML",cr2,3)ÿ
                            then do                 ÿ
                                   cs = "HTML"
                                   enrich = "html"           +
                                     end                   ÿ
                                    else do
                                         cs = "TEXT"
                                         enrich = "plain"
        ÿ
                                     create_suf = "XMIT"random(9999)"."c
                                     if sysvar('syspref') <> null then
         ÿ
ate_suf                                  else create_dsn = sysvar('sysui
eate_suf                                 create_dsn = "'"create_dsn"'"
                        ÿ
                                               "Alloc ds("create_dsn") n
5,90) tr",                                        "Recfm(v b) lrecl(255)
(9004)",                               ÿ
                                                 if enricÿ
                                                      o.1 = "<html><body
                                                      ÿ
finis stem o."                                          o. = null
                                                          end
                                                       Address ISPExeÿ
                                                         save_tenter = t
           ÿ
                                                           "Vput (tenter
"   ÿ
ttachment"                  ÿ
eate_dsn") Macro(xmitiped)" ,                                     "profi
p) Panel(xmitiped)"ÿ
                                             ÿ
_tenter                                                            "Vput
                                  ÿ
                                                              ÿ
 ds("create_dsn")"                                                     c
ns = create_dsns create_dsn                      ÿ
 > 3 then do

it e_rc                                                         ÿ
end
urn             ÿ


* Do PKZIP Routine                 ÿ
  * ----------------------------------------------------- */
  Do_Zip:
  zipcount =ÿ
      zip_dsn = "ZIPwork.zip"zipcount".ZIP"
      if zip_method = null then method = "*"
                           ÿ
          if zippass  = null then password = "*"
                             else password = zippass
          if fmt2l    = null then do      ÿ
      ÿ
                    then fmt2l = file_ddn""suffix
                    else do                              ÿ
                       +
                     ÿ
                                    parse value save_file_dsn with "(" m
 .                                    fmt2l = strip(mem)""suffix
                                      ÿ
                                   else
       ÿ
x                                    end               ÿ
                               if confirm = null then
                      ÿ
                                 end
                                if z_type   = null then z_type   = "ZIP"
                                if ziÿ
                                  Address TSO
         ÿ
                                                tranÿ
                                                  z_type fmt2l password
                          ÿ
                                        e_rc = rc                  ÿ
                                          if e_rc > 0 then do
                                           ÿ
g for:" save_file_dsn                          say msgid "Ending XMITIP.
  ÿ
                                                 "Delete" fiÿ
                                                   "Delete" zip_dsn
                 +
               ÿ

                                                      type     = "Binary
                              ÿ
e_dsn") SHR Reusÿ
                                                          "EXECIO * DISK
"(FINIS STEM in."                            ÿ
                                 ÿ
                                                              "Free f("i
                                                            ÿ
                                                  ÿ
c                                                                 if e_r
en do                                                                say
 "Error reading generated zip file:" file_dsn ,                    +
   "Ending XMITIP."                                              ÿ
8
          ÿ
= save_bytes
ecÿ
ytes = bytes + length(in.ÿ
 end
ll test_limit      ÿ
return                                  ÿ

 /* --------------------------------ÿ
    * Fix up the color specified.......                ÿ
      * ----------------------------------------------------- */
      Fix_Color: Procedure Expose msgid null         ÿ
        arg color                                                     ÿ
          Select
               When abbrev("AQUA",color,1)    then newcolor = "Aqua"  ÿ
                 When abbrev("BLACK",color,3)   then newcolor = "Black"
     ÿ
                   When abbrev("FUCHSIA",color,1) then newcolor = "Fuchs
       ÿ
                    ÿ
                       When abbrev("LIME",color,1)    then newcolor = "L
                       Wÿ
                         When abbre+
                           When aÿ
ve"                          When abbrev("Pÿ
urple"                         When abbrev("RED",color,1)     then newco
ed"                            When abbrev("SILVÿ
"Silver"                         When abbrev("TEAL",color,1)ÿ
= "Teal"                           When abbrev("WHITE",color,1)   then n
= "White"                          When abbrev("YELLOW",color,1ÿ
r = "Yellow"                         When color = null then newcolor = n
                                       otherwise do
                                                 newcolor = null
                                                   say msgid "Color spec
color ,       ÿ                                                "is not a
olor. -",                                                      "Will use
 colors."    ÿ
re:"                           ÿç
Color      Abbrev   Color     Abbrev"                                say
Aqua       A        Navy    ÿ
 "Black      Bla      Olive     O     "         ÿ
id "Blue       Blu      Purple    P     "
id "Fuchsia    F        Red       R     "  ÿ
sgid "Gray      Gra       Silver    S     "                      ÿ
 msgid "Green     Gre       Teal      T     "
 msgid "Lime      L         White     W     "             ÿ
ay msgid "Maroon    M         Yellow    Y     "
ndÿ
                                                                     ret
wcolor
                   ÿ
--------------------------------------------- *                       *
sage if ÿ
------------------------------------ÿ

id "The correct syntax ÿ
sgid "%XMITIP user@address"                          ÿ
 msgid "     or (u1@address u2@address..) "
 msgid "     or *list-id* "           ÿ
ay msgid "     or * "                                                 ÿ
 say msgid "        AddressFile"
 say msgid "        AddressFileDD"                   +
   say msgid "        BCC user@address"            ÿ
     say ÿ
       say msgid "        CC user@address"
       say msgid "     or CC (u1@add1 u2@add2 ..)"                ÿ
         say msgid "      ÿ
           say msgid "     or FILE (dsn1 dsn2 ...)  "
           say msgid "        FILEDD ddn1"
 ÿ
               say msgid "        FILEDESC file-description "
               say msgid "     or FILEDESC (desc1 desc2 ...)"
               sÿ
                   say msgid "     or FILENAME (file1 file2 ..)"
                   say msgid "        FORMAT options (see the doc)"
                   say msgid " ÿ
                       say msgid "        HTML (for MSGDx only)"
                         say msgid "        IMPORTANCE High Normal or Lo
                         say msgid "        MSÿ
                           say msgid "        MARGIN Lm/Rm/Tm/Bm"
            ÿ
...)"                        if sysvar('sysispf') = "ACTIVE" ÿ
                                  say msgid "     or MSGDS *"
                             ÿ
                                 say msgid "     or NOMSG (if no MSGDS,
or MSGQ)"                          say msgid "        Murphy"
                                   say msgid "ÿ
                                     say msgid "        PRIORITY Urgent
r Non-Urgenÿ
s"                                     say msgid "        REPLYÿ
s"                                       say msgid "        SENSITIVITY
Personal or Confidential" ÿ
D ddname"                                  say msgid "        SUBJECT 's
ÿ
mpression-method"                        ÿ
rd for zip files"                              exit 4
                 ÿ
                                                 /******ÿ
**********************************                 * Trap uninitialized
s                                *ÿ
************************************/                Novalue:          +
                                                       Say "Variable"ÿ
                                                     ÿ
tion") "undefined in line" sigl":"                         Say sourcelin
                                                           if sysvar("sy
> "Fÿ
rror in this application along with the",                          "synt
"                                                              exit 8
                   ÿ

              * Name:      XMITIPCU
              *                   ÿ
        ÿ
                  *
                  * Syntax:    Invoked as a rexx ÿ
 *                  *    ÿ
   *                  *            x = xmitipcu()
   *                  *                                         ÿ
     *                  *            Must ÿ
       *                  *            concatenation.
       *                  *

           *                  *            Kaiser Permanente
           *                  *            Walnut Creek, CA 94598
           *  ÿ
               *                  *            Internet: lionel.b.dyck@k
               *                  *
               *             ÿ
             ÿ
time zones         *                  *            04/12/00 - add size_l
ion                *                  *     ÿ
tion                 *        ÿ
nd zip_load            *                  *            02/07/00 - add fr
lt here                *                  *                ÿ
omain                    *                  *  ÿ
 keyword                   *                  *                     - ad
 defaults                  *                  *            10/18/99 - up
timezone routine to use      *                  *               ÿ
ted cvt field                  *                  *
s Leland)                      *                  *            10/03/99
on from xÿç
             ÿ
---------------------------------------------- *                  * Time
routine from Leland.Luciÿ
------------------------------ÿ
                                                                      pa
e "" with null zone smtp vio center fonÿ
            smtp_secure smtp_address smtp_domai+
              text_enter sysout_class from_ceÿ
                from_default append_domain ,          ÿ
                  zip_type zip_load zip_unit ,
                  writer top bottom left right ,              ÿ
                    interlink size_limit                             ÿ

 /* ----------------------------------------------------- *

    ÿ
      interlink = 0
                ÿ
       /* ---------ÿ
          * Get current IP Domain      *
          * ---------------------ÿ
           if interlink = 0 then dÿ
                res    = Socket('Initialize','ANYNAME')
                host   = Socket('GetHostId')      ÿ
                  name   = word(Socket('GetHostnaÿ
                    domain = word(Socket('GetDomainName'),2)
                    res    = Socket('Terminate')                   ÿ
                      end                                       ÿ

                     /* -------------------------- *
    ÿ

                          * the smtp server is running.*
                     ÿ
              ÿ
                             From_Center = center
                                      ÿ
                             +
--------- *                ÿ
            *                       * set to your local tÿ
              *                       * or set to null to force call to
 function     *                       * whÿ
mt offset       *                       * ------------------------------
----------------- */                     zone   = null
                                         /* or call timezÿ
                                           if zone = null then
           +
         ÿ
                                                 /* --------------------
------------------------- *                       * Local NJE, Dasd and
ver Setup                 ÿ
       ÿ
here the SMTP server runs     *                       *
                              *            ÿ
sk name for the SMTP sÿ
 the DEST for SYSOUT alloc on     *                       *     WORKDD a
XMITIP                            *                       * ÿ
                                    *ÿ
me of the SMTP started task           *                       *   - null
ptable                                *                       *   - sett
 the smtp variable is probably normal   *           ÿ
fied will override DEST on SYSOUT for     *                       *
lloc in XMITIP                            *                       *
              ÿ
he esoteric for the vio virtual dasd          *                       *
                                              *                       *
ows this same code to run on muÿ
--ÿ

center = "NKAISER2" then do                     ÿ
  smtp   = "SMTP"ÿ
    writer = null
    vio    = "sysda"                                             ÿ
      end                       ÿ
   when left(center,2) = "NK" then do
        center = "NKAISERA"
  ÿ
            writer = null                    ÿ
              vio    = "VIO"
              end    ÿ
           when left(center,2) = "SK" then do               ÿ
                  center = "SKAISERB"
                  smtp   = "TCPSMTP"  ÿ
                    writer = null
                      vio    = "sysda"
                      end                              +
                   otherwise do                      ÿ
          ÿ
                            smtp   = "SMTP"
                            writer = null                             ÿ
                         ÿ
                                end
                           end
       ÿ
                             /* -------------------------- *
                              * Secure SMTP option         *
                        ÿ
                                  * -------------------------- */
                                 /* smtp_secure = 1 */
                                 smtp_secÿ

                                     /* -------------------------- *
                                      * nje address of smtÿ
     ÿ
                                         if interlink = 0 then
                                            smtp_address = center"."smtp
                    ÿ
                                                smtp_address = smtp

            ÿ
                                                  * domain name of smtp
                                                  * --------------------
/                            ÿ
"
                                                     /* ----------------
----------------------------- *               ÿ
                                  *                       *  ifÿ
used to append to e-mail addresses  *                       *  that are
d without a domain.                 *                       *  Noÿ
de the @ symbol - it will be added    *                       *        b
ult.                                    *                       * ------
--------------------------------------- */                      /* appen
 =ÿ
= null       ÿ
                                                                   /* --
-------------------+
ult font         ÿ
quotes if a blank is part of the font name.       *
lternative font is "Courier".                     *
: if you change the font name you ÿ
      change the rtf tag font family to a valid family*
      fmodern is valid for Courier and Courier New    *
---------------------------------------------------ÿ
  font = "Courier New"

 /* ----------------------------------------------------- *         ÿ
      * Set text_enter to null if you do not want the msgds * *
      * process to begin with the TE (Text Enter) command.    *
      * ----------------------------------------------------- */
     ÿ
             text_enter = "Y"

         /* ----------ÿÿ
              * Set the sysout class to a external writer sysout      *
              * class if you are a JES3 shop.                         *
              * ----------------------ÿ
                  sysout_class = "A"

                 /* ---------------------------------ÿ
                      * Margin defaults:
                      * ------------------------------------------------
                      top    = "1.0"                                ÿ
                          bottom = "1.0"
                          left   = "0.8"
                          right  = "0.8"
   +
 ÿ
------- *                       * Setup the From Default
        *                    ÿ
hop       *     ÿ
t customize *                       * ----------------------------------
----------- */                        msgid = ÿ
                               ÿ
                                             msgid = sysvar("syspcmd")":
                                          uid = sysvar('sysuid'+
                                            ifÿ
                                                   from_default = uid"@"
"domain                                         else
                                                   from_defauÿ
ÿ
                                                 /* --------------------
------------------------- *                       * Setup ZIP variables
                 ÿ
KZIP/MVS                      *                       *              ISP
ASE's ISP/ZIP                 *                       *   if null then n
rted by youÿ
brary(module)                     *                       *   zip_unit:
 the dasd work device to use      *                       *
esoteric - try 3390       ÿ
* to use the system default           *                       * --------
------------------------------------- */                        zip_type
P"                                       ÿ
                                                                 /* Now
e load library for PKZIP */                                         env
('symdef','ksysenv')                                    ÿ
 "'syÿ
 = "*"
                                                             /*        ÿ
pe = "ISPZIP"         ÿ
load = "'syslbd.demoispz.load(ispzip)'"                          */

------ÿ
Set size limit in bytes. 0 is unlimited (no commas)   *
----------------------------------------------------- *
           × 10 milli+
  *            ×× 1ÿ
    *            ××× 100K                                   *
    *            ×××× 10K                                   *
      *            ××××× 1k       ÿ
        size_limit = 12000000  /* 12,000,000 bytes */

       /* ÿ
            * Now return to the caller with each value separated    *
            * by a /.                                               *
            * -------------+
               return  centÿ
                         vio "/" smtp_secure "/" smtp_address "/" ,
                         smtp_domain "/" font "/" text_enter "/" ,

                             top "/" bottom "/" left "/" right "/" ,
                             host "/" name "/" domain "/" from_default ,
              ÿ
 ,                               zip_unit "/" interlink "/" size_limit

                         exitÿ

                             /*
                             ×× ============ÿ
===============ÿ
offset from GMT                  ×× Arguments:     (none)      : nothing
ired                             ×× Return:        offset  ÿ
HHMM format                     ÿ
exposed                              ××
                                     ×× Note:  Uses the CVTLDTO field in
f the CVT extensions.  It looks        ××        ÿ
etime in 1991, so this routine           ××        will not work on any
on older than that.                      ×× ============================
=========ÿ
                                             Timezone:
                                             PROCEDURE
                        ÿ
   ÿ
========================================           ×× We're gonna have a
ber                                    +
                    ÿ

                                                         /* ============
=====================================ÿ
DTO (Local Date Time Offset in STCK format))                 */
                                                             cvt     = C
age( D2x( 16 ), 4 ) )                                 ÿ
Storage( D2x( cvt + 304 ), 4 ) )                                 cvtext2
Storage( D2x( cvt + 328 ), 4 ) )                                 cvtldto
Storage( D2x( cvtext2 + 56 ), 8 ), 8 )                                 +
  ÿ
============================================================           ×
he current offset in hours and minutes (work with absolute)            *
                 ÿ
 = Abs( ÿ
   = absldto % x2d('D693A400000' )
es = ( absldto % x2d('3938700000ÿ
                         ÿ
* ==================================================================
× Format to ANSI standard X3.51-1975           ÿ
 */                                       ÿ
   zone    = Right( hours, 2, "0" )Right( minutes, 2, "0" )
   IF cvtldto < 0 THEN DO                                     ÿ
       zone      = "-"zone                                 ÿ
       END
       ELSE DO
          zone = "+"zone
           END

           /ÿ
==           ÿ
               */
               NUMERIC DIGIÿ
                              ¯
                 RETURN zone
         {
ocedure  -------------------- *                  * Name:      XMITIPDS
                              *                  *
                              *         ÿ
ITIP in Report format the         *                  * ÿ
er) currently being Edited.         *                  *
                                    *                  * Syÿ
e-mail@address report-opt             *                  *            ÿ
                                        *                  *
pt if null defaults to rtf              *                  *
anything else and txt is used.            *                  *
     ÿ
el B. Dyck                                  *                  *
er Permanenteÿ
lnut Creek, CA 94598ÿ
(925) 926-5332                                  *                  *
Internet: lionel.b.dyck@kp.orgÿ
                                   ÿ
:                                                   *                  *
    06/29/00 - fixed support for sequential filÿ
      06/27/00 - update for new format keyword    ÿ
                 - add popup for to/from address        *
                 - add popup for attachment type        *       ÿ
          02/10/00 - created from a base provided by      *      ÿ
                       Russell Nesbitt                      *
 ---------------------------------------------------------- */
dÿ
ÿ
  "MACRO (Address report)"
  if length(addresÿ
       Address ÿ
         xmt = "To Address"
         "Addpop"                  ÿ
           "Vget (xmto) profilÿ
             xminfo = xmto
             "Display Panel(xmitipds)"              ÿ
               if rc > 3 then exit 4         ÿ
                 xmto = xminfo
                 "Vput (xmto) profile"                               +
                   address = xmto                           ÿ
                       "Rempop"
                       Address ISREdit
                       end
      ÿ
                            do
                              if pos("@",address)  = 0 then do
                       ÿ
 ,      ÿ
                                     zedsmsg = ""
                                     Addÿ
                       ÿ
                                       end
                                     end                 ÿ
                                      ÿ
                                     /* ----------------------- *
                                      * Get a from address      *
                                        * -----------ÿ
                                             Address ISPExec
                                             xmt = "From Address"
           ÿ
                                                 "Vget (xmfrom) profile"
                                                 xminfo = xmfrom
                            ÿ
   ÿ
                                                     xmfrom = xminfo
                                             ÿ
                  ÿ
                                                         Address ISREdit
                                                              ÿ
                                 ÿ
--- *                                                     * If no report
    *                                                     * ------------

t) = 0 then do                                                      Addr
xec                                                                 xmt
t"              ÿ

"TEXT or RTF"
 Panel(xmitipds)"                +
c > 3 then exit 4                ÿ
empop"
port = translate(xminfo)
 left(report,ÿç
                 then report = ""
              Address ISREdit
              end           ÿ

              /* ----------------------------------------------------- *
               * Invoke XMITIPCU for local ÿ
                ÿ
                  cu = xmitipcu()
                                                          ÿ
                    /* ----------ÿ
                       * parse the customization defaults to use them he
                       * -----------------------------------------------
 */                     parse value cu with centerÿ
                                  vio "/" smtp_secure "/" smtp_address "
                                  smtp_domain "/" font "/" tenter "/" ,
        ÿ
" ,                                   top "/" bottom "/" left "/" right
                                      host "/" name "/" domain "/" from_
,                      ÿ
    ÿ
                                "(dsn) = Dataset"
                                "(mem)ÿ
                     ÿ
                                    if mem <> "" then do
                                       file = "'"dsn"ÿ
                                      ÿ
                                        else do
                                           file = "'"dsn"'"         ÿ
                                             mem  = "Fiÿ
                                               end
                                            subject = '"File:' file'"'
   ÿ
                                               /* ----------------------
----------------------- *                       * Now setup for the prop
t layout          ÿ
---------+
       ÿ
nd"                              +
                               ÿ
                          ÿ
                                                               report =
                                              ÿ
                                           ÿ

                                                             ÿ
----------------------------------------- *                 ÿ
te and invoke the XMITIP command            *                       * --
------------------------------------------- */                      Addr
O,                                                                    "%
" address "nomsg file" file ,
ct" subject  report ,
 xmfrom ,  ÿ
ename" mem"."se uf ,
iledesc Edit-Member-Print"                                         {

on */                    Address ISREdit
                         "Macro"
                  ÿ
                             "Number Off"
                             "Reset"
                             Addresÿ
                                 if enrich = "enrich" then do
                                    call do_line "Sample HTML Commands:"
                                    call do_line "<bÿ
                                        call do_line "<i> italic </i> un
                                        call do_line "<center> center </
uncenter"                               end                          ÿ
      ÿ
                                            "TEnter .zl"
                                         exit
      ÿ
                                                parse arg newline
                                                "LINE_Before .zfirst = m
newline)"              %            ÿ
                                         
-------------------  rexx procedure  ------------------- */
 "4.14"                                            +
Name:      XMITIPI                               ÿ
  *                                                            *
  * Function:  To drive the ISPF Interface to the XMITIP       *
  *            application.                                    *ÿ
    *    ÿ
      * Notes:     Normally invoked by the XMITIP command if no    *
      *            parameters are specified and ISPF is active.    *

          * Syntax:    %xmitipi parm                                   *
          *                                                            *
          *   ÿ
              *
              * Author:    Lionel B. Dyck
              *            Kaÿ
                  *            Walnut Creek, CA 94598
                  *            (925) 926-5332
                  *            Internet: lioÿ
   *                  *
   *                  * History:
   *                  *            08/29/00:- 4.14 Fix the ÿ
     *        ÿ
       *                  *            08/07/00:- 4.12 Minor cleanup
       *                  *            08/04/00:- 4.11 Minor cleanup
         *                  *  ÿ
ts         *                  *            06/08/00:- 4.05 level change
           *                  *            06/06/00:- 4.04 level change
         ÿ
rmat if        *                  *                       using file tab
 that format   *                  *            06/01/00:- change to 4.02
h xmitip       *        ÿ
match xmitip       *                  *            05/16/00:- clean up A
 file              *                  *            04/16/00:- 4.00 suppo
xmitip             *                  *ÿ
 cÿ
                       *                  *            06/15/99 - create
                       *                  *           ÿ
                   +
 version of XMITIÿ
tion of updates to this code.*                  * -------------------+
------------------------------ */                 arg options      ÿ
                                    ÿ
                                                      Signal on NoValue

  ÿ
--------------------------------- *                       * If options n
then trace                        *                       * ------------
-----------------ÿ
hen do                                                           options
late(options)                                                    select
                                ÿ
ns = "Dÿ
ions = "TEST" then nop
e nop                                          ÿ
                        ÿ

                                                              ÿ
-----------------------------------------ÿ
 for ISPF Applid of XMIT and if not then recurse  *
 that Applid.                                     *
--------------------------------------------------- */    ÿ
ress ISPEXEC
ET ZAPPLID"
f zapplid <>ÿ
      "TBCreate xmitcmds names(zctverb zcttrunc zctact" ,
                "zctdesc) replace share nowrite"
      zctverb = "RFIND"    ÿ
        zcttÿ
          zctact = "&XMTRFIND"
          zctdesc = "RFIND for XMITIP"    ÿ
            "TBAdd xmitcmds" ÿ
              "Select CMD(%"sysvar('sysicmd') options ") Newappl(XMIT)"
                  "passlib scrname(XMITIP)"              ÿ
                "TBEnd xmitcmds"              ÿ
                  Exit 0
                  end
                                                               +
                 /* -----------------------------------------ÿ
                    * Display ISPF Panel XMITIP
       +
     ÿ
ÿ
                          Address ISPExec
                    ÿ
                 ÿ
                              null = ""
                              if daÿ
                                ifÿ
l                                 if datatype(top)    <> "NUM" then top
l                                 if datatype(bottÿ
ull                                 do forever     ÿ
                                         parse value "" with c_format c_
_to ,                                               c_cc c_bcc zcÿ
 att c_mur,                                           tb_open c_fileÿ
ename c_zippass ,                                       c_zipmethod
                                             "Display Panel(xmitip)"
ÿ
     ÿ
                                                    end
               ÿ
                      ÿ

                              ÿ
                                       ÿ
----------------------------- *                       * Test for FORMAT
                              *              ÿ
------------------------------- */                      ÿ
" then do                                                    call fix_fo
mat                                                         ÿ
null then                                                         format
_format                                                          return
                                                                 end

          ÿ
----------------------------------------- *                       * Save
to ISPF Prÿ
---------------------------+
sgds bcc cc from subject ÿ
eft right top bottom sigd+
"sens import mur prior ÿ
  ") profile"                               ÿ

--------------------------------------ÿ
* Retrieve saved profile values.                        *    ÿ
  * ----------------------------------------------------- */
    "Vget (b1 b2 b3 b4 b5 b6 b7 b8 b9 ba bb bc)"     ÿ
      "Vget (c1 c2 c3 c4 c5 c6 c7 c8 c9 ca cb ccx)"
        "Vget (f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc)"
        "Vget (ss1 ss2 ss3 ss4 ss5 ss6 ss7 ss8",                    ÿ
                             "ss9 ssa ssb ssc)"
          "Vgetÿ
                               "ssf9 ssfa ssfb ssfc)"
   ÿ
                                ÿ
                "Vget (sl1 sl2 sl3 sl4 sl5 sl6 sl7 sl8",
                  ÿ
                  "Vget (sr1 sr2 sr3 sr4 sr5 sr6 ÿ
                                       "sr9 sra srb src)"
                    "Vget (st1 stÿ
                                         "st9 sta stb stc)"       ÿ
                        "Vget (sb1 sb2 sb3 sb4 sb5 sb6 sb7 sb8",
                                           "sb9 ÿ

   ÿ
- *                       * If To is ? then display selection lÿ
ss  *                       * ------------------------------------------
--- */              ÿ
                              if to <> "?" then do
                                   call process_address to
                                   ifÿ
                                     if tb_open <> 1 then
             ÿ
                                       to   = translatÿ
                                         c_to = to
                            ÿ
                                           do i = 1 to words(t_addrs)  +
                                                eaddr = word(t_addrs,ÿ
                                           +
                                         ÿ
fix_name eaddr                                        if left(eaddr,1) =
n iteratÿ
en do                                                   ÿ
)                                                            if pos("@",
t+1) > 0 then inv = 1    ÿ
pat+1) > 0 then inv = 0                                        end     ÿ
                                                              if inv = 1
erate                                     ÿ
"Order"                                                         end
      ÿ
                                                           ÿ
                                                                   if tb
 1 then              ÿ
ld_address_table                                                     cal
ddress_table                                                           a
e = 1                               ÿ
                                                                       c
_addr_table  ÿ
= 1 then parse value "" with c_to c_cc c_bcc       ÿ
ngth(c_to) + length(c_cc) + length(c_bcc) = 0 then do
 inv = 0 then do              ÿ
   zedsmsg = "No Selections"                                      ÿ
     zedlmsg = "No addresses were selected."
     end                                       ÿ
    else do
 ÿ
         zedlmsg = "Invalid Address - too many @'s."            ÿ
           end
        "Setmsg ÿ
          return
 ÿ
                               ÿ
       /* ----------------------------------------------------- *
        * Test forÿ
          * ----------------------------------ÿ
            if length(c_to) = 0 then do
               zedsmsg = null      +
                 zedlmsg = "Errorÿ
                     "Setmsg Msg(isrz001)"                 ÿ
                       return
                       end                          ÿ

                       /* ----------------------------------------------
*                       * For bcc, cc, file, plus paper, style, and mÿ
  *                       * get additional information if coded as a +
  *      ÿ
--- */                      if c_bcc = null then
      ÿ
                        ÿ
                                      else
                       ÿ
                                       ÿ
                                             c_bcc = bcc
                                        ÿ
                                      if c_bcc = null ÿ
                                          if bcc = "+" then do forever
                                           zcmd = null   ÿ
                                             "Display Panel(xmitipi1)ÿ
                                               d_rc = rc
                                               if translate(zcmd) = "CAN
hen return                                       if translate(zcmd) = "C
en  ÿ
b3 b4 b5 b6 b7 b8 b9 ba bb bc                      if d_rc > 7 then do
           ÿ
4 b5 b6 b7 b8 b9 baÿ
b6 b7 b8 b9 ba bb bc) profile"                            end
                            ÿ
                                  ÿ

                                             ÿ
                                                 ÿ
                                                                  if cc
en call do_address_table2                                     ÿ
                                                                ÿ
translate(cc," ",",")
cc = null then c_cc = cc


= "+" then do forever
= null
lay Panel(xmitipÿ
c = rc      ÿ
f translate(zcmd) = "CANCEL" then return
f translate(zcmd) = "CLEAR" then ÿ
    parse value "" with c1 ÿ
   if d_rc > 7 then do
      c_cc = strip(c1 c2 c3 c4 c5 c6 c7 c8 c9 ca cÿ
        "Vput (c1 c2 c3 c4 c5 c6 c7 c8 c9 ÿ
          end
       if d_rc > 7 then leave                                      ÿ
         end                                             ÿ

       /* ----------------------------------------------------- *
    ÿ
            * ----------------------------------------------------- */
            if file <> "?" then do
               d_rc =ÿ
       ÿ
                      call test_file file
                   if d_rc = 0 then reÿ
                     cÿ
                       form_over = 0
                       end                             ÿ
                      else do        ÿ
                             call do_attachment_table
                             style = null
                               font  = null         ÿ
                                 "TBTop" tblname
                                 parse value "" with c_file c_margin c_f
c_format ÿ
                                      skip = 0
                                       "TBskip" tblname
                          ÿ
  ÿ                                        if act = null then iterate
                                           act = null
                                           +
                 ÿç
 do                                                             skip = 1
                                                                "TBDelet
me                              ÿ
                                                                 if skip
n iterate                                                        c_file
 adsn                                          ÿ
         ÿ
 null
ilename = strip(c_filename) afile                             ÿ
_filename = strip(c_filenaÿ
c <> null
 c_filedesc = strip(c_filedesc) adesc
se c_filedesc = strip(c_filedesc) "x"      ÿ
aformat <> null
then c_format = strip(c_format) aformat
else c_formaÿ
 if aleft <> null
    then c_margin = strip(c_margin) ,
         aleft"/"aright"/"aÿ
        else c_margin = strip(c_margin) "/"
   end
   if words(c_file) > 1 then              ÿ
         c_filÿ
       else
           c_file = strip(c_file)                        ÿ
         if c_filedesc <> null ÿ
              ok = 0
              do cf = 1 to words(c_filedesc)
                   if translate(word(c_filedesc,ÿ
                        then ok = 1
                     end
       ÿ
                      if words(c_filedesc) > 1 then
                         c_filedesc = "Filedesc ("strip(c_filedesc)")"
                      ÿ
  ÿ
                                c_filedesc = "Filedesc "strip(c_filedesc
                             end     +
                   +
                   ÿ
                                  ok = 0
                                  do cf = 1 to worÿ
                                    ÿ
                                            then ok = 1
                                         end                     ÿ
                                        if ok = 0 theÿ
                                          if words(c_format) > 1 then
                                             c_format = "Format ("strip(
ÿ
                                                 if length(c_format) > 0
                                                    c_format = "Format "
format)        ÿ
       ÿ
                                               if c_filename <> null the
                              ÿ
                        ÿ
ame)                                                     if translate(wo
ename,cf)) <> "X"                            ÿ
                                         ÿ
                                                          if ok = 0 then
ame = null                                                ifÿ
 > 1 then                                                 ÿ
ilename ("strip(c_filename)")"                                else do
                                                                 if leng
ip(c_filename)) > 0 then                                              c_
me = "Filename "strip(c_filename)                                    end
                                                                  end
          ÿ
null then doÿ
 space(c_margin,0)                                                    t_
 left("/",length(w_marginÿ
gin <> t_margin              ÿ
n c_margin = "Margin ("strip(c_margin)")"
e c_margin = null                       ÿ
                                              ÿ
ose" tblname "Library(ISPPRof)"                                        e
                                                       +
                                                     ÿ
       /* ----------------------------------------------------- *
        * Test Importance                                       */
        test = translate(import)                                    ÿ
  ÿ
              when abbrev("HIGH",test,1)   then import = "High"
              when abbrev("LOW",test,1)    then import = "Low"
   ÿ
                  otherwise nop;
                  end
                  ÿ
                   /* --------------------------------------------------
                    * Test prior
                    test = translÿ
                        select
                          when abbrev("URGENT",test,1) then prior = "Urg
                          when abbrev("HIGH",tesÿ
                              when abbrev("NON-URGENT",test,3) then
                                   prior = "Non-Urgent"
                              when abbrev("LOW",test,1) then   ÿ
       ÿ
                                  when abbrev("NORMAL",test,3) then prio
mal"                              otherwise nop;
                        ÿ

                                   /* ----------------------------------
----------- *ÿ
                */                      test = translate(sens)
                                          select
                            ÿ
3) then                                              sens = "Confidentia
                                                when abbrev("COMPANY-CON
L",test,3) then                            ÿ
ntial"                                              when abbrev("PRIVATE
) then                                                   sens = "Private
                                                    when aÿ
t,2) then   ÿ
                                                        otherwise nop;
                                                        end
                             +
                             ÿ
----------------------------------- *                       * Save updat
s                                   */                      "Vput (impor
sens) ÿ
                                                               /* ------
--------------------------------------- *                       * Test e
he keywords and set tÿ
                                            *                       * --
------------------------------------------- */                     if tr
msgds) = "HTML" then do             ÿ
ÿ

o                                                  ÿ
 if length(msgds)ÿ
      if translate(msgds) = "NOMSG"
         then c_msgds = "Nomsg"                                   ÿ
           else c_msgds = "Msgds" ÿ
             end
       else c_msgds = "Nomsg"
 ÿ
   if length(sigdsn)  > 0 then c_sigds = "Sig" sigdsn
                          else c_sigds = null
   if length(impÿ
                              else c_import = null
       if length(filedesc) > 0
          then do              ÿ
     ÿ
                      filedesc = translate(filedesc,"-"," ")
                   c_filedesc = "Filedesc" filÿ
                     eÿ
               if length(filename) > 0
                  then do                                    ÿ
                         if words(filenÿ
                              filename = translate(filename,"-"," ")
                           c_filename = "Filename" filename
                             end                        ÿ
                       if form_over = 0 then do
                          if length(format) > 0
           +
         ÿ
                                             format = translate(format,"
                                          c_format = "Format" format
                        ÿ
          ÿ
                                   if length(sens)    > 0 then c_sens
tivity" sens                           ÿ
                           ÿ
riority" prior                                                else c_pri
ll                                     if length(mur) ÿ
                                            ÿ
 = "Y" then                                                          c_m
rphy"                                                             elsÿ
 null                                        if length(c_bcc)ÿ
                                                                      c_
rip(c_bcc)                                                            if
_bccÿ
cc = "Bcc ("c_bcc")"
e c_bcc = "bcc" c_bcc
                   ÿ
 c_bcc = null  ÿ
en do
cc = strip(c_cc)                  ÿ
if words(c_cc) > 1 then         ÿ
     c_cc = "Cc ("c_cc")"
     else c_cc = "cc" c_cc                       ÿ
    end                                          ÿ
      else c_cc = null                                         if length
  > 0 then c_from = "From" from                                 ÿ
        else c_from = null                                       iÿ
lyto) > 0 then c_replyto = "Replyto" replyto
          else c_replyto = null                                    if le

   ÿ
(subject) = 0 then c_subject = null
o             ÿ
 qt = '"'           ÿ
   qt = qt"'"
   if pos(left(subject,1),qt)+
        c_subject = "Subjecÿ
         else                        ÿ
              c_subject = "Subject" subject
           end                            ÿ
     if length(c_file)  > 0 then c_file = "File" c_filÿ
                              else c_file = null
       if length(c_file) > 0 then                        ÿ
            if length(c_format) > 0 then do                            ÿ
                 if c_margin = null then
                    if file <> "?" then do
                      if length(left)    > 0
        ÿ
                           else c_margin = null
       ÿ
                       enÿ
                   if pos(left(c_format,1),"X x") > 0 then c_margin = nu
                   if ÿ
                     if pos("RTF",translatÿ
                          if pos("PDF",translate(c_format)) = 0 then
                             c_marginÿ
                         if length(zipmeth) > 0 then       ÿ
                                                  c_zipmethod = "ZIPMETH
eth                                               elÿ
                             if length(zippass) > 0 then
                                                      c_zippass = "ZIPPA
ass                                                   else c_zippasÿ
                                 if length(c_file) = 0 then do
             ÿ
                                      c_zippass   = null
  ÿ
                              ÿ

                 ÿ
----------------- *                       * Makÿ
e e-mail table      *                       * --------------------------
------------------- */          ÿ
PROF)"                                        if pos("(",c_to) >ÿ
value c_to with "(" t_to ")"                                       else
_to                                            +
e value c_cc with . "(" t_cc ")"             ÿ
e v+
 ÿ
parse value c_bcc with x t_bcc                          callÿ
_to                                                       if parens = 1
nal display       ÿ
addrs)                                                         ename = t
.i                                                               eaddr =
addrs,i)                           ÿ
ll then call fix_name eaddr                                        if le
,1) = "*" ÿ
addr"                                               ÿ
                                                                    call
_address t_cc            ÿ
= 1 then signal display                                              ÿ
 to words(t_addrs)
 = t_names.i                            ÿ
dr = word(t_addrs,i)
ename ÿ
TBAdd xmitaddr"                                        ÿ
 end
ll process_address t_bcÿ
if parens = 1 then signal display                                     ÿ
  do i = 1 to words(t_addrs)
     ename = t_names.i                  ÿ
       eaddr = word(t_addrs,i)
     ÿ
         "TBAdd xmitaddr"                                ÿ
           end
         "TBSave  xmÿ
           "TBClose xmitaddr Library(ISPPROF)"

           /* ---------------------ÿ
              * Now invoke the XMITIP application based on our input  *
           ÿ
                * --------------------------------ÿ
                 Address TSO
                 cmd.  = nulÿ
                   xmit. = null                                  +
                     if options = null then                    ÿ
                          call outtrap "xmit." +
                         /* -----------------ÿ
                            * Log the command            *
                              * -------------------------- */
                             n = 1                            ÿ
                               cmd.n = "Generated Command:"
             ÿ
                                 if words(c_to) > 1 then do

                            ÿ
                                        c_to = "("c_to")"
                ÿ
                                           ÿ
addrs,1)">"                                 else
                                 ÿ
                                              if words(t_aÿ
                                                   cmd.n = "%xmitip ("ad
                                                elÿ
                                                     cmd.n = "%xmitip ("
 +"                                                 n = n + 1
                                                    do co = 2 to woÿ
)                                                        if t_names.co <
hen     ÿ
co'"' "<"word(t_addrs,co)">"                               else
    ÿ
drs,co)                ÿ
ddrs)                                                             then a
dr ")"               ÿ
  " addr "+"                          ÿ
                                                                   end
                                      ÿ
                                                     ÿ

 "%xmitip" c_to "+"                                    ÿ
 + 1                                                                ÿ

                                                                     cmd
       " c_msgds "+"                                                   n
   +
sÿ
rse value c+
call procÿ
  if parens = 1 ÿ
    if t_names.1 <> null then
          addr = '"'t_nameÿ
         else                  ÿ
              addr = word(t_addrs,1)
        cmd.n = "        Cc (" addr "+"    ÿ
          n = n + 1                           ÿ
            do co = 2 to words(t_addrs)
               if t_names.co <> null then                   ÿ
                    addr = '"'t_names.co'"' "<"word(t_addrs,cÿ
                   else
                      addr = word(t_addrs,co)
                     if co = words(t_addrs)
                          then addr = addr ")"
                       cmd.n = "           " addr "+"
              ÿ
           ÿ
                           end
                        else doÿ
                          ÿ
                                n = n + 1
                                end             ÿ
                           if length(c_ccÿ
                             if words(c_bcc) > 2 then do
                                cmd.n = "        Bcc" word(c_bcc,ÿ
                                  n = n + 1             ÿ
                                    do co = 3 to words(c_bcc)
                                       cmd.n = "            " word(c_bcc
  ÿ
                                           end
                                           end
                   ÿ
      ÿ                                         cmd.n = "       " c_bcc
                                                n = n + 1
                                    ÿ
                     ÿç
en n = n - 1                                             cmd.n = c_from
                                                           if str+
null then cmd.n = "       " cmd.n "+ÿ
    else n = n - 1                                             n = n + 1
                                                               cmd.n = c
                                                   ÿ
n)ÿ
        else n = n - 1                                             n = n
                                                                  ÿ
ubject             ÿ
p(cmd.n) <> null then cmd.n = "       " cmd.n "+"
            else n = n - 1                                             n
 ÿ
 = c_receipt
strip(cmd.n) <> null then cmd.n = "       " cmd.n "+"
                ÿ
 = n + 1
md.n = c_import
 if strip(cmd.n) <> null then cÿ
                        else n = n - 1
   n = n + 1
   cmd.n = c_sens                             ÿ
       ÿ
                            else n = n - 1
       n = n + 1                                             ÿ
         cmd.n = c_priorÿ
             if strip(cmd.n) <> null then cmd.n = "       " cmd.n "+"
                                else n = n - 1
             n = n + 1                   ÿ
               cmd.n = c_mur
                 if strip(cmd.n) <> null then cmd.n = "       " cmd.n "+
           ÿ
                   n = n + 1
                   cmd.n = c_zipmethod
                     if stÿ
"                                           else n = n - 1
                       n = n + 1
                       cmd.n = c_zippass +
            ÿ
d.n "+"                                           else n = n - 1
                             n = n + 1
                             +
                             ÿ
  " cmd.n "+"                                           else n = n - 1
                                   n = n + 1                         ÿ
                                     cmd.n = cÿ
                                         if strip(cmd.n) <> null then cm
      " cmd.n "+"                                           else n = n -
    ÿ
                                           cmd.n = c_filedesc
                                             if strip(cmd.n) <> null the
= "       " cmd.n "ÿ
ÿ
                                               cmd.n = c_format
                                  ÿ
cmd.n = "       "ÿ
 n - 1                                             n = n + 1
                                                 ÿ
                                  ÿ
 then cmd.n = "       " cmd.n "+"
 n = n - 1                                             /* now reÿ
+ */                                               ÿ
ngth(cmd.n)-1)                                             n = n + 1
                                                           cmd.n = "  "

                                                               /* ------
------------ *                                                  * Now is
command      *ÿ
-----ÿ
"TEST" then                                                        say "
 c_to c_msgds c_cc c_bcc c_frÿ
_format c_margin c_sigÿ
 c_prior c_filedesc c_replyto c_receipt c_zippass ,
 c_filename c_zipmethod                     ÿ
                                       ÿ
tip" c_to c_msgds c_cc c_bcc c_from c_subject c_file,
     c_format c_margin c_sigds c_import c_sens c_mur,      +
       c_prior c_filedesc c_replyto c_receipt c_zippass ÿÿ
           c_filename c_zipmethod
 call outtrap "off"


                 "ALLOCATE FILE("xmit_dd") REUSE UNIT(SYSDA) SPACE(1 1)
",                        "DSORG(PS) RECFM(V B) LRECL(255)"
       ÿ
                     "EXECIO * DISKW" xmit_dd "(STEM xmit. FINIS)"
                     Address ISPEXEC "LMINIT DATAID(DATAID) DDNAME("xmit
                     Aÿ
                         Address ISPEXEC "LMFREE DATAID("dataid")"
                         "FREE FILE("xmit_dd")"
                         Return      ÿ

                             /* ----------------------------------------
----- *                       * Build address table ÿ
          *                       * ------------------------------------
--------- */                      Build_address_table:
                                  tb_open = 1                      ÿ
ÿ
                                      "TBCreate" tblname "keys(eaddr) na
 lact ename) Write"                   "TBSort" tblname "Fields(ename)"
  ÿ
)"                                         if rc = 8 then do
                                              call Create_Table
                 ÿ
                                                  end
                                               if rc = 12 then do
                                ÿ
ISPPROF)"                                             "TBOpen xmitaddr W
rary(ISPPROF)"                                        end
                                               ÿ
                                                        lact = null
                                                       "TBQuery xmitaddr
rows)"                                                 add_rowÿ
"    ÿ
                                                              "TBSkip xm
                                                              "TBGet  xm
"                     ÿ
ull then call fix_name eaddr                                        "TBA
ame "Order" add_row                                                 add_
ll                                     +
          ÿ
blname                                                                 r

                         ÿ
------------------------------------------------- *
te the permanent address table                    *
----------------------------------------ÿ
eate_Table:
TBCreate xmitaddr keys(eaddr)",
          "Names(ename) Library(ISPPROF) Replace"      ÿ
  return  ÿ

 /* ----------------------------------------------------- *           ÿ
    * Save the address tablÿ
      * ----------------------------------------------------- */
      Save_Addr_Table:
     ÿ
           "TBTop" tblname
           "TBQuery" tblname "rownum(rows)"
           add_row =ÿ
               do rw = 1 to rows
                 "TBSkip" tblname
                 "TBGet" tblname   ÿ
                     "TBAdd xmitaddr" add_row
                     add_row = null
                     end                          ÿ
               ÿ
                       "TBClose xmitaddr Library(ISPPROF)"
                       "TBEnd" tblname                           ÿ
                         return ÿ

                         /* --------------------------------------------
ÿ
      *                       * ----------------------------------------
----- */                     Do_Find:
               +
             ÿ
                                         argument = strip(argument)
                                         hit  = 1
   +
   ÿ
                                               search    = ''
                                           ÿ
                    ÿ
                                                      last_find = last_f
                                                      "TBTÿ
                                     ÿ
tion(ROWID) Number("Last_find")"                          end
                                                          else do
                                                      ÿ
ame "Position(ROWID)"                                              end
                                                           if rc = 8 the
        ÿ
BTop" tblname
BSKIP" tblname "Position(ROWID)"
dsmsg = "Wrapped"      ÿ
end     ÿ
e zedsmsg = "Found"
                                      ÿ
search */                ÿ
                                                                       d
r                                                    ÿ
tt = 1 then                               ÿ
 search = translate(adsn afile aformat adesc)
se                                                                  ÿ
    search = translate(ename eaddr)                        ÿ
  if pos(argument,search) > 0 then do
     crp = rowid + 0
   ÿ
         last_find = crp
             zedlmsg = argument "found during search in row:" crp
             "Setmÿ
           leÿ
             end
          "TBSKIP" tblname "POSIT+
            if rc = 8 then do ÿÿ
                      "TBTOP" tblname
                       zedsmsg = "Wrapped"
                   if find_loop = "on" then doÿ
                           zedsmsg = "Not Foundÿ
                             zedlmsg = argument "Not found during search
                             rowid = crp                     ÿ
                               "Setmsg msg(isrz001)"            ÿ
                                 leave
                                 end
                                   else find_loop = "on"
 ÿ
                              end
           ÿ
                  ÿ
                         /* --------------------------------------------
- *                       ÿ
    *                       * -----ÿ
----- */                      Do_Insert:
                                  iexit =ÿ
                                    "control displayÿ
                                      parse value "" with ename eaddr la
zsel                                  do forever        ÿ
                                           "Display panel(xmitipau)" ÿ
                                             if rc > 3 then leave
                                             if rc < 4 then do         ÿ
                                                  Select
      ÿ
hen                                                         zedlmsg = "I
ame - ÿ
."                     ÿ
 0 then                                                         zedlmsg
id Address - no @ fouÿ
 > 0 then do                            ÿ
eaddr)                                                            if pos
dr,pat+1) > 0 then do               ÿ
 "Too many @ in address"                                 ÿ
 2
                                                   +
 = 0 then do                                     ÿ
f ename = null then call fix_name eaddr
TBAdd" tblname "Order"
f rc = 8 then call dup_eaddr eaddr                              ÿ
 iexit = 1   +
   end     ÿ
  end

 end                        ÿ
iexit = 1 then leave
smsg = "Error"ÿ
Setmsg msg(isrz001)"                         ÿ
 end
d                            ÿ
"control display restore"                                     ÿ
  return
                                            ÿ
* ----------------------------------------------------- *

   Fix_Name:                                               ÿ
     parse arg waddr
     parse valueÿ
       wname = translate(wname," ",".")
         ename = wname
         return                  ÿ

         ÿ
            * Issue duplicate address message     ÿ
              * ----------------------------------------------------- */
              dup_eaddr:ÿ
                parse arg addr                                     ÿ
                  zedsmsg = "Duplicate"
                  zedlmsg = "Address:" ÿ
                              "- not added.  Use Update if you need to c
    ÿ
                      "Setmsg msg(isrz001)"           ÿ
                        return
                     ÿ
                         /* -----------------------------------------+
--- *                       * Test file for existence              ÿ
      *                       * --------ÿ
------- */                      test_file:
                                arg file_dsn
  ÿ
                                    if translate(file_dÿ
eturn                                 if sysdsn(file_dsn) <> "OK" then d
                 ÿ
                                           zedsmsg = "DSN Error"
                                             zedlmsg = file_dsn sysdsn(f
                                ÿ
                                              end
         ÿ
                                               ÿ
                                                     if sysdsorg = "PS"
urn                       ÿ
do                                                        d_rcÿ
                                                            zedsmsg = "D
"                                          ÿ
 "is an invalid dataset" ,                                             "
zation. DSORG="sysdsorg                                        "Setmsg m
01)"                                                        ÿ
                                                                 end
            ÿ
_dsn) > 0 then return                                            d_rc =
                                                                   zedsm
N Error"                   ÿ
ile_dsn "is partitioned and requires" ,
member name." ÿ
sg(isrz001)"                              ÿ
                                                                   retur
                               ÿ
                                                         ÿ
----------------------------------------------- *
 e-mail address table cc / bcc                  ÿ
------------------------------------------------- */
ddress_table2:
ddr_table = 1 then return                                        ÿ
dr_table = 1
ll buil+
call ÿ
  caÿ
    return
                    ÿ
     /* -------------+
        * Do the e-ÿ
          * -----------------------ÿ
            do_address_table:
               mult_sels = 0        ÿ
                 crp = 1                          ÿ
                   rowcrp = 0
                   src    = 0                        ÿ
                     disp:                                       ÿ
                       do forever
                          xmtrfind = "PASSTHRU"                       ÿ
                            "Vput xmtrfind"
ÿ
                              if mult_sels = 0 then do
       ÿ
               ÿ
                                       "TBDispl" tblname "Panel(xmitipat
                        ÿ
                              ÿ
                                      else
                                        "ÿ
                                        t_rc ÿ
                                          mult_sels = ztdsels
                                          xmtrfind = ''   ÿ
                                            "vput xmtrfind" ÿ
                                              if t_rc > 7 then leave
                                              up_ok = 0
                                                select
                                                    when zcmd = "CANCEL"
                                                         call save_addr_
            ÿ
          ÿ                                                  end
                                                        When words(zcmd)
n do                         ÿ
with o1 o2               ÿç
l = null
abbrev("FIND",o1,1) = 1 then call do_find                 ÿ
nd                                      ÿ
 zcmd = "RFIND" then do
 zcmd = "RFIND" o2
   zsel = null                                         ÿ
       call  do_find
       end
  When abbrev("INSERT",zcmd,1) = 1 then call do_insert                ÿ
    When zseÿ
           if lact <> "To" then do
              call clean_addr
     ÿ
                     c_to = strip(c_to '"'ename'" <'eaddr'>')
                  else
                    ÿ
                      lact = "To"
                      zsel = null
                      "TBPut" tblnaÿ
                          end
                       end
                  When zsel = "B" then do         ÿ
ÿ
                              call clean_addr
                              c_bcc = strip(c_bcc eaddr)         ÿ
                 ÿ
                                  zsel = null
                                  "TBPut" tblname
ÿ
                                   end
                              When zsel = "U" then do
               ÿ
                                       lact = null
                                       zsel = null
                              ÿ
                                           end
                                      When zsel = "C" then do
                                           if+
     ÿ
                                                    if ename <> null the
                                                       c_cc = strip(c_cc
e'" <'eaddr'>')       ÿ
                                                           c_cc = strip(
dr)                                                     lact = "Cc"
                                       +
                                       ÿ
                                                              end
                                                           end
        ÿ
o                                                               call cle
                                                               "TBDelete
e                      ÿ
                                                              When zsel
en do                                                              call
dr                                    ÿ
splay saveÿ
ll                                                                     l
evise"                                               ÿ
 tblname "Position(rcrp)"  ÿ
r = eaddr
lay panel(xmitipau)"                                                ÿ
rc < 4 then do                              ÿ
  if s_addr <> eaddr then do
     n_eaddr = eaddr
   ÿ
         "TBTop" tblname
         "TBSkip" tblname "Number("rcrp")"
         "TBDeleteÿ
             eaddr = n_eaddr
             ename = n_ename
             end                 ÿ
            if ÿ
                 up_ok = 1
                 zedlmsg = "Invalid address - noÿ
                   zedsmsg = "Erÿ
                     end
                  if pos("(",ename) > 0 then do                +
                       up_ok = 1                 ÿ
                           zedlmsg = "Invalid name - ( found"
                           zedsmsg = "Error"
                           end                                    ÿ
                            if pos(")",ename) > 0 then do
                               up_ok = 1
                               zedlmsg = "Invalid name - ) found"
   ÿç
                                               end
                                            end
                    ÿ
                                             if up_ok = 0 then
                                                "TBMod" tblname "Order"
                                     ÿ
                                                    "Setmsg msg(isrz001)
                                                 end
                                            When zsel ÿ
                                                     call do_insert
                                                     end
                                                Otherwise do           ÿ
                                                              m_type = n
                                                              if zsel <>
en                                                               m_type
id Selÿ
l then                                                               m_t
Invalid Command" zcmd                                             zedsms
or"                  ÿ
"An" m_type "was entered."                                            if
<> null then
 Msg(isrz001)"                      ÿ
                                                              end
                                                           end
                                                   ÿ

                                                           /* ----------
----------------------------------- *                       * Cleaÿ
ble duplicate address                   *                       * ------
--------------------------------------- */                      Clean_Ad
                                                                if lact
h+

t = "To" then do
l clean_addr_string c_to        ÿ
_to = string  ÿ
 end
 lact = "Cc" then do                             +
   call clean_addr_string c_cÿ
       c_cc = string
       end
  When lact = "Bcc" then do                 ÿ
           call clean_addr_string c_bcc
           c_bcc = string
           end                                             ÿ
   ÿ
          end
          return
                    ÿ
           /* ----------------------------------------------------- *
            * Eliminate duplicate address                           *
         ÿ
                Clean_Addr_String:
                parse arg string
                if enameÿ
                       p1 = wordpos(eaddr,string)
                       string = delword(string,p1,1)
                       end             ÿ
                        else do
                             saddr = "<"eaddr">"
                             p1 = wordpos(saddr,stringÿ
        ÿ
                                    string = delword(string,p1,1)
                                    pw = words(ename)                ÿ
                         ÿ
                                        string = delword(string,p1,pw)
                                        end
    ÿ
                                              p1 = wordpos(eaddr,string)
                                              string = delword(string,p1
                   +
                 ÿ
                                          return

                                ÿ
--------------------- *                       * Do the Attachment Table
                      *                       * ------------------------
-------------+
             ÿ
                                                    att_sel = 0
                                                    tblname = ÿ
                              ÿ
Library(ISPProf)"                                       if rc = 0 then d
                                                           "TBQuery" tbl
Names(names) Rownum(rows)"                     ÿ
 with "(" names ")"                                            if wordpo
AT",names) = 0 then do                                            oldtbl
me          ÿ
"XMITFNEW"                                                            ca
_attachment_table                                                     "T
dtbl                       ÿ
eÿ
 1 to rows
Skip" oldtbl                              ÿ
f pos("/",adesc) >ÿ
    parse value adesc with afile "/" adesc
 "TBadd" tblname                                         ÿ
   end                             ÿ
  "TBend" oldtbl
  "TBSave" tblname "Library(ISPProf) Name(XMITFILE)"
    "TBEND" tblname                                 ÿ
      tblname = "XMITFILE"
      "TBOpen" tblname "Write Library(ISPProf)"
      zÿ
          zedlmsg = "Info: Your File attachment table ",
                    "has been converted to the new format.",
                    "Sÿ
      ÿ
              "setmsg msg(isrz001)"
           end                       +
             if wordposÿ
                    oldtbl = tblname
                    tblname = "XMITFNEW"
                    call build_attachmenÿ
                        "TBTop" oldtbl
                        do i = 1 to rows
                           "TBSkip" oldtbl               +
                               "TBadd" tblname           ÿ
                                 end
                              "TBend" oldtbl
ÿ
LE)"                              "TBEND" tblname
                                  tblname = "XMITFILE"
               ÿ
           ÿ
                                      zedlmsg = "Info: Your File attachm
e ",                          ÿ
 format.",                  ÿ
ve been lost",                                      "in the conversion."
                                          "seÿ
                                         end ÿ
                                        end
                                        if rc = 8 then call ÿ
able                                         mult_sels = 0    ÿ
                                               crp = 1
                                               rowcrp = 1
                                                 src    = 0

                                                   do forever
          ÿ
                ÿ
                                                          "Vput xmtrfind
                         ÿ
n do                             ÿ
                                                                "TBSkip"
 "Number("crp")"                        ÿ
l then csr = "zsel"                               ÿ
    else csr = "adsn"                                               if r
0 then                                                 +
l" tblname "Panel(xmitipfi)",                        ÿ
"Position(rowcrp)"

Displ" tblname "Panel(xmitipfi)" ,                                  ÿ
      ÿ
         "Position(rowcrp)"
d
   ÿ
  "TBDispl" tblname "ÿ
              "Position(rowcrp) cursor(adsn)"
  t_rc = rc       ÿ
    mult_sels = ztdsels               ÿ
      xmtrfind = ''
      "vput xmtrfind"            ÿ
        if t_rc > 7 & att_sel > 0 then leave           ÿ
          if t_rc > 7 then
             if att_sel = 0 then do             ÿ
                  zedsmsg = null
                    zedlmsg = "Error: No files were selected for ",
                              "attachment.  Select at least oneÿ
                                "ok use the Cancel command."
         ÿ
                        zcmd = null
                          end
                    selectÿ
                      when zcmd = "CANCEL" then do
             ÿ
                             signal displayÿ
                               end
                          whÿ
                                 "TBEnd" tblname            ÿ
                                   "TBErase" tblname "Library(ISPProf)"
                                   call buiÿ
                                     zcmd = null
                                       mult_sels = 0
                                       crp = 1            ÿ
                                         rowcrp = 1
              ÿ
                                           end
                                          When words(zcmd) > 1 then do ÿ
                                 ÿ
                                                   if abbrev("FIND",o1,1
en call do_find                                    end
      ÿ
 1 then do                                             "TBbottom" tblnam
                                                       "TBVClear" tblnam
                     ÿ
                                                           "TBQueÿ
rownum(rowcrp)"                                              crp = rowcr
                                    ÿ
                                                          When zcmd = "R
enÿ
o2                                                 ÿ
                                                                   end
                   ÿ
then do                                                           ÿ
ll                                                                     a
ll                                  ÿ
 tblname
=ÿ
  = rowcrp                                           ÿ

l = "S" then do ÿ
sel = null                                                            ÿ
 call test_file adsn
 act  = "Y"                    ÿ
   att_sel = att_sel + 1
   if lÿ
        "Control Display Save"                ÿ
          call fix_format aformat
          "Control Displÿ
            if new_format <> null then                       ÿ
                 aformat = new_format
              end                        ÿ
             "TBPut" tblname
               end
          When zsel = "U" then do                         ÿ
                 zsel = null
           +
         ÿ
                       "TBPut" tblname
                       end
                  When zÿ
              ÿ
                           if act <> null then
                              att_sel =ÿ
                             "T+
                             ÿ
                            When zsel = null then do  ÿ
                                   if left(aformat,1) = "?" then do
                                      "Controlÿ
                                        call fix_format aformat      ÿ
                                          "Control Display Restore"
                                          if new_format <> nullÿ
                                               aformat = new_format
    ÿ
                                           if words(adesc) > 1 then do
ÿ
                   ÿ
s more than" ,                                              "1 word. Das
inserted."       ÿ
                                  ÿ
"," ")                                                end
                                  ÿ
                                                 ÿ
                                                           call test_fil
                                                   ÿ
                                                         end    ÿ
                                                      Otherwise do
                                                                if zÿ
l then                                                               m_t

ull then                                                               m
 "Invÿ
"Error"       ÿ
= "An" m_type "was entered."
Msg(isrz001)"         ÿ
                             ÿç

                                                   ÿ
 0                                          ÿ
urn
                                                                    ÿ
----------------------------------------------------- *    ÿ
* Build the file attachment table                       *
* ----------------------------------------------------- */
build+
     ÿ
                 "names(act adsn afile aformat aleft aright",
                       "atop abottom adesc) replace"
       "Tÿ
           "TBVClear" tblname
           "TBadd"    tblname
           return       ÿ

           /* ----------------------------------------------------- *
            * Process Address          ÿ
                * -----------------------------------------------------
               Process_Address: Procedure Expose t_names. t_addrs parens
               parse arg address                      ÿ
                   /* --------------------------------------------------
                    * Remove any wrapping parens
                    if left(address,1) = "(" then do                 ÿ
          ÿ
                           if right(address,1) = ")" then
                              parse value address with address ")"
    ÿ
                            address = strip(address)

                   ÿ
------- *                       * Test for parenthesis
        */                       parens = 0
                                 iÿ
                                     if pos(")",address) > 1 then parens
                                     if parens = 1 then do
                                        zedsmsg =+
                                            zedÿ
des '(' or ')' :" ,                                      address
                                              Address ISPExec,
               ÿ
                                                  return
                                                  end
                                ÿ
                                                 /* --------------------
------------------------- *                       * set up our variables
                          */                     +
            ÿ
                                                        t_names.0 = 0
                                                        tn = 0
                           ÿ
                                                           /* ----------
----------------------------------- *                       * Now proces
he provided address                 *     ÿ
---ÿ
ddress) = 0                                                          Sel
                                                         ÿ
--------------------ÿ
 name just an address in <>                         *
g. <first.last@address>                             */
n left(address,1) = '<' then do      ÿ
    tn = tn + 1
    parse value address with "<" addr ">" address
    t_aÿ
        address = strip(address)
        end
   /* ----------------ÿ
        * double quotes                                         *
        * e.g. "first last" <first.last@address>                */
       when left(address,1) = '"' theÿ
        ÿ
                if right = 0 then
                   if pos("<",address) > 1          ÿ
                       thÿ
                              address = address">"
                              right = pos(">",address)             +
                                end       ÿ
                               else right = length(address)
                          data = left(address,right)
                          x = length(address)              ÿ
ÿ
                              address = strip(address)
                              tn = tn + 1
               ÿ
                                  parse value data with . "<" addr ">" .
                                  t_addrs = t_addrs addr
             ÿç
                                             /* ------------------------
--------------------- *                       * single quotes
                      *       ÿ
t@address>                */                     when left(address,1) =
 do                                                   right = pos(">",ad
                                               ÿ
                                                             if pos("<",
 > 1                                                           then do
                                                                ÿ
= address">"
pos(">",address)
                                                                   else
lÿ
dress,right)                                                      addres
tr(address,right+1)                                               addres
p(address)        ÿ
1                                                                     pa
e data with "'" t_names.tn "'" .                                      pa
e data with . "<" addr ">" .       ÿ
s = t_addrs addr
                                                                     /*
--------------------------------------------- *     ÿ
 1 word so must be an address                     */
rds(address) = 1 then do
 = tn + 1                                                            ÿÿ
  t_addrs = t_addrs address
  address = ""
  end
-----+
  *ÿ
   when pos(">",address) = 0 then do
        tn = tn + 1      ÿ
          t_addrs ÿ
            address = ""
            end                           ÿ
         /* ---------------------ÿ
            * Test for address without 'name'                       */
           when pos("@",word(address,1)) > 0 then do       +
                  tn = tn + 1                   ÿ
                      t_addrs = t_addrs word(address,1)
                      parse value address with x address
                      end                                      ÿ
                     /* ------------------------------------------------
                      * otherwise assume name with no quotes
                      * e.g. first last <first.last@address>
*/           ÿ
                              right = pos(">",address)
                              data = left(address,right)
             ÿ
                                  address = strip(address)
                                  tn = tn + 1
                            ÿ
                                      parse value data with . "<" addr "
                                      t_addrs = t_addrs addr
                                      end  ÿ
                                     end
                                   end
                                   t_names.0 = tn         ÿ
 ÿ

                                 /* ------------------------------------
----------- *     ÿ
              *                       * --------------------------------
------------- */                      Fix_Format:
        ÿ
                                           Parse value "" with ft tsuf f
h hcolor hsuf,                                                 fr rlayou
rpaper rsuf ,          +
znia fhz hznia zcolorÿ
layout zfont zpaper ,                                                fp
pfont plpi ppaper ,                                                  ÿ
 pzlayout pzfont pzlpi pzpaper ,    ÿ
mat                                                  fixfmt = substr(fix
                                                     if fixfmt <> null t
      ÿ
ith fmt1 "/" fmt2 "/" fmt3 "/" ,
    fmt4 "/" fmt5 "/" fmt6                                  fmt1l = stri
                       +
(fmt1l)                ÿ
mt2)                                                              fmt3 =
mt3)                                                              fmt4 =
mÿ
ip(fmt5)                                                              fm
ip(fmt6)                                                              Se
                ÿ
 fmt1 = "BIN" then
 bznia = fmt2
 left(fmt1,3) = "HTM" then do  ÿ
     hcolor = fmt2
     hsuf   = fmt3
     end                                      ÿ
  When fmt1ÿ
         playout = fmt2
         pfont   = fmt3                                      ÿ
           ppaper  = fmt4   ÿ
             plpi    = fmt5
             end
          When fmt1 = "RTF" then do          ÿ
                 rlayout = fmt2
                 rfont   = fmt3
           ÿ
                     rsuf    = fmt5
                     end
                When fmt1 ÿ

                    When fmt1 = "ZIPBIN" then
                         bznia = fmt2    +
                ÿ
                               hznia  = fmt2
                               zcolor = fmt3
                               enÿ
                              When fmt1 = "ZIPPDF" then do
                                   pznia    = fmt2
                                   pzlayout = fmt3ÿ
                                       pzfont   = fmt4
                                       pzpaper  = fmt5
                                       pzlpi    = fmt6             +
    ÿ
                                        When fmt1 = "ZIPRTF" then do
                                             rznia  = fmt2
                   ÿ
    ÿ
                                                 zpaper  = fmt5
                                  ÿ
                     ÿ
                                                End
                                             End ÿ
                                      ÿ
                                                  "Display Panel(xmitipf
                                                  if rc > 3 thenÿ
                                                       ÿ
                                                      if length(fp) > 0
                                                         if pfont = null

<> "NUM" then do                                                zedsmsg
                                                                zedlmsg
id Font Size Sÿ
rz001)"  ÿ
                                                                    end
                             ÿ
                          ÿ
> 0 then do                                                          if
null then rfont = 9                         ÿ
pe(rfont) <> "NUM" then do                 ÿ
msg = ""
msg = "Invalid Font Size Specified."                       +
etmsg msg(isrz001)"                                      ÿ
  fr = null
  end
nd

   if pzfont = null then pzfont = 9
   if datatype(pzfont) <> "NUM" then do
      zÿ
          zedlmsg = "Invalid Font Size Specified."
          "Setmsg msg(isrz001)"
          fpz = null  ÿ
              end              ÿ
             end
          if length(frz) > 0 then do ÿ
               if zfont = null then zfont = 9   ÿ
                 if datatype(zfont) <> "NUM" then do
                    zedsmsg = ""                    ÿ
                      zedlmsg = "Invalid Font Size Specified."   ÿ
                        "Setmsg msg(isrz001)"
                        frz = null                                 ÿ
                          end
  ÿ

  ÿ
pz)) > 0           ÿ
                          end
                 ÿ
                           When ft <ÿ
                                  nfmt = tsuf
                             Wheÿ
                                    nfmt = "BIN/"bsufÿ
                                 When fh <> null then
                                      nfmt = "Hÿ
                                   When fp <> null then               ÿ
                                          nfmt = "PDF/"playout"/"pfont"/
/"plpi                               When fr <> null then     ÿ
                                            nfmt = "RTF/"rlayout"/"rfont
r"/"rsuÿ
                                              nfmt = "ZIP/"znia
                                           When fbz <> null then
                          ÿ
                                               When fhz <> null then
                                                    nfmt = "ZIPHTML/"hzn
lor       ÿ
                                                        nfmt = "ZIPPDF/"
                                                        nfmt = nfmt"/"pz
"pzfont"/"pzpaper"/"pzlpiÿ
                                                       When frz <> null
                                                            nfmt = "ZIPR
a"/"zlayout"/"zfont"/"zpaper            ÿ
                                                           end
                                                             new_format
                                                       ÿ

            ÿ
**************************************************           * Trap unÿ
zed variables                                      *           *********
*****************************ÿ

     ÿ
" condition("Description") "undefined in line"ÿ  sigl":"             Say
ine(sigl)                                                            Say
t systems support abÿ
                                                               {

                   /* -------------ÿ
----- *               * Name:      XMITIPMU (Murphy)
      *       ÿ
TIP     *               *            application. ÿ
          *               *
          *               * Funÿ
 be used    *               *            either standalone, whereÿ
s merely      *               *            output using SAY, or as a cal
tion, where   *               *            the pÿ
single RETURN   *               *            value.
ÿ
                  *               * Environment: Tested under TSOÿ
/390 2.5 and under  *               *            CA-OPS/MVS OPS/REXX at
4.3.           +
X environmentÿ
    ÿ
tandalone)                *               *            rtvl = xmitipmu(S
unction call)             * ÿ
UNC")                ÿ
  (function call in OPS/REXX) *               *
                              *            ÿ
 positive integer to receive    *     ÿ
 phrase.                          *               *
                                  *               * Examplÿ
 (standalone from TSO command line) *               *  ÿ
   (and with seed)                    *               *
                                      *               *            TSO %
MU  (standalone from ISPF command line) *               *            TSO
IPMU 321 (and with seed)                  *               *
                                          *               *            a
SO      ÿ
PMU"     ÿ
TIPMU 321"      (and with seed)               *               *
                       ÿ
XMITIPMU          (standalÿ
I XMITIPMU 321      (and with seed)               *               *
                                      ÿ
 !OI XMITIPMU         (standalone OPS/REXX +
                        ! is site OSFCHARÿ
                                                     ÿ
       The following code extract can be used to make     *
       a function call and 'deblock' the RETURN value.    ÿ
                                                            *       ÿ
           murph = xmitipmu(,"FUNC")                          *
           mur. = ""                                          *
*            n = 1                                              *
*  ÿ
  *                                                               *
  *         ÿ
    *             ÿ  murchar = substr(murph,murpos,1)                 *
      *              if murchar = "0A"x then do                       *
      *                n = muÿ
        *                mur.n = ÿç
      *               *                mur.0 = n
      *               *              end                  ÿ
        *               *              else mur.ÿ
          *               *            end
          *               *
            *               *            do n = 1 to mur.0     ÿ
              *               *              say mur.n
              *               *            end
            ÿ
                  *               * Installation: On TSO, put it somewhe
ur SYSEXEC or     *               *            SYSPROC concatenation.
                  *          ÿ
             ÿ
                      *               *            Ladbroke Racing UK Lt
                      *               *       ÿ
                        *   ÿ
                          *               *            Rayners Lane
                          *               *            HARROW  ÿ
                            *              ÿ
                              *               *            UK
                              *               *
ÿ
old@yahoo.co.uk                   *               *         or Paul.Well
kes.co.uk                         *               * Telephone: +44 7808
                 +
                 ÿ
                                        *               *            00/
add pooh quote                          *               *            00/
remove sÿ
4:  add a few quotes                        *               *
2:  Original with 949 phrases               *               *
                       ÿ
ts:                                             *               *
                                                *               *
t of the phrases in this REXX version ÿ
 Murphy originate from file 300 of the CBT tape     *               *
 at http://www.cbttape.org. This version of Murphy  *               *
 is the one which most sites seem to use. I then    *+
   adÿ
                                                          *
       After correcting some spelling errors, adding      *
       quotation marksÿ
           and removing some which seemed 'tired', I added    *
           a few myself from the excellent web site           *
           of mainframer Thierry Falissÿ
*ÿ
  *            homepages/TFALISSARD/murphy.htm                    *
  *                                                     ÿ
    *           ÿ
      *            try this link.                                     *
      *                                                               *
        *            http://womÿ
          *            foldoc.cgi?query=murphy&action=Search
          *
          ÿ
              *
              *            This program is provided on an "as is" basis
              *            ÿ
  *               *            implied, including, but not limited to, t
ed*               *            warranties of merchantability or fitness
  *               *            a particular ÿ
 or   *               *            or the results therefrom is entirely
isk   *               *            of the user. This program is freeware
 be   *               *            be freely copied, modified+
        *  ÿ
            *               * ------------------------------------------
----------- */
                          ÿ
                                              /* The 2nd parameter is a
ich may be used                                     to identify whether
eing called                              ÿ
n. This is usefÿ
 which PARSE SOURCE                                     does not return
N' e.g. OPS/REXX */                                     ÿ
                                ÿ
* no non-numeric seeds */
                                        call set_murph   /* load the mu+
/                                                ÿ
                                              do cnt = 1 to 9999 /* arbr
ax 9999 to guard against loop */
                                                varname = "M"××rigÿ
)××"ÿ
                                                    if value(varname) =
then do /* initialised variable ? */
ot,ÿ
set the number of Murphy phrases */                       leave

                    ÿ

                                                          end
                                     ÿ
                                                              if seed <
               /* passed a valid seed ? */                     seed = ra
ummurph)       /* if not, set random one */           ÿ
                                                                   if se
murph then ,       /* seed > than max ? */                          seed
 // nummurph) + 1  /* if yes, set a valid one */                       ÿ

""
                                                                      do
 to 10 /ÿ

ame = "M"××right(seed,5,"0")××"."××cnt
.cnt = value(varname)    +
                         ÿ
  if varname = line.cnt then do  /* past last line ? */
    line.0 = cnt - 1  /* if yes, set array cÿ
      leave             /* and finish */  ÿ
      end
      else do                                              ÿ
          if cnt = 1 then pad = "" /* if 1st line then no pÿ
            else pad = "0A"x         /* else pad is a newline */
            lineout = lineout××pad××line.cnt
            end

            end
         +
       ÿ

                  if called = "FUNCTION" ×,  /* source is function ? */
                   PARÿ
                       return lineout            /* if either, return da
                      else do cnt = 1 to line.0  /* else we are standalo
                        say line.cnt ÿ
                          end

                         return 0                   ÿ


                             set_murph:                            ÿ
   ÿ
                                 M00001.1 = ,
                                 '"When things are going well, someone w
itÿ
                                     M00002.1 = ,
                                     '"If not controlled, work will flow
competent man untÿ
                                         M00003.1 = ,
                                         '"The deficiency will never sho
 during the test runs."'        ÿ
                                             '"The lagging activity in a
 will invariably be found'                   M00004.2 = ,
                                             'iÿ
overtime rates lie waiting."'                    M00005.1 = ,        ÿ
                                                   '"It is impossible to
 fool-proof system, because fools are s'××,        'o ingeniouÿ
                                                     M00006.1 = ,
      ÿ
 sales will continually be'                            M00006.2 = ,
                                                         'interpreted as
ial ability."'         ÿ
                                                           '"Information
 more surelyÿ
                                        ÿ
                                                               '"The ''t
itive'' leader tends to lis+
                         ÿ
e''s premonitions only during the postmortems."'                     M00
,                                                                    '"A
al idea can never emerge from committee ÿ

1 = ,
od deed goes unpunished."'                             ÿ
1.1 = ,      ÿ
hen the product is destined to fail, the delivery system'
011.2 = ,                                                             ÿ
will perform perfectly."'     ÿ
 M00012.1 = ,
 '"Clearly stated instructions will consistently produce'
 M000ÿ
     'multiple interpretations."'
     M00013.1 = ,
     '"The crucial mÿ
         M00013.2 = ,
         'the paper clip of the overlying memo and go to file."'
         M00014.1 = ,              ÿ
 ÿ
             M00014.2 = ,
             'boxes will never decrease."'        ÿ
               M00ÿ
                 '"It is okay to be ignorant in some areas, but some peo
e the'××,        ' privilege."'                                  ÿ
                   M00016.1 = ,    +
                     '"Every Titaÿ
                       M00017.1 = ,
ÿ
inst'                    M00017.2 = ,             ÿ
                           'failure of the contingency plan."'
               ÿ
                             '"Adding manpower to a late software pÿ
s it later."'                  M00019.1 = ,
                              ÿ
rsity of inanimate ob'××,        'jects."'
    ÿ
                                   '"You can +
day at a time."'                     M00021ÿ
                       ÿ
ou can offend them with subst'××,        'ance."'
                                         M00022.1 = ,     ÿ
                                        ÿ
; our own paperwork is loss."'               M00023.1 = ,
                                             '"At any level of traffic,
lay is intolerable."'                          M00024.1 =ÿ
                                                 '"As the economy gets b
verything else gets worse."'                     M00025.1 = ,
        ÿ
                                                     M00026.1 = ,
                                                     '"The more directiv
ssue to solve a problemÿ
           ÿ
                                                         '"Cop-out numbe
                                      ÿ
                            ÿ
en it when I got it."'                                       M00028.1 =
                                                     ÿ
 to your ass in alligators, it is difficult tÿ
                                                                 M00028.
                                                                 'miÿ
fact that your primary objective was to drain the swam'××,    ÿ
                                                                     M00
,                                                                    '"T
to ÿ

littered with sloppy analyses!"'
0.1 = ,           ÿ
n a democracy you can be respected though poor, but don''t count '××,
 it."'        ÿ
00031.1 = ,                      ÿ
 '"If the assumptions are wrong, the conclusions aren''t likely to be'××
 ' very good."'                ÿ
   M00032.1 = ,                                 ÿ
     '"The organization of any program reflects the organization'
     M00032.2 = ,                               ÿ
       'of the people who developed it."'                      +
         M00033.1 = ,                                        ÿ
           '"There is no such thing as a ''dirty capitalist'', onlyÿ
st."'        M00034.1 = ,
             '"Anything is possible, but nothing is easy."'
               M00035.1 = ,
    ÿ
e sta'××,        'rs."'
           ÿ
                   '"ÿ
                     M00037.1 = ,
                     '"A lÿ
chnological'××,        ' roccoco."'   ÿ
                         M00038.1 = ,
                         '"A little humilÿ
                           M00039.1 = ,                ÿ
                             'Ancient Chinese curse:'
                             M00039.2 = ,               ÿ
                               '"May all your wishes be granted."'
                                 M00040.1 = ,
                                 '"Any time you wish to demonstrate somÿ
 the number of'                    M00040.2 = ,
         ÿ
ewers."'                             M00041.1 = ,
      ÿ
up that does not take placÿ
                                         M00042.1 = ,
                     ÿ
ilure.'                                    +
                                         ÿ
xample."'                           ÿ
                                                 '"Despite the sign that
wet paint'', please don''t."'                    M00044.1 ÿ
                                                   ÿ
 less like chicken."'                                M00045.1 = ,
                                                     '"People don''t cha
hey only become more so."'                             M00046.1 = ÿ
                                                         '"If your next
hili tastes better, it probably is'                      M00046.2 = ,
            ÿ
 +

 one more bug."'               ÿ
                                                                 '"The b
always win."' ÿ
                                                ÿ
s ever accomplished by a reasonable man."'                           M00
,                            ÿ
ficiently advanced technology is indistinguishable from mag'××,  ÿ

1 = ,                                       ÿ
's always darkest just before the lights go out."'
2.ÿ
t is better to be part of the idle rich class'             ÿ
00052.2 = ,
than be part of theÿ
 M00053.1 = ,
   '"Each problem solved introduces a new unsolved problem."'
   M00054.1 = ,                     ÿ
     '"For every credibility gap there is a gullibility fill."'
     M000ÿ
       '"If you have something to do, and you put it ÿ
         M00055.2 = ,
         'chances are soÿ
           M00056.1 = ,                                               ÿ
             '"Everybody''s gotta be someplace."'
             M00057.1 = ,              ÿ
               '"Nature is a mother."'
       ÿç
                             '"If you''ve got them by ÿ
and minds will foll'××,        'ow."'
                        ÿ
                                 '"People will accept your idea much ÿ
ily if you tell'                   M00059.2 = ,
                                   'them ÿ
                                     M00060.1 = ,
    ÿ
H"'                                    M00061.1 = ,       ÿ
                                         '"Any given program, when runni
bsolete."'         +
                 ÿ
d takes longer."'                              M00063.1 = ,
                                               '"If a program is useful,
 be changed."'                  ÿ
              ÿ
 will be documented."'                             M00065.1 = ,
                                               ÿ
pand to fill all available memoÿ
                                                       '"The value of a
is inversely proportional'                             M00066.ÿ
                                                ÿ
 output."'                                                 M00067.1 = ,
                                                           '"In case of
 make it sound convincing."'                                 M000ÿ
                                                               '"Program
ity grows until it exceeds the capability'                     M00068.2
            ÿ
meÿ
                                                                   '"Mak
sible for programmers to wrÿ
,                  ÿ
will find that programmers cannot write in English."'                  M
= ,                                       ÿ
y''s First Law of Evolving System Dyÿ
0.2 = ,
e you open a can of worms, the only way to recan them'   ÿ
070.3 = ,                                            +
is to use a larger can."'                          ÿ
 M00071.1 = ,
   '"If you can''t measure it, I''m not interested."'
   M00072.1 = ,                                                     ÿ
     '"The best way to lie is to tell the truth.....'
     M0ÿ
       'carefully edited truth."'
     ÿ
         '"There are tÿ hree ways to get things done'
           M00073.2 = ,
           ' Do it youÿ
             M00073.3 = ,            ÿç
                           ' Hire someone to do it or'
                           M00073.4 = ,            ÿ
                             ' Forbid your kids to dÿ
                               M00074.1 = ,
                               '"A fail-safe circuit will destroy otÿ
                                 M00075.1 = ,                      ÿ
                                   '"History repeats itself.'
                                   M00075.2 = ,
     ÿ
ryÿ
                                       '"90% of everything is crud."'
                      ÿ
                 ÿ
f she can."'                               M00078.1 = ,
                                       ÿ
no advice."'                    ÿ
                                               '"Speak softly and own a
n Doberman."'                                  M00080.1 ÿ
                                               ÿ
overnment where'                                   M00080.2 = ,
                                                   'everybody gets what
jority deserves."'                                   M00081.1 ÿ
                                                       '"If you''re worr
t being crazy,'                                        M00081.2 = ,
          ÿ
cerned:'                                                   M00081.3 = ,
                                                           'if you were,
ld think you were sane."'  +
            ÿ
aken in twos always come out of the bottle in threes."'          M00083.
                                                                 '"Flynn
'                          ÿ
,                                                                    'Tr
ad'                                                                  M00
,                                         ÿ
ive the MCP."'
1 = ,
programmers don''t number paragraph names consecutively."+
085.1 = ,                                              ÿ
"If you''re feeling good, don''t worry, you''ll get over it."'
00086.1 = ,
"Real programmeÿ
   M00086.2 = ,
   'of COBOL when they don''t know any other language."'
   M00087.1 = ,                 ÿ
     ÿ
       M00087.2 = ,
       'A mouse built to government specificationÿ
         M00088.1 = ÿ
           '"Real programmers are kind to rookies."'
           M00089.1 = ,                                           ÿ
             '"Real programmers donÿ
rvi'××,        'ce request."'
               M00090.1 = ,
   ÿ
                   M00090.2 = ,
                   'operations department called them last night."'
                   Mÿ
                       '"A day without sunshine is like ... night!"'
                       M00092.1 = ,
                       '"Real programÿ
ÿ
                           'which they then self-righteously refuse to e
'                          M00093.1 = ,               ÿ
               ÿ
                               M00094.1 = ,
                               '"Real programmers understand PASCAL."' +
                              ÿ
                                     '"Real programmers know it''s not o
s fault if their jobs go '××,        'into ''hogs."'
                                     M00096.1ÿ
        ÿ
 from the vending machines."'            M00097.1 = ,
                                         '"Real programmers ÿ
 programs."'             ÿ
                                             '"When life hands you a lem
 lemonade."'                                 M00099.1 = ,
                                          ÿ
the standards manual but won''t admit i'××,        't."'
                                                   M00100.1 = ,
                                                   '"Real pÿ
dvertiseÿ
                                                       '"Real programmer
 dress for success unless they are'                    M00101.2 = ,
                       ÿ
thers that they are going on interviews."'                 M00102.1 = ,
                                                           '"Real progra
 not practiceÿ
                                                               M00103.1
                                                               '"All war
expire upon payment of invoiceÿ
                                                                   '"Rea
mmers argue with the systems analyst as a matter of pri'××,        'ncip
                                               ÿ
= ,                                                                    '
al test is when it goes production ...'                                M
= ,                                                             ÿ
n iÿ
5.3 = ,
e n     i  t     g  o  e  s     p  r  o  d  u  c  t'
5ÿ
w h  e   n       i   t       g   o   e   s       p   r   o"'
00106.1 = ,
"Real programmers ÿ
   M00106.2 = ,
   'always seem tense and overworked."'
   M00107.1 = ,                    +
       '"Real programmers always haÿ
         M00108.1 = ,
         '"Anyone who follows a crowd will never be followed byÿ
           M00109.1 = ,                             ÿ
             '"Real programmers can do octal, hexadecimal and binary mat
e'××,        'ir heads."'
               M00110.1 = ,                                          ÿ
                 '"Real programmers don''t write memos."'
                 M00111.1 = ,
             +
      ÿ
                       '"Real programmers do not utter profanities at an
d decibel l'××,        'evel."'
                       ÿ
                           '"Where you stand on an issue depends on wher
t."'                       M00114.1 = ,
                           '"Real prograÿÿ
 non-DP situations."'          M00115.1 = ,
                               '"186,000 miles per second - it''s not ju
d idea, it''s the l'××,        'aw."'                   ÿ
                                   M00116.1 = ,
                                   '"Real programmers do not read books
                                   M00116.2 = ,                        ÿ
                                       '''effective listening'' and ''co
ion skills''."'                        M00117.1 = ,
                                       '"Real programmers print only cle
les,' ÿ
                                           'fixing all errors through th
al."'                                      M00118.1 = ,
                     ÿ
d."'                                           M00119.1 = ,
                                               '"A diplomat is someone w
ell you to go to hell'              ÿ
                                                   'in such a way that y
forward to the trip."'                             M00120.1 = ,
                                                   ÿ
o around in circles, for they shall be know'××,        'n as wheels."'
                                                       M00121.1 = ,
                                                       '"Never eatÿ
 +

active, cater to your favorite neurosis."'                   M00123.1 =
 ÿ
d dataset is inaÿ
                                                                 '"RACF
r letter word."'ÿ
                                 ÿ
e recognized soon.'                                                  M00
,                              +
                             ÿ
5.3 = ,
hey find you, lie."'
6.1 = ,                                     ÿ
First Law of Advice:'
00126.2 = ,
"The correct advice is to give the advice that is desired."ÿ
 M0012ÿ
   '"Avoid reality at all costs."'
   M00128.1 = ,
     'Program design phÿ
       M00128.2 = ,
       '"Start at the beginning and continue until the end, then stop."'
       M0ÿ
           '            (Lewis Carroll)'
           M00129.1 = ,
           '"A closed moÿ
               M00130.1 = ,
               '"Only mediocre people are always at their best."'
               M00131.1 = ,            ÿ
                   '"Friends come and go, but enemies accumulate."'
                   M00132.1 = ,
                   '"In a hierarchical organization,' ÿ
           ÿ
                       'the higher the level,'
                       M00132.3 = ,                                  ÿ
                         'thÿ
                           M00133.1 = ,
                           '"Anyone can hold the helm when the sea is ca
    ÿ
                               'Publilius Sÿ
8'                               M00134.1 = ,
                   ÿ
one will occur."'                  M00135.1 = ,             ÿ
                                     '"The faster the plane, the narrowe
ats."'                            ÿ
                                       '"The logical man has a shorter l
pectancy than the practical m'××,        'an,'
                                         M00136.2+
                                           'becÿ
ys on a one-way ÿ
                                               '"If on an actuarial basi
is a 50-50 chance that'                        M00137.2 = ,   ÿ
                                 ÿ
                                                   M00137.3 = ,
                                                   'it will actually go
nine times out of ten."'                          ÿ
                                                       '"A man of qualit
ot fear a woman seeking equality."'                    M00139.1 = ,
            ÿ
ntelligent tinkering is to save all of the part'××,        's."'
                                                           M00140.1 = ,
                           ÿ
ase ÿ
                                                               '"There i
tion to every problem; the only difficultyÿ
                     ÿ
                                                                   '"Don
 your doctor your heir."'                                ÿ
,                                     ÿ
ask the barber if you need a haircut."'                                M
= ,                                                                    '
u don''t like the answer, you shouldn''t have asked theÿ
"'
5.1 = ,
not belÿ
00146.1 = ,
"You can''t expect to hit the jackpot'
00146.2 = ,           ÿ
 'if you +
   M001ÿ
     '"Unless you intend to kill him ÿ
       M00147.2 = ,
       'in the balls, noÿ
         M00147.3 = ,                               ÿ
           'not symbolically."'
           M00148.1 = ,                  ÿ
             'Freud''s 23rd law: "Ideas endure and prosper in inver+
               M00148.2 = ,                                      ÿ
                 'proportion to their soundness and validityÿ
                   M00149.1 = ,
                   '"A short cut is the longest distance between two poi
ÿ
                       '"If you want to make an enemy, do someone a favo
                       M00151.1 = ,
               ÿ
 best compute'ÿ
                           M00152.1 = ,
                           '"Tÿ
eral rights."'               M0ÿ
                               'The three laws of Thermodynamics in simp
'                              M00153.2 = ,  ÿ
                                 '1) "You can''tÿ
                                   M00153.3 = ,
                                   '2) "You can''t break eveÿ
                                     M00153.4 = ,                ÿ
                                       '3) "You can''t even quit the gam
                                       M00154.1 = ,
                                         '"When eating an elephant, take
e ÿ
                                           '"Common sense is not so comm
          ÿ
                   ÿ
                                               M00156.2 = ,
                         ÿ
ucation!!"'                         ÿ
                                                   '"Fuzzy project objec
e used to avoid the'                    ÿ
                                                     +
ing the corresponding costs."'                     ÿ
                                                       ÿ
sely proportional to its reputation for being u'××,        'seful."'
                                                           M00159.1 ÿ
                                                             '"You wilÿ
 find something in the last place you look."'                  M00160.1
                                                               '"The pro
 of aÿ
     +
   ÿ
 myth of management is tÿ
= ,                                                                    '
nd myth of managemÿ
1 = ,                                    ÿ
 trouble with computers is that they do what you tell'
2.2 = ,                          ÿ
em to do, not what you want them to do."'                 ÿ
00162.3 = ,
        - A frustrated programmer'              ÿ
 M00163.1 = ,
   '"Inside every large program is a small program struggling to get ou'
   't."'                                                       ÿ
     M00164.1 = ,
     '"A memÿ
       'e writer."'
         M00165.1 = ,
         '"Never insult an alÿ
           M00166.1 = ,
           '"ÿ
             M00167.1 = ,                     ÿ
               '"The word ''dog'' does not bite."  --- William James'
               M00168.1 = , ÿ
                 '"The man who can smile when things go wrong hÿ
                   M00168.2 = ,
                   'someone he can blame itÿ
                     M00169.1 = ,
ÿ                      '"The chance of a piece of bread falling with the
d side'                M00169.2 = ,                       ÿ
                         'down is directly proportional to the cost of t
t."'             ÿç
                                       '"In the fight between you and th
d, back the world."'                     M00171.1 = ,
                                  ÿ
                                           M00172.1 = ,
        ÿ
                                             M00172ÿ
                                               'Never regret anything.'
                       +
                     ÿ
t responsible."'                                     M00173.1 = ,
                                                     '"If you have alway
t that way, it is probably wrong."' ÿ
       ÿ
he solution of a problem,'                               M00174.2 = ,
                                                   ÿ
ou know the answer.'    ÿ
                                                             'Provided o
 you know there is a problem."'                              M0017ÿ
                                         ÿ
s of any meeting is in inverse proportion to the atte'××,        'ndance
                                                                 M00176.
 ÿ
oes down just when you need it the most."'                           M00
,                                                                    '"P
el tends to drivÿ
1 = ,
ver creates the greatest inconvenience for the largest'××,
r must happen."'               ÿ
9.1 = ,     ÿ
o matter how long or hard you shop for an item, after'
179.2 = ,                                     ÿ
you have bought it, it will bÿ
 M00180.1 = ,
 '"Sanity and insanity overlap a fine gray line."'           ÿ
   M00181.1 = ,                               ÿ
     '"A disagreeable task is its own reward."'
     M00182.1 = ,
       '"If things were left to chance, they''d be better."'   +
         M00183.1 = ,                                        ÿ
           '"The phone will not ring until you leave your desk and walk'
           ÿ
             'to the other end of the building."'
               M00184.1 = ,
               '"Anybody cÿ an win - unless there happens to be a second
'                M00185.1 = ,
               ÿ
                   M00185.2 = ,          ÿç
                                 'willing, and able to lay down your lif
s country."'                     M00186.1 = ÿ
                                   '"If a thing is done ÿ
becomes right."'                     M00187.1 = ,
                                     '"People will buy anythiÿ
 a customer."'                         M00188.1 = ,                    ÿ
                                         '"If you just try long enough a
enough, you can always'                  M00188.2 = ,
                                           'manage to boot yourself in t
rior."ÿ
                                             '"No one''s life, liberty,
rty are safe'  ÿ
                     ÿ
ssion."'                                         M00190.1 = ,
                                ÿ
u have submitted a job."'           ÿ
                                                     '"Bad news drives g
 out of the media."'                             ÿ
                                                   ÿ
lly good at something, you don''t need to do '××,        'it anymore."'
                                                         M00193.1 ÿ
                                                           '"If faÿ
onform to the theory, they must be disposed of."'            M00194.1 =
                                                             '"Almost an
s eÿ
 ÿ
 administered, vacations do not diminish productivity'××,        '.'
                    ÿ
                ÿ
week you are away and get nothing done, there is another'            M00
,                                    +
n your boss is away and you getÿ
6.1 = ,
matter what happens, there is always somebody who knew that it '××,
d."'                                          ÿ
00197.1 = ,
"The other line always moves faster."'
00198.1 = ,                                                  +
   '"Never eat at a place called Moms, never play cards witÿ
     'd Doc,'
     M00198.2 = ,
     'anÿ
         '."'
         M00199.1 = ,
         '"To get a loan,ÿ
         ÿ
             '"When all else fails, read the instructions."'
             M00201.1 = ,                 ÿ
               '"Anythinÿ
ou th'××,        'ought."'
                 M00202.1 = ,                              ÿ
                   '"''Close'' counts iÿ
clear dev'××,        'ices."'
                     M00203.1 = ,
                       '"The lion and the lamb shall lÿ
                         M00203.2 = ,
                         'but the lamb won''t get much sleep."'
             ÿ
                             '"If you fool around with a thing for very
 will screw it up'××,        '."'
                             Mÿ
    ÿ
st advice."'                     M00206.1 = ,
                                 '"Justice alwaÿ
                   ÿ
                                     'three times out of seven."'
                                     M00207.1 = ,               ÿ
                                  ÿ
, it needed replacing anyway."'          M00208.1 = ,
                                         '"I have yet to see any problem
r+
 ÿ
ht way, did not become'                        M00208.3 = ,
                                               'still more complÿ
oul Anderson'     ÿ
                                                   '"Any tool dropped wh
iring a car'                                       M00209.2 = ,

o the exact center."'                                    M00210.1 = ,
                                                         '"No matter whi
tion you start, it''s always against the wind'××,   ÿ
            ÿ
                                                             '"The repai
l never have seen a model quite like yours before'××,        '."'    ÿ
                           ÿ
                                                                 '"Don''
it, get a bigger hammer."'                                       M00213.
      ÿ
oken appliance is demonstrated for the repairman,'                   M00
,                                                                    'it
rk perfectly."'        ÿ
1 = ,
the poor egg:'
2 = ,                                   ÿ
 only gets laid once in its life."'
215.1 = ,
n optimist is a person who looks forward to marriage.'   ÿ
00215.2ÿ
 'A pessimist is a married optimist!"'
 M00216.1 = ,
   '"A pessimist is anÿ
     M00217.1 = ,
     '"Old programmers never die - they just abend."'
     M00218ÿ
         '"The success of any venture will be helped by prayer,'
         M00218.2 = ,
         'even in the wrong ÿ
             M00219.1 = ,
             '"Just about the time when you think you can make ends meet
             M00219.2 = ,                    +
                 'somebody moves the ends!"' ÿ
                   M00220.1 = ,
                   '"Just because you are paranoid doesn''t mean ''they'
t ÿ
                       M00221.1 = ,
                       '"An Irishman is not drunk as long as he can hang
single'          +

rth."'                       M00222.1 = ,
                             '"Beware of all enterprises that require ne
s."'            ÿ
                                 ' - Thoreau'
                                 M00223.1 = ,
                                 ÿ
 drink, some prefer to ju'××,        'st gargle."'
                                     M00224.1 = ,
                                     '"Everything ÿ
s over enough stones.'                   M00224.2 = ,
                                         '(including the snakes that he
want to find.)"'                         M00225.1 = ,              ÿ
                                             '"Everybody should believe
hing;'                                       M00225.2 = ,
                                             'I believe I''ll have anoth
."' ÿ
                                                 '"Those whose approval
 the most give you the least."'                  M00227.1 = ,
                     ÿ
a fool can use, and only a fool will use '××,        'it."'
                                                     M00228.1 = ,
                                      ÿ
any custom as to worship it at' ,                        'the expense of
'                                                        M00228.2 = ,
                                                       ÿ
immermann'                                                   M00229.1 =
                                                             '"Everyone
heme for getting rich that will not work."'                  M00230.1 ÿ
                                                                 '"Being
ted is disagreeable, but the real disasters'                     M00230.
                                                                 'in lif
when ÿ
,        ÿ
hierarchy, each individual rises to his own level'                     M
= ,                 ÿ
ompetence, and then remainÿ
2.1 = ,
does not matter if you fall down as+
232.2 = ,                        ÿ
 'up something from the floor while you get up."'
 M00233.1 = ,
 '"You will remember that you forgot to take outÿ
     M00233.2 = ,
     'when the garbage truck is two doors away."'
     M00234.1 = ,                                              ÿ

         M00235.1 = ,
         '"Some of it plus the rest of it is all of it."'
           M0023ÿ
             '"There''s never time to do it right, but there''s always t
o'××,        ' it over."'
             ÿ
                 '"The more ridiculous a belief system, the higher the p
ty'××,           ' of its success."'
                 M00238.1 = ÿ
                     '"Anything good in life is either illegal, immoral
ning."'              M00239.1 = ,
                     '"Old age is always fiÿ
                         M00240.1 = ,
                         '"It is morally wrong to allow suckers to keep
ney."'                   M00241.1 = ,                     ÿ
    ÿ
                             M00241.2 = ,
                             'be sure to keep your mouth shut."'
                     ÿ
                                 '"One''s life tends to be like a beaver
 dam thing after anot'××,        'her."'
        ÿ
                                     '"A bird in hand is safer than one
."'                                  M00244.1 = ,
                       ÿ
 time available for'                     M00244.2 = ,ÿ
                                           'work is usually about 0.6"'
                                      ÿ
                                             '"Remember the golden rulÿ
                                               M00245.2 = ,
                                               'Those+
the rules."'                                     M0ÿ
         ÿ
ched the point of no return and'                     M00246.2 = ,
                                                     'knows it, foÿ
njoy living."'            ÿ
                                                         '"Everything ea
e San Andreas fault will eventually'                     M00247.2 = ,
 ÿ
lantic Ocean."'                                              M00248.1 =
                                                             '"Some peop
minds like a steÿ
                                                                 ' whate
 in gets crushed and mangled."'                                  M00249.
                               ÿ
ways sides with the hidden flaw."'                                   M00
,                                                                    '"B
s he who expects no gratitude, for he shall noÿ
'             ÿ
1 = ,
ight at the end of the tunnel is the headlamp of an oncoming ÿ
n."'                           ÿ
252.1 = ,
elibacy is not hereditary."'
00253.1 = ,                                     ÿ
 '"You can observe a lot just by watching."'
 M00254.1 = ,
 '"Even theÿ
     M00255.1 = ,
     '"Never sleep with anyone crazier than yourself."'
     M00256.1 = ,         ÿ
  ÿ
         M00257.1 = ,
         '"Beauty is only skin deep; uglyÿ
           M00258.1+
             '"Neÿ
               M00259.1 = ,                             ÿ
                 '"To know yourself is the ultimate form of aggression."
                 M00260.1 = ,     ÿ
                   '"An ounce of application is worth a ton of abstract+
                     M00261.1 = ,                                    ÿ
                       '"Never play leapfrog with a uÿ
                         M00262.1 = ,
                         '"A bird in the hand is dead."'
    ÿ
                             '"A Smith and Wesson beats four aces."'
                             M00264.1 = ,
                   ÿ
       ÿ
                                 '"If everything seems to be going well,
                                 Mÿ
                        ÿ
 going on."'                         M00266.1 = ,
                                     '"If at firsÿ
t on your supervisor."'                M0ÿ
                                         '"If more than one person is re
e for a miscalculation,'                 M00267.2 = ,           ÿ
                                           'no one will beÿ
                                             M00268.1 = ,
                                             '"Don''t bite the hand that

                                                 '"DDD      OO     NN
TT       PPPP    AA    NN   N  I    C'××,        'CC'
              ÿ
            ÿ
  T          P   P  A  A   N N  N  I   C'            M00269.3 = ,
                             ÿ
    T          PPPP   AAAA   ÿ
                                                         ' D  D    O  O
N     T          P     A    A  N   NN  I   Cÿ
                                              ÿ
    N     T          P     A    A  N    N  I    C'××,        'CC"'
                                                           ÿ
                                                               +
                                                             ÿ
                                                                   '"Whe
oubt, mumble.'                                                       M00
,                                                                    'Wh
trouble, delegate.'                                                    M
= ,      +
n chargÿ
1.1 = ,          ÿ
ever argue with a fool, people might not know the difference."'
272.1 = ,             ÿ
"You can''t guard against the arbiÿ
 M00273.1 = ,
 '"People can be divided into three gÿ
   M00273.2 = ,                                    ÿ
     'Those who make things happen,'
     M00273.3 = ,                                   ÿ
       'Those who watch things happen and'                          ÿ
         M00273.4 = ,
         'Those who wonder what happened."'                        ÿ
           M00274.1 = ,
     ÿ
             M00275.1 = ,
  ÿ
n."'           M00276.ÿ
                 '"In any household, junk accumulates to fill all the sp
                 ÿ
                   'available for its sÿ
                     M00277.1 = ,
                     '"Don''t stÿ
mpeding."'             M00278.1 = ,                     ÿ
                         '"The longer the title the less important the j
                         M00279.1 = ,          ÿ
                           '"Everything bows to success, even grammar."'
                             M00280.1 = ,
                             '"When you are right be logical,'ÿ
                               M00280.2 = ,
          ÿ                      'when you are wrong be-fuddle."'
                                 M00281.1 = ,
                                   '"For every human problem, there is a
lain solution --'          ÿç
                                                 'and it is always wrong
            ÿ
                                            ÿ
ife: only survivors."'                               M00283.1 = ,
                           +
in a rush), they get it bÿ
                                                           '"You can''t
 deep a puddle is until you step into it."'                M00285.1 = ,
                                        ÿ
ÿ
                                                               '"Misery
mpany, but company does not reciprocate."'             ÿ
                 ÿ
r to retire too soon than too late."'                              M0028
                                                                   '"Aÿ
uld be greater than some of his paÿ
= ,                                                                    '
don''t say it, they can''t repeat it."'                                M
= ,  ÿ
hing is ever as simple as it seems."'
1.1 = ,
rything takes longerÿ
00292.1 = ,
"Left to themselves, all things go from bad to worse."'
00293.1 = ,                        ÿ
 '"Ifÿ
   M00293.2 = ,
   'procedure can go wrong, and circumvent these, ÿ
     M00293.3 = ,     ÿ
       'fifth way, unprepared for, will promptly develop."'
       M00294.1 = ,                                              ÿ
         '"Things get worse under pressÿ
           M00295.1 = ,
           '"Persons disagreeing with your facts are always emotional'
ÿ
               'and employ faulty reasoning."'
               M00296.1 = ,
               ÿ
                   M00297.1 = ,                                        ÿ
                     '"Progress is made on alternate Fridays."'
                     M00298.1 ÿ = ,
                       '"The first 90 percent of the task takes 90 perce
e'      ÿ
                         'time; the last 10 pÿç
r 90 percent."'                        M00299.1 = ,
                                     ÿ
y three."'                               M00300.1 = ,       ÿ
                                           '"Don''t look back, something
gaining on you."'                          M00301.1 = ÿ
                                             '"All things being equal, a
ngs are never equal."'                         M00302.1 = ,
                                               '"Even paranoids have enÿ
'                                                M00303.1 = ,
          ÿ
ers of time or place."'                            M00304.1 = ,
        ÿ
hose employees who have nÿ
                                                       'reached their le
ncompetence."'           ÿ
                                        ÿ
''t succeed, try something else."'                         M00306.1 = ,
                                          ÿ
ng, you''re going downhill."'                          ÿ
                                                               '"Never t
 what you wouldn''t do."'                                  ÿ
                                                                 '"Theÿ
of flak received on any subject is inversely'                      M0030
                                                                   'prop
al to the subject''s true value."'                                   M00
,    ÿ
ell''s Second Law:'                                                    M
= ,          ÿ
fference is the onlyÿ
0.1 = ,
tever hits the fan will not beÿ
311.1 = ,                          ÿ
"Never needlessly disturb a thing at rest."'
00312.1 = ,                                    +
 '"In Leningrad, freezing point is called melÿ
     M00313.1 = ,
     '"The easiest way to find something lost around the house'
     M00313.2 = ,                                             ÿ
          'is to buy a replacement."'                          ÿ
           M00314.1 = ,
           '"Bare feet magnetize sharp metal objects so they always'
 ÿ
               'point upward from the floor -- especially in the dark."'
               M00315.1 = ,
               '"Mÿ
             ÿ
                   'establish yourself as an expert."'
                   M00316.1 = ,    ÿ
                     '"It woÿ
                       M00317.1 = ,
                       '"Quit while you''re still beÿ
                         M00318.1 = ,      ÿ
                           '"The difference between genius and stupidity
 genius has lim'××,        'its."'                                   ÿ
                             M00319.1 = ,                 ÿ
                               '"It''s always easier to go downhill, but
w is from the top."'           M00320.1 = ,
      ÿ
"'                                 M00321.1 = ,
                                   '"Laziness is the mother of nine inve
ut of ten."'           ÿ
        ÿ
measure input."'                       M00323.1 = ,
                                       'ÿ
ts by means of'        ÿ
                                           'appropriate, additional assu
"'                                         M00324.1 = ,  ÿ
                                      ÿ
ant that we may always be'                     M00324.2 = ,
                                               'right, for Thou knowest
l never change our minds."'                      M003ÿ
                                                   '"Never be first to d
ng."'                                              M00326.1 = ,
           +
lems is solÿ
                                                         '"The only winn
e war of 1812 was Tchaikovsky."'                         M00328.1 = ,
   +
eÿ
                                                               '"Learn t
cere.  Even if you have to fake it."'        ÿ
                ÿ
 us outnumbered."'                                                 M0033
                                                              ÿ
er your enemies don''t want youÿ
= ,                                                                    '
e ambiguity never hurt anyone."'                                       M

''t permit yourself to get between a dog and a lamppost."'
4.1 = ,
 universe doesn'ÿ
00335.1 = ,
"Half of being smart is knowing what you''re dumb at."'
00336.1 = ,                      ÿ
   '"No man is an island so long as he is on at least one mailing list."
   M00337.1 = ,
   '"Cant produces countercant."'                 ÿ
     M00338ÿ
       '"If you see a man approaching you with the obvious intent'
       M00338.2 = ,                                                ÿ
         'of doing you gooÿ
           M00339.1 = ,
           '"When you are sure you''re right, you have a moral duty'
    ÿ
               'to impose your will upon anyone who disagrees with you."
               M00340.1 = ,
               '"If yÿ
                   M00341.1 = ,
                   '"Assumption is the mother of all foul-ups."'
                   M00342.1 = ,       ÿ
                       '"All general statements are false.  (think about
                       M00343.1 = ,
                       '"If it happens, it must be poss+
      ÿ
                             '"Them what gets--has."'
                             M00345.1 = ,
                     +
 to continue digginÿ
                                   '"If builders built buildings the way
mers wrote programs,'              M00346.2 = ,
         ÿ
g would destroy civilizati'××,         'on."'
                                       M00347.1 = ,
                          ÿ
 whisper it."'                             M00348.1 = ,
                                           '"A pat on the back is only a
hes from a kick in the pants."'            ÿ
                                               '"Never leave hold of wha
e got until you''ve got hold of '××,           'something else."'
                                               M00349.2 = , ÿ

                                                   M00350.1 = ,
                                                   '"A theory is better
ts explanationÿ
                                                       '"If you eat a li
the first thing in the morning, nothing'               M00351.2 = ,
              ÿ
 either of you the rest of the day."'                      M00352.1 = ,
                                                           '"Nobody noti
 things go right."'            ÿ
                                                               '"There i
ety in numbers, or in anything else."'                         M00354.1
                                                ÿ
 can go wrong, it will."'                                          M0035
                                                                   '"If
 can''t go wrong it will."'                                      ÿ
= ,                                                                    '
hy''s law can go wrong, it will."'                                     M
= ,                                                                    '
riÿ
7.2 = ,
worst possible sequence."'
8.1 = ,            +
"After things have ÿ
 'self."'
 M00359.1 = ,                          +
   '"An auditor enters the battlefieÿÿ
       M00359.2 = ,
       'and attacks the wounded."'
       M00360.1 = ,                                 ÿ
           '"Nothing is ever so bad that it can''t get worse."'
           M00361.1 = ,
           '"No matter what goes wrong, there is always somebody whÿ
 wo'××,        'uld."'
               M00362.1 = ,
               '"Those whom the gods would destroy, they first teach BAS
  ÿ
                   '"The hidden flaw never remains hidden."'
                   M00364.1 = ,
                 ÿ
                       M00364.2 = ,
                       '2. "Nothing is always"'
                       M00364.3 ÿ
                           '3. "Everything is sometimes"'
                           M00365.1 = ,
                           '"If you wait, it wiÿ
                               M00365.2 = ,
                               '....having done its damage.'
                               M00365.3 = ,                   ÿ
                                   'If it was bad, it''ll be back."'
                                   M00366.1 = ,
                                   '"Complex problems have simple, easy-
erstand wrong ÿ
                                       '"Opportunity always knocks at th
opportune moment."'                    M00368.1 = ,
            ÿ
hen you realize the'                       M00368.2 = ,
                                           'world''s composed of aluminu
nyl."'                     ÿ
                                               '"In order for something
e clean, something else must become'××,        ' dirty.'
                                          ÿ
                                                   '...But you ÿ
ing dirty without getting anything clean'××,         '."'
                                                     M003+
                                                       ÿ
ngÿ
                                                           '"The first p
look for anything is the last place'                       M00371.2 = ÿ
                   ÿ
 to find it."'                                                 M00372.1
                                                               '"You can
find ÿ
                                                                   '"If
't care where you are, you ain''t lost."'                          M0037
                    ÿ
mpossible for an optimist to be pleasantly surprised."'                M
= ,                                                                    '
s is when you can''t say ''let''s fÿ
6.1 = ,
hing your car to make it rain doesn''t work."'
7.1 = ,                                           ÿ
hen theÿ
00378.1 = ,
"The time it takes to rectify a situation is inversely'          ÿ
 M00378.2 = ,           ÿ
   'proportional to the time it took to do the damage."'
   M00379.1 = ,
ÿ
       M00379.2 = ,
       'A pessimist fears this is true."'
       M00380.1ÿ
           '"You can make it foolproof, but you can''t make it damnfoolp
           M00381.1 = ,
           '"It takes longer tÿ
               M00382.1 = ,
               '"It takes longer to lose ''x'' number of pounds than'
               M00382.2 = ,                  ÿ
            ÿ
                   M00383.1 = ,
                   '"The item you had your eye on the minuteÿ
                     M00383.2+
                       'wilÿ
                         M00384.1 = ,
                           '"If you change lines, the one you just left
tart'                        M00384.2 = ,     ÿ
                               'to move faster than the one you are now
                               M00385.1 = ,
        ÿ
e'                                 M00385.2 = ,
                                   'likelihood that you are standing in
g line."'              ÿ
ÿ
ick-check-out lane."'                  M00387.1 = ,
                                      ÿ
 will find a needÿ
                                           M00388.1 = ,
                                           '"If a sitÿ
 attention, it will'              ÿ
                                               'occur simultaneously wit
elling distraction."'                          M00389.1 = ,         ÿ
                                                 '"ÿ
titious."'                                         M00390.1 = ,
                                                   '"You simply MUST sto
 adÿ
                                                       '
ssa Timberman'                                         M00391.1 = ,
                  ÿ
earthÿ
                                                           'as receiving
e tax refund."'                  ÿ
                      ÿ
 inspire fresh thoughts is to seal the letter."'               M00393.1
                                                ÿ
e curse:'                              ÿ
                                                                   '"May
e in interesting times."'                                      ÿ
,                                                       ÿ
l is 90 per cent perspiration;'                                        M
= ,                                                                    '
ther half is mental."'
4.3 = ,                                                                ÿ
                   --Yogi Berra'
395.1 = ,    +
"THINK    Iÿ
 'e."'    ÿ
   M00396.1 = ,
   '1. "Never draw what yoÿ
     M00396.2 = ,          ÿ
       '2. "Never copy what you can trace."'
       M00396.3 = ,                      ÿ
         '3. "Never trace what you can cut oÿ
           M00397.1 = ,
           '"Distributed data processing is a scatter-brÿ
             M00398.1 = ,                                    ÿ
               '"When you don''t know what to do, walk fast and look wor
               M00399.1 = ,                                            ÿ
                 '"If you are the first to know about something bad, you
oing t'××,         'o be'
                   M00399.2 = ,
      ÿ
al dutie'××,   ÿ
                       M00400.1 = ,
                     ÿ
e times out'             M00400.ÿ
                           'of ten, the elevator car will be on a floor
u are not."'               M00401.1 ÿ
                             '"The tendency of smÿ
e,'                            M00401.2 = ,
                               'campfire, etc. to dÿ
varies'                          M00401.3 = ,                     ÿ
                                   'directly with that person''s sensiti
smoke."'                           M00402.1 = ,                   ÿ
                                     '"The distance to the gate is inver
porÿ
                                       'to the time available to catch y
hÿ
                    ÿ                      '"As soon as the stewardess s
e coffee, the airliner encoun'××,          'ters turbulence."'
                ÿ
                                     ÿç
ircraft causes turbulence."'                               M00405.1 = ,
                               +
l you stand by, your baggage ÿ
                                                                 M00406.
                                                                 '"When
ng overseas, the exchange rate improves'    ÿ
,                                                                    'ma
he day after one has purchased foreign currency."'                   M00
,                                                          ÿ
 kilometerÿ

1 = ,
 bigger they are, the hardeÿ
409.1 = ,
or every action, there is an equal and opposite criticism."'
410.1 = ,ÿ
 '"Authorization for a project will be granted only when none of'
 M00410.2 = ,
 'the authorizers can beÿ
     M00410.3 = ,
     'all of the authorizers can claim credit if it succeeds."'
     M00411.1 = ,                      ÿ
         '"If an idea can survive a bureacratic review and be'
         M00411.2 = ,
         'implemented, it wasn''t worth doing."'      ÿ
           M004ÿ
             '"The greater the cost of putting a plan into operation,'
             M00412.2 = ,                                            ÿ
               'the less chance ÿ
                 M00412.3 = ,
                 'if it subsequently becomes irrelevant."'
    ÿ
                     '"You can tune a piano, but you can''t tuna fish."'
                     M00414.1 = ,
                   ÿ
ho knows what'××,        ' is going on.'
                         M00414.2 = ,
                         'This perÿ son must be fired."'
   +
 ÿ
."'                            M00416.1 = ,      ÿç
                                             '"Some people manage by the
ven though they'              ÿ
                                               'don''t know who ÿ
 or even what book."'                            M00417.1 = ,
                                               ÿ
now you''re better than they are."'                M00418.1 = ,

ht, but you always know who''s in charge."'          M00419.1 = ÿ
                                                       '1. "Anyone can m
cision given eÿ
                                                         '2. "A good man
 ÿ
                             ÿ
ger can operate in perfect ignorance"'                       M00420.1 =
                  ÿ
tempts to impress employees with his knowledÿ
                                                                 'intric
ils has lost sight of his final objÿ
                                                           ÿ
save yourself a lot of needless worry if you'                        M00
,                                                   ÿ
urn your bridges until you come to them."'                             M
1 = ,
hierarchical system, the rate of pay varies inversely with'          ÿ
2.2 = ,
unpleasanÿ
423.1 = ,
he cliÿ
00424.1 = ,             ÿ
 '"A lack of planning on your part does not constitute an emergency o'××
 'n my part."'         ÿ
   M00425.1 = ,                        ÿ
     '"I know you believe you understand'
     M00425.2 = ,                       ÿ
       '   what you think I said,'                    ÿ
         M00425.3 = ,
         '      however, I am not sure you realize,'     +
           M00425.4 = ,                                ÿ
               '         that what I think you heard'              ÿ
                 M00425.5 = ,
                 '            is not what I meant."'
                   M00426.1 = ,
  ÿ
                     M00427.1 = ,
           ÿ
re and more'××,  ÿ
                         M00427.2 = ,
                         'reÿ
lity is achiev'××,         'ed' ÿ
                             M00427.3 = ,
                             'when you spend ÿ
 nothing you are d'××,         'oing."'        ÿ
                                 M00428.1 = ,
                                 '"Consultants are mystical peÿ
ompany for a number'               M00428.2 = ,               ÿ
                                     'and then give it back to them."'
                                     M00429.1 = ,

 are inversely proportional t'××,        'o'
                                         M00429.2 = ,
                ÿ
n a positionÿ
                                             '"Never make a decision you
 someone else to make."'         ÿ
                           ÿ
sions you could have made'                       M00431.2 = ,
                                                 'ÿ
a record of your bad ones."'              ÿ
                                                     '"For every vision,
s an equal and opposite revision."'                  M00433.1 = ,  ÿ
                                                       '"ÿ
at you have developed at great expense'                  M00433.2 = ,
                                                         'is the first p
 be ÿ
                                                             '"Time flie
n arrow.'                                                    M00434.2 =
                     +
 a bana+
     ÿ
 is four wolves and a lamb voting on what to have for lun'××,        'ch
                                      ÿ
= ,                 ÿ
e generally don''t make the same mistake twice;'
2 = ,                                                  ÿ
 make it three, four, or five timesÿ
437.1 = ,
 meeting is an event at which the minutes are kept and the hours '××,
are lost."'                                       ÿ
 M00438.1 = ,
 '"If you leave the room, you''re elected."'
 M00439.1ÿ
     '"The cream rises to the top.'
     M00439.2 = ,
     'So does the scum."' ÿ
ÿ
         '"You can never do just one thing."'
         M00441.1 = ,                      ÿ
           '"Thÿ
w'××,        'ant to do."'
             M00442.1 = ,                                   ÿ
               '"Any task wortÿ
                 M00443.1 = ,
                 '"The more complicated and grandiose the plan, the grea
e cha'××,          'nce of failure."'        ÿ
                     M00444.1 = ,
                     '"Simple jobs always get put off because there will
 to do th'××, ÿ
                         M00445.1 = ,
                         '"Hollow chocolate has no calories."'
                         M00446ÿ
                             '"A work project expands to fill the space
e."'                         M00447.1 = ,
                             '"No matter how larÿ
ects must ÿ
                                 M00447.2 = ,
                                 'same time, they will require th+
f the work space."'      +
                       ÿ
will be the one'                         M00448.2 = ,
                                         'missing from the tool chest."'
  ÿ
                                             '"Most projects require thr
."'                                          M00450.1 = ,
                   ÿ
tover bolts."'                                   M00451.1 = ,
                                                 '"The more carefully yo
 project, the more'                 ÿ
                                                     'confusion there is
mething goes wrong."'                                M00452.1 = ,
                                                     ÿ
sioÿ
                                                         '   "Measure wi
rometer,'                                                M00452.3 = , ÿ
                  ÿ
,'                                                           M00452.4 =
                                                             '   cut wit
."'    ÿ
                                                                 '"You c
x it if it ain''t broke."'                                       M00454.
                        ÿ
 of intelligent tinkering:'                                          M00
,                                                                    '
ll the parts."'                          ÿ
1 = ,
l you have is a hammer, everything looks like a nail."'
1 = ,                                                     ÿ
oftware suppliers are trying to make their software packages mor'××,

456.2 = ,
''user-friendÿ
 'e all'
 M00456.3 = ,
 'the old brÿ
     'ver."'
     M00456.4 = ,
     '       --Bill Gates'   +
         M00457.1 = ,        ÿ
             'Bradley''s Bromide: "If computers get too powerful, we can
             M00457.2 = ,
             'organize them into a committee..ÿ
                 M00458.1 = ,
                 '"The solution to a problem changes the problem."'
                 M00459.1 = ,                                  ÿ
                     '"Be yourself.  Who else is better qualified?"'
                     M00460.1 = ,
                     '"If you think nobody cares you''re alive, try miss
ÿ
                         M00460.2 = ,
                         '--Earl Wilson'
                 ÿ
                             '"Important letters which contain no errors
velop errors in t'××,        'he mail."'
                             M0046ÿ
                                 '"Office machines which function perfec
ng normal'                       M00462.2 = ,
                                 'business hours wiÿ
turn to the'                         M00462.3 = ,
                                     'office at night to use them for pe
usiness."'                           M00463.1 = ,                 ÿ
                                         '"Machines that have broken dow
ork perfectly when the repair'××,        'man arrives."'
                                         M00464.1 = ,
 ÿ
 stick when you lick them will'              M00464.2 = ,
                                             'stick to other things when
''t want them toÿ
                                                 '"Vital papers will dem
 their vitality by spontaneously movi'××,        'ng'
                               ÿ
                                                     'from where you lef
o where you can''t find them."'                      M00466.1 = ,
                                              ÿ
uit or was fired will be held responsible for'           M00466.2 = ,
                                                         'everything tha
rong -- until the next person quits or is fi'××,         'red+
                                                           ÿ
                                                                 '"If yo
o keys on the typewriter, the one you don''t want hit'××,        's the
                                                                 M00468.
            ÿ
 looks exactly the same as cold glass."'                             M00
,                                                                    '"W
do not knÿ
1 = ,
ork is essential. It allows you to blame someone else."'
1 = ,                   ÿ
cience is true. Don''t be misled by facts."'
472.1 = ,
he more popular something is, the more ÿ
 M00472.2 = ,
 'religious personnage will object to it."'
 M00473.1 = ,                                         ÿ
ÿ
     M00474.1 = ,
     '"The quality of correlation is inversely proportional to the deÿ
       'ity of coÿ
         M00475.1 = ,
         '"If reproducibility may be a problem, conduct the test only on
    ÿ
             '"If a straight line fit is required, obtain only two data
'            M00477.1 = ,
             '"Unleÿ
                 M00477.2 = ,
                 'agencies will reject the proposal."'
                 M00478.1 = ,     ÿ
                     '"An easily-understood, workable falsehood is more
                     M00478.2 = ,
                     'than a complete, incompreheÿ
     ÿ
                         '"Anyone who makes a significant contribution t
eld'                     M00479.2 = ,                           ÿ
                      ÿ
                             M00479.3 = ,
                             'becomes an obstruction to its progress --

                                   'proÿ
al contribution."'                   M00480.1 = ,
                                     '"The more the name of a product pr
the less it ÿ
                                         M00480.2 = ,
                                         'cheap stereo equipment often h
ord ''super'' in its name, ÿ
                                             M00480.3 = ,
                                             'equipment is usually named
consulting firm.)'                        ÿ
          ÿ
traight line."'                                  M00482.1 = ,
                                                 '"In anyÿ
ns, errors tend to occur atÿ
                                                     M00482.2 = ,
                                                     'to the end at whic
begin checking for errors."'                ÿ
                                                         '"Only errors e
                                                         M00484.1 = ,
       ÿ
is another man''s data."'                                    M00485.1 =
                                                             '"To err is
but to really foul thiÿ
                                                                 '"When
it into memory, remember where you put it."'                     M00487.
                                     ÿ
for an error coÿ
,                                                                    '"E
 lies; but it doesn''t matter, since nobody listens.ÿ
= ,                             ÿ
e who love sausage and respect the law should never'
2 = ,                                                              ÿ
h either one being made."'                       ÿ
490.1 = ,
o matter what they''re talking about, they''re talking about mone'××,
"'ÿ
 M00491.1 = ,
 '"In any dealings with a collective body of people, the'
 M00491.2 = ,    +
   +
   ÿ
         '"If you can keep your head when all about you are losing'
         M00492.2 = ,         ÿ
           'theirs, ÿ
             M00493.1 = ,
             '"Information deteriorates upwarÿ
               M00494.1 = ,          ÿ
                 '"When an exaggerated emphasis is placed upon delegatio
                 M00494.2 = ,                               ÿ
                   'responsibility, like sediment, sinÿ
                     M00495.1 = ,
                     '"When outrageous expenditures are divided finely e
 the public'           M00495.2 = ,                                    ÿ
                         'will not have enough stake in any one expendit
quelch it."'             M00496.1 = ,
          ÿ
''t'    ÿ
                             'possibly know where it''s going after that
                         ÿ
                         ÿ
pecial case."'                   M00498.1 = ,
                                 '"If evÿ
it."'                              M00499.ÿ
                                     '"Everything is contagious."'
                                     M00500.1 = ,      ÿ
                                       '"Nothing is ever doÿ
asons."'                                 M00501.1 = ,
                                         '"The secret of success is siÿ
 Once you can fake that,'                  M00501.2 = ,
                                             'you''ve got it made."'
                                             M00502.1 = ,
     ÿ
 town."'     ÿ
                                                 '"An expert is one who
re and more about leÿ
                              ÿ                      'until he knows abs
everything about nothing."'                          M00504.1 = ,
                                   +
k the one who predicts the job'  ÿ
= ,                                                                    '
e the longest and cost the most."'                                     M
= ,                                             ÿ
it sits on your desk for 15 minutes, you''ve just become the ex'××,
."'
6.1 = ,                                                        ÿ
nytÿ
."'
00507.1 = ,
 '"Never create a prÿ
   M00508.1 = ,
   '"Create problems for which only you have the answer."'
   M00509.1 =ÿ
       '"A conclusion is the place where you got tired of thinking."'
       M00510.1 = ,
       '"Hindsight is an exaÿ
           M00511.1 = ,
           '"History doesn''t repeat itself -- historians merely repeat
××,        'her."'                         ÿ
               M00512.1 = ,
               '"Fact is solidified opinion."'
               M00513.1 = ,                               ÿ
        ÿ
                   M00514.1 = ,
                   '"Truth is elastic."'
                     M005ÿ
                       '"When in doubt, predict that the trend will cont
                       M00516.1 = ,
        ÿ
                           M00517.1 = ,
                           '"Progress does not consist of replacing a th
t is'                  ÿ
                               'wrong with one that is right. It consist
lacing'                        M00517.3 = ,
                               'a theoÿ ry that is wrong with one that i
 subtly wrong."'                   M00518.1 = ,
                                   '"It is a simple task to make things
 but a complex'                    M00518.2 = ,      ÿç
                         +
                       ÿ
                                                     '"If you have aÿ
 task give it to a lazy man; he'                       M00519.2 = ,
                                        ÿ
y to do it."'                                            M00520.1 = ,
   ÿ
s a disadvantage equal to or'                            ÿ
                                                             'exceeding
tness of the idea.ÿ
                                                               '"Never a
te to malice that which is adequately explained by st'××,        'upidit
                                 ÿ
                                                                   '"New
 generate nÿ
,                                               ÿ
 tend to grow, and as they grow they encroach."'                       M
= ,                         ÿ
otal behavior of large systems cannot be predicted."'          ÿ
5.1 = ,
arge system, produced by expanding the dimensÿ
525.2 = ,
a smaller system, does not behave like the smaller system."'
00526.1 = ,                                                   ÿ
 'Second law of Frisbee:'
 M00526.2 = ,ÿ
   '"Never precede any manoeuvre by a comment more predictive than ''W'×

     M00527.1 = ,           ÿ
       '"The system itself does not do what it says it is doing."'
       M00528.1 ÿ
         '"A complex system that works is iÿ
           M00528.2 = ,
           'evolved from a simpleÿ
             M00529.1 = ,                                 ÿ
               '"A complex system designed from scratch never works and'
               M00529.2 = ,                       ÿ
                 'cannot be patched up to make it work. You have to star
                   M00529.3 = ,                                        ÿ
                     'over, beginning with a working simple system."'+
                       M00530.1 = ,                                ÿ
                         '1. "Everything is a system."'
      ÿ
                           '2. "Everything is part of a larger system."'
    ÿ
                     ÿ
 upward'                       M00530.4 = ,
                     ÿ
ems)."'                          M00ÿ
                                   '4. "All systems are infinitely compl
 illusion'                         M00ÿ
                                     '   of simplicÿ
ention on'                             M00530.7 = ,
                                       '   one or a fewÿ
                                         M00531.1 = ,             ÿ
                                           '"Complex systems tend to opp
r own proper function."'                   M00532.1 = ,
                                             '"If little else, the brain
dÿ
                                               '
  Tom Robÿ
                ÿ
er made a mistake and I''ll'                       M00533.2 = ,
                          ÿ
ever achieved much."'          ÿ
                                                       '"Small change ca
be found under seat cushions."'            ÿ
                                              ÿ
rth what you pay for it."'                                 M00536.1 = ,
                                                           'ÿ
, I always pick the one I never tried before."'              ÿ
                                                               '
           - Mae West'                                         M00537.1
                                                                 '"Credi
ave much better memories than debtors."'                           M0053
                                                                   '"Eve
mplains of hisÿ
,          +
es us relÿ
1 = ,                            +
who falls in love with himself ÿ
541.1 = ,               ÿ
"If at first you don''t succeed, you''re doing about average."'
00542.1 = ,                                     ÿ
 '"It is better to wear out than to rusÿ
   M00543.1 = ,
   '"Never call a man a fool; borrow from him."'                 ÿ
     M00544.1 = ,                                     ÿ
       '"Often, statistics are used as a drunken man uses a'
       M00544.2 = ,
  ÿ
           M00545.1 = ,
           '"The average woman would rather have beauty than brains'
           M00545.2ÿ
    ÿ
               M00546.1 = ,
               '"Beware of and escheÿ
                 M0ÿ
                   '"Everything needs a little oil now and then."'
                   M00548.1 = ,                      ÿ
                     '"If you are ÿ
                       M00548.2 = ,
                       'The converse is not true."'                   ÿ
                         M00549.1 = ,            ÿ
                           'Astrology law: "It''s always the wrong time
onth."'                    M00550.1 = ,
       ÿ
ndition'                       M00550.2 = ,
                               'doesn''t mean he knows what it is."'
                        ÿ

es in the waiting room,'           M00551.2 = ,
                                   'the lÿ
scheduled appoÿ
                                       '"Only adults have difficulty wit
proof bottles."'                       M00553.1 = ,       ÿ
                             +
pills left on the'         ÿ
                                             'last day of a prescription
                                               M00554.1 = ,
                                          ÿ
meals will be the least appetizing ones'××,        '."'
                                                   M00555.1 = ,
            ÿ
 who is great at getting out of trouble."'             M00556.1 = ,
                                                       '"It''s never too
 have a happy childhood."'   ÿ
                                                           '"Before orde
est, decide what you will do if it is 1) positi'××,        've,'
                                              ÿ
       ÿ
If both answers are the same, don''t do the test."'            M00558.1
                                                               ÿ
                      ÿ
                                                                   'Your
                                                                   M0055
ÿ
a minute'                                                              M
= ,                                                                    '
 your head'      ÿ
8.5 = ,
 brains are in it."'
8.6 = ,                           ÿ
        - Burma Shave'
00559.1 = ,
"The feasibility of an operation is not the best'  ÿ
 Mÿ
   'indication for its performance."'
   M00560.1 = ,                                                     ÿ
     '"A physiciaÿ
       'ty."'
       M00561.1 = ,
     ÿ
           M00561.2 = ,
           'stay on and that which won''t come off."'
           M00562.1 = ÿ
               '"Never decide to buy somethinÿ
."'              M00563.1 = ,
                 '"''C'' combines the fle+
e power'           M00563.2 = ,        ÿ
                       'of assembly language."'
                       M00564.1 = ,
                       '"An alcoholic is a person who drÿ
wn physician."'            M00565.1 = ,
                           '"Fools rush in -- and get the best seats."'
                           M00566.1 = ,
          ÿ
st from the aisle a'××,        'rrive last."'
                               M00567.1 = ,
          ÿ
rse by firing the coach'××,        '."'
                                   M00568.1 = ,
                           ÿ
                                       M00569.1 = ,
                                       '"To do is to be" - Nietzsche'
                                       M0056ÿ
                                           '"To be is to do" - Sartre'
                                           M00569.3 = ,
                                           '"Do be do be do" ÿ
                                               M00570.1 = ,
                                               '"What makes us so bitter
 people who outwit us is'                      M00570.2 = ,
     ÿ
leverer than we are."'                             M00571.1 = ,
                                                   '"It''s always easy t
th sides of an ÿ
                                                       'we are not parti
concerned about."'                                     M00572.1 = ,
                                ÿ
e who PRESS ENTER here."'                                  M00573.1 = ,
                                                           '"A mediocre
ill sink to the level of his or her opposition."'ÿÿ
                                                               '"Pound f
, the amoeba is the most vicious animal on earth."'            M00575.1
                                                               '"+
ery few personal problems that can''t be'                      ÿ
,                                                                    'so
a suitable application of high explosives."'                         M00
,    +
u''veÿ
7.1 = ,
matter how cynical you get, it''s impossible to keep up."'
8.1 = ,      ÿ
"The mountain gets steeper as you get closer."'
00579.1 = ,
"The mountain looks closer tÿ
   M00580.1 = ,
   '"All trails have more uphill sections than they have level or dow'××
   'nhill sections."'                      ÿ
       M00581.1 = ,
       '"All things being equal, you lose.'
       M00581.2 = ,                                       ÿ
           'All things being in your favor, you still lose."'
           M00582.1 = ,
           '"43 percent of all statistics are useless."'
          ÿ
               '"No matter where you go, there you are!"'
               M00584.1 = ,
        ÿ
                   M00585.1 = ,
                   '"If everything is coming your way, you''re in the wr
."'                M005ÿ
                       '"The only difference between the fool, and the c
who attacks'××,        ' a'
                       M00586.2 = ,   ÿ
                           'system is that the fool attacks unpredictabl
 a broader fro'××,         'nt."'
                           M00586.3 = ,              ÿ
                               '        - Tom Gilb'
                               M00587.1 = ,
                               '"When you''re not in a hurry, the trÿ
t will turn'   ÿ
                                   'green as soon as your vehicle comes
plete stop."'                      M00588.1 = ,
   +
rÿ
                                         'deserted road will meet at the
bridge."'                                M00589.1+
                ÿ
e is directly proportional'                    M00589.2 = ,
                                               'to the length of the pas
e."'                           ÿ
                                                   '"I don''t like to sp
ors, but what else can you do with them'××,        '?"'
                                              ÿ
   ÿ
nto a computer, nothing comes out but'                 M00591.2 = ,
                                                       'tomfoÿ
tomfoolery, having pÿ
                                                           'expensive ma
s somehow enobled, and no one dares to critici'××,         'ze it."'
                                     ÿ
                                                               '"A verba
ct isn''t worth the paper it''s written on."'                  M00593.1
           ÿ
ed arises, any tool or object closest to you becomes a '××,        'hamm
                                                                   M0059
                          ÿ
f auto repair:'                                                        M
= ,                                                                    '
er how minor the task, you will inevitablÿ
3 = ,   ÿ
red with grease and motor oil."'
5.1 = ,                                                 ÿ
hen necessary, metric andÿ
00596.1 = ,
Automotive engine repairing law:'                                      ÿ
 M00596.2 = ,                             ÿ
   '"If you drop something, it will never reach the ground."'
   M00597.1 = ,
   '"Iÿ
       M00598.1 = ,
       '"It the shoe fits, it''s ugly."'
       M00599.1 = ,  +
           '"Whoso ÿ
             M00599.2 = ,
             '        - Book of Proverbs'
             +
             ÿ
                   M00601.1 = ,
                   '"The label ''new'' and/or ''iÿ
t up."'              M00602.1 ÿ
                       '"The label ''all new,'' ''completely new'' or ''
ws'''                  M00602.2 = ,                             ÿ
                         'means the price went ÿ
                           M00603.1 = ,
                           '"If an item is advertised as ''under $50,''

                               M00604.1 = ,
                               '"ACF2 is a four letter word."'
              ÿ
 ÿ
uotation,'                         M00605.2 = ,
                             ÿ
                  ÿ
                                       '"A 60-day warranty guarantees th
roduct will'                           M0060ÿ
                                   ÿ
                                           M00607.1 = ,
                                           '"The ''consumerÿ
em will come out a week'                     M00607.ÿ
                                               'after you''ve made your
:'                                             M00607.3 = ,
                                                 ' '                 ÿ
                                                   M00607.4 = ,
                                                   '  1. The one you bou
 be ratedÿ
      ÿ
bought will be rated ''best buy"'                      M00608.1 = ,
                        ÿ
o complain, you''ll nevÿ
                                                           'If you do wr
''ll receive the merchandise before you+
                                     ÿ
eaches its destination."'                                        M00609.
                                                                 '"The m
rtant item in an order will no longer be available."ÿ
 M00610.1 = ,
 '"During the time an item is on back-order, it will be'
 M00610.2 = ,                                                      ÿ
     'available cheaper and quicker from many other sources."'
     M00611.1 = ,
     '"You are wise, witty and wonderful, but you spend too much of your
  ÿ
         'time reading silly messages."'
         M00612.1 = ,
         '"Securiÿ
             M00613.1 = ,
             '"Tell a man that there are 300 billion stars in the univer
             M00613.2 = ,       ÿ
                 'and he''ll believe you....  Tell him that a bench has
                 M00613.3 = ,
                 'paint upon it and he''ll haveÿ
                     M00614.1 = ,
                     '"Cleanliness is next to impossible."'
                     M00615.1 = ,                             ÿ
 ÿ
 function ade'××,        'quately."'
                         M00616.1 = ,
                  ÿ
 will use it."'              M00617.1 = ,
                             '"The simpler the instruction (e.g. ''press
, the'      ÿ
                                 'more difficult it will be to open the
"'                               M00618.1 = ,
                           ÿ
 an old book,'                       M00618.2 = ,
                                     'the most vital measurement will be
le."'                                M0061ÿ 9.1 = ,                  ÿ
                                         '"Once a dish is fouled up, any
ded to save it only makes it '××,        'worse."'
                                         M00620.1 = ,    ÿç
                  ÿ
mented on the item which took the'                       M00620.2 = ,
                                                         'least effort t
are.'                              +
                                 ÿ
                                                               M00620.4
       ÿ
                                                  ÿ
                                                                   ' If
 ''Duck a l''Orange'',ÿ
,                                                                  ÿ
ented on the baked potato."'                                           M
= ,                                  ÿ
ne ingredient you made a special trip to the store to get'
2 = ÿ
 be the one thing your guest is allergic to."'      ÿ
622.1 = ,
he more time and enerÿ
00622.2 = ,                                                        ÿ
 'the greater the chance you guests will spend the entire'
 M00622.3 = ,                         ÿ
   'meal discussing other meals they have had."'
  ÿ
     '"Souffles rise and cream whips only for the familÿ
       M00623.2 = ,
       'for guestÿ
         M00624.1 = ,
           '"The rotten egg will be the one you break into the cake batt
           M00625.1 = ,         ÿ
             '"Any cooking utensil placed in the dishwasher will be'
         ÿ
               'needed immediately thereafter fÿ
                 M00626.1 = ,
                 '"Any meaÿ
                   M00626.2 = ,                               ÿ
                     'be needed immediately thereafter for dry ingredien
                     M00627.1 = ,          ÿ
                       '"Time spent consuming a meal is in inverse propo
                         M00627.2 = ,
                           'to time spent preparing it."'     ÿ
                             M00628.1 = ,
                             '"I used to be indecisive; now I''m not sur
          ÿ

ut to thaw, you didn''t'××,        '."'
                         ÿ
                                     '"If you''re wondering if you left
ee pot pluggedÿ
                                       Mÿ
                                         '"If you''re wondering if you n
top and pick up'               ÿ
                                           'bread and eÿ
u do."'                                      M00632.1 = ,
                                             '"Iÿ
e enough money to take'                        M00632.2 = ,           ÿ
                                                 'the family out to eat
 you don''t."'                                   M00633.1 = ,    ÿ
                                                   '"The spot you are sc
on glÿ
                                                     M00634.1 = ,
  ÿ
reak down during theÿ
                                                         '"There is alwa
dirty laundry then ÿ
                                   ÿ
t isn''t laundry."'                                          M00637.1 =
                                    ÿ
t spill on a dirty floor."'                       ÿ
                                                                 '"An un
e toy is useful for breaking other toys."'           ÿ
                                                                 ÿ
 who chatters non-stop at home will adamantly refuse'                M00
,                                                                    'ÿ
 a word when requested to demonstrate for an audience."'               M
ÿ
, introverted child will choose a crowded public'
2 = ,  ÿ
 to loudly demo+
641.1 = ,    ÿ
"The probability of a cat ÿ
 M00641.2 = ,
 'nothing to do with the priÿ
   M00642.1 = ,                            +
     '"The probability that a household pÿ
       M00642.2 = ,                        ÿ
         'to go in or out is directly proportional to the number'
         M00642.3 = ,                                     ÿ
           'and importance of your dinner guests."'       ÿ
             M00643.1 = ,
             '"How long a minute is depends on which side of the bathroo
 yo'××,        'u''re on."'
                 M00644.1 = ,
                 '"The life expectancy of a house plant varies inversely
            ÿ
        ÿ
                     M00645.1 = ,
                     '"If theÿ
on together'××,        ÿ
                         M00646.1 = ,
                         '"Most people deserveÿ
                           M00647.1 = ÿ
                             '"Possessions increase to fill the space av
for their storage'××,        '."'                              ÿ
                               M00648.1 = ,          ÿ
                                 '"When you dial a wrong number, you nev
 busy signal."'                  M00649.1 = ,
ÿ
utside the'                          M00649.2 = ,
                                     '   door, fumbling for your keys."'
                 ÿ
   ÿ
hear the click'                          M00649.4 = ,
                                  ÿ
                  ÿ
                                             '"People to whom you are at
invariably think you'                        M00650ÿ
                                 +
                               ÿ
                                                   '"The one who snoreÿ
all asleep first."'                                  M00652.1 = ,
                                              ÿ
 a blind date because of how it sounds over'××,        ' the phone."'
       +
     ÿ
arriage is inversely proportional'                           M00653.2 =
                                                             'to the amo
t on the wedding."'   ÿ
                                                                 '"All p
ties are 50%. Either a thing will happen or it won''t.'          M00654.
                                       ÿ
cially trueÿ
,                                                                    'Li
s, however, are 90% against you."'                      ÿ
= ,                       ÿ
our wild oats on Saturday night - then on Sunday pray for cro'××,
ure."'
6.1 = ,                                  ÿ
he probability of meeting someone you know increases'
656.2 = ,
en you areÿ
 M00657.1 = ,
 '"If you help a friend in need, he is sure to remember'
 M00657.2 = ,              ÿ
     'you - the next time he''s in need."'
     M00658.1 = ,
     '"Virtue is its own punishment."'      ÿ
      ÿ
         '"If you do something right once, someone will ask you to do it
,        'n."'                                               ÿ
           M00660.1 =ÿ
             '"The one day you''d sell your soul for something, souls ar
."'          M00661.1 = ,
               '"The scratch on the ÿ
 most'××,        '."'
                 M00662.1 = ,
               ÿ
                     M00663.1 = ,                ÿ
                       '"Forgive and remember."'
                       M00664.1 = ÿ
                         '"COBOL is the next best thing to codinÿ
."'                        M00665.1 = ,
                           '"Anything good in life +
                             M00665.2 = ,        ÿ

                                 M00666.1 = ,
                                 '"To err is human -- to blame it ÿ
lse is even moÿ
                                     '"Whatever happens to you, it will
ly have'                             M00667.2 = ,
   ÿ
re so."'                                 M00668.1 = ,
                                         '"He who laughs last -- probabl
t get the joke."'   ÿ
                                             '"Don''t worry over what ot
le are thinking about'                       M00669.2 = ,
                                     ÿ
g over what you are'                             M00669.3 = ,
                                                 'thinking about them."'
                                                 M0067ÿ
                                                     '"There are some th
ch are impossible to know -'                         M00670.2 = ,
                                                     'but it is impossiÿ
know thesÿ
                                                         '"When we try t
ut anything by itself we find'                           M00671.2 = ,
        ÿ
ything else in the universe."'                               M00672.1 =
                                                             '"If one vi
problem closely enough heÿ
                                                                 'recogn
elf as part of the problem."'                                    M00673.
                                          ÿ
may be divided into as many parts as you please."'                   M00
,                                                                    '"T
s are universal: hydrogen and stupidity."'                 ÿ
1 = ,                                                              ÿ
several things that could have gone wrong have not gone wrong,'
5.2 = ,
 would have been ultimately beneficial for them to have gone wro'××,
."ÿ
00676.1 = ,
"The quickest w+
 ' shirt."'  ÿ
     M00677.1 = ,
     '"Absolutely nothing in the world is friendlier than a wet dog."'
     M00678.1 = ,             ÿ
         '"The severity of an itch is inversely proportional to the reac
         M00679.1 = ,
         '"The only game that can''t be fixed iÿ
             M00680.1 = ,
             '"Ignorance should be painful."'
             M00681.1 = ,                                     ÿ
                 '"Magellan was the first strait man."'
                 M00682.1 = ,
                 '"If you smile when everything goes wrong, you are eith
   ÿ
                     'a nitwit or a repairman."'
                     M00683.1 = ,
            ÿ
                         M00684.1 = ,
                         '"Laugh and the world laughs with you. Cry and
                         M0ÿ
                             'you have to blow your nose."'
                             M00685.1 = ,
                             '"A penny savÿ
                                 M00686.1 = ,
                                 '"He who marries for money...better be
his wife."'                      M00687.1 = ,            ÿ
                                     '"It''s always darkest before ...da
aving time."'                        M00688.1 = ,
                                     '"Double negatives are a no-no."'
        ÿ
                                         '"There is nothing more frighte
n ignorance in action."'                 M00690.1 = ,
       +
ou haÿ
                                               '"One place where you''re
 find the perfect driver is in the '××,   ÿ
                    ÿ
                                                   '"Nothing is indestru
with the possible exception'                       M00692.2+
                                   ÿ
itcakes."'                                               M00693.1 = ,
                                                         '"How do they k
wo snowflakes are alike?"'                        ÿ
                                                             '"How did t
ure hail before the golf ball was invented?"'                M00695.1 =
                                                             '"Neÿ
h an artist."ÿ
                                                                 '"You c
hieve the impossible unless you attempt the absurd."'            M00697.
ÿ
is trying to figure out how the family next door is doing'××,        ' i
                                                                     M00
,              ÿ
ure have to borrow a lot of money these days to be an average'××,
mer."'
1 = ,                         ÿ
e who dies with the most toys wins."'
700.1 = ,
f his IQ were any lower he''d be a plant."'  ÿ
0ÿ
 '"Everybody is ignorant, only on different subjects."'
 M00702.1 = ,                                               ÿ
   '"It is far betÿ
     M00702.2 = ,
     '                        Siezbo'
       M00703.1 = ,                ÿ
         '"The man who has no more problems is out of the game."'
         M00704.1 = ,
         'ÿ
             M00704.2 = ,
             'to the strong, but that''s the way to bet."'
             M00705.1 = ,+
                 '"A foÿ
                   M00706.1 = ,
                   '"All things come to he whose name is on a mailing li
      ÿ
                       '"After winning an argument with his wife,'
                       M00707.2 = ,
                       +
                       ÿ
                             '"If opportunity came disguised as temptati
knock would be en'××,        'ough."'                               ÿ
                               M00709.1 ÿ
                                 '"Easy doesn''t do it."'
                                 M00710.1 = ,
   ÿ
ptation but'                         M00710.2 = ,
                                     ' would like it to keep in touch."'
                  ÿ
                                         '"When a distinguished scientis
 something is possible,'                 M00711.2 = ,
                                 ÿ
e states thÿ
                                             'something is impossible, h
y probably wrong."'                          M00ÿ
                            ÿ
hing.'                                           M00712.2 = ,
                                                 'No one gets aÿ
hing."'                                      ÿ
                                                     '"Calm down .... It
 ones and zeros."'                                   M00714.1 = ,
                                                       '"Real ÿ
't write COBOL.'                                         M00714.2 = ,
                                                         'COBOL is for w
lications proÿ

y mind, it is backed up on tape somewhere."'                 M00716.1 =
                            ÿ
s do not documenÿ
                                                                 'Docume
is for simps who can''t read listings or'  +
                                 ÿ
ode."'                                                                 M
= ,                                                                    '
ogrammers don''t write specs -- users should'     ÿ     ÿ
7.2 = ,
ider themselves lucky to get any programs at all and'
7.3 = ,                                                            ÿç

           M00718.1 = ,
           '"Real programmers don''t comment their code. If it is hard'
    ÿ
               'to write, it should be hard to understand."'
               M00719.1 = ,
               '"Realÿ
                   M00719.2 = ,
                   'program right down on the bare metal.  Application'
                   M00719.3 = ,     ÿ
                       'programming is for feebs who can''t do systems p
ng."'                  M00720.1 = ,
                       '"Real programmers don''t eaÿ
'                          M00720.2 = ,
                           'programmers don''t know how to spell quiche.
t'                         M00720.3 = ,                           ÿ
                               'Twinkies and Szechwan food."'
                               M00721.1 = ,
                               '"Real programmer''s programs never work
tÿ
                                   'if you throw them on the machine, th
e patched into'                    M00721.3 = ,
                ÿ
ing sessions."'                        M00722.1 = ,
                                       '"Real programmers don''t write i
N. FORTRAN is for'             ÿ
                                           'pipe stress freaks and cryst
hy weenies."'                              M00723.1 = ,
                                           '"Rÿ eal programmerÿ
o 5. If any real'                              M00723.2 = ,
                                               'programmers are around a
, it''s because they'                          M00723.3 = ,  ÿç
           ÿ
t."'                                                           M00724.1
                                                               '"Real pr
ers don''t write in BASIC. Aÿ
                                                                   'prog
write in BASIC after age 12."'                                     M0072
           ÿ
ogrammers don''t write in PL/1. PL/1 is forÿ
2 = ,
mmers who can''t decide whÿ
5.3 = ,                                                     ÿ
BOL or FORTRAN."'
726.1 = ,                                ÿ
"Real programmers don''t play tennis or any other sport'
 M00726.2 = ,
 'that requires you to change clothes. Mountain climbingÿ
   M00726.3 = ,
   'OK, and reÿ
     M00726.4 = ,                                                      ÿ
       'in case a mountain should suddenly spring up in the middle'
       M00726.5 = ,            ÿ
         'of the machine room."'
      ÿ
           '"Real programmers don''t write in PAÿ
             M00727.2 = ,
             'any of ÿ
               M00727.3 = ,                                      ÿ
                 'typing is for people with weak memories."'
                 M00728.1 = ,       ÿ
                   '"On a clear disk, you can seek forever."'
  ÿ
                     '"When things are going well, ÿ
                       M00729.2 = ,
                   ÿ
                         M00729.3 = ,                             ÿ
                           'When things appear to be going better you ha
ooked someth'××,           'ing."'  ÿ
                             M00730.1 = ,
 +

                                   'change will exceed the rate of progr
                                   M00731.1 = ,
              ÿ
attempts to debug'                     M00731.2 = ,
                                       'a system will inevitably introdu
ugs that are even'           ÿ
         +
       ÿ
                                            ÿ
ll take three times'                           M00732.2 = ,
                        ÿ
lly planned project will'                        M00732.3 =ÿ
                                                   'take only twice as l
                                         ÿ
                                                     '"After all is said
one, a hell of a lot more is said than done'××,        '."'
                                                       M00ÿ
                                                         '"If it''s not
omputer, ÿ
                                                           '"Never wrest
h a pig, you both get dirty, and the pig enjoys i'××,        't!"'
                        ÿ
                                                               '"Don''t
th a bear inÿ
                                       ÿ
oesn''t know any more than you do. He or she is'                   M0073
                             ÿ
ter organized and uses slides."'                      ÿ
= ,                                                                    '
 lead a horse to water, but if you can get himÿ
2 = ,                                                                ÿ
t on his back, you''ve really got something."'
9.1 = ,                                                        ÿ
eople are promoted not by what they can do, but what people'××,
hinkÿ
00740.1 = ,
ÿ
 'anges."'         +
   M00741.1 = ,  ÿ
     '"Matter can bÿ
       'ost."'
       M00742.1 = ,             ÿ
         '"There are two classes of ÿ
           M00742.2 = ,
           'steerage with free drinks.  You payÿ
             M00742.3 = ,                            +
               'the free drinks, of course."'      ÿ
                 M00743.1 = ,                                 ÿ
                   '"Experience is the worst teacher'
                   M00743.2 = ,                                     ÿ
                     ' - it gives you the test before you''ve had a chan
study."'               M00744.1 = ,
                       '"If you can''t beat your computer at chess, try
ng."'ÿ
            ÿ
 jet engines."'            M00746.1 = ,
                      ÿ
.0"'                       ÿ
                               'The Law of Airplanes: "You will always g
.."'                           M00748.1ÿ
                                 '"Man wilÿ
h, but most of the time'           M00748.2 = ,
                                   'he will pick himselfÿ
                                     M00749.1 = ,        ÿ
                                       '"2 rules to success in life. 1.
ell people everything you k'××,        'now."'
                                         M00750.1 = ,
                                           '"A penny for your thoughts;
ct them out."'                             M00751.1 = ,
          ÿ
ps awouÿ
                                               '"An effective way to dea
redators is to taste terribÿ
                      ÿ
any two."'                                         M00754.1 = ,
                                            ÿ
citly declared INTEGER."'            +
                                   ÿ
olicy, but insanity is a better defense."'               M00756ÿ
                                                           '"If you can'
placed, you can''t be promoted."'                 ÿ
                                                             '"If ignora
ÿ
                                                               '"ÿ
s simple as possible, but not simpler." --Einstein'              M00759.
                 +
is like an Old ÿ
ÿ
= ,                                                                    '
each entitled to our own opinionÿ
2 = ,          ÿ
 no one is entitled to his own facts."'
1.1 = ,                                          ÿ
eware of people who know the aÿ
question."'
00762.1 = ,                                                       ÿ
 '"When things just can''t get any worse, theÿ
   M00763.1 = ,
   '"When things appear to be going better you have overlooked'
   ÿ
       'something."'
       M00764.1 = ,
       '"I owe, I owÿ
           M00764.2 = ,
           'so it''s off to work I go."'
           M00765.1 = ,              ÿ
          ÿ
               M00766.1 = ,
               '"Don''t try to teach a pig to sing.   ÿ
                 M00766.2ÿ
                   'It won''t work, and it annoys the pig."'
                   M00767.1 = ,                                        ÿ
                     '"Only four things ÿ
                       M00767.2 = ,
                       '    1.  Death
        ÿ
                           '    2.  Taxes            ÿ
     '                       M00767.4 = ,
                           ÿ
       '                       M00767.5 = ,                         ÿ
                                 '    4.  IBM will once again jack up so
rices    '                       M00768.1 = ÿ
                                   '"All the world loves a lover - excep
whoÿ
                                     'waiting to use the phon+
                                       M00769.1 = ,        ÿ
                  ÿ
awyer."'                                   M00770.1 = ,
                                           '"In spite of the cost of liv
t''s still popular."'            ÿ
                                               'In the approval cycle fo
icle:                 '                        M00771.2 = ,
             ÿ
ment will add a fact,      '                       M00771.3 = ,
                                                   '  the second level o
ment will edit that fact,  '  ÿ
                                                       '  the third  lev
nagement will remove that fact."'                      M00772.1 = ,
                                               ÿ
down to a hot cup of coffee, your   '                      M00772.2 = ,
                                                           'boss will as
 do something that will last       '                       M0077ÿ
             ÿ
 is cold."'                                                    M00773.1
                                                               'Murphy''
oÿ
                                                                   ' "An
f ''I don''t'' is worth                      '                     M0077
                  ÿ
ons of ''I wish I didn''t''."'                                         M
= ,                                                                    '
're not the lead dog the scenery neÿ
5.1 = ,
ord to the wise is often enough to start an argument."'
6.1 = ,                                             ÿ
"A bird in the hand is bad table manners."'                            ÿ
 M00777.1 = ,
 '"Those who can, do. Those who can''t, write the instructions."'      ÿ
   M00778.1 = ,
   '"Nÿ
     M00779.1 = ,
     '"Tÿ
       M00779.2 = ,  ÿ
         'proportional to its importance."'
         M00780.1 = ,    +
           '"No major pÿ
               M00780.2 = ,
               'or with the same staff that started it."'
               M00781.1 = ,             ÿ
                   ' "A door is what a dog is perpetually      '
                   M00781.2 = ,
                   '  on the wrong side of."             ÿ
                       M00781.3 = ,
                       '                                           '
                       M00781.4 = ,
 ÿ
                           M00781.5 = ,
                           '              Ogden Nash                   '
           ÿ
                               ' "Women are like elephants to me.
                               M00782.2 = ,
                            ÿ
                                   M00782.3 = ,
                                   '  wouldn''t want to own one."
                                   M00782.4 =ÿÿ
                                       '
   '                                   M00782.5 = ,
                                       '              W.C. Fiÿ
       '                                   M00783.1 = ,
                                           ' "The only grounds for divor
       '                                   M00783.2 = ,
 ÿ
          '                                    M00783.3 = ,
                                               '
           +
         ÿ
                 '                                   M00783.5 = ,
                                   ÿ
                   '    ÿ
                                                         ' "Education is
d by which one       '                              ÿ
                                       ÿ
r grade of              '                                    M00784.3 =
                                                             '  preju+
                          '                           ÿ
                                                                   '
                               '                                   M0078
                                                                   ' ÿ
    Laÿ
= ,                                                                    '
y is a set of lies                 '                                   M
= , ÿ
reed upon."                           '
5.3 = ,
                   ÿ
00785.4 = ,
                                           '
00785.5 = ,                       ÿ
   '              Napoleon Bonaparte           '
   M00786.1 = ,
   ' "The best audience is one that is         ' ÿ
       M00786.2 = ,
       '  intelligent, well-educated              '
       M00786.3 = ,                                             ÿ
         ' ÿ
           M00786.4 = ,
           '                                           '

               '              Alben W. Barkley             '
               M00787.1 = ,
              ÿ
                   M00787.2 = ,
                   '  parties not to drink but to listen."    '
                   M00787.3 =+
                       '   ÿ
                         M00787.4 = ,
                         '                                           '

                             '              Pierre Daninos
                             M00788.1 = ,
                ÿ
                                 M00788.2 = ,
                                 '  They don''t talk about other people.
                                 +
                                 ÿ
   '                                   M00788.4 = ,
                                       '
   '   ÿ
                                           '              Lucille S. Har
       '                                   M00789.1 = ,
                      ÿ
once a     '                                   M00789.2 = ,
                                               '  year; a real genius ha
iginal    '                          ÿ
    ÿ
              '                                    M00789.4 = ,
                                                   'ÿ
                 '   ÿ
                                                       '              G.
enberg             '                                   M00790.1 = ,ÿ
                                      ÿ
ote the Gettysburg     '                                   M00790.2 = ,
                                                           '  address wh
elÿ
                                                               '  Washin
Gettysburg on the back    '                                    M00790.4
                 ÿ
lope." (Sic)                  '                                    M0079
                                                                   '
  Louis Untermeyer             'ÿ
,        ÿ
fference between a politician and  '                                   M
= ,                                            +
atesman is: A politician tÿ
791.3 = ,
of the next election and a statesman    '
791.4 = ,                                  ÿ
 '  thinks of the next generation."         '
 M00791.5 = ,
 '              James Freeman Clarke         '              ÿ
     M00792.1 = ,
     ' "Sanity is madness put to good use."      '
     M00792.2 = ,

                     M00792.3 = ,
                     '                                           '
              ÿ
                         '                                           '
                         M00792.5 = ,
                         '     ÿ
                             M00793.1 = ,
                             ' "The end move in politics is always
                             M00793.2 = ,       ÿ
                                 '  to pick up the gun."
                                 M00793.3 = ,
                                 '                               ÿ
 '                                   M00793.4 = ,
                                     '
 '                                   M00793.5 = ,
  ÿ
     '                                   M00794.1 = ,
                                         ' "To many people dramatic crit
st   '             ÿÿ
                                             '  be like trying to tattoo
bbles." '                                    M00794.3 = ,
                                   ÿ
             '                                   M00794.4 = ,
                                                 '
             '                                   Mÿ 007ÿ
                                                     '              John
rown             '                                   M00795.1 = ,
                                                     ' "A fool anÿç
 hisÿ
,                                                                    '
    James Howell                 '                                   M00
ÿ
ow only two tunes: One of them is    '
2 = ,
nkee Doodle'', ÿ
796.3 = ,
isn''t."                                '
796.4 = ,                     ÿ
 '                                           '       ÿ
   M00796.5 = ,
   '              Ulysses S. Grant           ÿ
     M00797.1 = ,                                                     ÿ
       'Umbrella law:                             '
       M00797.2 = ,                                         ÿ
         '  "You will need three umbrellas:          '
       ÿ
           '   One to leave at the office, one to     '
             M00797.4 = ,
             '   leave aÿ
               M00797.5 = ,
          ÿ
                 M00798.1 = ,            ÿ
                   'Bell''s rule. "The average time between   '
                   M00798ÿ
                     '   throwing something away and neediÿ
                       M00798.3 = ,
                       '   badly is two ÿ
                         M00798.4 = ,
                           '   reduced to one week by retaining the    '
                           M00798.5 = ,                ÿ
                             '   thing for a long time first."
            ÿ
                               'Ogden''s law:                         ÿ
                                 M00799.2 = ,
                             ÿ
                                   M00799.3 = ,
     +
   ÿ
                                         '
     '                                   M00799.5 = ,
                  ÿ
         '                                   M00800.1 = ,
                                             'Berra''s law:
        '                        ÿ
  ÿ
by watching."'                                   M00800.3 = ,
                                                ÿ
               '   +
                 ÿ
imes worse than    '                                   M00801.2ÿ
                                                         '  ordinary ign
                     '            ÿ
                                                           '
nett Cerf                '                                   M00802.1 =
                                                   ÿ
ngland                     '                                   M00802.2
             ÿ
il''s there."               '                                    M00ÿ
                                                                   '
                            ÿ
,                                                                    '
     ÿ
= ,                                        ÿ
         Robert Browning             '
1 = ,                 ÿ
 a playwright is funny, the English    '                  ÿ
803.2 = ,
look for a serious message, and if he''ÿ
00803.3 = ,
 '  serious, they look for the joke."       '
 M00803.4 = ,                                           ÿ
   '                                           '
   M0080ÿ
     '               Sacha Guitry                '
       M00804.1 = ,
       ' "At no time is+
         M00804.2 = ,ÿ
           'ÿ
             M00804.3 = ,
             '  thumb with a hammer.ÿ
               M00804.4 = ,  ÿ
                 '                                           '
                 M00804.5 = ,                      ÿ
                   '               Marshall Luÿ
                     M00805.1 = ,
                     ' "I''m a great believer in luck,           'ÿ
                       M00805.2 = ,                            +
                         '  and I find the harder I work the ÿ
                           M00805.3 = ,
 ÿ
                             M00805.4 = ,
                               '
                ÿ
                                 '               Thomas Jefferson
               ÿ
                               ÿ
 '                                   M00806.2 = ,
                                ÿ
. '                                    M00807.ÿ
                                         ' "Is there such a thing as sho
     '                                   M00807.2ÿ
                                           '  anonymous?"    ÿ
        '                                    M00807.3 = ,
                                             '                    ÿ
           '                                   M00807.4 = ,
                                                 '   John F. Kennedy, on
ng a $40,000 '                                   M00807.5 = ,
   ÿ
fe''s clothÿ
                                                     ' "Most people like
rk.              '  ÿ
                          ÿ
ey are              '                                    M00808.3 = ,
                                     ÿ
                      '                  +
                                       ÿ
                           '                            ÿ
                                                                 '
 Franklin P. Jones           '                        ÿ
                                                                   ' "Co
s can figure out all kinds of    '                                   M00
,                                                                    ÿ
ms, except the things that        '                                    M
= ,       ÿ
 don''t add up."                    '
4 = ÿ
                           +
809.5 = ,                ÿ
               Jameÿ
 M00810.1 = ,
 ' "If all men knew what each said of the ÿ
   M00810.2 = ,                   ÿ
     '  other, there would not be four friends  '
     M00810.3 = ,                                          ÿ
       '  in the world."                         ÿ
         M00810.4 = ,
         '                                           '
           M00810.5 = ,                                         ÿ
             '               Blaise Pascal               '
             M00811.1 = ,
             ÿ

                 '  the two parties are really one party    '
                 M00811.3 = , ÿ
              ÿ
                     M00811.4 = ,
                     '                         ÿ
                       M00811ÿ
                         '               Gore Vidal                  '
                         M00812.1 = ,                           ÿ
                           '"Manufacturers rÿ
you   '                      M00812.2 = ,
                             'know you''ve been overcharged."'
 ÿ
                                 '"Trust everybody but cuÿ
                                   M00814.1 = ,
                    ÿ
                                     M00814.2 = ,
                                       'was at the end of my own arm."'
                                     ÿ
                                         '"Never put off until tomorrow
 can doÿ
                                           'day after.ÿ
                                             M00816.1 = ,
                      ÿ
 said in the first place."'                    M00817.1 = ,            +
                                                 '"If you can''t be kÿ
ease be vague."'                     ÿ
                                                     '"All progress is b
n a universal innate desire on'                      M00818.2 = ,
      ÿ
nism to live beyond its income."'                        M00819.1 = ,
                                                         '"One good reas
omputers can do more woÿ
                                                             'people is
y never have to stop and answer      '                       M00819.3 =
                                        ÿ
  ÿ
                                                                 '"VSAM
r letter word."'                                         ÿ
                 ÿ
ihood of someone doing 50 mph in the fast     '                      M00
,                                                                    'la
directly proportional to how latÿ
3 = ,
rk."'
1 = ,      ÿ
he changes of someone making a right turn from the    '
822.2 = ,
ft-turn lane are a constant ÿ
 M00823.1 = ,
 '"The chances of the individual making this turn while  '
 M00823.2 = ,                                ÿ
     'flashing his left turn signal are a constant one in six."'
       M00824.1 = ,
       '"If there is any possibility of installing a part       ÿ
         M00824.2 = ,
         'ÿ
           M00825.1 = ,
 ÿ
             M00825.2 = ,ÿ
               'work, the rest willing to let them."'
               M00ÿ
                 '"My father taught me tÿ
                   M00826.2 = ,
                   'love it."'     +
                     M00827.1 = ,ÿ
                         '"Work is the greatest thing in the world, so w
  '                      M00827.2 = ,
                         'always save some of it fÿ
                             M00828.1 = ,
                             '"If your project doesn''t work, look for t
you   '                      M00828.2 = ,                          ÿ
     ÿ
                                 M00829.1 = ,
                                 '"If you''re early, it will be cancelle
u''rÿ
                                     'time it will be over."'
                                     M00830.1 = ,
                     ÿ
e efficiency is   '                      M00830.2 = ,
                                         'immediately indistinguishable
 predecessor."'                       ÿ
                                             '"Any order that can be mis
od has been           '                      M00831.2 = ,
                                             'misundersÿ
                                                 M00832.1 = ,
                                                 '"There is always room
op - after an investigation."'                   M00833.1 = ,
ÿ
ople :                        '                      M00833.2 = ,
                                                     '    Those who divi
e into twÿ
             ÿ
n''t."'                                                    M00834.1 = ,
                            ÿ
mplimented on the dish that ÿ
                                                               'least ef
prepare."'                                   ÿ
                                           ÿ
with the least expertise has the most opinions."'                  M0083
                                                              ÿ
''ve mailed your last Christmas card, you     '           ÿ
= ,                                                                    '
eive one from someone you''ve overlooked."'                            M


837.2 = ,
er get done."'
838.1 = ÿ
 '"Unbreakable toys aren''t."'
 M00839.1 = ,
 '"Nothing is as inevitÿ
     M00839.2 = ,
     'has come."'
     M00840.1 = ,                     ÿ
         '"The most expensive component is the one that breaks."'
         M00841.1 = ,
         '"It requires less energy to take an object ÿ
             M00841.2 = ,
             'proper place than to put it back."'
             M00842.1 = ,                                           ÿ
    ÿ
                 M00843.1 = ,
                 '"Government corruption will be reported in the past te
   ÿ
                     '"Nobody notices the big errors."'
                     M00845.1 = ,
                  ÿ
  '                      M00845.2 = ,
                         'into your office."'
                         M00846.1+
                             '"ÿ
hid     '                      M00846.2 = ,
                               'from a friend."'
                                 M00847.1 = , ÿ
                                   '"No matter how often a lie is proven
alse, there '                      M00847.2 = ,
         ÿ
."'                                    M00848.1 = ,
                                       '"Only God can make a random sele
                          ÿ
                                           '"Everything put together fal
 sooner or later."'                        M00850.1 = ,
                                           +
y please, tÿ
                                                 'usually imitate each o
                                                 M00851.1 = ,
                          ÿ
                             '                       M00851.2 = ,
                                                     ' "Them that has, g
                                         ÿ
                                                         '"When parking,
allow someone in front of you,    '                      M00852.2 = ,
                                                        ÿ
e the last avaÿ
                                                             '"Of two po
vents, only the undesired one will occur."'                  M00854.1 =ÿ
                               ÿ
ing so small that it can''t be blown      '                      M00854.
                                                                 'out of
ion."'ÿ
,                                                                    '"A
s you''re doing what you wanted to be doing,  '                      M00
,                    ÿ
nt to be doing something else."'
1 = ,
ing can happen, if it''s not coveredÿ
6.ÿ
surance."'
857.1 = ,                                          +
"The shopping cart ÿ
   M00857.2 = ,
   'you chose."'
   M00858.1 = ,                     ÿ
       '"Doing it the hard way is always easier."'
       M00859.1 = ,
       '"Wisdom consists of knowing when to avoid perÿ

           '"The driver behind you always wants to go faster        '
           M00860.2 = ,                                               ÿ
             'ÿ
               M00861.1 = ,
               '"If it looks easy, it''s tough, if it looks tough,
       ÿç
                               'it''s impossible."'
                               M00862.1 = ,
                        ÿ
            '                      M00862.2 = ,
                                   ' darkest-colored stain."'
                                   M00863ÿ
                                       '"If you understand it, it''s obs
                                       M00864.1 = ,
                                       '"Every solution brÿ
"'                                         M00865.1 = ,
                                           '"When you try to prove to so
at a machine        '                      M00865.2 = ,
         ÿ
                                               M00866.1 = ,
                                               '"Whenever you set out to
thing, sometÿ
                                                   'must be done first."
                                                   M00867.1 = ,
                             ÿ
be made insoluble if enough     '                      M00867.2 = ,
                                                       'meetings are hel
cuss it."'                                    ÿ
                                                           '"Anything th
e changed will be changed until     '                      M00868.2 = ,
                                                           'theÿ

9.1 = ,
post office ever loses your junk mail."'
0.1 ÿ
"No matter how well you perform your job, a superior    '
00870.2 = ,
will seek to modifyÿ
   M00871.1 = ,
   '"If something is confidential it will be left           '
   M00871.2 = ,                   ÿ
       'in the copier."'
       M00872.1 = ,
       '"Tall people have higher standards."'    ÿ
           M00873.1 = ,                                        ÿ
             '"What can you expect of a day that begins with getting  '
             M00873.2 = ,                                       ÿ
               'up in the morning."'
ÿ
                 '"Age is a state of mind.

                 ÿ
                     M00875.1 = ,
              ÿ
'                      M00875.2 = ÿ
                         'l''m ignoring you."'
                         M008ÿ
                           '"I refuse to have a batÿ
     '                       M00876.2 = ,
                             'unarmed personÿ
                               M00877.1 = ,                         ÿ
                                 '"Age is not important unless you''re a
of wine."'                       M00878.1 = ,              ÿ
                                   '"Life is too short to drink cheap wi
     ÿ
                                     '"Neurotics build castles in the sk
                                       M00879.2 = ,
                      ÿ
                 '                       M00879.3 = ,
         +
       ÿ
                                               '"Lindberg was the first
ly the Atlantic alone   '                      M00880.2 = ,
                      ÿ
ame time as his luggage."'                         M00881.1 = ,
                                                   '"Lightning is said t
strike twice in the same place'      ÿ
                                                       'unless, of cours
et your insurance lapse."'                             M00882.1 = ,
                                                    ÿ
we pass thisÿ
                                                           'your spouse
ng the road map."'                                         M00883.1ÿ
                             +
nder the same conditions wiÿ
                                                                 'estima
erÿ
                                            ÿ
estimator at ten different times."'                                  M00
,                ÿ
t valuable and least used word in a project   '              ÿ
2 = ,
r''s vocabulary is ''no''."'    ÿ
5.1 = ,
ou can con a sucker into committing to an unreasonable'
885.2 = ,                                      ÿ
deadline, but you can''t bully him into meeting it."'
00886.1 = ,    ÿ
 '"The more ridiculous the deadline, the more it costs to '   ÿ
   M00886.2 = ,
   'try to meet it."'           ÿ
     M00887.1 = ,
       '"You can freeze the user''s specs but he won''t         '
       M00887.2 = ,                              ÿ
         'stop expecting."'
         M00ÿ
           '"Frozen specs and the abominable snowman are alike:   ÿ
             M00888.2 = ,
             'They are both+
               M00888.3 =ÿ
     ÿ
                   M00889.1 = ,
                   '"The conditions attaÿ
                     Mÿ
                       'and the promise is remembered."'
                       M00890.1 = ,                    ÿ
                         '"A user will ÿ
thing '                    M00890.2 = ,
                           'more."'                                   ÿ
                             M00891.1 = ,               ÿ
                               '"Of several possible interpretations of
ication '                      M00891.2 = ,
     ÿ
 one."'                            M00892.1 = ,                        ÿ
                                     '"What is not on paper has not been
                    ÿ
                                       '"Those who flee temptation gener
ve a    ÿ
                                   ÿ
                                           M00894.1 = ,
                         ÿ
g mysteriously       '                       M0089ÿ
                                               'resumes working."'
                                          ÿ
                                                 '"One thing thatÿ
t procrastination is that   '                      M00895.2 = ,
                                                   'you alwÿ
planned for tomorrow."'                              M00896.1 = ,
ÿ
and look through the Forbes    '                       M00896.2 = ,
                                                         'list of the ri
ople in Americaÿ
                                                           'there, I go
"'           ÿ
                              ÿ
ve late for the theater never have     '                       M00897.2
                              ÿ
                                             +
                                           ÿ
thing about buying beer is that no one ever   '  ÿ
= ,                                                                    '
t year you want."'                                        ÿ
1 = ,                                                             ÿ
's the kind of friend you can depend on - always    '
9.2 = ,
ound when he needs you."'
900ÿ
"Anyone who says he can see through women is missing a lot."'
00901.1 ÿ
 '"My program   - a ÿ
   M00901.2 = ,
   'the most sublime baÿ
     M00901.3 = ,                    +
       'coding on the one hand, andÿ
         M00901.4 = ,                 ÿ
           'for posterity on the other.                          '
           M00901.5 = ,                             ÿ
             'Your program - a maze of non sequiturs ÿ
               M00901.6 = ,
               'clever-clever tricks and irrelevant comments."'      ÿ
                 M00902.1 = ,                                       ÿ
                   ' "Start every day off with a smile and     '
                   M00902.2 = ,
      ÿ
   ÿ
                       '                                           '
                       ÿ
                  ÿ
                           M00903.1 = ,
                           '"Truth emergÿ
onfusion."'                  M009ÿ
                               '"People will generally accept facts as t
y if    '                      M00904.2 = ,              ÿ
                                 'the facts agreÿ
ve."'                              M00905.1 = ,
                                   '"Getting up early in the morning is
 way to gain  '                      M00905.2 = ,              +
                                       'respect without ever ÿ
o do anything."'                         M00906.1 = ,
             ÿ
carry or how good   '                      M00906.2 = ,
                                             'your raincoat is, if it ra
get wet."'                    ÿ
                                               '"If dogs could talk, it
ke a lot ofÿ
                                               ÿ
                                                   M00908.1 = ,
                          ÿ
ting little mistakes. It gives'                      M00908.2 = ÿ
                                                       'us the feeling w
 make any big ones."'                    ÿ
                                                         '"People who ar
s+

any times in your life when your body   '                      M00910.2
                                                               'has abso
othing wrong witÿ
                                                                   '"Vac
ren''t necessarily better than other times, '                      M0091
                                 ÿ
ust diÿ
= ,                                                                    '
g - a device for losing all your keys at once."'  ÿ
1 = ,                ÿ
onsultant is someone who borrows your watch, then   '
3.2 = ,                                                            ÿ
ves you the time."'                 ÿ
00914.1 = ,
"People who write subsystems usually use four letter words."'
0091ÿ
   '"Hypocrisy is the homage that vice pays to virtue."'
   M00916.1 = ,
   '"He who laughs laÿ
       M00917.1 = ,
       '"The worst way to make an argument is by reason and     '
       M00917.2 = ,                   ÿ
 +

             'emotions and to their fears of being made tÿ
               M00917.4 = ,
              ÿ
                 M00918.1 = ,
                   '"Few things are more satisfying than seeing your
                   M00918.2 =ÿ
                     'children have teenagers of their own."'
           ÿ
                       '"The optimist is theÿ
  '                      M00919.2 = ,
                         'hoÿ
                           M00920.1 = ,                    ÿ
                             '"With proper sleep, diet and care, a healt
      '                      M00920.2 = ,    +
                               'will last aÿ
                                   M00921.1 = ,
                                   '"If you wait for a repairman, you''l
ll day.     '                      M00921.2 = ,             ÿ
         ÿ
rrive and     '                        M00921.3 = ,
                                       'leave while you''re gone."'
                        ÿ
                                           '"People who have the most bi
live the longest."'                        M00923.1 = ,
              ÿ
tself, no solution is   '                      M00923.2 = ,
                                               'acceptable unless it is
, expensive and       '        ÿ
                                                   'time consuming."'
                                                   M00924.1 = ,
                                                ÿ
 than it takes."'                                      M00925.1 = ,
                                                       '"Nothing is impo
or the person who doesn''t      '                      M00925.2 =ÿ
    ÿ
                                                           M00926.1 = ,
                                                           '"In God we t
l ÿ
                 ÿ
k of the draw:                            '                      M00927.
                     ÿ
 you get the elevator           ÿ
,                                                                    '
es you get the shaft."'               ÿ
= ,                                            ÿ
u don''t find me here look there.'
2 = ,                                                  ÿ
''m not there then try somewhere else.'                       ÿ
928.3 = ,
 you still can''t find me then I don''t want to be found."'
00929.1 = ,
 '"Management is where programmers go when'
 M00929.2 = ,
 'they ha+
   M009ÿ
       '"Programmers are the workers.'
       M00930.2 = ,
       'Management is whÿ
           M00931.1 = ,
           '"The day your ship comes in'
           M00931.2 = ,                  ÿÿ
               'you will probably be at the airport."'
               M00932.1 = ,
               '"Never argue with an idiot: People watchiÿ
                   M00932.2 = ,
                   'able to tell the difference."'
                   M00933.1 = ,
                       '"The six steps of program management are:
'                      M00933.2 = ,
                       '     1. Wild enthusiasm
       ÿ
                           '     2. Disenchantment
   '                       M00933.4 = ,
                      ÿ
       '                       M00933.5 = ,
                               '     4. Search for the guilty
       '                       M00933+
                                   ÿ
             '                       M00933.7 = ,
                                     '     6. Promotion of the noÿ
s"'                                    M00934.1 = ÿ
                                         '"The only thing we learn from
is that we learn  '                      M00934.2 = ,
  ÿ
                                             M00935.1 = ,
                                             '"Humpty Dumpty was pushed.
                   ÿ
ÿ
nius,                    '                       M00936.2 = ,
                                    ÿ
               ÿ
                                                     '"The great debugge
......                       '                       +
                              ÿ
stent ''detective'' searching out    '                     M00937.3 = ,
                                                           '   the guilt
rators of programming crimes."'              ÿ
                                                               '"The gre
ger is..........                       '                       M00938.2
                                                            ÿ
 the prÿ
                                                                   '   a
only a few bits out of 100 million zeroes  '                       M0093
,                       ÿ
nes."'                                                                 M
= ,                                                                    '
ion of an ÿ
0.1 = ,
''t anthropomorphize machines. They hate that."'
1.1 = ,                  ÿ
"The nice thing about standards is that there are so many to"'
00941.2 = ,
"choose from."'                         ÿ
   M00942.1 = ,
   '"Nobody is so busy as the one who has nothing to do."'
   M00943.1 = ,                                        +
     '"A leiÿ
         M00944.1 = ,
         ' "Opportunity is missed by most people because'
         M00944.2 = ,        ÿ
             '  it is dressed in overalls and looks like work."'
             M00944.3 = ,
             '                                ÿ
   ÿ
                 '              Thomas Edison                '
                 M00945.1 = ,                                  ÿ
                  ÿ
                     M00946.1 = ,
                     '"You cannot solve a problem with the tools that cr
ÿ ."'                  M00946.2 =ÿ
                         '              Albert Einstein              '
                         M00947.1 = ,
                 ÿç
 confidence in experimental'             M00947.2 = ,
                                         'results until they have been c
 by theory."'                     ÿ
                                             '"It is not possible to awa
one who is pretending to be asleep."'        M00948.2 = ,
                                             '  (Naÿ
                                                 M00949.1 = ,
                                                 '"The customer has a ch
s long as he chooses." -- Henry Ford'            M00950.1 = ,       ÿ
             ÿ
ore eloquence than speech."'                         M00950.2 = ,
                                                     '   Martin Fraquhar
     ÿ
                                                         '"If you don''t
o laugh at trouble, you won''t'                          M00951.2 = ,
                      ÿ
laugh at when you''re old."'                                 M00951.3 =
                                                             '   Ed Howe
                                       ÿ
                                                                 '   "Oh
!" said the Borg.  "We have assimilated Pooh...."'               M00952.
                                                        ÿ          '   U
Ñ

 return
¦
---------- *                  * Name:      xmitippd
           *                  *
           *          ÿÿ
               *                  *
               *                  * Syntax:    %xmitippd In input-dsn ,
               *                  *   ÿ
                   *                  *                      Paper lette
a4/nnxnn ,         *                  *                      Orient Port
pe ,               *                  *              ÿ
,                      *                  *                      LPI lin
ch ,                   *                  *                      LM  lef
 (in inches) ,         *                  *                      RM ÿ
argin (in inches) ,        *                  *                      TM
gin (in inches) ,          *                  *                      BM
margin (in inches) ,       *                  *                      CC
cc ÿ
                               *                  * Notes:
                               *                  *    1. The input-dsn
-exist            ÿ
l be allocated if it doesn't exist *                  *
                                   *                  * Author:    Lelan
                                 ÿ
 Dyck                                  *                  *            K
rmanente Information Technology        *                  *            W
eek, CA 94598                          *        ÿ
 926-5332                                  *                  *
net: lionel.b.dyck@kp.org                  *                  *
                                           *                  *ÿ
ÿ
7/13/00 - corrections                          *                  *
7/12/00 - update by Leland to Machine CC       *                  *
 07/12/00 - conveÿ
   06/18/00 - converted for XMITIP usage           *                  *
                                                   *                  *
-------------+
           ÿ
ptions
 value options with "IN" infile . 1 ,              +
                      . "Oÿ
                          . "PAPER" paper . 1 ,
                          . "ORIENT" orient . 1 ,
                          . "FONT" font .ÿ
                              . "LPI" lpi . 1 ,
                              . "LM" lm . 1 ,
                              . "RM" rm . 1,            ÿ
     ÿ
                                  . "BM" bm . 1,
                                  . "CC" cc .                          ÿ
                      ÿ
             parse value "" with null

      ÿ
                  * Set paper size width and height
                 Select
                   whÿ
                         parse value paper with pw "X" ph
                         pdf.numPageWidth    = pw
                         pdf.numPageÿ
                             end
                           when Left(paper,3) = "LET" then do
                             pdf.numPageWidth    = ÿ
          ÿ
                                 end
                               when Left(paper,3) = "LEG" then do ÿ
                           ÿ
                                     pdf.numPageHeight   = 14
                                     end
 ÿ
                                         pdf.numPageWidth    = 8.27
                                         pdf.numPageHeight   = 11.7
                ÿ
                                           otherwise do
                                             pdf.numPageWidth    = 8.5
                               +
                             ÿ
                                                 end

               +
 *             ÿ
   *                                                  * ----------------
-- */                                                if lefÿ
hen                             ÿ
 = 1                                                     else
                                                             pdf.boolLan
   = 0                                           ÿ
                                                             if font <>
n                                                               pdf.numP
font     ÿ
                                                                    pdf.
s    = 10
                        ÿ
---ÿ
ins                *                                                  *
------------------ */                  ÿ
null then           ÿ
.numLeftMargin   = lm
                                                      ÿ
df.numLeftMargin   = .8              ÿ
tm <> null then
pdf.numTopMargin    = tm                                             ÿ
lse                                                   ÿ
    pdf.numTopMargin    = 1
 if rm <> null then
    ÿ
     else
        pdf.numRightMargin  = .8
     if bm <> null ÿ
        ÿ
         else
            pdf.numBottomMargin = ÿ
                         ÿ
             /* -------------------------- *
              * Set LPI                    *     +
                * ------------------------ÿ
                   if lpi <> null then
                      pdf.numLPI          = lpi
                   else                                    +
                          pdf.numLPI          = 6          ÿ

                         /* -------------------------- *
                            * Set Carriage Control       *
                              * -------------------------- */
                             if cc <> null then
            ÿ
             ÿ
                                    pdf.boolCC          = 0
                           ÿ
                              ÿ
t records       */                   stmOut.             = ""
ut records      */                        ÿ
                                       "Alloc fÿ
                                         call listdsi infile
                                         if left(sysrecfmÿ
= 4                                                             ÿ
l = 0                                        lrecl = lrecl + (syslrecl*2
                                             if left(sysunits,2) = "BL"
                                                  alloc_u = null
 ÿ
                                                 if "OK" <> sysdsn(outfi
       ÿ
                  ÿ
ile") new reuse",                                          "space("sysal
salloc") recfm(V B)", ÿ
size(0)" alloc_u                   ÿ
                                                            "Alloc f(ofi
outfile") shr reuse"                 ÿ
                                                    ÿ
LE (STEM stmIn. FINIS"
                                                    ÿ
                                                                     ÿ
                                                                 "EXECIO
 OFILE (STEM stmOut. FINIS"                                        +
                                                                 ÿ
ILE OFILÿ
                                                                     EXI

ÿ
                       ÿ
====================================================================
Routine:       ÿ
× Arguments:     (none)      : none requÿ
 ×× Return:        (none)      : none required
 ×× Exposed vars:  pdf.       ÿ
   ××                stmIn.      : Input records         ÿ
     ××                stmOut.     : Output records
     ×× =====================================ÿ
       */
         PDFConvert:
         PROCEDURE EXPOSE pdf. stmIn. stmOut.               ÿ

           ÿ
====           ×× Define ECBDIC to ASCII translation table and ECBDIC ch
r set            */
                 strE2A =  'ÿ
                             '101112131A0A081A18191A1A1C1D1E1F'x ×× ,
          ÿ
                               '1A1A161A1A1E1ÿ
                                 '20A6E180EB909FE2AB8B9B2E3C282B7C'x ××
                         ÿ
                                   '2D2FDFDC9ADDDE989DACBA2C25ÿ
                                     'D78894B0B1B2FCD6FB603A2340273D22'x
                                     'F8ÿ
                                       '8C6A6B6C6D6E6F7071729787CE93F1FE

,                                        'B5B6FDB7B8B9Eÿ
× ,                                        '7B414243444546474849CBCABEE8
× ,             ÿ
 ×× ,                                        '5CE7535455565758595AA085ÿ
'x ×× ,                                        '30313233343536373839B3F7
'x                               ÿ

     +
===ÿ
                                             ××
                                             ×× (Integers aren't require
ecise), but fasterÿ
                                                 numPageWidth    = ÿ
numPageWidth * 72 )                                numPageHeight   = Tru
numPageHeight * 72 )             ÿ
O                                                      numSwap = numPage
    ÿ
Width                                           ÿ
p                                                        END
                     ÿ
.numPoints                                                 numLÿ
runc( 72 / pdf.numLPI )                                      numLeftMarg
runc( pdf.numLeftMargin * 72 )        ÿ
 numPageHeight - Trunc( pdf.numTopMargin * 72 )                numRightM
 = numPageWidth - Trunc( pdf.numRightMargin * 72 )               numBott
 = Trunc( pdf.numBottomMargin * 72 )                   ÿ
                                                                   /* ==
=============ÿ
ze misc variables                                                    */
                                                                       b
       = 1                  ÿ
         = '0D25'x
Count    ÿ
fset       = 0                             ÿ
Offsets.     = ""
Objs         = 0          ÿ
trContentObjs  = ""                                       ÿ
 numContentObjs  = 0
 numOut          = 0                       ÿ
   boolInPage      = 0

     /* ====================================================ÿ
       ×× Calculate the number of lines per page
       *ÿ
         numLPP = ( numTopMargin - ,
                      numBottomMargin ) / numLeading
                       +
             /* =====ÿ
====           ×ÿ
                 */
                 CALL PDFQueue "%PDFÿ
                                 +
                     /* =======ÿ
============           ×× Does the file contain ASAÿ
                         */
                         IF pdf.boolCC THEN DO  ÿ
                                                                  ÿ
                               /* ======================================
==================             ×× Send the file while processing ÿ
ters.                            */
 ÿ

  ÿ
================ÿ
                                         */
                   ÿ
                               ÿ
mIn.numI, 2) ) ×× ")'"
                                    ÿ
                                              ÿ
==================================                 ×× Form feed
                                                   */ÿ
                                                     WHEN strÿ
                                                            strCCC = '89
                                                            strCCC = 'ÿ
N DO                                                       CALL PDFNewPa
                                                           END

       ÿ
===========ÿ
                                                               */
                        ÿ
-"   ×,                   ÿ
 '19'x ×,
 '1B'x THEN DO                           ÿ
ine "( )'"                               +
FLine "( )'"                           ÿ
                                                            ÿ

======================================================ÿ
Double space
/
 WHEN strCCC = "0"   ×,                                              ÿ
        strCCC = '11'x ×,
        strCCC = '13'x THEN DO
     CALL PDÿ
    ÿ

       /* ===================ÿ
         ×× Supressÿ
           ×× since this line doesn't add to the line count.
           */                                 ÿ
             WHEN strCCC = "+"   ×ÿ
                    strCCC = '01'x ×,
                    strCCC = '03'x THEN DO                     ÿ
                   strLin = "0 " ×× numLeading ××ÿ
                   END

ÿ
======                 ×× Just ignore it.
                       */
                 ÿ

                           END
                         END      ÿ
              ÿ
                             /* ========================================
==============               ×× Queue the line, strÿ
 character                   ÿ
                                 CALL PDFLine strLin
                               END                                  ÿ
                                            ÿ
                                 END
                                 ELSE DO
     ÿ
                                       /* ===============ÿ
============================             ×× Send each line of the file A
                        ÿ
                                           DO numI = 1 TO stmIn.0
                                               CALL PDFLine "(" ×× PDFXl
In.numI ) ×× ")'"                        +
                                       ÿ
       ÿ

                                                 /* ====ÿ
======================ÿ
                                                     */
                                                     CALL PDFEndPage
                                     ÿ
                                                         /* ============
==============================================           ×× Generate a f
ect, save ÿ
                                                             numFontObj
Obj()                                                        CALL PDFQue
                           ÿ
/Type /Font"                                                     CALL PD
/Subtype /Type1"                                                 CALL PD
/Name /F1"                                  ÿ
 "ÿ
ue ">>"                                                              CAL
Obj                                                          ÿ
                 ÿ
==============================================================
rate a resource object and save ID
                                ÿ
ResourceObj = PDFNewObj()
L PDFQueue "<<"
L PDFQueue "/Foÿ
 CALL PDFQueue "/ProcSet [/PDF /Text]"
 CALL PDFQueue ">>"
 CALL PDFEndObj                 ÿ

     /* ================================================================
     ×× Generate a pages object and save ID.     ÿ
§
                     ×× Note:  This will generate the kids array based o
sumption             ×× that the "page" objects will immediately follow
ages" objectÿ
                         numPagesObj = PDFNewObj()
                         CALL PDFQueue "<<"
               ÿç
                                         CALL PDFQueue "/MediaBox [ 0 0
PageWidth numPageHeight ×× " ]"          CALL PDFQueue "/Resources " ××
rceObj ×× " 0 R"                ÿ
ntObjs                                       CALL PDFQueue "/Kids ["
                                             DO numI = 1 TO numContentOb
                                               CAÿ
umI ×× " 0 R"                                    END
                                                 CALL PDFQueue "]"
                                                 CALL PDFQueue ">>ÿ
                                                     CALL PDFEndObj

                                                     /* ================
===ÿ
ct for each content object.                              */
                                                         DO numI = 1 to
ntObjs              ÿ
                                                               CALL PDFQ
"                                                              CALL PDFQ
ype /Page"                           ÿ
 "/Parent " ×× numPagesObj ×× " 0 R"                               CALL
 "/Contents " ×× Word( strContentObjs, numI ) ×× " 0 R"            CALL
 ">>"                                               ÿ
ndObj                                                                END

                                                                   ÿ
==============================================================
rate the catalog object and save ID

loÿ
L PDFQueue "<<"
L PDFQueue "/Type /Catalog"
L PDFQueue "/Page+
 CALL PDFQueue ÿ
   CALL PDFEndObj
                                            ÿ
     /* ======================ÿ
       ×× Generate the XREF table
       */                                                    +
         numIrefOff = numOffset              ÿ
             CALL PDFQueue "xref"
             CALL PDFQueue "0 " ×× numObjs + 1
             CALL PDFQueue "0000000000 65535 f "            ÿ
                 DO numI = 1 to numObjs
                   CALL PDFQueue Right( stmOffsets.numI, 10, "0" ) ×× "
                 END
               ÿ
                     /* ================================================
==========           ×× Generate trailer
          ÿ
                         CALL PDFQueue "trailer"
                         CALL PDFQueue "<<"
                         ÿ
                             CALL PDFQueue "/Root " ×× numCatalogObj ××
                             CALL PDFQueue ">>"
                             CALL PDFQueÿ
                                 CALL PDFQueue numIrefOff
                                 CALL PDFQueue "%%EOF"
                                                       ÿ
   ÿ
==========================           ×× Set number of records in output
                                     */                               ÿ
                    ÿ

                                       RETURN
     ÿ
                                           /*
                                           ×× ==========================
====================ÿ
ueues a record and tracks file offset          ×× Arguments:     strRec
ecord to queue                                 ×× Return:        (none)
one required                       +
 : all                           ÿ
============================================         */
                                                     PDFQueue:
        ÿ

                                                           /* ==========
=========================+
 line queued             ÿ
                                                                 numOut
 + 1
                                          ÿ
==========================================================           ××
 ASCII or EBCDIC?                                                    */
             ÿ
Ascii THEN DO
t.numOut = Translate( strRec ×× strCrlf, strE2A, strCSet )
                            ÿ
E DO
tmOut.numOut = strRec ×× strCrlf
                                           ÿ
             ÿ
 /* ==================================================================
 ×× Calculate new file offset                             ÿ
   */                         ÿ
     numOffset = numOffset + Length( strRec ) + Length( strCrlf )

     RETURN                                    ÿ

       /*
       ×ÿ
==         ×× Routine:       PDFLine     : Queues a line while tracking
t          ×× Arguments:     (none)      : none required
           ×× Return:  ÿ
 ÿ
               ×× ======================================================
======         */                     ÿ
                 Pÿ
                   PARSE ARG strLine
                                                     +
                       /* =========ÿ
================           ×× Bump line count and end the page on overfl
                           */
                           numLineCount = numLineCouÿ
                               IF numLineCount > numLPP THEN DO
                                 CALL PDFEndPage
                               END                                   +
 ÿ
                                     /* ================================
==========================           ×× Start a page if needed
                ÿ
      ÿ
                                           CALL PDFNewPage
                               ÿ
                       ÿ
                                             /* ========================
==================================           ×ÿ
                                        ÿ
                                                 CALL PDFQueue strLine
                                                             ÿ
                                                 RETURN  ÿ

                                                   /*
                                                     ×× ================
==============================================         ×× Routine:
bj   : Starts a new object and tracks offsets          ×× Arguments:
     : noneÿ
t id   : IDÿ
l)       : All                                             ×× ==========
==========================ÿ
                            ÿ

                                         ÿ
=============================================ÿ
t number of objects and store its' offset                            */
                                                        ÿ
 numObjs + 1                                                  ÿ
ets.numObjs = numOffset
                                                                       +
================================================================     ÿ
Qÿ
/
ALL PDFQueue numObjs ×× " 0 obj"
    ÿ
 RETURN numObjs

 /*                ÿ
     ×× =========================ÿ
       ×× Routine:       PDFEndObj   : Completes an object (rather simpl
       ×× Arguments:     (none)   ÿ
         ×× Return:        (none)      : none requÿ
           ×× Exposed vars:  (all)       : All
           ×× ===================================ÿ
====         */                                                    ÿ
               PDFEndObj:
                                                                ÿ
                   /* ==================================================
====ÿ
                     */

                     ÿ
                       RETURN
              ÿ
                         /*           ÿ
                           ×× ==========================================
==================         ××ÿ
ontent object)               ×× Arguments:     (none)  ÿ
                               ×× Return:        (none)      : none requ
                               ×× Exposed vaÿ
                                 ×× ====================================
==========================         */
                                   PDFNewPage:             ÿ

         ÿ
==============================           ×× End last page if needed
                                           */
                          ÿ
                                               CALL PDFEndPage
         +
       ÿ
                                                   /* ==================
========================================           ×× Create a new objec
                      ÿ
                                                       numPageObj = PDFN

                                     ÿ

er and number of tracked                                     */
                                                    ÿ
strContentObjs numPageObj                                      numConten
numContentObjsÿ
                                                                 /*ÿ
========================================================           ×× Qu
am dictionary ( forward point tÿ
                                                                     CAL
ueÿ
ueue "/Length " ×× numPageObj + 1 ×× " 0 R"     ÿ
FQueue ">>"
FQueue "stream"  ÿ
                                                                 ÿ
==================================================================
Save file offset to beginning ofÿ
/
umÿ
                                               ÿ
   /* ==================================================================
   ×× Start the texÿ
     */                                                       ÿ
       CALL PDFQueue "BT"
       CALL PDFQueue "/F1 " ×× numPoÿ

           /* ==========================================================
           ×× Queue the text matrix:                 ÿ
             ××
            ÿ
               ×× 0 = x-axis skew (slant)    × Rotation               ÿ
                 ×× 0 = y-axis skew (slant)    ×
                 ×× 1 = y-a+
                   ×× 0 =ÿ
         ÿ
                       */
                       CALL PDFQueue "1 ÿ
                          ÿ
                                         numTopMargin ,
                                         "Tm"          ÿ
                                           +
                               /* =======ÿ
======================           ×× Specify the leading units         ÿ
                                   */
                                   CALL PDFQueue numLeadinÿ

     ÿ
============================           ×× Reset line count
                                         */
                    ÿ

            ÿ
================================== ÿ
                                               */
                             ÿ
                                                  ÿ
                                                 RETURN
                                              ÿ
                                                   /*            ÿ
                                                     ×× ================
============================================         ×× Routineÿ
age  : End a page (content object)                     ×× Arguments:
ÿ
)      : none required                                   ×× Exposed vars
ÿ
===============ÿ
                                                             PDFEndPage:
                 ÿ
                              ÿ
========================================================           ×× By
not needed                        ÿ
                                             +
nPage THEN DO                              ÿ
N                                                    ÿ

                                                          ÿ
==================================================================    ÿ
× End the text object
/
 CALL PDFQueue "ET"
       +
   /*ÿ
     ×× ÿ
       */
       numStreamEnd = ÿ
                       ÿ
           /* ==========================================================
           ×× Terminiate the stream andÿ
             */                       ÿ
               CALL PDFQueue "endstream"
               CALL PDFEndObj                           ÿ
                                                     ÿ
                   /* ==================================================
========           ×× Queue the length of the previous content object
                     */                                             ÿ
                       CALL PDFNewObj
                       CALL PDFQueue numStreamEnd - numStreamStart
          ÿ
   ÿ
                           /* ==========================================
================           ÿ
                  ÿ
                               boolInPage = 0
                                            ÿ
                               REÿ

                                 /*                          ÿ
                                   ×× ==========ÿ
============================         ×× Routine:       PDFXlate    : Esc
racters within text                  ×× Arguments:     strData     : Dat
can                                    ×× Return:        strDat+
 data                                    ×× Exposed vars:  (aÿ
                                           ×× ==========================
=================ÿ
                                             PDFXlate:
                                               PARSE ARG strData
                                  ÿ
                                                   /* ==================
===========ÿ
o escape                                           +
                                                 ÿ
                          ÿ
                                                           /* ==========
================================================           ×× Loopÿ
all above characters with a backslash (\)ÿ
                                                               strOut =
                                                               DO UNTIL
 0 ÿ
erify( strData, strFrom, "Match" )                                   IF
= 0 THEN DO                                                            s
 Substr( strData, nuÿ
 VAR strData strLeft (strChar) strData
t = strOut ×× strLeft ×× "\" ×× strChar
                                     ÿ
      ÿ
t = strOut ×× strData
                                                      ÿ
=====================ÿ
× Return escaped data
/                                                                      &
ETURN strOut                        ÿ
Ô
---------- *                  * Name:      XMITIPZP
           *                  *                    ÿ
             *          ÿ
ity for the    *                  *            input file before e-maili
               *                  *                               ÿ
                 *                  * Synÿ
                   *                  *                       zip_type z
,                  *                  *                       z_type zip
sÿç
thod unit debug                    *                  *
                                   *                  *            where
                ÿ
nput fiÿ
 output zip file                       *                  *            z
 zip package (e.g. PKZIP or ISPÿ
d  load library and progÿ
     e.g. sys1.zip.load(zip)               *                  *
e    ZIP for text                          *  ÿ
       ZIPBIN for binary                 ÿ
ip_nia   is the file name of the input file    *                  *
         as record in the ZIP file             *             ÿ
           (PKZIP NIA - name in archive)         *        ÿ
             * if not used                         *                  *
   password  optional encryption password          *                  *
               * if not used                         *
       method    optional compression format           *
                 * if not used                         *
       unitÿ
            ÿ
           debug     optional - display all messages       *
                          ÿ
* Author:    Lionel B. Dyck  ÿ
  *            Kaiser Permanente Information Technology        *
  *            Walnut Creek, CA 94598    ÿ
    *            (925) 926-5332               ÿ
      *            Internet: lionel.b.dyck@kp.org                  *
      *                                                 ÿ
        * History:                                             +
          *            06/08/00 - delete zipdsn (output) if zÿ
            *            05/23/00 - change test for rc after zip for 0<ÿ
              *            05/19/00 - add warning if rc=4 but continue
              *            05/18/00 - add rc to zip error message
                *            04/17/00 - add method
      ÿ
                  *            04/07/00 - created
               ÿ
 *                  *+
-- */              ÿ
                        parse arg ÿ
                                    zip_nia password method unit debug
                                  ÿ
                            if zip_type = "" then rÿ

                              indsn    = translatÿ
                                zipdsn   = translate(zipdsn)        ÿ
                                  zip_type = translate(zip_type)
                                                                ÿ
                                   /* ----------------------------------
-----ÿ
              *                       * --------------------------------

                      ÿ
                                          if zip_load <> "*" then
              ÿ
do                                     ÿ
rted in this environment"                           say "       load lib
p_load                       ÿ
n(zip_load)                                           exÿ
                                                        end
                                            ÿ
                                                   /* ------------------
----------------------------- *                       * Test input datas
                              *                       * ---ÿ
------------------------------- */                      if sysdsn(indsn)
 then do  ÿ
ut DSN was not found."                                       say "
: " indsn                                                      say "
n:" sysdsn(indsn)          +
                         ÿ
         ÿ
                                                                 /* ----
----------------------------------------- ÿ
specified then verify   ÿ
--------------------------------------------- */                      if
e = "PKZIP" then do                                        ÿ
thod <> "*" then                       +
Select                               ÿ
    When abbrev("NORMAL",translate(method),2) then
           method = "Normal"
      When abbrev("MAXIMUM",translate(method),2) theÿ
             method = "Maximum"
        When abÿ
               method = "Fast"                                     ÿ
            When abbrev("SUPERFAST",translate(method),2) then
                 method = "Superÿ
              When abbrev("STORE",translate(method),2) then
  ÿ
                otherwise do                     ÿ
                            say "ZIP Error: The specified compression" ,
                 ÿ
                              say "           is not a supported mÿ
                                say "ZIP Terminating."
                                ÿ
                                  end
   ÿ
                     end                       ÿ
                    if zip_type = "ISPZIP" then
                    ÿ
                            then do                           ÿ
                                   say "ZIP Error: ISPZIP does not suppo
                                     ÿ
                                     say "ZIP Terminating."
                                       exit 16
                                  end                 ÿ

            ÿ
------- *                       * Get rough space allocations          +
          *                       * ---------------------------------ÿ
----------- */             ÿ
                                      if zip_type = "PKZIP" then do
                                         if sysadirblk = "NO_LIM" then d
      ÿ
 a PDSE Library" ,                                  "which is not suppor
KZIP/MVS."                                      exit 16
                       ÿ
                                                 end   ÿ

                                          ÿ
------------------------- *                       * fixup dataset nameÿ
                            *                       * ------------------
--------------------------- */                      if zip_ÿ
n                                                        if pos("(",inds
hen dÿ
with ldsn "(" mem ")" rdsn                                    indsn = ld
sn                                                              if zip_n
                    ÿ
a = translate(mem)".txt"                                          end
             ÿ
> "'" then                         ÿ
r("syspref")"."indsn                                               else
lue indsn with "'" indsn "'"  ÿ
,1) <> "'" then                                   ÿ
sysvar("syspref")"."zipdsn
                                               ÿ
                                                                 ÿ
p_type = "PKZIP" then call build_pkzip
p_type = "ISPZIP" then call build_ispzip                        ÿ
wise do
ÿ
ay "ZIP processing terminating."
xÿ
 end           ÿ
 end
                  ÿ
 /* --------------------------ÿ
    * Setup the SYSIN Work dataset                          *
    * -----------------------------+
      if zip_type <> "ISPZIP" theÿ
             rr = random(99999)
             sysin = "zipwork.sysin.r"rr
             "Alloc f(sysin) unit(sysda) spa(1,1) ÿ
                        "lrecl(80) blksize(6160) reuse ds("sysin") new"
                 end
                                                                   ÿ
                 /* ----------------------------------------------------
                    * Write the control cards out to sysin
                    * --------------------------------------------------
      ÿ
        ÿ

                       ÿ
- *                    ÿ
    *                       * ------------------------------------------
--- */                      sysprint = "ÿ
                              call msgÿ
                                if zip_type = "PKZIP" then do
                                   prnt_dd = "sysprint"  ÿ
                                     "Free  f(sysprinÿ
                                       "Alloc f(sysprint) unit(sysda) sp
r" ,                                          "blksize(0) reuse ds("sysp
 new"                                    end                        ÿ
                                        if zip_type = "ISPZIP" then do
                                           prnt_dd = "ispzprnt"
           ÿ
   ÿ
a(1,1) tr" ,                                          "blksize(0) reuse
rint") new"                 ÿ
                  ÿ

                                             ÿ
------------------------- *      ÿ
                            *                       * ------------------
--------------------------- */                      call outtrÿ
                                                ÿ
                                                           Address Link
                                                        else do


zip_load "'"parm"'"                                                 else
zip_load                                                         end
                ÿ
                                                                  erc =
                                                                  call o
off"         +
           ÿ
----------------------------------------------- *
urn non-zero then display zip messages          * ÿ
--------------------------ÿ
rc = 4 then do
ay " "                                                             ÿ
 say "Warning: Zip processing returned a ÿ
   say "         Processing continues but you should check "
   say "         the zip report."
   sÿ
       debug = "DEBUG"
       src   = 0
       erc   = 0     ÿ
           end
        if src > 4 × src < 0 then do
           say " "                    ÿ
      ÿ
               say " "
               debug = "DEBUG"                         ÿ
                 src ÿ
                   call msg 'off'
                   "Delete" zipdsn
                     end            ÿ

                   /* --------------------------------------------------
         ÿ
*                       * ----------------------------------------------
*/                      if debug <> null
                          ÿ
                               then do
                                   "Execio * diskr" prnt_dd "(finis stem
                                    Say "ZI+
 ÿ
                                             say zip.i
                                             end
                ÿ
                                              end

                               +
----------------- *          ÿ
 and reallocate     *                       * sysin and sysprint dd's
                    *                       * --------------------------
--------------ÿ
                                                return erc

                               ÿ
--------------------------- *                       * Free Allocations
                            *                       * ------------------
--------------------------- */                  ÿ
                                                        "Free  f(sysin)
                                                        "Free  f("prnt_d
te"                                                     "Alloc f(ÿ
*) reuse"ÿ
s(*) reuse"                                                 if zip_type
P" then                                                        "Free  f(
)"ÿ

                                                               /* ------
-------------------ÿ
the PKZIP control statements                *                       * --
------------------------------------------- */                     Build
                                    ÿ
= "-Echo"
= "-Archive("zipdsn")"
= "-Add"                                             ÿ
.4  = "-Archspace(TRK)"
.5  = "-Archprimary("sysprimary")"
.6  = "-Archsecondary("sysseconds")"                                  ÿ
rd.7ÿ
card.8  = "-Archlrl(512)"
card.9  = "-Archblksiz(0)"
card.10+
    carÿ
      i = 11
                                  ÿ
        method = strip(mÿ
          i = i + 1
          if method <> "*"                       +
               then card.i = "-Method("meÿ
                   else card.i = "-Method(Normal)"

                password = strip(password)                ÿ
                    if password <> "*" then do
                       i = i + 1
                       card.i = "-Password("password")"
                           end

                        if z_type = "ZIPBIN" then do
            ÿ
                               card.i = "-Binary"
                               end
                           ÿ
                                if unit <> "*" then do
                                   i = i + 1
                                   card.i ÿ
                                       end

                                    zip_nia    = strip(ziÿ
                                        if zip_nia <> "*" then do
                                           i = i + 1
                                           card.i = "-NIA(*,"zip_nia")"
  ÿ

                                            i = i + 1
       ÿ
                                                card.0 = i
                                                return
                      ÿ
                                                   /* ------------------
--------------------------- *                       * Now build the ISPZ
ol statements               *        ÿ
------------------------------- */                 ÿ
                                                           if password <
en do                                               ÿ
ISP/ZIP does not support a  password"                           say ÿ
ime.  ZIP process terminating."                                   exit 1
                                                                  e+
                                                                 ÿ
')     ÿ
ipdsn"'"                                                             cal
n')                                                                  zip
ÿ
f("zip_dd") ds('"zipdsn"') new tracks" ,
("sysprimary","sysseconds")"   ,
fm(v b) lrecl(4ÿ
m = "COMP"
zip_nia <> "*"
then                          ÿ
       parm = parm "FROMDS(''"indsn"("zip_nia")'')"
    else
       parm = parm "FROMDS(''"indsn"'')"     ÿ
     parm = parm "TODS(''"zipdsn"'')"
     if z_type = "ZIPBIN"
        then parm = parm "ZIP"                              ÿ
          elT se parm = parm "ZAC"
         parm = parm "NOLOG"
         return
 {


ƒ

 





°
S




TIPI2
r^ÿ

E



TIPXM
Õ

PX5
 

ÿ

lt(%+_)                                                              /*
ext  ) intens(low )                   information only  */

pe( input) intens(high) caps(off) just(left )
pe( input) intens(high) caps(off) just(left ) pad('_')
pe( input) intÿ
type(textÿ
~ type(text) intens(high) color(blue) hilite(reverse)
# type(output) intens(high) c+
Body  Expand(//)          ÿÿ
   %-/-/- ~XMITIP E-Mail Address BCC% -/-/-
   %Command ===>_Zcmd
                                          ÿ
       ~Enter Blind Carbon Copy addresses:+

       ~Address: _b1                                     ÿ
           ~Address: _b2
           ~Address: _b3
           ~Address: _b4

               ~Address: _b6
               ~Address: _b7
       ÿ
                   ~Address: _b9
                   ~Address: _ba
                   ~Adÿ
                       ~Address: _bc
                       +
                       +Enter CLEAR tÿ
or CANCEL to Cancel        )Init
                            .cursor = zcmd
                           )Proc                    ÿ
                               )End
                               
                                                         /* + type(ÿ
ens(low )                   information only  */              _ type( in
ens(high) caps(off) just(left )                             ÿ
ntens(high) caps(off) just(left )                               $ type(
ntÿ
 intens(non)  caps(off) just(left )                               % type
 intens(high)                                                       ~ ty
 intens(high) colÿ
put) intens(high) color(blue) just(right)                          )Body
(//)          ÿ
TIP E-Mail Address CC% -/-/-    ÿ
===>_Zcmd
                               ÿ
Carbon Copy addresses:+                        +
                                             ÿ
dress: _c1                                        ÿ
Address: _c2
Address: _c3                                                ÿ
 ~Address: _c4                                                     ÿ
   ~Address: _c5
   ~Address: _c6
     ~Address: _c7
    ÿ
       ~Address: _c9
       ~Adÿ
         ~Address: _cÿ
           ~Address: _ccx
           +             ÿ
             +Enter CLEAR to clear, PFÿ
 Cancel        )Init
                .cursor = zcmd          ÿ
                 )Proc                                 h
                   )End
                   
it highlighting with no action bars */         )ATTR DEFAULT(%+_) FORMAT
                                                ~ TYPE(AB)
                                                ÿ
                                                    1B TYPE(PT)
                                                    ! TYPE(FP)
                                                    @ TYPE(NT)   ÿ
     ÿ
                                                        * TYPE(VOI) PADC
                                                        { AREA(DYNAMIC)
N)ÿ
ENS(LOW)                                                    02 TYPE(DATA
                                                            03 TYPE(DATA
P(ON)              ÿ
INTENS(LOW) CAPS(OFF) FORMAT(&MIXED)                            05 TYPE(
CAPS(OFF) FORMAT(&MIXED)                                        06 TYPE(
INTENS(LOW) CAPS(IN) COLOR(&ECOLOR) ÿ
IN) CAPS(IN) FORMAT(&MIXED)                                         08 T
IN) INTENS(LOW) FORMAT(DBCS)                                        09 T
IN) INTENS(LOW) FORMAT(EBCDIC)                       ÿ
DATAIN) INTENS(LOW) FORMAT(&MIXED)                             ÿ
E(DATAIN) INTENS(LOW) CAPS(IN)  COLOR(&ZPLEXCLR) FORMAT(&MIXED)
E(DATAIN) INTENS(LOW) CAPS(OFF) COLOR(&ZPLEXCLR) FORMAT(&MIXED)
YPE(DATAIN) INTENS(LOW) CAPS(IN)  COLOR(BLUE)      FORMAT(&MIXED)
 TYPE(DATAIN) INTENS(LOW) CAPS(IN) FORMAT(&MIXED)
 TYPE(CHAR) COLOR(PINK) HILITE(REVERSE)
 TYPE(CHAÿ
G  TYPE(CHAR)ÿ
  B  TYPE(CHAR) COLOR(BLUE)
  W  TYPE(CHAR) COLOR(WHITÿ
    P  TYPE(CHAR) COLOR(PINKÿ
      Y  TYPE(CHAR) COLOR(YELLOW)
      T  TYPE(CHAR) COLOR(TURQ)            ÿ
        L  TYPE(CHAR) COLOR(RED)           ÿ
          K  TYPE(CHAR) COLOR(&ZCK) HILITE(&ZHK)
          O  TYPE(CHAR) COLOR(&ZCO) HILITE(&ZHO)            ÿ
            Q  TYPE(CHAR) COLOR(&ZCQ) HILITE(&ZHQ)        ÿ
              C  TYPE(CHAR) COLOR(&ZCC) HILITE(&ZHC)
              V  TYPE(CHAR) COLOR(&ZCV) HILITE(&ZHV)
                D  TYPE(CHAR) COLOR(&ZCD) HILITE(&ZHD)
                    F  TYPE(CHAR) COLOR(&ZCF) HILITE(&ZHF)
                    S  TYPE(CHAR) COLOR(&ZCS) HILITE(&ZHS)
                   )BODY  EXPAND(//) WIDTH(&ZWIDTH)  CMD(ZCMD)
        ÿ
  !Columns*Z    *Z    @!Command ===>#Z/ /
     !Scroll ===>#Z   @{ZDATA,ZSHADOW/ /
                      {ÿ
                          {)INIT
                           .ZVARS = '( ZVMODET ZTITLE ZCL ZCR ZCMD ZSCED
                           &ZTITLE = &ÿ
                                 IF (&ZVMODET = 'VIEW')
                                   &ECOLOR = 'BLUE'          /* 'BLUE' i
anslatable          */             .HELP = ISR10000  ÿ
                                     ELSE
                                       &ECOLOR = 'GREEN'         /* 'GRE
OT translatable         */             .HELP = ISR20000             ÿ
  ÿ
MT VARIABLE NAME  */                     &MIXED = MIX                /*
AT MIX            */                     IF (&ZPDMIX = N)            /*
C M+
 ÿ
                                             .ATTR(ZSCED)='CAPS(ON)'
                                    ÿ
SCROLL VARS IF  ÿ
NK WITH PAGE.          */                         &ZSCED = 'PAGE'
                       */                            ÿ
                               ÿ
                                                       REFRESH(*)
                                                       IF (&ZVMODET = ÿ
                                              ÿ
       /* DEFAULT TUTORIAL NAME     */                     ELSE
                                                             .HELP = ISR
       ÿ
                                                               REFRESH(*
                                                               &ZCURSOR
R                       ÿ
SRPOS                                                              &ZLVL
LINE(ZDATA)                                                      VPUT (Z
OFILE                                    +
           ÿ
************************************************************/          /
riable ZDSVOL to display the volume of the data set        */          /
**************************ÿ
EG(ISREFR02) COMP(SCLM)  PROD(MVS):                   */
E= USERREQ   OS390R3   961010   040100 :  add zdsvol            */
645-001, 5655-042 (C) COPYRIGHT IBM CORP ÿ
{
                           )Attr Default(%`_)
                           /* _ type( input) intens(highÿ
)               */            ÿ
t ) pad('_') color(turq)          ! type(output) intens(high) caps(off)
s ) color(white)                  ~ type(text) intens(high) caps(off) jÿ
s ) color(turq)                     % type(textÿ
                                      # area(SCRL) Extend(ON)
                                   )Body  Expand(//)
      ÿ
                                       %Command ===>_zcmd
                                       %
                     +
 ÿ
--------------------------------------------#)Area Help
                                             `  This table allows you to
s many e-mail addrÿ
remembered so from this address book you         `  can select one or mo
sses to receive your e-mail.                     `
                                   ÿ
                                                     `
                                                     ~  Cancel`      Can
 current XMITIP session                             ÿ
                                                         ~  Find`
e character sting entered                                `
                                                         ~  Insert`  ÿ

                                                             `  Valid Li
ns are:                                                      `
      ÿ
 Select the current address to be a primary TO recipient         `
                                                                 ~  C`
 Select the current addÿ
                                                                     ~
     Select the current address to be a Blind Carbon Copy recipient  `
                                        ÿ
         UnSelect the current address

         Delete the current address from the table       +
                                                         ÿ
  I`           Insert a new address

 ~  R`           Displays a panel to Revise the current address
   ` ~
   )Init
     .curÿ
     )Proc ‘
       )end
       {
                                     /* + type(text  ) intens(low )
      information only  */           /* _ type( input) intens(high) caps
st(left )               */            ÿ+
) just(left) color(yellow)           ÿ
ff) just(left) color(blue)                    % type(text) intens(high)
                                              ~ type(textÿ
yellow)                                      )Body  ÿ
                                               %-/-/- ~XMITIP E-Mail Add
ision%-/-/-                                    %Command:%===>_zcmd
                                                 +                 ÿ
                                                   +  Enter or Revise th
nd Address                                         +
           ÿ
meÿ
addr                                                   +
                            ÿ
                 ÿ
                                                           )END
                                             º               

         ` type(text) intens(high) caps(off) just(asis ) color(yellow)
         ~ type(text) intens(high) caps(off) just(asis ) color(turq)
         %ÿ
             )Body Window(60,15) Expand(//)
             %-/-/- ~XMITIP Recipient Address%-/-/-
             +             ÿ
                 ~The recipient address is the internet e-mail address t
                 ~will appear in the TO field of the e-mail.
                 +                          ÿ
                     ~Valid options are:
                     +
                     ~e-mail address                         ÿ
            ÿ
                         ~? - which will bring up the address book
                         +
                           ÿ
                             +
                             ~your.boss@company.com
               ÿ
                                 )Init
                                 )End
                                  
)                                                      ÿ
tens(high) caps(off) just(asis ) color(yellow)                   ~ type(
tens(high) caps(off) just(asis ) color(turq)                     %ÿ
intens(high)                                                       )Boÿ
w(60,11) Expand(//)                                                  %-/
TIP Message Dataset%-/-/-                                            +
   ÿ
age dÿ
hat will be included in the e-mail as the message.
                    ÿ
d options are:      ÿ

           - used when under ISPF to ÿ
               and edit a message. ÿ
 ~dataset name+- any sequential dataset or PDS member.
 ~HTML        +- same as~*+but will define as rich texI t.
   )Init                                          ÿ
     )End
     
                               ` type(text) intens(high) caps(offÿ
 color(yellow)                   ~ type(text) intens(high) caps(off) jus
 color(turq)                     %ÿ
                                   )Body Window(60,15) Expand(//)
ÿ
                                     +             ÿ
                                       ~The CC address is the internet e
dress that willÿ
                                         +                          ÿ
                                           ~Valid options are:
                              ÿ
                                             ~e-mail address
     ÿ
                                             ÿ
dress book                                       +
                      ÿ
                                                   +        ÿ
                                                     ~your.boss@company.
                                       ÿ
ompany.com>                                            )Init
                                                         )End
                                                            

       ` type(text) intens(high) caps(off) just(asis ) color(yellow)
       ~ÿ
         %ÿ
           )Body Window(60,16) Expand(//)
           %-/-/- ~XMITÿ
             +             ÿ
               ~The BCC address is the internet e-mail address who will
               ~receive a copy of the ÿ
                 ~in the e-mail header.     ÿ
                   +
                   ~Valid options are:               ÿ
                     +                                       ÿ
                       ~e-mail address
                       ~"first last" <e-mail address>               ÿ
                         ~? - which will bring up the address book
                           +
                           ~Examples:
   ÿ
               ÿ
                               ~"your boss" <your.boss@company.com>
                  ÿ
                                ^  )End
                                   
                                 ÿ
ns(high) caps(off) just(asis ) color(yellow)                   ~ type(te
ns(high) caps(off) just(asis ) color(turq)                     %ÿ
tens(high)                                      ÿ
60,14) Expand(//)                                                  %-/-/
P From Address%-/-/-                                               +
 ÿ
the address that will be used in the FROM field to                     ~
he recipient who sent the e-mail.  If not specified                    ~
l default to your ÿ

d options are:
                                   ÿ
mail address ÿç
           +
           ~Examples:                                           ÿ
             +              ÿ
               ~your.name@company.com
               ~"your name" <your.name@company.com>
 ¼               )Init                     ÿ
                   )End
                   
                                             ` type(text) ÿ
f) just(asis ) color(yellow)                   ~ type(text) intens(high)
f) just(asis ) color(turq)                     %ÿ
                                                 )Body Window(60,15) Exp
)                                                  %-/-/- ~XMITIP Reply-
ss%-/-/-                                           +             ÿ
                                                     ~This is the addres
ill be nÿ
 will be used by the recipients                        ~mail client as t
 Tÿ
                       ÿ
                                                           ~Valid option
                   ÿ
                                      ÿ
                                                               +
                                    ÿ
                                                     ÿ
                                                                   ~your
mpany.com                                            ÿ
" <your.name@company.com>                                           ÿ
                                                                       )
                                                                      
½
   ÿ
w)                   ~ type(text) intens(high) caps(off) just(asis ) col
                     %ÿ
                  ÿ
                         %-/-/- ~XMITIP Receipt Address%-/-/-
                         +             ÿ
                           ~This +
ients                        ~eÿ
 arrives.                      ~Note: this feature is not ÿ
l systems.                       +
                                 ~Valid optionÿ
                                   +
                                     ~e-mail address
                                     +                       ÿ
                                       ~Examples:
            ÿ
                                         ~your.name@company.com
                                           ~"your name" <your.name@compa
                             ¼               )Init
                                             )End
           ÿ
efault(%+_)
text) intens(high) caps(off) just(asis ) color(yellow)
text) intens(high) caps(ofÿ
ype(text) intens(high)
dy Window(60,9) Expand(//)
-/- ~XMITIP Attachment DSN%-/-/-         ÿ
             ÿ
 ~This is any sequential dataset or PDS member that will be
 ~inserted into the e-mail as an attachment.            ÿ
   +                          ÿ
     ~Valid options are:
     +                                                                 ÿ
       ~sequential-dataset-name                ÿ
         ~?+ will bring up the file attachment dialog
         )Init
      ÿ
             
                                       ` type(text) intens(high) caps(of
asis ) color(yellow) ÿ
t(asis ) color(turq)                     %ÿ
                                           )Body Window(60,6) Expand(\\)
                                    ÿ
                                             +             ÿ
                                               ~The option will include
after the message text                         ~and+
                                                 ÿ
                                                     ~Values:`Yes+or`No
                                                     )Init
                                                     )End       ÿ
               Í                                         

   ` type(text) intens(high) caps(off) just(asis ) color(yellow)

     %ÿ
       )Body Window(60,4) Expand(//)
       %-/-/- ÿ
         +             ÿ
           ~This is a sequential dataset or PDS member that contains
           ~information that ÿ
             )Init                      l
               )End
               
                                           ` type(text) intens(high) cap
ust(asis ) color(yellow)                   ~ type(text) intens(high) cap
ust(asis ) color(turq)                     %ÿ
                                               )Body Window(60,6) Expand
                                               %-\-\- ~XMITIP Importance
                                               +             ÿ
                                                   ~Define the`importanc
s e-mail message. The valid                        ~options are:`High, N
r`Low+                                             +
         ÿ
ents support this option.                              )Init
                                                       )End
               Í        ÿ
¦
     ` type(text) intens(high) caps(off) just(asis ) color(yellow)
     ~ type(text) intens(high) caps(offÿ
       %ÿ
         )Body Window(60,6) Expand(\\)
         %-\-\- ~XMITIP Priority%-\-\-                ÿ
           +             ÿ
             ~Define the`Priority~of this e-mail message. The valid
             ~options are:`Urgent, Non-Urgent,~or`Normal+            +
               +                          ÿ
                   `Note:~Not all e-mail clients support this option.
                   )Init
                   )End                                    Í
  ÿ
                                                 ` type(text) intens(hig
off) just(asis ) color(yellow)                   ~ type(text) intens(hig
off) just(asis ) ÿ
                                                     )Body Window(60,6)
\)                                                   %-\-\- ~XMITIP Sens
-\-\-                           ÿ
                                                         ~Define the`Sen
~of this e-mail message. The valid                       ~options are:`P
Personal, Confidential,~or`Company.            ÿ
      ÿ
il clients support this option.                              )Init
                                                             )ÿ
                       Í                                         

           /* % type(text  ) intens(high)              Defaults displaye
*/           /* + type(text  ) intens(low )                   informatio
*/           /ÿ
  */              ! type( input) intens(high) caps(on ) just(left ) pad(
            ÿ
                    # type(outpÿ
                        hilite(uscore)
                      ~ typÿ
                        ` type(text) intens(highÿ
                       )Body  Expand(//)
                       %-/-/- ~XMITIP E-Maÿ
                         %Command ===>_zcmd                      ÿ
/%Scroll ===>_amt +        %
                           + Commands: `Find`Insert+or`Caÿ
                             +or`S+Select`B+Blind Copy`C+Carbon Copy`D+D
Inÿ
                               %Sel  Action   Recipients Name
                                 +              E-Mail Address
                   ÿ
                                   )Model
       +
     ÿ
                                         )Init
                                         .help = xmitipah
                    ÿ
'                                              &amt = csr
                                             )Reinit
                                   ÿ
                                                  ver (&zsel,list,S,B,C,
                                                 )End
                                                 
tr default(%+_)
ype(text) intens(high) caps(off) just(asis ) color(yellow)
ype(text) intens(high) caps(off) just(asis ) color(turq)         ÿ
ÿ
 )Body Window(60,13) Expand(//)
 %-/-/- ~XMITIP Subject%-/-/-
ÿ
     ~The subject of the message.  The text may be enclosed in
     ~quotes, either single (') or double (").  The`default+is
     ~to enclosÿ
         ~command.  By using double quotes at the start and end of
         ~the subject you can use single quotes within.
         +                    ÿ
             ~Three special keywords are allowed:
             +
             ~&&DATE+or~&&DATE-n+to insert thÿ
                 ~&&DAY+ or~&&DAY-n+ to insert the current day or day-n
                 ~&&TIME+to insert the time of day
                 )Init                                      ÿ
     %               )End
                     
                                               /* + type(text  ) intens(
                  information only  */              _ type( input) inten
caps(off) just(left )                             ÿ
) caps(on ) just(left )                               ` type( input) int
) caps(offÿ
)                                                       ~ type(textÿ
gh) color(blue) hilite(reverse)                           @ type(output)
high) color(blue) just(ri+
ON)                    ÿ
      ÿ
og @ver  %-\-\-                                              %Command ==
                                      ÿ
-----------------------ÿ
                                                                 +Recipi
ess%===>_to                                          ÿ
     %===>_msgds                        ÿ
             dsn or * to edit a message or null for no message       ~Op
nformation+                                                         ÿ
         %===>_subject                                   ÿ
ress       %===>_cc
dress      %===>_bcc
ddrÿ
ply-To Address %===>_replyto
ceipt Address  %===>_receipt
gnature DSN    %==ÿ
Attachment ÿ
 +Attachment Desc  %===>`filedesc
 +Carriage Control %===>_asa+    ÿ
   +Murphy           %===>_mÿ
     +Importance       %===>_import      + High, Normal, Low
     +Priority         %===>_prior       + Urgenÿ
       +Sensitivity      %===>_sens        + ÿ
Company  +Report Style     %===>_style       + Landscape, Portrait, File
ull or X +Font/Type        %===>_font+         Font size or Attÿ
ee help)   +Paper Size       %===>_paper        +Paper size, cÿ
 (see help)  +Margins - in inches (e.g. 8.5 for 8 1/2 inches)
             +    Left%===>_left +Right%===>_right +Top%===>_top +Bottom
bottom+        +

                   )Init
             ÿ
                      .help   = xmitiph0
              ÿ
                        &murÿ
                         )Proc
                          ver (ÿ
                            if (&msgds EQ &+
                                 ver (&fiÿ
                                if (&sigdsn NE &Z)ÿ
                                     ver (&sigdsn,dsname)
                                  &asa = trans(trunc(&asÿ
N,&z)                               if (&file = +)                 ÿ
                                          &file = ?
                                      &mur = trans(trunc(&mur,1) Y,Yes ÿ
,&z N,&z)                               if (&style = +)
    ÿ
                                          Vput (from replyto sigdsn asa
rt priÿ
                     ÿ
                                              Field(to)       panel(xmit
                     ÿ
                                      ÿ
)                                                 Field(cc)       panel(
)                                   ÿ
x5)                                                 Fieÿ
ipx6)                                                 Field(replyto)  pa
ipx7)                                              ÿ
itipx8)                                                 Field(sigdsn)
xmitipx9)                                                 Field(file)
xmitipxa)                                                 Field(fiÿ
l(xmitipxb)                                                 Field(asa)
l(xmitipxÿ
nel(xmitipxd)                                                 Field(impo
nÿ
panel(xmitipxf)           ÿ
  panel(xmitipxg)                                                 Field(
  panel(xmitipxhÿ
    panel(xmitipxi)                        +
r)    panel(xmitipxj)                    ÿ
ft)     panel(xmitipxk)        ÿ
right)    panel(xmitipxk)
top)      panel(xmitipxk)                                 œ
d(bottom)   panel(xmitipxk)                   ÿ
d

                         ` type(text) intens(high) caps(off) +
(yellow)                   ~ type(text) intens(high) caps(oÿ
or(turq)                     %ÿ
                               )Body Window(60,10) Expand(\\)
                               %-\-\- ~XMITIP Attachment Description%-\-
                                 +             ÿ
                                   ~This is a description of the file be
ched.  It may                      ~be specified as follows (no blanks a
         ÿ
                                       ~  file-description
                                       +
                        ÿ
 ÿ
                                           +Note:~not all mail clients u
feature.                               ÿ
                  `                            )End
                                               
efault(%+_)                                           ÿ
e(text) intens(high) caps(off) just(asis ) color(yellow)
e(text) intens(high) caps(off) just(asis ) color(turq)
ype(text) intens(high)                                               ÿ
Body Window(56,10) Expand(\\)
-\-\- ~XMITIP FILENAME Keyword%-\-\-
             ÿ
 ~FIÿ
   ~attachment in the e-mail and will appear in the e-mail
   ~client as the attachment nÿ
     ~             ÿ
       ~Syntax:
       ~                                       ÿ
               ~FILENAME file-nameÿ
           `or   ~FILENAME (file-name1 file-name2 ...)
           )Init                                                `
             )End                                ÿ
               
                                         /* % type(text  ) intens(high)
     Defaults displayed for */           /* + type(text  ) intenÿ
            information only  */           /ÿ
(on ) just(left )               */              ! type( input) intens(hi
(on ) just(left ) pad('_')                      $ type( input) intens(hi

) caps(off) just(asis ) pad(' ')                      # type(text) inten
caps(off) just(asis )                                   hilite(uscore)
                                                      ~ type(text) inten
) color(blueÿ
gh) color(red)                                         )Body  Expand(\\)
                                                       %-\-\- ~XMITIP Fi
hment%-\-\-    ÿ
                              \ \%Scroll ===>_amt +        %
                                                           + Commands:`F
rt`Cancel+or`Clear              ÿ
ect `D+Delete `I+Insert `U+unSelect `or+overtype to change     +
                                                               %Sel+ #Ds
                                                 ÿ
me+(that will appear in the e-mail)                                %
+(of the file attachment - use~?+for prompting)                    %
ption+(of the file attachment - no blanks)                        ÿ
ft+ #Right+#Top+ #Bottom+   (Margins in inches .5 =1/2 inch)           )
                                                                       !
                                                           +           +
   ÿ
 $z                                                            +
 $z                                                            +
 $z  + +$z  + +$z  +ÿ
Init
 .help = xmitipfh
 &zv1   = 'zsel act adsn afile aformaÿ
     &zv2   = 'aleft aright atop abottom'
     .zvars = '(&zv1 &zv2)'
     &amt = csr                                     ÿ
       )Proc
        ver (&zsel,list,S,D,I,U)
        if (&adsn NE *CREATE*)                                     ÿ
                ver (&adsn,dsname)                                     ÿ
             )Help
              Field(adsn)     panel(xmitipxa)
  ÿ             Field(adesc)    panel(xmitipxb)
        ÿ
                  Field(aformat)  panel(xmitipxh)
                 ÿç
                                Fieldÿ
                                  Field(atop)     panel(xmitipxk)
                                ÿ
                                   )End               ü
                                     {
+_)                                            ÿ
intens(high) caps(off) just(asis ) color(yellow)                   ~ typ
intens(high) caps(off) just(asis ) color(turq)                     %ÿ
) intens(high)                                                ÿ
dow(55,11) Expand(\\)                                                  %
MITIP ZIPMETHOD Keyword%-\-\-                                          +
     ÿ
ETHOD is the compression method to be used by the
utility.
                      ÿ
or PKZIP theÿ
     Normal, Fast, Maximum, Store, Superfast
                                       ÿ
 ` For ISPZIP this option iÿ
   ~
   ~This requires that the file attachment be zip'd     I
     )Init                                ÿ
       )End
       
                                 ` type(text) intens(highÿ
 ) color(yellow)                   ~ type(text) intens(high) caps(off) j
 ) color(turq)                     %ÿ
                                     )Body Window(55,11) Expand(\\)
                                       %-\-\- ~XMITIP ZIPPASS Keyword%-\
                                       +             ÿ
                                         ~ZIPPASS is a password that wil
d by thÿ
nt for security.                           `                          ÿ
                                             `PKZIP the supported value
pto 64 characters.    ÿ
                                               `ISPZIP does not support
ion.   ÿ
                                     +
attachment be zip'd                ÿ
                          `                            )End
                                                       
›)attr default(%+_)                               ÿ
   $ type(output) intens(high) caps(off) color(yellow)
   _ type(input)  intens(high) caps(off)
   ~ÿ
       % type(text) intens(high)
       )Body Window(55,4) Expand(\\)
       %-\-\- ~XMITIPÿ
ÿ
           ~Enter/Confirm the$info
            ===>_xminfo               ÿ
             )Iÿ
                &info = &xmt
               )Proc                                   O
                  ver (&xminfoÿ
                   )End
                   
                                             ÿ
                                               /* _ type( input) intens(
ps(on ) just(left )               */            ÿ
caps(on ) just(left ) pad('_') color(turq)          ! type(oÿ
) caps(off) just(asis ) color(white)                  ~ type(text) inten
caps(off) just(asis ) color(turq)                     % type(textÿ
)                                                       # area(SCRL) Ext
)                                                      )Body  Expand(\\)
                                                       %-\-\- ~XMITIP Fi
hmÿ
          ÿ
                                                           `
                   ÿ
-------------------------ÿ
                                                               `  This t
ows you to enter as many files as yoÿ
he file formatting information.  All filÿ
n select only those file attachments that you want for the         `  cu
ITIP session.                                        ÿ
                                                       +
To update any row just move/tab the cursor to the fieÿ

lid Commands are:
                                                                    ÿ
Cancel`      Cancels the current XMITIP session
         ÿ
  Clear`       Clears the table of all entries
   ÿ
 ~  Find`        find the ÿ
   `
   ~  Insert`     ÿ
     `                                     ÿ
       `  Valid Line options are:
       `                         ÿ
         ~  Select`      Select the current file to be attacÿ
           `
           ~  UnSelect`    UnSelect the current ÿ
             `
               ~  Delete`      Delete the current row from the table
                 `                                             ÿ
                   ~  Insert`      Insert a blank row
                   `
            ÿ
                       `
                       ~  Dsname`      The dataset name of the file to b
ment.  Use normal      `     ÿ
.            ÿ
                           `               A dsname of *create* will be
and opened in ISPF Edit    `                  ÿ
                            ÿ
tachment.                      `               enter a ? and press enter
opup will appear to            `               assist with fillÿ
eld.                             `         ÿ
to use the popup to assist         `               with updating the cur
ue.                                `
ÿ
pecification in inches (e.g. .5)       `               and is only used
and PDF conversions. Default is .8     `
                 ÿ
gin specification in inches (e.g. .5)      `               and is only ÿ
r RTF and PDF conversions. Default is .8     `
                                    ÿ
argin specification in inches (e.g. .5)        `               and is on
for RTÿ
                                                 ~  Bÿ
ottom margin specification in inches (e.g. .5)     `               and i
sed for RTF and PDF cÿ
                                                     ~  Description` Tÿ
ither the file-description (with no blanks) or         `               f
/file-description.                  ÿ
port.doc/monthly-report                                  )Init
       ÿ
                                                   ÿ
                                                             )end
                                                              {

               ` type(text) intens(high) caps(off) just(asis ) color(yel
               ~ type(text) intens(high) caps(off) just(asis ) color(tur
              ÿ
 ÿ
                 )Body Expand(\\)
                 %-\-\- ~XMITIPÿ
                ÿ
      %Up F10 Dn F11 #help ---------------------------------------------
--------------------#)Area Help                 ÿ
                       ~Definesÿ
                         `
                         ~Note: Enter a ? to bring up a dialog poÿ
ut                         ~      this informaÿ
                             `
                             ~The syntax is:
  ÿ
                                 `~FORMAT`- the~FORMAT`of the file attac
                                 `~FORMAT`xxx or .xxx
                   ÿ
                                     `~FORMAT`TXT
                                     `         plain text attachment (de
                                    ÿ
           +
 suffix  ÿ
                                           `~FORMAT`HTMÿ
                                             `        color is documente
(after FORMAT)          ÿ
hment suffix                                   `            (e.g. xls or
                                                 `~FORMAT`PDF/layout/fon
lpi                                    ÿ
(11x8.5)                                           `                  Po
(8.5x11) ÿ
t is Portrait                                        `ÿ
ize where 72 points                                    `             is
 (default is 9)           ÿ
r for Letter (8.5 x 11)                                  `           ÿ
al for Legal (11x14)                                       `
for A4 (European paper)                    +
r hhxww where hh = height                ÿ
    ÿ
      e.g. 8.5x11 for letter                                     `
 the lines per inch (default 6)                           ÿ
layout/font/paper/sÿ
yout is Landscape (11x8.5)                                           `
        Portrait  (8.5x11)                                           `
          - default is Portrait   ÿ
  font is a font size where 72 points
       is one inch (default is 9)
  paper is Lÿ
               LEGal for Legal (11x14)
               A4 for A4 (European paper)
               or hhxww whereÿ
 `                                ww = width
 `                    e.g. 8.5x11 for letter
 `        suffix is the file attachment suffixÿ

     `~FORMAT`ZIP/name-in-archive
     `        to zip a text file                               ÿ
       `      ÿ
         `             will have in the zip file
         `~FORMAT`ZIPBIN/name-in-archive
ÿ
             `~FORMAT`ZIPHTÿ
               `        to convert the file to HTML and then
               `   ÿ
                 `~FORMAT`ZIPPDF/name-in-aÿ
                   `        to convert the file to PDF and then
                   `        zip the ÿ
                     `~FORMAT`ZIPRTF/name-in-archive/layoÿ
                       `        to convert the file to RTF and then
                       `        zip the file         ÿ
                         `
                           ~ Color definitions for HTML attachments
                           ~        If color is just color then it is ÿ
                             ~        text color on a white background.
       ÿ
                               ~        color is the background color an
       +
     ÿ
                                     ~        Color      Abbrev   Color
ev                                   `        Aqua       A        Navy
                      ÿ
O                                        `        Blue       Blu      Pu
P                                        `        Fuchsia    F        Re
R                                      ÿ
    S                                        `        Green     Gre
    T                                        `        Lime      L
    W                                        `        MaX roon    Mÿ
llow    Y                                        )Init
                                                 )End
                                                 {
trÿ
* + type(text  ) intens(low )                   information only  */
  _ type( input) intens(high) caps(off) just(left )
ÿ
      ` type(text) intens(high) caps(off) just(left ) color(blue)
      % type(text) intens(high)
      ~ type(textÿ
          # area(SCRL) Extend(ON)
       )Body Expand(\\)
       %-\-\- ~Format Prompt%-\-\-ÿ
           %Command ===>_Zcmd                ÿ
 %Up F7 Dn F8`Enter, Verify then Check FORMAT Information and then press
o 'register'.`Leave or blank out unnecessary fields. ÿ
               #xmit ---------------------------------------ÿ
----------------#)Area xmit
                 `Format Text:     %===>$ft +                     non-ÿ
                   ` File Suffix     %===>_tsuf+                    suff
g. txt xls)          +--------------------------------------------------
---------------------`Format Binary:   %===>$fb +                     no
       ÿ
e.g. bin xÿ
-------------------------`Format HTML:     %===>$fh +
ank                     ÿ
ground or text-backgroundÿ
fault is html                +------------------------------------------
-----------------------------`Format PDF:ÿ
non-blank                      ` Layout ÿ
  Portrait or Landscape          ` Font size       %===>_pfont+
  default is 9 (72 = 1 inch)     ` LPI             %===>_pÿ
    Lines per inch (default 6)     ` Paper           %=ÿ
      Letter, Legal, A4 or nnxyy     +----------------------------------
-------------------------------------`Format RTF:      %===>$fr +
        non-blank                      ` Layout          %===>_rlayoutÿ
          Portrait or Landscape          ` Font size       %===>_rfont+
          default is 9                   ` Paper           %===>_rpaper+
          Leÿ
     ÿ
---------------------------------------------`Format ZIP:      %===>$fz
              non-blank      +
               +Nameÿ
---------------------------------------------------`Format ZIPBIN:   %==
                    non-blank                      ` Name-in-Archive %==
                   +Name in Archiveÿ
-------------------------------------------------------`Format ZIPHTML:
hz+                     non-blank                      ` Name-in-Archive
znia                   +Name in Archive for file  ÿ
=>_zcolor     +             background or text-background  +------------
-----------------------------------------------------------`Format ZIPPD
=>$fpz+                     non-blank                      ` Name+
ÿ
   %===>_pzlayout   +             Portrait or Landscape          ` Font
   %===>_pzfont+                  default is 9                   ` LPI
   %===>_pzlpi+  ÿ
       %===>_pzpaper+                 Letter, Legal, A4 or nnxyy     +--
---------------------------------------------------------------------`Fo
RTF:   %===>$frz+                 ÿ
-Archive %===ÿ
t          %===>_zlayout   +              Portrait or Landscape
size       %===>_zfont+                   default iÿ
er           %===>_zpaper+  ÿ
------------------------------------------------------------------------
it                                                                  ÿ
.cursor = zcmd                             ÿ
  .help   = xmitipxh
  &ft = &z
  &fbÿ
      &fh = &z
      &fr = &z
      &fp = &z        ÿ
          &fz = &z
          &fbz = &z
          &fhz = &z                    ÿ
        ÿ
              &frz = &z
             )Proc                                      ÿ
                If (&ftÿ
                    If (&fb EQ &Z)
                      If (&fh EQ &Z)
                          If (&fp EQ &ÿ
                                 If (&fr EQ &Z)
                                   If (&fz EQ &Z)
                                     If (&fbz EQ &Z) ÿ
          ÿ
                                             If (&fpz EQ &Z)
                                                If (&frz EQ &Z)     ÿ
                           u                           ver (&ft,nb)
                               )End
                               {
   +
nÿ
 intens(high) caps(off) just(left )                             ÿ
t) intens(high) caps(on ) just(left )                               ` ty
t) intens(high) ÿ
t) intens(high)                                                       ~
tÿ
utput) intens(high) color(blue)ÿ
(SCRL) Extend(ON)                                                      )
and(\\)           ÿ
~E-Mail Dialog @ver  %-\-\-                   ÿ
and ===>_Zcmd                                                  %Up F7 Dn
 ----------------------------------ÿ
ea xmit                                                      ÿ
Recipient Address%===>_to
Message DSN      %===>_msgds                        ÿ
                         dsn or * to edit a message or null for no messa
   ~Optional information+
   +Subject          %===>_subject                                   ÿ
     +CC Address       %===>_cc
     +BCC Aÿ
       +From Address     %===>_from
      ÿ
         +Receipt Address ÿ
           +Signature DSN    %===>$sigdsn
 +         +Attachment ÿ
   +or ?     +Attachment Name  %===>`fileÿ
     +         +Attachment Desc  %===>`filedesc
             + +Murphy           %===>_mÿ
                 +Importance       %===>_import      + Hÿ
                   +Priority         %===>_prior       + Urgent, Non-Urg
mal                +Sensitivity      %===>_sens        + ÿ
nfidential, Company  +Format (?=prompt)%===>_format                    ÿ
                      ++ZipMethod        %===>_zipmeth        +Compressi
d                      +ZipPass          %===>_zippass
              + Password +Margins - in inches (e.g. 8.5 for 8 1/2 inches
      ÿ                    +    Left%===>_left +Right%===>_right +Top%==
Bottom%===>_bottom+        +
           +
1+       ÿ
                                              .cursor = zcmd
                                              .help   = xmitiph0
                                    ÿ
es y,Yes n,&z N,&z *,*)                          )Proc
                                                  ver (&to,nb)
                                                  iÿ
                                                         ver (&file,nb)
                                                      if (&sigdsn NE &Z)
                                                         ver (&sigÿ
)                                                         if (&file = +)
                                                              &file = ?
                                                          &mur = trans(t
rÿ
 sigdsn mur import prior sens receipt) Profile                Vput (form
ss zipmeth filename) Profile                                 )Help
                ÿ
  panel(xmitipx1)                                                 Field(
  panel(xmitipx2)                                                 Field(
  panel(xmitipx3)              ÿ
      panel(xmitipx4)                                                 Fi
      panel(xmitipx5)                                                 Fi
)     panel(xmitipx6)                         ÿ
replyto)  panel(xmitipx7)
receipt)  panel(xmitipx8)
sigdsn)   panel(xmitipx9)                                    ÿ

eld(filename) panel(xmitipxj)
eld(filedesc) panel(xmitipxb)
Field(mur)      ÿ
  Field(import)   panel(xmitipxe)
  Field(prior)    panel(xmitipxf)
  Field(senÿ
      Field(format)   panel(xmitipxh)
      Field(zippass)  panel(xmitipxi)
      Field(zipmeth)  paneÿ
          Field(left)     panel(xmitipxk)
          Field(right)    panel(xmitipxk)
          Field(top)      panel(xmitipxk)+
              Field(bottom)   panel(xmiÿ
                 )End
                 {
                                             )Attr Defÿ
                                               /* _ type( input) intens(
ps(on ) just(left )               */            ÿ
caps(off) just(asis ) color(white)                  ~ type(text) inteÿ
caps(off) just(asis ) color(turq)                     } type(text) inten
caps(off) just(asis ) color(turq)                       hilite(reÿ
                                                        % type(text) int
)   ÿ
)                                                      )Body  Expand(\\)
  ÿ
ialog Tutorial% -\-ÿ
                                                           %
                   ÿ
                                  ÿ
--------------------------------------------------------------#)Area Hel
                                    ÿ
alog provides a simple interface to the XMITIP apÿ
 application is a tool that can be used to send electronic mail    `  me
nd`files as attachments to internet e-mail addresses.ÿ
                                                                ÿ
 up and down in this tutorial use the Left (Up) and Right (Down)       `
 function keys (PF10 and PF11).                                       ÿ



is fielÿ
By entering a ÿ
  allowing the user to select one or more addresses.
                        ÿ
 ` }Note` Valid Address formaÿ
ipt`        first.last@domain.com
   `        "first last" <first.last@domaÿ
     `        'first last' <first.last@domaiÿ
       `
       ` ~Message DSN       ===>                          ÿ
         `                                                 +
           `  This field defines the dataset name of a fiÿ
ssage to     `  be sent in the e-mail.  Use of~*`will cause the ISPF Edi
 be opened     `  on an empty dataset and allow you to enter the text of
message.         `  Blank will result in no message to be sent but will~
e`that the         `  Attachment DSN be specified.
                   `
            ÿ
       ÿ
                       ` ~CC Address        ===>
                       `     ÿ
                      ÿ
                           `
                           `  Use of a + will ÿ
 allow the entry of          `  up toÿ
                               `
                               `  By entering a ? in this fieldÿ
ble will be displayed            `  allowing the useÿ
dresses. This table will only      `  be displayed once even if you spec
r the To, Cc, and Bcc.             `
ÿ
                                       `
                                       `  This defines the 'blind carbon
-mail address    ÿ
  ÿ
anel that will allow the entry of          `  up to 12 bcc addresses
                                  ÿ
                 ÿ
a selection table will be displayed            `  allowing the user to s
e or more addresses. This table will only      `  bÿ
u specify ? for the To, Cc, and ÿ
                                                   ` ~From Address
                                                   `                ÿ
                                               ÿ
address to be used (e.g. your e-mail address)          `
                                                         ~Reply-To Addre
     ÿ
                                                           `  Defines an
 to which any replies to this e-mail will be sent          `  and differ
he FROM address.      ÿ
                                                                 ~Receip
ess                                                              `
                                         +
 address to which a e-mail will be sentÿ
 NOTE thatÿ
                                                                       `
N           ===>                                        ÿ
                         ÿ
is defines an optional dataset from which a signature block will be
ded to the message.
                                        ÿ
 ~Subject           ===>

  This is ÿ
   `
   ` ~Attachment DSN    ===>
   `                       ÿ
       `  This is optional (unless you do not code a Message DSN) and de
       `  a dataset to be sent as an attachment.
       `                                    ÿ
     ÿ
f          `  additional attachment datasets and their attributes (see s
           `                                                 ÿ
             `  A daÿ
nd open        `  ISPF Edit on it so you can create your own attachment.
 for           `  HTML and RTF attachments that you want to work with.
                 `                 ÿ
                   ` ~Attachment Name   ===>
                   `
               ÿ
 the attachment        `  file.  It is the name that will appear in the
ts e-mail for          `  the attachment. (e.g. report.rtf)
                       `        ÿ
                           ` ~Attachment Desc   ===>
                           `
                           `  This is optional anÿ
ÿ
                               `  syntax is:   description or file-name/
ion                            `  e.g.         monthly-report     ÿ
               +
             ÿ
                                     ` ~Murphy            ===>
 No  +
   ÿ
 Edward A. Murphy, Jr and others.          `
                                           ` ~Importance        ===>
High, Normal, Low   ÿ
                                               `  Defines the importance
message.  Some e-mail systems use this to      `  flag the message in th
                                     ÿ
                                                   ` ~Sensitivity
        Private, Personal, Confidential, Company   `
                                                   `  ÿ
y of the message.                                      `
                                                       ` ~Format
                                                       `               ÿ
        ÿ
s how you want the Attachment Dataset to be formatted      `  for sendin
                                                           `
        ÿ
 to enter a ? to have a dialog popup to prompt for the         `  format
tion.  It will then construct the format keyword and           `  update
iable on the panel for yoÿ
                                                                   ` ~Ma
in inches (e.g. 8.5 for 8 1/2 inches)                              ` ~
==>       Right ===>        Top ===>      ÿ
                                                                       `
ou specify a Report of Landscape or Portrait then this option will     `
u define the margins for your report.                      ÿ

PMETHOD ===>

Thiÿ
  the ZIP utlity.

      For PKZÿ
   `          Normal, Fast, Maximum, Store, Superfast
   `
   `      For ISPZIP this optiÿ
       `                       ÿ
         ` ~ZIPPASS ===>
         `                                       +
           `  This field is a password that wiÿ
               `  for all the zip file attachments.
               `
               `      For PKZIP the supported value may be upÿ
s.                 `
                   `      For ISPZIP this option is not supported.
                   ` ~
   ÿ
                         .cursor = zcmd
                       )Proc
           ÿ
                           {
                                                       ` type(text) inte
 caps(off) just(asis ) colÿ
h) caps(off) just(asis ) color(turq)                     %ÿ
igh)                                                       )Body Window(
pand(\\)                                 ÿ
ins%-\-\-                                                    +
                                                               ~Margins
 Right, Top~and`Bottom                                  ÿ
                                                                 ~Define
ms of inchesT : 1 = 1 inch .5 = 1/2 inch                           )Init
                                                                   )End>
                                                                     


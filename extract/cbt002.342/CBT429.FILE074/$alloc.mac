         MACRO
&NAME    $ALLOC   &DSECT=NO,&CSECT=YES,&CONTDS=NO
*----------------------------------------------------------------------
*
*        BINARY ZEROS IN ANY FIELD WILL CAUSE THAT FIELD TO BE
*        IGNORED FOR THE ALLOCATION/UN-ALLOCATION
*
*        VALID PARAMETER FORMATS ARE SHOWN BELOW
*
*----------------------------------------------------------------------
         AIF   ('&DSECT' EQ 'YES').CHKCONT
&NAME    DS    0D
*    WORK AREA AND ERROR RETURN CODES
DYNWRK   DC    D'0'             DOUBLE WORD WORK AREA
DYNLEN   DC    AL1(DYNLL)       LENGTH OF THIS SECTION
DYNR15   DC    CL4' '           R15 FROM SVC99
DYNERR   DC    CL4' '           ERROR CODE
DYNINFO  DC    CL4' '           INFO CODE
*    DYNAMIC ALLOCATION PARAMETERS
DYNTYPE  DC    CL1' '    1=ALLOC 2=UNALLOC 3=CONCAT 4=DECONCAT
DYNDDNM  DC    XL8'00'   CHAR - DDNAME
DYNDSN   DC    XL44'00'  CHAR - DSNAME
DYNMBR   DC    XL8'00'   CHAR - MEMBER
*
DYNDISP1 DC    XL1'00'   HEX  - DATA SET STATUS
DYNOLD   EQU   X'01'     OLD
DYNMOD   EQU   X'02'     MOD
DYNNEW   EQU   X'04'     NEW
DYNSHR   EQU   X'08'     SHR
*
DYNDISP2 DC    XL1'00'   HEX  - NORMAL DISPOSITION
DYNDISP3 DC    XL1'00'   HEX  - CONDITIONAL DISPOSTION
DYNUNCAT EQU   X'01'     UNCATLG
DYNCAT   EQU   X'02'     CATLG
DYNDEL   EQU   X'04'     DELETE
DYNKEEP  EQU   X'08'     KEEP
*
DYNBTC   DC    XL3'00'   CHAR - 'BLK'   'TRK'   'CYL'   ALLOCATION
*
DYNPRIM  DC    XL3'00'   HEX  - PRIMARY ALLOCATION IN ABOVE UNITS
DYNSEC   DC    XL3'00'   HEX  - SECONDARY ALLOCATION IN ABOVE UNITS
DYNDIR   DC    XL3'00'   HEX  - DIRECTORY BLOCKS
*
DYNRLSE  DC    XL1'00'   ANY  - RELEASE OPTION SELECTED IF NON-ZERO
DYNROUND DC    XL1'00'   ANY  - ROUND OPTION SELECTED IF NON-ZERO
*
DYNVOLSR DC    XL6'00'   CHAR - VOLSER
DYNUNIT  DC    XL8'00'   CHAR - UNIT NAME
*
DYNSYSOU DC    XL1'00'   CHAR - SYSOUT CLASS
DYNSPGNM DC    XL8'00'   CHAR - SYSOUT WRITER NAME
*
DYNFREE  DC    XL1'00'   ANY  - FREE=CLOSE SELECTED IF NON-ZERO
*
DYNTERM  DC    XL1'00'   ANY  - TSO TERMINAL ALLOCATION
*
DYNBLKSZ DC    XL2'00'   HEX  - BLKSIZE
DYNLRECL DC    XL2'00'   HEX  - LRECL
*
DYNRECFM DC    XL1'00'   HEX  - RECFM
DYNM     EQU   X'02'     M    - MACHINE CHARACTER
DYNA     EQU   X'04'     A    - ASA CHARACTER
DYNS     EQU   X'08'     S    - STANDARD OR SPANNED
DYNB     EQU   X'10'     B    - BLOCKED
DYNT     EQU   X'20'     D    - VARIABLE ASCII   T - TRACK OVERFLOW
DYNF     EQU   X'80'     F    - FIXED
DYNFA    EQU   X'84'     FA   - FIXED ASA
DYNFB    EQU   X'90'     FB   - FIXED BLOCKED
DYNFBA   EQU   X'94'     FBA  - FIXED BLOCKED ASA
DYNV     EQU   X'40'     V    - VARIABLE
DYNVA    EQU   X'44'     VA   - VARIABLE ASA
DYNVB    EQU   X'50'     VB   - VARIABLE BLOCKED
DYNVBA   EQU   X'54'     VBA  - VARIABLE BLOCKED ASA
DYNVBS   EQU   X'58'     VBS  - VARIABLE BLOCKED SPANNED
DYNU     EQU   X'C0'     U    - UNDEFINED RECORDS
*
DYNDUMMY DC    XL1'00'   ANY  - DD DUMMY
DYNUNALC DC    XL1'00'   ANY  - UN-ALLOC EVEN IF PERM ATTRIBUTE IS ON
*
DYNDEST  DC    XL8'00'   CHAR - SYSOUT DESTINATION ID - R0 - R255
DYNFORM  DC    XL4'00'   CHAR - SYSOUT FORM ID
DYNCOPYS DC    XL1'00'   HEX  - NUMBER OF COPIES  01 - FF
DYNFCB   DC    XL4'00'   CHAR - FCB IMAGE NAME
*
DYNRTDD  DC    XL8'00'   ANY  - NON-ZERO IN BYTE 1 INDICATES DDNAME TO
*                               BE RETURNED, IT WILL BE RETURNED HERE
DYNSPFRM DC    XL1'00'   HEX  - (SEE EQUATES)
DYNALX   EQU   X'02'     DIFFERENT AREAS OF CONTIGUOUS SPACE
DYNMXIG  EQU   X'04'     MAXIMUM CONTIGUOUS SPACE
DYNCONTG EQU   X'08'     CONTIGUOUS SPACE
*
DYNPRIVT DC    XL1'00'   ANY  - PRIVATE VOLUME REQUEST
DYNDCBDS DC    XL44'00'  CHAR - DSNAME TO BE USED FOR DCB ATTRIBUTES
*
DYNDSORG DC    XL2'00'   HEX  - DSORG
DYNPO    EQU   X'0200'   PDS
DYNDA    EQU   X'2000'   BDAM
DYNPS    EQU   X'4000'   SEQ
*
DYNEXPDT DC    XL5'00'   CHAR - EXPIRATION DATE YYMMM
DYNRTVOL DC    XL1'00'   ANY  - RETURN VOLSER
DYNRTDSN DC    XL1'00'   ANY  - RETURN DSNAME
DYNREMOV DC    XL1'00'   ANY  - REMOVE IN-USE ATTRIBUTE
DYNPERMA DC    XL1'00'   ANY  - ALLOC WITH PERM ATTRIBUTE
DYNHOLD  DC    XL1'00'   ANY  - PLACE SYSOUT ON HOLD
DYNNHOLD DC    XL1'00'   ANY  - CANCEL SYSOUT HOLD ON UN-ALLOC
DYNBUFNO DC    XL1'00'   HEX  - NUMBER OF BUFFERS FOR DCB
*
DYNINOUT DC    XL1'00'   HEX  - ONLY OPEN FOR INPUT OR OUTPUT
DYNIN    EQU   X'40'     INPUT ONLY
DYNOUT   EQU   X'80'     OUTPUT ONLY
*
DYNRETPD DC    XL2'00'   HEX  - RETENTION PERIOD - DAYS
*
DYNSSNM  DC    CL4' '    CHAR - SUB-SYSTEM NAME
DYNSSPR1 DC    CL8' '    CHAR - SUB-SYSTEM PARM1
DYNSSPR2 DC    CL8' '    CHAR - SUB-SYSTEM PARM2
*
DYNVLCNT DC    XL1'00'   HEX  - VOLUME COUNT (01 - FF)
*
DYNEND   EQU   *
*
DYNEPA   DC    F'0'
DYNLL    EQU   DYNEND-DYNWRK    LENGTH OF THIS SECTION
         AGO   .DONE
.CHKCONT AIF   ('&CONTDS' EQ 'YES').DS
         DSECT
.DS      ANOP
&NAME    DS    0D
*    WORK AREA AND ERROR RETURN CODES
DYNWRK   DS    D                DOUBLE WORD WORK AREA
DYNLEN   DS    AL1              LENGTH OF THIS SECTION
DYNR15   DS    CL4              R15 FROM SVC99
DYNERR   DS    CL4              ERROR CODE
DYNINFO  DS    CL4              INFO CODE
*    DYNAMIC ALLOCATION PARAMETERS
DYNTYPE  DS    CL1       1=ALLOC 2=UNALLOC 3=CONCAT 4=DECONCAT
DYNDDNM  DS    XL8       CHAR - DDNAME
DYNDSN   DS    XL44      CHAR - DSNAME
DYNMBR   DS    XL8       CHAR - MEMBER
*
DYNDISP1 DS    XL1       HEX  - DATA SET STATUS
DYNOLD   EQU   X'01'     OLD
DYNMOD   EQU   X'02'     MOD
DYNNEW   EQU   X'04'     NEW
DYNSHR   EQU   X'08'     SHR
*
DYNDISP2 DS    XL1       HEX  - NORMAL DISPOSITION
DYNDISP3 DS    XL1       HEX  - CONDITIONAL DISPOSTION
DYNUNCAT EQU   X'01'     UNCATLG
DYNCAT   EQU   X'02'     CATLG
DYNDEL   EQU   X'04'     DELETE
DYNKEEP  EQU   X'08'     KEEP
*
DYNBTC   DS    XL3       CHAR - 'BLK'   'TRK'   'CYL'   ALLOCATION
*
DYNPRIM  DS    XL3       HEX  - PRIMARY ALLOCATION IN ABOVE UNITS
DYNSEC   DS    XL3       HEX  - SECONDARY ALLOCATION IN ABOVE UNITS
DYNDIR   DS    XL3       HEX  - DIRECTORY BLOCKS
*
DYNRLSE  DS    XL1       ANY  - RELEASE OPTION SELECTED IF NON-ZERO
DYNROUND DS    XL1       ANY  - ROUND OPTION SELECTED IF NON-ZERO
*
DYNVOLSR DS    XL6       CHAR - VOLSER
DYNUNIT  DS    XL8       CHAR - UNIT NAME
*
DYNSYSOU DS    XL1       CHAR - SYSOUT CLASS
DYNSPGNM DS    XL8       CHAR - SYSOUT WRITER NAME
*
DYNFREE  DS    XL1       ANY  - FREE=CLOSE SELECTED OF NON-ZERO
*
DYNTERM  DS    XL1       ANY  - TSO TERMINAL ALLOCATION
*
DYNBLKSZ DS    XL2       HEX  - BLKSIZE
DYNLRECL DS    XL2       HEX  - LRECL
*
DYNRECFM DS    XL1       HEX  - RECFM
DYNM     EQU   X'02'     M    - MACHINE CHARACTER
DYNA     EQU   X'04'     A    - ASA CHARACTER
DYNS     EQU   X'08'     S    - STANDARD OR SPANNED
DYNB     EQU   X'10'     B    - BLOCKED
DYNT     EQU   X'20'     D    - VARIABLE ASCII   T - TRACK OVERFLOW
DYNF     EQU   X'80'     F    - FIXED
DYNFA    EQU   X'84'     FA   - FIXED ASA
DYNFB    EQU   X'90'     FB   - FIXED BLOCKED
DYNFBA   EQU   X'94'     FBA  - FIXED BLOCKED ASA
DYNV     EQU   X'40'     V    - VARIABLE
DYNVA    EQU   X'44'     VA   - VARIABLE ASA
DYNVB    EQU   X'50'     VB   - VARIABLE BLOCKED
DYNVBA   EQU   X'54'     VBA  - VARIABLE BLOCKED ASA
DYNVBS   EQU   X'58'     VBS  - VARIABLE BLOCKED SPANNED
DYNU     EQU   X'C0'     U    - UNDEFINED RECORDS
*
DYNDUMMY DS    XL1       ANY  - DD DUMMY
DYNUNALC DS    XL1       ANY  - UN-ALLOC EVEN IF PERM ATTRIBUTE IS ON
*
DYNDEST  DS    XL8       CHAR - SYSOUT DESTINATION ID - R0 - R255
DYNFORM  DS    XL4       CHAR - SYSOUT FORM ID
DYNCOPYS DS    XL1       HEX  - NUMBER OF COPIES  01 - FF
DYNFCB   DS    XL4       CHAR - FCB IMAGE NAME
*
DYNRTDD  DS    XL8       ANY  - NON-ZERO IN BYTE 1 INDICATES DDNAME TO
*                               BE RETURNED, IT WILL BE RETURNED HERE
DYNSPFRM DS    XL1       HEX  - (SEE EQUATES)
DYNALX   EQU   X'02'     DIFFERENT AREAS OF CONTIGUOUS SPACE
DYNMXIG  EQU   X'04'     MAXIMUM CONTIGUOUS SPACE
DYNCONTG EQU   X'08'     CONTIGUOUS SPACE
*
DYNPRIVT DS    XL1       ANY  - PRIVATE VOLUME REQUEST
DYNDCBDS DS    XL44      CHAR - DSNAME TO BE USED FOR DCB ATTRIBUTES
*
DYNDSORG DS    XL2       HEX  - DSORG
DYNPO    EQU   X'0200'   PDS
DYNDA    EQU   X'2000'   BDAM
DYNPS    EQU   X'4000'   SEQ
*
DYNEXPDT DS    XL5       CHAR - EXPIRATION DATE YYMMM
DYNRTVOL DS    XL1       ANY  - RETURN VOLSER
DYNRTDSN DS    XL1       ANY  - RETURN DSNAME
DYNREMOV DS    XL1       ANY  - REMOVE IN-USE ATTRIBUTE
DYNPERMA DS    XL1       ANY  - ALLOC WITH PERM ATTRIBUTE
DYNHOLD  DS    XL1       ANY  - PLACE SYSOUT ON HOLD
DYNNHOLD DS    XL1       ANY  - CANCEL SYSOUT HOLD ON UN-ALLOC
DYNBUFNO DS    XL1       HEX  - NUMBER OF BUFFERS FOR DCB
*
DYNINOUT DS    XL1       HEX  - ONLY OPEN FOR INPUT OR OUTPUT
DYNIN    EQU   X'40'     INPUT ONLY
DYNOUT   EQU   X'80'     OUTPUT ONLY
*
DYNRETPD DS    XL2       HEX - RETENTION PERIOD - DAYS
*
DYNSSNM  DS    CL4       CHAR - SUB-SYSTEM NAME
DYNSSPR1 DS    CL8       CHAR - SUB-SYSTEM PARM1
DYNSSPR2 DS    CL8       CHAR - SUB-SYSTEM PARM2
*
DYNVLCNT DS    XL1       HEX  - VOLUME COUNT (01 - FF)
*
DYNEND   EQU   *
*
DYNEPA   DS    F
DYNLL    EQU   DYNEND-DYNWRK    LENGTH OF THIS SECTION
         AIF   ('&CSECT' EQ 'NO').DONE
&SYSECT  CSECT
.DONE    ANOP
.*---------------------------------------------------------------------
.*---------------------------------------------------------------------
.*
.*       FREEWARE: THIS MACRO IS DISTRIBUTED ON AN AS-IS BASIS
.*                 WITHOUT WARRANTY, EITHER EXPRESSED OR IMPLIED, BY:
.*
.*                 THE NATIONAL SYSTEMS PROGRAMMERS ASSOCIATION (NASPA)
.*                 P.O. BOX 21525
.*                 GREENFIELD, WI 53221
.*
.*
.*       MACRO WRITTEN BY:
.*
.*                 PRODUCTIVITY SYSTEMS, INC.
.*                 MILWAUKEE, WI
.*
.*---------------------------------------------------------------------
.*
.*    THIS MACRO HAS MET A BASIC SET OF PROGRAMMING AND
.*    DOCUMENTATION STANDARDS, BUT HAS NOT BEEN PROGRAM TESTED IN ANY
.*    FORMAL FASHION BY NASPA. THE USER IS EXPECTED TO MAKE THE FINAL
.*    EVALUATION OF THE USE OF THIS MACRO IN THEIR ENVIRONMENT.
.*
.*    NASPA MAKES NO WARRANTY, EXPRESSED OR IMPLIED, OF THE FITNESS
.*    FOR A PARTICULAR PURPOSE AS RELATES TO THE DOCUMENTATION,
.*    FUNCTION, RESULTS, OR PERFORMANCE OF THIS MACRO.
.*
.*    IMPLEMENTATION AND USE OF THIS MACRO CONSTITUTES A RELEASE
.*    FROM LIABILITY OF NASPA FOR ANY PROBLEMS ARISING FROM THE USE OF
.*    THIS MACRO AT THE USER'S INSTALLATION.
.*
.*    THIS MACRO IS MADE AVAILABLE BY NASPA WITHOUT CHARGE.
.*    RECIPIENTS ARE FREE TO MAKE THIS MACRO AVAILABLE TO OTHERS IN
.*    LIKE MANNER, PROVIDED THIS DISCLAIMER IS KEPT INTACT.  IT MAY
.*    NOT BE SOLD, TRADED, OR EXCHANGED FOR CASH, SERVICES, OR AS AN
.*    INCENTIVE FOR SERVICES AND/OR OTHER PURCHASES, NOR MAY IT BE
.*    INTEGRATED INTO ANY PROGRAM FOR SUCH USE.
.*
.*---------------------------------------------------------------------
.*---------------------------------------------------------------------
         MEND

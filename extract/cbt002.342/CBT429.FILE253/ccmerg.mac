/* REXX PRODXREF CC MERGE EXEC */
PARSE UPPER ARG XCCDSNAME;
"EXECIO * DISKR CCSCAN   (STEM CCSCAN. FINIS";
DO K = 1 TO CCSCAN.0;
     PARSE VAR CCSCAN.K CCMEM CCACCESS CCFNDD;
     DROP CCSCAN.K;
     CCMEM=STRIP(CCMEM);
     CCACCESS=STRIP(CCACCESS);
     CCFNDD=STRIP(CCFNDD);
     IF CCACCESS="D" × CCACCESS="E" × CCACCESS="M" ,
      THEN DO;
         IF SYMBOL('CCDD.CCMEM')="VAR" THEN ,
             CCDD.CCMEM=CCDD.CCMEM CCACCESS CCFNDD; /* DDNAME */
           ELSE ,
             CCDD.CCMEM=CCACCESS CCFNDD; /* DDNAME */
         END;
     ELSE DO;
         IF SYMBOL('CCDS.CCMEM')="VAR" THEN ,
             CCDS.CCMEM=CCDS.CCMEM CCACCESS CCFNDD; /* DATASET */
           ELSE ,
             CCDS.CCMEM=CCACCESS CCFNDD; /* DATASET */
         END;
END;
DROP CCSCAN.0;
"EXECIO * DISKR XREFFILE (STEM XREFFILE. FINIS";
DO I = 1 TO XREFFILE.0;
  PARSE VAR XREFFILE.I JOBNAME 9 JOBCLASS 10 EPROCSN 18 PROCNAME ,
      26 EPGMSN 34 EXECPGM 42 STEPPROC 45 STEPJOB ,
      48 DDNAME 56 DSNAME 100 MEMBER 108 DISP 111 ACCESS;
  IF  DSNAME=" " THEN ITERATE I;
  JOBNAME=STRIP(JOBNAME);
  PROCNAME=STRIP(PROCNAME);
  EPROCSN=STRIP(EPROCSN);
  EPGMSN=STRIP(EPGMSN);
  DDNAME=STRIP(DDNAME);
  DSNAME=STRIP(DSNAME);
  MEMBER=STRIP(MEMBER);
  DISP=STRIP(DISP);
  ACCESS =STRIP(ACCESS);
  IF MEMBER=" " × MEMBER="" × ,
     DSNAME^=XCCDSNAME × ,
     DATATYPE(MEMBER,"W") THEN ITERATE I;
  IF SYMBOL('CCDD.MEMBER')="VAR" THEN DO;
     CTR = WORDS(CCDD.MEMBER);
     DO J = 1 TO CTR BY 2;
       FAX=WORD(CCDD.MEMBER,J);
       FDN=WORD(CCDD.MEMBER,J+1);
       FFDD.JOBNAME.EPGMSN.PROCNAME.EPROCSN.FDN=FAX;
     END;
     END;
END;
XOUT=1;
DO I = 1 TO XREFFILE.0;
  PARSE VAR XREFFILE.I JOBNAME 9 JOBCLASS 10 EPROCSN 18 PROCNAME ,
      26 EPGMSN 34 EXECPGM 42 STEPPROC 45 STEPJOB ,
      48 DDNAME 56 DSNAME 100 MEMBER 108 DISP 111 ACCESS;
  JOBNAME=STRIP(JOBNAME);
  PROCNAME=STRIP(PROCNAME);
  EPROCSN=STRIP(EPROCSN);
  EPGMSN=STRIP(EPGMSN);
  DDNAME=STRIP(DDNAME);
  DSNAME=STRIP(DSNAME);
  MEMBER=STRIP(MEMBER);
  DISP=STRIP(DISP);
  ACCESS =STRIP(ACCESS);
  IF DSNAME=XCCDSNAME THEN DO;
       XREFOUT.XOUT = XREFFILE.I; /* DUP RECORD UNCHANGED */
       XOUT = XOUT + 1;
       IF SYMBOL('CCDS.MEMBER')="VAR" THEN DO;
          CTR = WORDS(CCDS.MEMBER);
          DO J = 1 TO CTR BY 2;
            FAX=WORD(CCDS.MEMBER,J);
            SELECT;
              WHEN (FAX="F") THEN FAX="INPUT ";
              WHEN (FAX="G") THEN FAX="OUTPUT";
              WHEN (FAX="H") THEN FAX="DELETE";
              WHEN (FAX="I") THEN FAX="ALLOC ";
              WHEN (FAX="J") THEN FAX="ALLOC ";
              WHEN (FAX="K") THEN FAX="ALLOC ";
              WHEN (FAX="L") THEN FAX="ALLOC ";
              WHEN (FAX="N") THEN FAX="VERIFY";
              WHEN (FAX="O") THEN FAX="EXPORT";
              WHEN (FAX="P") THEN FAX="RESTOR";
              WHEN (FAX="Q") THEN FAX="RESTOR";
              WHEN (FAX="R") THEN FAX="RESTOR";
              WHEN (FAX="Y") THEN FAX="YYYYYY"; /* DYL280 PGM */
              WHEN (FAX="Z") THEN FAX="ZZZZZZ"; /* DB2 IKJEF PGM */
              OTHERWISE FAX="??????";
            END;
  IF FAX^="ZZZZZZ" & FAX^="YYYYYY" THEN DO; /* NOT DB2/DYL CALL */
             FDS=LEFT(WORD(CCDS.MEMBER,J+1),44);
             TEMP=XREFFILE.I;
             TEMP=OVERLAY(FDS,TEMP,56,44);
             TEMP=OVERLAY(FAX,TEMP,111,6);
             TEMP=OVERLAY("   ",TEMP,108,3); /* NO DISP ON GENNED DS*/
             XREFOUT.XOUT = TEMP; /* DUP RECORD */
             XOUT = XOUT + 1;
            END;
           ELSE IF FAX="YYYYYY" THEN DO; /* DYL PGM CALL */
             FDS=LEFT(WORD(CCDS.MEMBER,J+1),8);
             TEMP=XREFFILE.I;
             TEMP=OVERLAY(FDS,TEMP,34,8);
             TEMP=OVERLAY("   ",TEMP,108,3); /* NO DISP ON GENNED DB*/
       TEMP=OVERLAY("DYLPGM",TEMP,111,6); /* IND DYL INTERNAL PGM*/
             XREFOUT.XOUT = TEMP; /* DUP RECORD */
             XOUT = XOUT + 1;
            END;
           ELSE DO; /* DB2 PGM CALL */
             FDS=LEFT(WORD(CCDS.MEMBER,J+1),8);
             TEMP=XREFFILE.I;
             TEMP=OVERLAY(FDS,TEMP,34,8);
             TEMP=OVERLAY("   ",TEMP,108,3); /* NO DISP ON GENNED DB*/
       TEMP=OVERLAY("DB2PGM",TEMP,111,6); /* IND DB2 INTERNAL PGM*/
             XREFOUT.XOUT = TEMP; /* DUP RECORD */
             XOUT = XOUT + 1;
            END;
          END;
         END;
       ITERATE I;
       END;
  IF ACCESS ^= " " & ACCESS^="" THEN DO;
       XREFOUT.XOUT = XREFFILE.I; /* DUP RECORD UNCHANGED */
       XOUT = XOUT + 1;
       ITERATE I;
       END;
IF SYMBOL('FFDD.JOBNAME.EPGMSN.PROCNAME.EPROCSN.DDNAME')="VAR" ,
       THEN DO;
          FAX=FFDD.JOBNAME.EPGMSN.PROCNAME.EPROCSN.DDNAME;
            SELECT;
              WHEN (FAX="D") THEN FAX="INPUT ";
              WHEN (FAX="E") THEN FAX="OUTPUT";
              WHEN (FAX="M") THEN FAX="VERIFY";
              OTHERWISE FAX="??????";
            END;
            TEMP=XREFFILE.I;
            TEMP=OVERLAY(FAX,TEMP,111,6);
            XREFOUT.XOUT = TEMP; /* DUP RECORD */
            XOUT = XOUT + 1;
            ITERATE I;
          END;
    XREFOUT.XOUT = XREFFILE.I; /* DUP RECORD UNCHANGED */
    XOUT = XOUT + 1;
END;
"EXECIO * DISKW XREFOUT (STEM XREFOUT. FINIS";
EXIT 0;

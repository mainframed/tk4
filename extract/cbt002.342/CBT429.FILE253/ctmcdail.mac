PROC 0 DATE1() DATE2()                      +
       CTMSLIB(SYSS.CTMO.V410.SCHEDULE) +
       CTMCAL(SYSS.IOA.V410.CAL)       +
       CTMSMEM() DEBUG                      +
       CTMSJOB()                            +
       CTMGRP()                             +
       FORCE()                              +
       DBPREFA(SYSS.IOA)                   +
       DBPREFM(SYSS.CTMO)                   +
       DBVERA(V410)                     +
       DBVERM(V410)                     +
       LANG()                         +
       LOADLIB(SYS1.IOA.V410.LOAD)                   +
       NOALC
 CONTROL MAIN NOLIST NOCONLIST NOSYMLIST NOMSG
 IF &DEBUG=DEBUG THEN CONTROL MAIN LIST CONLIST SYMLIST MSG
 /*   WARNING:   BE VERY CAREFULL WHEN CHANGING THE CLIST !
 /*              FREE  M U S T  BE DONE TO DAJOB,DAJOBI AND DACAL.
 /*
LSTDS: LISTDSI DACAL FILE PREALLOC
SET  OLDDACAL = &SYSDSNAME
 /*
FREE DD(DAJOB,DAJOBI,DACAL)
 IF &NOALC=NOALC THEN GOTO NOALLOC
FREE  DD(DACHK,DACKPT,DALIB,DALOG,DAOUT,PRTDBG,SYSPRINT)
ALLOC DD(DACHK)    NEW TRACKS SP(1 1)
ALLOC DD(DACKPT)   DA('&DBPREFM..&DBVERM..CKP') SH
ALLOC DD(DALOG)    DA('&DBPREFA..&DBVERA..LOG') SH
ALLOC DD(DAOUT)    DA(*)
ALLOC DD(PRTDBG)   DA(*)
ALLOC DD(SYSPRINT) DA(*)
NOALLOC:+
ALLOC DD(DACAL)    DA('&CTMCAL') SH
 /*
FREE DD(DAALOCIN)
ALLOC DD(DAALOCIN) DSN('SYSM.IOA.V410.PARM(ALCADDCD)')  SHR
CALL '&LOADLIB(IOALOC)' 'ALLOC'
SET RCODE = &LASTCC
FREE DD(DAALOCIN)
IF &RCODE NE 0 THEN EXIT CODE(&RCODE)
 /*
OPENFILE DACHK OUTPUT
SET DACHK=&STR(+
&DATE2           &DATE1 &DATE1            &DATE1 &DATE1           &DATE1
PUTFILE DACHK
CLOSFILE DACHK
 IF '&CTMSJOB'='1'  THEN GOTO NOJOBNM
GRPNM:+
ALLOC DD(DAJOBI)   DA('&CTMSLIB(&CTMSMEM)') SH
IF &LASTCC ^= 0 THEN +
  DO
    SET RCODE = &LASTCC
    WRITE CTMCDAIL:  ALLOCATION ERROR IN DAJOBI
    WRITE CTMCDAIL:  PLEASE LOGOFF AND LOGON AGAIN
    WRITENR       HIT ANY KEY TO CONTINUE
    READ A
    EXIT CODE(&RCODE)
  END
ALLOC DD(DAJOB)    NEW  DELETE TRACKS SP(1 3)
IF &LASTCC ^= 0 THEN +
  DO
    SET RCODE = &LASTCC
    WRITE CTMCDAIL:  ALLOCATION ERROR IN DAJOB
    WRITE CTMCDAIL:  PLEASE LOGOFF AND LOGON AGAIN
    WRITENR       HIT ANY KEY TO CONTINUE
    READ A
    EXIT CODE(&RCODE)
  END
 /*  WARNING:   BE VERY CAREFULL WHEN CHANGING THE CLIST !
 /*             CTMTJRQ OVERRIDES CHARACTERISTICS OF THE "DAJOB" D.S. !
CALL '&LOADLIB(CTMTJRQ)' '&CTMSJOB,&CTMGRP'
GOTO REQJOBS
NOJOBNM:+
IF &STR('&CTMGRP') = '1'  THEN GOTO NOGRPNM
GOTO GRPNM
NOGRPNM:+
ALLOC DD(DAJOB) DA('&CTMSLIB(&CTMSMEM)') SH
REQJOBS:+
IF '&FORCE' NE 'YES'  THEN GOTO NOFORCE
CALL '&LOADLIB(CTMJOB)' 'FORCE'
GOTO FREEDD
NOFORCE:+
CALL '&LOADLIB(CTMJOB)'
GOTO FREEDD
FREEDD:+
FREE DD(DAJOBI,DAJOB)
IF '&OLDDACAL' = '' THEN GOTO NODEALL
IF '&OLDDACAL' = '&CTMCAL' THEN GOTO NODEALL
FREE DD(DACAL)
ALLOC DD(DACAL) DA('&OLDDACAL')
NODEALL:+
END

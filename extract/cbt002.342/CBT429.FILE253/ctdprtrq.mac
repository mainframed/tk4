PROC 0 DEBUG DATEFMT(USA) +
         STEPLIB(SYS1.IOA.V410.LOAD) +
         LANG() +
         OLPREFA(SYSS.IOA) +
         OLPREFD(SYSS.CTDO) +
         OLVERA(V410) +
         OLVERD(V310) +
         PGMID(CTDPRQ)
ISPEXEC CONTROL ERRORS RETURN
CONTROL MAIN NOLIST NOCONLIST NOSYMLIST NOMSG
IF &DEBUG=DEBUG THEN CONTROL MAIN LIST CONLIST SYMLIST MSG
ISPEXEC VGET (ZDAY,ZMONTH,ZYEAR)
SET YY=&ZYEAR
SET MM=&ZMONTH
SET DD=&ZDAY
SET &NOALC=&STR()
SET MM=&SUBSTR(2:3,&EVAL(&MM+100))
SET DD=&SUBSTR(2:3,&EVAL(&DD+100))
SET CTDSLIB=&STR(&OLPREFD..&OLVERD..PRTMIS)
SET CTDCAL=&STR(&OLPREFA..&OLVERA..CAL)
SET CTDSMIS=&STR()
SET CTDSCAT=&STR()
SET FOR=NO
REDISP:+
IF &DATEFMT=JPN THEN +
      ISPEXEC DISPLAY PANEL(CTDPPRQJ)
      ELSE  +
        IF &DATEFMT=USA THEN +
              ISPEXEC DISPLAY PANEL(CTDPPRQA)
              ELSE  ISPEXEC DISPLAY PANEL(CTDPPRQW)
IF &RESP = END THEN EXIT
SET FORCE=&FOR
SET ZYEAR=&YY
SET ZMONTH=&MM
SET ZDAY=&DD
SET ZDAY=&SUBSTR(2:3,&EVAL(&ZDAY+100))
SET ZMONTH=&SUBSTR(2:3,&EVAL(&ZMONTH+100))
IF &DATEFMT=JPN THEN +
  %CTDUPAMF CTDSLIB('&CTDSLIB') +
     CTDCAL('&CTDCAL') +
     CTDSMIS(&CTDSMIS)+
     CTDSCAT(&CTDSCAT) +
     STEPLIB('&STEPLIB') +
     LANG(&LANG) +
     PGMID(&PGMID) +
     FORCE(&FORCE) +
     &DEBUG DATE(&YY&MM&DD) &NOALC
   ELSE    +
IF &DATEFMT=USA THEN +
  %CTDUPAMF CTDSLIB('&CTDSLIB') +
     CTDCAL('&CTDCAL') +
     CTDSMIS(&CTDSMIS)+
     CTDSCAT(&CTDSCAT) +
     STEPLIB('&STEPLIB') +
     LANG(&LANG) +
     PGMID(&PGMID) +
     FORCE(&FORCE) +
     &DEBUG DATE(&MM&DD&YY) &NOALC
   ELSE    +
  %CTDUPAMF CTDSLIB('&CTDSLIB') +
     CTDCAL('&CTDCAL') +
     CTDSMIS(&CTDSMIS)+
     CTDSCAT(&CTDSCAT) +
     STEPLIB('&STEPLIB') +
     LANG(&LANG) +
     PGMID(&PGMID) +
     FORCE(&FORCE) +
     &DEBUG DATE(&DD&MM&YY) &NOALC
SET &NOALC=NOALC
SET DD=&SUBSTR(2:3,&EVAL(&ZDAY+100))
SET MM=&SUBSTR(2:3,&EVAL(&ZMONTH+100))
SET YY=&SUBSTR(2:3,&EVAL(&ZYEAR+100))
GOTO REDISP
END

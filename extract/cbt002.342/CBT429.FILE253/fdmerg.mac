/* REXX PRODXREF FD MERGE EXEC */
"EXECIO * DISKR FDSCAN   (STEM FDSCAN. FINIS";
DO K = 1 TO FDSCAN.0;
     PARSE VAR FDSCAN.K FDPGM FDDDNAME FDACCESS;
     DROP FDSCAN.K;
     FDPGM=STRIP(FDPGM);
     FDDDNAME=STRIP(FDDDNAME);
     FDSC.FDPGM.FDDDNAME=STRIP(FDACCESS);
END;
DROP FDSCAN.0;
"EXECIO * DISKR XREFIN (STEM XREFIN. FINIS";
XOUT = 1;
DO I = 1 TO XREFIN.0;
  PARSE VAR XREFIN.I JOBNAME 9 JOBCLASS 10 EPROCSN 18 PROCNAME ,
      26 EPGMSN 34 EXECPGM 42 STEPPROC 45 STEPJOB ,
      48 DDNAME 56 DSNAME 100 MEMBER 108 DISP 111 ACCESS;
  IF ACCESS ^= " " × DSNAME=" " THEN DO;
       XREFOUT.XOUT = XREFIN.I; /* DUP RECORD UNCHANGED */
       XOUT = XOUT + 1;
       ITERATE I;
       END;
  EXECPGM=STRIP(EXECPGM);
  DDNAME=STRIP(DDNAME);
        IF SYMBOL('FDSC.EXECPGM.DDNAME')="VAR" THEN DO;
                 XREFIN.I = ,
                 OVERLAY(FDSC.EXECPGM.DDNAME,XREFIN.I,111,6);
                 END;
  XREFOUT.XOUT = XREFIN.I; /* DUP RECORD CHANGED */
  XOUT = XOUT + 1;
END;
"EXECIO * DISKW XREFOUT (STEM XREFOUT. FINIS";
EXIT 0;

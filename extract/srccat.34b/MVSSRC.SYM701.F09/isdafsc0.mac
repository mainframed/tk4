         TITLE 'FAULT SYMPTOM CODE REPORT ACCUMULATOR                  *
                        '
ISDAFSC0 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(8)                                              0001
         DC    C'ISDAFSC0'                                         0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         ISDAGSPC R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0027
*   /*****************************************************************/
*   /*                                                               */
*   /* PROGRAM START                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0027
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO SDACVT.    0027
*                                                            @Y30LB51*/
         L     @10,@PC00001                                        0027
         L     CVTPTR,WORKPTR(,@10)                                0027
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO SDAPARMS.  0028
*                                                            @Y30LB51*/
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0028
*   FSCRETCD=0;                     /* INITIALIZE RETURN CODE.     0029
*                                                            @Y30LB51*/
         SLR   @10,@10                                             0029
         LR    FSCRETCD,@10                                        0029
*   FSCWKPTR=0;                     /* INITIALIZE            @Y30LB51*/
         LR    FSCWKPTR,@10                                        0030
*   CHNPTR=0;                       /* POINTERS.             @Y30LB51*/
         LR    CHNPTR,@10                                          0031
*   IF FSC00PTR=0 THEN              /* IF FIRST ENTRY GET SPACE    0032
*                                                            @Y30LB51*/
         C     @10,FSC00PTR(,CVTPTR)                               0032
         BNE   @RF00032                                            0032
*     DO;                           /* FOR WORK AREA AND TABLE.    0033
*                                                            @Y30LB51*/
*       CALL FIRSTENT;              /* GO GET SPACE          @Y30LB51*/
         BAL   @14,FIRSTENT                                        0034
*       IF FSCRETCD=0 THEN          /* IF SPACE SECURED GET  @Y30LB51*/
         LTR   FSCRETCD,FSCRETCD                                   0035
         BNZ   @RF00035                                            0035
*         DO;                       /* SPACE FOR ACCUMULATOR.      0036
*                                                            @Y30LB51*/
*           CALL GETTBL;            /* GO GET SPACE.         @Y30LB51*/
         BAL   @14,GETTBL                                          0037
*           IF FSCRETCD^=0 THEN     /* IF SPACE NO AVAILABLE @Y30LB51*/
         LTR   FSCRETCD,FSCRETCD                                   0038
         BZ    @RF00038                                            0038
*             DO;                   /* FREE WORK AREA AND TABLE.   0039
*                                                            @Y30LB51*/
*               CALL FREECORE;      /* GO FREE SPACE,        @Y30LB51*/
         BAL   @14,FREECORE                                        0040
*               CFSC='00'X;         /* SET 'DO NOT CALL' SWITCH    0041
*                                                            @Y30LB51*/
         MVI   CFSC(LPARMPTR),X'00'                                0041
*               RETURN CODE(FSCRETCD);/* AND RETURN TO CALLER.     0042
*                                                            @Y30LB51*/
         L     @13,4(,@13)                                         0042
         L     @00,@SIZDATD                                        0042
         LR    @01,@11                                             0042
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@05                                             0042
         L     @14,12(,@13)                                        0042
         LM    @00,@12,20(@13)                                     0042
         BR    @14                                                 0042
*             END;                  /*                       @Y30LB51*/
*           ELSE                                                   0044
*             ;                     /* ACCUMULATOR SPACE SECURED.  0044
*                                                            @Y30LB51*/
@RF00038 DS    0H                                                  0045
*         END;                      /*                       @Y30LB51*/
*       ELSE                        /* WORK AREA AND TABLE SPACE NOT
*                                                            @Y30LB51*/
*         RETURN CODE(FSCRETCD);    /* AVAILABLE, RETURN TO CALLER.
*                                                            @Y30LB51*/
         B     @RC00035                                            0046
@RF00035 L     @13,4(,@13)                                         0046
         L     @00,@SIZDATD                                        0046
         LR    @01,@11                                             0046
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@05                                             0046
         L     @14,12(,@13)                                        0046
         LM    @00,@12,20(@13)                                     0046
         BR    @14                                                 0046
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* ON ALL OTHER ENTRIES  @Y30LB51*/
*     DO;                           /* SET POINTERS.         @Y30LB51*/
         B     @RC00032                                            0048
@RF00032 DS    0H                                                  0049
*       FSCWKPTR=FSC00PTR;          /* SET PTR TO WORK AREA. @Y30LB51*/
         L     FSCWKPTR,FSC00PTR(,CVTPTR)                          0049
*       CHNPTR=CHAINTBL;            /* SET PTR TO CHAIN TABLE.     0050
*                                                            @Y30LB51*/
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0050
*     END;                          /*                       @Y30LB51*/
*   LOGPTR=DATAPTR;                 /* SET LOCAL PTR TO RECORD.    0052
*                                                            @Y30LB51*/
@RC00032 MVC   LOGPTR(4,FSCWKPTR),DATAPTR(CVTPTR)                  0052
*   SENSEPTR=SDATAPTR;              /* SET LOCAL PTR TO SENSE AREA.
*                                                            @Y30LB51*/
         MVC   SENSEPTR(4,FSCWKPTR),SDATAPTR(CVTPTR)               0053
*   SSIDSAVE=''B;                   /* ZERO OUT SSID SAVE AREA.    0054
*                                                            @Y30LB51*/
         XC    SSIDSAVE(2,FSCWKPTR),SSIDSAVE(FSCWKPTR)             0054
*   FSCSAVE1=''B;                   /* ZERO OUT FIRST FSC SAVE AREA.
*                                                            @Y30LB51*/
         XC    FSCSAVE1(4,FSCWKPTR),FSCSAVE1(FSCWKPTR)             0055
*   FSCSAVE2=''B;                   /* ZERO OUT SECOND FSC SAVE AREA.
*                                                            @Y30LB51*/
         XC    FSCSAVE2(4,FSCWKPTR),FSCSAVE2(FSCWKPTR)             0056
*   WORKFLGS=WORKFLGS&SWOFF;        /* RESET SWITCHES.       @Y30LB51*/
         NC    WORKFLGS(2,FSCWKPTR),@CB00418                       0057
*   IF CFSCONLY^=0 THEN             /* IF USER SPECIFIED AN FSC    0058
*                                                            @Y30LB51*/
         SLR   @10,@10                                             0058
         CL    @10,CFSCONLY(,LPARMPTR)                             0058
         BE    @RF00058                                            0058
*     IF CFSC34^=0 THEN             /* AND IF IT IS LIBRARY FSC    0059
*                                                            @Y30LB51*/
         SLR   @04,@04                                             0059
         ICM   @04,3,CFSC34(LPARMPTR)                              0059
         CR    @10,@04                                             0059
         BE    @RF00059                                            0059
*       LFSC=CFSCONLY;              /* STORE IT.             @Y30LB51*/
         MVC   LFSC(4,FSCWKPTR),CFSCONLY(LPARMPTR)                 0060
*     ELSE                          /* IT IS NON-LIBRARY FSC.      0061
*                                                            @Y30LB51*/
*       LFSCSYS=CFSC12;             /* STORE NON-LIBRARY FSC.      0061
*                                                            @Y30LB51*/
         B     @RC00059                                            0061
@RF00059 MVC   LFSCSYS(2,FSCWKPTR),CFSC12(LPARMPTR)                0061
*   ELSE                                                           0062
*     ;                             /* USER DID NOT SPECIFY AN FSC.
*                                                            @Y30LB51*/
@RF00058 DS    0H                                                  0063
*   LSSID=CSSIDF;                   /* STORE USER SPECIFIED SSID.  0063
*                                                            @Y30LB51*/
@RC00058 MVC   LSSID(2,FSCWKPTR),CSSIDF(LPARMPTR)                  0063
*   LTYPE=CTYPE;                    /* STORE USER SPECIFIED DEVICE 0064
*                                      TYPE.                 @Y30LB51*/
         MVC   LTYPE(2,FSCWKPTR),CTYPE(LPARMPTR)                   0064
*   CALL RECTYPE;                   /* PROCESS THE RECORD.   @Y30LB51*/
         BAL   @14,RECTYPE                                         0065
*   RETURN CODE(FSCRETCD);          /*                       @Y30LB51*/
         L     @13,4(,@13)                                         0066
         L     @00,@SIZDATD                                        0066
         LR    @01,@11                                             0066
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@05                                             0066
         L     @14,12(,@13)                                        0066
         LM    @00,@12,20(@13)                                     0066
         BR    @14                                                 0066
*FIRSTENT:                                                         0067
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0067
@EL00001 L     @13,4(,@13)                                         0067
@EF00001 L     @00,@SIZDATD                                        0067
         LR    @01,@11                                             0067
         ISDAFSPC R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0067
         BR    @14                                                 0067
FIRSTENT ST    @14,@SA00002                                        0067
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED ON THE FIRST ENTRY OF ISDAFSC0 TO      */
*   /* SECURE SPACE FOR THE WORK AREA AND TABLE.                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0068
*   CORELEN=LENGTH(FSCWORK);        /* GET WORK AREA LENGTH. @Y30LB51*/
         MVC   CORELEN(3,CVTPTR),@CF00552+1                        0068
*   SPNO='04'X;                     /* SPECIFY SUBPOOL NUMBER.     0069
*                                                            @Y30LB51*/
         MVI   SPNO(CVTPTR),X'04'                                  0069
*   CALL ISDAGET1(WORKPTR);         /* GET WORK AREA SPACE.  @Y30LB51*/
         L     @10,@PC00001                                        0070
         ST    @10,@AL00001                                        0070
         L     @15,@CV00432                                        0070
         LA    @01,@AL00001                                        0070
         BALR  @14,@15                                             0070
*   RFY                                                            0071
*     RF RSTD;                      /*                       @Y30LB51*/
*   FSCRETCD=RF;                    /* SAVE THE RETURN CODE. @Y30LB51*/
         LR    FSCRETCD,RF                                         0072
*   RFY                                                            0073
*     RF UNRSTD;                    /*                       @Y30LB51*/
*   IF FSCRETCD=0 THEN              /* IF WORK AREA SPACE SECURED  0074
*                                                            @Y30LB51*/
         SLR   @10,@10                                             0074
         CR    FSCRETCD,@10                                        0074
         BNE   @RF00074                                            0074
*     DO;                           /* INITIALIZE POINTERS.  @Y30LB51*/
*       FSC00PTR=COREADDR;          /* SAVE WORK AREA ADDRESS.     0076
*                                                            @Y30LB51*/
         L     @15,COREADDR(,CVTPTR)                               0076
         ST    @15,FSC00PTR(,CVTPTR)                               0076
*       FSCWKPTR=COREADDR;          /* SET PTR TO WORK AREA. @Y30LB51*/
         LR    FSCWKPTR,@15                                        0077
*       FSCWORK=''B;                /* ZERO OUT WORK AREA.   @Y30LB51*/
         XC    FSCWORK(84,FSCWKPTR),FSCWORK(FSCWKPTR)              0078
*       IF CNFG0PTR=0 THEN          /* IF NO CONFIGURATION DATA SET
*                                                            @Y30LB51*/
         C     @10,CNFG0PTR(,CVTPTR)                               0079
         BNE   @RF00079                                            0079
*         SSIDCT=80;                /* SET MAXIMUM SSID COUNT.     0080
*                                                            @Y30LB51*/
         MVC   SSIDCT(2,FSCWKPTR),@CH00420                         0080
*       ELSE                        /* CONFIG DATA SET EXISTS.     0081
*                                                            @Y30LB51*/
*         SSIDCT=CNFGTOTL;          /* GET THE SSID COUNT.   @Y30LB51*/
         B     @RC00079                                            0081
@RF00079 L     @10,CNFG0PTR(,CVTPTR)                               0081
         MVC   SSIDCT(2,FSCWKPTR),CNFGTOTL(@10)                    0081
*       CORELEN=LENGTH(CHNTBL)*SSIDCT;/*                           0082
*                                      GET CHAIN TABLE LENGTH.     0082
*                                                            @Y30LB51*/
@RC00079 LH    @10,SSIDCT(,FSCWKPTR)                               0082
         MH    @10,@CH00119                                        0082
         STCM  @10,7,CORELEN(CVTPTR)                               0082
*       CALL ISDAGET1(WORKPTR);     /* GET CHAIN TABLE SPACE.      0083
*                                                            @Y30LB51*/
         L     @10,@PC00001                                        0083
         ST    @10,@AL00001                                        0083
         L     @15,@CV00432                                        0083
         LA    @01,@AL00001                                        0083
         BALR  @14,@15                                             0083
*       RFY                                                        0084
*         RF RSTD;                  /*                       @Y30LB51*/
*       FSCRETCD=RF;                /* SAVE THE RETURN CODE. @Y30LB51*/
         LR    FSCRETCD,RF                                         0085
*       RFY                                                        0086
*         RF UNRSTD;                /*                       @Y30LB51*/
*       IF FSCRETCD=0 THEN          /* IF CHAIN TABLE SPACE SECURED
*                                                            @Y30LB51*/
         LTR   FSCRETCD,FSCRETCD                                   0087
         BNZ   @RF00087                                            0087
*         DO;                       /* INITIALIZE POINTERS.  @Y30LB51*/
*           CHAINTBL=COREADDR;      /* SAVE CHAIN TABLE ADDRESS.   0089
*                                                            @Y30LB51*/
         L     @10,COREADDR(,CVTPTR)                               0089
         ST    @10,CHAINTBL(,FSCWKPTR)                             0089
*           CHNPTR=COREADDR;        /* SET PTR TO CHAIN TABLE.     0090
*                                                            @Y30LB51*/
         LR    CHNPTR,@10                                          0090
*           DO I=1 TO SSIDCT;       /*                       @Y30LB51*/
         LA    @10,1                                               0091
         B     @DE00091                                            0091
@DL00091 DS    0H                                                  0092
*             CHNTBL=''B;           /* ZERO OUT CHAIN TABLE. @Y30LB51*/
         XC    CHNTBL(12,CHNPTR),CHNTBL(CHNPTR)                    0092
*             CHNPTR=CHNPTR+LENGTH(CHNTBL);/*                      0093
*                                                            @Y30LB51*/
         AH    CHNPTR,@CH00119                                     0093
*           END;                    /*                       @Y30LB51*/
         LA    @10,1                                               0094
         AH    @10,I(,FSCWKPTR)                                    0094
@DE00091 STH   @10,I(,FSCWKPTR)                                    0094
         CH    @10,SSIDCT(,FSCWKPTR)                               0094
         BNH   @DL00091                                            0094
*           CHNPTR=CHAINTBL;        /* SET PTR TO CHAIN TABLE START.
*                                                            @Y30LB51*/
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0095
*         END;                      /*                       @Y30LB51*/
*       ELSE                        /* CHAIN TABLE SPACE NOT @Y30LB51*/
*         DO;                       /* AVAILABLE, FREE ALL STORAGE.
*                                                            @Y30LB51*/
         B     @RC00087                                            0097
@RF00087 DS    0H                                                  0098
*           CALL FREECORE;          /* FREE ALL DYNAMIC STORAGE.   0098
*                                                            @Y30LB51*/
         BAL   @14,FREECORE                                        0098
*           FSCRETCD=NOSPACE;       /* SET RETURN CODE.      @Y30LB51*/
         LA    FSCRETCD,4                                          0099
*         END;                      /*                       @Y30LB51*/
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* WORK AREA SPACE NOT AVAILABLE.
*                                                            @Y30LB51*/
*     DO;                           /* RETURN TO CALLER.     @Y30LB51*/
         B     @RC00074                                            0102
@RF00074 DS    0H                                                  0103
*       CFSC='00'X;                 /* SET 'DO NOT CALL' SWITCH.   0103
*                                                            @Y30LB51*/
         MVI   CFSC(LPARMPTR),X'00'                                0103
*       FSCRETCD=NOSPACE;           /* SET RETURN CODE.      @Y30LB51*/
         LA    FSCRETCD,4                                          0104
*     END;                          /*                       @Y30LB51*/
*   END FIRSTENT;                   /*                       @Y30LB51*/
@EL00002 DS    0H                                                  0106
@EF00002 DS    0H                                                  0106
@ER00002 L     @14,@SA00002                                        0106
         BR    @14                                                 0106
*GETTBL:                                                           0107
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0107
GETTBL   ST    @14,@SA00003                                        0107
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL OBTAIN SPACE FOR THE FSC TABLE VIA THE      */
*   /* ISDAGET0 ROUTINE.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0108
*   CORELEN=LENGTH(ISDAGHDR)+LENGTH(FSCTBL)*TBLNR;/*               0108
*                                      GET TABLE LENGTH.     @Y30LB51*/
         MVC   CORELEN(3,CVTPTR),@CF00555+1                        0108
*   SPNO='04'X;                     /* GET SUBPOOL NUMBER.   @Y30LB51*/
         MVI   SPNO(CVTPTR),X'04'                                  0109
*   CALL ISDAGET0(WORKPTR);         /* GET THE SPACE.        @Y30LB51*/
         L     @10,@PC00001                                        0110
         ST    @10,@AL00001                                        0110
         L     @15,@CV00431                                        0110
         LA    @01,@AL00001                                        0110
         BALR  @14,@15                                             0110
*   GET0PTR=COREADDR;               /* SAVE ADDRESS OF FSC TABLE.  0111
*                                                            @Y30LB51*/
         L     @10,COREADDR(,CVTPTR)                               0111
         ST    @10,GET0PTR(,FSCWKPTR)                              0111
*   RFY                                                            0112
*     RF RSTD;                      /*                       @Y30LB51*/
*   FSCRETCD=RF;                    /* SAVE RETURN CODE.     @Y30LB51*/
         LR    FSCRETCD,RF                                         0113
*   RFY                                                            0114
*     RF UNRSTD;                    /*                       @Y30LB51*/
*   IF FSCRETCD=0 THEN              /* IF SPACE WAS AVAILABLE      0115
*                                                            @Y30LB51*/
         LTR   FSCRETCD,FSCRETCD                                   0115
         BNZ   @RF00115                                            0115
*     DO;                           /* INITIALIZE FSC TABLE. @Y30LB51*/
*       FSCTBLCT=FSCTBLCT+1;        /* PUT ONE IN TABLE COUNTER.   0117
*                                                            @Y30LB51*/
         LA    @15,1                                               0117
         LH    @14,FSCTBLCT(,FSCWKPTR)                             0117
         ALR   @14,@15                                             0117
         STH   @14,FSCTBLCT(,FSCWKPTR)                             0117
*       BLOCKCNT=FSCTBLCT;          /* PUT NUMBER IN TABLE.  @Y30LB51*/
         STH   @14,BLOCKCNT(,@10)                                  0118
*       BLOCKID='FSC ';             /* PUT ID IN TABLE.      @Y30LB51*/
         MVC   BLOCKID(4,@10),@CC00449                             0119
*       FSCPTR=GET0PTR;             /* SAVE ADDRESS OF FIRST TABLE.
*                                                            @Y30LB51*/
         ST    @10,FSCPTR(,FSCWKPTR)                               0120
*       FREEPTR=STARTPTR;           /* SET PTR TO FREE ELEMENT.    0121
*                                                            @Y30LB51*/
         L     @10,STARTPTR(,@10)                                  0121
         ST    @10,FREEPTR(,FSCWKPTR)                              0121
*       TBLPTR=STARTPTR;            /* SET PTR TO FIRST ELEMENT.   0122
*                                                            @Y30LB51*/
         LR    TBLPTR,@10                                          0122
*       DO I=1 TO TBLNR;            /*                       @Y30LB51*/
         STH   @15,I(,FSCWKPTR)                                    0123
@DL00123 DS    0H                                                  0124
*         FSCTBL=''B;               /* ZERO OUT FSC TABLE.   @Y30LB51*/
         XC    FSCTBL(44,TBLPTR),FSCTBL(TBLPTR)                    0124
*         TBLPTR=TBLPTR+LENGTH(FSCTBL);/*                          0125
*                                                            @Y30LB51*/
         AH    TBLPTR,@CH00553                                     0125
*       END;                        /*                       @Y30LB51*/
         LA    @15,1                                               0126
         AH    @15,I(,FSCWKPTR)                                    0126
         STH   @15,I(,FSCWKPTR)                                    0126
         CH    @15,@CH00420                                        0126
         BNH   @DL00123                                            0126
*       TBLPTR=STARTPTR;            /* SET PTR TO FIRST ELEMENT.   0127
*                                                            @Y30LB51*/
         L     @10,GET0PTR(,FSCWKPTR)                              0127
         L     TBLPTR,STARTPTR(,@10)                               0127
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* SPACE NOT AVAILABLE.  @Y30LB51*/
*     FSCRETCD=NOSPACE;             /*                       @Y30LB51*/
         B     @RC00115                                            0129
@RF00115 LA    FSCRETCD,4                                          0129
*   END GETTBL;                     /*                       @Y30LB51*/
@EL00003 DS    0H                                                  0130
@EF00003 DS    0H                                                  0130
@ER00003 L     @14,@SA00003                                        0130
         BR    @14                                                 0130
*RECTYPE:                                                          0131
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0131
RECTYPE  ST    @14,@SA00004                                        0131
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE THE FORMAT OF THE INPUT RECORD AND*/
*   /* THE VALIDITY OF THE RECORD (EXCEPT FOR AN MSC FORMAT 3        */
*   /* RECORD). A RECORD IS ACCEPTED AS VALID IF IT HAS A NON-ZERO   */
*   /* FSC. FOR AN MSC FORMAT 1 OR 2 RECORD AND FOR ALL DASD RECORDS,*/
*   /* THE CUA IS SAVED AS THE SSID. FOR MSC FORMAT 4 AND 5 RECORDS  */
*   /* THE SSID AND FSC ARE SAVED. FOR AN MSC FORMAT RECORD 3 A      */
*   /* ROUTINE IS CALLED TO DETERMINE VALIDITY AND TO SAVE THE SSID  */
*   /* AND FSC(S). ROUTINES ARE CALLED TO DETERMINE THE SUBFORMAT FOR*/
*   /* MSC FORMAT 4 AND 5 RECORDS AND FOR ALL DASD RECORDS.          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0132
*   IF INDEVTYP='S' THEN            /* IF SUBSYSTEM RECORD   @Y30LB51*/
         L     @10,SDA00PTR(,CVTPTR)                               0132
         CLI   INDEVTYP(@10),C'S'                                  0132
         BNE   @RF00132                                            0132
*     IF(FORMATNO(2)='1'B)×(FORMATNO(3)='1'B) THEN/* AND IF FMT 1 OR
*                                      2                     @Y30LB51*/
         L     @04,SENSEPTR(,FSCWKPTR)                             0133
         TM    FORMATNO(@04),B'01100000'                           0133
         BZ    @RF00133                                            0133
*       IF MSCFSC^=0 THEN           /* AND IF NON-ZERO FSC   @Y30LB51*/
         ICM   @15,3,MSCFSC(@04)                                   0134
         BZ    @RF00134                                            0134
*         DO;                       /* THE RECORD IS ACCEPTED.     0135
*                                                            @Y30LB51*/
*           SSIDSAVE=INRECCUA;      /* SAVE CUA AS SSID      @Y30LB51*/
         MVC   SSIDSAVE(2,FSCWKPTR),INRECCUA(@10)                  0136
*           CUAFLAG='1111'B;        /* AND SET CUA FLAG.     @Y30LB51*/
         OI    CUAFLAG(FSCWKPTR),B'11110000'                       0137
*           FSCSYSSV=MSCFSC;        /* SAVE THE FSC.         @Y30LB51*/
         MVC   FSCSYSSV(2,FSCWKPTR),MSCFSC(@04)                    0138
*           MSCREC='1'B;            /* SET MSC RECORD FLAG.  @Y30LB51*/
         OI    MSCREC(FSCWKPTR),B'10000000'                        0139
*         END;                      /*                       @Y30LB51*/
*       ELSE                        /* FSC IS ZERO,          @Y30LB51*/
*         FSCRETCD=BADREC;          /* RECORD IS INVALID.    @Y30LB51*/
         B     @RC00134                                            0141
@RF00134 LA    FSCRETCD,8                                          0141
*     ELSE                          /* NOT FMT 1 OR 2 RECORD,      0142
*                                                            @Y30LB51*/
*       DO;                         /* MUST BE FMT 3,4 OR 5 RECORD.
*                                                            @Y30LB51*/
         B     @RC00133                                            0142
@RF00133 DS    0H                                                  0143
*         SSIDSAVE=SUBSYSID;        /* SAVE THE SSID         @Y30LB51*/
         L     @10,SENSEPTR(,FSCWKPTR)                             0143
         MVC   SSIDSAVE(2,FSCWKPTR),SUBSYSID(@10)                  0143
*         SSIDSAVE=SSIDSAVE&SSIDMASK;/* AND CLEAR FLAGS.     @Y30LB51*/
         NC    SSIDSAVE(2,FSCWKPTR),@CB00416                       0144
*         IF FORMATNO(4)='1'B THEN  /* IF FMT 3 RECORD       @Y30LB51*/
         TM    FORMATNO(@10),B'00010000'                           0145
         BNO   @RF00145                                            0145
*           CALL MSCTHREE;          /* GO PROCESS IT.        @Y30LB51*/
         BAL   @14,MSCTHREE                                        0146
*         ELSE                      /* NOT FMT 3 RECORD.     @Y30LB51*/
*           IF MSCFSC^=0 THEN       /* IF NON-ZERO FSC       @Y30LB51*/
         B     @RC00145                                            0147
@RF00145 L     @10,SENSEPTR(,FSCWKPTR)                             0147
         ICM   @04,3,MSCFSC(@10)                                   0147
         BZ    @RF00147                                            0147
*             DO;                   /* ACCEPT FMT 4 OR 5 RECORD.   0148
*                                                            @Y30LB51*/
*               FSCSYSSV=MSCFSC;    /* SAVE THE FSC.         @Y30LB51*/
         MVC   FSCSYSSV(2,FSCWKPTR),MSCFSC(@10)                    0149
*               IF FORMATNO(5)='1'B THEN/* IF FMT 4 RECORD   @Y30LB51*/
         TM    FORMATNO(@10),B'00001000'                           0150
         BNO   @RF00150                                            0150
*                 CALL FMTFOUR;     /* DETERMINE SUBFORMAT.  @Y30LB51*/
         BAL   @14,FMTFOUR                                         0151
*               ELSE                /* NOT FMT 4 RECORD,     @Y30LB51*/
*                 CALL DASDFIVE;    /* DETERMINE FMT 5 SUBFORMAT.  0152
*                                                            @Y30LB51*/
         B     @RC00150                                            0152
@RF00150 BAL   @14,DASDFIVE                                        0152
*             END;                  /*                       @Y30LB51*/
*           ELSE                    /* FSC IS ZERO,          @Y30LB51*/
*             FSCRETCD=BADREC;      /* RECORD IS INVALID.    @Y30LB51*/
         B     @RC00147                                            0154
@RF00147 LA    FSCRETCD,8                                          0154
*       END;                        /*                       @Y30LB51*/
*   ELSE                            /* NOT SUBSYSTEM RECORD. @Y30LB51*/
*     IF FSCDASD^=0 THEN            /* IF DASD FSC NON-ZERO  @Y30LB51*/
         B     @RC00132                                            0156
@RF00132 L     @10,SENSEPTR(,FSCWKPTR)                             0156
         ICM   @04,3,FSCDASD(@10)                                  0156
         BZ    @RF00156                                            0156
*       DO;                         /* ACCEPT THE RECORD.    @Y30LB51*/
*         IF INDEVTYP='R' THEN      /* IF READ DASD RECORD   @ZD00149*/
         L     @10,SDA00PTR(,CVTPTR)                               0158
         CLI   INDEVTYP(@10),C'R'                                  0158
         BNE   @RF00158                                            0158
*           DO;                     /* STORE CUA AS SSID.    @ZD00149*/
*             SSIDSAVE=INRECCUA;    /* SAVE CUA AS SSID      @Y30LB51*/
         MVC   SSIDSAVE(2,FSCWKPTR),INRECCUA(@10)                  0160
*             CUAFLAG='1111'B;      /* AND SET CUA FLAG.     @Y30LB51*/
         OI    CUAFLAG(FSCWKPTR),B'11110000'                       0161
*           END;                    /*                       @ZD00149*/
*         ELSE                      /* VIRTUAL DASD RECORD,  @ZD00149*/
*           DO;                     /* STORE BYTE 27 AS SSID.      0163
*                                                            @ZD00149*/
         B     @RC00158                                            0163
@RF00158 DS    0H                                                  0164
*             SSIDDUMA='00'X;       /* SET FIRST BYTE TO ZERO      0164
*                                                            @ZD00149*/
         MVI   SSIDDUMA(FSCWKPTR),X'00'                            0164
*             SSIDDUMB=SSIDDASD;    /* AND SAVE BYTE 27 AS SSID.   0165
*                                                            @ZD00149*/
         L     @10,SENSEPTR(,FSCWKPTR)                             0165
         MVC   SSIDDUMB(1,FSCWKPTR),SSIDDASD(@10)                  0165
*           END;                    /*                       @ZD00149*/
*         FSCSYSSV=FSCDASD;         /* SAVE THE FSC.         @Y30LB51*/
@RC00158 L     @10,SENSEPTR(,FSCWKPTR)                             0167
         MVC   FSCSYSSV(2,FSCWKPTR),FSCDASD(@10)                   0167
*         DASDREC='1'B;             /* SET DASD RECORD FLAG. @Y30LB51*/
         OI    DASDREC(FSCWKPTR),B'00000001'                       0168
*         CALL DASDFIVE;            /* DETERMINE FORMAT.     @Y30LB51*/
         BAL   @14,DASDFIVE                                        0169
*       END;                        /*                       @Y30LB51*/
*     ELSE                          /* FSC IS ZERO           @YM32182*/
*       IF INDEVTYP='R' THEN        /* IF REAL DASD          @YM32182*/
         B     @RC00156                                            0171
@RF00156 L     @10,SDA00PTR(,CVTPTR)                               0171
         CLI   INDEVTYP(@10),C'R'                                  0171
         BNE   @RF00171                                            0171
*         FSCRETCD=REALREC;         /* FLAG BAD REAL DASD    @YM32182*/
         LA    FSCRETCD,2                                          0172
*       ELSE                        /* IF VIRTUAL DASD       @YM32182*/
*         FSCRETCD=BADREC;          /* RECORD IS INVALID.    @YM32182*/
         B     @RC00171                                            0173
@RF00171 LA    FSCRETCD,8                                          0173
*   IF FSCRETCD=0 THEN              /* IF RECORD ACCEPTED    @Y30LB51*/
@RC00171 DS    0H                                                  0174
@RC00156 DS    0H                                                  0174
@RC00132 LTR   FSCRETCD,FSCRETCD                                   0174
         BNZ   @RF00174                                            0174
*     CALL REPORTYP;                /* PREPARE THE REPORT.   @Y30LB51*/
         BAL   @14,REPORTYP                                        0175
*   ELSE                            /* RECORD NOT ACCEPTED.  @Y30LB51*/
*     IF FSCRETCD=BUFFREC×FSCRETCD=REALREC THEN/* IF BUFFERED LOG OR
*                                      REAL DASD             @YM32182*/
         B     @RC00174                                            0176
@RF00174 CH    FSCRETCD,@CH00082                                   0176
         BE    @RT00176                                            0176
         CH    FSCRETCD,@CH00101                                   0176
         BNE   @RF00176                                            0176
@RT00176 DS    0H                                                  0177
*       FSCRETCD=0;                 /* RESET RETURN CODE.    @Y30LB51*/
         SLR   FSCRETCD,FSCRETCD                                   0177
*     ELSE                                                         0178
*       ;                           /* NOT BUFFERED LOG RECORD.    0178
*                                                            @Y30LB51*/
@RF00176 DS    0H                                                  0179
*   END RECTYPE;                    /*                       @Y30LB51*/
@EL00004 DS    0H                                                  0179
@EF00004 DS    0H                                                  0179
@ER00004 L     @14,@SA00004                                        0179
         BR    @14                                                 0179
*MSCTHREE:                                                         0180
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0180
MSCTHREE ST    @14,12(,@13)                                        0180
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE THE VALIDITY OF AN MSC FORMAT 3   */
*   /* RECORD AND SAVE THE FSC(S) IF THE RECORD IS ACCEPTED. TO BE   */
*   /* VALID AN MSC FORMAT 3 RECORD MUST HAVE ONE FSC NON-ZERO. A    */
*   /* BUFFERED LOG RECORD WILL BE REJECTED, BUT AN INVALID RECORD   */
*   /* RETURN CODE WILL NOT BE RETURNED TO THE CONTROLLER.           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0181
*   IF SUBSTAT5(8)='0'B THEN        /* IF NOT BUFFERED LOG RECORD  0181
*                                                            @Y30LB51*/
         L     @10,SENSEPTR(,FSCWKPTR)                             0181
         TM    SUBSTAT5(@10),B'00000001'                           0181
         BNZ   @RF00181                                            0181
*     DO;                           /* ACCEPT THE RECORD.    @Y30LB51*/
*       CSREC='1'B;                 /* SET CART STORE UNIT FLAG.   0183
*                                                            @Y30LB51*/
         OI    CSREC(FSCWKPTR),B'00001000'                         0183
*       IF FSCACC1^=0 THEN          /* IF FSC FOR ACCESSOR 1 @Y30LB51*/
         SLR   @04,@04                                             0184
         CL    @04,FSCACC1(,@10)                                   0184
         BE    @RF00184                                            0184
*         DO;                       /* SAVE THE FSC.         @Y30LB51*/
*           FSCSAVE1=FSCACC1;       /* SAVE THE FSC.         @Y30LB51*/
         MVC   FSCSAVE1(4,FSCWKPTR),FSCACC1(@10)                   0186
*           FMT3ACC1='1'B;          /* SET ACC 1 FSC FLAG.   @Y30LB51*/
         OI    FMT3ACC1(FSCWKPTR),B'10000000'                      0187
*           IF FSCACC2^=0 THEN      /* IF ACCESSOR 2 FSC THEN      0188
*                                                            @Y30LB51*/
         CL    @04,FSCACC2(,@10)                                   0188
         BE    @RF00188                                            0188
*             DO;                   /* SAVE IT, ALSO.        @Y30LB51*/
*               FSCSAVE2=FSCACC2;   /* SAVE ACC 2 FSC        @Y30LB51*/
         MVC   FSCSAVE2(4,FSCWKPTR),FSCACC2(@10)                   0190
*               FMT3ACC2='1'B;      /* AND SET FLAG.         @Y30BL51*/
         OI    FMT3ACC2(FSCWKPTR),B'01000000'                      0191
*             END;                  /*                       @Y30LB51*/
*           ELSE                                                   0193
*             ;                     /* ONLY ACCESSOR 1 FSC.  @Y30LB51*/
@RF00188 DS    0H                                                  0194
*         END;                      /*                       @Y30LB51*/
*       ELSE                        /* NO ACCESSOR 1 FSC,    @Y30LB51*/
*         DO;                       /* CHECK FOR ACC 2 FSC.  @Y30LB51*/
         B     @RC00184                                            0195
@RF00184 DS    0H                                                  0196
*           IF FSCACC2^=0 THEN      /* IF ACCESSOR 2 FSC     @Y30LB51*/
         L     @10,SENSEPTR(,FSCWKPTR)                             0196
         ICM   @04,15,FSCACC2(@10)                                 0196
         BZ    @RF00196                                            0196
*             DO;                   /* SAVE IT.              @Y30LB51*/
*               FSCSAVE2=FSCACC2;   /* SAVE ACC 2 FSC.       @Y30LB51*/
         MVC   FSCSAVE2(4,FSCWKPTR),FSCACC2(@10)                   0198
*               FMT3ACC2='1'B;      /* SET ACC 2 FSC FLAG.   @Y30LB51*/
         OI    FMT3ACC2(FSCWKPTR),B'01000000'                      0199
*             END;                  /*                       @Y30LB51*/
*           ELSE                    /* NO ACCESSOR 2 FSC,    @Y30LB51*/
*             FSCRETCD=BUFFREC;     /* NOT BAD BUT IGNORE IT @ZM30730*/
         B     @RC00196                                            0201
@RF00196 LA    FSCRETCD,1                                          0201
*         END;                      /*                       @Y30LB51*/
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* BUFFERED LOG RECORD,  @Y30LB51*/
*     FSCRETCD=BUFFREC;             /* REJECT IT.            @Y30LB51*/
         B     @RC00181                                            0204
@RF00181 LA    FSCRETCD,1                                          0204
*   END MSCTHREE;                   /*                       @Y30LB51*/
@EL00005 DS    0H                                                  0205
@EF00005 DS    0H                                                  0205
@ER00005 L     @14,12(,@13)                                        0205
         BR    @14                                                 0205
*FMTFOUR:                                                          0206
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0206
FMTFOUR  ST    @14,12(,@13)                                        0206
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE THE SUBFORMAT OF AN MSC FORMAT 4  */
*   /* RECORD. IT WILL ALSO DETERMINE IF ALTERNATE PATH RETRY HAS    */
*   /* CHANGED THE SSID OF THE RECORD.                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0207
*   IF SUBFMTNO='1001'B THEN        /* IF SUBFORMAT '9'      @Y30LB51*/
         L     @10,SENSEPTR(,FSCWKPTR)                             0207
         TM    SUBFMTNO(@10),B'10010000'                           0207
         BNO   @RF00207                                            0207
         TM    SUBFMTNO(@10),B'01100000'                           0207
         BNZ   @RF00207                                            0207
*     DO;                           /* PROCESS IT.           @Y30LB51*/
*       DRDREC='1'B;                /* SET DRD RECORD FLAG.  @Y30LB51*/
         OI    DRDREC(FSCWKPTR),B'00010000'                        0209
*       IF SSIDDEV^='0010'B THEN    /* IF SSID NOT 2XX       @Y30LB51*/
         TM    SSIDDEV(FSCWKPTR),B'00000010'                       0210
         BNO   @RT00210                                            0210
         TM    SSIDDEV(FSCWKPTR),B'00001101'                       0210
         BZ    @RF00210                                            0210
@RT00210 DS    0H                                                  0211
*         WORKAPR='1'B;             /* SET APR FLAG.         @Y30LB51*/
         OI    WORKAPR(FSCWKPTR),B'00010000'                       0211
*       ELSE                                                       0212
*         ;                         /* NO APR ACTIVITY.      @Y30LB51*/
@RF00210 DS    0H                                                  0213
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* NOT SUBFORMAT '9' RECORD.   0214
*                                                            @Y30LB51*/
*     IF SUBFMTNO='1010'B THEN      /* IF SUBFMT 'A'         @Y30LB51*/
         B     @RC00207                                            0214
@RF00207 L     @10,SENSEPTR(,FSCWKPTR)                             0214
         TM    SUBFMTNO(@10),B'10100000'                           0214
         BNO   @RF00214                                            0214
         TM    SUBFMTNO(@10),B'01010000'                           0214
         BNZ   @RF00214                                            0214
*       DO;                         /* PROCESS IT.           @Y30LB51*/
*         SAREC='1'B;               /* SET SA RECORD FLAG.   @Y30LB51*/
         OI    SAREC(FSCWKPTR),B'01000000'                         0216
*         IF SSIDDEV^='1000'B THEN  /* IF SSID NOT 8XX       @Y30LB51*/
         TM    SSIDDEV(FSCWKPTR),B'00001000'                       0217
         BNO   @RT00217                                            0217
         TM    SSIDDEV(FSCWKPTR),B'00000111'                       0217
         BZ    @RF00217                                            0217
@RT00217 DS    0H                                                  0218
*           WORKAPR='1'B;           /* SET APR FLAG.         @Y30LB51*/
         OI    WORKAPR(FSCWKPTR),B'00010000'                       0218
*         ELSE                                                     0219
*           ;                       /* NO APR ACTIVITY.      @Y30LB51*/
@RF00217 DS    0H                                                  0220
*       END;                        /*                       @Y30LB51*/
*     ELSE                          /* NOT SUBFMT 'A' RECORD.      0221
*                                                            @Y30LB51*/
*       IF SUBFMTNO='1011'B THEN    /* IF SUBFORMAT 'B'      @Y30LB51*/
         B     @RC00214                                            0221
@RF00214 L     @10,SENSEPTR(,FSCWKPTR)                             0221
         TM    SUBFMTNO(@10),B'10110000'                           0221
         BNO   @RF00221                                            0221
         TM    SUBFMTNO(@10),B'01000000'                           0221
         BNZ   @RF00221                                            0221
*         IF SSIDDEV='0010'B THEN   /* AND IF SSID 2XX       @Y30LB51*/
         TM    SSIDDEV(FSCWKPTR),B'00000010'                       0222
         BNO   @RF00222                                            0222
         TM    SSIDDEV(FSCWKPTR),B'00001101'                       0222
         BNZ   @RF00222                                            0222
*           DRDREC='1'B;            /* SET DRD RECORD FLAG.  @Y30LB51*/
         OI    DRDREC(FSCWKPTR),B'00010000'                        0223
*         ELSE                      /* SSID NOT 2XX.         @Y30LB51*/
*           IF SSIDDEV='0100'B THEN /* IF SSID 4XX           @Y30LB51*/
         B     @RC00222                                            0224
@RF00222 TM    SSIDDEV(FSCWKPTR),B'00000100'                       0224
         BNO   @RF00224                                            0224
         TM    SSIDDEV(FSCWKPTR),B'00001011'                       0224
         BNZ   @RF00224                                            0224
*             DRCREC='1'B;          /* SET DRC RECORD FLAG.  @Y30LB51*/
         OI    DRCREC(FSCWKPTR),B'00100000'                        0225
*           ELSE                    /* SSID NOT 4XX.         @Y30LB51*/
*             DO;                   /* MUST BE SA SSID       @ZM31105*/
         B     @RC00224                                            0226
@RF00224 DS    0H                                                  0227
*               DRCREC='1'B;        /* SET DRC RECORD FLAG   @ZM31105*/
         OI    DRCREC(FSCWKPTR),B'00100000'                        0227
*               WORKAPR='1'B;       /* SET APR FLAG          @ZM31105*/
         OI    WORKAPR(FSCWKPTR),B'00010000'                       0228
*             END;                  /* END 4B WITH SA SSID   @ZM31105*/
*       ELSE                        /* NOT SUBFORMAT 'B',    @Y30LB51*/
*         DO;                       /* MUST BE SUBFORMAT 'E'.      0230
*                                                            @Y30LB51*/
         B     @RC00221                                            0230
@RF00221 DS    0H                                                  0231
*           DRCREC='1'B;            /* SET DRC RECORD FLAG.  @Y30LB51*/
         OI    DRCREC(FSCWKPTR),B'00100000'                        0231
*           IF SSIDDEV^='0100'B THEN/* IF SSID NOT 4XX       @Y30LB51*/
         TM    SSIDDEV(FSCWKPTR),B'00000100'                       0232
         BNO   @RT00232                                            0232
         TM    SSIDDEV(FSCWKPTR),B'00001011'                       0232
         BZ    @RF00232                                            0232
@RT00232 DS    0H                                                  0233
*             WORKAPR='1'B;         /* SET APR FLAG.         @Y30LB51*/
         OI    WORKAPR(FSCWKPTR),B'00010000'                       0233
*           ELSE                                                   0234
*             ;                     /* NO APR ACTIVITY.      @Y30LB51*/
@RF00232 DS    0H                                                  0235
*         END;                      /*                       @Y30LB51*/
*   END FMTFOUR;                    /*                       @Y30LB51*/
@EL00006 DS    0H                                                  0236
@EF00006 DS    0H                                                  0236
@ER00006 L     @14,12(,@13)                                        0236
         BR    @14                                                 0236
*DASDFIVE:                                                         0237
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0237
DASDFIVE ST    @14,12(,@13)                                        0237
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE THE SUBFORMAT FOR AN MSC FORMAT 5 */
*   /* RECORD AND FOR A DASD RECORD.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0238
*   IF INDEVTYP='S' THEN            /* IF FMT 5 RECORD       @Y30LB51*/
         L     @10,SDA00PTR(,CVTPTR)                               0238
         CLI   INDEVTYP(@10),C'S'                                  0238
         BNE   @RF00238                                            0238
*     IF(SUBFMTNO='0001'B)×(SUBFMTNO='0100'B) THEN/* AND IF SUBFORMAT
*                                      1 OR 4                @Y30LB51*/
         L     @10,SENSEPTR(,FSCWKPTR)                             0239
         TM    SUBFMTNO(@10),B'00010000'                           0239
         BNO   @GL00002                                            0239
         TM    SUBFMTNO(@10),B'11100000'                           0239
         BZ    @RT00239                                            0239
@GL00002 L     @10,SENSEPTR(,FSCWKPTR)                             0239
         TM    SUBFMTNO(@10),B'01000000'                           0239
         BNO   @RF00239                                            0239
         TM    SUBFMTNO(@10),B'10110000'                           0239
         BNZ   @RF00239                                            0239
@RT00239 DS    0H                                                  0240
*       DAREC='1'B;                 /* SET 3330 RECORD FLAG. @Y30LB51*/
         OI    DAREC(FSCWKPTR),B'00000010'                         0240
*     ELSE                          /* NOT 3330 RECORD,      @Y30LB51*/
*       DIRREC='1'B;                /* SET 3830 RECORD FLAG. @Y30LB51*/
         B     @RC00239                                            0241
@RF00239 OI    DIRREC(FSCWKPTR),B'00000100'                        0241
*   ELSE                            /* NOT FMT 5 RECORD.     @Y30LB51*/
*     IF(DASDFMT='0001'B)×(DASDFMT='0100'B) THEN/* IF SUB- FORMAT 1
*                                      OR 4                  @Y30LB51*/
         B     @RC00238                                            0242
@RF00238 L     @10,SENSEPTR(,FSCWKPTR)                             0242
         TM    DASDFMT(@10),B'00010000'                            0242
         BNO   @GL00003                                            0242
         TM    DASDFMT(@10),B'11100000'                            0242
         BZ    @RT00242                                            0242
@GL00003 L     @10,SENSEPTR(,FSCWKPTR)                             0242
         TM    DASDFMT(@10),B'01000000'                            0242
         BNO   @RF00242                                            0242
         TM    DASDFMT(@10),B'10110000'                            0242
         BNZ   @RF00242                                            0242
@RT00242 DS    0H                                                  0243
*       DAREC='1'B;                 /* SET 3330 RECORD FLAG. @Y30LB51*/
         OI    DAREC(FSCWKPTR),B'00000010'                         0243
*     ELSE                          /* NOT 3330 RECORD,      @Y30LB51*/
*       DIRREC='1'B;                /* SET 3830 RECORD FLAG. @Y30LB51*/
         B     @RC00242                                            0244
@RF00242 OI    DIRREC(FSCWKPTR),B'00000100'                        0244
*   END DASDFIVE;                   /*                       @Y30LB51*/
@EL00007 DS    0H                                                  0245
@EF00007 DS    0H                                                  0245
@ER00007 L     @14,12(,@13)                                        0245
         BR    @14                                                 0245
*REPORTYP:                                                         0246
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0246
REPORTYP ST    @14,@SA00008                                        0246
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE THE REPORT TYPE REQUESTED BY THE  */
*   /* USER. LSSID CONTAINS THE USER SPECIFIED SSID OR ZERO. LFSC    */
*   /* CONTAINS THE USER SPECIFIED FSC OR ZERO. LTYPE CONTAINS THE   */
*   /* USER SPECIFIED DEVICE TYPE OR ZERO.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*   IF LSSID=0 THEN                 /* IF NOT BY SSID        @Y30LB51*/
         SLR   @10,@10                                             0247
         SLR   @04,@04                                             0247
         ICM   @04,3,LSSID(FSCWKPTR)                               0247
         CR    @10,@04                                             0247
         BNE   @RF00247                                            0247
*     IF LFSC=0 THEN                /* AND IF NOT BY LIBRARY FSC   0248
*                                                            @Y30LB51*/
         CL    @10,LFSC(,FSCWKPTR)                                 0248
         BNE   @RF00248                                            0248
*       IF LFSCSYS=0 THEN           /* AND IF NOT BY NON-LIBRARY FSC
*                                                            @Y30LB51*/
         SLR   @04,@04                                             0249
         ICM   @04,3,LFSCSYS(FSCWKPTR)                             0249
         CR    @10,@04                                             0249
         BNE   @RF00249                                            0249
*         IF LTYPE='  ' THEN        /* AND IF NOT BY DEVICE TYPE   0250
*                                                            @Y30LB51*/
         CLC   LTYPE(2,FSCWKPTR),@CC00481                          0250
         BNE   @RF00250                                            0250
*           CALL COUNTALL;          /* THEN COUNT ALL RECORDS.     0251
*                                                            @Y30LB51*/
         BAL   @14,COUNTALL                                        0251
*         ELSE                      /* DEVICE TYPE WAS SPECIFIED.  0252
*                                                            @Y30LB51*/
*           CALL COUNTYPE;          /*                       @Y30LB51*/
         B     @RC00250                                            0252
@RF00250 BAL   @14,COUNTYPE                                        0252
*       ELSE                        /* A NON-LIBRARY FSC WAS       0253
*                                      SPECIFIED.            @Y30LB51*/
*         CALL COUNTFSC;            /*                       @Y30LB51*/
         B     @RC00249                                            0253
@RF00249 BAL   @14,COUNTFSC                                        0253
*     ELSE                          /* A LIBRARY FSC WAS SPECIFIED.
*                                                            @Y30LB51*/
*       CALL COUNTFSC;              /*                       @Y30LB51*/
         B     @RC00248                                            0254
@RF00248 BAL   @14,COUNTFSC                                        0254
*   ELSE                            /* AN SSID WAS SPECIFIED.      0255
*                                                            @Y30LB51*/
*     CALL CNTSSID;                 /*                       @Y30LB51*/
         B     @RC00247                                            0255
@RF00247 BAL   @14,CNTSSID                                         0255
*   END REPORTYP;                   /*                       @Y30LB51*/
@EL00008 DS    0H                                                  0256
@EF00008 DS    0H                                                  0256
@ER00008 L     @14,@SA00008                                        0256
         BR    @14                                                 0256
*CNTSSID:                                                          0257
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0257
CNTSSID  ST    @14,@SA00009                                        0257
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS ENTERED WHEN THE USER REQUESTS A REPORT FOR A */
*   /* SPECIFIED SSID. THIS ROUTINE WILL DETERMINE IF THE SSID IN THE*/
*   /* RECORD MATCHES THE SPECIFIED SSID. IF A MATCH IS FOUND ROUTINE*/
*   /* 'COUNTALL' IS CALLED TO COUNT THE RECORD. IF A MATCH IS NOT   */
*   /* FOUND THIS ROUTINE WILL RETURN TO THE CALLER. LSSID CONTAINS  */
*   /* THE USER SPECIFIED SSID. SSIDSAVE CONTAINS THE SSID FROM THE  */
*   /* INPUT RECORD.                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0258
*   TBLPTR=FREEPTR;                 /* SET PTR TO EMPTY ELEMENT.   0258
*                                                            @Y30LB51*/
         L     TBLPTR,FREEPTR(,FSCWKPTR)                           0258
*   IF SSIDSAVE=LSSID THEN          /* IF THIS IS SPECIFIED SSID   0259
*                                                            @Y30LB51*/
         CLC   SSIDSAVE(2,FSCWKPTR),LSSID(FSCWKPTR)                0259
         BNE   @RF00259                                            0259
*     CALL COUNTALL;                /* COUNT THE RECORD.     @Y30LB51*/
         BAL   @14,COUNTALL                                        0260
*   END CNTSSID;                    /*                       @Y30LB51*/
@EL00009 DS    0H                                                  0261
@EF00009 DS    0H                                                  0261
@ER00009 L     @14,@SA00009                                        0261
         BR    @14                                                 0261
*COUNTFSC:                                                         0262
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0262
COUNTFSC ST    @14,@SA00010                                        0262
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS ENTERED WHEN THE USER REQUESTS A REPORT FOR A */
*   /* SPECIFIED FSC. THIS ROUTINE WILL DETERMINE IF THE FSC IN THE  */
*   /* RECORD MATCHES THE SPECIFIED FSC. IF A MATCH IS FOUND THE     */
*   /* ROUTINE 'COUNTALL' IS CALLED TO COUNT THE RECORD. IF A MATCH  */
*   /* IS NOT FOUND THIS ROUTINE RETURNS TO THE CALLER. FSCSAVE1     */
*   /* CONTAINS THE ACCESSOR 1 FSC OR ZERO. FSCSAVE2 CONTAINS THE    */
*   /* ACCESSOR 2 FSC OR ZERO. FSCSYS CONTAINS THE NON-LIBRARY FSC OR*/
*   /* ZERO. LFSC CONTAINS THE USER SPECIFIED LIBRARY FSC OR ZERO.   */
*   /* LFSCSYS CONTAINS THE USER SPECIFED NON-LIBRARY FSC OR ZERO.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0263
*   TBLPTR=FREEPTR;                 /* SET PTR TO EMPTY ELEMENT.   0263
*                                                            @Y30LB51*/
         L     TBLPTR,FREEPTR(,FSCWKPTR)                           0263
*   IF CSREC='1'B THEN              /* IF AN MSC FMT 3 RECORD      0264
*                                                            @Y30LB51*/
         TM    CSREC(FSCWKPTR),B'00001000'                         0264
         BNO   @RF00264                                            0264
*     IF FMT3ACC1='1'B THEN         /* AND IF AN ACCESSOR 1 FSC    0265
*                                                            @Y30LB51*/
         TM    FMT3ACC1(FSCWKPTR),B'10000000'                      0265
         BNO   @RF00265                                            0265
*       IF FSCSAVE1=LFSC THEN       /* AND IF SPECIFIED FSC  @Y30LB51*/
         CLC   FSCSAVE1(4,FSCWKPTR),LFSC(FSCWKPTR)                 0266
         BNE   @RF00266                                            0266
*         DO;                       /* COUNT THIS FSC.       @Y30LB51*/
*           FSCCOUNT='1'B;          /* SET COUNT FSC ONLY SWITCH.  0268
*                                                            @Y30LB51*/
         OI    FSCCOUNT(FSCWKPTR),B'00100000'                      0268
*           CALL COUNTALL;          /* COUNT THE FSC.        @Y30LB51*/
         BAL   @14,COUNTALL                                        0269
*           IF FMT3ACC2='1'B THEN   /* IF AN ACCESSOR 2 FSC, TOO,  0270
*                                                            @Y30LB51*/
         TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0270
         BNO   @RF00270                                            0270
*             IF FSCSAVE2=LFSC THEN /* AND IF IT IS SPECIFIED FSC  0271
*                                                            @Y30LB51*/
         CLC   FSCSAVE2(4,FSCWKPTR),LFSC(FSCWKPTR)                 0271
         BNE   @RF00271                                            0271
*               DO;                 /* COUNT THE FSC.        @Y30LB51*/
*                 FMT3ACC1='0'B;    /* RESET ACCESSOR 1 FSC SWITCH.
*                                                            @Y30LB51*/
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0273
*                 CHNPTR=CHAINTBL;  /* SET PTR TO CHAIN TABLE START.
*                                                            @Y30LB51*/
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0274
*                 CALL COUNTALL;    /* COUNT THIS FSC.       @Y30LB51*/
         BAL   @14,COUNTALL                                        0275
*               END;                /*                       @Y30LB51*/
*             ELSE                                                 0277
*               ;                   /* NOT SPECIFIED FSC.    @Y30LB51*/
@RF00271 DS    0H                                                  0278
*           ELSE                                                   0278
*             ;                     /* NO ACCESSOR 2 FSC.    @Y30LB51*/
@RF00270 DS    0H                                                  0279
*         END;                      /*                       @Y30LB51*/
*       ELSE                        /* NOT SPECIFIED FSC.    @Y30LB51*/
*         IF FMT3ACC2='1'B THEN     /* IF AN ACCESSOR 2 FSC  @Y30LB51*/
         B     @RC00266                                            0280
@RF00266 TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0280
         BNO   @RF00280                                            0280
*           IF FSCSAVE2=LFSC THEN   /* AND IF IT IS SPECIFIED FSC  0281
*                                                            @Y30LB51*/
         CLC   FSCSAVE2(4,FSCWKPTR),LFSC(FSCWKPTR)                 0281
         BNE   @RF00281                                            0281
*             DO;                   /* COUNT THIS FSC.       @Y30LB51*/
*               FMT3ACC1='0'B;      /* RESET ACCESSOR 1 FSC SWITCH.
*                                                            @Y30LB51*/
*               FSCCOUNT='1'B;      /* SET COUNT BY FSC ONLY SWITCH.
*                                                            @Y30LB51*/
         OI    FSCCOUNT(FSCWKPTR),B'00100000'                      0284
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0284
*               CALL COUNTALL;      /* COUNT THE FSC.        @Y30LB51*/
         BAL   @14,COUNTALL                                        0285
*             END;                  /*                       @Y30LB51*/
*           ELSE                                                   0287
*             ;                     /* NOT SPECIFIED FSC.    @Y30LB51*/
@RF00281 DS    0H                                                  0288
*         ELSE                                                     0288
*           ;                       /* NO ACCESSOR 2 FSC.    @Y30LB51*/
@RF00280 DS    0H                                                  0289
*     ELSE                          /* NO ACCESSOR 1 FSC.    @Y30LB51*/
*       DO;                         /* MUST BE ACCESSOR 2 FSC.     0289
*                                                            @Y30LB51*/
         B     @RC00265                                            0289
@RF00265 DS    0H                                                  0290
*         IF FSCSAVE2=LFSC THEN     /* IF SPECIFIED FSC      @Y30LB51*/
         CLC   FSCSAVE2(4,FSCWKPTR),LFSC(FSCWKPTR)                 0290
         BNE   @RF00290                                            0290
*           DO;                     /* COUNT IT.             @Y30LB51*/
*             FMT3ACC1='0'B;        /* RESET ACCESSOR 1 FSC SWITCH.
*                                                            @Y30LB51*/
*             FSCCOUNT='1'B;        /* SET COUNT BY FSC ONLY SWITCH.
*                                                            @Y30LB51*/
         OI    FSCCOUNT(FSCWKPTR),B'00100000'                      0293
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0293
*             CALL COUNTALL;        /* COUNT THE FSC.        @Y30LB51*/
         BAL   @14,COUNTALL                                        0294
*           END;                    /*                       @Y30LB51*/
*         ELSE                                                     0296
*           ;                       /* NOT SPECIFIED FSC.    @Y30LB51*/
@RF00290 DS    0H                                                  0297
*       END;                        /*                       @Y30LB51*/
*   ELSE                            /* NOT MSC FMT 3 RECORD. @Y30LB51*/
*     IF FSCSYSSV=LFSCSYS THEN      /* IF SPECIFIED FSC      @Y30LB51*/
         B     @RC00264                                            0298
@RF00264 CLC   FSCSYSSV(2,FSCWKPTR),LFSCSYS(FSCWKPTR)              0298
         BNE   @RF00298                                            0298
*       CALL COUNTALL;              /* COUNT THIS FSC.       @Y30LB51*/
         BAL   @14,COUNTALL                                        0299
*     ELSE                                                         0300
*       ;                           /* NOT SPECIFIED FSC.    @Y30LB51*/
@RF00298 DS    0H                                                  0301
*   END COUNTFSC;                   /*                       @Y30LB51*/
@EL00010 DS    0H                                                  0301
@EF00010 DS    0H                                                  0301
@ER00010 L     @14,@SA00010                                        0301
         BR    @14                                                 0301
*COUNTYPE:                                                         0302
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0302
COUNTYPE ST    @14,@SA00011                                        0302
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS ENTERED WHEN THE USER REQUESTS A REPORT FOR A */
*   /* SPECIFIED DEVICE TYPE. THIS ROUTINE WILL DETERMINE IF THE     */
*   /* RECORD IS FOR THE SPECIFIED DEVICE TYPE. IF A MATCH IS FOUND  */
*   /* THE ROUTINE 'COUNTALL' IS CALLED TO COUNT THE RECORD. IF A    */
*   /* MATCH IS NOT FOUND THIS ROUTINE RETURNS TO THE CALLER. LTYPE  */
*   /* CONTAINS THE USER SPECIFIED DEVICE TYPE. SSIDDEV CONTAINS THE */
*   /* DEVICE INDICATOR OF THE SSID.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0303
*   IF LTYPE='MS' THEN              /* IF MSC SPECIFIED      @Y30LB51*/
         CLC   LTYPE(2,FSCWKPTR),@CC00495                          0303
         BNE   @RF00303                                            0303
*     IF MSCREC='1'B THEN           /* AND IF MSC RECORD     @Y30LB51*/
         TM    MSCREC(FSCWKPTR),B'10000000'                        0304
         BNO   @RF00304                                            0304
*       CALL COUNTALL;              /* COUNT THE RECORD.     @Y30LB51*/
         BAL   @14,COUNTALL                                        0305
*     ELSE                                                         0306
*       ;                           /* NOT MSC RECORD.       @Y30LB51*/
@RF00304 DS    0H                                                  0307
*   ELSE                            /* MSC NOT SPECIFIED.    @Y30LB51*/
*     IF LTYPE='SA' THEN            /* IF STAGING ADAPTOR SPECIFIED
*                                                            @Y30LB51*/
         B     @RC00303                                            0307
@RF00303 CLC   LTYPE(2,FSCWKPTR),@CC00496                          0307
         BNE   @RF00307                                            0307
*       IF SAREC='1'B THEN          /* AND IF SA RECORD      @Y30LB51*/
         TM    SAREC(FSCWKPTR),B'01000000'                         0308
         BNO   @RF00308                                            0308
*         CALL COUNTALL;            /* COUNT THE RECORD.     @Y30LB51*/
         BAL   @14,COUNTALL                                        0309
*       ELSE                                                       0310
*         ;                         /* NOT SA RECORD.        @Y30LB51*/
@RF00308 DS    0H                                                  0311
*     ELSE                          /* STAGING ADAPTOR NOT SPECIFIED.
*                                                            @Y30LB51*/
*       IF LTYPE='RC' THEN          /* IF R/W CONTROLLER SPECIFIED 0311
*                                                            @Y30LB51*/
         B     @RC00307                                            0311
@RF00307 CLC   LTYPE(2,FSCWKPTR),@CC00497                          0311
         BNE   @RF00311                                            0311
*         IF DRCREC='1'B THEN       /* AND IF DRC RECORD     @Y30LB51*/
         TM    DRCREC(FSCWKPTR),B'00100000'                        0312
         BNO   @RF00312                                            0312
*           CALL COUNTALL;          /* COUNT THE RECORD.     @Y30LB51*/
         BAL   @14,COUNTALL                                        0313
*         ELSE                                                     0314
*           ;                       /* NOT DRC RECORD.       @Y30LB51*/
@RF00312 DS    0H                                                  0315
*       ELSE                        /* R/W CONTROLLER NOT SPECIFIED.
*                                                            @Y30LB51*/
*         IF LTYPE='RD' THEN        /* IF R/W DEVICE SPECIFIED     0315
*                                                            @Y30LB51*/
         B     @RC00311                                            0315
@RF00311 CLC   LTYPE(2,FSCWKPTR),@CC00498                          0315
         BNE   @RF00315                                            0315
*           IF DRDREC='1'B THEN     /* AND IF DRD RECORD     @Y30LB51*/
         TM    DRDREC(FSCWKPTR),B'00010000'                        0316
         BNO   @RF00316                                            0316
*             CALL COUNTALL;        /* COUNT THE RECORD.     @Y30LB51*/
         BAL   @14,COUNTALL                                        0317
*           ELSE                                                   0318
*             ;                     /* NOT DRD RECORD.       @Y30LB51*/
@RF00316 DS    0H                                                  0319
*         ELSE                      /* R/W DEVICE NOT SPECIFIED.   0319
*                                                            @Y30LB51*/
*           IF LTYPE='CS' THEN      /* IF CS DEVICE SPECIFIED      0319
*                                                            @Y30LB51*/
         B     @RC00315                                            0319
@RF00315 CLC   LTYPE(2,FSCWKPTR),@CC00499                          0319
         BNE   @RF00319                                            0319
*             IF CSREC='1'B THEN    /* AND IF CS RECORD      @Y30LB51*/
         TM    CSREC(FSCWKPTR),B'00001000'                         0320
         BNO   @RF00320                                            0320
*               CALL COUNTALL;      /* COUNT THE RECORD.     @Y30LB51*/
         BAL   @14,COUNTALL                                        0321
*             ELSE                                                 0322
*               ;                   /* NOT CS RECORD.        @Y30LB51*/
@RF00320 DS    0H                                                  0323
*           ELSE                    /* CS DEVICE NOT SPECIFIED.    0323
*                                                            @Y30LB51*/
*             IF LTYPE='DA' THEN    /* IF DASD DEVICE SPECIFIED    0323
*                                                            @Y30LB51*/
         B     @RC00319                                            0323
@RF00319 CLC   LTYPE(2,FSCWKPTR),@CC00500                          0323
         BNE   @RF00323                                            0323
*               IF(DAREC='1'B)×(DIRREC='1'B) THEN/* AND IF 3330 OR 0324
*                                      3830 RECORD           @Y30LB51*/
         TM    DAREC(FSCWKPTR),B'00000110'                         0324
         BZ    @RF00324                                            0324
*                 CALL COUNTALL;    /* COUNT THE RECORD.     @Y30LB51*/
         BAL   @14,COUNTALL                                        0325
*               ELSE                                               0326
*                 ;                 /* NOT 3330 OR 3830 RECORD.    0326
*                                                            @Y30LB51*/
@RF00324 DS    0H                                                  0327
*             ELSE                                                 0327
*               ;                   /* DASD RECORD NOT SPECIFIED.  0327
*                                                            @Y30LB51*/
@RF00323 DS    0H                                                  0328
*   END COUNTYPE;                   /*                       @Y30LB51*/
@EL00011 DS    0H                                                  0328
@EF00011 DS    0H                                                  0328
@ER00011 L     @14,@SA00011                                        0328
         BR    @14                                                 0328
*COUNTALL:                                                         0329
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0329
COUNTALL ST    @14,@SA00012                                        0329
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL COUNT ALL RECORDS. THE CHAIN TABLE WILL BE  */
*   /* SEARCHED TO LOCATE THE SSID. IF THE SSID IS FOUND ON THE CHAIN*/
*   /* TABLE ROUTINES 'FMTTHREE' OR 'FMTOTHER' WILL BE CALLED TO     */
*   /* LOCATE THE FSC ON THE SSID CHAIN. IF THE SSID IS NOT FOUND ON */
*   /* THE CHAIN TABLE THE ROUTINE 'NEWELM' WILL BE CALLED TO CREATE */
*   /* A NEW FSC TABLE ELEMENT. CHNPTR POINTS TO THE START OF THE    */
*   /* CHAIN TABLE. FREEPTR POINTS TO THE NEXT FREE SPACE IN THE FSC */
*   /* TABLE. SSIDSAVE CONTAINS THE SSID FROM THE CURRENT INPUT      */
*   /* RECORD.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0330
*   TBLPTR=STARTPTR;                /* SET PTR TO FIRST ELEMENT.   0330
*                                                            @Y30LB51*/
         L     @10,GET0PTR(,FSCWKPTR)                              0330
         L     TBLPTR,STARTPTR(,@10)                               0330
*   DO WHILE((CHNTPTR^=0)&(SSIDSAVE^=CHNSSIDF));/* SEARCH CHAIN TABLE
*                                      FOR END OF TABLE OR FOR SSID.
*                                                            @Y30LB51*/
         B     @DE00331                                            0331
@DL00331 DS    0H                                                  0332
*     CHNPTR=CHNPTR->CHNTPTR;       /*                       @Y30LB51*/
         L     CHNPTR,CHNTPTR(,CHNPTR)                             0332
*   END;                            /*                       @Y30LB51*/
@DE00331 ICM   @10,15,CHNTPTR(CHNPTR)                              0333
         BZ    @DC00331                                            0333
         CLC   SSIDSAVE(2,FSCWKPTR),CHNSSIDF(CHNPTR)               0333
         BNE   @DL00331                                            0333
@DC00331 DS    0H                                                  0334
*   IF CHNTPTR=0 THEN               /* IF AT END OF TABLE    @Y30LB51*/
         ICM   @10,15,CHNTPTR(CHNPTR)                              0334
         BNZ   @RF00334                                            0334
*     DO;                           /* CREATE A NEW FSC TABLE      0335
*                                      ELEMENT.              @Y30LB51*/
*       CHNSSIDF=SSIDSAVE;          /* PLACE SSID IN CHAIN TABLE.  0336
*                                                            @Y30LB51*/
         MVC   CHNSSIDF(2,CHNPTR),SSIDSAVE(FSCWKPTR)               0336
*       FSCTPTR=FREEPTR;            /* SET PTR TO NEW FSC TABLE    0337
*                                      ELEMENT.              @Y30LB51*/
         MVC   FSCTPTR(4,CHNPTR),FREEPTR(FSCWKPTR)                 0337
*       CALL NEWELM;                /* CREATE NEW FSC TABLE ELEMENT.
*                                                            @Y30LB51*/
         BAL   @14,NEWELM                                          0338
*       PTRSAVE=CHNPTR;             /* SAVE PTR TO CURRENT SPACE.  0339
*                                                            @Y30LB51*/
         ST    CHNPTR,PTRSAVE(,FSCWKPTR)                           0339
*       CHNPTR=CHNPTR+LENGTH(CHNTBL);/*                            0340
*                                      GET ADDRESS NEXT SPACE.     0340
*                                                            @Y30LB51*/
         AH    CHNPTR,@CH00119                                     0340
*       PTRSAVE->CHNTPTR=CHNPTR;    /* ADD CURRENT SPACE TO CHAIN. 0341
*                                                            @Y30LB51*/
         L     @10,PTRSAVE(,FSCWKPTR)                              0341
         ST    CHNPTR,CHNTPTR(,@10)                                0341
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* SSID FOUND IN TABLE.  @Y30LB51*/
*     DO;                           /*                       @Y30LB51*/
         B     @RC00334                                            0343
@RF00334 DS    0H                                                  0344
*       TBLPTR=CHNPTR->FSCTPTR;     /* SET PTR TO SSID CHAIN START.
*                                                            @Y30LB51*/
         L     TBLPTR,FSCTPTR(,CHNPTR)                             0344
*       IF CSREC='1'B THEN          /* IF MSC FMT 3 RECORD   @Y30LB51*/
         TM    CSREC(FSCWKPTR),B'00001000'                         0345
         BNO   @RF00345                                            0345
*         CALL FMTTHREE;            /* PROCESS THE LIBRARY FSCS.   0346
*                                                            @Y30LB51*/
         BAL   @14,FMTTHREE                                        0346
*       ELSE                        /* NOT AN MSC FMT 3 RECORD SO  0347
*                                                            @Y30LB51*/
*         CALL FMTOTHER;            /* PROCESS THE NON-LIBRARY FSC.
*                                                            @Y30LB51*/
         B     @RC00345                                            0347
@RF00345 BAL   @14,FMTOTHER                                        0347
*     END;                          /*                       @Y30LB51*/
*   END COUNTALL;                   /*                       @Y30LB51*/
@EL00012 DS    0H                                                  0349
@EF00012 DS    0H                                                  0349
@ER00012 L     @14,@SA00012                                        0349
         BR    @14                                                 0349
*NEWELM:                                                           0350
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0350
NEWELM   ST    @14,@SA00013                                        0350
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE IF SPACE IS AVAILABLE IN THE FSC  */
*   /* TABLE BEFORE ADDING A NEW ELEMENT TO IT.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0351
*   IF ADDCORE='1'B THEN            /* IF SPACE NEEDED IN FSC TABLE
*                                                            @Y30LB51*/
         TM    ADDCORE(FSCWKPTR),B'00000001'                       0351
         BNO   @RF00351                                            0351
*     DO;                           /* GET THE SPACE AND ADD IT TO 0352
*                                      CHAIN.                @Y30LB51*/
*       CALL GETMORE;               /* GET THE SPACE.        @Y30LB51*/
         BAL   @14,GETMORE                                         0353
*       IF FSCRETCD=0 THEN          /* IF SPACE WAS AVAILABLE      0354
*                                                            @Y30LB51*/
         LTR   FSCRETCD,FSCRETCD                                   0354
         BNZ   @RF00354                                            0354
*         DO;                       /* CREATE THE NEW ELEMENT.     0355
*                                                            @Y30LB51*/
*           FSCTPTR=FREEPTR;        /* SET PTR TO NEW FSC TABLE    0356
*                                      ELEMENT.              @Y30LB51*/
         MVC   FSCTPTR(4,CHNPTR),FREEPTR(FSCWKPTR)                 0356
*           CALL CREATELM;          /* CREATE THE ELEMENT.   @Y30LB51*/
         BAL   @14,CREATELM                                        0357
*         END;                      /*                       @Y30LB51*/
*       ELSE                                                       0359
*         ;                         /* SPACE WAS NOT AVAILABLE.    0359
*                                                            @Y30LB51*/
@RF00354 DS    0H                                                  0360
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* THERE IS SPACE IN FSC TABLE.
*                                                            @Y30LB51*/
*     CALL CREATELM;                /* CREATE THE ELEMENT.   @Y30LB51*/
         B     @RC00351                                            0361
@RF00351 BAL   @14,CREATELM                                        0361
*   END NEWELM;                     /*                       @Y30LB51*/
@EL00013 DS    0H                                                  0362
@EF00013 DS    0H                                                  0362
@ER00013 L     @14,@SA00013                                        0362
         BR    @14                                                 0362
*CREATELM:                                                         0363
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0363
CREATELM ST    @14,@SA00014                                        0363
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL CREATE A NEW ELEMENT TO BE ADDED TO THE FSC */
*   /* TABLE.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   CALL PUTREC;                    /* PUT DATA IN FSC TABLE.      0364
*                                                            @Y30LB51*/
         BAL   @14,PUTREC                                          0364
*   SSIDCTR=SSIDCTR+1;              /* ADD ONE TO SSID COUNTER.    0365
*                                                            @Y30LB51*/
         LA    @10,1                                               0365
         AH    @10,SSIDCTR(,FSCWKPTR)                              0365
         STH   @10,SSIDCTR(,FSCWKPTR)                              0365
*   IF SSIDCTR=SSIDCT THEN          /* IF CHAIN TABLE FULL   @Y30LB51*/
         CH    @10,SSIDCT(,FSCWKPTR)                               0366
         BNE   @RF00366                                            0366
*     FSCRETCD=TBLFULL;             /* TELL THE CONTROLLER.  @Y30LB51*/
         LA    FSCRETCD,12                                         0367
*   ELSE                            /* CHAIN TABLE NOT FULL. @Y30LB51*/
*     DO;                           /*                       @Y30LB51*/
         B     @RC00366                                            0368
@RF00366 DS    0H                                                  0369
*       FREEPTR=FREEPTR+LENGTH(FSCTBL);/*                          0369
*                                      SET PTR TO NEXT SPACE.      0369
*                                                            @Y30LB51*/
         LA    @10,44                                              0369
         AL    @10,FREEPTR(,FSCWKPTR)                              0369
         ST    @10,FREEPTR(,FSCWKPTR)                              0369
*       IF FREEPTR>ENDPTR THEN      /* IF NO MORE SPACE IN TABLE   0370
*                                                            @Y30LB51*/
         L     @01,GET0PTR(,FSCWKPTR)                              0370
         C     @10,ENDPTR(,@01)                                    0370
         BNH   @RF00370                                            0370
*         ADDCORE='1'B;             /* SET ADD CORE SWITCH.  @Y30LB51*/
         OI    ADDCORE(FSCWKPTR),B'00000001'                       0371
*       ELSE                                                       0372
*         ;                         /* SPACE REMAINING IN TABLE.   0372
*                                                            @Y30LB51*/
@RF00370 DS    0H                                                  0373
*       IF FSCCOUNT='0'B THEN       /* IF NOT COUNTING BY FSC ONLY 0373
*                                                            @Y30LB51*/
         TM    FSCCOUNT(FSCWKPTR),B'00100000'                      0373
         BNZ   @RF00373                                            0373
*         IF FMT3ACC2='1'B THEN     /* AND IF ACCESSOR 2 FSC @Y30LB51*/
         TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0374
         BNO   @RF00374                                            0374
*           DO;                     /* PUT IT IN THE TABLE.  @Y30LB51*/
*             TBLPTRSV=TBLPTR;      /* SAVE PTR TO CURRENT SPACE.  0376
*                                                            @Y30LB51*/
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0376
*             CALL ACCESTWO;        /* PUT ACCESSOR 2 FSC IN TABLE.
*                                                            @Y30LB51*/
         BAL   @14,ACCESTWO                                        0377
*           END;                    /*                       @Y30LB51*/
*         ELSE                                                     0379
*           ;                       /* NO ACCESSOR 2 FSC.    @Y30LB51*/
@RF00374 DS    0H                                                  0380
*     END;                          /*                       @Y30LB51*/
*   END CREATELM;                   /*                       @Y30LB51*/
@EL00014 DS    0H                                                  0381
@EF00014 DS    0H                                                  0381
@ER00014 L     @14,@SA00014                                        0381
         BR    @14                                                 0381
*PUTREC:                                                           0382
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0382
PUTREC   ST    @14,@SA00015                                        0382
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL PUT THE DATA FROM THE INPUT RECORD INTO THE */
*   /* FSC TABLE.                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0383
*   TBLPTR=FREEPTR;                 /* SET PTR TO FREE SPACE.      0383
*                                                            @Y30LB51*/
         L     TBLPTR,FREEPTR(,FSCWKPTR)                           0383
*   FSCDT=DATETIME;                 /* PUT TIME INTO TABLE.  @Y30LB51*/
         L     @10,LOGPTR(,FSCWKPTR)                               0384
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0384
*   FSCCTR=FSCCTR+1;                /* INITIALIZE RECORD COUNTER.  0385
*                                                            @Y30LB51*/
         LA    @10,1                                               0385
         AH    @10,FSCCTR(,TBLPTR)                                 0385
         STH   @10,FSCCTR(,TBLPTR)                                 0385
*   FSCSSID=SSIDSAVE;               /* PUT SSID/CUA INTO TABLE.    0386
*                                                            @Y30LB51*/
         XC    FSCSSID+2(2,TBLPTR),FSCSSID+2(TBLPTR)               0386
         MVC   FSCSSID(2,TBLPTR),SSIDSAVE(FSCWKPTR)                0386
*   IF CSREC='1'B THEN              /* IF FMT 3 RECORD       @Y30LB51*/
         TM    CSREC(FSCWKPTR),B'00001000'                         0387
         BNO   @RF00387                                            0387
*     IF FMT3ACC1='1'B THEN         /* AND IF ACC 1 FSC      @Y30LB51*/
         TM    FMT3ACC1(FSCWKPTR),B'10000000'                      0388
         BNO   @RF00388                                            0388
*       DO;                         /* PUT FSC IN TABLE.     @Y30LB51*/
*         FSCFSC=FSCSAVE1;          /* PUT FSC INTO TABLE.   @Y30LB51*/
         MVC   FSCFSC(4,TBLPTR),FSCSAVE1(FSCWKPTR)                 0390
*         FMT3ACC1='0'B;            /* RESET FSC FLAG.       @Y30LB51*/
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0391
*       END;                        /*                       @Y30LB51*/
*     ELSE                          /* NO ACCESSOR 1 FSC,    @Y30LB51*/
*       DO;                         /* PUT ACCESSOR 2 FSC INTO TABLE.
*                                                            @Y30LB51*/
         B     @RC00388                                            0393
@RF00388 DS    0H                                                  0394
*         FSCFSC=FSCSAVE2;          /* PUT FSC INTO TABLE.   @Y30LB51*/
         MVC   FSCFSC(4,TBLPTR),FSCSAVE2(FSCWKPTR)                 0394
*         FMT3ACC2='0'B;            /* RESET FLAG.           @Y30LB51*/
         NI    FMT3ACC2(FSCWKPTR),B'10111111'                      0395
*       END;                        /*                       @Y30LB51*/
*   ELSE                            /* NOT FMT 3 RECORD.     @Y30LB51*/
*     FSCSYS=FSCSYSSV;              /* PUT FSC INTO TABLE.   @Y30LB51*/
         B     @RC00387                                            0397
@RF00387 MVC   FSCSYS(2,TBLPTR),FSCSYSSV(FSCWKPTR)                 0397
*   IF MSCREC='1'B THEN             /* IF MSC RECORD         @Y30LB51*/
@RC00387 TM    MSCREC(FSCWKPTR),B'10000000'                        0398
         BNO   @RF00398                                            0398
*     MSCFLAG='1'B;                 /* SET FLAG.             @Y30LB51*/
         OI    MSCFLAG(TBLPTR),B'10000000'                         0399
*   ELSE                            /* NOT MSC RECORD.       @Y30LB51*/
*     IF SAREC='1'B THEN            /* IF SA RECORD          @Y30LB51*/
         B     @RC00398                                            0400
@RF00398 TM    SAREC(FSCWKPTR),B'01000000'                         0400
         BNO   @RF00400                                            0400
*       SAFLAG='1'B;                /* SET FLAG.             @Y30LB51*/
         OI    SAFLAG(TBLPTR),B'01000000'                          0401
*     ELSE                          /* NOT SA RECORD.        @Y30LB51*/
*       IF DRCREC='1'B THEN         /* IF DRC RECORD         @Y30LB51*/
         B     @RC00400                                            0402
@RF00400 TM    DRCREC(FSCWKPTR),B'00100000'                        0402
         BNO   @RF00402                                            0402
*         DRCFLAG='1'B;             /* SET DRC FLAG.         @Y30LB51*/
         OI    DRCFLAG(TBLPTR),B'00100000'                         0403
*       ELSE                        /* NOT DRC RECORD.       @Y30LB51*/
*         IF DRDREC='1'B THEN       /* IF DRD RECORD         @Y30LB51*/
         B     @RC00402                                            0404
@RF00402 TM    DRDREC(FSCWKPTR),B'00010000'                        0404
         BNO   @RF00404                                            0404
*           DRDFLAG='1'B;           /* SET DRD FLAG.         @Y30LB51*/
         OI    DRDFLAG(TBLPTR),B'00010000'                         0405
*         ELSE                      /* NOT DRD RECORD.       @Y30LB51*/
*           IF CSREC='1'B THEN      /* IF CS RECORD          @Y30LB51*/
         B     @RC00404                                            0406
@RF00404 TM    CSREC(FSCWKPTR),B'00001000'                         0406
         BNO   @RF00406                                            0406
*             CSFLAG='1'B;          /* SET FLAG.             @Y30LB51*/
         OI    CSFLAG(TBLPTR),B'00001000'                          0407
*           ELSE                    /* NOT CS RECORD.        @Y30LB51*/
*             IF DIRREC='1'B THEN   /* IF 3830 RECORD        @Y30LB51*/
         B     @RC00406                                            0408
@RF00406 TM    DIRREC(FSCWKPTR),B'00000100'                        0408
         BNO   @RF00408                                            0408
*               DO;                 /* SET COUNTERS AND FLAG.      0409
*                                                            @ZD00149*/
*                 DIRFLAG='1'B;     /* SET FLAG.             @Y30LB51*/
         OI    DIRFLAG(TBLPTR),B'00000100'                         0410
*                 CALL PUTDEV;      /* INITIALIZE DEVICE COUNTER.  0411
*                                                            @ZD00149*/
         BAL   @14,PUTDEV                                          0411
*               END;                /*                       @ZD00149*/
*             ELSE                  /* NOT 3830 RECORD.      @Y30LB51*/
*               DO;                 /* SET COUNTERS AND FLAG.      0413
*                                                            @ZD00149*/
         B     @RC00408                                            0413
@RF00408 DS    0H                                                  0414
*                 DAFLAG='1'B;      /* SET 3330 FLAG.        @Y30LB51*/
         OI    DAFLAG(TBLPTR),B'00000010'                          0414
*                 CALL PUTDEV;      /* INITIALIZE DEVICE COUNTER.  0415
*                                                            @ZD00149*/
         BAL   @14,PUTDEV                                          0415
*               END;                /*                       @ZD00149*/
*   IF DASDREC='1'B THEN            /* IF DASD RECORD        @Y30LB51*/
@RC00408 DS    0H                                                  0417
@RC00406 DS    0H                                                  0417
@RC00404 DS    0H                                                  0417
@RC00402 DS    0H                                                  0417
@RC00400 DS    0H                                                  0417
@RC00398 TM    DASDREC(FSCWKPTR),B'00000001'                       0417
         BNO   @RF00417                                            0417
*     DO;                           /* SET DASD FLAGS.       @Y30LB51*/
*       DASDFLAG='1'B;              /* SET DASD RECORD FLAG. @Y30LB51*/
         OI    DASDFLAG(TBLPTR),B'00000001'                        0419
*       IF INDEVTYP='R' THEN        /* IF REAL DASD DEVICE   @Y30LB51*/
         L     @10,SDA00PTR(,CVTPTR)                               0420
         CLI   INDEVTYP(@10),C'R'                                  0420
         BNE   @RF00420                                            0420
*         REALDASD='1'B;            /* SET REAL DASD DEVICE FLAG.  0421
*                                                            @Y30LB51*/
         OI    REALDASD(TBLPTR),B'10000000'                        0421
*       ELSE                        /* NOT REAL DASD DEVICE, @Y30LB51*/
*         VIRTDASD='1'B;            /* SET VIRTUAL DASD DEVICE FLAG.
*                                                            @Y30LB51*/
         B     @RC00420                                            0422
@RF00420 OI    VIRTDASD(TBLPTR),B'01000000'                        0422
*     END;                          /*                       @Y30LB51*/
*   ELSE                                                           0424
*     ;                             /* NOT A DASD RECORD.    @Y30LB51*/
@RF00417 DS    0H                                                  0425
*   IF SDAFLAG0(8)='1'B THEN        /* IF GENERATED FSC      @Y30LB51*/
@RC00417 L     @10,SDA00PTR(,CVTPTR)                               0425
         TM    SDAFLAG0(@10),B'00000001'                           0425
         BNO   @RF00425                                            0425
*     FAKEFSC='1'B;                 /* SET FLAG.             @Y30LB51*/
         OI    FAKEFSC(TBLPTR),B'00100000'                         0426
*   ELSE                            /* NOT GENERATED FSC.    @Y30LB51*/
*     IF WORKAPR='1'B THEN          /* IF SSID ALTERED       @Y30LB51*/
         B     @RC00425                                            0427
@RF00425 TM    WORKAPR(FSCWKPTR),B'00010000'                       0427
         BNO   @RF00427                                            0427
*       FSCAPR='1'B;                /* SET FLAG.             @Y30LB51*/
         OI    FSCAPR(TBLPTR),B'00010000'                          0428
*     ELSE                                                         0429
*       ;                           /* SSID NOT ALTERED.     @Y30LB51*/
@RF00427 DS    0H                                                  0430
*   TBLELMCT=TBLELMCT+1;            /* ADD ONE TO ELEMENT COUNTER. 0430
*                                                            @Y30LB51*/
@RC00425 LA    @10,1                                               0430
         AH    @10,TBLELMCT(,FSCWKPTR)                             0430
         STH   @10,TBLELMCT(,FSCWKPTR)                             0430
*   END PUTREC;                     /*                       @Y30LB51*/
@EL00015 DS    0H                                                  0431
@EF00015 DS    0H                                                  0431
@ER00015 L     @14,@SA00015                                        0431
         BR    @14                                                 0431
*FMTTHREE:                                                         0432
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0432
FMTTHREE ST    @14,@SA00016                                        0432
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL COUNT LIBRARY (MSC FMT 3) RECORDS. TBLPTR   */
*   /* CONTAINS POINTER TO START OF SSID CHAIN. FSCSPTR CONTAINS     */
*   /* POINTER TO NEXT ELEMENT ON SSID CHAIN (ZERO INDICATES END OF  */
*   /* SSID CHAIN). FSCSAVE1 CONTAINS FSC FOR ACCESSOR ONE OR ZERO.  */
*   /* FSCSAVE2 CONTAINS FSC FOR ACCESSOR TWO OR ZERO.               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0433
*   IF FMT3ACC1='1'B THEN           /* IF ACCESSOR 1 FSC     @Y30LB51*/
         TM    FMT3ACC1(FSCWKPTR),B'10000000'                      0433
         BNO   @RF00433                                            0433
*     DO;                           /* SEARCH FOR IT IN TABLE.     0434
*                                                            @Y30LB51*/
*       DO WHILE((TBLPTR^=0)&(FSCSAVE1^=FSCFSC));/* SEARCH SSID CHAIN
*                                      FOR SSID OR FOR END OF CHAIN.
*                                                            @Y30LB51*/
         B     @DE00435                                            0435
@DL00435 DS    0H                                                  0436
*         TBLPTRSV=TBLPTR;          /* SAVE PTR TO THIS SPACE.     0436
*                                                            @Y30LB51*/
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0436
*         TBLPTR=FSCSPTR;           /* GET PTR TO NEXT SPACE.      0437
*                                                            @Y30LB51*/
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0437
*       END;                        /*                       @Y30LB51*/
@DE00435 LTR   TBLPTR,TBLPTR                                       0438
         BZ    @DC00435                                            0438
         CLC   FSCSAVE1(4,FSCWKPTR),FSCFSC(TBLPTR)                 0438
         BNE   @DL00435                                            0438
@DC00435 DS    0H                                                  0439
*       IF TBLPTR=0 THEN            /* IF AT END OF CHAIN    @Y30LB51*/
         LTR   TBLPTR,TBLPTR                                       0439
         BNZ   @RF00439                                            0439
*         DO;                       /* CREATE NEW ELEMENT AND      0440
*                                                            @Y30LB51*/
*           CALL NEXTELM;           /* ADD IT TO THE CHAIN.  @Y30LB51*/
         BAL   @14,NEXTELM                                         0441
*           IF FMT3ACC2='1'B THEN   /* IF ACCESSOR 2 FSC     @Y30LB51*/
         TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0442
         BNO   @RF00442                                            0442
*             CALL ACCESTWO;        /* ADD IT TO THE CHAIN.  @Y30LB51*/
         BAL   @14,ACCESTWO                                        0443
*           ELSE                                                   0444
*             ;                     /* NO ACCESSOR 2 FSC     @Y30LB51*/
@RF00442 DS    0H                                                  0445
*         END;                      /*                       @Y30LB51*/
*       ELSE                        /* FSC FOUND ON CHAIN.   @Y30LB51*/
*         DO;                       /*                       @Y30LB51*/
         B     @RC00439                                            0446
@RF00439 DS    0H                                                  0447
*           FSCCTR=FSCCTR+1;        /* ADD ONE TO RECORD COUNTER.  0447
*                                                            @Y30LB51*/
         LA    @10,1                                               0447
         AH    @10,FSCCTR(,TBLPTR)                                 0447
         STH   @10,FSCCTR(,TBLPTR)                                 0447
*           FSCDT=DATETIME;         /* PUT DATE IN TABLE.    @Y30LB51*/
         L     @10,LOGPTR(,FSCWKPTR)                               0448
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0448
*           FMT3ACC1='0'B;          /* RESET ACCESSOR 1 FSC FLAG.  0449
*                                                            @Y30LB51*/
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0449
*           IF FMT3ACC2='1'B THEN   /* IF ACCESSOR 2 FSC     @Y30LB51*/
         TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0450
         BNO   @RF00450                                            0450
*             CALL ACCESTWO;        /* PUT IT IN TABLE.      @Y30LB51*/
         BAL   @14,ACCESTWO                                        0451
*           ELSE                                                   0452
*             ;                     /* NO ACCESSOR 2 FSC.    @Y30LB51*/
@RF00450 DS    0H                                                  0453
*         END;                      /*                       @Y30LB51*/
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* NO ACCESSOR 1 FSC,    @Y30LB51*/
*     DO;                           /* MUST BE ACCESSOR TWO FSC.   0455
*                                                            @Y30LB51*/
         B     @RC00433                                            0455
@RF00433 DS    0H                                                  0456
*       DO WHILE((TBLPTR^=0)&(FSCSAVE2^=FSCFSC));/* SEARCH SSID CHAIN
*                                      FOR SSID OR FOR END OF CHAIN.
*                                                            @Y30LB51*/
         B     @DE00456                                            0456
@DL00456 DS    0H                                                  0457
*         TBLPTRSV=TBLPTR;          /* SAVE PTR TO CURRENT SPACE.  0457
*                                                            @Y30LB51*/
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0457
*         TBLPTR=FSCSPTR;           /* SET PTR TO NEXT SPACE.      0458
*                                                            @Y30LB51*/
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0458
*       END;                        /*                       @Y30LB51*/
@DE00456 LTR   TBLPTR,TBLPTR                                       0459
         BZ    @DC00456                                            0459
         CLC   FSCSAVE2(4,FSCWKPTR),FSCFSC(TBLPTR)                 0459
         BNE   @DL00456                                            0459
@DC00456 DS    0H                                                  0460
*       IF TBLPTR=0 THEN            /* IF AT END OF CHAIN    @Y30LB51*/
         LTR   TBLPTR,TBLPTR                                       0460
         BNZ   @RF00460                                            0460
*         CALL NEXTELM;             /* ADD NEW ELEMENT TO CHAIN.   0461
*                                                            @Y30LB51*/
         BAL   @14,NEXTELM                                         0461
*       ELSE                        /* FSC FOUND ON CHAIN.   @Y30LB51*/
*         DO;                       /*                       @Y30LB51*/
         B     @RC00460                                            0462
@RF00460 DS    0H                                                  0463
*           FSCCTR=FSCCTR+1;        /* ADD ONE TO RECORD COUNTER.  0463
*                                                            @Y30LB51*/
         LA    @10,1                                               0463
         AH    @10,FSCCTR(,TBLPTR)                                 0463
         STH   @10,FSCCTR(,TBLPTR)                                 0463
*           FSCDT=DATETIME;         /* PUT TIME/DATE IN TABLE.     0464
*                                                            @Y30LB51*/
         L     @10,LOGPTR(,FSCWKPTR)                               0464
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0464
*         END;                      /*                       @Y30LB51*/
*     END;                          /*                       @Y30LB51*/
*   END FMTTHREE;                   /*                       @Y30LB51*/
@EL00016 DS    0H                                                  0467
@EF00016 DS    0H                                                  0467
@ER00016 L     @14,@SA00016                                        0467
         BR    @14                                                 0467
*FMTOTHER:                                                         0468
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0468
FMTOTHER ST    @14,@SA00017                                        0468
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL COUNT NON-LIBRARY RECORDS. FSCSYSSV CONTAINS*/
*   /* THE FSC.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0469
*   DO WHILE((TBLPTR^=0)&(FSCSYSSV^=FSCSYS));/* SEARCH SSID CHAIN FOR
*                                      FSC OR FOR END OF CHAIN.    0469
*                                                            @Y30LB51*/
         B     @DE00469                                            0469
@DL00469 DS    0H                                                  0470
*     TBLPTRSV=TBLPTR;              /* SAVE PTR TO THIS ELEMENT.   0470
*                                                            @Y30LB51*/
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0470
*     TBLPTR=TBLPTR->FSCSPTR;       /* GET PTR TO NEXT ELEMENT.    0471
*                                                            @Y30LB51*/
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0471
*   END;                            /*                       @Y30LB51*/
@DE00469 LTR   TBLPTR,TBLPTR                                       0472
         BZ    @DC00469                                            0472
         CLC   FSCSYSSV(2,FSCWKPTR),FSCSYS(TBLPTR)                 0472
         BNE   @DL00469                                            0472
@DC00469 DS    0H                                                  0473
*   IF TBLPTR=0 THEN                /* IF AT END OF CHAIN    @Y30LB51*/
         LTR   TBLPTR,TBLPTR                                       0473
         BNZ   @RF00473                                            0473
*     CALL NEXTELM;                 /* ADD NEW ELEMENT TO TABLE.   0474
*                                                            @Y30LB51*/
         BAL   @14,NEXTELM                                         0474
*   ELSE                            /* FSC FOUND ON CHAIN.   @Y30LB51*/
*     DO;                           /*                       @Y30LB51*/
         B     @RC00473                                            0475
@RF00473 DS    0H                                                  0476
*       FSCCTR=FSCCTR+1;            /* INCREMENT RECORD COUNTER.   0476
*                                                            @Y30LB51*/
         LA    @10,1                                               0476
         AH    @10,FSCCTR(,TBLPTR)                                 0476
         STH   @10,FSCCTR(,TBLPTR)                                 0476
*       FSCDT=DATETIME;             /* PUT DATE/TIME IN TABLE.     0477
*                                                            @Y30LB51*/
         L     @10,LOGPTR(,FSCWKPTR)                               0477
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0477
*       IF((FORMATNO(6)='1'B)×(DASDREC='1'B)) THEN/* IF THIS IS    0478
*                                      FORMAT 5 OR DASD RECORD     0478
*                                                            @ZD00149*/
         L     @10,SENSEPTR(,FSCWKPTR)                             0478
         TM    FORMATNO(@10),B'00000100'                           0478
         BO    @RT00478                                            0478
         TM    DASDREC(FSCWKPTR),B'00000001'                       0478
         BNO   @RF00478                                            0478
@RT00478 DS    0H                                                  0479
*         CALL PUTDEV;              /* ADD ONE TO THE DEVICE COUNTER.
*                                                            @ZD00149*/
         BAL   @14,PUTDEV                                          0479
*       ELSE                                                       0480
*         ;                         /* NOT A FORMAT 5 OR DASD RECORD.
*                                                            @ZD00149*/
@RF00478 DS    0H                                                  0481
*     END;                          /*                       @Y30LB51*/
*   END FMTOTHER;                   /*                       @Y30LB51*/
@EL00017 DS    0H                                                  0482
@EF00017 DS    0H                                                  0482
@ER00017 L     @14,@SA00017                                        0482
         BR    @14                                                 0482
*PUTDEV:                                                           0483
*   PROC OPTIONS(SAVE(14));         /*                       @ZD00149*/
*                                                                  0483
PUTDEV   ST    @14,12(,@13)                                        0483
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE THE SPINDLE ID AND ADD ONE TO THE */
*   /* DEVICE COUNTER FOR THAT SPINDLE.                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   IF INDEVTYP='S' THEN            /* IF THIS IS FORMAT 5 RECORD  0484
*                                                            @ZD00149*/
         L     @10,SDA00PTR(,CVTPTR)                               0484
         CLI   INDEVTYP(@10),C'S'                                  0484
         BNE   @RF00484                                            0484
*     DEVBYTEA=DRIVEID;             /* GET THE DRIVE ID.     @ZD00149*/
         L     @10,SENSEPTR(,FSCWKPTR)                             0485
         MVC   DEVBYTEA(1,FSCWKPTR),DRIVEID(@10)                   0485
*   ELSE                            /* THIS IS A DASD RECORD,      0486
*                                                            @ZD00149*/
*     DEVBYTEA=DRIVE;               /* GET ITS DEVICE ID.    @ZD00149*/
         B     @RC00484                                            0486
@RF00484 L     @10,SENSEPTR(,FSCWKPTR)                             0486
         MVC   DEVBYTEA(1,FSCWKPTR),DRIVE(@10)                     0486
*   IF DEVBYTEA^='00'X&DEVBYTEA^='FF'X THEN /* VALID ID      @ZA05081*/
@RC00484 CLI   DEVBYTEA(FSCWKPTR),X'00'                            0487
         BE    @RF00487                                            0487
         CLI   DEVBYTEA(FSCWKPTR),X'FF'                            0487
         BE    @RF00487                                            0487
*     DO;                           /* FIND THE DEVICE ID.   @ZD00149*/
*       CNTLUNIT=DEVBYTEA;          /* GET THE CONTROL UNIT ID,    0489
*                                                            @ZD00149*/
         MVC   CNTLUNIT(1,TBLPTR),DEVBYTEA(FSCWKPTR)               0489
*       SRL(CNTLUNIT,6);            /* ISOLATE IT            @ZD00149*/
         SLR   @10,@10                                             0490
         IC    @10,CNTLUNIT(,TBLPTR)                               0490
         SRL   @10,6                                               0490
         STC   @10,CNTLUNIT(,TBLPTR)                               0490
*       CNTLUNIT=CNTLUNIT×'F0'X;    /* AND CONVERT IT TO PRINTABLE.
*                                                            @ZD00149*/
         OI    CNTLUNIT(TBLPTR),X'F0'                              0491
*       DEVBYTEA=DEVBYTEA&'3F'X;    /* RESET UNNEEDED BITS.  @ZD00149*/
         NI    DEVBYTEA(FSCWKPTR),X'3F'                            0492
*       DO I=1 TO 8 WHILE(DEVBYTEA^=DEVICES(I));/* FIND THE DEVICE 0493
*                                      ID.                   @ZD00149*/
         LA    @10,1                                               0493
         STH   @10,I(,FSCWKPTR)                                    0493
@DL00493 LH    @10,I(,FSCWKPTR)                                    0493
         LA    @01,DEVICES-1(@10)                                  0493
         CLC   DEVBYTEA(1,FSCWKPTR),0(@01)                         0493
         BE    @DC00493                                            0493
*       END;                        /*                       @ZD00149*/
         LA    @10,1                                               0494
         AH    @10,I(,FSCWKPTR)                                    0494
         STH   @10,I(,FSCWKPTR)                                    0494
         CH    @10,@CH00070                                        0494
         BNH   @DL00493                                            0494
@DC00493 DS    0H                                                  0495
*       IF I<9 THEN                 /* IF DEVICE ID FOUND    @ZD00149*/
         LH    @10,I(,FSCWKPTR)                                    0495
         CH    @10,@CH00535                                        0495
         BNL   @RF00495                                            0495
*         DUMCTR(I)=DUMCTR(I)+1;    /* ADD ONE TO DEVICE COUNTER.  0496
*                                                            @ZD00149*/
         ALR   @10,@10                                             0496
         LA    @15,1                                               0496
         ST    @10,@TF00001                                        0496
         ALR   @10,TBLPTR                                          0496
         SLR   @14,@14                                             0496
         ICM   @14,3,DUMCTR-2(@10)                                 0496
         ALR   @15,@14                                             0496
         L     @10,@TF00001                                        0496
         STH   @15,DUMCTR-2(@10,TBLPTR)                            0496
*      ELSE                                                        0497
*        ;                          /*                       @ZD00149*/
@RF00495 DS    0H                                                  0498
*     END;                          /*                       @ZD00149*/
*   ELSE                                                           0499
*     ;                             /* DEVICE ID NOT PRESENT.      0499
*                                                            @ZD00149*/
@RF00487 DS    0H                                                  0500
*   END PUTDEV;                     /*                       @ZD00149*/
@EL00018 DS    0H                                                  0500
@EF00018 DS    0H                                                  0500
@ER00018 L     @14,12(,@13)                                        0500
         BR    @14                                                 0500
*NEXTELM:                                                          0501
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0501
NEXTELM  ST    @14,@SA00019                                        0501
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE IF SPACE IS AVAILABLE IN THE FSC  */
*   /* TABLE BEFORE ADDING A NEW ELEMENT TO AN EXISTING SSID CHAIN.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0502
*   IF ADDCORE='1'B THEN            /* IF MORE SPACE IS NEEDED     0502
*                                                            @Y30LB51*/
         TM    ADDCORE(FSCWKPTR),B'00000001'                       0502
         BNO   @RF00502                                            0502
*     DO;                           /* GET IT AND ADD IT TO CHAIN. 0503
*                                                            @Y30LB51*/
*       CALL GETMORE;               /* GET ADDED FSC TABLE SPACE.  0504
*                                                            @Y30LB51*/
         BAL   @14,GETMORE                                         0504
*       IF FSCRETCD=0 THEN          /* IF SPACE OBTAINED     @Y30LB51*/
         LTR   FSCRETCD,FSCRETCD                                   0505
         BNZ   @RF00505                                            0505
*         CALL ADDELM;              /* ADD NEW ELEMENT TO SSID CHAIN.
*                                                            @Y30LB51*/
         BAL   @14,ADDELM                                          0506
*       ELSE                                                       0507
*         ;                         /* ADDED SPACE UNAVAILABLE.    0507
*                                                            @Y30LB51*/
@RF00505 DS    0H                                                  0508
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* SPACE IS AVAILABLE IN TABLE.
*                                                            @Y30LB51*/
*     CALL ADDELM;                  /* ADD NEW ELEMENT TO SSID CHAIN.
*                                                            @Y30LB51*/
         B     @RC00502                                            0509
@RF00502 BAL   @14,ADDELM                                          0509
*   END NEXTELM;                    /*                       @Y30LB51*/
@EL00019 DS    0H                                                  0510
@EF00019 DS    0H                                                  0510
@ER00019 L     @14,@SA00019                                        0510
         BR    @14                                                 0510
*ACCESTWO:                                                         0511
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0511
ACCESTWO ST    @14,@SA00020                                        0511
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL PROCESS AN FSC FOR ACCESSOR TWO IF IT IS THE*/
*   /* SECOND FSC IN THE RECORD. FSCSAVE2 CONTAINS THE FSC. CHNPTR   */
*   /* CONTAINS THE PTR TO THE SSID IN THE CHAIN TABLE. FSCTPTR      */
*   /* CONTAINS THE PTR TO THE START OF THE SSID CHAIN.              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0512
*   TBLPTR=CHNPTR->FSCTPTR;         /*                       @Y30LB51*/
         L     TBLPTR,FSCTPTR(,CHNPTR)                             0512
*   DO WHILE((TBLPTR^=0)&(FSCSAVE2^=FSCFSC));/* SEARCH SSID CHAIN FOR
*                                      FSC OR FOR END OF CHAIN.    0513
*                                                            @Y30LB51*/
         B     @DE00513                                            0513
@DL00513 DS    0H                                                  0514
*     TBLPTRSV=TBLPTR;              /* SAVE PTR TO THIS ELEMENT.   0514
*                                                            @Y30LB51*/
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0514
*     TBLPTR=TBLPTR->FSCSPTR;       /* GET PTR TO NEXT ELEMENT.    0515
*                                                            @Y30LB51*/
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0515
*   END;                            /*                       @Y30LB51*/
@DE00513 LTR   TBLPTR,TBLPTR                                       0516
         BZ    @DC00513                                            0516
         CLC   FSCSAVE2(4,FSCWKPTR),FSCFSC(TBLPTR)                 0516
         BNE   @DL00513                                            0516
@DC00513 DS    0H                                                  0517
*   IF TBLPTR=0 THEN                /* IF AT END OF CHAIN    @Y30LB51*/
         LTR   TBLPTR,TBLPTR                                       0517
         BNZ   @RF00517                                            0517
*     CALL NEXTELM;                 /* ADD NEW ELEMENT TO CHAIN.   0518
*                                                            @Y30LB51*/
         BAL   @14,NEXTELM                                         0518
*   ELSE                            /* FSC FOUND ON CHAIN.   @Y30LB51*/
*     DO;                           /*                       @Y30LB51*/
         B     @RC00517                                            0519
@RF00517 DS    0H                                                  0520
*       FSCCTR=FSCCTR+1;            /* ADD ONE TO RECORD COUNTER.  0520
*                                                            @Y30LB51*/
         LA    @10,1                                               0520
         AH    @10,FSCCTR(,TBLPTR)                                 0520
         STH   @10,FSCCTR(,TBLPTR)                                 0520
*       FSCDT=DATETIME;             /* PUT DATE IN TABLE.    @Y30LB51*/
         L     @10,LOGPTR(,FSCWKPTR)                               0521
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0521
*     END;                          /*                       @Y30LB51*/
*   END ACCESTWO;                   /*                       @Y30LB51*/
@EL00020 DS    0H                                                  0523
@EF00020 DS    0H                                                  0523
@ER00020 L     @14,@SA00020                                        0523
         BR    @14                                                 0523
*ADDELM:                                                           0524
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0524
ADDELM   ST    @14,@SA00021                                        0524
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL CREATE A NEW FSC TABLE ELEMENT AND ADD IT TO*/
*   /* AN ACTIVE SSID CHAIN. FREEPTR CONTAINS THE PTR TO THE NEXT    */
*   /* AVAILABLE SPACE IN THE FSC TABLE. TBLPTRSV CONTAINS THE PTR TO*/
*   /* THE LAST ELEMENT ON THE SSID CHAIN.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0525
*   CALL PUTREC;                    /* PUT DATA IN FSC TABLE.      0525
*                                                            @Y30LB51*/
         BAL   @14,PUTREC                                          0525
*   TBLPTRSV->FSCSPTR=FREEPTR;      /* ADD ELEMENT TO SSID CHAIN.  0526
*                                                            @Y30LB51*/
         L     @10,TBLPTRSV(,FSCWKPTR)                             0526
         L     @04,FREEPTR(,FSCWKPTR)                              0526
         ST    @04,FSCSPTR(,@10)                                   0526
*   FREEPTR=FREEPTR+LENGTH(FSCTBL); /* SET PTR TO NEXT FREE SPACE. 0527
*                                                            @Y30LB51*/
         AH    @04,@CH00553                                        0527
         ST    @04,FREEPTR(,FSCWKPTR)                              0527
*   IF FREEPTR>ENDPTR THEN          /* IF AT END OF TABLE    @Y30LB51*/
         L     @10,GET0PTR(,FSCWKPTR)                              0528
         C     @04,ENDPTR(,@10)                                    0528
         BNH   @RF00528                                            0528
*     ADDCORE='1'B;                 /* SET NEED CORE SWITCH. @Y30LB51*/
         OI    ADDCORE(FSCWKPTR),B'00000001'                       0529
*   ELSE                                                           0530
*     ;                             /* SPACE REMAINING IN TABLE.   0530
*                                                            @Y30LB51*/
@RF00528 DS    0H                                                  0531
*   END ADDELM;                     /*                       @Y30LB51*/
@EL00021 DS    0H                                                  0531
@EF00021 DS    0H                                                  0531
@ER00021 L     @14,@SA00021                                        0531
         BR    @14                                                 0531
*GETMORE:                                                          0532
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0532
GETMORE  ST    @14,@SA00022                                        0532
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL GET AN ADDITION FSC TABLE WHEN NEEDED, AND  */
*   /* CHAIN IT TO THE PREVIOUS FSC TABLE.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0533
*   ADDCORE='0'B;                   /* RESET THE ADDCORE SWITCH.   0533
*                                                            @Y30LB51*/
         NI    ADDCORE(FSCWKPTR),B'11111110'                       0533
*   CORELEN=LENGTH(ISDAGHDR)+LENGTH(FSCTBL)*TBLNR;/*               0534
*                                      GET LENGTH OF TABLE.@Y30LB51  */
         MVC   CORELEN(3,CVTPTR),@CF00555+1                        0534
*   SPNO='04'X;                     /* GET SUBPOOL NUMBER.   @Y30LB51*/
         MVI   SPNO(CVTPTR),X'04'                                  0535
*   CALL ISDAGET0(WORKPTR);         /* GET THE ADDED SPACE.  @Y30LB51*/
         L     @10,@PC00001                                        0536
         ST    @10,@AL00001                                        0536
         L     @15,@CV00431                                        0536
         LA    @01,@AL00001                                        0536
         BALR  @14,@15                                             0536
*   RFY                                                            0537
*     RF RSTD;                      /*                       @Y30LB51*/
*   FSCRETCD=RF;                    /* SAVE THE RETURN CODE. @Y30LB51*/
         LR    FSCRETCD,RF                                         0538
*   RFY                                                            0539
*     RF UNRSTD;                    /*                       @Y30LB51*/
*   IF FSCRETCD=0 THEN              /* IF SPACE WAS AVAILABLE      0540
*                                                            @Y30LB51*/
         LTR   FSCRETCD,FSCRETCD                                   0540
         BNZ   @RF00540                                            0540
*     DO;                           /* INITIALIZE IT AND CHAIN IT. 0541
*                                                            @Y30LB51*/
*       NEXTPTR=COREADDR;           /* SAVE ADDRESS OF NEW TABLE.  0542
*                                                            @Y30LB51*/
         L     @10,GET0PTR(,FSCWKPTR)                              0542
         L     @15,COREADDR(,CVTPTR)                               0542
         ST    @15,NEXTPTR(,@10)                                   0542
*       PTRSAVE=GET0PTR;            /* SAVE PTR TO PREVIOUS TABLE. 0543
*                                                            @Y30LB51*/
         ST    @10,PTRSAVE(,FSCWKPTR)                              0543
*       GET0PTR=NEXTPTR;            /* SET PTR TO NEW TABLE. @Y30LB51*/
         ST    @15,GET0PTR(,FSCWKPTR)                              0544
*       LASTPTR=PTRSAVE;            /* SET BACK PTR IN NEW TABLE.  0545
*                                                            @Y30LB51*/
         ST    @10,LASTPTR(,@15)                                   0545
*       FSCTBLCT=FSCTBLCT+1;        /* INCREMENT TABLE COUNT.      0546
*                                                            @Y30LB51*/
         LA    @10,1                                               0546
         LH    @14,FSCTBLCT(,FSCWKPTR)                             0546
         ALR   @14,@10                                             0546
         STH   @14,FSCTBLCT(,FSCWKPTR)                             0546
*       BLOCKCNT=FSCTBLCT;          /* PUT COUNT IN TABLE.   @Y30LB51*/
         STH   @14,BLOCKCNT(,@15)                                  0547
*       BLOCKID='FSC ';             /* PUT ID IN TABLE.      @Y30LB51*/
         MVC   BLOCKID(4,@15),@CC00449                             0548
*       FREEPTR=STARTPTR;           /* SET PTR TO NEXT ELEMENT.    0549
*                                                            @Y30LB51*/
         L     @15,STARTPTR(,@15)                                  0549
         ST    @15,FREEPTR(,FSCWKPTR)                              0549
*       TBLPTR=STARTPTR;            /* SET PTR TO FIRST ELEMENT.   0550
*                                                            @Y30LB51*/
         LR    TBLPTR,@15                                          0550
*       DO I=1 TO TBLNR;            /*                       @Y30LB51*/
         STH   @10,I(,FSCWKPTR)                                    0551
@DL00551 DS    0H                                                  0552
*         FSCTBL=''B;               /* ZERO OUT THE NEW FSC TABLE. 0552
*                                                            @Y30LB51*/
         XC    FSCTBL(44,TBLPTR),FSCTBL(TBLPTR)                    0552
*         TBLPTR=TBLPTR+LENGTH(FSCTBL);/*                          0553
*                                                            @Y30LB51*/
         AH    TBLPTR,@CH00553                                     0553
*       END;                        /*                       @Y30LB51*/
         LA    @10,1                                               0554
         AH    @10,I(,FSCWKPTR)                                    0554
         STH   @10,I(,FSCWKPTR)                                    0554
         CH    @10,@CH00420                                        0554
         BNH   @DL00551                                            0554
*       TBLPTR=STARTPTR;            /* RESET PTR TO FIRST ELEMENT. 0555
*                                                            @Y30LB51*/
         L     @10,GET0PTR(,FSCWKPTR)                              0555
         L     TBLPTR,STARTPTR(,@10)                               0555
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* SPACE WAS NOT AVAILABLE,    0557
*                                                            @Y30LB51*/
*     DO;                           /* FREE WHAT HAS BEEN SECURED. 0557
*                                                            @Y30LB51*/
         B     @RC00540                                            0557
@RF00540 DS    0H                                                  0558
*       CALL FREECORE;              /* FREE ALL DYNAMIC STORAGE.   0558
*                                                            @Y30LB51*/
         BAL   @14,FREECORE                                        0558
*       FSCRETCD=NOSPACE;           /* SET RETURN CODE.      @Y30LB51*/
         LA    FSCRETCD,4                                          0559
*       RETURN CODE(FSCRETCD);      /* RETURN TO CALLER.     @Y30LB51*/
         LR    @15,FSCRETCD                                        0560
@EL00022 DS    0H                                                  0560
@EF00022 DS    0H                                                  0560
@ER00022 L     @14,@SA00022                                        0560
         BR    @14                                                 0560
*     END;                          /*                       @Y30LB51*/
*   END GETMORE;                    /*                       @Y30LB51*/
         B     @EL00022                                            0562
*FREECORE:                                                         0563
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0563
FREECORE ST    @14,@SA00023                                        0563
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL FREE ALL GOTTEN CORE VIA THE ISDAFREE       */
*   /* ROUTINE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0564
*   SPNO='04'X;                     /* GET THE SUBPOOL NUMBER.     0564
*                                                            @Y30LB51*/
         MVI   SPNO(CVTPTR),X'04'                                  0564
*   IF FSC00PTR^=0 THEN             /* IF WORK AREA EXISTS   @Y30LB51*/
         ICM   @10,15,FSC00PTR(CVTPTR)                             0565
         BZ    @RF00565                                            0565
*     DO;                           /* FREE IT.              @Y30LB51*/
*       DO WHILE GET0PTR^=0;        /* FREE EXISTING FSC TABLES.   0567
*                                                            @ZM31022*/
         B     @DE00567                                            0567
@DL00567 DS    0H                                                  0568
*         SPNOLEN=GET0SPLN;         /* GET FSC TABLE LENGTH. @ZM31022*/
         L     @10,GET0PTR(,FSCWKPTR)                              0568
         MVC   SPNOLEN(4,CVTPTR),GET0SPLN(@10)                     0568
*         COREADDR=GET0PTR;         /* GET ADDRESS OF LAST TABLE ON
*                                      CHAIN.                @ZM31022*/
         ST    @10,COREADDR(,CVTPTR)                               0569
*         GET0PTR=LASTPTR;          /* SET PTR TO PRECEDING TABLE ON
*                                      CHAIN.                @ZM31022*/
         L     @10,LASTPTR(,@10)                                   0570
         ST    @10,GET0PTR(,FSCWKPTR)                              0570
*         CALL ISDAFREE(WORKPTR);   /* FREE THE LAST TABLE ON CHAIN.
*                                                            @ZM31022*/
         L     @10,@PC00001                                        0571
         ST    @10,@AL00001                                        0571
         L     @15,@CV00433                                        0571
         LA    @01,@AL00001                                        0571
         BALR  @14,@15                                             0571
*       END;                        /*                       @ZM31022*/
@DE00567 SLR   @10,@10                                             0572
         C     @10,GET0PTR(,FSCWKPTR)                              0572
         BNE   @DL00567                                            0572
*       IF CHAINTBL^=0 THEN         /* IF CHAIN TABLE EXISTS.      0573
*                                                            @ZM31022*/
         L     @04,CHAINTBL(,FSCWKPTR)                             0573
         CR    @04,@10                                             0573
         BE    @RF00573                                            0573
*         DO;                       /* FREE IT.              @ZM31022*/
*           CORELEN=LENGTH(CHNTBL)*SSIDCT;/*                       0575
*                                      GET CHAIN TABLE LENGTH      0575
*                                                            @ZM31022*/
         LH    @10,SSIDCT(,FSCWKPTR)                               0575
         MH    @10,@CH00119                                        0575
         STCM  @10,7,CORELEN(CVTPTR)                               0575
*           COREADDR=CHAINTBL;      /* AND ADDRESS           @ZM31022*/
         ST    @04,COREADDR(,CVTPTR)                               0576
*           CALL ISDAFREE(WORKPTR); /* AND FREE IT.          @ZM31022*/
         L     @10,@PC00001                                        0577
         ST    @10,@AL00001                                        0577
         L     @15,@CV00433                                        0577
         LA    @01,@AL00001                                        0577
         BALR  @14,@15                                             0577
*         END;                      /*                       @ZM31022*/
*       ELSE;                       /* CHAIN TABLE DOES NOT EXIST. 0579
*                                                            @ZM31022*/
@RF00573 DS    0H                                                  0580
*       CORELEN=LENGTH(FSCWORK);    /* GET WORK AREA LENGTH  @Y30LB51*/
         MVC   CORELEN(3,CVTPTR),@CF00552+1                        0580
*       COREADDR=FSC00PTR;          /* AND ADDRESS           @Y30LB51*/
         MVC   COREADDR(4,CVTPTR),FSC00PTR(CVTPTR)                 0581
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/
         L     @10,@PC00001                                        0582
         ST    @10,@AL00001                                        0582
         L     @15,@CV00433                                        0582
         LA    @01,@AL00001                                        0582
         BALR  @14,@15                                             0582
*     END;                          /*                       @Y30LB51*/
*   ELSE                                                           0584
*     ;                             /* WORK AREA DOES NOT EXIST.   0584
*                                                            @Y30LB51*/
@RF00565 DS    0H                                                  0585
*   FSC00PTR=0;                     /* ZERO WORK AREA ADDRESS.     0585
*                                                            @Y30LB51*/
         SLR   @10,@10                                             0585
         ST    @10,FSC00PTR(,CVTPTR)                               0585
*   CFSC='00'X;                     /* SET 'DO NOT CALL' SWITCH.   0586
*                                                            @Y30LB51*/
         MVI   CFSC(LPARMPTR),X'00'                                0586
*   END FREECORE;                   /*                       @Y30LB51*/
@EL00023 DS    0H                                                  0587
@EF00023 DS    0H                                                  0587
@ER00023 L     @14,@SA00023                                        0587
         BR    @14                                                 0587
*   END ISDAFSC0                    /*                       @Y30LB51*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDAWORK)                                        *
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        *
*/*%INCLUDE SYSLIB  (ISDAMCFG)                                        *
*/*%INCLUDE SYSLIB  (ISDASOBR)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        *
*/*%INCLUDE SYSLIB  (ISDAFSC5)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSC3)                                        *
*;                                                                 0588
@DATA    DS    0H
@CH00082 DC    H'1'
@CH00101 DC    H'2'
@CH00070 DC    H'8'
@CH00535 DC    H'9'
@CH00119 DC    H'12'
@CH00553 DC    H'44'
@CH00420 DC    H'80'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    1F
@SA00004 DS    1F
@SA00008 DS    1F
@SA00012 DS    1F
@SA00011 DS    1F
@SA00010 DS    1F
@SA00009 DS    1F
@SA00013 DS    1F
@SA00016 DS    1F
@SA00017 DS    1F
@SA00022 DS    1F
@SA00014 DS    1F
@SA00015 DS    1F
@SA00020 DS    1F
@SA00019 DS    1F
@SA00021 DS    1F
@SA00023 DS    0F
@SA00003 DS    0F
         DS    1F
@AL00001 DS    1A
@TF00001 DS    F
ISDAFSC0 CSECT
         DS    0F
@CF00552 DC    F'84'
@CF00555 DC    F'3548'
@DATD    DSECT
         DS    0D
SUMPTR   DS    A
PRTPTR   DS    A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDAFSC0 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00431 DC    V(ISDAGET0)
@CV00432 DC    V(ISDAGET1)
@CV00433 DC    V(ISDAFREE)
         DS    0D
@CC00449 DC    C'FSC '
@CC00481 DC    C'  '
@CC00495 DC    C'MS'
@CC00496 DC    C'SA'
@CC00497 DC    C'RC'
@CC00498 DC    C'RD'
@CC00499 DC    C'CS'
@CC00500 DC    C'DA'
@CB00416 DC    X'0FFF'
@CB00418 DC    X'0001'
PATCH    DS    CL50
         ORG   PATCH
@NM00025 DC    50X'00'
         ORG   PATCH+50
DEVICES  DC    X'38312A231C150E07'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
FSCRETCD EQU   @05
CHNPTR   EQU   @06
TBLPTR   EQU   @04
FSCWKPTR EQU   @03
LPARMPTR EQU   @07
CVTPTR   EQU   @02
RF       EQU   @15
R0       EQU   @00
R1       EQU   @01
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
DATAPTR  EQU   CVTPTRS0
SDATAPTR EQU   CVTPTRS0+4
PARMPTR  EQU   CVTPTRS0+8
SDA00PTR EQU   CVTPTRS0+12
FSC00PTR EQU   CVTPTRS0+56
CNFG0PTR EQU   CVTPTRS0+88
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CTYPE    EQU   ISDAPRMS+11
CFSCONLY EQU   ISDAPRMS+13
CFSC12   EQU   CFSCONLY
CFSC34   EQU   CFSCONLY+2
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CFSC     EQU   CREPORTS+4
ISDAWORK EQU   0
INFLAGS  EQU   ISDAWORK
INDEVTYP EQU   INFLAGS+2
SDAFLAG0 EQU   INFLAGS+3
INRECCUA EQU   ISDAWORK+6
ISDAGHDR EQU   0
STARTPTR EQU   ISDAGHDR
ENDPTR   EQU   ISDAGHDR+4
GET0SPLN EQU   ISDAGHDR+8
NEXTPTR  EQU   ISDAGHDR+12
LASTPTR  EQU   ISDAGHDR+16
BLOCKID  EQU   ISDAGHDR+20
BLOCKCNT EQU   ISDAGHDR+24
PCNFG    EQU   0
CNFGFXD  EQU   PCNFG
CNFGTOTL EQU   PCNFG+28
OBRMDR   EQU   0
SCW      EQU   OBRMDR
SWITCHES EQU   OBRMDR+6
DATETIME EQU   OBRMDR+12
DATE     EQU   DATETIME
TIME     EQU   DATETIME+4
CPUSERID EQU   OBRMDR+21
ISDAMSCS EQU   0
SUBSYSID EQU   ISDAMSCS+1
SSID     EQU   SUBSYSID
FORMATNO EQU   ISDAMSCS+3
SUBSENSE EQU   ISDAMSCS+4
SUBSTAT5 EQU   SUBSENSE+1
SUBFMTMG EQU   SUBSENSE+7
SUBFMTNO EQU   SUBFMTMG
MSCFSC   EQU   SUBSENSE+22
FSCWORK  EQU   0
GET0PTR  EQU   FSCWORK
PTRSAVE  EQU   FSCWORK+4
FSCPTR   EQU   FSCWORK+8
LOGPTR   EQU   FSCWORK+12
SENSEPTR EQU   FSCWORK+16
FREEPTR  EQU   FSCWORK+20
CHAINTBL EQU   FSCWORK+32
TBLPTRSV EQU   FSCWORK+40
FSCTBLCT EQU   FSCWORK+44
SSIDCT   EQU   FSCWORK+46
SSIDCTR  EQU   FSCWORK+48
TBLELMCT EQU   FSCWORK+50
I        EQU   FSCWORK+52
WORKFLGS EQU   FSCWORK+54
MSCREC   EQU   WORKFLGS
SAREC    EQU   WORKFLGS
DRCREC   EQU   WORKFLGS
DRDREC   EQU   WORKFLGS
CSREC    EQU   WORKFLGS
DIRREC   EQU   WORKFLGS
DAREC    EQU   WORKFLGS
DASDREC  EQU   WORKFLGS
FMT3ACC1 EQU   WORKFLGS+1
FMT3ACC2 EQU   WORKFLGS+1
FSCCOUNT EQU   WORKFLGS+1
WORKAPR  EQU   WORKFLGS+1
ADDCORE  EQU   WORKFLGS+1
LSSID    EQU   FSCWORK+56
LFSC     EQU   FSCWORK+58
LFSCSYS  EQU   FSCWORK+62
LTYPE    EQU   FSCWORK+64
SSIDSAVE EQU   FSCWORK+66
CUAFLAG  EQU   SSIDSAVE
SSIDDEV  EQU   SSIDSAVE
FSCSYSSV EQU   FSCWORK+68
FSCSAVE1 EQU   FSCWORK+70
FSCSAVE2 EQU   FSCWORK+74
DEVBYTES EQU   FSCWORK+82
DEVBYTEA EQU   DEVBYTES
FSCTBL   EQU   0
FSCSPTR  EQU   FSCTBL
FSCSSID  EQU   FSCTBL+4
FSCFSC   EQU   FSCTBL+8
FSCSYS   EQU   FSCFSC
CNTLUNIT EQU   FSCFSC+3
FSCDT    EQU   FSCTBL+12
FSCDATE  EQU   FSCDT
FSCTIME  EQU   FSCDT+4
FSCCTR   EQU   FSCTBL+20
FSCFLAGS EQU   FSCTBL+26
MSCFLAG  EQU   FSCFLAGS
SAFLAG   EQU   FSCFLAGS
DRCFLAG  EQU   FSCFLAGS
DRDFLAG  EQU   FSCFLAGS
CSFLAG   EQU   FSCFLAGS
DIRFLAG  EQU   FSCFLAGS
DAFLAG   EQU   FSCFLAGS
DASDFLAG EQU   FSCFLAGS
REALDASD EQU   FSCFLAGS+1
VIRTDASD EQU   FSCFLAGS+1
FAKEFSC  EQU   FSCFLAGS+1
FSCAPR   EQU   FSCFLAGS+1
FSCDEVS  EQU   FSCTBL+28
CHNTBL   EQU   0
CHNTPTR  EQU   CHNTBL
CHNSSIDF EQU   CHNTBL+4
FSCTPTR  EQU   CHNTBL+8
SUMTBL   EQU   0
PRTTBL   EQU   0
ISDAMSC3 EQU   4
FSCACC1  EQU   ISDAMSC3+4
FSCACC2  EQU   ISDAMSC3+8
MSCFIVE  EQU   0
DRIVEID  EQU   MSCFIVE+8
MSCDASD  EQU   0
DRIVE    EQU   MSCDASD+4
FMTMSG   EQU   MSCDASD+7
DASDFMT  EQU   FMTMSG
DASD10   EQU   MSCDASD+10
FSCDASD  EQU   MSCDASD+22
SSIDDASD EQU   MSCDASD+27
WORKPTR  EQU   0
DUMCTR   EQU   FSCDEVS
SSIDDUM  EQU   SSIDSAVE
SSIDDUMA EQU   SSIDDUM
SSIDDUMB EQU   SSIDDUM+1
*                                      START UNREFERENCED COMPONENTS
@NM00024 EQU   MSCDASD+24
@NM00023 EQU   MSCDASD+21
DASD20   EQU   MSCDASD+20
@NM00022 EQU   MSCDASD+12
DASD11   EQU   MSCDASD+11
@NM00021 EQU   DASD10
CLOCKERR EQU   DASD10
TIMEBIT  EQU   DASD10
@NM00020 EQU   MSCDASD+8
DASDMSG  EQU   FMTMSG
@NM00019 EQU   MSCDASD+5
@NM00018 EQU   MSCDASD
@NM00017 EQU   MSCFIVE+9
@NM00016 EQU   MSCFIVE
@NM00015 EQU   ISDAMSC3+16
IREGS3F3 EQU   ISDAMSC3+15
IREGS2F3 EQU   ISDAMSC3+14
IREGS1F3 EQU   ISDAMSC3+13
MISCF3   EQU   ISDAMSC3+12
SHIFT2F3 EQU   FSCACC2+3
PCHKACC2 EQU   FSCACC2+2
FAULT2F3 EQU   FSCACC2+1
MCHKACC2 EQU   FSCACC2
SHIFT1F3 EQU   FSCACC1+3
PCHKACC1 EQU   FSCACC1+2
FAULT1F3 EQU   FSCACC1+1
MCHKACC1 EQU   FSCACC1
QUEUE3   EQU   ISDAMSC3+3
MOVES12  EQU   ISDAMSC3+2
RECOVER3 EQU   ISDAMSC3+1
STATUS3  EQU   ISDAMSC3
PRTTPTR  EQU   PRTTBL
SUMPCTR  EQU   SUMTBL+14
SUMSCTR  EQU   SUMTBL+12
SUMFPTR  EQU   SUMTBL+8
SUMTOTAL EQU   SUMTBL+6
SUMSSID  EQU   SUMTBL+4
SUMTPTR  EQU   SUMTBL
@NM00014 EQU   CHNTBL+6
CHNSSID  EQU   CHNSSIDF
SSIDFLGS EQU   CHNSSIDF
DEVHCTR  EQU   FSCDEVS+14
DEVGCTR  EQU   FSCDEVS+12
DEVFCTR  EQU   FSCDEVS+10
DEVECTR  EQU   FSCDEVS+8
DEVDCTR  EQU   FSCDEVS+6
DEVCCTR  EQU   FSCDEVS+4
DEVBCTR  EQU   FSCDEVS+2
DEVACTR  EQU   FSCDEVS
INPRTTBL EQU   FSCFLAGS+1
@NM00013 EQU   FSCFLAGS+1
FSCPCT   EQU   FSCTBL+24
FSCSUM   EQU   FSCTBL+22
FSCHSEC  EQU   FSCTIME+3
FSCSEC   EQU   FSCTIME+2
FSCMIN   EQU   FSCTIME+1
FSCHR    EQU   FSCTIME
FSCDAY   EQU   FSCDATE+2
FSCYR    EQU   FSCDATE
@NM00012 EQU   FSCFSC+2
@NM00011 EQU   FSCSSID+2
UNITCHAR EQU   FSCSSID+1
DEVCHAR  EQU   FSCSSID
DEVBYTEB EQU   DEVBYTES+1
LINECT   EQU   FSCWORK+80
SUMBUILD EQU   FSCWORK+78
@NM00010 EQU   SSIDSAVE+1
@NM00009 EQU   WORKFLGS+1
PRINTTBL EQU   FSCWORK+36
SUMSTART EQU   FSCWORK+28
SUMTABLE EQU   FSCWORK+24
SANOMSCD EQU   SUBSENSE+27
RCYLMSCD EQU   SUBSENSE+25
RUAMSCD  EQU   SUBSENSE+24
@NM00008 EQU   SUBSENSE+21
RUADASD  EQU   SUBSENSE+20
DASDFSC  EQU   SUBSENSE+18
@NM00007 EQU   SUBSENSE+8
MSGCODEN EQU   SUBFMTMG
SALOWAD2 EQU   SUBSENSE+6
SARETRY  EQU   SUBSENSE+5
@NM00006 EQU   SUBSENSE+4
DASDFMTN EQU   SUBSENSE+3
SALOWADD EQU   SUBSENSE+2
SUBSTAT4 EQU   SUBSENSE
SSIDDEVT EQU   SSID+1
SSIDLIBN EQU   SSID+1
SSIDTYPE EQU   SSID
SSIDFLAG EQU   SUBSYSID
STATUS   EQU   ISDAMSCS
CPUID    EQU   CPUSERID+3
CPUSER   EQU   CPUSERID
VERNO    EQU   OBRMDR+20
TENSHUND EQU   TIME+3
SECOND   EQU   TIME+2
MINUTE   EQU   TIME+1
HOUR     EQU   TIME
DAY      EQU   DATE+2
YEAR     EQU   DATE
RECENTRY EQU   OBRMDR+11
RCDCNT   EQU   OBRMDR+10
SWITCH3  EQU   SWITCHES+3
SWITCH2  EQU   SWITCHES+2
SWITCH1  EQU   SWITCHES+1
SWITCH0  EQU   SWITCHES
SYSREL   EQU   OBRMDR+5
CLASRC   EQU   OBRMDR+4
@NM00005 EQU   SCW+3
SCODE    EQU   SCW+2
SLENGTH  EQU   SCW
SAINTFP  EQU   PCNFG+32
@NM00004 EQU   PCNFG+30
CPUSERAD EQU   PCNFG+24
CHCUAD   EQU   PCNFG+20
LTPAD    EQU   PCNFG+16
PCNFGL   EQU   CNFGFXD+14
CHINTFNO EQU   CNFGFXD+12
LIBSIZS  EQU   CNFGFXD+8
SANO     EQU   CNFGFXD+6
SPINO    EQU   CNFGFXD+4
CPUNO    EQU   CNFGFXD+2
MSFNO    EQU   CNFGFXD
@NM00003 EQU   ISDAGHDR+26
GET0LEN  EQU   GET0SPLN+1
GET0SPNO EQU   GET0SPLN
DEVPTR   EQU   ISDAWORK+16
NOUTREC  EQU   ISDAWORK+12
NINREC   EQU   ISDAWORK+8
CUABYTE1 EQU   INRECCUA+1
CUABYTE0 EQU   INRECCUA
DLENGTH  EQU   ISDAWORK+4
INSOURCE EQU   INFLAGS+1
IRECTYPE EQU   INFLAGS
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CDHEDHU  EQU   CREPORTS+3
CSUM     EQU   CREPORTS+2
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
LINE     EQU   OUTLINE+1
ANSI     EQU   OUTLINE
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
WORKCALL EQU   CVTPTRS0+96
GEN00PTR EQU   CVTPTRS0+92
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
*                                      END UNREFERENCED COMPONENTS
@RC00035 EQU   @RC00032
@RC00059 EQU   @RC00058
@RC00074 EQU   @EL00002
@RC00115 EQU   @EL00003
@RC00133 EQU   @RC00132
@RC00147 EQU   @RC00132
@RC00145 EQU   @RC00132
@RC00174 EQU   @EL00004
@RC00181 EQU   @EL00005
@RC00221 EQU   @EL00006
@RC00214 EQU   @EL00006
@RC00207 EQU   @EL00006
@RC00242 EQU   @EL00007
@RC00238 EQU   @EL00007
@RC00247 EQU   @EL00008
@RF00259 EQU   @EL00009
@RC00264 EQU   @EL00010
@RC00319 EQU   @EL00011
@RC00315 EQU   @EL00011
@RC00311 EQU   @EL00011
@RC00307 EQU   @EL00011
@RC00303 EQU   @EL00011
@RC00334 EQU   @EL00012
@RC00345 EQU   @EL00012
@RC00351 EQU   @EL00013
@RC00366 EQU   @EL00014
@RF00373 EQU   @EL00014
@RC00388 EQU   @RC00387
@RC00420 EQU   @RC00417
@RC00433 EQU   @EL00016
@RC00460 EQU   @EL00016
@RC00473 EQU   @EL00017
@RC00502 EQU   @EL00019
@RC00517 EQU   @EL00020
@RC00540 EQU   @EL00022
@RC00087 EQU   @RC00074
@RC00134 EQU   @RC00133
@RC00150 EQU   @RC00147
@RC00184 EQU   @RC00181
@RC00196 EQU   @RC00181
@RC00224 EQU   @RC00221
@RC00222 EQU   @RC00221
@RC00239 EQU   @RC00238
@RC00248 EQU   @RC00247
@RC00265 EQU   @RC00264
@RC00439 EQU   @RC00433
@RC00249 EQU   @RC00248
@RC00266 EQU   @RC00265
@RC00250 EQU   @RC00249
@ENDDATA EQU   *
         END   ISDAFSC0,(C'PLS1830',0603,75268)

         TITLE 'SDA PAD ERROR ACCUMULATOR                              *
                        '
ISDAPAD0 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'ISDAPAD0  77.354'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         ISDAGSPC R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @00,@01,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MVC   @PC00001(4),0(@01)                               01S0001
*                                                               02S0015
         B     @PB00002                                         02S0015
P0ADDBLK ST    @14,@SA00002                                     02S0015
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT IS CALLED TO ADD AN ADDITIONAL 2K BLOCK OF       */
*   /* DYNAMIC STORAGE IS REQUIRED. IT WILL CALL 'ISDAGET1' FOR      */
*   /* ANOTHER BLOCK AND CHAIN IT TO THE PREVIOUS.                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0016
*   CORELEN=2048;                   /* LOAD BLOCK LENGTH     @Y30LB52*/
         L     @10,@PC00001                                     02S0016
         L     @10,CVTPTR(,@10)                                 02S0016
         MVC   CORELEN(3,@10),@CF00330+1                        02S0016
*   SPNO=2;                         /* LOAD SUBPOOL NUMBER   @Y30LB52*/
         MVI   SPNO(@10),X'02'                                  02S0017
*   RESPECIFY                                                   02S0018
*     R1 RESTRICTED;                /*                       @Y30LB52*/
*   R1=ADDR(WORKCALL);              /* LOAD PARMLIST POINTER @Y30LB52*/
         LA    R1,WORKCALL(,@10)                                02S0019
*   RESPECIFY                                                   02S0020
*     R1 UNRESTRICTED;              /*                       @Y30LB52*/
*   CALL ISDAGET1;                  /* GET A BLOCK           @Y30LB52*/
*                                                               02S0021
         L     @15,@CV00054                                     02S0021
         BALR  @14,@15                                          02S0021
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS NON-ZERO, CONTROL IS RETURNED TO THE    */
*   /* CALLER. OTHERWISE, THE BLOCK IS CHAINED AND THE ASSIGNMENT    */
*   /* POINTERS SET.                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0022
*   RESPECIFY                                                   02S0022
*     R15 RESTRICTED;               /*                       @Y30LB52*/
*   IF R15=0 THEN                                               02S0023
         SLR   @14,@14                                          02S0023
         CR    R15,@14                                          02S0023
         BNE   @RF00023                                         02S0023
*     DO;                           /* ERROR IN BLOCK        @Y30LB52*/
*       RESPECIFY                                               02S0025
*         R15 UNRESTRICTED;         /*                       @Y30LB52*/
*       PADLASTB->PADFPTR1=COREADDR;/* CHAIN NEW BLOCK       @Y30LB52*/
         L     @10,@PC00001                                     02S0026
         L     @10,CVTPTR(,@10)                                 02S0026
         L     @15,PAD00PTR(,@10)                               02S0026
         L     @01,PADLASTB(,@15)                               02S0026
         L     @10,COREADDR(,@10)                               02S0026
         ST    @10,PADFPTR1(,@01)                               02S0026
*       PADLASTB=COREADDR;          /* SET NEW LAST PTR      @Y30LB52*/
         ST    @10,PADLASTB(,@15)                               02S0027
*       PADLASTB->PADFPTR1=0;       /* INDICATE NO FOREWORD  @Y30LB52*/
         ST    @14,PADFPTR1(,@10)                               02S0028
*       COREASG=COREADDR+LENGTH(P0WORK1);/* LOADASSIGNED PTR @Y30LB52*/
         LA    @09,4                                            02S0029
         ALR   @09,@10                                          02S0029
         ST    @09,COREASG(,@15)                                02S0029
*       ENDCORE=COREADDR+2048;      /* SET END OF CORE       @Y30LB52*/
         AL    @10,@CF00330                                     02S0030
         ST    @10,ENDCORE(,@15)                                02S0030
*       RETURN CODE(0);             /* RETURN                @Y30LB52*/
         LR    @15,@14                                          02S0031
@EL00002 DS    0H                                               02S0031
@EF00002 DS    0H                                               02S0031
@ER00002 L     @14,@SA00002                                     02S0031
         BR    @14                                              02S0031
*     END;                          /*                       @Y30LB52*/
*   ELSE                                                        02S0033
*     DO;                           /*                       @Y30LB52*/
@RF00023 DS    0H                                               02S0034
*       RESPECIFY                                               02S0034
*        (R1) RESTRICTED;           /*                       @Y30LB52*/
*       RESPECIFY                                               02S0035
*         P0WORK1 BASED(COREADDR);  /*                       @Y30LB52*/
*       COREADDR=PAD00PTR;          /* LOAD FIRST BLK ADDRESS@Y30LB52*/
         L     @10,@PC00001                                     02S0036
         L     @10,CVTPTR(,@10)                                 02S0036
         MVC   COREADDR(4,@10),PAD00PTR(@10)                    02S0036
*       DO WHILE(COREADDR^=0);      /* FREE TO LAST BLOCK    @Y30LB52*/
         B     @DE00037                                         02S0037
@DL00037 DS    0H                                               02S0038
*         R1=ADDR(WORKCALL);        /* LOAD PARMLIST POINTER @Y30LB52*/
         L     @10,@PC00001                                     02S0038
         L     @10,CVTPTR(,@10)                                 02S0038
         LA    R1,WORKCALL(,@10)                                02S0038
*         I=PADFPTR1;               /* LOAD NEXT BLOCK ADDR  @Y30LB52*/
         L     @10,COREADDR(,@10)                               02S0039
         L     I,PADFPTR1(,@10)                                 02S0039
*         CALL ISDAFREE;            /* FREE THE BLOCK        @Y30LB52*/
         L     @15,@CV00053                                     02S0040
         BALR  @14,@15                                          02S0040
*         COREADDR=I;               /* LOAD NEXT BLOCK PTR   @Y30LB52*/
         L     @10,@PC00001                                     02S0041
         L     @10,CVTPTR(,@10)                                 02S0041
         ST    I,COREADDR(,@10)                                 02S0041
*       END;                        /*                       @Y30LB52*/
@DE00037 L     @10,@PC00001                                     02S0042
         L     @10,CVTPTR(,@10)                                 02S0042
         ICM   @00,15,COREADDR(@10)                             02S0042
         BNZ   @DL00037                                         02S0042
*       CPAD='00'X;                 /* TURN OFF THE PAD      @Y30LB52*/
         L     @10,LPARMPTR(,@10)                               02S0043
         MVI   CPAD(@10),X'00'                                  02S0043
*       RETURN CODE(NOSPACE);       /* INDICATE NO SPACE     @Y30LB52*/
         LA    @15,4                                            02S0044
         L     @14,@SA00002                                     02S0044
         BR    @14                                              02S0044
*     END;                          /*                       @Y30LB52*/
*   END P0ADDBLK;                   /*                       @Y30LB52*/
@PB00002 DS    0H                                               02S0047
*                                                               01S0047
*   /*****************************************************************/
*   /*                                                               */
*   /* 'PAD00PTR' CONTAINS THE ADDRESS OF THE PERMANENT ACCUMULATOR  */
*   /* STORAGE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0047
*   I=0;                            /* CLEAR UTILITY VARIABLE@Y30LB52*/
         SLR   I,I                                              01S0047
*   J=0;                            /*                       @Y30LB52*/
         SLR   J,J                                              01S0048
*   K=0;                            /*                       @Y30LB52*/
         SLR   K,K                                              01S0049
*   SATABP=0;                       /* CLEAR THE SA POINTER  @Y30LB52*/
         SLR   SATABP,SATABP                                    01S0050
*   IF PAD00PTR=0 THEN                                          01S0051
         L     @10,@PC00001                                     01S0051
         L     @10,CVTPTR(,@10)                                 01S0051
         ICM   @05,15,PAD00PTR(@10)                             01S0051
         BNZ   @RF00051                                         01S0051
*     DO;                           /*                       @Y30LB52
*                                      FIRST ENTRY, ALLOCATE 2K      */
*                                                               02S0053
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT IS ENTERED ON THE FIRST CALL TO THE MAIN     */
*       /* SEGMENT. IT'S FUNCTION IS TO GET THE FIRST 2K OF DYNAMIC  */
*       /* STORAGE AND SET THE FIXED WORK AREA TO XERO. IF NO SPACE  */
*       /* IS AVAILABLE, THE REPORT TURNS ITSELF OFF AND RETURNS THAT*/
*       /* INDICATION TO THE CONTROLLER.                             */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0053
*       CORELEN=2048;               /* LENGTH OF BLOCK       @Y30LB52*/
         MVC   CORELEN(3,@10),@CF00330+1                        02S0053
*       SPNO=2;                     /* SUBPOOL NUMBER        @Y30LB52*/
*                                                               02S0054
         MVI   SPNO(@10),X'02'                                  02S0054
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP CALLING SEQUENCE                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0055
*       RESPECIFY                                               02S0055
*         R1 RESTRICTED;            /*                       @Y30LB52*/
*       R1=ADDR(WORKCALL);          /* ADDRESS OF PARMLIST   @Y30LB52*/
         LA    R1,WORKCALL(,@10)                                02S0056
*       RESPECIFY                                               02S0057
*         R1 UNRESTRICTED;          /*                       @Y30LB52*/
*       CALL ISDAGET1;              /* GET A 2K BLOCK        @Y30LB52*/
*                                                               02S0058
         L     @15,@CV00054                                     02S0058
         BALR  @14,@15                                          02S0058
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE IS NON-XERO, RETURN TO CALLER.         */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0059
*       RESPECIFY                                               02S0059
*         R15 RESTRICTED;           /*                       @Y30LB52*/
*       IF R15^=0 THEN              /* NON-ZERO RETURN CODE  @Y30LB52*/
         LTR   R15,R15                                          02S0060
         BZ    @RF00060                                         02S0060
*         DO;                       /* NOSPACE AVAILABLE     @Y30LB52*/
*           CPAD='00'X;             /*                       @Y30LB52
*                                      TURN OFF THE PAD REPORT       */
         L     @14,@PC00001                                     02S0062
         L     @14,CVTPTR(,@14)                                 02S0062
         L     @14,LPARMPTR(,@14)                               02S0062
         MVI   CPAD(@14),X'00'                                  02S0062
*           RETURN CODE(NOSPACE);   /* RETURN ERROR          @Y30LB52*/
         L     @13,4(,@13)                                      02S0063
         L     @00,@SIZDATD                                     02S0063
         LR    @01,@11                                          02S0063
         ISDAFSPC R,LV=(0),A=(1)
         LA    @15,4                                            02S0063
         L     @14,12(,@13)                                     02S0063
         LM    @00,@12,20(@13)                                  02S0063
         BR    @14                                              02S0063
*         END;                      /*                       @Y30LB52*/
*                                                               02S0064
*       /*************************************************************/
*       /*                                                           */
*       /* CLEAR THE GOTTEN STORAGE AND SET THE POINTERS TO IT.      */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0065
*       ELSE                                                    02S0065
*         DO;                       /*                       @Y30LB52*/
@RF00060 DS    0H                                               02S0066
*           PAD00PTR=COREADDR;      /* POINTER TO FIRST 2K   @Y30LB52*/
         L     @14,@PC00001                                     02S0066
         L     @14,CVTPTR(,@14)                                 02S0066
         L     @10,COREADDR(,@14)                               02S0066
         ST    @10,PAD00PTR(,@14)                               02S0066
*           P0WORK=P0WORK&&P0WORK;  /* CLEAR HEADER          @Y30LB52*/
         XC    P0WORK(92,@10),P0WORK(@10)                       02S0067
*           PADLASTB=COREADDR;      /* PTR TO LAST BLK       @Y30LB52*/
         ST    @10,PADLASTB(,@10)                               02S0068
*           COREASG=PAD00PTR+LENGTH(P0WORK);/* SET ASSIGNED POINTER
*                                                            @Y30LB52*/
         LA    @14,92                                           02S0069
         ALR   @14,@10                                          02S0069
         ST    @14,COREASG(,@10)                                02S0069
*           ENDCORE=COREADDR+2048;  /* SET END OF CORE ADDR  @Y30LB52*/
         LA    @14,2048                                         02S0070
         ALR   @14,@10                                          02S0070
         ST    @14,ENDCORE(,@10)                                02S0070
*         END;                      /*                       @Y30LB52*/
*       RESPECIFY                                               02S0072
*         R15 UNRESTRICTED;         /*                       @Y30LB52*/
*     END;                          /*                       @Y30LB52*/
*   ELSE                                                        01S0074
*     ;                             /* NOT FIRST ENTRY       @ZA00699*/
*                                                               01S0074
@RF00051 DS    0H                                               01S0075
*   /*****************************************************************/
*   /*                                                               */
*   /* LOAD THE WORKAREA POINTER FROM THE SDACVT.                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0075
*   PWORKPTR=PAD00PTR;              /* SET WORKPTR           @Y30LB52*/
         L     @10,@PC00001                                     01S0075
         L     @10,CVTPTR(,@10)                                 01S0075
         L     PWORKPTR,PAD00PTR(,@10)                          01S0075
*   RESPECIFY                                                   01S0076
*    (P0WORK) BASED(PWORKPTR);      /*                       @Y30LB52*/
*                                                               01S0076
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DEVICE TYPE IS MSC, THEN A TEST AND ALLOCATION SEGMENT */
*   /* IS EXECUTED TO SUPPLY ACCESS TO THE 'MSC' AND 'SA' LEVELS OF  */
*   /* THE ACCUMULATOR STRUCTURE. 'P0FMT4' IS EXECUTED TO ACCUMULATE */
*   /* DRC/DRD ERRORS AND 'P0FMT5' IS EXECUTED TO ACCUMULATE MSC/DASD*/
*   /* ERRORS.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0077
*   IF INDEVTYP='S' THEN            /* INDICATES MSC RECORD  @Y30LB52*/
         L     @05,SDA00PTR(,@10)                               01S0077
         CLI   INDEVTYP(@05),C'S'                               01S0077
         BNE   @RF00077                                         01S0077
*     DO;                           /* PROCESS MSC RECORD    @Y30LB52*/
*                                                               02S0079
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT OF CODE IS EXECUTED FOR THOSE ERROR RECORDS  */
*       /* LOGGED THROUGH THE 'MSC'. IT'S FUNCTION IS THAT OF FINDING*/
*       /* THE 'MSC' IN THE 'MSCDRDAC' AND ALLOCATING STORAGE FOR THE*/
*       /* NEXT LEVEL 'SA' ARRAY. A POINTER TO THE 'SA' LEVEL IS SET.*/
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0079
*       IF SUBSTAT4(5)='1'B THEN    /* DATA CHECK RECORD     @ZM30731*/
         L     @10,SENSEPTR(,@10)                               02S0079
         TM    SUBSTAT4(@10),B'00001000'                        02S0079
         BNO   @RF00079                                         02S0079
*         RETURN CODE(0);           /* YES, IGNORE IT, EXIT  @ZM30731*/
         L     @13,4(,@13)                                      02S0080
         L     @00,@SIZDATD                                     02S0080
         LR    @01,@11                                          02S0080
         ISDAFSPC R,LV=(0),A=(1)
         SLR   @15,@15                                          02S0080
         L     @14,12(,@13)                                     02S0080
         LM    @00,@12,20(@13)                                  02S0080
         BR    @14                                              02S0080
*       ELSE                                                    02S0081
*         ;                         /* NO, USE THIS RECORD   @ZM30731*/
@RF00079 DS    0H                                               02S0082
*       DO I=1 TO 8 WHILE(MSCINTF(I)^=INRECCUA)&(MSCINTF(I)^='0000'X);
         LA    I,1                                              02S0082
@DL00082 LR    @10,I                                            02S0082
         SLA   @10,3                                            02S0082
         L     @15,@PC00001                                     02S0082
         L     @01,CVTPTR(,@15)                                 02S0082
         L     @01,SDA00PTR(,@01)                               02S0082
         ST    @10,@TF00001                                     02S0082
         ALR   @10,PWORKPTR                                     02S0082
         CLC   MSCINTF-8(2,@10),INRECCUA(@01)                   02S0082
         BE    @DC00082                                         02S0082
         LR    @10,PWORKPTR                                     02S0082
         AL    @10,@TF00001                                     02S0082
         CLC   MSCINTF-8(2,@10),@CB00338                        02S0082
         BE    @DC00082                                         02S0082
*                                   /* LOOP THROUGH ALL MSC'S@Y30LB52*/
*       END;                        /*                       @Y30LB52*/
*                                                               02S0083
         AH    I,@CH00049                                       02S0083
         CH    I,@CH00057                                       02S0083
         BNH   @DL00082                                         02S0083
@DC00082 DS    0H                                               02S0084
*       /*************************************************************/
*       /*                                                           */
*       /* IF A NEW MSC ADDRESS, AN ARRAY FOR THE POSSIBLE SA'S MUST */
*       /* BE ALLOCATED.                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0084
*       SATABP=SATABPTR(I);         /* PTR TO SATAB          @Y30LB52*/
         LR    @10,I                                            02S0084
         SLA   @10,3                                            02S0084
         L     SATABP,SATABPTR-8(@10,PWORKPTR)                  02S0084
*       IF SATABP=0 THEN            /* IF ZERO, ALLOCATE     @Y30LB52*/
         LTR   SATABP,SATABP                                    02S0085
         BNZ   @RF00085                                         02S0085
*         DO;                       /*                       @Y30LB52*/
*           MSCINTF(I)=INRECCUA;    /* SET MSC UNIT ADDRESS  @Y30LB52*/
*                                                               02S0087
         ST    @10,@TF00001                                     02S0087
         ALR   @10,PWORKPTR                                     02S0087
         L     @15,@PC00001                                     02S0087
         L     @01,CVTPTR(,@15)                                 02S0087
         L     @01,SDA00PTR(,@01)                               02S0087
         MVC   MSCINTF-8(2,@10),INRECCUA(@01)                   02S0087
*           /*********************************************************/
*           /*                                                       */
*           /* THIS SUBSEGMENT ASSIGNS A BLOCK OF STORAGE ON DEMAND. */
*           /* IF INSUFFICIENT STORAGE REMAINS IN THE LAST BLOCK, THE*/
*           /* SEGMENT 'P0ADDBLK' IS EXECUTED TO OBTAIN ANOTHER 2K OF*/
*           /* STORAGE AND CHAIN IT TO THE PREVIOUS BLOCK(S).        */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0088
*           SATABPTR(I)=COREASG;    /* SET BLOCK ADDRESS TO NEXT
*                                      AVAILABLE             @Y30LB52*/
         L     @10,COREASG(,PWORKPTR)                           02S0088
         L     @01,@TF00001                                     02S0088
         ST    @10,SATABPTR-8(@01,PWORKPTR)                     02S0088
*           COREASG=COREASG+LENGTH(CSADRDDS);/* INCREMENT THE NEXT
*                                      ADDRESS               @Y30LB52*/
*                                                               02S0089
         AH    @10,@CH00074                                     02S0089
         ST    @10,COREASG(,PWORKPTR)                           02S0089
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE CURRENT BLOCK DOESN'T CONTAIN ENOUGH SPACE, GET*/
*           /* A NEW 2K BLOCK AND CHAIN IT IN.                       */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0090
*           IF COREASG>ENDCORE THEN /* PAST END OF 2K BLOCK? @Y30LB52*/
         C     @10,ENDCORE(,PWORKPTR)                           02S0090
         BNH   @RF00090                                         02S0090
*             DO;                   /* GET ANOTHER           @Y30LB52*/
*               CALL P0ADDBLK;      /* INTERNAL PROCEDURE    @Y30LB52*/
         BAL   @14,P0ADDBLK                                     02S0092
*               RESPECIFY                                       02S0093
*                 R15 RESTRICTED;   /*                       @Y30LB52*/
*               IF R15^=0 THEN                                  02S0094
         LTR   R15,R15                                          02S0094
         BZ    @RF00094                                         02S0094
*                 DO;               /* OUT OF CORE?          @Y30LB52*/
*                   CPAD='00'X;     /* TURN OFF THE PAD REPORT  02S0096
*                                                            @Y30LB52*/
         L     @14,@PC00001                                     02S0096
         L     @14,CVTPTR(,@14)                                 02S0096
         L     @14,LPARMPTR(,@14)                               02S0096
         MVI   CPAD(@14),X'00'                                  02S0096
*                   RETURN CODE(NOSPACE);/* INDICATE WHAT HAPPENED
*                                                            @Y30LB52*/
         L     @13,4(,@13)                                      02S0097
         L     @00,@SIZDATD                                     02S0097
         LR    @01,@11                                          02S0097
         ISDAFSPC R,LV=(0),A=(1)
         LA    @15,4                                            02S0097
         L     @14,12(,@13)                                     02S0097
         LM    @00,@12,20(@13)                                  02S0097
         BR    @14                                              02S0097
*                 END;              /*                       @Y30LB52*/
*               ELSE                                            02S0099
*                 DO;               /* SET THE POINTERS      @Y30LB52*/
@RF00094 DS    0H                                               02S0100
*                   SATABPTR(I)=COREASG;/* SET BLOCK ADDRESS @Y30LB52*/
         LR    @14,I                                            02S0100
         SLA   @14,3                                            02S0100
         L     @10,COREASG(,PWORKPTR)                           02S0100
         ST    @10,SATABPTR-8(@14,PWORKPTR)                     02S0100
*                   COREASG=COREASG+LENGTH(CSADRDDS);/* INCREMENT THE
*                                      ASSIGNL               @Y30LB52*/
         AH    @10,@CH00074                                     02S0101
         ST    @10,COREASG(,PWORKPTR)                           02S0101
*                 END;              /*                       @Y30LB52*/
*             END;                  /*                       @Y30LB52*/
*                                                               02S0103
*           /*********************************************************/
*           /*                                                       */
*           /* CLEAR THE RETURNED ARRAY                              */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0104
*           SATABP=SATABPTR(I);     /* SET SATAB POINTER     @Y30LB52*/
@RF00090 LR    @14,I                                            02S0104
         SLA   @14,3                                            02S0104
         L     SATABP,SATABPTR-8(@14,PWORKPTR)                  02S0104
*           RESPECIFY                                           02S0105
*             SADRDDSD BASED(SATABP);/*                      @Y30LB52*/
*           CSADRDDS=CSADRDDS&&CSADRDDS;/* CLEAR             @Y30LB52*/
         XC    CSADRDDS(128,SATABP),CSADRDDS(SATABP)            02S0106
*         END;                      /*                       @Y30LB52*/
*     END;                          /*                       @Y30LB52*/
*   ELSE                                                        01S0109
*     ;                             /* NOT FROM MSC          @ZA00699*/
@RF00077 DS    0H                                               01S0110
*   IF(INDEVTYP='S'&FORMATNO(5)=ON) THEN/* FMT 4 BIT ON?     @Y30LB52*/
@RC00077 L     @14,@PC00001                                     01S0110
         L     @14,CVTPTR(,@14)                                 01S0110
         L     @10,SDA00PTR(,@14)                               01S0110
         CLI   INDEVTYP(@10),C'S'                               01S0110
         BNE   @RF00110                                         01S0110
         L     @14,SENSEPTR(,@14)                               01S0110
         TM    FORMATNO(@14),B'00001000'                        01S0110
         BNO   @RF00110                                         01S0110
*     DO;                           /*                       @Y30LB52*/
*                                                               02S0112
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT OF CODE IS ENTERED TO UPDATE THE PROPER ERROR*/
*       /* COUNTER FOR AN ERROR REFLECTED IN A FORMAT 4 MSC OBR. THE */
*       /* SA NUMBER IS USED TO ACCESS THAT ARRAY WHICH POINTS TO A 4*/
*       /* BY 4 ARRAY OF ACCUMULATORS, 'DRDACCTB'. THIS ARRAY IS ALSO*/
*       /* ALLOCATED AS NEEDED. FIRST LOCATE THE MSC ADDRESS IN THE  */
*       /* TABLE OR THE FIRST EMPTY SLOT. COMPUTE THE SA NUMBER TO BE*/
*       /* USED AS AN INDEX INTO THE SA ARRAY. THE SA NUMBER IS IN   */
*       /* THE CHANNEL ADDRESS IN THE SA SENSE AND THE 'SARETRY' BYTE*/
*       /* DETERMINES THE LOWER INTERFACE ON THE MSC.                */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0112
*       IF SARETRY(8)=ON THEN       /* CHECK DSM INTF BIT    @Y30LB52*/
         TM    SARETRY(@14),B'00000001'                         02S0112
         BNO   @RF00112                                         02S0112
*         I=SALOWAD2/32+9;          /* IF ON, SA 9-16        @YD00146*/
         SLR   I,I                                              02S0113
         IC    I,SALOWAD2(,@14)                                 02S0113
         SRL   I,5                                              02S0113
         AH    I,@CH00341                                       02S0113
*       ELSE                                                    02S0114
*         I=SALOWAD2/32+1;          /* OTHERWISE, SA 1-8     @YD00146*/
*                                                               02S0114
         B     @RC00112                                         02S0114
@RF00112 L     @14,@PC00001                                     02S0114
         L     @14,CVTPTR(,@14)                                 02S0114
         L     @14,SENSEPTR(,@14)                               02S0114
         SLR   I,I                                              02S0114
         IC    I,SALOWAD2(,@14)                                 02S0114
         SRL   I,5                                              02S0114
         AH    I,@CH00049                                       02S0114
*       /*************************************************************/
*       /*                                                           */
*       /* THE ARRAY ELEMENT SELECTED IS A POINTER TO THE            */
*       /* ACCUMULATORS FOR THE PATH WITH THE SA AND MSC COMPUTED    */
*       /* ABOVE. IF XERO, THE ACCUMULATOR ARRAY MUST BE ALLOCATED.  */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0115
*       DRDTBPTR=SADRDACC(I);       /* LOAD ACCUMULATOR PTR  @Y30LB52*/
@RC00112 LR    @14,I                                            02S0115
         SLA   @14,3                                            02S0115
         LR    @10,SATABP                                       02S0115
         AL    @10,@CF00378                                     02S0115
         L     DRDTBPTR,SADRDACC(@14,@10)                       02S0115
*       IF DRDTBPTR=0 THEN                                      02S0116
         LTR   DRDTBPTR,DRDTBPTR                                02S0116
         BNZ   @RF00116                                         02S0116
*         DO;                       /* IF ZERO, ALLOCATE BLK @Y30LB52*/
*                                                               02S0117
*           /*********************************************************/
*           /*                                                       */
*           /* THIS SUBSEGMENT ASSIGNS A BLOCK OF STORAGE ON DEMAND. */
*           /* IF INSUFFICIENT STORAGE REMAINS IN THE LAST BLOCK, THE*/
*           /* SEGMENT 'P0ADDBLK' IS EXECUTED TO OBTAIN ANOTHER 2K OF*/
*           /* STORAGE AND CHAIN IT TO THE PREVIOUS BLOCK(S).        */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0118
*           SADRDACC(I)=COREASG;    /* SET BLOCK ADDRESS TO NEXT
*                                      AVAILABLE             @Y30LB52*/
         L     @10,COREASG(,PWORKPTR)                           02S0118
         AL    @14,@CF00378                                     02S0118
         ST    @10,SADRDACC(@14,SATABP)                         02S0118
*           COREASG=COREASG+LENGTH(CDRDACCT);/* INCREMENT THE NEXT
*                                      ADDRESS               @Y30LB52*/
*                                                               02S0119
         AH    @10,@CH00078                                     02S0119
         ST    @10,COREASG(,PWORKPTR)                           02S0119
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE CURRENT BLOCK DOESN'T CONTAIN ENOUGH SPACE, GET*/
*           /* A NEW 2K BLOCK AND CHAIN IT IN.                       */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0120
*           IF COREASG>ENDCORE THEN /* PAST END OF 2K BLOCK? @Y30LB52*/
         C     @10,ENDCORE(,PWORKPTR)                           02S0120
         BNH   @RF00120                                         02S0120
*             DO;                   /* GET ANOTHER           @Y30LB52*/
*               CALL P0ADDBLK;      /* INTERNAL PROCEDURE    @Y30LB52*/
         BAL   @14,P0ADDBLK                                     02S0122
*               RESPECIFY                                       02S0123
*                 R15 RESTRICTED;   /*                       @Y30LB52*/
*               IF R15^=0 THEN                                  02S0124
         LTR   R15,R15                                          02S0124
         BZ    @RF00124                                         02S0124
*                 DO;               /* OUT OF CORE?          @Y30LB52*/
*                   CPAD='00'X;     /* TURN OFF THE PAD REPORT  02S0126
*                                                            @Y30LB52*/
         L     @14,@PC00001                                     02S0126
         L     @14,CVTPTR(,@14)                                 02S0126
         L     @14,LPARMPTR(,@14)                               02S0126
         MVI   CPAD(@14),X'00'                                  02S0126
*                   RETURN CODE(NOSPACE);/* INDICATE WHAT HAPPENED
*                                                            @Y30LB52*/
         L     @13,4(,@13)                                      02S0127
         L     @00,@SIZDATD                                     02S0127
         LR    @01,@11                                          02S0127
         ISDAFSPC R,LV=(0),A=(1)
         LA    @15,4                                            02S0127
         L     @14,12(,@13)                                     02S0127
         LM    @00,@12,20(@13)                                  02S0127
         BR    @14                                              02S0127
*                 END;              /*                       @Y30LB52*/
*               ELSE                                            02S0129
*                 DO;               /* SET THE POINTERS      @Y30LB52*/
@RF00124 DS    0H                                               02S0130
*                   SADRDACC(I)=COREASG;/* SET BLOCK ADDRESS @Y30LB52*/
         LR    @14,I                                            02S0130
         SLA   @14,3                                            02S0130
         L     @10,COREASG(,PWORKPTR)                           02S0130
         AL    @14,@CF00378                                     02S0130
         ST    @10,SADRDACC(@14,SATABP)                         02S0130
*                   COREASG=COREASG+LENGTH(CDRDACCT);/* INCREMENT THE
*                                      ASSIGNL               @Y30LB52*/
         AH    @10,@CH00078                                     02S0131
         ST    @10,COREASG(,PWORKPTR)                           02S0131
*                 END;              /*                       @Y30LB52*/
*             END;                  /*                       @Y30LB52*/
*           DRDTBPTR=SADRDACC(I);   /* LOAD ACCUMULATOR PTR  @Y30LB52*/
@RF00120 LR    @14,I                                            02S0134
         SLA   @14,3                                            02S0134
         AL    @14,@CF00378                                     02S0134
         L     DRDTBPTR,SADRDACC(@14,SATABP)                    02S0134
*           RESPECIFY                                           02S0135
*             DRDACCTB BASED(DRDTBPTR);/* SET BASE           @Y30LB52*/
*           CDRDACCT=CDRDACCT&&CDRDACCT;/* CLEAR             @Y30LB52*/
         XC    CDRDACCT(96,DRDTBPTR),CDRDACCT(DRDTBPTR)         02S0136
*         END;                      /*                       @Y30LB52*/
*                                                               02S0137
*       /*************************************************************/
*       /*                                                           */
*       /* SET A POINTER TO THE ACCUMULATOR OBTAINED AND EXTRACT THE */
*       /* LOGICAL DRD AND DRC NUMBERS FROM THE CHANNEL ADDRESS IN   */
*       /* THE SENSE(SALOWAD2).                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0138
*       I=SALOWAD2(1:8)&'0F'X;      /* LOAD DRC AND DRD      @YD00146
*                                      NUMBER                @Y30LB52*/
@RF00116 L     @14,@PC00001                                     02S0138
         L     @14,CVTPTR(,@14)                                 02S0138
         L     @14,SENSEPTR(,@14)                               02S0138
         SLR   @10,@10                                          02S0138
         IC    @10,SALOWAD2(,@14)                               02S0138
         LA    I,15                                             02S0138
         NR    I,@10                                            02S0138
*       I=I/4+1;                    /* LOAD DRC              @Y30LB52*/
         LA    @09,1                                            02S0139
         LR    @08,I                                            02S0139
         SRL   @08,2                                            02S0139
         ALR   @08,@09                                          02S0139
         LR    I,@08                                            02S0139
*       J=SALOWAD2(1:8)&'03'X;      /* LOAD DRD NUMBER       @YD00146*/
         N     @10,@CF00344                                     02S0140
         LR    J,@10                                            02S0140
*       J=J+1;                      /* LOAD DRD INDEX        @Y30LB52*/
*                                                               02S0141
         ALR   J,@09                                            02S0141
*       /*************************************************************/
*       /*                                                           */
*       /* DEPENDING ON WHICH SUBFORMAT(9,A,B,E) IS INDICATED IN THE */
*       /* RECORD AND THE DRD AND DRC LOGICAL ADDRESSES, THE         */
*       /* APPROPRIATE ACCUMULATOR IS INCREMENTED.                   */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0142
*       I=ADDR(DRDACCTB(I,J));      /* LOAD POINTER TO       @Y30LB52
*                                      ACCUMULATOR           @Y30LB52*/
         LR    @10,I                                            02S0142
         SLA   @10,2                                            02S0142
         ALR   @10,J                                            02S0142
         MH    @10,@CH00076                                     02S0142
         AL    @10,@CF00379                                     02S0142
         LA    @10,DRDACCTB(@10,DRDTBPTR)                       02S0142
         LR    I,@10                                            02S0142
*       RESPECIFY                                               02S0143
*        (DRDACCS) BASED(I);        /*                       @Y30LB52*/
*       IF SUBFMTNO='1001'B THEN    /* IF SUBFORMAT 9        @Y30LB52*/
         TM    SUBFMTNO(@14),B'10010000'                        02S0144
         BNO   @RF00144                                         02S0144
         TM    SUBFMTNO(@14),B'01100000'                        02S0144
         BNZ   @RF00144                                         02S0144
*         DRDERRS=DRDERRS+1;        /* INCREMENT THE PTR     @Y30LB52*/
         AH    @09,DRDERRS(,I)                                  02S0145
         STH   @09,DRDERRS(,I)                                  02S0145
*       ELSE                        /* OTHERWISE, CHECK OTHER@Y30LB52
*                                      SUBS                  @Y30LB52*/
*         IF SUBFMTNO='1010'B THEN  /* IF SUB A,             @Y30LB52*/
         B     @RC00144                                         02S0146
@RF00144 L     @14,@PC00001                                     02S0146
         L     @14,CVTPTR(,@14)                                 02S0146
         L     @14,SENSEPTR(,@14)                               02S0146
         TM    SUBFMTNO(@14),B'10100000'                        02S0146
         BNO   @RF00146                                         02S0146
         TM    SUBFMTNO(@14),B'01010000'                        02S0146
         BNZ   @RF00146                                         02S0146
*           CTLIERRS=CTLIERRS+1;    /* INCREMENT CTLI        @Y30LB52
*                                      ACCUMULATOR           @Y30LB52*/
         LA    @14,1                                            02S0147
         AH    @14,CTLIERRS(,I)                                 02S0147
         STH   @14,CTLIERRS(,I)                                 02S0147
*         ELSE                      /* CHECK SUB B           @ZM30731*/
*           IF SUBFMTNO='1011'B THEN/* SA FORMAT B           @ZM30731*/
         B     @RC00146                                         02S0148
@RF00146 L     @14,@PC00001                                     02S0148
         L     @14,CVTPTR(,@14)                                 02S0148
         L     @14,SENSEPTR(,@14)                               02S0148
         TM    SUBFMTNO(@14),B'10110000'                        02S0148
         BNO   @RF00148                                         02S0148
         TM    SUBFMTNO(@14),B'01000000'                        02S0148
         BNZ   @RF00148                                         02S0148
*             IF SSIDTYPE='0010'B THEN/* DRD SSID            @ZM30731*/
         TM    SSIDTYPE(@14),B'00000010'                        02S0149
         BNO   @RF00149                                         02S0149
         TM    SSIDTYPE(@14),B'00001101'                        02S0149
         BNZ   @RF00149                                         02S0149
*               DRDERRS=DRDERRS+1;  /* YES, INC DRD COUNT    @ZM30731*/
         LA    @14,1                                            02S0150
         AH    @14,DRDERRS(,I)                                  02S0150
         STH   @14,DRDERRS(,I)                                  02S0150
*             ELSE                  /* NO, MUST BE DRC SSID  @ZM30731*/
*               DRCERRS=DRCERRS+1;  /* INC DRC ACCUMULATOR   @ZM30731*/
         B     @RC00149                                         02S0151
@RF00149 LA    @14,1                                            02S0151
         AH    @14,DRCERRS(,I)                                  02S0151
         STH   @14,DRCERRS(,I)                                  02S0151
*           ELSE                    /* MUST BE SA FORMAT E   @ZM30731*/
*             DRCERRS=DRCERRS+1;    /* MUST BE ABOX ERROR    @Y30LB52*/
         B     @RC00148                                         02S0152
@RF00148 LA    @14,1                                            02S0152
         AH    @14,DRCERRS(,I)                                  02S0152
         STH   @14,DRCERRS(,I)                                  02S0152
*       I=P0LIBN/16+1;              /* LOAD LIB INDEX        @Y30LB52*/
@RC00148 DS    0H                                               02S0153
@RC00146 DS    0H                                               02S0153
@RC00144 LA    @14,1                                            02S0153
         L     @10,@PC00001                                     02S0153
         L     @10,CVTPTR(,@10)                                 02S0153
         L     @10,SENSEPTR(,@10)                               02S0153
         SLR   I,I                                              02S0153
         IC    I,P0LIBN(,@10)                                   02S0153
         SRL   I,4                                              02S0153
         ALR   I,@14                                            02S0153
*       CSFTOTAL(I)=CSFTOTAL(I)+1;  /* INCREMENT LIB TOTAL   @Y30LB52
*                                                            @Y30LB52*/
         LR    @10,I                                            02S0154
         ALR   @10,@10                                          02S0154
         AH    @14,CSFTOTAL-2(@10,PWORKPTR)                     02S0154
         STH   @14,CSFTOTAL-2(@10,PWORKPTR)                     02S0154
*                                                               02S0155
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SMALL STRUCTURE MAPS THE SSID IN THE MSC FORMAT4     */
*       /* SENSE RECORD FOR THE PURPOSE OF EXTRACTING THE LIBRARY    */
*       /* CARTRIDGE STORE NUMBER.                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0155
*       DCL                                                     02S0155
*         1 P0SSID DEF(SUBSYSID),   /* SUBSYSTEM ID          @Y30LB52*/
*          2 * FIXED(8),            /* FIRST BYTE            @Y30LB52*/
*          2 P0LIBN FIXED(8);       /* LIBRARY AND DRD       @Y30LB52*/
*     END;                          /*                       @Y30LB52*/
*   ELSE                                                        01S0157
*     DO;                           /* FMT 5 OR OBR          @Y30LB52*/
         B     @RC00110                                         01S0157
@RF00110 DS    0H                                               01S0158
*                                                               02S0158
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT IS CALLED TO THE ERRORS RECORDED IN FORMAT   */
*       /* 5(DASD) RECORDS. THE FIRST DECISION ROUTES CONTROL THROUGH*/
*       /* ONE OF TWO SEGMENTS WHICH LOAD AND ALLOCATE IF NECESSARY  */
*       /* THE ADDRESS OF AN ACCUMLATOR ARRAY. ONE SEGMENT(SSDASD) IS*/
*       /* EXECUTED FOR ERRORS LOGGED DUE TO 'MSC' I/O AND THE       */
*       /* OTHER(CHDASD), FOR HOST CHANNEL DASD ERRORS.              */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0158
*       IF INDEVTYP='S' THEN                                    02S0158
         L     @14,@PC00001                                     02S0158
         L     @14,CVTPTR(,@14)                                 02S0158
         L     @10,SDA00PTR(,@14)                               02S0158
         CLI   INDEVTYP(@10),C'S'                               02S0158
         BNE   @RF00158                                         02S0158
*         DO;                       /*                       @Y30LB52*/
*                                                               03S0160
*           /*********************************************************/
*           /*                                                       */
*           /* THIS SEGMENT IS EXECUTED FOR ALL MSC/DASD ERRORS      */
*           /* ENCOUNTERED. AT THIS POINT, THE 'SADRDDASD' ARRAY HAS */
*           /* BEEN ADDRESSED BY POINTER. THIS SEGMENT LOCATES THE   */
*           /* PROPER ENTRY IN THIS ARRAY BY USING THE 'SA' NUMBER IN*/
*           /* THE LAST BYRE OF THE SENSE DATA AND LOADS A POINTER TO*/
*           /* THE ACCUMULATOR ARRAY FOR THIS 'SA' AND 'MSC'         */
*           /* COMBINATION. IF THE ACCUMULATOR POINTER IS ZERO, THE  */
*           /* ACCUMULATOR ARRAY MUST FIRST BE ALLOCATED.            */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0160
*           I=(SANOMSCD&'0F'X)+1;   /* LOAD SA NUMBER        @ZA25718*/
         L     @14,SENSEPTR(,@14)                               03S0160
         LA    I,15                                             03S0160
         SLR   @10,@10                                          03S0160
         IC    @10,SANOMSCD(,@14)                               03S0160
         NR    I,@10                                            03S0160
         AH    I,@CH00049                                       03S0160
*           SPTBPTR=SADASDAC(I);    /* LOAD ACCUMULATOR ADDRESS 03S0161
*                                                            @Y30LB52*/
         LR    @14,I                                            03S0161
         SLA   @14,3                                            03S0161
         LR    @10,SATABP                                       03S0161
         AL    @10,@CF00380                                     03S0161
         L     SPTBPTR,SADASDAC-4(@14,@10)                      03S0161
*           IF SPTBPTR=0            /* NOT ALLOCATED         @Y30LB52*/
*             THEN                                              03S0162
         LTR   SPTBPTR,SPTBPTR                                  03S0162
         BNZ   @RF00162                                         03S0162
*             DO;                   /* THEN ALLOCATE         @Y30LB52*/
*                                                               03S0163
*               /*****************************************************/
*               /*                                                   */
*               /* THIS SUBSEGMENT ASSIGNS A BLOCK OF STORAGE ON     */
*               /* DEMAND. IF INSUFFICIENT STORAGE REMAINS IN THE    */
*               /* LAST BLOCK, THE SEGMENT 'P0ADDBLK' IS EXECUTED TO */
*               /* OBTAIN ANOTHER 2K OF STORAGE AND CHAIN IT TO THE  */
*               /* PREVIOUS BLOCK(S).                                */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0164
*               SADASDAC(I)=COREASG;/* SET BLOCK ADDRESS TO NEXT
*                                      AVAILABLE             @Y30LB52*/
         L     @10,COREASG(,PWORKPTR)                           03S0164
         AL    @14,@CF00380                                     03S0164
         ST    @10,SADASDAC-4(@14,SATABP)                       03S0164
*               COREASG=COREASG+LENGTH(CSPNDLET);/* INCREMENT THE
*                                      NEXT ADDRESS          @Y30LB52*/
*                                                               03S0165
         AH    @10,@CH00096                                     03S0165
         ST    @10,COREASG(,PWORKPTR)                           03S0165
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE CURRENT BLOCK DOESN'T CONTAIN ENOUGH SPACE,*/
*               /* GET A NEW 2K BLOCK AND CHAIN IT IN.               */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0166
*               IF COREASG>ENDCORE THEN/* PAST END OF 2K BLOCK? 03S0166
*                                                            @Y30LB52*/
         C     @10,ENDCORE(,PWORKPTR)                           03S0166
         BNH   @RF00166                                         03S0166
*                 DO;               /* GET ANOTHER           @Y30LB52*/
*                   CALL P0ADDBLK;  /* INTERNAL PROCEDURE    @Y30LB52*/
         BAL   @14,P0ADDBLK                                     03S0168
*                   RESPECIFY                                   03S0169
*                     R15 RESTRICTED;/*                      @Y30LB52*/
*                   IF R15^=0 THEN                              03S0170
         LTR   R15,R15                                          03S0170
         BZ    @RF00170                                         03S0170
*                     DO;           /* OUT OF CORE?          @Y30LB52*/
*                       CPAD='00'X; /* TURN OFF THE PAD REPORT  03S0172
*                                                            @Y30LB52*/
         L     @14,@PC00001                                     03S0172
         L     @14,CVTPTR(,@14)                                 03S0172
         L     @14,LPARMPTR(,@14)                               03S0172
         MVI   CPAD(@14),X'00'                                  03S0172
*                       RETURN CODE(NOSPACE);/* INDICATE WHAT   03S0173
*                                      HAPPENED              @Y30LB52*/
         L     @13,4(,@13)                                      03S0173
         L     @00,@SIZDATD                                     03S0173
         LR    @01,@11                                          03S0173
         ISDAFSPC R,LV=(0),A=(1)
         LA    @15,4                                            03S0173
         L     @14,12(,@13)                                     03S0173
         LM    @00,@12,20(@13)                                  03S0173
         BR    @14                                              03S0173
*                     END;          /*                       @Y30LB52*/
*                   ELSE                                        03S0175
*                     DO;           /* SET THE POINTERS      @Y30LB52*/
@RF00170 DS    0H                                               03S0176
*                       SADASDAC(I)=COREASG;/* SET BLOCK ADDRESS
*                                                            @Y30LB52*/
         LR    @14,I                                            03S0176
         SLA   @14,3                                            03S0176
         L     @10,COREASG(,PWORKPTR)                           03S0176
         AL    @14,@CF00380                                     03S0176
         ST    @10,SADASDAC-4(@14,SATABP)                       03S0176
*                       COREASG=COREASG+LENGTH(CSPNDLET);/* INCREMENT
*                                      THE ASSIGNL           @Y30LB52*/
         AH    @10,@CH00096                                     03S0177
         ST    @10,COREASG(,PWORKPTR)                           03S0177
*                     END;          /*                       @Y30LB52*/
*                 END;              /*                       @Y30LB52*/
*                                                               03S0179
*               /*****************************************************/
*               /*                                                   */
*               /* CLEAR THE ARRAY                                   */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0180
*               SPTBPTR=SADASDAC(I);/* LOAD ACCUMULATOR ADDRESS 03S0180
*                                                            @Y30LB52*/
@RF00166 LR    @14,I                                            03S0180
         SLA   @14,3                                            03S0180
         AL    @14,@CF00380                                     03S0180
         L     SPTBPTR,SADASDAC-4(@14,SATABP)                   03S0180
*               RESPECIFY                                       03S0181
*                 SPNDLETB BASED(SPTBPTR);/*                 @Y30LB52*/
*               CSPNDLET=CSPNDLET&&CSPNDLET;/* CLEAR ACCUMULATOR BLK
*                                                            @Y30LB52*/
         XC    CSPNDLET(192,SPTBPTR),CSPNDLET(SPTBPTR)          03S0182
*             END;                  /*                       @Y30LB52*/
*                                                               03S0183
*           /*********************************************************/
*           /*                                                       */
*           /* LOAD THE CONTROL UNIT, DRIVE ADDRESS, AND THE DASD    */
*           /* SUBFORMAT NUMBER.                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0184
*           RESPECIFY                                           03S0184
*             ISDAMSC5 BASED(K);    /*                       @Y30LB52*/
@RF00162 DS    0H                                               03S0185
*           K=SENSEPTR+4;           /* LOAD DASD SENSC ADDRESS  03S0185
*                                                            @Y30LB52*/
         L     @14,@PC00001                                     03S0185
         L     @14,CVTPTR(,@14)                                 03S0185
         LA    K,4                                              03S0185
         AL    K,SENSEPTR(,@14)                                 03S0185
*           I=DRIVEID4;             /* LOAD THE CU AND DRIVE @Y30LB52*/
         SLR   I,I                                              03S0186
         IC    I,DRIVEID4(,K)                                   03S0186
*           J=(I&'3F'X)/7;          /* LOAD THE DRIVE ADDRESS@Y30LB52*/
         LA    @00,63                                           03S0187
         NR    @00,I                                            03S0187
         LR    @09,@00                                          03S0187
         SLR   @08,@08                                          03S0187
         D     @08,@CF00356                                     03S0187
         LR    J,@09                                            03S0187
*           J=ABS(J-9);             /* COMPUTE ACCUMULATOR INDEX
*                                                            @Y30LB52*/
         LR    @14,J                                            03S0188
         SH    @14,@CH00341                                     03S0188
         LPR   @14,@14                                          03S0188
         LR    J,@14                                            03S0188
*           I=I/64+1;               /* CONTROLLER ADDRESS    @Y30LB52*/
         LA    @14,1                                            03S0189
         LR    @10,I                                            03S0189
         SRL   @10,6                                            03S0189
         ALR   @10,@14                                          03S0189
         LR    I,@10                                            03S0189
*           K=FMTMSG5/16;           /* DASD SUBFORMAT NUMBER @Y30LB52*/
         SLR   @10,@10                                          03S0190
         IC    @10,FMTMSG5(,K)                                  03S0190
         SRL   @10,4                                            03S0190
         LR    K,@10                                            03S0190
*           IF J<1J>8 THEN         /* INVALID DRIVE ID      @ZA00699*/
         CR    J,@14                                            02S0191
         BL    @RT00191                                         02S0191
         CH    J,@CH00057                                       02S0191
         BNH   @RF00191                                         02S0191
@RT00191 DS    0H                                               02S0192
*             RETURN CODE(0);       /* IGNORE BUT REC VALID  @ZA00699*/
         L     @13,4(,@13)                                      02S0192
         L     @00,@SIZDATD                                     02S0192
         LR    @01,@11                                          02S0192
         ISDAFSPC R,LV=(0),A=(1)
         SLR   @15,@15                                          02S0192
         L     @14,12(,@13)                                     02S0192
         LM    @00,@12,20(@13)                                  02S0192
         BR    @14                                              02S0192
*           ELSE                    /* DRIVE ID OK           @ZA00699*/
*             MSCTOTAL=MSCTOTAL+1;  /* INCREMENT TOTAL MSC DASD 02S0193
*                                                            @Y30LB52*/
@RF00191 LA    @14,1                                            02S0193
         AH    @14,MSCTOTAL(,PWORKPTR)                          02S0193
         STH   @14,MSCTOTAL(,PWORKPTR)                          02S0193
*         END;                      /*                       @Y30LB52*/
*       ELSE                                                    02S0195
*         DO;                       /*                       @Y30LB52*/
         B     @RC00158                                         02S0195
@RF00158 DS    0H                                               02S0196
*                                                               03S0196
*           /*********************************************************/
*           /*                                                       */
*           /* A HOST CHANNEL INTERFACE. IT'S FUNCTION IS THAT OF    */
*           /* LOCATING AND ALLOCATING, IF NECESSARY, THE PROPER     */
*           /* ACCUMULATOR ARRAY FOR THE STORAGE ADAPTER INDICATED IN*/
*           /* THE SENSE. THE PROPER 'SA' ENTRY IS LOCATED IN THE    */
*           /* 'CHCUTAB' BY COMPARING THE CPUID/CH/CU IN THE SENSE TO*/
*           /* THE TABLE ENTRIES. WHEN A MATCH IS FOUND, THE         */
*           /* ACCUMULATOR BASE REGISTER IS LOADED.                  */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0196
*           DCL                                                 03S0196
*             1 DCPUCHCU BDY(WORD), /* INTERFACE COMPONENTS  @Y30LB52*/
*              2 DCPUID CHAR(5),    /* CPUID                 @Y30LB52*/
*              2 DCHCU FIXED(8);    /* SET CHANNEL/CONTROL UNIT 03S0196
*                                                            @Y30LB52*/
*                                                               03S0197
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP THE CPU/CH/CU ID'S FOR THE TABLE SEARCH.       */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0197
*           DCPUID(1:3)=CPUSER;     /* SET CPU SERIAL        @Y30LB52*/
         L     @14,@PC00001                                     03S0197
         L     @14,CVTPTR(,@14)                                 03S0197
         L     @10,LOGPTR(,@14)                                 03S0197
         MVC   DCPUID(3),CPUSER(@10)                            03S0197
*           DCPUID(4:5)=CPUID;      /*                       @Y30LB52*/
         MVC   DCPUID+3(2),CPUID(@10)                           03S0198
*           I=INRECCUA(1);          /* LOAD CHANNEL ADDRESS  @Y30LB52*/
         L     @10,SDA00PTR(,@14)                               03S0199
         SLR   I,I                                              03S0199
         IC    I,INRECCUA(,@10)                                 03S0199
*           I=I*16;                 /* SHIFT TO HIGH ORDER 4B@Y30LB52*/
         SLL   I,4                                              03S0200
*           J=INRECCUA(2);          /* LOAD 2ND BYTE         @Y30LB52*/
         SLR   J,J                                              03S0201
         IC    J,INRECCUA+1(,@10)                               03S0201
*           DCHCU=(J/64)I;         /*                       @Y30LB52
*                                      SHIFT CU ADDR AND COMBINE     */
*                                                               03S0202
         LR    @10,J                                            03S0202
         SRL   @10,6                                            03S0202
         OR    @10,I                                            03S0202
         STC   @10,DCHCU                                        03S0202
*           /*********************************************************/
*           /*                                                       */
*           /* SCAN THROUGH THE 'CHCUTAB' LOOKING FOR THE            */
*           /* CPUID/CHAN/CU IN THE SENSE RECORD.                    */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0203
*           CHCUPTR=CHCUAD;         /* LOAD FIRST ENTRY ADDR @Y30LB52*/
         L     @14,CNFG0PTR(,@14)                               03S0203
         L     CHCUPTR,CHCUAD(,@14)                             03S0203
*           RESPECIFY                                           03S0204
*             CHCUTAB BASED(CHCUPTR);/*                      @Y30LB52*/
*           DO I=1 TO CHINTFNO      /*                       @Y30LB52
*                                      LOOP THROUGH ALL ENTRIES      */
*                 WHILE((CPUIDSER^=DCPUID)(CHCU^=DCHCU));/* @Y30LB52*/
         LA    I,1                                              03S0205
         B     @DE00205                                         03S0205
@DL00205 CLC   CPUIDSER(5,CHCUPTR),DCPUID                       03S0205
         BNE   @DB00205                                         03S0205
         CLC   CHCU(1,CHCUPTR),DCHCU                            03S0205
         BE    @DC00205                                         03S0205
@DB00205 DS    0H                                               03S0206
*             CHCUPTR=CHCUPTR+LENGTH(CHCUTAB);/* INCREMENT CHCUTAB
*                                                            @Y30LB52
*                                      PTR                   @Y30LB52*/
         AH    CHCUPTR,@CH00087                                 03S0206
*           END;                    /*                       @Y30LB52*/
*                                                               03S0207
         AH    I,@CH00049                                       03S0207
@DE00205 L     @14,@PC00001                                     03S0207
         L     @14,CVTPTR(,@14)                                 03S0207
         L     @14,CNFG0PTR(,@14)                               03S0207
         CH    I,CHINTFNO(,@14)                                 03S0207
         BNH   @DL00205                                         03S0207
@DC00205 DS    0H                                               03S0208
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO MATCH FOUND, MUST BE A NON-SUBSYSTEM RECORD.    */
*           /* SKIP IT.                                              */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0208
*           IF I>CHINTFNO THEN      /* NO MATCH              @Y30LB52*/
         L     @14,@PC00001                                     03S0208
         L     @14,CVTPTR(,@14)                                 03S0208
         L     @14,CNFG0PTR(,@14)                               03S0208
         CH    I,CHINTFNO(,@14)                                 03S0208
         BNH   @RF00208                                         03S0208
*             RETURN CODE(0);       /* IGNORE                @Y30LB52*/
*                                                               03S0209
         L     @13,4(,@13)                                      03S0209
         L     @00,@SIZDATD                                     03S0209
         LR    @01,@11                                          03S0209
         ISDAFSPC R,LV=(0),A=(1)
         SLR   @15,@15                                          03S0209
         L     @14,12(,@13)                                     03S0209
         LM    @00,@12,20(@13)                                  03S0209
         BR    @14                                              03S0209
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE ACCUMULATOR POINTER IN THE ENTRY IS XERO, THE  */
*           /* ACCUMULATOR MUST BE ALLOCATED FIRST.                  */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0210
*           ELSE                                                03S0210
*             DO;                   /* MATCH FOUND           @Y30LB52*/
@RF00208 DS    0H                                               03S0211
*               SPTBPTR=SPLTABP;    /* SET ACCUMULATOR BASE  @Y30LB52*/
         L     @14,SPLTABP(,CHCUPTR)                            03S0211
         LR    SPTBPTR,@14                                      03S0211
*               IF SPLTABP=0 THEN   /* ID XERO               @Y30LB52*/
         LTR   @14,@14                                          03S0212
         BNZ   @RF00212                                         03S0212
*                 DO;               /* ALLOCATE BLOCK        @Y30LB52*/
*                                                               03S0213
*                   /*************************************************/
*                   /*                                               */
*                   /* THIS SUBSEGMENT ASSIGNS A BLOCK OF STORAGE ON */
*                   /* DEMAND. IF INSUFFICIENT STORAGE REMAINS IN THE*/
*                   /* LAST BLOCK, THE SEGMENT 'P0ADDBLK' IS EXECUTED*/
*                   /* TO OBTAIN ANOTHER 2K OF STORAGE AND CHAIN IT  */
*                   /* TO THE PREVIOUS BLOCK(S).                     */
*                   /*                                               */
*                   /*************************************************/
*                                                               03S0214
*                   SPLTABP=COREASG;/* SET BLOCK ADDRESS TO NEXT
*                                      AVAILABLE             @Y30LB52*/
         L     @14,COREASG(,PWORKPTR)                           03S0214
         ST    @14,SPLTABP(,CHCUPTR)                            03S0214
*                   COREASG=COREASG+LENGTH(CSPNDLET);/* INCREMENT THE
*                                      NEXT ADDRESS          @Y30LB52*/
*                                                               03S0215
         AH    @14,@CH00096                                     03S0215
         ST    @14,COREASG(,PWORKPTR)                           03S0215
*                   /*************************************************/
*                   /*                                               */
*                   /* IF THE CURRENT BLOCK DOESN'T CONTAIN ENOUGH   */
*                   /* SPACE, GET A NEW 2K BLOCK AND CHAIN IT IN.    */
*                   /*                                               */
*                   /*************************************************/
*                                                               03S0216
*                   IF COREASG>ENDCORE THEN/* PAST END OF 2K BLOCK?
*                                                            @Y30LB52*/
         C     @14,ENDCORE(,PWORKPTR)                           03S0216
         BNH   @RF00216                                         03S0216
*                     DO;           /* GET ANOTHER           @Y30LB52*/
*                       CALL P0ADDBLK;/* INTERNAL PROCEDURE  @Y30LB52*/
         BAL   @14,P0ADDBLK                                     03S0218
*                       RESPECIFY                               03S0219
*                         R15 RESTRICTED;/*                  @Y30LB52*/
*                       IF R15^=0 THEN                          03S0220
         LTR   R15,R15                                          03S0220
         BZ    @RF00220                                         03S0220
*                         DO;       /* OUT OF CORE?          @Y30LB52*/
*                           CPAD='00'X;/* TURN OFF THE PAD REPORT
*                                                            @Y30LB52*/
         L     @14,@PC00001                                     03S0222
         L     @14,CVTPTR(,@14)                                 03S0222
         L     @14,LPARMPTR(,@14)                               03S0222
         MVI   CPAD(@14),X'00'                                  03S0222
*                           RETURN CODE(NOSPACE);/* INDICATE WHAT
*                                      HAPPENED              @Y30LB52*/
         L     @13,4(,@13)                                      03S0223
         L     @00,@SIZDATD                                     03S0223
         LR    @01,@11                                          03S0223
         ISDAFSPC R,LV=(0),A=(1)
         LA    @15,4                                            03S0223
         L     @14,12(,@13)                                     03S0223
         LM    @00,@12,20(@13)                                  03S0223
         BR    @14                                              03S0223
*                         END;      /*                       @Y30LB52*/
*                       ELSE                                    03S0225
*                         DO;       /* SET THE POINTERS      @Y30LB52*/
@RF00220 DS    0H                                               03S0226
*                           SPLTABP=COREASG;/* SET BLOCK ADDRESS
*                                                            @Y30LB52*/
         L     @14,COREASG(,PWORKPTR)                           03S0226
         ST    @14,SPLTABP(,CHCUPTR)                            03S0226
*                           COREASG=COREASG+LENGTH(CSPNDLET);/* 03S0227
*                                      INCREMENT THE ASSIGNL @Y30LB52*/
         AH    @14,@CH00096                                     03S0227
         ST    @14,COREASG(,PWORKPTR)                           03S0227
*                         END;      /*                       @Y30LB52*/
*                     END;          /*                       @Y30LB52*/
*                   SPTBPTR=SPLTABP;/* SET NEW POINTER       @Y30LB52*/
@RF00216 L     SPTBPTR,SPLTABP(,CHCUPTR)                        03S0230
*                   CSPNDLET=CSPNDLET&&CSPNDLET;/* CLEAR THE    03S0231
*                                      ACCUMULATOR           @Y30LB52*/
         XC    CSPNDLET(192,SPTBPTR),CSPNDLET(SPTBPTR)          03S0231
*                 END;              /*                       @Y30LB52*/
*             END;                  /*                       @Y30LB52*/
*                                                               03S0233
@RF00212 DS    0H                                               03S0234
*           /*********************************************************/
*           /*                                                       */
*           /* LOAD THE CONTROL UNIT AND DRIVE ADDRESSES AND THE DASD*/
*           /* SUBFORMAT NUMBER                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0234
*           RESPECIFY                                           03S0234
*            (ISDAMSC5) BASED(SENSEPTR);/*                   @Y30LB52*/
*           I=DRIVEID4;             /* LOAD THE CU/DRIVE BYTE@Y30LB52
*                                                            @Y30LB52*/
         L     @14,@PC00001                                     03S0235
         L     @14,CVTPTR(,@14)                                 03S0235
         L     @14,SENSEPTR(,@14)                               03S0235
         SLR   I,I                                              03S0235
         IC    I,DRIVEID4(,@14)                                 03S0235
*           J=(I&'3F'X)/7;          /* LOAD THE DRIVE INDEX  @Y30LB52*/
         LA    @08,63                                           03S0236
         NR    @08,I                                            03S0236
         LR    @01,@08                                          03S0236
         SLR   @00,@00                                          03S0236
         D     @00,@CF00356                                     03S0236
         LR    J,@01                                            03S0236
*           J=ABS(J-9);             /* COMPUTE ACCUMULATOR INDEX
*                                                            @Y30LB52*/
         LR    @10,J                                            03S0237
         SH    @10,@CH00341                                     03S0237
         LPR   @10,@10                                          03S0237
         LR    J,@10                                            03S0237
*           I=I/64+1;               /* LOAD CU ADDRESS       @Y30LB52*/
         LA    @10,1                                            03S0238
         LR    @07,I                                            03S0238
         SRL   @07,6                                            03S0238
         ALR   @07,@10                                          03S0238
         LR    I,@07                                            03S0238
*           K=FMTMSG5/16;           /* LOAD DASD SUBFORMAT   @Y30LB52*/
         SLR   K,K                                              03S0239
         IC    K,FMTMSG5(,@14)                                  03S0239
         SRL   K,4                                              03S0239
*           IF J<1J>8 THEN         /* INVALID DRIVE ID      @ZA00699*/
         CR    J,@10                                            02S0240
         BL    @RT00240                                         02S0240
         CH    J,@CH00057                                       02S0240
         BNH   @RF00240                                         02S0240
@RT00240 DS    0H                                               02S0241
*             RETURN CODE(0);       /* IGNORE BUT REC VALID  @ZA00699*/
         L     @13,4(,@13)                                      02S0241
         L     @00,@SIZDATD                                     02S0241
         LR    @01,@11                                          02S0241
         ISDAFSPC R,LV=(0),A=(1)
         SLR   @15,@15                                          02S0241
         L     @14,12(,@13)                                     02S0241
         LM    @00,@12,20(@13)                                  02S0241
         BR    @14                                              02S0241
*           ELSE                    /* DRIVE ID OK           @ZA00699*/
*             HTOTAL=HTOTAL+1;      /* INCREMENT HOST CHANNEL TOTAL
*                                                            @Y30LB52*/
@RF00240 LA    @14,1                                            02S0242
         AH    @14,HTOTAL(,PWORKPTR)                            02S0242
         STH   @14,HTOTAL(,PWORKPTR)                            02S0242
*         END;                      /*                       @Y30LB52*/
*                                                               02S0243
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING CASE LOGIC CODE INCREMENTS THE PROPER ERROR */
*       /* COUNTER. THE ACCUMLATOR ARRAY POINTER HAS BEEN SET, 'I'   */
*       /* CONTAINS THE LOGICAL DASD A-BOX ADDRESS, AND 'J' CONTAINS */
*       /* THE DRIVE ADDRESS. SEPARATE ACCUMULATORS ARE MAINTAINED   */
*       /* FOR EACH OF THE SUBFORMATS(1,2,3). THE SUBFORMAT IS USED  */
*       /* TO CONTROL THE FLOW THROUGH THE CASE LOGIC.               */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0244
*       J=ADDR(SPNDLETB(I,J));      /*                       @Y30LB52*/
@RC00158 LR    @14,I                                            02S0244
         SLA   @14,3                                            02S0244
         ALR   @14,J                                            02S0244
         MH    @14,@CH00076                                     02S0244
         AL    @14,@CF00381                                     02S0244
         LA    @14,SPNDLETB(@14,SPTBPTR)                        02S0244
         LR    J,@14                                            02S0244
*       RESPECIFY                                               02S0245
*        (SPNDLES) BASED(J);        /*                       @Y30LB52*/
*       DO;                         /* CASE(K)NAMES(DCHK,STCHK,STCCHK
*                                      )                             */
*         DCL                                                   02S0247
*           CL0001@ LABEL BASED(CP0001@(K)) VALUERANGE(DCHK,STCHK,
*               STCCHK);            /* BRANCH TARGET                 */
*         DCL                                                   02S0248
*           CP0001@(3) PTR(31) INIT(ADDR(DCHK),ADDR(STCHK),ADDR(STCCHK)
*               );                                              02S0248
*         GOTO CL0001@;             /* BRANCH TO SELECTED CASE  02S0249
*                                                            @Y30LB52*/
         LR    @14,K                                            02S0249
         SLA   @14,2                                            02S0249
         L     @14,CP0001@-4(@14)                               02S0249
         BR    @14                                              02S0249
*DCHK:                                                          02S0250
*         DO;                       /* SUBCASE               @Y30LB52*/
DCHK     DS    0H                                               02S0251
*           DRVEQCHK=DRVEQCHK+1;    /*                       @Y30LB52*/
         LA    @14,1                                            02S0251
         AH    @14,DRVEQCHK(,J)                                 02S0251
         STH   @14,DRVEQCHK(,J)                                 02S0251
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0252
*         END;                      /* END OF SUBCASE                */
*STCHK:                                                         02S0254
*         DO;                       /* SUBCASE               @Y30LB52*/
STCHK    DS    0H                                               02S0255
*           STCTLCHK=STCTLCHK+1;    /*                       @Y30LB52*/
         LA    @14,1                                            02S0255
         AH    @14,STCTLCHK(,J)                                 02S0255
         STH   @14,STCTLCHK(,J)                                 02S0255
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0256
*         END;                      /* END OF SUBCASE                */
*STCCHK:                                                        02S0258
*         DO;                       /* SUBCASE               @Y30LB52*/
STCCHK   DS    0H                                               02S0259
*           STCTLCCK=STCTLCCK+1;    /*                       @Y30LB52*/
         LA    @14,1                                            02S0259
         AH    @14,STCTLCCK(,J)                                 02S0259
         STH   @14,STCTLCCK(,J)                                 02S0259
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0260
*         END;                      /* END OF SUBCASE                */
*CE0001@:                                                       02S0262
*       END;                        /* END OF CASE                   */
CE0001@  DS    0H                                               02S0263
*/*@Y30LB52                                                          */
*                                                               02S0263
*     END;                          /*                       @Y30LB52*/
*   RETURN CODE(0);                 /* SUCCESSFUL EXIT       @Y30LB52*/
@RC00110 L     @13,4(,@13)                                      01S0264
         L     @00,@SIZDATD                                     01S0264
         LR    @01,@11                                          01S0264
         ISDAFSPC R,LV=(0),A=(1)
         SLR   @15,@15                                          01S0264
         L     @14,12(,@13)                                     01S0264
         LM    @00,@12,20(@13)                                  01S0264
         BR    @14                                              01S0264
*   END ISDAPAD0                    /*                       @Y30LB52*/
*                                                               01S0265
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ISDAPAD5)                                       */
*/*%INCLUDE SYSLIB  (ISDAMCFG)                                       */
*/*%INCLUDE SYSLIB  (ISDAWORK)                                       */
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                       */
*/*%INCLUDE SYSLIB  (ISDAMSC5)                                       */
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                       */
*/*%INCLUDE SYSLIB  (ISDACVT )                                       */
*/*%INCLUDE SYSLIB  (ISDASOBR)                                       */
*/*%INCLUDE SYSUT5  (P0ADDBLK)                                       */
*/*%INCLUDE SYSUT5  (P0ALLOC )                                       */
*/*%INCLUDE SYSUT5  (P0MSCALL)                                       */
*/*%INCLUDE SYSUT5  (P0GETBLK)                                       */
*/*%INCLUDE SYSUT5  (P0GETBLK)                                       */
*/*%INCLUDE SYSUT5  (P0GETBLK)                                       */
*/*%INCLUDE SYSUT5  (P0GETBLK)                                       */
*/*%INCLUDE SYSUT5  (P0FMT4  )                                       */
*/*%INCLUDE SYSUT5  (P0FMT5  )                                       */
*/*%INCLUDE SYSUT5  (P0SSDASD)                                       */
*/*%INCLUDE SYSUT5  (P0CHDASD)                                       */
*                                                               01S0265
*       ;                                                       01S0265
@DATA    DS    0H
@CH00049 DC    H'1'
@CH00076 DC    H'6'
@CH00057 DC    H'8'
@CH00341 DC    H'9'
@CH00087 DC    H'12'
@CH00078 DC    H'96'
@CH00074 DC    H'128'
@CH00096 DC    H'192'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    0F
         DS    1F
@TF00001 DS    F
ISDAPAD0 CSECT
         DS    0F
@CF00356 DC    F'7'
@CF00330 DC    F'2048'
@CF00381 DC    F'-54'
@CF00379 DC    F'-30'
@CF00378 DC    F'-8'
@CF00380 DC    F'-4'
@CF00344 DC    XL4'03'
@DATD    DSECT
         DS    0D
LTPDRDP  DS    A
DCPUCHCU DS    CL6
         ORG   DCPUCHCU
DCPUID   DS    CL5
DCHCU    DS    FL1
         ORG   DCPUCHCU+6
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDAPAD0 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00053 DC    V(ISDAFREE)
@CV00054 DC    V(ISDAGET1)
         DS    0D
@CB00338 DC    X'0000'
         DS    CL2
CP0001@  DC    AL4(DCHK)
         DC    AL4(STCHK)
         DC    AL4(STCCHK)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SATABP   EQU   @04
DRDTBPTR EQU   @05
CHCUPTR  EQU   @05
SPTBPTR  EQU   @06
PWORKPTR EQU   @03
K        EQU   @05
J        EQU   @04
I        EQU   @02
R1       EQU   @01
R15      EQU   @15
LTPDRDTB EQU   0
LTPDRC   EQU   LTPDRDTB
SADRDDSD EQU   0
SADRDACC EQU   SADRDDSD
SADASDAC EQU   SADRDDSD+4
DRDACCTB EQU   0
DRDACCS  EQU   0
DRDERRS  EQU   DRDACCS
CTLIERRS EQU   DRDACCS+2
DRCERRS  EQU   DRDACCS+4
CHCUTAB  EQU   0
CPUIDSER EQU   CHCUTAB
CHCU     EQU   CHCUTAB+5
SPLTABP  EQU   CHCUTAB+8
SPNDLETB EQU   0
SPNDLES  EQU   0
DRVEQCHK EQU   SPNDLES
STCTLCHK EQU   SPNDLES+2
STCTLCCK EQU   SPNDLES+4
P0WORK   EQU   0
PADLASTB EQU   P0WORK+4
COREASG  EQU   P0WORK+8
ENDCORE  EQU   P0WORK+12
MSCDRDAC EQU   P0WORK+16
MSCINTF  EQU   MSCDRDAC
SATABPTR EQU   MSCDRDAC+4
CSFTOTAL EQU   P0WORK+80
MSCTOTAL EQU   P0WORK+88
HTOTAL   EQU   P0WORK+90
P0WORK1  EQU   0
PADFPTR1 EQU   P0WORK1
PCNFG    EQU   0
CNFGFXD  EQU   PCNFG
CHINTFNO EQU   CNFGFXD+12
CHCUAD   EQU   PCNFG+20
CPUSERAD EQU   PCNFG+24
ISDAWORK EQU   0
INFLAGS  EQU   ISDAWORK
INDEVTYP EQU   INFLAGS+2
INRECCUA EQU   ISDAWORK+6
ISDAMSCS EQU   0
SUBSYSID EQU   ISDAMSCS+1
SSID     EQU   SUBSYSID
SSIDTYPE EQU   SSID
FORMATNO EQU   ISDAMSCS+3
SUBSENSE EQU   ISDAMSCS+4
SUBSTAT4 EQU   SUBSENSE
SARETRY  EQU   SUBSENSE+5
SALOWAD2 EQU   SUBSENSE+6
SUBFMTMG EQU   SUBSENSE+7
SUBFMTNO EQU   SUBFMTMG
SANOMSCD EQU   SUBSENSE+27
ISDAMSC5 EQU   0
DRIVEID4 EQU   ISDAMSC5+4
FMTMSG5  EQU   ISDAMSC5+7
DASDSENS EQU   ISDAMSC5+8
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CPAD     EQU   CREPORTS+1
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
DATAPTR  EQU   CVTPTRS0
SDATAPTR EQU   CVTPTRS0+4
PARMPTR  EQU   CVTPTRS0+8
SDA00PTR EQU   CVTPTRS0+12
PAD00PTR EQU   CVTPTRS0+44
CNFG0PTR EQU   CVTPTRS0+88
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
OBRMDR   EQU   0
SCW      EQU   OBRMDR
SWITCHES EQU   OBRMDR+6
DATETIME EQU   OBRMDR+12
DATE     EQU   DATETIME
TIME     EQU   DATETIME+4
CPUSERID EQU   OBRMDR+21
CPUSER   EQU   CPUSERID
CPUID    EQU   CPUSERID+3
CL0001@  EQU   0
CPUSERS  EQU   0
SAINTF   EQU   0
CVTPTR   EQU   0
CSADRDDS EQU   SADRDDSD
CDRDACCT EQU   DRDACCTB
CSPNDLET EQU   SPNDLETB
SENSEPTR EQU   SDATAPTR
LPARMPTR EQU   PARMPTR
LOGPTR   EQU   DATAPTR
P0SSID   EQU   SUBSYSID
P0LIBN   EQU   P0SSID+1
*                                      START UNREFERENCED COMPONENTS
@NM00009 EQU   P0SSID
VERNO    EQU   OBRMDR+20
TENSHUND EQU   TIME+3
SECOND   EQU   TIME+2
MINUTE   EQU   TIME+1
HOUR     EQU   TIME
DAY      EQU   DATE+2
YEAR     EQU   DATE
RECENTRY EQU   OBRMDR+11
RCDCNT   EQU   OBRMDR+10
SWITCH3  EQU   SWITCHES+3
SWITCH2  EQU   SWITCHES+2
SWITCH1  EQU   SWITCHES+1
SWITCH0  EQU   SWITCHES
SYSREL   EQU   OBRMDR+5
CLASRC   EQU   OBRMDR+4
@NM00008 EQU   SCW+3
SCODE    EQU   SCW+2
SLENGTH  EQU   SCW
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
LINE     EQU   OUTLINE+1
ANSI     EQU   OUTLINE
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
GEN00PTR EQU   CVTPTRS0+92
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CDHEDHU  EQU   CREPORTS+3
CSUM     EQU   CREPORTS+2
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00007 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00006 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
BYTE27F5 EQU   DASDSENS+19
REALCYL5 EQU   DASDSENS+17
RUAFMT5  EQU   DASDSENS+16
FSCFMT5  EQU   DASDSENS+14
BYTE21F5 EQU   DASDSENS+13
BYTE20F5 EQU   DASDSENS+12
BYTE19F5 EQU   DASDSENS+11
BYTE18F5 EQU   DASDSENS+10
BYTE17F5 EQU   DASDSENS+9
BYTE16F5 EQU   DASDSENS+8
BYTE15F5 EQU   DASDSENS+7
BYTE14F5 EQU   DASDSENS+6
BYTE13F5 EQU   DASDSENS+5
BYTE12F5 EQU   DASDSENS+4
BYTE11F5 EQU   DASDSENS+3
BYTE10F5 EQU   DASDSENS+2
BYTE9F5  EQU   DASDSENS+1
BYTE8F5  EQU   DASDSENS
MSGCODE5 EQU   FMTMSG5
SUBFMTN5 EQU   FMTMSG5
HIGHCYL5 EQU   ISDAMSC5+6
LOWCYL5  EQU   ISDAMSC5+5
RESTART5 EQU   ISDAMSC5+3
STATUS35 EQU   ISDAMSC5+2
STATUS25 EQU   ISDAMSC5+1
STATUS15 EQU   ISDAMSC5
RCYLMSCD EQU   SUBSENSE+25
RUAMSCD  EQU   SUBSENSE+24
MSCFSC   EQU   SUBSENSE+22
@NM00005 EQU   SUBSENSE+21
RUADASD  EQU   SUBSENSE+20
DASDFSC  EQU   SUBSENSE+18
@NM00004 EQU   SUBSENSE+8
MSGCODEN EQU   SUBFMTMG
@NM00003 EQU   SUBSENSE+4
DASDFMTN EQU   SUBSENSE+3
SALOWADD EQU   SUBSENSE+2
SUBSTAT5 EQU   SUBSENSE+1
SSIDDEVT EQU   SSID+1
SSIDLIBN EQU   SSID+1
SSIDFLAG EQU   SUBSYSID
STATUS   EQU   ISDAMSCS
DEVPTR   EQU   ISDAWORK+16
NOUTREC  EQU   ISDAWORK+12
NINREC   EQU   ISDAWORK+8
CUABYTE1 EQU   INRECCUA+1
CUABYTE0 EQU   INRECCUA
DLENGTH  EQU   ISDAWORK+4
SDAFLAG0 EQU   INFLAGS+3
INSOURCE EQU   INFLAGS+1
IRECTYPE EQU   INFLAGS
SAINTFP  EQU   PCNFG+32
@NM00002 EQU   PCNFG+30
CNFGTOTL EQU   PCNFG+28
LTPAD    EQU   PCNFG+16
PCNFGL   EQU   CNFGFXD+14
LIBSIZS  EQU   CNFGFXD+8
SANO     EQU   CNFGFXD+6
SPINO    EQU   CNFGFXD+4
CPUNO    EQU   CNFGFXD+2
MSFNO    EQU   CNFGFXD
@NM00001 EQU   MSCDRDAC+2
PADFPTR  EQU   P0WORK
INTF     EQU   CHCUTAB+7
SA       EQU   CHCUTAB+6
DRCL1    EQU   LTPDRC+1
DRCL0    EQU   LTPDRC
*                                      END UNREFERENCED COMPONENTS
@RF00085 EQU   @RC00077
@RC00149 EQU   @RC00148
@ENDDATA EQU   *
         END   ISDAPAD0,(C'PLS2115',0701,77354)

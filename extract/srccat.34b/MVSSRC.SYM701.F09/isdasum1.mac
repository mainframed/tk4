         TITLE 'ISDASUM1 - SDA SUMMARY FORMAT AND PRINT ROUTINE        *
                        '
ISDASUM1 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(8)                                              0001
         DC    C'ISDASUM1'                                         0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         ISDAGSPC R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0028
*   /*****************************************************************/
*   /*                                                               */
*   /* ISDASUM1 - OUTPUT FORMAT PROC                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0028
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO ISDACVT    0028
*                                                            @Y30LB55*/
         L     @10,@PC00001                                        0028
         L     CVTPTR,WORKPTR(,@10)                                0028
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO ISDAPRMS   0029
*                                                            @Y30LB55*/
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0029
*   RETCODE=0;                      /* SET RETURN CODE TO ZERO     0030
*                                                            @Y30LB55*/
         SLR   @10,@10                                             0030
         ST    @10,RETCODE                                         0030
*   SUMWKPTR=SUM00PTR;              /* SET LOCAL PTR TO WORKAREA   0031
*                                                            @Y30LB55*/
         L     SUMWKPTR,SUM00PTR(,CVTPTR)                          0031
*   GET0PTR=ACCM0PTR;               /* SET PTR TO ACCUMULATOR 0    0032
*                                                            @Y30LB55*/
         L     @05,ACCM0PTR(,SUMWKPTR)                             0032
         ST    @05,GET0PTR                                         0032
*   IF CSUM(8)='1'B&GET0PTR^=0 THEN /* WAS SUMMARY REPORT REQUESTED
*                                                            @Y30LB55*/
         TM    CSUM(LPARMPTR),B'00000001'                          0033
         BNO   @RF00033                                            0033
         CR    @05,@10                                             0033
         BE    @RF00033                                            0033
*     DO;                           /* YES, PRODUCE REPORT   @Y30LB55*/
*                                                                  0034
*       /*************************************************************/
*       /*                                                           */
*       /* OUTPUT FORMAT CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0035
*       ANSI=PSKIP;                 /* SET PAGE SKIP         @Y30LB55*/
         MVI   ANSI(CVTPTR),C'1'                                   0035
*       LINE=SUMMSG12;              /* MOVE TOP TITLE        @Y30LB55*/
         MVI   LINE+28(CVTPTR),C' '                                0036
         MVC   LINE+29(103,CVTPTR),LINE+28(CVTPTR)                 0036
         MVC   LINE(28,CVTPTR),SUMMSG12                            0036
*       RFY                                                        0037
*         R1 RSTD;                  /*                       @Y30LB55*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0038
*       CALL ISDAPRT0;              /* OUTPUT SUMMSG12       @Y30LB55*/
         L     @15,@CV00333                                        0039
         BALR  @14,@15                                             0039
*       RFY                                                        0040
*         R1 UNRSTD;                /* RELEASE R1            @Y30LB55*/
*       K=CNTSENSE;                 /* SET K = COUNT OF SENSE RECORDS
*                                                            @Y30LB55*/
         L     K,CNTSENSE(,SUMWKPTR)                               0041
*       TOTPERMS=''B;               /* ZERO COUNT            @Y30LB55*/
         SLR   @10,@10                                             0042
         ST    @10,TOTPERMS(,SUMWKPTR)                             0042
*       TOTTEMPS=''B;               /* ZERO COUNT            @Y30LB55*/
         ST    @10,TOTTEMPS(,SUMWKPTR)                             0043
*       FLAGMASK(8)='1'B;           /* SET BUFFERED LOG SWITCH     0044
*                                                            @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000001'                      0044
*       LINE=SUMMSG30;              /* MOVE SUMMSG30         @Y30LB55*/
         MVI   LINE+60(CVTPTR),C' '                                0045
         MVC   LINE+61(71,CVTPTR),LINE+60(CVTPTR)                  0045
         MVC   LINE(60,CVTPTR),SUMMSG30                            0045
*       ANSI=LSKIP2;                /* SET 2 LINE SKIP       @ZM31022*/
         MVI   ANSI(CVTPTR),C'0'                                   0046
*       CALL PUTTITLE;              /* OUTPUT TABLE TITLES   @Y30LB55*/
         BAL   @14,PUTTITLE                                        0047
*       COUNTPTR=ACCUMPTR;          /* SET PTR TO START OF SUMACCUM
*                                                            @Y30LB55*/
         L     COUNTPTR,ACCUMPTR(,SUMWKPTR)                        0048
*       COUNTEND=ACCM0END;          /* SET PTR TO END OF SUMACCUM  0049
*                                                            @Y30LB55*/
         MVC   COUNTEND(4),ACCM0END(SUMWKPTR)                      0049
*       FORMATCK=MCFXXX;            /* SET FORMAT SWITCH FLAG@Y30LB55*/
         MVC   FORMATCK(1,SUMWKPTR),MCFXXX(COUNTPTR)               0050
*       DO WHILE(COUNTPTR<COUNTEND);/* LOOP THROUGH COUNTERS @Y30LB55*/
         B     @DE00051                                            0051
@DL00051 DS    0H                                                  0052
*         DEVIDPTR=MCADDXXX;        /* SET PTR TO ISDASUM2 TABLE   0052
*                                                            @Y30LB55*/
         L     DEVIDPTR,MCADDXXX(,COUNTPTR)                        0052
*         IF MCFLAG(8)='1'B&FLAGMASK(8)='1'B THEN/* AT FIRST BUFFERED
*                                                            @Y30LB55*/
         TM    MCFLAG(COUNTPTR),B'00000001'                        0053
         BNO   @RF00053                                            0053
         TM    FLAGMASK(SUMWKPTR),B'00000001'                      0053
         BNO   @RF00053                                            0053
*           DO;                     /* YES, OUTPUT NEW TITLE @Y30LB55*/
*             CALL PUTTOTAL;        /* PRINT TOTALS          @Y30LB55*/
         BAL   @14,PUTTOTAL                                        0055
*             ANSI=PSKIP;           /* SET PAGE SKIP         @Y30LB55*/
         MVI   ANSI(CVTPTR),C'1'                                   0056
*             LINE=SUMMSG12;        /* MOVE SUMMSG12         @Y30LB55*/
         MVI   LINE+28(CVTPTR),C' '                                0057
         MVC   LINE+29(103,CVTPTR),LINE+28(CVTPTR)                 0057
         MVC   LINE(28,CVTPTR),SUMMSG12                            0057
*             RFY                                                  0058
*               R1 RSTD;            /*                       @Y30LB55*/
*             R1=ADDR(WORKCALL);    /* R1 -> WORKPTR         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0059
*             CALL ISDAPRT0;        /* PRINT SUMMSG12        @Y30LB55*/
         L     @15,@CV00333                                        0060
         BALR  @14,@15                                             0060
*             RFY                                                  0061
*               R1 UNRSTD;          /*                       @Y30LB55*/
*             CALL PRINTCPU;        /* PRINT CPU IDS         @Y30LB55*/
         BAL   @14,PRINTCPU                                        0062
*             FLAGMASK(8)='0'B;     /* TURN OFF BUFFERED LOG SWITCH
*                                                            @Y30LB55*/
         NI    FLAGMASK(SUMWKPTR),B'11111110'                      0063
*             LINE=SUMMSG40;        /* MOVE SUMMSG40         @Y30LB55*/
         MVI   LINE+61(CVTPTR),C' '                                0064
         MVC   LINE+62(70,CVTPTR),LINE+61(CVTPTR)                  0064
         MVC   LINE(61,CVTPTR),SUMMSG40                            0064
*             ANSI=LSKIP3;          /* SET 3 LINE SKIP       @Y30LB55*/
         MVI   ANSI(CVTPTR),C'-'                                   0065
*             CALL PUTTITLE;        /* OUTPUT TABLE TITLES   @Y30LB55*/
         BAL   @14,PUTTITLE                                        0066
*             K=CNTLOG;             /* SET K = COUNT OF LOG RECORDS
*                                                            @Y30LB55*/
         L     K,CNTLOG(,SUMWKPTR)                                 0067
*             TOTPERMS=''B;         /* ZERO COUNT            @Y30LB55*/
         SLR   @10,@10                                             0068
         ST    @10,TOTPERMS(,SUMWKPTR)                             0068
*             TOTTEMPS=''B;         /* ZERO COUNT            @Y30LB55*/
         ST    @10,TOTTEMPS(,SUMWKPTR)                             0069
*             FORMATCK=MCFXXX;      /* SET FORMAT SWITCH FLAG@Y30LB55*/
         MVC   FORMATCK(1,SUMWKPTR),MCFXXX(COUNTPTR)               0070
*           END;                    /* END SWITCH TO LOG CODE@Y30LB55*/
*         ELSE                                                     0072
*           ;                       /* NO SWITCH             @Y30LB55*/
@RF00053 DS    0H                                                  0073
*         CALL BUILDIT;             /* BUILD AND PRINT OUTPUT LINE 0073
*                                                            @Y30LB55*/
         BAL   @14,BUILDIT                                         0073
*         COUNTPTR=COUNTPTR+LENGTH(MCOUNTER);/*                    0074
*                                      INC PTR TO NEXT ENTRY @Y30LB55*/
         AH    COUNTPTR,@CH00335                                   0074
*       END;                        /* END OF FORMAT OUTPUT CODE   0075
*                                                            @Y30LB55*/
@DE00051 C     COUNTPTR,COUNTEND                                   0075
         BL    @DL00051                                            0075
*       CALL PUTTOTAL;              /* PRINT TOTALS          @Y30LB55*/
         BAL   @14,PUTTOTAL                                        0076
*       CALL RCODESUM;              /* PRINT THE MSC REASON CODE   0077
*                                      SUMMARY               @ZM31074*/
         BAL   @14,RCODESUM                                        0077
*     END;                          /* END FORMATOR CODE     @Y30LB55*/
*   ELSE                            /* SUMMARY REPORT NOT REQUESTED
*                                                            @Y30LB55*/
*     RETCODE=0;                    /* SET NO REPORT RETCODE @Y30LB55*/
         B     @RC00033                                            0079
@RF00033 SLR   @10,@10                                             0079
         ST    @10,RETCODE                                         0079
*                                                                  0080
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEANUP SECTION - FREE SUMACCUM                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0080
*   IF GET0PTR^=0 THEN              /* WAS CORE FOR ACCUMULATOR GOT
*                                                            @Y30LB55*/
@RC00033 SLR   @10,@10                                             0080
         C     @10,GET0PTR                                         0080
         BE    @RF00080                                            0080
*     DO;                           /* YES, FREE SUMACCUM    @Y30LB55*/
*       IF RCODEPTR^=0 THEN         /* HAVE RCODES TABLE     @ZM31074*/
         L     @15,RCODEPTR(,SUMWKPTR)                             0082
         CR    @15,@10                                             0082
         BE    @RF00082                                            0082
*         DO;                       /* YES, FREE IT          @ZM31074*/
*           CORELEN=RCODELEN;       /* GET LENGTH            @ZM31074*/
         MVC   CORELEN(3,CVTPTR),@CF00280+1                        0084
*           SPNO=SUMSPNO;           /* GET SUBPOOL           @ZM31074*/
         MVC   SPNO(1,CVTPTR),SUMSPNO                              0085
*           COREADDR=RCODEPTR;      /* GET ADDRESS           @ZM31074*/
         ST    @15,COREADDR(,CVTPTR)                               0086
*           RFY R1 RSTD;                                           0087
*           R1=ADDR(WORKCALL);      /* R1 -> WORKPTR         @ZM31074*/
         LA    R1,WORKCALL(,CVTPTR)                                0088
*           CALL ISDAFREE;          /* FREEMAIN              @ZM31074*/
         L     @15,@CV00331                                        0089
         BALR  @14,@15                                             0089
*           RFY R1 UNRSTD;                                         0090
*         END;                      /* END FREE OF RCODES    @ZM31074*/
*       ELSE;                       /* NO TABLE TO FREE      @ZM31074*/
@RF00082 DS    0H                                                  0093
*       SPNOLEN=GET0SPLN;           /* SET SUBPOOL AND LENGTH@Y30LB55*/
         L     @10,GET0PTR                                         0093
         MVC   SPNOLEN(4,CVTPTR),GET0SPLN(@10)                     0093
*       COREADDR=GET0PTR;           /* SET ADDRESS TO FREE   @Y30LB55*/
         ST    @10,COREADDR(,CVTPTR)                               0094
*       RFY                                                        0095
*         R1 RSTD;                  /*                       @Y30LB55*/
*       R1=ADDR(WORKCALL);          /* R1 -> ADDR(WORKPTR)   @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0096
*       CALL ISDAFREE;              /* FREE ACCUMULATOR      @Y30LB55*/
         L     @15,@CV00331                                        0097
         BALR  @14,@15                                             0097
*       RFY                                                        0098
*         R1 UNRSTD;                /*                       @Y30LB55*/
*     END;                          /* END FREE OF SUMACCUM  @Y30LB55*/
*   ELSE                                                           0100
*     ;                             /* NO ACCUMULATOR TO FREE@Y30LB55*/
*                                                                  0100
@RF00080 DS    0H                                                  0101
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE SUMWORK                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0101
*   CORELEN=LENGTH(SUMWORK);        /* LENGTH OF WORKAREA    @Y30LB55*/
         MVC   CORELEN(3,CVTPTR),@CF00523+1                        0101
*   SPNO=SUMSPNO;                   /* SET SUBPOOL NUMBER    @Y30LB55*/
         MVC   SPNO(1,CVTPTR),SUMSPNO                              0102
*   COREADDR=SUM00PTR;              /* ADDR OF WORKAREA      @Y30LB55*/
         MVC   COREADDR(4,CVTPTR),SUM00PTR(CVTPTR)                 0103
*   RFY                                                            0104
*     R1 RSTD;                      /*                       @Y30LB55*/
*   R1=ADDR(WORKCALL);              /* R1 -> ADDR(WORKPTR)   @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0105
*   CALL ISDAFREE;                  /* FREE SUMWORK          @Y30LB55*/
         L     @15,@CV00331                                        0106
         BALR  @14,@15                                             0106
*   RFY                                                            0107
*     R1 UNRSTD;                    /* END FREEMAIN          @Y30LB55*/
*   SUM00PTR=0;                     /* SET MY CVT PTR TO ZERO@Y30LB55*/
         SLR   @10,@10                                             0108
         ST    @10,SUM00PTR(,CVTPTR)                               0108
*   RETURN CODE(RETCODE);           /* RETURN TO ISDASDA0    @Y30LB55*/
         L     @10,RETCODE                                         0109
         L     @13,4(,@13)                                         0109
         L     @00,@SIZDATD                                        0109
         LR    @01,@11                                             0109
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@10                                             0109
         L     @14,12(,@13)                                        0109
         LM    @00,@12,20(@13)                                     0109
         BR    @14                                                 0109
*                                                                  0110
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINTCPU - PROC TO PRINT CPUIDS USED FOR THIS RUN             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0110
*PRINTCPU:                                                         0110
*   PROC OPTIONS(SAVE(14));         /* PRINT CPUIDS PROC     @Y30LB55*/
@EL00001 L     @13,4(,@13)                                         0110
@EF00001 L     @00,@SIZDATD                                        0110
         LR    @01,@11                                             0110
         ISDAFSPC R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0110
         BR    @14                                                 0110
PRINTCPU ST    @14,@SA00002                                        0110
*   ANSI=LSKIP3;                    /* SET 3 LINE SKIP       @Y30LB55*/
         MVI   ANSI(CVTPTR),C'-'                                   0111
*   LINE=SUMMSG20;                  /* MOVE SUMMSG20         @Y30LB55*/
         MVI   LINE+35(CVTPTR),C' '                                0112
         MVC   LINE+36(96,CVTPTR),LINE+35(CVTPTR)                  0112
         MVC   LINE(35,CVTPTR),SUMMSG20                            0112
*   IF SUMFLAGS(8)='1'B THEN        /* IS OVERFLOW BIT ON    @Y30LB55*/
         TM    SUMFLAGS(SUMWKPTR),B'00000001'                      0113
         BNO   @RF00113                                            0113
*     MSG21ID=SUMMSG21;             /* YES, MOVE SUMMSG21    @Y30LB55*/
         MVC   MSG21ID(42,CVTPTR),SUMMSG21                         0114
*   ELSE                                                           0115
*     ;                             /* NO, OK                @Y30LB55*/
@RF00113 DS    0H                                                  0116
*   CPUXXCNT=NCPUUSED;              /* SET CPUID COUNT       @Y30LB55*/
         SLR   CPUXXCNT,CPUXXCNT                                   0116
         ICM   CPUXXCNT,3,NCPUUSED(SUMWKPTR)                       0116
*   CPUIDPTR=ADDR(CPUFOUND(1));     /* SET PTR TO CPUID TABLE@Y30LB55*/
         LA    @10,CPUFOUND(,SUMWKPTR)                             0117
         ST    @10,CPUIDPTR                                        0117
*   CALL PRTCPU00;                  /* PRINT CPUID TABLE     @Y30LB55*/
         BAL   @14,PRTCPU00                                        0118
*   IF CNFG0PTR^=0 THEN             /* CONFIGURATION TABLE BUILT   0119
*                                                            @Y30LB55*/
         SLR   @10,@10                                             0119
         L     @09,CNFG0PTR(,CVTPTR)                               0119
         CR    @09,@10                                             0119
         BE    @RF00119                                            0119
*     DO;                           /* YES, PRINT VALID CPUIDS     0120
*                                                            @Y30LB55*/
*       CPUXXCNT=CPUNO;             /* SET CPUID COUNT       @Y30LB55*/
         L     @15,CNFG0PTR(,CVTPTR)                               0121
         LH    CPUXXCNT,CPUNO(,@15)                                0121
*       CPUIDPTR=CPUSERAD;          /* SET PTR TO CPUID TABLE@Y30LB55*/
*                                                                  0122
         MVC   CPUIDPTR(4),CPUSERAD(@15)                           0122
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE CPUFOUND LIST WITH CONFIG TABLE TO SEE IF ANY     */
*       /* RECORDS USED ARE FOR CPUS NOT IN THE STORAGE SYSTEM       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0123
*       J=0;                        /* INIT FOUND FLAG       @Y30LB55*/
         LR    J,@10                                               0123
*       DO I=1 TO NCPUUSED WHILE(J=0);/* LOOP THROUGH CPUIDS @Y30LB55*/
         LA    I,1                                                 0124
         B     @DE00124                                            0124
@DL00124 LTR   J,J                                                 0124
         BNZ   @DC00124                                            0124
*         DO K=1 TO CPUXXCNT WHILE(J=0);/* LOOP THROUGH CONFIG     0125
*                                                            @Y30LB55*/
         LA    K,1                                                 0125
         B     @DE00125                                            0125
@DL00125 LTR   J,J                                                 0125
         BNZ   @DC00125                                            0125
*           IF CPUFOUND(I)=CPUXXIDS(K) THEN/* FOUND MATCH    @Y30LB55*/
         LA    @10,5                                               0126
         LR    @01,I                                               0126
         MR    @00,@10                                             0126
         LR    @15,@10                                             0126
         MR    @14,K                                               0126
         ALR   @01,SUMWKPTR                                        0126
         L     @10,CPUIDPTR                                        0126
         ALR   @10,@15                                             0126
         AL    @10,@CF00526                                        0126
         CLC   CPUFOUND-5(5,@01),CPUXXIDS(@10)                     0126
         BNE   @RF00126                                            0126
*             J=1;                  /* SET FOUND FLAG        @Y30LB55*/
         LA    J,1                                                 0127
*           ELSE                                                   0128
*             ;                     /* NOT FOUND YET         @Y30LB55*/
@RF00126 DS    0H                                                  0129
*         END;                      /* END CHECK FOR CPU(I)  @Y30LB55*/
         AH    K,@CH00082                                          0129
@DE00125 CR    K,CPUXXCNT                                          0129
         BNH   @DL00125                                            0129
@DC00125 DS    0H                                                  0130
*         IF J=0 THEN               /* NOT FOUND             @Y30LB55*/
         LTR   J,J                                                 0130
         BNZ   @RF00130                                            0130
*           J=1;                    /* SET FLAG AND GET OUT  @Y30LB55*/
         LA    J,1                                                 0131
*         ELSE                      /* CPUID FOUND IN CONFIG TABLE 0132
*                                                            @Y30LB55*/
*           J=0;                    /* RESET FOUND FLAG AND CHECK  0132
*                                      NEXT ONE              @Y30LB55*/
         B     @RC00130                                            0132
@RF00130 SLR   J,J                                                 0132
*       END;                        /* END ALL CHECKS        @Y30LB55*/
@RC00130 AH    I,@CH00082                                          0133
@DE00124 SLR   @10,@10                                             0133
         ICM   @10,3,NCPUUSED(SUMWKPTR)                            0133
         CR    I,@10                                               0133
         BNH   @DL00124                                            0133
@DC00124 DS    0H                                                  0134
*       IF J^=0 THEN                /* ONE CPUID NOT FOUND   @Y30LB55*/
         LTR   J,J                                                 0134
         BZ    @RF00134                                            0134
*         DO;                       /* ISSUE WARNING MESSAGE @Y30LB55*/
*           ANSI=LSKIP2;            /* SET 2 LINE SKIP       @Y30LB55*/
         MVI   ANSI(CVTPTR),C'0'                                   0136
*           LINE=ISDA1001;          /* MOVE ISDA1001         @Y30LB55*/
         MVI   LINE+83(CVTPTR),C' '                                0137
         MVC   LINE+84(48,CVTPTR),LINE+83(CVTPTR)                  0137
         MVC   LINE(83,CVTPTR),ISDA1001                            0137
*           RFY                                                    0138
*             R1 RSTD;                                     /*@Y30LB55*/
*           R1=ADDR(WORKCALL);      /* R1 -> WORKPTR         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0139
*           CALL ISDAPRT0;          /* PRINT ISDA1001        @Y30LB55*/
         L     @15,@CV00333                                        0140
         BALR  @14,@15                                             0140
*           RFY                                                    0141
*             R1 UNRSTD;            /* RELEASE R1            @Y30LB55*/
*         END;                      /* END PRINT WARNING     @Y30LB55*/
*       ELSE                                                       0143
*         ;                         /* OK, ALL CPUIDS FOUND IN CONFIG
*                                      TABLE                 @Y30LB55*/
@RF00134 DS    0H                                                  0144
*       ANSI=LSKIP2;                /* SET 2 LINE SKIP       @Y30LB55*/
         MVI   ANSI(CVTPTR),C'0'                                   0144
*       LINE=SUMMSG22;              /* MOVE SUMMSG22         @Y30LB55*/
         MVI   LINE+42(CVTPTR),C' '                                0145
         MVC   LINE+43(89,CVTPTR),LINE+42(CVTPTR)                  0145
         MVC   LINE(42,CVTPTR),SUMMSG22                            0145
*       CALL PRTCPU00;              /* PRINT CPUID TABLE     @Y30LB55*/
         BAL   @14,PRTCPU00                                        0146
*     END;                          /* END CONFIGURATION TABLE PRINT
*                                                            @Y30LB55*/
*   ELSE                            /* NO CONFIGURATION TABLE@Y30LB55*/
*     DO;                           /* PRINT CONFIG NOTE     @Y30LB55*/
         B     @RC00119                                            0148
@RF00119 DS    0H                                                  0149
*       ANSI=LSKIP2;                /* SET 2 LINE SKIP       @Y30LB55*/
         MVI   ANSI(CVTPTR),C'0'                                   0149
*       LINE=SUMMSG23;              /* MOVE SUMMSG23         @Y30LB55*/
         MVI   LINE+72(CVTPTR),C' '                                0150
         MVC   LINE+73(59,CVTPTR),LINE+72(CVTPTR)                  0150
         MVC   LINE(72,CVTPTR),SUMMSG23                            0150
*       RFY R1 RSTD;                /*                       @Y30LB55*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPRT         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0152
*       CALL ISDAPRT0;              /* PRINT SUMMSG23        @Y30LB55*/
         L     @15,@CV00333                                        0153
         BALR  @14,@15                                             0153
*       RFY R1 UNRSTD;              /*                       @Y30LB55*/
*     END;                          /* END NO CONFIG CODE    @Y30LB55*/
*                                                                  0156
*   /*****************************************************************/
*   /*                                                               */
*   /* PRTCPU00 - INNER PROC TO PRINT CPUIDS USED FOR THIS RUN       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0156
*PRTCPU00:                                                         0156
*   PROC OPTIONS(SAVE(14));         /* INNER PROC TO OUTPUT CPUIDS 0156
*                                                            @Y30LB55*/
         B     @PB00003                                            0156
PRTCPU00 ST    @14,@SA00003                                        0156
*   RFY                                                            0157
*     R1 RSTD;                      /*                       @Y30LB55*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0158
*   CALL ISDAPRT0;                  /* OUTPUT MESSAGE        @Y30LB55*/
         L     @15,@CV00333                                        0159
         BALR  @14,@15                                             0159
*   RFY                                                            0160
*     R1 UNRSTD;                    /*                       @Y30LB55*/
*   LINE='';                        /* BLANK LINE            @Y30LB55*/
         MVI   LINE(CVTPTR),C' '                                   0161
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0161
*   ANSI=LSKIP1;                    /* 1 LINE SKIP           @Y30LB55*/
         MVI   ANSI(CVTPTR),C' '                                   0162
*   J=1;                            /* INIT CHARACTER POINTER@Y30LB55*/
         LA    @10,1                                               0163
         LR    J,@10                                               0163
*   DO I=1 TO CPUXXCNT;             /* LOOP THROUGH CPUFOUND @Y30LB55*/
         LR    I,@10                                               0164
         B     @DE00164                                            0164
@DL00164 DS    0H                                                  0165
*     TEMP5=CPUXXIDS(I);            /* MOVE TO TEMP          @Y30LB55*/
         LR    @10,I                                               0165
         MH    @10,@CH00182                                        0165
         L     @07,CPUIDPTR                                        0165
         ALR   @07,@10                                             0165
         AL    @07,@CF00526                                        0165
         MVC   TEMP5(5,SUMWKPTR),CPUXXIDS(@07)                     0165
*     UNPK(TEMP20(1:13),TEMP7);     /* UNPACK                @Y30LB55*/
         UNPK  TEMP20(13,SUMWKPTR),TEMP7(7,SUMWKPTR)               0166
*     DO K=1 TO 10;                 /* FIX HEX               @Y30LB55*/
         LA    K,1                                                 0167
@DL00167 DS    0H                                                  0168
*       IF TEMP20(K)>'9' THEN       /* A-F                   @Y30LB55*/
         LR    @10,SUMWKPTR                                        0168
         ALR   @10,K                                               0168
         CLI   TEMP20-1(@10),C'9'                                  0168
         BNH   @RF00168                                            0168
*         TEMP20(K)=TEMP20(K)-'39'X;/* YES, FIX IT           @Y30LB55*/
         SLR   @10,@10                                             0169
         IC    @10,TEMP20-1(K,SUMWKPTR)                            0169
         SH    @10,@CH00505                                        0169
         STC   @10,TEMP20-1(K,SUMWKPTR)                            0169
*       ELSE                                                       0170
*         ;                         /* NO, OK                @Y30LB55*/
@RF00168 DS    0H                                                  0171
*     END;                          /* END FIX               @Y30LB55*/
         AH    K,@CH00082                                          0171
         CH    K,@CH00503                                          0171
         BNH   @DL00167                                            0171
*     LINE(J:J+5)=TEMP16;           /* MOVE CPU USER         @Y30LB55*/
         LR    @10,CVTPTR                                          0172
         ALR   @10,J                                               0172
         MVC   LINE-1(6,@10),TEMP16(SUMWKPTR)                      0172
*     LINE(J+6)='-';                /* SET -                 @Y30LB55*/
         LR    @10,CVTPTR                                          0173
         ALR   @10,J                                               0173
         MVI   LINE+5(@10),C'-'                                    0173
*     LINE(J+7:J+10)=TEMP710;       /* MOVE CPU ID           @Y30LB55*/
         LR    @10,CVTPTR                                          0174
         ALR   @10,J                                               0174
         MVC   LINE+6(4,@10),TEMP710(SUMWKPTR)                     0174
*     J=J+13;                       /* INC TO NEXT FIELD     @Y30LB55*/
         AH    J,@CH00431                                          0175
*     IF I=CPUXXCNT×J>NCPUCHAR THEN /* LINE FULL             @Y30LB55*/
         CR    I,CPUXXCNT                                          0176
         BE    @RT00176                                            0176
         CH    J,@CH00307                                          0176
         BNH   @RF00176                                            0176
@RT00176 DS    0H                                                  0177
*       DO;                         /* YES, PRINT LINE       @Y30LB55*/
*         RFY                                                      0178
*           R1 RSTD;                /*                       @Y30LB55*/
*         R1=ADDR(WORKCALL);        /* R1 -> WORKPTR         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0179
*         CALL ISDAPRT0;            /* OUTPUT CPUID LINE     @Y30LB55*/
         L     @15,@CV00333                                        0180
         BALR  @14,@15                                             0180
*         RFY                                                      0181
*           R1 UNRSTD;              /*                       @Y30LB55*/
*         J=1;                      /* RESET LINE INDEX      @Y30LB55*/
         LA    J,1                                                 0182
*         LINE='';                  /* BLANK LINE            @Y30LB55*/
         MVI   LINE(CVTPTR),C' '                                   0183
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0183
*       END;                        /* END PRINT LINE        @Y30LB55*/
*     ELSE                                                         0185
*       ;                           /* NO, GET NEXT CPUID    @Y30LB55*/
@RF00176 DS    0H                                                  0186
*   END;                            /* END MOVE CPUID LOOP   @Y30LB55*/
         AH    I,@CH00082                                          0186
@DE00164 CR    I,CPUXXCNT                                          0186
         BNH   @DL00164                                            0186
*   END PRTCPU00;                   /* END INNER PROC        @Y30LB55*/
@EL00003 DS    0H                                                  0187
@EF00003 DS    0H                                                  0187
@ER00003 L     @14,@SA00003                                        0187
         BR    @14                                                 0187
*   END PRINTCPU;                   /* END OF PRINT CPUIDS PROC    0188
*                                                            @Y30LB55*/
@EL00002 DS    0H                                                  0188
@EF00002 DS    0H                                                  0188
@ER00002 L     @14,@SA00002                                        0188
         BR    @14                                                 0188
*                                                                  0189
*   /*****************************************************************/
*   /*                                                               */
*   /* PUTTITLE - PROC TO PUTOUT TABLE TITLES                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0189
*PUTTITLE:                                                         0189
*   PROC;                           /* OUTPUT TITLES         @Y30LB55*/
PUTTITLE STM   @14,@12,@SA00004                                    0189
*   RFY                                                            0190
*     R1 RSTD;                      /*                       @Y30LB55*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0191
*   CALL ISDAPRT0;                  /* OUTPUT FIRST LINE     @Y30LB55*/
         L     @15,@CV00333                                        0192
         BALR  @14,@15                                             0192
*   LINE=SUMMSG31;                  /* MOVE NEXT LINE        @Y30LB55*/
         MVI   LINE+86(CVTPTR),C' '                                0193
         MVC   LINE+87(45,CVTPTR),LINE+86(CVTPTR)                  0193
         MVC   LINE(86,CVTPTR),SUMMSG31                            0193
*   ANSI=LSKIP2;                    /* 2 LINE SKIP           @Y30LB55*/
         MVI   ANSI(CVTPTR),C'0'                                   0194
*   CALL ISDAPRT0;                  /* OUTPUT 2ND LINE       @Y30LB55*/
         L     @15,@CV00333                                        0195
         BALR  @14,@15                                             0195
*   ANSI=LSKIP1;                    /* SET 1 LINE SKIP       @Y30LB55*/
         MVI   ANSI(CVTPTR),C' '                                   0196
*   LINE=SUMMSG32;                  /* MOVE 3RD LINE         @Y30LB55*/
         MVI   LINE+86(CVTPTR),C' '                                0197
         MVC   LINE+87(45,CVTPTR),LINE+86(CVTPTR)                  0197
         MVC   LINE(86,CVTPTR),SUMMSG32                            0197
*   IF FLAGMASK(8)='0'B THEN        /* BUFFERED LOG          @Y30LB55*/
         TM    FLAGMASK(SUMWKPTR),B'00000001'                      0198
         BNZ   @RF00198                                            0198
*     DO;                           /* YES, CHANGE SUMMSG32  @Y30LB55*/
*       MSG32PC=M32OBR;             /* CHANGE TEMP TO OBR    @Y30LB55*/
         MVC   MSG32PC(4,CVTPTR),@CC00309                          0200
*       MSG32TC=M32MDR;             /* CHANGE PERM TO MDR    @Y30LB55*/
         MVC   MSG32TC(4,CVTPTR),@CC00311                          0201
*     END;                          /* END LOG CHANGE        @Y30LB55*/
*   ELSE                                                           0203
*     ;                             /* SUMMSG32 OK           @Y30LB55*/
@RF00198 DS    0H                                                  0204
*   CALL ISDAPRT0;                  /* OUTPUT 3RD LINE       @Y30LB55*/
         L     @15,@CV00333                                        0204
         BALR  @14,@15                                             0204
*   LINE=SUMMSG33;                  /* MOVE 4TH LINE         @Y30LB55*/
         MVI   LINE+87(CVTPTR),C' '                                0205
         MVC   LINE+88(44,CVTPTR),LINE+87(CVTPTR)                  0205
         MVC   LINE(87,CVTPTR),SUMMSG33                            0205
*   CALL ISDAPRT0;                  /* OUTPUT 4TH LINE       @Y30LB55*/
         L     @15,@CV00333                                        0206
         BALR  @14,@15                                             0206
*   RFY                                                            0207
*     R1 UNRSTD;                    /* RELEASE REG 1         @Y30LB55*/
*   END PUTTITLE;                   /* END PUT TITLE PROC    @Y30LB55*/
@EL00004 DS    0H                                                  0208
@EF00004 DS    0H                                                  0208
@ER00004 LM    @14,@12,@SA00004                                    0208
         BR    @14                                                 0208
*                                                                  0209
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILDIT - PROC TO BUILD AND PRINT TABLE OUTPUT                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0209
*BUILDIT:                                                          0209
*   PROC;                           /* BUILD AND PRINT TABLE OUTPUT
*                                                            @Y30LB55*/
BUILDIT  STM   @14,@12,@SA00005                                    0209
*   LINE='';                        /* BLANK LINE            @Y30LB55*/
         MVI   LINE(CVTPTR),C' '                                   0210
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0210
*   OUTFMT=MDCFXXX;                 /* MOVE FORMAT ID        @Y30LB55*/
         MVC   OUTFMT(4,CVTPTR),MDCFXXX(DEVIDPTR)                  0211
*   IF MDFXXX(1)='1'B THEN          /* FORMAT 0              @ZM30976*/
         TM    MDFXXX(DEVIDPTR),B'10000000'                        0212
         BNO   @RF00212                                            0212
*     OUTMSGCD=MDCSMXXX;            /* YES, MOVE MSG CODE    @ZM30976*/
         MVC   OUTMSGCD(2,CVTPTR),MDCSMXXX(DEVIDPTR)               0213
*   ELSE                            /* NOT FORMAT 0          @ZM30976*/
*     DO;                           /* MOVE SA FORMAT/MSG    @ZM31022*/
         B     @RC00212                                            0214
@RF00212 DS    0H                                                  0215
*       OUTSAFMT=MDCSXXX;           /* MOVE SA FORMAT ID     @ZM30976*/
         MVC   OUTSAFMT(1,CVTPTR),MDCSXXX(DEVIDPTR)                0215
*       IF MDCMXXX^=' ' THEN        /* IS MSG CODE BLANK     @ZM31022*/
         CLI   MDCMXXX(DEVIDPTR),C' '                              0216
         BE    @RF00216                                            0216
*         OUT9CDE=MSG9CDE;          /* NO, MOVE SPECIAL MESSAGE CODE
*                                      FOR 9C,9D,9E          @ZM31022*/
         MVC   OUT9CDE(3,CVTPTR),@CC00313                          0217
*       ELSE;                       /* MSG CODE IS BLANK     @ZM31022*/
@RF00216 DS    0H                                                  0219
*     END;                          /* END MOVE FMT/MSG      @ZM31022*/
*   OUTDEVID=MDIDXXX;               /* MOVE DEVICE ID        @Y30LB55*/
@RC00212 MVC   OUTDEVID(5,CVTPTR),MDIDXXX(DEVIDPTR)                0220
*   OUTMSGID=MDMSGXXX;              /* MOVE FORMAT MESSAGE   @Y30LB55*/
         MVC   OUTMSGID(34,CVTPTR),MDMSGXXX(DEVIDPTR)              0221
*   I=MCPXXX+MCTXXX;                /* TOTAL COUNT           @Y30LB55*/
         SLR   I,I                                                 0222
         ICM   I,3,MCPXXX(COUNTPTR)                                0222
         SLR   @10,@10                                             0222
         ICM   @10,3,MCTXXX(COUNTPTR)                              0222
         ALR   I,@10                                               0222
*   CVD(I,TEMP8);                   /* CONVERT TOTAL         @Y30LB55*/
         CVD   I,TEMP8(,SUMWKPTR)                                  0223
*   OUTTOTAL=EDPAT02;               /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   OUTTOTAL(6,CVTPTR),EDPAT02                          0224
*   ED(OUTTOTAL,TEMP68);            /* EDIT TOTAL COUNT      @Y30LB55*/
         ED    OUTTOTAL(6,CVTPTR),TEMP68(SUMWKPTR)                 0225
*   IF I>0 THEN                     /* ANY COUNTS FOR THIS FORMAT  0226
*                                                            @Y30LB55*/
         LTR   I,I                                                 0226
         BNP   @RF00226                                            0226
*     DO;                           /* YES, FILL IN DATES AND PERCENT
*                                                            @Y30LB55*/
*       TEMP2230=''B;               /* ZERO TEMP AREA        @Y30LB55*/
         XC    TEMP2230(9,SUMWKPTR),TEMP2230(SUMWKPTR)             0228
*       TEMP2326=MLTIME;            /* MOVE LOW TIME         @Y30LB55*/
         MVC   TEMP2326(4,SUMWKPTR),MLTIME(COUNTPTR)               0229
*       TEMP2730=MLDATE;            /* MOVE LOW DATE         @Y30LB55*/
         MVC   TEMP2730(4,SUMWKPTR),MLDATE(COUNTPTR)               0230
*       EDREC01=EDPAT01;            /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   EDREC01(21,SUMWKPTR),EDPAT01                        0231
*       ED(EDREC01,TEMP2230);       /* EDIT LOW DATE+TIME    @Y30LB55*/
         ED    EDREC01(21,SUMWKPTR),TEMP2230(SUMWKPTR)             0232
*       OUTLDAY=ED01DAY;            /* MOVE EDITED LOW DAY   @Y30LB55*/
         MVC   OUTLDAY(3,CVTPTR),ED01DAY(SUMWKPTR)                 0233
*       OUTLYEAR=ED01YEAR;          /* MOVE EDITED LOW YEAR  @Y30LB55*/
         MVC   OUTLYEAR(3,CVTPTR),ED01YEAR(SUMWKPTR)               0234
*       OUTLTIME=ED01TIME;          /* MOVE EDITED LOW TIME  @Y30LB55*/
         MVC   OUTLTIME(8,CVTPTR),ED01TIME(SUMWKPTR)               0235
*       TEMP2326=MHTIME;            /* MOVE HIGH TIME        @Y30LB55*/
         MVC   TEMP2326(4,SUMWKPTR),MHTIME(COUNTPTR)               0236
*       TEMP2730=MHDATE;            /* MOVE HIGH DATE        @Y30LB55*/
         MVC   TEMP2730(4,SUMWKPTR),MHDATE(COUNTPTR)               0237
*       EDREC01=EDPAT01;            /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   EDREC01(21,SUMWKPTR),EDPAT01                        0238
*       ED(EDREC01,TEMP2230);       /* EDIT LOW DATE+TIME    @Y30LB55*/
         ED    EDREC01(21,SUMWKPTR),TEMP2230(SUMWKPTR)             0239
*       OUTHDAY=ED01DAY;            /* MOVE EDITED HIGH DAY  @Y30LB55*/
         MVC   OUTHDAY(3,CVTPTR),ED01DAY(SUMWKPTR)                 0240
*       OUTHYEAR=ED01YEAR;          /* MOVE EDITED HIGH YEAR @Y30LB55*/
         MVC   OUTHYEAR(3,CVTPTR),ED01YEAR(SUMWKPTR)               0241
*       OUTHTIME=ED01TIME;          /* MOVE EDITED HIGH TIME @Y30LB55*/
         MVC   OUTHTIME(8,CVTPTR),ED01TIME(SUMWKPTR)               0242
*       J=(I*1000)/K;               /* TOTAL*1000/TOTAL RECORD COUNT
*                                                            @Y30LB55*/
         LR    @01,I                                               0243
         M     @00,@CF00514                                        0243
         DR    @00,K                                               0243
         LR    J,@01                                               0243
*       CVD(J,TEMP8);               /* CONVERT PERCENT       @Y30LB55*/
         CVD   J,TEMP8(,SUMWKPTR)                                  0244
*       OUTPERC=EDPAT03;            /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   OUTPERC(7,CVTPTR),EDPAT03                           0245
*       ED(OUTPERC,TEMP68);         /* EDIT PERCENT          @Y30LB55*/
         ED    OUTPERC(7,CVTPTR),TEMP68(SUMWKPTR)                  0246
*     END;                          /* END PERCENT CODE      @Y30LB55*/
*   ELSE                                                           0248
*     ;                             /* NO, LEAVE PERCENT BLANK     0248
*                                                            @Y30LB55*/
@RF00226 DS    0H                                                  0249
*   CVD(MCPXXX,TEMP8);              /* CONVERT COUNT PERMS   @Y30LB55*/
         SLR   @10,@10                                             0249
         ICM   @10,3,MCPXXX(COUNTPTR)                              0249
         CVD   @10,TEMP8(,SUMWKPTR)                                0249
*   OUTPERM=EDPAT02;                /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   OUTPERM(6,CVTPTR),EDPAT02                           0250
*   ED(OUTPERM,TEMP68);             /* EDIT COUNT PERMS      @Y30LB55*/
         ED    OUTPERM(6,CVTPTR),TEMP68(SUMWKPTR)                  0251
*   CVD(MCTXXX,TEMP8);              /* CONVERT COUNT TEMPS   @Y30LB55*/
         SLR   @10,@10                                             0252
         ICM   @10,3,MCTXXX(COUNTPTR)                              0252
         CVD   @10,TEMP8(,SUMWKPTR)                                0252
*   OUTTEMP=EDPAT02;                /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   OUTTEMP(6,CVTPTR),EDPAT02                           0253
*   ED(OUTTEMP,TEMP68);             /* EDIT COUNT TEMPS      @Y30LB55*/
*                                                                  0254
         ED    OUTTEMP(6,CVTPTR),TEMP68(SUMWKPTR)                  0254
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT LINE                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0255
*   IF FORMATCK=MCFXXX THEN         /* NEW FORMAT            @Y30LB55*/
         CLC   FORMATCK(1,SUMWKPTR),MCFXXX(COUNTPTR)               0255
         BNE   @RF00255                                            0255
*     ANSI=LSKIP1;                  /* NO, SET 1 LINE SKIP   @Y30LB55*/
         MVI   ANSI(CVTPTR),C' '                                   0256
*   ELSE                            /* NEW FORMAT            @Y30LB55*/
*     ANSI=LSKIP2;                  /* YES, SET 2 LINE SKIP  @Y30LB55*/
         B     @RC00255                                            0257
@RF00255 MVI   ANSI(CVTPTR),C'0'                                   0257
*   IF MDFXXX(3)='1'B THEN          /* CHECK EXCEPTION FMT 2 @ZM31022*/
@RC00255 TM    MDFXXX(DEVIDPTR),B'00100000'                        0258
         BNO   @RF00258                                            0258
*     ANSI=LSKIP1;                  /* NO SKIP FROM 1 TO 2   @ZM31022*/
         MVI   ANSI(CVTPTR),C' '                                   0259
*   ELSE                            /* CHECK OTHER EXCEPTIONS@ZM31022*/
*     IF MDFLAG(3)='1'B&(MDSMXXX='00'X×MDSMXXX='60'X) THEN /*      0260
*                                    REAL 3330 FORMAT 0 OR 6 @ZM31022*/
         B     @RC00258                                            0260
@RF00258 TM    MDFLAG(DEVIDPTR),B'00100000'                        0260
         BNO   @RF00260                                            0260
         CLI   MDSMXXX(DEVIDPTR),X'00'                             0260
         BE    @RT00260                                            0260
         CLI   MDSMXXX(DEVIDPTR),X'60'                             0260
         BNE   @RF00260                                            0260
@RT00260 DS    0H                                                  0261
*       ANSI=LSKIP2;                /* SKIP FROM STAG TO REAL@ZM31022*/
         MVI   ANSI(CVTPTR),C'0'                                   0261
*     ELSE;                         /* NO MORE EXCEPTIONS    @ZM31022*/
@RF00260 DS    0H                                                  0263
*   RFY                                                            0263
*     R1 RSTD;                      /*                       @Y30LB55*/
@RC00258 DS    0H                                                  0264
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0264
*   CALL ISDAPRT0;                  /* OUTPUT TABLE LINE     @Y30LB55*/
         L     @15,@CV00333                                        0265
         BALR  @14,@15                                             0265
*   RFY                                                            0266
*     R1 UNRSTD;                    /* RELEASE REG 1         @Y30LB55*/
*   FORMATCK=MCFXXX;                /* SAVE CURRENT FORMAT   @Y30LB55*/
         MVC   FORMATCK(1,SUMWKPTR),MCFXXX(COUNTPTR)               0267
*   TOTPERMS=TOTPERMS+MCPXXX;       /* INC COUNT OF PERMS    @Y30LB55*/
         SLR   @10,@10                                             0268
         ICM   @10,3,MCPXXX(COUNTPTR)                              0268
         AL    @10,TOTPERMS(,SUMWKPTR)                             0268
         ST    @10,TOTPERMS(,SUMWKPTR)                             0268
*   TOTTEMPS=TOTTEMPS+MCTXXX;       /* INC COUNT OF TEMPS    @Y30LB55*/
         SLR   @10,@10                                             0269
         ICM   @10,3,MCTXXX(COUNTPTR)                              0269
         AL    @10,TOTTEMPS(,SUMWKPTR)                             0269
         ST    @10,TOTTEMPS(,SUMWKPTR)                             0269
*   END BUILDIT;                    /* END PROC              @Y30LB55*/
@EL00005 DS    0H                                                  0270
@EF00005 DS    0H                                                  0270
@ER00005 LM    @14,@12,@SA00005                                    0270
         BR    @14                                                 0270
*                                                                  0271
*   /*****************************************************************/
*   /*                                                               */
*   /* PUTTOTAL - PROC TO PRINT TOTALS                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0271
*PUTTOTAL:                                                         0271
*   PROC;                           /* PROC TO PRINT TOTALS  @Y30LB55*/
PUTTOTAL STM   @14,@12,@SA00006                                    0271
*   ANSI=LSKIP2;                    /* 2 LINE SKIP           @Y30LB55*/
         MVI   ANSI(CVTPTR),C'0'                                   0272
*   LINE='';                        /* BLANK LINE            @Y30LB55*/
         MVI   LINE(CVTPTR),C' '                                   0273
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0273
*   MSG37ID=SUMMSG37;               /* MOVE SUMMSG37         @Y30LB55*/
         MVC   MSG37ID(6,CVTPTR),SUMMSG37                          0274
*   CVD(K,TEMP8);                   /* CONVERT TOTAL COUNT   @Y30LB55*/
         CVD   K,TEMP8(,SUMWKPTR)                                  0275
*   MSG37TOT=EDPAT02;               /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   MSG37TOT(6,CVTPTR),EDPAT02                          0276
*   ED(MSG37TOT,TEMP68);            /* EDIT TOTAL            @Y30LB55*/
         ED    MSG37TOT(6,CVTPTR),TEMP68(SUMWKPTR)                 0277
*   CVD(TOTPERMS,TEMP8);            /* CONVERT TOTAL PERMS   @Y30LB55*/
         L     @10,TOTPERMS(,SUMWKPTR)                             0278
         CVD   @10,TEMP8(,SUMWKPTR)                                0278
*   MSG37OBR=EDPAT02;               /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   MSG37OBR(6,CVTPTR),EDPAT02                          0279
*   ED(MSG37OBR,TEMP68);            /* EDIT COUNT PERMS      @Y30LB55*/
         ED    MSG37OBR(6,CVTPTR),TEMP68(SUMWKPTR)                 0280
*   CVD(TOTTEMPS,TEMP8);            /* CONVERT COUNT TEMPS   @Y30LB55*/
         L     @10,TOTTEMPS(,SUMWKPTR)                             0281
         CVD   @10,TEMP8(,SUMWKPTR)                                0281
*   MSG37MDR=EDPAT02;               /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   MSG37MDR(6,CVTPTR),EDPAT02                          0282
*   ED(MSG37MDR,TEMP68);            /* EDIT COUNT TEMPS      @Y30LB55*/
         ED    MSG37MDR(6,CVTPTR),TEMP68(SUMWKPTR)                 0283
*   RFY                                                            0284
*     R1 RSTD;                      /*                       @Y30LB55*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0285
*   CALL ISDAPRT0;                  /* PRINT SUMMSG37        @Y30LB55*/
         L     @15,@CV00333                                        0286
         BALR  @14,@15                                             0286
*   RFY                                                            0287
*     R1 UNRSTD;                    /* RELEASE REG 1         @Y30LB55*/
*   END PUTTOTAL;                   /* END PRINT TOTALS PROC @Y30LB55*/
@EL00006 DS    0H                                                  0288
@EF00006 DS    0H                                                  0288
@ER00006 LM    @14,@12,@SA00006                                    0288
         BR    @14                                                 0288
*                                                                  0289
*   /*****************************************************************/
*   /*                                                               */
*   /*  RCODESUM - PROC TO PRINT THE COUNTS OF EACH UNIQUE OCCURRENCE*/
*   /*             OF MSC FORMAT 0 MESSAGE CODE 06 REASON CODES FOUND*/
*   /*             IN BYTE 12.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0289
*RCODESUM:                                                         0289
*   PROC OPTIONS(SAVE(14));         /* PROC TO PRINT RCODES  @ZM31074*/
*                                                                  0289
RCODESUM ST    @14,@SA00007                                        0289
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT FIRST 3 LINES                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0290
*   ANSI=LSKIP3;                    /* SET 3 LINE SKIP       @ZM31074*/
         MVI   ANSI(CVTPTR),C'-'                                   0290
*   LINE=SUMMSG50;                  /* MOVE MSG50            @ZM31074*/
         MVI   LINE+36(CVTPTR),C' '                                0291
         MVC   LINE+37(95,CVTPTR),LINE+36(CVTPTR)                  0291
         MVC   LINE(36,CVTPTR),SUMMSG50                            0291
*   MSG53OVL=SUMMSG51;              /* MOVE RIGHT PART       @ZM31074*/
         MVC   MSG53OVL(52,CVTPTR),SUMMSG51                        0292
*   RFY R1 RSTD;                                                   0293
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @ZM31074*/
         LA    R1,WORKCALL(,CVTPTR)                                0294
*   CALL ISDAPRT0;                  /* PRINT IT              @ZM31074*/
         L     @15,@CV00333                                        0295
         BALR  @14,@15                                             0295
*   RFY R1 UNRSTD;                                                 0296
*   IF RCODECNT>0 THEN              /* HAVE CODES TO PRINT   @ZM31074*/
         ICM   @10,15,RCODECNT(SUMWKPTR)                           0297
         BNP   @RF00297                                            0297
*     DO;                           /* YES, PRINT SUMMARY    @ZM31074*/
*       LINE='';                    /* BLANK LINE            @ZM31074*/
         MVI   LINE(CVTPTR),C' '                                   0299
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0299
*       J=1;                        /* SET CODE INDEX        @ZM31074*/
         LA    J,1                                                 0300
*       DO I=3 TO 108 BY 7;         /* LOOP THROUGH LINE     @ZM31074*/
         LA    I,3                                                 0301
@DL00301 DS    0H                                                  0302
*         LINE(I)=BAR;              /* MOVE BAR              @ZM31074*/
         LR    @10,CVTPTR                                          0302
         ALR   @10,I                                               0302
         MVI   LINE-1(@10),C'×'                                    0302
*         LINE(I+4)=CODENUMB(J);    /* MOVE HEX NUMBER       @ZM31074*/
         LR    @10,CVTPTR                                          0303
         ALR   @10,I                                               0303
         LA    @07,CODENUMB-1(J)                                   0303
         MVC   LINE+3(1,@10),0(@07)                                0303
*         J=J+1;                    /* ADD 1 TO J            @ZM31074*/
         AH    J,@CH00082                                          0304
*       END;                        /* END MOVE BAR          @ZM31074*/
         AH    I,@CH00217                                          0305
         CH    I,@CH00522                                          0305
         BNH   @DL00301                                            0305
*       LINE(I)=BAR;                /* MOVE LAST BAR         @ZM31074*/
         LR    @10,CVTPTR                                          0306
         ALR   @10,I                                               0306
         MVI   LINE-1(@10),C'×'                                    0306
*       ANSI=LSKIP2;                /* SET 2 LINE SKIP       @ZM31074*/
         MVI   ANSI(CVTPTR),C'0'                                   0307
*       RFY R1 RSTD;                                               0308
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZM31074*/
         LA    R1,WORKCALL(,CVTPTR)                                0309
*       CALL ISDAPRT0;              /* PRINT LINE 2          @ZM31074*/
         L     @15,@CV00333                                        0310
         BALR  @14,@15                                             0310
*       LINE=DASH;                  /* MOVE DASH             @ZM31074*/
         MVI   LINE+117(CVTPTR),C' '                               0311
         MVC   LINE+118(14,CVTPTR),LINE+117(CVTPTR)                0311
         MVC   LINE(117,CVTPTR),DASH                               0311
*       ANSI=LSKIP1;                /* SET 1 LINE SKIP       @ZM31074*/
         MVI   ANSI(CVTPTR),C' '                                   0312
*       CALL ISDAPRT0;              /* WRITE LINE 3          @ZM31074*/
*                                                                  0313
         L     @15,@CV00333                                        0313
         BALR  @14,@15                                             0313
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT TERMINATION CODE COUNTS IN 16 LINES                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0314
*       DO I=1 TO 16;               /* PRINT 16 LINES        @ZM31074*/
         LA    I,1                                                 0314
@DL00314 DS    0H                                                  0315
*         LINE='';                  /* BLANK LINE            @ZM31074*/
         MVI   LINE(CVTPTR),C' '                                   0315
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0315
*         LINE(1)=CODENUMB(I);      /* MOVE CODE             @ZM31074*/
         LA    @10,CODENUMB-1(I)                                   0316
         MVC   LINE(1,CVTPTR),0(@10)                               0316
*         J=((I-1)*16)+1;           /* COMPUTE RCODES INDEX  @ZM31074*/
         LR    J,I                                                 0317
         BCTR  J,0                                                 0317
         SLA   J,4                                                 0317
         AH    J,@CH00082                                          0317
*         L=3;                      /* SET LINE INDEX        @ZM31074*/
         LA    L,3                                                 0318
*         DO K=J TO J+15;           /* LOOP THROUGH RCODES   @ZM31074*/
         LR    K,J                                                 0319
         B     @DE00319                                            0319
@DL00319 DS    0H                                                  0320
*           IF RCODES(K)>0 THEN     /* NON ZERO COUNT        @ZM31074*/
         LR    @10,K                                               0320
         ALR   @10,@10                                             0320
         L     @15,RCODEPTR(,SUMWKPTR)                             0320
         ALR   @15,@10                                             0320
         AL    @15,@CF00527                                        0320
         SLR   @10,@10                                             0320
         ICM   @10,3,RCODES(@15)                                   0320
         LTR   @10,@10                                             0320
         BNP   @RF00320                                            0320
*             DO;                   /* YES, CONVERT IT       @ZM31074*/
*               CVD(RCODES(K),TEMP8);/* CONVERT TO DEC       @ZM31074*/
         CVD   @10,TEMP8(,SUMWKPTR)                                0322
*               LINE(L:L+5)=EDPAT02;/* MOVE EDIT PATTERN     @ZM31074*/
         LR    @10,CVTPTR                                          0323
         ALR   @10,L                                               0323
         MVC   LINE-1(6,@10),EDPAT02                               0323
*               ED(LINE(L:L+5),TEMP68);/* EDIT COUNT         @ZM31074*/
         LR    @10,CVTPTR                                          0324
         ALR   @10,L                                               0324
         ED    LINE-1(6,@10),TEMP68(SUMWKPTR)                      0324
*             END;                  /* END EDIT CODE         @ZM31074*/
*           ELSE;                   /* BLANK FOR ZERO COUNT  @ZM31074*/
@RF00320 DS    0H                                                  0327
*           LINE(L)=BAR;            /* MOVE BAR              @ZM31074*/
         LR    @10,CVTPTR                                          0327
         ALR   @10,L                                               0327
         MVI   LINE-1(@10),C'×'                                    0327
*           L=L+7;                  /* MOVE LINE POINTER     @ZM31074*/
         AH    L,@CH00217                                          0328
*         END;                      /* END FILL LINE CODE    @ZM31074*/
         AH    K,@CH00082                                          0329
@DE00319 LA    @10,15                                              0329
         ALR   @10,J                                               0329
         CR    K,@10                                               0329
         BNH   @DL00319                                            0329
*         LINE(L)=BAR;              /* LAST BAR              @ZM31074*/
         LR    @10,CVTPTR                                          0330
         ALR   @10,L                                               0330
         MVI   LINE-1(@10),C'×'                                    0330
*         LINE(L+2)=CODENUMB(I);    /* MOVE HEX NUMBER       @ZM31074*/
         LR    @10,CVTPTR                                          0331
         ALR   @10,L                                               0331
         LA    @07,CODENUMB-1(I)                                   0331
         MVC   LINE+1(1,@10),0(@07)                                0331
*         CALL ISDAPRT0;            /* PRINT LINE            @ZM31074*/
         L     @15,@CV00333                                        0332
         BALR  @14,@15                                             0332
*       END;                        /* END LOOP FOR 16 LINES @ZM31074*/
         AH    I,@CH00082                                          0333
         CH    I,@CH00156                                          0333
         BNH   @DL00314                                            0333
*       LINE=DASH;                  /* MOVE DASHS            @ZM31074*/
         MVI   LINE+117(CVTPTR),C' '                               0334
         MVC   LINE+118(14,CVTPTR),LINE+117(CVTPTR)                0334
         MVC   LINE(117,CVTPTR),DASH                               0334
*       CALL ISDAPRT0;              /* WRITE DASH LINE       @ZM31074*/
*                                                                  0335
         L     @15,@CV00333                                        0335
         BALR  @14,@15                                             0335
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT LAST LINE AND NOTE AT BOTTOM                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0336
*       LINE='';                    /* BLANK LINE            @ZM31074*/
         MVI   LINE(CVTPTR),C' '                                   0336
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0336
*       J=1;                        /* SET CODE INDEX        @ZM31074*/
         LA    J,1                                                 0337
*       DO I=3 TO 108 BY 7;         /* LOOP THROUGH LINE     @ZM31074*/
         LA    I,3                                                 0338
@DL00338 DS    0H                                                  0339
*         LINE(I)=BAR;              /* MOVE BAR              @ZM31074*/
         LR    @10,CVTPTR                                          0339
         ALR   @10,I                                               0339
         MVI   LINE-1(@10),C'×'                                    0339
*         LINE(I+4)=CODENUMB(J);    /* MOVE HEX NUMBER       @ZM31074*/
         LR    @10,CVTPTR                                          0340
         ALR   @10,I                                               0340
         LA    @07,CODENUMB-1(J)                                   0340
         MVC   LINE+3(1,@10),0(@07)                                0340
*         J=J+1;                    /* ADD 1 TO J            @ZM31074*/
         AH    J,@CH00082                                          0341
*       END;                        /* END LINE FILL         @ZM31074*/
         AH    I,@CH00217                                          0342
         CH    I,@CH00522                                          0342
         BNH   @DL00338                                            0342
*       LINE(I)=BAR;                /* MOVE LAST BAR         @ZM31074*/
         LR    @10,CVTPTR                                          0343
         ALR   @10,I                                               0343
         MVI   LINE-1(@10),C'×'                                    0343
*       CALL ISDAPRT0;              /* PRINT LAST LINE       @ZM31074*/
         L     @15,@CV00333                                        0344
         BALR  @14,@15                                             0344
*       LINE=SUMMSG52;              /* MOVE MESSAGE          @ZM31074*/
         MVI   LINE+70(CVTPTR),C' '                                0345
         MVC   LINE+71(61,CVTPTR),LINE+70(CVTPTR)                  0345
         MVC   LINE(70,CVTPTR),SUMMSG52                            0345
*       ANSI=LSKIP2;                /* SET 2 LINE SKIP       @ZM31074*/
         MVI   ANSI(CVTPTR),C'0'                                   0346
*       CALL ISDAPRT0;              /* PRINT NOTE AT BOTTOM  @ZM31074*/
         L     @15,@CV00333                                        0347
         BALR  @14,@15                                             0347
*       RFY R1 UNRSTD;              /* RELEASE R1            @ZM31074*/
*     END;                          /* END PRINT SUMMARY OF REASON 0349
*                                      CODES                 @ZM31074*/
*   ELSE                            /* NO CODES TO PRINT     @ZM31074*/
*     DO;                           /* PRINT NONE            @ZM31074*/
         B     @RC00297                                            0350
@RF00297 DS    0H                                                  0351
*       LINE=SUMMSG53;              /* MOVE MESSAGE          @ZM31074*/
         MVI   LINE+13(CVTPTR),C' '                                0351
         MVC   LINE+14(118,CVTPTR),LINE+13(CVTPTR)                 0351
         MVC   LINE(13,CVTPTR),SUMMSG53                            0351
*       ANSI=LSKIP3;                /* SET 3 LINE SKIP       @ZM31074*/
         MVI   ANSI(CVTPTR),C'-'                                   0352
*       RFY R1 RSTD;                                               0353
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZM31074*/
         LA    R1,WORKCALL(,CVTPTR)                                0354
*       CALL ISDAPRT0;              /* PRINT NO DATA FOUND   @ZM31074*/
         L     @15,@CV00333                                        0355
         BALR  @14,@15                                             0355
*       RFY R1 UNRSTD;                                             0356
*     END;                          /* END OF NO INPUT CODE  @ZM31074*/
*   END RCODESUM;                   /* END PRINT ROUTINE     @ZM31074*/
@EL00007 DS    0H                                                  0358
@EF00007 DS    0H                                                  0358
@ER00007 L     @14,@SA00007                                        0358
         BR    @14                                                 0358
*   END ISDASUM1                    /*                       @ZM02889*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        *
*/*%INCLUDE SYSLIB  (ISDAMCFG)                                        *
*/*%INCLUDE SYSLIB  (ISDASUM5)                                        *
*;                                                                 0359
@DATA    DS    0H
@CH00082 DC    H'1'
@CH00182 DC    H'5'
@CH00217 DC    H'7'
@CH00503 DC    H'10'
@CH00431 DC    H'13'
@CH00156 DC    H'16'
@CH00335 DC    H'28'
@CH00307 DC    H'104'
@CH00522 DC    H'108'
@CH00505 DC    XL2'39'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    1F
@SA00003 DS    0F
@SA00007 DS    0F
@SA00005 DS    0F
@SA00006 DS    0F
@SA00004 DS    0F
         DS    15F
ISDASUM1 CSECT
         DS    0F
@CF00523 DC    F'212'
@CF00514 DC    F'1000'
@CF00280 DC    F'1024'
@CF00526 DC    F'-5'
@CF00527 DC    F'-2'
@DATD    DSECT
         DS    0D
GET0PTR  DS    A
COUNTEND DS    A
RETCODE  DS    F
CPUIDPTR DS    A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDASUM1 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00331 DC    V(ISDAFREE)
@CV00333 DC    V(ISDAPRT0)
@CV00329 DC    V(ISDAGET0)
@CV00330 DC    V(ISDAGET1)
@CV00332 DC    V(ISDAHEXP)
@CA00276 DC    A(ISDASUM2)
         DS    0D
@CC00309 DC    C' OBR'
@CC00311 DC    C' MDR'
@CC00313 DC    C'CDE'
EDPAT01  DC    X'40212020207A20207A202020202020612020202020'
EDPAT02  DC    X'402020202120'
EDPAT03  DC    X'40202021204B20'
SUMSPNO  DC    X'01'
SUMMSG12 DC    CL28'REPORT 2 - SDA INPUT SUMMARY'
SUMMSG20 DC    CL35'LIST OF CPU IDS FOR THIS INPUT DATA'
SUMMSG21 DC    CL42'(NOTE: ONLY THE FIRST 16 ARE PRINTED HERE)'
SUMMSG22 DC    CL42'LIST OF CPU IDS IN THE CONFIGURATION TABLE'
SUMMSG23 DC    CL72'NOTE: CPUID VALIDITY CHECKING CANNOT BE DONE WITHOUC
               T CONFIGURATION DATA.'
ISDA1001 DC    CL83'ISDA1001  SOME OF THE DATA USED IN THIS SDA RUN MAYC
                NOT BE FROM THE STORAGE SYSTEM'
SUMMSG30 DC    CL60'INPUT SUMMARY OF ERROR SENSE DATA FROM THE MSS AND C
               HOST 3330'
SUMMSG31 DC    CL86'  MSS   SA    MSG          FIRST             LAST  C
                            NO.   NO. TOTAL   % OF'
SUMMSG32 DC    CL86'FORMAT FORMAT CODE DEVICE  DATE   TIME       DATE  C
                TIME       PERM  TEMP COUNT  INPUT'
SUMMSG33 DC    CL87'------×------×----×------×-----------------×-------C
               ----------×-----×-----×-----×------×'
SUMMSG37 DC    CL6'TOTALS'
SUMMSG40 DC    CL61'INPUT SUMMARY OF BUFFERED LOG DATA FROM THE MSS ANDC
                HOST 3330'
CODENUMB DC    CL16'0123456789ABCDEF'
SUMMSG50 DC    CL36'MSS FORMAT 0 MESSAGE CODE 06 SUMMARY'
SUMMSG51 DC    CL52'NUMBER OF OCCURRENCES OF EACH UNIQUE CODE IN BYTE 1C
               2'
SUMMSG52 DC    CL70'VERTICAL AXIS IS BITS 0-3 AND HORIZONTAL AXIS IS BIC
               TS 4-7 FROM BYTE 12'
SUMMSG53 DC    CL13'NO INPUT DATA'
DASH     DC    CL117'--×------×------×------×------×------×------×-----C
               -×------×------×------×------×------×------×------×-----C
               -×------×--'
PATCH    DC    50X'00'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
L        EQU   @05
K        EQU   @07
J        EQU   @04
I        EQU   @06
CPUXXCNT EQU   @09
DEVIDPTR EQU   @08
COUNTPTR EQU   @05
SUMWKPTR EQU   @03
LPARMPTR EQU   @04
CVTPTR   EQU   @02
R1       EQU   @01
R15      EQU   @15
         EXTRN ISDASUM2
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
PARMPTR  EQU   CVTPTRS0+8
SUM00PTR EQU   CVTPTRS0+48
CNFG0PTR EQU   CVTPTRS0+88
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
ANSI     EQU   OUTLINE
LINE     EQU   OUTLINE+1
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CSUM     EQU   CREPORTS+2
ISDAGHDR EQU   0
GET0SPLN EQU   ISDAGHDR+8
PCNFG    EQU   0
CNFGFXD  EQU   PCNFG
CPUNO    EQU   CNFGFXD+2
CPUSERAD EQU   PCNFG+24
CPUXXIDS EQU   0
SUMWORK  EQU   0
SUMWORK1 EQU   SUMWORK
ACCM0PTR EQU   SUMWORK1
ACCUMPTR EQU   SUMWORK1+4
ACCM0END EQU   SUMWORK1+8
RCODEPTR EQU   SUMWORK1+20
RCODECNT EQU   SUMWORK1+24
GTOTALS  EQU   SUMWORK1+32
CNTSENSE EQU   GTOTALS+28
CNTLOG   EQU   GTOTALS+32
TOTPERMS EQU   SUMWORK1+68
TOTTEMPS EQU   SUMWORK1+72
NCPUUSED EQU   SUMWORK1+82
SUMWORK2 EQU   SUMWORK+86
CPUFOUND EQU   SUMWORK2
SUMTEMPS EQU   SUMWORK+166
TEMP9    EQU   SUMTEMPS
TEMP8    EQU   TEMP9
TEMP7    EQU   TEMP8
TEMP6    EQU   TEMP7
TEMP5    EQU   TEMP6
TEMP4    EQU   TEMP5
TEMP3    EQU   TEMP4
TEMP2    EQU   TEMP3
TEMP20   EQU   SUMTEMPS+9
TEMP16   EQU   TEMP20
TEMP710  EQU   TEMP20+6
SUMWORK3 EQU   SUMWORK+198
SUMFLAGS EQU   SUMWORK3
MAINMASK EQU   SUMWORK3+2
FORMATCK EQU   MAINMASK
FLAGMASK EQU   MAINMASK+1
MDEVIDTB EQU   0
MDFMTXXX EQU   MDEVIDTB
MDMASK   EQU   MDFMTXXX
MDFXXX   EQU   MDMASK
MDFLAG   EQU   MDMASK+1
MDSMXXX  EQU   MDMASK+2
MDIDS    EQU   MDFMTXXX+3
MDCFXXX  EQU   MDIDS
MDCSMXXX EQU   MDIDS+4
MDCSXXX  EQU   MDCSMXXX
MDCMXXX  EQU   MDCSMXXX+1
MDIDXXX  EQU   MDIDS+6
MDMSGXXX EQU   MDFMTXXX+14
MCOUNTER EQU   0
MCFMTXXX EQU   MCOUNTER
MCADDXXX EQU   MCFMTXXX
MCOUNTS  EQU   MCFMTXXX+4
MCPXXX   EQU   MCOUNTS
MCTXXX   EQU   MCOUNTS+2
MCMASK   EQU   MCFMTXXX+8
MCFXXX   EQU   MCMASK
MCFLAG   EQU   MCMASK+1
MLDTIME  EQU   MCFMTXXX+12
MLDATE   EQU   MLDTIME
MLTIME   EQU   MLDTIME+4
MHDTIME  EQU   MCFMTXXX+20
MHDATE   EQU   MHDTIME
MHTIME   EQU   MHDTIME+4
RCODES   EQU   0
SUMACCUM EQU   0
WORKPTR  EQU   0
TEMP68   EQU   TEMP8+5
EDREC01  EQU   SUMTEMPS
TEMP2326 EQU   SUMTEMPS+22
TEMP2730 EQU   SUMTEMPS+26
TEMP2230 EQU   SUMTEMPS+21
ED01TIME EQU   EDREC01+3
ED01YEAR EQU   EDREC01+15
ED01DAY  EQU   EDREC01+18
MSG53OVL EQU   LINE+65
MSG21ID  EQU   LINE+37
MSG32PC  EQU   LINE+63
MSG32TC  EQU   LINE+69
MSG37ID  EQU   LINE+54
MSG37OBR EQU   LINE+61
MSG37MDR EQU   LINE+67
MSG37TOT EQU   LINE+73
OUTFMT   EQU   LINE+1
OUTSAFMT EQU   LINE+8
OUTMSGCD EQU   LINE+15
OUT9CDE  EQU   LINE+14
OUTDEVID EQU   LINE+19
OUTLDAY  EQU   LINE+27
OUTLYEAR EQU   LINE+30
OUTLTIME EQU   LINE+34
OUTHDAY  EQU   LINE+45
OUTHYEAR EQU   LINE+48
OUTHTIME EQU   LINE+52
OUTPERM  EQU   LINE+61
OUTTEMP  EQU   LINE+67
OUTTOTAL EQU   LINE+73
OUTPERC  EQU   LINE+79
OUTMSGID EQU   LINE+88
TEMP78   EQU   TEMP8+6
*                                      START UNREFERENCED COMPONENTS
MCSPARE  EQU   MCFMTXXX+11
MCSMXXX  EQU   MCMASK+2
MSGCODSV EQU   SUMWORK3+13
SUBFIDSV EQU   SUMWORK3+12
FMTIDSV  EQU   SUMWORK3+5
SUBFMASK EQU   MAINMASK+2
FORMATNC EQU   SUMWORK3+1
TEMP3032 EQU   SUMTEMPS+29
TEMP1820 EQU   TEMP20+17
TEMP1417 EQU   TEMP20+13
TEMP1113 EQU   TEMP20+10
TEMP1    EQU   TEMP2
NCPUCNTS EQU   SUMWORK1+84
NCOUNTER EQU   SUMWORK1+80
SUMACCL  EQU   SUMWORK1+78
ACCUMCNT EQU   SUMWORK1+76
CNTFDASD EQU   GTOTALS+24
CNTF5    EQU   GTOTALS+20
CNTF4    EQU   GTOTALS+16
CNTF3    EQU   GTOTALS+12
CNTF2    EQU   GTOTALS+8
CNTF1    EQU   GTOTALS+4
CNTF0    EQU   GTOTALS
SUM2PTR  EQU   SUMWORK1+28
SENSEPTR EQU   SUMWORK1+16
LOGPTR   EQU   SUMWORK1+12
SAINTFP  EQU   PCNFG+32
@NM00004 EQU   PCNFG+30
CNFGTOTL EQU   PCNFG+28
CHCUAD   EQU   PCNFG+20
LTPAD    EQU   PCNFG+16
PCNFGL   EQU   CNFGFXD+14
CHINTFNO EQU   CNFGFXD+12
LIBSIZS  EQU   CNFGFXD+8
SANO     EQU   CNFGFXD+6
SPINO    EQU   CNFGFXD+4
MSFNO    EQU   CNFGFXD
@NM00003 EQU   ISDAGHDR+26
BLOCKCNT EQU   ISDAGHDR+24
BLOCKID  EQU   ISDAGHDR+20
LASTPTR  EQU   ISDAGHDR+16
NEXTPTR  EQU   ISDAGHDR+12
GET0LEN  EQU   GET0SPLN+1
GET0SPNO EQU   GET0SPLN
ENDPTR   EQU   ISDAGHDR+4
STARTPTR EQU   ISDAGHDR
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CDHEDHU  EQU   CREPORTS+3
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
GEN00PTR EQU   CVTPTRS0+92
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDA00PTR EQU   CVTPTRS0+12
SDATAPTR EQU   CVTPTRS0+4
DATAPTR  EQU   CVTPTRS0
*                                      END UNREFERENCED COMPONENTS
@PB00003 EQU   @EL00002
@RC00297 EQU   @EL00007
@RC00119 EQU   @PB00003
@ENDDATA EQU   *
         END   ISDASUM1,(C'PLS1920',0603,75147)

         TITLE 'CS BUFFERED LOG/FORCED SENSE DATA ACCUMULATOR          *
                        '
ISDACSB0 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(8)                                           01S0001
         DC    C'ISDACSB0'                                      01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         ISDAGSPC R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @00,@01,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MVC   @PC00001(4),0(@01)                               01S0001
*                                      ACCUMULATOR JUST OBTAINED
*                                                            @Y30LB50*/
*                                                               01S0036
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF ISDACSB0 DECLARES                              @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0037
*                                                               01S0037
*   /*****************************************************************/
*   /*                                                               */
*   /* START OF ISDACSB0 MAIN PROGRAM                        @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0037
*   CVTPTR=WORKPTR;                 /* SAVE SDACVT POINTER   @Y30LB50*/
         L     @10,@PC00001                                     01S0037
         L     CVTPTR,WORKPTR(,@10)                             01S0037
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO PARMS@ZM30983*/
         MVC   LPARMPTR(4),PARMPTR(CVTPTR)                      01S0038
*   SENSEPTR=SDATAPTR;              /* SET SENSE DATA PTR    @ZM30983*/
         MVC   SENSEPTR(4),SDATAPTR(CVTPTR)                     01S0039
*   RETCODE=0;                      /* ZERO RETURN CODE      @Y30LB50*/
         SLR   @10,@10                                          01S0040
         LR    RETCODE,@10                                      01S0040
*   IF CSB00PTR=0 THEN              /* IF CSB00PTR IS 0, THIS IS THE
*                                      INITIAL CALL AND A WORK AREA
*                                      MUST BE OBTAINED AND     01S0041
*                                      INITIALIZED           @Y30LB50*/
         C     @10,CSB00PTR(,CVTPTR)                            01S0041
         BNE   @RF00041                                         01S0041
*                                                               02S0042
*   /*****************************************************************/
*   /*                                                               */
*   /* CSBINIT IS CALLED ONLY ONCE TO OBTAIN A WORKAREA AND TO       */
*   /* INITITALIZE IT.                                       @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0042
*   DO;                             /*                       @Y30LB50*/
*     RFY                                                       02S0043
*       R1 RSTD;                    /*                       @Y30LB50*/
*     R1=ADDR(WORKCALL);            /*                       @Y30LB50*/
         LA    R1,WORKCALL(,CVTPTR)                             02S0044
*     CORELEN=LENGTH(CSBWORK)+MAXCSS*LENGTH(CSTBLS);/*          02S0045
*                                        LENGTH OF WORKAREA=HEADER
*                                      INFOR LENGTH PLUS SPACE FOR CS
*                                      PROCESSING PARAMETER TABLES
*                                                            @Y30LB50*/
         MVC   CORELEN(3,CVTPTR),@CF00402+1                     02S0045
*     SPNO=WORKSPNO;                /* SUBPOOL NUMBER FOR CSB   02S0046
*                                      WORKAREA              @Y30LB50*/
         MVC   SPNO(1,CVTPTR),WORKSPNO                          02S0046
*     CALL ISDAGET1;                /* ASK FOR WORKAREA      @Y30LB50*/
         L     @15,@CV00369                                     02S0047
         BALR  @14,@15                                          02S0047
*     RFY                                                       02S0048
*       R15 RSTD;                   /*                       @Y30LB50*/
*     RETCODE=R15;                  /* SAVE RETURN CODE FROM REQUEST
*                                                            @Y30LB50*/
         LR    RETCODE,R15                                      02S0049
*     RFY                                                       02S0050
*      (R15,                                                    02S0050
*       R1) UNRSTD;                 /*                       @Y30LB50*/
*     IF RETCODE=0 THEN                                         02S0051
         LTR   RETCODE,RETCODE                                  02S0051
         BNZ   @RF00051                                         02S0051
*       DO;                         /* CONTINUE IF WORKAREA OBTAINED
*                                                            @Y30LB50*/
*         LWORKPTR=COREADDR;        /* SAVE WORKAREA PTR FOR LOCAL
*                                      USE                   @Y30LB50*/
         L     LWORKPTR,COREADDR(,CVTPTR)                       02S0053
*         CSB00PTR=LWORKPTR;        /* SAVE WORKAREA POINTER IN 02S0054
*                                      SDACVT                @Y30LB50*/
         ST    LWORKPTR,CSB00PTR(,CVTPTR)                       02S0054
*         CSBWORK=''B;              /* ZERO WORK AREA        @Y30LB50*/
         XC    CSBWORK(112,LWORKPTR),CSBWORK(LWORKPTR)          02S0055
*         CSPTR=LWORKPTR+LENGTH(CSBWORK);/*                     02S0056
*                                      PTR TO FIRST TABLE    @Y30LB50*/
         LA    CSPTR,112                                        02S0056
         ALR   CSPTR,LWORKPTR                                   02S0056
*         DO I=1 TO MAXCSS;         /* ZERO EACH CS TABLE    @Y30LB50*/
         LA    @10,1                                            02S0057
         STH   @10,I(,LWORKPTR)                                 02S0057
@DL00057 DS    0H                                               02S0058
*           CSTPTRS(I)=CSPTR;       /* SAVE CS TABLE POINTER @Y30LB50*/
         LH    @10,I(,LWORKPTR)                                 02S0058
         SLA   @10,2                                            02S0058
         ST    CSPTR,CSTPTRS-4(@10,LWORKPTR)                    02S0058
*           CSTBLS=''B;             /*                       @Y30LB50*/
         XC    CSTBLS(44,CSPTR),CSTBLS(CSPTR)                   02S0059
*           CSPTR=CSPTR+LENGTH(CSTBLS);/*                       02S0060
*                                                            @Y30LB50*/
         AH    CSPTR,@CH00400                                   02S0060
*         END;                      /*                       @Y30LB50*/
         LA    @10,1                                            02S0061
         AH    @10,I(,LWORKPTR)                                 02S0061
         STH   @10,I(,LWORKPTR)                                 02S0061
         CH    @10,@CH00107                                     02S0061
         BNH   @DL00057                                         02S0061
*       END;                        /*                       @Y30LB50*/
*     ELSE                          /* BAD RETURN FROM GET1  @ZM30983*/
*       CCSBCSF='00'X;              /* SET NO CALL FLAG      @ZM30983*/
         B     @RC00051                                         02S0063
@RF00051 L     @10,LPARMPTR                                     02S0063
         MVI   CCSBCSF(@10),X'00'                               02S0063
*   END;                            /*                       @Y30LB50*/
*   ELSE                                                        01S0065
*     ;                             /*                       @Y30LB50*/
@RF00041 DS    0H                                               01S0066
*   IF RETCODE=0 THEN                                           01S0066
@RC00041 SLR   @10,@10                                          01S0066
         CR    RETCODE,@10                                      01S0066
         BNE   @RF00066                                         01S0066
*     DO;                           /* CONTINUE ONLY IF INITIAL 01S0067
*                                      WORKAREA WAS OBTAINED @Y30LB50*/
*       LWORKPTR=CSB00PTR;          /* PTR FOR WORKAREA      @Y30LB50*/
         L     LWORKPTR,CSB00PTR(,CVTPTR)                       01S0068
*       LOGPTR=DATAPTR;             /* SAVE LOG HEADER POINTER  01S0069
*                                                            @Y30LB50*/
         MVC   LOGPTR(4,LWORKPTR),DATAPTR(CVTPTR)               01S0069
*       IF(ENVIRDAT=ON)&(RECONFIG^=ON) THEN                     01S0070
         L     @15,SENSEPTR                                     01S0070
         TM    ENVIRDAT(@15),B'00000001'                        01S0070
         BNO   @RF00070                                         01S0070
         TM    RECONFIG(@15),B'01000000'                        01S0070
         BO    @RF00070                                         01S0070
*         DO;                       /* FOR VALID INPUT THE      01S0071
*                                      ENVIRONMENTAL DATA BIT MUST BE
*                                      ON AND THE RECONFIGURATION BIT
*                                      MUST BE OFF IN THE FORMAT 3
*                                      SENSE. IF TRUE, CHECK FOR NEW
*                                      CS. IF NOT TRUE, IGNORE DATA
*                                                            @Y30LB50*/
*                                                               02S0072
*   /*****************************************************************/
*   /*                                                               */
*   /* CSCHK IS CALLED FOR EACH INPUT RECORD TO DETERMINE IF IT IS   */
*   /* FOR A NEW CS (I.E. ONE FOR WHICH NO CS PARAMETERS TABLE HAS   */
*   /* BEEN INITIALIZED). IF IT IS NEW, THE TABLE WILL BE INITIALIZED*/
*   /* AND CSPTR WILL BE INITIALIZED TO POINT TO THE NEW CS TABLE    */
*   /*                                                       @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0072
*   DO;                             /*                       @Y30LB50*/
*     NBRWORK=SUBSYSID;             /* ISOLATE CS IN SSID    @Y30LB50*/
         MVC   NBRWORK(2,LWORKPTR),SUBSYSID(@15)                02S0073
*     NBRWORK=NBRWORK&CSMASK;       /*                       @Y30LB50*/
         NC    NBRWORK(2,LWORKPTR),CSMASK                       02S0074
*     SRL(NBRWORK(2),4);            /*                       @Y30LB50*/
         SLR   @15,@15                                          02S0075
         IC    @15,NBRWORK+1(,LWORKPTR)                         02S0075
         SRL   @15,4                                            02S0075
         STC   @15,NBRWORK+1(,LWORKPTR)                         02S0075
*     CSPTR=CSTPTRS(NBRWORK+1);     /* POINT TO THIS CS TABLE   02S0076
*                                                            @Y30LB50*/
         SLR   @15,@15                                          02S0076
         ICM   @15,3,NBRWORK(LWORKPTR)                          02S0076
         SLA   @15,2                                            02S0076
         L     CSPTR,CSTPTRS(@15,LWORKPTR)                      02S0076
*     IF(ACCUM=0)&(FACCUM=0) THEN                               02S0077
         C     @10,ACCUM(,CSPTR)                                02S0077
         BNE   @RF00077                                         02S0077
         C     @10,FACCUM(,CSPTR)                               02S0077
         BNE   @RF00077                                         02S0077
*       DO;                         /* NO CSB OR CSF ACCUMULATOR
*                                      BLOCKS OBTAINED INDICATES NEW
*                                      CS INPUT              @Y30LB50*/
*                                                               03S0079
*   /*****************************************************************/
*   /*                                                               */
*   /* FIRSTCSB IS CALLED TO OBTAIN THE FIRST CSB ACCUMULATOR BLOCK  */
*   /* FOR A NEW CS, TO INITIALIZE ITS HEADER AND TO INITIALIZE THE  */
*   /* CSB PARAMETERS IN THE CS TABLE IN THE CSB WORKAREA . IT CAN   */
*   /* RETURN A CODE OF 4 FOR NO BLOCK OBTAINED OR 0 FOR BLOCK       */
*   /* OBTAINED AND INITIALIZED                              @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0079
*   IF CCSBCSF(8)=ON THEN                                       03S0079
         L     @10,LPARMPTR                                     03S0079
         TM    CCSBCSF(@10),B'00000001'                         03S0079
         BNO   @RF00079                                         03S0079
*     DO;                           /* CHECK FOR CSB REQUESTED (USAGE
*                                      BUFFERED LOG REPORT)  @Y30LB50*/
*       CORELEN=LENGTH(ISDAGHDR)+BLOCKKNT*LENGTH(CSBDATA);/*    03S0081
*                                             LENGTH OF ACCUMULATOR
*                                      FOR ISDAGET0 REQUESTS=LENGTH
*                                      OF HEADER PLUS LENGTH OF ONE
*                                      LOG SAVE TIMES NUMBER OF LOGS
*                                      PER BLOCK             @Y30LB50*/
         MVC   CORELEN(3,CVTPTR),@CF00404+1                     03S0081
*       SPNO=CSBSPNO;               /* SUBPOOL NUMBER FOR CSB   03S0082
*                                      PROCESSING            @Y30LB50*/
         MVI   SPNO(CVTPTR),X'01'                               03S0082
*       RFY                                                     03S0083
*         R1 RSTD;                  /*                       @Y30LB50*/
*       R1=ADDR(WORKCALL);          /*                       @Y30LB50*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0084
*       CALL ISDAGET0;              /* GET ACCUMULATOR BLOCK @Y30LB50*/
         L     @15,@CV00368                                     03S0085
         BALR  @14,@15                                          03S0085
*       RFY                                                     03S0086
*         R15 RSTD;                 /*                       @Y30LB50*/
*       RETCODE=R15;                /* SAVE RETURN CODE FROM ISDAGET0
*                                                            @Y30LB50*/
         LR    RETCODE,R15                                      03S0087
*       RFY                                                     03S0088
*        (R15,                                                  03S0088
*         R1) UNRSTD;               /*                       @Y30LB50*/
*       IF RETCODE=0 THEN                                       03S0089
         LTR   RETCODE,RETCODE                                  03S0089
         BNZ   @RF00089                                         03S0089
*         DO;                       /* INITIALIZE BLK IF OBTAINED
*                                                            @Y30LB50*/
*           RFY                                                 03S0091
*             GET0PTR RSTD;         /*                       @Y30LB50*/
*           GET0PTR=COREADDR;       /* SAVE ADDR OF BLOCK OBTAINED
*                                                            @Y30LB50*/
         L     GET0PTR,COREADDR(,CVTPTR)                        03S0092
*           BLOCKID='CSB';          /* BLOCK USER ID         @Y30LB50*/
         MVI   BLOCKID+3(GET0PTR),C' '                          03S0093
         MVC   BLOCKID(3,GET0PTR),@CC00381                      03S0093
*           ACCUM=GET0PTR;          /* FIRST CSB BLOCK FOR CS   03S0094
*                                                            @Y30LB50*/
         ST    GET0PTR,ACCUM(,CSPTR)                            03S0094
*           ACCMPTR=GET0PTR;        /* CURRENT CSB BLOCK FOR CS 03S0095
*                                                            @Y30LB50*/
         ST    GET0PTR,ACCMPTR(,CSPTR)                          03S0095
*           CSBFIRST=STARTPTR;      /* SET PTR FOR EARLIEST TIME REC
*                                                            @Y30LB50*/
         L     @10,STARTPTR(,GET0PTR)                           03S0096
         ST    @10,CSBFIRST(,CSPTR)                             03S0096
*           NEXTCSB=STARTPTR-LENGTH(CSBDATA);/*                 03S0097
*                                        SAVE ADDR-FIRST CSB RECORD
*                                                            @Y30LB50*/
         SH    @10,@CH00097                                     03S0097
         ST    @10,NEXTCSB(,CSPTR)                              03S0097
*           CSNUMB=NBRWORK(2)×'0';  /* SAVE CS NUMBER FOR PRINTING
*                                                            @Y30LB50*/
         MVC   CSNUMB(1,CSPTR),NBRWORK+1(LWORKPTR)              03S0098
         OI    CSNUMB(CSPTR),C'0'                               03S0098
*           RFY                                                 03S0099
*             GET0PTR UNRSTD;       /*                       @Y30LB50*/
*         END;                      /*                       @Y30LB50*/
*       ELSE                                                    03S0101
*         ;                         /*                       @Y30LB50*/
@RF00089 DS    0H                                               03S0102
*     END;                          /*                       @Y30LB50*/
*   ELSE                                                        03S0103
*     ;                             /*                       @Y30LB50*/
@RF00079 DS    0H                                               03S0104
*                                                               03S0104
*   /*****************************************************************/
*   /*                                                               */
*   /* FIRSTCSF IS USED TO OBTAIN THE FIRST CSF ACCUMULATOR BLOCK FOR*/
*   /* A NEW CS, TO INITIALIZE ITS HEADER AND TO INITIALIZE THE CSF  */
*   /* PARAMETERS IN THE CS TABLE IN THE CSB WORKAREA. IT CAN RETURN */
*   /* A CODE OF 0 FOR BLOCK OBTAINED AND INITIALIZED OR 4 FOR NO    */
*   /* BLOCK OBTAINED.                                       @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0104
*   IF(CCSBCSF(7)=ON)&(RETCODE=0) THEN                          03S0104
         L     @10,LPARMPTR                                     03S0104
         TM    CCSBCSF(@10),B'00000010'                         03S0104
         BNO   @RF00104                                         03S0104
         LTR   RETCODE,RETCODE                                  03S0104
         BNZ   @RF00104                                         03S0104
*     DO;                           /* CHECK IF ERROR BUFFERED LOG
*                                      WAS REQUESTED         @Y30LB50*/
*       CORELEN=LENGTH(ISDAGHDR)+BLOCKKNT*LENGTH(CSFDATA);/*    03S0106
*                                             LENGTH OF ACCUMULATOR
*                                      FOR ISDAGET0 REQUESTS=LENGTH
*                                      OF HEADER PLUS LENGTH OF ONE
*                                      LOG SAVE TIMES NUMBER OF LOGS
*                                      PER BLOCK             @Y30LB50*/
         MVC   CORELEN(3,CVTPTR),@CF00406+1                     03S0106
*       SPNO=CSBSPNO;               /* SUBPOOL NUMBER FOR CSB, CSF
*                                      PROCESSING            @Y30LB50*/
         MVI   SPNO(CVTPTR),X'01'                               03S0107
*       RFY                                                     03S0108
*         R1 RSTD;                  /*                       @Y30LB50*/
*       R1=ADDR(WORKCALL);          /*                       @Y30LB50*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0109
*       CALL ISDAGET0;              /* GET CSF ACCUMULATOR BLK  03S0110
*                                                            @Y30LB50*/
         L     @15,@CV00368                                     03S0110
         BALR  @14,@15                                          03S0110
*       RFY                                                     03S0111
*         R15 RSTD;                 /*                       @Y30LB50*/
*       RETCODE=R15;                /* SAVE RETURN CODE FROM ISDAGET0
*                                                            @Y30LB50*/
         LR    RETCODE,R15                                      03S0112
*       RFY                                                     03S0113
*        (R15,                                                  03S0113
*         R1) UNRSTD;               /*                       @Y30LB50*/
*       IF RETCODE=0 THEN                                       03S0114
         LTR   RETCODE,RETCODE                                  03S0114
         BNZ   @RF00114                                         03S0114
*         DO;                       /* INITIALIZE BLK IF OBTAINED
*                                                            @Y30LB50*/
*           RFY                                                 03S0116
*             GET0PTR RSTD;         /*                       @Y30LB50*/
*           GET0PTR=COREADDR;       /* SAVE ADDR OF BLOCK OBTAINED
*                                                            @Y30LB50*/
         L     GET0PTR,COREADDR(,CVTPTR)                        03S0117
*           BLOCKID='CSF';          /* BLOCK USER ID         @Y30LB50*/
         MVI   BLOCKID+3(GET0PTR),C' '                          03S0118
         MVC   BLOCKID(3,GET0PTR),@CC00383                      03S0118
*           FACCUM=GET0PTR;         /* FIRST CSF BLOCK FOR CS   03S0119
*                                                            @Y30LB50*/
         ST    GET0PTR,FACCUM(,CSPTR)                           03S0119
*           FACCMPTR=GET0PTR;       /* CURRENT CSF BLOCK FOR CS 03S0120
*                                                            @Y30LB50*/
         ST    GET0PTR,FACCMPTR(,CSPTR)                         03S0120
*           CSFFIRST=STARTPTR;      /* SET PTR FOR EARLIEST TIME REC
*                                                            @Y30LB50*/
         L     @10,STARTPTR(,GET0PTR)                           03S0121
         ST    @10,CSFFIRST(,CSPTR)                             03S0121
*           NEXTCSF=STARTPTR-LENGTH(CSFDATA);/*                 03S0122
*                                        ADDR TO SAVE FIRST CSF LOG
*                                                            @Y30LB50*/
         SH    @10,@CH00400                                     03S0122
         ST    @10,NEXTCSF(,CSPTR)                              03S0122
*           RFY                                                 03S0123
*             GET0PTR UNRSTD;       /*                       @Y30LB50*/
*           CSNUMB=NBRWORK(2)×'0';  /* SAVE CS NUMBER FOR PRINTING
*                                                            @Y30LB50*/
         MVC   CSNUMB(1,CSPTR),NBRWORK+1(LWORKPTR)              03S0124
         OI    CSNUMB(CSPTR),C'0'                               03S0124
*         END;                      /*                       @Y30LB50*/
*       ELSE                                                    03S0126
*         ;                         /*                       @Y30LB50*/
@RF00114 DS    0H                                               03S0127
*     END;                          /*                       @Y30LB50*/
*   ELSE                                                        03S0128
*     ;                             /*                       @Y30LB50*/
@RF00104 DS    0H                                               03S0129
*       END;                        /*                       @Y30LB50*/
*     ELSE                                                      02S0130
*       ;                           /*                       @Y30LB50*/
@RF00077 DS    0H                                               02S0131
*   END;                            /*                       @Y30LB50*/
*           IF RETCODE=0 THEN                                   01S0132
         LTR   RETCODE,RETCODE                                  01S0132
         BNZ   @RF00132                                         01S0132
*             DO;                   /* IF CS CHECK WAS SUCCESSFUL
*                                                            @Y30LB50*/
*               IF(BFRBIT=ON) THEN  /* CHECK BUFFERED LOG BIT IN THE
*                                      MSC FMT 3 SENSE TO DETERMINE
*                                      DATA TYPE. IF ON-CS BUFFERED
*                                      LOG DATA. IF OFF-CS FORCED
*                                      SENSE DATA            @Y30LB50*/
         L     @10,SENSEPTR                                     01S0134
         TM    BFRBIT(@10),B'00000001'                          01S0134
         BNO   @RF00134                                         01S0134
*                                                               02S0135
*   /*****************************************************************/
*   /*                                                               */
*   /* BFRLOG IS CALLED TO ACCUMULATE BUFFERED LOG DATA FOR EITHER A */
*   /* USAGE REPORT REQUEST(CSB) OR AN ERROR REPORT REQUEST(CSF) OR  */
*   /* BOTH. IT WILL OBTAIN A NEW BLOCK FOR ACCUMULATING WHEN        */
*   /* NECESSARY. RETURN CODE WILL BE 4 IF NO ADDITIONAL BLOCK COULD */
*   /* BE OBTAINED WHEN NEEDED.                              @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0135
*   DO;                             /*                       @Y30LB50*/
*     IF CCSBCSF(8)=ON THEN         /* IF USAGE REQUEST      @Y30LB50*/
         L     @10,LPARMPTR                                     02S0136
         TM    CCSBCSF(@10),B'00000001'                         02S0136
         BNO   @RF00136                                         02S0136
*   DO;                             /*                       @Y30LB50*/
*     RFY                                                       03S0138
*       LASTREC RSTD;               /*                       @Y30LB50*/
*     LASTREC=NEXTCSB;              /* SAVE ADDR OF PREVIOUS RECORD
*                                                            @Y30LB50*/
         L     @10,NEXTCSB(,CSPTR)                              03S0139
         LR    LASTREC,@10                                      03S0139
*     NEXTCSB=NEXTCSB+LENGTH(CSBDATA);/*                        03S0140
*                                      UP PTR TO SAVE CURRENT REC
*                                                            @Y30LB50*/
         AH    @10,@CH00097                                     03S0140
         ST    @10,NEXTCSB(,CSPTR)                              03S0140
*     IF CSBCNT=BLOCKKNT THEN       /* IF CURRENT BLOCK IS FULL,
*                                      OBTAIN A NEW ONE      @Y30LB50*/
         CLC   CSBCNT(2,CSPTR),@CH00237                         03S0141
         BNE   @RF00141                                         03S0141
*                                                               04S0142
*   /*****************************************************************/
*   /*                                                               */
*   /* NEWCSB IS CALLED TO OBTAIN AN ADDITIONAL ACCUMULATOR BLOCK FOR*/
*   /* CSB PROCESSING. RETURN CODE WILL BE 4 IF NO BLOCK IS AVAILABLE*/
*   /*                                                       @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               04S0142
*   DO;                             /*                       @Y30LB50*/
*     CORELEN=LENGTH(ISDAGHDR)+BLOCKKNT*LENGTH(CSBDATA);/*      04S0143
*                                           LENGTH OF ACCUMULATOR FOR
*                                      ISDAGET0 REQUESTS=LENGTH OF
*                                      HEADER PLUS LENGTH OF ONE LOG
*                                      SAVE TIMES NUMBER OF LOGS PER
*                                      BLOCK                 @Y30LB50*/
         MVC   CORELEN(3,CVTPTR),@CF00404+1                     04S0143
*     SPNO=CSBSPNO;                 /* SUBPOOL NUMBER FOR BLOCK 04S0144
*                                                            @Y30LB50*/
         MVI   SPNO(CVTPTR),X'01'                               04S0144
*     RFY                                                       04S0145
*       R1 RSTD;                    /*                       @Y30LB50*/
*     R1=ADDR(WORKCALL);            /*                       @Y30LB50*/
         LA    R1,WORKCALL(,CVTPTR)                             04S0146
*     CALL ISDAGET0;                /* REQUEST BLOCK         @Y30LB50*/
         L     @15,@CV00368                                     04S0147
         BALR  @14,@15                                          04S0147
*     RFY                                                       04S0148
*       R15 RSTD;                   /*                       @Y30LB50*/
*     RETCODE=R15;                  /* SAVE RETURN CODE FROM ISDAGET0
*                                                            @Y30LB50*/
         LR    RETCODE,R15                                      04S0149
*     RFY                                                       04S0150
*      (R1,                                                     04S0150
*       R15) UNRSTD;                /*                       @Y30LB50*/
*     IF RETCODE=0 THEN                                         04S0151
         SLR   @10,@10                                          04S0151
         CR    RETCODE,@10                                      04S0151
         BNE   @RF00151                                         04S0151
*       DO;                         /* INITIALIZE AND CHAIN BLOCK IF
*                                      OBTAINED              @Y30LB50*/
*         RFY                                                   04S0153
*           GET0PTR RSTD;           /*                       @Y30LB50*/
*         GET0PTR=COREADDR;         /* SAVE ADDRESS OF BLOCK OBTAINED
*                                                            @Y30LB50*/
         L     GET0PTR,COREADDR(,CVTPTR)                        04S0154
*         LASTPTR=ACCMPTR;          /* BACKWARD CHAIN IN NEW BLOCK
*                                                            @Y30LB50*/
         L     @06,ACCMPTR(,CSPTR)                              04S0155
         ST    @06,LASTPTR(,GET0PTR)                            04S0155
*         BLOCKID='CSB';            /* BLOCK USER ID         @Y30LB50*/
         MVI   BLOCKID+3(GET0PTR),C' '                          04S0156
         MVC   BLOCKID(3,GET0PTR),@CC00381                      04S0156
*         CSBCNT=0;                 /* COUNT OF LOGS IN NEW BLOCK
*                                                            @Y30LB50*/
         STH   @10,CSBCNT(,CSPTR)                               04S0157
*         NEXTCSB=STARTPTR;         /* ADDR TO SAVE NEXT LOG @Y30LB50*/
         MVC   NEXTCSB(4,CSPTR),STARTPTR(GET0PTR)               04S0158
*         RFY                                                   04S0159
*           ISDAGHDR BASED(ACCMPTR);/*                       @Y30LB50*/
*         NEXTPTR=GET0PTR;          /* FORWARD CHAIN IN PREVIOUS
*                                      BLOCK                 @Y30LB50*/
         ST    GET0PTR,NEXTPTR(,@06)                            04S0160
*         RFY                                                   04S0161
*           ISDAGHDR BASED(GET0PTR);/*                       @Y30LB50*/
*         ACCMPTR=GET0PTR;          /* NEW CSB BLOCK FOR CS  @Y30LB50*/
         ST    GET0PTR,ACCMPTR(,CSPTR)                          04S0162
*         RFY                                                   04S0163
*           GET0PTR UNRSTD;         /*                       @Y30LB50*/
*       END;                        /*                       @Y30LB50*/
*     ELSE                                                      04S0165
*       ;                           /*                       @Y30LB50*/
@RF00151 DS    0H                                               04S0166
*   END;                            /*                       @Y30LB50*/
*     ELSE                                                      03S0167
*       ;                           /*                       @Y30LB50*/
@RF00141 DS    0H                                               03S0168
*     IF RETCODE=0 THEN                                         03S0168
         LTR   RETCODE,RETCODE                                  03S0168
         BNZ   @RF00168                                         03S0168
*       DO;                         /* CONTINUE IF BLOCK OBTAINED
*                                                            @Y30LB50*/
*         CSBCNT=CSBCNT+1;          /* UP COUNT OF LOGS IN BLOCK
*                                                            @Y30LB50*/
         LA    @10,1                                            03S0170
         LH    @06,CSBCNT(,CSPTR)                               03S0170
         ALR   @06,@10                                          03S0170
         STH   @06,CSBCNT(,CSPTR)                               03S0170
*         BFRCNT=BFRCNT+1;          /* UP TOTAL COUNT OF CSB LOGS
*                                      SAVED                 @Y30LB50*/
         AH    @10,BFRCNT(,CSPTR)                               03S0171
         STH   @10,BFRCNT(,CSPTR)                               03S0171
*         CSBDAY=DATE;              /* SAVE DATE FROM HEADER @Y30LB50*/
         L     @10,NEXTCSB(,CSPTR)                              03S0172
         L     @06,LOGPTR(,LWORKPTR)                            03S0172
         MVC   CSBDAY(4,@10),DATE(@06)                          03S0172
*         CSBTIME=TIME;             /* SAVE TIME FROM HEADER @Y30LB50*/
         MVC   CSBTIME(4,@10),TIME(@06)                         03S0173
*         CSBMSC=ISDAMSCS;          /* SAVE MSC SENSE        @Y30LB50*/
         L     @06,SENSEPTR                                     03S0174
         MVC   CSBMSC(4,@10),ISDAMSCS(@06)                      03S0174
*         CSBREC=MSCFMT3B;          /* SAVE BUFFERED LOG DATA   03S0175
*                                                            @Y30LB50*/
         MVC   CSBREC(24,@10),MSCFMT3B(@06)                     03S0175
*         STARTADR=CSBFIRST;        /* EARLIEST CSB TIME TAGGED 03S0176
*                                      RECORD                @Y30LB50*/
         MVC   STARTADR(4,LWORKPTR),CSBFIRST(CSPTR)             03S0176
*         CURRADR=NEXTCSB;          /* CURRENT RECORD SAVED  @Y30LB50*/
         ST    @10,CURRADR(,LWORKPTR)                           03S0177
*         CALL CSBSORT;             /* TIME MERGE CURRENT RECORD WITH
*                                      THOSE ALREADY SAVED   @Y30LB50*/
         BAL   @14,CSBSORT                                      03S0178
*         CSBFIRST=STARTADR;        /* UPDATE POINTER TO EARLIEST
*                                      RECORD                @Y30LB50*/
         MVC   CSBFIRST(4,CSPTR),STARTADR(LWORKPTR)             03S0179
*         RFY                                                   03S0180
*           LASTREC UNRSTD;         /*                       @Y30LB50*/
*       END;                        /*                       @Y30LB50*/
*     ELSE                                                      03S0182
*       ;                           /*                       @Y30LB50*/
@RF00168 DS    0H                                               03S0183
*   END;                            /*                       @Y30LB50*/
*     ELSE                                                      02S0184
*       ;                           /*                       @Y30LB50*/
@RF00136 DS    0H                                               02S0185
*     IF(CCSBCSF(7)=ON)&(ERROVFL1=ON) THEN/* IF ERROR        @YM32171
*                                      BUFFERED LOG REPORT IS   02S0185
*                                      REQUESTED(CSF) AND THE ERROR
*                                      BUFFERED LOG BIT IS ON IN THE
*                                      MSC FORMAT3B SENSE-SAVE LOG
*                                      FOR CSF PROCESSING    @Y30LB50*/
         L     @10,LPARMPTR                                     02S0185
         TM    CCSBCSF(@10),B'00000010'                         02S0185
         BNO   @RF00185                                         02S0185
         L     @10,SENSEPTR                                     02S0185
         TM    ERROVFL1(@10),B'00100000'                        02S0185
         BNO   @RF00185                                         02S0185
*   DO;                             /*                       @Y30LB50*/
*     RFY                                                       03S0187
*       LASTREC RSTD;               /*                       @Y30LB50*/
*     LASTREC=NEXTCSF;              /* SAVE PTR TO LAST REC  @Y30LB50*/
         L     @10,NEXTCSF(,CSPTR)                              03S0188
         LR    LASTREC,@10                                      03S0188
*     NEXTCSF=NEXTCSF+LENGTH(CSFDATA);/*                        03S0189
*                                      UP PTR TO SAVE CURR REC  03S0189
*                                                            @Y30LB50*/
         AH    @10,@CH00400                                     03S0189
         ST    @10,NEXTCSF(,CSPTR)                              03S0189
*     IF CSFCNT=BLOCKKNT THEN                                   03S0190
         CLC   CSFCNT(2,CSPTR),@CH00237                         03S0190
         BNE   @RF00190                                         03S0190
*       CALL NEWCSF;                /* IF CURRENT CSF BLOCK IS FULL
*                                      THEN GET A NEW ONE    @Y30LB50*/
         BAL   @14,NEWCSF                                       03S0191
*     ELSE                                                      03S0192
*       ;                           /*                       @Y30LB50*/
@RF00190 DS    0H                                               03S0193
*     IF RETCODE=0 THEN                                         03S0193
         LTR   RETCODE,RETCODE                                  03S0193
         BNZ   @RF00193                                         03S0193
*       DO;                         /* CONTINUE IF BLOCK OBTAINED
*                                                            @Y30LB50*/
*         CSFCNT=CSFCNT+1;          /* UP COUNT OF LOGS IN BLOCK
*                                                            @Y30LB50*/
         LA    @10,1                                            03S0195
         LH    @06,CSFCNT(,CSPTR)                               03S0195
         ALR   @06,@10                                          03S0195
         STH   @06,CSFCNT(,CSPTR)                               03S0195
*         FBFRCNT=FBFRCNT+1;        /* UP TOTAL COUNT OF ERROR  03S0196
*                                      BUFFERED LOGS SAVED   @Y30LB50*/
         AH    @10,FBFRCNT(,CSPTR)                              03S0196
         STH   @10,FBFRCNT(,CSPTR)                              03S0196
*         CSFDAY=DATE;              /* SAVE DAY FROM HEADER  @Y30LB50*/
         L     @10,NEXTCSF(,CSPTR)                              03S0197
         L     @06,LOGPTR(,LWORKPTR)                            03S0197
         MVC   CSFDAY(4,@10),DATE(@06)                          03S0197
*         CSFTIME=TIME;             /* SAVE TIME FROM HEADER @Y30LB50*/
         MVC   CSFTIME(4,@10),TIME(@06)                         03S0198
*         CSFMSC=ISDAMSCS;          /* SAVE MSC SENSE        @Y30LB50*/
         L     @06,SENSEPTR                                     03S0199
         MVC   CSFMSC(4,@10),ISDAMSCS(@06)                      03S0199
*         CSFREC=ISDAMSC3;          /* SAVE ERROR BUFFERED LOG DATA
*                                                            @Y30LB50*/
         MVC   CSFREC(28,@10),ISDAMSC3(@06)                     03S0200
*         STARTADR=CSFFIRST;        /* EARLIEST CSF RECORD   @Y30LB50*/
         MVC   STARTADR(4,LWORKPTR),CSFFIRST(CSPTR)             03S0201
*         CURRADR=NEXTCSF;          /* CURRENT RECORD        @Y30LB50*/
         ST    @10,CURRADR(,LWORKPTR)                           03S0202
*         CALL CSBSORT;             /* TIME MERGE CURRENT RECORD WITH
*                                      THOSE ALREADY SAVED   @Y30LB50*/
         BAL   @14,CSBSORT                                      03S0203
*         CSFFIRST=STARTADR;        /* UPDATE EARLIEST RECORD POINTER
*                                                            @Y30LB50*/
         MVC   CSFFIRST(4,CSPTR),STARTADR(LWORKPTR)             03S0204
*         RFY                                                   03S0205
*           LASTREC UNRSTD;         /*                       @Y30LB50*/
*         FRCDLOGS=NFORCED;         /* EXPECTED COUNT OF FORCED LOGS
*                                                            @Y30LB50*/
         MVC   FRCDLOGS(2,CSPTR),@CH00107                       03S0206
*       END;                        /*                       @Y30LB50*/
*     ELSE                                                      03S0208
*       ;                           /*                       @Y30LB50*/
@RF00193 DS    0H                                               03S0209
*   END;                            /*                       @Y30LB50*/
*     ELSE                                                      02S0210
*       ;                           /*                       @Y30LB50*/
@RF00185 DS    0H                                               02S0211
*   END;                            /*                       @Y30LB50*/
*               ELSE                                            01S0212
*                                                               02S0212
*   /*****************************************************************/
*   /*                                                               */
*   /* FSNSLOG IS CALLED TO ACUMULATE CS FORCED SENSE DATA. IF NONE  */
*   /* IS EXPECTED, THE INPUT IS IGNORED. IF A NEW BLOCK CANNOT BE   */
*   /* OBTAINED WHEN NEEDED. RETURN CODE WILL BE 4.          @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0212
*   DO;                             /*                       @Y30LB50*/
         B     @RC00134                                         02S0212
@RF00134 DS    0H                                               02S0213
*     IF CCSBCSF(7)=ON THEN                                     02S0213
         L     @10,LPARMPTR                                     02S0213
         TM    CCSBCSF(@10),B'00000010'                         02S0213
         BNO   @RF00213                                         02S0213
*       DO;                         /* PROCESS IF CSF IS REQUESTED
*                                                            @Y30LB50*/
*         IF FRCDLOGS^=0 THEN                                   02S0215
         ICM   @10,3,FRCDLOGS(CSPTR)                            02S0215
         BZ    @RF00215                                         02S0215
*           DO;                     /* PROCESS ONLY IF FORCED DATA IS
*                                      EXPECTED. FRCDLOGS IS COUNT
*                                      EXPECTED              @Y30LB50*/
*             RFY                                               02S0217
*               LASTREC RSTD;       /*                       @Y30LB50*/
*             LASTREC=NEXTCSF;      /* SAVE PTR TO LAST REC SAVED
*                                                            @Y30LB50*/
         L     @10,NEXTCSF(,CSPTR)                              02S0218
         LR    LASTREC,@10                                      02S0218
*             NEXTCSF=NEXTCSF+LENGTH(CSFDATA);/*                02S0219
*                                         UP PTR TO SAVE CURRENT REC
*                                                            @Y30LB50*/
         AH    @10,@CH00400                                     02S0219
         ST    @10,NEXTCSF(,CSPTR)                              02S0219
*             IF CSFCNT=BLOCKKNT THEN                           02S0220
         CLC   CSFCNT(2,CSPTR),@CH00237                         02S0220
         BNE   @RF00220                                         02S0220
*               CALL NEWCSF;        /* IF CURRENT BLOCK IS FULL THEN
*                                      GET A NEW BLOCK       @Y30LB50*/
         BAL   @14,NEWCSF                                       02S0221
*             ELSE                                              02S0222
*               ;                   /*                       @Y30LB50*/
@RF00220 DS    0H                                               02S0223
*             IF RETCODE=0 THEN                                 02S0223
         LTR   RETCODE,RETCODE                                  02S0223
         BNZ   @RF00223                                         02S0223
*               DO;                 /* CONTINUE IF BLOCK OBTAINED
*                                                            @Y30LB50*/
*                 CSFCNT=CSFCNT+1;  /* UP COUNT OF LOGS IN BLOCK
*                                                            @Y30LB50*/
         LA    @10,1                                            02S0225
         AH    @10,CSFCNT(,CSPTR)                               02S0225
         STH   @10,CSFCNT(,CSPTR)                               02S0225
*                 CSFDAY=DATE;      /* SAVE DATE FROM HEADER @Y30LB50*/
         L     @10,NEXTCSF(,CSPTR)                              02S0226
         L     @06,LOGPTR(,LWORKPTR)                            02S0226
         MVC   CSFDAY(4,@10),DATE(@06)                          02S0226
*                 CSFTIME=TIME;     /* SAVE TIME FROM HEADER @Y30LB50*/
         MVC   CSFTIME(4,@10),TIME(@06)                         02S0227
*                 CSFMSC=ISDAMSCS;  /* SAVE MSC SENSE        @Y30LB50*/
         L     @06,SENSEPTR                                     02S0228
         MVC   CSFMSC(4,@10),ISDAMSCS(@06)                      02S0228
*                 CSFREC=ISDAMSC3;  /* SAVE FORCED SENSE DATA   02S0229
*                                                            @Y30LB50*/
         MVC   CSFREC(28,@10),ISDAMSC3(@06)                     02S0229
*                 FRCDLOGS=FRCDLOGS-1;/* DECREMENT COUNT OF LOGS
*                                      STILL EXPECTED        @Y30LB50*/
         LH    @06,FRCDLOGS(,CSPTR)                             02S0230
         BCTR  @06,0                                            02S0230
         STH   @06,FRCDLOGS(,CSPTR)                             02S0230
*                 STARTADR=CSFFIRST;/* EARLIEST RECORD SAVED @Y30LB50*/
         MVC   STARTADR(4,LWORKPTR),CSFFIRST(CSPTR)             02S0231
*                 CURRADR=NEXTCSF;  /* CURRENT RECORD SAVED  @Y30LB50*/
         ST    @10,CURRADR(,LWORKPTR)                           02S0232
*                 CALL CSBSORT;     /* TIME MERGE CURRENT RECORD WITH
*                                      THOSE ALREADY SAVED   @Y30LB50*/
         BAL   @14,CSBSORT                                      02S0233
*                 CSFFIRST=STARTADR;/* UPDATE EARLIEST RECORD   02S0234
*                                                            @Y30LB50*/
         MVC   CSFFIRST(4,CSPTR),STARTADR(LWORKPTR)             02S0234
*                 RFY                                           02S0235
*                   LASTREC UNRSTD; /*                       @Y30LB50*/
*               END;                /*                       @Y30LB50*/
*             ELSE                                              02S0237
*               ;                   /*                       @Y30LB50*/
@RF00223 DS    0H                                               02S0238
*           END;                    /*                       @Y30LB50*/
*         ELSE                                                  02S0239
*           RETCODE=INVLDATA;       /* SET INVALID INPUT RET CODE
*                                                            @Y30LB50*/
         B     @RC00215                                         02S0239
@RF00215 LA    RETCODE,16                                       02S0239
*       END;                        /*                       @Y30LB50*/
*     ELSE                                                      02S0241
*       ;                           /*                       @Y30LB50*/
@RF00213 DS    0H                                               02S0242
*   END;                            /*                       @Y30LB50*/
*             END;                  /*                       @Y30LB50*/
*           ELSE                                                01S0244
*             ;                     /*                       @Y30LB50*/
@RF00132 DS    0H                                               01S0245
*           IF RETCODE=NOSPACE THEN /* IF ACCUMULATOR SPACE WAS NOT
*                                      AVAILABLE, RELEASE BLOCKS
*                                      ALREADY OBTAINED AND SHUT OFF
*                                      THE CSB AND CSF REPORTS  01S0245
*                                                            @Y30LB50*/
@RC00132 CH    RETCODE,@CH00107                                 01S0245
         BNE   @RF00245                                         01S0245
*                                                               02S0246
*   /*****************************************************************/
*   /*                                                               */
*   /* FREEBLKS IS USED TO FREE ALL ACCUMULATOR BLOCKS OBTAINED BY   */
*   /* ISDACSB0, THE WORKAREA OBTAINED BY ISDACSB0 AND THE WORKAREA  */
*   /* OBTAINED BY ISDACSB1                                  @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0246
*  DO;                              /*                       @Y30LB50*/
*   DO I=1 TO MAXCSS;               /* RELEASE ACCUMULATOR BLOCKS
*                                      OBTAINED FOR EACH CS TABLE
*                                                            @Y30LB50*/
         LA    @10,1                                            02S0247
         STH   @10,I(,LWORKPTR)                                 02S0247
@DL00247 DS    0H                                               02S0248
*     CSPTR=CSTPTRS(I);             /* POINT TO CS TABLE     @Y30LB50*/
         LH    @10,I(,LWORKPTR)                                 02S0248
         SLA   @10,2                                            02S0248
         L     CSPTR,CSTPTRS-4(@10,LWORKPTR)                    02S0248
*     CORELEN=LENGTH(CSBDATA)*BLOCKKNT+LENGTH(ISDAGHDR);/*      02S0249
*                                           LENGTH-CSB BLOCK @Y30LB50*/
         MVC   CORELEN(3,CVTPTR),@CF00404+1                     02S0249
*     SPNO=CSBSPNO;                 /* SUBPOOL NUMBER OF BLOCKS 02S0250
*                                                            @Y30LB50*/
         MVI   SPNO(CVTPTR),X'01'                               02S0250
*     DO WHILE ACCUM^=0;            /* RELEASE CSB BLOCKS    @Y30LB50*/
         B     @DE00251                                         02S0251
@DL00251 DS    0H                                               02S0252
*       RFY                                                     02S0252
*         ISDAGHDR BASED(ACCUM);    /*                       @Y30LB50*/
*       ACCMPTR=NEXTPTR;            /* BLOCK CURRENT BLOCK IS CHAINED
*                                      TO                    @Y30LB50*/
         L     @10,ACCUM(,CSPTR)                                02S0253
         MVC   ACCMPTR(4,CSPTR),NEXTPTR(@10)                    02S0253
*       RFY                                                     02S0254
*         R1 RSTD;                  /*                       @Y30LB50*/
*       R1=ADDR(WORKCALL);          /*                       @Y30LB50*/
         LA    R1,WORKCALL(,CVTPTR)                             02S0255
*       COREADDR=ACCUM;             /* ADDRESS TO FREE       @Y30LB50*/
         ST    @10,COREADDR(,CVTPTR)                            02S0256
*       CALL ISDAFREE;              /* FREE CURRENT BLOCK    @Y30LB50*/
         L     @15,@CV00370                                     02S0257
         BALR  @14,@15                                          02S0257
*       RFY                                                     02S0258
*         R1 UNRSTD;                /*                       @Y30LB50*/
*       ACCUM=ACCMPTR;              /* POINT TO NEXT BLOCK   @Y30LB50*/
         MVC   ACCUM(4,CSPTR),ACCMPTR(CSPTR)                    02S0259
*     END;                          /*                       @Y30LB50*/
@DE00251 ICM   @10,15,ACCUM(CSPTR)                              02S0260
         BNZ   @DL00251                                         02S0260
*     CORELEN=LENGTH(CSFDATA)*BLOCKKNT+LENGTH(ISDAGHDR);/*      02S0261
*                                           LENGTH-CSF BLOCK @Y30LB50*/
         MVC   CORELEN(3,CVTPTR),@CF00406+1                     02S0261
*     DO WHILE FACCUM^=0;           /* RELEASE CSF BLOCKS    @Y30LB50*/
         B     @DE00262                                         02S0262
@DL00262 DS    0H                                               02S0263
*       RFY                                                     02S0263
*         ISDAGHDR BASED(FACCUM);   /*                       @Y30LB50*/
*       FACCMPTR=NEXTPTR;           /* BLOCK CURRENT BLOCK IS CHAINED
*                                      TO                    @Y30LB50*/
         L     @10,FACCUM(,CSPTR)                               02S0264
         MVC   FACCMPTR(4,CSPTR),NEXTPTR(@10)                   02S0264
*       RFY                                                     02S0265
*         R1 RSTD;                  /*                       @Y30LB50*/
*       R1=ADDR(WORKCALL);          /*                       @Y30LB50*/
         LA    R1,WORKCALL(,CVTPTR)                             02S0266
*       COREADDR=FACCUM;            /* ADDR TO RELEASE       @Y30LB50*/
         ST    @10,COREADDR(,CVTPTR)                            02S0267
*       CALL ISDAFREE;              /* FREE CURRENT BLOCK    @Y30LB50*/
         L     @15,@CV00370                                     02S0268
         BALR  @14,@15                                          02S0268
*       RFY                                                     02S0269
*         R1 UNRSTD;                /*                       @Y30LB50*/
*       FACCUM=FACCMPTR;            /* NEXT BLOCK            @Y30LB50*/
         MVC   FACCUM(4,CSPTR),FACCMPTR(CSPTR)                  02S0270
*       RFY                                                     02S0271
*         ISDAGHDR BASED(GET0PTR);  /*                       @Y30LB50*/
*     END;                          /*                       @Y30LB50*/
@DE00262 ICM   @10,15,FACCUM(CSPTR)                             02S0272
         BNZ   @DL00262                                         02S0272
*   END;                            /*                       @Y30LB50*/
         LA    @10,1                                            02S0273
         AH    @10,I(,LWORKPTR)                                 02S0273
         STH   @10,I(,LWORKPTR)                                 02S0273
         CH    @10,@CH00107                                     02S0273
         BNH   @DL00247                                         02S0273
*   RFY                                                         02S0274
*     R1 RSTD;                      /*                       @Y30LB50*/
*   CCSBCSF='00'X;                  /* TURN OFF CONTROL FLAG FOR CSB,
*                                      CSF REPORTS           @Y30LB50*/
         L     @10,LPARMPTR                                     02S0275
         MVI   CCSBCSF(@10),X'00'                               02S0275
*   R1=ADDR(WORKCALL);              /*                       @Y30LB50*/
         LA    R1,WORKCALL(,CVTPTR)                             02S0276
*   CORELEN=LENGTH(CSBWORK)+MAXCSS*LENGTH(CSTBLS);/*            02S0277
*                                      LENGTH OF WORKAREA    @Y30LB50*/
         MVC   CORELEN(3,CVTPTR),@CF00402+1                     02S0277
*   SPNO=WORKSPNO;                  /* SUBPOOL NUMBER OF CSB WORKAREA
*                                                            @Y30LB50*/
         MVC   SPNO(1,CVTPTR),WORKSPNO                          02S0278
*   COREADDR=LWORKPTR;              /*                       @Y30LB50*/
         ST    LWORKPTR,COREADDR(,CVTPTR)                       02S0279
*   CALL ISDAFREE;                  /* FREE CSB0 WORKAREA    @Y30LB50*/
         L     @15,@CV00370                                     02S0280
         BALR  @14,@15                                          02S0280
*   RFY                                                         02S0281
*     R1 UNRSTD;                    /*                       @Y30LB50*/
*   CSB00PTR=0;                     /* ZERO ISDACSB0 WORKAREA ADDRESS
*                                                            @Y30LB50*/
         SLR   @10,@10                                          02S0282
         ST    @10,CSB00PTR(,CVTPTR)                            02S0282
*  END;                             /*                       @Y30LB50*/
*           ELSE                                                01S0284
*             ;                     /*                       @Y30LB50*/
@RF00245 DS    0H                                               01S0285
*         END;                      /*                       @Y30LB50*/
*       ELSE                                                    01S0286
*         ;                         /*                       @Y30LB50*/
@RF00070 DS    0H                                               01S0287
*     END;                          /*                       @Y30LB50*/
*   ELSE                                                        01S0288
*     ;                             /*                       @Y30LB50*/
@RF00066 DS    0H                                               01S0289
*   RETURN CODE(RETCODE);           /*                       @Y30LB50*/
         L     @13,4(,@13)                                      01S0289
         L     @00,@SIZDATD                                     01S0289
         LR    @01,@11                                          01S0289
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@03                                          01S0289
         L     @14,12(,@13)                                     01S0289
         LM    @00,@12,20(@13)                                  01S0289
         BR    @14                                              01S0289
*                                                               02S0290
*   /*****************************************************************/
*   /*                                                               */
*   /* NEWCSF IS CALLED TO OBTAIN AN ADDITIONAL ACCUMULATOR BLOCK FOR*/
*   /* CSF PROCESSING. RETURN CODE WILL BE 4 IF NO BLOCK IS          */
*   /* AVAILABLE.                                            @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0290
*NEWCSF:                                                        02S0290
*   PROC;                           /*                       @Y30LB50*/
@EL00001 L     @13,4(,@13)                                      02S0290
@EF00001 L     @00,@SIZDATD                                     02S0290
         LR    @01,@11                                          02S0290
         ISDAFSPC R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                  02S0290
         BR    @14                                              02S0290
NEWCSF   STM   @14,@12,@SA00002                                 02S0290
*   CORELEN=LENGTH(ISDAGHDR)+BLOCKKNT*LENGTH(CSFDATA);/*        02S0291
*                                         LENGTH OF ACCUMULATOR FOR
*                                      ISDAGET0 REQUESTS=LENGTH OF
*                                      HEADER PLUS LENGTH OF ONE LOG
*                                      SAVE TIMES NUMBER OF LOGS PER
*                                      BLOCK                 @Y30LB50*/
         MVC   CORELEN(3,CVTPTR),@CF00406+1                     02S0291
*   SPNO=CSBSPNO;                   /* SUBPOOL NUMBER FOR BLOCK 02S0292
*                                                            @Y30LB50*/
         MVI   SPNO(CVTPTR),X'01'                               02S0292
*   RFY                                                         02S0293
*     R1 RSTD;                      /*                       @Y30LB50*/
*   R1=ADDR(WORKCALL);              /*                       @Y30LB50*/
         LA    R1,WORKCALL(,CVTPTR)                             02S0294
*   CALL ISDAGET0;                  /* REQUEST BLOCK         @Y30LB50*/
         L     @15,@CV00368                                     02S0295
         BALR  @14,@15                                          02S0295
*   RFY                                                         02S0296
*     R15 RSTD;                     /*                       @Y30LB50*/
*   RETCODE=R15;                    /* SAVE RETURN CODE FROM ISDAGET0
*                                                            @Y30LB50*/
         LR    RETCODE,R15                                      02S0297
*   RFY                                                         02S0298
*    (R1,                                                       02S0298
*     R15) UNRSTD;                  /*                       @Y30LB50*/
*   IF RETCODE=0 THEN                                           02S0299
         SLR   @10,@10                                          02S0299
         CR    RETCODE,@10                                      02S0299
         BNE   @RF00299                                         02S0299
*     DO;                           /* INITIALIZE & CHAIN BLOCK IF
*                                      OBTAINED              @Y30LB50*/
*       RFY                                                     02S0301
*         GET0PTR RSTD;             /*                       @Y30LB50*/
*       GET0PTR=COREADDR;           /* SAVE ADDRESS OF BLOCK OBTAINED
*                                                            @Y30LB50*/
         L     GET0PTR,COREADDR(,CVTPTR)                        02S0302
*       LASTPTR=FACCMPTR;           /* BACKWARD CHAIN IN NEW BLOCK
*                                                            @Y30LB50*/
         L     @04,FACCMPTR(,CSPTR)                             02S0303
         ST    @04,LASTPTR(,GET0PTR)                            02S0303
*       BLOCKID='CSF';              /* BLOCK USER ID         @Y30LB50*/
         MVI   BLOCKID+3(GET0PTR),C' '                          02S0304
         MVC   BLOCKID(3,GET0PTR),@CC00383                      02S0304
*       CSFCNT=0;                   /* COUNT OF LOGS IN NEW BLOCK
*                                                            @Y30LB50*/
         STH   @10,CSFCNT(,CSPTR)                               02S0305
*       NEXTCSF=STARTPTR;           /* ADDR TO SAVE FIRST LOG IN
*                                      BLOCK                 @Y30LB50*/
         MVC   NEXTCSF(4,CSPTR),STARTPTR(GET0PTR)               02S0306
*       RFY                                                     02S0307
*         ISDAGHDR BASED(FACCMPTR); /*                       @Y30LB50*/
*       NEXTPTR=GET0PTR;            /* FORWARD CHAIN PREVIOUS BLOCK
*                                                            @Y30LB50*/
         ST    GET0PTR,NEXTPTR(,@04)                            02S0308
*       RFY                                                     02S0309
*         ISDAGHDR BASED(GET0PTR);  /*                       @Y30LB50*/
*       FACCMPTR=GET0PTR;           /* NEW CSF BLOCK FOR CS  @Y30LB50*/
         ST    GET0PTR,FACCMPTR(,CSPTR)                         02S0310
*       RFY                                                     02S0311
*         GET0PTR UNRSTD;           /*                       @Y30LB50*/
*     END;                          /*                       @Y30LB50*/
*   ELSE                                                        02S0313
*     ;                             /*                       @Y30LB50*/
@RF00299 DS    0H                                               02S0314
*   END NEWCSF;                                                 02S0314
@EL00002 DS    0H                                               02S0314
@EF00002 DS    0H                                               02S0314
@ER00002 LM    @14,@12,@SA00002                                 02S0314
         BR    @14                                              02S0314
*                                                               02S0315
*   /*****************************************************************/
*   /*                                                               */
*   /* CSBSORT IS CALLED TO SORT BUFFERED LOG INPUT AND FORCED LOG   */
*   /* INPUT BY DAY AND TIME. THE LOG RECORDS WILL BE SAVED IN THE   */
*   /* ORDER THEY ARE RECEIVED BUT EACH RECORD WILL CONTAIN A CHAIN  */
*   /* POINTER TO ANOTHER RECORD INDICATING THE ORDER OF RECORDS BY  */
*   /* TIME                                                  @Y30LB50*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0315
*CSBSORT:                                                       02S0315
*   PROC;                           /*                       @Y30LB50*/
CSBSORT  STM   @14,@12,12(@13)                                  02S0315
*   RFY                                                         02S0316
*     LASTREC RSTD;                 /*                       @Y30LB50*/
*   NRECORD=STARTADR;               /* POINTER TO EARLIEST RECORD
*                                                            @Y30LB50*/
         L     @10,STARTADR(,LWORKPTR)                          02S0317
         ST    @10,NRECORD(,LWORKPTR)                           02S0317
*   IF NRECORD=CURRADR THEN                                     02S0318
         L     @06,CURRADR(,LWORKPTR)                           02S0318
         CR    @10,@06                                          02S0318
         BNE   @RF00318                                         02S0318
*     CURRADR->CHAINPTR=0;          /* IF FIRST RECORD FOR THIS CS DO
*                                      NOT TIME SORT         @Y30LB50*/
         SLR   @10,@10                                          02S0319
         ST    @10,CHAINPTR(,@06)                               02S0319
*   ELSE                                                        02S0320
*     DO;                           /*                       @Y30LB50*/
         B     @RC00318                                         02S0320
@RF00318 DS    0H                                               02S0321
*       PRECORD=LASTREC->CHAINPTR;  /* PTR TO REC PREVIOUS RECORD WAS
*                                      CHAINED TO            @Y30LB50*/
         L     @10,CHAINPTR(,LASTREC)                           02S0321
         ST    @10,PRECORD(,LWORKPTR)                           02S0321
*       IF(CURRADR->DAYTIME>LASTREC->DAYTIME)&((PRECORD=0)×(PRECORD->
*           DAYTIME>CURRADR->DAYTIME)) THEN                     02S0322
         L     @06,CURRADR(,LWORKPTR)                           02S0322
         CLC   DAYTIME(8,@06),DAYTIME(LASTREC)                  02S0322
         BNH   @RF00322                                         02S0322
         LTR   @10,@10                                          02S0322
         BZ    @RT00322                                         02S0322
         CLC   DAYTIME(8,@10),DAYTIME(@06)                      02S0322
         BNH   @RF00322                                         02S0322
@RT00322 DS    0H                                               02S0323
*         DO;                       /* IF LAST RECORD SAVED WAS THE
*                                      LATEST RECORD BY TIME OR IF
*                                      THE CURRENT RECORD FALLS 02S0323
*                                      BETWEEN IT AND THE RECORD IT
*                                      IS CHAINED TO, RECHAIN THE
*                                      PREVIOUS RECORD TO THE CURRENT
*                                      RECORD AND THE CURRENT RECORD
*                                      TO THE ONE THE PREVIOUS RECORD
*                                      WAS CHAINED TO        @Y30LB50*/
*           CURRADR->CHAINPTR=LASTREC->CHAINPTR;/*           @Y30LB50*/
         L     @10,CURRADR(,LWORKPTR)                           02S0324
         MVC   CHAINPTR(4,@10),CHAINPTR(LASTREC)                02S0324
*           LASTREC->CHAINPTR=CURRADR;/*                     @Y30LB50*/
         ST    @10,CHAINPTR(,LASTREC)                           02S0325
*         END;                      /*                       @Y30LB50*/
*       ELSE                                                    02S0327
*   DO;                             /*                       @Y30LB50*/
         B     @RC00322                                         03S0327
@RF00322 DS    0H                                               03S0328
*     DO WHILE(NRECORD->DAYTIME^>CURRADR->DAYTIME)&(NRECORD->CHAINPTR^=
*           0);                     /* LOOP UNTIL A RECORD IS FOUND
*                                      WHOSE TIME IS GREATER THAN THE
*                                      CURRENT INPUT OR UNTIL ALL
*                                      RECORDS SAVED HAVE BEEN  03S0328
*                                      SEARCHED. THE LAST RECORD WILL
*                                      HAVE A CHAIN POINTER OF 0
*                                                            @Y30LB50*/
         B     @DE00328                                         03S0328
@DL00328 DS    0H                                               03S0329
*       PRECORD=NRECORD;            /* SAVE PREVIOUS RECORD POINTER
*                                                            @Y30LB50*/
         L     @10,NRECORD(,LWORKPTR)                           03S0329
         ST    @10,PRECORD(,LWORKPTR)                           03S0329
*       NRECORD=NRECORD->CHAINPTR;  /* POINT TO NEXT RECORD BY TIME
*                                                            @Y30LB50*/
         L     @10,CHAINPTR(,@10)                               03S0330
         ST    @10,NRECORD(,LWORKPTR)                           03S0330
*     END;                          /*                       @Y30LB50*/
@DE00328 L     @10,NRECORD(,LWORKPTR)                           03S0331
         L     @06,CURRADR(,LWORKPTR)                           03S0331
         CLC   DAYTIME(8,@10),DAYTIME(@06)                      03S0331
         BH    @DC00328                                         03S0331
         ICM   @06,15,CHAINPTR(@10)                             03S0331
         BNZ   @DL00328                                         03S0331
@DC00328 DS    0H                                               03S0332
*     IF NRECORD->DAYTIME>CURRADR->DAYTIME THEN                 03S0332
         L     @10,NRECORD(,LWORKPTR)                           03S0332
         L     @06,CURRADR(,LWORKPTR)                           03S0332
         CLC   DAYTIME(8,@10),DAYTIME(@06)                      03S0332
         BNH   @RF00332                                         03S0332
*       DO;                         /* IF A RECORD WAS FOUND WHOSE
*                                      TIME WAS GREATER THAN THAT OF
*                                      THE INPUT             @Y30LB50*/
*         IF STARTADR^=NRECORD THEN                             03S0334
         C     @10,STARTADR(,LWORKPTR)                          03S0334
         BE    @RF00334                                         03S0334
*           PRECORD->CHAINPTR=CURRADR;/* IF IT IS NOT THE EARLIEST
*                                      TIME TAGGED RECORD THEN ,
*                                      UNHOOK THE PREVIOUS CHAIN
*                                      POINTER TO THAT RECORD AND
*                                      POINT IT INSTEAD TO THE  03S0335
*                                      CURRENT INPUT RECORD. @Y30LB50*/
         L     @10,PRECORD(,LWORKPTR)                           03S0335
         ST    @06,CHAINPTR(,@10)                               03S0335
*         ELSE                                                  03S0336
*           STARTADR=CURRADR;       /* IF RECORD FOUND IS EARLIEST
*                                      TIME TAGGED RECORD, RESET THE
*                                      EARLIEST TIME TAGGED RECORD
*                                      POINTER TO THE CURRENT RECORD
*                                                            @Y30LB50*/
         B     @RC00334                                         03S0336
@RF00334 MVC   STARTADR(4,LWORKPTR),CURRADR(LWORKPTR)           03S0336
*         CURRADR->CHAINPTR=NRECORD;/* ALSO, POINT THE CURRENT RECORD
*                                      TO THE RECORD WITH THE GREATER
*                                      TIME                  @Y30LB50*/
@RC00334 L     @10,CURRADR(,LWORKPTR)                           03S0337
         MVC   CHAINPTR(4,@10),NRECORD(LWORKPTR)                03S0337
*       END;                        /*                       @Y30LB50*/
*     ELSE                                                      03S0339
*       DO;                         /* ALL SAVED RECORDS WERE   03S0339
*                                      SEARCHED AND NO TIME GREATER
*                                      THAN THE CURRENT INPUT WAS
*                                      FOUND. POINT THE LAST RECORD
*                                      SAVED BY TIME TO THE CURRENT
*                                      INPUT RECORD AND POINT THE
*                                      CURRENT RECORD TO 0   @Y30LB50*/
         B     @RC00332                                         03S0339
@RF00332 DS    0H                                               03S0340
*         NRECORD->CHAINPTR=CURRADR;/*                       @Y30LB50*/
         L     @10,NRECORD(,LWORKPTR)                           03S0340
         L     @06,CURRADR(,LWORKPTR)                           03S0340
         ST    @06,CHAINPTR(,@10)                               03S0340
*         CURRADR->CHAINPTR=0;      /*                       @Y30LB50*/
         SLR   @10,@10                                          03S0341
         ST    @10,CHAINPTR(,@06)                               03S0341
*       END;                        /*                       @Y30LB50*/
*   END;                            /*                       @Y30LB50*/
*     END;                          /*                       @Y30LB50*/
*   RFY                                                         02S0345
*     LASTREC UNRSTD;               /*                       @Y30LB50*/
*   END CSBSORT;                    /*                       @Y30LB50*/
@EL00003 DS    0H                                               02S0346
@EF00003 DS    0H                                               02S0346
@ER00003 LM    @14,@12,12(@13)                                  02S0346
         BR    @14                                              02S0346
*   END ISDACSB0                    /*                       @Y30LB50*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDASOBR)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSC3)                                        *
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        *
*/*%INCLUDE SYSLIB  (ISDACSB5)                                        *
*/*%INCLUDE SYSUT5  (MSCFMT3B)                                        *
*/*%INCLUDE SYSUT5  (CSB0CNST)                                        *
*/*%INCLUDE SYSUT5  (CSBINIT )                                        *
*/*%INCLUDE SYSUT5  (CSCHK   )                                        *
*/*%INCLUDE SYSUT5  (FIRSTCSB)                                        *
*/*%INCLUDE SYSUT5  (FIRSTCSF)                                        *
*/*%INCLUDE SYSUT5  (BFRLOG  )                                        *
*/*%INCLUDE SYSUT5  (USAGELOG)                                        *
*/*%INCLUDE SYSUT5  (NEWCSB  )                                        *
*/*%INCLUDE SYSUT5  (ERRORLOG)                                        *
*/*%INCLUDE SYSUT5  (FSNSLOG )                                        *
*/*%INCLUDE SYSUT5  (FREEBLKS)                                        *
*/*%INCLUDE SYSUT5  (NEWCSF  )                                        *
*/*%INCLUDE SYSUT5  (CSBSORT )                                        *
*/*%INCLUDE SYSUT5  (TIMESORT)                                        *
*;                                                              01S0347
@DATA    DS    0H
@CH00107 DC    H'4'
@CH00237 DC    H'23'
@CH00097 DC    H'40'
@CH00400 DC    H'44'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    0F
         DS    15F
ISDACSB0 CSECT
         DS    0F
@CF00402 DC    F'288'
@CF00404 DC    F'948'
@CF00406 DC    F'1040'
@DATD    DSECT
         DS    0D
SENSEPTR DS    A
LPARMPTR DS    A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDACSB0 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00368 DC    V(ISDAGET0)
@CV00369 DC    V(ISDAGET1)
@CV00370 DC    V(ISDAFREE)
         DS    0D
@CC00381 DC    C'CSB'
@CC00383 DC    C'CSF'
WORKSPNO DC    X'00'
PATCH    DS    CL50
         ORG   PATCH
@NM00009 DC    50X'00'
         ORG   PATCH+50
CSMASK   DC    X'00F0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CVTPTR   EQU   @02
GET0PTR  EQU   @05
RETCODE  EQU   @03
R15      EQU   @15
R1       EQU   @01
LWORKPTR EQU   @09
CSPTR    EQU   @08
LASTREC  EQU   @07
R0       EQU   @00
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
DATAPTR  EQU   CVTPTRS0
SDATAPTR EQU   CVTPTRS0+4
PARMPTR  EQU   CVTPTRS0+8
CSB00PTR EQU   CVTPTRS0+68
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
OBRMDR   EQU   0
SCW      EQU   OBRMDR
SWITCHES EQU   OBRMDR+6
DATETIME EQU   OBRMDR+12
DATE     EQU   DATETIME
TIME     EQU   DATETIME+4
CPUSERID EQU   OBRMDR+21
ISDAMSCS EQU   0
SUBSYSID EQU   ISDAMSCS+1
SSID     EQU   SUBSYSID
SUBSENSE EQU   ISDAMSCS+4
SUBFMTMG EQU   SUBSENSE+7
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CCSBCSF  EQU   CREPORTS+7
ISDAMSC3 EQU   4
FSCACC1  EQU   ISDAMSC3+4
FSCACC2  EQU   ISDAMSC3+8
ISDAGHDR EQU   0
STARTPTR EQU   ISDAGHDR
GET0SPLN EQU   ISDAGHDR+8
NEXTPTR  EQU   ISDAGHDR+12
LASTPTR  EQU   ISDAGHDR+16
BLOCKID  EQU   ISDAGHDR+20
CSTBLS   EQU   0
BFRCNT   EQU   CSTBLS
FBFRCNT  EQU   CSTBLS+2
ACCUM    EQU   CSTBLS+4
ACCMPTR  EQU   CSTBLS+8
NEXTCSB  EQU   CSTBLS+12
CSBCNT   EQU   CSTBLS+16
FRCDLOGS EQU   CSTBLS+18
CSBFIRST EQU   CSTBLS+20
FACCUM   EQU   CSTBLS+24
FACCMPTR EQU   CSTBLS+28
NEXTCSF  EQU   CSTBLS+32
CSFFIRST EQU   CSTBLS+36
CSFCNT   EQU   CSTBLS+40
CSNUMB   EQU   CSTBLS+42
CSBDATA  EQU   0
CHAINPTR EQU   CSBDATA
DAYTIME  EQU   CSBDATA+4
CSBDAY   EQU   DAYTIME
CSBTIME  EQU   DAYTIME+4
CSBMSC   EQU   CSBDATA+12
CSBREC   EQU   CSBDATA+16
CSFDATA  EQU   0
CSFDTIM  EQU   CSFDATA+4
CSFDAY   EQU   CSFDTIM
CSFTIME  EQU   CSFDTIM+4
CSFMSC   EQU   CSFDATA+12
CSFREC   EQU   CSFDATA+16
CSFSNS2  EQU   CSFREC+1
CSBWORK  EQU   0
LOGPTR   EQU   CSBWORK
NRECORD  EQU   CSBWORK+4
PRECORD  EQU   CSBWORK+8
STARTADR EQU   CSBWORK+12
CURRADR  EQU   CSBWORK+16
CSTPTRS  EQU   CSBWORK+20
NBRWORK  EQU   CSBWORK+36
I        EQU   CSBWORK+38
HOLDDBL  EQU   CSBWORK+86
HOLD2    EQU   HOLDDBL+4
KWORK    EQU   CSBWORK+94
MSCFMT3B EQU   4
CSSNS0   EQU   MSCFMT3B
ENVIRDAT EQU   CSSNS0
CSSNS1   EQU   MSCFMT3B+1
RECONFIG EQU   CSSNS1
BFRBIT   EQU   CSSNS1
USAGECT1 EQU   MSCFMT3B+2
ERROVFL1 EQU   USAGECT1
USAGECT2 EQU   MSCFMT3B+13
WORKPTR  EQU   0
*                                      START UNREFERENCED COMPONENTS
@NM00010 EQU   MSCFMT3B+24
YSTRIP2  EQU   MSCFMT3B+23
XSTRIP2  EQU   MSCFMT3B+22
XYSTRIP2 EQU   MSCFMT3B+21
SEQCNT2  EQU   MSCFMT3B+20
GAPSWIV2 EQU   MSCFMT3B+19
XDUCER2  EQU   MSCFMT3B+18
ADDRCHK2 EQU   MSCFMT3B+17
TIMEOUT2 EQU   MSCFMT3B+16
SELRST2  EQU   MSCFMT3B+15
UCOUNT2  EQU   USAGECT2
USPARE2  EQU   USAGECT2
YSTRIP1  EQU   MSCFMT3B+12
XSTRIP1  EQU   MSCFMT3B+11
XYSTRIP1 EQU   MSCFMT3B+10
SEQCNT1  EQU   MSCFMT3B+9
GAPSWIV1 EQU   MSCFMT3B+8
XDUCER1  EQU   MSCFMT3B+7
ADDRCHK1 EQU   MSCFMT3B+6
TIMEOUT1 EQU   MSCFMT3B+5
SELRST1  EQU   MSCFMT3B+4
UCOUNT1  EQU   USAGECT1
USPARE   EQU   USAGECT1
CSPARE1  EQU   CSSNS1
CSPARE   EQU   CSSNS1
CSPARE0  EQU   CSSNS0
FILLXX   EQU   CSBWORK+110
M        EQU   CSBWORK+108
L        EQU   CSBWORK+106
K        EQU   CSBWORK+104
J        EQU   CSBWORK+102
GINDEX   EQU   CSBWORK+100
REMNDR   EQU   CSBWORK+98
GROUPS   EQU   CSBWORK+96
CWORK    EQU   KWORK
HOLD     EQU   HOLD2+1
HOLD1    EQU   HOLD2
HOLD0    EQU   HOLDDBL
PAGECNT  EQU   CSBWORK+84
ACCTOT   EQU   CSBWORK+82
CNTINDX  EQU   CSBWORK+80
BRETCODE EQU   CSBWORK+78
FRETCODE EQU   CSBWORK+76
SUMS     EQU   CSBWORK+52
SUMY     EQU   CSBWORK+48
SUMX     EQU   CSBWORK+44
SUMU     EQU   CSBWORK+40
CSFBYTES EQU   CSFREC+2
CSFBFRBT EQU   CSFSNS2
CSFBITS  EQU   CSFSNS2
CSFSNS1  EQU   CSFREC
CSFCHAIN EQU   CSFDATA
CSB1CNTS EQU   CSBREC+2
CSBSNSBY EQU   CSBREC
CSBHSEC  EQU   CSBTIME+3
CSBSEC   EQU   CSBTIME+2
CSBMIN   EQU   CSBTIME+1
CSBHR    EQU   CSBTIME
CSBDATE  EQU   CSBDAY+2
CSBYR    EQU   CSBDAY
FILL2    EQU   CSTBLS+43
@NM00008 EQU   ISDAGHDR+26
BLOCKCNT EQU   ISDAGHDR+24
GET0LEN  EQU   GET0SPLN+1
GET0SPNO EQU   GET0SPLN
ENDPTR   EQU   ISDAGHDR+4
@NM00007 EQU   ISDAMSC3+16
IREGS3F3 EQU   ISDAMSC3+15
IREGS2F3 EQU   ISDAMSC3+14
IREGS1F3 EQU   ISDAMSC3+13
MISCF3   EQU   ISDAMSC3+12
SHIFT2F3 EQU   FSCACC2+3
PCHKACC2 EQU   FSCACC2+2
FAULT2F3 EQU   FSCACC2+1
MCHKACC2 EQU   FSCACC2
SHIFT1F3 EQU   FSCACC1+3
PCHKACC1 EQU   FSCACC1+2
FAULT1F3 EQU   FSCACC1+1
MCHKACC1 EQU   FSCACC1
QUEUE3   EQU   ISDAMSC3+3
MOVES12  EQU   ISDAMSC3+2
RECOVER3 EQU   ISDAMSC3+1
STATUS3  EQU   ISDAMSC3
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CDHEDHU  EQU   CREPORTS+3
CSUM     EQU   CREPORTS+2
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00006 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00005 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
SANOMSCD EQU   SUBSENSE+27
RCYLMSCD EQU   SUBSENSE+25
RUAMSCD  EQU   SUBSENSE+24
MSCFSC   EQU   SUBSENSE+22
@NM00004 EQU   SUBSENSE+21
RUADASD  EQU   SUBSENSE+20
DASDFSC  EQU   SUBSENSE+18
@NM00003 EQU   SUBSENSE+8
MSGCODEN EQU   SUBFMTMG
SUBFMTNO EQU   SUBFMTMG
SALOWAD2 EQU   SUBSENSE+6
SARETRY  EQU   SUBSENSE+5
@NM00002 EQU   SUBSENSE+4
DASDFMTN EQU   SUBSENSE+3
SALOWADD EQU   SUBSENSE+2
SUBSTAT5 EQU   SUBSENSE+1
SUBSTAT4 EQU   SUBSENSE
FORMATNO EQU   ISDAMSCS+3
SSIDDEVT EQU   SSID+1
SSIDLIBN EQU   SSID+1
SSIDTYPE EQU   SSID
SSIDFLAG EQU   SUBSYSID
STATUS   EQU   ISDAMSCS
CPUID    EQU   CPUSERID+3
CPUSER   EQU   CPUSERID
VERNO    EQU   OBRMDR+20
TENSHUND EQU   TIME+3
SECOND   EQU   TIME+2
MINUTE   EQU   TIME+1
HOUR     EQU   TIME
DAY      EQU   DATE+2
YEAR     EQU   DATE
RECENTRY EQU   OBRMDR+11
RCDCNT   EQU   OBRMDR+10
SWITCH3  EQU   SWITCHES+3
SWITCH2  EQU   SWITCHES+2
SWITCH1  EQU   SWITCHES+1
SWITCH0  EQU   SWITCHES
SYSREL   EQU   OBRMDR+5
CLASRC   EQU   OBRMDR+4
@NM00001 EQU   SCW+3
SCODE    EQU   SCW+2
SLENGTH  EQU   SCW
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
LINE     EQU   OUTLINE+1
ANSI     EQU   OUTLINE
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
GEN00PTR EQU   CVTPTRS0+92
CNFG0PTR EQU   CVTPTRS0+88
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDA00PTR EQU   CVTPTRS0+12
*                                      END UNREFERENCED COMPONENTS
@RC00051 EQU   @RC00041
@RC00134 EQU   @RC00132
@RC00213 EQU   @RC00132
@RC00318 EQU   @EL00003
@RC00322 EQU   @EL00003
@RC00332 EQU   @EL00003
@RC00215 EQU   @RC00213
@ENDDATA EQU   *
         END   ISDACSB0,(C'PLS2219',0603,75312)

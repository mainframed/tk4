         TITLE 'ISDAPARM SDA PARAMETER PROCESSOR                       *
                        '
ISDAPARM CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(8)                                              0001
         DC    C'ISDAPARM'                                         0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @12,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@12                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @10,@01                                             0001
         USING @DATD,@10                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @10,8(,@13)                                         0001
         LR    @13,@10                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0069
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL LINKAGE                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0069
*   CVTPTR=WORKPTR;                 /* BASE FOR SDA CVT      @Y30LB54*/
         L     @15,@PC00001                                        0069
         L     CVTPTR,WORKPTR(,@15)                                0069
*   LPARMPTR=PARMPTR;               /* GETMAIN AREA BASE FOR PARMS 0070
*                                                            @Y30LB54*/
         MVC   LPARMPTR(4),PARMPTR(CVTPTR)                         0070
*   ANSI=' ';                       /* SET CARRIAGE CONTROL CHAR   0071
*                                                            @Y30LB54*/
*                                                                  0071
         MVI   ANSI(CVTPTR),C' '                                   0071
*   /*****************************************************************/
*   /*                                                               */
*   /* HOUSEKEEPING AND INITIALIZATION                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0072
*   LINE='ISDAPARM ENTER PARAMETERS AT THIS POINT';/*        @Y30LB54*/
         MVI   LINE+39(CVTPTR),C' '                                0072
         MVC   LINE+40(92,CVTPTR),LINE+39(CVTPTR)                  0072
         MVC   LINE(39,CVTPTR),@CC00348                            0072
*   CALL ISDATYPE(WORKPTR);         /*                       @Y30LB54*/
         L     @03,@PC00001                                        0073
         ST    @03,@AL00001                                        0073
         L     @15,@CV00038                                        0073
         LA    @01,@AL00001                                        0073
         BALR  @14,@15                                             0073
*   WORKBUF=' ';                    /* CLEAR AREA OF COMPRESSED SYSIN
*                                                            @Y30LB54*/
         MVI   WORKBUF+1,C' '                                      0074
         MVC   WORKBUF+2(198),WORKBUF+1                            0074
         MVI   WORKBUF,C' '                                        0074
*   CHARL=0;                        /* USED BY SCAN1         @Y30LB54*/
         SLR   @03,@03                                             0075
         ST    @03,CHARL                                           0075
*   CHAR1=0;                        /* USED BY SCAN1         @Y30LB54*/
         SLR   @03,@03                                             0076
         ST    @03,CHAR1                                           0076
*   INPTR=ADDR(WORKBUF);            /* USED FOR DURATION OF PGM    0077
*                                                            @Y30LB54*/
         LA    @03,WORKBUF                                         0077
         ST    @03,INPTR                                           0077
*   INPTR1=ADDR(WORKBUF)+200;       /* USED FOR DURATION     @Y30LB54*/
         LA    @03,WORKBUF                                         0078
         AH    @03,@CH00327                                        0078
         ST    @03,INPTR1                                          0078
*   INPUT=INPUT&&INPUT;             /* CLEAR PROCESSING AREA @Y30LB54*/
         L     @03,INPTR                                           0079
         XC    INPUT(200,@03),INPUT(@03)                           0079
*   ENDTXT=0;                       /* USED CARDIN,SCAN1     @Y30LB54*/
         SLR   @03,@03                                             0080
         ST    @03,ENDTXT                                          0080
*   STARTTXT=0;                     /* USED CARDIN,SCAN1     @Y30LB54*/
         SLR   @03,@03                                             0081
         ST    @03,STARTTXT                                        0081
*   FULLWD2=0;                      /* WORKING REGISTER      @Y30LB54*/
         SLR   @03,@03                                             0082
         ST    @03,FULLWD2                                         0082
*   RETCODE=0;                      /*                       @Y30LB54*/
         SLR   @03,@03                                             0083
         ST    @03,RETCODE                                         0083
*   RETCODE1=0;                     /*                       @Y30LB54*/
         SLR   @03,@03                                             0084
         ST    @03,RETCODE1                                        0084
*   ENDPRM=0;                       /* OUPUT SCAN1           @Y30LB54*/
         SLR   @03,@03                                             0085
         ST    @03,ENDPRM                                          0085
*   STARTPRM=0;                     /* OUTPUT SCAN1          @Y30LB54*/
         SLR   @03,@03                                             0086
         ST    @03,STARTPRM                                        0086
*   STARTINP=0;                     /* USED CARDIN,SCAN1     @Y30LB54*/
         SLR   @03,@03                                             0087
         ST    @03,STARTINP                                        0087
*   ENDINP=0;                       /* USED CARDIN,SCAN1     @Y30LB54*/
         SLR   @03,@03                                             0088
         ST    @03,ENDINP                                          0088
*   SYSINDCB(1:96)=DCBSTAT(1:96);   /* OBTAIN GOOD COPY OF DCB IN  0089
*                                      POOL 0                @Y30LB54*/
         MVC   SYSINDCB(96),DCBSTAT                                0089
*   OPENLIST=OPENSTAT;              /* OBTAIN GOOD COPY OF OPEN LIST
*                                      IN POOL 0             @Y30LB54*/
         MVC   OPENLIST(4),OPENSTAT                                0090
*   CLOSLIST=CLOSSTAT;              /* OBTAIN GOOD COPY OF CLOSE LIST
*                                      IN POOL 0             @Y30LB54*/
*                                                                  0091
         MVC   CLOSLIST(4),CLOSSTAT                                0091
*   /*****************************************************************/
*   /*                                                               */
*   /* LOGIC TO INSURE CORRECT TEMPLATE DEFAULTS TAKEN               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0092
*   ISDAPRMS=SDAPARM0;              /* MOVE DEFAULTS TO GETMAIN AREA
*                                                            @Y30LB54*/
*                                                                  0092
         L     @03,LPARMPTR                                        0092
         MVC   ISDAPRMS(49,@03),SDAPARM0                           0092
*   /*****************************************************************/
*   /*                                                               */
*   /* MAIN LOGIC DISPATCHER                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0093
*/*FILL WORKING BUFFER WITH COMPRESSED SYSIN                 @Y30LB54*/
*                                                                  0093
*   CALL CARDIN;                    /* PROCESS THE SYSIN STREAM    0093
*                                                            @Y30LB54*/
         BAL   @14,CARDIN                                          0093
*/*OUTPUT OF CARDIN IS INPTR1,AND INPTR ADDRESSES OF BOUNDRIES     0094
*                                                            @Y30LB54*/
*/*OF WORKING BUFFER FILLED IN WITH ALL COMPRESSES SYSIN     @Y30LB54*/
*/*STARTINP AND ENDINP ARE COUNTERS USED TO KEEP TRACK OF    @Y30LB54*/
*/*WORKING BUFFER BUT ARE NOT PASSED TO ANY OTHER PROCESSOR  @Y30LB54*/
*/*STARTTXT AND ENDTXT KEEP TRACK OF INDIVIDUAL CARD LIMITS  @Y30LB54*/
*/*BUT ARE NOT PASSED TO ANY OTHER PROCESSOR                 @Y30LB54*/
*                                                                  0094
*   IF RETCODE^=0 THEN                                             0094
         ICM   @03,15,RETCODE                                      0094
         BZ    @RF00094                                            0094
*     RETURN CODE(RETCODE);         /* OTHER THAN EOF ON SYSIN     0095
*                                                            @Y30LB54*/
         L     @03,RETCODE                                         0095
         L     @13,4(,@13)                                         0095
         L     @00,@SIZDATD                                        0095
         LR    @01,@10                                             0095
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@03                                             0095
         L     @14,12(,@13)                                        0095
         LM    @00,@12,20(@13)                                     0095
         BR    @14                                                 0095
*   ELSE                                                           0096
*     DO;                           /*                       @Y30LB54*/
@RF00094 DS    0H                                                  0097
*       IF INPUT(ONE:FOUR)=0 THEN                                  0097
         L     @03,INPTR                                           0097
         ICM   @15,15,INPUT(@03)                                   0097
         BZ    @RT00097                                            0097
*         ;                         /*                       @Y30LB54*/
*       ELSE                                                       0099
*         CALL EMPTYIT;             /* PROCESS DATA          @Y30LB54*/
         BAL   @14,EMPTYIT                                         0099
*     END;                          /*                       @Y30LB54*/
*                                                                  0100
@RT00097 DS    0H                                                  0101
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS JCL INPUT PARMS INTO WORK BUFFER                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0101
*   CALL JCLIN;                     /* PROCESS THE JCL PARAMETERS  0101
*                                                            @Y30LB54*/
         BAL   @14,JCLIN                                           0101
*   IF INPUT(ONE:FOUR)=0 THEN                                      0102
         L     @03,INPTR                                           0102
         ICM   @15,15,INPUT(@03)                                   0102
         BZ    @RT00102                                            0102
*     ;                             /*                       @Y30LB54*/
*   ELSE                                                           0104
*     CALL EMPTYIT;                 /* PROCESS DATA          @Y30LB54*/
         BAL   @14,EMPTYIT                                         0104
*                                                                  0105
*   /*****************************************************************/
*   /*                                                               */
*   /* FOURTH PRIORITY SPECIAL PROCESSING                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0105
*   IF CDETAIL^=0 THEN                                             0105
@RT00102 L     @03,LPARMPTR                                        0105
         CLI   CDETAIL(@03),0                                      0105
         BE    @RF00105                                            0105
*     CSUM=CSUM×'02'X;              /* TELL SUMMARY DETAIL WAS FILLED
*                                      IN                    @Y30LB54*/
         L     @03,LPARMPTR                                        0106
         OI    CSUM(@03),X'02'                                     0106
*   ELSE                                                           0107
*     CSUM=CSUM&'FD'X;              /* TURN OFF CSUM DETAIL PORTION
*                                                            @Y30LB54*/
         B     @RC00105                                            0107
@RF00105 L     @03,LPARMPTR                                        0107
         NI    CSUM(@03),X'FD'                                     0107
*   IF CSUM^=0 THEN                                                0108
@RC00105 L     @03,LPARMPTR                                        0108
         CLI   CSUM(@03),0                                         0108
         BE    @RF00108                                            0108
*     CGEN=CGEN×'01'X;              /* CALL FSC GENERATOR    @Y30LB54*/
         L     @03,LPARMPTR                                        0109
         OI    CGEN(@03),X'01'                                     0109
*   ELSE                                                           0110
*     ;                             /*                       @Y30LB54*/
@RF00108 DS    0H                                                  0111
*   IF CFSC^=0 THEN                                                0111
         L     @03,LPARMPTR                                        0111
         CLI   CFSC(@03),0                                         0111
         BE    @RF00111                                            0111
*     CGEN=CGEN×'02'X;              /* CALL FSC GENERATOR    @Y30LB54*/
         L     @03,LPARMPTR                                        0112
         OI    CGEN(@03),X'02'                                     0112
*   ELSE                                                           0113
*     ;                             /*                       @Y30LB54*/
@RF00111 DS    0H                                                  0114
*   IF CEQC^=0 THEN                                                0114
         L     @03,LPARMPTR                                        0114
         CLI   CEQC(@03),0                                         0114
         BE    @RF00114                                            0114
*     CGEN=CGEN×'04'X;              /* CALL FSC GENERATOR    @Y30LB54*/
         L     @03,LPARMPTR                                        0115
         OI    CGEN(@03),X'04'                                     0115
*   ELSE                                                           0116
*     ;                             /*                       @Y30LB54*/
@RF00114 DS    0H                                                  0117
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/
         L     @03,RETCODE                                         0117
         L     @13,4(,@13)                                         0117
         L     @00,@SIZDATD                                        0117
         LR    @01,@10                                             0117
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@03                                             0117
         L     @14,12(,@13)                                        0117
         LM    @00,@12,20(@13)                                     0117
         BR    @14                                                 0117
*                                                                  0118
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSIN PROCESSOR                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0118
*CARDIN:                                                           0118
*   PROC;                           /*                       @Y30LB54*/
@EL00001 L     @13,4(,@13)                                         0118
@EF00001 L     @00,@SIZDATD                                        0118
         LR    @01,@10                                             0118
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0118
         BR    @14                                                 0118
CARDIN   STM   @14,@12,@SA00002                                    0118
*   STARTINP=FIVE;                  /* RESET PTR TO START OF INPUT 0119
*                                      AREA                  @Y30LB54*/
         MVC   STARTINP(4),@CF00318                                0119
*   ENDINP=FOUR;                    /* RESET PTR TO END OF INPUT AREA
*                                                            @Y30LB54*/
*                                                                  0120
         MVC   ENDINP(4),@CF00071                                  0120
*   /*****************************************************************/
*   /*                                                               */
*   /* GET SYSIN LOOP                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0121
*   DO WHILE(RETCODE=0);            /*                       @Y30LB54*/
         B     @DE00121                                            0121
@DL00121 DS    0H                                                  0122
*     LINE='ENTER NEXT LINE ';      /*                       @Y30LB54*/
         MVI   LINE+16(CVTPTR),C' '                                0122
         MVC   LINE+17(115,CVTPTR),LINE+16(CVTPTR)                 0122
         MVC   LINE(16,CVTPTR),@CC00357                            0122
*     CALL ISDATYPE(WORKPTR);       /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0123
         ST    @03,@AL00001                                        0123
         L     @15,@CV00038                                        0123
         LA    @01,@AL00001                                        0123
         BALR  @14,@15                                             0123
*     CALL GETCARD;                 /* GET SYSIN             @Y30LB54*/
         BAL   @14,GETCARD                                         0124
*     RFY                                                          0125
*       CONDCODE RSTD;              /*                       @Y30LB54*/
*     RETCODE=CONDCODE;             /*                       @Y30LB54*/
         ST    CONDCODE,RETCODE                                    0126
*     RFY                                                          0127
*       CONDCODE UNRSTD;            /*                       @Y30LB54*/
*     IF RETCODE=8×RETCODE=4 THEN                                  0128
         CLC   RETCODE(4),@CF00091                                 0128
         BE    @RT00128                                            0128
         CLC   RETCODE(4),@CF00071                                 0128
         BNE   @RF00128                                            0128
@RT00128 DS    0H                                                  0129
*       DO;                         /* IT IS AN EOF          @Y30LB54*/
*         INPUT(ENDINP:ENDINP)=SMI; /* BLANK LAST CHAR       @Y30LB54*/
         L     @03,INPTR                                           0130
         AL    @03,ENDINP                                          0130
         AL    @03,@CF00396                                        0130
         MVI   INPUT(@03),X'5E'                                    0130
*         INPTR1=ADDR(WORKBUF)+ENDINP-ONE;/* NEW END OF WORK AREA  0131
*                                                            @Y30LB54*/
*                                                                  0131
         LA    @03,WORKBUF                                         0131
         AL    @03,ENDINP                                          0131
         BCTR  @03,0                                               0131
         ST    @03,INPTR1                                          0131
*         /***********************************************************/
*         /*                                                         */
*         /* ENDINP NOW SHOWS LAST BYTE OF REAL DATA IN INPUT AREA   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0132
*         RETCODE=0;                /*                       @Y30LB54*/
         SLR   @03,@03                                             0132
         ST    @03,RETCODE                                         0132
*         RETURN CODE(RETCODE);     /* EXIT TO CALLING PROGRAM     0133
*                                                            @Y30LB54*/
         L     @15,RETCODE                                         0133
         L     @14,@SA00002                                        0133
         LM    @00,@12,@SA00002+8                                  0133
         BR    @14                                                 0133
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0135
*       IF RETCODE^=0 THEN                                         0135
@RF00128 ICM   @03,15,RETCODE                                      0135
         BZ    @RF00135                                            0135
*         DO;                       /*                       @Y30LB54*/
*           RETURN CODE(RETCODE);   /*                       @Y30LB54*/
         L     @15,RETCODE                                         0137
         L     @14,@SA00002                                        0137
         LM    @00,@12,@SA00002+8                                  0137
         BR    @14                                                 0137
*         END;                      /*                       @Y30LB54*/
*       ELSE                                                       0139
*         ;                                                /*@Y30LB54*/
@RF00135 DS    0H                                                  0140
*     DO;                           /*                       @Y30LB54*/
*       STARTTXT=0;                 /* RESET STARTING POINTER CARD 0141
*                                                            @Y30LB54*/
         SLR   @03,@03                                             0141
         ST    @03,STARTTXT                                        0141
*       ENDTXT=0;                   /* RESET ENDING POINTER CARD   0142
*                                                            @Y30LB54*/
         SLR   @03,@03                                             0142
         ST    @03,ENDTXT                                          0142
*       DO CTR=1 TO 80 BY 1;        /*                       @Y30LB54*/
         LA    CTR,1                                               0143
@DL00143 DS    0H                                                  0144
*         IF CARD(CTR)=' ' THEN                                    0144
         LA    @01,CARD-1(CTR)                                     0144
         CLI   0(@01),C' '                                         0144
         BE    @RT00144                                            0144
*           ;                       /* SCAN FOR FIRST NON BLANK CHAR
*                                                            @Y30LB54*/
*         ELSE                                                     0146
*           DO;                     /*                       @Y30LB54*/
*             STARTTXT=CTR;         /* FIRST NON BLANK LOCATION    0147
*                                                            @Y30LB54*/
         ST    CTR,STARTTXT                                        0147
*             DO CTR=CTR TO 80 BY 1;/*                       @Y30LB54*/
         B     @DE00148                                            0148
@DL00148 DS    0H                                                  0149
*               IF CARD(CTR)=SMI THEN/*                      @Y30LB54*/
         LA    @01,CARD-1(CTR)                                     0149
         CLI   0(@01),X'5E'                                        0149
         BNE   @RF00149                                            0149
*                 DO;               /*                       @Y30LB54*/
*                   ENDTXT=CTR;     /* LAST CHAR OF INPUT    @Y30LB54*/
         ST    CTR,ENDTXT                                          0151
*                   CTR=81;         /* TERMINATE THIS LINE OF INPUT
*                                      REST COMMENTS         @Y30LB54*/
         LA    CTR,81                                              0152
*                 END;              /*                       @Y30LB54*/
*               ELSE                                               0154
*                 ;                 /*                       @Y30LB54*/
@RF00149 DS    0H                                                  0155
*             END;                  /*                       @Y30LB54*/
         AH    CTR,@CH00068                                        0155
@DE00148 CH    CTR,@CH00331                                        0155
         BNH   @DL00148                                            0155
*             IF ENDTXT=0 THEN                                     0156
         ICM   @15,15,ENDTXT                                       0156
         BNZ   @RF00156                                            0156
*               DO;                 /*                       @Y30LB54*/
*                 IF CARD(80)=' ' THEN                             0158
         CLI   CARD+79,C' '                                        0158
         BNE   @RF00158                                            0158
*                   DO CTR=CTR-ONE TO 0 BY-ONE;/*            @Y30LB54*/
         LR    @15,CTR                                             0159
         BCTR  @15,0                                               0159
         LR    CTR,@15                                             0159
         B     @DE00159                                            0159
@DL00159 DS    0H                                                  0160
*                     IF CARD(CTR)=' ' THEN                        0160
         LA    @01,CARD-1(CTR)                                     0160
         CLI   0(@01),C' '                                         0160
         BE    @RT00160                                            0160
*                       ;           /*                       @Y30LB54*/
*                     ELSE                                         0162
*                       DO;         /*                       @Y30LB54*/
*                         ENDTXT=CTR+ONE;/*                  @Y30LB54*/
         LA    @15,1                                               0163
         ALR   @15,CTR                                             0163
         ST    @15,ENDTXT                                          0163
*                         CTR=0;    /*                       @Y30LB54*/
         SLR   CTR,CTR                                             0164
*                       END;        /*                       @Y30LB54*/
*                   END;            /*                       @Y30LB54*/
@RT00160 BCTR  CTR,0                                               0166
@DE00159 LTR   CTR,CTR                                             0166
         BNM   @DL00159                                            0166
*                 ELSE                                             0167
*                   ENDTXT=81;      /* MAKE LAST COLUMN OF CARD END
*                                                            @Y30LB54*/
         B     @RC00158                                            0167
@RF00158 MVC   ENDTXT(4),@CF00360                                  0167
*                 CTR=81;           /* TERMINATE THIS LOOP   @Y30LB54*/
@RC00158 LA    CTR,81                                              0168
*               END;                /*                       @Y30LB54*/
*             ELSE                                                 0170
*               ;                   /*                       @Y30LB54*/
@RF00156 DS    0H                                                  0171
*           END;                    /*                       @Y30LB54*/
*       END;                        /*                       @Y30LB54*/
@RT00144 AH    CTR,@CH00068                                        0172
         CH    CTR,@CH00331                                        0172
         BNH   @DL00143                                            0172
*       IF STARTTXT=0               /* NO INPUT ON CARD      @Y30LB54*/
*         THEN                                                     0173
         ICM   @03,15,STARTTXT                                     0173
         BZ    @RT00173                                            0173
*         ;                         /*                       @Y30LB54*/
*       ELSE                                                       0175
*         DO;                       /*                       @Y30LB54*/
*           FULLWD2=ENDTXT-STARTTXT+ONE;/* HOW MANY POSITIONS OF   0176
*                                      INPUT                 @Y30LB54*/
         L     @03,ENDTXT                                          0176
         SL    @03,STARTTXT                                        0176
         AH    @03,@CH00068                                        0176
         ST    @03,FULLWD2                                         0176
*           ENDINP=ENDINP+FULLWD2;  /* LAST ITEM OF GOOD DATA@Y30LB54*/
         L     @03,ENDINP                                          0177
         AL    @03,FULLWD2                                         0177
         ST    @03,ENDINP                                          0177
*           IF ENDINP+ADDR(WORKBUF)>INPTR1/* HAVE WE OVERFLOWED    0178
*                                                            @Y30LB54*/
*             THEN                                                 0178
         LA    @03,WORKBUF                                         0178
         AL    @03,ENDINP                                          0178
         C     @03,INPTR1                                          0178
         BNH   @RF00178                                            0178
*             DO;                   /*                       @Y30LB54*/
*               RETCODE=4;          /*                       @Y30LB54*/
         MVC   RETCODE(4),@CF00071                                 0180
*               RETURN CODE(RETCODE);/*                      @Y30LB54*/
         L     @15,RETCODE                                         0181
         L     @14,@SA00002                                        0181
         LM    @00,@12,@SA00002+8                                  0181
         BR    @14                                                 0181
*             END;                  /*                       @Y30LB54*/
*           ELSE                                                   0183
*             INPUT(ONE:FOUR)=ENDINP;/* TURN ON LENGTH FIELD @Y30LB54*/
@RF00178 L     @03,INPTR                                           0183
         MVC   INPUT(4,@03),ENDINP                                 0183
*           INPUT(STARTINP:ENDINP)=CARD(STARTTXT:ENDTXT);/*  @Y30LB54*/
         L     @03,INPTR                                           0184
         AL    @03,STARTINP                                        0184
         AL    @03,@CF00396                                        0184
         L     @15,ENDINP                                          0184
         SL    @15,STARTINP                                        0184
         L     @01,STARTTXT                                        0184
         LA    @14,CARD-1(@01)                                     0184
         EX    @15,@SM00508                                        0184
*           INPUT(ENDINP:ENDINP)=',';/* MAKE IT LOOK LIKE JCL INPUT
*                                                            @Y30LB54*/
         L     @03,INPTR                                           0185
         AL    @03,ENDINP                                          0185
         AL    @03,@CF00396                                        0185
         MVI   INPUT(@03),C','                                     0185
*           STARTINP=ENDINP+ONE;    /* SET UP FOR NEXT TIME AROUND 0186
*                                                            @Y30LB54*/
         LA    @03,1                                               0186
         AL    @03,ENDINP                                          0186
         ST    @03,STARTINP                                        0186
*/*                    MOVE COMPESSED DATA TO INPUT AREA     @Y30LB54*/
*                                                                  0187
*         END;                      /*                       @Y30LB54*/
*     END;                          /*                       @Y30LB54*/
@RT00173 DS    0H                                                  0189
*   END;                            /*                       @Y30LB54*/
@DE00121 ICM   @03,15,RETCODE                                      0189
         BZ    @DL00121                                            0189
*   END CARDIN;                     /*                       @Y30LB54*/
@EL00002 DS    0H                                                  0190
@EF00002 DS    0H                                                  0190
@ER00002 LM    @14,@12,@SA00002                                    0190
         BR    @14                                                 0190
*                                                                  0191
*   /*****************************************************************/
*   /*                                                               */
*   /* READ A CARD ROUTINE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0191
*GETCARD:                                                          0191
*   PROC;                           /*                       @Y30LB54*/
GETCARD  STM   @14,@12,@SA00003                                    0191
*   DCL                                                            0192
*    (EOD,                                                         0192
*     EOF) LABEL;                   /*                       @Y30LB54*/
*                                                                  0192
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO READ CARD FROM SYSIN                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0193
*   IF OFLAGS(4)^='1'B THEN                                        0193
         TM    OFLAGS,B'00010000'                                  0193
         BO    @RF00193                                            0193
*     DO;                           /* IS DCB OPEN           @Y30LB54*/
*       GENERATE CODE;                                     /*@Y30LB54*/
*                                                         /*@Y30LB54*/
        OPEN  (SYSINDCB,INPUT),MF=(E,OPENLIST)
*       IF OFLAGS(4)='1'B THEN                                     0196
         TM    OFLAGS,B'00010000'                                  0196
         BNO   @RF00196                                            0196
*         RETCODE=0;                /* OPEN                  @Y30LB54*/
         SLR   @03,@03                                             0197
         ST    @03,RETCODE                                         0197
*       ELSE                                                       0198
*         RETCODE=4;                /* MISSING DD CARD       @Y30LB54*/
         B     @RC00196                                            0198
@RF00196 MVC   RETCODE(4),@CF00071                                 0198
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0200
*     RETCODE=0;                    /*                       @Y30LB54*/
         B     @RC00193                                            0200
@RF00193 SLR   @03,@03                                             0200
         ST    @03,RETCODE                                         0200
*   IF RETCODE=0 THEN                                              0201
@RC00193 ICM   @03,15,RETCODE                                      0201
         BNZ   @RF00201                                            0201
*     DO;                           /*                       @Y30LB54*/
*       CARD=CARD&&CARD;            /* CLEAR CARD AREA FOR SHORT   0203
*                                      RECORDS               @Y30LB54*/
         XC    CARD(80),CARD                                       0203
*       RFY                                                        0204
*         R6 RSTD;                  /*                       @Y30LB54*/
*       R6=ADDR(CARD);              /* SET ADDR OF CARD      @Y30LB54*/
         LA    R6,CARD                                             0205
*       GEN( GET   SYSINDCB,(R6))                                  0206
*       FLOWS(EOF,EOD);             /*                       @Y30LB54*/
          GET   SYSINDCB,(R6)
*       RFY                                                        0207
*         R6 UNRSTD;                /*                       @Y30LB54*/
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0209
*     ;                             /*                       @Y30LB54*/
@RF00201 DS    0H                                                  0210
*   RETURN CODE(RETCODE);           /* RETURN WITH CONDCODE  @Y30LB54*/
         L     @15,RETCODE                                         0210
         L     @14,@SA00003                                        0210
         LM    @00,@12,@SA00003+8                                  0210
         BR    @14                                                 0210
*EOF:                                                              0211
*   RETCODE=8;                      /* SET END OF FILE RETURN CODE 0211
*                                                            @Y30LB54*/
EOF      MVC   RETCODE(4),@CF00091                                 0211
*   GEN CODE;                                              /*@Y30LB54*/
*                                                         /*@Y30LB54*/
        CLOSE (SYSINDCB),MF=(E,CLOSLIST)
*   RETURN CODE(RETCODE);                                  /*@Y30LB54*/
         L     @15,RETCODE                                         0213
         L     @14,@SA00003                                        0213
         LM    @00,@12,@SA00003+8                                  0213
         BR    @14                                                 0213
*EOD:                                                              0214
*   RETCODE=12;                     /* SET SYNAD RETURN CODE @Y30LB54*/
EOD      MVC   RETCODE(4),@CF00034                                 0214
*   GEN CODE;                                              /*@YM32173*/
*                                                         /*@YM32173*/
        CLOSE (SYSINDCB),MF=(E,CLOSLIST)
*   RETURN CODE(RETCODE);                                  /*@Y30LB54*/
         L     @15,RETCODE                                         0216
         L     @14,@SA00003                                        0216
         LM    @00,@12,@SA00003+8                                  0216
         BR    @14                                                 0216
*   END GETCARD;                    /*                       @Y30LB54*/
*                                                                  0218
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN ROUTINE TO FIND KEY CLAUSES                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0218
*SCAN1:                                                            0218
*   PROC;                           /*                       @Y30LB54*/
SCAN1    STM   @14,@12,12(@13)                                     0218
*   RETCODE1=0;                     /* INITIALIZE IT FOR THIS TIME 0219
*                                                            @Y30LB54*/
         SLR   @03,@03                                             0219
         ST    @03,RETCODE1                                        0219
*   STARTTXT=0;                     /* RESET KEYWORD POINTER @Y30LB54*/
         SLR   @03,@03                                             0220
         ST    @03,STARTTXT                                        0220
*   ENDTXT=0;                       /* RESET END KEYWORD POINTER   0221
*                                                            @Y30LB54*/
         SLR   @03,@03                                             0221
         ST    @03,ENDTXT                                          0221
*   STARTPRM=0;                     /* RESET FUNCTION POINTER@Y30LB54*/
         SLR   @03,@03                                             0222
         ST    @03,STARTPRM                                        0222
*   ENDPRM=0;                       /* RESET END FUNCTION POINTER  0223
*                                                            @Y30LB54*/
         SLR   @03,@03                                             0223
         ST    @03,ENDPRM                                          0223
*   CHAR1=STARTINP;                 /* SET START SCAN PTR    @Y30LB54*/
         MVC   CHAR1(4),STARTINP                                   0224
*   CHARL=ENDINP;                   /* SET END SCAN PTR      @Y30LB54*/
         MVC   CHARL(4),ENDINP                                     0225
*/*                  DON'T WANT TO LOSE ORIGIONAL SO SET THEM IN   0226
*                                                            @Y30LB54*/
*/*                  CHAR1 AND CHARL                         @Y30LB54*/
*                                                                  0226
*   DO CHAR1=CHAR1 TO CHARL BY ONE; /* LOOK FOR NON BLANKS   @Y30LB54*/
         L     @03,CHAR1                                           0226
         B     @DE00226                                            0226
@DL00226 DS    0H                                                  0227
*     IF INPUT(CHAR1)=' '×INPUT(CHAR1)=',' THEN                    0227
         L     @03,INPTR                                           0227
         AL    @03,CHAR1                                           0227
         AL    @03,@CF00396                                        0227
         CLI   INPUT(@03),C' '                                     0227
         BE    @RT00227                                            0227
         L     @03,INPTR                                           0227
         AL    @03,CHAR1                                           0227
         AL    @03,@CF00396                                        0227
         CLI   INPUT(@03),C','                                     0227
         BE    @RT00227                                            0227
*       ;                           /*                       @Y30LB54*/
*     ELSE                          /* HAVE HIT              @Y30LB54*/
*       DO;                         /*                       @Y30LB54*/
*         STARTTXT=CHAR1;           /* START OF CLAUSE       @Y30LB54*/
         MVC   STARTTXT(4),CHAR1                                   0230
*         DO CHAR1=CHAR1 TO CHARL BY ONE;/* LOOK FOR OPEN PAREN    0231
*                                                            @Y30LB54*/
         L     @03,CHAR1                                           0231
         B     @DE00231                                            0231
@DL00231 DS    0H                                                  0232
*           IF INPUT(CHAR1)^='(' THEN                              0232
         L     @03,INPTR                                           0232
         AL    @03,CHAR1                                           0232
         AL    @03,@CF00396                                        0232
         CLI   INPUT(@03),C'('                                     0232
         BNE   @RT00232                                            0232
*             ;                     /* GO TO NEXT CHAR       @Y30LB54*/
*           ELSE                                                   0234
*             DO;                   /*                       @Y30LB54*/
*               STARTPRM=CHAR1;     /* POINT TO FUNCTION START     0235
*                                                            @Y30LB54*/
         MVC   STARTPRM(4),CHAR1                                   0235
*               DO CHAR1=CHAR1 TO CHARL BY ONE;/* LOOK FOR CLOSE   0236
*                                      PAREN                 @Y30LB54*/
         L     @03,CHAR1                                           0236
         B     @DE00236                                            0236
@DL00236 DS    0H                                                  0237
*                 IF INPUT(CHAR1)^=')' THEN                        0237
         L     @03,INPTR                                           0237
         AL    @03,CHAR1                                           0237
         AL    @03,@CF00396                                        0237
         CLI   INPUT(@03),C')'                                     0237
         BNE   @RT00237                                            0237
*                   ;               /*                       @Y30LB54*/
*                 ELSE                                             0239
*                   DO;             /*                       @Y30LB54*/
*                     ENDPRM=CHAR1; /* POINT TO FUNCTION END @Y30LB54*/
         MVC   ENDPRM(4),CHAR1                                     0240
*                     CHAR1=CHAR1+ONE;/* NEXT DIGIT          @Y30LB54*/
         LA    @03,1                                               0241
         AL    @03,CHAR1                                           0241
         ST    @03,CHAR1                                           0241
*                     IF INPUT(CHAR1)=SMI×INPUT(CHAR1)=','  THEN   0242
         L     @03,INPTR                                           0242
         AL    @03,CHAR1                                           0242
         AL    @03,@CF00396                                        0242
         CLI   INPUT(@03),X'5E'                                    0242
         BE    @RT00242                                            0242
         L     @03,INPTR                                           0242
         AL    @03,CHAR1                                           0242
         AL    @03,@CF00396                                        0242
         CLI   INPUT(@03),C','                                     0242
         BNE   @RF00242                                            0242
@RT00242 DS    0H                                                  0243
*          /*                                                @Y30LB54*/
*                                                                  0243
*                       /*********************************************/
*                       /*                                           */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0243
*                       STARTINP=CHAR1+ONE;/* SKIP DELIMITER @Y30LB54*/
         LA    @03,1                                               0243
         AL    @03,CHAR1                                           0243
         ST    @03,STARTINP                                        0243
*                     ELSE                                         0244
*                       STARTINP=CHAR1;/* NO DELIMITER DONT SKIP   0244
*                                                            @Y30LB54*/
         B     @RC00242                                            0244
@RF00242 MVC   STARTINP(4),CHAR1                                   0244
*                     ENDTXT=STARTINP;/* END OF CLAUSE       @Y30LB54*/
@RC00242 MVC   ENDTXT(4),STARTINP                                  0245
*                     CHAR1=FFEE;   /* TERMINATE ALL SCANS   @Y30LB54*/
         MVC   CHAR1(4),FFEE                                       0246
*                   END;            /*                       @Y30LB54*/
*               END;                /*                       @Y30LB54*/
@RT00237 LA    @03,1                                               0248
         AL    @03,CHAR1                                           0248
         ST    @03,CHAR1                                           0248
@DE00236 C     @03,CHARL                                           0248
         BNH   @DL00236                                            0248
*             END;                  /*                       @Y30LB54*/
*         END;                      /*                       @Y30LB54*/
@RT00232 LA    @03,1                                               0250
         AL    @03,CHAR1                                           0250
         ST    @03,CHAR1                                           0250
@DE00231 C     @03,CHARL                                           0250
         BNH   @DL00231                                            0250
*       END;                        /*                       @Y30LB54*/
*     IF CHAR1^>FFEE THEN                                          0252
@RT00227 CLC   CHAR1(4),FFEE                                       0252
         BH    @RF00252                                            0252
*       DO;                         /*                       @Y30LB54*/
*         ENDTXT=ENDINP;            /* END OF CLAUSE         @Y30LB54*/
         MVC   ENDTXT(4),ENDINP                                    0254
*         STARTINP=ENDINP;          /*                       @Y30LB54*/
         MVC   STARTINP(4),ENDINP                                  0255
*         ENDTXT=ENDINP;            /* TO SHOW BACK OF BUFFER@Y30LB54*/
         MVC   ENDTXT(4),ENDINP                                    0256
*         STARTPRM=0;               /*                       @Y30LB54*/
         SLR   @03,@03                                             0257
         ST    @03,STARTPRM                                        0257
*         ENDPRM=0;                 /*                       @Y30LB54*/
         SLR   @03,@03                                             0258
         ST    @03,ENDPRM                                          0258
*         RETCODE1=8;               /* PASS ERROR INDICATION BACK  0259
*                                                            @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0259
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0261
*       RETCODE1=0;                 /* PASS BACK OK INDICATION     0261
*                                                            @Y30LB54*/
         B     @RC00252                                            0261
@RF00252 SLR   @03,@03                                             0261
         ST    @03,RETCODE1                                        0261
*   END;                            /*                       @Y30LB54*/
@RC00252 LA    @03,1                                               0262
         AL    @03,CHAR1                                           0262
         ST    @03,CHAR1                                           0262
@DE00226 C     @03,CHARL                                           0262
         BNH   @DL00226                                            0262
*   RETURN CODE(RETCODE1);          /*                       @Y30LB54*/
         L     @15,RETCODE1                                        0263
         L     @14,12(,@13)                                        0263
         LM    @00,@12,20(@13)                                     0263
         BR    @14                                                 0263
*   END SCAN1;                      /*                       @Y30LB54*/
*                                                                  0265
*   /*****************************************************************/
*   /*                                                               */
*   /* JCL INPUT PARAMETER PROCESSOR                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*JCLIN:                                                            0265
*   PROC;                           /*                       @Y30LB54*/
JCLIN    STM   @14,@12,12(@13)                                     0265
*   INPUT=INPUT&&INPUT;             /* CLEAR PROCESSING AREA @Y30LB54*/
         L     @03,INPTR                                           0266
         XC    INPUT(200,@03),INPUT(@03)                           0266
*/*PARM0PTR IS POINTER TO HALFWORD STARTING WITH JCL PARMS   @Y30LB54*/
*                                                                  0267
*   IF JCLAREA(ONE:TWO)=0 THEN                                     0267
         L     @03,PARM0PTR(,CVTPTR)                               0267
         ICM   @15,3,JCLAREA(@03)                                  0267
         BZ    @RT00267                                            0267
*     ;                             /*                       @Y30LB54*/
*   ELSE                                                           0269
*     DO;                           /*                       @Y30LB54*/
*       CTR=JCLAREA(ONE:TWO);       /* PICK UP HALFWORD OF LENGTH  0270
*                                                            @Y30LB54*/
         L     @05,PARM0PTR(,CVTPTR)                               0270
         SLR   CTR,CTR                                             0270
         ICM   CTR,3,JCLAREA(@05)                                  0270
*       CTR=CTR+2;                  /* ADJUST COUNT TO INCLUDE LENGTH
*                                      FIELD                 @Y30LB54*/
         AH    CTR,@CH00066                                        0271
*       CTR1=3;                     /* STARTING LOCATION OF SCAN   0272
*                                                            @Y30LB54*/
         LA    CTR1,3                                              0272
*       INPTR1=ADDR(WORKBUF)+200;   /* RESET END PTR TO BACK OF AREA
*                                                            @Y30LB54*/
         LA    @05,WORKBUF                                         0273
         AH    @05,@CH00327                                        0273
         ST    @05,INPTR1                                          0273
*       STARTINP=FIVE;              /* FIRST LOCATION TO INSERT DATA
*                                      IN                    @Y30LB54*/
         MVC   STARTINP(4),@CF00318                                0274
*       DO CTR1=CTR1 TO CTR BY 1;   /*                       @Y30LB54*/
         B     @DE00275                                            0275
@DL00275 DS    0H                                                  0276
*         IF JCLAREA(CTR1)=' '×JCLAREA(CTR1)='=' THEN              0276
         L     @05,PARM0PTR(,CVTPTR)                               0276
         LR    @01,@05                                             0276
         ALR   @01,CTR1                                            0276
         AL    @01,@CF00396                                        0276
         CLI   JCLAREA(@01),C' '                                   0276
         BE    @RT00276                                            0276
         ALR   @05,CTR1                                            0276
         AL    @05,@CF00396                                        0276
         CLI   JCLAREA(@05),C'='                                   0276
         BE    @RT00276                                            0276
*           ;                       /*                       @Y30LB54*/
*         ELSE                                                     0278
*           DO;                     /*                       @Y30LB54*/
*             INPUT(STARTINP)=JCLAREA(CTR1);/* MOVE ONE BYTE OF DATA
*                                                            @Y30LB54*/
         L     @05,INPTR                                           0279
         AL    @05,STARTINP                                        0279
         AL    @05,@CF00396                                        0279
         L     @01,PARM0PTR(,CVTPTR)                               0279
         ALR   @01,CTR1                                            0279
         AL    @01,@CF00396                                        0279
         MVC   INPUT(1,@05),JCLAREA(@01)                           0279
*             STARTINP=STARTINP+ONE;/* MOVE TO NEXT INPUT BYTE     0280
*                                                            @Y30LB54*/
         LA    @05,1                                               0280
         AL    @05,STARTINP                                        0280
         ST    @05,STARTINP                                        0280
*             IF STARTINP>200 THEN  /* DONT LET IT EXCEED BUFFER   0281
*                                                            @Y30LB54*/
         L     @05,STARTINP                                        0281
         CH    @05,@CH00327                                        0281
         BNH   @RF00281                                            0281
*               DO;                 /*                       @Y30LB54*/
*                 RETCODE=4;        /* OUT OF SPACE          @Y30LB54*/
         MVC   RETCODE(4),@CF00071                                 0283
*                 RETURN CODE(RETCODE);/*                    @Y30LB54*/
         L     @15,RETCODE                                         0284
         L     @14,12(,@13)                                        0284
         LM    @00,@12,20(@13)                                     0284
         BR    @14                                                 0284
*               END;                /*                       @Y30LB54*/
*           END;                    /*                       @Y30LB54*/
@RF00281 DS    0H                                                  0287
*       END;                        /*                       @Y30LB54*/
@RT00276 AH    CTR1,@CH00068                                       0287
@DE00275 CR    CTR1,CTR                                            0287
         BNH   @DL00275                                            0287
*       INPUT(STARTINP)=SMI;        /* DENOTE END OF INPUT   @Y30LB54*/
         L     @03,INPTR                                           0288
         AL    @03,STARTINP                                        0288
         AL    @03,@CF00396                                        0288
         MVI   INPUT(@03),X'5E'                                    0288
*       INPUT(ONE:FOUR)=STARTINP;   /* TOTAL BYTES IN WORK AREA    0289
*                                                            @Y30LB54*/
         L     @03,INPTR                                           0289
         MVC   INPUT(4,@03),STARTINP                               0289
*       INPTR1=ADDR(WORKBUF)+STARTINP-ONE;/* NEW END OF WORK AREA  0290
*                                                            @Y30LB54*/
         LA    @03,WORKBUF                                         0290
         AL    @03,STARTINP                                        0290
         BCTR  @03,0                                               0290
         ST    @03,INPTR1                                          0290
*       RETURN CODE(RETCODE);       /*                       @Y30LB54*/
         L     @15,RETCODE                                         0291
         L     @14,12(,@13)                                        0291
         LM    @00,@12,20(@13)                                     0291
         BR    @14                                                 0291
*     END;                          /*                       @Y30LB54*/
*   END JCLIN;                      /*                       @Y30LB54*/
@EL00005 DS    0H                                                  0293
@EF00005 DS    0H                                                  0293
@ER00005 LM    @14,@12,12(@13)                                     0293
         BR    @14                                                 0293
*                                                                  0294
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS DATA                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0294
*EMPTYIT:                                                          0294
*   PROC;                           /*                       @Y30LB54*/
*                                                                  0294
EMPTYIT  STM   @14,@12,@SA00006                                    0294
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW READY TO EMPTY COMPRESSED BUFFER                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0295
*   STARTINP=FIVE;                  /* TELL SCAN1 WHERE TO START   0295
*                                                            @Y30LB54*/
         MVC   STARTINP(4),@CF00318                                0295
*   ENDINP=INPTR1-INPTR+ONE;        /* TELL SCAN 1 WHERE TO END    0296
*                                                            @Y30LB54*/
         L     @03,INPTR1                                          0296
         SL    @03,INPTR                                           0296
         AH    @03,@CH00068                                        0296
         ST    @03,ENDINP                                          0296
*   DO WHILE STARTINP<ENDINP;       /* PROCESS ALL KEY CLAUSES     0297
*                                                            @Y30LB54*/
         B     @DE00297                                            0297
@DL00297 DS    0H                                                  0298
*     CALL SCAN1;                   /* LOCATE THE KEYWORD CLAUSE   0298
*                                                            @Y30LB54*/
         BAL   @14,SCAN1                                           0298
*/*STARTINP AND ENDINP ARE INITIAL COUNTER VALUES FOR BUFFER BOUNDRIE
*                                                                    S
*                                                            @Y30LB54*/
*/*INPTR AND INPTR1 ARE INITIAL ADDRESS VALUES FOR BUFFER BOUNDRIES
*                                                            @Y30LB54*/
*/*OUTPUT OF SCAN 1                                          @Y30LB54*/
*/*STARTTXT = FIRST NON BLANK LOCATION                       @Y30LB54*/
*/*STARTPRM = OPEN PAREN                                     @Y30LB54*/
*/*ENDPRM = CLOSE PAREN                                      @Y30LB54*/
*/*ENDTXT = END OF CLAUSE                                    @Y30LB54*/
*                                                                  0299
*     LINE=' ';                     /* BLANK OUT PRINT LINE  @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0299
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0299
         MVI   LINE(CVTPTR),C' '                                   0299
*     FULLWD2=ENDTXT-STARTTXT;      /*                       @Y30LB54*/
         L     @03,ENDTXT                                          0300
         SL    @03,STARTTXT                                        0300
         ST    @03,FULLWD2                                         0300
*     IF FULLWD2>120 THEN                                          0301
         LA    @03,120                                             0301
         C     @03,FULLWD2                                         0301
         BNL   @RF00301                                            0301
*       FULLWD2=120;                /* DONT ALLOW TO OVERFLOW PRINT
*                                      AREA                  @Y30LB54*/
         ST    @03,FULLWD2                                         0302
*     ELSE                                                         0303
*       ;                           /*                       @Y30LB54*/
@RF00301 DS    0H                                                  0304
*     LINE(1:FULLWD2)=INPUT(STARTTXT:ENDTXT);/* PRINT WHAT WAS FOUND
*                                                            @Y30LB54*/
         L     @03,FULLWD2                                         0304
         BCTR  @03,0                                               0304
         L     @01,INPTR                                           0304
         AL    @01,STARTTXT                                        0304
         AL    @01,@CF00396                                        0304
         EX    @03,@SM00510                                        0304
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/
         L     @03,@PC00001                                        0305
         ST    @03,@AL00001                                        0305
         L     @15,@CV00037                                        0305
         LA    @01,@AL00001                                        0305
         BALR  @14,@15                                             0305
*     CALL ISDATYPE(WORKPTR);       /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0306
         ST    @03,@AL00001                                        0306
         L     @15,@CV00038                                        0306
         LA    @01,@AL00001                                        0306
         BALR  @14,@15                                             0306
*     IF RETCODE1^=0 THEN                                          0307
         ICM   @03,15,RETCODE1                                     0307
         BZ    @RF00307                                            0307
*       DO;                         /*                       @Y30LB54*/
*         LINE='ISDAPARM DELIMITER ERRORS';/*                @Y30LB54*/
         MVI   LINE+25(CVTPTR),C' '                                0309
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0309
         MVC   LINE(25,CVTPTR),@CC00383                            0309
*         RETCODE=RETCODE1;         /* TELL MOTHER ABOUT IT  @Y30LB54*/
         MVC   RETCODE(4),RETCODE1                                 0310
*         CALL ISDAPRT0(WORKPTR);   /*                       @Y30LB54*/
         L     @03,@PC00001                                        0311
         ST    @03,@AL00001                                        0311
         L     @15,@CV00037                                        0311
         LA    @01,@AL00001                                        0311
         BALR  @14,@15                                             0311
*         CALL ISDATYPE(WORKPTR);   /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0312
         ST    @03,@AL00001                                        0312
         L     @15,@CV00038                                        0312
         LA    @01,@AL00001                                        0312
         BALR  @14,@15                                             0312
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0314
*       DO;                         /*                       @Y30LB54*/
         B     @RC00307                                            0314
@RF00307 DS    0H                                                  0315
*         POINTADD=0;               /* ZERO ADDRESS POINTER  @Y30LB54*/
         SLR   POINTADD,POINTADD                                   0315
*         DO CTR=1 TO 14 BY 1;      /*                       @Y30LB54*/
         LA    CTR,1                                               0316
@DL00316 DS    0H                                                  0317
*           IF INPUT(STARTTXT:STARTTXT+TWO)=KEYARG(CTR) THEN       0317
*                                                                  0317
         LR    @05,CTR                                             0317
         SLA   @05,3                                               0317
         L     @01,INPTR                                           0317
         AL    @01,STARTTXT                                        0317
         AL    @01,@CF00396                                        0317
         LA    @15,KEYARG-8(@05)                                   0317
         CLC   INPUT(3,@01),0(@15)                                 0317
         BNE   @RF00317                                            0317
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH FOR PROPER ROUTINE TO PROCESS KEYWORD        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0318
*             DO;                   /*                       @Y30LB54*/
*               POINTADD=KEYFUNC(CTR);/* PLUG IN ADDRESS OF EDITING
*                                      ROUTINE               @Y30LB54*/
         L     POINTADD,KEYFUNC-8(@05)                             0319
*               CTR=99;             /* STOP LOOP HERE        @Y30LB54*/
         LA    CTR,99                                              0320
*             END;                  /*                       @Y30LB54*/
*           ELSE                                                   0322
*             ;                     /*                       @Y30LB54*/
@RF00317 DS    0H                                                  0323
*         END;                      /*                       @Y30LB54*/
         AH    CTR,@CH00068                                        0323
         CH    CTR,@CH00264                                        0323
         BNH   @DL00316                                            0323
*         IF POINTADD=0 THEN                                       0324
         LTR   POINTADD,POINTADD                                   0324
         BNZ   @RF00324                                            0324
*           DO;                     /*                       @Y30LB54*/
*             LINE='ISDAPARM KEYWORD ERROR';/*               @Y30LB54*/
         MVI   LINE+22(CVTPTR),C' '                                0326
         MVC   LINE+23(109,CVTPTR),LINE+22(CVTPTR)                 0326
         MVC   LINE(22,CVTPTR),@CC00387                            0326
*             CALL ISDAPRT0(WORKPTR);/*                      @Y30LB54*/
         L     @03,@PC00001                                        0327
         ST    @03,@AL00001                                        0327
         L     @15,@CV00037                                        0327
         LA    @01,@AL00001                                        0327
         BALR  @14,@15                                             0327
*             CALL ISDATYPE(WORKPTR);/* TO TERMINAL OUTPUT   @Y30LB54*/
         L     @03,@PC00001                                        0328
         ST    @03,@AL00001                                        0328
         L     @15,@CV00038                                        0328
         LA    @01,@AL00001                                        0328
         BALR  @14,@15                                             0328
*             RETCODE=8;            /*                       @Y30LB54*/
         MVC   RETCODE(4),@CF00091                                 0329
*           END;                    /*                       @Y30LB54*/
*         ELSE                                                     0331
*           DO;                     /*                       @Y30LB54*/
         B     @RC00324                                            0331
@RF00324 DS    0H                                                  0332
*             RETCODE1=0;           /* RESET RETURN CODE FOR CALLED
*                                      ROUTINE               @Y30LB54*/
         SLR   @05,@05                                             0332
         ST    @05,RETCODE1                                        0332
*             CALL POINTADD;        /* GO TO EDITING ROUTINE @Y30LB54*/
         LR    @15,POINTADD                                        0333
         BALR  @14,@15                                             0333
*             IF RETCODE1^=0 THEN                                  0334
         ICM   @03,15,RETCODE1                                     0334
         BZ    @RF00334                                            0334
*               RETCODE=RETCODE1;   /* MAKE SURE MOTHER KNOWS ABOUT
*                                      ERROR                 @Y30LB54*/
         MVC   RETCODE(4),RETCODE1                                 0335
*           END;                    /*                       @Y30LB54*/
@RF00334 DS    0H                                                  0337
*       END;                        /*                       @Y30LB54*/
@RC00324 DS    0H                                                  0338
*   END;                            /*                       @Y30LB54*/
@RC00307 DS    0H                                                  0338
@DE00297 L     @03,STARTINP                                        0338
         C     @03,ENDINP                                          0338
         BL    @DL00297                                            0338
*   END EMPTYIT;                    /*                       @Y30LB54*/
@EL00006 DS    0H                                                  0339
@EF00006 DS    0H                                                  0339
@ER00006 LM    @14,@12,@SA00006                                    0339
         BR    @14                                                 0339
*                                                                  0340
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH FOR MULTI OPTIONS IN KEYCLAUSE                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*FNDCOMMA:                                                         0340
*   PROC;                           /*                       @Y30LB54*/
FNDCOMMA STM   @14,@12,12(@13)                                     0340
*   DO STARTPRM=STARTPRM+ONE TO ENDPRM BY ONE;/* WATCH FOR ()@Y30LB54*/
         LA    @03,1                                               0341
         AL    @03,STARTPRM                                        0341
         ST    @03,STARTPRM                                        0341
         B     @DE00341                                            0341
@DL00341 DS    0H                                                  0342
*     IF INPUT(STARTPRM)^=',' THEN                                 0342
         L     @03,INPTR                                           0342
         AL    @03,STARTPRM                                        0342
         AL    @03,@CF00396                                        0342
         CLI   INPUT(@03),C','                                     0342
         BE    @RF00342                                            0342
*       ;                           /*                       @Y30LB54*/
*     ELSE                                                         0344
*       RETURN;                     /* INDICATE TO CALLER POSITION OF
*                                      COMMA                 @Y30LB54*/
*/*BY LOCATION OF STARTPRM                                   @Y30LB54*/
*                                                                  0345
*   END;                            /*                       @Y30LB54*/
         LA    @03,1                                               0345
         AL    @03,STARTPRM                                        0345
         ST    @03,STARTPRM                                        0345
@DE00341 C     @03,ENDPRM                                          0345
         BNH   @DL00341                                            0345
*   STARTPRM=0;                     /* INDICATE TO CALLER NO SECOND
*                                      OPTION                @Y30LB54*/
         SLR   @03,@03                                             0346
         ST    @03,STARTPRM                                        0346
*   END FNDCOMMA;                   /*                       @Y30LB54*/
@EL00007 DS    0H                                                  0347
@EF00007 DS    0H                                                  0347
@ER00007 LM    @14,@12,12(@13)                                     0347
         BR    @14                                                 0347
*                                                                  0348
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT EBDIC TO HEX USE LINE AS OUTPUT AREA                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0348
*/*CALL-SET STARTPRN TO FIRSTDIGIT AND CTR1 TO NUMBER OF BYTES     0348
*                                                            @Y30LB54*/
*                                                                  0348
*EBDICHEX:                                                         0348
*   PROC;                           /*                       @Y30LB54*/
EBDICHEX STM   @14,@12,12(@13)                                     0348
*   FULLWD2=1;                      /* OUTPUT POSITION TO ZERO     0349
*                                                            @Y30LB54*/
         MVC   FULLWD2(4),@CF00068                                 0349
*   DO CTR1=CTR1-ONE TO 0 BY-ONE;   /*                       @Y30LB54*/
         LR    @05,CTR1                                            0350
         BCTR  @05,0                                               0350
         LR    CTR1,@05                                            0350
         B     @DE00350                                            0350
@DL00350 DS    0H                                                  0351
*     DO CTR=1 TO 16 BY 1;          /* 16 HEX COMBINATIONS   @Y30LB54*/
         LA    CTR,1                                               0351
@DL00351 DS    0H                                                  0352
*       IF EBDIC(CTR)=INPUT(STARTPRM) THEN/* WE HAVE A MATCH @Y30LB54*/
         LR    @05,CTR                                             0352
         SLA   @05,2                                               0352
         LA    @01,EBDIC-4(@05)                                    0352
         L     @15,INPTR                                           0352
         AL    @15,STARTPRM                                        0352
         AL    @15,@CF00396                                        0352
         CLC   0(1,@01),INPUT(@15)                                 0352
         BNE   @RF00352                                            0352
*         DO;                       /*                       @Y30LB54*/
*           LINE(FULLWD2:FULLWD2)=HEXTOP(CTR);/* MOVE IN TOP HALF  0354
*                                                            @Y30LB54*/
         LR    @01,CVTPTR                                          0354
         AL    @01,FULLWD2                                         0354
         LA    @15,HEXTOP-4(@05)                                   0354
         MVC   LINE-1(1,@01),0(@15)                                0354
*           CTR=100;                /* QUIT THIS LOOP        @Y30LB54*/
         LA    CTR,100                                             0355
*         END;                      /*                       @Y30LB54*/
*       ELSE                                                       0357
*         ;                         /*                       @Y30LB54*/
@RF00352 DS    0H                                                  0358
*     END;                          /*                       @Y30LB54*/
         AH    CTR,@CH00068                                        0358
         CH    CTR,@CH00214                                        0358
         BNH   @DL00351                                            0358
*     STARTPRM=STARTPRM+ONE;        /* USED UP ONE BYTE OF INPUT   0359
*                                                            @Y30LB54*/
         LA    @05,1                                               0359
         AL    @05,STARTPRM                                        0359
         ST    @05,STARTPRM                                        0359
*     IF CTR^>99 THEN                                              0360
         CH    CTR,@CH00386                                        0360
         BH    @RF00360                                            0360
*       DO;                         /*                       @Y30LB54*/
*         CTR1=-1;                  /* TERMINATE SCAN        @Y30LB54*/
         SLR   CTR1,CTR1                                           0362
         BCTR  CTR1,0                                              0362
*         RETCODE1=8;               /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0363
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0365
*       DO;                         /*                       @Y30LB54*/
         B     @RC00360                                            0365
@RF00360 DS    0H                                                  0366
*         DO CTR=1 TO 16 BY 1;      /*                       @Y30LB54*/
         LA    CTR,1                                               0366
@DL00366 DS    0H                                                  0367
*           IF EBDIC(CTR)=INPUT(STARTPRM) THEN                     0367
         LR    @05,CTR                                             0367
         SLA   @05,2                                               0367
         LA    @01,EBDIC-4(@05)                                    0367
         L     @15,INPTR                                           0367
         AL    @15,STARTPRM                                        0367
         AL    @15,@CF00396                                        0367
         CLC   0(1,@01),INPUT(@15)                                 0367
         BNE   @RF00367                                            0367
*             DO;                   /*                       @Y30LB54*/
*               LINE(FULLWD2:FULLWD2)=HEXBOT(CTR)×LINE(FULLWD2:FULLWD2)
*                   ;               /*                       @Y30LB54*/
         LR    @01,CVTPTR                                          0369
         AL    @01,FULLWD2                                         0369
         LA    @15,HEXBOT-4(@05)                                   0369
         OC    LINE-1(1,@01),0(@15)                                0369
*               CTR=100;            /*                       @Y30LB54*/
         LA    CTR,100                                             0370
*             END;                  /*                       @Y30LB54*/
*           ELSE                                                   0372
*             ;                     /*                       @Y30LB54*/
@RF00367 DS    0H                                                  0373
*         END;                      /*                       @Y30LB54*/
         AH    CTR,@CH00068                                        0373
         CH    CTR,@CH00214                                        0373
         BNH   @DL00366                                            0373
*         STARTPRM=STARTPRM+ONE;    /* USED UP ANOTHER BYTE  @Y30LB54*/
         LA    @05,1                                               0374
         AL    @05,STARTPRM                                        0374
         ST    @05,STARTPRM                                        0374
*         IF CTR^>99 THEN                                          0375
         CH    CTR,@CH00386                                        0375
         BH    @RF00375                                            0375
*           DO;                     /*                       @Y30LB54*/
*             RETCODE1=8;           /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0377
*             CTR1=-1;              /* TERMINATE SCAN        @Y30LB54*/
         SLR   CTR1,CTR1                                           0378
         BCTR  CTR1,0                                              0378
*           END;                    /*                       @Y30LB54*/
*         ELSE                                                     0380
*           ;                       /*                       @Y30LB54*/
@RF00375 DS    0H                                                  0381
*       END;                        /*                       @Y30LB54*/
*     FULLWD2=FULLWD2+ONE;          /* MOVE TO NEXT POSITION OUTPUT
*                                                            @Y30LB54*/
@RC00360 LA    @05,1                                               0382
         AL    @05,FULLWD2                                         0382
         ST    @05,FULLWD2                                         0382
*     CTR1=CTR1-ONE;                /* USED UP TWO BYTES OF DATA   0383
*                                                            @Y30LB54*/
         BCTR  CTR1,0                                              0383
*   END;                            /*                       @Y30LB54*/
         BCTR  CTR1,0                                              0384
@DE00350 LTR   CTR1,CTR1                                           0384
         BNM   @DL00350                                            0384
*   END EBDICHEX;                   /*                       @Y30LB54*/
@EL00008 DS    0H                                                  0385
@EF00008 DS    0H                                                  0385
@ER00008 LM    @14,@12,12(@13)                                     0385
         BR    @14                                                 0385
*                                                                  0386
*   /*****************************************************************/
*   /*                                                               */
*   /* INPUT(HISTORY,LOGREC) EDITOR                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0386
*INPCLAUS:                                                         0386
*   PROC;                           /*                       @Y30LB54*/
INPCLAUS STM   @14,@12,@SA00009                                    0386
*   CHISTIN='N';                    /* TURN OFF ALL DEFAULTS @Y30LB54*/
         L     @03,LPARMPTR                                        0387
         MVI   CHISTIN(@03),C'N'                                   0387
*   CLOGIN='N';                     /* TURN OFF ALL DEFAULTS @Y30LB54*/
         L     @03,LPARMPTR                                        0388
         MVI   CLOGIN(@03),C'N'                                    0388
*   IF INPUT(STARTPRM+ONE)='H' THEN                                0389
         L     @03,INPTR                                           0389
         AL    @03,STARTPRM                                        0389
         CLI   INPUT(@03),C'H'                                     0389
         BNE   @RF00389                                            0389
*     DO;                           /* 'H' REPRESENTS HISTORY INPUT
*                                                            @Y30LB54*/
*       CHISTIN='Y';                /* TURN ON HISTORY FLAG  @Y30LB54*/
         L     @03,LPARMPTR                                        0391
         MVI   CHISTIN(@03),C'Y'                                   0391
*       CALL FNDCOMMA;              /* SEARCH FOR COMMA      @Y30LB54*/
         BAL   @14,FNDCOMMA                                        0392
*       IF STARTPRM^=0 THEN                                        0393
         ICM   @03,15,STARTPRM                                     0393
         BZ    @RF00393                                            0393
*         IF INPUT(STARTPRM+ONE)='L' THEN                          0394
         L     @03,INPTR                                           0394
         AL    @03,STARTPRM                                        0394
         CLI   INPUT(@03),C'L'                                     0394
         BNE   @RF00394                                            0394
*           CLOGIN='Y';             /* TURN ON LOGIN FLAG    @Y30LB54*/
         L     @03,LPARMPTR                                        0395
         MVI   CLOGIN(@03),C'Y'                                    0395
*         ELSE                                                     0396
*           RETCODE1=8;             /* INVALID INPUT         @Y30LB54*/
         B     @RC00394                                            0396
@RF00394 MVC   RETCODE1(4),@CF00091                                0396
*       ELSE                                                       0397
*         ;                         /*                       @Y30LB54*/
@RF00393 DS    0H                                                  0398
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0399
*     DO;                           /*                       @Y30LB54*/
         B     @RC00389                                            0399
@RF00389 DS    0H                                                  0400
*       IF INPUT(STARTPRM+ONE)='L' THEN                            0400
         L     @03,INPTR                                           0400
         AL    @03,STARTPRM                                        0400
         CLI   INPUT(@03),C'L'                                     0400
         BNE   @RF00400                                            0400
*         DO;                       /*                       @Y30LB54*/
*           CLOGIN='Y';             /* TURN ON LOGIN FLAG    @Y30LB54*/
         L     @03,LPARMPTR                                        0402
         MVI   CLOGIN(@03),C'Y'                                    0402
*           CALL FNDCOMMA;          /* SEARCH OUT COMMA      @Y30LB54*/
         BAL   @14,FNDCOMMA                                        0403
*           IF STARTPRM^=0 THEN                                    0404
         ICM   @03,15,STARTPRM                                     0404
         BZ    @RF00404                                            0404
*             IF INPUT(STARTPRM+ONE)='H' THEN                      0405
         L     @03,INPTR                                           0405
         AL    @03,STARTPRM                                        0405
         CLI   INPUT(@03),C'H'                                     0405
         BNE   @RF00405                                            0405
*               CHISTIN='Y';        /* TURN ON HISTORY INPUT FLAG  0406
*                                                            @Y30LB54*/
         L     @03,LPARMPTR                                        0406
         MVI   CHISTIN(@03),C'Y'                                   0406
*             ELSE                                                 0407
*               RETCODE1=8;         /* INVALID INPUT         @Y30LB54*/
         B     @RC00405                                            0407
@RF00405 MVC   RETCODE1(4),@CF00091                                0407
*           ELSE                                                   0408
*             ;                     /*                       @Y30LB54*/
@RF00404 DS    0H                                                  0409
*         END;                      /*                       @Y30LB54*/
*       ELSE                                                       0410
*         RETCODE1=8;               /* INVALID INPUT         @Y30LB54*/
         B     @RC00400                                            0410
@RF00400 MVC   RETCODE1(4),@CF00091                                0410
*     END;                          /*                       @Y30LB54*/
@RC00400 DS    0H                                                  0412
*   IF RETCODE1=8 THEN                                             0412
@RC00389 CLC   RETCODE1(4),@CF00091                                0412
         BNE   @RF00412                                            0412
*     DO;                           /*                       @Y30LB54*/
*       CINPUT=DFINPUT;             /* REVERT BACK TO DEFAULTS     0414
*                                                            @Y30LB54*/
         L     @03,LPARMPTR                                        0414
         MVC   CINPUT(2,@03),DFINPUT                               0414
*       RETCODE1=0;                 /* ALLOW CONTROL TO CONTINUE   0415
*                                                            @Y30LB54*/
         SLR   @03,@03                                             0415
         ST    @03,RETCODE1                                        0415
*       LINE='ISDAPARM INPUT(HISTORY,LOGREC) ERROR';/*       @Y30LB54*/
         MVI   LINE+36(CVTPTR),C' '                                0416
         MVC   LINE+37(95,CVTPTR),LINE+36(CVTPTR)                  0416
         MVC   LINE(36,CVTPTR),@CC00402                            0416
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0417
         ST    @03,@AL00001                                        0417
         L     @15,@CV00037                                        0417
         LA    @01,@AL00001                                        0417
         BALR  @14,@15                                             0417
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0418
         ST    @03,@AL00001                                        0418
         L     @15,@CV00038                                        0418
         LA    @01,@AL00001                                        0418
         BALR  @14,@15                                             0418
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0420
*     ;                             /*                       @Y30LB54*/
@RF00412 DS    0H                                                  0421
*   RETURN CODE(RETCODE1);          /*                       @Y30LB54*/
         L     @15,RETCODE1                                        0421
         L     @14,@SA00009                                        0421
         LM    @00,@12,@SA00009+8                                  0421
         BR    @14                                                 0421
*   END INPCLAUS;                   /*                       @Y30LB54*/
*                                                                  0423
*   /*****************************************************************/
*   /*                                                               */
*   /* STARTDATE(YYDDD) EDITOR FATAL IF INCORRECT                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*STACLAUS:                                                         0423
*   PROC;                           /*                       @Y30LB54*/
STACLAUS STM   @14,@12,@SA00010                                    0423
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* HOW MANY INPUT DIGITS @Y30LB54*/
         L     @03,ENDPRM                                          0424
         SL    @03,STARTPRM                                        0424
         AH    @03,@CH00068                                        0424
         ST    @03,FULLWD2                                         0424
*   IF FULLWD2^=7 THEN              /* (YYDDD)               @Y30LB54*/
         CLC   FULLWD2(4),@CF00408                                 0425
         BE    @RF00425                                            0425
*     RETCODE1=8;                   /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0426
*   ELSE                                                           0427
*     DO;                           /*                       @Y30LB54*/
         B     @RC00425                                            0427
@RF00425 DS    0H                                                  0428
*       DO CTR=1 TO 5 BY 1;         /*                       @Y30LB54*/
         LA    CTR,1                                               0428
@DL00428 DS    0H                                                  0429
*         IF INPUT(STARTPRM+CTR)<'0' THEN                          0429
         LR    @15,CTR                                             0429
         AL    @15,STARTPRM                                        0429
         L     @01,INPTR                                           0429
         ALR   @01,@15                                             0429
         AL    @01,@CF00396                                        0429
         CLI   INPUT(@01),C'0'                                     0429
         BNL   @RF00429                                            0429
*           RETCODE1=8;             /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0430
*         ELSE                                                     0431
*           IF INPUT(STARTPRM+CTR)>'9' THEN                        0431
         B     @RC00429                                            0431
@RF00429 LR    @15,CTR                                             0431
         AL    @15,STARTPRM                                        0431
         L     @01,INPTR                                           0431
         ALR   @01,@15                                             0431
         AL    @01,@CF00396                                        0431
         CLI   INPUT(@01),C'9'                                     0431
         BNH   @RF00431                                            0431
*             RETCODE1=8;           /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0432
*       END;                        /*                       @Y30LB54*/
@RF00431 DS    0H                                                  0433
@RC00429 AH    CTR,@CH00068                                        0433
         CH    CTR,@CH00318                                        0433
         BNH   @DL00428                                            0433
*       EBDIC5=INPUT(STARTPRM+ONE:STARTPRM+FIVE);/* (YYDDD)  @Y30LB54*/
         L     @03,INPTR                                           0434
         AL    @03,STARTPRM                                        0434
         MVC   EBDIC5(5),INPUT(@03)                                0434
*       PACK(CSTART,EBDIC5);        /*                       @Y30LB54*/
         L     @03,LPARMPTR                                        0435
         PACK  CSTART(4,@03),EBDIC5(5)                             0435
*     END;                          /*                       @Y30LB54*/
*   IF RETCODE1=8 THEN                                             0437
@RC00425 CLC   RETCODE1(4),@CF00091                                0437
         BNE   @RF00437                                            0437
*     DO;                           /*                       @Y30LB54*/
*       LINE='ISDAPARM STARTDATE(YYDDD) ERROR';/*            @Y30LB54*/
         MVI   LINE+31(CVTPTR),C' '                                0439
         MVC   LINE+32(100,CVTPTR),LINE+31(CVTPTR)                 0439
         MVC   LINE(31,CVTPTR),@CC00410                            0439
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0440
         ST    @03,@AL00001                                        0440
         L     @15,@CV00037                                        0440
         LA    @01,@AL00001                                        0440
         BALR  @14,@15                                             0440
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0441
         ST    @03,@AL00001                                        0441
         L     @15,@CV00038                                        0441
         LA    @01,@AL00001                                        0441
         BALR  @14,@15                                             0441
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0443
*     ;                             /*                       @Y30LB54*/
@RF00437 DS    0H                                                  0444
*   END STACLAUS;                   /*                       @Y30LB54*/
@EL00010 DS    0H                                                  0444
@EF00010 DS    0H                                                  0444
@ER00010 LM    @14,@12,@SA00010                                    0444
         BR    @14                                                 0444
*                                                                  0445
*   /*****************************************************************/
*   /*                                                               */
*   /* ENDDATE(YYDDD) EDITOR FATAL IF INCORRECT                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0445
*ENDCLAUS:                                                         0445
*   PROC;                           /*                       @Y30LB54*/
ENDCLAUS STM   @14,@12,@SA00011                                    0445
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* HOW MANY DIGITS       @Y30LB54*/
         L     @03,ENDPRM                                          0446
         SL    @03,STARTPRM                                        0446
         AH    @03,@CH00068                                        0446
         ST    @03,FULLWD2                                         0446
*   IF FULLWD2^=7 THEN              /* (YYDDD)               @Y30LB54*/
         CLC   FULLWD2(4),@CF00408                                 0447
         BE    @RF00447                                            0447
*     RETCODE1=8;                   /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0448
*   ELSE                                                           0449
*     DO;                           /*                       @Y30LB54*/
         B     @RC00447                                            0449
@RF00447 DS    0H                                                  0450
*       DO CTR=1 TO 5 BY 1;         /*                       @Y30LB54*/
         LA    CTR,1                                               0450
@DL00450 DS    0H                                                  0451
*         IF INPUT(STARTPRM+CTR)<'0' THEN                          0451
         LR    @15,CTR                                             0451
         AL    @15,STARTPRM                                        0451
         L     @01,INPTR                                           0451
         ALR   @01,@15                                             0451
         AL    @01,@CF00396                                        0451
         CLI   INPUT(@01),C'0'                                     0451
         BNL   @RF00451                                            0451
*           RETCODE1=8;             /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0452
*         ELSE                                                     0453
*           IF INPUT(STARTPRM+CTR)>'9' THEN                        0453
         B     @RC00451                                            0453
@RF00451 LR    @15,CTR                                             0453
         AL    @15,STARTPRM                                        0453
         L     @01,INPTR                                           0453
         ALR   @01,@15                                             0453
         AL    @01,@CF00396                                        0453
         CLI   INPUT(@01),C'9'                                     0453
         BNH   @RF00453                                            0453
*             RETCODE1=8;           /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0454
*       END;                        /*                       @Y30LB54*/
@RF00453 DS    0H                                                  0455
@RC00451 AH    CTR,@CH00068                                        0455
         CH    CTR,@CH00318                                        0455
         BNH   @DL00450                                            0455
*       EBDIC5=INPUT(STARTPRM+ONE:STARTPRM+FIVE);/*          @Y30LB54*/
         L     @03,INPTR                                           0456
         AL    @03,STARTPRM                                        0456
         MVC   EBDIC5(5),INPUT(@03)                                0456
*       PACK(CEND,EBDIC5);          /*                       @Y30LB54*/
         L     @03,LPARMPTR                                        0457
         PACK  CEND(4,@03),EBDIC5(5)                               0457
*     END;                          /*                       @Y30LB54*/
*   IF RETCODE1=8 THEN                                             0459
@RC00447 CLC   RETCODE1(4),@CF00091                                0459
         BNE   @RF00459                                            0459
*     DO;                           /*                       @Y30LB54*/
*       LINE='ISDAPARM ENDDATE(YYDDD) ERROR';/*              @Y30LB54*/
         MVI   LINE+29(CVTPTR),C' '                                0461
         MVC   LINE+30(102,CVTPTR),LINE+29(CVTPTR)                 0461
         MVC   LINE(29,CVTPTR),@CC00416                            0461
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0462
         ST    @03,@AL00001                                        0462
         L     @15,@CV00037                                        0462
         LA    @01,@AL00001                                        0462
         BALR  @14,@15                                             0462
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0463
         ST    @03,@AL00001                                        0463
         L     @15,@CV00038                                        0463
         LA    @01,@AL00001                                        0463
         BALR  @14,@15                                             0463
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0465
*     ;                             /*                       @Y30LB54*/
@RF00459 DS    0H                                                  0466
*   END ENDCLAUS;                   /*                       @Y30LB54*/
@EL00011 DS    0H                                                  0466
@EF00011 DS    0H                                                  0466
@ER00011 LM    @14,@12,@SA00011                                    0466
         BR    @14                                                 0466
*                                                                  0467
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMMARY(YES×NO)                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0467
*SUMCLAUS:                                                         0467
*   PROC;                           /*                       @Y30LB54*/
SUMCLAUS STM   @14,@12,@SA00012                                    0467
*   IF INPUT(STARTPRM+ONE)='Y'×INPUT(STARTPRM+ONE)='N' THEN        0468
         L     @03,INPTR                                           0468
         AL    @03,STARTPRM                                        0468
         CLI   INPUT(@03),C'Y'                                     0468
         BE    @RT00468                                            0468
         L     @03,INPTR                                           0468
         AL    @03,STARTPRM                                        0468
         CLI   INPUT(@03),C'N'                                     0468
         BNE   @RF00468                                            0468
@RT00468 DS    0H                                                  0469
*     DO;                           /*                       @Y30LB54*/
*       CSUMMARY=INPUT(STARTPRM+ONE);/* MOVE VALID DATA TO PARMS   0470
*                                                            @Y30LB54*/
         L     @03,LPARMPTR                                        0470
         L     @01,INPTR                                           0470
         AL    @01,STARTPRM                                        0470
         MVC   CSUMMARY(1,@03),INPUT(@01)                          0470
*       RETURN;                     /*                       @Y30LB54*/
@EL00012 DS    0H                                                  0471
@EF00012 DS    0H                                                  0471
@ER00012 LM    @14,@12,@SA00012                                    0471
         BR    @14                                                 0471
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0473
*     DO;                           /*                       @Y30LB54*/
@RF00468 DS    0H                                                  0474
*       CSUMMARY=DFSUMMAR;          /* TAKE DEFAULTS         @Y30LB54*/
         L     @03,LPARMPTR                                        0474
         MVC   CSUMMARY(1,@03),DFSUMMAR                            0474
*       LINE='ISDAPARM SUMMARY(YES×NO) ERROR';/*             @Y30LB54*/
         MVI   LINE+30(CVTPTR),C' '                                0475
         MVC   LINE+31(101,CVTPTR),LINE+30(CVTPTR)                 0475
         MVC   LINE(30,CVTPTR),@CC00422                            0475
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0476
         ST    @03,@AL00001                                        0476
         L     @15,@CV00037                                        0476
         LA    @01,@AL00001                                        0476
         BALR  @14,@15                                             0476
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0477
         ST    @03,@AL00001                                        0477
         L     @15,@CV00038                                        0477
         LA    @01,@AL00001                                        0477
         BALR  @14,@15                                             0477
*     END;                          /*                       @Y30LB54*/
*   END SUMCLAUS;                   /*                       @Y30LB54*/
         B     @EL00012                                            0479
*                                                                  0480
*/*DEVTYPE(SA×RC×RD×CS×DA)                                   @Y30LB54*/
*                                                                  0480
*DEVCLAUS:                                                         0480
*   PROC;                           /*                       @Y30LB54*/
DEVCLAUS STM   @14,@12,@SA00013                                    0480
*   STARTPRM=STARTPRM+ONE;          /* POINT TO FIRST DIGIT  @Y30LB54*/
         LA    @03,1                                               0481
         AL    @03,STARTPRM                                        0481
         ST    @03,STARTPRM                                        0481
*   DO CTR1=1 TO 5 BY 1;            /* SEARCH FOR VALID ID   @Y30LB54*/
         LA    CTR1,1                                              0482
@DL00482 DS    0H                                                  0483
*     IF INPUT(STARTPRM:STARTPRM+ONE)=DEVARG(CTR1) THEN            0483
         LR    @05,CTR1                                            0483
         ALR   @05,@05                                             0483
         L     @03,INPTR                                           0483
         AL    @03,STARTPRM                                        0483
         AL    @03,@CF00396                                        0483
         LA    @01,DEVARG-2(@05)                                   0483
         CLC   INPUT(2,@03),0(@01)                                 0483
         BNE   @RF00483                                            0483
*       DO;                         /*                       @Y30LB54*/
*         CTYPE(ONE:TWO)=INPUT(STARTPRM:STARTPRM+ONE);/*     @Y30LB54*/
         L     @03,LPARMPTR                                        0485
         L     @01,INPTR                                           0485
         AL    @01,STARTPRM                                        0485
         AL    @01,@CF00396                                        0485
         MVC   CTYPE(2,@03),INPUT(@01)                             0485
*         RETURN;                   /*                       @Y30LB54*/
@EL00013 DS    0H                                                  0486
@EF00013 DS    0H                                                  0486
@ER00013 LM    @14,@12,@SA00013                                    0486
         BR    @14                                                 0486
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0488
*       ;                           /*                       @Y30LB54*/
@RF00483 DS    0H                                                  0489
*   END;                            /*                       @Y30LB54*/
         AH    CTR1,@CH00068                                       0489
         CH    CTR1,@CH00318                                       0489
         BNH   @DL00482                                            0489
*   CTYPE=DFTYPE;                   /* TAKE DEFAULTS         @Y30LB54*/
         L     @03,LPARMPTR                                        0490
         MVC   CTYPE(2,@03),DFTYPE                                 0490
*   LINE='ISDAPARM DEVTYPE(SA×RC×RD×CS×DA) ERROR';/*         @Y30LB54*/
         MVI   LINE+38(CVTPTR),C' '                                0491
         MVC   LINE+39(93,CVTPTR),LINE+38(CVTPTR)                  0491
         MVC   LINE(38,CVTPTR),@CC00429                            0491
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @03,@PC00001                                        0492
         ST    @03,@AL00001                                        0492
         L     @15,@CV00037                                        0492
         LA    @01,@AL00001                                        0492
         BALR  @14,@15                                             0492
*   CALL ISDATYPE(WORKPTR);         /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0493
         ST    @03,@AL00001                                        0493
         L     @15,@CV00038                                        0493
         LA    @01,@AL00001                                        0493
         BALR  @14,@15                                             0493
*   DCL                                                            0494
*     1 DEVTAB(5) STATIC LOCAL,     /* TABLE OF VALID ID ARGUMENTS 0494
*                                                            @Y30LB54*/
*      2 DEVARG CHAR(2) INIT('SA','RC','RD','CS','DA');/*    @Y30LB54*/
*   END DEVCLAUS;                   /*                       @Y30LB54*/
         B     @EL00013                                            0495
*                                                                  0496
*   /*****************************************************************/
*   /*                                                               */
*   /* FSCODE(XXXXXXXX × XXXX)                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0496
*FSCCLAUS:                                                         0496
*   PROC;                           /*                       @Y30LB54*/
FSCCLAUS STM   @14,@12,@SA00014                                    0496
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* HOW MANY INPUT DIGITS @Y30LB54*/
         L     @03,ENDPRM                                          0497
         SL    @03,STARTPRM                                        0497
         AH    @03,@CH00068                                        0497
         ST    @03,FULLWD2                                         0497
*   IF FULLWD2^=6&FULLWD2^=10 THEN                                 0498
         CLC   FULLWD2(4),@CF00207                                 0498
         BE    @RF00498                                            0498
         CLC   FULLWD2(4),@CF00441                                 0498
         BE    @RF00498                                            0498
*     RETCODE1=8;                   /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0499
*   ELSE                                                           0500
*     DO;                           /*                       @Y30LB54*/
         B     @RC00498                                            0500
@RF00498 DS    0H                                                  0501
*       LINE(ONE:FOUR)='00000000'X; /* ZERO AREA TO BE CONVERTED   0501
*                                                            @Y30LB54*/
         MVC   LINE(4,CVTPTR),@CB00122                             0501
*       STARTPRM=STARTPRM+ONE;      /* POINT TO FIRST DIGIT  @Y30LB54*/
         LA    @05,1                                               0502
         AL    @05,STARTPRM                                        0502
         ST    @05,STARTPRM                                        0502
*       CTR1=FULLWD2-TWO;           /* TELL THEM HOW MANY DIGITS   0503
*                                                            @Y30LB54*/
         L     CTR1,FULLWD2                                        0503
         BCTR  CTR1,0                                              0503
         BCTR  CTR1,0                                              0503
*       CALL EBDICHEX;              /*                       @Y30LB54*/
         BAL   @14,EBDICHEX                                        0504
*       IF RETCODE1^=0 THEN                                        0505
         ICM   @03,15,RETCODE1                                     0505
         BNZ   @RT00505                                            0505
*         ;                         /*                       @Y30LB54*/
*       ELSE                                                       0507
*         CFSCONLY=LINE(ONE:FOUR);  /* MOVE TO PARMS         @Y30LB54*/
         L     @03,LPARMPTR                                        0507
         MVC   CFSCONLY(4,@03),LINE(CVTPTR)                        0507
*     END;                          /*                       @Y30LB54*/
@RT00505 DS    0H                                                  0509
*   IF RETCODE1^=0 THEN                                            0509
@RC00498 SLR   @03,@03                                             0509
         C     @03,RETCODE1                                        0509
         BE    @RF00509                                            0509
*     DO;                           /*                       @Y30LB54*/
*       RETCODE1=0;                 /* TAKE DEFAULTS ALLOW CONTROL TO
*                                      CONTINUE              @Y30LB54*/
         ST    @03,RETCODE1                                        0511
*       CFSCONLY=DFFSCONL;          /* TAKE DEFAULTS         @Y30LB54*/
         L     @03,LPARMPTR                                        0512
         MVC   CFSCONLY(4,@03),DFFSCONL                            0512
*       LINE='ISDAPARM FSCODE(XXXXXXXX × XXXX) ERROR';/*     @Y30LB54*/
         MVI   LINE+38(CVTPTR),C' '                                0513
         MVC   LINE+39(93,CVTPTR),LINE+38(CVTPTR)                  0513
         MVC   LINE(38,CVTPTR),@CC00442                            0513
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0514
         ST    @03,@AL00001                                        0514
         L     @15,@CV00037                                        0514
         LA    @01,@AL00001                                        0514
         BALR  @14,@15                                             0514
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0515
         ST    @03,@AL00001                                        0515
         L     @15,@CV00038                                        0515
         LA    @01,@AL00001                                        0515
         BALR  @14,@15                                             0515
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0517
*     ;                             /*                       @Y30LB54*/
@RF00509 DS    0H                                                  0518
*   END FSCCLAUS;                   /*                       @Y30LB54*/
@EL00014 DS    0H                                                  0518
@EF00014 DS    0H                                                  0518
@ER00014 LM    @14,@12,@SA00014                                    0518
         BR    @14                                                 0518
*                                                                  0519
*   /*****************************************************************/
*   /*                                                               */
*   /* SSID(XXX)                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0519
*SSICLAUS:                                                         0519
*   PROC;                           /*                       @Y30LB54*/
SSICLAUS STM   @14,@12,@SA00015                                    0519
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /*                       @Y30LB54*/
         L     @03,ENDPRM                                          0520
         SL    @03,STARTPRM                                        0520
         AH    @03,@CH00068                                        0520
         ST    @03,FULLWD2                                         0520
*   IF FULLWD2^=5 THEN                                             0521
         CLC   FULLWD2(4),@CF00318                                 0521
         BE    @RF00521                                            0521
*     RETCODE1=8;                   /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0522
*   ELSE                                                           0523
*     DO;                           /*                       @Y30LB54*/
         B     @RC00521                                            0523
@RF00521 DS    0H                                                  0524
*       INPUT(STARTPRM)='0';        /*                       @Y30LB54*/
         L     @05,INPTR                                           0524
         AL    @05,STARTPRM                                        0524
         AL    @05,@CF00396                                        0524
         MVI   INPUT(@05),C'0'                                     0524
*       CTR1=4;                     /*                       @Y30LB54*/
         LA    CTR1,4                                              0525
*       CALL EBDICHEX;              /*                       @Y30LB54*/
         BAL   @14,EBDICHEX                                        0526
*       IF RETCODE1^=0 THEN                                        0527
         ICM   @03,15,RETCODE1                                     0527
         BNZ   @RT00527                                            0527
*         ;                         /*                       @Y30LB54*/
*       ELSE                                                       0529
*         CSSIDF=LINE(ONE:TWO);     /*                       @Y30LB54*/
         L     @03,LPARMPTR                                        0529
         MVC   CSSIDF(2,@03),LINE(CVTPTR)                          0529
*     END;                          /*                       @Y30LB54*/
@RT00527 DS    0H                                                  0531
*   IF RETCODE1^=0 THEN                                            0531
@RC00521 SLR   @03,@03                                             0531
         C     @03,RETCODE1                                        0531
         BE    @RF00531                                            0531
*     DO;                           /*                       @Y30LB54*/
*       RETCODE1=0;                 /* TAKE DEFAULTS ALLOW CONTROL TO
*                                      CONTINUE              @Y30LB54*/
         ST    @03,RETCODE1                                        0533
*       CSSIDF=DFSSIDF;             /* TAKE DEFAULTS         @Y30LB54*/
         L     @03,LPARMPTR                                        0534
         MVC   CSSIDF(2,@03),DFSSIDF                               0534
*       LINE='ISDAPARM SSID(XXX) ERROR ';/*                  @Y30LB54*/
         MVI   LINE+25(CVTPTR),C' '                                0535
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0535
         MVC   LINE(25,CVTPTR),@CC00448                            0535
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0536
         ST    @03,@AL00001                                        0536
         L     @15,@CV00037                                        0536
         LA    @01,@AL00001                                        0536
         BALR  @14,@15                                             0536
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0537
         ST    @03,@AL00001                                        0537
         L     @15,@CV00038                                        0537
         LA    @01,@AL00001                                        0537
         BALR  @14,@15                                             0537
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0539
*     ;                             /*                       @Y30LB54*/
@RF00531 DS    0H                                                  0540
*   END SSICLAUS;                   /*                       @Y30LB54*/
@EL00015 DS    0H                                                  0540
@EF00015 DS    0H                                                  0540
@ER00015 LM    @14,@12,@SA00015                                    0540
         BR    @14                                                 0540
*                                                                  0541
*   /*****************************************************************/
*   /*                                                               */
*   /* RATIO(XX)                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0541
*RATCLAUS:                                                         0541
*   PROC;                           /*                       @Y30LB54*/
RATCLAUS STM   @14,@12,@SA00016                                    0541
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /*                       @Y30LB54*/
         L     @03,ENDPRM                                          0542
         SL    @03,STARTPRM                                        0542
         AH    @03,@CH00068                                        0542
         ST    @03,FULLWD2                                         0542
*   IF FULLWD2^=4 THEN                                             0543
         CLC   FULLWD2(4),@CF00071                                 0543
         BE    @RF00543                                            0543
*     RETCODE1=8;                   /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0544
*   ELSE                                                           0545
*     DO;                           /*                       @Y30LB54*/
         B     @RC00543                                            0545
@RF00543 DS    0H                                                  0546
*       STARTPRM=STARTPRM+ONE;      /*                       @Y30LB54*/
         LA    @03,1                                               0546
         AL    @03,STARTPRM                                        0546
         ST    @03,STARTPRM                                        0546
*       IF INPUT(STARTPRM:STARTPRM+ONE)<'00' THEN                  0547
         L     @03,INPTR                                           0547
         AL    @03,STARTPRM                                        0547
         AL    @03,@CF00396                                        0547
         CLC   INPUT(2,@03),@CC00454                               0547
         BNL   @RF00547                                            0547
*         RETCODE1=8;               /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0548
*       ELSE                                                       0549
*         IF INPUT(STARTPRM:STARTPRM+ONE)>'99' THEN                0549
         B     @RC00547                                            0549
@RF00547 L     @03,INPTR                                           0549
         AL    @03,STARTPRM                                        0549
         AL    @03,@CF00396                                        0549
         CLC   INPUT(2,@03),@CC00455                               0549
         BNH   @RF00549                                            0549
*           RETCODE1=8;             /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0550
*         ELSE                                                     0551
*           IF INPUT(STARTPRM+ONE)<'0' THEN                        0551
         B     @RC00549                                            0551
@RF00549 L     @03,INPTR                                           0551
         AL    @03,STARTPRM                                        0551
         CLI   INPUT(@03),C'0'                                     0551
         BNL   @RF00551                                            0551
*             RETCODE1=8;           /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0552
*           ELSE                                                   0553
*             IF INPUT(STARTPRM+ONE)>'9' THEN                      0553
         B     @RC00551                                            0553
@RF00551 L     @03,INPTR                                           0553
         AL    @03,STARTPRM                                        0553
         CLI   INPUT(@03),C'9'                                     0553
         BNH   @RF00553                                            0553
*               RETCODE1=8;         /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0554
*             ELSE                                                 0555
*               CRATIO=INPUT(STARTPRM:STARTPRM+ONE);               0555
         B     @RC00553                                            0555
@RF00553 L     @03,LPARMPTR                                        0555
         L     @01,INPTR                                           0555
         AL    @01,STARTPRM                                        0555
         AL    @01,@CF00396                                        0555
         MVC   CRATIO(2,@03),INPUT(@01)                            0555
*     END;                          /*                       @Y30LB54*/
@RC00553 DS    0H                                                  0556
@RC00551 DS    0H                                                  0556
@RC00549 DS    0H                                                  0556
@RC00547 DS    0H                                                  0557
*   IF RETCODE1^=0 THEN                                            0557
@RC00543 SLR   @03,@03                                             0557
         C     @03,RETCODE1                                        0557
         BE    @RF00557                                            0557
*     DO;                           /*                       @Y30LB54*/
*       RETCODE1=0;                 /* TAKE DEFAULTS ALLOW CONTROL TO
*                                      CONTINUE              @Y30LB54*/
         ST    @03,RETCODE1                                        0559
*       CRATIO=DFRATIO;             /* TAKE DEFAULTS         @Y30LB54*/
         L     @03,LPARMPTR                                        0560
         MVC   CRATIO(2,@03),DFRATIO                               0560
*       LINE='ISDAPARM RATIO(XX) ERROR';/*                   @Y30LB54*/
         MVI   LINE+24(CVTPTR),C' '                                0561
         MVC   LINE+25(107,CVTPTR),LINE+24(CVTPTR)                 0561
         MVC   LINE(24,CVTPTR),@CC00456                            0561
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0562
         ST    @03,@AL00001                                        0562
         L     @15,@CV00037                                        0562
         LA    @01,@AL00001                                        0562
         BALR  @14,@15                                             0562
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0563
         ST    @03,@AL00001                                        0563
         L     @15,@CV00038                                        0563
         LA    @01,@AL00001                                        0563
         BALR  @14,@15                                             0563
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0565
*     ;                             /*                       @Y30LB54*/
@RF00557 DS    0H                                                  0566
*   END RATCLAUS;                   /*                       @Y30LB54*/
@EL00016 DS    0H                                                  0566
@EF00016 DS    0H                                                  0566
@ER00016 LM    @14,@12,@SA00016                                    0566
         BR    @14                                                 0566
*                                                                  0567
*   /*****************************************************************/
*   /*                                                               */
*   /* CSN(XXXYYYYYYYYY)                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0567
*CSNCLAUS:                                                         0567
*   PROC;                           /*                       @Y30LB54*/
CSNCLAUS STM   @14,@12,@SA00017                                    0567
*   CSERIAL=' ';                    /*                       @Y30LB54*/
         L     @03,LPARMPTR                                        0568
         MVI   CSERIAL+1(@03),C' '                                 0568
         MVC   CSERIAL+2(10,@03),CSERIAL+1(@03)                    0568
         MVI   CSERIAL(@03),C' '                                   0568
*   FULLWD2=ENDPRM-STARTPRM-ONE;    /*                       @Y30LB54*/
         L     @03,ENDPRM                                          0569
         SL    @03,STARTPRM                                        0569
         BCTR  @03,0                                               0569
         ST    @03,FULLWD2                                         0569
*   IF FULLWD2>12×FULLWD2<1 THEN                                   0570
         L     @03,FULLWD2                                         0570
         CH    @03,@CH00034                                        0570
         BH    @RT00570                                            0570
         ICM   @03,15,FULLWD2                                      0570
         BP    @RF00570                                            0570
@RT00570 DS    0H                                                  0571
*     DO;                           /*                       @Y30LB54*/
*       CSERIAL=DFSERIAL;           /* TAKE DEFAULTS         @Y30LB54*/
         L     @03,LPARMPTR                                        0572
         MVC   CSERIAL(12,@03),DFSERIAL                            0572
*       LINE='ISDAPARM CSN(XXXYYYYYYYYY) ERROR';/*           @Y30LB54*/
         MVI   LINE+32(CVTPTR),C' '                                0573
         MVC   LINE+33(99,CVTPTR),LINE+32(CVTPTR)                  0573
         MVC   LINE(32,CVTPTR),@CC00461                            0573
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0574
         ST    @03,@AL00001                                        0574
         L     @15,@CV00037                                        0574
         LA    @01,@AL00001                                        0574
         BALR  @14,@15                                             0574
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0575
         ST    @03,@AL00001                                        0575
         L     @15,@CV00038                                        0575
         LA    @01,@AL00001                                        0575
         BALR  @14,@15                                             0575
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0577
*     CSERIAL(ONE:FULLWD2)=INPUT(STARTPRM+ONE:ENDPRM-ONE);/* @Y30LB54*/
         B     @RC00570                                            0577
@RF00570 L     @03,LPARMPTR                                        0577
         L     @15,FULLWD2                                         0577
         BCTR  @15,0                                               0577
         L     @01,INPTR                                           0577
         AL    @01,STARTPRM                                        0577
         EX    @15,@SM00512                                        0577
*   END CSNCLAUS;                   /*                       @Y30LB54*/
@EL00017 DS    0H                                                  0578
@EF00017 DS    0H                                                  0578
@ER00017 LM    @14,@12,@SA00017                                    0578
         BR    @14                                                 0578
*                                                                  0579
*   /*****************************************************************/
*   /*                                                               */
*   /* INCLUDE(XXX,YYY,ETC)                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0579
*INCCLAUS:                                                         0579
*   PROC;                           /*                       @Y30LB54*/
INCCLAUS STM   @14,@12,@SA00018                                    0579
*   CREPORTS=CREPORTS&&CREPORTS;    /* CLEAR ALL DEFAULTS    @Y30LB54*/
         L     @03,LPARMPTR                                        0580
         XC    CREPORTS(12,@03),CREPORTS(@03)                      0580
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* FIND TOTAL LENGTH     @Y30LB54*/
         L     @03,ENDPRM                                          0581
         SL    @03,STARTPRM                                        0581
         AH    @03,@CH00068                                        0581
         ST    @03,FULLWD2                                         0581
*   IF FULLWD2^>4 THEN              /* CANNOT DO TABLE SEARCH@Y30LB54*/
         L     @03,FULLWD2                                         0582
         CH    @03,@CH00071                                        0582
         BH    @RF00582                                            0582
*     RETCODE1=8;                   /* ERROR INPUT           @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0583
*   ELSE                                                           0584
*     ;                             /*                       @Y30LB54*/
@RF00582 DS    0H                                                  0585
*   DO WHILE STARTPRM>0;            /* PROCESS ALL INPUTS    @Y30LB54*/
         B     @DE00585                                            0585
@DL00585 DS    0H                                                  0586
*     STARTPRM=STARTPRM+ONE;        /* POINT TO FIRST DIGIT  @Y30LB54*/
         LA    @03,1                                               0586
         AL    @03,STARTPRM                                        0586
         ST    @03,STARTPRM                                        0586
*     DO CTR1=1 TO NREPORTS BY 1;   /* LOOK UP ALL REPORTS   @ZM30976*/
         LA    CTR1,1                                              0587
@DL00587 DS    0H                                                  0588
*       IF INPUT(STARTPRM:STARTPRM+TWO)=RPTARG(CTR1) THEN          0588
         LR    @05,CTR1                                            0588
         SLA   @05,3                                               0588
         L     @03,INPTR                                           0588
         AL    @03,STARTPRM                                        0588
         AL    @03,@CF00396                                        0588
         LA    @01,RPTARG-8(@05)                                   0588
         CLC   INPUT(3,@03),0(@01)                                 0588
         BNE   @RF00588                                            0588
*         DO;                       /*                       @Y30LB54*/
*           FULLWD2=RPTFUNCA(CTR1)+ONE;/* PICK UP DISPLACEMENT OF  0590
*                                      REPORT                @Y30LB54*/
         LA    @03,1                                               0590
         AL    @03,RPTFUNCA-8(@05)                                 0590
         ST    @03,FULLWD2                                         0590
*           ISDAPRMS(FULLWD2)=ISDAPRMS(FULLWD2)×RPTFUNCH(CTR1);/*  0591
*                                      TURN IT ON            @Y30LB54*/
         L     @05,LPARMPTR                                        0591
         AL    @05,FULLWD2                                         0591
         AL    @05,@CF00396                                        0591
         LR    @03,CTR1                                            0591
         SLA   @03,3                                               0591
         LA    @01,RPTFUNCH-8(@03)                                 0591
         OC    ISDAPRMS(1,@05),0(@01)                              0591
*           CALL FNDCOMMA;          /* FIND COMMA OR END OF PARMS  0592
*                                                            @Y30LB54*/
         BAL   @14,FNDCOMMA                                        0592
*           CTR1=100;               /* START THIS LOOP OVER  @Y30LB54*/
         LA    CTR1,100                                            0593
*         END;                      /*                       @Y30LB54*/
*       ELSE                                                       0595
*         ;                         /*                       @Y30LB54*/
@RF00588 DS    0H                                                  0596
*     END;                          /*                       @Y30LB54*/
         AH    CTR1,@CH00068                                       0596
         CH    CTR1,@CH00205                                       0596
         BNH   @DL00587                                            0596
*     IF CTR1^>99 THEN                                             0597
         CH    CTR1,@CH00386                                       0597
         BH    @RF00597                                            0597
*       DO;                         /* INVALID INPUT DATA    @ZA00669*/
*         STARTPRM=0;               /* GET OUT OF LOOP       @ZA00669*/
         SLR   @03,@03                                             0599
         ST    @03,STARTPRM                                        0599
*         RETCODE1=8;               /* ERROR ON INPUT        @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0600
*       END;                        /* END ERROR SET         @ZA00669*/
*     ELSE                                                         0602
*       ;                           /*                       @Y30LB54*/
@RF00597 DS    0H                                                  0603
*   END;                            /*                       @Y30LB54*/
@DE00585 SLR   @03,@03                                             0603
         C     @03,STARTPRM                                        0603
         BL    @DL00585                                            0603
*   IF RETCODE1^=0 THEN                                            0604
         C     @03,RETCODE1                                        0604
         BE    @RF00604                                            0604
*     DO;                           /*                       @Y30LB54*/
*       RETCODE1=0;                 /* ALLOW TO TAKE DEFAULTS@Y30LB54*/
         ST    @03,RETCODE1                                        0606
*       CREPORTS=DFREPORT;          /* TAKE DEFAULTS FOR REPORTS   0607
*                                                            @Y30LB54*/
         L     @03,LPARMPTR                                        0607
         MVC   CREPORTS(12,@03),DFREPORT                           0607
*       LINE='ISDAPARM INCLUDE(DCS,PAD,SUM,DHE,DHU,FSC,EQC,DCK,TLX,CSB,
*SF,DAT,DRC,APR,SUU) ERROR';        /*                       @ZM30976*/
         MVI   LINE+83(CVTPTR),C' '                                0608
         MVC   LINE+84(48,CVTPTR),LINE+83(CVTPTR)                  0608
         MVC   LINE(83,CVTPTR),@CC00467                            0608
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0609
         ST    @03,@AL00001                                        0609
         L     @15,@CV00037                                        0609
         LA    @01,@AL00001                                        0609
         BALR  @14,@15                                             0609
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0610
         ST    @03,@AL00001                                        0610
         L     @15,@CV00038                                        0610
         LA    @01,@AL00001                                        0610
         BALR  @14,@15                                             0610
*     END;                          /*                       @Y30LB54*/
*   END INCCLAUS;                   /*                       @Y30LB54*/
@EL00018 DS    0H                                                  0612
@EF00018 DS    0H                                                  0612
@ER00018 LM    @14,@12,@SA00018                                    0612
         BR    @14                                                 0612
*                                                                  0613
*   /*****************************************************************/
*   /*                                                               */
*   /* EXCLUDE(XXX,YYY,ETC)                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0613
*EXCCLAUS:                                                         0613
*   PROC;                           /*                       @Y30LB54*/
EXCCLAUS STM   @14,@12,@SA00019                                    0613
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* FIND TOTAL LENGTH     @Y30LB54*/
         L     @03,ENDPRM                                          0614
         SL    @03,STARTPRM                                        0614
         AH    @03,@CH00068                                        0614
         ST    @03,FULLWD2                                         0614
*   IF FULLWD2^>4 THEN              /* CANNOT DO TABLE SEARCH@Y30LB54*/
         L     @03,FULLWD2                                         0615
         CH    @03,@CH00071                                        0615
         BH    @RF00615                                            0615
*     RETCODE1=8;                   /* ERROR INPUT           @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0616
*   ELSE                                                           0617
*     ;                             /*                       @Y30LB54*/
@RF00615 DS    0H                                                  0618
*   DO WHILE STARTPRM>0;            /* PROCESS ALL INPUTS    @Y30LB54*/
         B     @DE00618                                            0618
@DL00618 DS    0H                                                  0619
*     STARTPRM=STARTPRM+ONE;        /* POINT TO FIRST DIGIT  @Y30LB54*/
         LA    @03,1                                               0619
         AL    @03,STARTPRM                                        0619
         ST    @03,STARTPRM                                        0619
*     DO CTR1=1 TO NREPORTS BY 1;   /* LOOK UP ALL REPORTS   @ZM30976*/
         LA    CTR1,1                                              0620
@DL00620 DS    0H                                                  0621
*       IF INPUT(STARTPRM:STARTPRM+TWO)=RPTARG(CTR1) THEN          0621
         LR    @05,CTR1                                            0621
         SLA   @05,3                                               0621
         L     @03,INPTR                                           0621
         AL    @03,STARTPRM                                        0621
         AL    @03,@CF00396                                        0621
         LA    @01,RPTARG-8(@05)                                   0621
         CLC   INPUT(3,@03),0(@01)                                 0621
         BNE   @RF00621                                            0621
*         DO;                       /*                       @Y30LB54*/
*           FULLWD2=RPTFUNCA(CTR1)+ONE;/* PICK UP DISPLACEMENT OF  0623
*                                      REPORT                @Y30LB54*/
         LA    @03,1                                               0623
         AL    @03,RPTFUNCA-8(@05)                                 0623
         ST    @03,FULLWD2                                         0623
*           ISDAPRMS(FULLWD2)=ISDAPRMS(FULLWD2)×RPTFUNCH(CTR1);/*  0624
*                                      TURN IT ON            @Y30LB54*/
         L     @05,LPARMPTR                                        0624
         AL    @05,FULLWD2                                         0624
         AL    @05,@CF00396                                        0624
         LR    @03,CTR1                                            0624
         SLA   @03,3                                               0624
         LA    @01,RPTFUNCH-8(@03)                                 0624
         OC    ISDAPRMS(1,@05),0(@01)                              0624
*           ISDAPRMS(FULLWD2)=ISDAPRMS(FULLWD2)&&RPTFUNCH(CTR1);/* 0625
*                                      TURN IT OFF           @Y30LB54*/
         L     @05,LPARMPTR                                        0625
         AL    @05,FULLWD2                                         0625
         AL    @05,@CF00396                                        0625
         LR    @03,CTR1                                            0625
         SLA   @03,3                                               0625
         LA    @01,RPTFUNCH-8(@03)                                 0625
         XC    ISDAPRMS(1,@05),0(@01)                              0625
*           CALL FNDCOMMA;          /* FIND COMMA OR END OF PARMS  0626
*                                                            @Y30LB54*/
         BAL   @14,FNDCOMMA                                        0626
*           CTR1=100;               /* START THIS LOOP OVER  @Y30LB54*/
         LA    CTR1,100                                            0627
*         END;                      /*                       @Y30LB54*/
*       ELSE                                                       0629
*         ;                         /*                       @Y30LB54*/
@RF00621 DS    0H                                                  0630
*     END;                          /*                       @Y30LB54*/
         AH    CTR1,@CH00068                                       0630
         CH    CTR1,@CH00205                                       0630
         BNH   @DL00620                                            0630
*     IF CTR1^>99 THEN                                             0631
         CH    CTR1,@CH00386                                       0631
         BH    @RF00631                                            0631
*       DO;                         /* INVALID INPUT DATA    @ZA00669*/
*         STARTPRM=0;               /* GET OUT OF LOOP       @ZA00669*/
         SLR   @03,@03                                             0633
         ST    @03,STARTPRM                                        0633
*         RETCODE1=8;               /* ERROR ON INPUT        @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0634
*       END;                        /* END ERROR SET         @ZA00669*/
*     ELSE                                                         0636
*       ;                           /*                       @Y30LB54*/
@RF00631 DS    0H                                                  0637
*   END;                            /*                       @Y30LB54*/
@DE00618 SLR   @03,@03                                             0637
         C     @03,STARTPRM                                        0637
         BL    @DL00618                                            0637
*   IF RETCODE1^=0 THEN                                            0638
         C     @03,RETCODE1                                        0638
         BE    @RF00638                                            0638
*     DO;                           /*                       @Y30LB54*/
*       RETCODE1=0;                 /* ALLOW TO TAKE DEFAULTS@Y30LB54*/
         ST    @03,RETCODE1                                        0640
*       CREPORTS=DFREPORT;          /* TAKE DEFAULTS FOR REPORTS   0641
*                                                            @Y30LB54*/
         L     @03,LPARMPTR                                        0641
         MVC   CREPORTS(12,@03),DFREPORT                           0641
*       LINE='ISDAPARM EXCLUDE(DCS,PAD,SUM,DHE,DHU,FSC,EQC,DCK,TLX,CSB,
*SF,DAT,DRC,APR,SUU) ERROR';        /*                       @ZM30976*/
         MVI   LINE+83(CVTPTR),C' '                                0642
         MVC   LINE+84(48,CVTPTR),LINE+83(CVTPTR)                  0642
         MVC   LINE(83,CVTPTR),@CC00476                            0642
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0643
         ST    @03,@AL00001                                        0643
         L     @15,@CV00037                                        0643
         LA    @01,@AL00001                                        0643
         BALR  @14,@15                                             0643
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/
         L     @03,@PC00001                                        0644
         ST    @03,@AL00001                                        0644
         L     @15,@CV00038                                        0644
         LA    @01,@AL00001                                        0644
         BALR  @14,@15                                             0644
*     END;                          /*                       @Y30LB54*/
*   END EXCCLAUS;                   /*                       @Y30LB54*/
@EL00019 DS    0H                                                  0646
@EF00019 DS    0H                                                  0646
@ER00019 LM    @14,@12,@SA00019                                    0646
         BR    @14                                                 0646
*                                                                  0647
*   /*****************************************************************/
*   /*                                                               */
*   /* DETAIL(ALL × NONE × 0,1,2,3,4,5)                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0647
*DETCLAUS:                                                         0647
*   PROC;                           /*                       @Y30LB54*/
DETCLAUS STM   @14,@12,@SA00020                                    0647
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* FIND TOTAL LENGTH     @Y30LB54*/
         L     @03,ENDPRM                                          0648
         SL    @03,STARTPRM                                        0648
         AH    @03,@CH00068                                        0648
         ST    @03,FULLWD2                                         0648
*   CDETAIL='00'X;                  /* TURN OFF DEFAULTS     @Y30LB54*/
         L     @03,LPARMPTR                                        0649
         MVI   CDETAIL(@03),X'00'                                  0649
*   IF FULLWD2^>2 THEN                                             0650
         L     @03,FULLWD2                                         0650
         CH    @03,@CH00066                                        0650
         BH    @RF00650                                            0650
*     RETCODE1=8;                   /* ERROR ON INPUT()      @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0651
*   ELSE                                                           0652
*     DO;                           /*                       @Y30LB54*/
         B     @RC00650                                            0652
@RF00650 DS    0H                                                  0653
*       IF INPUT(STARTPRM+ONE)='A' THEN                            0653
         L     @03,INPTR                                           0653
         AL    @03,STARTPRM                                        0653
         CLI   INPUT(@03),C'A'                                     0653
         BNE   @RF00653                                            0653
*         CDETAIL='FF'X;            /* TURN ON ALL BITS      @Y30LB54*/
         L     @03,LPARMPTR                                        0654
         MVI   CDETAIL(@03),X'FF'                                  0654
*       ELSE                                                       0655
*         IF INPUT(STARTPRM+ONE)='N' THEN                          0655
         B     @RC00653                                            0655
@RF00653 L     @03,INPTR                                           0655
         AL    @03,STARTPRM                                        0655
         CLI   INPUT(@03),C'N'                                     0655
         BNE   @RF00655                                            0655
*           CDETAIL='00'X;          /* TURN OFF ALL BITS     @Y30LB54*/
         L     @03,LPARMPTR                                        0656
         MVI   CDETAIL(@03),X'00'                                  0656
*         ELSE                                                     0657
*           DO WHILE STARTPRM>0;    /*                       @Y30LB54*/
         B     @RC00655                                            0657
@RF00655 B     @DE00657                                            0657
@DL00657 DS    0H                                                  0658
*             DO CTR=1 TO 6 BY 1;   /*                       @Y30LB54*/
         LA    CTR,1                                               0658
@DL00658 DS    0H                                                  0659
*               IF INPUT(STARTPRM+ONE)=DETARG(CTR) THEN            0659
         LR    @15,CTR                                             0659
         ALR   @15,@15                                             0659
         L     @01,INPTR                                           0659
         AL    @01,STARTPRM                                        0659
         LA    @14,DETARG-2(@15)                                   0659
         CLC   INPUT(1,@01),0(@14)                                 0659
         BNE   @RF00659                                            0659
*                 DO;               /*                       @Y30LB54*/
*                   CDETAIL=CDETAIL×DETFUNC(CTR);/* TURN ON CORRECT
*                                      BITS                  @Y30LB54*/
         L     @01,LPARMPTR                                        0661
         LA    @14,DETFUNC-2(@15)                                  0661
         OC    CDETAIL(1,@01),0(@14)                               0661
*                   CTR=100;        /* TERMINATE THIS PORTION OF LOOP
*                                                            @Y30LB54*/
         LA    CTR,100                                             0662
*                 END;              /*                       @Y30LB54*/
*               ELSE                                               0664
*                 ;                 /*                       @Y30LB54*/
@RF00659 DS    0H                                                  0665
*             END;                  /*                       @Y30LB54*/
         AH    CTR,@CH00068                                        0665
         CH    CTR,@CH00207                                        0665
         BNH   @DL00658                                            0665
*             IF CTR^>99 THEN                                      0666
         CH    CTR,@CH00386                                        0666
         BH    @RF00666                                            0666
*               DO;                 /* INVALID INPUT DATA    @ZA00669*/
*                 STARTPRM=0;       /* GET OUT OF LOOP       @ZA00669*/
         SLR   @03,@03                                             0668
         ST    @03,STARTPRM                                        0668
*                 RETCODE1=8;       /* INVALID INPUT DATA    @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0669
*               END;                /* END ERROR SET         @ZA00669*/
*             ELSE                                                 0671
*               CALL FNDCOMMA;      /*                       @Y30LB54*/
         B     @RC00666                                            0671
@RF00666 BAL   @14,FNDCOMMA                                        0671
*           END;                    /*                       @Y30LB54*/
@RC00666 DS    0H                                                  0672
@DE00657 ICM   @03,15,STARTPRM                                     0672
         BP    @DL00657                                            0672
*     END;                          /*                       @Y30LB54*/
@RC00655 DS    0H                                                  0673
@RC00653 DS    0H                                                  0674
*   IF RETCODE1^=0 THEN                                            0674
@RC00650 ICM   @03,15,RETCODE1                                     0674
         BZ    @RF00674                                            0674
*     DO;                           /*                       @Y30LB54*/
*       CDETAIL=DFDETAIL;           /* TAKE DEFAULTS         @Y30LB54*/
         L     @03,LPARMPTR                                        0676
         MVC   CDETAIL(1,@03),DFDETAIL                             0676
*       RETCODE1=0;                 /* ALLOW TI TAKE DEFAULTS@Y30LB54*/
         SLR   @03,@03                                             0677
         ST    @03,RETCODE1                                        0677
*       LINE='ISDAPARM DETAIL(ALL × NONE × 0,1,2,3,4,5) ERROR';    0678
         MVI   LINE+47(CVTPTR),C' '                                0678
         MVC   LINE+48(84,CVTPTR),LINE+47(CVTPTR)                  0678
         MVC   LINE(47,CVTPTR),@CC00488                            0678
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0679
         ST    @03,@AL00001                                        0679
         L     @15,@CV00037                                        0679
         LA    @01,@AL00001                                        0679
         BALR  @14,@15                                             0679
*       CALL ISDATYPE(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0680
         ST    @03,@AL00001                                        0680
         L     @15,@CV00038                                        0680
         LA    @01,@AL00001                                        0680
         BALR  @14,@15                                             0680
*     END;                          /*                       @Y30LB54*/
*   DCL                                                            0682
*     1 DETTAB(6) STATIC LOCAL,                                    0682
*      2 DETARG CHAR(1) INIT('0','1','2','3','4','5'),             0682
*      2 DETFUNC CHAR(1) INIT('80'X,'40'X,'20'X,'10'X,'08'X,'04'X);
*   END DETCLAUS;                   /*                       @Y30LB54*/
@EL00020 DS    0H                                                  0683
@EF00020 DS    0H                                                  0683
@ER00020 LM    @14,@12,@SA00020                                    0683
         BR    @14                                                 0683
*                                                                  0684
*   /*****************************************************************/
*   /*                                                               */
*   /* PERIOD(XXX)                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0684
*PERCLAUS:                                                         0684
*   PROC;                           /*                       @Y30LB54*/
PERCLAUS STM   @14,@12,@SA00021                                    0684
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* HOW MANY DIGITS       @Y30LB54*/
         L     @03,ENDPRM                                          0685
         SL    @03,STARTPRM                                        0685
         AH    @03,@CH00068                                        0685
         ST    @03,FULLWD2                                         0685
*   IF FULLWD2^>2 THEN                                             0686
         L     @03,FULLWD2                                         0686
         CH    @03,@CH00066                                        0686
         BH    @RF00686                                            0686
*     RETCODE1=8;                   /* ERROR ON INPUT()      @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0687
*   ELSE                                                           0688
*     DO;                           /*                       @Y30LB54*/
         B     @RC00686                                            0688
@RF00686 DS    0H                                                  0689
*       EBDIC5='00000';             /* CLEAR HOLDING AREA    @Y30LB54*/
         MVC   EBDIC5(5),@CC00496                                  0689
*       IF FULLWD2=THREE THEN                                      0690
         CLC   FULLWD2(4),@CF00088                                 0690
         BNE   @RF00690                                            0690
*         EBDIC5(FIVE:FIVE)=INPUT(STARTPRM+ONE);/*           @Y30LB54*/
         L     @03,INPTR                                           0691
         AL    @03,STARTPRM                                        0691
         MVC   EBDIC5+4(1),INPUT(@03)                              0691
*       ELSE                                                       0692
*         IF FULLWD2=FOUR THEN                                     0692
         B     @RC00690                                            0692
@RF00690 CLC   FULLWD2(4),@CF00071                                 0692
         BNE   @RF00692                                            0692
*           EBDIC5(FOUR:FIVE)=INPUT(STARTPRM+ONE:STARTPRM+TWO);    0693
         L     @03,INPTR                                           0693
         AL    @03,STARTPRM                                        0693
         MVC   EBDIC5+3(2),INPUT(@03)                              0693
*         ELSE                                                     0694
*           IF FULLWD2=FIVE THEN                                   0694
         B     @RC00692                                            0694
@RF00692 CLC   FULLWD2(4),@CF00318                                 0694
         BNE   @RF00694                                            0694
*             EBDIC5(THREE:FIVE)=INPUT(STARTPRM+ONE:STARTPRM+THREE);
         L     @03,INPTR                                           0695
         AL    @03,STARTPRM                                        0695
         MVC   EBDIC5+2(3),INPUT(@03)                              0695
*           ELSE                                                   0696
*             RETCODE1=8;           /* ERROR ON INPUT        @Y30LB54*/
         B     @RC00694                                            0696
@RF00694 MVC   RETCODE1(4),@CF00091                                0696
*       IF EBDIC5(THREE)<'0'×EBDIC5(THREE)>'9' THEN                0697
@RC00694 DS    0H                                                  0697
@RC00692 DS    0H                                                  0697
@RC00690 CLI   EBDIC5+2,C'0'                                       0697
         BL    @RT00697                                            0697
         CLI   EBDIC5+2,C'9'                                       0697
         BNH   @RF00697                                            0697
@RT00697 DS    0H                                                  0698
*         RETCODE1=8;               /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0698
*       ELSE                                                       0699
*         IF EBDIC5(FOUR)<'0'×EBDIC5(FOUR)>'9' THEN                0699
         B     @RC00697                                            0699
@RF00697 CLI   EBDIC5+3,C'0'                                       0699
         BL    @RT00699                                            0699
         CLI   EBDIC5+3,C'9'                                       0699
         BNH   @RF00699                                            0699
@RT00699 DS    0H                                                  0700
*           RETCODE1=8;             /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0700
*         ELSE                                                     0701
*           IF EBDIC5(FIVE)<'0'×EBDIC5(FIVE)>'9' THEN              0701
         B     @RC00699                                            0701
@RF00699 CLI   EBDIC5+4,C'0'                                       0701
         BL    @RT00701                                            0701
         CLI   EBDIC5+4,C'9'                                       0701
         BNH   @RF00701                                            0701
@RT00701 DS    0H                                                  0702
*             RETCODE1=8;           /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0702
*           ELSE                                                   0703
*             ;                     /*                       @Y30LB54*/
@RF00701 DS    0H                                                  0704
*       EBDIC5(FIVE)=EBDIC5(FIVE)×'F0'X;/* PROTECT PACK      @Y30LB54*/
@RC00699 DS    0H                                                  0704
@RC00697 OI    EBDIC5+4,X'F0'                                      0704
*       PACK(EBDIC4,EBDIC5);        /* PACK DATA             @Y30LB54*/
         PACK  EBDIC4(4),EBDIC5(5)                                 0705
*       CVB(CTR1,EBDIC4);           /* CONVERT TO BINARY     @Y30LB54*/
         XC    @TS00001(8),@TS00001                                0706
         MVC   @TS00001+4(4),EBDIC4                                0706
         CVB   CTR1,@TS00001                                       0706
*       IF CTR1>255 THEN                                           0707
         CH    CTR1,@CH00498                                       0707
         BNH   @RF00707                                            0707
*         RETCODE1=8;               /* MORE THAN ONE BYTE WILL HOLD
*                                                            @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0708
*       ELSE                                                       0709
*         ;                                                /*@Y30LB54*/
@RF00707 DS    0H                                                  0710
*       EBDIC4=CTR1;                /* MOVE IT TO SUBSTRINGABLE AREA
*                                                            @Y30LB54*/
         ST    CTR1,EBDIC4                                         0710
*       CPERIOD=EBDIC4(FOUR);       /*                       @Y30LB54*/
         L     @03,LPARMPTR                                        0711
         MVC   CPERIOD(1,@03),EBDIC4+3                             0711
*     END;                          /*                       @Y30LB54*/
*   IF RETCODE1^=0 THEN                                            0713
@RC00686 SLR   @03,@03                                             0713
         C     @03,RETCODE1                                        0713
         BE    @RF00713                                            0713
*     DO;                           /*                       @Y30LB54*/
*       RETCODE1=0;                 /*                       @Y30LB54*/
         ST    @03,RETCODE1                                        0715
*       CPERIOD=DFPERIOD;           /* TAKE DEFAULTS         @Y30LB54*/
         L     @03,LPARMPTR                                        0716
         MVC   CPERIOD(1,@03),DFPERIOD                             0716
*       LINE='ISDAPARM PERIOD (X × XX × XXX) ERROR';/*       @Y30LB54*/
         MVI   LINE+36(CVTPTR),C' '                                0717
         MVC   LINE+37(95,CVTPTR),LINE+36(CVTPTR)                  0717
         MVC   LINE(36,CVTPTR),@CC00499                            0717
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0718
         ST    @03,@AL00001                                        0718
         L     @15,@CV00037                                        0718
         LA    @01,@AL00001                                        0718
         BALR  @14,@15                                             0718
*       CALL ISDATYPE(WORKPTR);     /*                       @Y30LB54*/
         L     @03,@PC00001                                        0719
         ST    @03,@AL00001                                        0719
         L     @15,@CV00038                                        0719
         LA    @01,@AL00001                                        0719
         BALR  @14,@15                                             0719
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0721
*     ;                             /*                       @Y30LB54*/
@RF00713 DS    0H                                                  0722
*   END PERCLAUS;                   /*                       @Y30LB54*/
@EL00021 DS    0H                                                  0722
@EF00021 DS    0H                                                  0722
@ER00021 LM    @14,@12,@SA00021                                    0722
         BR    @14                                                 0722
*                                                                  0723
*   /*****************************************************************/
*   /*                                                               */
*   /* SET DEBUG FLAGS                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0723
*TRACLAUS:                                                         0723
*   PROC;                           /*                       @Y30LB54*/
TRACLAUS STM   @14,@12,@SA00022                                    0723
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /*                       @Y30LB54*/
         L     @03,ENDPRM                                          0724
         SL    @03,STARTPRM                                        0724
         AH    @03,@CH00068                                        0724
         ST    @03,FULLWD2                                         0724
*   IF FULLWD2=3 THEN                                              0725
         CLC   FULLWD2(4),@CF00088                                 0725
         BNE   @RF00725                                            0725
*     INPUT(STARTPRM)='0';          /* MAKE IT TWO DIGITS    @Y30LB54*/
         L     @03,INPTR                                           0726
         AL    @03,STARTPRM                                        0726
         AL    @03,@CF00396                                        0726
         MVI   INPUT(@03),C'0'                                     0726
*   ELSE                                                           0727
*     IF FULLWD2=4 THEN                                            0727
         B     @RC00725                                            0727
@RF00725 CLC   FULLWD2(4),@CF00071                                 0727
         BNE   @RF00727                                            0727
*       STARTPRM=STARTPRM+1;        /* MAKE IT TWO DIGITS    @Y30LB54*/
         LA    @03,1                                               0728
         AL    @03,STARTPRM                                        0728
         ST    @03,STARTPRM                                        0728
*     ELSE                                                         0729
*       DO;                         /*                       @Y30LB54*/
         B     @RC00727                                            0729
@RF00727 DS    0H                                                  0730
*         RETCODE1=8;               /*                       @Y30LB54*/
         MVC   RETCODE1(4),@CF00091                                0730
*       END;                        /*                       @Y30LB54*/
*   CTR1=2;                         /*                       @Y30LB54*/
@RC00727 DS    0H                                                  0732
@RC00725 LA    CTR1,2                                              0732
*   CALL EBDICHEX;                  /* CONVERT TO HEX FROM EBDIC   0733
*                                                            @Y30LB54*/
         BAL   @14,EBDICHEX                                        0733
*   IF RETCODE1^=0 THEN                                            0734
         ICM   @03,15,RETCODE1                                     0734
         BNZ   @RT00734                                            0734
*     ;                             /*                       @Y30LB54*/
*   ELSE                                                           0736
*     DO;                           /*                       @Y30LB54*/
*       CTRACE=LINE(ONE);           /* MOVE IN NEW VALUE     @Y30LB54*/
         L     @03,LPARMPTR                                        0737
         MVC   CTRACE(1,@03),LINE(CVTPTR)                          0737
*     END;                          /*                       @Y30LB54*/
*   IF RETCODE1^=0 THEN                                            0739
@RT00734 SLR   @03,@03                                             0739
         C     @03,RETCODE1                                        0739
         BE    @RF00739                                            0739
*     DO;                           /*                       @Y30LB54*/
*       RETCODE1=0;                 /*                       @Y30LB54*/
         ST    @03,RETCODE1                                        0741
*       CTRACE=DFTRACE;             /* MAKE IT THE DEFAULT   @Y30LB54*/
         L     @03,LPARMPTR                                        0742
         MVC   CTRACE(1,@03),DFTRACE                               0742
*       LINE='ISDAPARM TRACE(XX) ERROR';/*                   @Y30LB54*/
         MVI   LINE+24(CVTPTR),C' '                                0743
         MVC   LINE+25(107,CVTPTR),LINE+24(CVTPTR)                 0743
         MVC   LINE(24,CVTPTR),@CC00505                            0743
*       CALL ISDAPRT0(WORKPTR);     /* PRINT ERROR           @Y30LB54*/
         L     @03,@PC00001                                        0744
         ST    @03,@AL00001                                        0744
         L     @15,@CV00037                                        0744
         LA    @01,@AL00001                                        0744
         BALR  @14,@15                                             0744
*       CALL ISDATYPE(WORKPTR);     /* TYPE ERROR            @Y30LB54*/
         L     @03,@PC00001                                        0745
         ST    @03,@AL00001                                        0745
         L     @15,@CV00038                                        0745
         LA    @01,@AL00001                                        0745
         BALR  @14,@15                                             0745
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0747
*     ;                             /*                       @Y30LB54*/
@RF00739 DS    0H                                                  0748
*   END TRACLAUS;                   /*                       @Y30LB54*/
@EL00022 DS    0H                                                  0748
@EF00022 DS    0H                                                  0748
@ER00022 LM    @14,@12,@SA00022                                    0748
         BR    @14                                                 0748
*   END ISDAPARM                    /*                       @Y30LB54*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*;                                                                 0749
@DATA    DS    0H
@CH00066 DC    H'2'
@CH00264 DC    H'14'
@CH00205 DC    H'15'
@CH00214 DC    H'16'
@CH00331 DC    H'80'
@CH00386 DC    H'99'
@CH00327 DC    H'200'
@CH00498 DC    H'255'
@SM00508 MVC   INPUT(0,@03),0(@14)
@SM00510 MVC   LINE(0,CVTPTR),INPUT(@01)
@SM00512 MVC   CSERIAL(0,@03),INPUT(@01)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    15F
@SA00009 DS    15F
@SA00022 DS    15F
@SA00014 DS    15F
@SA00015 DS    15F
@SA00018 DS    15F
@SA00019 DS    15F
@SA00020 DS    15F
@SA00006 DS    15F
@SA00003 DS    15F
@SA00017 DS    0F
@SA00016 DS    0F
@SA00013 DS    0F
@SA00012 DS    0F
@SA00021 DS    0F
@SA00011 DS    0F
@SA00010 DS    0F
         DS    15F
@AL00001 DS    1A
ISDAPARM CSECT
         DS    0F
@CF00068 DC    F'1'
@CH00068 EQU   @CF00068+2
@CF00088 DC    F'3'
@CF00071 DC    F'4'
@CH00071 EQU   @CF00071+2
@CF00318 DC    F'5'
@CH00318 EQU   @CF00318+2
@CF00207 DC    F'6'
@CH00207 EQU   @CF00207+2
@CF00408 DC    F'7'
@CF00091 DC    F'8'
@CF00441 DC    F'10'
@CF00034 DC    F'12'
@CH00034 EQU   @CF00034+2
@CF00360 DC    F'81'
@CF00396 DC    F'-1'
@DATD    DSECT
         DS    0D
RETCODE  DS    F
INPTR    DS    A
INPTR1   DS    A
STARTINP DS    F
ENDINP   DS    F
STARTTXT DS    F
ENDTXT   DS    F
STARTPRM DS    F
ENDPRM   DS    F
CHAR1    DS    F
CHARL    DS    F
RETCODE1 DS    F
FULLWD2  DS    F
LPARMPTR DS    A
         DS    0D
@TS00001 DS    CL8
EBDIC4   DS    CL4
EBDIC5   DS    CL5
         DS    CL3
WORKBUF  DS    CL200
CARD     DS    CL80
         ORG   CARD
@NM00007 DS    CL80
         ORG   CARD+80
ISDAPARM CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00037 DC    V(ISDAPRT0)
@CV00038 DC    V(ISDATYPE)
         DS    0D
@CC00467 DC    C'ISDAPARM INCLUDE(DCS,PAD,SUM,DHE,DHU,FSC,EQC,DCK,TLX,CC
               SB,CSF,DAT,DRC,APR,SUU) ERROR'
@CC00476 DC    C'ISDAPARM EXCLUDE(DCS,PAD,SUM,DHE,DHU,FSC,EQC,DCK,TLX,CC
               SB,CSF,DAT,DRC,APR,SUU) ERROR'
@CC00488 DC    C'ISDAPARM DETAIL(ALL × NONE × 0,1,2,3,4,5) ERROR'
@CC00348 DC    C'ISDAPARM ENTER PARAMETERS AT THIS POINT'
@CC00429 DC    C'ISDAPARM DEVTYPE(SA×RC×RD×CS×DA) ERROR'
@CC00442 DC    C'ISDAPARM FSCODE(XXXXXXXX × XXXX) ERROR'
@CC00402 DC    C'ISDAPARM INPUT(HISTORY,LOGREC) ERROR'
@CC00499 DC    C'ISDAPARM PERIOD (X × XX × XXX) ERROR'
@CC00461 DC    C'ISDAPARM CSN(XXXYYYYYYYYY) ERROR'
@CC00410 DC    C'ISDAPARM STARTDATE(YYDDD) ERROR'
@CC00422 DC    C'ISDAPARM SUMMARY(YES×NO) ERROR'
@CC00416 DC    C'ISDAPARM ENDDATE(YYDDD) ERROR'
@CC00383 DC    C'ISDAPARM DELIMITER ERRORS'
@CC00448 DC    C'ISDAPARM SSID(XXX) ERROR '
@CC00456 DC    C'ISDAPARM RATIO(XX) ERROR'
@CC00505 DC    C'ISDAPARM TRACE(XX) ERROR'
@CC00387 DC    C'ISDAPARM KEYWORD ERROR'
@CC00357 DC    C'ENTER NEXT LINE '
@CC00496 DC    C'00000'
@CC00454 EQU   @CC00496
@CC00455 DC    C'99'
@CB00122 DC    X'00000000'
         DS    CL3
SDAPARM0 DS    CL49
         ORG   SDAPARM0
DFINPUT  DS    CL2
         ORG   DFINPUT
DFLOGIN  DC    CL1'Y'
DFHISTIN DC    CL1'Y'
         ORG   SDAPARM0+2
DFSTART  DC    X'0000000F'
DFEND    DC    X'0000000F'
DFSUMMAR DC    CL1'N'
DFTYPE   DC    CL2'  '
DFFSCONL DC    X'00000000'
DFSSIDF  DC    X'0000'
         ORG   DFSSIDF
@NM00003 DS    BL1
DFSSID   EQU   DFSSIDF+0
         ORG   SDAPARM0+19
DFRATIO  DC    X'F0F0'
DFSERIAL DC    CL12' '
         ORG   DFSERIAL
DFIBM    DS    CL3
@NM00004 DS    CL1
DFSERNO  DS    CL8
         ORG   SDAPARM0+33
DFREPORT DS    CL12
         ORG   DFREPORT
DFDCS    DC    X'01'
DFPAD    DC    X'01'
DFSUM    DC    X'03'
DFDHEDHU DC    X'03'
DFFSC    DC    X'01'
DFEQC    DC    X'01'
DFDCKTLX DC    X'03'
DFCSBCSF DC    X'03'
DFDAT    DC    X'01'
DFDRC    DC    X'01'
DFAPR    DC    X'03'
DFPWR    DC    X'00'
         ORG   SDAPARM0+45
DFPERIOD DC    XL1'00'
DFDETAIL DC    X'00'
DFGEN    DC    X'00'
DFTRACE  DC    X'00'
         ORG   SDAPARM0+49
         DS    CL3
FFEE     DC    X'7FFFFFEE'
PATCH    DC    50X'00'
TBLCVT   DS    CL4
         ORG   TBLCVT+0
EBDIC    DC    CL1'0'
HEXTOP   DC    X'00'
HEXBOT   DC    X'00'
@NM00005 DC    X'00'
         ORG   TBLCVT+4
         ORG   TBLCVT+4
         DC    CL1'1'
         DC    X'10'
         DC    X'01'
         DC    X'00'
         ORG   TBLCVT+8
         ORG   TBLCVT+8
         DC    CL1'2'
         DC    X'20'
         DC    X'02'
         DC    X'00'
         ORG   TBLCVT+12
         ORG   TBLCVT+12
         DC    CL1'3'
         DC    X'30'
         DC    X'03'
         DC    X'00'
         ORG   TBLCVT+16
         ORG   TBLCVT+16
         DC    CL1'4'
         DC    X'40'
         DC    X'04'
         DC    X'00'
         ORG   TBLCVT+20
         ORG   TBLCVT+20
         DC    CL1'5'
         DC    X'50'
         DC    X'05'
         DC    X'00'
         ORG   TBLCVT+24
         ORG   TBLCVT+24
         DC    CL1'6'
         DC    X'60'
         DC    X'06'
         DC    X'00'
         ORG   TBLCVT+28
         ORG   TBLCVT+28
         DC    CL1'7'
         DC    X'70'
         DC    X'07'
         DC    X'00'
         ORG   TBLCVT+32
         ORG   TBLCVT+32
         DC    CL1'8'
         DC    X'80'
         DC    X'08'
         DC    X'00'
         ORG   TBLCVT+36
         ORG   TBLCVT+36
         DC    CL1'9'
         DC    X'90'
         DC    X'09'
         DC    X'00'
         ORG   TBLCVT+40
         ORG   TBLCVT+40
         DC    CL1'A'
         DC    X'A0'
         DC    X'0A'
         DC    X'00'
         ORG   TBLCVT+44
         ORG   TBLCVT+44
         DC    CL1'B'
         DC    X'B0'
         DC    X'0B'
         DC    X'00'
         ORG   TBLCVT+48
         ORG   TBLCVT+48
         DC    CL1'C'
         DC    X'C0'
         DC    X'0C'
         DC    X'00'
         ORG   TBLCVT+52
         ORG   TBLCVT+52
         DC    CL1'D'
         DC    X'D0'
         DC    X'0D'
         DC    X'00'
         ORG   TBLCVT+56
         ORG   TBLCVT+56
         DC    CL1'E'
         DC    X'E0'
         DC    X'0E'
         DC    X'00'
         ORG   TBLCVT+60
         ORG   TBLCVT+60
         DC    CL1'F'
         DC    X'F0'
         DC    X'0F'
         DC    X'00'
         ORG   TBLCVT+64
         DS    CL2
KEYTABLE DS    CL8
         ORG   KEYTABLE+0
KEYARG   DC    CL3'INP'
@NM00006 DS    CL1
KEYFUNC  DC    AL4(INPCLAUS)
         ORG   KEYTABLE+8
         ORG   KEYTABLE+8
         DC    CL3'STA'
         DS    CL1
         DC    AL4(STACLAUS)
         ORG   KEYTABLE+16
         ORG   KEYTABLE+16
         DC    CL3'END'
         DS    CL1
         DC    AL4(ENDCLAUS)
         ORG   KEYTABLE+24
         ORG   KEYTABLE+24
         DC    CL3'PER'
         DS    CL1
         DC    AL4(PERCLAUS)
         ORG   KEYTABLE+32
         ORG   KEYTABLE+32
         DC    CL3'SUM'
         DS    CL1
         DC    AL4(SUMCLAUS)
         ORG   KEYTABLE+40
         ORG   KEYTABLE+40
         DC    CL3'DEV'
         DS    CL1
         DC    AL4(DEVCLAUS)
         ORG   KEYTABLE+48
         ORG   KEYTABLE+48
         DC    CL3'FSC'
         DS    CL1
         DC    AL4(FSCCLAUS)
         ORG   KEYTABLE+56
         ORG   KEYTABLE+56
         DC    CL3'SSI'
         DS    CL1
         DC    AL4(SSICLAUS)
         ORG   KEYTABLE+64
         ORG   KEYTABLE+64
         DC    CL3'RAT'
         DS    CL1
         DC    AL4(RATCLAUS)
         ORG   KEYTABLE+72
         ORG   KEYTABLE+72
         DC    CL3'CSN'
         DS    CL1
         DC    AL4(CSNCLAUS)
         ORG   KEYTABLE+80
         ORG   KEYTABLE+80
         DC    CL3'INC'
         DS    CL1
         DC    AL4(INCCLAUS)
         ORG   KEYTABLE+88
         ORG   KEYTABLE+88
         DC    CL3'EXC'
         DS    CL1
         DC    AL4(EXCCLAUS)
         ORG   KEYTABLE+96
         ORG   KEYTABLE+96
         DC    CL3'DET'
         DS    CL1
         DC    AL4(DETCLAUS)
         ORG   KEYTABLE+104
         ORG   KEYTABLE+104
         DC    CL3'TRA'
         DS    CL1
         DC    AL4(TRACLAUS)
         ORG   KEYTABLE+112
RPTTBL   DS    CL8
         ORG   RPTTBL+0
RPTARG   DC    CL3'DCS'
RPTFUNCH DC    X'01'
RPTFUNCA DC    AL4(CDCS)
         ORG   RPTTBL+8
         ORG   RPTTBL+8
         DC    CL3'PAD'
         DC    X'01'
         DC    AL4(CPAD)
         ORG   RPTTBL+16
         ORG   RPTTBL+16
         DC    CL3'SUM'
         DC    X'01'
         DC    AL4(CSUM)
         ORG   RPTTBL+24
         ORG   RPTTBL+24
         DC    CL3'DHE'
         DC    X'01'
         DC    AL4(CDHEDHU)
         ORG   RPTTBL+32
         ORG   RPTTBL+32
         DC    CL3'DHU'
         DC    X'02'
         DC    AL4(CDHEDHU)
         ORG   RPTTBL+40
         ORG   RPTTBL+40
         DC    CL3'FSC'
         DC    X'01'
         DC    AL4(CFSC)
         ORG   RPTTBL+48
         ORG   RPTTBL+48
         DC    CL3'EQC'
         DC    X'01'
         DC    AL4(CEQC)
         ORG   RPTTBL+56
         ORG   RPTTBL+56
         DC    CL3'DCK'
         DC    X'01'
         DC    AL4(CDCKTLX)
         ORG   RPTTBL+64
         ORG   RPTTBL+64
         DC    CL3'TLX'
         DC    X'02'
         DC    AL4(CDCKTLX)
         ORG   RPTTBL+72
         ORG   RPTTBL+72
         DC    CL3'CSB'
         DC    X'01'
         DC    AL4(CCSBCSF)
         ORG   RPTTBL+80
         ORG   RPTTBL+80
         DC    CL3'CSF'
         DC    X'02'
         DC    AL4(CCSBCSF)
         ORG   RPTTBL+88
         ORG   RPTTBL+88
         DC    CL3'DAT'
         DC    X'01'
         DC    AL4(CDAT)
         ORG   RPTTBL+96
         ORG   RPTTBL+96
         DC    CL3'DRC'
         DC    X'01'
         DC    AL4(CDRC)
         ORG   RPTTBL+104
         ORG   RPTTBL+104
         DC    CL3'APR'
         DC    X'01'
         DC    AL4(CAPRSUU)
         ORG   RPTTBL+112
         ORG   RPTTBL+112
         DC    CL3'SUU'
         DC    X'02'
         DC    AL4(CAPRSUU)
         ORG   RPTTBL+120
DEVTAB   DS    CL2
         ORG   DEVTAB+0
DEVARG   DC    CL2'SA'
         ORG   DEVTAB+2
         ORG   DEVTAB+2
         DC    CL2'RC'
         ORG   DEVTAB+4
         ORG   DEVTAB+4
         DC    CL2'RD'
         ORG   DEVTAB+6
         ORG   DEVTAB+6
         DC    CL2'CS'
         ORG   DEVTAB+8
         ORG   DEVTAB+8
         DC    CL2'DA'
         ORG   DEVTAB+10
DETTAB   DS    CL2
         ORG   DETTAB+0
DETARG   DC    CL1'0'
DETFUNC  DC    X'80'
         ORG   DETTAB+2
         ORG   DETTAB+2
         DC    CL1'1'
         DC    X'40'
         ORG   DETTAB+4
         ORG   DETTAB+4
         DC    CL1'2'
         DC    X'20'
         ORG   DETTAB+6
         ORG   DETTAB+6
         DC    CL1'3'
         DC    X'10'
         ORG   DETTAB+8
         ORG   DETTAB+8
         DC    CL1'4'
         DC    X'08'
         ORG   DETTAB+10
         ORG   DETTAB+10
         DC    CL1'5'
         DC    X'04'
         ORG   DETTAB+12
@DATD    DSECT
*                                                         /*@Y30LB54*/
OPENLIST OPEN (0,INPUT),MF=L
@DATD    DSECT
*                                                         /*@Y30LB54*/
CLOSLIST CLOSE (0),MF=L
ISDAPARM CSECT
*                                                         /*@Y30LB54*/
DCBSTAT  DCB   DSORG=PS,MACRF=GM,DDNAME=SYSIN,LRECL=80,EODAD=EOF,     XX
               RECFM=FB,SYNAD=EOD
ISDAPARM CSECT
*                                                         /*@Y30LB54*/
OPENSTAT OPEN (0,INPUT),MF=L
ISDAPARM CSECT
*                                                         /*@Y30LB54*/
CLOSSTAT CLOSE (0),MF=L
@DATD    DSECT
*                                                         /*@Y30LB54*/
SYSINDCB DCB   DSORG=PS,MACRF=GM,DDNAME=SYSIN,LRECL=80,EODAD=EOF,     XX
               RECFM=FB,SYNAD=EOD
OFLAGS   EQU   SYSINDCB+48
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDAPARM CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
POINTADD EQU   @04
CTR1     EQU   @04
CTR      EQU   @03
CVTPTR   EQU   @02
CONDCODE EQU   @15
R6       EQU   @06
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CLOGIN   EQU   CINPUT
CHISTIN  EQU   CINPUT+1
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CSUMMARY EQU   ISDAPRMS+10
CTYPE    EQU   ISDAPRMS+11
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CRATIO   EQU   ISDAPRMS+19
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CDCS     EQU   CREPORTS
CPAD     EQU   CREPORTS+1
CSUM     EQU   CREPORTS+2
CDHEDHU  EQU   CREPORTS+3
CFSC     EQU   CREPORTS+4
CEQC     EQU   CREPORTS+5
CDCKTLX  EQU   CREPORTS+6
CCSBCSF  EQU   CREPORTS+7
CDAT     EQU   CREPORTS+8
CDRC     EQU   CREPORTS+9
CAPRSUU  EQU   CREPORTS+10
CPERIOD  EQU   ISDAPRMS+45
CDETAIL  EQU   ISDAPRMS+46
CGEN     EQU   ISDAPRMS+47
CTRACE   EQU   ISDAPRMS+48
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
PARMPTR  EQU   CVTPTRS0+8
PARM0PTR EQU   CVTPTRS0+16
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
ANSI     EQU   OUTLINE
LINE     EQU   OUTLINE+1
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
INPUT    EQU   0
JCLAREA  EQU   0
WORKPTR  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
COREADDR EQU   GET0CALL+4
CORELEN  EQU   SPNOLEN+1
SPNO     EQU   SPNOLEN
WORKCALL EQU   CVTPTRS0+96
GEN00PTR EQU   CVTPTRS0+92
CNFG0PTR EQU   CVTPTRS0+88
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
SDA00PTR EQU   CVTPTRS0+12
SDATAPTR EQU   CVTPTRS0+4
DATAPTR  EQU   CVTPTRS0
CPWR     EQU   CREPORTS+11
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00196 EQU   @RC00193
@RT00267 EQU   @EL00005
@RF00342 EQU   @EL00007
@RC00393 EQU   @RC00389
@RC00404 EQU   @RC00400
@RC00570 EQU   @EL00017
@RF00604 EQU   @EL00018
@RF00638 EQU   @EL00019
@RF00674 EQU   @EL00020
@RC00394 EQU   @RC00393
@RC00405 EQU   @RC00404
@ENDDATA EQU   *
         END   ISDAPARM,(C'PLS0137',0603,75313)

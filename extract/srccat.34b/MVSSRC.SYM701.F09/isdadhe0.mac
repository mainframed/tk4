         TITLE 'ISDADHE0 DHU AND DHE ACCUMULATOR                       *
                        '
ISDADHE0 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISDADHE0  78.044'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         L     @00,@SIZDATD                                        0001
         ISDAGSPC R,LV=(0)
         LR    @12,@01                                             0001
         USING @DATD,@12                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @12,8(,@13)                                         0001
         LR    @13,@12                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0031
*   /*****************************************************************/
*   /*                                                               */
*   /* HOUSEKEEPING                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0031
*   CVTPTR=WORKPTR;                 /*                       @Y30LB54*/
         L     @10,@PC00001                                        0031
         L     CVTPTR,WORKPTR(,@10)                                0031
*   SENSEPTR=SDATAPTR;              /* SET LOCAL PTR TO SENSE@ZM30983*/
         L     SENSEPTR,SDATAPTR(,CVTPTR)                          0032
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO PARMS@ZM30983*/
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0033
*   RETCODE=0;                      /* INIT RETURN CODE      @ZM30983*/
         SLR   RETCODE,RETCODE                                     0034
*   IF SUBFMTMG^='05'X THEN         /* MSG CODE 05 RECORD    @ZM30976*/
         CLI   SUBFMTMG(SENSEPTR),X'05'                            0035
         BE    @RF00035                                            0035
*     RETURN CODE(RETCODE);         /* NO, DONT USE THIS REC @ZM30976*/
         L     @13,4(,@13)                                         0036
         L     @00,@SIZDATD                                        0036
         LR    @01,@12                                             0036
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0036
         L     @14,12(,@13)                                        0036
         LM    @00,@12,20(@13)                                     0036
         BR    @14                                                 0036
*   ELSE;                           /* OK, DRD BUFFERED LOG  @ZM30976*/
@RF00035 DS    0H                                                  0038
*   DHEWKPTR=DHE00PTR;              /* SET LOCAL PTR TO WORK @ZM30983*/
         L     @10,DHE00PTR(,CVTPTR)                               0038
         LR    DHEWKPTR,@10                                        0038
*   IF DHE00PTR=0 THEN              /* FIRST TIME SWITCH     @Y30LB54*/
         LTR   @10,@10                                             0039
         BNZ   @RF00039                                            0039
*     DO;                           /*                       @Y30LB54*/
*       SPNO=0;                     /* WANT SUBPOOL ZERO     @Y30LB54*/
         MVI   SPNO(CVTPTR),X'00'                                  0041
*       CORELEN=LENGTH(WORKCORE);   /*                       @Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00344+1                        0042
*       CALL ISDAGET1(WORKPTR);     /*                       @Y30LB54*/
         L     @10,@PC00001                                        0043
         ST    @10,@AL00001                                        0043
         L     @15,@CV00041                                        0043
         LA    @01,@AL00001                                        0043
         BALR  @14,@15                                             0043
*       RFY                                                        0044
*         R15 RSTD;                 /*                       @Y30LB54*/
*       RETCODE=R15;                /*                       @Y30LB54*/
         LR    RETCODE,R15                                         0045
*       RFY                                                        0046
*         R15 UNRSTD;               /*                       @Y30LB54*/
*       IF RETCODE=0 THEN                                          0047
         LTR   RETCODE,RETCODE                                     0047
         BNZ   @RF00047                                            0047
*         DO;                       /*                       @Y30LB54*/
*           DHE00PTR=COREADDR;      /*                       @Y30LB54*/
         L     @10,COREADDR(,CVTPTR)                               0049
         ST    @10,DHE00PTR(,CVTPTR)                               0049
*           DHEWKPTR=COREADDR;      /* SET LOCAL PTR TO WORK @ZM30983*/
         LR    DHEWKPTR,@10                                        0050
*         END;                      /*                       @Y30LB54*/
*       ELSE                                                       0052
*         DO;                       /*                       @Y30LB54*/
         B     @RC00047                                            0052
@RF00047 DS    0H                                                  0053
*           RETCODE=4;              /*                       @Y30LB54*/
         LA    RETCODE,4                                           0053
*           CDHEDHU='00'X;          /* TURN CALL FLAG OFF    @ZM30983*/
         MVI   CDHEDHU(LPARMPTR),X'00'                             0054
*           RETURN CODE(RETCODE);   /*                       @Y30LB54*/
         L     @13,4(,@13)                                         0055
         L     @00,@SIZDATD                                        0055
         LR    @01,@12                                             0055
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0055
         L     @14,12(,@13)                                        0055
         LM    @00,@12,20(@13)                                     0055
         BR    @14                                                 0055
*         END;                      /*                       @Y30LB54*/
*       COUNTRP4=0;                 /* NUMBER OF TIMES RPT 4 COUNTERS
*                                      ADDED TO              @Y30LB54*/
@RC00047 SLR   @10,@10                                             0057
         ST    @10,COUNTRP4(,DHEWKPTR)                             0057
*       COUNTR4A=0;                 /* NUMBER OF TIMES RPT 4A@Y30LB54
*                                      COUNTERS ADDED TO     @Y30LB54*/
         ST    @10,COUNTR4A(,DHEWKPTR)                             0058
*       COUNTRP5=0;                 /* NUMBER OF TIMES RPT 5 COUNTERS
*                                      ADDED TO              @Y30LB54*/
         ST    @10,COUNTRP5(,DHEWKPTR)                             0059
*       LIBTAB(1)=0;                /* RESET LIBRARY POINTERS TO 0 0060
*                                                            @Y30LB54*/
         ST    @10,LIBTAB(,DHEWKPTR)                               0060
*       LIBTAB(2)=0;                /*                       @Y30LB54*/
         ST    @10,LIBTAB+4(,DHEWKPTR)                             0061
*       LIBTAB(3)=0;                /*                       @Y30LB54*/
         ST    @10,LIBTAB+8(,DHEWKPTR)                             0062
*       LIBTAB(4)=0;                /*                       @Y30LB54*/
         ST    @10,LIBTAB+12(,DHEWKPTR)                            0063
*       LIBNO(1)='01'X;             /* SET UP LIBRARY COUNTER TABLE
*                                                            @Y30LB54*/
         MVI   LIBNO(DHEWKPTR),X'01'                               0064
*       LIBNO(2)='02'X;             /*                       @Y30LB54*/
         MVI   LIBNO+4(DHEWKPTR),X'02'                             0065
*       LIBNO(3)='03'X;             /*                       @Y30LB54*/
         MVI   LIBNO+8(DHEWKPTR),X'03'                             0066
*       LIBNO(4)='04'X;             /*                       @Y30LB54*/
         MVI   LIBNO+12(DHEWKPTR),X'04'                            0067
*       PTR5TOP=0;                  /* CLEAR POINTER TO DHE AREA   0068
*                                                            @Y30LB54*/
         ST    @10,PTR5TOP(,DHEWKPTR)                              0068
*       PTR5BOT=0;                  /* CLEAR DHU OVERFLOW    @ZM30983*/
         ST    @10,PTR5BOT(,DHEWKPTR)                              0069
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0071
*     ;                             /*                       @Y30LB54*/
@RF00039 DS    0H                                                  0072
*   LOGPTR=DATAPTR;                 /*                       @Y30LB54*/
         MVC   LOGPTR(4,DHEWKPTR),DATAPTR(CVTPTR)                  0072
*                                                                  0073
*   /*****************************************************************/
*   /*                                                               */
*   /* MAIN LOGIC PULL ALL DATA TOGETHER AS NEEDED                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0073
*   DATA04=TRPAT04;                 /* SET UP TRANSLATE TABLE@Y30LB54*/
         MVC   DATA04(24,DHEWKPTR),TRPAT04                         0073
*   SUBSTAT4='00'X;                 /* MAKE BYTE 4 = 0 FOR PADDING 0074
*                                      COUNTERS              @ZM31087*/
         MVI   SUBSTAT4(SENSEPTR),X'00'                            0074
*/* THE ABOVE IS BYTE FOUR OF SENSE DATA                     @ZM31087*/
*                                                                  0075
*   TR(DATA04,ISDAMSCS);            /* REACH INTO DATA AND PULL    0075
*                                      TOGETHER FIELDS, ALSO MAKES ALL
*                                      COUNTERS 4 BYTES LONG @ZA29820*/
         TR    DATA04(24,DHEWKPTR),ISDAMSCS(SENSEPTR)              0075
*/* INVERT THE OVERFLOW BIT TO MAKE THE COUNTERS CORRECT     @ZA29820*/
*   PTRINP=ADDR(DATA04);            /* SET BASE REGISTER     @ZA29820*/
         LA    @10,DATA04(,DHEWKPTR)                               0076
         ST    @10,PTRINP(,DHEWKPTR)                               0076
*   DO CTR=1 TO 6;                  /* LOOP THROUGH COUNTERS @ZA29820*/
         LA    @10,1                                               0077
         ST    @10,CTR(,DHEWKPTR)                                  0077
@DL00077 DS    0H                                                  0078
*     INCTR(CTR)=INCTR(CTR)&&MSK(CTR);/* EX OR WITH MASK     @ZA29820*/
         L     @10,CTR(,DHEWKPTR)                                  0078
         SLA   @10,2                                               0078
         L     @07,PTRINP(,DHEWKPTR)                               0078
         LA    @01,0(@10,@07)                                      0078
         AL    @01,@CF00348                                        0078
         L     @15,INCTR(,@01)                                     0078
         X     @15,MSK-4(@10)                                      0078
         AL    @07,@CF00348                                        0078
         ST    @15,INCTR(@10,@07)                                  0078
*   END;                            /* END INVERT OVERFLOW   @ZA29820*/
         LA    @10,1                                               0079
         AL    @10,CTR(,DHEWKPTR)                                  0079
         ST    @10,CTR(,DHEWKPTR)                                  0079
         CH    @10,@CH00142                                        0079
         BNH   @DL00077                                            0079
*   FULLWD1=SUBSYSID;               /* GET SSID AND LIBRARY NO     0080
*                                                            @Y30LB54*/
         SLR   @10,@10                                             0080
         ICM   @10,3,SUBSYSID(SENSEPTR)                            0080
         ST    @10,FULLWD1(,DHEWKPTR)                              0080
*   DATASSID=FULLWD1&'0000000F'X;   /* STRIP OFF SSID        @Y30LB54*/
         N     @10,@CF00301                                        0081
         ST    @10,DATASSID(,DHEWKPTR)                             0081
*   IF DATASSID>7 THEN              /* VALIDATE SSID         @Y30LB54*/
         CH    @10,@CH00302                                        0082
         BNH   @RF00082                                            0082
*     DO;                           /*                       @Y30LB54*/
*       RETCODE=8;                  /*                       @Y30LB54*/
         LA    RETCODE,8                                           0084
*       RETURN CODE(RETCODE);       /*                       @Y30LB54*/
         L     @13,4(,@13)                                         0085
         L     @00,@SIZDATD                                        0085
         LR    @01,@12                                             0085
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0085
         L     @14,12(,@13)                                        0085
         LM    @00,@12,20(@13)                                     0085
         BR    @14                                                 0085
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0087
*     ;                             /*                       @Y30LB54*/
@RF00082 DS    0H                                                  0088
*   DATALIB=FULLWD1&'000000F0'X;    /* STRIP OFF LIBRARY NO  @Y30LB54*/
         L     @10,FULLWD1(,DHEWKPTR)                              0088
         N     @10,@CF00303                                        0088
         ST    @10,DATALIB(,DHEWKPTR)                              0088
*   SRL(DATALIB,4);                 /* SHIFT IT TO UNITS POSITION  0089
*                                                            @Y30LB54*/
         L     @10,DATALIB(,DHEWKPTR)                              0089
         SRL   @10,4                                               0089
         ST    @10,DATALIB(,DHEWKPTR)                              0089
*   DATALIB=DATALIB+1;              /* ALLOW FOR STARTING AT LIBRARY
*                                      0                     @Y30LB54*/
         LA    @10,1                                               0090
         AL    @10,DATALIB(,DHEWKPTR)                              0090
         ST    @10,DATALIB(,DHEWKPTR)                              0090
*   DATA05(1:1)=DATALIB;            /* LIBRARY NUMBER BROKEN DOWN  0091
*                                                            @Y30LB54*/
         STC   @10,DATA05(,DHEWKPTR)                               0091
*   DATA05(10:10)=DATASSID;         /* SSID NUMBER BROKEN DOWN     0092
*                                                            @Y30LB54*/
         MVC   DATA05+9(1,DHEWKPTR),DATASSID+3(DHEWKPTR)           0092
*   DATA05(2:9)=DATETIME;           /* DATE TIME OF THIS RECORD    0093
*                                                            @Y30LB54*/
         L     @10,LOGPTR(,DHEWKPTR)                               0093
         MVC   DATA05+1(8,DHEWKPTR),DATETIME(@10)                  0093
*   DATA05(13:36)=DATA04;           /* COUNTERS              @Y30LB54*/
         MVC   DATA05+12(24,DHEWKPTR),DATA04(DHEWKPTR)             0094
*   DATA05(11:12)='0000'X;          /* FILL CHAR             @Y30LB54*/
*                                                                  0095
         MVC   DATA05+10(2,DHEWKPTR),@CB00306                      0095
*   /*****************************************************************/
*   /*                                                               */
*   /* DISPATCHER                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0096
*   CALL LIBMATCH;                  /* DETERMINE IF WE HAD LIBRARY 0096
*                                      BEFORE                @Y30LB54*/
         BAL   @14,LIBMATCH                                        0096
*   IF RETCODE^=0 THEN              /* MUST HAVE HAD CORE PROBLEMS OR
*                                      INPUT ERROR           @Y30LB54*/
         LTR   RETCODE,RETCODE                                     0097
         BZ    @RF00097                                            0097
*     RETURN CODE(RETCODE);         /*                       @Y30LB54*/
*                                                                  0098
         L     @13,4(,@13)                                         0098
         L     @00,@SIZDATD                                        0098
         LR    @01,@12                                             0098
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0098
         L     @14,12(,@13)                                        0098
         LM    @00,@12,20(@13)                                     0098
         BR    @14                                                 0098
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT OF THIS IS PTRLIB HAS POINTER TO COUNTERS              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0099
*   PTRSSID=DATASSID*24;            /* SIX-FOUR BYTE COUNTERS TIMES
*                                      SSID NO               @Y30LB54*/
*                                                                  0099
@RF00097 L     @10,DATASSID(,DHEWKPTR)                             0099
         MH    @10,@CH00122                                        0099
         ST    @10,PTRSSID(,DHEWKPTR)                              0099
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPUTE DISPLACEMENTS AND ADD ONE TO COUNTERS                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0100
*   CHAR4(1:1)=CDHEDHU&'02'X;       /* CONVERT TO LOOK AT DHE ONLY 0100
*                                                            @Y30LB54*/
         MVC   CHAR4(1,DHEWKPTR),CDHEDHU(LPARMPTR)                 0100
         NI    CHAR4(DHEWKPTR),X'02'                               0100
*   IF CHAR4(1:1)='02'X THEN                                       0101
         CLI   CHAR4(DHEWKPTR),X'02'                               0101
         BNE   @RF00101                                            0101
*     DO;                           /*                       @Y30LB54*/
*       CALL RPT4FILL;              /* DO DHU COUNTERS       @Y30LB54*/
         BAL   @14,RPT4FILL                                        0103
*       IF RETCODE^=0 THEN                                         0104
         LTR   RETCODE,RETCODE                                     0104
         BZ    @RF00104                                            0104
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/
         L     @13,4(,@13)                                         0105
         L     @00,@SIZDATD                                        0105
         LR    @01,@12                                             0105
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0105
         L     @14,12(,@13)                                        0105
         LM    @00,@12,20(@13)                                     0105
         BR    @14                                                 0105
*       ELSE                                                       0106
*         ;                         /*                       @Y30LB54*/
@RF00104 DS    0H                                                  0107
*       CALL RPT4AFIL;              /* DO DHUA COUNTERS      @Y30LB54*/
         BAL   @14,RPT4AFIL                                        0107
*       IF RETCODE^=0 THEN          /* ERROR ON INPUT        @Y30LB54*/
         LTR   RETCODE,RETCODE                                     0108
         BZ    @RF00108                                            0108
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/
         L     @13,4(,@13)                                         0109
         L     @00,@SIZDATD                                        0109
         LR    @01,@12                                             0109
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0109
         L     @14,12(,@13)                                        0109
         LM    @00,@12,20(@13)                                     0109
         BR    @14                                                 0109
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0111
*     ;                             /*                       @Y30LB54*/
@RF00101 DS    0H                                                  0112
*   CHAR4(1:1)=CDHEDHU&'01'X;       /* CONVERT TO LOOK ONLY AT DHU 0112
*                                                            @Y30LB54*/
@RC00101 MVC   CHAR4(1,DHEWKPTR),CDHEDHU(LPARMPTR)                 0112
         NI    CHAR4(DHEWKPTR),X'01'                               0112
*   IF CHAR4(1:1)='01'X THEN                                       0113
         CLI   CHAR4(DHEWKPTR),X'01'                               0113
         BNE   @RF00113                                            0113
*     DO;                           /*                       @Y30LB54*/
*       CALL RPT5FILL;              /* DO DHE COUNTERS       @Y30LB54*/
         BAL   @14,RPT5FILL                                        0115
*       IF RETCODE^=0 THEN          /* MUST HAVE HAD ERROR ON INPUT
*                                                            @Y30LB54*/
         LTR   RETCODE,RETCODE                                     0116
         BZ    @RF00116                                            0116
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/
         L     @13,4(,@13)                                         0117
         L     @00,@SIZDATD                                        0117
         LR    @01,@12                                             0117
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0117
         L     @14,12(,@13)                                        0117
         LM    @00,@12,20(@13)                                     0117
         BR    @14                                                 0117
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0119
*     ;                             /*                       @Y30LB54*/
*                                                                  0119
@RF00113 DS    0H                                                  0120
*   /*****************************************************************/
*   /*                                                               */
*   /* THATS IT FOR THIS RECORD                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0120
*/*ADDRESS STOP AT THIS POINT                                @Y30LB54
*                                                            @Y30LB54*/
*                                                                  0120
*   RETURN CODE(RETCODE);           /* FINAL EXIT FROM ACCUMULATOR 0120
*                                      PORTION               @Y30LB54*/
@RC00113 L     @13,4(,@13)                                         0120
         L     @00,@SIZDATD                                        0120
         LR    @01,@12                                             0120
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0120
         L     @14,12(,@13)                                        0120
         LM    @00,@12,20(@13)                                     0120
         BR    @14                                                 0120
*                                                                  0121
*   /*****************************************************************/
*   /*                                                               */
*   /* DID WE HAVE THIS LIBRARY BEFORE IF NOT GET CTRS               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0121
*LIBMATCH:                                                         0121
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/
LIBMATCH ST    @14,@SA00002                                        0121
*   PTRLIB=0;                       /* FORCE IT TO FILL IN CORRECT 0122
*                                      ADDRESS               @Y30LB54*/
         SLR   @10,@10                                             0122
         ST    @10,PTRLIB(,DHEWKPTR)                               0122
*   CHAR4=DATALIB;                  /* NEED TO MOVE IT TO CHAR AREA
*                                      FOR SUBSCRIPTING      @Y30LB54*/
         MVC   CHAR4(4,DHEWKPTR),DATALIB(DHEWKPTR)                 0123
*   DO CTR=1 TO 4 BY 1;             /* FOUR LIBRARY REPORTS POSSIBLE
*                                                            @Y30LB54*/
         LA    @10,1                                               0124
         ST    @10,CTR(,DHEWKPTR)                                  0124
@DL00124 DS    0H                                                  0125
*     IF CHAR4(4)=LIBNO(CTR) THEN   /* DO WE HAVE A VALID LIBRARY  0125
*                                                            @Y30LB54*/
         L     @10,CTR(,DHEWKPTR)                                  0125
         SLA   @10,2                                               0125
         ST    @10,@TF00001                                        0125
         ALR   @10,DHEWKPTR                                        0125
         CLC   CHAR4+3(1,DHEWKPTR),LIBNO-4(@10)                    0125
         BNE   @RF00125                                            0125
*       DO;                         /*                       @Y30LB54*/
*         IF LIBPTR(CTR)=0 THEN     /* DID WE HAVE ONE BEFORE@Y30LB54*/
         L     @10,@TF00001                                        0127
         L     @10,LIBPTR-5(@10,DHEWKPTR)                          0127
         LA    @10,0(,@10)                                         0127
         LTR   @10,@10                                             0127
         BNZ   @RF00127                                            0127
*           DO;                     /*                       @Y30LB54*/
*             SPNO=0;               /* INSERT SUBPOOL ID WE WANT   0129
*                                                            @Y30LB54*/
*                                                                  0129
         MVI   SPNO(CVTPTR),X'00'                                  0129
*             /*******************************************************/
*             /*                                                     */
*             /* EACH LIBRARY HAS SET OF COUNTERS DHU HAS 48 COUNTERS*/
*             /* OF 4 BYTES FOR 192 BYTES DHUA HAS 192 COUNTERS OF 4 */
*             /* BYTES FOR 768 BYTES PLUS 8 BYTES EACH OF 4 DAYS FOR */
*             /* THE JULIAN DATE + OFFSET                            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0130
*             CORELEN=192+32+768;   /* LENGTH OF COUNTERS    @Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00346+1                        0130
*             CALL ISDAGET1(WORKPTR);/* GET THE CORE         @Y30LB54*/
         L     @10,@PC00001                                        0131
         ST    @10,@AL00001                                        0131
         L     @15,@CV00041                                        0131
         LA    @01,@AL00001                                        0131
         BALR  @14,@15                                             0131
*             RFY                                                  0132
*               R15 RSTD;           /*                       @Y30LB54*/
*             RETCODE=R15;          /* SAVE RETURN CODE FROM GETMAIN
*                                                            @Y30LB54*/
         LR    RETCODE,R15                                         0133
*             RFY                                                  0134
*               R15 UNRSTD;         /* RELEASE REG 15 FOR OTHER USE
*                                                            @Y30LB54*/
*             IF RETCODE=0 THEN                                    0135
         LTR   RETCODE,RETCODE                                     0135
         BNZ   @RF00135                                            0135
*               DO;                 /*                       @Y30LB54*/
*                 PTRLIB=COREADDR;  /* POINT TO MY COUNTERS  @Y30LB54*/
         L     @10,COREADDR(,CVTPTR)                               0137
         ST    @10,PTRLIB(,DHEWKPTR)                               0137
*                 LIBPTR(CTR)=PTRLIB;/*                      @Y30LB54*/
         L     @15,CTR(,DHEWKPTR)                                  0138
         SLA   @15,2                                               0138
         ALR   @15,DHEWKPTR                                        0138
         STCM  @10,7,LIBPTR-4(@15)                                 0138
*                 CTR=100;          /* TERMINATE THE LOOP    @Y30LB54*/
         MVC   CTR(4,DHEWKPTR),@CF00318                            0139
*                 KICKPTR=PTRLIB;   /* ZERO OUT THE GETMAIN CORE   0140
*                                                            @Y30LB54*/
         ST    @10,KICKPTR(,DHEWKPTR)                              0140
*                 DO CTR1=1 TO 248 BY 1;/* THEY MAY CONTAIN JUNK   0141
*                                                            @Y30LB54*/
         LA    @10,1                                               0141
         ST    @10,CTR1(,DHEWKPTR)                                 0141
@DL00141 DS    0H                                                  0142
*                   COUNTER(CTR1)=0;/*                       @Y30LB54*/
         L     @10,CTR1(,DHEWKPTR)                                 0142
         SLA   @10,2                                               0142
         L     @01,KICKPTR(,DHEWKPTR)                              0142
         SLR   @00,@00                                             0142
         AL    @01,@CF00348                                        0142
         ST    @00,COUNTER(@10,@01)                                0142
*                 END;              /*                       @Y30LB54*/
         LA    @10,1                                               0143
         AL    @10,CTR1(,DHEWKPTR)                                 0143
         ST    @10,CTR1(,DHEWKPTR)                                 0143
         CH    @10,@CH00319                                        0143
         BNH   @DL00141                                            0143
*                 KICKPTR=PTRLIB+192;/* SKIP DHU PORTION OF COUNTERS
*                                                            @Y30LB54*/
         LA    @10,192                                             0144
         AL    @10,PTRLIB(,DHEWKPTR)                               0144
         ST    @10,KICKPTR(,DHEWKPTR)                              0144
*                 FULLWD1=32;       /* START COUNTERS AFTER CONTROL
*                                      PORTION               @Y30LB54*/
         MVC   FULLWD1(4,DHEWKPTR),@CF00316                        0145
*                 DO CTR1=2 TO 8 BY 2;/* FILL IN DAY OFFSETS IN    0146
*                                      CONTROL PORTION       @Y30LB54*/
         LA    @10,2                                               0146
         ST    @10,CTR1(,DHEWKPTR)                                 0146
@DL00146 DS    0H                                                  0147
*                   COUNTER(CTR1)=FULLWD1;/*                 @Y30LB54*/
         L     @10,CTR1(,DHEWKPTR)                                 0147
         SLA   @10,2                                               0147
         L     @01,KICKPTR(,DHEWKPTR)                              0147
         L     @15,FULLWD1(,DHEWKPTR)                              0147
         AL    @01,@CF00348                                        0147
         ST    @15,COUNTER(@10,@01)                                0147
*                   FULLWD1=FULLWD1+192;/* ADJUST FOR NEXT DAYS    0148
*                                      OFFSET                @Y30LB54*/
         AH    @15,@CH00315                                        0148
         ST    @15,FULLWD1(,DHEWKPTR)                              0148
*                 END;              /*                       @Y30LB54*/
         LA    @10,2                                               0149
         AL    @10,CTR1(,DHEWKPTR)                                 0149
         ST    @10,CTR1(,DHEWKPTR)                                 0149
         CH    @10,@CH00072                                        0149
         BNH   @DL00146                                            0149
*               END;                /*                       @Y30LB54*/
*             ELSE                  /* NO CORE AVAILABLE     @Y30LB54*/
*                                                                  0151
*               /*****************************************************/
*               /*                                                   */
*               /* FREE ALL CORE ALREADY OBTAINED                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0151
*               DO;                                        /*@Y30LB54*/
         B     @RC00135                                            0151
@RF00135 DS    0H                                                  0152
*                 CALL FREECORE;    /*                       @Y30LB54*/
         BAL   @14,FREECORE                                        0152
*                 RETURN CODE(RETCODE);                    /*@Y30LB54*/
         LR    @15,RETCODE                                         0153
@EL00002 DS    0H                                                  0153
@EF00002 DS    0H                                                  0153
@ER00002 L     @14,@SA00002                                        0153
         BR    @14                                                 0153
*               END;                                       /*@Y30LB54*/
*           END;                    /*                       @Y30LB54*/
*         ELSE                                                     0156
*           DO;                     /*                       @Y30LB54*/
         B     @RC00127                                            0156
@RF00127 DS    0H                                                  0157
*             PTRLIB=LIBPTR(CTR);   /* USE OLD ONE           @Y30LB54*/
         L     @10,CTR(,DHEWKPTR)                                  0157
         SLA   @10,2                                               0157
         L     @10,LIBPTR-5(@10,DHEWKPTR)                          0157
         LA    @10,0(,@10)                                         0157
         ST    @10,PTRLIB(,DHEWKPTR)                               0157
*             CTR=100;              /*                       @Y30LB54*/
         MVC   CTR(4,DHEWKPTR),@CF00318                            0158
*           END;                    /*                       @Y30LB54*/
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0161
*       ;                           /*                       @Y30LB54*/
@RF00125 DS    0H                                                  0162
*   END;                            /*                       @Y30LB54*/
@RC00125 LA    @10,1                                               0162
         AL    @10,CTR(,DHEWKPTR)                                  0162
         ST    @10,CTR(,DHEWKPTR)                                  0162
         CH    @10,@CH00051                                        0162
         BNH   @DL00124                                            0162
*   IF CTR^>99 THEN                                                0163
         L     @10,CTR(,DHEWKPTR)                                  0163
         CH    @10,@CH00321                                        0163
         BH    @RF00163                                            0163
*     DO;                           /*                       @Y30LB54*/
*       RETCODE=8;                  /* INVALID LIBRARY NO ON INPUT 0165
*                                                            @Y30LB54*/
         LA    RETCODE,8                                           0165
*       RETURN CODE(RETCODE);       /*                       @Y30LB54*/
         LR    @15,RETCODE                                         0166
         L     @14,@SA00002                                        0166
         BR    @14                                                 0166
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0168
*     ;                             /*                       @Y30LB54*/
@RF00163 DS    0H                                                  0169
*   END LIBMATCH;                   /*                       @Y30LB54*/
         B     @EL00002                                            0169
*                                                                  0170
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL THE DHU COUNTERS                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0170
*RPT4FILL:                                                         0170
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/
RPT4FILL ST    @14,12(,@13)                                        0170
*   PTRINP=ADDR(DATA04);            /* POINT TO DHU COMPOSIT DATA  0171
*                                                            @Y30LB54*/
         LA    @10,DATA04(,DHEWKPTR)                               0171
         ST    @10,PTRINP(,DHEWKPTR)                               0171
*   PTRRPT=0;                       /* DHU COUNTER OFFSET    @Y30LB54*/
         SLR   @10,@10                                             0172
         ST    @10,PTRRPT(,DHEWKPTR)                               0172
*   KICKPTR=PTRLIB+PTRRPT+PTRSSID;  /* DETERMINE BUNCH OF COUNTERS 0173
*                                                            @Y30LB54*/
         AL    @10,PTRLIB(,DHEWKPTR)                               0173
         AL    @10,PTRSSID(,DHEWKPTR)                              0173
         ST    @10,KICKPTR(,DHEWKPTR)                              0173
*   DO CTR=1 TO 6 BY 1;             /* SIX COUNTERS NEED TO BE WORKED
*                                      ON                    @Y30LB54*/
         LA    @10,1                                               0174
         ST    @10,CTR(,DHEWKPTR)                                  0174
@DL00174 DS    0H                                                  0175
*     COUNTER(CTR)=COUNTER(CTR)+INCTR(CTR);/* ADD TO COUNTERS@Y30LB54*/
         L     @10,CTR(,DHEWKPTR)                                  0175
         SLA   @10,2                                               0175
         L     @15,KICKPTR(,DHEWKPTR)                              0175
         L     @14,PTRINP(,DHEWKPTR)                               0175
         LA    @01,0(@10,@15)                                      0175
         AL    @01,@CF00348                                        0175
         L     @09,COUNTER(,@01)                                   0175
         AL    @14,@CF00348                                        0175
         AL    @09,INCTR(@10,@14)                                  0175
         AL    @15,@CF00348                                        0175
         ST    @09,COUNTER(@10,@15)                                0175
*     COUNTRP4=COUNTRP4+1;          /* INCREMENT NUMBER OF TIMES   0176
*                                      ADDED                 @Y30LB54*/
         LA    @10,1                                               0176
         AL    @10,COUNTRP4(,DHEWKPTR)                             0176
         ST    @10,COUNTRP4(,DHEWKPTR)                             0176
*   END;                            /*                       @Y30LB54*/
         LA    @10,1                                               0177
         AL    @10,CTR(,DHEWKPTR)                                  0177
         ST    @10,CTR(,DHEWKPTR)                                  0177
         CH    @10,@CH00142                                        0177
         BNH   @DL00174                                            0177
*   END RPT4FILL;                   /*                       @Y30LB54*/
@EL00003 DS    0H                                                  0178
@EF00003 DS    0H                                                  0178
@ER00003 L     @14,12(,@13)                                        0178
         BR    @14                                                 0178
*                                                                  0179
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL THE DHUA COUNTERS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0179
*RPT4AFIL:                                                         0179
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/
RPT4AFIL ST    @14,12(,@13)                                        0179
*   PTRINP=ADDR(DATA04);            /* POINT TO DHU COMPOSIT DATA  0180
*                                                            @Y30LB54*/
         LA    @10,DATA04(,DHEWKPTR)                               0180
         ST    @10,PTRINP(,DHEWKPTR)                               0180
*   PTRDATE=0;                      /* RESET DATE POINTER INTO     0181
*                                      COUNTERS              @Y30LB54*/
         SLR   @10,@10                                             0181
         ST    @10,PTRDATE(,DHEWKPTR)                              0181
*   PTRRPT=192;                     /* OFFSET TO THE 4A COUNTERS   0182
*                                                            @Y30LB54*/
         LA    @10,192                                             0182
         ST    @10,PTRRPT(,DHEWKPTR)                               0182
*   KICKPTR=PTRLIB+PTRRPT;          /* FIND CORRECT SET OF COUNTERS
*                                      TO WORK               @Y30LB54*/
         AL    @10,PTRLIB(,DHEWKPTR)                               0183
         ST    @10,KICKPTR(,DHEWKPTR)                              0183
*/*FIRST 32 BYTES OF 4A AREA IS CONTROL INFO                 @Y30LB54*/
*                                                                  0184
*   /*****************************************************************/
*   /*                                                               */
*   /* STRIP CONTROL INFO INTO WORKING CORE                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0184
*   CTR=1;                          /* COUNTER OFFSET        @Y30LB54*/
         LA    @10,1                                               0184
         ST    @10,CTR(,DHEWKPTR)                                  0184
*   DO CTR1=1 TO 4 BY 1;            /* EXTRACT LIBRARY DAY CONTROL 0185
*                                      INFO TO WORKING       @Y30LB54*/
         ST    @10,CTR1(,DHEWKPTR)                                 0185
@DL00185 DS    0H                                                  0186
*     DATEYYDD(CTR1)=COUNTER(CTR);  /* PICK OFF YEAR DAY     @Y30LB54*/
         L     @10,CTR1(,DHEWKPTR)                                 0186
         SLA   @10,3                                               0186
         L     @15,CTR(,DHEWKPTR)                                  0186
         LR    @14,@15                                             0186
         SLA   @14,2                                               0186
         L     @09,KICKPTR(,DHEWKPTR)                              0186
         AL    @14,@CF00348                                        0186
         L     @14,COUNTER(@14,@09)                                0186
         ST    @14,DATEYYDD-8(@10,DHEWKPTR)                        0186
*     CTR=CTR+1;                    /* GO TO NEXT CONTROL FIELD    0187
*                                                            @Y30LB54*/
         LA    @14,1                                               0187
         ALR   @15,@14                                             0187
         ST    @15,CTR(,DHEWKPTR)                                  0187
*     DATEOFST(CTR1)=COUNTER(CTR);  /* PICK OFF WORKING COUNTER    0188
*                                      OFFSET                @Y30LB54*/
         LR    @08,@15                                             0188
         SLA   @08,2                                               0188
         AL    @09,@CF00348                                        0188
         L     @09,COUNTER(@08,@09)                                0188
         ST    @09,DATEOFST-8(@10,DHEWKPTR)                        0188
*     CTR=CTR+ONE;                  /* GO TO NEXT CONTROL FIELD    0189
*                                                            @Y30LB54*/
         ALR   @15,@14                                             0189
         ST    @15,CTR(,DHEWKPTR)                                  0189
*   END;                            /* DO THIS PROCESS FOR FOUR DAYS
*                                      WORTH OF DATA         @Y30LB54*/
         LA    @10,1                                               0190
         AL    @10,CTR1(,DHEWKPTR)                                 0190
         ST    @10,CTR1(,DHEWKPTR)                                 0190
         CH    @10,@CH00051                                        0190
         BNH   @DL00185                                            0190
*   DATEYYDD(FIVE)=DATETIME(1:4);   /* FILL IN CURRENT RECORD DATE 0191
*                                      FOR SORT              @Y30LB54*/
         L     @10,LOGPTR(,DHEWKPTR)                               0191
         MVC   DATEYYDD+32(4,DHEWKPTR),DATETIME(@10)               0191
*   DATEOFST(FIVE)=0;               /* NO OFFSET ON NEW RECORD     0192
*                                                            @Y30LB54*/
*                                                                  0192
         SLR   @10,@10                                             0192
         ST    @10,DATEOFST+32(,DHEWKPTR)                          0192
*   /*****************************************************************/
*   /*                                                               */
*   /* ARANGE NEW DAY TO DETERMINE IF PREEMPTION OF OLD DAY NEEDED   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0193
*   PTRDATE=0;                      /* DATE OFFSET INTO COUNTERS   0193
*                                                            @Y30LB54*/
         ST    @10,PTRDATE(,DHEWKPTR)                              0193
*   SORTSW='0'B;                    /* TURN OFF SORT KEY     @Y30LB54*/
         MVI   SORTSW(DHEWKPTR),B'00000000'                        0194
*   DO CTR1=1 TO 4 BY 1;            /* DETERMINE IF SORT IS NEEDED 0195
*                                                            @Y30LB54*/
         LA    @10,1                                               0195
         ST    @10,CTR1(,DHEWKPTR)                                 0195
@DL00195 DS    0H                                                  0196
*     IF DATEYYDD(FIVE)>DATEYYDD(CTR1) THEN/* IF SO SORT IS NEEDED 0196
*                                                            @Y30LB54*/
         L     @10,CTR1(,DHEWKPTR)                                 0196
         SLA   @10,3                                               0196
         ALR   @10,DHEWKPTR                                        0196
         CLC   DATEYYDD+32(4,DHEWKPTR),DATEYYDD-8(@10)             0196
         BNH   @RF00196                                            0196
*       DO;                         /*                       @Y30LB54*/
*         CTR1=100;                 /* STOP THE LOOP         @Y30LB54*/
*                                                                  0198
         MVC   CTR1(4,DHEWKPTR),@CF00318                           0198
*         /***********************************************************/
*         /*                                                         */
*         /* SORT THE DAY CONTROL TABLE                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0199
*         DO CTR=1 TO 4 BY 1;       /* SORT NEW TABLE        @Y30LB54*/
         LA    @10,1                                               0199
         ST    @10,CTR(,DHEWKPTR)                                  0199
@DL00199 DS    0H                                                  0200
*           IF DATEYYDD(CTR+1)>DATEYYDD(CTR) THEN                  0200
         L     @10,CTR(,DHEWKPTR)                                  0200
         SLA   @10,3                                               0200
         ST    @10,@TF00001                                        0200
         ALR   @10,DHEWKPTR                                        0200
         LR    @01,DHEWKPTR                                        0200
         AL    @01,@TF00001                                        0200
         CLC   DATEYYDD(4,@10),DATEYYDD-8(@01)                     0200
         BNH   @RF00200                                            0200
*             DO;                   /*                       @Y30LB54*/
*               FULLWD1=DATEYYDD(CTR);/* SAVE LOWER OF DATES @Y30LB54*/
         L     @10,@TF00001                                        0202
         L     @10,DATEYYDD-8(@10,DHEWKPTR)                        0202
         ST    @10,FULLWD1(,DHEWKPTR)                              0202
*               FULLWD2=DATEOFST(CTR);/* SAVE LOWER COUNTER OFFSET 0203
*                                                            @Y30LB54*/
         L     @01,@TF00001                                        0203
         L     @15,DATEOFST-8(@01,DHEWKPTR)                        0203
         ST    @15,FULLWD2(,DHEWKPTR)                              0203
*               DATETBL(CTR)=DATETBL(CTR+1);/* MOVE ENTIRE CONTROL 0204
*                                      ENTRY                 @Y30LB54*/
         LR    @01,DHEWKPTR                                        0204
         AL    @01,@TF00001                                        0204
         LR    @14,DHEWKPTR                                        0204
         AL    @14,@TF00001                                        0204
         MVC   DATETBL-8(8,@01),DATETBL(@14)                       0204
*               DATEYYDD(CTR+1)=FULLWD1;/* SWAP IN LOWER DATE@Y30LB54*/
         L     @01,@TF00001                                        0205
         ST    @10,DATEYYDD(@01,DHEWKPTR)                          0205
*               DATEOFST(CTR+1)=FULLWD2;/* SWAP IN LOWER OFFSET    0206
*                                                            @Y30LB54*/
         L     @10,@TF00001                                        0206
         ST    @15,DATEOFST(@10,DHEWKPTR)                          0206
*               SORTSW='1'B;        /* LET WORLD KNOW WE HAVE NEW  0207
*                                      DATE                  @Y30LB54*/
         MVI   SORTSW(DHEWKPTR),B'10000000'                        0207
*               CTR=0;              /* BUBBLE UP SORT THE ENTIRE LIST
*                                      AGAIN                 @Y30LB54*/
         SLR   @10,@10                                             0208
         ST    @10,CTR(,DHEWKPTR)                                  0208
*             END;                  /*                       @Y30LB54*/
*           ELSE                                                   0210
*             ;                     /*                       @Y30LB54*/
@RF00200 DS    0H                                                  0211
*         END;                      /*                       @Y30LB54*/
         LA    @10,1                                               0211
         AL    @10,CTR(,DHEWKPTR)                                  0211
         ST    @10,CTR(,DHEWKPTR)                                  0211
         CH    @10,@CH00051                                        0211
         BNH   @DL00199                                            0211
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0213
*                                                                  0213
*       /*************************************************************/
*       /*                                                           */
*       /* WE DID NOT NEED SORT DID WE HAVE MATCH                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0213
*       IF DATEYYDD(FIVE)=DATEYYDD(CTR1) THEN                      0213
         B     @RC00196                                            0213
@RF00196 L     @10,CTR1(,DHEWKPTR)                                 0213
         SLA   @10,3                                               0213
         ST    @10,@TF00001                                        0213
         ALR   @10,DHEWKPTR                                        0213
         CLC   DATEYYDD+32(4,DHEWKPTR),DATEYYDD-8(@10)             0213
         BNE   @RF00213                                            0213
*         DO;                       /*                       @Y30LB54*/
*           PTRDATE=DATEOFST(CTR1); /*                       @Y30LB54*/
         L     @10,@TF00001                                        0215
         L     @10,DATEOFST-8(@10,DHEWKPTR)                        0215
         ST    @10,PTRDATE(,DHEWKPTR)                              0215
*           CTR1=100;               /* TERMINATE LOOP WE HAVE HIT  0216
*                                                            @Y30LB54*/
         MVC   CTR1(4,DHEWKPTR),@CF00318                           0216
*         END;                      /*                       @Y30LB54*/
*       ELSE                                                       0218
*         ;                         /* CHECK NEXT CONTROL FIELD NOT
*                                      HIGH AND NOT EQUAL DONT ADD   */
@RF00213 DS    0H                                                  0219
*   END;                            /*                       @Y30LB54*/
@RC00196 LA    @10,1                                               0219
         AL    @10,CTR1(,DHEWKPTR)                                 0219
         ST    @10,CTR1(,DHEWKPTR)                                 0219
         CH    @10,@CH00051                                        0219
         BNH   @DL00195                                            0219
*   IF SORTSW^='00000000'B THEN     /* WE NOW HAVE A NEW DATE CONTROL
*                                      FIELD                 @Y30LB54*/
*                                                                  0220
         CLI   SORTSW(DHEWKPTR),B'00000000'                        0220
         BE    @RF00220                                            0220
*     /***************************************************************/
*     /*                                                             */
*     /* LATER DATE FOUND UPDATE MASTER LIBRARY CONTROL FIELD        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0221
*     DO;                           /*                       @Y30LB54*/
*       CTR=1;                      /* COUNTER OFFSET        @Y30LB54*/
         LA    @10,1                                               0222
         ST    @10,CTR(,DHEWKPTR)                                  0222
*       DO CTR1=1 TO 4 BY 1;        /* WE ARE GOING TO BUILD NEW   0223
*                                      CONTROL RECORD        @Y30LB54*/
         ST    @10,CTR1(,DHEWKPTR)                                 0223
@DL00223 DS    0H                                                  0224
*         COUNTER(CTR)=DATEYYDD(CTR1);/* MOVE IN YYDDD       @Y30LB54*/
         L     @10,CTR(,DHEWKPTR)                                  0224
         LR    @15,@10                                             0224
         SLA   @15,2                                               0224
         L     @14,KICKPTR(,DHEWKPTR)                              0224
         L     @09,CTR1(,DHEWKPTR)                                 0224
         SLA   @09,3                                               0224
         L     @08,DATEYYDD-8(@09,DHEWKPTR)                        0224
         AL    @15,@CF00348                                        0224
         ST    @08,COUNTER(@15,@14)                                0224
*         CTR=CTR+1;                /* POINT TO NEXT CONTROL OUTPUT
*                                      FIELD                 @Y30LB54*/
         LA    @08,1                                               0225
         ALR   @10,@08                                             0225
         ST    @10,CTR(,DHEWKPTR)                                  0225
*         IF DATEOFST(CTR1)=0 THEN  /* THIS WAS THE INSERTED NEW   0226
*                                      FIELD                 @Y30LB54*/
         L     @10,DATEOFST-8(@09,DHEWKPTR)                        0226
         LTR   @10,@10                                             0226
         BNZ   @RF00226                                            0226
*           DO;                     /*                       @Y30LB54*/
*             DATEOFST(CTR1)=DATEOFST(FIVE);/* GUY ON BOTTOM LOOSES
*                                      OUT                   @Y30LB54*/
         L     @10,DATEOFST+32(,DHEWKPTR)                          0228
         ST    @10,DATEOFST-8(@09,DHEWKPTR)                        0228
*             PTRDATE=DATEOFST(FIVE);/*                      @Y30LB54*/
         L     @10,DATEOFST+32(,DHEWKPTR)                          0229
         ST    @10,PTRDATE(,DHEWKPTR)                              0229
*             FULLWD2=KICKPTR;      /* SAVE POINTER TO CONTROL FIELDS
*                                                            @Y30LB54*/
         ST    @14,FULLWD2(,DHEWKPTR)                              0230
*             KICKPTR=PTRLIB+PTRRPT+PTRDATE+PTRSSID;/*       @Y30LB54*/
         L     @09,PTRLIB(,DHEWKPTR)                               0231
         AL    @09,PTRRPT(,DHEWKPTR)                               0231
         ALR   @09,@10                                             0231
         AL    @09,PTRSSID(,DHEWKPTR)                              0231
         ST    @09,KICKPTR(,DHEWKPTR)                              0231
*             DO FULLWD1=1 TO 6 BY 1;/*                      @Y30LB54*/
         ST    @08,FULLWD1(,DHEWKPTR)                              0232
@DL00232 DS    0H                                                  0233
*               COUNTER(FULLWD1)=0; /* ZERO COUNTERS         @Y30LB54*/
         L     @10,FULLWD1(,DHEWKPTR)                              0233
         SLA   @10,2                                               0233
         L     @01,KICKPTR(,DHEWKPTR)                              0233
         SLR   @00,@00                                             0233
         AL    @01,@CF00348                                        0233
         ST    @00,COUNTER(@10,@01)                                0233
*             END;                  /*                       @Y30LB54*/
         LA    @08,1                                               0234
         AL    @08,FULLWD1(,DHEWKPTR)                              0234
         ST    @08,FULLWD1(,DHEWKPTR)                              0234
         CH    @08,@CH00142                                        0234
         BNH   @DL00232                                            0234
*             KICKPTR=FULLWD2;      /* RESET KICKPTR BACK TO CONTROL
*                                      FIELD                 @Y30LB54*/
         MVC   KICKPTR(4,DHEWKPTR),FULLWD2(DHEWKPTR)               0235
*           END;                    /*                       @Y30LB54*/
*         ELSE                                                     0237
*           ;                       /*                       @Y30LB54*/
@RF00226 DS    0H                                                  0238
*         COUNTER(CTR)=DATEOFST(CTR1);/* MOVE OFFSET INTO MASTER   0238
*                                      CONTROL RCD           @Y30LB54*/
         L     @10,CTR(,DHEWKPTR)                                  0238
         LR    @15,@10                                             0238
         SLA   @15,2                                               0238
         L     @01,KICKPTR(,DHEWKPTR)                              0238
         L     @14,CTR1(,DHEWKPTR)                                 0238
         SLA   @14,3                                               0238
         L     @14,DATEOFST-8(@14,DHEWKPTR)                        0238
         AL    @01,@CF00348                                        0238
         ST    @14,COUNTER(@15,@01)                                0238
*         CTR=CTR+1;                /* POINT TO NEXT CONTROL OUTPUT
*                                      FIELD                 @Y30LB54*/
         AH    @10,@CH00048                                        0239
         ST    @10,CTR(,DHEWKPTR)                                  0239
*       END;                        /*                       @Y30LB54*/
         LA    @10,1                                               0240
         AL    @10,CTR1(,DHEWKPTR)                                 0240
         ST    @10,CTR1(,DHEWKPTR)                                 0240
         CH    @10,@CH00051                                        0240
         BNH   @DL00223                                            0240
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0242
*     ;                             /*                       @Y30LB54*/
@RF00220 DS    0H                                                  0243
*   IF PTRDATE^=0 THEN                                             0243
*                                                                  0243
         L     @10,PTRDATE(,DHEWKPTR)                              0243
         LTR   @10,@10                                             0243
         BZ    @RF00243                                            0243
*     /***************************************************************/
*     /*                                                             */
*     /* WE HAVE A RECORD OF LATEST 4 DAYS ADD TO COUNTERS           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0244
*     DO;                           /*                       @Y30LB54*/
*       KICKPTR=PTRLIB+PTRRPT+PTRDATE+PTRSSID;/*             @Y30LB54*/
         L     @15,PTRLIB(,DHEWKPTR)                               0245
         AL    @15,PTRRPT(,DHEWKPTR)                               0245
         ALR   @15,@10                                             0245
         AL    @15,PTRSSID(,DHEWKPTR)                              0245
         ST    @15,KICKPTR(,DHEWKPTR)                              0245
*       DO CTR=1 TO 6 BY 1;         /* WANT TO ADD IN 6 COUNTERS   0246
*                                                            @Y30LB54*/
         LA    @10,1                                               0246
         ST    @10,CTR(,DHEWKPTR)                                  0246
@DL00246 DS    0H                                                  0247
*         COUNTER(CTR)=INCTR(CTR)+COUNTER(CTR);/*            @Y30LB54*/
         L     @10,CTR(,DHEWKPTR)                                  0247
         SLA   @10,2                                               0247
         L     @15,KICKPTR(,DHEWKPTR)                              0247
         L     @14,PTRINP(,DHEWKPTR)                               0247
         AL    @14,@CF00348                                        0247
         L     @14,INCTR(@10,@14)                                  0247
         LA    @01,0(@10,@15)                                      0247
         AL    @01,@CF00348                                        0247
         AL    @14,COUNTER(,@01)                                   0247
         AL    @15,@CF00348                                        0247
         ST    @14,COUNTER(@10,@15)                                0247
*         COUNTR4A=COUNTR4A+1;      /* NUMBER OF TIMES COUNTERS ADDED
*                                      TO                    @Y30LB54*/
         LA    @10,1                                               0248
         AL    @10,COUNTR4A(,DHEWKPTR)                             0248
         ST    @10,COUNTR4A(,DHEWKPTR)                             0248
*       END;                        /*                       @Y30LB54*/
         LA    @10,1                                               0249
         AL    @10,CTR(,DHEWKPTR)                                  0249
         ST    @10,CTR(,DHEWKPTR)                                  0249
         CH    @10,@CH00142                                        0249
         BNH   @DL00246                                            0249
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0251
*     ;                             /*                       @Y30LB54*/
@RF00243 DS    0H                                                  0252
*   END RPT4AFIL;                   /*                       @Y30LB54*/
@EL00004 DS    0H                                                  0252
@EF00004 DS    0H                                                  0252
@ER00004 L     @14,12(,@13)                                        0252
         BR    @14                                                 0252
*                                                                  0253
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE DHE COMPOSIT RECORDS                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0253
*RPT5FILL:                                                         0253
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/
RPT5FILL ST    @14,@SA00005                                        0253
*   PTRINP=ADDR(DATA05)+12;         /* ADDRESS OF COMPOSIT COUNTERS
*                                                            @Y30LB54*/
         LA    @10,DATA05(,DHEWKPTR)                               0254
         AH    @10,@CH00065                                        0254
         ST    @10,PTRINP(,DHEWKPTR)                               0254
*   DO CTR=1 TO 6 BY 1;             /* LOOK FOR OVERFLOWED COUNTER 0255
*                                                            @Y30LB54*/
         LA    @10,1                                               0255
         ST    @10,CTR(,DHEWKPTR)                                  0255
@DL00255 DS    0H                                                  0256
*     LINE(1:4)=INCTR(CTR)&MSK(CTR);/* CLEAR EVERYTHING EXCEPT     0256
*                                      OVERFLOW              @Y30LB54*/
         L     @10,CTR(,DHEWKPTR)                                  0256
         SLA   @10,2                                               0256
         L     @01,PTRINP(,DHEWKPTR)                               0256
         L     @15,MSK-4(@10)                                      0256
         AL    @01,@CF00348                                        0256
         L     @10,INCTR(@10,@01)                                  0256
         NR    @10,@15                                             0256
         ST    @10,LINE(,CVTPTR)                                   0256
*     IF LINE(1:4)=MSK(CTR) THEN    /* 1 BIT MEANS OVERFLOW  @Y30LB54*/
         CR    @10,@15                                             0257
         BNE   @RF00257                                            0257
*       DO;                         /*                       @Y30LB54*/
*         IF PTR5TOP=0 THEN         /* HAVE WE HAD ANY BEFORE@Y30LB54*/
         ICM   @10,15,PTR5TOP(DHEWKPTR)                            0259
         BNZ   @RF00259                                            0259
*           DO;                     /*                       @Y30LB54*/
*             SPNO=0;               /* SUBPOOL NUMBER        @Y30LB54*/
         MVI   SPNO(CVTPTR),X'00'                                  0261
*             CORELEN=50*36;        /* ALLOW FOR 50 OVERFLOW RECORDS
*                                                            @Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00347+1                        0262
*             CALL ISDAGET1(WORKPTR);/*                      @Y30LB54*/
         L     @10,@PC00001                                        0263
         ST    @10,@AL00001                                        0263
         L     @15,@CV00041                                        0263
         LA    @01,@AL00001                                        0263
         BALR  @14,@15                                             0263
*             RFY                                                  0264
*               R15 RSTD;           /*                       @Y30LB54*/
*             RETCODE=R15;          /*                       @Y30LB54*/
         LR    RETCODE,R15                                         0265
*             RFY                                                  0266
*               R15 UNRSTD;         /*                       @Y30LB54*/
*             IF RETCODE=0 THEN     /* WE GOT CORE OK        @Y30LB54*/
         LTR   RETCODE,RETCODE                                     0267
         BNZ   @RF00267                                            0267
*               DO;                 /*                       @Y30LB54*/
*                 PTR5TOP=COREADDR; /* BEGINNING OF CORE AREA@Y30LB54*/
         L     @10,COREADDR(,CVTPTR)                               0269
         ST    @10,PTR5TOP(,DHEWKPTR)                              0269
*                 PTR5CUR=COREADDR; /* CURRENT WORKING ADDRESS     0270
*                                                            @Y30LB54*/
         ST    @10,PTR5CUR(,DHEWKPTR)                              0270
*                 PTR5BOT=COREADDR+(50*36);/* BACK END OF CORE AREA
*                                                            @Y30LB54*/
         AL    @10,@CF00347                                        0271
         ST    @10,PTR5BOT(,DHEWKPTR)                              0271
*               END;                /*                       @Y30LB54*/
*             ELSE                  /* WE DID NOT GET CORE QUIT    0273
*                                                            @Y30LB54*/
*               DO;                 /*                       @Y30LB54*/
         B     @RC00267                                            0273
@RF00267 DS    0H                                                  0274
*                 CALL FREECORE;    /* FREE ALL CORE WE HAVE SO FAR
*                                                            @Y30LB54*/
         BAL   @14,FREECORE                                        0274
*                 RETCODE=4;        /*                       @Y30LB54*/
         LA    RETCODE,4                                           0275
*                 RETURN CODE(RETCODE);/*                    @Y30LB54*/
         LR    @15,RETCODE                                         0276
@EL00005 DS    0H                                                  0276
@EF00005 DS    0H                                                  0276
@ER00005 L     @14,@SA00005                                        0276
         BR    @14                                                 0276
*               END;                /*                       @Y30LB54*/
*           END;                    /*                       @Y30LB54*/
*         ELSE                      /* CHECK FOR MAX LIMIT   @ZM30983*/
*           IF PTR5BOT='FFFFFFFF'X THEN  /* WE HAVE EXCEEDED       0279
*                                           OUR LIMIT        @ZM30983*/
         B     @RC00259                                            0279
@RF00259 CLC   PTR5BOT(4,DHEWKPTR),@CF00334                        0279
         BNE   @RF00279                                            0279
*             DO;                   /*                       @ZM30983*/
*               RETCODE=16;         /* REJECT RECORD         @ZM30983*/
         LA    RETCODE,16                                          0281
*               RETURN CODE(RETCODE); /*                     @ZM30983*/
         LR    @15,RETCODE                                         0282
         L     @14,@SA00005                                        0282
         BR    @14                                                 0282
*             END;                  /*                       @ZM30983*/
*           ELSE;                   /* NOT AT MAX YET        @ZM30983*/
@RF00279 DS    0H                                                  0285
*                                                                  0285
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE INTO GETMAIN AREA                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0285
*         CTR=100;                  /* GET OUT OF LOOP       @Y30LB54*/
@RC00259 MVC   CTR(4,DHEWKPTR),@CF00318                            0285
*         IF PTR5CUR=PTR5BOT THEN   /* HAVE WE FILLED BUFFER @Y30LB54*/
         CLC   PTR5CUR(4,DHEWKPTR),PTR5BOT(DHEWKPTR)               0286
         BNE   @RF00286                                            0286
*           DO;                     /*                       @Y30LB54*/
*             PTR5BOT='FFFFFFFF'X;  /*    SET OVERFLOW FLAG  @Y30LB54*/
         MVC   PTR5BOT(4,DHEWKPTR),@CF00334                        0288
*             ANSI='-';             /* SET 2 LINE SKIP       @ZM30983*/
         MVI   ANSI(CVTPTR),C'-'                                   0289
*             LINE=                                                0290
*'ISDADHE0 OVERFLOW RECORDS EXCEED LIMIT FIRST 50 PROCESSED';      0290
         MVI   LINE+57(CVTPTR),C' '                                0290
         MVC   LINE+58(74,CVTPTR),LINE+57(CVTPTR)                  0290
         MVC   LINE(57,CVTPTR),@CC00336                            0290
*             CALL ISDAPRT0(WORKPTR);/*                      @Y30LB54*/
         L     @10,@PC00001                                        0291
         ST    @10,@AL00001                                        0291
         L     @15,@CV00039                                        0291
         LA    @01,@AL00001                                        0291
         BALR  @14,@15                                             0291
*             CALL ISDATYPE(WORKPTR);/*                      @Y30LB54*/
         L     @10,@PC00001                                        0292
         ST    @10,@AL00001                                        0292
         L     @15,@CV00040                                        0292
         LA    @01,@AL00001                                        0292
         BALR  @14,@15                                             0292
*             RETCODE=16;            /* SET DHE REJECT CODE  @ZM30983*/
         LA    RETCODE,16                                          0293
*             RETURN CODE(RETCODE); /*                       @Y30LB54*/
         LR    @15,RETCODE                                         0294
         L     @14,@SA00005                                        0294
         BR    @14                                                 0294
*           END;                    /*                       @Y30LB54*/
*         ELSE                                                     0296
*           ;                       /*                       @Y30LB54*/
@RF00286 DS    0H                                                  0297
*         RPT5RCD(ONE)=DATA05;      /*                       @Y30LB54*/
         L     @10,PTR5CUR(,DHEWKPTR)                              0297
         MVC   RPT5RCD(36,@10),DATA05(DHEWKPTR)                    0297
*         PTR5CUR=PTR5CUR+36;       /* INCREMENT FOR NEXT TIME     0298
*                                                            @Y30LB54*/
         AH    @10,@CH00275                                        0298
         ST    @10,PTR5CUR(,DHEWKPTR)                              0298
*         COUNTRP5=COUNTRP5+1;      /* TELL HE1 WE HAVE DATA @Y30LB54*/
         LA    @10,1                                               0299
         AL    @10,COUNTRP5(,DHEWKPTR)                             0299
         ST    @10,COUNTRP5(,DHEWKPTR)                             0299
*       END;                        /*                       @Y30LB54*/
*     ELSE;                         /* NO OVERFLOW           @ZA29820*/
@RF00257 DS    0H                                                  0302
*   END;                            /*                       @Y30LB54*/
         LA    @10,1                                               0302
         AL    @10,CTR(,DHEWKPTR)                                  0302
         ST    @10,CTR(,DHEWKPTR)                                  0302
         CH    @10,@CH00142                                        0302
         BNH   @DL00255                                            0302
*   END RPT5FILL;                   /*                       @Y30LB54*/
         B     @EL00005                                            0303
*                                                                  0304
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE ALL CORE WE RAN INTO PROBLEMS AND CANNOT CONTINUE        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*FREECORE:                                                         0304
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/
FREECORE ST    @14,@SA00006                                        0304
*   DO CTR1=1 TO 4 BY 1;            /*                       @Y30LB54*/
         LA    @10,1                                               0305
         ST    @10,CTR1(,DHEWKPTR)                                 0305
@DL00305 DS    0H                                                  0306
*     IF LIBPTR(CTR1)^=0 THEN       /* FREE ALL CORE ALREADY OBTAINED
*                                                            @Y30LB54*/
         L     @10,CTR1(,DHEWKPTR)                                 0306
         SLA   @10,2                                               0306
         L     @10,LIBPTR-5(@10,DHEWKPTR)                          0306
         LA    @10,0(,@10)                                         0306
         LTR   @10,@10                                             0306
         BZ    @RF00306                                            0306
*       DO;                         /*                       @Y30LB54*/
*         SPNO=0;                   /*                       @Y30LB54*/
         MVI   SPNO(CVTPTR),X'00'                                  0308
*         CORELEN=192+32+768;       /* FILL IN LENGTH OF AREA@Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00346+1                        0309
*         COREADDR=LIBPTR(CTR1);    /* FILL IN ADDRESS OF AREA     0310
*                                                            @Y30LB54*/
         ST    @10,COREADDR(,CVTPTR)                               0310
*         CALL ISDAFREE(WORKPTR);   /*                       @Y30LB54*/
         L     @10,@PC00001                                        0311
         ST    @10,@AL00001                                        0311
         L     @15,@CV00042                                        0311
         LA    @01,@AL00001                                        0311
         BALR  @14,@15                                             0311
*         LIBPTR(CTR1)=0;           /* DELETE GOTTEN CORE PTR@Y30LB54*/
         L     @10,CTR1(,DHEWKPTR)                                 0312
         SLA   @10,2                                               0312
         ALR   @10,DHEWKPTR                                        0312
         SLR   @04,@04                                             0312
         STCM  @04,7,LIBPTR-4(@10)                                 0312
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0314
*       ;                           /*                       @Y30LB54*/
@RF00306 DS    0H                                                  0315
*   END;                            /*                       @Y30LB54*/
         LA    @10,1                                               0315
         AL    @10,CTR1(,DHEWKPTR)                                 0315
         ST    @10,CTR1(,DHEWKPTR)                                 0315
         CH    @10,@CH00051                                        0315
         BNH   @DL00305                                            0315
*   CDHEDHU='00'X;                  /* DONT LET CONTROL COME TO US 0316
*                                      AGAIN                 @Y30LB54*/
         MVI   CDHEDHU(LPARMPTR),X'00'                             0316
*   RETCODE=4;                      /* TELL CONTROL WHY WE QUIT    0317
*                                                            @Y30LB54*/
         LA    RETCODE,4                                           0317
*   IF PTR5TOP^=0 THEN              /* DO WE HAVE DHE SPACE  @Y30LB54*/
         L     @10,PTR5TOP(,DHEWKPTR)                              0318
         LTR   @10,@10                                             0318
         BZ    @RF00318                                            0318
*     DO;                           /*                       @Y30LB54*/
*       SPNO=0;                     /*                       @Y30LB54*/
         MVI   SPNO(CVTPTR),X'00'                                  0320
*       CORELEN=50*36;              /*                       @Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00347+1                        0321
*       COREADDR=PTR5TOP;           /*                       @Y30LB54*/
         ST    @10,COREADDR(,CVTPTR)                               0322
*       CALL ISDAFREE(WORKPTR);     /*                       @Y30LB54*/
         L     @10,@PC00001                                        0323
         ST    @10,@AL00001                                        0323
         L     @15,@CV00042                                        0323
         LA    @01,@AL00001                                        0323
         BALR  @14,@15                                             0323
*       PTR5TOP=0;                  /*                       @Y30LB54*/
         SLR   @10,@10                                             0324
         ST    @10,PTR5TOP(,DHEWKPTR)                              0324
*       PTR5CUR=0;                  /*                       @Y30LB54*/
         ST    @10,PTR5CUR(,DHEWKPTR)                              0325
*       PTR5BOT=0;                  /*                       @Y30LB54*/
         ST    @10,PTR5BOT(,DHEWKPTR)                              0326
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0328
*     ;                             /*                       @Y30LB54*/
@RF00318 DS    0H                                                  0329
*   SPNO=0;                         /* FREE WORKING CORE ALSO@Y30LB54*/
         MVI   SPNO(CVTPTR),X'00'                                  0329
*   CORELEN=LENGTH(WORKCORE);       /* FILL IN LENGTH OF AREA@Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00344+1                        0330
*   COREADDR=DHE00PTR;              /* FILL IN LOCATION ADDRESS    0331
*                                                            @Y30LB54*/
         MVC   COREADDR(4,CVTPTR),DHE00PTR(CVTPTR)                 0331
*   CALL ISDAFREE(WORKPTR);         /*                       @Y30LB54*/
         L     @10,@PC00001                                        0332
         ST    @10,@AL00001                                        0332
         L     @15,@CV00042                                        0332
         LA    @01,@AL00001                                        0332
         BALR  @14,@15                                             0332
*   DHE00PTR=0;                     /* TELL THE WORLD WE QUIT@Y30LB54*/
         SLR   @10,@10                                             0333
         ST    @10,DHE00PTR(,CVTPTR)                               0333
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/
         LR    @15,RETCODE                                         0334
@EL00006 DS    0H                                                  0334
@EF00006 DS    0H                                                  0334
@ER00006 L     @14,@SA00006                                        0334
         BR    @14                                                 0334
*   END FREECORE;                   /*                       @Y30LB54*/
*   END ISDADHE0                    /*                       @Y30LB54*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDASOBR)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        *
*;                                                                 0336
@DATA    DS    0H
@CH00048 DC    H'1'
@CH00051 DC    H'4'
@CH00142 DC    H'6'
@CH00302 DC    H'7'
@CH00072 DC    H'8'
@CH00065 DC    H'12'
@CH00122 DC    H'24'
@CH00275 DC    H'36'
@CH00321 DC    H'99'
@CH00315 DC    H'192'
@CH00319 DC    H'248'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    1F
@SA00005 DS    1F
@SA00006 DS    0F
         DS    1F
@AL00001 DS    1A
@TF00001 DS    F
ISDADHE0 CSECT
         DS    0F
@CF00316 DC    F'32'
@CF00318 DC    F'100'
@CF00344 DC    F'336'
@CF00346 DC    F'992'
@CF00347 DC    F'1800'
@CF00348 DC    F'-4'
@CF00301 DC    XL4'0000000F'
@CF00303 DC    XL4'000000F0'
@CF00334 DC    XL4'FFFFFFFF'
@DATD    DSECT
         DS    0D
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDADHE0 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00039 DC    V(ISDAPRT0)
@CV00040 DC    V(ISDATYPE)
@CV00041 DC    V(ISDAGET1)
@CV00042 DC    V(ISDAFREE)
         DS    0D
@CC00336 DC    C'ISDADHE0 OVERFLOW RECORDS EXCEED LIMIT FIRST 50 PROCESC
               SED'
@CB00306 DC    X'0000'
TRPAT04  DC    X'040418190411121304041A1B0415161704041E1F04041C1D'
         DS    CL1
MASKTBL  DS    CL24
         ORG   MASKTBL
MSK      DC    XL4'00008000'
         DC    XL4'00800000'
         DC    XL4'00008000'
         DC    XL4'00800000'
         DC    XL4'00008000'
         DC    XL4'00008000'
         ORG   MASKTBL+24
PATCH    DC    50X'00'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RETCODE  EQU   @04
DHEWKPTR EQU   @03
SENSEPTR EQU   @06
LPARMPTR EQU   @05
CVTPTR   EQU   @02
R15      EQU   @15
R0       EQU   @00
R1       EQU   @01
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CDHEDHU  EQU   CREPORTS+3
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
DATAPTR  EQU   CVTPTRS0
SDATAPTR EQU   CVTPTRS0+4
PARMPTR  EQU   CVTPTRS0+8
DHE00PTR EQU   CVTPTRS0+52
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
ANSI     EQU   OUTLINE
LINE     EQU   OUTLINE+1
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
OBRMDR   EQU   0
SCW      EQU   OBRMDR
SWITCHES EQU   OBRMDR+6
DATETIME EQU   OBRMDR+12
DATE     EQU   DATETIME
TIME     EQU   DATETIME+4
CPUSERID EQU   OBRMDR+21
ISDAMSCS EQU   0
SUBSYSID EQU   ISDAMSCS+1
SSID     EQU   SUBSYSID
SUBSENSE EQU   ISDAMSCS+4
SUBSTAT4 EQU   SUBSENSE
SUBFMTMG EQU   SUBSENSE+7
INPUTCTR EQU   0
INCTR    EQU   INPUTCTR
RPT5RCD  EQU   0
WORKCORE EQU   0
LOGPTR   EQU   WORKCORE
LIBTAB   EQU   WORKCORE+4
LIBNO    EQU   LIBTAB
LIBPTR   EQU   LIBTAB+1
FULLWD1  EQU   WORKCORE+20
FULLWD2  EQU   WORKCORE+24
DATASSID EQU   WORKCORE+28
DATALIB  EQU   WORKCORE+32
KICKPTR  EQU   WORKCORE+36
PTRRPT   EQU   WORKCORE+40
PTRLIB   EQU   WORKCORE+44
PTRSSID  EQU   WORKCORE+48
PTRDATE  EQU   WORKCORE+52
PTRINP   EQU   WORKCORE+56
CTR      EQU   WORKCORE+60
CTR1     EQU   WORKCORE+64
CHAR4    EQU   WORKCORE+68
COUNTRP4 EQU   WORKCORE+72
COUNTR4A EQU   WORKCORE+76
COUNTRP5 EQU   WORKCORE+80
DATETBL  EQU   WORKCORE+84
DATEYYDD EQU   DATETBL
DATEOFST EQU   DATETBL+4
PTR5TOP  EQU   WORKCORE+124
PTR5CUR  EQU   WORKCORE+128
PTR5BOT  EQU   WORKCORE+132
RATIOTBL EQU   WORKCORE+152
DATA04   EQU   WORKCORE+248
DATA05   EQU   WORKCORE+272
SORTSW   EQU   WORKCORE+309
COUNTER  EQU   0
WORKPTR  EQU   0
BYTESSID EQU   DATASSID+3
*                                      START UNREFERENCED COMPONENTS
COUNT    EQU   COUNTER
ENDAREA  EQU   WORKCORE+335
CHAR5    EQU   WORKCORE+330
EDREC1   EQU   WORKCORE+321
EDREC    EQU   WORKCORE+311
FOURBITS EQU   WORKCORE+310
DATAWORK EQU   WORKCORE+308
RATCODE  EQU   RATIOTBL+3
RATSSID  EQU   RATIOTBL+2
RATCNT   EQU   RATIOTBL
RATCTR   EQU   WORKCORE+148
GRANDE   EQU   WORKCORE+144
GRANDU   EQU   WORKCORE+140
LIBCTR   EQU   WORKCORE+136
@NM00012 EQU   RPT5RCD+32
@NM00011 EQU   RPT5RCD+28
@NM00010 EQU   RPT5RCD+24
@NM00009 EQU   RPT5RCD+20
@NM00008 EQU   RPT5RCD+16
RPT5CTRS EQU   RPT5RCD+12
@NM00007 EQU   RPT5RCD+10
RPT5SSID EQU   RPT5RCD+9
RPT5DATE EQU   RPT5RCD+1
RPT5LIB  EQU   RPT5RCD
SANOMSCD EQU   SUBSENSE+27
RCYLMSCD EQU   SUBSENSE+25
RUAMSCD  EQU   SUBSENSE+24
MSCFSC   EQU   SUBSENSE+22
@NM00006 EQU   SUBSENSE+21
RUADASD  EQU   SUBSENSE+20
DASDFSC  EQU   SUBSENSE+18
@NM00005 EQU   SUBSENSE+8
MSGCODEN EQU   SUBFMTMG
SUBFMTNO EQU   SUBFMTMG
SALOWAD2 EQU   SUBSENSE+6
SARETRY  EQU   SUBSENSE+5
@NM00004 EQU   SUBSENSE+4
DASDFMTN EQU   SUBSENSE+3
SALOWADD EQU   SUBSENSE+2
SUBSTAT5 EQU   SUBSENSE+1
FORMATNO EQU   ISDAMSCS+3
SSIDDEVT EQU   SSID+1
SSIDLIBN EQU   SSID+1
SSIDTYPE EQU   SSID
SSIDFLAG EQU   SUBSYSID
STATUS   EQU   ISDAMSCS
CPUID    EQU   CPUSERID+3
CPUSER   EQU   CPUSERID
VERNO    EQU   OBRMDR+20
TENSHUND EQU   TIME+3
SECOND   EQU   TIME+2
MINUTE   EQU   TIME+1
HOUR     EQU   TIME
DAY      EQU   DATE+2
YEAR     EQU   DATE
RECENTRY EQU   OBRMDR+11
RCDCNT   EQU   OBRMDR+10
SWITCH3  EQU   SWITCHES+3
SWITCH2  EQU   SWITCHES+2
SWITCH1  EQU   SWITCHES+1
SWITCH0  EQU   SWITCHES
SYSREL   EQU   OBRMDR+5
CLASRC   EQU   OBRMDR+4
@NM00003 EQU   SCW+3
SCODE    EQU   SCW+2
SLENGTH  EQU   SCW
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
WORKCALL EQU   CVTPTRS0+96
GEN00PTR EQU   CVTPTRS0+92
CNFG0PTR EQU   CVTPTRS0+88
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDA00PTR EQU   CVTPTRS0+12
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CSUM     EQU   CREPORTS+2
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
*                                      END UNREFERENCED COMPONENTS
@RF00108 EQU   @RC00101
@RF00116 EQU   @RC00113
@RC00127 EQU   @RC00125
@RC00267 EQU   @RC00259
@RC00135 EQU   @RC00127
@ENDDATA EQU   *
         END   ISDADHE0,(C'PLS1754',0701,78044)

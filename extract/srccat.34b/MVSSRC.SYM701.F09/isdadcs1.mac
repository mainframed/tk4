         TITLE 'ISDADCS1 - DATA CARTRIDGE STATISTICS REPORTING         *
                        '
ISDADCS1 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(8)                                           01S0001
         DC    C'ISDADCS1'                                      01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @10,0                                            01S0001
@PSTART  LA    @11,4095(,@10)                                   01S0001
         USING @PSTART,@10                                      01S0001
         USING @PSTART+4095,@11                                 01S0001
         L     @00,@SIZDATD                                     01S0001
         ISDAGSPC R,LV=(0)
         LR    @12,@01                                          01S0001
         USING @DATD,@12                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @00,@01,20(@13)                                  01S0001
         ST    @12,8(,@13)                                      01S0001
         LR    @13,@12                                          01S0001
         MVC   @PC00001(4),0(@01)                               01S0001
*                                                               01S0035
*/*  %WORKAREL='LENGTH(WORKAREA)'                            @Y30LB56*/
*                                                               01S0036
*   CVTPTR=WORKPTR;                 /* SAVE POINTER TO CVT	  @Y30LB56*/
         L     @09,@PC00001                                     01S0036
         L     CVTPTR,WORKPTR(,@09)                             01S0036
*   RETCODE=0;                      /* INITIALIZE RETURN CODE@Y30LB56*/
         SLR   @09,@09                                          01S0037
         STH   @09,RETCODE                                      01S0037
*   GET0PTR=GET0PSV;                /* RESTORE CURRENT WORKAREA PTR
*                                                            @Y30LB56*/
         L     @04,DCS00PTR(,CVTPTR)                            01S0038
         L     GET0PTR,GET0PSV(,@04)                            01S0038
*   GET0INDX=DCS00PTR->STARTPTR;    /* POINT TO FIRST DCS ENTRY 01S0039
*                                                            @Y30LB56*/
         L     GET0INDX,STARTPTR(,@04)                          01S0039
*   GET0NEXT=GET0XSV;               /* RESTORE CURRENT WORKAREA INDEX
*                                                            @Y30LB56*/
         L     @09,GET0XSV(,@04)                                01S0040
         ST    @09,GET0NEXT                                     01S0040
*   LPARMPTR=PARMPTR;               /* SET POINTER TO SDA PARMS 01S0041
*                                                            @Y30LB56*/
         L     LPARMPTR,PARMPTR(,CVTPTR)                        01S0041
*                                                               02S0042
*   /*****************************************************************/
*   /*                                                               */
*   /* INSURE THAT SPACE IS AVAILABLE IN WORKAREA FOR SSID/RATIOS,   */
*   /* WORK SPACE, AND AT LEAST ONE TOTALS ACCUMULATOR.              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0042
*       IF GET0LEN<((GET0NEXT+LENGTH(SSIDX)+LENGTH(WORKAREA)+LENGTH(TOT
*LS))-GET0PTR) THEN                                             02S0042
         AH    @09,@CH00568                                     02S0042
         SLR   @09,GET0PTR                                      02S0042
         SLR   @04,@04                                          02S0042
         ICM   @04,7,GET0LEN(GET0PTR)                           02S0042
         CR    @09,@04                                          02S0042
         BNH   @RF00042                                         02S0042
*     CALL GETMORE;                 /* ASK FOR ANOTHER WORKAREA 02S0043
*                                                            @Y30LB56*/
         BAL   @14,GETMORE                                      02S0043
*   ELSE                                                        02S0044
*     ;                             /* ENOUGH WORKAREA STILL AVAIL
*                                                            @Y30LB56*/
@RF00042 DS    0H                                               02S0045
*   IF RETCODE=0 THEN               /* BUILD ACCUMULATOR     @Y30LB56*/
         ICM   @09,3,RETCODE                                    02S0045
         BNZ   @RF00045                                         02S0045
*     DO;                                                  /*@Y30LB56*/
*       TOTX1=GET0NEXT;             /* POINT TO START OF WORKAREA
*                                                            @Y30LB56*/
         L     TOTX1,GET0NEXT                                   02S0047
*       SSIDX=SSIDX&&SSIDX;         /* CLEAR SSID RATIO LOOKUP TBL
*                                                            @Y30LB56*/
         XC    SSIDX(64,TOTX1),SSIDX(TOTX1)                     02S0048
*           TOTSTART=TOTX1+LENGTH(SSIDX)+LENGTH(WORKAREA);/*    02S0049
*                                                     START  @Y30LB56*/
         LA    @09,96                                           02S0049
         ALR   @09,TOTX1                                        02S0049
         ST    @09,TOTSTART(,TOTX1)                             02S0049
*       GET0NEXT=TOTSTART;          /* POINT TO NEXT SLOT IN WORKAREA
*                                                            @Y30LB56*/
         ST    @09,GET0NEXT                                     02S0050
*       TOTSW='00'X;                /* SET FIRST PASS SWITCH @Y30LB56*/
         MVI   TOTSW(TOTX1),X'00'                               02S0051
*       DO WHILE(GET0INDX^=0&RETCODE=0);                   /*@Y30LB56*/
         B     @DE00052                                         02S0052
@DL00052 DS    0H                                               02S0053
*         TOTX2=TOTSTART;           /* RESET PTR TO FIRST ACCUMULATOR
*                                                            @Y30LB56*/
*                                                               02S0053
         L     TOTX2,TOTSTART(,TOTX1)                           02S0053
*         /***********************************************************/
*         /*                                                         */
*         /* SAVE HIGHEST ERROR/USAGE=RATIO FOR THIS SSID            */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0054
*         IF SNSSID(1:4)='0010'B THEN/* THIS IS A DRD SSID   @Y30LB56*/
         TM    SNSSID(GET0INDX),B'00000010'                     02S0054
         BNO   @RF00054                                         02S0054
         TM    SNSSID(GET0INDX),B'00001101'                     02S0054
         BNZ   @RF00054                                         02S0054
*           DO;                                            /*@Y30LB56*/
*             WORKVAR=SNSSID(5:12); /* BUILD TABLE LOOKUP INDEX 02S0056
*                                                            @Y30LB56*/
         SLR   WORKVAR,WORKVAR                                  02S0056
         IC    WORKVAR,SNSSID+1(,GET0INDX)                      02S0056
*             WORKVAR=WORKVAR+1;    /* ADD 1 FOR SSID 00     @ZM31053*/
         AH    WORKVAR,@CH00084                                 02S0057
*             IF SNSRDRAT>SSIDR(WORKVAR) THEN/* SAVE IT      @Y30LB56*/
         SLR   @09,@09                                          02S0058
         IC    @09,SNSRDRAT(,GET0INDX)                          02S0058
         LR    @07,TOTX1                                        02S0058
         AL    @07,@CF00573                                     02S0058
         SLR   @15,@15                                          02S0058
         IC    @15,SSIDR(WORKVAR,@07)                           02S0058
         CR    @09,@15                                          02S0058
         BNH   @RF00058                                         02S0058
*               SSIDR(WORKVAR)=SNSRDRAT;                   /*@Y30LB56*/
         LR    @07,TOTX1                                        02S0059
         AL    @07,@CF00573                                     02S0059
         STC   @09,SSIDR(WORKVAR,@07)                           02S0059
*             ELSE                                              02S0060
*               ;                   /* KEEP THE PRESENT RATIO@Y30LB56*/
@RF00058 DS    0H                                               02S0061
*             IF SNSWRAT>SSIDR(WORKVAR) THEN/* SAVE IT       @Y30LB56*/
         SLR   @09,@09                                          02S0061
         IC    @09,SNSWRAT(,GET0INDX)                           02S0061
         LR    @07,TOTX1                                        02S0061
         AL    @07,@CF00573                                     02S0061
         SLR   @15,@15                                          02S0061
         IC    @15,SSIDR(WORKVAR,@07)                           02S0061
         CR    @09,@15                                          02S0061
         BNH   @RF00061                                         02S0061
*               SSIDR(WORKVAR)=SNSWRAT;                    /*@Y30LB56*/
         LR    @07,TOTX1                                        02S0062
         AL    @07,@CF00573                                     02S0062
         STC   @09,SSIDR(WORKVAR,@07)                           02S0062
*             ELSE                                              02S0063
*               ;                   /* KEEP THE PRESENT RATIO@Y30LB56*/
@RF00061 DS    0H                                               02S0064
*           END;                                           /*@Y30LB56*/
*         ELSE                                                  02S0065
*           ;                       /* SSID IS NOT FOR A DRD @Y30LB56*/
*                                                               02S0065
@RF00054 DS    0H                                               02S0066
*         /***********************************************************/
*         /*                                                         */
*         /* BUILD CSN TOTALS ACCUMULATOR                            */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0066
*         IF TOTSW='00'X THEN       /* BUILD FIRST ACCUMULATOR  02S0066
*                                                            @Y30LB56*/
         CLI   TOTSW(TOTX1),X'00'                               02S0066
         BNE   @RF00066                                         02S0066
*           DO;                                            /*@Y30LB56*/
*             TOTSW='10'X;          /* INDICATE FIRST ACCUM BUILT
*                                                            @Y30LB56*/
         MVI   TOTSW(TOTX1),X'10'                               02S0068
*                                                               03S0069
*   /*****************************************************************/
*   /*                                                               */
*   /* COPY NEW DCS ENTRY INTO AN ACCUMULATOR                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0069
*   TOTCHAIN=0;                     /* ZERO CHAIN POINTER    @Y30LB56*/
         SLR   @09,@09                                          03S0069
         ST    @09,TOTCHAIN(,TOTX2)                             03S0069
*   DCSN=SNSCSN;                    /* COPY DATA CARTRIDGE SERIAL NO.
*                                                            @Y30LB56*/
         MVC   DCSN(12,TOTX2),SNSCSN(GET0INDX)                  03S0070
*   OLDEST=GET0INDX;                /* SET PTR TO OLDEXT ENTR /CART
*                                                            @Y30LB56*/
         ST    GET0INDX,OLDEST(,TOTX2)                          03S0071
*   NEWEST=GET0INDX;                /* SET PTR TO NEWEST ENTRY/CART
*                                                            @Y30LB56*/
         ST    GET0INDX,NEWEST(,TOTX2)                          03S0072
*   TOTRDUC=SNSRDUC;                /* SET READ USAGE ACCUMULATOR
*                                                            @Y30LB56*/
         SLR   @09,@09                                          03S0073
         ICM   @09,3,SNSRDUC(GET0INDX)                          03S0073
         ST    @09,TOTRDUC(,TOTX2)                              03S0073
*   TOTRDCK=SNSRDCK;                /* SET READ CHECK ACCUMULATOR
*                                                            @Y30LB56*/
         SLR   @09,@09                                          03S0074
         ICM   @09,3,SNSRDCK(GET0INDX)                          03S0074
         ST    @09,TOTRDCK(,TOTX2)                              03S0074
*   TOTWRUC=SNSWRUC;                /* SET WRITE USAGE ACCUMULATOR
*                                                            @Y30LB56*/
         SLR   @09,@09                                          03S0075
         ICM   @09,3,SNSWRUC(GET0INDX)                          03S0075
         ST    @09,TOTWRUC(,TOTX2)                              03S0075
*   TOTWRCK=SNSWRCK;                /* SET WRITE CHECK ACCUMULATOR
*                                                            @Y30LB56*/
         SLR   @09,@09                                          03S0076
         ICM   @09,3,SNSWRCK(GET0INDX)                          03S0076
         ST    @09,TOTWRCK(,TOTX2)                              03S0076
*   TOTNUM='01'X;                   /* SET NUMBER OF DCS ENTRIES
*                                                            @Y30LB56*/
         MVI   TOTNUM(TOTX2),X'01'                              03S0077
*   GET0NEXT=GET0NEXT+LENGTH(TOTALS);/*                         03S0078
*                                      ADVANCE TO NEXT ACCUM @Y30LB56*/
         LA    @09,52                                           03S0078
         AL    @09,GET0NEXT                                     03S0078
         ST    @09,GET0NEXT                                     03S0078
*           END;                                           /*@Y30LB56*/
*         ELSE                      /* LOCATE ACCUMULATOR TO MATCH
*                                      DCS                   @Y30LB56*/
*           DO;                                            /*@Y30LB56*/
         B     @RC00066                                         02S0080
@RF00066 DS    0H                                               02S0081
*             SORTX=TOTX2;          /* SAVE FOR CHAINING     @Y30LB56*/
         LR    SORTX,TOTX2                                      02S0081
*             DO WHILE(TOTX2^=0&SNSCSN^=DCSN);/* LOOK FOR CSN MATCH
*                                                            @Y30LB56*/
         B     @DE00082                                         02S0082
@DL00082 DS    0H                                               02S0083
*               SORTX=TOTX2;        /* SAVE TOTX2 FOR CHAINING  02S0083
*                                                            @Y30LB56*/
         LR    SORTX,TOTX2                                      02S0083
*               TOTX2=TOTCHAIN;     /* GET POINTER TO NEXT ACCUM
*                                                            @Y30LB56*/
         L     TOTX2,TOTCHAIN(,TOTX2)                           02S0084
*             END;                                         /*@Y30LB56*/
@DE00082 LTR   TOTX2,TOTX2                                      02S0085
         BZ    @DC00082                                         02S0085
         CLC   SNSCSN(12,GET0INDX),DCSN(TOTX2)                  02S0085
         BNE   @DL00082                                         02S0085
@DC00082 DS    0H                                               02S0086
*             IF TOTX2^=0 THEN      /* DCS ENTRY MATCHES ACCUMULATOR
*                                                            @Y30LB56*/
         LTR   TOTX2,TOTX2                                      02S0086
         BZ    @RF00086                                         02S0086
*               DO;                                        /*@Y30LB56*/
*                 NEWEST=GET0INDX;  /* SET PTR TO NEWEST ENTRY/CART
*                                                            @Y30LB56*/
         ST    GET0INDX,NEWEST(,TOTX2)                          02S0088
*                 I=1073700000;     /* SET COUNTER LIMIT     @Y30LB56*/
         L     I,@CF00508                                       02S0089
*                 IF TOTRDUC<I&TOTRDCK<I&TOTWRUC<I&TOTWRCK<I THEN
         L     @09,TOTRDUC(,TOTX2)                              02S0090
         CLR   @09,I                                            02S0090
         BNL   @RF00090                                         02S0090
         L     @06,TOTRDCK(,TOTX2)                              02S0090
         CLR   @06,I                                            02S0090
         BNL   @RF00090                                         02S0090
         L     @15,TOTWRUC(,TOTX2)                              02S0090
         CLR   @15,I                                            02S0090
         BNL   @RF00090                                         02S0090
         L     @14,TOTWRCK(,TOTX2)                              02S0090
         CLR   @14,I                                            02S0090
         BNL   @RF00090                                         02S0090
*                   DO;                                    /*@Y30LB56*/
*                     TOTRDUC=TOTRDUC+SNSRDUC;/* ACCUMULATE READ
*                                      USAGE                 @Y30LB56*/
         SLR   @07,@07                                          02S0092
         ICM   @07,3,SNSRDUC(GET0INDX)                          02S0092
         ALR   @09,@07                                          02S0092
         ST    @09,TOTRDUC(,TOTX2)                              02S0092
*                     TOTRDCK=TOTRDCK+SNSRDCK;/* ACCUMULATE READ
*                                      CHECKS                @Y30LB56*/
         SLR   @09,@09                                          02S0093
         ICM   @09,3,SNSRDCK(GET0INDX)                          02S0093
         ALR   @06,@09                                          02S0093
         ST    @06,TOTRDCK(,TOTX2)                              02S0093
*                     TOTWRUC=TOTWRUC+SNSWRUC;/* ACCUMULATE WRITE
*                                      USAGE                 @Y30LB56*/
         SLR   @09,@09                                          02S0094
         ICM   @09,3,SNSWRUC(GET0INDX)                          02S0094
         ALR   @15,@09                                          02S0094
         ST    @15,TOTWRUC(,TOTX2)                              02S0094
*                     TOTWRCK=TOTWRCK+SNSWRCK;/* ACCUMULATE WRITE CKS
*                                                            @Y30LB56*/
         SLR   @09,@09                                          02S0095
         ICM   @09,3,SNSWRCK(GET0INDX)                          02S0095
         ALR   @14,@09                                          02S0095
         ST    @14,TOTWRCK(,TOTX2)                              02S0095
*                   END;                                   /*@Y30LB56*/
*                 ELSE                                          02S0097
*                   ;               /* PRESERVE RATIOS - BYPASS 02S0097
*                                      ACCUMULATION          @Y30LB56*/
@RF00090 DS    0H                                               02S0098
*                 IF TOTNUM>0&TOTNUM<255 THEN                   02S0098
         CLI   TOTNUM(TOTX2),0                                  02S0098
         BNH   @RF00098                                         02S0098
         CLI   TOTNUM(TOTX2),255                                02S0098
         BNL   @RF00098                                         02S0098
*                   TOTNUM=TOTNUM+1;/* ADVANCE CSN COUNTER   @Y30LB56*/
         LA    @09,1                                            02S0099
         SLR   @15,@15                                          02S0099
         IC    @15,TOTNUM(,TOTX2)                               02S0099
         ALR   @09,@15                                          02S0099
         STC   @09,TOTNUM(,TOTX2)                               02S0099
*                 ELSE                                          02S0100
*                   TOTNUM='00'X;   /* INDICATE MORE THAT 255@Y30LB56*/
         B     @RC00098                                         02S0100
@RF00098 MVI   TOTNUM(TOTX2),X'00'                              02S0100
*               END;                                       /*@Y30LB56*/
*             ELSE                  /* DCS CSN NOT YET IN ACCUMULATOR
*                                                            @Y30LB56*/
*               DO;                                        /*@Y30LB56*/
         B     @RC00086                                         02S0102
@RF00086 DS    0H                                               02S0103
*                 IF GET0LEN<((GET0NEXT+LENGTH(TOTALS))-GET0PTR) THEN
         LA    @09,52                                           02S0103
         AL    @09,GET0NEXT                                     02S0103
         SLR   @09,GET0PTR                                      02S0103
         SLR   @07,@07                                          02S0103
         ICM   @07,7,GET0LEN(GET0PTR)                           02S0103
         CR    @09,@07                                          02S0103
         BNH   @RF00103                                         02S0103
*                   CALL GETMORE;   /* ASK FOR MORE WORKAREA @Y30LB56*/
         BAL   @14,GETMORE                                      02S0104
*                 ELSE                                          02S0105
*                   ;               /* ENOUGH WORKAREA STILL @Y30LB56
*                                      AVAILABLE             @Y30LB56*/
@RF00103 DS    0H                                               02S0106
*                 IF RETCODE=0 THEN /* BUILD ACCUMULATORS    @Y30LB56*/
         SLR   @09,@09                                          02S0106
         CH    @09,RETCODE                                      02S0106
         BNE   @RF00106                                         02S0106
*                   DO;                                    /*@Y30LB56*/
*                     SORTX->TOTCHAIN=GET0NEXT;/* CHAIN TO NEW ACCUM
*                                                            @Y30LB56*/
         L     @07,GET0NEXT                                     02S0108
         ST    @07,TOTCHAIN(,SORTX)                             02S0108
*                     TOTX2=GET0NEXT;/* INDEX NEXT ACCUMULATOR SLOT
*                                                            @Y30LB56*/
         LR    TOTX2,@07                                        02S0109
*                                                               03S0110
*   /*****************************************************************/
*   /*                                                               */
*   /* COPY NEW DCS ENTRY INTO AN ACCUMULATOR                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0110
*   TOTCHAIN=0;                     /* ZERO CHAIN POINTER    @Y30LB56*/
         ST    @09,TOTCHAIN(,TOTX2)                             03S0110
*   DCSN=SNSCSN;                    /* COPY DATA CARTRIDGE SERIAL NO.
*                                                            @Y30LB56*/
         MVC   DCSN(12,TOTX2),SNSCSN(GET0INDX)                  03S0111
*   OLDEST=GET0INDX;                /* SET PTR TO OLDEXT ENTR /CART
*                                                            @Y30LB56*/
         ST    GET0INDX,OLDEST(,TOTX2)                          03S0112
*   NEWEST=GET0INDX;                /* SET PTR TO NEWEST ENTRY/CART
*                                                            @Y30LB56*/
         ST    GET0INDX,NEWEST(,TOTX2)                          03S0113
*   TOTRDUC=SNSRDUC;                /* SET READ USAGE ACCUMULATOR
*                                                            @Y30LB56*/
         SLR   @09,@09                                          03S0114
         ICM   @09,3,SNSRDUC(GET0INDX)                          03S0114
         ST    @09,TOTRDUC(,TOTX2)                              03S0114
*   TOTRDCK=SNSRDCK;                /* SET READ CHECK ACCUMULATOR
*                                                            @Y30LB56*/
         SLR   @09,@09                                          03S0115
         ICM   @09,3,SNSRDCK(GET0INDX)                          03S0115
         ST    @09,TOTRDCK(,TOTX2)                              03S0115
*   TOTWRUC=SNSWRUC;                /* SET WRITE USAGE ACCUMULATOR
*                                                            @Y30LB56*/
         SLR   @09,@09                                          03S0116
         ICM   @09,3,SNSWRUC(GET0INDX)                          03S0116
         ST    @09,TOTWRUC(,TOTX2)                              03S0116
*   TOTWRCK=SNSWRCK;                /* SET WRITE CHECK ACCUMULATOR
*                                                            @Y30LB56*/
         SLR   @09,@09                                          03S0117
         ICM   @09,3,SNSWRCK(GET0INDX)                          03S0117
         ST    @09,TOTWRCK(,TOTX2)                              03S0117
*   TOTNUM='01'X;                   /* SET NUMBER OF DCS ENTRIES
*                                                            @Y30LB56*/
         MVI   TOTNUM(TOTX2),X'01'                              03S0118
*   GET0NEXT=GET0NEXT+LENGTH(TOTALS);/*                         03S0119
*                                      ADVANCE TO NEXT ACCUM @Y30LB56*/
         AH    @07,@CH00462                                     03S0119
         ST    @07,GET0NEXT                                     03S0119
*                   END;                                   /*@Y30LB56*/
*                 ELSE                                          02S0121
*                   ;                                      /*@Y30LB56*/
@RF00106 DS    0H                                               02S0122
*               END;                                       /*@Y30LB56*/
*           END;                                           /*@Y30LB56*/
@RC00086 DS    0H                                               02S0124
*         GET0INDX=CHAINPTR;        /* PROCESS NEXT DCS ENTRY@Y30LB56*/
@RC00066 L     GET0INDX,CHAINPTR(,GET0INDX)                     02S0124
*       END;                                               /*@Y30LB56*/
@DE00052 SLR   @09,@09                                          02S0125
         CR    GET0INDX,@09                                     02S0125
         BE    @DC00052                                         02S0125
         CH    @09,RETCODE                                      02S0125
         BE    @DL00052                                         02S0125
@DC00052 DS    0H                                               02S0126
*       IF RETCODE=0 THEN           /* WORKAREA IS STILL AVAILABLE
*                                                            @Y30LB56*/
         ICM   @15,3,RETCODE                                    02S0126
         BNZ   @RF00126                                         02S0126
*         DO;                                              /*@Y30LB56*/
*                                                               03S0128
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE USAGE AND ERROR TOTALS                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0128
*   TOTX2=TOTSTART;                 /* RESET PTR TO FIRST ACCUMULATOR
*                                                            @Y30LB56*/
         L     TOTX2,TOTSTART(,TOTX1)                           03S0128
*   DO WHILE(TOTX2^=0);             /* DO UNTIL TOTX2=0      @Y30LB56*/
         B     @DE00129                                         03S0129
@DL00129 DS    0H                                               03S0130
*     TOTALUSE=TOTRDUC+TOTWRUC;     /* TOTAL USAGE           @Y30LB56*/
         L     @05,TOTRDUC(,TOTX2)                              03S0130
         LR    @15,@05                                          03S0130
         AL    @15,TOTWRUC(,TOTX2)                              03S0130
         ST    @15,TOTALUSE(,TOTX2)                             03S0130
*     TOTALERR=TOTRDCK+TOTWRCK;     /* TOTAL ERRORS          @Y30LB56*/
         L     @15,TOTRDCK(,TOTX2)                              03S0131
         LR    @14,@15                                          03S0131
         AL    @14,TOTWRCK(,TOTX2)                              03S0131
         ST    @14,TOTALERR(,TOTX2)                             03S0131
*     IF TOTRDUC<TOTRDCK THEN       /* RATIO > .99           @Y30LB56*/
         CLR   @05,@15                                          03S0132
         BNL   @RF00132                                         03S0132
*       RDRATIO='FF'X;                                     /*@Y30LB56*/
         MVI   RDRATIO(TOTX2),X'FF'                             03S0133
*     ELSE                                                      03S0134
*       DO;                                                /*@Y30LB56*/
         B     @RC00132                                         03S0134
@RF00132 DS    0H                                               03S0135
*         IF TOTRDUC=0 THEN         /* NO RATIO              @Y30LB56*/
         ICM   @05,15,TOTRDUC(TOTX2)                            03S0135
         BNZ   @RF00135                                         03S0135
*           RDRATIO=0;                                     /*@Y30LB56*/
         MVI   RDRATIO(TOTX2),X'00'                             03S0136
*         ELSE                      /* CALCULATE RATIO       @Y30LB56*/
*           RDRATIO=(TOTRDCK*100)/TOTRDUC;/* READ RATIO      @Y30LB56*/
         B     @RC00135                                         03S0137
@RF00135 L     @05,TOTRDCK(,TOTX2)                              03S0137
         MH    @05,@CH00511                                     03S0137
         LR    @01,@05                                          03S0137
         SLR   @00,@00                                          03S0137
         D     @00,TOTRDUC(,TOTX2)                              03S0137
         STC   @01,RDRATIO(,TOTX2)                              03S0137
*       END;                                               /*@Y30LB56*/
@RC00135 DS    0H                                               03S0139
*     IF TOTWRUC<TOTWRCK THEN       /* RATIO > .99           @Y30LB56*/
@RC00132 CLC   TOTWRUC(4,TOTX2),TOTWRCK(TOTX2)                  03S0139
         BNL   @RF00139                                         03S0139
*       WRATIO='FF'X;                                      /*@Y30LB56*/
         MVI   WRATIO(TOTX2),X'FF'                              03S0140
*     ELSE                                                      03S0141
*       DO;                                                /*@Y30LB56*/
         B     @RC00139                                         03S0141
@RF00139 DS    0H                                               03S0142
*         IF TOTWRUC=0 THEN         /* NO RATIO              @Y30LB56*/
         ICM   @05,15,TOTWRUC(TOTX2)                            03S0142
         BNZ   @RF00142                                         03S0142
*           WRATIO=0;                                      /*@Y30LB56*/
         MVI   WRATIO(TOTX2),X'00'                              03S0143
*         ELSE                      /* CALCULATE RATIO       @Y30LB56*/
*           WRATIO=(TOTWRCK*100)/TOTWRUC;/* WRITE RATIO      @Y30LB56*/
         B     @RC00142                                         03S0144
@RF00142 L     @05,TOTWRCK(,TOTX2)                              03S0144
         MH    @05,@CH00511                                     03S0144
         LR    @01,@05                                          03S0144
         SLR   @00,@00                                          03S0144
         D     @00,TOTWRUC(,TOTX2)                              03S0144
         STC   @01,WRATIO(,TOTX2)                               03S0144
*       END;                                               /*@Y30LB56*/
@RC00142 DS    0H                                               03S0146
*     IF TOTALUSE<TOTALERR THEN     /* RATIO > .99           @Y30LB56*/
@RC00139 CLC   TOTALUSE(4,TOTX2),TOTALERR(TOTX2)                03S0146
         BNL   @RF00146                                         03S0146
*       TOTRATIO='FF'X;                                    /*@Y30LB56*/
         MVI   TOTRATIO(TOTX2),X'FF'                            03S0147
*     ELSE                                                      03S0148
*       DO;                                                /*@Y30LB56*/
         B     @RC00146                                         03S0148
@RF00146 DS    0H                                               03S0149
*         IF TOTALUSE=0 THEN        /* NO RATIO              @Y30LB56*/
         ICM   @05,15,TOTALUSE(TOTX2)                           03S0149
         BNZ   @RF00149                                         03S0149
*           TOTRATIO=0;                                    /*@Y30LB56*/
         MVI   TOTRATIO(TOTX2),X'00'                            03S0150
*         ELSE                      /* CALCULATE RATIO       @Y30LB56*/
*           TOTRATIO=(TOTALERR*100)/TOTALUSE;/* TOTAL RATIO  @Y30LB56*/
         B     @RC00149                                         03S0151
@RF00149 L     @05,TOTALERR(,TOTX2)                             03S0151
         MH    @05,@CH00511                                     03S0151
         LR    @01,@05                                          03S0151
         SLR   @00,@00                                          03S0151
         D     @00,TOTALUSE(,TOTX2)                             03S0151
         STC   @01,TOTRATIO(,TOTX2)                             03S0151
*       END;                                               /*@Y30LB56*/
@RC00149 DS    0H                                               03S0153
*     TOTX2=TOTCHAIN;               /* POINT TO NEXT ACCUMULATOR
*                                                            @Y30LB56*/
@RC00146 L     TOTX2,TOTCHAIN(,TOTX2)                           03S0153
*   END;                                                   /*@Y30LB56*/
*                                                               03S0154
@DE00129 LTR   TOTX2,TOTX2                                      03S0154
         BNZ   @DL00129                                         03S0154
*   /*****************************************************************/
*   /*                                                               */
*   /* SORT TOTAL ACCUMULATORS IN HIGHEST 'ERROR/USAGE=RATIO' FIRST  */
*   /* SEQUENCE                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0155
*   TOTSW='00'X;                    /* INDICATE SORT REQUIRED@Y30LB56*/
         MVI   TOTSW(TOTX1),X'00'                               03S0155
*   DO WHILE(TOTSW='00'X);                                 /*@Y30LB56*/
         B     @DE00156                                         03S0156
@DL00156 DS    0H                                               03S0157
*     WORKX1=ADDR(TOTSTART);                               /*@Y30LB56*/
         LA    WORKX1,TOTSTART(,TOTX1)                          03S0157
*     TOTX2=TOTSTART;                                      /*@Y30LB56*/
         L     TOTX2,TOTSTART(,TOTX1)                           03S0158
*     WORKX2=TOTX2;                                        /*@Y30LB56*/
         LR    WORKX2,TOTX2                                     03S0159
*     TOTX2=TOTCHAIN;                                      /*@Y30LB56*/
         L     TOTX2,TOTCHAIN(,TOTX2)                           03S0160
*     DO WHILE(TOTX2^=0);                                  /*@Y30LB56*/
         B     @DE00161                                         03S0161
@DL00161 DS    0H                                               03S0162
*       IF WORKX2->TOTRATIO<TOTRATIO THEN/* SORT TOTCHAIN    @Y30LB56*/
         CLC   TOTRATIO(1,WORKX2),TOTRATIO(TOTX2)               03S0162
         BNL   @RF00162                                         03S0162
*         DO;                                              /*@Y30LB56*/
*           TOTSW='01'X;            /* REMEMBER SORT REQUIRED@Y30LB56*/
         MVI   TOTSW(TOTX1),X'01'                               03S0164
*           WORKX1->TOTCHAIN=WORKX2->TOTCHAIN;/* UPDATE TOTCHAIN
*                                                            @Y30LB56*/
         MVC   TOTCHAIN(4,WORKX1),TOTCHAIN(WORKX2)              03S0165
*           WORKX2->TOTCHAIN=TOTCHAIN;                     /*@Y30LB56*/
         L     @06,TOTCHAIN(,TOTX2)                             03S0166
         ST    @06,TOTCHAIN(,WORKX2)                            03S0166
*           TOTCHAIN=WORKX2;                               /*@Y30LB56*/
         ST    WORKX2,TOTCHAIN(,TOTX2)                          03S0167
*           WORKX1=TOTX2;           /* ADVANCE POINTERS      @Y30LB56*/
         LR    WORKX1,TOTX2                                     03S0168
*           TOTX2=WORKX2->TOTCHAIN;                        /*@Y30LB56*/
         LR    TOTX2,@06                                        03S0169
*         END;                                             /*@Y30LB56*/
*       ELSE                        /* ENTRIES IN SEQUENCE   @Y30LB56*/
*         DO;                                              /*@Y30LB56*/
         B     @RC00162                                         03S0171
@RF00162 DS    0H                                               03S0172
*           WORKX1=WORKX2;          /* ADVANCE POINTERS      @Y30LB56*/
         LR    WORKX1,WORKX2                                    03S0172
*           WORKX2=TOTX2;                                  /*@Y30LB56*/
         LR    WORKX2,TOTX2                                     03S0173
*           TOTX2=TOTCHAIN;                                /*@Y30LB56*/
         L     TOTX2,TOTCHAIN(,TOTX2)                           03S0174
*         END;                                             /*@Y30LB56*/
*     END;                          /* END OF ONE PASS OF SORT  03S0176
*                                                            @Y30LB56*/
@RC00162 DS    0H                                               03S0176
@DE00161 LTR   TOTX2,TOTX2                                      03S0176
         BNZ   @DL00161                                         03S0176
*     TOTSW=TOTSW&&'01'X;           /* INVERT SORT SWITCH    @Y30LB56*/
         XI    TOTSW(TOTX1),X'01'                               03S0177
*   END;                            /* END ALL PASSES OF SORT@Y30LB56
*                                                            @Y30LB56*/
@DE00156 CLI   TOTSW(TOTX1),X'00'                               03S0178
         BE    @DL00156                                         03S0178
*   CALL NEWPAGE;                   /* OUTPUT FIRST PAGE HEADING
*                                                            @Y30LB56*/
*                                                               03S0179
         BAL   @14,NEWPAGE                                      03S0179
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF ANY REPORT IS TO BE OUTPUT                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0180
*   TOTX2=TOTSTART;                                        /*@Y30LB56*/
         L     TOTX2,TOTSTART(,TOTX1)                           03S0180
*   CVD(TOTRATIO,CVDOUT);                                  /*@Y30LB56*/
         SLR   @05,@05                                          03S0181
         IC    @05,TOTRATIO(,TOTX2)                             03S0181
         CVD   @05,CVDOUT(,TOTX1)                               03S0181
*   UNPK(UNPKOUT(1:2),UNPKIN(3:4)); /* BUILD TOTAL RATIO     @Y30LB56*/
         UNPK  UNPKOUT(2,TOTX1),UNPKIN+2(2,TOTX1)               03S0182
*   UNPKOUT(2)=UNPKOUT(2)×'F0'X;    /* FOR OPTION COMPARE    @Y30LB56*/
         OI    UNPKOUT+1(TOTX1),X'F0'                           03S0183
*   IF UNPKOUT(1:2)<RATIO THEN      /* NO CARTRIDGES EXCEEDED RATIO
*                                                            @Y30LB56*/
         L     @01,DCS00PTR(,CVTPTR)                            03S0184
         CLC   UNPKOUT(2,TOTX1),RATIO(@01)                      03S0184
         BNL   @RF00184                                         03S0184
*     DO;                                                  /*@Y30LB56*/
*       OUTLINE=MSGNONE;                                   /*@Y30LB56*/
         MVI   OUTLINE+95(CVTPTR),C' '                          03S0186
         MVC   OUTLINE+96(37,CVTPTR),OUTLINE+95(CVTPTR)         03S0186
         MVC   OUTLINE(95,CVTPTR),MSGNONE                       03S0186
*       CVD(TOTRATIO,CVDOUT);       /* CONVERT RATIO TO DECIMAL 03S0187
*                                                            @Y30LB56*/
         CVD   @05,CVDOUT(,TOTX1)                               03S0187
*       UNPK(WORSTRAT,UNPKIN(3:4)); /* MAKE IT PRINTABLE     @Y30LB56*/
         UNPK  WORSTRAT(2,CVTPTR),UNPKIN+2(2,TOTX1)             03S0188
*       WORSTRAT(2)=WORSTRAT(2)×'F0'X;/* OVERLAY SIGN        @Y30LB56*/
         OI    WORSTRAT+1(CVTPTR),X'F0'                         03S0189
*   RFY                                                         04S0190
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             04S0191
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     04S0192
         BALR  @14,@15                                          04S0192
*   RFY                                                         04S0193
*     R1 UNRSTD;                                           /*@Y30LB56*/
*     END;                                                 /*@Y30LB56*/
*   ELSE                            /* OUTPUT REPORT         @Y30LB56*/
*     DO;                                                  /*@Y30LB56*/
         B     @RC00184                                         03S0195
@RF00184 DS    0H                                               03S0196
*       IF SUM='N' THEN             /* OUTPUT DETAILED REPORT@Y30LB56*/
*                                                               03S0196
         L     @05,DCS00PTR(,CVTPTR)                            03S0196
         CLI   SUM(@05),C'N'                                    03S0196
         BNE   @RF00196                                         03S0196
*         /***********************************************************/
*         /*                                                         */
*         /* SUMMARY=NO OUTPUT DETAILED REPORT                       */
*         /*                                                         */
*         /***********************************************************/
*                                                               03S0197
*         DO WHILE(TOTX2^=0);                              /*@Y30LB56*/
         B     @DE00197                                         03S0197
@DL00197 DS    0H                                               03S0198
*           IF LINECNT>9&LINECNT+TOTNUM+3>58 THEN               03S0198
         CLI   LINECNT(TOTX1),9                                 03S0198
         BNH   @RF00198                                         03S0198
         SLR   @05,@05                                          03S0198
         IC    @05,LINECNT(,TOTX1)                              03S0198
         SLR   @15,@15                                          03S0198
         IC    @15,TOTNUM(,TOTX2)                               03S0198
         ALR   @05,@15                                          03S0198
         AH    @05,@CH00088                                     03S0198
         CH    @05,@CH00518                                     03S0198
         BNH   @RF00198                                         03S0198
*             CALL NEWPAGE;         /* START THIS CSN ON NEW PAGE
*                                                            @Y30LB56*/
         BAL   @14,NEWPAGE                                      03S0199
*           ELSE                                                03S0200
*             ;                     /* CSN WILL FIT ON CURRENT PAGE
*                                                            @Y30LB56*/
@RF00198 DS    0H                                               03S0201
*           GET0INDX=OLDEST;        /* POINT TO FIRST DCS ENTRY 03S0201
*                                                            @Y30LB56*/
         L     GET0INDX,OLDEST(,TOTX2)                          03S0201
*           OLDATE=ADATE;           /* SAVE DATE             @Y30LB56*/
         MVC   OLDATE(4,TOTX1),ADATE(GET0INDX)                  03S0202
*           DO WHILE(GET0INDX^=0);                         /*@Y30LB56*/
         B     @DE00203                                         03S0203
@DL00203 DS    0H                                               03S0204
*                                                               04S0204
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT DETAIL REPORT LINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               04S0204
*   OUTLINE=' ';                    /* CLEAR OUTPUT LINE     @Y30LB56*/
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0204
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0204
         MVI   OUTLINE(CVTPTR),C' '                             04S0204
*   IF GET0INDX=OLDEST×LINECNT=9 THEN/* NEW CSN OR PAGE      @Y30LB56*/
         C     GET0INDX,OLDEST(,TOTX2)                          04S0205
         BE    @RT00205                                         04S0205
         CLI   LINECNT(TOTX1),9                                 04S0205
         BNE   @RF00205                                         04S0205
@RT00205 DS    0H                                               04S0206
*     DO;                                                  /*@Y30LB56*/
*       LINSER=SNSCSN;              /* SETUP CSN             @Y30LB56*/
         MVC   LINSER(12,CVTPTR),SNSCSN(GET0INDX)               04S0207
*       IF GET0INDX^=OLDEST THEN    /* CONTINUATION PAGE     @Y30LB56*/
         C     GET0INDX,OLDEST(,TOTX2)                          04S0208
         BE    @RF00208                                         04S0208
*         LINECONT='(CONTINUED)';                          /*@Y30LB56*/
         MVC   LINECONT(11,CVTPTR),@CC00519                     04S0209
*       ELSE                                                    04S0210
*         ;                         /* THIS IS FIRST PG FOR THIS CART
*                                                            @Y30LB56*/
@RF00208 DS    0H                                               04S0211
*     END;                                                 /*@Y30LB56*/
*   ELSE                                                        04S0212
*     ;                             /* OMIT CSN              @Y30LB56*/
@RF00205 DS    0H                                               04S0213
*   IF GET0INDX=OLDEST×LINECNT=9×OLDATE^=ADATE THEN             04S0213
         C     GET0INDX,OLDEST(,TOTX2)                          04S0213
         BE    @RT00213                                         04S0213
         CLI   LINECNT(TOTX1),9                                 04S0213
         BE    @RT00213                                         04S0213
         CLC   OLDATE(4,TOTX1),ADATE(GET0INDX)                  04S0213
         BE    @RF00213                                         04S0213
@RT00213 DS    0H                                               04S0214
*     DO;                                                  /*@Y30LB56*/
*       UNPK(UNPKOUT(1:5),ADATE);   /* MAKE DATE PRINTABLE   @Y30LB56*/
         UNPK  UNPKOUT(5,TOTX1),ADATE(4,GET0INDX)               04S0215
*       UNPKOUT(5)=UNPKOUT(5)×'F0'X;                       /*@Y30LB56*/
         OI    UNPKOUT+4(TOTX1),X'F0'                           04S0216
*       LINDATE(1:3)=UNPKOUT(3:5);  /* DDD/YY                @Y30LB56*/
         MVC   LINDATE(3,CVTPTR),UNPKOUT+2(TOTX1)               04S0217
*       OLDATE=ADATE;               /* SAVE TO SUPRESS SAME DATE
*                                                            @Y30LB56*/
         MVC   OLDATE(4,TOTX1),ADATE(GET0INDX)                  04S0218
*       LINDATE(4)='/';                                    /*@Y30LB56*/
         MVI   LINDATE+3(CVTPTR),C'/'                           04S0219
*       LINDATE(5:6)=UNPKOUT(1:2);                         /*@Y30LB56*/
         MVC   LINDATE+4(2,CVTPTR),UNPKOUT(TOTX1)               04S0220
*     END;                                                 /*@Y30LB56*/
*   ELSE                                                        04S0222
*     ;                             /* OMIT DATE             @Y30LB56*/
@RF00213 DS    0H                                               04S0223
*   UNPK(UNPKOUT,ATIME);            /* MAKE TIME PRINTABLE   @Y30LB56*/
         UNPK  UNPKOUT(7,TOTX1),ATIME(4,GET0INDX)               04S0223
*   LINTIME(1:2)=UNPKOUT(1:2);                             /*@Y30LB56*/
         MVC   LINTIME(2,CVTPTR),UNPKOUT(TOTX1)                 04S0224
*   LINTIME(3)=':';                 /* HH:MM:SS              @Y30LB56*/
         MVI   LINTIME+2(CVTPTR),C':'                           04S0225
*   LINTIME(4:5)=UNPKOUT(3:4);                             /*@Y30LB56*/
         MVC   LINTIME+3(2,CVTPTR),UNPKOUT+2(TOTX1)             04S0226
*   LINTIME(6)=':';                                        /*@Y30LB56*/
         MVI   LINTIME+5(CVTPTR),C':'                           04S0227
*   LINTIME(7:8)=UNPKOUT(5:6);                             /*@Y30LB56*/
         MVC   LINTIME+6(2,CVTPTR),UNPKOUT+4(TOTX1)             04S0228
*   CVDIN=CVDIN&&CVDIN;             /* CLEAR CVD INPUT AREA  @Y30LB56*/
         L     @15,CVDIN(,TOTX1)                                04S0229
         LR    @14,@15                                          04S0229
         XR    @14,@15                                          04S0229
         ST    @14,CVDIN(,TOTX1)                                04S0229
*   CVDIN2=SNSRDCK;                                        /*@Y30LB56*/
         MVC   CVDIN2(2,TOTX1),SNSRDCK(GET0INDX)                04S0230
*   CALL CONVERT;                   /* SETUP READ ERRORS     @Y30LB56*/
         BAL   @14,CONVERT                                      04S0231
*   LINER1=UNPKOUT(3:7);                                   /*@Y30LB56*/
         MVC   LINER1(5,CVTPTR),UNPKOUT+2(TOTX1)                04S0232
*   CVDIN2=SNSRDUC;                                        /*@Y30LB56*/
         MVC   CVDIN2(2,TOTX1),SNSRDUC(GET0INDX)                04S0233
*   CALL CONVERT;                   /* SETUP READ USAGE      @Y30LB56*/
         BAL   @14,CONVERT                                      04S0234
*   LINEU1=UNPKOUT(3:7);                                   /*@Y30LB56*/
         MVC   LINEU1(5,CVTPTR),UNPKOUT+2(TOTX1)                04S0235
*   IF SNSRDRAT='FF'X THEN          /* INDICATE INVALID RATIO@Y30LB56*/
         CLI   SNSRDRAT(GET0INDX),255                           04S0236
         BNE   @RF00236                                         04S0236
*     LINEP1(2:3)='**';                                    /*@Y30LB56*/
         MVC   LINEP1+1(2,CVTPTR),@CC00524                      04S0237
*   ELSE                                                        04S0238
*     DO;                                                  /*@Y30LB56*/
         B     @RC00236                                         04S0238
@RF00236 DS    0H                                               04S0239
*       IF SNSRDRAT='64'X THEN      /* USE=ERR               @Y30LB56*/
         CLI   SNSRDRAT(GET0INDX),100                           04S0239
         BNE   @RF00239                                         04S0239
*         SNSRDRAT='63'X;           /* SET RATIO = .99       @Y30LB56*/
         MVI   SNSRDRAT(GET0INDX),X'63'                         04S0240
*       ELSE                                                    04S0241
*         ;                                                /*@Y30LB56*/
@RF00239 DS    0H                                               04S0242
*       CVD(SNSRDRAT,CVDOUT);       /* SETUP RD ERR/USE=RATIO@Y30LB56*/
         SLR   @15,@15                                          04S0242
         IC    @15,SNSRDRAT(,GET0INDX)                          04S0242
         CVD   @15,CVDOUT(,TOTX1)                               04S0242
*       UNPK(LINEP1(2:3),UNPKIN(3:4));                     /*@Y30LB56*/
         UNPK  LINEP1+1(2,CVTPTR),UNPKIN+2(2,TOTX1)             04S0243
*       LINEP1(3)=LINEP1(3)×'F0'X;                         /*@Y30LB56*/
         OI    LINEP1+2(CVTPTR),X'F0'                           04S0244
*     END;                                                 /*@Y30LB56*/
*   LINEP1(1)='.';                                         /*@Y30LB56*/
@RC00236 MVI   LINEP1(CVTPTR),C'.'                              04S0246
*   CVDIN2=SNSWRCK;                                        /*@Y30LB56*/
         MVC   CVDIN2(2,TOTX1),SNSWRCK(GET0INDX)                04S0247
*   CALL CONVERT;                   /* SETUP WRITE ERRORS    @Y30LB56*/
         BAL   @14,CONVERT                                      04S0248
*   LINER2=UNPKOUT(3:7);                                   /*@Y30LB56*/
         MVC   LINER2(5,CVTPTR),UNPKOUT+2(TOTX1)                04S0249
*   CVDIN2=SNSWRUC;                                        /*@Y30LB56*/
         MVC   CVDIN2(2,TOTX1),SNSWRUC(GET0INDX)                04S0250
*   CALL CONVERT;                   /* SETUP WRITE USAGE     @Y30LB56*/
         BAL   @14,CONVERT                                      04S0251
*   LINEU2=UNPKOUT(3:7);                                   /*@Y30LB56*/
         MVC   LINEU2(5,CVTPTR),UNPKOUT+2(TOTX1)                04S0252
*   IF SNSWRAT='FF'X THEN           /* INDICATE INVALID RATIO@Y30LB56*/
         CLI   SNSWRAT(GET0INDX),255                            04S0253
         BNE   @RF00253                                         04S0253
*     LINEP2(2:3)='**';                                    /*@Y30LB56*/
         MVC   LINEP2+1(2,CVTPTR),@CC00524                      04S0254
*   ELSE                                                        04S0255
*     DO;                                                  /*@Y30LB56*/
         B     @RC00253                                         04S0255
@RF00253 DS    0H                                               04S0256
*       IF SNSWRAT='64'X THEN       /* USE=ERR               @Y30LB56*/
         CLI   SNSWRAT(GET0INDX),100                            04S0256
         BNE   @RF00256                                         04S0256
*         SNSWRAT='63'X;                                   /*@Y30LB56*/
         MVI   SNSWRAT(GET0INDX),X'63'                          04S0257
*       ELSE                                                    04S0258
*         ;                                                /*@Y30LB56*/
@RF00256 DS    0H                                               04S0259
*       CVD(SNSWRAT,CVDOUT);        /* SETUP WR ERR/USE=RATIO@Y30LB56*/
         SLR   @15,@15                                          04S0259
         IC    @15,SNSWRAT(,GET0INDX)                           04S0259
         CVD   @15,CVDOUT(,TOTX1)                               04S0259
*       UNPK(LINEP2(2:3),UNPKIN(3:4));                     /*@Y30LB56*/
         UNPK  LINEP2+1(2,CVTPTR),UNPKIN+2(2,TOTX1)             04S0260
*       LINEP2(3)=LINEP2(3)×'F0'X;                         /*@Y30LB56*/
         OI    LINEP2+2(CVTPTR),X'F0'                           04S0261
*     END;                                                 /*@Y30LB56*/
*   LINEP2(1)='.';                                         /*@Y30LB56*/
@RC00253 MVI   LINEP2(CVTPTR),C'.'                              04S0263
*   UNPK(UNPKOUT(1:4),SNS4D(1:3));  /* SETUP SSID            @Y30LB56*/
         UNPK  UNPKOUT(4,TOTX1),SNS4D(3,GET0INDX)               04S0264
*   LINESSID=UNPKOUT(1:3);                                 /*@Y30LB56*/
         MVC   LINESSID(3,CVTPTR),UNPKOUT(TOTX1)                04S0265
*   WORKVAR=SNS9A10;                                       /*@Y30LB56*/
         SLR   WORKVAR,WORKVAR                                  04S0266
         ICM   WORKVAR,3,SNS9A10(GET0INDX)                      04S0266
*   SLL(WORKVAR,23);                /* SETUP SA ADDRESS      @Y30LB56*/
         SLL   WORKVAR,23                                       04S0267
*   SRL(WORKVAR,28);                                       /*@Y30LB56*/
         SRL   WORKVAR,28                                       04S0268
*   IF WORKVAR>9 THEN               /* A-F                   @Y30LB56*/
         CH    WORKVAR,@CH00184                                 04S0269
         BNH   @RF00269                                         04S0269
*     WORKVAR=WORKVAR+183;          /* MAKE IT PRINTABLE     @Y30LB56*/
         AH    WORKVAR,@CH00531                                 04S0270
*   ELSE                            /* 0-9                   @Y30LB56*/
*     WORKVAR=WORKVAR×'F0'X;        /* MAKE IT PRINTABLE     @Y30LB56*/
         B     @RC00269                                         04S0271
@RF00269 O     WORKVAR,@CF00516                                 04S0271
*   LINESA=WORKVAR;                                        /*@Y30LB56*/
@RC00269 STC   WORKVAR,LINESA(,CVTPTR)                          04S0272
*   WORKVAR=SNS9A10;                                       /*@Y30LB56*/
         SLR   @15,@15                                          04S0273
         ICM   @15,3,SNS9A10(GET0INDX)                          04S0273
         LR    WORKVAR,@15                                      04S0273
*   SLL(WORKVAR,28);                /* SETUP DRC ADDRESS     @Y30LB56*/
         SLL   WORKVAR,28                                       04S0274
*   SRL(WORKVAR,30);                                       /*@Y30LB56*/
         SRL   WORKVAR,30                                       04S0275
*   LINEDRC=WORKVAR×'F0'X;                                 /*@Y30LB56*/
         LA    @07,240                                          04S0276
         LR    @14,WORKVAR                                      04S0276
         OR    @14,@07                                          04S0276
         STC   @14,LINEDRC(,CVTPTR)                             04S0276
*   WORKVAR=SNS9A10;                                       /*@Y30LB56*/
         LR    WORKVAR,@15                                      04S0277
*   SLL(WORKVAR,30);                /* SETUP DRD ADDRESS     @Y30LB56*/
         SLL   WORKVAR,30                                       04S0278
*   SRL(WORKVAR,30);                                       /*@Y30LB56*/
         SRL   WORKVAR,30                                       04S0279
*   LINEDRD=WORKVAR×'F0'X;                                 /*@Y30LB56*/
         OR    @07,WORKVAR                                      04S0280
         STC   @07,LINEDRD(,CVTPTR)                             04S0280
*   IF SNSFORCE='0'B THEN           /* FORCE LOG BIT ON      @ZM31073*/
         TM    SNSFORCE(GET0INDX),B'10000000'                   04S0281
         BNZ   @RF00281                                         04S0281
*     LINEREAS='OVERFLOW  ';        /* NO, MUST BE OVERFLOW  @ZM31073*/
         MVC   LINEREAS(10,CVTPTR),@CC00534                     04S0282
*   ELSE                            /* YES, HAVE FORCED LOG  @ZM31073*/
*     IF SNSLDCHK='1'B THEN         /* LOAD CHECK BIT ON     @ZM31073*/
         B     @RC00281                                         04S0283
@RF00281 TM    SNSLDCHK(GET0INDX),B'01000000'                   04S0283
         BNO   @RF00283                                         04S0283
*       LINEREAS='LOAD CHECK';      /* YES, HAD LOAD CHECK   @ZM31073*/
         MVC   LINEREAS(10,CVTPTR),@CC00537                     04S0284
*     ELSE                          /* NO, NORMAL FORCED LOG @ZM31073*/
*       LINEREAS='THRESHOLD ';      /* LOG THRESHOLD EXCEEDED@ZM31073*/
         B     @RC00283                                         04S0285
@RF00283 MVC   LINEREAS(10,CVTPTR),@CC00539                     04S0285
*   RFY                                                         05S0286
*     R1 RSTD;                                             /*@Y30LB56*/
@RC00283 DS    0H                                               05S0286
@RC00281 DS    0H                                               05S0287
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             05S0287
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     05S0288
         BALR  @14,@15                                          05S0288
*   RFY                                                         05S0289
*     R1 UNRSTD;                                           /*@Y30LB56*/
*   LINECNT=LINECNT+1;              /* ADVANCE LINE COUNTER  @Y30LB56*/
         LA    @15,1                                            04S0290
         SLR   @14,@14                                          04S0290
         IC    @14,LINECNT(,TOTX1)                              04S0290
         ALR   @15,@14                                          04S0290
         STC   @15,LINECNT(,TOTX1)                              04S0290
*   IF LINECNT>58 THEN              /* START A NEW PAGE      @Y30LB56*/
         CLI   LINECNT(TOTX1),58                                04S0291
         BNH   @RF00291                                         04S0291
*     CALL NEWPAGE;                                        /*@Y30LB56*/
         BAL   @14,NEWPAGE                                      04S0292
*   ELSE                                                        04S0293
*     ;                             /* CONTINUE USING THIS PG@Y30LB56
*                                                            @Y30LB56*/
@RF00291 DS    0H                                               04S0294
*             GET0INDX=CHAINPTR;    /* POINT TO NEXT ENTRY IN CHAIN
*                                                            @Y30LB56*/
         L     GET0INDX,CHAINPTR(,GET0INDX)                     03S0294
*             DO WHILE(GET0INDX^=0&SNSCSN^=DCSN);          /*@Y30LB56*/
         B     @DE00295                                         03S0295
@DL00295 DS    0H                                               03S0296
*               GET0INDX=CHAINPTR;  /* LOOK FOR NEXT ENTRY   @Y30LB56*/
         L     GET0INDX,CHAINPTR(,GET0INDX)                     03S0296
*             END;                                         /*@Y30LB56*/
@DE00295 LTR   GET0INDX,GET0INDX                                03S0297
         BZ    @DC00295                                         03S0297
         CLC   SNSCSN(12,GET0INDX),DCSN(TOTX2)                  03S0297
         BNE   @DL00295                                         03S0297
@DC00295 DS    0H                                               03S0298
*           END;                                           /*@Y30LB56*/
@DE00203 LTR   GET0INDX,GET0INDX                                03S0298
         BNZ   @DL00203                                         03S0298
*                                                               04S0299
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT SUBTOTALS AND TOTALS FOR THIS DATA CARTRIDGE           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               04S0299
*   OUTLINE=' ';                    /* CLEAR OUTPUT LINE     @Y30LB56*/
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0299
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0299
         MVI   OUTLINE(CVTPTR),C' '                             04S0299
*   TOTALE1=TOTALE;                                        /*@Y30LB56*/
         MVC   TOTALE1(14,CVTPTR),TOTALE                        04S0300
*   IF TOTALERR>999999 THEN                                     04S0301
         CLC   TOTALERR(4,TOTX2),@CF00541                       04S0301
         BNH   @RF00301                                         04S0301
*     TOTALE2='******';             /* OVERFLOW              @Y30LB56*/
         MVC   TOTALE2(6,CVTPTR),@CC00542                       04S0302
*   ELSE                                                        04S0303
*     DO;                                                  /*@Y30LB56*/
         B     @RC00301                                         04S0303
@RF00301 DS    0H                                               04S0304
*       CVDIN=TOTALERR;                                    /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTALERR(TOTX2)                   04S0304
*       CALL CONVERT;               /* SET UP TOTAL ERRORS   @Y30LB56*/
         BAL   @14,CONVERT                                      04S0305
*       TOTALE2=UNPKOUT(2:7);                              /*@Y30LB56*/
         MVC   TOTALE2(6,CVTPTR),UNPKOUT+1(TOTX1)               04S0306
*     END;                                                 /*@Y30LB56*/
*   RFY                                                         05S0308
*     R1 RSTD;                                             /*@Y30LB56*/
@RC00301 DS    0H                                               05S0309
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             05S0309
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     05S0310
         BALR  @14,@15                                          05S0310
*   RFY                                                         05S0311
*     R1 UNRSTD;                                           /*@Y30LB56*/
*   LINECNT=LINECNT+1;              /* ADVANCE LINE COUNTER  @Y30LB56*/
         LA    @05,1                                            04S0312
         SLR   @15,@15                                          04S0312
         IC    @15,LINECNT(,TOTX1)                              04S0312
         ALR   @05,@15                                          04S0312
         STC   @05,LINECNT(,TOTX1)                              04S0312
*   IF LINECNT>58 THEN              /* START A NEW PAGE      @Y30LB56*/
         CLI   LINECNT(TOTX1),58                                04S0313
         BNH   @RF00313                                         04S0313
*     CALL NEWPAGE;                                        /*@Y30LB56*/
         BAL   @14,NEWPAGE                                      04S0314
*   ELSE                                                        04S0315
*     ;                             /* CONTINUE USING THIS PG@Y30LB56*/
@RF00313 DS    0H                                               04S0316
*   OUTLINE=' ';                    /* CLEAR OUTPUT LINE     @Y30LB56*/
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0316
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0316
         MVI   OUTLINE(CVTPTR),C' '                             04S0316
*   TOTALU1=TOTALU;                                        /*@Y30LB56*/
         MVC   TOTALU1(13,CVTPTR),TOTALU                        04S0317
*   IF TOTALUSE>9999999 THEN                                    04S0318
         CLC   TOTALUSE(4,TOTX2),@CF00543                       04S0318
         BNH   @RF00318                                         04S0318
*     TOTALU2='*******';            /* OVERFLOW              @Y30LB56*/
         MVC   TOTALU2(7,CVTPTR),@CC00544                       04S0319
*   ELSE                                                        04S0320
*     DO;                                                  /*@Y30LB56*/
         B     @RC00318                                         04S0320
@RF00318 DS    0H                                               04S0321
*       CVDIN=TOTALUSE;                                    /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTALUSE(TOTX2)                   04S0321
*       CALL CONVERT;               /* SETUP TOTAL USAGE     @Y30LB56*/
         BAL   @14,CONVERT                                      04S0322
*       TOTALU2=UNPKOUT;                                   /*@Y30LB56*/
         MVC   TOTALU2(7,CVTPTR),UNPKOUT(TOTX1)                 04S0323
*     END;                                                 /*@Y30LB56*/
*   SUBTOT1=SUBTOT;                                        /*@Y30LB56*/
@RC00318 MVC   SUBTOT1(10,CVTPTR),SUBTOT                        04S0325
*   IF TOTRDCK>999999 THEN                                      04S0326
         CLC   TOTRDCK(4,TOTX2),@CF00541                        04S0326
         BNH   @RF00326                                         04S0326
*     SUBTE1='******';              /* OVERFLOW              @Y30LB56*/
         MVC   SUBTE1(6,CVTPTR),@CC00542                        04S0327
*   ELSE                                                        04S0328
*     DO;                                                  /*@Y30LB56*/
         B     @RC00326                                         04S0328
@RF00326 DS    0H                                               04S0329
*       CVDIN=TOTRDCK;                                     /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTRDCK(TOTX2)                    04S0329
*       CALL CONVERT;               /* SETUP TOTAL READ ERRORS  04S0330
*                                                            @Y30LB56*/
         BAL   @14,CONVERT                                      04S0330
*       SUBTE1=UNPKOUT(2:7);                               /*@Y30LB56*/
         MVC   SUBTE1(6,CVTPTR),UNPKOUT+1(TOTX1)                04S0331
*     END;                                                 /*@Y30LB56*/
*   IF TOTRDUC>999999 THEN                                      04S0333
@RC00326 CLC   TOTRDUC(4,TOTX2),@CF00541                        04S0333
         BNH   @RF00333                                         04S0333
*     SUBTU1='******';              /* OVERFLOW              @Y30LB56*/
         MVC   SUBTU1(6,CVTPTR),@CC00542                        04S0334
*   ELSE                                                        04S0335
*     DO;                                                  /*@Y30LB56*/
         B     @RC00333                                         04S0335
@RF00333 DS    0H                                               04S0336
*       CVDIN=TOTRDUC;                                     /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTRDUC(TOTX2)                    04S0336
*       CALL CONVERT;               /* SETUP TOTAL READ USAGE@Y30LB56*/
         BAL   @14,CONVERT                                      04S0337
*       SUBTU1=UNPKOUT(2:7);                               /*@Y30LB56*/
         MVC   SUBTU1(6,CVTPTR),UNPKOUT+1(TOTX1)                04S0338
*     END;                                                 /*@Y30LB56*/
*   IF RDRATIO='FF'X THEN           /* INDICATE INVALID RATIO@Y30LB56*/
@RC00333 CLI   RDRATIO(TOTX2),255                               04S0340
         BNE   @RF00340                                         04S0340
*     SUBTP1(2:3)='**';                                    /*@Y30LB56*/
         MVC   SUBTP1+1(2,CVTPTR),@CC00524                      04S0341
*   ELSE                                                        04S0342
*     DO;                                                  /*@Y30LB56*/
         B     @RC00340                                         04S0342
@RF00340 DS    0H                                               04S0343
*       IF RDRATIO='64'X THEN       /* USE=ERR               @Y30LB56*/
         CLI   RDRATIO(TOTX2),100                               04S0343
         BNE   @RF00343                                         04S0343
*         RDRATIO='63'X;                                   /*@Y30LB56*/
         MVI   RDRATIO(TOTX2),X'63'                             04S0344
*       ELSE                                                    04S0345
*         ;                                                /*@Y30LB56*/
@RF00343 DS    0H                                               04S0346
*       CVD(RDRATIO,CVDOUT);        /* SETUP RD ERR/USE=RATIO@Y30LB56*/
         SLR   @05,@05                                          04S0346
         IC    @05,RDRATIO(,TOTX2)                              04S0346
         CVD   @05,CVDOUT(,TOTX1)                               04S0346
*       UNPK(SUBTP1(2:3),UNPKIN(3:4));                     /*@Y30LB56*/
         UNPK  SUBTP1+1(2,CVTPTR),UNPKIN+2(2,TOTX1)             04S0347
*       SUBTP1(3)=SUBTP1(3)×'F0'X;                         /*@Y30LB56*/
         OI    SUBTP1+2(CVTPTR),X'F0'                           04S0348
*     END;                                                 /*@Y30LB56*/
*   SUBTP1(1)='.';                                         /*@Y30LB56*/
@RC00340 MVI   SUBTP1(CVTPTR),C'.'                              04S0350
*   IF TOTWRCK>999999 THEN                                      04S0351
         CLC   TOTWRCK(4,TOTX2),@CF00541                        04S0351
         BNH   @RF00351                                         04S0351
*     SUBTE2='******';              /* OVERFLOW              @Y30LB56*/
         MVC   SUBTE2(6,CVTPTR),@CC00542                        04S0352
*   ELSE                                                        04S0353
*     DO;                                                  /*@Y30LB56*/
         B     @RC00351                                         04S0353
@RF00351 DS    0H                                               04S0354
*       CVDIN=TOTWRCK;                                     /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTWRCK(TOTX2)                    04S0354
*       CALL CONVERT;               /* SETUP TOTAL WRITE ERRORS 04S0355
*                                                            @Y30LB56*/
         BAL   @14,CONVERT                                      04S0355
*       SUBTE2=UNPKOUT(2:7);                               /*@Y30LB56*/
         MVC   SUBTE2(6,CVTPTR),UNPKOUT+1(TOTX1)                04S0356
*     END;                                                 /*@Y30LB56*/
*   IF TOTWRUC>999999 THEN                                      04S0358
@RC00351 CLC   TOTWRUC(4,TOTX2),@CF00541                        04S0358
         BNH   @RF00358                                         04S0358
*     SUBTU2='******';              /* OVERFLOW              @Y30LB56*/
         MVC   SUBTU2(6,CVTPTR),@CC00542                        04S0359
*   ELSE                                                        04S0360
*     DO;                                                  /*@Y30LB56*/
         B     @RC00358                                         04S0360
@RF00358 DS    0H                                               04S0361
*       CVDIN=TOTWRUC;                                     /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTWRUC(TOTX2)                    04S0361
*       CALL CONVERT;               /* SETUP TOTAL WRITE USAGE  04S0362
*                                                            @Y30LB56*/
         BAL   @14,CONVERT                                      04S0362
*       SUBTU2=UNPKOUT(2:7);                               /*@Y30LB56*/
         MVC   SUBTU2(6,CVTPTR),UNPKOUT+1(TOTX1)                04S0363
*     END;                                                 /*@Y30LB56*/
*   IF WRATIO='FF'X THEN            /* INDICATE INVALID RATIO@Y30LB56*/
@RC00358 CLI   WRATIO(TOTX2),255                                04S0365
         BNE   @RF00365                                         04S0365
*     SUBTP2(2:3)='**';                                    /*@Y30LB56*/
         MVC   SUBTP2+1(2,CVTPTR),@CC00524                      04S0366
*   ELSE                                                        04S0367
*     DO;                                                  /*@Y30LB56*/
         B     @RC00365                                         04S0367
@RF00365 DS    0H                                               04S0368
*       IF WRATIO='64'X THEN        /* USE=ERR               @Y30LB56*/
         CLI   WRATIO(TOTX2),100                                04S0368
         BNE   @RF00368                                         04S0368
*         WRATIO='63'X;                                    /*@Y30LB56*/
         MVI   WRATIO(TOTX2),X'63'                              04S0369
*       ELSE                                                    04S0370
*         ;                                                /*@Y30LB56*/
@RF00368 DS    0H                                               04S0371
*       CVD(WRATIO,CVDOUT);         /* SETUP WR ERR/USE=RATIO@Y30LB56*/
         SLR   @05,@05                                          04S0371
         IC    @05,WRATIO(,TOTX2)                               04S0371
         CVD   @05,CVDOUT(,TOTX1)                               04S0371
*       UNPK(SUBTP2(2:3),UNPKIN(3:4));                     /*@Y30LB56*/
         UNPK  SUBTP2+1(2,CVTPTR),UNPKIN+2(2,TOTX1)             04S0372
*       SUBTP2(3)=SUBTP2(3)×'F0'X;                         /*@Y30LB56*/
         OI    SUBTP2+2(CVTPTR),X'F0'                           04S0373
*     END;                                                 /*@Y30LB56*/
*   SUBTP2(1)='.';                                         /*@Y30LB56*/
@RC00365 MVI   SUBTP2(CVTPTR),C'.'                              04S0375
*   RFY                                                         05S0376
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             05S0377
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     05S0378
         BALR  @14,@15                                          05S0378
*   RFY                                                         05S0379
*     R1 UNRSTD;                                           /*@Y30LB56*/
*   LINECNT=LINECNT+1;              /* ADVANCE LINECOUNTER   @Y30LB56*/
         LA    @05,1                                            04S0380
         SLR   @15,@15                                          04S0380
         IC    @15,LINECNT(,TOTX1)                              04S0380
         ALR   @05,@15                                          04S0380
         STC   @05,LINECNT(,TOTX1)                              04S0380
*   IF LINECNT>58 THEN              /* START A NEW PAGE      @Y30LB56*/
         CLI   LINECNT(TOTX1),58                                04S0381
         BNH   @RF00381                                         04S0381
*     CALL NEWPAGE;                                        /*@Y30LB56*/
         BAL   @14,NEWPAGE                                      04S0382
*   ELSE                                                        04S0383
*     ;                             /* CONTINUE THIS PAGE    @Y30LB56*/
@RF00381 DS    0H                                               04S0384
*   OUTLINE=' ';                    /* CLEAR OUTPUT LINE     @Y30LB56*/
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0384
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0384
         MVI   OUTLINE(CVTPTR),C' '                             04S0384
*   TOTALR1=TOTALR;                                        /*@Y30LB56*/
         MVC   TOTALR1(9,CVTPTR),TOTALR                         04S0385
*   IF TOTRATIO='FF'X THEN          /* INDICATE INVALID RATIO@Y30LB56*/
         CLI   TOTRATIO(TOTX2),255                              04S0386
         BNE   @RF00386                                         04S0386
*     TOTALR2='**';                                        /*@Y30LB56*/
         MVC   TOTALR2(2,CVTPTR),@CC00524                       04S0387
*   ELSE                                                        04S0388
*     DO;                                                  /*@Y30LB56*/
         B     @RC00386                                         04S0388
@RF00386 DS    0H                                               04S0389
*       IF TOTRATIO='64'X THEN      /* USE=ERR               @Y30LB56*/
         CLI   TOTRATIO(TOTX2),100                              04S0389
         BNE   @RF00389                                         04S0389
*         TOTRATIO='63'X;                                  /*@Y30LB56*/
         MVI   TOTRATIO(TOTX2),X'63'                            04S0390
*       ELSE                                                    04S0391
*         ;                                                /*@Y30LB56*/
@RF00389 DS    0H                                               04S0392
*       CVD(TOTRATIO,CVDOUT);       /* SETUP TOTAL ERR/USE=RATIO
*                                                            @Y30LB56*/
         SLR   @05,@05                                          04S0392
         IC    @05,TOTRATIO(,TOTX2)                             04S0392
         CVD   @05,CVDOUT(,TOTX1)                               04S0392
*       UNPK(TOTALR2,UNPKIN(3:4));                         /*@Y30LB56*/
         UNPK  TOTALR2(2,CVTPTR),UNPKIN+2(2,TOTX1)              04S0393
*       TOTALR2(2)=TOTALR2(2)×'F0'X;                       /*@Y30LB56*/
         OI    TOTALR2+1(CVTPTR),X'F0'                          04S0394
*     END;                                                 /*@Y30LB56*/
*   RFY                                                         05S0396
*     R1 RSTD;                                             /*@Y30LB56*/
@RC00386 DS    0H                                               05S0397
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             05S0397
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     05S0398
         BALR  @14,@15                                          05S0398
*   RFY                                                         05S0399
*     R1 UNRSTD;                                           /*@Y30LB56*/
*   LINECNT=LINECNT+1;              /* ADVANCE LINE COUNTER  @Y30LB56*/
         LA    @05,1                                            04S0400
         SLR   @15,@15                                          04S0400
         IC    @15,LINECNT(,TOTX1)                              04S0400
         ALR   @05,@15                                          04S0400
         STC   @05,LINECNT(,TOTX1)                              04S0400
*   IF LINECNT>58 THEN              /* START A NEW PAGE      @Y30LB56*/
         CLI   LINECNT(TOTX1),58                                04S0401
         BNH   @RF00401                                         04S0401
*     CALL NEWPAGE;                                        /*@Y30LB56*/
         BAL   @14,NEWPAGE                                      04S0402
*   ELSE                                                        04S0403
*     ;                             /* CONTINUE THIS PAGE    @Y30LB56
*                                                            @Y30LB56*/
@RF00401 DS    0H                                               04S0404
*           TOTX2=TOTCHAIN;         /* ADVANCE TO NEXT CSN   @Y30LB56*/
         L     TOTX2,TOTCHAIN(,TOTX2)                           03S0404
*           IF TOTX2^=0 THEN                                    03S0405
         SLR   @05,@05                                          03S0405
         CR    TOTX2,@05                                        03S0405
         BE    @RF00405                                         03S0405
*             DO;                                          /*@Y30LB56*/
*               CVD(TOTRATIO,CVDOUT);                      /*@Y30LB56*/
         SLR   @15,@15                                          03S0407
         IC    @15,TOTRATIO(,TOTX2)                             03S0407
         CVD   @15,CVDOUT(,TOTX1)                               03S0407
*               UNPK(UNPKOUT(1:2),UNPKIN(3:4));            /*@Y30LB56*/
         UNPK  UNPKOUT(2,TOTX1),UNPKIN+2(2,TOTX1)               03S0408
*               UNPKOUT(2)=UNPKOUT(2)×'F0'X;               /*@Y30LB56*/
         OI    UNPKOUT+1(TOTX1),X'F0'                           03S0409
*               IF UNPKOUT(1:2)<RATIO THEN/* SUPRESS REST OF REPORT
*                                                            @Y30LB56*/
         L     @01,DCS00PTR(,CVTPTR)                            03S0410
         CLC   UNPKOUT(2,TOTX1),RATIO(@01)                      03S0410
         BNL   @RF00410                                         03S0410
*                 TOTX2=0;                                 /*@Y30LB56*/
         LR    TOTX2,@05                                        03S0411
*               ELSE                /* OUTPUT CSN SEPARATOR  @Y30LB56*/
*                 DO;                                      /*@Y30LB56*/
         B     @RC00410                                         03S0412
@RF00410 DS    0H                                               03S0413
*                   OUTLINE=' ';                           /*@Y30LB56*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0413
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0413
         MVI   OUTLINE(CVTPTR),C' '                             03S0413
*                   DO I=4 TO 128 BY 4;                    /*@ZM31073*/
         LA    I,4                                              03S0414
@DL00414 DS    0H                                               03S0415
*                     OUTLINE(I)='-';/* BUILD - - - LINE     @Y30LB56*/
         LR    @06,CVTPTR                                       03S0415
         ALR   @06,I                                            03S0415
         MVI   OUTLINE-1(@06),C'-'                              03S0415
*                   END;                                   /*@Y30LB56*/
         AH    I,@CH00107                                       03S0416
         CH    I,@CH00545                                       03S0416
         BNH   @DL00414                                         03S0416
*                   OUTLINE(28)='×';                       /*@Y30LB56*/
         MVI   OUTLINE+27(CVTPTR),C'×'                          03S0417
*                   OUTLINE(52)='×';                       /*@Y30LB56*/
         MVI   OUTLINE+51(CVTPTR),C'×'                          03S0418
*                   OUTLINE(98)='×';                       /*@ZM31073*/
         MVI   OUTLINE+97(CVTPTR),C'×'                          03S0419
*                   OUTLINE(118)='×';                      /*@ZM31073*/
         MVI   OUTLINE+117(CVTPTR),C'×'                         03S0420
*   RFY                                                         04S0421
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             04S0422
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     04S0423
         BALR  @14,@15                                          04S0423
*   RFY                                                         04S0424
*     R1 UNRSTD;                                           /*@Y30LB56*/
*                   LINECNT=LINECNT+1;/* ADVANCE LINE COUNTER@Y30LB56*/
         LA    @05,1                                            03S0425
         SLR   @15,@15                                          03S0425
         IC    @15,LINECNT(,TOTX1)                              03S0425
         ALR   @05,@15                                          03S0425
         STC   @05,LINECNT(,TOTX1)                              03S0425
*                   IF LINECNT>58 THEN/* START A NEW PAGE    @Y30LB56*/
         CLI   LINECNT(TOTX1),58                                03S0426
         BNH   @RF00426                                         03S0426
*                     CALL NEWPAGE;                        /*@Y30LB56*/
         BAL   @14,NEWPAGE                                      03S0427
*                   ELSE                                        03S0428
*                     ;             /* CONTINUE THIS PAGE    @Y30LB56*/
@RF00426 DS    0H                                               03S0429
*                 END;                                     /*@Y30LB56*/
*             END;                                         /*@Y30LB56*/
*           ELSE                                                03S0431
*             ;                     /* END OF DCS            @Y30LB56*/
@RF00405 DS    0H                                               03S0432
*         END;                                             /*@Y30LB56*/
@RC00405 DS    0H                                               03S0432
@DE00197 LTR   TOTX2,TOTX2                                      03S0432
         BNZ   @DL00197                                         03S0432
*       ELSE                        /* OUTPUT SUMMARIZED REPORT 03S0433
*                                                            @Y30LB56*/
*                                                               03S0433
*         /***********************************************************/
*         /*                                                         */
*         /* SUMMARY=YES OUTPUT ONLY ACCUMULATED TOTALS              */
*         /*                                                         */
*         /***********************************************************/
*                                                               03S0433
*         DO WHILE(TOTX2^=0);                              /*@Y30LB56*/
         B     @RC00196                                         03S0433
@RF00196 B     @DE00433                                         03S0433
@DL00433 DS    0H                                               03S0434
*                                                               04S0434
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT SUMMARY OF SUBTOTALS AND TOTALS FOR THIS DATA          */
*   /* CARTRIDGE.                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               04S0434
*   OUTLINE=' ';                    /* CLEAR OUTPUT LINE     @Y30LB56*/
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0434
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0434
         MVI   OUTLINE(CVTPTR),C' '                             04S0434
*   SLINSER=DCSN;                   /* SETUP CSN             @Y30LB56*/
         MVC   SLINSER(12,CVTPTR),DCSN(TOTX2)                   04S0435
*   UNPK(UNPKOUT(1:5),OLDEST->ADATE);                      /*@Y30LB56*/
         L     @05,OLDEST(,TOTX2)                               04S0436
         UNPK  UNPKOUT(5,TOTX1),ADATE(4,@05)                    04S0436
*   UNPKOUT(5)=UNPKOUT(5)×'F0'X;                           /*@Y30LB56*/
         OI    UNPKOUT+4(TOTX1),X'F0'                           04S0437
*   SLINDATF(1:3)=UNPKOUT(3:5);     /* SETUP FROM DATE       @Y30LB56*/
         MVC   SLINDATF(3,CVTPTR),UNPKOUT+2(TOTX1)              04S0438
*   SLINDATF(4)='/';                                       /*@Y30LB56*/
         MVI   SLINDATF+3(CVTPTR),C'/'                          04S0439
*   SLINDATF(5:6)=UNPKOUT(1:2);                            /*@Y30LB56*/
         MVC   SLINDATF+4(2,CVTPTR),UNPKOUT(TOTX1)              04S0440
*   UNPK(UNPKOUT,OLDEST->ATIME);                           /*@Y30LB56*/
         UNPK  UNPKOUT(7,TOTX1),ATIME(4,@05)                    04S0441
*   SLINTIMF(1:2)=UNPKOUT(1:2);     /* SETUP FROM TIME       @Y30LB56*/
         MVC   SLINTIMF(2,CVTPTR),UNPKOUT(TOTX1)                04S0442
*   SLINTIMF(3)=':';                                       /*@Y30LB56*/
         MVI   SLINTIMF+2(CVTPTR),C':'                          04S0443
*   SLINTIMF(4:5)=UNPKOUT(3:4);                            /*@Y30LB56*/
         MVC   SLINTIMF+3(2,CVTPTR),UNPKOUT+2(TOTX1)            04S0444
*   SLINTIMF(6)=':';                                       /*@Y30LB56*/
         MVI   SLINTIMF+5(CVTPTR),C':'                          04S0445
*   SLINTIMF(7:8)=UNPKOUT(5:6);                            /*@Y30LB56*/
         MVC   SLINTIMF+6(2,CVTPTR),UNPKOUT+4(TOTX1)            04S0446
*   UNPK(UNPKOUT(1:5),NEWEST->ADATE);                      /*@Y30LB56*/
         L     @05,NEWEST(,TOTX2)                               04S0447
         UNPK  UNPKOUT(5,TOTX1),ADATE(4,@05)                    04S0447
*   UNPKOUT(5)=UNPKOUT(5)×'F0'X;    /* SETUP TO DATE         @Y30LB56*/
         OI    UNPKOUT+4(TOTX1),X'F0'                           04S0448
*   SLINDATO(1:3)=UNPKOUT(3:5);                            /*@Y30LB56*/
         MVC   SLINDATO(3,CVTPTR),UNPKOUT+2(TOTX1)              04S0449
*   SLINDATO(4)='/';                                       /*@Y30LB56*/
         MVI   SLINDATO+3(CVTPTR),C'/'                          04S0450
*   SLINDATO(5:6)=UNPKOUT(1:2);                            /*@Y30LB56*/
         MVC   SLINDATO+4(2,CVTPTR),UNPKOUT(TOTX1)              04S0451
*   UNPK(UNPKOUT,NEWEST->ATIME);                           /*@Y30LB56*/
         UNPK  UNPKOUT(7,TOTX1),ATIME(4,@05)                    04S0452
*   SLINTIMT(1:2)=UNPKOUT(1:2);     /* SETUP TO TIME         @Y30LB56*/
         MVC   SLINTIMT(2,CVTPTR),UNPKOUT(TOTX1)                04S0453
*   SLINTIMT(3)=':';                                       /*@Y30LB56*/
         MVI   SLINTIMT+2(CVTPTR),C':'                          04S0454
*   SLINTIMT(4:5)=UNPKOUT(3:4);                            /*@Y30LB56*/
         MVC   SLINTIMT+3(2,CVTPTR),UNPKOUT+2(TOTX1)            04S0455
*   SLINTIMT(6)=':';                                       /*@Y30LB56*/
         MVI   SLINTIMT+5(CVTPTR),C':'                          04S0456
*   SLINTIMT(7:8)=UNPKOUT(5:6);                            /*@Y30LB56*/
         MVC   SLINTIMT+6(2,CVTPTR),UNPKOUT+4(TOTX1)            04S0457
*   IF TOTRDCK>999999 THEN                                      04S0458
         CLC   TOTRDCK(4,TOTX2),@CF00541                        04S0458
         BNH   @RF00458                                         04S0458
*     SLINER1='******';             /* OVERFLOW              @Y30LB56*/
         MVC   SLINER1(6,CVTPTR),@CC00542                       04S0459
*   ELSE                                                        04S0460
*     DO;                                                  /*@Y30LB56*/
         B     @RC00458                                         04S0460
@RF00458 DS    0H                                               04S0461
*       CVDIN=TOTRDCK;                                     /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTRDCK(TOTX2)                    04S0461
*       CALL CONVERT;               /* SETUP TOTAL READ ERRORS  04S0462
*                                                            @Y30LB56*/
         BAL   @14,CONVERT                                      04S0462
*       SLINER1=UNPKOUT(2:7);                              /*@Y30LB56*/
         MVC   SLINER1(6,CVTPTR),UNPKOUT+1(TOTX1)               04S0463
*     END;                                                 /*@Y30LB56*/
*   IF TOTRDUC>999999 THEN                                      04S0465
@RC00458 CLC   TOTRDUC(4,TOTX2),@CF00541                        04S0465
         BNH   @RF00465                                         04S0465
*     SLINEU1='******';             /* OVERFLOW              @Y30LB56*/
         MVC   SLINEU1(6,CVTPTR),@CC00542                       04S0466
*   ELSE                                                        04S0467
*     DO;                                                  /*@Y30LB56*/
         B     @RC00465                                         04S0467
@RF00465 DS    0H                                               04S0468
*       CVDIN=TOTRDUC;                                     /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTRDUC(TOTX2)                    04S0468
*       CALL CONVERT;               /* SETUP TOTAL READ USAGE@Y30LB56*/
         BAL   @14,CONVERT                                      04S0469
*       SLINEU1=UNPKOUT(2:7);                              /*@Y30LB56*/
         MVC   SLINEU1(6,CVTPTR),UNPKOUT+1(TOTX1)               04S0470
*     END;                                                 /*@Y30LB56*/
*   IF RDRATIO='FF'X THEN           /* INDICATE INVALID RATIO@Y30LB56*/
@RC00465 CLI   RDRATIO(TOTX2),255                               04S0472
         BNE   @RF00472                                         04S0472
*     SLINEP1(2:3)='**';                                   /*@Y30LB56*/
         MVC   SLINEP1+1(2,CVTPTR),@CC00524                     04S0473
*   ELSE                                                        04S0474
*     DO;                                                  /*@Y30LB56*/
         B     @RC00472                                         04S0474
@RF00472 DS    0H                                               04S0475
*       IF RDRATIO='64'X THEN       /* USE=ERR               @Y30LB56*/
         CLI   RDRATIO(TOTX2),100                               04S0475
         BNE   @RF00475                                         04S0475
*         RDRATIO='63'X;                                   /*@Y30LB56*/
         MVI   RDRATIO(TOTX2),X'63'                             04S0476
*       ELSE                                                    04S0477
*         ;                                                /*@Y30LB56*/
@RF00475 DS    0H                                               04S0478
*       CVD(RDRATIO,CVDOUT);                               /*@Y30LB56*/
         SLR   @05,@05                                          04S0478
         IC    @05,RDRATIO(,TOTX2)                              04S0478
         CVD   @05,CVDOUT(,TOTX1)                               04S0478
*       UNPK(SLINEP1(2:3),UNPKIN(3:4));                    /*@Y30LB56*/
         UNPK  SLINEP1+1(2,CVTPTR),UNPKIN+2(2,TOTX1)            04S0479
*       SLINEP1(3)=SLINEP1(3)×'F0'X;/* SETUP TOTAL RD ERR/USE=RATIO
*                                                            @Y30LB56*/
         OI    SLINEP1+2(CVTPTR),X'F0'                          04S0480
*     END;                                                 /*@Y30LB56*/
*   SLINEP1(1)='.';                                        /*@Y30LB56*/
@RC00472 MVI   SLINEP1(CVTPTR),C'.'                             04S0482
*   IF TOTWRCK>999999 THEN                                      04S0483
         CLC   TOTWRCK(4,TOTX2),@CF00541                        04S0483
         BNH   @RF00483                                         04S0483
*     SLINER2='******';             /* OVERFLOW              @Y30LB56*/
         MVC   SLINER2(6,CVTPTR),@CC00542                       04S0484
*   ELSE                                                        04S0485
*     DO;                                                  /*@Y30LB56*/
         B     @RC00483                                         04S0485
@RF00483 DS    0H                                               04S0486
*       CVDIN=TOTWRCK;                                     /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTWRCK(TOTX2)                    04S0486
*       CALL CONVERT;               /* SETUP TOTAL WRITE ERRORS 04S0487
*                                                            @Y30LB56*/
         BAL   @14,CONVERT                                      04S0487
*       SLINER2=UNPKOUT(2:7);                              /*@Y30LB56*/
         MVC   SLINER2(6,CVTPTR),UNPKOUT+1(TOTX1)               04S0488
*     END;                                                 /*@Y30LB56*/
*   IF TOTWRUC>999999 THEN                                      04S0490
@RC00483 CLC   TOTWRUC(4,TOTX2),@CF00541                        04S0490
         BNH   @RF00490                                         04S0490
*     SLINEU2='******';             /* OVERFLOW              @Y30LB56*/
         MVC   SLINEU2(6,CVTPTR),@CC00542                       04S0491
*   ELSE                                                        04S0492
*     DO;                                                  /*@Y30LB56*/
         B     @RC00490                                         04S0492
@RF00490 DS    0H                                               04S0493
*       CVDIN=TOTWRUC;                                     /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTWRUC(TOTX2)                    04S0493
*       CALL CONVERT;               /* SETUP TOTAL WRITE USAGE  04S0494
*                                                            @Y30LB56*/
         BAL   @14,CONVERT                                      04S0494
*       SLINEU2=UNPKOUT(2:7);                              /*@Y30LB56*/
         MVC   SLINEU2(6,CVTPTR),UNPKOUT+1(TOTX1)               04S0495
*     END;                                                 /*@Y30LB56*/
*   IF WRATIO='FF'X THEN            /* INDICATE INVALID RATIO@Y30LB56*/
@RC00490 CLI   WRATIO(TOTX2),255                                04S0497
         BNE   @RF00497                                         04S0497
*     SLINEP2(2:3)='**';                                   /*@Y30LB56*/
         MVC   SLINEP2+1(2,CVTPTR),@CC00524                     04S0498
*   ELSE                                                        04S0499
*     DO;                                                  /*@Y30LB56*/
         B     @RC00497                                         04S0499
@RF00497 DS    0H                                               04S0500
*       IF WRATIO='64'X THEN        /* USE=ERR               @Y30LB56*/
         CLI   WRATIO(TOTX2),100                                04S0500
         BNE   @RF00500                                         04S0500
*         WRATIO='63'X;                                    /*@Y30LB56*/
         MVI   WRATIO(TOTX2),X'63'                              04S0501
*       ELSE                                                    04S0502
*         ;                                                /*@Y30LB56*/
@RF00500 DS    0H                                               04S0503
*       CVD(WRATIO,CVDOUT);                                /*@Y30LB56*/
         SLR   @05,@05                                          04S0503
         IC    @05,WRATIO(,TOTX2)                               04S0503
         CVD   @05,CVDOUT(,TOTX1)                               04S0503
*       UNPK(SLINEP2(2:3),UNPKIN(3:4));                    /*@Y30LB56*/
         UNPK  SLINEP2+1(2,CVTPTR),UNPKIN+2(2,TOTX1)            04S0504
*       SLINEP2(3)=SLINEP2(3)×'F0'X;/* SETUP TOTAL WR ERR/USE=RATIO
*                                                            @Y30LB56*/
         OI    SLINEP2+2(CVTPTR),X'F0'                          04S0505
*     END;                                                 /*@Y30LB56*/
*   SLINEP2(1)='.';                                        /*@Y30LB56*/
@RC00497 MVI   SLINEP2(CVTPTR),C'.'                             04S0507
*   CVDIN=TOTALERR;                                        /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTALERR(TOTX2)                   04S0508
*   CALL CONVERT;                   /* SETUP TOTAL ERRORS    @Y30LB56*/
         BAL   @14,CONVERT                                      04S0509
*   SLINER3=UNPKOUT(2:7);                                  /*@Y30LB56*/
         MVC   SLINER3(6,CVTPTR),UNPKOUT+1(TOTX1)               04S0510
*   CVDIN=TOTALUSE;                                        /*@Y30LB56*/
         MVC   CVDIN(4,TOTX1),TOTALUSE(TOTX2)                   04S0511
*   CALL CONVERT;                   /* SETUP TOTAL USAGE     @Y30LB56*/
         BAL   @14,CONVERT                                      04S0512
*   SLINEU3=UNPKOUT;                                       /*@Y30LB56*/
         MVC   SLINEU3(7,CVTPTR),UNPKOUT(TOTX1)                 04S0513
*   IF TOTRATIO='FF'X THEN          /* INDICATE INVALID RATIO@Y30LB56*/
         CLI   TOTRATIO(TOTX2),255                              04S0514
         BNE   @RF00514                                         04S0514
*     SLINEP3(2:3)='**';                                   /*@Y30LB56*/
         MVC   SLINEP3+1(2,CVTPTR),@CC00524                     04S0515
*   ELSE                                                        04S0516
*     DO;                                                  /*@Y30LB56*/
         B     @RC00514                                         04S0516
@RF00514 DS    0H                                               04S0517
*       IF TOTRATIO='64'X THEN      /* USE=ERR               @Y30LB56*/
         CLI   TOTRATIO(TOTX2),100                              04S0517
         BNE   @RF00517                                         04S0517
*         TOTRATIO='63'X;                                  /*@Y30LB56*/
         MVI   TOTRATIO(TOTX2),X'63'                            04S0518
*       ELSE                                                    04S0519
*         ;                                                /*@Y30LB56*/
@RF00517 DS    0H                                               04S0520
*       CVD(TOTRATIO,CVDOUT);                              /*@Y30LB56*/
         SLR   @05,@05                                          04S0520
         IC    @05,TOTRATIO(,TOTX2)                             04S0520
         CVD   @05,CVDOUT(,TOTX1)                               04S0520
*       UNPK(SLINEP3(2:3),UNPKIN(3:4));                    /*@Y30LB56*/
         UNPK  SLINEP3+1(2,CVTPTR),UNPKIN+2(2,TOTX1)            04S0521
*       SLINEP3(3)=SLINEP3(3)×'F0'X;/* SETUP TOT ERR/USE=RATIO  04S0522
*                                                            @Y30LB56*/
         OI    SLINEP3+2(CVTPTR),X'F0'                          04S0522
*       IF SLINEP3(2:3)<RATIO THEN  /* SUPRESS THIS LINE     @Y30LB56*/
         L     @05,DCS00PTR(,CVTPTR)                            04S0523
         CLC   SLINEP3+1(2,CVTPTR),RATIO(@05)                   04S0523
         BNL   @RF00523                                         04S0523
*         SLINEP3(2)=' ';           /* AND THE REST OF THIS REPORT
*                                                            @Y30LB56*/
         MVI   SLINEP3+1(CVTPTR),C' '                           04S0524
*       ELSE                                                    04S0525
*         ;                                                /*@Y30LB56*/
@RF00523 DS    0H                                               04S0526
*     END;                                                 /*@Y30LB56*/
*   IF SLINEP3(2)^=' ' THEN         /* OUTPUT REPORT         @Y30LB56*/
@RC00514 CLI   SLINEP3+1(CVTPTR),C' '                           04S0527
         BE    @RF00527                                         04S0527
*     DO;                                                  /*@Y30LB56*/
*       SLINEP3(1)='.';                                    /*@Y30LB56*/
         MVI   SLINEP3(CVTPTR),C'.'                             04S0529
*   RFY                                                         05S0530
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             05S0531
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     05S0532
         BALR  @14,@15                                          05S0532
*   RFY                                                         05S0533
*     R1 UNRSTD;                                           /*@Y30LB56*/
*       LINECNT=LINECNT+1;          /* ADVANCE LINE COUNTER  @Y30LB56*/
         LA    @05,1                                            04S0534
         SLR   @15,@15                                          04S0534
         IC    @15,LINECNT(,TOTX1)                              04S0534
         ALR   @05,@15                                          04S0534
         STC   @05,LINECNT(,TOTX1)                              04S0534
*       IF LINECNT>58 THEN          /* START A NEW PAGE      @Y30LB56*/
         CLI   LINECNT(TOTX1),58                                04S0535
         BNH   @RF00535                                         04S0535
*         CALL NEWPAGE;                                    /*@Y30LB56*/
         BAL   @14,NEWPAGE                                      04S0536
*       ELSE                                                    04S0537
*         ;                         /* CONTINUE USING THIS PAGE 04S0537
*                                                            @Y30LB56*/
@RF00535 DS    0H                                               04S0538
*     END;                                                 /*@Y30LB56*/
*   ELSE                                                        04S0539
*     ;                             /* SUPRESS THE REST OF THIS 04S0539
*                                      REPORT                   04S0539
*                                                            @Y30LB56*/
@RF00527 DS    0H                                               04S0540
*           TOTX2=TOTCHAIN;                                /*@Y30LB56*/
         L     TOTX2,TOTCHAIN(,TOTX2)                           03S0540
*         END;                                             /*@Y30LB56*/
@DE00433 LTR   TOTX2,TOTX2                                      03S0541
         BNZ   @DL00433                                         03S0541
*     END;                                                 /*@Y30LB56*/
@RC00196 DS    0H                                               03S0543
*   IF LINECNT>55 THEN              /* START A NEW PAGE      @Y30LB56*/
@RC00184 CLI   LINECNT(TOTX1),55                                03S0543
         BNH   @RF00543                                         03S0543
*     CALL NEWPAGE;                                        /*@Y30LB56*/
         BAL   @14,NEWPAGE                                      03S0544
*   ELSE                                                        03S0545
*     ;                             /* CONTINUE USING THIS PAGE 03S0545
*                                                            @Y30LB56*/
@RF00543 DS    0H                                               03S0546
*   OUTLINE=DRDS;                                          /*@Y30LB56*/
*                                                               03S0546
         MVI   OUTLINE+52(CVTPTR),C' '                          03S0546
         MVC   OUTLINE+53(80,CVTPTR),OUTLINE+52(CVTPTR)         03S0546
         MVC   OUTLINE(52,CVTPTR),DRDS                          03S0546
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT DRD SSIDS WITH HIGHEST ERROR/USAGE=RATIO FIRST         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0547
*   WORKX1=1;                                              /*@Y30LB56*/
         LA    WORKX1,1                                         03S0547
*   DO WHILE(WORKX1<17);                                   /*@Y30LB56*/
         B     @DE00548                                         03S0548
@DL00548 DS    0H                                               03S0549
*     CVDIN1='00'X;                                        /*@Y30LB56*/
         MVI   CVDIN1(TOTX1),X'00'                              03S0549
*     WORKVAR=0;                                           /*@Y30LB56*/
         SLR   WORKVAR,WORKVAR                                  03S0550
*     DO I=1 TO 56;                                        /*@Y30LB56*/
         LA    I,1                                              03S0551
@DL00551 DS    0H                                               03S0552
*       IF CVDIN1<SSIDX(I) THEN     /* SAVE HIGHEST RATIO    @Y30LB56*/
         LR    @04,TOTX1                                        03S0552
         AL    @04,@CF00573                                     03S0552
         SLR   @15,@15                                          03S0552
         IC    @15,SSIDX(I,@04)                                 03S0552
         SLR   @04,@04                                          03S0552
         IC    @04,CVDIN1(,TOTX1)                               03S0552
         CR    @15,@04                                          03S0552
         BNH   @RF00552                                         03S0552
*         DO;                                              /*@Y30LB56*/
*           WORKVAR=I;              /* SAVE INDEX            @Y30LB56*/
         LR    WORKVAR,I                                        03S0554
*           CVDIN1=SSIDX(I);        /* SAVE RATIO            @Y30LB56*/
         STC   @15,CVDIN1(,TOTX1)                               03S0555
*         END;                                             /*@Y30LB56*/
*       ELSE                                                    03S0557
*         ;                         /* HIGHEST RATIO SAVED   @Y30LB56*/
@RF00552 DS    0H                                               03S0558
*     END;                                                 /*@Y30LB56*/
         AH    I,@CH00084                                       03S0558
         CH    I,@CH00552                                       03S0558
         BNH   @DL00551                                         03S0558
*     IF CVDIN1>'00'X THEN          /* CONSTRUCT SSID        @Y30LB56*/
         CLI   CVDIN1(TOTX1),0                                  03S0559
         BNH   @RF00559                                         03S0559
*       DO;                                                /*@Y30LB56*/
*         SSIDX(WORKVAR)='00'X;     /* PREVENT REUSE         @Y30LB56*/
         LR    @07,TOTX1                                        03S0561
         ALR   @07,WORKVAR                                      03S0561
         AL    @07,@CF00573                                     03S0561
         MVI   SSIDX(@07),X'00'                                 03S0561
*         WORKVAR=WORKVAR-1;        /*SUBTRACT 1 FOR SSID 00 @ZM31053*/
         BCTR  WORKVAR,0                                        03S0562
*         SLL(WORKVAR,8);                                  /*@Y30LB56*/
         SLL   WORKVAR,8                                        03S0563
*         UNPKIN=WORKVAR;                                  /*@Y30LB56*/
         ST    WORKVAR,UNPKIN(,TOTX1)                           03S0564
*         UNPK(UNPKOUT(1:3),UNPKIN(3:4));                  /*@Y30LB56*/
         UNPK  UNPKOUT(3,TOTX1),UNPKIN+2(2,TOTX1)               03S0565
*         DRDS2(WORKX1,3)='2';      /* SET SSID TYPE CODE    @Y30LB56*/
         LR    @04,WORKX1                                       03S0566
         MH    @04,@CH00383                                     03S0566
         ST    @04,@TF00001                                     03S0566
         ALR   @04,CVTPTR                                       03S0566
         MVI   DRDS2-3(@04),C'2'                                03S0566
*         DRDS2(WORKX1,4:5)=UNPKOUT(1:2);/* SET ID           @Y30LB56*/
         LR    @04,CVTPTR                                       03S0567
         AL    @04,@TF00001                                     03S0567
         MVC   DRDS2-2(2,@04),UNPKOUT(TOTX1)                    03S0567
*         WORKX1=WORKX1+1;          /* ADVANCE ARRAY INDEX   @Y30LB56*/
         AH    WORKX1,@CH00084                                  03S0568
*       END;                                               /*@Y30LB56*/
*     ELSE                          /* ALL SSIDS ARE SET     @Y30LB56*/
*       WORKX1=WORKX1+16;                                  /*@ZM31073*/
         B     @RC00559                                         03S0570
@RF00559 AH    WORKX1,@CH00188                                  03S0570
*   END;                                                   /*@Y30LB56*/
@RC00559 DS    0H                                               03S0571
@DE00548 LA    @04,17                                           03S0571
         CR    WORKX1,@04                                       03S0571
         BL    @DL00548                                         03S0571
*   IF WORKX1=17 THEN               /* WERE ALL RATIOS ZERO  @ZM31073*/
         CR    WORKX1,@04                                       03S0572
         BNE   @RF00572                                         03S0572
*     DRDS3=DRDSZERO;               /* YES, MOVE ALL ZERO    @ZM31073*/
         MVC   DRDS3(20,CVTPTR),DRDSZERO                        03S0573
*   ELSE;                           /* NO, SOME SSIDS PRINTED@ZM31073*/
@RF00572 DS    0H                                               03S0575
*   RFY                                                         04S0575
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             04S0576
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     04S0577
         BALR  @14,@15                                          04S0577
*   RFY                                                         04S0578
*     R1 UNRSTD;                                           /*@Y30LB56*/
*         END;                                             /*@Y30LB56*/
*       ELSE                                                    02S0580
*         ;                         /* NO WORKAREA AVAILABLE @Y30LB56*/
@RF00126 DS    0H                                               02S0581
*     END;                                                 /*@Y30LB56*/
*   ELSE                                                        02S0582
*     ;                             /* NO WORKAREA AVAILABLE @Y30LB56
*                                                            @Y30LB56*/
@RF00045 DS    0H                                               02S0583
*                                                               02S0583
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE ALLOCATED WORKAREAS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0583
*   GET0PTR=DCS00PTR;               /* POINT TO FIRST WORKAREA  02S0583
*                                                            @Y30LB56*/
         L     GET0PTR,DCS00PTR(,CVTPTR)                        02S0583
*   DCS00PTR=0;                                            /*@Y30LB56*/
         SLR   @09,@09                                          02S0584
         ST    @09,DCS00PTR(,CVTPTR)                            02S0584
*   SPNOLEN=GETWORK;                /* PUT SUBPOOL NO AND LEN IN CVT
*                                                            @Y30LB56*/
         MVC   SPNOLEN(4,CVTPTR),GETWORK                        02S0585
*   DO WHILE(GET0PTR^=0);                                  /*@Y30LB56*/
         B     @DE00586                                         02S0586
@DL00586 DS    0H                                               02S0587
*     WORKX1=NEXTPTR;               /* SAVE POINTER TO NEXT WORK AREA
*                                                            @Y30LB56*/
         L     WORKX1,NEXTPTR(,GET0PTR)                         02S0587
*     COREADDR=GET0PTR;             /* PUT WORKAREA PTR INTO CVT
*                                                            @Y30LB56*/
         ST    GET0PTR,COREADDR(,CVTPTR)                        02S0588
*     RFY                                                       02S0589
*       R1 RSTD;                                           /*@Y30LB56*/
*     R1=ADDR(WORKCALL);            /* PTR TO PTR TO PTR TO CVT 02S0590
*                                                            @Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             02S0590
*     CALL ISDAFREE;                /* FREE WORKAREA         @Y30LB56*/
         L     @15,@CV00144                                     02S0591
         BALR  @14,@15                                          02S0591
*     RFY                                                       02S0592
*       R1 UNRSTD;                                         /*@Y30LB56*/
*     GET0PTR=WORKX1;               /* POINT TO NEXT WORKAREA OR 0
*                                                            @Y30LB56*/
         LR    GET0PTR,WORKX1                                   02S0593
*   END;                                                   /*@Y30LB56*/
@DE00586 LTR   GET0PTR,GET0PTR                                  02S0594
         BNZ   @DL00586                                         02S0594
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER* * * * * * *
*                                                            @Y30LB56*/
         LH    @09,RETCODE                                      01S0595
         L     @13,4(,@13)                                      01S0595
         L     @00,@SIZDATD                                     01S0595
         LR    @01,@12                                          01S0595
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@09                                          01S0595
         L     @14,12(,@13)                                     01S0595
         LM    @00,@12,20(@13)                                  01S0595
         BR    @14                                              01S0595
*                                                               02S0596
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLOCATE ADDITIONAL WORKING STORAGE                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0596
*GETMORE:                                                       02S0596
*   PROC;                                                  /*@Y30LB56*/
@EL00001 L     @13,4(,@13)                                      02S0596
@EF00001 L     @00,@SIZDATD                                     02S0596
         LR    @01,@12                                          02S0596
         ISDAFSPC R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                  02S0596
         BR    @14                                              02S0596
GETMORE  STM   @14,@04,@SA00002                                 02S0596
         STM   @06,@07,@SA00002+28                              02S0596
         STM   @09,@12,@SA00002+36                              02S0596
*   DO;                             /* GET ANOTHER WORKAREA  @Y30LB56*/
*     WORKX2=GET0INDX;              /* SAVE DCS ENTRY POINTER@Y30LB56*/
         LR    WORKX2,GET0INDX                                  02S0598
*                                                               03S0599
*   /*****************************************************************/
*   /*                                                               */
*   /* GET ADDITIONAL WORKAREA. GETWORK IS A FULL WORD CONTAINING A  */
*   /* ONE BYTE SUBPOOL NUMBER, AND A THREE BYTE VALUE INDICATING THE*/
*   /* NUMBER OF BYTES TO ALLOCATE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0599
*   DO;                                                    /*@Y30LB56*/
*     SPNOLEN=GETWORK;              /* SETUP SUBPOOL AND LENGTH IN
*                                      CVT                   @Y30LB56*/
         MVC   SPNOLEN(4,CVTPTR),GETWORK                        03S0600
*     RFY                                                       03S0601
*       R1 RSTD;                                           /*@Y30LB56*/
*     R1=ADDR(WORKCALL);            /* PTR TO PTR TO PTR TO CVT 03S0602
*                                                            @Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0602
*     CALL ISDAGET0;                /* GET A WORK AREA       @Y30LB56*/
         L     @15,@CV00145                                     03S0603
         BALR  @14,@15                                          03S0603
*     RFY                                                       03S0604
*       R1 UNRSTD;                                         /*@Y30LB56*/
*     RFY                                                       03S0605
*       R15 RSTD;                   /* PROTECT RETURN CODE REG  03S0605
*                                                            @Y30LB56*/
*     IF R15=0 THEN                 /* WORKAREA WAS ALLOCATED@Y30LB56*/
         SLR   @14,@14                                          03S0606
         CR    R15,@14                                          03S0606
         BNE   @RF00606                                         03S0606
*       DO;                                                /*@Y30LB56*/
*         RETCODE=0;                /* SET RETURN CODE TO 0  @Y30LB56*/
         STH   @14,RETCODE                                      03S0608
*         NEXTPTR=COREADDR;         /* CHAIN OLD WORKAREA TO NEW
*                                                            @Y30LB56*/
         L     @14,COREADDR(,CVTPTR)                            03S0609
         ST    @14,NEXTPTR(,GET0PTR)                            03S0609
*         WORKVAR=BLOCKCNT;         /* GET PREVIOUS BLOCK COUNT 03S0610
*                                                            @Y30LB56*/
         LH    WORKVAR,BLOCKCNT(,GET0PTR)                       03S0610
*         WORKX1=GET0PTR;           /* SAVE POINTER TO LAST BLOCK
*                                                            @Y30LB56*/
         LR    WORKX1,GET0PTR                                   03S0611
*         GET0PTR=NEXTPTR;          /* GET POINTER TO NEW WORK AREA
*                                                            @Y30LB56*/
         LR    GET0PTR,@14                                      03S0612
*         LASTPTR=WORKX1;           /* SAVE POINTER TO LAST BLOCK
*                                                            @Y30LB56*/
         ST    WORKX1,LASTPTR(,GET0PTR)                         03S0613
*         BLOCKCNT=WORKVAR+1;       /* SAVE BLOCK COUNTER    @Y30LB56*/
         LA    @14,1                                            03S0614
         ALR   @14,WORKVAR                                      03S0614
         STH   @14,BLOCKCNT(,GET0PTR)                           03S0614
*         GET0INDX=STARTPTR;        /* POINT TO NEXT AVAIL ENTRY
*                                                            @Y30LB56*/
         L     GET0INDX,STARTPTR(,GET0PTR)                      03S0615
*       END;                                               /*@Y30LB56*/
*     ELSE                          /* WORKAREA COULD NOT BE @Y30LB56
*                                      ALLOCATED             @Y30LB56*/
*       RETCODE=4;                  /* SET RETURN CODE TO 4  @Y30LB56*/
         B     @RC00606                                         03S0617
@RF00606 MVC   RETCODE(2),@CH00107                              03S0617
*     RFY                                                       03S0618
*       R15 UNRSTD;                                        /*@Y30LB56*/
@RC00606 DS    0H                                               03S0619
*   END;                                                   /*@Y30LB56*/
*     IF RETCODE=0 THEN             /* WORKAREA WAS OBTAINED @Y30LB56*/
         ICM   @09,3,RETCODE                                    02S0620
         BNZ   @RF00620                                         02S0620
*       DO;                                                /*@Y30LB56*/
*         BLOCKID='DCS ';           /* SET WORKAREA ID       @Y30LB56*/
         MVC   BLOCKID(4,GET0PTR),@CC00557                      02S0622
*         GET0NEXT=GET0INDX;        /* POINT TO NEXT SLOT    @Y30LB56*/
         ST    GET0INDX,GET0NEXT                                02S0623
*         GET0INDX=WORKX2;          /* RESTORE DCS ENTRY POINTER
*                                                            @Y30LB56*/
         LR    GET0INDX,WORKX2                                  02S0624
*       END;                                               /*@Y30LB56*/
*     ELSE                                                      02S0626
*       ;                           /* NO MORE WORKAREA AVAILABLE
*                                                            @Y30LB56*/
@RF00620 DS    0H                                               02S0627
*   END;                                                   /*@Y30LB56*/
*   END GETMORE;                                           /*@Y30LB56*/
@EL00002 DS    0H                                               02S0628
@EF00002 DS    0H                                               02S0628
@ER00002 LM    @14,@04,@SA00002                                 02S0628
         LM    @06,@07,@SA00002+28                              02S0628
         LM    @09,@12,@SA00002+36                              02S0628
         BR    @14                                              02S0628
*                                                               02S0629
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT PAGE HEADING AND RESET LINE COUNTER                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0629
*NEWPAGE:                                                       02S0629
*   PROC;                                                  /*@Y30LB56*/
NEWPAGE  STM   @14,@12,@SA00003                                 02S0629
*   LINECNT=9;                      /* RESET LINE COUNTER    @Y30LB56*/
         MVI   LINECNT(TOTX1),X'09'                             02S0630
*   OUTLINE=LINE4;                                         /*@Y30LB56*/
         MVI   OUTLINE+128(CVTPTR),C' '                         02S0631
         MVC   OUTLINE+129(4,CVTPTR),OUTLINE+128(CVTPTR)        02S0631
         MVC   OUTLINE(128,CVTPTR),LINE4                        02S0631
*   HEADSER=SER;                    /* INSERT USER OPTIONS   @Y30LB56*/
         L     @15,DCS00PTR(,CVTPTR)                            02S0632
         MVC   HEADSER(12,CVTPTR),SER(@15)                      02S0632
*   HEADRAT=RATIO;                                         /*@Y30LB56*/
         MVC   HEADRAT(2,CVTPTR),RATIO(@15)                     02S0633
*   IF SUM='Y' THEN                                             02S0634
         CLI   SUM(@15),C'Y'                                    02S0634
         BNE   @RF00634                                         02S0634
*     HEADSUM='YES';                                       /*@Y30LB56*/
         MVC   HEADSUM(3,CVTPTR),@CC00562                       02S0635
*   ELSE                                                        02S0636
*     ;                                                    /*@Y30LB56*/
@RF00634 DS    0H                                               02S0637
*   RFY                                                         03S0637
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0638
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     03S0639
         BALR  @14,@15                                          03S0639
*   RFY                                                         03S0640
*     R1 UNRSTD;                                           /*@Y30LB56*/
*   IF SUM='N' THEN                 /* OUTPUT DETAIL HEADINGS@Y30LB56*/
         L     @01,DCS00PTR(,CVTPTR)                            02S0641
         CLI   SUM(@01),C'N'                                    02S0641
         BNE   @RF00641                                         02S0641
*     DO;                                                  /*@Y30LB56*/
*       OUTLINE=LINE7SN;                                   /*@Y30LB56*/
         MVI   OUTLINE+125(CVTPTR),C' '                         02S0643
         MVC   OUTLINE+126(7,CVTPTR),OUTLINE+125(CVTPTR)        02S0643
         MVC   OUTLINE(125,CVTPTR),LINE7SN                      02S0643
*   RFY                                                         03S0644
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0645
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     03S0646
         BALR  @14,@15                                          03S0646
*   RFY                                                         03S0647
*     R1 UNRSTD;                                           /*@Y30LB56*/
*       OUTLINE=LINE8SN;                                   /*@Y30LB56*/
         MVI   OUTLINE+125(CVTPTR),C' '                         02S0648
         MVC   OUTLINE+126(7,CVTPTR),OUTLINE+125(CVTPTR)        02S0648
         MVC   OUTLINE(125,CVTPTR),LINE8SN                      02S0648
*   RFY                                                         03S0649
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0650
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     03S0651
         BALR  @14,@15                                          03S0651
*   RFY                                                         03S0652
*     R1 UNRSTD;                                           /*@Y30LB56*/
*       OUTLINE=' ';                                       /*@Y30LB56*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0653
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0653
         MVI   OUTLINE(CVTPTR),C' '                             02S0653
*       DO I=2 TO 128 BY 2;                                /*@ZM31073*/
         LA    I,2                                              02S0654
@DL00654 DS    0H                                               02S0655
*         OUTLINE(I)='-';           /* BUILD - - - LINE      @Y30LB56*/
         LR    @06,CVTPTR                                       02S0655
         ALR   @06,I                                            02S0655
         MVI   OUTLINE-1(@06),C'-'                              02S0655
*       END;                                               /*@Y30LB56*/
         AH    I,@CH00103                                       02S0656
         CH    I,@CH00545                                       02S0656
         BNH   @DL00654                                         02S0656
*       OUTLINE(28)='×';                                   /*@Y30LB56*/
         MVI   OUTLINE+27(CVTPTR),C'×'                          02S0657
*       OUTLINE(52)='×';                                   /*@Y30LB56*/
         MVI   OUTLINE+51(CVTPTR),C'×'                          02S0658
*       OUTLINE(98)='×';                                   /*@ZM31073*/
         MVI   OUTLINE+97(CVTPTR),C'×'                          02S0659
*       OUTLINE(118)='×';                                  /*@ZM31073*/
         MVI   OUTLINE+117(CVTPTR),C'×'                         02S0660
*   RFY                                                         03S0661
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0662
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     03S0663
         BALR  @14,@15                                          03S0663
*   RFY                                                         03S0664
*     R1 UNRSTD;                                           /*@Y30LB56*/
*     END;                                                 /*@Y30LB56*/
*   ELSE                            /* OUTPUT SUMMARY HEADING@Y30LB56*/
*     DO;                                                  /*@Y30LB56*/
         B     @RC00641                                         02S0666
@RF00641 DS    0H                                               02S0667
*       OUTLINE=LINE7SY;                                   /*@Y30LB56*/
         MVI   OUTLINE+102(CVTPTR),C' '                         02S0667
         MVC   OUTLINE+103(30,CVTPTR),OUTLINE+102(CVTPTR)       02S0667
         MVC   OUTLINE(102,CVTPTR),LINE7SY                      02S0667
*   RFY                                                         03S0668
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0669
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     03S0670
         BALR  @14,@15                                          03S0670
*   RFY                                                         03S0671
*     R1 UNRSTD;                                           /*@Y30LB56*/
*       OUTLINE=LINE8SY;                                   /*@Y30LB56*/
         MVI   OUTLINE+115(CVTPTR),C' '                         02S0672
         MVC   OUTLINE+116(17,CVTPTR),OUTLINE+115(CVTPTR)       02S0672
         MVC   OUTLINE(115,CVTPTR),LINE8SY                      02S0672
*   RFY                                                         03S0673
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0674
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     03S0675
         BALR  @14,@15                                          03S0675
*   RFY                                                         03S0676
*     R1 UNRSTD;                                           /*@Y30LB56*/
*       OUTLINE=' ';                                       /*@Y30LB56*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0677
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0677
         MVI   OUTLINE(CVTPTR),C' '                             02S0677
*       DO I=2 TO 114 BY 2;                                /*@Y30LB56*/
         LA    I,2                                              02S0678
@DL00678 DS    0H                                               02S0679
*         OUTLINE(I)='-';           /* BUILD - - - LINE      @Y30LB56*/
         LR    @06,CVTPTR                                       02S0679
         ALR   @06,I                                            02S0679
         MVI   OUTLINE-1(@06),C'-'                              02S0679
*       END;                                               /*@Y30LB56*/
         AH    I,@CH00103                                       02S0680
         CH    I,@CH00563                                       02S0680
         BNH   @DL00678                                         02S0680
*       OUTLINE(20)='×';                                   /*@Y30LB56*/
         MVI   OUTLINE+19(CVTPTR),C'×'                          02S0681
*       OUTLINE(56)='×';                                   /*@Y30LB56*/
         MVI   OUTLINE+55(CVTPTR),C'×'                          02S0682
*       OUTLINE(96)='×';                                   /*@Y30LB56*/
         MVI   OUTLINE+95(CVTPTR),C'×'                          02S0683
*   RFY                                                         03S0684
*     R1 RSTD;                                             /*@Y30LB56*/
*   R1=ADDR(WORKCALL);                                     /*@Y30LB56*/
         LA    R1,WORKCALL(,CVTPTR)                             03S0685
*   CALL ISDAPRT0;                  /* PRINT LINE            @Y30LB56*/
         L     @15,@CV00223                                     03S0686
         BALR  @14,@15                                          03S0686
*   RFY                                                         03S0687
*     R1 UNRSTD;                                           /*@Y30LB56*/
*     END;                                                 /*@Y30LB56*/
*   END NEWPAGE;                                           /*@Y30LB56*/
@EL00003 DS    0H                                               02S0689
@EF00003 DS    0H                                               02S0689
@ER00003 LM    @14,@12,@SA00003                                 02S0689
         BR    @14                                              02S0689
*                                                               02S0690
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERTS CVDIN TO DECIMAL AND UNPACKS IT INTO UNPKOUT. LEADING*/
*   /* ZEROS ARE CONVERTED TO BLANKS.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0690
*CONVERT:                                                       02S0690
*   PROC;                                                  /*@Y30LB56*/
CONVERT  STM   @14,@12,12(@13)                                  02S0690
*   CVD(CVDIN,CVDOUT);              /* CONVERT TO DECIMAL    @Y30LB56*/
         L     @02,CVDIN(,TOTX1)                                02S0691
         CVD   @02,CVDOUT(,TOTX1)                               02S0691
*   UNPK(UNPKOUT,UNPKIN);           /* MAKE IT PRINTABLE     @Y30LB56*/
         UNPK  UNPKOUT(7,TOTX1),UNPKIN(4,TOTX1)                 02S0692
*   UNPKOUT(7)=UNPKOUT(7)×'F0'X;    /* OVERLAY SIGN          @Y30LB56*/
         OI    UNPKOUT+6(TOTX1),X'F0'                           02S0693
*   DO I=1 TO 6 WHILE(UNPKOUT(I)='0');                     /*@Y30LB56*/
         LA    I,1                                              02S0694
@DL00694 LR    @06,TOTX1                                        02S0694
         ALR   @06,I                                            02S0694
         CLI   UNPKOUT-1(@06),C'0'                              02S0694
         BNE   @DC00694                                         02S0694
*     UNPKOUT(I)=' ';               /* SUPRESS LEADING ZEROS @Y30LB56*/
         LR    @06,TOTX1                                        02S0695
         ALR   @06,I                                            02S0695
         MVI   UNPKOUT-1(@06),C' '                              02S0695
*   END;                                                   /*@Y30LB56*/
         AH    I,@CH00084                                       02S0696
         CH    I,@CH00096                                       02S0696
         BNH   @DL00694                                         02S0696
@DC00694 DS    0H                                               02S0697
*   CVDIN=CVDIN&&CVDIN;             /* ZERO INPUT AREA       @Y30LB56*/
         L     @02,CVDIN(,TOTX1)                                02S0697
         LR    @15,@02                                          02S0697
         XR    @15,@02                                          02S0697
         ST    @15,CVDIN(,TOTX1)                                02S0697
*   END CONVERT;                                           /*@Y30LB56*/
@EL00004 DS    0H                                               02S0698
@EF00004 DS    0H                                               02S0698
@ER00004 LM    @14,@12,12(@13)                                  02S0698
         BR    @14                                              02S0698
*   END ISDADCS1                                           /*@Y30LB56*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDADCS5)                                        *
*/*%INCLUDE SYSUT5  (WORKTOT )                                        *
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        *
*/*%INCLUDE SYSUT5  (DCSDCLS2)                                        *
*/*%INCLUDE SYSUT5  (REPORT  )                                        *
*/*%INCLUDE SYSUT5  (NEWCSN  )                                        *
*/*%INCLUDE SYSUT5  (NEWCSN  )                                        *
*/*%INCLUDE SYSUT5  (TOTBUILD)                                        *
*/*%INCLUDE SYSUT5  (DOREPORT)                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (PRINT   )                                        *
*/*%INCLUDE SYSUT5  (LINEFMT1)                                        *
*/*%INCLUDE SYSUT5  (LINEFMT2)                                        *
*/*%INCLUDE SYSUT5  (LINEFMT3)                                        *
*/*%INCLUDE SYSUT5  (DRDS    )                                        *
*/*%INCLUDE SYSUT5  (CLEANUP )                                        *
*/*%INCLUDE SYSUT5  (GETMORE2)                                        *
*/*%INCLUDE SYSUT5  (GETMORE )                                        *
*/*%INCLUDE SYSUT5  (NEWPAGE )                                        *
*/*%INCLUDE SYSUT5  (CONVERT )                                        *
*;                                                              01S0699
@DATA    DS    0H
@CH00084 DC    H'1'
@CH00103 DC    H'2'
@CH00088 DC    H'3'
@CH00107 DC    H'4'
@CH00383 DC    H'5'
@CH00096 DC    H'6'
@CH00184 DC    H'9'
@CH00188 DC    H'16'
@CH00462 DC    H'52'
@CH00552 DC    H'56'
@CH00518 DC    H'58'
@CH00511 DC    H'100'
@CH00563 DC    H'114'
@CH00545 DC    H'128'
@CH00568 DC    H'148'
@CH00531 DC    H'183'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    0F
@SA00002 DS    0F
         DS    15F
@TF00001 DS    F
ISDADCS1 CSECT
         DS    0F
@CF00541 DC    F'999999'
@CF00543 DC    F'9999999'
@CF00508 DC    F'1073700000'
@CF00573 DC    F'-1'
@CF00516 DC    XL4'F0'
@DATD    DSECT
         DS    0D
GET0NEXT DS    A
RETCODE  DS    H
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDADCS1 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00144 DC    V(ISDAFREE)
@CV00145 DC    V(ISDAGET0)
@CV00223 DC    V(ISDAPRT0)
         DS    0D
GETWORK  DS    FL4
         ORG   GETWORK
@NM00010 DC    AL1(1)
@NM00011 DC    AL3(2048)
         ORG   GETWORK+4
@CC00519 DC    C'(CONTINUED)'
@CC00534 DC    C'OVERFLOW  '
@CC00537 DC    C'LOAD CHECK'
@CC00539 DC    C'THRESHOLD '
@CC00544 DC    C'*******'
@CC00542 EQU   @CC00544
@CC00557 DC    C'DCS '
@CC00562 DC    C'YES'
@CC00524 EQU   @CC00544
PATCH    DS    CL50
         ORG   PATCH
@NM00003 DC    50X'00'
         ORG   PATCH+50
LINE4    DS    CL128
         ORG   LINE4
@NM00013 DC    CL1'1'
@NM00014 DC    CL40'REPORT 16 - DATA CARTRIDGE STATISTICS   '
@NM00015 DC    CL27'OPTIONS: CSN(123 56789ABC),'
@NM00016 DC    CL25'RATIO(00),SUMMARY(NO )   '
@NM00017 DC    CL35'DATA FROM MSS FORMAT 4, SA FORMAT D'
         ORG   LINE4+128
LINE7SN  DS    CL125
         ORG   LINE7SN
@NM00018 DC    CL1'0'
@NM00019 DC    CL31'CARTRIDGE                      '
@NM00020 DC    CL45'                        STRIPES READ         '
@NM00021 DC    CL48'STRIPES WRITTEN       DRD   MSC PATH TO   REASON'
         ORG   LINE7SN+125
LINE8SN  DS    CL125
         ORG   LINE8SN
@NM00022 DC    CL1' '
@NM00023 DC    CL31'SERIAL NUMBER                  '
@NM00024 DC    CL45'DATE    TIME            ERRORS/USAGE=RATIO   '
@NM00025 DC    CL48'ERRORS/USAGE=RATIO    SSID   SA/DRC/DRD   LOGGED'
         ORG   LINE8SN+125
LINE7SY  DS    CL102
         ORG   LINE7SY
@NM00026 DC    CL1'0'
@NM00027 DC    CL38'CARTRIDGE                             '
@NM00028 DC    CL37'                 TOTAL STRIPES READ  '
@NM00029 DC    CL26'TOTAL STRIPES WRITE  TOTAL'
         ORG   LINE7SY+102
LINE8SY  DS    CL115
         ORG   LINE8SY
@NM00030 DC    CL1' '
@NM00031 DC    CL38'SERIAL NUMBER        FROM DATE TIME   '
@NM00032 DC    CL37'TO DATE TIME     ERRORS/USAGE=RATIO  '
@NM00033 DC    CL39'ERRORS/USAGE=RATIO   ERRORS/USAGE=RATIO'
         ORG   LINE8SY+115
MSGNONE  DS    CL95
         ORG   MSGNONE
@NM00034 DC    CL1'0'
@NM00035 DC    CL45'THE SPECIFIED RATIO OPTION EXCEEDS THE HIGHES'
@NM00036 DC    CL42'T DATA CARTRIDGE ''TOTAL ERROR/USAGE RATIO'''
@NM00037 DC    CL7' OF .00'
         ORG   MSGNONE+95
TOTALE   DC    CL14'TOTAL ERRORS ='
TOTALU   DC    CL13'TOTAL USAGE ='
SUBTOT   DC    CL10'SUBTOTALS:'
TOTALR   DC    CL9'RATIO = .'
DRDS     DS    CL52
         ORG   DRDS
@NM00040 DC    CL1'0'
@NM00041 DC    CL35'DRDS IN ''HIGHEST ERROR/USAGE=RATIO '
@NM00042 DC    CL16'FIRST'' SEQUENCE:'
         ORG   DRDS+52
DRDSZERO DC    CL20' ALL RATIOS ARE ZERO'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
TOTX2    EQU   @04
TOTX1    EQU   @03
SORTX    EQU   @06
I        EQU   @07
WORKX2   EQU   @07
WORKX1   EQU   @05
WORKVAR  EQU   @06
GET0INDX EQU   @05
GET0PTR  EQU   @08
LPARMPTR EQU   @03
CVTPTR   EQU   @02
R1       EQU   @01
R15      EQU   @15
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
PARMPTR  EQU   CVTPTRS0+8
DCS00PTR EQU   CVTPTRS0+40
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
GET0HDR1 EQU   28
RATIO    EQU   GET0HDR1
SUM      EQU   GET0HDR1+2
SER      EQU   GET0HDR1+4
GET0PSV  EQU   GET0HDR1+20
GET0XSV  EQU   GET0HDR1+24
DCSENTRY EQU   0
CHAINPTR EQU   DCSENTRY
DATIME   EQU   DCSENTRY+4
ADATE    EQU   DATIME
ATIME    EQU   DATIME+4
SNS4D    EQU   DCSENTRY+12
SNS1A2   EQU   SNS4D
SNSSID   EQU   SNS1A2
SNS9A10  EQU   SNS4D+2
SNS12T31 EQU   SNS4D+4
SNSRDUC  EQU   SNS12T31
SNSRDCK  EQU   SNS12T31+2
SNSBYT14 EQU   SNSRDCK
SNSWRUC  EQU   SNS12T31+4
SNSWRCK  EQU   SNS12T31+6
SNSBYT20 EQU   SNS12T31+8
SNSFORCE EQU   SNSBYT20
SNSLDCHK EQU   SNSBYT20
SNSCSN   EQU   SNS12T31+9
SNSRDRAT EQU   DCSENTRY+40
SNSWRAT  EQU   DCSENTRY+41
ISDAGHDR EQU   0
STARTPTR EQU   ISDAGHDR
GET0SPLN EQU   ISDAGHDR+8
GET0LEN  EQU   GET0SPLN+1
NEXTPTR  EQU   ISDAGHDR+12
LASTPTR  EQU   ISDAGHDR+16
BLOCKID  EQU   ISDAGHDR+20
BLOCKCNT EQU   ISDAGHDR+24
TOTALS   EQU   0
TOTCHAIN EQU   TOTALS
OLDEST   EQU   TOTALS+4
NEWEST   EQU   TOTALS+8
TOTRDUC  EQU   TOTALS+12
TOTRDCK  EQU   TOTALS+16
TOTWRUC  EQU   TOTALS+20
TOTWRCK  EQU   TOTALS+24
DCSN     EQU   TOTALS+28
TOTALUSE EQU   TOTALS+40
TOTALERR EQU   TOTALS+44
@NM00092 EQU   TOTALS+48
RDRATIO  EQU   @NM00092
WRATIO   EQU   @NM00092+1
TOTRATIO EQU   @NM00092+2
TOTNUM   EQU   @NM00092+3
SSIDX    EQU   0
SSIDR    EQU   SSIDX
WORKAREA EQU   64
CVDOUT   EQU   WORKAREA
UNPKIN   EQU   CVDOUT+4
CVDIN    EQU   WORKAREA+8
CVDIN3   EQU   CVDIN+1
CVDIN2   EQU   CVDIN3+1
CVDIN1   EQU   CVDIN2+1
TOTSTART EQU   WORKAREA+12
OLDATE   EQU   WORKAREA+16
LINECNT  EQU   WORKAREA+20
TOTSW    EQU   WORKAREA+21
UNPKOUT  EQU   WORKAREA+25
WORKPTR  EQU   0
@NM00038 EQU   OUTLINE
WORSTRAT EQU   @NM00038+93
@NM00043 EQU   OUTLINE
HEADSER  EQU   @NM00043+54
HEADRAT  EQU   @NM00043+74
HEADSUM  EQU   @NM00043+86
@NM00047 EQU   OUTLINE
LINSER   EQU   @NM00047+1
LINECONT EQU   @NM00047+15
LINDATE  EQU   @NM00047+32
LINTIME  EQU   @NM00047+40
LINER1   EQU   @NM00047+56
LINEU1   EQU   @NM00047+63
LINEP1   EQU   @NM00047+70
LINER2   EQU   @NM00047+77
LINEU2   EQU   @NM00047+84
LINEP2   EQU   @NM00047+91
LINESSID EQU   @NM00047+99
LINESA   EQU   @NM00047+106
LINEDRC  EQU   @NM00047+110
LINEDRD  EQU   @NM00047+114
LINEREAS EQU   @NM00047+119
@NM00063 EQU   OUTLINE
TOTALE1  EQU   @NM00063+5
TOTALE2  EQU   @NM00063+19
@NM00065 EQU   OUTLINE
TOTALU1  EQU   @NM00065+5
TOTALU2  EQU   @NM00065+18
SUBTOT1  EQU   @NM00065+44
SUBTE1   EQU   @NM00065+55
SUBTU1   EQU   @NM00065+62
SUBTP1   EQU   @NM00065+70
SUBTE2   EQU   @NM00065+76
SUBTU2   EQU   @NM00065+83
SUBTP2   EQU   @NM00065+91
@NM00074 EQU   OUTLINE
TOTALR1  EQU   @NM00074+5
TOTALR2  EQU   @NM00074+14
@NM00076 EQU   OUTLINE
SLINSER  EQU   @NM00076+1
SLINDATF EQU   @NM00076+22
SLINTIMF EQU   @NM00076+29
SLINDATO EQU   @NM00076+39
SLINTIMT EQU   @NM00076+46
SLINER1  EQU   @NM00076+55
SLINEU1  EQU   @NM00076+62
SLINEP1  EQU   @NM00076+70
SLINER2  EQU   @NM00076+75
SLINEU2  EQU   @NM00076+82
SLINEP2  EQU   @NM00076+90
SLINER3  EQU   @NM00076+96
SLINEU3  EQU   @NM00076+103
SLINEP3  EQU   @NM00076+112
@NM00091 EQU   OUTLINE
DRDS2    EQU   @NM00091+52
DRDS3    EQU   OUTLINE+52
*                                      START UNREFERENCED COMPONENTS
DRDS1    EQU   @NM00091
@NM00090 EQU   @NM00076+110
@NM00089 EQU   @NM00076+102
@NM00088 EQU   @NM00076+93
@NM00087 EQU   @NM00076+88
@NM00086 EQU   @NM00076+81
@NM00085 EQU   @NM00076+73
@NM00084 EQU   @NM00076+68
@NM00083 EQU   @NM00076+61
@NM00082 EQU   @NM00076+54
@NM00081 EQU   @NM00076+45
@NM00080 EQU   @NM00076+37
@NM00079 EQU   @NM00076+28
@NM00078 EQU   @NM00076+13
@NM00077 EQU   @NM00076
@NM00075 EQU   @NM00074
@NM00073 EQU   @NM00065+89
@NM00072 EQU   @NM00065+82
@NM00071 EQU   @NM00065+73
@NM00070 EQU   @NM00065+68
@NM00069 EQU   @NM00065+61
@NM00068 EQU   @NM00065+54
@NM00067 EQU   @NM00065+25
@NM00066 EQU   @NM00065
@NM00064 EQU   @NM00063
@NM00062 EQU   @NM00047+115
@NM00061 EQU   @NM00047+111
@NM00060 EQU   @NM00047+107
@NM00059 EQU   @NM00047+102
@NM00058 EQU   @NM00047+94
@NM00057 EQU   @NM00047+89
@NM00056 EQU   @NM00047+82
@NM00055 EQU   @NM00047+73
@NM00054 EQU   @NM00047+68
@NM00053 EQU   @NM00047+61
@NM00052 EQU   @NM00047+48
@NM00051 EQU   @NM00047+38
@NM00050 EQU   @NM00047+26
@NM00049 EQU   @NM00047+13
@NM00048 EQU   @NM00047
@NM00046 EQU   @NM00043+76
@NM00045 EQU   @NM00043+66
@NM00044 EQU   @NM00043
@NM00039 EQU   @NM00038
@NM00097 EQU   WORKAREA+22
@NM00096 EQU   CVDIN2
@NM00095 EQU   CVDIN3
@NM00094 EQU   CVDIN
@NM00093 EQU   CVDOUT
@NM00012 EQU   ISDAGHDR+26
GET0SPNO EQU   GET0SPLN
ENDPTR   EQU   ISDAGHDR+4
@NM00009 EQU   DCSENTRY+42
@NM00008 EQU   SNS4D+25
SNSAVAL4 EQU   SNSBYT20
OFLOWRCK EQU   SNSWRCK
@NM00007 EQU   SNSWRCK
OFLOWRUC EQU   SNSWRUC
OFLORDCK EQU   SNSBYT14
@NM00006 EQU   SNSBYT14
OFLORDUC EQU   SNSRDUC
SNSADDR  EQU   SNS9A10
SNSBYT9  EQU   SNS9A10
SNSBYT1  EQU   SNS1A2
@NM00005 EQU   GET0HDR1+18
RETCDSV  EQU   GET0HDR1+16
@NM00004 EQU   GET0HDR1+3
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CDHEDHU  EQU   CREPORTS+3
CSUM     EQU   CREPORTS+2
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
LINE     EQU   OUTLINE+1
ANSI     EQU   OUTLINE
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
CORELEN  EQU   SPNOLEN+1
SPNO     EQU   SPNOLEN
GEN00PTR EQU   CVTPTRS0+92
CNFG0PTR EQU   CVTPTRS0+88
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDA00PTR EQU   CVTPTRS0+12
SDATAPTR EQU   CVTPTRS0+4
DATAPTR  EQU   CVTPTRS0
*                                      END UNREFERENCED COMPONENTS
@RC00098 EQU   @RC00086
@RC00410 EQU   @RC00405
@RC00641 EQU   @EL00003
@ENDDATA EQU   *
         END   ISDADCS1,(C'PLS0109',0603,75313)

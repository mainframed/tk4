         TITLE 'CONFIGURATION INPUT ROUTINE                            *
                        '
ISDACNFG CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                          01S0001
         DC    C'ISDACNFG  78.157'                              01S0001
ISDACNF1 DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL2(@EP00321-ISDACNF1)
         ENTRY ISDACNF1
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @15,@01,16(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         AH    @15,4(,@15)                                      01S0001
         BR    @15                                              01S0001
@EP00001 MVC   @PC00001(4),0(@01)                               01S0001
*/* %SDACVTL='LENGTH(ISDACVT)'                               @Y30LB55*/
*/*   DCL CVTPTR PTR(31)  AND SET CVTPTR=WORKPTR             @Y30LB55*/
*                                                               01S0017
*                                                               01S0017
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN SEGMENT OF THE MODULE. IN OPERATION, IT      */
*   /* LOCATES COMMAND WORDS IN THE INPUT RECORDS AND PASSES CONTROL */
*   /* THROUGH A SET OF SUBSEGMENTS TO PROCESS THE DATA. WHEN THE END*/
*   /* OF THE INPUT FILE IS REACHED, A FINAL SET OF CONFIGURATION    */
*   /* TABLES ARE BUILT FROM THE DATA EXTRACTED FROM THE INPUT.      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0017
*   TCNFGFXD=TCNFGFXD&&TCNFGFXD;    /* CLEAR TEMP CNFG AREA  @Y30LB52*/
         XC    TCNFGFXD(14),TCNFGFXD                            01S0017
*   TLTPLIBC='FF'X;                 /* INIT FIRST LTP BYTE   @Y30LB52*/
         XC    TLTPLIBC+1(31),TLTPLIBC+1                        01S0018
         MVI   TLTPLIBC,X'FF'                                   01S0018
*   MVC(TLTPLIBC(2:LENGTH(TLTPLIBC)),TLTPLIBC(1:LENGTH(TLTPLIBC)-1));
         MVC   TLTPLIBC+1(31),TLTPLIBC                          01S0019
*                                   /* INIT REMAINDER        @Y30LB52*/
*   TCPUID(2)='FFFFFFFFFF'X;        /* INITIALIZE END OF LIST@Y30LB52*/
         MVC   TCPUID+12(5),@CB00249                            01S0020
*   TCPUID(1)='0000000000'X;        /* INITIALIZE BEG OF LIST@Y30LB52*/
         MVC   TCPUID(5),@CB00251                               01S0021
*   TFPTR(1)=2;                     /* INIT CHAIN            @Y30LB52*/
         MVI   TFPTR,X'02'                                      01S0022
*   CNFGFLAG='00'X;                 /* INITIALIZE THE FLAGS  @Y30LB52*/
         MVI   CNFGFLAG,X'00'                                   01S0023
*   LINEND=ADDR(ILINE(72));         /* INIT END OF SCAN      @Y30LB52*/
         LA    LINEND,ILINE+71                                  01S0024
*   LCPTR=ADDR(ILINE);              /* INIT LINE PTR         @Y30LB52*/
         LA    LCPTR,ILINE                                      01S0025
*   J=0;                            /* SET J FOR REG ASSIGNMENT 01S0026
*                                                            @Y30LB52*/
         SLR   J,J                                              01S0026
*                                                               02S0027
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT ATTEMPTS TO OPEN THE 'SDACONFG' DATA SET         */
*   /* CONTAINING THE 'TABLE CREATE' CONTROL STATEMENTS. IF          */
*   /* UNSUCCESSFUL, IT WILL RETURN AN ERROR CODE. THE FOLLOWING IS A*/
*   /* DATA CONTROL BLOCK FOR THE DATA SET.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0027
*   GENERATE DATA DEFS(SYSINDCB);                               02S0027
*   GENERATE DATA DEFS(DUMMYDCB);                               02S0028
*   DCL                                                         02S0029
*     DUMMYDCB CHAR(96) STATIC LOCAL GEND,/* STATIC DCB      @Y30LB52*/
*     SYSINDCB CHAR(96) AUTOMATIC GEND,/* REAL DCB           @Y30LB52*/
*     OFLAGS BIT(8) GEND;           /* OPEN FLAGS            @Y30LB52*/
*   DCL                                                         02S0030
*     1 OPENLIST FIXED(31),         /* OPEN PARMLIST         @Y30LB52*/
*      2 OPENEOL CHAR(1),           /* OPTION BYTE           @Y30LB52*/
*      2 * CHAR(3);                 /* ADDRESS OF DCB        @Y30LB52*/
*                                                               02S0030
*   /*****************************************************************/
*   /*                                                               */
*   /* OPEN THE DCB                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0031
*   SYSINDCB=DUMMYDCB;              /* STATIC DCB TO REAL    @Y30LB52*/
         MVC   SYSINDCB(96),DUMMYDCB                            02S0031
*   OPENEOL='80'X;                  /* SET END OF OPEN LIST  @Y30LB52*/
         MVI   OPENEOL,X'80'                                    02S0032
*   GEN(OPEN (SYSINDCB,INPUT),MF=(E,OPENLIST));/* OPEN THE DCB  02S0033
*                                                            @Y30LB52*/
         OPEN (SYSINDCB,INPUT),MF=(E,OPENLIST)
*   IF OFLAGS(4)=OFF THEN           /* DID NOT OPEN          @Y30LB52*/
         TM    OFLAGS,B'00010000'                               02S0034
         BNZ   @RF00034                                         02S0034
*     RETURN CODE(NOINPUT);         /* RETURN ERROR          @Y30LB52*/
         L     @13,4(,@13)                                      02S0035
         L     @00,@SIZDATD                                     02S0035
         LR    @01,@11                                          02S0035
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,36                                           02S0035
         L     @14,12(,@13)                                     02S0035
         LM    @00,@12,20(@13)                                  02S0035
         BR    @14                                              02S0035
*   CALL READRCRD;                  /* READ FIRST RECORD     @Y30LB52*/
*                                                               01S0036
@RF00034 BAL   @14,READRCRD                                     01S0036
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SECTION OF INCLUDED CODE READS THE 'TABLE       */
*   /* CREATE' INPUT RECORDS AND RETAINS THE CONFIGURATION DATA      */
*   /* TEMPORARILY UNTIL END OF FILE.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0037
*                                                               02S0037
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT OF CODE READS THE 'TABLE CREATE' RECORDS,        */
*   /* DETERMINES COMMAND TYPE, AND PASSES CONTROL THROUGH THE       */
*   /* CORRECT COMMAND STATEMENT PROCESSOR. AN ERROR CODE IS RETURNED*/
*   /* IF THE COMMAND TYPE IS NOT RECOGNIZED.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0037
*   DO WHILE(EOF=OFF);              /* LOOP THRO ALL RECORDS @Y30LB52*/
*                                                               02S0037
         B     @DE00037                                         02S0037
@DL00037 DS    0H                                               02S0038
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR LABEL                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0038
*     IF LINECHAR(1)^=' ' THEN      /* IF LABEL NON-BLANK    @Y30LB52*/
         CLI   LINECHAR(LCPTR),C' '                             02S0038
         BE    @RF00038                                         02S0038
*       DO;                         /* SKIP THE LABEL        @Y30LB52*/
*         CALL NEXTBLNK;            /* SKIP TO NEXT BLANK    @Y30LB52*/
         BAL   @14,NEXTBLNK                                     02S0040
*       END;                        /*                       @Y30LB52*/
*     CALL NEXTCHAR;                /* SKIP TO COMMAND WORD  @Y30LB52*/
@RF00038 BAL   @14,NEXTCHAR                                     02S0042
*     FIND=OFF;                     /* LABEL/COMMAND NOT FIND@OZ28372*/
*                                                               02S0043
         NI    FIND,B'11111011'                                 02S0043
*     /***************************************************************/
*     /*                                                             */
*     /* LOOP THROUGH THE COMMAND WORD TABLE LOOKING FOR THE COMMAND */
*     /* WORD ENCOUNTERED                                            */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0044
*     DO I=1 TO 10 WHILE(LINECHAR(1:3)^=CMNDWORD(I));/* COMPARE FIRST
*                                      THREE CHARACTERS      @Y30LB52*/
         LA    I,1                                              02S0044
@DL00044 LR    @10,I                                            02S0044
         MH    @10,@CH00063                                     02S0044
         LA    @07,CMNDWORD-3(@10)                              02S0044
         CLC   LINECHAR(3,LCPTR),0(@07)                         02S0044
         BE    @DC00044                                         02S0044
*     END;                          /*                       @Y30LB52*/
*                                                               02S0045
         AH    I,@CH00060                                       02S0045
         CH    I,@CH00266                                       02S0045
         BNH   @DL00044                                         02S0045
@DC00044 DS    0H                                               02S0046
*     /***************************************************************/
*     /*                                                             */
*     /* DO THE CODE SUBSEGMENT FOR THE COMMAND WORD FOUND.          */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0046
*     IF I<10 THEN                                              02S0046
         CH    I,@CH00266                                       02S0046
         BNL   @RF00046                                         02S0046
*       DO;                         /* VALID COMMAND FOUND   @Y30LB52*/
*         RETCOD=0;                 /* SET FOR NO ERROR      @OZ28372*/
         SLR   @10,@10                                          02S0048
         ST    @10,RETCOD                                       02S0048
*         DO;                       /* CASE(I)NAMES(CPUCONFG,MSFN,LOW
*                                      ERCON,UPPERCON,DASD,SKIPCMND,S
*                                      KIPCMND,SKIPCMND,SKIPCMND)    */
*           DCL                                                 02S0050
*             CL0001@ LABEL BASED(CP0001@(I)) VALUERANGE(CPUCONFG,MSFN,
*                 LOWERCON,UPPERCON,DASD,SKIPCMND,SKIPCMND,SKIPCMND,
*                 SKIPCMND);        /* BRANCH TARGET                 */
*           DCL                                                 02S0051
*             CP0001@(9) PTR(31) INIT(ADDR(CPUCONFG),ADDR(MSFN),ADDR(
*                 LOWERCON),ADDR(UPPERCON),ADDR(DASD),ADDR(SKIPCMND),
*                 ADDR(SKIPCMND),ADDR(SKIPCMND),ADDR(SKIPCMND));
*           GOTO CL0001@;           /* BRANCH TO SELECTED CASE  02S0052
*                                                            @Y30LB52*/
         LR    @10,I                                            02S0052
         SLA   @10,2                                            02S0052
         L     @10,CP0001@-4(@10)                               02S0052
         BR    @10                                              02S0052
*CPUCONFG:                                                      02S0053
*           DO;                     /* SUBCASE               @Y30LB52*/
CPUCONFG DS    0H                                               02S0054
*                                                               03S0054
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SEGMENT PROCESSES THE CPUCONFG CONTROL         */
*             /* STATEMENTS IN THE TABLE CREATE DECK INPUT. ON ENTRY,*/
*             /* THE BASE POINTER IN THE INPUT RECORD IS SET TO THE  */
*             /* FIRST POSITION. FOUR SEGMENTS ARE CALLED IN THE SCAN*/
*             /* PROCESS: NEXTBLNK(FOR THE NEXT BLANK CHARACTER IN   */
*             /* THE INPUT), NEXTCHAR(FOR THE NEXT CHARACTER),       */
*             /* NEXTCMMA(FOR THE NEXT COMMA), AND HEXBYTES(CONVERT  */
*             /* EBCDIC STRING TO HEX). THE CPUID KEYWORD IS LOCATED */
*             /* AND THE CPU COUNT UPDATED AND THE CPUID SAVED. IF   */
*             /* THE KEYWORD IS NOT FOUND BEFORE THE END OF THE      */
*             /* CONTROL STATEMENT, NOTHING IS RECORDED. STEP OVER   */
*             /* THE COMMAND WORD AND ANY FOLLOWING BLANKS TO THE    */
*             /* FIRST OPERAND.                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0054
*             CALL NEXTBLNK;        /* LOCATE NEXT BLANK CHARACTER
*                                                            @Y30LB52*/
         BAL   @14,NEXTBLNK                                     03S0054
*             CALL NEXTCHAR;        /* LOCATE NEXT NON-BLANK @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0055
*             FIND=OFF;             /* NOT VALID FIND        @OZ28372*/
*                                                               03S0056
         NI    FIND,B'11111011'                                 03S0056
*             /*******************************************************/
*             /*                                                     */
*             /* LOCATE THE 'CPUID=' KEYWORD IN THE OPERAND STRING   */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0057
*             DO WHILE(LINECHAR(1:5)^='CPUID'&EOC=OFF);/* SCAN FOR
*                                      CPUID KEYWORD         @Y30LB52*/
         B     @DE00057                                         03S0057
@DL00057 DS    0H                                               03S0058
*               CALL NEXTCMMA;      /* NEXT COMMA IN STREAM  @Y30LB52*/
         BAL   @14,NEXTCMMA                                     03S0058
*               CALL NEXTCHAR;      /* NEXT CHARACTER        @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0059
*             END;                  /*                       @Y30LB52*/
*                                                               03S0060
@DE00057 CLC   LINECHAR(5,LCPTR),@CC00276                       03S0060
         BE    @DC00057                                         03S0060
         TM    EOC,B'10000000'                                  03S0060
         BZ    @DL00057                                         03S0060
@DC00057 DS    0H                                               03S0061
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE 'CPUID' KEYWORD WAS FOUND, CONVERT THE EBCDIC*/
*             /* OPERAND VALUE TO HEXADECIMAL AND STORE IN THE       */
*             /* TEMPORARY CPUID TABLE                               */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0061
*             IF EOC=OFF THEN                                   03S0061
         TM    EOC,B'10000000'                                  03S0061
         BNZ   @RF00061                                         03S0061
*               DO;                 /* CPUID KEYWORD FOUND   @Y30LB52*/
*                 LCPTR=LCPTR+6;    /* INCREMENT OVER THE KEYWORD
*                                                            @Y30LB52*/
         AH    LCPTR,@CH00054                                   03S0063
*                 BYTES=10;         /* INDICATE BYTES TO BE CONVERTED
*                                                            @Y30LB52*/
         LA    BYTES,10                                         03S0064
*                 CALL HEXBYTES;    /* CALL BYTE CONVERTER   @Y30LB52*/
         BAL   @14,HEXBYTES                                     03S0065
*                 TCPUNO=TCPUNO+1;  /* INCREMENT CPU TOTAL   @Y30LB52*/
         LA    @10,1                                            03S0066
         AH    @10,TCPUNO                                       03S0066
         STH   @10,TCPUNO                                       03S0066
*                 TCPUSER(TCPUNO)=LINECHAR(1:5);/* STORE ID  @Y30LB52*/
         MH    @10,@CH00056                                     03S0067
         LA    @07,TCPUSER-5(@10)                               03S0067
         MVC   0(5,@07),LINECHAR(LCPTR)                         03S0067
*                 LCPTR=LCPTR+10;   /* BUMP PTR PAST POSSIBLE X'40'S
*                                                            @ZA32464*/
         AH    LCPTR,@CH00266                                   03S0068
*               END;                /*                       @Y30LB52*/
*             GOTO CE0001@;         /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0070
*           END;                    /* END OF SUBCASE        @Y30LB52*/
*MSFN:                                                          02S0072
*           DO;                     /* SUBCASE               @Y30LB52*/
MSFN     DS    0H                                               02S0073
*                                                               03S0073
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SEGMENT PROCESSES THE 'MSFN' CONTROL           */
*             /* STATEMENTS, EXTRACTING THE SIZE OF EACH LIBRARY AND */
*             /* THE TOTAL NUMBER OF LIBRARIES ON THE SUBSYSTEM. THE */
*             /* 'SIZE=' KEYWORD IS LOCATED AND IT'S OPERAND SAVED IN*/
*             /* AN ARRAY. A TOTAL COUNT OF LIBRARIES IS MAINTAINED. */
*             /* THIS SEGMENT CALLS THE SEGMENTS: NEXTBLNK(FOR THE   */
*             /* NEXT BLANK IN THE INPUT ), AND NEXTCMMA(FOR THE NEXT*/
*             /* COMMA IN THE INPUT ). THE LIBRARY NUMBER IS         */
*             /* CONVERTED TO BINARY FOR USE AS AN INDEX             */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0073
*             I=(LINECHAR(4)&'0F'X)+1;/* LOAD MSFNO PLUS ONE @YM32172*/
         LA    I,15                                             03S0073
         SLR   @10,@10                                          03S0073
         IC    @10,LINECHAR+3(,LCPTR)                           03S0073
         NR    I,@10                                            03S0073
         AH    I,@CH00060                                       03S0073
*             IF I>TMSFNO           /* IF MSFNO HIGHER THAN TOTAL
*                                      MSF'S SO FAR          @YM32172*/
*               THEN                                            03S0074
         CH    I,TMSFNO                                         03S0074
         BNH   @RF00074                                         03S0074
*               TMSFNO=I;           /* REPLACE MSFNO TOTAL   @YM32172*/
         STH   I,TMSFNO                                         03S0075
*             CALL NEXTBLNK;        /* PAST 'MSFN'           @Y30LB52*/
@RF00074 BAL   @14,NEXTBLNK                                     03S0076
*             CALL NEXTCHAR;        /* TO KEYWORD            @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0077
*             FIND=OFF;             /* NOT VALID FIND        @OZ28372*/
*                                                               03S0078
         NI    FIND,B'11111011'                                 03S0078
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH FOR THE 'SIZE=' KEYWORD IN THE INPUT         */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0079
*             DO WHILE((LINECHAR(1:3)^='SIZ')&(EOC=OFF));/* SCAN FOR
*                                      SIZ KEYWORD           @Y30LB52*/
         B     @DE00079                                         03S0079
@DL00079 DS    0H                                               03S0080
*               CALL NEXTCMMA;      /* SCAN FOR COMMA        @Y30LB52*/
         BAL   @14,NEXTCMMA                                     03S0080
*               CALL NEXTCHAR;      /* NEXT HEYWORD          @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0081
*             END;                  /*                       @Y30LB52*/
*                                                               03S0082
@DE00079 CLC   LINECHAR(3,LCPTR),@CC00280                       03S0082
         BE    @DC00079                                         03S0082
         TM    EOC,B'10000000'                                  03S0082
         BZ    @DL00079                                         03S0082
@DC00079 DS    0H                                               03S0083
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE SIZE=' WAS LOCATED, SAVE IT                  */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0083
*             IF EOC=OFF THEN                                   03S0083
         TM    EOC,B'10000000'                                  03S0083
         BNZ   @RF00083                                         03S0083
*               DO;                 /* NOT END OF COMMAND, MUST BE
*                                      KEYWORD               @Y30LB52*/
*                 TLIB(I)=LINECHAR(6)&'0F'X;/* TURN OFF ZONE AND
*                                      STORE                 @YM32172*/
         LA    @10,TLIB-1(I)                                    03S0085
         MVC   0(1,@10),LINECHAR+5(LCPTR)                       03S0085
         NI    0(@10),X'0F'                                     03S0085
*               END;                /*                       @Y30LB52*/
*             GOTO CE0001@;         /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0087
*           END;                    /* END OF SUBCASE        @Y30LB52*/
*LOWERCON:                                                      02S0089
*           DO;                     /* SUBCASE               @Y30LB52*/
LOWERCON DS    0H                                               02S0090
*                                                               03S0090
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SEGMENT PROCESSES THE INFORMATION ON THE       */
*             /* 'LOWERCON' CONTROL STATEMENTS. FROM THOSE INPUT     */
*             /* RECORDS, THE RELATIONSHIP OF LOGICAL 'DRC'          */
*             /* CONNECTIONS TO A 'SA' TO PHYSICAL 'DRC' CONNECTIONS */
*             /* IS EXTRACTED AND ENTERED INTO THE 'LCON' TABLE. WHEN*/
*             /* THE END OF THE CONTROL STATEMENT IS REACHED, THE    */
*             /* EQUIVALENCE IS TRANSFERRED IN TO THE PHYSICAL TO    */
*             /* LOGICAL TABLE 'TLTPLIB'. THE SEGMENTS 'NEXTBLNK',   */
*             /* 'NEXTCMMA', 'NEXTCHAR', AND 'HEXBYTES' ARE CALLED TO*/
*             /* PERFORM THE RESPECTIVE FUNCTIONS. THE FOLLOWING DATA*/
*             /* STRUCTURE IS A TEMPORARY REPOSITORY FOR THE DATA    */
*             /* COLLECTED FROM A SINGLE CONTROL STATEMENT. THIS IS  */
*             /* NECESSARY SINCE THE OPERANDS MAY BE ENTERED OUT OF  */
*             /* SEQUENCE OR OMITTED. THE CONTENTS OF THIS STRUCTURE */
*             /* IS FINALLY MERGED INTO THE FINAL STRUCTURE AT       */
*             /* SEGMENT END.                                        */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0090
*             DCL                                               03S0090
*               1 LCON CHAR(9) BDY(WORD),/* LOWER CONNECTION @Y30LB52*/
*                2 LSA FIXED(8),    /* SA NUMBER FOR CONNECTION 03S0090
*                                                            @Y30LB52*/
*                2 LDRC(4) CHAR(2), /* LOGICAL CU'S          @Y30LB52*/
*                 3 MSFNN FIXED(8), /* CS NUMBER FOR DRC     @Y30LB52*/
*                 3 PCU FIXED(8);   /* PHYSICAL DRC          @Y30LB52*/
*                                                               03S0091
*             /*******************************************************/
*             /*                                                     */
*             /* THE TABLE IS INITIALIZED AND THE NEXT CHARACTER     */
*             /* LOCATED                                             */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0091
*             LCON='FF'X;           /* INITIALIZE THE LOWER  @Y30LB52
*                                      CONNECTION WORKAREA   @Y30LB52*/
         XC    LCON+1(8),LCON+1                                 03S0091
         MVI   LCON,X'FF'                                       03S0091
*             CALL NEXTBLNK;        /* NEXT BLANK            @Y30LB52*/
         BAL   @14,NEXTBLNK                                     03S0092
*             CALL NEXTCHAR;        /* NEXT CHARACTER        @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0093
*             FIND=OFF;             /* NOT VALID FIND        @OZ28372*/
*                                                               03S0094
         NI    FIND,B'11111011'                                 03S0094
*             /*******************************************************/
*             /*                                                     */
*             /* LOOP THROUGH ALL KEYWORD OPERANDS IN THE CONTROL    */
*             /* STATEMENT                                           */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0095
*             DO WHILE(EOC=OFF);    /* LOOP THROUGH ENTIRE COMMAND
*                                                            @Y30LB52*/
*                                                               03S0095
         B     @DE00095                                         03S0095
@DL00095 DS    0H                                               03S0096
*               /*****************************************************/
*               /*                                                   */
*               /* IF 'SA=' KEYWORD                                  */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0096
*               IF LINECHAR(1:2)='SA' THEN                      03S0096
         CLC   LINECHAR(2,LCPTR),@CC00287                       03S0096
         BNE   @RF00096                                         03S0096
*                 DO;               /*                       @Y30LB52*/
*                                                               03S0097
*                   /*************************************************/
*                   /*                                               */
*                   /* CONVERT TO BINARY AND STORE                   */
*                   /*                                               */
*                   /*************************************************/
*                                                               03S0098
*                   LCPTR=LCPTR+3;  /* SPACE OVER 'SA='      @Y30LB52*/
         AH    LCPTR,@CH00063                                   03S0098
*                   IF(LINECHAR(2)^=',')&(LINECHAR(2)^=' ') THEN
         CLI   LINECHAR+1(LCPTR),C','                           03S0099
         BE    @RF00099                                         03S0099
         CLI   LINECHAR+1(LCPTR),C' '                           03S0099
         BE    @RF00099                                         03S0099
*                     LINECHAR(1)=LINECHAR(2);/* MOVE SA CHARACTER
*                                                            @Y30LB52*/
         MVC   LINECHAR(1,LCPTR),LINECHAR+1(LCPTR)              03S0100
*                   BYTES=1;        /* CONVERT COUNT         @Y30LB52*/
@RF00099 LA    BYTES,1                                          03S0101
*                   CALL HEXBYTES;  /* CONVERT FROM EBCDIC   @Y30LB52*/
         BAL   @14,HEXBYTES                                     03S0102
*                   LSA=LINECHAR(1);/* STORE THE RESULT      @Y30LB52*/
         SLR   @10,@10                                          03S0103
         IC    @10,LINECHAR(,LCPTR)                             03S0103
         STC   @10,LSA                                          03S0103
*                   IF LSA+1>TSANO THEN                         03S0104
         AH    @10,@CH00060                                     03S0104
         CH    @10,TSANO                                        03S0104
         BNH   @RF00104                                         03S0104
*                     TSANO=LSA+1;  /* UPDATE TOTAL SA COUNT @Y30LB52*/
         STH   @10,TSANO                                        03S0105
*                   LSA=LSA*16;     /* SHIFT SA NUMBER       @Y30LB52*/
@RF00104 SLR   @10,@10                                          03S0106
         IC    @10,LSA                                          03S0106
         SLA   @10,4                                            03S0106
         STC   @10,LSA                                          03S0106
*                   LCPTR=LCPTR+1;  /* BUMP PTR PAST POSSIBLE X'40'
*                                                            @ZA32464*/
         AH    LCPTR,@CH00060                                   03S0107
*                 END;              /*                       @Y30LB52*/
*                                                               03S0108
*               /*****************************************************/
*               /*                                                   */
*               /* IF NOT 'SA=', MUST BE 'CUNN='. EXTRACT AND STORE  */
*               /* THE PHYSICAL EQUIVALENT OF LOGICAL 'CUIDNN'.      */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0109
*               ELSE                                            03S0109
*                 DO;               /*                       @Y30LB52*/
         B     @RC00096                                         03S0109
@RF00096 DS    0H                                               03S0110
*                   IF LINECHAR(1:2)='CU' THEN                  03S0110
         CLC   LINECHAR(2,LCPTR),@CC00289                       03S0110
         BNE   @RF00110                                         03S0110
*                     DO;           /* KEYWORD FOUND         @YM32172*/
*                       I=1;        /* INIT LOGICAL DRC      @Y30LB52*/
*                                                               03S0112
         LA    I,1                                              03S0112
*                       /*********************************************/
*                       /*                                           */
*                       /* THE 'NN' OF CUIDNN' IS EXTRACTED          */
*                       /*                                           */
*                       /*********************************************/
*                                                               03S0113
*                       IF LINECHAR(3)='1' THEN                 03S0113
         CLI   LINECHAR+2(LCPTR),C'1'                           03S0113
         BNE   @RF00113                                         03S0113
*                         I=I+2;    /* TWO'S BIT             @YM32172*/
         AH    I,@CH00045                                       03S0114
*                       IF LINECHAR(4)='1' THEN                 03S0115
@RF00113 CLI   LINECHAR+3(LCPTR),C'1'                           03S0115
         BNE   @RF00115                                         03S0115
*                         I=I+1;    /* ONE'S BIT             @YM32172*/
*                                                               03S0116
         AH    I,@CH00060                                       03S0116
*                       /*********************************************/
*                       /*                                           */
*                       /* SAVE THE LIBRARY NUMBER                   */
*                       /*                                           */
*                       /*********************************************/
*                                                               03S0117
*                       MSFNN(I)=LINECHAR(9)&'0F'X;/* TURN OFF THE
*                                      ZONE AND STORE        @YM32172*/
@RF00115 LR    @10,I                                            03S0117
         ALR   @10,@10                                          03S0117
         LA    @07,15                                           03S0117
         SLR   @04,@04                                          03S0117
         IC    @04,LINECHAR+8(,LCPTR)                           03S0117
         NR    @07,@04                                          03S0117
         STC   @07,MSFNN-2(@10)                                 03S0117
*                       CALL NEXTCMMA;/* TO NEXT COMMA       @Y30LB52*/
         BAL   @14,NEXTCMMA                                     03S0118
*                       CALL NEXTCHAR;/* TO 'DRC ' KEYWORD   @Y30LB52*/
*                                                               03S0119
         BAL   @14,NEXTCHAR                                     03S0119
*                       /*********************************************/
*                       /*                                           */
*                       /* SET THE PHYSICAL 'DRC' FROM THE 'BASERW'  */
*                       /* KEYWORD                                   */
*                       /*                                           */
*                       /*********************************************/
*                                                               03S0120
*                       IF LINECHAR(1:3)='DRC' THEN             03S0120
         CLC   LINECHAR(3,LCPTR),@CC00291                       03S0120
         BNE   @RF00120                                         03S0120
*                         PCU(I)=(LINECHAR(4)&'0F'X)+1;/* ZONES OFF
*                                      AND STORE             @Y30LB52*/
         LR    @10,I                                            03S0121
         ALR   @10,@10                                          03S0121
         LA    @07,15                                           03S0121
         SLR   @04,@04                                          03S0121
         IC    @04,LINECHAR+3(,LCPTR)                           03S0121
         NR    @07,@04                                          03S0121
         AH    @07,@CH00060                                     03S0121
         STC   @07,PCU-2(@10)                                   03S0121
*                     END;          /*                       @Y30LB52*/
@RF00120 DS    0H                                               03S0123
*                 END;              /*                       @Y30LB52*/
*                                                               03S0123
@RF00110 DS    0H                                               03S0124
*               /*****************************************************/
*               /*                                                   */
*               /* STEP PAST THE NEXT COMMA TO THE NEXT KEYWORD      */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0124
*               CALL NEXTCMMA;      /* NEXT COMMA            @Y30LB52*/
@RC00096 BAL   @14,NEXTCMMA                                     03S0124
*               CALL NEXTCHAR;      /* NEXT CHARACTER        @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0125
*             END;                  /*                       @Y30LB52*/
@DE00095 TM    EOC,B'10000000'                                  03S0126
         BZ    @DL00095                                         03S0126
*                                                               03S0127
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SUBSEGMENT OF THE SEGMENT 'LOWERCON COMPLETES  */
*             /* THE PROCESSING OF THE 'LOWERCON' CONTROL STATEMENT  */
*             /* BY INSERTING THE LOGICAL VALUES OF PHYSICAL         */
*             /* CONNECTIONS INTO A TABLE. AT THIS POINT, THE ENTIRE */
*             /* CONTROL STATEMENT HAS BEEN CONDENSED INTO THE 'LCON'*/
*             /* DATA STRUCTURE. THE FOLLOWING CODE TRANSFERS THE    */
*             /* LOGICAL - PHYSICAL EQUIVALENTS TO THE 'TLTPLIB'     */
*             /* TABLES.                                             */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0127
*             DO I=1 TO 4;          /* LOOP THROUGH ALL LDRC'S  03S0127
*                                                            @Y30LB52*/
*                                                               03S0127
         LA    I,1                                              03S0127
@DL00127 DS    0H                                               03S0128
*               /*****************************************************/
*               /*                                                   */
*               /* THE 'TLTPLIB' TABLE ADDRESSED IS DETERMINED BY THE*/
*               /* PHYSICAL LIBRARY CONTAINING THE PHYSICAL 'DRC'    */
*               /* CORRESPONDING TO THE LOGICAL 'DRC' CONNECTION IN  */
*               /* EACH ITERATION OF THE LOOP                        */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0128
*               LTPDRDP=ADDR(TLTPLIB(MSFNN(I)+1));/* ADDR OF LTP
*                                                            @Y30LB52*/
*                                                               03S0128
         LR    @10,I                                            03S0128
         ALR   @10,@10                                          03S0128
         SLR   @07,@07                                          03S0128
         IC    @07,MSFNN-2(@10)                                 03S0128
         LR    LTPDRDP,@07                                      03S0128
         SLA   LTPDRDP,3                                        03S0128
         LA    LTPDRDP,TLTPLIB(LTPDRDP)                         03S0128
*               /*****************************************************/
*               /*                                                   */
*               /* IF A LOGICAL CONNECTION IS BEING USED, INSERT IN  */
*               /* THE CORRESPONDING PHYSICAL TABLE.                 */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0129
*               IF LSA^='FF'X THEN                              03S0129
         CLI   LSA,255                                          03S0129
         BE    @RF00129                                         03S0129
*                 DO;               /* SKIP THE UNUSED       @Y30LB52*/
*                   IF MSFNN(I)^=0×PCU(I)^=0 THEN/* IF EITHER IS NON
*                                                            @OZ28372*/
         SLR   @15,@15                                          03S0131
         CR    @07,@15                                          03S0131
         BNE   @RT00131                                         03S0131
         SLR   @07,@07                                          03S0131
         IC    @07,PCU-2(@10)                                   03S0131
         CR    @15,@07                                          03S0131
         BE    @RF00131                                         03S0131
@RT00131 DS    0H                                               03S0132
*                     DO;           /* ZERO, THEN SAVE       @OZ28372*/
*                                                               03S0132
*                       /*********************************************/
*                       /*                                           */
*                       /* THE 'SA' AND LOGICAL 'DRC' ARE STORED IN  */
*                       /* ONE BYTE OF THE PHYSICAL 'DRC' TABLE      */
*                       /*                                           */
*                       /*********************************************/
*                                                               03S0133
*                       IF DRCL0(PCU(I))='FF'X THEN/* IF FIRST FIND
*                                                            @OZ28372*/
         LR    @10,I                                            03S0133
         ALR   @10,@10                                          03S0133
         SLR   @07,@07                                          03S0133
         IC    @07,PCU-2(@10)                                   03S0133
         ALR   @07,@07                                          03S0133
         ST    @07,@TF00001                                     03S0133
         ALR   @07,LTPDRDP                                      03S0133
         BCTR  @07,0                                            03S0133
         BCTR  @07,0                                            03S0133
         CLI   DRCL0(@07),X'FF'                                 03S0133
         BNE   @RF00133                                         03S0133
*                         DRCL0(PCU(I))=LSA+I;/* STORE SA AND DRC
*                                                            @Y30LB52*/
         SLR   @10,@10                                          03S0134
         IC    @10,LSA                                          03S0134
         ALR   @10,I                                            03S0134
         L     @07,@TF00001                                     03S0134
         BCTR  @07,0                                            03S0134
         BCTR  @07,0                                            03S0134
         STC   @10,DRCL0(@07,LTPDRDP)                           03S0134
*                       ELSE                                    03S0135
*                         IF DRCL1(PCU(I))='FF'X THEN/* STORE IN
*                                                            @OZ28372*/
         B     @RC00133                                         03S0135
@RF00133 LR    @10,I                                            03S0135
         ALR   @10,@10                                          03S0135
         SLR   @07,@07                                          03S0135
         IC    @07,PCU-2(@10)                                   03S0135
         ALR   @07,@07                                          03S0135
         ST    @07,@TF00001                                     03S0135
         ALR   @07,LTPDRDP                                      03S0135
         BCTR  @07,0                                            03S0135
         CLI   DRCL1-1(@07),X'FF'                               03S0135
         BNE   @RF00135                                         03S0135
*                           DRCL1(PCU(I))=LSA+I;/* SECOND INTERFACE
*                                                            @OZ28372*/
         SLR   @10,@10                                          03S0136
         IC    @10,LSA                                          03S0136
         ALR   @10,I                                            03S0136
         L     @07,@TF00001                                     03S0136
         BCTR  @07,0                                            03S0136
         STC   @10,DRCL1-1(@07,LTPDRDP)                         03S0136
*                         ELSE      /* IF THIRD, IS ERROR    @OZ28372*/
*                           RETCOD=DATAERR;/* SO SET RETURN CODE
*                                                            @OZ28372*/
         B     @RC00135                                         03S0137
@RF00135 MVC   RETCOD(4),@CF00082                               03S0137
*                     END;          /* END STORE             @OZ28372*/
@RC00135 DS    0H                                               03S0138
@RC00133 DS    0H                                               03S0139
*                 END;              /*                       @Y30LB52*/
@RF00131 DS    0H                                               03S0140
*             END;                  /*                       @Y30LB52*/
@RF00129 AH    I,@CH00060                                       03S0140
         CH    I,@CH00042                                       03S0140
         BNH   @DL00127                                         03S0140
*             GOTO CE0001@;         /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0141
*           END;                    /* END OF SUBCASE        @Y30LB52*/
*UPPERCON:                                                      02S0143
*           DO;                     /* SUBCASE               @Y30LB52*/
UPPERCON DS    0H                                               02S0144
*                                                               03S0144
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SEGMENT EXTRACTS THE CHANNEL/CONTROL UNIT -    */
*             /* STAGING ADAPTER EQUIVALENCES FROM THE 'UPPERCON'    */
*             /* CONTROL STATEMENTS. THE SUBSEGMENTS 'HEXBYTES',     */
*             /* 'NEXTCHAR', AND 'NEXTCMMA' ARE CALLED WITHIN THIS   */
*             /* SEGMENT. THE DATA EXTRACTED IS USED TO CREATE AN    */
*             /* ENTRY IN THE TEMPORARY CPU INTERFACE TABLE          */
*             /* 'TCPUINTF'. THE FOLLOWING TABLE IS A BRANCH TABLE   */
*             /* DIRECTING EXECUTION THROUGH THE CASE LOGIC BASED ON */
*             /* THE KEYWORDS FOUND.                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0144
*             DCL                                               03S0144
*               UCKEYS(6) CHAR(2) INIT('SA','CI','CH','CU','CP','AL');
*                                   /*                       @Y30LB52*/
*                                                               03S0145
*             /*******************************************************/
*             /*                                                     */
*             /* THE FOLLOWING STRUCTURE IS A REPOSITORY OF THE      */
*             /* KEYWORD OPERANDS LOCATED IN A SCAN OF THE CONTROL   */
*             /* STATEMENT. THIS IS NECESSARY SINCE THE KEYWORD      */
*             /* OPERANDS CAN BE IN ANY ORDER.                       */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0145
*             DCL                                               03S0145
*               1 UC CHAR(8),       /* UPPPER CONNECTION STRUCTURE
*                                                            @Y30LB52*/
*                2 UID CHAR(6),     /* CONNECTION ID         @Y30LB52*/
*                 3 UCPUID CHAR(5), /* HOST ID               @Y30LB52*/
*                 3 UCH FIXED(8),   /* CHANNEL ON HOST       @Y30LB52*/
*                2 USA FIXED(8),    /* STAGING ADAPTER       @Y30LB52*/
*                2 UCI CHAR(1);     /* INTERFACE ON THE SA   @Y30LB52*/
*                                                               03S0146
*             /*******************************************************/
*             /*                                                     */
*             /* FIND THE FIRST OPERAND CHARACTER                    */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0146
*             UC=UC&&UC;            /* CLEAR UPPERCON WA     @Y30LB52*/
         XC    UC(8),UC                                         03S0146
*             CALL NEXTBLNK;        /* NEXT BLANK            @Y30LB52*/
         BAL   @14,NEXTBLNK                                     03S0147
*             CALL NEXTCHAR;        /* NEXT CHARACTER        @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0148
*             FIND=OFF;             /* NOT VALID FIND        @OZ28372*/
         NI    FIND,B'11111011'                                 03S0149
*             TINTFNO=TINTFNO+1;    /* TOTAL INTERFACES COUNT@Y30LB52*/
*                                                               03S0150
         LH    @10,TINTFNO                                      03S0150
         LA    @10,1(,@10)                                      03S0150
         STH   @10,TINTFNO                                      03S0150
*             /*******************************************************/
*             /*                                                     */
*             /* THE STATEMENT IS SCANNED TO THE END BEFORE THE      */
*             /* 'TCPUINTF' TABLE IS UPDATED                         */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0151
*             DO WHILE(EOC=OFF);    /* SCAN WHOLE COMMAND    @Y30LB52*/
*                                                               03S0151
         B     @DE00151                                         03S0151
@DL00151 DS    0H                                               03S0152
*               /*****************************************************/
*               /*                                                   */
*               /* SEARCH FOR ONE OF THE KEYWORDS IN THE TABLE(FIRST */
*               /* TWO CHARACTERS).                                  */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0152
*               DO I=1 TO 6 WHILE(LINECHAR(1:2)^=UCKEYS(I));/* SCAN
*                                      FOR KEY               @Y30LB52*/
         LA    I,1                                              03S0152
@DL00152 LR    @10,I                                            03S0152
         ALR   @10,@10                                          03S0152
         LA    @07,UCKEYS-2(@10)                                03S0152
         CLC   LINECHAR(2,LCPTR),0(@07)                         03S0152
         BE    @DC00152                                         03S0152
*               END;                /*                       @Y30LB52*/
*                                                               03S0153
         AH    I,@CH00060                                       03S0153
         CH    I,@CH00054                                       03S0153
         BNH   @DL00152                                         03S0153
@DC00152 DS    0H                                               03S0154
*               /*****************************************************/
*               /*                                                   */
*               /* SUBCASE SUBSEGMENTS ARE PROVIDED FOR EACH KEYWORD */
*               /* POSSIBLE                                          */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0154
*                                                               04S0154
*               /*****************************************************/
*               /*                                                   */
*               /* THIS SEGMENT CONTAINS ONE SUBSEGMENT OF CODE TO   */
*               /* PROCESS THE KEYWORDS OF THE 'UPPERCON' COMMAND.   */
*               /*                                                   */
*               /*****************************************************/
*                                                               04S0154
*               DO;                 /* CASE(I)NAMES(KSA,CI,CH,CUID,KC
*                                      PUID,ALTPATH,UPPSKIP)         */
*                 DCL                                           04S0155
*                   CL0002@ LABEL BASED(CP0002@(I)) VALUERANGE(KSA,CI,
*                       CH,CUID,KCPUID,ALTPATH,UPPSKIP);/* BRANCH
*                                      TARGET                        */
*                 DCL                                           04S0156
*                   CP0002@(7) PTR(31) INIT(ADDR(KSA),ADDR(CI),ADDR(CH)
*                       ,ADDR(CUID),ADDR(KCPUID),ADDR(ALTPATH),ADDR(
*                       UPPSKIP));                              04S0156
*                 GOTO CL0002@;     /* BRANCH TO SELECTED CASE  04S0157
*                                                            @Y30LB52*/
*                                                               04S0157
         LR    @10,I                                            04S0157
         SLA   @10,2                                            04S0157
         L     @10,CP0002@-4(@10)                               04S0157
         BR    @10                                              04S0157
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS CODE PROCESSES THE 'SA=' KEYWORD, STORING  */
*                 /* THE VALUE FOR LATER USE                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                               04S0158
*KSA:                                                           04S0158
*                 DO;               /* SUBCASE               @Y30LB52*/
KSA      DS    0H                                               04S0159
*                   LCPTR=LCPTR+3;  /* STEP OVER KEY         @Y30LB52*/
         AH    LCPTR,@CH00063                                   04S0159
*                   BYTES=1;        /* CONVERSION COUNT      @Y30LB52*/
         LA    BYTES,1                                          04S0160
*                   CALL HEXBYTES;  /* TO BINARY             @Y30LB52*/
         BAL   @14,HEXBYTES                                     04S0161
*                   USA=LINECHAR(1);/* STASH                 @Y30LB52*/
         MVC   USA(1),LINECHAR(LCPTR)                           04S0162
*                   LCPTR=LCPTR+1;  /* BUMP PTR PAST POSSIBLE X'40'
*                                                            @ZA32464*/
         AH    LCPTR,@CH00060                                   04S0163
*                   GOTO CE0002@;   /* BRANCH TO END OF CASE         */
         B     CE0002@                                          04S0164
*                 END;              /* END OF SUBCASE        @Y30LB52*/
*                                                               04S0165
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS CODE SAVES THE 'CI=' VALUE, THE 'SA' UPPER */
*                 /* INTERFACE ID                                    */
*                 /*                                                 */
*                 /***************************************************/
*                                                               04S0166
*CI:                                                            04S0166
*                 DO;               /* SUBCASE               @Y30LB52*/
CI       DS    0H                                               04S0167
*                   UCI=LINECHAR(4);/* SAVE INTERFACE (B,C,D)@Y30LB52*/
         MVC   UCI(1),LINECHAR+3(LCPTR)                         04S0167
*                   GOTO CE0002@;   /* BRANCH TO END OF CASE         */
         B     CE0002@                                          04S0168
*                 END;              /* END OF SUBCASE        @Y30LB52*/
*                                                               04S0169
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS CODE SAVES THE BINARY EQUIVALENT OF THE    */
*                 /* CHANNEL                                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                               04S0170
*CH:                                                            04S0170
*                 DO;               /* SUBCASE               @Y30LB52*/
CH       DS    0H                                               04S0171
*                   SLL(LINECHAR(4),4);/* SHIFT TO HIGH 4 BITS  04S0171
*                                                            @Y30LB52*/
         SLR   @10,@10                                          04S0171
         IC    @10,LINECHAR+3(,LCPTR)                           04S0171
         SLL   @10,4                                            04S0171
         STC   @10,LINECHAR+3(,LCPTR)                           04S0171
*                   UCH=UCH×LINECHAR(4);/* STORE             @Y30LB52*/
         SLR   @10,@10                                          04S0172
         IC    @10,UCH                                          04S0172
         SLR   @07,@07                                          04S0172
         IC    @07,LINECHAR+3(,LCPTR)                           04S0172
         OR    @10,@07                                          04S0172
         STC   @10,UCH                                          04S0172
*                   LCPTR=LCPTR+4;  /* BUMP PAST A POSSIBLE CONVERTED
*                                      CH=4 TO PREVENT BLANK    04S0173
*                                      DETECTION             @ZA32464*/
         AH    LCPTR,@CH00042                                   04S0173
*                   COMMA=OFF;      /* TURN OFF COMMA        @ZA32464*/
         NI    COMMA,B'11111101'                                04S0174
*                   GOTO CE0002@;   /* BRANCH TO END OF CASE         */
         B     CE0002@                                          04S0175
*                 END;              /* END OF SUBCASE        @Y30LB52*/
*                                                               04S0176
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS CODE SAVES THE BINARY EQUIVALENT OF THE    */
*                 /* CONTROL UNIT ATTACHMENT.                        */
*                 /*                                                 */
*                 /***************************************************/
*                                                               04S0177
*CUID:                                                          04S0177
*                 DO;               /* SUBCASE               @Y30LB52*/
CUID     DS    0H                                               04S0178
*                   IF LINECHAR(6)='1' THEN                     04S0178
         CLI   LINECHAR+5(LCPTR),C'1'                           04S0178
         BNE   @RF00178                                         04S0178
*                     UCH=UCH+2;    /* TWO'S BIT             @Y30LB52*/
         IC    @10,UCH                                          04S0179
         LA    @10,2(,@10)                                      04S0179
         STC   @10,UCH                                          04S0179
*                   IF LINECHAR(7)='1' THEN                     04S0180
@RF00178 CLI   LINECHAR+6(LCPTR),C'1'                           04S0180
         BNE   @RF00180                                         04S0180
*                     UCH=UCH+1;    /* ONE'S BIT             @Y30LB52*/
         IC    @10,UCH                                          04S0181
         LA    @10,1(,@10)                                      04S0181
         STC   @10,UCH                                          04S0181
*                   GOTO CE0002@;   /* BRANCH TO END OF CASE         */
         B     CE0002@                                          04S0182
*                 END;              /* END OF SUBCASE        @Y30LB52*/
*                                                               04S0183
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS CODE CONVERTS THE 'CPUID=' VALUE TO BINARY */
*                 /* AND STORES IT.                                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                               04S0184
*KCPUID:                                                        04S0184
*                 DO;               /* SUBCASE               @Y30LB52*/
KCPUID   DS    0H                                               04S0185
*                   LCPTR=LCPTR+6;  /* PAST 'CPUID=          @Y30LB52*/
         AH    LCPTR,@CH00054                                   04S0185
*                   BYTES=10;       /* CONVERSION COUNT      @Y30LB52*/
         LA    BYTES,10                                         04S0186
*                   CALL HEXBYTES;  /* CONVERT TO BINARY     @Y30LB52*/
         BAL   @14,HEXBYTES                                     04S0187
*                   UCPUID=LINECHAR(1:5);/* STORE            @Y30LB52*/
         MVC   UCPUID(5),LINECHAR(LCPTR)                        04S0188
*                   LCPTR=LCPTR+10; /* STEP OVER VALUE       @Y30LB52*/
         AH    LCPTR,@CH00266                                   04S0189
*                   GOTO CE0002@;   /* BRANCH TO END OF CASE         */
         B     CE0002@                                          04S0190
*                 END;              /* END OF SUBCASE        @Y30LB52*/
*                                                               04S0191
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS CODE STEPS OVER THE 'ALTPATH=' KEYWORD AND */
*                 /* VALUE. NOTHING IS RETAINED, THIS IS NECESSARY   */
*                 /* DUE TO THE PECULIAR SYNTAX.                     */
*                 /*                                                 */
*                 /***************************************************/
*                                                               04S0192
*ALTPATH:                                                       04S0192
*                 DO;               /* SUBCASE               @Y30LB52*/
ALTPATH  DS    0H                                               04S0193
*                   DO WHILE(LINECHAR(1)^=')'&EOC=OFF);/* SCAN FOR
*                                      END                   @Y30LB52*/
         B     @DE00193                                         04S0193
@DL00193 DS    0H                                               04S0194
*                     LCPTR=LCPTR+1;/* INCREMENT             @Y30LB52*/
         AH    LCPTR,@CH00060                                   04S0194
*                     CALL NEXTCHAR;/* NEXT CHARACTER        @Y30LB52*/
         BAL   @14,NEXTCHAR                                     04S0195
*                   END;            /*                       @Y30LB52*/
@DE00193 CLI   LINECHAR(LCPTR),C')'                             04S0196
         BE    @DC00193                                         04S0196
         TM    EOC,B'10000000'                                  04S0196
         BZ    @DL00193                                         04S0196
@DC00193 DS    0H                                               04S0197
*                   GOTO CE0002@;   /* BRANCH TO END OF CASE         */
         B     CE0002@                                          04S0197
*                 END;              /* END OF SUBCASE        @Y30LB52*/
*UPPSKIP:                                                       04S0199
*                 DO;               /* SUBCASE               @Y30LB52*/
UPPSKIP  DS    0H                                               04S0200
*                   LCPTR=LCPTR+1;  /* INCREMENT POINTER     @Y30LB52*/
         AH    LCPTR,@CH00060                                   04S0200
*                   GOTO CE0002@;   /* BRANCH TO END OF CASE         */
         B     CE0002@                                          04S0201
*                 END;              /* END OF SUBCASE        @Y30LB52*/
*CE0002@:                                                       04S0203
*               END;                /* END OF CASE           @Y30LB52*/
CE0002@  DS    0H                                               04S0204
*                                                               03S0204
*               /*****************************************************/
*               /*                                                   */
*               /* STEP TO NEXT KEYWORD                              */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0204
*               CALL NEXTCMMA;      /* NEXT COMMA            @Y30LB52*/
         BAL   @14,NEXTCMMA                                     03S0204
*               CALL NEXTCHAR;      /* NEXT CHARACTER        @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0205
*             END;                  /*                       @Y30LB52
*                                                            @Y30LB52*/
@DE00151 TM    EOC,B'10000000'                                  03S0206
         BZ    @DL00151                                         03S0206
*                                                               03S0207
*             /*******************************************************/
*             /*                                                     */
*             /* THIS CODE UPDATES THE 'TCPUINTF' TABLE FROM THE     */
*             /* KEYWORD OPERANDS EXTRACTED DURING THE SCAN OF THIS  */
*             /* STATEMENT. THE TABLE IS A GROUP OF CHAINED ENTRIES  */
*             /* WITH BEGINNING AND END DUMMIES ANCHORING THE CHAIN. */
*             /* THE SCAN FOR THE POSITION OF THE CURRENT ENTRY      */
*             /* STARTS FROM THE TOP AND PROCEEDS TO THE CORRECT     */
*             /* POSITION. THE CHAIN IS RESET WITH THE NEW ENTRY.    */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0207
*             K=TINTFNO+2;          /* LOAD NEXT ENTRY INDEX @Y30LB52*/
         LA    K,2                                              03S0207
         AH    K,TINTFNO                                        03S0207
*             TCPUINTF(K)=UC;       /* MOVE TEMPORARY UPPERCON  03S0208
*                                      STRUCTURE             @Y30LB52*/
         LR    @10,K                                            03S0208
         MH    @10,@CH00052                                     03S0208
         LA    @07,TCPUINTF-12(@10)                             03S0208
         MVI   8(@07),C' '                                      03S0208
         MVC   9(3,@07),8(@07)                                  03S0208
         MVC   0(8,@07),UC                                      03S0208
*             I=1;                  /* INDEX STARTING POINT  @Y30LB52*/
         LA    I,1                                              03S0209
*             DO WHILE(TCPUCHCU(K)>TCPUCHCU(I));/* CHAIN TO PROPER
*                                      POSITION              @Y30LB52*/
         B     @DE00210                                         03S0210
@DL00210 DS    0H                                               03S0211
*               J=I;                /* SAVE THE LAST INDEX   @Y30LB52*/
         LR    J,I                                              03S0211
*               I=TFPTR(I);         /* LOAD NEXT INDEX       @Y30LB52*/
         LR    @10,I                                            03S0212
         MH    @10,@CH00052                                     03S0212
         SLR   @07,@07                                          03S0212
         IC    @07,TFPTR-12(@10)                                03S0212
         LR    I,@07                                            03S0212
*             END;                  /*                       @Y30LB52*/
@DE00210 LA    @10,12                                           03S0213
         LR    @01,K                                            03S0213
         MR    @00,@10                                          03S0213
         LR    @09,I                                            03S0213
         MR    @08,@10                                          03S0213
         LA    @07,TCPUCHCU-12(@01)                             03S0213
         LA    @08,TCPUCHCU-12(@09)                             03S0213
         CLC   0(6,@07),0(@08)                                  03S0213
         BH    @DL00210                                         03S0213
*             TFPTR(K)=TFPTR(J);    /* POINT CURRENT TO NEXT @Y30LB52*/
         LR    @09,@10                                          03S0214
         MR    @08,J                                            03S0214
         SLR   @10,@10                                          03S0214
         IC    @10,TFPTR-12(@09)                                03S0214
         STC   @10,TFPTR-12(@01)                                03S0214
*             TFPTR(J)=K;           /* POINT PREVIOUS TO CURRENT
*                                                            @Y30LB52*/
         STC   K,TFPTR-12(@09)                                  03S0215
*             GOTO CE0001@;         /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0216
*           END;                    /* END OF SUBCASE        @Y30LB52*/
*DASD:                                                          02S0218
*           DO;                     /* SUBCASE               @Y30LB52*/
DASD     DS    0H                                               02S0219
*                                                               03S0219
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SEGMENT PROCESSES THE 'DASD ' CONTROL          */
*             /* STATEMENTS, EXTRACTING THE DEVN KEYWORDS, COUNTING  */
*             /* THE NUMBER OF SPINDELS. LOCATE THE NEXT KEYWORD     */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0219
*             CALL NEXTBLNK;        /* NEXT BLANK            @Y30LB52*/
         BAL   @14,NEXTBLNK                                     03S0219
*             CALL NEXTCHAR;        /* NEXT CHARACTER        @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0220
*             FIND=OFF;             /* NOT VALID FIND        @OZ28372*/
*                                                               03S0221
         NI    FIND,B'11111011'                                 03S0221
*             /*******************************************************/
*             /*                                                     */
*             /* SCAN THE COMPLETE STATEMENT                         */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0222
*             DO WHILE(EOC=OFF);    /* SCAN TO END OF COMMAND@Y30LB52*/
*                                                               03S0222
         B     @DE00222                                         03S0222
@DL00222 DS    0H                                               03S0223
*               /*****************************************************/
*               /*                                                   */
*               /* COUNT THE 'DEV=' KEYWORDS(SPINDLES)               */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0223
*               IF LINECHAR(1:2)='DE'/* DEV= KEYWORD?        @Y30LB52*/
*                 THEN                                          03S0223
         CLC   LINECHAR(2,LCPTR),@CC00326                       03S0223
         BNE   @RF00223                                         03S0223
*                 TSPINO=TSPINO+1;  /* INCREMENT THE SPINDLES COUNT
*                                                            @Y30LB52*/
         LH    @10,TSPINO                                       03S0224
         LA    @10,1(,@10)                                      03S0224
         STH   @10,TSPINO                                       03S0224
*               LCPTR=LCPTR+1;      /* ON TO NEXT CHARACTER  @Y30LB52*/
*                                                               03S0225
@RF00223 AH    LCPTR,@CH00060                                   03S0225
*               /*****************************************************/
*               /*                                                   */
*               /* STEP TO THE NEXT OPERAND                          */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0226
*               CALL NEXTCMMA;      /* NEXT COMMA IN LINE    @Y30LB52*/
         BAL   @14,NEXTCMMA                                     03S0226
*               CALL NEXTCHAR;      /* NEXT CHARACTER        @Y30LB52*/
         BAL   @14,NEXTCHAR                                     03S0227
*             END;                  /*                       @Y30LB52*/
@DE00222 TM    EOC,B'10000000'                                  03S0228
         BZ    @DL00222                                         03S0228
*             GOTO CE0001@;         /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0229
*           END;                    /* END OF SUBCASE        @Y30LB52*/
*SKIPCMND:                                                      02S0231
*           DO;                     /* SUBCASE               @Y30LB52*/
SKIPCMND DS    0H                                               02S0232
*                                                               03S0232
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SEGMENT IS EXECUTED WHEN A COMMAND STATEMENT IS*/
*             /* ENCOUNTERED THAT IS NOT PROCESSED BY 'ISDACNFG'.    */
*             /* IT'S ONLY FUNCTION IS TO SKIP TO THE END OF THE     */
*             /* COMMAND STATEMENT.                                  */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0232
*             CALL NEXTBLNK;        /* NEXT BLANK            @ZM30730*/
         BAL   @14,NEXTBLNK                                     03S0232
*             CALL NEXTCHAR;        /* NEXT CHARACTER        @ZM30730*/
         BAL   @14,NEXTCHAR                                     03S0233
*             DO WHILE(EOC=OFF);    /* SCAN TO COMMAND END   @Y30LB52*/
         B     @DE00234                                         03S0234
@DL00234 DS    0H                                               03S0235
*               LCPTR=LCPTR+1;      /* STEP TO NEXT CHARACTER@Y30LB52*/
         AH    LCPTR,@CH00060                                   03S0235
*               CALL NEXTCMMA;      /* LOCATE NEXT COMMA     @Y30LB52*/
         BAL   @14,NEXTCMMA                                     03S0236
*               CALL NEXTCHAR;      /* CHECK FOR COMMENT     @ZM30730*/
         BAL   @14,NEXTCHAR                                     03S0237
*             END;                  /*                       @Y30LB52*/
@DE00234 TM    EOC,B'10000000'                                  03S0238
         BZ    @DL00234                                         03S0238
*             GOTO CE0001@;         /* BRANCH TO END OF CASE         */
         B     CE0001@                                          02S0239
*           END;                    /* END OF SUBCASE        @Y30LB52*/
*CE0001@:                                                       02S0241
*         END;                      /* END OF CASE           @Y30LB52*/
CE0001@  DS    0H                                               02S0242
*       END;                        /*                       @Y30LB52*/
*     ELSE                                                      02S0243
*       RETCOD=DATAERR;             /* INDICATE ERROR        @OZ28372*/
         B     @RC00046                                         02S0243
@RF00046 MVC   RETCOD(4),@CF00082                               02S0243
*     IF RETCOD^=0 THEN             /* IF INVALID COMMAND OR @OZ28372*/
@RC00046 ICM   @10,15,RETCOD                                    02S0244
         BZ    @RF00244                                         02S0244
*       DO;                         /* INVALID PARM IN DATA  @OZ28372*/
*         GEN(CLOSE MF=(E,OPENLIST))/* GIVES RETURN WITH     @OZ28372*/
*         SETS(SYSINDCB,OPENLIST);  /* 28 RETURN CODE - DATA @OZ28372*/
         CLOSE MF=(E,OPENLIST)
*         RETURN CODE(DATAERR);     /* ERROR                 @OZ28372*/
         L     @13,4(,@13)                                      02S0247
         L     @00,@SIZDATD                                     02S0247
         LR    @01,@11                                          02S0247
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,28                                           02S0247
         L     @14,12(,@13)                                     02S0247
         LM    @00,@12,20(@13)                                  02S0247
         BR    @14                                              02S0247
*       END;                        /*                       @OZ28372*/
*     DO WHILE(EOC=OFF);            /* SKIP TO END OF CURRENT COMMAND
*                                                            @Y30LB52*/
@RF00244 B     @DE00249                                         02S0249
@DL00249 DS    0H                                               02S0250
*       LCPTR=LCPTR+1;              /* INCREMENT BUFFER POINTER 02S0250
*                                                            @Y30LB52*/
         AH    LCPTR,@CH00060                                   02S0250
*       CALL NEXTCMMA;              /* SCAN FOR COMMA        @Y30LB52*/
         BAL   @14,NEXTCMMA                                     02S0251
*       CALL NEXTCHAR;              /* CHECK FOR COMMENT     @ZM30730*/
         BAL   @14,NEXTCHAR                                     02S0252
*     END;                          /*                       @Y30LB52*/
@DE00249 TM    EOC,B'10000000'                                  02S0253
         BZ    @DL00249                                         02S0253
*     EOC=OFF;                      /* RESET END OF COMMAND FLAG
*                                                            @Y30LB52*/
         NI    EOC,B'01111111'                                  02S0254
*     IF EOF=OFF THEN               /* OK TO READ AGAIN      @ZA11669*/
         TM    EOF,B'01000000'                                  02S0255
         BNZ   @RF00255                                         02S0255
*       CALL READRCRD;              /* READ NEXT RECORD      @Y30LB52*/
         BAL   @14,READRCRD                                     02S0256
*     ELSE                          /* NO, EOF ALREADY READ  @ZA11669*/
*       RETURN CODE(DATAERR);       /* UNEXPECTED INPUT END  @ZA11669*/
         B     @RC00255                                         02S0257
@RF00255 L     @13,4(,@13)                                      02S0257
         L     @00,@SIZDATD                                     02S0257
         LR    @01,@11                                          02S0257
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,28                                           02S0257
         L     @14,12(,@13)                                     02S0257
         LM    @00,@12,20(@13)                                  02S0257
         BR    @14                                              02S0257
*   END;                            /*                       @Y30LB52*/
@RC00255 DS    0H                                               02S0258
@DE00037 TM    EOF,B'01000000'                                  02S0258
         BZ    @DL00037                                         02S0258
*                                                               01S0259
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLOCATE THE PERMANENT CONFIGURATION DATA STRUCTURE. THE SPACE*/
*   /* ALLOCATED IS BASED ON THE SIZE OF THE SUBSYSTEM REFLECTED IN  */
*   /* THE TEMPORARY COUNTS.                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0259
*   IF RCRD1=OFF                    /* NO RECORDS READ       @Y30LB52*/
*     THEN                                                      01S0259
         TM    RCRD1,B'00010000'                                01S0259
         BNZ   @RF00259                                         01S0259
*     RETURN CODE(NOINPUT);         /* INDICATE NO RECORDS   @Y30LB52*/
         L     @13,4(,@13)                                      01S0260
         L     @00,@SIZDATD                                     01S0260
         LR    @01,@11                                          01S0260
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,36                                           01S0260
         L     @14,12(,@13)                                     01S0260
         LM    @00,@12,20(@13)                                  01S0260
         BR    @14                                              01S0260
*   IF ERROR=OFF                    /* NO I/O ERROR          @Y30LB52*/
*     THEN                                                      01S0261
@RF00259 TM    ERROR,B'00100000'                                01S0261
         BNZ   @RF00261                                         01S0261
*     DO;                           /*                       @Y30LB52*/
*                                                               02S0263
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT PRODUCES THE FINAL CONFIGURATION DATA        */
*       /* STRUCTURE FROM THE TEMPORARY DATA ACCUMULATED FROM THE    */
*       /* INPUT CONTROL STATEMENTS. THE STORAGE FOR THE FINAL TABLES*/
*       /* IS ALLOCATED FROM SUBPOOL 0 AND ANCHORED TO THE 'SDACVT'  */
*       /* AT 'CNFG0PTR'. ALLOCATE THE PERMANENT CONFIGURATION DATA  */
*       /* STRUCTURE. THE SPACE ALLOCATED IS BASED ON THE SIZE OF THE*/
*       /* SUBSYSTEM AS REFLECTED IN THE TEMPORARY COUNTS. THE       */
*       /* FOLLOWING STRUCTURE MAPS THE ISDAGET0 INPUT PARAMETER LIST*/
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0263
*       DCL                                                     02S0263
*         CHCUPTR PTR(31),          /* CHANNEL/CU TABLE BASE @Y30LB52*/
*         GET0PTR PTR(31) DEF(CNFG0PTR);/*                   @Y30LB52*/
*       IF TMSFNO=0×TCPUNO=0×TSANO=0×TINTFNO=0 THEN/* FULL INPUT
*                                                            @ZA10797*/
         SLR   @10,@10                                          02S0264
         CH    @10,TMSFNO                                       02S0264
         BE    @RT00264                                         02S0264
         CH    @10,TCPUNO                                       02S0264
         BE    @RT00264                                         02S0264
         CH    @10,TSANO                                        02S0264
         BE    @RT00264                                         02S0264
         CH    @10,TINTFNO                                      02S0264
         BNE   @RF00264                                         02S0264
@RT00264 DS    0H                                               02S0265
*         RETURN CODE(DATAERR);     /* NO, SOME FIELD ZERO   @ZA10797*/
         L     @13,4(,@13)                                      02S0265
         L     @00,@SIZDATD                                     02S0265
         LR    @01,@11                                          02S0265
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,28                                           02S0265
         L     @14,12(,@13)                                     02S0265
         LM    @00,@12,20(@13)                                  02S0265
         BR    @14                                              02S0265
*       ELSE                                                    02S0266
*         ;                         /* INPUT COMPLETE        @ZA10797*/
@RF00264 DS    0H                                               02S0267
*       CORELEN=LENGTH(LTPDRDTB)*TMSFNO+LENGTH(CHCUTAB)*TINTFNO+TCPUNO*
*           LENGTH(TCPUSER)+LENGTH(PCNFG)+LENGTH(SAINTFC)*TSANO;/*
*                                      CALCULATE LENGTH OF FIXED
*                                      CONFIGURATION DATA    @Y30LB52*/
         L     @10,@PC00001                                     02S0267
         L     @10,CVTPTR(,@10)                                 02S0267
         LH    @15,TMSFNO                                       02S0267
         SLA   @15,3                                            02S0267
         LA    @14,12                                           02S0267
         LR    @09,@14                                          02S0267
         MH    @09,TINTFNO                                      02S0267
         ALR   @15,@09                                          02S0267
         LH    @09,TCPUNO                                       02S0267
         MH    @09,@CH00056                                     02S0267
         ALR   @15,@09                                          02S0267
         AH    @15,@CH00085                                     02S0267
         MH    @14,TSANO                                        02S0267
         ALR   @15,@14                                          02S0267
         STCM  @15,7,CORELEN(@10)                               02S0267
*       SPNO=0;                     /* SUBPOOL NUMBER        @Y30LB52*/
         MVI   SPNO(@10),X'00'                                  02S0268
*       RESPECIFY                                               02S0269
*         R1 RESTRICTED;            /*                       @Y30LB52*/
*       R1=ADDR(WORKCALL);          /* ADDRESS PARMLIST      @Y30LB52*/
         LA    R1,WORKCALL(,@10)                                02S0270
*       CALL ISDAGET1;              /* ALLOCATE CONFIG AREA  @Y30LB52*/
         L     @15,@CV00119                                     02S0271
         BALR  @14,@15                                          02S0271
*       RESPECIFY                                               02S0272
*         R1 UNRESTRICTED;          /*                       @Y30LB52*/
*       RESPECIFY                                               02S0273
*         R15 RESTRICTED;           /*                       @Y30LB52*/
*       IF R15^=0                   /* ERROR RETURN          @Y30LB52*/
*         THEN                                                  02S0274
         LTR   R15,R15                                          02S0274
         BZ    @RF00274                                         02S0274
*         DO;                       /*                       @Y30LB52*/
*           GEN(CLOSE MF=(E,OPENLIST))                          02S0276
*           SETS(SYSINDCB,OPENLIST);/*                       @Y30LB52*/
         CLOSE MF=(E,OPENLIST)
*           RETURN CODE(NOSPACE);   /* INDICATE NO CONFIGURATION DATA
*                                                            @Y30LB52*/
         L     @13,4(,@13)                                      02S0277
         L     @00,@SIZDATD                                     02S0277
         LR    @01,@11                                          02S0277
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,24                                           02S0277
         L     @14,12(,@13)                                     02S0277
         LM    @00,@12,20(@13)                                  02S0277
         BR    @14                                              02S0277
*         END;                      /*                       @Y30LB52*/
*       ELSE                                                    02S0279
*         DO;                       /* CONFIGURATION AREA OBTAINED
*                                                            @Y30LB52*/
@RF00274 DS    0H                                               02S0280
*           CNFG0PTR=COREADDR;      /* BASE OF CONFIG        @Y30LB52*/
         L     @14,@PC00001                                     02S0280
         L     @14,CVTPTR(,@14)                                 02S0280
         L     @10,COREADDR(,@14)                               02S0280
         ST    @10,CNFG0PTR(,@14)                               02S0280
*           PCNFGL=CORELEN;         /* LENGTH OF TOTAL AREA  @Y30LB52*/
         MVC   PCNFGL(2,@10),CORELEN+1(@14)                     02S0281
*           RESPECIFY                                           02S0282
*             R15 UNRESTRICTED;     /*                       @Y30LB52*/
*                                                               02S0282
*           /*********************************************************/
*           /*                                                       */
*           /* SET POINTERS TO THE CHCU/SA CONVERSION TABLE AND TO   */
*           /* THE LOGICAL TO PHYSICAL DRC/DRD TABLE                 */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0283
*           RESPECIFY                                           02S0283
*             ISDAGHDR BASED(CNFG0PTR);/*                    @Y30LB52*/
*           CHCUAD=CNFG0PTR+LENGTH(PCNFG);/* SET POINTER TO CHANNEL
*                                      TABLE                 @Y30LB52*/
         LA    @15,36                                           02S0284
         ALR   @15,@10                                          02S0284
         ST    @15,CHCUAD(,@10)                                 02S0284
*           LTPAD=CHCUAD+LENGTH(CHCUTAB)*TINTFNO;/* SET POINTER TO
*                                      THE DRD/DRC TABLE     @Y30LB52*/
         LH    @14,TINTFNO                                      02S0285
         LA    @09,12                                           02S0285
         LR    @01,@14                                          02S0285
         MR    @00,@09                                          02S0285
         ALR   @15,@01                                          02S0285
         ST    @15,LTPAD(,@10)                                  02S0285
*           SAINTFP=LTPAD+LENGTH(LTPDRDTB)*TMSFNO;/* SET POINTER TO
*                                      SA UPPER INTF TABLE   @Y30LB52*/
         LH    @08,TMSFNO                                       02S0286
         SLA   @08,3                                            02S0286
         ALR   @15,@08                                          02S0286
         ST    @15,SAINTFP(,@10)                                02S0286
*           CPUSERAD=SAINTFP+LENGTH(SAINTFC)*TSANO;/* SET POINTER TO
*                                      CPU SERIALS           @Y30LB52*/
         MH    @09,TSANO                                        02S0287
         ALR   @15,@09                                          02S0287
         ST    @15,CPUSERAD(,@10)                               02S0287
*           IF TINTFNO=0 THEN                                   02S0288
         SLR   @15,@15                                          02S0288
         CR    @14,@15                                          02S0288
         BNE   @RF00288                                         02S0288
*             CHCUAD=0;             /* IF NO UPPER INTERFACES ARE
*                                      DEFINED, INDICATE     @Y30LB52*/
         ST    @15,CHCUAD(,@10)                                 02S0289
*           I=SAINTFP;              /* LOAD FIRST SAINTF ADDRESS
*                                                            @Y30LB52*/
@RF00288 L     @10,@PC00001                                     02S0290
         L     @10,CVTPTR(,@10)                                 02S0290
         L     @10,CNFG0PTR(,@10)                               02S0290
         L     I,SAINTFP(,@10)                                  02S0290
*           RESPECIFY                                           02S0291
*             SAINTF BASED(I);      /*                       @Y30LB52*/
*           DO J=1 TO TSANO;        /* LOOP THROUGH ALL SA'S @Y30LB52*/
         LA    J,1                                              02S0292
         B     @DE00292                                         02S0292
@DL00292 DS    0H                                               02S0293
*             SAINTFC=SAINTFC&&SAINTFC;/* CLEAR FIRST SAINTF @Y30LB52*/
         XC    SAINTFC(12,I),SAINTFC(I)                         02S0293
*             I=I+LENGTH(SAINTFC);  /* INCREMENT             @Y30LB52*/
         AH    I,@CH00052                                       02S0294
*           END;                    /*                       @Y30LB52*/
         AH    J,@CH00060                                       02S0295
@DE00292 CH    J,TSANO                                          02S0295
         BNH   @DL00292                                         02S0295
*                                                               03S0296
*           /*********************************************************/
*           /*                                                       */
*           /* THE FOLLOWING SEGMENT MOVES THE FIXED CONFIGURATION   */
*           /* DATA AND VARIABLE DATA TO ITS PERMANENT STORAGE. MOVE */
*           /* THE FIXED PORTION OF THE CONFIGURATION DATA TO THE    */
*           /* PERMANENT STRUCTURE.                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0296
*           CNFGFXD(1:LENGTH(TCNFGFXD))=TCNFGFXD;/* FIXED CONFIG
*                                      DATA@Y30LB52                  */
*                                                               03S0296
         L     @10,@PC00001                                     03S0296
         L     @10,CVTPTR(,@10)                                 03S0296
         L     @10,CNFG0PTR(,@10)                               03S0296
         MVC   CNFGFXD(14,@10),TCNFGFXD                         03S0296
*           /*********************************************************/
*           /*                                                       */
*           /* COMPUTE TOTAL OF SSID'S AND DASD                      */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0297
*           CNFGTOTL=TMSFNO+TSPINO+TSANO+36;/* COMPUTE TOTAL DEVICES
*                                      IN SUBSYSTEM          @Y30LB52*/
*                                                               03S0297
         LH    @02,TMSFNO                                       03S0297
         AH    @02,TSPINO                                       03S0297
         AH    @02,TSANO                                        03S0297
         AH    @02,@CH00085                                     03S0297
         STH   @02,CNFGTOTL(,@10)                               03S0297
*           /*********************************************************/
*           /*                                                       */
*           /* LOOP THROUGH AND MOVE THE CHAINED SA UPPPER INTERFACE */
*           /* ENTRIES TO THE PERMANENT STRUCTURE. THE ENTRIES ARE   */
*           /* STORE IN ASCENDING ORDER BY CPUID/CH/CU.              */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0298
*           I=TFPTR(1);             /* STARTING ENTRY        @Y30LB52*/
         SLR   I,I                                              03S0298
         IC    I,TFPTR                                          03S0298
*           RESPECIFY                                           03S0299
*             CHCUTAB BASED(CHCUPTR);/*                      @Y30LB52*/
*           DO CHCUPTR=CHCUAD TO LTPAD BY LENGTH(CHCUTAB) WHILE(I^=2);
         L     CHCUPTR,CHCUAD(,@10)                             03S0300
         B     @DE00300                                         03S0300
@DL00300 CH    I,@CH00045                                       03S0300
         BE    @DC00300                                         03S0300
*                                   /* LOOP THROUGH ALL CHANNEL 03S0301
*                                      ENTRIES                       */
*             CHCUTAB=TCPUINTF(I);  /* MOVE TEMPORARY ENTRY TO  03S0301
*                                      PERMANENT ENTRY       @Y30LB52*/
         LA    @10,12                                           03S0301
         LR    @01,I                                            03S0301
         MR    @00,@10                                          03S0301
         LA    @07,TCPUINTF-12(@01)                             03S0301
         MVC   CHCUTAB(12,CHCUPTR),0(@07)                       03S0301
*             SPLTABP=0;            /* ACCUMULATOR PTR INIT  @Y30LB52*/
         SLR   @07,@07                                          03S0302
         ST    @07,SPLTABP(,CHCUPTR)                            03S0302
*             J=INTF;               /* LOAD INTERFACE(B,C,D) @Y30LB52*/
         SLR   J,J                                              03S0303
         IC    J,INTF(,CHCUPTR)                                 03S0303
*             J=J-'C1'X;            /* COMPUTE INDEX         @Y30LB52*/
         SH    J,@CH00334                                       03S0304
*             K=SA*LENGTH(SAINTFC)+SAINTFP;/* COMPUTE POINTER TO SA
*                                      TABLE                 @Y30LB52*/
         LR    @05,@10                                          03S0305
         SLR   @10,@10                                          03S0305
         IC    @10,SA(,CHCUPTR)                                 03S0305
         MR    K,@10                                            03S0305
         L     @10,@PC00001                                     03S0305
         L     @10,CVTPTR(,@10)                                 03S0305
         L     @10,CNFG0PTR(,@10)                               03S0305
         AL    @05,SAINTFP(,@10)                                03S0305
         LR    K,@05                                            03S0305
*             K->SAINTF(J)=CHCUPTR; /* SET ALTERNATE ACCESS POINTER
*                                      TO CHANNEL ENTRY      @Y30LB52*/
*                                                               03S0306
         LR    @10,J                                            03S0306
         SLA   @10,2                                            03S0306
         AL    @10,@CF00382                                     03S0306
         ST    CHCUPTR,SAINTF(@10,K)                            03S0306
*             /*******************************************************/
*             /*                                                     */
*             /* LOAD INDEX TO NEXT ENTRY                            */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0307
*             I=TFPTR(I);           /* LOAD NEXT ENTRY INDEX @Y30LB52*/
         SLR   @10,@10                                          03S0307
         IC    @10,TFPTR-12(@01)                                03S0307
         LR    I,@10                                            03S0307
*           END;                    /*                       @Y30LB52*/
*                                                               03S0308
         AH    CHCUPTR,@CH00052                                 03S0308
@DE00300 L     @10,@PC00001                                     03S0308
         L     @10,CVTPTR(,@10)                                 03S0308
         L     @10,CNFG0PTR(,@10)                               03S0308
         C     CHCUPTR,LTPAD(,@10)                              03S0308
         BNH   @DL00300                                         03S0308
@DC00300 DS    0H                                               03S0309
*           /*********************************************************/
*           /*                                                       */
*           /* MOVE THE 'DRC' LOGICAL TO PHYSICAL TABLES TO THE      */
*           /* PERMANENT STRUCTURE.                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0309
*           LTPDRDP=LTPAD;          /* FIRST PERM. TABLE     @Y30LB52*/
         L     @10,@PC00001                                     03S0309
         L     @10,CVTPTR(,@10)                                 03S0309
         L     @10,CNFG0PTR(,@10)                               03S0309
         L     LTPDRDP,LTPAD(,@10)                              03S0309
*           DO I=1 TO TMSFNO;       /* LOOP THRO ALL CS'S    @Y30LB52*/
         LA    I,1                                              03S0310
         B     @DE00310                                         03S0310
@DL00310 DS    0H                                               03S0311
*             LTPDRDTB=TLTPLIB(I);  /* MOVE CS LTP TABLE     @Y30LB52*/
         LR    @10,I                                            03S0311
         SLA   @10,3                                            03S0311
         LA    @05,TLTPLIB-8(@10)                               03S0311
         MVC   LTPDRDTB(8,LTPDRDP),0(@05)                       03S0311
*             LTPDRDP=LTPDRDP+LENGTH(LTPDRDTB);/* INCREMENT TO NEXT
*                                      PERMANENT LTP         @Y30LB52*/
         AH    LTPDRDP,@CH00049                                 03S0312
*           END;                    /*                       @Y30LB52*/
*                                                               03S0313
         AH    I,@CH00060                                       03S0313
@DE00310 CH    I,TMSFNO                                         03S0313
         BNH   @DL00310                                         03S0313
*           /*********************************************************/
*           /*                                                       */
*           /* MOVE CPU SERIALS TO FINAL TABLE                       */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0314
*           I=5*TCPUNO;             /* COMPUTE CPU SERIALS LENGTH
*                                                            @Y30LB52*/
         LH    I,TCPUNO                                         03S0314
         MH    I,@CH00056                                       03S0314
*           CPUSERS(1:I)=TCPUSER2(1:I);/* MOVE CPU SERIALS   @Y30LB52*/
         L     @10,@PC00001                                     03S0315
         L     @10,CVTPTR(,@10)                                 03S0315
         L     @10,CNFG0PTR(,@10)                               03S0315
         L     @10,CPUSERAD(,@10)                               03S0315
         LR    @02,I                                            03S0315
         BCTR  @02,0                                            03S0315
         EX    @02,@SM00383                                     03S0315
*         END;                      /*                       @Y30LB52*/
*       DCL                                                     02S0317
*         SAINTFC CHAR(12) DEF(SAINTF);/*                    @Y30LB52*/
*       RETURN CODE(0);             /* INDICATE SUCCESSFUL RETURN
*                                                            @Y30LB52*/
         L     @13,4(,@13)                                      01S0318
         L     @00,@SIZDATD                                     01S0318
         LR    @01,@11                                          01S0318
         FREEMAIN R,LV=(0),A=(1)
         SLR   @15,@15                                          01S0318
         L     @14,12(,@13)                                     01S0318
         LM    @00,@12,20(@13)                                  01S0318
         BR    @14                                              01S0318
*     END;                          /*                       @Y30LB52*/
*   ELSE                                                        01S0320
*     RETURN CODE(IOERROR);         /* INDICATE I/O ERROR    @Y30LB52
*                                                            @Y30LB52*/
@RF00261 L     @13,4(,@13)                                      01S0320
         L     @00,@SIZDATD                                     01S0320
         LR    @01,@11                                          01S0320
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,32                                           01S0320
         L     @14,12(,@13)                                     01S0320
         LM    @00,@12,20(@13)                                  01S0320
         BR    @14                                              01S0320
*                                                               01S0321
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING CODE IS CALLED BY ISDASDA0 TO FREE THE ALLOCATED*/
*   /* CONFIGURATION DATA AREA.                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0321
*ISDACNF1:                                                      01S0321
*   ENTRY(CVTPTR);                  /*                       @Y30LB52*/
@EP00321 MVC   @PC00001(4),0(@01)                               01S0321
*   SPNO=0;                         /* SUBPOOL NUMBER        @Y30LB52*/
         L     @10,@PC00001                                     01S0322
         L     @10,CVTPTR(,@10)                                 01S0322
         MVI   SPNO(@10),X'00'                                  01S0322
*   COREADDR=CNFG0PTR;              /* AREA TO BE FREED      @Y30LB52*/
         L     @15,CNFG0PTR(,@10)                               01S0323
         ST    @15,COREADDR(,@10)                               01S0323
*   CORELEN=PCNFGL;                 /* LENGTH OF AREA        @Y30LB52*/
         LH    @15,PCNFGL(,@15)                                 01S0324
         STCM  @15,7,CORELEN(@10)                               01S0324
*   RESPECIFY                                                   01S0325
*     R1 RESTRICTED;                /*                       @Y30LB52*/
*   R1=ADDR(WORKCALL);              /* PARMLIST              @Y30LB52*/
         LA    R1,WORKCALL(,@10)                                01S0326
*   CALL ISDAFREE;                  /* FREE THE AREA         @Y30LB52*/
         L     @15,@CV00120                                     01S0327
         BALR  @14,@15                                          01S0327
*   RESPECIFY                                                   01S0328
*     R1 UNRESTRICTED;              /*                       @Y30LB52*/
*   RETURN CODE(0);                 /* NORMAL RETURN         @Y30LB52*/
         L     @13,4(,@13)                                      01S0329
         L     @00,@SIZDATD                                     01S0329
         LR    @01,@11                                          01S0329
         FREEMAIN R,LV=(0),A=(1)
         SLR   @15,@15                                          01S0329
         L     @14,12(,@13)                                     01S0329
         LM    @00,@12,20(@13)                                  01S0329
         BR    @14                                              01S0329
*NEXTCHAR:                                                      02S0330
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/
*                                                               02S0330
@EL00001 L     @13,4(,@13)                                      02S0330
@EF00001 L     @00,@SIZDATD                                     02S0330
         LR    @01,@11                                          02S0330
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                  02S0330
         BR    @14                                              02S0330
NEXTCHAR ST    @14,@SA00002                                     02S0330
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE IS USED BY THE SEGMENTS OF 'ISDACNFG' TO LOCATE*/
*   /* THE NEXT NON-BLANK, NON-COMMA CHARACTER IN THE INPUT STREAM.  */
*   /* NOTHING IS PASSED AS INPUT AND ONLY THE SETTING OF 'LCPTR' IS */
*   /* RETURNED. THE 'EOC' FLAG IS USED TO SIGNAL TO THE CALLER, 'END*/
*   /* OF LINE' AND THE 'EOF' FLAG IS USED TO SIGNAL, 'END OF FILE'. */
*   /* THE 'READRCRD' PROCEDURE IS CALLED TO READ THE NEXT INPUT     */
*   /* RECORD IN THE FILE.                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0331
*   SCAN=ON;                        /* INIT SCAN CONTROL     @Y30LB52*/
*                                                               02S0331
         OI    SCAN,B'00001000'                                 02S0331
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP TO END OF COMMAND, END OF FILE, OR UNTIL NONBLANK IS     */
*   /* FOUND.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0332
*   DO WHILE(EOC=OFF)&(EOF=OFF)&(SCAN=ON);/* SCAN FOR CHARACTER, END
*                                      OF LINE, OR END OF FILE  02S0332
*                                                            @Y30LB52*/
*                                                               02S0332
         B     @DE00332                                         02S0332
@DL00332 DS    0H                                               02S0333
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN FOR A NONBLANK OR THE END OF A RECORD.                 */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0333
*     DO LCPTR=LCPTR TO LINEND WHILE(LINECHAR(1)=' '×LINECHAR(1)=',');
         B     @DE00333                                         02S0333
@DL00333 CLI   LINECHAR(LCPTR),C' '                             02S0333
         BE    @DB00333                                         02S0333
         CLI   LINECHAR(LCPTR),C','                             02S0333
         BNE   @DC00333                                         02S0333
@DB00333 DS    0H                                               02S0334
*       IF LINECHAR(1)=',' THEN     /* IF COMMA, TURN ON FLAG@Y30LB52*/
         CLI   LINECHAR(LCPTR),C','                             02S0334
         BNE   @RF00334                                         02S0334
*         DO;                       /* CHECK FOR COMMENT     @ZM30730*/
*           COMMA=ON;               /*                       @Y30LB52*/
         OI    COMMA,B'00000010'                                02S0336
*           IF LINECHAR(2)=' ' THEN /* BLANK AFTER COMMA     @ZM30730*/
         CLI   LINECHAR+1(LCPTR),C' '                           02S0337
         BNE   @RF00337                                         02S0337
*             LCPTR=LINEND;         /* YES, GET OUT OF LOOP  @ZM30730*/
         LR    LCPTR,LINEND                                     02S0338
*           ELSE                                                02S0339
*             ;                     /* NO, OK                @ZM30730*/
@RF00337 DS    0H                                               02S0340
*         END;                      /* END FOUND COMMA CODE  @ZM30730*/
*       ELSE                                                    02S0341
*         ;                         /* NOT A COMMA           @ZM30730*/
@RF00334 DS    0H                                               02S0342
*     END;                          /*                       @Y30LB52*/
*                                                               02S0342
         AH    LCPTR,@CH00060                                   02S0342
@DE00333 CR    LCPTR,LINEND                                     02S0342
         BNH   @DL00333                                         02S0342
@DC00333 DS    0H                                               02S0343
*     /***************************************************************/
*     /*                                                             */
*     /* AT THE END OF THE LINE, IF THE LAST NONBLANK WAS NOT A      */
*     /* COMMA, THIS IS THE END OF A CONTROL STATEMENT.              */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0343
*     IF LCPTR>LINEND THEN                                      02S0343
         CR    LCPTR,LINEND                                     02S0343
         BNH   @RF00343                                         02S0343
*       DO;                         /* END OF LINE?          @Y30LB52*/
*         IF COMMA=OFF THEN                                     02S0345
         TM    COMMA,B'00000010'                                02S0345
         BNZ   @RF00345                                         02S0345
*           DO;                     /* LAST CHAR NOT A COMMA @Y30LB52*/
*             EOC=ON;               /* INDICATE END COMMAND  @Y30LB52*/
*             SCAN=OFF;             /* END OF SCAN           @Y30LB52*/
         OI    EOC,B'10000000'                                  02S0348
         NI    SCAN,B'11110111'                                 02S0348
*           END;                    /*                       @Y30LB52*/
*                                                               02S0349
*         /***********************************************************/
*         /*                                                         */
*         /* OTHERWISE, GET THE NEXT RECORD.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0350
*         ELSE                      /* IF COMMA LAST CHARACTER, GET
*                                      NEXT COMMAND LINE     @Y30LB52*/
*           CALL READRCRD;          /*                       @Y30LB52*/
         B     @RC00345                                         02S0350
@RF00345 BAL   @14,READRCRD                                     02S0350
*       END;                        /*                       @Y30LB52*/
*                                                               02S0351
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT END OF LINE, INDICATE END OF THE SCAN.               */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0352
*     ELSE                                                      02S0352
*       DO;                         /* CHARACTER FOUND       @Y30LB52*/
         B     @RC00343                                         02S0352
@RF00343 DS    0H                                               02S0353
*         COMMA=OFF;                /* REINITIALIZE FLAG     @Y30LB52*/
*         SCAN=OFF;                 /* END OF SCAN           @Y30LB52*/
*         FIND=ON;                  /* DATA FOUND IN RECORD  @OZ28372*/
         OI    FIND,B'00000100'                                 02S0355
         NI    COMMA,B'11110101'                                02S0355
*       END;                        /*                       @Y30LB52*/
*   END;                            /*                       @Y30LB52*/
@RC00343 DS    0H                                               02S0357
@DE00332 TM    SCAN,B'00001000'                                 02S0357
         BNO   @DC00332                                         02S0357
         TM    EOC,B'11000000'                                  02S0357
         BZ    @DL00332                                         02S0357
@DC00332 DS    0H                                               02S0358
*   RETURN;                         /* RETURN TO CALLER              */
@EL00002 DS    0H                                               02S0358
@EF00002 DS    0H                                               02S0358
@ER00002 L     @14,@SA00002                                     02S0358
         BR    @14                                              02S0358
*   END NEXTCHAR;                   /*                       @Y30LB52*/
*NEXTBLNK:                                                      02S0360
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/
*                                                               02S0360
NEXTBLNK ST    @14,@SA00003                                     02S0360
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE IS USED BY SEGMENTS OF 'ISDACNFG' TO SCAN FOR  */
*   /* THE NEXT BLANK CHARACTER IN THE INPUT STREAM. NOTHING IS INPUT*/
*   /* AND THE 'LCPTR' IS SET TO ADDRESS THE CHARACTER FOUND. IF THE */
*   /* END OF THE COMMAND IS REACHED, 'EOC' IS SET, AND IF THE END OF*/
*   /* THE FILE IS REACHED, 'EOF' IS SET.                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0361
*   SCAN=ON;                        /* INITIALIZE SCAN FLAG  @Y30LB52*/
*                                                               02S0361
         OI    SCAN,B'00001000'                                 02S0361
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN TO END OF COMMAND, END OF FILE, OR A BLANK IS FOUND.     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0362
*   DO WHILE(EOC=OFF)&(EOF=OFF)&(SCAN=ON);/* SCAN TO BLANK END OF
*                                      FILE, OR END OF COMMAND       */
*                                                               02S0362
         B     @DE00362                                         02S0362
@DL00362 DS    0H                                               02S0363
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN TO LINE END OR TO FIRST BLANK                          */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0363
*     DO LCPTR=LCPTR TO LINEND WHILE(LINECHAR(1)^=' ');/* SCAN TO
*                                      BLANK                 @Y30LB52*/
*                                                               02S0363
         B     @DE00363                                         02S0363
@DL00363 CLI   LINECHAR(LCPTR),C' '                             02S0363
         BE    @DC00363                                         02S0363
*       /*************************************************************/
*       /*                                                           */
*       /* WHEN A COMMA IS ENCOUNTERED, THE 'COMMA' FLAG IS TURNED ON*/
*       /* AND WHEN A NONBLANK OTHER THAN A COMMA IS FOUND, IT IS    */
*       /* TURNED OFF.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0364
*       IF LINECHAR(1)=',' THEN     /* IF COMMA FOUND        @Y30LB52*/
         CLI   LINECHAR(LCPTR),C','                             02S0364
         BNE   @RF00364                                         02S0364
*         COMMA=ON;                 /* SET FLAG ON           @Y30LB52*/
         OI    COMMA,B'00000010'                                02S0365
*       ELSE                                                    02S0366
*         COMMA=OFF;                /* IF CHARACTER, TURN OFF@Y30LB52*/
         B     @RC00364                                         02S0366
@RF00364 NI    COMMA,B'11111101'                                02S0366
*     END;                          /*                       @Y30LB52*/
@RC00364 AH    LCPTR,@CH00060                                   02S0367
@DE00363 CR    LCPTR,LINEND                                     02S0367
         BNH   @DL00363                                         02S0367
@DC00363 DS    0H                                               02S0368
*     IF LCPTR^>LINEND THEN         /* INSURE SKIP OVER      @OZ28372*/
         CR    LCPTR,LINEND                                     02S0368
         BH    @RF00368                                         02S0368
*       IF FIND=ON THEN             /* COMMENTS              @OZ28372*/
         TM    FIND,B'00000100'                                 02S0369
         BNO   @RF00369                                         02S0369
*         LCPTR=LINEND+1;           /*                       @OZ28372*/
         LA    LCPTR,1                                          02S0370
         ALR   LCPTR,LINEND                                     02S0370
*       ELSE                                                    02S0371
*         ;                         /*                       @OZ28372*/
@RF00369 DS    0H                                               02S0372
*     ELSE                                                      02S0372
*       ;                           /*                       @OZ28372*/
*                                                               02S0372
@RF00368 DS    0H                                               02S0373
*     /***************************************************************/
*     /*                                                             */
*     /* AT THE END OF THE LINE, IF THE 'COMMA' FLAG IS OFF, THE END */
*     /* OF COMMAND FLAG IS SET AND TE SCAN TERMINATED. OTHERWISE,   */
*     /* THE NEXT RECORD IS READ AND THE SCAN CONTINUED.             */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0373
*     IF LCPTR>LINEND THEN                                      02S0373
         CR    LCPTR,LINEND                                     02S0373
         BNH   @RF00373                                         02S0373
*       DO;                         /* END OF LINE?          @Y30LB52*/
*         IF COMMA=OFF THEN                                     02S0375
         TM    COMMA,B'00000010'                                02S0375
         BNZ   @RF00375                                         02S0375
*           DO;                     /* NO COMMA ON LINE?     @Y30LB52*/
*             EOC=ON;               /* END OF COMMAND        @Y30LB52*/
*             SCAN=OFF;             /* END OF SCAN           @Y30LB52*/
         OI    EOC,B'10000000'                                  02S0378
         NI    SCAN,B'11110111'                                 02S0378
*           END;                    /*                       @Y30LB52*/
*         ELSE                                                  02S0380
*           CALL READRCRD;          /* COMMA LAST CHAR, GET NEXT
*                                      RECORD                @Y30LB52*/
         B     @RC00375                                         02S0380
@RF00375 BAL   @14,READRCRD                                     02S0380
*       END;                        /*                       @Y30LB52*/
*                                                               02S0381
*     /***************************************************************/
*     /*                                                             */
*     /* OTHERWISE, A BLANK HAS BEEN LOCATED AND THE SCAN IS         */
*     /* TERMINATED.                                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0382
*     ELSE                                                      02S0382
*       SCAN=OFF;                   /* NOT END OF LINE, BLANK FOUND
*                                                            @Y30LB52*/
         B     @RC00373                                         02S0382
@RF00373 NI    SCAN,B'11110111'                                 02S0382
*   END;                            /*                       @Y30LB52*/
@RC00373 DS    0H                                               02S0383
@DE00362 TM    SCAN,B'00001000'                                 02S0383
         BNO   @DC00362                                         02S0383
         TM    EOC,B'11000000'                                  02S0383
         BZ    @DL00362                                         02S0383
@DC00362 DS    0H                                               02S0384
*   RETURN;                         /* BACK TO CALLER        @Y30LB52*/
@EL00003 DS    0H                                               02S0384
@EF00003 DS    0H                                               02S0384
@ER00003 L     @14,@SA00003                                     02S0384
         BR    @14                                              02S0384
*   END NEXTBLNK;                   /*                       @Y30LB52*/
*NEXTCMMA:                                                      02S0386
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/
*                                                               02S0386
NEXTCMMA ST    @14,@SA00004                                     02S0386
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE IS CALLED TO SCAN THE INPUT STREAM FOR THE NEXT*/
*   /* COMMA. ON RETURN, THE LCPTR IS SET TO ADDRESS THE NEXT COMMA  */
*   /* OR THE 'EOC' OR 'EOF' FLAGS ARE SET TO REFLECT END OF COMMAND */
*   /* AND END OF FILE. ONLY THE 'READRCRD' ROUTINE IS CALLED TO READ*/
*   /* THE NEXT INPUT RECORD.                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0387
*   SCAN=ON;                        /* START SCAN            @Y30LB52*/
*                                                               02S0387
         OI    SCAN,B'00001000'                                 02S0387
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP TO THE END OF THE COMMAND STATEMENT, END OF THE FILE, OR */
*   /* UNTIL A COMMA IS FOUND.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0388
*   DO WHILE(EOC=OFF)&(EOF=OFF)&(SCAN=ON);/* SCAN FOR END OF FILE,
*                                      END OF COMMAND, OR COMMA      */
*                                                               02S0388
         B     @DE00388                                         02S0388
@DL00388 DS    0H                                               02S0389
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN TO END OF LINE FOR A COMMA                             */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0389
*     DO LCPTR=LCPTR TO LINEND WHILE(LINECHAR(1)^=',');/* SCAN TO END
*                                      OF COMMAND, COMMA     @Y30LB52*/
*                                                               02S0389
         B     @DE00389                                         02S0389
@DL00389 CLI   LINECHAR(LCPTR),C','                             02S0389
         BE    @DC00389                                         02S0389
*       /*************************************************************/
*       /*                                                           */
*       /* IF A NONBLANK IS ENCOUNTERED, TURN OFF THE COMMA FLAG.    */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0390
*       IF LINECHAR(1)^=' ' THEN    /* IF CHARACTER NON-BLANK@Y30LB52*/
         CLI   LINECHAR(LCPTR),C' '                             02S0390
         BE    @RF00390                                         02S0390
*         COMMA=OFF;                /* TURN COMMA LAST FLAG OFF 02S0391
*                                                            @Y30LB52*/
         NI    COMMA,B'11111101'                                02S0391
*       ELSE                        /* IF BLANK AND DATA     @OZ28372*/
*         IF FIND=ON THEN           /* HAS BEEN FOUND IN THE @OZ28372*/
         B     @RC00390                                         02S0392
@RF00390 TM    FIND,B'00000100'                                 02S0392
         BNO   @RF00392                                         02S0392
*           DO;                     /* STATEMENT, THEN IS    @OZ28372*/
*             LCPTR=LINEND;         /* END OF RECORD, GO TO  @OZ28372*/
         LR    LCPTR,LINEND                                     02S0394
*             COMMA=OFF;            /* NEXT RECORD           @OZ28372*/
         NI    COMMA,B'11111101'                                02S0395
*           END;                    /*                       @OZ28372*/
*         ELSE                                                  02S0397
*           ;                       /* IGNORE INIT. BLANKS   @OZ28372*/
@RF00392 DS    0H                                               02S0398
*     END;                          /*                       @Y30LB52*/
*                                                               02S0398
@RC00390 AH    LCPTR,@CH00060                                   02S0398
@DE00389 CR    LCPTR,LINEND                                     02S0398
         BNH   @DL00389                                         02S0398
@DC00389 DS    0H                                               02S0399
*     /***************************************************************/
*     /*                                                             */
*     /* AT THE END OF A LINE, IF THE LAST CHARACTER WAS NOT A       */
*     /* COMMA(COMMA FLAG OFF), SET END OF CONTROL STATEMENT AND END */
*     /* OF SCAN.                                                    */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0399
*     IF LCPTR>LINEND THEN          /* END OF LINE?          @Y30LB52*/
         CR    LCPTR,LINEND                                     02S0399
         BNH   @RF00399                                         02S0399
*       DO;                         /* CHECK FOR END OF COMMAND 02S0400
*                                                            @Y30LB52*/
*         IF COMMA=OFF THEN         /* LAST CHARACTER COMMA? @Y30LB52*/
         TM    COMMA,B'00000010'                                02S0401
         BNZ   @RF00401                                         02S0401
*           DO;                     /*                       @Y30LB52*/
*             EOC=ON;               /* SET END OF COMMAND    @Y30LB52*/
*             SCAN=OFF;             /* SET END OF SCAN       @Y30LB52*/
         OI    EOC,B'10000000'                                  02S0404
         NI    SCAN,B'11110111'                                 02S0404
*           END;                    /*                       @Y30LB52*/
*         ELSE                                                  02S0406
*           CALL READRCRD;          /* READ NEXT RECORD      @Y30LB52*/
         B     @RC00401                                         02S0406
@RF00401 BAL   @14,READRCRD                                     02S0406
*       END;                        /*                       @Y30LB52*/
*                                                               02S0407
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT THE END OF THE LINE, A COMMA WAS FOUND. INDICATE     */
*     /* THROUGH THE COMMA FLAG AND END THE SCAN.                    */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0408
*     ELSE                                                      02S0408
*       DO;                         /* MUST HAVE FOUND COMMA @Y30LB52*/
         B     @RC00399                                         02S0408
@RF00399 DS    0H                                               02S0409
*         SCAN=OFF;                 /* INDICATE COMMA LAST CHARACTER
*                                                            @Y30LB52*/
*         COMMA=ON;                 /* LAST CHARACTER COMMA  @Y30LB52*/
         OI    COMMA,B'00000010'                                02S0410
         NI    SCAN,B'11110111'                                 02S0410
*       END;                        /*                       @Y30LB52*/
*   END;                            /*                       @Y30LB52*/
@RC00399 DS    0H                                               02S0412
@DE00388 TM    SCAN,B'00001000'                                 02S0412
         BNO   @DC00388                                         02S0412
         TM    EOC,B'11000000'                                  02S0412
         BZ    @DL00388                                         02S0412
@DC00388 DS    0H                                               02S0413
*   RETURN;                         /*                       @Y30LB52*/
@EL00004 DS    0H                                               02S0413
@EF00004 DS    0H                                               02S0413
@ER00004 L     @14,@SA00004                                     02S0413
         BR    @14                                              02S0413
*   END NEXTCMMA;                   /*                       @Y30LB52*/
*READRCRD:                                                      02S0415
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/
*                                                               02S0415
READRCRD ST    @14,@SA00005                                     02S0415
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE READS THE NEXT SEQUENTIAL RECORD IN THE INPUT  */
*   /* STREAM FOR THE PROCEDURES, 'NEXTCHAR', 'NEXTBLNK', AND        */
*   /* 'NEXTCMMA'. ON RETURN, THE 'LCPTR' WILL BE SET TO THE         */
*   /* BEGINNING OF THE NEW LINE. IF THE END OF THE FILE IS REACHED, */
*   /* THE 'EOF' FLAG IS SET AND IF AN I/O ERROR IS ENCOUNTERED, THE */
*   /* 'EOD' FLAG IS SET.                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0416
*   RESPECIFY                                                   02S0416
*    (R0,                                                       02S0416
*     R1) RESTRICTED;               /*                       @Y30LB52*/
*   DO UNTIL(ILINE(1)^='*');        /* SKIP COMMENT LINES    @YM32172*/
@DL00417 DS    0H                                               02S0418
*     R1=ADDR(SYSINDCB);            /* ADDRESS OF DCB        @Y30LB52*/
         LA    R1,SYSINDCB                                      02S0418
*     R0=ADDR(ILINE);               /* ADDRESS OF INPUT BUFFER  02S0419
*                                                            @Y30LB52*/
         LA    R0,ILINE                                         02S0419
*     GEN(GET   SYSINDCB,ILINE)                                 02S0420
*     FLOWS(SYNAD,EODAD) SETS(SYSINDCB,ILINE);/* GET A LINE  @Y30LB52*/
         GET   SYSINDCB,ILINE
*   END;                            /*                       @YM32172*/
@DE00417 CLI   ILINE,C'*'                                       02S0421
         BE    @DL00417                                         02S0421
*   RESPECIFY                                                   02S0422
*    (R0,                                                       02S0422
*     R1) UNRESTRICTED;             /*                       @Y30LB52*/
*   RCRD1=ON;                       /* INDICATE RECORD READ  @Y30LB52*/
         OI    RCRD1,B'00010000'                                02S0423
*   LCPTR=ADDR(ILINE);              /* SET SCAN POINTER TO INPUT
*                                                            @Y30LB52*/
         LA    LCPTR,ILINE                                      02S0424
*   FIND=OFF;                       /* SAY NO DATA YET FOUND @OZ28372*/
         NI    FIND,B'11111011'                                 02S0425
*   RETURN;                         /* EXIT                  @Y30LB52*/
*                                                               02S0426
@EL00005 DS    0H                                               02S0426
@EF00005 DS    0H                                               02S0426
@ER00005 L     @14,@SA00005                                     02S0426
         BR    @14                                              02S0426
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ENTRY IS TAKEN WHEN AN I/O ERROR IS ENCOUNTERED IN       */
*   /* READING A RECORD. THE SCAN IS TERMINATED AND THE DATA SET     */
*   /* CLOSED.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0427
*   DCL                                                         02S0427
*     SYNAD LABEL;                  /*                       @Y30LB52*/
*SYNAD:                             /* SYNCHRONOUS I/O ERROR EXIT
*                                                            @Y30LB52*/
*   EOC=ON;                         /* END THE COMMAND       @Y30LB52*/
SYNAD    DS    0H                                               02S0429
*   EOF=ON;                         /* END THE FILE          @Y30LB52*/
*   ERROR=ON;                       /* INDICATE I/O ERROR    @Y30LB52*/
         OI    EOC,B'11100000'                                  02S0430
*   GEN(CLOSE MF=(E,OPENLIST))                                  02S0431
*   SETS(SYSINDCB,OPENLIST);        /* CLOSE THE DS          @Y30LB52*/
         CLOSE MF=(E,OPENLIST)
*   RETURN;                         /*                       @Y30LB52*/
*                                                               02S0432
         B     @EL00005                                         02S0432
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS EXIT IS TAKEN AT THE END OF THE FILE. THE DATA SET IS    */
*   /* CLOSED.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0433
*   DCL                                                         02S0433
*     EODAD LABEL;                  /*                       @Y30LB52*/
*EODAD:                             /* END OF DS EXIT        @Y30LB52*/
*   EOF=ON;                         /* END OF FILE           @Y30LB52*/
EODAD    DS    0H                                               02S0435
*   EOC=ON;                         /* END OF COMMAND        @Y30LB52*/
         OI    EOF,B'11000000'                                  02S0435
*   GEN(CLOSE MF=(E,OPENLIST))                                  02S0436
*   SETS(SYSINDCB,OPENLIST);        /* CLOSE THE DS          @Y30LB52*/
         CLOSE MF=(E,OPENLIST)
*   RETURN;                         /*                       @Y30LB52*/
         B     @EL00005                                         02S0437
*   END READRCRD;                   /*                       @Y30LB52*/
*HEXBYTES:                                                      02S0439
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/
*                                                               02S0439
HEXBYTES ST    @14,12(,@13)                                     02S0439
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE IS CALLED BY THE PROCEDURES 'NEXTCHAR',        */
*   /* 'NEXTCMMA', AND 'NEXTBLNK' TO CONVERT EBCDIC                  */
*   /* STRINGS(0<LENGTH<11) TO THE HEXADECIMAL EQUIVALENTS. THIS IS  */
*   /* DONE BY CONVERTING EACH CHARACTER INTO THE FORMAT, '0X' WHERE */
*   /* THE 'X' IS A DIGIT 0-9, A-F. THE STRING TO BE CONVERTED IS    */
*   /* ADDTESSED THROUGH BASED VARIABLE 'LINECHAR' AND ITS LENGTH IS */
*   /* CONTAINED IN 'BYTES'. THE CONVERTED STRING IS RETURNED IN THE */
*   /* FIRST HALF OF 'LINECHAR'.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0440
*   DCL                                                         02S0440
*     HEX1 CHAR(11),                /* CONVERSTION SPACE     @Y30LB52*/
*     HEX2 CHAR(6),                 /*                       @Y30LB52*/
*     HEXPTR PTR(31),               /* INPUT STRING POINTER  @Y30LB52*/
*     HEXCHAR FIXED(8) BASED(HEXPTR);/* INPUT CHARACTERS     @Y30LB52*/
*                                                               02S0440
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH THE STRING AND CHANGE 'C1'-'C5' TO '0A'-'0F',    */
*   /* 'F0'-'F9' TO '00'-'09'.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0441
*   HEXPTR=LCPTR;                   /* SET HEX STRING POINTER@Y30LB52*/
         LR    HEXPTR,LCPTR                                     02S0441
*   DO K=1 TO BYTES;                /* LOOP THROUGH TOTAL STRING
*                                                            @Y30LB52*/
         LA    K,1                                              02S0442
         B     @DE00442                                         02S0442
@DL00442 DS    0H                                               02S0443
*     IF HEXCHAR<199 THEN                                       02S0443
         CLI   HEXCHAR(HEXPTR),199                              02S0443
         BNL   @RF00443                                         02S0443
*       HEX1(K)=HEXCHAR-183;        /* CONVERT ALPHABETIC CHARACTERS
*                                                            @Y30LB52*/
         SLR   @10,@10                                          02S0444
         IC    @10,HEXCHAR(,HEXPTR)                             02S0444
         SH    @10,@CH00367                                     02S0444
         STC   @10,HEX1-1(K)                                    02S0444
*     ELSE                                                      02S0445
*       HEX1(K)=HEXCHAR-240;        /* CONVERT NUMERIC CHARACTERS
*                                                            @Y30LB52*/
         B     @RC00443                                         02S0445
@RF00443 SLR   @10,@10                                          02S0445
         IC    @10,HEXCHAR(,HEXPTR)                             02S0445
         SH    @10,@CH00368                                     02S0445
         STC   @10,HEX1-1(K)                                    02S0445
*     HEXPTR=HEXPTR+1;              /* INCREMENT TO NEXT CHARACTER
*                                                            @Y30LB52*/
@RC00443 AH    HEXPTR,@CH00060                                  02S0446
*   END;                            /*                       @Y30LB52*/
         AH    K,@CH00060                                       02S0447
@DE00442 CR    K,BYTES                                          02S0447
         BNH   @DL00442                                         02S0447
*   IF BYTES=1 THEN                                             02S0448
         CH    BYTES,@CH00060                                   02S0448
         BNE   @RF00448                                         02S0448
*     LINECHAR(1)=HEX1(1);          /* ONE CHAR TO CONVERT   @Y30LB52*/
         MVC   LINECHAR(1,LCPTR),HEX1                           02S0449
*   ELSE                                                        02S0450
*     DO;                           /* IF MORE THAN ONE CHARACTER
*                                                            @Y30LB52*/
*                                                               02S0450
         B     @RC00448                                         02S0450
@RF00448 DS    0H                                               02S0451
*       /*************************************************************/
*       /*                                                           */
*       /* PACK THE RESULT                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0451
*       PACK(HEX2,HEX1);            /* EXTRACT THE ZONES     @Y30LB52*/
*                                                               02S0451
         PACK  HEX2(6),HEX1(11)                                 02S0451
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE CONVERTED STRING BACK INTO THE LINE                  */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0452
*       LINECHAR(1:BYTES/2)=HEX2(1:BYTES/2);/* MOVE BACK INTO INPUT
*                                                            @Y30LB52*/
         LR    @00,BYTES                                        02S0452
         SRDA  @00,32                                           02S0452
         D     @00,@CF00045                                     02S0452
         BCTR  @01,0                                            02S0452
         EX    @01,@SM00389                                     02S0452
*     END;                          /*                       @Y30LB52*/
*   END HEXBYTES;                   /*                       @Y30LB52*/
@EL00006 DS    0H                                               02S0454
@EF00006 DS    0H                                               02S0454
@ER00006 L     @14,12(,@13)                                     02S0454
         BR    @14                                              02S0454
*   END ISDACNFG                    /*                       @Y30LB52*/
*                                                               01S0455
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                       */
*/*%INCLUDE SYSLIB  (ISDAPAD5)                                       */
*/*%INCLUDE SYSLIB  (ISDAMCFG)                                       */
*/*%INCLUDE SYSLIB  (ISDACVT )                                       */
*/*%INCLUDE SYSUT5  (OPENCNFG)                                       */
*/*%INCLUDE SYSUT5  (CMNDPROC)                                       */
*/*%INCLUDE SYSUT5  (CPUCONFG)                                       */
*/*%INCLUDE SYSUT5  (MSFN    )                                       */
*/*%INCLUDE SYSUT5  (LOWERCON)                                       */
*/*%INCLUDE SYSUT5  (UPPERCON)                                       */
*/*%INCLUDE SYSUT5  (UPPERCN1)                                       */
*/*%INCLUDE SYSUT5  (DASD    )                                       */
*/*%INCLUDE SYSUT5  (SKIPCMND)                                       */
*/*%INCLUDE SYSUT5  (FINALCFG)                                       */
*/*%INCLUDE SYSUT5  (FINALCF1)                                       */
*/*%INCLUDE SYSUT5  (NEXTCHAR)                                       */
*/*%INCLUDE SYSUT5  (NEXTBLNK)                                       */
*/*%INCLUDE SYSUT5  (NEXTCMMA)                                       */
*/*%INCLUDE SYSUT5  (READRCRD)                                       */
*/*%INCLUDE SYSUT5  (HEXBYTES)                                       */
*                                                               01S0455
*       ;                                                       01S0455
@DATA    DS    0H
@CH00060 DC    H'1'
@CH00063 DC    H'3'
@CH00042 DC    H'4'
@CH00056 DC    H'5'
@CH00054 DC    H'6'
@CH00049 DC    H'8'
@CH00266 DC    H'10'
@CH00052 DC    H'12'
@CH00085 DC    H'36'
@CH00367 DC    H'183'
@CH00368 DC    H'240'
@CH00334 DC    XL2'C1'
@SM00383 MVC   CPUSERS(0,@10),TCPUSER2
@SM00389 MVC   LINECHAR(0,LCPTR),HEX2
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    1F
@SA00002 DS    1F
@SA00004 DS    1F
@SA00005 DS    1F
@TF00001 DS    F
ISDACNFG CSECT
         DS    0F
@CF00045 DC    F'2'
@CH00045 EQU   @CF00045+2
@CF00082 DC    F'28'
@CF00382 DC    F'-4'
@DATD    DSECT
         DS    0D
OPENLIST DS    FL4
         ORG   OPENLIST
OPENEOL  DS    CL1
@NM00007 DS    CL3
         ORG   OPENLIST+4
@NM00001 DS    CL648
         ORG   @NM00001
TCNFGFXD DS    CL14
         ORG   TCNFGFXD
TMSFNO   DS    FL2
TCPUNO   DS    FL2
TSPINO   DS    FL2
TSANO    DS    FL2
TLIB     DS    CL4
TINTFNO  DS    FL2
         ORG   @NM00001+14
@NM00002 DS    CL2
TLTPLIBC DS    CL32
         ORG   TLTPLIBC
TLTPLIB  DS    4CL8
         ORG   @NM00001+48
TCPUINTF DS    CL12
         ORG   TCPUINTF+0
TCPUCHCU DS    CL6
         ORG   TCPUCHCU+0
TCPUID   DS    CL5
TCH      DS    FL1
         ORG   TCPUINTF+6
TSA      DS    FL1
TUINTF   DS    CL1
TFPTR    DS    FL1
@NM00003 DS    CL3
         ORG   @NM00001+648
ILINE    DS    CL80
CNFGFLAG DS    CL1
         ORG   CNFGFLAG
EOC      DS    BL1
EOF      EQU   CNFGFLAG+0
ERROR    EQU   CNFGFLAG+0
RCRD1    EQU   CNFGFLAG+0
SCAN     EQU   CNFGFLAG+0
FIND     EQU   CNFGFLAG+0
COMMA    EQU   CNFGFLAG+0
         ORG   CNFGFLAG+1
         DS    CL3
LCON     DS    CL9
         ORG   LCON
LSA      DS    FL1
LDRC     DS    CL2
         ORG   LDRC+0
MSFNN    DS    FL1
PCU      DS    FL1
         ORG   LCON+9
UC       DS    CL8
         ORG   UC
UID      DS    CL6
         ORG   UID
UCPUID   DS    CL5
UCH      DS    FL1
         ORG   UC+6
USA      DS    FL1
UCI      DS    CL1
         ORG   UC+8
HEX1     DS    CL11
HEX2     DS    CL6
TCPUSER  DS    16CL5
ISDACNFG CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00119 DC    V(ISDAGET1)
@CV00120 DC    V(ISDAFREE)
         DS    0D
RETCOD   DC    F'0'
@CC00276 DC    C'CPUID'
@CC00280 DC    C'SIZ'
@CC00291 DC    C'DRC'
@CC00287 DC    C'SA'
@CC00289 DC    C'CU'
@CC00326 DC    C'DE'
@CB00249 DC    X'FFFFFFFFFF'
@CB00251 DC    X'0000000000'
PATCH    DC    B'00000000'
         DC    XL49'0'
CMNDWORD DC    CL3'CPU'
         DC    CL3'MSF'
         DC    CL3'LOW'
         DC    CL3'UPP'
         DC    CL3'DAS'
         DC    CL3'CRE'
         DC    CL3'TAB'
         DC    CL3'SDG'
         DC    CL3'PRI'
CP0001@  DC    AL4(CPUCONFG)
         DC    AL4(MSFN)
         DC    AL4(LOWERCON)
         DC    AL4(UPPERCON)
         DC    AL4(DASD)
         DC    AL4(SKIPCMND)
         DC    AL4(SKIPCMND)
         DC    AL4(SKIPCMND)
         DC    AL4(SKIPCMND)
UCKEYS   DC    CL2'SA'
         DC    CL2'CI'
         DC    CL2'CH'
         DC    CL2'CU'
         DC    CL2'CP'
         DC    CL2'AL'
CP0002@  DC    AL4(KSA)
         DC    AL4(CI)
         DC    AL4(CH)
         DC    AL4(CUID)
         DC    AL4(KCPUID)
         DC    AL4(ALTPATH)
         DC    AL4(UPPSKIP)
@DATD    DSECT
*                                                         /*@Y30LB52*/
*                                                         /*@Y30LB52*/
*                                                         /*@Y30LB52*/
*                                /* REAL DCB AREA */        @Y30LB52
SYSINDCB DCB   DSORG=PS,MACRF=GM,DDNAME=SDACONFG,LRECL=80,            **
               RECFM=FB,SYNAD=SYNAD,EODAD=EODAD
OFLAGS   EQU   SYSINDCB+48     OPEN FLAGS
ISDACNFG CSECT
*                                                         /*@Y30LB52*/
*                                /* DUMMY STATIC DCB */     @Y30LB52
DUMMYDCB DCB   DSORG=PS,MACRF=GM,DDNAME=SDACONFG,LRECL=80,            **
               RECFM=FB,SYNAD=SYNAD,EODAD=EODAD
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDACNFG CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
HEXPTR   EQU   @07
CHCUPTR  EQU   @02
LTPDRDP  EQU   @04
K        EQU   @04
J        EQU   @06
I        EQU   @03
BYTES    EQU   @03
LCPTR    EQU   @02
LINEND   EQU   @05
R0       EQU   @00
R1       EQU   @01
R15      EQU   @15
LINECHAR EQU   0
ISDAGHDR EQU   0
GET0SPLN EQU   ISDAGHDR+8
CPUSERS  EQU   0
LTPDRDTB EQU   0
LTPDRC   EQU   LTPDRDTB
DRCL0    EQU   LTPDRC
DRCL1    EQU   LTPDRC+1
SADRDDSD EQU   0
DRDACCTB EQU   0
DRDACCS  EQU   0
SAINTF   EQU   0
CHCUTAB  EQU   0
SA       EQU   CHCUTAB+6
INTF     EQU   CHCUTAB+7
SPLTABP  EQU   CHCUTAB+8
SPNDLETB EQU   0
SPNDLES  EQU   0
P0WORK   EQU   0
MSCDRDAC EQU   P0WORK+16
P0WORK1  EQU   0
PCNFG    EQU   0
CNFGFXD  EQU   PCNFG
PCNFGL   EQU   CNFGFXD+14
LTPAD    EQU   PCNFG+16
CHCUAD   EQU   PCNFG+20
CPUSERAD EQU   PCNFG+24
CNFGTOTL EQU   PCNFG+28
SAINTFP  EQU   PCNFG+32
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
PAD00PTR EQU   CVTPTRS0+44
CNFG0PTR EQU   CVTPTRS0+88
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
CL0001@  EQU   0
CL0002@  EQU   0
HEXCHAR  EQU   0
CVTPTR   EQU   0
TCPUSER2 EQU   TCPUSER
GET0PTR  EQU   CNFG0PTR
SAINTFC  EQU   SAINTF
CDRDACCT EQU   DRDACCTB
CSADRDDS EQU   SADRDDSD
CSPNDLET EQU   SPNDLETB
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
LINE     EQU   OUTLINE+1
ANSI     EQU   OUTLINE
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
GEN00PTR EQU   CVTPTRS0+92
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDA00PTR EQU   CVTPTRS0+12
PARMPTR  EQU   CVTPTRS0+8
SDATAPTR EQU   CVTPTRS0+4
DATAPTR  EQU   CVTPTRS0
@NM00006 EQU   PCNFG+30
CHINTFNO EQU   CNFGFXD+12
LIBSIZS  EQU   CNFGFXD+8
SANO     EQU   CNFGFXD+6
SPINO    EQU   CNFGFXD+4
CPUNO    EQU   CNFGFXD+2
MSFNO    EQU   CNFGFXD
PADFPTR1 EQU   P0WORK1
HTOTAL   EQU   P0WORK+90
MSCTOTAL EQU   P0WORK+88
CSFTOTAL EQU   P0WORK+80
SATABPTR EQU   MSCDRDAC+4
@NM00005 EQU   MSCDRDAC+2
MSCINTF  EQU   MSCDRDAC
ENDCORE  EQU   P0WORK+12
COREASG  EQU   P0WORK+8
PADLASTB EQU   P0WORK+4
PADFPTR  EQU   P0WORK
STCTLCCK EQU   SPNDLES+4
STCTLCHK EQU   SPNDLES+2
DRVEQCHK EQU   SPNDLES
CHCU     EQU   CHCUTAB+5
CPUIDSER EQU   CHCUTAB
DRCERRS  EQU   DRDACCS+4
CTLIERRS EQU   DRDACCS+2
DRDERRS  EQU   DRDACCS
SADASDAC EQU   SADRDDSD+4
SADRDACC EQU   SADRDDSD
@NM00004 EQU   ISDAGHDR+26
BLOCKCNT EQU   ISDAGHDR+24
BLOCKID  EQU   ISDAGHDR+20
LASTPTR  EQU   ISDAGHDR+16
NEXTPTR  EQU   ISDAGHDR+12
GET0LEN  EQU   GET0SPLN+1
GET0SPNO EQU   GET0SPLN
ENDPTR   EQU   ISDAGHDR+4
STARTPTR EQU   ISDAGHDR
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00061 EQU   CE0001@
@RF00083 EQU   CE0001@
@RF00180 EQU   CE0002@
@RC00345 EQU   @RC00343
@RC00375 EQU   @RC00373
@RC00401 EQU   @RC00399
@RC00448 EQU   @EL00006
@ENDDATA EQU   *
         END   ISDACNFG,(C'PLS1338',0701,78157)
